(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[6958],{96958:(e,t,r)=>{"use strict";r.d(t,{t3:()=>d,WQ:()=>v,dM:()=>s,rK:()=>g,Lo:()=>h,gP:()=>w,S9:()=>F,AV:()=>P,Sc:()=>j,a3:()=>I,IC:()=>x,wT:()=>S,cZ:()=>k,ek:()=>A,Qc:()=>D,Cf:()=>M,dJ:()=>R,DR:()=>V,f1:()=>_});var n=r(86494),i=r(78889);function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var d=function(e,t,r){var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;return(0,n.findIndex)(e,(function(e){return e<=r&&r<e+t}))}(t,r,e);return-1===i?i:i*r+e-t[i]},f={id:"empty_row",get:function(){}},v=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3?arguments[3]:void 0;return t[d(e,r,n)]||l({},f)},s=function(e,t){return t[e]},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,n.isArray)(e)?e.reduce((function(e,t){return l(l({},e),{},c({},t.id,l(l({},e[t.id]),t.updated)))}),{}):{}},p=function(e,t){var r=Object.keys(t).filter((function(e){return"geometry"!==e})).reduce((function(e,r){return l(l({},e),{},c({},r,t[r]))}),{}),n=Object.keys(t).filter((function(e){return"geometry"===e})).reduce((function(e,r){return l(l({},e),{},c({},r,t[r]))}),{});return l(l(l({},e),n),{},{properties:l(l({},e&&e.properties||{}),r)})},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=(0,n.findIndex)(e,t);return i>=0?e.map((function(e,t){return t===i?r:e})):[].concat(o(e),[r])},h=function(e){return((0,i.getFeatureTypeProperties)(e)||[]).filter((function(e){return!(0,i.isGeometryType)(e)}))},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;return t.map((function(t){return r<=t&&t<=n?0:Math.abs(t-e)})).reduce((function(e,t,r,n){return t>n[e]&&r||e}),0)},b=function(e,t){return t.filter((function(t,r){return r!==e}))},O=function(e,t,r){return e.filter((function(e,n){return n<t||n>=t+r}))},w=function(e,t,r,n){for(var i,o,a=e;a<=t&&void 0===i;a++)-1===d(a*n,r,n)&&(i=a);for(var u=t;u>=e&&void 0===o;u--)-1===d(u*n,r,n)&&(o=u);return[i,o].filter((function(e){return void 0!==e}))},F=function(e,t,r){var n=e.startPage,i=e.endPage,o=w(n,i,t,r),a=o[1]-o[0]+1;return{startIndex:o[0]*r,maxFeatures:a*r}},P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.editable,i=void 0!==n&&n,o=r.sortable,a=void 0===o||o,u=r.resizable,l=void 0===u||u,c=r.filterable,d=void 0===c||c,f=r.defaultSize,v=void 0===f?200:f,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},g=s.getEditor,p=void 0===g?function(){}:g,y=s.getFilterRenderer,m=void 0===y?function(){}:y,b=s.getFormatter,O=void 0===b?function(){}:b;return h(e).filter((function(e){return!(t[e.name]&&t[e.name].hide)})).map((function(e){return{sortable:a,key:e.name,width:t[e.name]&&t[e.name].width||v||void 0,name:t[e.name]&&t[e.name].label||e.name,resizable:l,editable:i,filterable:d,editor:p(e),formatter:O(e),filterRenderer:m(e,e.name)}}))},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},a=(0,i.findGeometryProperty)(r);return e.map((function(e){return l(l({},e),{},{events:e.events&&Object.keys(e.events).reduce((function(i,o){return l(l({},i),{},c({},o,(function(i,a){return e.events[o](t(a.rowIdx),a,r,n)})))}),{})},"geometry"===e.key&&a?{filterRenderer:o(l(l({},a),{},{localType:"geometry"}),a.name),filterable:!0,geometryPropName:a.name}:{})}))},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;return Object.keys(e).reduce((function(o,a){return l(l({},o),{},c({},a,(function(){for(var o=arguments.length,u=new Array(o),l=0;l<o;l++)u[l]=arguments[l];return e[a].apply(e,u.concat([t,r,n,i]))})))}),{})},x=function(e,t){return!!(0,i.getPropertyDesciptor)(e,t)},S=function(e,t,r){return(0,i.isValidValueForPropertyName)(e,(a=r,"geometry"===(o=t)?function(e){return(0,n.get)((0,i.findGeometryProperty)(e),"name")}(a):o),r);var o,a},k=function(){return"EPSG:4326"},A=function(e,t,r){return function(n){return t.length>0?n._new:!e||e&&!!r[n.id]}},D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p(e,t[e.id]||{})},z=/\s*(!==|!=|<>|<=|>=|===|==|=|<|>)?\s*(-?\d*\.?\d*)\s*/,M=function(e,t){if("string"===t)return{newVal:(0,n.trim)(e),operator:"ilike"};var r,i=z.exec(e),o="=";return i?("!=="===(o=i[1]||"=")|"!="===o?o="<>":"==="===o|"=="===o&&(o="="),r=parseFloat(i[2])):r=parseFloat(e,10),{newVal:r,operator:o}},R=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.attribute,i=t.operator,o=t.value,a=t.type,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=(null===(e=u.groupFields)||void 0===e?void 0:e.filter((function(e){return r!==e.id&&1!==e.id})))||[];if(("string"===a||"number"===a)&&(0,n.isString)(o)&&-1!==(null==o?void 0:o.indexOf(","))){var d,f=(null==o?void 0:o.split(",").filter(n.identity))||[],v=(null===(d=u.filterFields)||void 0===d?void 0:d.filter((function(e){return r!==e.attribute})))||[];return l(l({},u),{},{groupFields:c.concat([{id:r,logic:"OR",groupId:1,index:0}]),filterFields:v.concat(f.map((function(e){var t=M(e,a),n=t.operator,i=t.newVal;return{attribute:r,rowId:Date.now(),type:a,groupId:r,operator:n,value:i}}))),spatialField:u.spatialField,spatialFieldOperator:u.spatialFieldOperator})}return l(l({},u),{},{groupFields:c.concat([{id:1,logic:"AND",groupId:1,index:0}]),filterFields:"geometry"===a?u.filterFields:(0,n.isNil)(o)?(u.filterFields||[]).filter((function(e){return e.attribute!==r})):y(u.filterFields||[],{attribute:r},{attribute:r,rowId:Date.now(),type:a,groupId:1,operator:i,value:o}),spatialField:"geometry"===a?o:u.spatialField,spatialFieldOperator:(0,n.isArray)(o)?"OR":""})},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.startIndex,r=void 0===t?0:t,n=e.maxFeatures,i=void 0===n?1:n,o=e.totalFeatures,a=void 0===o?0:o,u=e.resultSize;return{page:Math.ceil(r/i),resultSize:u,size:i,total:a,maxPages:Math.ceil(a/i)-1}},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.endPage,i=t.startPage,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=o.pages,u=o.features,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=l.size,d=l.maxStoredPages,f=l.startIndex,v=w(i,r,a,c),s=v[1]-v[0]+1,g=(0,n.get)(e,"features",[]);g.length!==s*c&&(g=g.concat((0,n.fill)(Array(s*c-g.length>0?s*c-g.length:g.length),!1)));var p=a,y=u,h=p.length+s-Math.max(d,r-i+1);if(h>0)for(var F=i*c,P=r*c,j=F+(P-F)/2,I=0;I<h;I++){var x=m(j,a,F,P),S=x*c;p=b(x,p),y=O(u,S,c)}for(var k=[],A=0;A<s;A++)k.push(f+c*A);return{pages:p.concat(k),features:y.concat(g)}}}}]);