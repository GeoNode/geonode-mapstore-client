(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[7539],{59551:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var n=r(72500),a=r.n(n),i=r(86494),o=r.n(i),u=r(27418),c=r.n(u),l=r(75875),s=r.n(l),f=r(37275),d=r(86267),g=function(e){var t=a().parse(e,!0);return a().format(c()({},t,{search:null},{query:c()({service:"CSW",version:"2.0.2"},t.query,{request:void 0})}))},p={parseUrl:g,getRecordById:function(e){return new Promise((function(t){Promise.all([r.e(9942),r.e(6372)]).then(function(){t(s().get(e).then((function(e){if(e){var t=r(66372).unmarshaller.unmarshalString(e.data);if(t&&t.name&&"GetRecordByIdResponse"===t.name.localPart&&t.value&&t.value.abstractRecord){var n=t.value.abstractRecord[0].value.dcElement;if(n){for(var a={references:[]},i=0;i<n.length;i++){var o=n[i],u=o.name.localPart,c={};c="references"===u&&o.value?{value:o.value.content&&(0,f.$F)(o.value.content[0])||o.value.content||o.value,scheme:o.value.scheme}:o.value.content&&o.value.content[0]||o.value.content||o.value,a[u]&&Array.isArray(a[u])?a[u].push(c):a[u]?a[u]=[a[u],c]:a[u]=c}return{dc:a}}}else if(t&&t.name&&"ExceptionReport"===t.name.localPart)return{error:t.value.exception&&t.value.exception.length&&t.value.exception[0].exceptionText||"GenericError"};return null}return null})))}.bind(null,r)).catch(r.oe)}))},getRecords:function(e,t,n,a){return new Promise((function(i){Promise.all([r.e(9942),r.e(1269)]).then(function(){var u=r(66372),c=u.CSW,l=u.marshaller,p=u.unmarshaller,m=l.marshalString({name:"csw:GetRecords",value:c.getRecords(t,n,a)});i(s().post(g(e),m,{headers:{"Content-Type":"application/xml"}}).then((function(e){if(e){var t=p.unmarshalString(e.data);if(t&&t.name&&"GetRecordsResponse"===t.name.localPart&&t.value&&t.value.searchResults){var r=t.value,n=r.searchResults.abstractRecord||r.searchResults.any,a={numberOfRecordsMatched:r.searchResults.numberOfRecordsMatched,numberOfRecordsReturned:r.searchResults.numberOfRecordsReturned,nextRecord:r.searchResults.nextRecord},i=[];if(n)for(var u=0;u<n.length;u++){var c=n[u].value,l={dateStamp:c.dateStamp&&c.dateStamp.date,fileIdentifier:c.fileIdentifier&&c.fileIdentifier.characterString&&c.fileIdentifier.characterString.value,identificationInfo:c.abstractMDIdentification&&c.abstractMDIdentification.value};if(c.boundingBox){var s,g=void 0,m=void 0;if((s=Array.isArray(c.boundingBox)?o().head(c.boundingBox):c.boundingBox)&&s.value){var v,y,h,b,S=null!==(v=null===(y=s.value)||void 0===y?void 0:y.crs)&&void 0!==v?v:"",x=null===(h=S.match(/[\w-]*:[\w-]*:[\w-]*:[\w-]*:[\w-]*:[^:]*:(([\w-]+\s[\w-]+)|[\w-]*)/))||void 0===h?void 0:h[0],R=(0,d.makeNumericEPSG)(null===(b=S.match(/EPSG:[0-9]+/))||void 0===b?void 0:b[0]),w=s.value.lowerCorner,P=s.value.upperCorner,O=R||(0,d.extractCrsFromURN)(x)||o().last(S.split(":"));if(O){if("EPSG:"===O.slice(0,5)){if(!(m=(0,d.makeNumericEPSG)(O)))throw new Error('No suitable EPSG numeric conversion found for "'.concat(O,'"'))}else if(!(m=(0,d.makeNumericEPSG)("EPSG:".concat(O))))throw new Error('No suitable EPSG numeric conversion found for "'.concat(O,'"'))}else m="EPSG:4326";"EPSG:4326"===m&&"CRS84"!==O&&"OGC:CRS84"!==O&&(w=[w[1],w[0]],P=[P[1],P[0]]),g=(0,d.makeBboxFromOWS)(w,P)}l.boundingBox={extent:g,crs:m}}var L=c.dcElement;if(L){for(var C={references:[]},B=0;B<L.length;B++){var E=L[B],M=E.name.localPart,G={};G="references"===M&&E.value?{value:E.value.content&&(0,f.$F)(E.value.content[0])||E.value.content||E.value,scheme:E.value.scheme}:E.value.content&&E.value.content[0]||E.value.content||E.value,C[M]&&Array.isArray(C[M])?C[M].push(G):C[M]?C[M]=[C[M],G]:C[M]=G}l.dc=C}i.push(l)}return a.records=i,a}if(t&&t.name&&"ExceptionReport"===t.name.localPart)return{error:t.value.exception&&t.value.exception.length&&t.value.exception[0].exceptionText||"GenericError"}}return null})))}.bind(null,r)).catch(r.oe)}))},textSearch:function(e,t,n,a){return new Promise((function(i){Promise.all([r.e(9942),r.e(1269)]).then(function(){var o=r(84454).Filter,u=null;if(a){var c=o.propertyIsLike("csw:AnyText","%"+a+"%");u=o.filter(c)}i(p.getRecords(e,t,n,u))}.bind(null,r)).catch(r.oe)}))},workspaceSearch:function(e,t,n,a,i){return new Promise((function(o){Promise.all([r.e(9942),r.e(1269)]).then(function(){var u=r(84454).Filter,c=i||"%",l=a&&"%"+a+"%"||"%",s=u.propertyIsLike("identifier",c+":"+l),f=u.filter(s);o(p.getRecords(e,t,n,f))}.bind(null,r)).catch(r.oe)}))},reset:function(){}};const m=p},67007:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>O});var n=r(72500),a=r.n(n),i=r(86494),o=r.n(i),u=r(27418),c=r.n(u),l=r(5055),s=r.n(l),f=r(75875),d=r.n(f),g=r(37275),p=r(86267);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h={},b=function(e){var t=(o().isArray(e)&&e||e.split(","))[0],r=a().parse(t,!0);return a().format(c()({},r,{search:null},{query:c()({service:"WMS",version:"1.3.0",request:"GetCapabilities"},r.query)}))},S=function(e){var t=e&&e.Title,r=e.LogoURL&&v(v({},o().get(e,"LogoURL.$")||{}),{},{format:o().get(e,"LogoURL.Format")}),n=o().get(e,'OnlineResource.$["xlink:href"]');return{title:t,logo:r,imageUrl:o().get(e,'LogoURL.OnlineResource.$["xlink:href"]'),link:n}},x=function e(t){return t.Layer?(o().isArray(t.Layer)&&t.Layer||[t.Layer]).reduce((function(t,r){return t.concat(e(r)).concat(r.Layer&&r.Name?[r]:[])}),[]):t.Name&&[t]||[]},R=function(e){return e.Request&&e.Request.GetMap&&e.Request.GetMap.DCPType&&e.Request.GetMap.DCPType.HTTP&&e.Request.GetMap.DCPType.HTTP.Get&&e.Request.GetMap.DCPType.HTTP.Get.OnlineResource&&e.Request.GetMap.DCPType.HTTP.Get.OnlineResource.$||void 0},w=function(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0,l=(n.WMS_Capabilities||n.WMT_MS_Capabilities||{}).Capability,s=(n.WMS_Capabilities||n.WMT_MS_Capabilities||{}).Service,f=R(l),d=l.Layer&&(null===(e=l.Layer.SRS||l.Layer.CRS)||void 0===e?void 0:e.map((function(e){return e.toUpperCase()})))||[],g=l.Layer&&l.Layer.Attribution&&S(l.Layer.Attribution),p=l.Request&&l.Request.GetMap&&l.Request.GetMap.Format||[],m=x(l),v=o().isArray(m)?m:[m],y=v.filter((function(e){return!u||-1!==e.Name.toLowerCase().indexOf(u.toLowerCase())||e.Title&&-1!==e.Title.toLowerCase().indexOf(u.toLowerCase())||e.Abstract&&-1!==e.Abstract.toLowerCase().indexOf(u.toLowerCase())}));return{numberOfRecordsMatched:y.length,numberOfRecordsReturned:Math.min(i,y.length),nextRecord:a+Math.min(i,y.length)+1,service:s,layerOptions:{version:(null===(t=n.WMS_Capabilities||n.WMT_MS_Capabilities)||void 0===t||null===(r=t.$)||void 0===r?void 0:r.version)||"1.3.0"},records:y.filter((function(e,t){return t>=a-1&&t<a-1+i})).map((function(e){return c()({},e,{formats:p,onlineResource:f,SRS:d,credits:e.Attribution?S(e.Attribution):g})}))}},P=function(e,t,r,n){var a=h[e];return a&&(new Date).getTime()<a.timestamp+1e3*((0,g.u8)("cacheExpire")||60)?new Promise((function(e){e(w(a.data,t,r,n))})):d().get(b(e)).then((function(a){var i;return s().parseString(a.data,{explicitArray:!1},(function(e,t){i=t})),h[e]={timestamp:(new Date).getTime(),data:i},w(i,t,r,n)}))};const O={flatLayers:x,parseUrl:b,getDimensions:function(e){return o().castArray(e.Dimension||e.dimension||[]).map((function(t,r){var n=e.Extent&&o().castArray(e.Extent)[r]||e.extent&&o().castArray(e.extent)[r];return{name:t.$.name,units:t.$.units,unitSymbol:t.$.unitSymbol,default:t.$.default||n&&n.$.default,values:t._&&t._.split(",")||n&&n._&&n._.split(",")}}))},getCapabilities:function(e,t){var n=a().parse(e,!0),i=a().format(c()({},n,{query:c()({service:"WMS",version:"1.1.1",request:"GetCapabilities"},n.query)}));return new Promise((function(e){Promise.all([r.e(9942),r.e(7260)]).then(function(){var n=r(67260).unmarshaller;e(d().get(b(i)).then((function(e){var r;if(t)return s().parseString(e.data,{explicitArray:!1},(function(e,t){r=t})),r;var a=n.unmarshalString(e.data);return a&&a.value})))}.bind(null,r)).catch(r.oe)}))},describeLayer:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=a().parse(e,!0),o=a().format(c()({},i,{query:c()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},i.query,n.query||{})}));return new Promise((function(e){Promise.all([r.e(9942),r.e(7260)]).then(function(){var t=r(67260).unmarshaller;e(d().get(b(o)).then((function(e){var r=t.unmarshalString(e.data);return r&&r.value&&r.value.layerDescription&&r.value.layerDescription[0]})))}.bind(null,r)).catch(r.oe)}))},getRecords:P,describeLayers:function(e,t){var r=a().parse(e,!0),n=a().format(c()({},r,{query:c()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},r.query)}));return d().get(b(n)).then((function(e){var t;return s().parseString(e.data,{explicitArray:!1},(function(e,r){t=r&&r.WMS_DescribeLayerResponse&&r.WMS_DescribeLayerResponse.LayerDescription})),(t=Array.isArray(t)?t:[t]).map((function(e){return v(v({},e&&e.$||{}),{},{layerName:e&&e.$&&e.$.name,query:v({},e&&e.query&&e.query.$||{})})}))}))},textSearch:function(e,t,r,n){return P(e,t,r,n)},parseLayerCapabilities:function e(t,r,n){return o().castArray(n||o().get(t,"capability.layer.layer")).reduce((function(n,a){return n||(!a.name&&a.layer?e(t,r,o().castArray(a.layer)):2===r.name.split(":").length&&a.name&&2===a.name.split(":").length?r.name===a.name&&a:a.name&&2===a.name.split(":").length?r.name===a.name.split(":")[1]&&a:2===r.name.split(":").length?r.name.split(":")[1]===a.name&&a:r.name===a.name&&a)}),null)},getBBox:function(e,t){for(var r=e,n=r.EX_GeographicBoundingBox||r.exGeographicBoundingBox||(0,p.getWMSBoundingBox)(r.BoundingBox)||r.LatLonBoundingBox&&r.LatLonBoundingBox.$||r.latLonBoundingBox;!n&&r.Layer&&r.Layer.length;)n=(r=r.Layer[0]).EX_GeographicBoundingBox||r.exGeographicBoundingBox||(0,p.getWMSBoundingBox)(r.BoundingBox)||r.LatLonBoundingBox&&r.LatLonBoundingBox.$||r.latLonBoundingBox;n||(n={westBoundLongitude:-180,southBoundLatitude:-90,eastBoundLongitude:180,northBoundLatitude:90});var a={extent:[n.westBoundLongitude||n.minx,n.southBoundLatitude||n.miny,n.eastBoundLongitude||n.maxx,n.northBoundLatitude||n.maxy],crs:"EPSG:4326"};return t?{crs:a.crs,bounds:{minx:a.extent[0],miny:a.extent[1],maxx:a.extent[2],maxy:a.extent[3]}}:a},reset:function(){Object.keys(h).forEach((function(e){delete h[e]}))}}},3475:(e,t,r)=>{"use strict";r.d(t,{Z:()=>b});var n=r(75875),a=r.n(n),i=r(37275),o=r(72500),u=r.n(o),c=r(27418),l=r.n(c),s=r(5055),f=r.n(s),d=r(86494),g=r(86267),p=r(7294),m={},v=function(e){var t=u().parse(e,!0);return u().format(l()({},t,{search:null},{query:l()({SERVICE:"WMTS",VERSION:"1.0.0",REQUEST:"GetCapabilities"},t.query)}))},y=function(e,t,r,n,a){for(var i=e.Capabilities.Contents,o=(0,p.getOperations)(e),u=(0,p.getRequestEncoding)(e),c=i.TileMatrixSet&&(0,d.castArray)(i.TileMatrixSet)||[],s=[],f=c.length,m=0;m<f;m++)s.push((0,g.getEPSGCode)(c[m]["ows:SupportedCRS"]));var v=i.Layer,y=(0,d.castArray)(v).filter((function(e){return!n||-1!==e["ows:Identifier"].toLowerCase().indexOf(n.toLowerCase())||e["ows:Title"]&&-1!==e["ows:Title"].toLowerCase().indexOf(n.toLowerCase())}));return{numberOfRecordsMatched:y.length,numberOfRecordsReturned:Math.min(r,y.length),nextRecord:t+Math.min(r,y.length)+1,records:y.filter((function(e,n){return n>=t-1&&n<t-1+r})).map((function(e){return l()({},e,{SRS:s,TileMatrixSet:c,queryable:!!(0,p.getOperation)(o,"GetFeatureInfo","KVP"),requestEncoding:u,style:(0,p.getDefaultStyleIdentifier)(e),format:(0,p.getDefaultFormat)(e),GetTileURL:(0,p.getOperation)(o,"GetTile",u),capabilitiesURL:a})}))}},h={parseUrl:v,getRecords:function(e,t,r,n){var o=m[e];return o&&(new Date).getTime()<o.timestamp+1e3*((0,i.u8)("cacheExpire")||60)?new Promise((function(a){a(y(o.data,t,r,n,e))})):a().get(v(e)).then((function(a){var i;return f().parseString(a.data,{explicitArray:!1},(function(e,t){i=t})),m[e]={timestamp:(new Date).getTime(),data:i},y(i,t,r,n,e)}))},getCapabilities:function(e){var t=m[e];return t&&(new Date).getTime()<t.timestamp+1e3*((0,i.u8)("cacheExpire")||60)?new Promise((function(e){e(t.data)})):a().get(v(e)).then((function(t){var r;return f().parseString(t.data,{explicitArray:!1},(function(e,t){r=t})),m[e]={timestamp:(new Date).getTime(),data:r},r}))},textSearch:function(e,t,r,n){return h.getRecords(e,t,r,n)},reset:function(){Object.keys(m).forEach((function(e){delete m[e]}))}};const b=h},32354:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(86494),a=r(37275),i=function(e,t,r,i){var o=(0,n.get)(a.ZP.getDefaults(),"initialState.defaultState.catalog.default.staticServices.default_map_backgrounds.backgrounds").filter((function(e){return!i||e.title.indexOf(i)>-1})),u=o.filter((function(e,n){return n>=t-1&&n<r+t-1}));return new Promise((function(e){return e({numberOfRecordsMatched:o.length,numberOfRecordsReturned:u.length,records:u,service:{Name:"Background Provider"}})}))};const o={getRecords:i,reset:function(){},textSearch:function(e,t,r,n){return i(0,t,r,n)}}},88113:(e,t,r)=>{"use strict";r.d(t,{b6:()=>l,PG:()=>s,_x:()=>f,Mm:()=>d,dP:()=>g,SX:()=>p,ZL:()=>m,_S:()=>v,iH:()=>y,R7:()=>h,Q7:()=>b,n7:()=>S,bA:()=>x,hm:()=>R,E2:()=>w,Cb:()=>P,eK:()=>O,Im:()=>L,e8:()=>C,$t:()=>B,kS:()=>E,y:()=>M,l2:()=>G,HN:()=>T});var n=r(22222),a=r(86494),i=r(827);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=function(e){return(0,a.get)(e,"catalog.services")},s=(0,n.P1)((function(e){return(0,a.get)(e,"catalog.default.staticServices")}),l,(function(e,t){return u(u({},t),(0,a.pick)(e,"default_map_backgrounds"))})),f=function(e){return(0,a.get)(e,"catalog.default.tileSizes",[256,512])},d=function(e){return(0,a.get)(e,"controls.metadataexplorer.group")},g=function(e){return(0,a.get)(e,"catalog.saving")},p=function(e){return(0,a.get)(e,"catalog.result")},m=function(e){return(0,a.get)(e,"catalog.openCatalogServiceList")},v=function(e){return(0,a.get)(e,"catalog.newService")},y=function(e){return(0,a.get)(e,"catalog.newService.type","csw")},h=function(e){return(0,a.get)(e,'catalog.services["'.concat((0,a.get)(e,"catalog.selectedService"),'"]'))},b=function(e){return(0,a.get)(e,'catalog.services["'.concat((0,a.get)(e,"catalog.selectedService"),'"].type'),function(e){return(0,a.get)(e,'catalog.default.staticServices["'.concat((0,a.get)(e,"catalog.selectedService"),'"].type'),"csw")}(e))},S=function(e){return(0,a.get)(e,'catalog.services["'.concat((0,a.get)(e,"catalog.selectedService"),'"].layerOptions'),{})},x=function(e){return(0,a.get)(e,"catalog.searchOptions")},R=function(e){return(0,a.get)(e,"catalog.loadingError")},w=function(e){return(0,a.get)(e,"catalog.loading",!1)},P=function(e){return(0,a.get)(e,"catalog.selectedService")},O=function(e){return(0,a.get)(e,"catalog.mode","view")},L=function(e){return(0,a.get)(e,"catalog.layerError")},C=function(e){return(0,a.get)(e,"catalog.searchOptions.text","")},B=function(e){return"metadataexplorer"===(0,a.get)(e,"controls.toolbar.active")||(0,a.get)(e,"controls.metadataexplorer.enabled")},E=function(e){return((0,a.get)(e,"localConfig.authenticationRules")||[]).filter((function(e){return"authkey"===e.method})).map((function(e){return e.authkeyParamName}))||[]},M=function(e){return(0,a.get)(e,"catalog.pageSize",4)},G=function(e){return(0,a.get)(e,"catalog.delayAutoSearch",1e3)},T=(0,n.zB)({projection:i.uy})}}]);