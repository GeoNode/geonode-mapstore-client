(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[237],{14068:(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var n=r(67294),o=r.n(n),a=r(55033),i=r.n(a),c=r(32425),l=r(83139),u=r(80717);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}const p=(0,n.forwardRef)((function(e,t){var r,a,m=e.className,p=void 0===m?"ms-thumbnail":m,b=e.label,v=e.loading,g=e.message,y=e.error,h=e.thumbnail,O=e.removeGlyph,E=void 0===O?"trash":O,S=e.removeTooltipId,j=void 0===S?"removeThumbnail":S,w=e.style,I=void 0===w?{}:w,A=e.maxFileSize,C=void 0===A?5e5:A,P=e.supportedImageTypes,D=void 0===P?["image/png","image/jpeg","image/jpg"]:P,k=e.thumbnailOptions,z=e.dropZoneProps,T=void 0===z?{className:"ms-thumbnail-dropzone",activeClassName:"ms-thumbnail-dropzone-active",rejectClassName:"ms-thumbnail-dropzone-reject"}:z,Z=e.onUpdate,N=void 0===Z?function(){}:Z,R=e.onError,G=void 0===R?function(){}:R,_=e.onRemove,x=e.toolbarButtons,U=(0,n.useRef)(),M=(r=(0,n.useState)(),a=2,function(e){if(Array.isArray(e))return e}(r)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return r}}(r,a)||d(r,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),F=M[0],B=M[1];if((0,n.useEffect)((function(){return U.current=!0,function(){U.current=!1}}),[]),v||F)return o().createElement("div",{className:"dropzone-thumbnail-container".concat(p?" ".concat(p):""," ms-loading")},o().createElement(c.Z,{size:70}));var L=o().createElement(u.Z,{btnDefaultProps:{className:"square-button-md no-border"},buttons:x||[{glyph:E,visible:!(!_||!h),tooltipId:j,onClick:function(e){var t;null==e||null===(t=e.stopPropagation)||void 0===t||t.call(e),null==_||_()}}]});return o().createElement("div",{className:"dropzone-thumbnail-container".concat(p?" ".concat(p):""),style:I},b,o().createElement(i(),s({},T,{multiple:!1,onDrop:function(e){var t,r=null==e||null===(t=e[0])||void 0===t?void 0:t.type,n=-1!==D.indexOf(r);B(!0),function(e,t){return new Promise((function(r){var n=e;if(null!=n&&n[0]){var o=n[0],a=new FileReader;return a.onload=function(e){return r(t?(0,l.Xq)(e.target.result,t).then((function(e){return{data:e,size:e.length}})):{data:e.target.result,size:o.size})},a.readAsDataURL(o)}return r({data:null})}))}(e,k).then((function(t){var r=t.data,o=t.size;return U.current?(B(!1),n&&r&&o<C?N(r,e):G([].concat(f(n?[]:["FORMAT"]),f(r&&o>=C?["SIZE"]:[])),e)):null})).catch((function(e){return U.current?(B(!1),G(e)):null}))}}),h?o().createElement("div",{style:{position:"relative",width:"100%",height:"100%"}},o().createElement("div",{ref:t,style:{position:"relative",width:"100%",height:"100%",backgroundImage:"url(".concat(h,")"),backgroundSize:null!=k&&k.contain?"contain":"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),o().createElement("div",{className:"dropzone-content-image-added"},g),L):o().createElement("div",{className:"dropzone-content-image"},g,L,y&&o().createElement("div",{className:"dropzone-errors"},y))))}))},46781:(e,t,r)=>{"use strict";r.d(t,{D6:()=>d,Ug:()=>p});var n=r(61545),o=r(57579),a=function(e,t,r){var n,o,a=[],i=[],c=e;for(a.push(c);a.length>0;)if(!r[c=a.shift()])for(r[c]=!0,i.push(c),n=0;n<t.length;n+=1)(o=t[n])[0]!==c||r[o[1]]?o[1]!==c||r[o[0]]||a.push(o[0]):a.push(o[1]);return i},i=function(e){for(var t={},r=[],n=0,o=e.length;n<o;n+=1){var i=e[n],c=i[0],l=i[1],u=null;t[c]?t[l]||(u=l):u=c,u&&r.push(a(u,e,t))}return r},c=r(43143);function l(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var f=function(e,t){var r,a,i=(r=o.oU.exec(e),a=2,function(e){if(Array.isArray(e))return e}(r)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return r}}(r,a)||u(r,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=i[0],l=i[1];return c?(0,n.find)(t,{id:l}):null},d=function(e,t){var r=o.oU.exec(e),a=r&&r[2],i=f(e,t);return a?(0,n.get)(i,a):i},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(t,r){var o=(0,n.get)(r,"mapSync")&&(0,n.get)(r,"dependenciesMap")||{},a=Object.keys(o).map((function(t){return f(o[t],e)}))||[];return[].concat(l(t),l(a.filter((function(e){return void 0!==e})).map((function(e){return[r.id,e.id]}))))}),[])},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=i(m(e)),r={base:190,range:340,options:{base:10,range:360,s:.67,v:.67}},n=(0,c.qH)(r.base,r.range,t.length+1,r.options);return t.map((function(e,t){return{color:n[t],widgets:e}}))}},73443:(e,t,r)=>{"use strict";r.d(t,{rs:()=>n,AY:()=>o,SW:()=>a,yB:()=>i,oG:()=>c,XG:()=>l,id:()=>u,gc:()=>s,cE:()=>f,rG:()=>d,Vj:()=>m,Pg:()=>p});var n="GEONODE:SAVING_RESOURCE",o="GEONODE:SAVE_SUCCESS",a="GEONODE:SAVE_ERROR",i="GEONODE:CLEAR_SAVE",c="GEONODE:SAVE_CONTENT",l="GEONODE:UPDATE_RESOURCE_BEFORE_SAVE";function u(){return{type:n}}function s(e){return{type:o,success:e}}function f(e){return{type:a,error:e}}function d(){return{type:i}}function m(e,t,r){return{type:c,id:e,metadata:t,reload:r}}function p(e){return{type:l,id:e}}},12547:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>N});var n=r(89255),o=r(827),a=r(75110),i=r(31935),c=r(52259),l=r(22222),u=r(88113),s=r(1757),f=r(7877),d=r(85148),m=r(97291);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g={},y=(0,l.zB)({catalogServices:(0,l.zB)({services:u.b6,selectedService:u.Cb}),widgetsConfig:(0,l.zB)({widgets:s.zm,layouts:s.p,collapsed:s.lF}),mapInfoConfiguration:f.bI,dimensionData:(0,l.zB)({currentTime:d.WT,offsetTime:d.ns}),timelineData:(0,l.zB)({selectedLayer:m.Li})}),h=r(37275),O=r(66113),E=r(74621),S=r(14689),j=r(73443),w=r(43892),I=r(99380),A=r(55035),C=r(55877),P=r.n(C);function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Z={map:function(e,t,r,n){var l,u=(0,o.Od)(e)||{},s=(0,a.l2)(e),f=(0,a.Bt)(e),d=(0,i.Mz)(e),m=function(e){return e.searchconfig&&e.searchconfig.textSearchConfig}(e),p=function(e){return e.searchbookmarkconfig&&e.searchbookmarkconfig.bookmarkSearchConfig}(e),O=function(e){var t=Object.keys(g).reduce((function(t,r){return b(b({},t),{},v({},r,g[r](e)))}),{});return b(b({},y(e)),t)}(e),E=(0,c.saveMapConfiguration)(u,s,f,d,m,p,O),j=r.name,w=r.description,I=r.thumbnail,C={name:j,data:E,attributes:[{type:"string",name:"title",value:j,label:"Title"},{type:"string",name:"abstract",value:w,label:"Abstract"}].concat((l=I?[{type:"string",name:"thumbnail",value:I,label:"Thumbnail"}]:[],function(e){if(Array.isArray(e))return T(e)}(l)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(l)||function(e,t){if(e){if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?T(e,t):void 0}}(l)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))};return t?(0,S.Gg)(t,k(k({},C),{},{id:t})):(0,S.fk)(C).then((function(e){return n&&(window.location.href=(0,A.zL)("".concat((0,h.u8)("geonode_url"),"maps/").concat(e.id,"/edit"))),e.data}))},geostory:function(e,t,r,n){var o=(0,O.Kg)(e),a=(0,E.np)(e),i={title:r.name,abstract:r.description,data:JSON.stringify(o),thumbnail_url:r.thumbnail};return t?(0,I.Tw)(t,i):(0,I.NJ)(k({name:r.name+" "+P()(),owner:a.name},i)).then((function(e){return n&&(window.location.href=(0,A.zL)("".concat((0,h.u8)("geonode_url"),"apps/").concat(e.pk,"/edit"))),e.data}))}};const N={gnSaveContent:function(e,t){return e.ofType(j.oG).switchMap((function(e){var r,o=t.getState(),a=(null===(r=o.gnresource)||void 0===r?void 0:r.type)||"map";return n.Observable.defer((function(){return Z[a](o,e.id,e.metadata,e.reload)})).switchMap((function(t){return n.Observable.of((0,j.gc)(t),(0,w.QN)({title:e.metadata.name,abstract:e.metadata.description,thumbnail_url:e.metadata.thumbnail}))})).catch((function(e){return n.Observable.of((0,j.cE)(e.data||e.message))})).startWith((0,j.id)())}))},gnUpdateResource:function(e,t){return e.ofType(j.XG).switchMap((function(e){var r,o=(null===(r=t.getState().gnresource)||void 0===r?void 0:r.data)||{};return!e.id||o.pk&&e.id&&o.pk+""==e.id+""?n.Observable.empty():n.Observable.defer((function(){return(0,I.iv)(e.id)})).switchMap((function(e){return n.Observable.of((0,w.DF)(e))})).catch((function(e){return n.Observable.of((0,w.mN)(e.data||e.message))})).startWith((0,w.Q$)())}))}}},36368:(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var n=r(67294),o=r.n(n),a=r(45697),i=r.n(a),c=r(94745),l=r(14068),u=r(5346),s=r(30294),f=r(93451),d=r(32425);function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var b=(0,f.Z)("placeholder")(s.FormControl);function v(e){var t=e.update,r=e.error,a=e.success,i=e.labelId,f=e.resource,p=e.contentId,v=e.saving,g=e.loading,y=e.enabled,h=e.onClose,O=e.onSave,E=e.onInit,S=e.onClear,j=e.thumbnailOptions,w=m((0,n.useState)(),2),I=w[0],A=w[1],C=m((0,n.useState)(),2),P=C[0],D=C[1],k=m((0,n.useState)(""),2),z=k[0],T=k[1],Z=m((0,n.useState)(""),2),N=Z[0],R=Z[1],G=m((0,n.useState)(!1),2),_=G[0],x=G[1],U=(0,n.useRef)();U.current={contentId:p,resource:f},(0,n.useEffect)((function(){y?E(U.current.contentId):S()}),[y]),(0,n.useEffect)((function(){if(!g){var e=U.current.resource||{};A(e.thumbnail_url),T(e.title),R(e.abstract),D(!1),x(e.title?void 0:"error")}}),[y,g]);var M=g||v;return o().createElement(c.Z,{title:o().createElement(u.Z,{msgId:i}),show:y,fitContent:!0,clickOutEnabled:!1,buttons:M?[]:[{text:o().createElement(u.Z,{msgId:"close"}),onClick:function(){return h()}},{text:o().createElement(u.Z,{msgId:i}),disabled:!!_,onClick:function(){return O(t?p:void 0,{thumbnail:I,name:z,description:N},!0)}}],onClose:M?null:function(){return h()}},r&&o().createElement(s.Alert,{bsStyle:"danger",style:{margin:0}},o().createElement("div",null,o().createElement(u.Z,{msgId:"map.mapError.errorDefault"}))),a&&o().createElement(s.Alert,{bsStyle:"success",style:{margin:0}},o().createElement("div",null,o().createElement(u.Z,{msgId:"saveDialog.saveSuccessMessage"}))),o().createElement(s.Form,null,o().createElement(s.FormGroup,{validationState:P?"error":void 0},o().createElement(s.ControlLabel,null,o().createElement(u.Z,{msgId:"map.thumbnail"})),o().createElement(l.Z,{thumbnail:I,thumbnailOptions:j,message:o().createElement(u.Z,{msgId:"map.message"}),onUpdate:function(e){A(e),D(!1)},onError:function(e){D(e)}}),P&&o().createElement("div",null,o().createElement("div",null,o().createElement(u.Z,{msgId:"map.error"})),o().createElement("div",null,P.indexOf&&-1!==P.indexOf("FORMAT")&&o().createElement("small",null,o().createElement(u.Z,{msgId:"map.errorFormat"}))),o().createElement("div",null,P.indexOf&&-1!==P.indexOf("SIZE")&&o().createElement("small",null,o().createElement(u.Z,{msgId:"map.errorSize"}))))),o().createElement(s.FormGroup,{validationState:_},o().createElement(s.ControlLabel,null,o().createElement(u.Z,{msgId:"saveDialog.name"})),o().createElement(b,{placeholder:"saveDialog.namePlaceholder",value:z,onChange:function(e){T(e.target.value),x(e.target.value?void 0:"error")},onBlur:function(e){x(e.target.value?void 0:"error")}})),o().createElement(s.FormGroup,null,o().createElement(s.ControlLabel,null,o().createElement(u.Z,{msgId:"saveDialog.description"})),o().createElement(b,{placeholder:"saveDialog.descriptionPlaceholder",value:N,onChange:function(e){return R(e.target.value)}}))),M&&o().createElement("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:2,display:"flex",alignItems:"center",justifyContent:"center"}},o().createElement(d.Z,{size:70})))}v.propTypes={update:i().bool,labelId:i().string,contentId:i().oneOfType([i().string,i().number]),resource:i().object,loading:i().bool,enabled:i().bool,onClose:i().func,onSave:i().func,onInit:i().func,onClear:i().func,error:i().oneOfType([i().string,i().object]),success:i().oneOfType([i().string,i().object]),thumbnailOptions:i().object},v.defaultProps={update:!1,resource:{},loading:!1,enabled:!1,onClose:function(){},onSave:function(){},onInit:function(){},onClear:function(){},thumbnailOptions:{width:300,height:250,type:"image/jpeg",quality:.9,contain:!1}};const g=v},62170:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(73443);const o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.rs:return{saving:!0};case n.AY:return{success:t.success,saving:!1};case n.SW:return{error:t.error,saving:!1};case n.yB:return{};default:return e}}}}]);