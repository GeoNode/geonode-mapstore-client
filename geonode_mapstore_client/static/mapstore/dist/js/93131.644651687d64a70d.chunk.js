"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[93131],{593131:(e,t,i)=>{i.r(t),i.d(t,{default:()=>he});var r=i(367019),n=i(41476),o=i(424620),l=i(267980),a=i(336946),u=i(448871),s=i(491446),m=i(584164),c=i(543622),p=i(337632),y=i(742558),d=i(367817),f=i(434067),v=i(953612),g=i(63316),h=i(15817),T=i(744603),b=i(707568),A=i(215327),O=i(71578),E=i(252544),C=i(938487),L=i.n(C),w=i(499084),P=i.n(w),S=i(198023),R=i.n(S),x=i(302404),H=i.n(x),G=i(623181),I=i.n(G),N=i(611741),z=i.n(N),j=i(417497),D=i(399392),_=i(684633),M=i(290505),k=i(715726),F=i(302982);function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}var B=["msTranslateX","msTranslateY","msHeight"],U=["msGeometry"],Y=["msGeometry"];function V(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,K(r.key),r)}}function X(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;i[r]=e[r]}return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)i=o[r],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function q(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function $(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?q(Object(i),!0).forEach(function(t){J(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):q(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function J(e,t,i){return(t=K(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function K(e){var t=function(e){if("object"!=W(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=W(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==W(t)?t:t+""}function Q(e){return function(e){if(Array.isArray(e))return ee(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Z(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){if(e){if("string"==typeof e)return ee(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ee(e,t):void 0}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}var te=M.R.cesium({Cesium:r});function ie(e){var t=e.color,i=e.opacity;if(!t)return new n.A(0,0,0,0);var r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,l,a=[],u=!0,s=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;u=!1}else for(;!(u=(r=o.call(i)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){s=!0,n=e}finally{try{if(!u&&null!=i.return&&(l=i.return(),Object(l)!==l))return}finally{if(s)throw n}}return a}}(e,t)||Z(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(L()(t).gl(),4),o=r[0],l=r[1],a=r[2],u=r[3];return void 0!==i?new n.A(o,l,a,i):new n.A(o,l,a,u)}function re(e){var t=e.color,i=e.opacity,r=e.dasharray;if((null==r?void 0:r.length)<=0)return ie({color:t,opacity:i});var n=r.reduce(function(e,t){return e+t},0);return new o.A({color:ie({color:t,opacity:i}),dashLength:n,dashPattern:parseInt(r.map(function(e){return Math.floor(e/n*16)}).map(function(e,t){return I()(e).map(function(){return t%2==0?"1":"0"}).join("")}).join(""),2)})}var ne=function(e){var t=parseFloat(e);return!z()(t)&&R()(t)?t:null},oe=function(e){var t=e.map,i=e.positions,r=e.heightReference,n=e.sampleTerrain,o=e.initialHeight,m=null!=r?r:"none",c={none:function(e){return e},relative:function(e,t){return e+t},clamp:function(e,t){return t}},p=[],y=function(e){var t=c[m],i=1/0,r=-1/0,n=1/0,o=-1/0,a=e.map(function(e,a){var u=p[a]||0,s="none"===m?0:e.height||0,c=t(u,s);return i=c<i?c:i,r=c>r?c:r,n=s<n?s:n,o=s>o?s:o,l.A.fromRadians(e.longitude,e.latitude,c)});return{height:{min:i,max:r},sampledHeight:{min:n,max:o},positions:a}},d=i.map(function(e){var t,i=a.A.fromCartesian(e);return p.push(null!==(t=null!=o?o:i.height)&&void 0!==t?t:0),new a.A(i.longitude,i.latitude,null!=o?o:0)}),f=null==t?void 0:t.terrainProvider;return"none"!==m&&f?(f.ready?Promise.resolve(!0):f.readyPromise).then(function(){var e,t,i,r=null!=f&&f.availability?u.A(f,d):n(f,null!==(e=null==f?void 0:f.sampleTerrainZoomLevel)&&void 0!==e?e:18,d);return s.A(r)?null===(t=r.then(function(e){return y(e)}))||void 0===t||null===(i=t.catch)||void 0===i?void 0:i.call(t,function(){return y(d)}):y(d)}):Promise.resolve(y(d))},le={};function ae(e){var t=e.offset,i=void 0===t?[]:t,r=e.msLeaderLineWidth,n=null!=r?r:1,o=Math.abs(i[0]||1),l=Math.abs(i[1]||1),a=Math.sign(i[0])===Math.sign(i[1]),u=[o,l,n,a].join(";");if(le[u])return le[u];var s=document.createElement("canvas");s.setAttribute("width",o),s.setAttribute("height",l);var m=s.getContext("2d");return m.strokeStyle="#ffffff",m.lineWidth=n,m.beginPath(),m.moveTo.apply(m,Q(a?[0,0]:[o,0])),m.lineTo.apply(m,Q(a?[o,l]:[0,l])),m.stroke(),le[u]=s,s}var ue=function(e,t){var i=t||{},r=i.msTranslateX,n=i.msTranslateY,o=ne(r),a=ne(n);return o||a?m.A.multiplyByPoint(c.A.eastNorthUpToFixedFrame(e),new l.A(o||0,a||0,0),new l.A):e},se={none:"NONE",relative:"RELATIVE_TO_GROUND",clamp:"CLAMP_TO_GROUND"},me=function(e){switch(e){case"top-left":return{horizontalOrigin:p.A.LEFT,verticalOrigin:y.A.TOP};case"top":return{horizontalOrigin:p.A.CENTER,verticalOrigin:y.A.TOP};case"top-right":return{horizontalOrigin:p.A.RIGHT,verticalOrigin:y.A.TOP};case"left":return{horizontalOrigin:p.A.LEFT,verticalOrigin:y.A.CENTER};case"center":default:return{horizontalOrigin:p.A.CENTER,verticalOrigin:y.A.CENTER};case"right":return{horizontalOrigin:p.A.RIGHT,verticalOrigin:y.A.CENTER};case"bottom-left":return{horizontalOrigin:p.A.LEFT,verticalOrigin:y.A.BOTTOM};case"bottom":return{horizontalOrigin:p.A.CENTER,verticalOrigin:y.A.BOTTOM};case"bottom-right":return{horizontalOrigin:p.A.RIGHT,verticalOrigin:y.A.BOTTOM}}},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Square",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if("Circle"===e){for(var i=[],r=0;r<360;r++){var n=d.A.toRadians(r);i.push(new f.A(t*Math.cos(n),t*Math.sin(n)))}return i}return"Square"===e?[new f.A(-t,-t),new f.A(t,-t),new f.A(t,t),new f.A(-t,t)]:[]},pe=function(e,t){var i=t||{},r=i.heading,n=i.pitch,o=i.roll;if(r||n||o){var l=new v.A(d.A.toRadians(null!=r?r:0),d.A.toRadians(null!=n?n:0),d.A.toRadians(null!=o?o:0));return c.A.headingPitchRollQuaternion(e,l)}return null},ye=function(e,t){var i,r=t.radius,n=e;if(t.geodesic){var o=k.A.computeEllipsePositions({granularity:.02,semiMajorAxis:r,semiMinorAxis:r,rotation:0,center:n},!1,!0).outerPositions;i=l.A.unpackArray(o),i=[].concat(Q(i),[i[0]])}else{var a=m.A.multiplyByTranslation(c.A.eastNorthUpToFixedFrame(n),new l.A(0,0,0),new m.A);i=F.A.computePositions(0,r,r,128,!1),i=(i=Q((i=l.A.unpackArray(i)).splice(0,Math.ceil(i.length/2)))).map(function(e){return m.A.multiplyByPoint(a,e,new l.A)}),i=[].concat(Q(i),[i[0]])}return i},de=function(e,t){var i=(t||{}).msHeight,r=ne(i);if(null!==r){var n=a.A.fromCartesian(e);return l.A.fromRadians(n.longitude,n.latitude,r)}return e},fe={point:function(e){var t=e.feature,i=e.primitive,r=e.parsedSymbolizer;if("Point"===t.geometry.type){var n=de(t.positions[0][0],r),o=pe(n,r);return $($({},e),{},{primitive:$($({},i),{},{orientation:o,geometry:ue(n,r)})})}var l=te($({msGeometry:{name:"centerPoint"}},r))(t).position,a=pe(l,r);return $($({},e),{},{primitive:$($({},i),{},{orientation:a,geometry:ue(de(l,r),r)})})},leaderLine:function(e,t){var i=t.map,r=t.sampleTerrain,n=e.parsedSymbolizer,o=(n.msTranslateX,n.msTranslateY,n.msHeight,X(n,B)),l=fe.point($($({},e),{},{parsedSymbolizer:o})).primitive;return Promise.all([oe({map:i,positions:[l.geometry],heightReference:"clamp",sampleTerrain:r}).then(function(e){return e.positions[0]}),oe({map:i,positions:[ue(de(l.geometry,n),n)],heightReference:n.msHeightReference,sampleTerrain:r}).then(function(e){return e.positions[0]})]).then(function(t){return $($({},e),{},{primitive:$($({},l),{},{geometry:[t]})})})},polyline:function(e,t){var i=t.map,r=t.sampleTerrain,n=e.feature,o=e.primitive,l=e.parsedSymbolizer,a=ne(l.msExtrudedHeight),u=ne(l.msHeight);if(null!==u||l.msExtrusionRelativeToGeometry){var s=1/0,m=-1/0;return Promise.all(null==n?void 0:n.positions.map(function(e){return oe({map:i,positions:e,heightReference:l.msHeightReference,sampleTerrain:r,initialHeight:u}).then(function(e){var t=e[l.msExtrusionRelativeToGeometry?"height":"sampledHeight"];return s=t.min<s?t.min:s,m=t.max>m?t.max:m,e.positions})})).then(function(t){return $($({},e),{},{primitive:$($({},o),{},{geometry:t,extrudedHeight:a?a+(a>0?m:s):void 0})})})}return $($({},e),{},{primitive:$($({},o),{},{geometry:null==n?void 0:n.positions},null!==a&&{extrudedHeight:a})})},wall:function(e,t){return Promise.resolve(fe.polyline(e,t)).then(function(t){var i,r,n=t.primitive;return $($({},e),{},{primitive:$($({},n),{},{geometry:null==n?void 0:n.geometry,minimumHeights:null==n||null===(i=n.geometry)||void 0===i?void 0:i.map(function(e){return e.map(function(e){return a.A.fromCartesian(e).height})}),maximumHeights:null==n||null===(r=n.geometry)||void 0===r?void 0:r.map(function(e){return e.map(function(){return n.extrudedHeight})})})})})},polygon:function(e,t){var i,r,n=t.map,o=t.sampleTerrain,l=e.feature,a=e.primitive,u=e.parsedSymbolizer,s=ne(u.msExtrudedHeight),m=ne(u.msHeight);if("none"!==(u.msHeightReference||"none")||u.msExtrusionRelativeToGeometry){var c=1/0,p=-1/0;return Promise.all(null==l?void 0:l.positions.map(function(e){return oe({map:n,positions:e,heightReference:u.msHeightReference,sampleTerrain:o,initialHeight:m}).then(function(e){var t=e[u.msExtrusionRelativeToGeometry?"height":"sampledHeight"];return c=t.min<c?t.min:c,p=t.max>p?t.max:p,e.positions})})).then(function(t){var i,r,n={height:void 0,extrudedHeight:s?s+(s>0?p:c):void 0};return $($({},e),{},{primitive:$($({},a),{},{geometry:t},null!=a&&null!==(i=a.entity)&&void 0!==i&&i.polygon?{entity:{polygon:$($({},null==a||null===(r=a.entity)||void 0===r?void 0:r.polygon),n)}}:n)})})}var y=$($({},null!==s&&{extrudedHeight:s}),null!==m&&{height:m,perPositionHeight:!1});return $($({},e),{},{primitive:$($({},a),{},{geometry:null==l?void 0:l.positions},null!=a&&null!==(i=a.entity)&&void 0!==i&&i.polygon?{entity:{polygon:$($({},null==a||null===(r=a.entity)||void 0===r?void 0:r.polygon),y)}}:y)})},circlePolyline:function(e){var t=e.feature,i=e.primitive,r=e.parsedSymbolizer;if("Point"===t.geometry.type){var n=l.A.fromDegrees(t.geometry.coordinates[0],t.geometry.coordinates[1],t.geometry.coordinates[2]||0),o=ye(n,r);return $($({},e),{},{primitive:$($({},i),{},{geometry:[o]})})}return e},circlePolygon:function(e){var t=e.feature,i=e.primitive,r=e.parsedSymbolizer;if("Point"===t.geometry.type){var n=l.A.fromDegrees(t.geometry.coordinates[0],t.geometry.coordinates[1],t.geometry.coordinates[2]||0),o=ye(n,r);return $($({},e),{},{primitive:$($({},i),{},{geometry:[o]})})}return e}},ve={Mark:function(e){var t,i=e.parsedSymbolizer,r=e.globalOpacity,n=e.images,o=e.symbolizer,l=n.find(function(e){return e.id===(0,D.RU)(i,o)})||{},a=l.image,u=l.width,s=l.height,m=u>s?u:s,c=2*i.radius/m;return a&&!z()(c)?[{type:"point",geometryType:"point",entity:{billboard:{image:a,scale:c,rotation:d.A.toRadians(-1*i.rotate||0),disableDepthTestDistance:i.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:g.A[se[i.msHeightReference]||"NONE"],color:ie({color:"#ffffff",opacity:1*r})}}}].concat(Q(i.msLeaderLineWidth?[{type:"leaderLine",geometryType:"leaderLine",entity:{polyline:{material:ie({color:i.msLeaderLineColor||"#000000",opacity:(null!==(t=i.msLeaderLineOpacity)&&void 0!==t?t:1)*r}),width:i.msLeaderLineWidth}}}]:[])):[]},Icon:function(e){var t,i=e.parsedSymbolizer,r=e.globalOpacity,n=e.images,o=e.symbolizer,l=n.find(function(e){return e.id===(0,D.RU)(i,o)})||{},a=l.image,u=l.width,s=l.height,m=u>s?u:s,c=i.size/m;return a&&!z()(c)?[{type:"point",geometryType:"point",entity:{billboard:$($({image:a,scale:c},me(i.anchor)),{},{pixelOffset:i.offset?new f.A(i.offset[0],i.offset[1]):null,rotation:d.A.toRadians(-1*i.rotate||0),disableDepthTestDistance:i.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:g.A[se[i.msHeightReference]||"NONE"],color:ie({color:"#ffffff",opacity:i.opacity*r})})}}].concat(Q(i.msLeaderLineWidth?[{type:"leaderLine",geometryType:"leaderLine",entity:{polyline:{material:ie({color:i.msLeaderLineColor||"#000000",opacity:(null!==(t=i.msLeaderLineOpacity)&&void 0!==t?t:1)*r}),width:i.msLeaderLineWidth}}}]:[])):[]},Text:function(e){var t,i,r,n,o=e.parsedSymbolizer,l=e.feature,a=e.globalOpacity,u=ne(null==o||null===(t=o.offset)||void 0===t?void 0:t[0]),s=ne(null==o||null===(i=o.offset)||void 0===i?void 0:i[1]);return[{type:"point",geometryType:"point",entity:{label:$($({text:(0,D.vK)({properties:l.properties},o.label,""),font:[o.fontStyle,o.fontWeight,"".concat(o.size,"px"),P()(o.font||["serif"]).join(", ")].filter(function(e){return e}).join(" "),fillColor:ie({color:o.color,opacity:1*a})},me(o.anchor)),{},{disableDepthTestDistance:o.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:g.A[se[o.msHeightReference]||"NONE"],pixelOffset:new f.A(null!=u?u:0,null!=s?s:0)},o.haloWidth>0&&{style:h.A.FILL_AND_OUTLINE,outlineColor:ie({color:o.haloColor,opacity:1*a}),outlineWidth:o.haloWidth})}}].concat(Q(o.msLeaderLineWidth?[{type:"leaderLine",geometryType:"leaderLine",entity:{polyline:{material:ie({color:o.msLeaderLineColor||"#000000",opacity:(null!==(r=o.msLeaderLineOpacity)&&void 0!==r?r:1)*a}),width:o.msLeaderLineWidth}}}]:[]),Q(o.msLeaderLineWidth&&(u||s)?[{type:"offset",geometryType:"point",entity:{billboard:{image:ae(o),scale:1,pixelOffset:new f.A((u||0)/2,(s||0)/2),color:ie({color:o.msLeaderLineColor||"#000000",opacity:(null!==(n=o.msLeaderLineOpacity)&&void 0!==n?n:1)*a})}}}]:[]))},Model:function(e){var t,i,r,n,o=e.parsedSymbolizer,l=e.globalOpacity;return null!=o&&o.model?[{type:"point",geometryType:"point",entity:{model:{uri:new T.A({proxy:(0,j.jG)(null==o?void 0:o.model)?new b.A((0,j.s_)()):void 0,url:null==o?void 0:o.model}),color:ie({color:null!==(t=o.color)&&void 0!==t?t:"#ffffff",opacity:(null!==(i=o.opacity)&&void 0!==i?i:1)*l}),scale:null!==(r=null==o?void 0:o.scale)&&void 0!==r?r:1,heightReference:g.A[se[o.msHeightReference]||"NONE"]}}}].concat(Q(o.msLeaderLineWidth?[{type:"leaderLine",geometryType:"leaderLine",entity:{polyline:{material:ie({color:o.msLeaderLineColor||"#000000",opacity:(null!==(n=o.msLeaderLineOpacity)&&void 0!==n?n:1)*l}),width:o.msLeaderLineWidth}}}]:[])):[]},Line:function(e){var t,i,r=e.parsedSymbolizer,n=e.feature,o=e.globalOpacity,l=te(r),a=l?l(n):{};return[].concat(Q(r.color&&0!==r.width?[{type:"polyline",geometryType:"polyline",entity:{polyline:$({material:null!=r&&r.dasharray?re({color:r.color,opacity:r.opacity*o,dasharray:r.dasharray}):ie({color:r.color,opacity:r.opacity*o}),width:r.width,clampToGround:r.msClampToGround,arcType:r.msClampToGround?A.A.GEODESIC:A.A.NONE},a)}}]:[]),Q(r.msClampToGround||!r.msExtrudedHeight||r.msExtrusionType?[]:[{type:"polylineVolume",geometryType:"wall",entity:{wall:{material:ie({color:r.msExtrusionColor||"#000000",opacity:(null!==(t=r.msExtrusionOpacity)&&void 0!==t?t:1)*o})}}}]),Q(!r.msClampToGround&&r.msExtrudedHeight&&r.msExtrusionType?[{type:"polylineVolume",geometryType:"polyline",entity:{polylineVolume:{material:ie({color:r.msExtrusionColor||"#000000",opacity:(null!==(i=r.msExtrusionOpacity)&&void 0!==i?i:1)*o}),shape:ce(r.msExtrusionType,r.msExtrudedHeight/2)}}}]:[]))},Fill:function(e){var t=e.parsedSymbolizer,i=e.feature,r=e.globalOpacity,n=!t.msClampToGround&&!!t.msExtrudedHeight,o=te(t),l=o?o(i):{};return[{type:"polygon",geometryType:"polygon",clampToGround:t.msClampToGround,entity:{polygon:$($({material:ie({color:t.color,opacity:t.fillOpacity*r}),perPositionHeight:!t.msClampToGround},t.msClampToGround?{classificationType:"terrain"===t.msClassificationType?O.A.TERRAIN:"3d"===t.msClassificationType?O.A.CESIUM_3D_TILE:O.A.BOTH}:void 0),{},{arcType:t.msClampToGround?A.A.GEODESIC:void 0},l)}}].concat(Q(t.outlineColor&&0!==t.outlineWidth&&!n?[{type:"polyline",geometryType:"polyline",entity:{polyline:$($({material:null!=t&&t.outlineDasharray?re({color:t.outlineColor,opacity:t.outlineOpacity*r,dasharray:t.outlineDasharray}):ie({color:t.outlineColor,opacity:t.outlineOpacity*r}),width:t.outlineWidth,clampToGround:t.msClampToGround},t.msClampToGround?{classificationType:"terrain"===t.msClassificationType?O.A.TERRAIN:"3d"===t.msClassificationType?O.A.CESIUM_3D_TILE:O.A.BOTH}:void 0),{},{arcType:t.msClampToGround?A.A.GEODESIC:A.A.NONE},l)}}]:[]))},Circle:function(e){var t=e.parsedSymbolizer,i=e.globalOpacity;return[{type:"polygon",geometryType:"circlePolygon",clampToGround:t.msClampToGround,entity:{polygon:$({material:ie({color:t.color,opacity:t.opacity*i})},t.geodesic?$($({perPositionHeight:!t.msClampToGround},t.msClampToGround?{classificationType:"terrain"===t.msClassificationType?O.A.TERRAIN:"3d"===t.msClassificationType?O.A.CESIUM_3D_TILE:O.A.BOTH}:void 0),{},{arcType:A.A.GEODESIC}):{perPositionHeight:!0,arcType:void 0})}}].concat(Q(t.outlineColor&&0!==t.outlineWidth?[{type:"polyline",geometryType:"circlePolyline",entity:{polyline:$({material:null!=t&&t.outlineDasharray?re({color:t.outlineColor,opacity:t.outlineOpacity*i,dasharray:t.outlineDasharray}):ie({color:t.outlineColor,opacity:t.outlineOpacity*i}),width:t.outlineWidth},t.geodesic?$($({clampToGround:t.msClampToGround},t.msClampToGround?{classificationType:"terrain"===t.msClassificationType?O.A.TERRAIN:"3d"===t.msClassificationType?O.A.CESIUM_3D_TILE:O.A.BOTH}:void 0),{},{arcType:A.A.GEODESIC}):{clampToGround:!1,arcType:A.A.NONE})}}]:[]))}},ge=function(e,t){e.msGeometry;var i=X(e,U),r=(t.msGeometry,X(t,Y));return!H()(i,r)};const he=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},(t=[{key:"readStyle",value:function(){return new Promise(function(e,t){try{e(null)}catch(e){t(e)}})}},{key:"writeStyle",value:function(e){return new Promise(function(t,i){try{t(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).rules,t=void 0===e?[]:e;return function(e){var i=e.opacity,r=void 0===i?1:i,n=e.features,o=e.getPreviousStyledFeature,l=void 0===o?function(){}:o,a=e.map,u=e.sampleTerrain,s=void 0===u?E.A:u;return(0,_.J)({rules:t},{features:n}).then(function(e){var i=function(e){var t=e.rules,i=e.features,r=e.globalOpacity,n=e.images;return null==t?void 0:t.map(function(e){var t=i.filter(function(t){var i=t.properties;return!e.filter||(0,D.Cx)({properties:i||{}},e.filter)});return e.symbolizers.map(function(e){return t.filter(function(t){return function(e){var t=e.geometry,i=e.symbolizer;return!("Point"===t.type&&["Fill","Line"].includes(i.kind)||"LineString"===t.type&&["Fill"].includes(i.kind)||"Polygon"===t.type&&["Line"].includes(i.kind))}({geometry:t.geometry,symbolizer:e})}).map(function(t){var i=(0,D.$k)(e,t);return(ve[i.kind]?ve[i.kind]:function(){return[]})({feature:t,symbolizer:e,images:n,parsedSymbolizer:i,globalOpacity:r}).map(function(r){return{id:"".concat(t.id,":").concat(i.symbolizerId,":").concat(r.type),feature:t,primitive:r,symbolizer:e,parsedSymbolizer:i}})}).flat()}).flat()}).flat()}({rules:t,features:n,globalOpacity:r,images:e});return Promise.all(i.map(function(e){var t,i,r,n,o,u,m=l(e);if(!m||(r=m.parsedSymbolizer,n=e.parsedSymbolizer,(null==r||null===(o=r.msGeometry)||void 0===o?void 0:o.name)!==(null==n||null===(u=n.msGeometry)||void 0===u?void 0:u.name)||(null==r?void 0:r.msHeight)!==(null==n?void 0:n.msHeight)||(null==r?void 0:r.msHeightReference)!==(null==n?void 0:n.msHeightReference)||(null==r?void 0:r.msExtrudedHeight)!==(null==n?void 0:n.msExtrudedHeight)||(null==r?void 0:r.msExtrusionRelativeToGeometry)!==(null==n?void 0:n.msExtrusionRelativeToGeometry)||(null==r?void 0:r.msExtrusionType)!==(null==n?void 0:n.msExtrusionType)||(null==r?void 0:r.msTranslateX)!==(null==n?void 0:n.msTranslateX)||(null==r?void 0:r.msTranslateY)!==(null==n?void 0:n.msTranslateY)||(null==r?void 0:r.heading)!==(null==n?void 0:n.heading)||(null==r?void 0:r.pitch)!==(null==n?void 0:n.pitch)||(null==r?void 0:r.roll)!==(null==n?void 0:n.roll))){var c,p,y=fe[null==e||null===(c=e.primitive)||void 0===c?void 0:c.geometryType]?fe[null==e||null===(p=e.primitive)||void 0===p?void 0:p.geometryType]:function(){return e};return Promise.resolve(y(e,{map:a,sampleTerrain:s})).then(function(e){return $($({},e),{},{action:"replace"})})}return Promise.resolve($($({},e),{},{primitive:$($($({},null==m?void 0:m.primitive),null==e?void 0:e.primitive),{},{geometry:null==m||null===(t=m.primitive)||void 0===t?void 0:t.geometry,entity:$({},Object.keys((null==e||null===(i=e.primitive)||void 0===i?void 0:i.entity)||{}).reduce(function(t,i){var r,n;return $($({},t),{},J({},i,$($({},null==m||null===(r=m.primitive)||void 0===r||null===(r=r.entity)||void 0===r?void 0:r[i]),null==e||null===(n=e.primitive)||void 0===n||null===(n=n.entity)||void 0===n?void 0:n[i])))},{}))}),action:ge(m.parsedSymbolizer,e.parsedSymbolizer)?"update":"none"}))}))}).then(function(e){return e.filter(function(e){return!!e.primitive.geometry})})}}(e))}catch(e){i(e)}})}}])&&V(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()}}]);