"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[40531],{140531:(e,t,r)=>{r.d(t,{Uj:()=>K,zZ:()=>ee,Zg:()=>X,Ay:()=>ue,o8:()=>oe,hZ:()=>W,QH:()=>te,lC:()=>V,Uh:()=>re,c5:()=>ne});var n={};r.r(n),r.d(n,{createCategory:()=>$,createResource:()=>F,deleteResource:()=>z,getResource:()=>U,getResourceDataByName:()=>_,getResourceIdByName:()=>x,getResources:()=>Z,searchListByAttributes:()=>H,updateResource:()=>q,updateResourceAttribute:()=>Q});var o=r(45388),u=r(541033),i=r.n(u),a=r(679859),c=r.n(a),s=r(269843),l=r.n(s),f=r(590179),b=r.n(f),v=r(956449),d=r.n(v),p=r(223805),g=r.n(p),m=r(858156),y=r.n(m),h=r(907309),O=r.n(h),A=r(499084),R=r.n(A),w=r(392347),k=r(496463);function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}var j=["tagList"];function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t,r){return(t=function(e){var t=function(e){if("object"!=P(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==P(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||T(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){if(e){if("string"==typeof e)return B(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(e,t):void 0}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var L,I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"rest/geostore/data/".concat(e).concat(t)},N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.A;return o.Observable.defer((function(){return r.getResourceAttributes(e)})).map((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).name;return t(e)})).map((function(e){var t=e.value;return(0,k.s)(t)})).filter((function(e){return!l()(e)}))}))},E=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.A;return t?o.Observable.defer((function(){return r.updateResourcePermissions(e,{SecurityRuleList:{SecurityRule:t}})})):o.Observable.empty()},J=function(e,t,r,n){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:w.A;return"NODATA"!==r.data?o.Observable.defer((function(){return u.createResource({name:"".concat(e,"-").concat(t,"-").concat(i()())},r.data,r.category)})).pluck("data").switchMap((function(i){return o.Observable.forkJoin([o.Observable.defer((function(){return u.updateResourceAttribute(e,t,I(i,r.tail))}))].concat(D(n?[E(i,n,u)]:[]))).map((function(){return i}))})):o.Observable.of(-1)},U=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.includeAttributes,n=void 0===r||r,u=t.includeTags,i=void 0===u||u,a=t.withData,c=void 0===a||a,s=t.withPermissions,l=void 0!==s&&s,f=t.baseURL,b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.A;return o.Observable.forkJoin([o.Observable.defer((function(){return b.getShortResource(e,i?{params:{includeTags:i}}:void 0)})).pluck("ShortResource"),o.Observable.defer((function(){return n?b.getResourceAttributes(e):new Promise((function(e){return e([])}))}))].concat(D(c?[o.Observable.defer((function(){return b.getData(e,{baseURL:f})}))]:[Promise.resolve(void 0)]),D(l?[o.Observable.defer((function(){return b.getResourcePermissions(e,{},!0)}))]:[Promise.resolve(void 0)]))).map((function(e){var t,r,n=(r=4,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,u,i,a=[],c=!0,s=!1;try{if(u=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=u.call(r)).done)&&(a.push(n.value),a.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return a}}(t,r)||T(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],u=void 0===o?{}:o,i=u.tagList,a=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)r=u[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(u,j),c=n[1],s=n[2],l=n[3];return M(M(M({},a),i&&{tags:R()((null==i?void 0:i.Tag)||[])}),{},{attributes:(c||[]).reduce((function(e,t){return M(M({},e),{},C({},t.name,t.value))}),{}),data:s,permissions:l})}))},x=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.A;return o.Observable.defer((function(){return r.getResourceIdByName(e,t)}))},_=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.A;return o.Observable.defer((function(){return r.getResourceDataByName(e,t)}))},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.query,r=void 0===t?"*":t,n=e.category,u=e.options,i=void 0===u?{params:{start:0,limit:10},includeAttributes:!1,withData:!1,withPermission:!1}:u,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.A;return o.Observable.defer((function(){return a.getResourcesByCategory(n,r,i)})).map((function(e){var t=e.results,r=void 0===t?[]:t,n=e.totalCount,o=void 0===n?0:n,u=i.includeAttributes,c=i.withData,s=i.withPermission;return u||c||s?{totalCount:o,results:r.map((function(e){var t=e.id;return U(t,i,a)}))}:{totalCount:o,results:r}}))},F=function(e){var t=e.data,r=e.category,n=e.metadata,u=e.permission,i=e.linkedResources,a=void 0===i?{}:i,c=e.tags,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.A;return o.Observable.defer((function(){return s.createResource(n,t,r)})).pluck("data").switchMap((function(e){return o.Observable.defer((function(){return s.getResourcePermissions(e)})).map((function(e){return function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).concat(e)}(e,u)})).switchMap((function(t){return E(e,t,s).map((function(){return{id:e,permission:t}}))}))})).switchMap((function(e){var t=e.id,r=e.permission;return Object.keys(a).length>0?o.Observable.forkJoin(Object.keys(a).filter((function(e){return a[e].data&&"NODATA"!==a[e].data})).map((function(e){return J(t,e,a[e],r,s)}))).map((function(){return t})):o.Observable.of(t)})).switchMap((function(e){return o.Observable.defer((function(){return Promise.all((c||[]).map((function(t){var r=t.tag;return"link"===t.action?s.linkTagToResource(r.id,e):s.unlinkTagFromResource(r.id,e)})))})).switchMap((function(){return o.Observable.of(e)}))}))},$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.A;return o.Observable.defer((function(){return t.createCategory(e)}))},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.data,n=e.permission,u=e.metadata,i=e.linkedResources,a=void 0===i?{}:i,s=e.tags,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.A,f=Object.keys(a);return o.Observable.forkJoin([o.Observable.defer((function(){return l.putResourceMetadataAndAttributes(t,u)})).switchMap((function(e){return r?o.Observable.defer((function(){return l.putResource(t,r)})):o.Observable.of(e)})).switchMap((function(e){return n?o.Observable.defer((function(){return E(t,n,l)})):o.Observable.of(e)})),(f.length>0?o.Observable.forkJoin.apply(o.Observable,D(f.map((function(e){return function(e,t,r,n){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:w.A;return o.Observable.defer((function(){return u.getResourceAttributes(e)})).switchMap((function(i){var a,c=null===(a=O()(i,{name:t}))||void 0===a?void 0:a.value;return(0,k.s)(c)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,u=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return"NODATA"===r.data?o.Observable.fromPromise(i.deleteResource(n)).catch((function(){return o.Observable.of("DUMMY")})).switchMap((function(){return o.Observable.fromPromise(i.updateResourceAttribute(e,t,"NODATA"))})):o.Observable.forkJoin([o.Observable.defer((function(){return i.putResource(n,r.data)})).switchMap((function(){return o.Observable.defer((function(){return i.updateResourceAttribute(e,t,I(n,r.tail))}))}))].concat(D(u?[E(n,u,i)]:[])))}(e,t,r,(0,k.s)(c),n,u):J(e,t,r,n,u)})).catch((function(o){return J(e,t,r,n,u,o)}))}(t,e,a[e],n,l)})))):o.Observable.of([])).switchMap((function(){return n?o.Observable.defer((function(){return function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w.A;return N(e,(function(e){return!c()(Object.keys(t),e)})).switchMap((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 0===e.length?o.Observable.of([]):o.Observable.forkJoin(e.map((function(e){return E(e,r,n)})))}))}(t,a,n,l)})):o.Observable.of(-1)})),o.Observable.defer((function(){return Promise.all((s||[]).map((function(e){var r=e.tag;return"link"===e.action?l.linkTagToResource(r.id,t):l.unlinkTagFromResource(r.id,t)})))})).switchMap((function(){return o.Observable.of(-1)}))]).map((function(){return t}))},z=function(e){var t=e.id,r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).deleteLinkedResources,n=void 0===r||r,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.A;return(n?N(t,(function(){return!0}),u):o.Observable.of([])).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return o.Observable.forkJoin([t].concat(D(e)).map((function(e){return u.deleteResource(e)})))}))},H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.A;return o.Observable.defer((function(){return r.searchListByAttributes(e,t)})).switchMap((function(e){if(!e||!y()(e,"ExtResourceList.Resource"))return o.Observable.of({results:[],totalCount:0});var n=y()(e,"ExtResourceList.Resource",[]),u=(d()(n)?n:[n]).map((function(e){return M(M({},b()(e,"Attributes")),{},{attributes:(t=e,r=y()(t,"Attributes.attribute"),n=d()(r)&&r||g()(r)&&[r],n&&n.reduce((function(e,t){return M(M({},e),{},C({},t.name,t.value))}),{})||{})});var t,r,n}));return(t.withPermissions?o.Observable.forkJoin(u.map((function(e){return o.Observable.defer((function(){return r.getResourcePermissions(e.id,{},!0)})).map((function(t){return M(M({},e),{},{permissions:t})}))}))):o.Observable.of(u)).map((function(t){return{results:t,totalCount:y()(e,"ExtResourceList.ResourceCount")}}))}))},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.name,n=e.value,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.A;return o.Observable.defer((function(){return u.updateResourceAttribute(t,r,n)})).switchMap((function(){return o.Observable.of(t)}))},Y=r(779893),G={geostore:n},K=function(e,t){G[e]=t},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"geostore";L.api=e},W=function(){var e;return(e=L.getApi()).getResource.apply(e,arguments)},X=function(){var e;return(e=L.getApi()).createResource.apply(e,arguments)},ee=function(){var e;return(e=L.getApi()).createCategory.apply(e,arguments)},te=function(){var e;return(e=L.getApi()).getResources.apply(e,arguments)},re=function(){var e;return(e=L.getApi()).updateResource.apply(e,arguments)},ne=function(){var e;return(e=L.getApi()).updateResourceAttribute.apply(e,arguments)},oe=function(){var e;return(e=L.getApi()).deleteResource.apply(e,arguments)};L={api:"geostore",addApi:K,setApi:V,getApi:function(){return G[Y.Ay.getConfigProp("persistenceApi")||L.api]},getResource:W,getResourceIdByName:function(){var e;return(e=L.getApi()).getResourceIdByName.apply(e,arguments)},getResourceDataByName:function(){var e;return(e=L.getApi()).getResourceDataByName.apply(e,arguments)},createResource:X,createCategory:ee,getResources:te,updateResource:re,updateResourceAttribute:ne,deleteResource:oe,searchListByAttributes:function(){var e;return(e=L.getApi()).searchListByAttributes.apply(e,arguments)}};const ue=/^(45562|95947)$/.test(r.j)?L:null},496463:(e,t,r)=>{r.d(t,{s:()=>o});var n=/rest\/geostore\/data\/(\d+)/,o=function(e){var t=decodeURIComponent(decodeURIComponent(e)),r=n.exec(t);return r&&!!r[0]&&r[1]}}}]);