"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[6915],{396915(t,i,e){e.d(i,{parsePGM:()=>a});const o=[9,-18,-88,0,96,90,0,0,-60,-20,-9,18,8,0,-96,30,0,0,60,-20,9,-88,-18,90,96,0,-20,-60,0,0,186,-42,-42,-150,-96,-150,60,60,60,60,54,162,-78,30,-24,-90,-60,60,-60,60,-9,-32,18,30,24,0,20,-60,0,0,-9,8,18,30,-96,0,-20,60,0,0,54,-78,162,-90,-24,30,60,-60,60,-60,-54,78,78,90,144,90,-60,-60,-60,-60,9,-8,-18,-30,-24,0,20,60,0,0,-9,18,-32,0,24,30,0,0,-60,20,9,-18,-8,0,-24,-30,0,0,60,20],s=[0,0,-131,0,138,144,0,0,-102,-31,0,0,7,0,-138,42,0,0,102,-31,62,0,-31,0,0,-62,0,0,0,31,124,0,-62,0,0,-124,0,0,0,62,124,0,-62,0,0,-124,0,0,0,62,62,0,-31,0,0,-62,0,0,0,31,0,0,45,0,-183,-9,0,93,18,0,0,0,216,0,33,87,0,-93,12,-93,0,0,156,0,153,99,0,-93,-12,-93,0,0,-45,0,-3,9,0,93,-18,0,0,0,-55,0,48,42,0,0,-84,31,0,0,-7,0,-48,-42,0,0,84,31],r=[18,-36,-122,0,120,135,0,0,-84,-31,-18,36,-2,0,-120,51,0,0,84,-31,36,-165,-27,93,147,-9,0,-93,18,0,210,45,-111,-93,-57,-192,0,93,12,93,162,141,-75,-93,-129,-180,0,93,-12,93,-36,-21,27,93,39,9,0,-93,-18,0,0,0,62,0,0,31,0,0,0,-31,0,0,124,0,0,62,0,0,0,-62,0,0,124,0,0,62,0,0,0,-62,0,0,62,0,0,31,0,0,0,-31,-18,36,-64,0,66,51,0,0,-102,31,18,-36,2,0,-66,-51,0,0,102,31];class n{constructor(t){this._v00=0,this._v01=0,this._v10=0,this._v11=0,this._t=[],this.options=t,this._ix=this.options._width,this._iy=this.options._height}getHeight(t,i){if(t=Math.abs(t)>90?NaN:t,isNaN(t)||isNaN(i))return NaN;const e=function(t,i){let e=h(t,i=Math.abs(i));return 2*Math.abs(e)===i?e-=h(t,2*i)-e:2*Math.abs(e)>i&&(e+=e<0?i:-i),e}(i,360);let n=(i=-180!==e?e:180)*this.options._rlonres,a=-t*this.options._rlatres,l=Math.floor(n),_=Math.min(Math.round((this.options._height-1)/2-1),Math.floor(a));n-=l,a-=_,_+=(this.options._height-1)/2,l+=l<0?this.options._width:l>=this.options._width?-this.options._width:0;let f=0,d=0,w=0,c=0,p=new Array(10);if(l!==this._ix||_!==this._iy)if(this.options.cubic){const t=[this._rawval(l,_-1),this._rawval(l+1,_-1),this._rawval(l-1,_),this._rawval(l,_),this._rawval(l+1,_),this._rawval(l+2,_),this._rawval(l-1,_+1),this._rawval(l,_+1),this._rawval(l+1,_+1),this._rawval(l+2,_+1),this._rawval(l,_+2),this._rawval(l+1,_+2)];let i=s;0!==_&&(i=_===this.options._height-2?r:o);let e=372;0!==_&&(e=_===this.options._height-2?372:240);for(let o=0;o<10;++o){p[o]=0;for(let e=0;e<12;++e)p[o]+=t[e]*i[10*e+o];p[o]/=e}}else f=this._rawval(l,_),d=this._rawval(l+1,_),w=this._rawval(l,_+1),c=this._rawval(l+1,_+1);else this.options.cubic?p=this._t:(f=this._v00,d=this._v01,w=this._v10,c=this._v11);if(!this.options.cubic){const t=(1-a)*((1-n)*f+n*d)+a*((1-n)*w+n*c),i=this.options._offset+this.options._scale*t;return this._ix=l,this._iy=_,this._v00=f,this._v01=d,this._v10=w,this._v11=c,i}let u=p[0]+n*(p[1]+n*(p[3]+n*p[6]))+a*(p[2]+n*(p[4]+n*p[7])+a*(p[5]+n*p[8]+a*p[9]));return u=this.options._offset+this.options._scale*u,this._ix=l,this._iy=_,this._t=p,u}_rawval(t,i){t<0?t+=this.options._width:t>=this.options._width&&(t-=this.options._width),(i<0||i>=this.options._height)&&(i=i<0?-i:2*(this.options._height-1)-i,t+=(t<this.options._width/2?1:-1)*this.options._width/2);const e=this.options._datastart+2*(i*this.options._swidth+t);return this.options.data[e]<<8|this.options.data[e+1]}}function h(t,i){return t-Math.floor(t/i)*i}function a(t,i){const e=function*(t){let i=0;do{const e=t.indexOf(10,i);if(-1!==e){const o=t.subarray(i,e);i=e+1,yield{offset:i,line:l(o)}}else{const e=t.subarray(i,t.length);i=t.length,yield{offset:i,line:l(e)}}}while(i<t.length);return{offset:i,line:""}}(t);let o=e.next();if(o.done||"P5"!==o.value.line)throw new Error("Geoid model file: File not in PGM format");let s=Number.MAX_VALUE,r=0,h=-1,a=-1,_="NONE",f="UNKNOWN",d=0,w=0,c=null,p=null;do{o=e.next();const t=o.value.line;if(t.length){if("#"!==t[0]){let i=t.split(" ");if(i=i.filter(t=>""!==t),d=parseInt(i[0],10),w=parseInt(i[1],10),!d||!w)throw new Error("Geoid model file: Error reading raster size");break}{const e=t.split(" "),o=e[0],n=e[1];if("#"!==o||!n)continue;const l=e.length>2?e.slice(2):[];if("Description"===n)_=l.join(" ");else if("DateTime"===n)f=l.join(" ");else if("Offset"===n){if(!e[2])throw new Error("Geoid model file: Error reading offset");s=parseInt(e[2],10)}else if("Scale"===n){if(!e[2])throw new Error("Geoid model file: Error reading scale");r=parseFloat(e[2])}else n===(i.cubic?"MaxCubicError":"MaxBilinearError")?isFinite(parseFloat(e[2]))&&(h=parseFloat(e[2])):n===(i.cubic?"RMSCubicError":"RMSBilinearError")&&isFinite(parseFloat(e[2]))&&(a=parseFloat(e[2]))}}}while(!o.done);o=e.next();const u=parseInt(o.value.line,10);if(o.done)throw new Error("Geoid model file: Error reading maxval");if(65535!==u)throw new Error("Geoid model file: Incorrect value of maxval");if(c=o.value.offset,p=d,s===Number.MAX_VALUE)throw new Error("Geoid model file: Offset not set");if(0===r)throw new Error("Geoid model file: Scale not set");if(r<0)throw new Error("Geoid model file: Scale must be positive");if(w<2||d<2)throw new Error("Geoid model file: Raster size too small");if(1&d)throw new Error("Geoid model file: Raster width is odd");if(!(1&w))throw new Error("Geoid model file: Raster height is even");const v=d/360,m=(w-1)/180;return new n({cubic:i.cubic,_width:d,_height:w,_rlonres:v,_rlatres:m,_offset:s,_scale:r,_swidth:p,_datastart:c,_maxerror:h,_rmserror:a,_description:_,_datetime:f,data:t})}function l(t){let i="";for(const e of t)i+=String.fromCharCode(e);return i}}}]);