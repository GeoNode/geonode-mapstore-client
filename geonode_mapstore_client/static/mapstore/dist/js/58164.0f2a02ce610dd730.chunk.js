"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[58164],{290505:(e,t,r)=>{r.d(t,{R:()=>c});var n=r(150802),o=r(323111),i=r(839545),l=r(764932);function a(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var s=function(e){return["centerPoint","lineToArc","startPoint","endPoint"].includes(null==e?void 0:e.name)},c={cesium:function(e){var t=e.Cesium,r=function(e){if(null!=e&&e.positions)return{type:e.geometry.type,positions:null==e?void 0:e.positions[0]};var r=("Polygon"===e.geometry.type?e.geometry.coordinates[0]:e.geometry.coordinates).map((function(e){return t.Cartesian3.fromDegrees(e[0],e[1],e[2])}));return{type:e.geometry.type,positions:r}},n={centerPoint:function(e){var n,o=r(e),l=o.positions,s=o.type,c=l.map((function(e){var r=t.Cartographic.fromCartesian(e),n=r.longitude,o=r.latitude,i=r.height;return[t.Math.toDegrees(n),t.Math.toDegrees(o),i]}));if("LineString"===s){var y=l.reduce((function(e,r,n){return l[n+1]?e+t.Cartesian3.distance(r,l[n+1]):e}),0)/2,g=c.map((function(e,r){var n=l.filter((function(e,t){return t<r+1}));return[e[0],e[1],e[2],n.reduce((function(e,r,o){return n[o+1]?e+t.Cartesian3.distance(r,n[o+1]):e}),0)]})),f=g.find((function(e){return e[3]>y})),m=g.indexOf(f)-1,p=g[m],h=y-p[3],d=t.Cartographic.toCartesian(t.Cartographic.fromDegrees(p[0],p[1],p[2])),v=t.Cartesian3.normalize(t.Cartesian3.subtract(t.Cartographic.toCartesian(t.Cartographic.fromDegrees(f[0],f[1],f[2])),d,new t.Cartesian3),new t.Cartesian3);return{position:t.Cartesian3.add(d,t.Cartesian3.multiplyByScalar(v,h,new t.Cartesian3),new t.Cartesian3)}}var S,b=((0,i.A)({type:"Polygon",coordinates:[[].concat((S=c,function(e){if(Array.isArray(e))return u(e)}(S)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(S)||a(S)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[c[0]])]})||{}).geometry,O=c.reduce((function(e,t){return e+function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,l,a=[],u=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(a.push(n.value),a.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(s)throw o}}return a}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,3)[2]}),0)/c.length,C=[b.coordinates[0],b.coordinates[1],O]||0;return{position:t.Cartographic.toCartesian((n=t.Cartographic).fromDegrees.apply(n,C))}},lineToArc:function(){return{arcType:t.ArcType.GEODESIC,perPositionHeight:void 0}},startPoint:function(e){return{position:r(e).positions[0].clone()}},endPoint:function(e){var t=r(e).positions;return{position:t["Polygon"===e.geometry.type?t.length-2:t.length-1].clone()}}};return function(e){var t=e.msGeometry;return s(t)&&n[null==t?void 0:t.name]?n[t.name]:null}},openlayers:function(e){var t=e.Point,r=e.LineString,i=e.Polygon,a=e.GeoJSON,u=e.getCenter,c=new a,y={centerPoint:function(e){return function(r){var i=r.getGeometry().getType();if(["Point","MultiPoint"].includes(i))return r.getGeometry();var a=e?e.getView().getProjection().getCode():"EPSG:3857",s=r.getGeometry();if(["LineString"].includes(i)){var y=JSON.parse(c.writeFeature(r,{dataProjection:"EPSG:4326",featureProjection:a})),g=(0,n.A)(y)/2,f=(0,o.A)(y,g),m=(0,l.reproject)(f.geometry.coordinates,"EPSG:4326",a);return new t([m.x,m.y])}var p=s.getExtent(),h=u(p);return new t(h)}},lineToArc:function(e){return function(t){var n=e?e.getView().getProjection().getCode():"EPSG:3857",o=t.getGeometry().getType();if("LineString"===o||"MultiPoint"===o){var a=t.getGeometry().getCoordinates();return a=(0,l.transformLineToArcs)(a.map((function(e){var t=(0,l.reproject)(e,n,"EPSG:4326");return[t.x,t.y]}))),new r(a.map((function(e){var t=(0,l.reproject)(e,"EPSG:4326",n);return[t.x,t.y]})))}if("Polygon"===o){var u=t.getGeometry().getCoordinates()[0];return u=(0,l.transformLineToArcs)(u.map((function(e){var t=(0,l.reproject)(e,n,"EPSG:4326");return[t.x,t.y]}))),new i([u.map((function(e){var t=(0,l.reproject)(e,"EPSG:4326",n);return[t.x,t.y]}))])}return t.getGeometry()}},startPoint:function(){return function(e){var r=e.getGeometry(),n=r.getType();if(["Point","MultiPoint"].includes(n))return e.getGeometry();var o="Polygon"===n?r.getCoordinates()[0]:r.getCoordinates();return o.length>1?new t(o[0]):null}},endPoint:function(){return function(e){var r=e.getGeometry(),n=r.getType();if(["Point","MultiPoint"].includes(n))return e.getGeometry();var o="Polygon"===n?r.getCoordinates()[0]:r.getCoordinates();return new t(o.length>3?o[o.length-("Polygon"===n?2:1)]:o[o.length-1])}}};return function(e,t,r){var n,o=e.msGeometry;if(s(o)&&y[null==o?void 0:o.name])return{geometry:y[o.name](r)};var i=(null==t?void 0:t.getGeometry)&&(null==t||null===(n=t.getGeometry())||void 0===n?void 0:n.getType());return["Mark","Icon"].includes(e.kind)&&["LineString","MultiLineString","Polygon","MultiPolygon"].includes(i)?{geometry:y.centerPoint(r)}:null}},geojson:function(){var e={centerPoint:function(e){if(["LineString"].includes(e.geometry.type)){var t=(0,n.A)(e)/2;return(0,o.A)(e,t).geometry.coordinates}return(0,i.A)(e).geometry.coordinates},lineToArc:function(e){return"LineString"===e.geometry.type?(0,l.transformLineToArcs)(e.geometry.coordinates):"Polygon"===e.geometry.type?e.geometry.coordinates.map(l.transformLineToArcs):null},startPoint:function(e){return"Polygon"===e.geometry.type?e.geometry.coordinates[0][0]:"LineString"===e.geometry.type?e.geometry.coordinates[0]:null},endPoint:function(e){return"Polygon"===e.geometry.type?e.geometry.coordinates[0][e.geometry.coordinates[0].length-2]:"LineString"===e.geometry.type?e.geometry.coordinates[e.geometry.coordinates.length-1]:null}};return function(t){var r=t.msGeometry;return s(r)&&e[null==r?void 0:r.name]?e[r.name]:null}}}},458164:(e,t,r)=>{r.r(t),r.d(t,{OlStyleParser:()=>T,createGetImagesSrc:()=>j,default:()=>E});var n=r(706141),o=r(644294),i=r(429276),l=r(910940),a=r(200953),u=r(981426),s=r(927733),c=r(113628),y=r(55394),g=r(986936),f=r(508100),m=r(570915),p=r(611217),h=r(694974),d=r(887331),v=r(736128),S=r(934142),b=r(207434),O=r(992055),C=r(185015),P=r.n(C);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x(n.key),n)}}function A(e,t,r){return(t=x(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e){var t=function(e){if("object"!=w(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(t)?t:t+""}var I=r(290505).R.openlayers({Point:o.A,LineString:p.A,Polygon:S.Ay,GeoJSON:v.A,getCenter:m.q1}),j=function(){var e={};return function(t,r){return r?(e[r]||(e[r]=t.toDataURL()),e[r]):t.toDataURL()}},G=function(e){switch(e){case"top-left":return[0,0];case"top":return[.5,0];case"top-right":return[1,0];case"left":return[0,.5];case"center":default:return[.5,.5];case"right":return[1,.5];case"bottom-left":return[0,1];case"bottom":return[.5,1];case"bottom-right":return[1,1]}},L=function(e,t){var r=e,n=t;if((0,O.Ec)(r)&&(r=O.d6.evaluateStringFunction(r)),"string"!=typeof r)return null;if(r.startsWith("rgba("))return r;if(!/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(r))return null;var o=parseInt(r.slice(1,3),16),i=parseInt(r.slice(3,5),16),l=parseInt(r.slice(5,7),16);return(0,O.uR)(n)&&(n=O.d6.evaluateNumberFunction(n)),n<0&&(n=1),"rgba("+o+", "+i+", "+l+", "+n+")"},T=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),A(this,"unsupportedProperties",{Symbolizer:{MarkSymbolizer:{avoidEdges:"none",blur:"none",offsetAnchor:"none",pitchAlignment:"none",pitchScale:"none",visibility:"none"},FillSymbolizer:{antialias:"none",fillOpacity:{support:"none",info:"Use opacity instead."},visibility:"none"},IconSymbolizer:{allowOverlap:"none",anchor:"none",avoidEdges:"none",color:"none",haloBlur:"none",haloColor:"none",haloWidth:"none",keepUpright:"none",offsetAnchor:"none",size:{support:"partial",info:"Will set/get the width of the ol Icon."},optional:"none",padding:"none",pitchAlignment:"none",rotationAlignment:"none",textFit:"none",textFitPadding:"none",visibility:"none"},LineSymbolizer:{blur:"none",gapWidth:"none",gradient:"none",miterLimit:"none",roundLimit:"none",spacing:"none",visibility:"none",graphicFill:"none",graphicStroke:"none",perpendicularOffset:"none"},RasterSymbolizer:"none"},Function:{double2bool:{support:"none",info:"Always returns false"},atan2:{support:"none",info:"Currently returns the first argument"},rint:{support:"none",info:"Currently returns the first argument"},numberFormat:{support:"none",info:"Currently returns the first argument"},strAbbreviate:{support:"none",info:"Currently returns the first argument"}}}),A(this,"title","OpenLayers Style Parser"),A(this,"olIconStyleCache",{}),A(this,"OlStyleConstructor",i.Ay),A(this,"OlStyleImageConstructor",l.A),A(this,"OlStyleFillConstructor",c.A),A(this,"OlStyleStrokeConstructor",a.A),A(this,"OlStyleTextConstructor",u.A),A(this,"OlStyleCircleConstructor",s.A),A(this,"OlStyleIconConstructor",y.A),A(this,"OlStyleRegularshapeConstructor",g.A),A(this,"isOlParserStyleFct",(function(e){return"function"==typeof e})),t&&(this.OlStyleConstructor=t.style.Style,this.OlStyleImageConstructor=t.style.Image,this.OlStyleFillConstructor=t.style.Fill,this.OlStyleStrokeConstructor=t.style.Stroke,this.OlStyleTextConstructor=t.style.Text,this.OlStyleCircleConstructor=t.style.Circle,this.OlStyleIconConstructor=t.style.Icon,this.OlStyleRegularshapeConstructor=t.style.RegularShape)},t=[{key:"readStyle",value:function(){return new Promise((function(e,t){try{e(null)}catch(e){t(e)}}))}},{key:"writeStyle",value:function(e){var t=this;return new Promise((function(r){var n=t.checkForUnsupportedProperties(e);try{r(t.getOlStyleTypeFromGeoStylerStyle(e),{unsupportedProperties:n,warnings:n&&["Your style contains unsupportedProperties!"]})}catch(e){r({errors:[e]})}}))}},{key:"checkForUnsupportedProperties",value:function(e){var t,r=this,n={};return null==e||null===(t=e.rules)||void 0===t||t.forEach((function(e){e.symbolizers.forEach((function(e){var t,o,i=(o="".concat(e.kind,"Symbolizer"))[0].toUpperCase()+o.slice(1),l=null===(t=r.unsupportedProperties)||void 0===t||null===(t=t.Symbolizer)||void 0===t?void 0:t[i];l&&("string"==typeof l||l instanceof String?(n.Symbolizer||(n.Symbolizer={}),n.Symbolizer[i]=l):Object.keys(e).forEach((function(e){l[e]&&(n.Symbolizer||(n.Symbolizer={}),n.Symbolizer[i]||(n.Symbolizer[i]={}),n.Symbolizer[i][e]=l[e])})))}))})),Object.keys(n).length>0?n:null}},{key:"getOlStyleTypeFromGeoStylerStyle",value:function(e){return this.geoStylerStyleToOlParserStyleFct(e)}},{key:"geoStylerStyleToOlParserStyleFct",value:function(e){var t=this,r=e.rules,n=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n.map,i=n.features;return(0,O.Jr)(e,{features:i}).then((function(e){return t._getImages=function(){return e},t._getImageSrc=j(),t._computeIconScaleBasedOnSymbolizer=function(t,r){var n=e.find((function(e){return e.id===(0,O.RU)(t,r)}))||{},o=n.image,i=n.width,l=n.height;if(o&&i&&l){var a=i>l?i:l;return t.size/a}return t.size},function(e,n){t._getMap=function(){return o};var i=[],l=o?o.getView().getProjection().getUnits():"m",a=f.I[l],u=n*a*39.37*(25.4/.28);return r.forEach((function(r){var o,l,a=null==r||null===(o=r.scaleDenominator)||void 0===o?void 0:o.min,s=null==r||null===(l=r.scaleDenominator)||void 0===l?void 0:l.max,c=!0;(a||s)&&(a=(0,O.Le)(a)?O.d6.evaluateNumberFunction(a):a,s=(0,O.Le)(s)?O.d6.evaluateNumberFunction(s):s,a&&u<a&&(c=!1),s&&u>=s&&(c=!1));var y=!1;if(r.filter)try{y=(0,O.Cx)(e,r.filter)}catch(e){y=!1}else y=!0;c&&y&&r.symbolizers.forEach((function(r){var o=t.getOlSymbolizerFromSymbolizer(r,e);if("function"!=typeof o)i.push(o);else{var l=o(e,n);i.push(l)}}))})),i}}))};return n.__geoStylerStyle=e,n}},{key:"getOlSymbolizerFromSymbolizer",value:function(e,t){var r;switch(e.kind){case"Mark":r=this.getOlPointSymbolizerFromMarkSymbolizer(e,t);break;case"Icon":r=this.getOlIconSymbolizerFromIconSymbolizer(e,t);break;case"Text":r=this.getOlTextSymbolizerFromTextSymbolizer(e,t);break;case"Line":r=this.getOlLineSymbolizerFromLineSymbolizer(e,t);break;case"Fill":r=this.getOlPolygonSymbolizerFromFillSymbolizer(e,t);break;case"Circle":r=this.getOlCircleSymbolizerFromCircleSymbolizer(e,t);break;default:var n=new this.OlStyleFillConstructor({color:"rgba(255,255,255,0.4)"}),o=new this.OlStyleStrokeConstructor({color:"#3399CC",width:1.25});r=new this.OlStyleConstructor({image:new this.OlStyleCircleConstructor({fill:n,stroke:o,radius:5}),fill:n,stroke:o})}return r}},{key:"getOlPointSymbolizerFromMarkSymbolizer",value:function(e,t){for(var r=k({},e),n=0,o=Object.keys(r);n<o.length;n++){var i=o[n];(0,O.Le)(r[i])&&(r[i]=O.d6.evaluateFunction(r[i],t))}var l=I(r,t,this._getMap()),a=this._getImages(),u=(0,O.RU)(r,e),s=a.find((function(e){return e.id===u}))||{},c=s.image,y=s.width,g=s.height;if(c){var f,m,p=y>g?y:g,h=2*r.radius/p,d=null!==(f=null===(m=this._getImageSrc)||void 0===m?void 0:m.call(this,c,u))&&void 0!==f?f:c.toDataURL();return new this.OlStyleConstructor(k({image:new this.OlStyleIconConstructor({src:d,crossOrigin:"anonymous",opacity:1,scale:h,rotation:"number"==typeof r.rotate?r.rotate*Math.PI/180:void 0})},l))}return new this.OlStyleConstructor}},{key:"getOlIconSymbolizerFromIconSymbolizer",value:function(e,t){for(var r=this,n=k({},e),o=0,i=Object.keys(n);o<i.length;o++){var l=i[o];(0,O.Le)(n[l])&&(n[l]=O.d6.evaluateFunction(n[l],t))}var a=I(n,t,this._getMap()),u={src:n.image,crossOrigin:"anonymous",opacity:n.opacity,scale:this._computeIconScaleBasedOnSymbolizer(n,e),rotation:"number"==typeof n.rotate?n.rotate*Math.PI/180:void 0,displacement:n.offset,anchor:G(n.anchor)},s=new RegExp("\\{\\{.*?\\}\\}","g");return"string"==typeof n.image&&n.image.match(s)?function(e){var t,o=(0,O.vK)(e,n.image,"");return o||(o=n.image+""),r.olIconStyleCache[o]?(t=r.olIconStyleCache[o],void 0!==u.rotation&&t.setRotation(u.rotation),void 0!==u.opacity&&t.setOpacity(u.opacity)):(t=new r.OlStyleIconConstructor(k(k({},u),{},{src:o})),r.olIconStyleCache[o]=t),new r.OlStyleConstructor(k({image:t},a))}:new this.OlStyleConstructor(k({image:new this.OlStyleIconConstructor(k({},u))},a))}},{key:"getOlLineSymbolizerFromLineSymbolizer",value:function(e,t){for(var r=k({},e),n=0,o=Object.keys(r);n<o.length;n++){var i=o[n];(0,O.Le)(r[i])&&(r[i]=O.d6.evaluateFunction(r[i],t))}var l=r.color,a=r.opacity,u=l&&null!=a?L(l,a):l,s=I(r,t,this._getMap());return new this.OlStyleConstructor(k(k({},s),{},{stroke:new this.OlStyleStrokeConstructor({color:u,width:r.width,lineCap:r.cap,lineJoin:r.join,lineDash:r.dasharray,lineDashOffset:r.dashOffset})}))}},{key:"getOlPolygonSymbolizerFromFillSymbolizer",value:function(e,t){for(var r,n=k({},e),o=0,i=Object.keys(n);o<i.length;o++){var l=i[o];(0,O.Le)(n[l])&&(n[l]=O.d6.evaluateFunction(n[l],t))}var a=I(n,t,this._getMap()),u=n.color,s=null!==(r=n.fillOpacity)&&void 0!==r?r:n.opacity,c=u&&Number.isFinite(s)?L(u,s):u,y=u?new this.OlStyleFillConstructor({color:c}):void 0,g=n.outlineColor,f=n.outlineOpacity,m=g&&Number.isFinite(f)?L(g,f):g,p=g||n.outlineWidth?new this.OlStyleStrokeConstructor({color:m,width:n.outlineWidth,lineDash:n.outlineDasharray}):void 0,h=new this.OlStyleConstructor(k(k({},a),{},{fill:y,stroke:p}));if(n.graphicFill){var d=this.getOlPatternFromGraphicFill(n.graphicFill);y||(y=new this.OlStyleFillConstructor({})),d&&y.setColor(d),h.setFill(y)}return h}},{key:"getOlCircleSymbolizerFromCircleSymbolizer",value:function(e,t){for(var r=this,n=k({},e),o=0,i=Object.keys(n);o<i.length;o++){var l=i[o];(0,O.Le)(n[l])&&(n[l]=O.d6.evaluateFunction(n[l],t))}var a=n.color,u=n.opacity,s=a&&Number.isFinite(u)?L(a,u):a,c=a?new this.OlStyleFillConstructor({color:s}):void 0,y=n.outlineColor,g=n.outlineOpacity,m=y&&Number.isFinite(g)?L(y,g):y,p=y||n.outlineWidth?new this.OlStyleStrokeConstructor({color:m,width:n.outlineWidth,lineDash:n.outlineDasharray}):void 0,d=new this.OlStyleConstructor({fill:c,stroke:p,geometry:function(e){var t=r._getMap();if(n.geodesic){var o=t.getView().getProjection().getCode(),i=(0,b.pd)(e.getGeometry().getCoordinates(),o,"EPSG:4326"),l=(0,S.kj)(i,n.radius,128);return l.transform("EPSG:4326",o),new S.Ay(l.getCoordinates())}return new h.A(e.getGeometry().getCoordinates(),n.radius/f.I[t.getView().getProjection().getUnits()])}});if(n.graphicFill){var v=this.getOlPatternFromGraphicFill(n.graphicFill);c||(c=new this.OlStyleFillConstructor({})),v&&c.setColor(v),d.setFill(c)}return d}},{key:"getOlPatternFromGraphicFill",value:function(e){var t;if("Icon"===(null==e?void 0:e.kind)){var r,i=null===(r=t=this.getOlIconSymbolizerFromIconSymbolizer(e))||void 0===r?void 0:r.getImage();if(null==i||i.load(),(null==i?void 0:i.getImageState())!==n.A.LOADED)return null}else{if("Mark"!==(null==e?void 0:e.kind)||!P()(null==e?void 0:e.wellKnownName))return null;t=this.getOlPointSymbolizerFromMarkSymbolizer(e)}var l=t.clone(),a=l.getImage(),u=document.createElement("canvas"),s=u.getContext("2d"),c=a.getScale()||1;a.setScale(1);var y=a.getSize(),g=(0,d.J7)(s,{pixelRatio:c,size:y});g.setStyle(l);var f=y.map((function(e){return e/2}));return g.drawGeometry(new o.A(f)),s.createPattern(u,"repeat")}},{key:"getOlTextSymbolizerFromTextSymbolizer",value:function(e,t){for(var r,n,o=this,i=k({},e),l=0,a=Object.keys(i);l<a.length;l++){var u=a[l];(0,O.Le)(i[u])&&(i[u]=O.d6.evaluateFunction(i[u],t))}var s,c=I(i,t,this._getMap()),y=i.color,g=i.opacity,f=y&&Number.isFinite(g)?L(y,g):y,m=i.haloColor,p=i.haloWidth,h=m&&Number.isFinite(g)?L(m,g):m,d=null!==(r=i.fontWeight)&&void 0!==r?r:"normal",v=null!==(n=i.fontStyle)&&void 0!==n?n:"normal",S=i.size,b=i.font,C=k({font:d+" "+v+" "+S+"px "+(null==b?void 0:b.join(", ")),fill:new this.OlStyleFillConstructor({color:f}),stroke:new this.OlStyleStrokeConstructor({color:h,width:p||0}),overflow:i.allowOverlap,offsetX:i.offset?i.offset[0]:0,offsetY:i.offset?i.offset[1]:0,rotation:"number"==typeof i.rotate?i.rotate*Math.PI/180:void 0},function(e){switch(e){case"top-left":return{textBaseline:"top",textAlign:"left"};case"top":default:return{textBaseline:"top",textAlign:"center"};case"top-right":return{textBaseline:"top",textAlign:"right"};case"left":return{textBaseline:"middle",textAlign:"left"};case"center":return{textBaseline:"middle",textAlign:"center"};case"right":return{textBaseline:"middle",textAlign:"right"};case"bottom-left":return{textBaseline:"bottom",textAlign:"left"};case"bottom":return{textBaseline:"bottom",textAlign:"center"};case"bottom-right":return{textBaseline:"bottom",textAlign:"right"}}}(i.anchor)),P=new RegExp("\\{\\{.*?\\}\\}","g");return(0,O.Ec)(i.label)||(s=i.label?i.label.match(P):null),s?function(e){var t=new o.OlStyleTextConstructor(k({text:(0,O.vK)(e,i.label,"")},C));return new o.OlStyleConstructor(k(k({},c),{},{text:t}))}:new this.OlStyleConstructor(k(k({},c),{},{text:new this.OlStyleTextConstructor(k({text:i.label},C))}))}}],t&&z(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();A(T,"title","OpenLayers Style Parser");const E=T}}]);