"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[1924],{866875:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(273517),o=n.n(r);function i(e){var t=e.text,n=e.className,r=void 0===n?"":n,i=e.style;return o().createElement("div",{className:"gn-main-event-container".concat(r?" ".concat(r):""),style:i},o().createElement("div",{className:"gn-main-event-content"},o().createElement("div",{className:"gn-main-loader"}),o().createElement("div",{className:"gn-main-event-text"},t)))}i.defaultProps={text:""};const a=i},131924:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var r=n(273517),o=n.n(r),i=n(475223),a=n(358132),l=n(444003),c=n(839545),s=n(68982),u=n(6683),f=n(697422),d=n(86881),m=n(433235),p=n(41476),y=n(149785),v=n(866875);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){E(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function E(e,t,n){return(t=function(e){var t=function(e){if("object"!=b(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},O(e,t)}function w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(w=function(){return!!e})()}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(e,t)||S(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){if(e){if("string"==typeof e)return j(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var P=(0,a.A)(i.A);P.displayName="Map";var I={gltf:function(e){var t=e.feature,n=e.url;return Promise.resolve({type:"vector",visibility:!0,features:[t],style:{format:"geostyler",body:{name:"",rules:[{name:"",symbolizers:[{kind:"Model",model:n}]}]}}})},ifc:function(e){var t=e.feature,n=e.url;return(0,s.Fu)(n).then(function(e){return{type:"model",visibility:!0,url:n,features:[t],capabilities:e}})}},k={gltf:function(e){var t=e.map,n=e.setLoading;return(0,r.useEffect)(function(){t.scene.globe.depthTestAgainstTerrain=!1,t.scene.screenSpaceCameraController.enableCollisionDetection=!1;var e=t.dataSources.get(0),r=function(){e.entities.values[0]&&(t.flyTo(e.entities.values[0],{duration:0}),n(!1))};return e.entities.collectionChanged.addEventListener(r),function(){e.entities.collectionChanged.removeEventListener(r)}},[]),null},ifc:function(e){var t=e.map,n=e.setLoading,i=e.container,a=e.center,l=e.layer,c=A((0,r.useState)({}),2),s=c[0],v=c[1],b=null==i?void 0:i.getBoundingClientRect();return(0,r.useEffect)(function(){var e,r=(((null==l?void 0:l.capabilities)||{}).properties||{}).size,o=void 0===r?[100,100,100]:r,i=A((null==a||null===(e=a.geometry)||void 0===e?void 0:e.coordinates)||[0,0],2),c=i[0],s=i[1],d=f.A.fromDegrees((c||0)-o[0]/2/u.Ig.degrees,(s||0)-o[1]/2/u.Ig.degrees,(c||0)+o[0]/2/u.Ig.degrees,(s||0)+o[1]/2/u.Ig.degrees);t.camera.setView({destination:d}),n(!1)},[l]),(0,r.useEffect)(function(){var e,n=new d.A(t.scene.canvas);return n.setInputAction(function(n){var r,o=t.scene.pick(n.endPosition);v({}),e&&(e.primitive.getGeometryInstanceAttributes(e.id).color=m.A.toValue(function(e,t,n){if(w())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return n&&O(o,n.prototype),o}(p.A,function(e){if(Array.isArray(e))return j(e)}(r=e.color)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||S(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),e=void 0,t.scene.requestRender());var i=o||{},a=i.primitive,l=i.id;if(a&&a._msGetFeatureById){var c,s=a.getGeometryInstanceAttributes(l);e={id:l,color:[s.color[0]/255,s.color[1]/255,s.color[2]/255,s.color[3]/255],primitive:a},s.color=m.A.toValue(p.A.RED),t.scene.requestRender();var u=a._msGetFeatureById(l);v({x:n.endPosition.x,y:n.endPosition.y,properties:null==u||null===(c=u.feature)||void 0===c?void 0:c.properties})}},y.A.MOUSE_MOVE),function(){n.destroy()}},[]),null!=s&&s.properties?o().createElement("div",{className:"shadow gn-media-scene-3d-info gn-details-info-fields",style:h({position:"absolute",zIndex:10,padding:"0.25rem",pointerEvents:"none",maxWidth:3*b.width/2,wordBreak:"break-word",transition:"0.3s all",minWidth:300,userSelect:"none"},function(){if(b.width<768||b.height<768)return{left:0,top:0,transform:"translateX(1rem) translateY(1rem)"};var e=null==s?void 0:s.x,t=null==s?void 0:s.y,n=e>b.width/2?"translateX(calc(-100% - 1rem))":"translateX(1rem)",r=t>b.height/2?"translateY(calc(-100% - 1rem))":"translateY(1rem)";return{left:e,top:t,transform:"".concat(n," ").concat(r)}}())},o().createElement("div",{className:"gn-media-scene-3d-info-bg",style:{opacity:.85,position:"absolute",top:0,left:0,width:"100%",height:"100%"}}),Object.keys(s.properties).map(function(e){return o().createElement("div",{key:e,className:"gn-details-info-row"},o().createElement("div",{className:"gn-details-info-label",style:{width:(t=Object.keys(s.properties||{}).reduce(function(e,t){return e.length>t.length?e:t}),t.length?"".concat(.5*t.length,"rem"):"auto")}},e),o().createElement("div",{className:"gn-details-info-value",style:{maxWidth:"none"}},s.properties[e]));var t})):null}};const N=function(e){var t=e.src,n=e.mediaType,i=e.bboxPolygon,a=(0,r.useRef)(),s=A((0,r.useState)(!0),2),u=s[0],f=s[1],d=A((0,r.useState)(null),2),m=d[0],p=d[1],y=i?(0,c.A)(i):{type:"Feature",geometry:{type:"Point",coordinates:[0,0]},properties:{}},b=k[n];return(0,r.useEffect)(function(){I[n]&&I[n]({url:t,feature:y}).then(function(e){p(e)})},[n]),o().createElement("div",{ref:a,className:"gn-media-scene-3d"},m?o().createElement(P,{id:"gn-media-scene-3d-map",mapType:l.Av.CESIUM,map:{registerHooks:!1,projection:"EPSG:4326"},styleMap:{position:"absolute",width:"100%",height:"100%"},eventHandlers:{},layers:[m]},o().createElement(b,{src:t,center:y,container:a.current,setLoading:f,layer:m})):null,u?o().createElement(v.A,null):null)}}}]);