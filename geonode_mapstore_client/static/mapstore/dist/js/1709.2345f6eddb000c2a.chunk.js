(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[1709,76369],{116745:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var o,r=n(273517),i=n(151230);const s=function(e){var t=e.map,n=e.onBoxEnd,s=e.status;return(0,r.useEffect)(function(){"start"===s?(o=new i.A({condition:function(e){return e.originalEvent.altKey}}),t.addInteraction(o)):"end"===s&&t.removeInteraction(o)},[s]),(0,r.useEffect)(function(){o&&o.on("boxend",function(e){n({boxExtent:o.getGeometry().getExtent(),modifiers:{ctrl:e.mapBrowserEvent.originalEvent.ctrlKey,metaKey:e.mapBrowserEvent.originalEvent.metaKey}})})},[s]),null}},194166:(e,t,n)=>{"use strict";n.d(t,{A:()=>O});var o=n(273517),r=n.n(o),i=n(310340),s=n.n(i),a=n(605556),c=n.n(a),u=n(211795),l=n(185015),p=n.n(l),f=n(315211),d=n(520943);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function m(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,w(o.key),o)}}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(g=function(){return!!e})()}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}function P(e,t,n){return(t=w(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){var t=function(e){if("object"!=h(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==h(t)?t:t+""}var O=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return P(e=function(e,t,n){return t=v(t),function(e,t){if(t&&("object"==h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,g()?Reflect.construct(t,n||[],v(e).constructor):t.apply(e,n))}(this,t,[].concat(o)),"onPopupClose",function(t){e.props.onPopupClose(t)}),P(e,"renderPopups",function(){return e.preparePopups().map(function(t){var n,o=t.popup,i=t.id,a=t.component,c=t.content,u=t.props,l=t.containerStyle,h=o.getElement(),y=p()(a)&&d.default[a]||a;return y?n=r().isValidElement(y)&&y||r().createElement(y,u):c&&(n=f.AH(c)?r().createElement("div",{dangerouslySetInnerHTML:{__html:c}}):c),h&&s().createPortal(r().createElement("div",{className:"map-popup-ol",key:i,onMouseUp:e.convertToClick},r().createElement("div",{className:"ol-popup-content-wrapper"},r().createElement("div",{className:"ol-popup-content",style:l},n)),r().createElement("div",{className:"ol-popup-closer",onClick:function(){return e.onPopupClose(i)}},"x")),h)})}),P(e,"update",function(){(e._popups||[]).map(function(e){var t=e.popup;t.setElement(t.getElement())})}),P(e,"convertToClick",function(e){var t=new MouseEvent("click",{bubbles:!0});t.stopPropagation=function(){},e.target.dispatchEvent(t)}),P(e,"preparePopups",function(){var t=e.props,n=t.popups,o=void 0===n?[]:n,r=t.map,i=r.getSize();return(e._popups||[]).forEach(function(e){var t=e.popup,n=e.observer;n&&n.disconnect(),t&&r.removeOverlay(t)}),e._popups=o.map(function(e){var t=Math.round(.9*i[0])-40,n=Math.round(.9*i[1])-40,o=e.id,s=e.position.coordinates,a=e.className,c=e.maxWidth,l=void 0===c?t:c,p=e.maxHeight,d=void 0===p?n:p,h=e.autoPan,m=void 0!==h&&h,g=e.autoPanMargin,v=void 0===g?20:g,b=e.offset,w=void 0===b?[0,0]:b,O=e.autoPanAnimation,E=void 0===O?{duration:200}:O,S=l>t?t:l,j=d>n?n:d,A=f.g$(o,a),_=new u.A({id:o,element:A,autoPan:m,offset:w,autoPanMargin:v,autoPanAnimation:E,positioning:"bottom-center",className:"ol-overlay-container ol-unselectable",position:s});r.addOverlay(_);var C=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=new MutationObserver(function(){e.getMap().getSize()&&(e.setPosition(void 0),e.setPosition(n.coordinates))});return o.observe(t,{attributes:!0,childList:!0,subtree:!0}),o}(_,A,{coordinates:s});return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach(function(t){P(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({popup:_,observer:C,containerStyle:{maxWidth:S,maxHeight:j}},e)}),e._popups}),P(e,"stopPropagationOnPointerMove",function(e){e.stopPropagation()}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(t,e),n=t,(o=[{key:"UNSAFE_componentWillMount",value:function(){this.props.map&&this.props.map.getOverlayContainerStopEvent().addEventListener("pointermove",this.stopPropagationOnPointerMove)}},{key:"shouldComponentUpdate",value:function(e){return e.popups!==this.props.popups}},{key:"componentWillUnmount",value:function(){this.props.map&&this.props.map.getOverlayContainerStopEvent().removeEventListener("pointermove",this.stopPropagationOnPointerMove)}},{key:"render",value:function(){return r().createElement("div",null,this.renderPopups())}}])&&m(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o}(r().Component);P(O,"propTypes",{map:c().object,popups:c().arrayOf(c().object),onPopupClose:c().func}),P(O,"defaultProps",{popups:[],onPopupClose:function(){}})},520943:(e,t,n)=>{"use strict";n.r(t),n.d(t,{IDENTIFY_POPUP:()=>E,default:()=>S});var o=n(273517),r=n.n(o),i=n(764997),s=n(419862),a=n(916589),c=n(811668),u=n(801081),l=n(975699),p=n(812366),f=n(986446),d=n(956449),h=n.n(d),y=n(762216),m=n.n(y),g=n(737056),v=n(131127),b=n(185520),P=(0,a.compose)((0,c.connect)((0,u.Mz)(l.oO,function(e){return{index:e}}),{setIndex:p.yd}),(0,a.defaultProps)({index:0,responses:[]})),w=(0,u.Mz)([l.SL,l.mR,l.KB,l.P9,l.XJ,v.GY,l.SH,b.T],function(e,t,n,o,r,i,s,a){return{responses:e,validResponses:t,requests:n,format:o,showEmptyMessageGFI:r,missingResponses:(n||[]).length-(e||[]).length,renderValidOnly:i,loaded:s,hidePopupIfNoResults:a}});const O=(0,a.compose)((0,c.connect)(w),(0,a.defaultProps)({responses:[],container:function(e){var t=e.index,n=e.children;return r().createElement(r().Fragment,null,h()(n)&&n[t]||n)},header:g.A}),P,s.Bo,s.tq,(0,i.A)(function(e){var t=e.loaded;return m()(t)}))(f.A);var E="identify";const S={identify:O}},353858:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>U});var o=n(971481),r=n(954762),i=n(42811),s=n(868280),a=n(94584),c=n(173998),u=n(605556),l=n.n(u),p=n(273517),f=n.n(p),d=n(142770),h=n(958704),y=n(200953),m=n(113628),g=n(429276),v=n(927733);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach(function(t){A(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function O(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_(o.key),o)}}function E(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(E=function(){return!!e})()}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function A(e,t,n){return(t=_(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e){var t=function(e){if("object"!=b(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:t+""}var C=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return A(e=function(e,t,n){return t=S(t),function(e,t){if(t&&("object"==b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,E()?Reflect.construct(t,n||[],S(e).constructor):t.apply(e,n))}(this,t,[].concat(o)),"getLayer",function(){var t;return e.props.map.getLayers().forEach(function(n){e.layersFilter(n)&&(t=n)},e),t}),A(e,"setSelectInteraction",function(){e._selectInteraction.getActive()||e._selectInteraction.setActive(!0)}),A(e,"createSelectInteraction",function(){e.createStyle(),e._selectInteraction=new d.A({layers:e.layersFilter,style:e._style,toggleCondition:h.k5}),e._selectInteraction.on("select",e.selectionChange,e),e.props.map.addInteraction(e._selectInteraction)}),A(e,"selectionChange",function(){var t=[];e._selectInteraction.getFeatures().forEach(function(e){t.push(e.getId())}),e.props.updateHighlighted(t,"")}),A(e,"cleanSupport",function(){e._selectInteraction&&e._selectInteraction.getActive()&&(e._selectInteraction.getFeatures().clear(),e.props.updateHighlighted([],""),e._selectInteraction.setActive(!1))}),A(e,"layersFilter",function(t){return e.props.layer&&t.get("msId")===e.props.layer}),A(e,"createStyle",function(){var t=e.props.selectedStyle,n={stroke:new y.A(t.stroke?t.stroke:{color:"blue",width:1}),fill:new m.A(t.fill?t.fill:{color:"blue"})};"Point"===t.type&&(n={image:new v.A(w(w({},n),{},{radius:t.radius||5}))}),e._style=new g.Ay(n)}),A(e,"highlightFeatures",function(t){var n=e.getLayer(),o=e._selectInteraction.getFeatures();o.clear(),n&&n.getSource().getFeatures().map(function(e){-1!==t.indexOf(e.getId())&&o.push(e)},e)}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(t,e),n=t,(o=[{key:"componentDidMount",value:function(){this.createSelectInteraction(),"enabled"===this.props.status?this._selectInteraction.setActive(!0):this._selectInteraction.setActive(!1),this.props.features&&this.highlightFeatures(this.props.features)}},{key:"shouldComponentUpdate",value:function(e){var t=this.props;return e.status!==t.status||e.layer!==t.layer||"update"===e.status&&e.features.toString()!==t.features.toString()}},{key:"UNSAFE_componentWillUpdate",value:function(e){switch(e.status){case"enabled":this.setSelectInteraction(e);break;case"disabled":this.cleanSupport();break;case"update":this.highlightFeatures(e.features);break;default:return}}},{key:"componentWillUnmount",value:function(){this._selectInteraction&&(this.cleanSupport(),this._selectInteraction.un("select",this.selectionChange,this),this.props.map.removeInteraction(this._selectInteraction),this._selectInteraction=null,this._style=null)}},{key:"render",value:function(){return null}}])&&O(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o}(f().Component);A(C,"propTypes",{map:l().object,layer:l().string.isRequired,status:l().oneOf(["disabled","enabled","update"]),updateHighlighted:l().func,selectedStyle:l().object,features:l().array}),A(C,"contextTypes",{messages:l().object}),A(C,"defaultProps",{status:"disabled",updateHighlighted:function(){},selectedStyle:{type:"Point",radius:12,stroke:{width:4,color:"yellow"},fill:{color:"red"}}});var I=n(754602),k=n(712651),T=n(54620),x=n(36068);function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function D(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,B(o.key),o)}}function F(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(F=function(){return!!e})()}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}function R(e,t){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},R(e,t)}function N(e,t,n){return(t=B(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e){var t=function(e){if("object"!=M(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==M(t)?t:t+""}var H=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return N(e=function(e,t,n){return t=L(t),function(e,t){if(t&&("object"==M(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,F()?Reflect.construct(t,n||[],L(e).constructor):t.apply(e,n))}(this,t,[].concat(o)),"addDrawInteraction",function(t){e.drawInteraction&&e.removeDrawInteraction();var n=new I.A,o=new k.A({source:n,zIndex:1e6,style:new g.Ay({fill:new m.A({color:"rgba(255, 255, 255, 0.2)"}),stroke:new y.A({color:"#ffcc33",width:2}),image:new v.A({radius:7,fill:new m.A({color:"#ffcc33"})})})});e.props.map.addLayer(o);var r=new T.Ay({source:n,type:t.selection.geomType,style:new g.Ay({fill:new m.A({color:"rgba(255, 255, 255, 0.2)"}),stroke:new y.A({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new v.A({radius:5,stroke:new y.A({color:"rgba(0, 0, 0, 0.7)"}),fill:new m.A({color:"rgba(255, 255, 255, 0.2)"})})})});r.on("drawstart",function(t){e.sketchFeature=t.feature,n.clear()}),r.on("drawend",function(){e.updateSelectionState()}),e.props.map.addInteraction(r),e.drawInteraction=r,e.selectionLayer=o,e.setDoubleClickZoomEnabled(!1)}),N(e,"removeDrawInteraction",function(){null!==e.drawInteraction&&(e.props.map.removeInteraction(e.drawInteraction),e.drawInteraction=null,e.props.map.removeLayer(e.selectionLayer),e.sketchFeature=null,setTimeout(function(){return e.setDoubleClickZoomEnabled(!0)},251))}),N(e,"updateSelectionState",function(){if(e.sketchFeature){var t=e.sketchFeature.getGeometry().getCoordinates(),n={geomType:e.props.selection.geomType,point:"Point"===e.props.selection.geomType?[t[0],t[1]]:null,line:"LineString"===e.props.selection.geomType?t.map(function(e){return[e[0],e[1]]}):null,polygon:"Polygon"===e.props.selection.geomType?e.sketchFeature.getGeometry().getLinearRing(0).getCoordinates().map(function(e){return[e[0],e[1]]}):null};e.props.changeSelectionState(n)}}),N(e,"setDoubleClickZoomEnabled",function(t){for(var n=e.props.map.getInteractions(),o=0;o<n.getLength();o++){var r=n.item(o);if(r instanceof x.A){r.setActive(t);break}}}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(t,e),n=t,(o=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.selection.geomType&&e.selection.geomType!==this.props.selection.geomType&&this.addDrawInteraction(e),e.selection.geomType||this.removeDrawInteraction()}},{key:"render",value:function(){return null}}])&&D(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o}(f().Component);N(H,"propTypes",{map:l().object,projection:l().string,selection:l().object,changeSelectionState:l().func}),N(H,"defaultProps",{selection:{}});var K=n(194166),V=n(116745);const U={LMap:o.A,Layer:r.A,Feature:i.A,Overview:s.A,ScaleBar:a.A,DrawSupport:c.A,HighlightFeatureSupport:C,SelectionSupport:H,PopupSupport:K.A,BoxSelectionSupport:V.A}},315211:(e,t,n)=>{"use strict";n.d(t,{AH:()=>s,BC:()=>a,g$:()=>i});var o=n(668414),r=n.n(o),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r()(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ms-map-popup",n=document.createElement("div");return n.setAttribute("id",e+"-map-popup"),n.setAttribute("class",t),n},s=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").startsWith("<")},a=function(e,t){if(!t)return e;if(t instanceof Node){var n=document.createDocumentFragment();n.appendChild(t),e.appendChild(n)}else s(t)?e.innerHTML=t:e.append(document.createTextNode(String(t)));return e}},677126:e=>{var t=Array.prototype.reverse;e.exports=function(e){return null==e?e:t.call(e)}},722331:(e,t,n)=>{var o=n(587133),r=n(677556),i=n(761489),s=n(213222);e.exports=function(e,t,n){return e=s(e),n=null==n?0:o(i(n),0,e.length),t=r(t),e.slice(n,n+t.length)==t}},582585:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});const o={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"}},211795:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var o=n(234120),r=n(582585),i=n(25176),s=n(570915),a=n(209438),c=n(568711);const u="element",l="map",p="offset",f="position",d="positioning";class h extends o.A{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=void 0===e.insertFirst||e.insertFirst,this.stopEvent=void 0===e.stopEvent||e.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==e.className?e.className:"ol-overlay-container "+i.Q5,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=!0===e.autoPan?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(u,this.handleElementChanged),this.addChangeListener(l,this.handleMapChanged),this.addChangeListener(p,this.handleOffsetChanged),this.addChangeListener(f,this.handlePositionChanged),this.addChangeListener(d,this.handlePositioningChanged),void 0!==e.element&&this.setElement(e.element),this.setOffset(void 0!==e.offset?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),void 0!==e.position&&this.setPosition(e.position)}getElement(){return this.get(u)}getId(){return this.id}getMap(){return this.get(l)||null}getOffset(){return this.get(p)}getPosition(){return this.get(f)}getPositioning(){return this.get(d)}handleElementChanged(){(0,c.gS)(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&((0,c.bf)(this.element),(0,a.JH)(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=(0,a.KT)(e,r.A.POSTRENDER,this.render,this),this.updatePixelPosition();const t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(u,e)}setMap(e){this.set(l,e)}setOffset(e){this.set(p,e)}setPosition(e){this.set(f,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const t=this.getMap();if(!t||!t.getTargetElement()||!this.get(f))return;const n=this.getRect(t.getTargetElement(),t.getSize()),o=this.getElement(),r=this.getRect(o,[(0,c.Gq)(o),(0,c.DK)(o)]),i=void 0===(e=e||{}).margin?20:e.margin;if(!(0,s.ms)(n,r)){const o=r[0]-n[0],s=n[2]-r[2],a=r[1]-n[1],c=n[3]-r[3],u=[0,0];if(o<0?u[0]=o-i:s<0&&(u[0]=Math.abs(s)+i),a<0?u[1]=a-i:c<0&&(u[1]=Math.abs(c)+i),0!==u[0]||0!==u[1]){const n=t.getView().getCenterInternal(),o=t.getPixelFromCoordinateInternal(n);if(!o)return;const r=[o[0]+u[0],o[1]+u[1]],i=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(r),duration:i.duration,easing:i.easing})}}}getRect(e,t){const n=e.getBoundingClientRect(),o=n.left+window.pageXOffset,r=n.top+window.pageYOffset;return[o,r,o+t[0],r+t[1]]}setPositioning(e){this.set(d,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t)return void this.setVisible(!1);const n=e.getPixelFromCoordinate(t),o=e.getSize();this.updateRenderedPosition(n,o)}updateRenderedPosition(e,t){const n=this.element.style,o=this.getOffset(),r=this.getPositioning();this.setVisible(!0);let i="0%",s="0%";"bottom-right"==r||"center-right"==r||"top-right"==r?i="-100%":"bottom-center"!=r&&"center-center"!=r&&"top-center"!=r||(i="-50%"),"bottom-left"==r||"bottom-center"==r||"bottom-right"==r?s="-100%":"center-left"!=r&&"center-center"!=r&&"center-right"!=r||(s="-50%");const a=`translate(${i}, ${s}) translate(${Math.round(e[0]+o[0])+"px"}, ${Math.round(e[1]+o[1])+"px"})`;this.rendered.transform_!=a&&(this.rendered.transform_=a,n.transform=a)}getOptions(){return this.options}}const y=h}}]);