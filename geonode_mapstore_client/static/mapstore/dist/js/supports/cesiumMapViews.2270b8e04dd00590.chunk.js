"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[296],{793784:(e,n,t)=>{t.r(n),t.d(n,{default:()=>E});var r=t(273517),o=t(267980),i=t(336946),l=t(697422),a=t(766067),u=t(367817),c=t(493721),s=t(770103),f=t(465674),d=t(590108),A=t(15817),p=t(434067),g=t(337632),v=t(742558),y=t(290176),m=t(41476),h=t(457378),b=t(762222),w=t(731807);function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}var O=["center","cameraPosition"];function I(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return C(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?C(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function P(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function S(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?P(Object(t),!0).forEach(function(n){T(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function T(e,n,t){return(n=function(e){var n=function(e){if("object"!=D(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=D(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==D(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}const E=function(e){var n,t,D,C,P,T,E,N,R,_,j=e.map,L=e.selectedId,k=e.views,B=e.apiRef,x=void 0===B?function(){}:B,V=e.showViewsGeometries,z=e.showClipGeometries,F=e.resources,U=null==k?void 0:k.find(function(e){return e.id===L}),Q=(0,r.useRef)(),Y=(0,r.useRef)(),M=(0,r.useRef)(),G=(0,r.useRef)(),q=(0,r.useRef)();return(0,r.useEffect)(function(){var e={options:{settings:[w.Q_.DESCRIPTION,w.Q_.POSITION,w.Q_.ANIMATION,w.Q_.MASK,w.Q_.GLOBE_TRANSLUCENCY,w.Q_.LAYERS_OPTIONS],unsupportedLayers:[],showClipGeometriesEnabled:!0},getView:function(){var e=j.camera.positionCartographic,n=(0,w.JH)(e.height),t=j.camera.computeViewRectangle(j.scene.globe.ellipsoid,new l.A),r=j.scene.globe.pick(new a.A(j.camera.position,j.camera.direction),j.scene);r||(r=o.A.add(o.A.clone(j.camera.position),o.A.multiplyByScalar(o.A.clone(j.camera.direction),1e5,new o.A),new o.A));var c=i.A.fromCartesian(new o.A(r.x,r.y,r.z));return{zoom:n,center:{longitude:u.A.toDegrees(c.longitude),latitude:u.A.toDegrees(c.latitude),height:c.height},cameraPosition:{longitude:u.A.toDegrees(e.longitude),latitude:u.A.toDegrees(e.latitude),height:e.height},bbox:[u.A.toDegrees(t.west),u.A.toDegrees(t.south),u.A.toDegrees(t.east),u.A.toDegrees(t.north)]}},setView:function(e){var n=function(e,n){var t=n.center,r=n.cameraPosition,l=function(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],-1===n.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}(n,O);if(l.orientation&&l.position)return{destination:l.position,orientation:l.orientation};var a,u={position:o.A.clone(e.camera.position),orientation:{heading:e.camera.heading,pitch:e.camera.pitch,roll:e.camera.roll}},c=i.A.toCartesian(i.A.fromDegrees(t.longitude,t.latitude,t.height,new i.A)),s=i.A.toCartesian(i.A.fromDegrees(t.longitude,t.latitude,t.height+1,new i.A)),f=i.A.toCartesian(i.A.fromDegrees(r.longitude,r.latitude,r.height,new i.A)),d=i.A.toCartesian(i.A.fromDegrees(r.longitude,r.latitude,r.height+1,new i.A)),A=o.A.subtract(f,c,new o.A),p=o.A.subtract(s,c,new o.A),g=t.latitude>0&&Math.round((0,b.Lj)(A,p))<=5?o.A.subtract(f,d,new o.A):o.A.subtract(d,f,new o.A);a=o.A.subtract(c,f,new o.A),o.A.normalize(a,a),e.camera.setView({destination:f,orientation:{direction:a,up:g}}),e.camera.setView({destination:f,orientation:{direction:a,up:g}});var v={destination:{x:e.camera.position.x,y:e.camera.position.y,z:e.camera.position.z},orientation:{heading:e.camera.heading,pitch:e.camera.pitch,roll:e.camera.roll}};return e.camera.setView({destination:u.position,orientation:u.orientation}),v}(j,e),t=n.destination,r=n.orientation;j.camera.cancelFlight(),j.camera[e.flyTo?"flyTo":"setView"]({destination:t,orientation:r})},computeViewCoordinates:function(n,t){e.setView(S(S({},t),{},{flyTo:!1}));var r=j.camera.positionCartographic,o=(0,w.JH)(r.height),i=j.camera.computeViewRectangle(j.scene.globe.ellipsoid,new l.A);return S(S({},t),{},{zoom:o,bbox:[u.A.toDegrees(i.west),u.A.toDegrees(i.south),u.A.toDegrees(i.east),u.A.toDegrees(i.north)]})}};x(e)},[j]),(0,r.useEffect)(function(){return j&&(Q.current=new c.A({destroyPrimitives:!0}),j.scene.primitives.add(Q.current),Y.current=new s.A,j.scene.primitives.add(Y.current),M.current=new f.A,j.scene.primitives.add(M.current),G.current=(0,h.g7)(16,{stroke:"#ffffff",strokeWidth:2,fill:!1}),q.current=new d.A("clipGeometriesDataSource")),function(){null!=j&&j.isDestroyed&&!j.isDestroyed()&&((0,h.IP)(j,Q.current),Q.current=null,(0,h.IP)(j,Y.current),Y.current=null,(0,h.IP)(j,M.current),M.current=null)}},[j]),(0,r.useEffect)(function(){return(V||z)&&null!=j&&j.isDestroyed&&!j.isDestroyed()&&(null==k?void 0:k.length)>0&&(V&&k.forEach(function(e){var n=i.A.toCartesian(i.A.fromDegrees(e.cameraPosition.longitude,e.cameraPosition.latitude,e.cameraPosition.height)),t=i.A.toCartesian(i.A.fromDegrees(e.center.longitude,e.center.latitude,e.center.height)),r=e.id===L;Q.current.add((0,h.Qi)({color:r?"#ffcc33":"#ffffff",opacity:1,depthFailColor:"#000000",depthFailOpacity:0,width:1,dashLength:10,coordinates:[n,t]})),Y.current.add({position:n,image:G.current,color:(0,h.Oe)({color:r?"#ffcc33":"#ffffff"}),disableDepthTestDistance:Number.POSITIVE_INFINITY,allowPicking:!1}),M.current.add({position:n,text:e.title,font:"12px sans-serif",disableDepthTestDistance:Number.POSITIVE_INFINITY,fillColor:(0,h.Oe)({color:"#ffffff"}),outlineColor:(0,h.Oe)({color:"#000000"}),outlineWidth:4,style:A.A.FILL_AND_OUTLINE,showBackground:!1,backgroundPadding:new p.A(4,4),pixelOffset:new p.A(0,-16),horizontalOrigin:g.A.CENTER,verticalOrigin:v.A.BASELINE})}),z&&F.filter(function(e){var n,t=!(null==k||!k.find(function(n){var t,r;return(null==n||null===(t=n.terrain)||void 0===t?void 0:t.clippingLayerResourceId)===e.id||(null==n||null===(r=n.layers)||void 0===r?void 0:r.find(function(n){return(null==n?void 0:n.clippingLayerResourceId)===e.id}))}));return!(null==e||null===(n=e.data)||void 0===n||null===(n=n.collection)||void 0===n||!n.features||!t)}).forEach(function(e){(0,w.J1)(e.data.collection.features).forEach(function(e){Q.current.add((0,h.Qi)({color:"#ff0000",opacity:1,width:3,dashLength:10,clampToGround:!0,coordinates:o.A.fromDegreesArray(e.geometry.coordinates[0].reduce(function(e,n){return[].concat(I(e),I(n))},[]))})),M.current.add({position:o.A.fromDegreesArray(e.geometry.coordinates[0][0])[0],text:e.id,font:"12px sans-serif",disableDepthTestDistance:Number.POSITIVE_INFINITY,fillColor:(0,h.Oe)({color:"#ffffff"}),outlineColor:(0,h.Oe)({color:"#000000"}),outlineWidth:4,style:A.A.FILL_AND_OUTLINE,showBackground:!1,backgroundPadding:new p.A(4,4),pixelOffset:new p.A(0,-16),horizontalOrigin:g.A.CENTER,verticalOrigin:v.A.BASELINE})})}),j.scene.requestRender()),function(){var e,n,t;null!=j&&j.isDestroyed&&!j.isDestroyed()&&(null===(e=Q.current)||void 0===e||e.removeAll(),null===(n=Y.current)||void 0===n||n.removeAll(),null===(t=M.current)||void 0===t||t.removeAll(),j.scene.requestRender())}},[k,L,j,V,z,F]),(0,r.useEffect)(function(){var e,n,t,r,o,i,l=j.scene.globe,a=(U||{}).globeTranslucency,u=void 0===a?{}:a;l.translucency.frontFaceAlphaByDistance=new y.A(null!==(e=null==U||null===(n=U.globeTranslucency)||void 0===n?void 0:n.nearDistance)&&void 0!==e?e:w.BU.TRANSLUCENCY_NEAR_DISTANCE,0,null!==(t=null==U||null===(r=U.globeTranslucency)||void 0===r?void 0:r.farDistance)&&void 0!==t?t:w.BU.TRANSLUCENCY_FAR_DISTANCE,1);var c=null!==(o=null==u?void 0:u.opacity)&&void 0!==o?o:w.BU.TRANSLUCENCY_OPACITY;return l.translucency.enabled=null!==(i=null==u?void 0:u.enabled)&&void 0!==i&&i,l.translucency.frontFaceAlphaByDistance.nearValue=c,l.translucency.frontFaceAlphaByDistance.farValue=null!=u&&u.fadeByDistance?1:c,j.scene.requestRender(),function(){null!=j&&j.isDestroyed&&!j.isDestroyed()&&(l.translucency.enabled=!1)}},[null==U||null===(n=U.globeTranslucency)||void 0===n?void 0:n.enabled,null==U||null===(t=U.globeTranslucency)||void 0===t?void 0:t.fadeByDistance,null==U||null===(D=U.globeTranslucency)||void 0===D?void 0:D.nearDistance,null==U||null===(C=U.globeTranslucency)||void 0===C?void 0:C.farDistance,null==U||null===(P=U.globeTranslucency)||void 0===P?void 0:P.opacity]),(0,r.useEffect)(function(){var e,n=j.scene;return n.invertClassification=!(null==U||null===(e=U.mask)||void 0===e||!e.enabled),n.invertClassificationColor=new m.A(0,0,0,0),function(){null!=j&&j.isDestroyed&&!j.isDestroyed()&&(n.invertClassification=!1)}},[null==U||null===(T=U.mask)||void 0===T?void 0:T.enabled]),(0,r.useEffect)(function(){var e,n,t,r=j.scene.globe,o=null==F||null===(e=F.find(function(e){var n;return e.id===(null==U||null===(n=U.terrain)||void 0===n?void 0:n.clippingLayerResourceId)}))||void 0===e?void 0:e.data,i=null===(n=(0,w.J1)(null==o||null===(t=o.collection)||void 0===t?void 0:t.features))||void 0===n?void 0:n.find(function(e){var n;return e.id===(null==U||null===(n=U.terrain)||void 0===n?void 0:n.clippingPolygonFeatureId)});if(i){var l,a=(0,h.xX)(i);(0,h.gi)({target:r,polygons:a,inverse:!(null==U||null===(l=U.terrain)||void 0===l||!l.clippingPolygonUnion),scene:j.scene,additionalProperties:{backFaceCulling:!0,showSkirts:!0}})}else{var u;null==r||null===(u=r.clippingPolygons)||void 0===u||u.removeAll(),j.scene.requestRender()}return function(){var e;null!=j&&j.isDestroyed&&!j.isDestroyed()&&(null==r||null===(e=r.clippingPolygons)||void 0===e||e.removeAll(),j.scene.requestRender())}},[null==U||null===(E=U.terrain)||void 0===E?void 0:E.clippingPolygonFeatureId,null==U||null===(N=U.terrain)||void 0===N?void 0:N.clippingPolygonUnion,null==U||null===(R=U.terrain)||void 0===R?void 0:R.clipOriginalGeometry,null==U||null===(_=U.terrain)||void 0===_?void 0:_.clippingLayerResourceId,F]),null}},762222:(e,n,t)=>{t.d(n,{Ht:()=>b,Kf:()=>D,L8:()=>v,Lj:()=>p,Ot:()=>g,Q2:()=>y,TS:()=>A,Vf:()=>m,_U:()=>w,qg:()=>O});var r=t(267980),o=t(367817),i=t(434067),l=t(336946),a=t(602289),u=t(466570),c=t.n(u);function s(e,n){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},s(e,n)}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(f=function(){return!!e})()}function d(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function A(e,n){var t=r.A.subtract(n,e,new r.A),o=r.A.multiplyByScalar(t,.5,new r.A);return r.A.add(e,o,new r.A)}function p(e,n){var t=r.A.normalize(e,new r.A),i=r.A.normalize(n,new r.A),l=r.A.dot(t,i);return o.A.toDegrees(Math.acos(l))}function g(e){return e.map(function(n,t){var o=e[t-1],i=e[t+1];return o&&i?p(r.A.subtract(o,n,new r.A),r.A.subtract(i,n,new r.A)):null}).filter(function(e){return null!==e})}function v(e){return new r.A((e[0].x+e[1].x+e[2].x)/3,(e[0].y+e[1].y+e[2].y)/3,(e[0].z+e[1].z+e[2].z)/3)}function y(e,n){return e.map(function(t,o){var i=e[o-1],l=e[o+1];if(i&&l){var a=function(e,n){var t=r.A.normalize(e,new r.A),o=r.A.normalize(n,new r.A);return r.A.cross(t,o,new r.A)}(r.A.subtract(i,t,new r.A),r.A.subtract(l,t,new r.A)),u=-Math.sign(r.A.dot(a,r.A.subtract(t,n,new r.A),new r.A));return p(r.A.multiplyByScalar(a,u,new r.A),t)}return null}).filter(function(e){return null!==e})}function m(e,n){if((null==e?void 0:e.length)<3)return 0;for(var t=i.A.packArray(e),o=c()(t,n,2),l=0,a=0;a<o.length;a+=3){var u=e[o[a]],s=e[o[a+1]],f=e[o[a+2]],d=r.A.subtract(s,u,new r.A),A=r.A.subtract(f,u,new r.A),p=r.A.cross(d,A,new r.A);l+=r.A.magnitude(p)/2}return l}function h(e,n){var t,r=[e,n].map(function(e){return l.A.fromCartesian(e)});return function(e,n,t){if(f())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,n);var o=new(e.bind.apply(e,r));return t&&s(o,t.prototype),o}(a.A,(t=r.map(function(e){var n=e.longitude,t=e.latitude;return new l.A(n,t,0)}),function(e){if(Array.isArray(e))return d(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,n){if(e){if("string"==typeof e)return d(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?d(e,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).surfaceDistance}function b(e,n){return(null==e?void 0:e.length)<2?0:e.reduce(function(t,o,i){return e[i-1]?t+(n?h(o,e[i-1]):r.A.distance(o,e[i-1])):t},0)}function w(e){return Math.sign(l.A.fromCartesian(e[1]).height-l.A.fromCartesian(e[0]).height)}function D(e,n){var t=l.A.fromCartesian(e),r=t.longitude,i=t.latitude,a=t.height;return[o.A.toDegrees(r),o.A.toDegrees(i),null!=n?n:a]}function O(e,n){var t=e.map(function(e){return l.A.fromCartesian(e)}),r=n?n(t):0;return t.map(function(e){var n=e.longitude,t=e.latitude;return l.A.toCartesian(new l.A(n,t,r))})}}}]);