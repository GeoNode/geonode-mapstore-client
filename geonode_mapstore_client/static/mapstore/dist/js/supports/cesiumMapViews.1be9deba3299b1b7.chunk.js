"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[296],{762222(e,n,t){t.d(n,{Ht:()=>b,Kf:()=>D,L8:()=>y,Lj:()=>g,Ot:()=>v,Q2:()=>m,TS:()=>p,Vf:()=>h,_U:()=>w,qg:()=>O});var r=t(434067),o=t(267980),i=t(336946),l=t(602289),a=t(367817),u=t(466570),c=t.n(u);function s(e,n,t){if(d())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,n);var o=new(e.bind.apply(e,r));return t&&f(o,t.prototype),o}function f(e,n){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},f(e,n)}function d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(d=function(){return!!e})()}function A(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function p(e,n){var t=o.A.subtract(n,e,new o.A),r=o.A.multiplyByScalar(t,.5,new o.A);return o.A.add(e,r,new o.A)}function g(e,n){var t=o.A.normalize(e,new o.A),r=o.A.normalize(n,new o.A),i=o.A.dot(t,r);return a.A.toDegrees(Math.acos(i))}function v(e){return e.map(function(n,t){var r=e[t-1],i=e[t+1];return r&&i?g(o.A.subtract(r,n,new o.A),o.A.subtract(i,n,new o.A)):null}).filter(function(e){return null!==e})}function y(e){return new o.A((e[0].x+e[1].x+e[2].x)/3,(e[0].y+e[1].y+e[2].y)/3,(e[0].z+e[1].z+e[2].z)/3)}function m(e,n){return e.map(function(t,r){var i=e[r-1],l=e[r+1];if(i&&l){var a=function(e,n){var t=o.A.normalize(e,new o.A),r=o.A.normalize(n,new o.A);return o.A.cross(t,r,new o.A)}(o.A.subtract(i,t,new o.A),o.A.subtract(l,t,new o.A)),u=-Math.sign(o.A.dot(a,o.A.subtract(t,n,new o.A),new o.A));return g(o.A.multiplyByScalar(a,u,new o.A),t)}return null}).filter(function(e){return null!==e})}function h(e,n){if((null==e?void 0:e.length)<3)return 0;for(var t=r.A.packArray(e),i=c()(t,n,2),l=0,a=0;a<i.length;a+=3){var u=e[i[a]],s=e[i[a+1]],f=e[i[a+2]],d=o.A.subtract(s,u,new o.A),A=o.A.subtract(f,u,new o.A),p=o.A.cross(d,A,new o.A);l+=o.A.magnitude(p)/2}return l}function b(e,n){return(null==e?void 0:e.length)<2?0:e.reduce(function(t,r,a){return e[a-1]?t+(n?(c=[r,e[a-1]].map(function(e){return i.A.fromCartesian(e)}),s(l.A,(u=c.map(function(e){var n=e.longitude,t=e.latitude;return new i.A(n,t,0)}),function(e){if(Array.isArray(e))return A(e)}(u)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(u)||function(e,n){if(e){if("string"==typeof e)return A(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?A(e,n):void 0}}(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).surfaceDistance):o.A.distance(r,e[a-1])):t;var u,c},0)}function w(e){return Math.sign(i.A.fromCartesian(e[1]).height-i.A.fromCartesian(e[0]).height)}function D(e,n){var t=i.A.fromCartesian(e),r=t.longitude,o=t.latitude,l=t.height;return[a.A.toDegrees(r),a.A.toDegrees(o),null!=n?n:l]}function O(e,n){var t=e.map(function(e){return i.A.fromCartesian(e)}),r=n?n(t):0;return t.map(function(e){var n=e.longitude,t=e.latitude;return i.A.toCartesian(new i.A(n,t,r))})}},793784(e,n,t){t.r(n),t.d(n,{default:()=>E});var r=t(273517),o=t(434067),i=t(267980),l=t(336946),a=t(41476),u=t(367817),c=t(290176),s=t(766067),f=t(697422),d=t(668696),A=t(770103),p=t(337632),g=t(465674),v=t(15817),y=t(493721),m=t(742558),h=t(457378),b=t(762222),w=t(731807);function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}var O=["center","cameraPosition"];function I(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return C(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?C(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function P(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function S(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?P(Object(t),!0).forEach(function(n){T(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function T(e,n,t){return(n=function(e){var n=function(e){if("object"!=D(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=D(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==D(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}const E=function(e){var n,t,D,C,P,T,E,N,R,_,j=e.map,L=e.selectedId,k=e.views,B=e.apiRef,x=void 0===B?function(){}:B,V=e.showViewsGeometries,z=e.showClipGeometries,F=e.resources,U=null==k?void 0:k.find(function(e){return e.id===L}),Q=(0,r.useRef)(),Y=(0,r.useRef)(),M=(0,r.useRef)(),G=(0,r.useRef)(),q=(0,r.useRef)();return(0,r.useEffect)(function(){var e={options:{settings:[w.Q_.DESCRIPTION,w.Q_.POSITION,w.Q_.ANIMATION,w.Q_.MASK,w.Q_.GLOBE_TRANSLUCENCY,w.Q_.LAYERS_OPTIONS],unsupportedLayers:[],showClipGeometriesEnabled:!0},getView:function(){var e=j.camera.positionCartographic,n=(0,w.JH)(e.height),t=j.camera.computeViewRectangle(j.scene.globe.ellipsoid,new f.A),r=j.scene.globe.pick(new s.A(j.camera.position,j.camera.direction),j.scene);r||(r=i.A.add(i.A.clone(j.camera.position),i.A.multiplyByScalar(i.A.clone(j.camera.direction),1e5,new i.A),new i.A));var o=l.A.fromCartesian(new i.A(r.x,r.y,r.z));return{zoom:n,center:{longitude:u.A.toDegrees(o.longitude),latitude:u.A.toDegrees(o.latitude),height:o.height},cameraPosition:{longitude:u.A.toDegrees(e.longitude),latitude:u.A.toDegrees(e.latitude),height:e.height},bbox:[u.A.toDegrees(t.west),u.A.toDegrees(t.south),u.A.toDegrees(t.east),u.A.toDegrees(t.north)]}},setView:function(e){var n=function(e,n){var t=n.center,r=n.cameraPosition,o=function(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],-1===n.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}(n,O);if(o.orientation&&o.position)return{destination:o.position,orientation:o.orientation};var a,u={position:i.A.clone(e.camera.position),orientation:{heading:e.camera.heading,pitch:e.camera.pitch,roll:e.camera.roll}},c=l.A.toCartesian(l.A.fromDegrees(t.longitude,t.latitude,t.height,new l.A)),s=l.A.toCartesian(l.A.fromDegrees(t.longitude,t.latitude,t.height+1,new l.A)),f=l.A.toCartesian(l.A.fromDegrees(r.longitude,r.latitude,r.height,new l.A)),d=l.A.toCartesian(l.A.fromDegrees(r.longitude,r.latitude,r.height+1,new l.A)),A=i.A.subtract(f,c,new i.A),p=i.A.subtract(s,c,new i.A),g=t.latitude>0&&Math.round((0,b.Lj)(A,p))<=5?i.A.subtract(f,d,new i.A):i.A.subtract(d,f,new i.A);a=i.A.subtract(c,f,new i.A),i.A.normalize(a,a),e.camera.setView({destination:f,orientation:{direction:a,up:g}}),e.camera.setView({destination:f,orientation:{direction:a,up:g}});var v={destination:{x:e.camera.position.x,y:e.camera.position.y,z:e.camera.position.z},orientation:{heading:e.camera.heading,pitch:e.camera.pitch,roll:e.camera.roll}};return e.camera.setView({destination:u.position,orientation:u.orientation}),v}(j,e),t=n.destination,r=n.orientation;j.camera.cancelFlight(),j.camera[e.flyTo?"flyTo":"setView"]({destination:t,orientation:r})},computeViewCoordinates:function(n,t){e.setView(S(S({},t),{},{flyTo:!1}));var r=j.camera.positionCartographic,o=(0,w.JH)(r.height),i=j.camera.computeViewRectangle(j.scene.globe.ellipsoid,new f.A);return S(S({},t),{},{zoom:o,bbox:[u.A.toDegrees(i.west),u.A.toDegrees(i.south),u.A.toDegrees(i.east),u.A.toDegrees(i.north)]})}};x(e)},[j]),(0,r.useEffect)(function(){return j&&(Q.current=new y.A({destroyPrimitives:!0}),j.scene.primitives.add(Q.current),Y.current=new A.A,j.scene.primitives.add(Y.current),M.current=new g.A,j.scene.primitives.add(M.current),G.current=(0,h.g7)(16,{stroke:"#ffffff",strokeWidth:2,fill:!1}),q.current=new d.A("clipGeometriesDataSource")),function(){null!=j&&j.isDestroyed&&!j.isDestroyed()&&((0,h.IP)(j,Q.current),Q.current=null,(0,h.IP)(j,Y.current),Y.current=null,(0,h.IP)(j,M.current),M.current=null)}},[j]),(0,r.useEffect)(function(){return(V||z)&&null!=j&&j.isDestroyed&&!j.isDestroyed()&&(null==k?void 0:k.length)>0&&(V&&k.forEach(function(e){var n=l.A.toCartesian(l.A.fromDegrees(e.cameraPosition.longitude,e.cameraPosition.latitude,e.cameraPosition.height)),t=l.A.toCartesian(l.A.fromDegrees(e.center.longitude,e.center.latitude,e.center.height)),r=e.id===L;Q.current.add((0,h.Qi)({color:r?"#ffcc33":"#ffffff",opacity:1,depthFailColor:"#000000",depthFailOpacity:0,width:1,dashLength:10,coordinates:[n,t]})),Y.current.add({position:n,image:G.current,color:(0,h.Oe)({color:r?"#ffcc33":"#ffffff"}),disableDepthTestDistance:Number.POSITIVE_INFINITY,allowPicking:!1}),M.current.add({position:n,text:e.title,font:"12px sans-serif",disableDepthTestDistance:Number.POSITIVE_INFINITY,fillColor:(0,h.Oe)({color:"#ffffff"}),outlineColor:(0,h.Oe)({color:"#000000"}),outlineWidth:4,style:v.A.FILL_AND_OUTLINE,showBackground:!1,backgroundPadding:new o.A(4,4),pixelOffset:new o.A(0,-16),horizontalOrigin:p.A.CENTER,verticalOrigin:m.A.BASELINE})}),z&&F.filter(function(e){var n,t=!(null==k||!k.find(function(n){var t,r;return(null==n||null===(t=n.terrain)||void 0===t?void 0:t.clippingLayerResourceId)===e.id||(null==n||null===(r=n.layers)||void 0===r?void 0:r.find(function(n){return(null==n?void 0:n.clippingLayerResourceId)===e.id}))}));return!(null==e||null===(n=e.data)||void 0===n||null===(n=n.collection)||void 0===n||!n.features||!t)}).forEach(function(e){(0,w.J1)(e.data.collection.features).forEach(function(e){Q.current.add((0,h.Qi)({color:"#ff0000",opacity:1,width:3,dashLength:10,clampToGround:!0,coordinates:i.A.fromDegreesArray(e.geometry.coordinates[0].reduce(function(e,n){return[].concat(I(e),I(n))},[]))})),M.current.add({position:i.A.fromDegreesArray(e.geometry.coordinates[0][0])[0],text:e.id,font:"12px sans-serif",disableDepthTestDistance:Number.POSITIVE_INFINITY,fillColor:(0,h.Oe)({color:"#ffffff"}),outlineColor:(0,h.Oe)({color:"#000000"}),outlineWidth:4,style:v.A.FILL_AND_OUTLINE,showBackground:!1,backgroundPadding:new o.A(4,4),pixelOffset:new o.A(0,-16),horizontalOrigin:p.A.CENTER,verticalOrigin:m.A.BASELINE})})}),j.scene.requestRender()),function(){var e,n,t;null!=j&&j.isDestroyed&&!j.isDestroyed()&&(null===(e=Q.current)||void 0===e||e.removeAll(),null===(n=Y.current)||void 0===n||n.removeAll(),null===(t=M.current)||void 0===t||t.removeAll(),j.scene.requestRender())}},[k,L,j,V,z,F]),(0,r.useEffect)(function(){var e,n,t,r,o,i,l=j.scene.globe,a=(U||{}).globeTranslucency,u=void 0===a?{}:a;l.translucency.frontFaceAlphaByDistance=new c.A(null!==(e=null==U||null===(n=U.globeTranslucency)||void 0===n?void 0:n.nearDistance)&&void 0!==e?e:w.BU.TRANSLUCENCY_NEAR_DISTANCE,0,null!==(t=null==U||null===(r=U.globeTranslucency)||void 0===r?void 0:r.farDistance)&&void 0!==t?t:w.BU.TRANSLUCENCY_FAR_DISTANCE,1);var s=null!==(o=null==u?void 0:u.opacity)&&void 0!==o?o:w.BU.TRANSLUCENCY_OPACITY;return l.translucency.enabled=null!==(i=null==u?void 0:u.enabled)&&void 0!==i&&i,l.translucency.frontFaceAlphaByDistance.nearValue=s,l.translucency.frontFaceAlphaByDistance.farValue=null!=u&&u.fadeByDistance?1:s,j.scene.requestRender(),function(){null!=j&&j.isDestroyed&&!j.isDestroyed()&&(l.translucency.enabled=!1)}},[null==U||null===(n=U.globeTranslucency)||void 0===n?void 0:n.enabled,null==U||null===(t=U.globeTranslucency)||void 0===t?void 0:t.fadeByDistance,null==U||null===(D=U.globeTranslucency)||void 0===D?void 0:D.nearDistance,null==U||null===(C=U.globeTranslucency)||void 0===C?void 0:C.farDistance,null==U||null===(P=U.globeTranslucency)||void 0===P?void 0:P.opacity]),(0,r.useEffect)(function(){var e,n=j.scene;return n.invertClassification=!(null==U||null===(e=U.mask)||void 0===e||!e.enabled),n.invertClassificationColor=new a.A(0,0,0,0),function(){null!=j&&j.isDestroyed&&!j.isDestroyed()&&(n.invertClassification=!1)}},[null==U||null===(T=U.mask)||void 0===T?void 0:T.enabled]),(0,r.useEffect)(function(){var e,n,t,r=j.scene.globe,o=null==F||null===(e=F.find(function(e){var n;return e.id===(null==U||null===(n=U.terrain)||void 0===n?void 0:n.clippingLayerResourceId)}))||void 0===e?void 0:e.data,i=null===(n=(0,w.J1)(null==o||null===(t=o.collection)||void 0===t?void 0:t.features))||void 0===n?void 0:n.find(function(e){var n;return e.id===(null==U||null===(n=U.terrain)||void 0===n?void 0:n.clippingPolygonFeatureId)});if(i){var l,a=(0,h.xX)(i);(0,h.gi)({target:r,polygons:a,inverse:!(null==U||null===(l=U.terrain)||void 0===l||!l.clippingPolygonUnion),scene:j.scene,additionalProperties:{backFaceCulling:!0,showSkirts:!0}})}else{var u;null==r||null===(u=r.clippingPolygons)||void 0===u||u.removeAll(),j.scene.requestRender()}return function(){var e;null!=j&&j.isDestroyed&&!j.isDestroyed()&&(null==r||null===(e=r.clippingPolygons)||void 0===e||e.removeAll(),j.scene.requestRender())}},[null==U||null===(E=U.terrain)||void 0===E?void 0:E.clippingPolygonFeatureId,null==U||null===(N=U.terrain)||void 0===N?void 0:N.clippingPolygonUnion,null==U||null===(R=U.terrain)||void 0===R?void 0:R.clipOriginalGeometry,null==U||null===(_=U.terrain)||void 0===_?void 0:_.clippingLayerResourceId,F]),null}}}]);