"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[9412],{447430:(e,t,r)=>{r.d(t,{A:()=>v});var n=r(605556),o=r.n(n),i=r(273517),a=r.n(i),l=r(750042),u=r.n(l);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(f=function(){return!!e})()}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function m(e,t,r){return(t=p(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}r.e(4434).then(r.bind(r,664434));var b=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,r){return t=d(t),function(e,t){if(t&&("object"==c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,f()?Reflect.construct(t,r||[],d(e).constructor):t.apply(e,r))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){return this.props.loading?a().createElement("div",{className:this.props.className,id:this.props.id},a().createElement(u(),{noFadeIn:!0,overrideSpinnerClassName:"spinner",spinnerName:this.props.spinner})):null}}])&&s(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);m(b,"propTypes",{id:o().string,loading:o().bool,className:o().string,spinner:o().string}),m(b,"defaultProps",{id:"mapstore-globalspinner",loading:!1,className:"ms2-loading",spinner:"circle"});const v=b},629692:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Qe});var n=r(605556),o=r.n(n),i=r(273517),a=r.n(i),l=r(292935),u=r(811668),c=r(916589),s=r(801081),f=r(227341),d=r.n(f),y=r(71665),m=r(8571),p=r(697950),b=r(563864);const v=(0,c.branch)(function(e){return e.selectionActive},(0,c.compose)((0,c.withProps)(function(e){var t=e.className;return{className:"".concat(t," selection-active")}}),(0,c.withHandlers)({getWidgetClass:function(e){var t=e.getWidgetClass,r=void 0===t?function(){}:t,n=e.isWidgetSelectable,o=void 0===n?function(){return!0}:n;return function(e){return r(e)?r(e)+(o(e)?void 0:" disabled"):o(e)?void 0:" disabled"}},onWidgetClick:function(e){var t=e.onWidgetSelected,r=void 0===t?function(){}:t,n=e.isWidgetSelectable,o=void 0===n?function(){return!0}:n;return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return o(e)?r.apply(void 0,[e].concat(n)):null}}})));var g=r(8117),h=r(694838),w=r(132672);function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?j(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach(function(t){A(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function A(e,t,r){return(t=function(e){var t=function(e){if("object"!=E(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==E(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return x(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var I=(0,h.A)(g.Dr),C=function(e){var t=e.handleSelect,r=e.isSelected,n=e.id,o=e.color,l=e.name,u=e.onRemove,c=e.onMove,s=e.canDelete,f=e.onConfigure,d=e.canMoveLeft,y=e.canMoveRight,p=e.canEdit,b=D((0,i.useState)({left:0,bottom:0,right:0}),2),v=b[0],h=b[1],w=(0,i.useRef)(null);return a().createElement(g.ms,{dropup:!0,bsStyle:"default",id:n,className:"".concat(r?"is-selected ":"","ms-layout-view"),style:{borderBottom:"2px solid ".concat(o)}},a().createElement(g.$n,{onClick:function(){return t(n)},bsStyle:"default"},l),p&&a().createElement(g.ms.Toggle,{onClick:function(){if(t(n),w.current){var e=w.current.getBoundingClientRect();window.innerWidth-e.right<200?h({right:window.innerWidth-e.right-4,bottom:window.innerHeight-e.top+10,left:"auto"}):h({left:e.left-4,bottom:window.innerHeight-e.top+10,right:"auto"})}},noCaret:!0},a().createElement("div",{ref:w},a().createElement(g.e6,{glyph:"option-vertical"}))),a().createElement(g.ms.Menu,{className:"_fixed",style:P({},v)},a().createElement(I,{confirmTitle:a().createElement(m.A,{msgId:"dashboard.view.removeConfirmTitle"}),confirmContent:a().createElement(m.A,{msgId:"dashboard.view.removeConfirmContent"}),onClick:function(){return u(n)},disabled:!s},a().createElement(g.e6,{glyph:"trash"}),a().createElement(m.A,{msgId:"dashboard.view.delete"})),a().createElement(g.Dr,{onClick:function(){f()}},a().createElement(g.e6,{glyph:"cog"}),a().createElement(m.A,{msgId:"dashboard.view.configure"})),a().createElement(g.Dr,{onClick:function(){c(n,"right")},disabled:!y},a().createElement(g.e6,{glyph:"arrow-right"}),a().createElement(m.A,{msgId:"dashboard.view.moveRight"})),a().createElement(g.Dr,{onClick:function(){c(n,"left")},disabled:!d},a().createElement(g.e6,{glyph:"arrow-left"}),a().createElement(m.A,{msgId:"dashboard.view.moveLeft"}))))};const k=function(e){var t=e.layouts,r=void 0===t?[]:t,n=e.selectedLayoutId,o=e.onSelect,l=e.onAdd,u=e.onRemove,c=e.onMove,s=e.onConfigure,f=e.canEdit,d=function(e){null==o||o(e)},y=function(e){var t=e.data,r=(0,i.useRef)(null),n=O((0,i.useState)(!0),2),o=n[0],a=n[1],l=O((0,i.useState)(!0),2),u=l[0],c=l[1],s=O((0,i.useState)(!1),2),f=s[0],d=s[1];return(0,i.useEffect)(function(){var e=function(){var e=r.current;if(e){var t=e.scrollLeft,n=e.scrollWidth,o=e.clientWidth;d(n>o+1),a(t<=0),c(t+o>=n-1)}},t=r.current;return t&&(e(),t.addEventListener("scroll",e),window.addEventListener("resize",e)),function(){null==t||t.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[t]),[r,f,o,u,function(e){var t=r.current;if(t){var n=.8*t.clientWidth;t.scrollBy({left:"left"===e?-n:n,behavior:"smooth"})}}]}({data:r}),m=D(y,5),p=m[0],b=m[1],v=m[2],h=m[3],j=m[4];return a().createElement(w.A,{gap:"xs",centerChildrenVertically:!0,className:"view-switcher-container"},f&&a().createElement(g.$n,{onClick:l,className:"square-button-md _margin-l-xs _margin-tb-xs",title:"Add a layout view to the dashboard"},a().createElement(g.e6,{glyph:"plus"})),a().createElement(w.A,{centerChildrenVertically:!0,ref:p,className:"_overflow-auto _fill view-switcher-tabs"},r.map(function(e,t){var o=e.id||t+1;return a().createElement(C,{key:o,id:o,name:e.name,color:e.color,handleSelect:d,isSelected:n===o,onRemove:u,onMove:c,onConfigure:s,canDelete:r.length>1,canMoveRight:t!==r.length-1,canMoveLeft:0!==t,canEdit:f})})),b&&a().createElement(w.A,{gap:"xs",centerChildrenVertically:!0,className:"view-scroll-buttons"},a().createElement(g.$n,{className:"square-button-md",bsStyle:"primary",onClick:function(){return j("left")},disabled:v,title:"Scroll left"},a().createElement(g.e6,{glyph:"chevron-left"})),a().createElement(g.$n,{className:"square-button-md",bsStyle:"primary",onClick:function(){return j("right")},disabled:h,title:"Scroll right"},a().createElement(g.e6,{glyph:"chevron-right"}))))};var T=r(541033),L=r.n(T),_=r(549112),W=r(711520),N=r(7235),M=r(192016),R=r(406250),H=r(622795);function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach(function(t){B(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function B(e,t,r){return(t=function(e){var t=function(e){if("object"!=z(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==z(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return U(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?U(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Z=(0,r(164045).A)(g.e6);const J=function(e){var t,r,n=e.active,o=e.onToggle,l=e.data,u=e.onSave,c=e.user,s=q((0,i.useState)({name:null,color:null}),2),f=s[0],d=s[1],y=q((0,i.useState)([]),2),p=y[0],b=y[1];(0,i.useEffect)(function(){d(l)},[l]),(0,i.useEffect)(function(){if(n&&c){var e=[{params:{pageSize:9999999,f:"dataset"}},{user:c},["DASHBOARD"]];H.Bv.apply(void 0,e).toPromise().then(function(e){var t=e.resources.map(function(e){return{value:e.id||e.pk,label:e.name}});b(t)})}},[n,c]);var v=!!l.dashboard||0===(null===(t=l.layoutsData)||void 0===t||null===(t=t.md)||void 0===t?void 0:t.length)&&0===(null===(r=l.layoutsData)||void 0===r||null===(r=r.xxs)||void 0===r?void 0:r.length);return n&&a().createElement(R.A,null,a().createElement(W.A,{id:"mapstore-export-data-results",draggable:!1,containerClassName:"configure-view-dialog-container",modal:!0},a().createElement("span",{role:"header"},a().createElement("span",{className:"modal-title about-panel-title"},a().createElement(m.A,{msgId:"dashboard.view.configure"})),a().createElement("button",{onClick:function(){return o()},className:"settings-panel-close close"},a().createElement(g.e6,{glyph:"1-close"}))),a().createElement("div",{role:"body",className:"_padding-lg"},a().createElement(g.gE,null,a().createElement(g.mq,null,a().createElement(m.A,{msgId:"dashboard.view.name"})),a().createElement(g.MJ,{type:"text",value:f.name,onChange:function(e){var t=(e.target||{}).value;d(function(e){return $($({},e),{},{name:t})})}})),a().createElement(g.gE,{className:"ms-flex-box _flex _flex-gap-sm _flex-center-v _relative _padding-b-sm"},a().createElement(g.mq,null,a().createElement(m.A,{msgId:"dashboard.view.color"})),a().createElement(g.MG,{className:"dashboard-color-picker _relative"},a().createElement(N.A,{format:"rgb",color:f.color,onChangeColor:function(e){return e&&d(function(t){return $($({},t),{},{color:e})})},placement:"right"}))),a().createElement(g.gE,{controlId:"thumbnail",key:"thumbnail",className:"ms-flex-box _flex _flex-gap-sm _flex-center-v _padding-b-sm"},a().createElement(g.Sc,{onChange:function(){return d(function(e){return $($({},e),{},{linkExistingDashboard:!e.linkExistingDashboard})})},checked:f.linkExistingDashboard,disabled:!v},a().createElement(m.A,{msgId:"dashboard.view.linkExistingDashboard"})),!v&&a().createElement(Z,{glyph:"info-sign",tooltipId:"dashboard.view.cannotAddExistingDashboard"})),f.linkExistingDashboard&&a().createElement(g.gE,null,a().createElement(g.mq,null,a().createElement(m.A,{msgId:"dashboard.view.selectDashboard"})),a().createElement(M.Ay,{value:f.dashboard||"",options:p,name:"dashboard",onChange:function(e){return d(function(t){return $($({},t),{},{dashboard:null==e?void 0:e.value})})}}))),a().createElement("div",{role:"footer"},a().createElement(g.$n,{bsStyle:"default",onClick:function(){return o()}},a().createElement(m.A,{msgId:"dashboard.view.cancel"})),a().createElement(g.$n,{bsStyle:"primary",onClick:function(){return u(f)}},a().createElement(m.A,{msgId:"dashboard.view.save"})))))};var X=r(672975),F=r(639996);function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function Q(e){return function(e){if(Array.isArray(e))return ne(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||re(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach(function(t){ee(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ee(e,t,r){return(t=function(e){var t=function(e){if("object"!=G(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=G(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==G(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||re(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){if(e){if("string"==typeof e)return ne(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ne(e,t):void 0}}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var oe=r(3162);function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}var ae=["selectedLayout","layoutsData"];function le(){return le=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},le.apply(null,arguments)}function ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ce(e,t,r){return(t=function(e){var t=function(e){if("object"!=ie(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ie(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function fe(e){var t,r,n=e.selectedLayout,o=e.layoutsData,l=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,ae),u=function(e){var t=e.props,r=e.dashboard,n=te((0,i.useState)(!1),2),o=n[0],a=n[1],l=te((0,i.useState)({}),2),u=l[0],c=l[1],s=(0,i.useRef)({}),f=(0,i.useRef)(!1),d=t||{},y=d.layouts,m=void 0===y?[]:y,p=d.selectedLayoutId,b=d.onLinkedDashboardDataLoad,v=d.widgets,g=void 0===v?[]:v,h=(0,i.useMemo)(function(){return m&&p?m.find(function(e){return e.id===p}):null},[p,m]);return(0,i.useEffect)(function(){var e,t;if(r&&h){var n=s.current[p];c(function(e){return Y(Y({},e),{},ee({},p,null))}),((null==h||null===(e=h.md)||void 0===e?void 0:e.length)>0||(null==h||null===(t=h.xxs)||void 0===t?void 0:t.length)>0)&&n===r||f.current||(f.current=!0,a(!0),(0,H.hZ)(r,"dashboard").toPromise().then(function(e){var t=Array.isArray(e.data.layouts)?e.data.layouts:[e.data.layouts];if((null==t?void 0:t.length)>1)c(function(e){return Y(Y({},e),{},ee({},p,{messageId:"dashboard.errors.multipleDashboardError"}))});else{var n=null==t?void 0:t[0],o=e.data.widgets.map(function(e){return Y(Y({},e),{},{id:"".concat(p,"-").concat(e.id),layoutId:p},e.dependenciesMap&&{dependenciesMap:(0,_.tg)(e.dependenciesMap,p)})}),i=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(e){return Y(Y({},e),{},{i:"".concat(p,"-").concat(e.i)})})},a=m.map(function(e){return e.id===p?Y(Y({},e),{},{md:i(n.md),xxs:i(n.xxs)}):e});b({widgets:[].concat(Q(g.filter(function(e){return e.layoutId!==p})),Q(o)),layouts:a}),s.current[p]=r}}).catch(function(e){var t=(0,_.Jv)(e);c(function(e){return Y(Y({},e),{},ee({},p,{messageId:t}))})}).finally(function(){f.current=!1,a(!1)}))}},[r,h,m,b,p,g]),[o,u[p]]}({props:l,dashboard:n.dashboard}),c=(r=2,function(e){if(Array.isArray(e))return e}(t=u)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,r)||function(e,t){if(e){if("string"==typeof e)return se(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?se(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=c[0],f=c[1],d=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(r),!0).forEach(function(t){ce(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},l);return l.widgets&&(d.widgets=l.widgets.filter(function(e){return e.layoutId===l.selectedLayoutId})),f?a().createElement("div",{style:{margin:"auto",fontWeight:"bold"}},a().createElement(oe.A,{title:a().createElement(m.A,{msgId:f.messageId})})):s?a().createElement("div",{style:{margin:"auto",fontWeight:"bold"}},a().createElement(X.A,{style:{display:"inline-block",verticalAlign:"middle"}}),a().createElement(m.A,{msgId:"loading"})):a().createElement(w.A.Fill,{classNames:["_relative","_overflow-auto"]},a().createElement(F.A,le({},d,{layouts:o,canEdit:!n.dashboard&&l.canEdit})))}function de(e){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(e)}var ye=["id","name","color","linkExistingDashboard","dashboard"];function me(){return me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},me.apply(null,arguments)}function pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(r),!0).forEach(function(t){ve(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pe(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ve(e,t,r){return(t=function(e){var t=function(e){if("object"!=de(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=de(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==de(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ge(e){return function(e){if(Array.isArray(e))return he(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return he(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?he(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function Oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(r),!0).forEach(function(t){Ee(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oe(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ee(e,t,r){return(t=function(e){var t=function(e){if("object"!=we(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=we(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==we(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Se=(0,c.compose)(c.pure,(0,c.defaultProps)({breakpoints:{md:480,xxs:0},cols:{md:6,xxs:1},minLayoutWidth:480}),(0,p.Qy)({overrideWidthProvider:!0}),(0,c.withProps)(function(e){var t=e.width;return{width:t<=e.minLayoutWidth?t-18:t,toolsOptions:{showMaximize:!0}}}),(0,c.withProps)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,r=e.height,n=e.maximized,o=e.minLayoutWidth,i=e.cols,a=null!=n&&n.widget?{width:"100%",height:"100%",marginTop:0,bottom:"auto",top:0,left:0,zIndex:99}:{},l=null!=n&&n.widget?{width:t,useDefaultWidthProvider:!1,rowHeight:r-50,breakpoints:{xxs:0},cols:{xxs:1}}:{};return je({className:"on-map",breakpoints:{md:o,xxs:0},cols:i||{md:6,xxs:1},style:je({position:"absolute",zIndex:50},a)},l)}),(0,c.withStateHandlers)(function(e){return function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),{viewConfigurationActive:!1}},{setViewConfigurationActive:function(){return function(e){return{viewConfigurationActive:e}}}}),(0,b.A)(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).layouts,t=void 0===e?[]:e;return!t||0===t.length},function(e){var t=e.loading,r=e.layouts,n=void 0===r?[]:r,o=e.onLayoutViewReplace,i=[{id:L()(),name:"Main view",color:null}];return n&&0!==n.length||o(i),{glyph:"dashboard",title:t?a().createElement(m.A,{msgId:"loading"}):a().createElement(m.A,{msgId:"dashboard.emptyTitle"})}}),(0,c.defaultProps)({isWidgetSelectable:function(){return!0}}),(0,c.withHandlers)({onLayoutChange:function(e){return function(t,r){var n=(Array.isArray(e.layouts)?e.layouts:[e.layouts]).map(function(t){return null!=t&&t.id&&(null==t?void 0:t.id)===e.selectedLayoutId?je(je(je({},t),r),{},{id:t.id,name:t.name,color:t.color}):t});return e.onLayoutChange&&e.onLayoutChange(t,n),{layout:t,allLayouts:n}}}}),v)(function(e){var t=e.layouts,r=void 0===t?[]:t,n=e.onLayoutViewReplace,o=e.selectedLayoutId,i=e.onLayoutViewSelected,l=e.widgets,u=void 0===l?[]:l,c=e.onWidgetsReplace,s=e.user,f=e.viewConfigurationActive,d=e.setViewConfigurationActive,y=e.canEdit,m=Array.isArray(r)?r.find(function(e){return(null==e?void 0:e.id)===o})||{}:r,p=m.id,b=m.name,v=m.color,g=m.linkExistingDashboard,h=m.dashboard,O=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(m,ye),j=Array.isArray(r)?r:[r];return a().createElement(w.A,{column:!0,classNames:["_relative","_fill"]},a().createElement(fe,me({selectedLayout:m,layoutsData:O},e)),(y||j.length>1)&&a().createElement(k,{layouts:Array.isArray(r)?r:[r],selectedLayoutId:o,onSelect:function(e){i(e)},onAdd:function(){var e={id:L()(),name:(0,_.iB)(r),color:null,md:[],xxs:[]},t=[].concat(ge(r),[e]);null==n||n(t),i(e.id),d(!0)},onRemove:function(e){var t,o=r.filter(function(t){return t.id!==e});n(o),i(null==o||null===(t=o[o.length-1])||void 0===t?void 0:t.id);var a=u.filter(function(t){return t.layoutId!==e});c(a)},onMove:function(e,t){var o=r.findIndex(function(t){return t.id===e});if(-1!==o){var i=ge(r);if("left"===t&&o>0){var a=[i[o],i[o-1]];i[o-1]=a[0],i[o]=a[1]}else if("right"===t&&o<i.length-1){var l=[i[o+1],i[o]];i[o]=l[0],i[o+1]=l[1]}n(i)}},onConfigure:function(){return d(!0)},canEdit:y}),f&&a().createElement(J,{active:f,onToggle:function(){return d(!1)},onSave:function(e){var t=r.map(function(t){return t.id===p?be(be({},t),{},{name:e.name,color:e.color,linkExistingDashboard:e.linkExistingDashboard,dashboard:e.dashboard}):t});n(t),d(!1)},data:{name:b,color:v,linkExistingDashboard:g,dashboard:h,layoutsData:O},user:s}))});var Pe=r(795153),Ae=r(589769),De=r(508828),xe=r(344297),Ie=r(737704),Ce=r(102780),ke=r(635666),Te=r(779956),Le=r(699518),_e=r(447430),We=r(393149),Ne=r(891543),Me=r(501719);function Re(e){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re(e)}function He(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ze(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?He(Object(r),!0).forEach(function(t){Ze(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):He(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ve(){return Ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ve.apply(null,arguments)}function $e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Je(n.key),n)}}function Be(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Be=function(){return!!e})()}function qe(e){return qe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qe(e)}function Ue(e,t){return Ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ue(e,t)}function Ze(e,t,r){return(t=Je(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Je(e){var t=function(e){if("object"!=Re(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Re(t)?t:t+""}var Xe=(0,c.compose)((0,u.connect)((0,s.Mz)(Ae.N9,Ie.mT,Ie.Cs,Ie.lo,Ie.Zh,function(e){return(0,Ie.bz)(e)},Ie.Re,Ae.m4,Ae.Nq,Ae.Xt,De.Bv,xe.f8,xe.RU,Ie.Og,De.Pd,Ae.aH,Ie.jT,Ae.DJ,Me.dt,function(e,t,r,n,o,i,a,l,u,c,s,f,y,m,p,b,v,g,h){return{resource:e,loading:u,canEdit:g,layouts:r,dependencies:n,selectionActive:o,editingWidget:i,widgets:!d()(m)&&Array.isArray(m.widget)&&m.widget.some(function(e){return e.layoutId===v})?t.filter(function(e){return m.widget.some(function(t){return t.id===e.id})}):t,groups:a,showGroupColor:l,language:f?s:null,env:y,maximized:!d()(m)&&(Array.isArray(m.widget)?m.widget.every(function(e){return e.layoutId!==v}):m.widget.layoutId!==v)?{}:m,currentLocale:p,isDashboardOpened:b,selectedLayoutId:v,user:h}}),{editWidget:y.Pd,updateWidgetProperty:y.Dr,exportCSV:y.HX,deleteWidget:y.uv,onWidgetSelected:y.Xj,onLayoutChange:y.ZJ,toggleMaximize:y.th,onLayoutViewReplace:y.WA,onWidgetsReplace:y.ID,onLayoutViewSelected:y.q4,onLinkedDashboardDataLoad:y.mz}),(0,c.withProps)(function(){return{style:{height:"100%",overflow:"auto"}}}),(0,c.withHandlers)({isWidgetSelectable:function(e){var t=e.editingWidget;return function(e){return("map"===e.widgetType||"table"===e.widgetType&&(0,_.Ls)(t,e)&&!e.mapSync)&&e.id!==t.id}}}))(Se),Fe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,r){return t=qe(t),function(e,t){if(t&&("object"==Re(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Be()?Reflect.construct(t,r||[],qe(e).constructor):t.apply(e,r))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ue(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){var e;(null===(e=this.props)||void 0===e?void 0:e.did)&&(this.oldDocumentTitle=document.title)}},{key:"componentDidUpdate",value:function(){var e,t=null===(e=this.props)||void 0===e?void 0:e.did;this.props.dashboardTitle&&t&&(document.title=this.props.dashboardTitle)}},{key:"componentWillUnmount",value:function(){var e;(null===(e=this.props)||void 0===e?void 0:e.did)&&(document.title=this.oldDocumentTitle)}},{key:"render",value:function(){return this.props.enabled?a().createElement(Xe,{items:this.props.items,width:this.props.width,height:this.props.height,rowHeight:this.props.rowHeight,cols:this.props.cols,minLayoutWidth:this.props.minLayoutWidth,enableZoomInTblWidget:this.props.enableZoomInTblWidget,widgetOpts:this.props.widgetOpts,isDashboardWidget:!0}):null}}])&&$e(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);Ze(Fe,"propTypes",{items:o().array,enabled:o().bool,rowHeight:o().number,cols:o().object,minLayoutWidth:o().number,widgetOpts:o().object,enableZoomInTblWidget:o().bool,dashboardTitle:o().string}),Ze(Fe,"defaultProps",{enabled:!0,minLayoutWidth:480,enableZoomInTblWidget:!0});var Ge=function(e,t){var r=t.loadedPlugins,n=(0,Ne.A)({items:e.items,loadedPlugins:r}).filter(function(e){return"menu"===e.target});return a().createElement(Fe,Ve({},e,{items:n}))};Ge.contextTypes={loadedPlugins:o().object};const Qe=(0,We.i1)("Dashboard",{component:(0,u.connect)(function(e){return{dashboardTitle:(0,Ae.gm)(e)}})((0,l.A)(Ge)),reducers:{dashboard:Ce.A,widgets:Pe.A},containers:{SidebarMenu:{name:"Dashboard-spinner",alwaysVisible:!0,position:2e3,tool:(0,u.connect)(function(e){return{loading:(0,Ae.Nq)(e)}})(_e.A)}},epics:ze(ze(ze({},ke.Ay),Te.Ay),Le.Ay)})}}]);