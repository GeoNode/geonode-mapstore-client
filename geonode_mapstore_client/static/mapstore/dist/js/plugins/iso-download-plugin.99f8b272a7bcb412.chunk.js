"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[1e3],{892096:(n,e,t)=>{t.r(e),t.d(e,{default:()=>P});var o=t(273517),r=t.n(o),i=t(811668),l=t(801081),a=t(393149),u=t(8571),c=t(836970),s="GEONODE:DOWNLOAD_METADATA",d="GEONODE:DOWNLOAD_METADATA_COMPLETE";function p(n,e){return{type:d,link:n,pk:e}}var f=t(45388),v=t(995531),b=t(791936),y=t(883832),w=t(794689),m=t(890559);function g(n){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},g(n)}function O(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),t.push.apply(t,o)}return t}function D(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?O(Object(t),!0).forEach(function(e){k(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):O(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}function k(n,e,t){return(e=function(n){var e=function(n){if("object"!=g(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var t=e.call(n,"string");if("object"!=g(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==g(e)?e:e+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var h={downloads:{ISO:{},DublinCore:{}}};function E(n){var e=n.onDownload,t=n.resourcePk,o=n.isDownloading;return r().createElement(c.A,{variant:"default",onClick:function(){return e("ISO",t)},className:"isobutton"},o&&r().createElement(m.A,{animation:"border",role:"status"},r().createElement("span",{className:"sr-only"},"Loading..."))," ",r().createElement(u.A,{msgId:"gnviewer.iso"}))}var j=(0,i.connect)((0,l.Mz)([function(n){var e;return(null==n||null===(e=n.gnresource)||void 0===e?void 0:e.data.pk)||null},function(n){var e;return(null==n||null===(e=n.gnDownload)||void 0===e||null===(e=e.downloads)||void 0===e?void 0:e.ISO)||{}}],function(n,e){return{resourcePk:n,isDownloading:e[n]}}),{onDownload:function(n,e){return{type:s,link:n,pk:e}}})(E);E.defaultProps={onDownload:function(){},resourcePk:null,isDownloading:!1};const P=(0,a.i1)("IsoDownload",{component:function(){return null},containers:{ActionNavbar:{name:"IsoDownload",Component:j}},epics:{gnDownloadMetaData:function(n,e){return n.ofType(s).switchMap(function(n){var t,o=e.getState(),r=(0,w.oQ)(n.pk),i=null===(t=o.gnresource)||void 0===t||null===(t=t.data)||void 0===t||null===(t=t.title)||void 0===t?void 0:t.replace(/[\.\s]/g,"_");return f.Observable.defer(function(){return v.A.get(r).then(function(n){return n})}).switchMap(function(e){var t=e.data,o=e.headers;if("application/xml"===o["content-type"]||"application/xml; charset=UTF-8"===o["content-type"]){var r=String.fromCharCode.apply(null,new Uint8Array(t));if(0===r.indexOf("<ows:ExceptionReport"))throw r}return(0,b.saveAs)(new Blob([t],{type:o&&o["content-type"]}),"".concat(i,"_").concat(n.link.split(" ").join("_"),"_Metadata")),f.Observable.of(p(n.link,n.pk))}).catch(function(e){var t,o,r;return f.Observable.of(p(n.link,n.pk),(0,y.z3)({title:"gnviewer.cannotPerfomAction",message:(null==e||null===(t=e.data)||void 0===t?void 0:t.message)||(null==e||null===(o=e.data)||void 0===o?void 0:o.detail)||(null==e||null===(r=e.originalError)||void 0===r?void 0:r.message)||"gnviewer.syncErrorDefault"}))})})}},reducers:{gnDownload:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case s:var t,o=null==e||null===(t=e.link)||void 0===t?void 0:t.split(" ").join("");return D(D({},n),{},{downloads:D(D({},n.downloads),{},k({},o,k({},e.pk,!0)))});case d:var r,i=D({},n),l=null==e||null===(r=e.link)||void 0===r?void 0:r.split(" ").join(""),a=i.downloads[l];return delete a[e.pk],D(D({},i),{},{downloads:D(D({},i.downloads),{},k({},l,D({},a)))});default:return n}}}})}}]);