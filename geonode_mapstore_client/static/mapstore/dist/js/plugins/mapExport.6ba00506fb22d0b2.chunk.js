(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[15872],{434164:(t,e,r)=>{"use strict";r.d(e,{Cc:()=>g,aF:()=>v});var n=r(23412),o=r.n(n),a=(r(400912),r(155584)),i=r(45388),l=r(375482),c=r(995531),u=(r(764932),r(112585)),s=r(492312),f=r(584153),p=r(79738);function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function b(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(Object(r),!0).forEach(function(e){d(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function d(t,e,r){return(e=function(t){var e=function(t){if("object"!=m(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==m(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}a.default;var v=function(t){return i.Observable.defer(function(){return l.Ay.getCapabilities((0,u.wk)(t))}).let(s.m9).map(function(e){return l.Ay.parseLayerCapabilities(e,t)})},g=function(t){return function(t){return i.Observable.defer(function(){return c.A.get(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.name,r=t.search,n=void 0===r?{}:r,a=t.url,i=o().parse((0,p.t)(n.url||a),!0);return o().format(b(b({},i),{},{search:void 0,query:b(b({},i.query),{},{service:"WMS",version:l.j0,layers:e,outputFormat:"application/json",request:"DescribeLayer"})}))}(t))}).let(s.m9)}(t).map(function(t){var e=t.data,r=void 0===e?{}:e;return r&&r.layerDescriptions[0]}).map(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).owsURL;return b(b({},t),{},{params:{},search:e?{type:"wfs",url:(0,f.o_)(e)}:void 0})})}},72737:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>nt});var n={};r.r(n),r.d(n,{exportMapContext:()=>Z});var o=r(273517),a=r.n(o),i=r(8117),l=r(244383),c=r.n(l),u=r(858156),s=r.n(u),f=r(811668),p=r(916589),m=r(801081),y=r(8571),b=r(595535),d=r(415392),v="EXPORT::EXPORT_MAP",g=function(){return{type:v,format:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mapstore2"}},h=r(130711),E=r(318938),w=r.n(E),O=r(711030);function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}const S=function(t){var e=t.show,r=void 0!==e&&e,n=t.formats,o=void 0===n?{}:n,l=t.selectedFormat,c=t.exportButtonLabel,u=void 0===c?a().createElement(y.A,{msgId:"mapExport.exportPanel.exportButtonLabel"}):c,f=t.exportPanelTitle,p=void 0===f?a().createElement(b.A,{msgId:"mapExport.exportPanel.title"}):f,m=t.onSelect,d=void 0===m?function(){}:m,v=t.onExport,g=void 0===v?function(){}:v,h=t.onClose,E=void 0===h?function(){}:h;return r&&a().createElement("div",{className:"export-panel"},a().createElement(O.A,{style:{border:"none",background:"transparent",color:"white",fontSize:35,top:0,right:0,position:"absolute"},onClick:function(){return E()}},a().createElement(i.e6,{glyph:"1-close"})),a().createElement("div",{style:{margin:"auto",maxWidth:550}},a().createElement("div",null,a().createElement("div",{className:"export-panel-heading-icon"},a().createElement(i.e6,{glyph:"upload"})),a().createElement("div",null,p),a().createElement("br",null),a().createElement("div",{className:"export-panel-formats-container"},w()(o).map(function(t){var e,r,n=(r=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,r)||function(t,e){if(t){if("string"==typeof t)return x(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(t,e):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],c=n[1],u=c.label,s=c.glyph;return a().createElement(O.A,{key:o,bsStyle:"default",className:l===o?"format-selected":"",onClick:function(){return d(o)}},a().createElement("div",null,a().createElement(i.e6,{style:{marginRight:"4px"},glyph:s}),u))})),a().createElement("br",null),a().createElement(O.A,{bsStyle:"primary",onClick:function(){return g(l)}},u),a().createElement("br",null),a().createElement("br",null),s()(o,"".concat(l,".description"),null),s()(o,"".concat(l,".note"))&&a().createElement(a().Fragment,null,a().createElement("hr",null),s()(o,"".concat(l,".note"))))))};var j=r(45388),A=r.n(j),P=r(265611),I=r.n(P),C=r(6683),k=r(434164),D=r(153986),M=r(750929),F=r(905185),T=r(131127),N=r(307679),_=r(148936),L=r(914950),U=r(958722),K=r(628017),R=r(761455);function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function q(t){return function(t){if(Array.isArray(t))return $(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||B(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(t,e){if(t){if("string"==typeof t)return $(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$(t,e):void 0}}function $(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function H(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?z(Object(r),!0).forEach(function(e){J(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function J(t,e,r){return(e=function(t){var e=function(t){if("object"!=X(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=X(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==X(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function W(t,e){this.title=t,this.message=e}var G=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=C.Ay.saveMapConfiguration((0,T.mg)(t),(0,N.Kv)(t),(0,N.eK)(t),(0,_.U3)(t),(0,R.r)(t),(0,R.Y)(t),(0,L.a_)(t));return e?H(H({},r),{},{map:H(H({},r.map),{},{bbox:(0,T.mg)(t).bbox})}):r},Y={mapstore2:function(t){return A().Observable.of([JSON.stringify(G(t)),"map.json","application/json"])},wmc:function(t){var e,r=G(t,!0),n=s()(r,"map.layers",[]).filter(function(t){return!!t.url&&"wms"===t.type});if(0===n.length)throw new W("mapExport.errorTitle","mapExport.wmcNoLayersError");return(e=A().Observable).forkJoin.apply(e,q(n.map(function(t){return(0,k.aF)(t).catch(function(){return A().Observable.of(null)})}))).switchMap(function(t){return A().Observable.of([(0,D.F)((0,F.hZ)("map.layers",I()(n,t).map(function(t){var e,r,n=(r=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,r)||B(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],a=n[1];return H(H({},o),{},{capabilities:a})}),r),{}),"context.wmc","application/xml"])})}},Z=function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,r=void 0===e?function(){}:e;return t.ofType(v).switchMap(function(t){var e=t.format;return Y[e](r()).do(function(t){return M.RG.apply(void 0,q(t))}).map(function(){return(0,d.fN)("export","enabled",!1)})}).catch(function(t,e){return A().Observable.of((0,U.X)(H(H({},t instanceof W?t:(0,K.u1)(t)),{},{autoDismiss:6,position:"tc"}))).concat(e)})},Q=r(393149);function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var tt=["mapstore2","wmc"],et=(0,h.cU)("export"),rt=(0,p.compose)((0,f.connect)((0,m.j8)({enabled:et}),{onClose:function(){return(0,d.KP)("export")},onExport:g}),(0,p.defaultProps)({formats:{mapstore2:{label:a().createElement(y.A,{msgId:"mapExport.formats.mapstore2.label"}),description:a().createElement(b.A,{msgId:"mapExport.formats.mapstore2.description"}),glyph:"ext-json"},wmc:{label:a().createElement(y.A,{msgId:"mapExport.formats.wmc.label"}),description:a().createElement(b.A,{msgId:"mapExport.formats.wmc.description"}),note:a().createElement(b.A,{msgId:"mapExport.formats.wmc.note"}),glyph:"ext-wmc"}}}),(0,p.withState)("format","setFormat","mapstore2"))(function(t){var e,r=t.enabled,n=t.format,o=t.formats,i=t.enabledFormats,l=void 0===i?tt:i,u=t.setFormat,s=void 0===u?function(){}:u,f=t.onExport,p=void 0===f?function(){}:f,m=t.onClose,y=void 0===m?function(){}:m;return a().createElement(S,{show:r,formats:c().apply(void 0,[o].concat((e=l,function(t){if(Array.isArray(t))return V(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return V(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?V(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))),selectedFormat:n,onSelect:s,onExport:p,onClose:y})});const nt=(0,Q.i1)("MapExport",{component:rt,containers:{SidebarMenu:function(t){var e=s()(t,"cfg.enabledFormats",tt);return{name:"export",position:4,tooltip:"mapExport.tooltip",text:a().createElement(y.A,{msgId:"mapExport.title"}),icon:a().createElement(i.e6,{glyph:"download"}),action:e.length>1?function(){return(0,d.KP)("export")}:function(){return g(e[0]||"mapstore2")},priority:1,toggle:!0,doNotHide:!0}},BurgerMenu:function(t){var e=s()(t,"cfg.enabledFormats",tt);return{name:"export",position:4,tooltip:"mapExport.tooltip",text:a().createElement(y.A,{msgId:"mapExport.title"}),icon:a().createElement(i.e6,{glyph:"download"}),action:e.length>1?function(){return(0,d.KP)("export")}:function(){return g(e[0]||"mapstore2")},priority:2,toggle:!0,doNotHide:!0}}},epics:n})},958722:(t,e,r)=>{"use strict";r.d(e,{X:()=>o});var n=r(883832),o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.title,r=void 0===e?"notification.warning":e,o=t.autoDismiss,a=void 0===o?6:o,i=t.position,l=void 0===i?"tc":i,c=t.message,u=void 0===c?"Error":c;return(0,n.z3)({title:r,autoDismiss:a,position:l,message:u})}},618330:(t,e,r)=>{var n=r(679770),o=r(634932),a=r(247237),i=r(78096),l=r(683693),c=Math.max;t.exports=function(t){if(!t||!t.length)return[];var e=0;return t=n(t,function(t){if(l(t))return e=c(t.length,e),!0}),i(e,function(e){return o(t,a(e))})}},265611:(t,e,r)=>{var n=r(269302)(r(618330));t.exports=n}}]);