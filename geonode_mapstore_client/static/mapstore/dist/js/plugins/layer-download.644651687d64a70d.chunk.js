/*! For license information please see layer-download.644651687d64a70d.chunk.js.LICENSE.txt */
(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[17004],{654456:(e,t,r)=>{"use strict";r.d(t,{GW:()=>u,IY:()=>a,Ii:()=>w,Jj:()=>y,KF:()=>l,LO:()=>g,Lk:()=>D,Lm:()=>n,MN:()=>E,Mb:()=>S,P:()=>T,Rb:()=>m,UR:()=>O,V8:()=>v,VZ:()=>C,Ve:()=>p,Xi:()=>b,Z4:()=>A,ZJ:()=>i,_Z:()=>f,cv:()=>c,f4:()=>d,jF:()=>h,oR:()=>R,pF:()=>s,qD:()=>o,qu:()=>j,x5:()=>P}),r(995531);var n="LAYER_SELECTED_FOR_SEARCH",o="FEATURE_TYPE_SELECTED",a="FEATURE_TYPE_LOADED",i="FEATURE_LOADED",l="FEATURE_LOADING",s="FEATURE_TYPE_ERROR",u="FEATURE_ERROR",c="QUERY_CREATE",d="QUERY:UPDATE_QUERY",p="QUERY_RESULT",f="QUERY_ERROR",m="RESET_QUERY",y="QUERY",v="INIT_QUERY_PANEL",b="QUERY:TOGGLE_SYNC_WMS",w="QUERY:TOGGLE_LAYER_FILTER";function g(){return{type:b}}function O(){return{type:w}}function h(){return{type:v}}function S(e,t){return{type:o,url:e,typeName:t,fields:arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],owner:arguments.length>3?arguments[3]:void 0}}function E(e,t,r){return{type:a,typeName:e,featureType:t,owner:r}}function A(e,t){return{type:s,typeName:e,error:t}}function P(e){return{type:l,isLoading:e}}function j(e,t,r,n,o){return{type:p,searchUrl:t,filterObj:r,result:e,queryOptions:n,reason:o}}function D(e){return{type:f,error:e}}function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.updates,r=e.reason,n=e.useLayerFilter;return{type:d,updates:t,reason:r,useLayerFilter:n}}function C(e,t,r){return{type:c,searchUrl:e,filterObj:t,owner:r}}function T(e,t,r,n){return{type:y,searchUrl:e,filterObj:t,queryOptions:r,reason:n}}},926560:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(916589),o=r(164045),a=r(509820);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var l=["renderPopover","popoverOptions"];function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function u(e,t,r){return(t=function(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const c=(0,n.compose)((0,n.withProps)(function(e){var t=e.renderPopover,r=e.popoverOptions;return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}(t?{renderPopover:t,popoverOptions:r}:{},function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,l))}),(0,n.branch)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.renderPopover,r=e.popoverOptions;return t&&!!r},a.A,o.A))},509820:(e,t,r)=>{"use strict";r.d(t,{A:()=>g});var n=r(273517),o=r.n(n),a=r(551258),i=r(8117),l=r(590179),s=r.n(l),u=r(310340),c=r.n(u);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}var p=["popoverOptions","keyProp"];function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f.apply(null,arguments)}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e){if("object"!=d(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(v=function(){return!!e})()}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}const g=function(e){return function(t){function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),function(e,t,r){return t=b(t),function(e,t){if(t&&("object"==d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,v()?Reflect.construct(t,r||[],b(e).constructor):t.apply(e,r))}(this,r,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(r,t),n=r,l=[{key:"render",value:function(){var t=null,r=this.props,n=r.popoverOptions,l=r.keyProp,u=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(r,p);return o().createElement("span",{className:"mapstore-info-popover"},o().createElement(e,f({},s()(u,["renderPopover","tooltipId"]),{key:l,ref:function(e){t=e}})),o().createElement(a.A,{placement:n.placement,shouldUpdatePosition:!0,show:!0,target:function(){return c().findDOMNode(t)}},o().createElement(i.AM,n.props,n.content)))}}],l&&m(n.prototype,l),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,l}(o().Component)}},628304:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var n=r(273517),o=r.n(n),a=r(8117),i=r(711030),l=["disabled","id","visible","onClick","glyph","active","className"];function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(null,arguments)}var u={width:0,padding:0,borderWidth:0},c={},d=function(e){return e?c:u};const p=(0,n.forwardRef)(function(e,t){var r=e.disabled,n=e.id,u=e.visible,c=e.onClick,p=e.glyph,f=e.active,m=e.className,y=void 0===m?"square-button-md":m,v=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,l);return o().createElement(i.A,s({ref:t},v,{bsStyle:f?"success":"primary",disabled:r,id:"fg-".concat(n),style:d(u),className:y,onClick:function(){return!r&&c()}}),o().createElement(a.e6,{glyph:p}))})},545567:(e,t,r)=>{"use strict";r.d(t,{EV:()=>V,Gw:()=>G,o0:()=>M,sq:()=>U});var n=r(23412),o=r.n(n),a=r(956449),i=r.n(a),l=r(499084),s=r.n(l),u=r(269843),c=r.n(u),d=r(223805),p=r.n(d),f=r(45388),m=r.n(f),y=r(738805),v=r(692114),b=r(995531),w=r(102685),g=r(112585),O=r(492312),h=r(193275),S=r(79738),E=["totalFeatures","features"],A=["sortOptions","propertyName"];function P(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?j(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function R(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach(function(t){F(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function F(e,t,r){return(t=function(e){var t=function(e){if("object"!=D(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==D(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var L=(0,h.A)({wfsVersion:"1.1.0"}),x=L.getFeature,N=L.query,I=L.sortBy,_=L.propertyName,k=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"json",a=(0,w.zD)(t,r),i=o().parse((0,S.t)(e),!0),l=p()(i.query)?i.query:{};l.service="WFS",l.outputFormat=n;var s=o().format({protocol:i.protocol,host:i.host,pathname:i.pathname,query:l});return r.layer&&"vector"===r.layer.type?m().Observable.defer(function(){return new Promise(function(e){var n,o=function(e,t){if(t.filterFields&&0!==t.filterFields.length){var r=e.features.filter((0,w.Jt)(t));e.features=r,e.numberMatched=r.length,e.numberReturned=r.length,e.totalFeatures=r.length}return t.sortOptions&&t.sortOptions.sortBy&&t.sortOptions.sortOrder&&"NONE"!==t.sortOptions.sortOrder&&e.features.sort(function(e,r){var n=e.properties[t.sortOptions.sortBy],o=r.properties[t.sortOptions.sortBy],a=n.toLowerCase().localeCompare(o.toLowerCase());return"ASC"===t.sortOptions.sortOrder?a:-1*a}),e}({crs:{type:"name",properties:{name:"urn:ogc:def:crs:EPSG::4326"}},numberMatched:(n=r.layer.features).length,numberReturned:n.length,timeStamp:"2020-07-20T11:36:20.118Z",totalFeatures:n.length,type:"FeatureCollection",features:n},t);e(o)})}):{data:a,queryString:s}},M=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;if(r.layer&&"vector"===r.layer.type)return k(e,t,r,n);var o=k(e,t,r,n),a=o.data,i=o.queryString;return m().Observable.defer(function(){return b.A.post(i,a,{timeout:6e4,responseType:"arraybuffer",headers:{Accept:"application/xml","Content-Type":"application/xml"}})})},W=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(r.layer&&"vector"===r.layer.type)return k(e,t,r);var n=k(e,t,r),o=n.data,a=n.queryString;return m().Observable.defer(function(){return b.A.post(a,o,T({timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/xml"}},null==r?void 0:r.requestOptions))}).let(O.m9).map(function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.totalFeatures,r=e.features,n=R(e,E),o=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).startIndex,a=arguments.length>2?arguments[2]:void 0;return a>t&&a===o+r.length&&t===r.length?T(T({},n),{},{features:r,totalFeatures:a}):T(T({},n),{},{features:r,totalFeatures:t})}(e.data,function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).pagination||!c()(e.startIndex)&&!c()(e.maxFeatures)&&{startIndex:e.startIndex,maxFeatures:e.maxFeatures}}(t,r),r.totalFeatures)})},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.search,r=void 0===t?{}:t,n=e.url,o=e.name,a=arguments.length>1?arguments[1]:void 0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=l.sortOptions,c=l.propertyName,d=R(l,A);return W(r.url||n,a&&"object"===D(a)?T(T({},a),{},{typeName:o||a.typeName}):x(N(o,[].concat(P(u?[I(u.sortBy,u.sortOrder)]:[]),P(c?[_(c)]:[]),P(a?s()(a):[]))),d),d).catch(function(e){if("OGCError"===e.name&&"NoApplicableCode"===e.code&&!u&&c&&c[0])return W(r.url||n,a&&"object"===D(a)?T(T({},a),{},{typeName:o||a.typeName}):x(N(o,[I(i()(c)?c[0]:c)].concat(P(c?[_(c)]:[]),P(a?s()(a):[]))),d),d);throw e})},U=function(e){var t=e.layer;return m().Observable.defer(function(){return b.A.get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.search,n=void 0===r?{}:r,a=e.url,i=e.describeFeatureTypeURL,l=o().parse((0,S.t)(i||n.url||a),!0);return o().format(T(T({},l),{},{search:void 0,query:T(T({},l.query),{},{service:"WFS",version:"1.1.0",typeName:t,outputFormat:"application/json",request:"DescribeFeatureType"})}))}(t))}).let(O.m9)},V=function(e){var t=e.layer;return m().Observable.defer(function(){return b.A.get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.search,n=void 0===r?{}:r,a=e.url,i=(0,g.wk)({name:t,url:n&&n.url||a}),l=o().parse(i,!0);return o().format(T(T({},l),{},{search:void 0,query:T(T({},l.query),{},{service:"WFS",version:"1.1.1",request:"GetCapabilities"})}))}(t))}).let(O.m9).switchMap(function(e){return m().Observable.bindNodeCallback(function(e,t){return(0,y.parseString)(e,{tagNameProcessors:[v.stripPrefix],explicitArray:!1,mergeAttrs:!0},t)})(e.data)})}},909309:(e,t,r)=>{"use strict";r.d(t,{l:()=>l});var n=r(45388),o=r(995531),a=r(492312),i=r(325177),l=function(e,t){return n.Observable.defer(function(){return o.A.get((0,i.Sd)(e,{version:"1.0.0",REQUEST:"DescribeProcess",IDENTIFIER:t}),{timeout:5e3,headers:{Accept:"application/json","Content-Type":"application/xml"}})}).let(a.m9)}},845657:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Sr});var n={};r.r(n),r.d(n,{checkExportDataEntriesEpic:()=>nr,closeExportDownload:()=>rr,fetchFormatsWFSDownload:()=>er,openDownloadTool:()=>Qt,resetExportDataResultsOnLogout:()=>ar,serializeCookieOnExportDataChange:()=>or,setExportDataResultsOnLoginSuccessAndMapConfigLoaded:()=>ir,startFeatureExportDownload:()=>tr});var o=r(273517),a=r.n(o),i=r(811668),l=r(801081),s="LAYERDOWNLOAD:DOWNLOAD_FEATURES",u="LAYERDOWNLOAD:DOWNLOAD_FINISHED",c="LAYERDOWNLOAD:FORMAT_SELECTED",d="LAYERDOWNLOAD:CLEAR_DOWNLOAD_OPTIONS",p="LAYERDOWNLOAD:FORMAT_FETCH",f="LAYERDOWNLOAD:FORMAT_UPDATE",m="LAYERDOWNLOAD:SET_WPS_AVAILABLE",y="LAYERDOWNLOAD:SET_SERVICE",v="LAYERDOWNLOAD:SET_EXPORT_DATA_RESULTS",b="LAYERDOWNLOAD:ADD_EXPORT_DATA_RESULT",w="LAYERDOWNLOAD:UPDATE_EXPORT_DATA_RESULT",g="LAYERDOWNLOAD:REMOVE_EXPORT_DATA_RESULT",O="LAYERDOWNLOAD:REMOVE_EXPORT_DATA_RESULTS",h="LAYERDOWNLOAD:CHECK_EXPORT_DATA_ENTRIES",S="LAYERDOWNLOAD:CHECKING_EXPORT_DATA_ENTRIES",E="LAYERDOWNLOAD:SERIALIZE_COOKIE",A=function(e,t){return{type:c,key:e,value:t}},P=function(){return{type:u}},j=function(e){return{type:v,results:e}},D=function(e,t){return{type:w,id:e,newProps:t}},R=function(e){return{type:S,checking:e}},C=r(415392),T=r(904059),F=r(401631),L=r(307679),x=r(806653),N=r(737704),I=function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.service},_=function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.downloadLayer},k=(0,l.Mz)(F.py,x.fQ,L.ZT,_,N.u9,function(e,t,r,n,o){var a=r||n,i=o.filter(function(e){return e.id===(null==n?void 0:n.widgetId)})[0];return e?t||(null==i?void 0:i.filter):null!=a&&a.name?(null==i?void 0:i.filter)||{featureTypeName:a.name,filterType:"OGC",ogcVersion:"1.1.0"}:null}),M=function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.results},W=r(286447),G=r(605556),U=r.n(G),V=r(324713),q=r.n(V),Y=r(400912),H=r.n(Y),X=r(45228),B=r.n(X),z=r(8117),K=r(750042),Z=r.n(K),$=r(275705),J=r(711520),Q=r(406250),ee=r(8571),te=r(3162),re=r(192016),ne=r(858156),oe=r.n(ne),ae=r(223805),ie=r.n(ae),le=r(962193),se=r.n(le),ue=r(302404),ce=r.n(ue),de=r(168995),pe=r(185015),fe=r.n(pe),me=r(348317);function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const ve=function(e){var t,r,n=e.advancedOptionsVisible,i=void 0===n||n,l=e.cropDataSetVisible,s=void 0!==l&&l,u=e.cropDataSetEnabled,c=void 0!==u&&u,d=e.downloadFilteredVisible,p=void 0!==d&&d,f=e.downloadFilteredEnabled,m=void 0!==f&&f,y=e.rasterOptionsVisibile,v=void 0!==y&&y,b=e.compressionOptions,w=void 0===b?["Deflate","JPEG","PackBits","LZW","CCITT RLE","ZLib"]:b,g=e.selectedCompression,O=e.tileWidth,h=e.tileHeight,S=e.quality,E=e.placeholders,A=void 0===E?{tileWidth:"256",tileHeight:"256",quality:"0.75"}:E,P=e.srsList,j=e.selectedSrs,D=e.onChange,R=void 0===D?function(){}:D,C=(t=(0,o.useState)(!1),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,r)||function(e,t){if(e){if("string"==typeof e)return ye(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ye(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),T=C[0],F=C[1];return(0,o.useEffect)(function(){R("compression",g||H()(w))},[]),a().createElement(a().Fragment,null,i&&a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-options"},a().createElement(z.$n,{className:"no-border",onClick:function(){return F(!T)}},a().createElement(z.e6,{glyph:"chevron-".concat(T?"down":"right")}),"   ",a().createElement(ee.A,{msgId:"layerdownload.advancedOptions"}))),T&&i&&a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced"},a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement("label",null,a().createElement(ee.A,{msgId:"layerdownload.srs"})),a().createElement(re.Ay,{clearable:!1,value:j,onChange:function(e){return R("selectedSrs",e.value)},options:P.map(function(e){return{value:e.name,label:e.label||e.name}})}))),s&&a().createElement(a().Fragment,null,a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(me.A,{checked:c,onClick:function(e){return R("cropDataSet",e)}}),a().createElement(ee.A,{msgId:"layerdownload.cropDataSet"})))),p&&a().createElement(a().Fragment,null,a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(me.A,{checked:m,onClick:function(e){return R("downloadFilteredDataSet",e)}}),a().createElement(ee.A,{msgId:"layerdownload.downloadFilteredDataSet"})))),v&&a().createElement(a().Fragment,null,a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement(ee.A,{msgId:"layerdownload.compression"}),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(re.Ay,{clearable:!1,value:g,options:w.map(function(e){return fe()(e)?{value:e,label:e}:e}),onChange:function(e){return R("compression",null==e?void 0:e.value)}}))),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement(ee.A,{msgId:"layerdownload.quality"}),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(z.MJ,{placeholder:A.quality,type:"number",size:"4",min:"0",max:"1",step:"0.1",value:S||"",onChange:function(e){return R("quality",e.target.value)}}))),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement(ee.A,{msgId:"layerdownload.tileWidth"}),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(z.MJ,{placeholder:A.tileWidth,type:"number",size:"4",min:"0",value:O||"",onChange:function(e){return R("tileWidth",e.target.value&&e.target.value.length>0?"".concat(parseInt(e.target.value,10)):"")}}),a().createElement("span",null,"px"))),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement(ee.A,{msgId:"layerdownload.tileHeight"}),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(z.MJ,{placeholder:A.tileHeight,type:"number",size:"4",min:"0",value:h||"",onChange:function(e){return R("tileHeight",e.target.value&&e.target.value.length>0?"".concat(parseInt(e.target.value,10)):"")}}),a().createElement("span",null,"px"))))))};function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}function we(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ee(n.key),n)}}function ge(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ge=function(){return!!e})()}function Oe(e){return Oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Oe(e)}function he(e,t){return he=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},he(e,t)}function Se(e,t,r){return(t=Ee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ee(e){var t=function(e){if("object"!=be(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=be(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==be(t)?t:t+""}var Ae=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Se(r=function(e,t,r){return t=Oe(t),function(e,t){if(t&&("object"==be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ge()?Reflect.construct(t,r||[],Oe(e).constructor):t.apply(e,r))}(this,t,[e]),"componentDidMount",function(){r.props.onClearDownloadOptions(r.props.defaultSelectedService);var e=oe()(r.props,"downloadOptions.selectedFormat")||oe()(H()(r.props.formats),"name"),t=oe()(r.props,"downloadOptions.selectedSrs")||oe()(r.props,"defaultSrs")||oe()(H()(r.props.srsList),"name"),n=oe()(r.props,"layer.layerFilter"),o=ie()(n)&&!se()(n)||r.props.filterObj;r.props.onChange("selectedFormat",e),r.props.onChange("selectedSrs",t),r.props.onChange("downloadFilteredDataSet",o),r.props.formatOptionsFetch(r.props.layer)}),Se(r,"componentWillReceiveProps",function(e){if(!ce()(r.props.formats,e.formats)){var t=oe()(e,"downloadOptions.selectedFormat")||oe()(H()(e.formats),"name");e.onChange("selectedFormat",t)}if(ce()(r.props.service,e.service)||e.formatOptionsFetch(e.layer),!ce()(r.props.layer,e.layer)){var n=oe()(e,"layer.layerFilter"),o=ie()(n)&&!se()(n)||e.filterObj;e.onChange("downloadFilteredDataSet",o)}if(!ce()(r.props.srsList,e.srsList)){var a=oe()(e,"downloadOptions.selectedSrs")||oe()(e,"defaultSrs")||oe()(H()(e.srsList),"name");e.onChange("selectedSrs",a)}}),Se(r,"componentWillUnmount",function(){r.props.onClearDownloadOptions(r.props.defaultSelectedService)}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&he(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e,t,r=this,n=this.props.formats.some(function(e){return"raster"===e.type});return a().createElement("form",null,!this.props.hideServiceSelector&&this.props.wpsAvailable&&this.props.wfsAvailable&&a().createElement("div",{className:"mapstore-downloadoptions downloadMode"},a().createElement("label",null,a().createElement(ee.A,{msgId:"layerdownload.downloadMode"})),a().createElement("div",{className:"mapstore-downloadoptions-row"},a().createElement(re.Ay,{clearable:!1,value:this.props.service,onChange:function(e){return r.props.onSetService(e.value)},options:this.props.services})," ",a().createElement(de.A,{text:a().createElement(ee.A,{msgId:"layerdownload.services.".concat(this.props.service,".tooltip")})}))),a().createElement("div",{className:"mapstore-downloadoptions"},a().createElement("label",null,a().createElement(ee.A,{msgId:"layerdownload.format"})),a().createElement(re.Ay,{clearable:!1,isLoading:this.props.formatsLoading,onOpen:function(){return r.props.formatOptionsFetch(r.props.layer)},value:null===(e=this.props.downloadOptions)||void 0===e?void 0:e.selectedFormat,noResultsText:a().createElement(ee.A,{msgId:"layerdownload.format"}),onChange:function(e){return r.props.onChange("selectedFormat",e.value)},options:this.props.formats.map(function(e){return{value:e.name,label:e.label||e.name}})})),a().createElement(ve,{srsList:this.props.srsList,selectedSrs:null===(t=this.props.downloadOptions)||void 0===t?void 0:t.selectedSrs,cropDataSetVisible:this.props.cropDataSetVisible,advancedOptionsVisible:!0,wpsOptionsVisible:!0,rasterOptionsVisibile:n,downloadFilteredVisible:this.props.downloadFilteredVisible,downloadFilteredEnabled:this.props.downloadOptions.downloadFilteredDataSet,cropDataSetEnabled:this.props.downloadOptions.cropDataSet,selectedCompression:this.props.downloadOptions.compression,quality:this.props.downloadOptions.quality,tileWidth:this.props.downloadOptions.tileWidth,tileHeight:this.props.downloadOptions.tileHeight,onChange:this.props.onChange}),this.props.virtualScroll?null:a().createElement(z.Sc,{checked:this.props.downloadOptions.singlePage,onChange:function(){return r.props.onChange("singlePage",!r.props.downloadOptions.singlePage)}},a().createElement(ee.A,{msgId:"layerdownload.downloadonlycurrentpage"})))}}])&&we(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);Se(Ae,"propTypes",{cropDataSetVisible:U().bool,defaultSelectedService:U().bool,defaultSrs:U().string,downloadFilteredVisible:U().bool,downloadOptions:U().object,formatOptionsFetch:U().func,formats:U().array,formatsLoading:U().bool,filterObj:U().object,hideServiceSelector:U().bool,layer:U().object,onChange:U().func,onClearDownloadOptions:U().func,onSetService:U().func,service:U().string,services:U().arrayOf(U().object),srsList:U().array,virtualScroll:U().bool,wfsAvailable:U().bool,wpsAdvancedOptionsVisible:U().bool,wpsAvailable:U().bool,wpsOptionsVisible:U().bool}),Se(Ae,"defaultProps",{cropDataSetVisible:!0,wpsAvailable:!1,wfsAvailable:!0,downloadOptions:{},formats:[],onChange:function(){},onClearDownloadOptions:function(){},formatOptionsFetch:function(){},formatsLoading:!1,srsList:[],wpsOptionsVisible:!1,wpsAdvancedOptionsVisible:!1,downloadFilteredVisible:!1,virtualScroll:!0,services:[{value:"wps",label:a().createElement(ee.A,{msgId:"layerdownload.services.wps.title"})},{value:"wfs",label:a().createElement(ee.A,{msgId:"layerdownload.services.wfs.title"})}],hideServiceSelector:!1});const Pe=Ae;var je=r(711030),De=r(525859),Re=r(738805),Ce=r(692114),Te=r(909309);function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Le=function(e){var t,r,n,i,l,s,u=e.attributes,c=e.checkingWPSAvailability,d=e.closeGlyph,p=e.cropDataSetVisible,f=e.customAttributeSettings,m=e.defaultSelectedService,y=e.defaultSrs,v=e.downloadLayer,b=e.downloadOptions,w=e.enabled,g=e.filterObj,O=e.formats,h=e.formatsLoading,S=e.hideServiceSelector,E=e.loading,A=e.mapLayer,P=e.onClearDownloadOptions,j=e.onClose,D=e.onDownloadOptionChange,R=e.onExport,C=e.onFormatOptionsFetch,T=e.onSetService,F=e.onSetWPSAvailability,L=e.service,x=e.srsList,N=e.virtualScroll,I=e.wfsFormats,_=e.wpsAvailable,k=A||v||{},M=(l=(0,o.useState)(!1),s=2,function(e){if(Array.isArray(e))return e}(l)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(l,s)||function(e,t){if(e){if("string"==typeof e)return Fe(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Fe(e,t):void 0}}(l,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),W=M[0],G=M[1];(0,o.useEffect)(function(){var e,t;w&&(P(m),e=k,t=m,G(!0),(0,Te.l)(e.url,"gs:DownloadEstimator,gs:Download").toPromise().then(function(e){return new Promise(function(t,r){return(0,Re.parseString)(e.data,{tagNameProcessors:[Ce.stripPrefix]},function(e,n){return e?r(e):t(n)})})}).then(function(r){var n,o,a,i=[null==r||null===(n=r.ProcessDescriptions)||void 0===n||null===(n=n.ProcessDescription)||void 0===n||null===(n=n[0])||void 0===n||null===(n=n.Identifier)||void 0===n?void 0:n[0],null==r||null===(o=r.ProcessDescriptions)||void 0===o||null===(o=o.ProcessDescription)||void 0===o||null===(o=o[1])||void 0===o||null===(o=o.Identifier)||void 0===o?void 0:o[0]],l=q()(i,function(e){return"gs:DownloadEstimator"===e})>-1&&q()(i,function(e){return"gs:Download"===e})>-1,s=null===(a=e.search)||void 0===a?void 0:a.url,u=l&&("wps"===t||!s);T(u?"wps":"wfs"),F(u)}).catch(function(){T("wfs"),F(!1)}).finally(function(){G(!1)}))},[w,k,m]);var U=function(e){return O.filter(function(t){var r,n,o=t.validServices,a=t.type,i=void 0===a?"vector":a;return(!o||q()(o,function(t){return t===e})>-1)&&("vector"===i&&(null==k||null===(r=k.search)||void 0===r?void 0:r.url)||"raster"===i&&!(null!=k&&null!==(n=k.search)&&void 0!==n&&n.url))})},V=U("wfs"),Y=U("wps"),X=V.length>0?V.filter(function(e){return I.find(function(t){return t.name.toLowerCase()===e.name.toLowerCase()})}):I,K=Boolean(null==k||null===(t=k.search)||void 0===t?void 0:t.url),re="wfs"===L?X:Y;return w?a().createElement(Q.A,null,a().createElement(J.A,{id:"mapstore-export",draggable:!1,modal:!0},a().createElement("span",{role:"header"},a().createElement("span",{className:"modal-title  about-panel-title"},a().createElement(ee.A,{msgId:"layerdownload.title"})),a().createElement("button",{onClick:j,className:"settings-panel-close close"},d?a().createElement(z.e6,{glyph:d}):a().createElement("span",null,"×"))),a().createElement("div",{role:"body"},W?a().createElement($.A,{size:100,style:{margin:"0 auto"}}):_||K?a().createElement(Pe,{attributes:u,cropDataSetVisible:p,customAttributesSettings:f,defaultSelectedService:m,defaultSrs:y,downloadFilteredVisible:!(null==k||!k.layerFilter)||!(null==g||null===(r=g.filterFields)||void 0===r||!r.length)||(null==g||null===(n=g.spatialFields)||void 0===n?void 0:n.length),downloadOptions:b,filterObj:g,formatOptionsFetch:"wfs"===L?C:function(){},formats:re,formatsLoading:h,hideServiceSelector:S,layer:k,onChange:D,onClearDownloadOptions:P,onSetService:T,service:L,srsList:x,virtualScroll:N,wfsAvailable:K,wpsAdvancedOptionsVisible:!(null!=k&&null!==(i=k.search)&&void 0!==i&&i.url),wpsAvailable:_}):a().createElement(te.A,{title:a().createElement(ee.A,{msgId:"layerdownload.noSupportedServiceFound"})})),!c&&a().createElement("div",{role:"footer"},a().createElement(je.A,{bsStyle:"primary",className:"download-button",disabled:h||0===O.length,onClick:function(){var e=b&&b.selectedSrs||y||(H()(x)||{}).name,t=(0,De.Eo)(u,f);R(null==k?void 0:k.url,g,B()({},b,{selectedSrs:e},{propertyName:t}))}},E?a().createElement("div",{style:{float:"left"}},a().createElement(Z(),{spinnerName:"circle",noFadeIn:!0})):a().createElement(z.e6,{glyph:"download"})," ",a().createElement(ee.A,{msgId:"layerdownload.export"}))))):null};Le.propTypes={attributes:U().array,checkingWPSAvailability:U().bool,closeGlyph:U().string,cropDataSetVisible:U().bool,customAttributeSettings:U().object,defaultSelectedService:U().string,defaultSrs:U().string,downloadLayer:U().object,downloadOptions:U().object,enabled:U().bool,filterObj:U().object,formats:U().array,formatsLoading:U().bool,hideServiceSelector:U().bool,loading:U().bool,mapLayer:U().object,onCheckWPSAvailability:U().func,onClearDownloadOptions:U().func,onClose:U().func,onDownloadOptionChange:U().func,onExport:U().func,onFormatOptionsFetch:U().func,onSetService:U().func,onSetWPSAvailability:U().func,service:U().string,srsList:U().array,virtualScroll:U().bool,wfsFormats:U().array,wpsAvailable:U().bool},Le.defaultProps={onExport:function(){},onClose:function(){},onCheckWPSAvailability:function(){},onSetService:function(){},onSetWPSAvailability:function(){},onDownloadOptionChange:function(){},onClearDownloadOptions:function(){},onFormatOptionsFetch:function(){},checkingWPSAvailability:!1,closeGlyph:"1-close",wpsAvailable:!1,service:"wfs",defaultSelectedService:"wps",wfsFormats:[],formats:[{name:"image/tiff",label:"TIFF",type:"raster",validServices:["wps"]},{name:"application/arcgrid",label:"ArcGrid",type:"raster",validServices:["wps"]},{name:"application/json",label:"GeoJSON",type:"vector",validServices:["wps"]},{name:"application/zip",label:"Shapefile",type:"vector",validServices:["wps"]},{name:"text/csv",label:"CSV",type:"vector",validServices:["wps"]},{name:"application/wfs-collection-1.0",label:"GML2",type:"vector",validServices:["wps"]},{name:"application/wfs-collection-1.1",label:"GML3",type:"vector",validServices:["wps"]}],formatsLoading:!1,srsList:[{name:"native",label:"Native"},{name:"EPSG:4326",label:"WGS84"}],virtualScroll:!0,downloadOptions:{},hideServiceSelector:!1};const xe=Le;var Ne=r(563864),Ie=r(306840),_e=r(112585),ke=a().createElement(z.$n,{bsStyle:"primary",bsSize:"small",className:"mapstore-exportdataresults-item-failed"},a().createElement(z.e6,{glyph:"exclamation-sign"}));const Me=(0,Ne.A)(function(e){var t=e.results;return!(void 0===t?[]:t).length},{title:a().createElement(ee.A,{msgId:"exportDataResults.emptyStateMessage"})})(function(e){var t=e.loading,r=void 0!==t&&t,n=e.results,o=void 0===n?[]:n,i=e.currentLocale,l=e.onRemoveResult,s=void 0===l?function(){}:l;return r?a().createElement($.A,{size:100,style:{margin:"0 auto",padding:"10px"}}):a().createElement("div",{className:"mapstore-exportdataresults-container"},o.map(function(e){var t=e.id,r=e.layerName,n=e.layerTitle,o=e.startTime,l=e.status,u=e.result,c=(0,_e.ez)({name:r,title:n},i),d=new Date(o),p=function(e){return e<10?"0".concat(e):"".concat(e)},f="".concat(p(d.getDate()),"/").concat(p(d.getMonth()+1),"/").concat(d.getFullYear()," ").concat(p(d.getHours()),":").concat(p(d.getMinutes()));return a().createElement("div",{key:t,className:"mapstore-exportdataresults-item"},a().createElement("div",{className:"mapstore-exportdataresults-item-name"},c),a().createElement("div",{className:"mapstore-exportdataresults-item-date"},f),a().createElement("div",{className:"mapstore-exportdataresults-item-buttons"},"pending"===l&&a().createElement($.A,{size:22,style:{marginLeft:"2px"}}),"failed"===l&&u&&u.msgId?a().createElement(Ie.A,{placement:"top",overlay:a().createElement(z.m_,{id:"exportresults-failure-tooltip"},a().createElement(ee.A,{msgId:u.msgId,msgParams:u.msgParams}))},ke):null,"failed"!==l||u&&u.msgId?null:ke,"completed"===l&&a().createElement("a",{href:u,target:"_blank",rel:"noopener noreferrer"},a().createElement(z.$n,{bsStyle:"primary",bsSize:"small"},a().createElement(z.e6,{glyph:"floppy-disk"}))),a().createElement(z.$n,{bsStyle:"primary",bsSize:"small",onClick:function(){return s(t)}},a().createElement(z.e6,{glyph:"trash"}))))}))});var We=r(926560),Ge=r(628304),Ue=(0,We.A)(Ge.A),Ve=r(45388),qe=r.n(Ve),Ye=r(269843),He=r.n(Ye),Xe=r(907309),Be=r.n(Xe),ze=r(244383),Ke=r.n(ze),Ze=r(318938),$e=r.n(Ze),Je=r(499084),Qe=r.n(Je),et=r(791936),tt=r(541033),rt=r.n(tt),nt=r(980971),ot=r(654456),at=r(883832),it=r(754364),lt=r(538704),st=r(130711),ut=r(131127),ct=r(501719),dt=r(545567),pt=r(395950),ft=r.n(pt),mt=r(590179),yt=r.n(mt),vt=r(325177),bt=r(264053);function wt(e){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wt(e)}function gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(r),!0).forEach(function(t){ht(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gt(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ht(e,t,r){return(t=function(e){var t=function(e){if("object"!=wt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==wt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function St(e){return function(e){if(Array.isArray(e))return At(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Et(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Et(e,t){if(e){if("string"==typeof e)return At(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?At(e,t):void 0}}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Pt=function(e){var t=e.type,r=e.data;return"TEXT"===t?(0,vt.oW)((0,vt.Xs)((0,vt.Gr)(r.data),r.mimeType)):(0,vt.Nj)(r.mimeType,r.href,r.method,(0,vt.Gr)(r.requestBodyData))},jt=function(e,t,r){if(e&&t){var n=(0,bt.p4)(e,(l=(i={layerName:t.layerName,ROI:t.ROI,roiCRS:t.roiCRS,dataFilter:t.dataFilter,targetCRS:t.targetCRS}).layerName,s=i.ROI,u=i.roiCRS,c=i.dataFilter,d=i.targetCRS,(0,bt.Yy)("gs:DownloadEstimator",[(0,vt.XH)("layerName",(0,vt.oW)((0,vt.mC)(l)))].concat(St(s?[(0,vt.XH)("ROI",Pt(s))]:[]),St(u?[(0,vt.XH)("RoiCRS",(0,vt.oW)((0,vt.mC)(u)))]:[]),St(c?[(0,vt.XH)("filter",Pt(c))]:[]),St(d?[(0,vt.XH)("targetCRS",(0,vt.oW)((0,vt.mC)(d)))]:[])))),{outputsExtractor:(0,bt.$t)(bt.J7)}),o=t.resultOutput||t.outputFormat||"application/zip",a=(0,bt.p4)(e,function(e){var t=e.layerName,r=e.dataFilter,n=e.outputFormat,o=e.targetCRS,a=e.roiCRS,i=e.ROI,l=e.cropToROI,s=e.asynchronous,u=e.outputAsReference,c=e.resultOutput,d=e.writeParameters;return(0,bt.Yy)("gs:Download",[(0,vt.XH)("layerName",(0,vt.oW)((0,vt.mC)(t))),(0,vt.XH)("outputFormat",(0,vt.oW)((0,vt.mC)(n)))].concat(St(i?[(0,vt.XH)("ROI",Pt(i))]:[]),St(r?[(0,vt.XH)("filter",Pt(r))]:[]),St(o?[(0,vt.XH)("targetCRS",(0,vt.oW)((0,vt.mC)(o)))]:[]),St(a?[(0,vt.XH)("RoiCRS",(0,vt.oW)((0,vt.mC)(a)))]:[]),[(0,vt.XH)("cropToROI",(0,vt.oW)((0,vt.mC)(l?"true":"false")))],St(d&&ft()(d).length>0?[(0,vt.Xk)($e()(d).map(function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,r)||Et(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],a=n[1];return(0,vt._y)(o,a)}).join(""))]:[])),(0,vt.mk)(s?(0,vt.ru)(!0,!0,u?(0,vt.Xi)(c,!0,"result"):(0,vt.Cs)("result",c)):(0,vt.Cs)("result",c)))}(Ot(Ot({},yt()(t,"notifyDownloadEstimatorSuccess","attribute")),{},{outputAsReference:!!t.asynchronous&&t.outputAsReference,resultOutput:o})),r,{headers:{"Content-Type":"application/xml",Accept:"application/xml, ".concat(o)}});return n.catch(function(){throw new Error("DownloadEstimatorException")}).mergeMap(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length>0&&"result"===e[0].identifier&&"true"===e[0].data)return t.notifyDownloadEstimatorSuccess?Ve.Observable.of("DownloadEstimatorSuccess").concat(a):a;throw new Error("DownloadEstimatorFailed")})}var i,l,s,u,c,d;return Ve.Observable.empty()},Dt=r(102685),Rt=r(564116),Ct=r(764932),Tt=r(492312),Ft=r(193275),Lt=r(184435),xt=r(112206);function Nt(e){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nt(e)}function It(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?It(Object(r),!0).forEach(function(t){kt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):It(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function kt(e,t,r){return(t=function(e){var t=function(e){if("object"!=Nt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Nt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Nt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mt(e){return function(e){if(Array.isArray(e))return Gt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Wt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wt(e,t){if(e){if("string"==typeof e)return Gt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Gt(e,t):void 0}}function Gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Ut={gml3:"GML3.1",GML2:"GML2","DXF-ZIP":"DXF-ZIP","application/vnd.google-earth.kml+xml":"KML","OGR-CSV":"OGR-CSV","OGR-FileGDB":"OGR-GeoDatabase","OGR-GPKG":"OGR-GeoPackage","OGR-KML":"OGR-KML","OGR-MIF":"OGR-MIF","OGR-TAB":"OGR-TAB","SHAPE-ZIP":"Shapefile",gml32:"GML3.2","application/json":"GeoJSON",csv:"CSV","application/x-gpkg":"GeoPackage",excel:"excel",excel2007:"excel2007"},Vt=(0,Ft.A)({wfsVersion:"1.1.0"}),qt=Vt.getFeature,Yt=Vt.query,Ht=Vt.sortBy,Xt=Vt.propertyName,Bt=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=null!==(e=null==t?void 0:t.params)&&void 0!==e?e:{};return null==r?void 0:r[Object.keys(r).find(function(e){return"cql_filter"===(null==e?void 0:e.toLowerCase())})]},zt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.filterObj,n=void 0===r?{}:r,o=e.layerFilter,a=e.layer,i=e.downloadOptions,l=void 0===i?{}:i,s=e.options,u=s.sortOptions,c=s.propertyNames,d=Bt(a),p=(0,Dt.o2)({ogcVersion:"1.1.0",addXmlnsToRoot:!0,xmlnsToAdd:['xmlns:ogc="http://www.opengis.net/ogc"','xmlns:gml="http://www.opengis.net/gml"']},l.downloadFilteredDataSet?o:{},l.downloadFilteredDataSet?n:{},d);return(0,dt.o0)(t,qt(Yt(n.featureTypeName,[].concat(Mt(u?[Ht(u.sortBy,u.sortOrder)]:[]),Mt(c?[Xt(c)]:[]),Mt(p?Qe()(p):[])),{srsName:l.selectedSrs})),s,l.selectedFormat)},Kt=function(e){var t=oe()(e,"filterObj.featureTypeName")||"suca",r=(0,Rt.ic)(oe()(e,"downloadOptions.selectedFormat"));return r&&r.extension?t+"."+r.extension:t},Zt=function(e){return e.query&&e.query.featureTypes&&e.query.featureTypes[e.query.typeName]&&e.query.featureTypes[e.query.typeName].attributes&&e.query.featureTypes[e.query.typeName].attributes[0]&&e.query.featureTypes[e.query.typeName].attributes[0].attribute||null},$t=function(e){switch(e.code){case"ProcessFailed":return{msgId:"layerdownload.wpsExecuteError.processFailed",msgParams:{exceptionReport:e.message}};case"NoStatusLocation":case"NoExecutionId":case"UnexpectedProcessStatus":return{msgId:"layerdownload.wpsExecuteError.badResponse",msgParams:{eCode:e.code}};case"ExecuteProcessXHRFailed":return{msgId:"layerdownload.wpsExecuteError.executeProcessXhrFailed"};case"GetExecutionStatusXHRFailed":return{msgId:"layerdonwload.wpsExecuteError.getExecutionStatusXhrFailed"};default:return{msgId:"layerdownload.wpsExecuteError.unexpectedError"}}},Jt=function(e){var t=(0,ct.dt)(e);if(null!=t&&t.id){var r=document.cookie.split(";").filter(function(e){return e.indexOf("exportDataResults_".concat(t.id,"="))>-1})[0];if(r){var n=JSON.parse(decodeURIComponent(r.split("=")[1])).results;return qe().Observable.of(j(n.filter(function(e){return"pending"!==e.status})))}}return qe().Observable.empty()},Qt=function(e){return e.ofType(T.dC).switchMap(function(e){var t;return qe().Observable.from([(0,C.KP)("layerdownload"),A("singlePage",!1)].concat(Mt(null!==(t=e.layer.search)&&void 0!==t&&t.url?[(0,ot.VZ)(e.layer.url,{featureTypeName:e.layer.name})]:[])))})},er=function(e){return e.ofType(p).switchMap(function(e){return(0,dt.EV)(e).map(function(e){return t=function(e){var t=oe()(e,"WFS_Capabilities.OperationsMetadata.Operation"),r=Be()(t,function(e){return"GetFeature"===e.name}),n=oe()(r,"Parameter"),o=Be()(n,function(e){return"outputFormat"===e.name}).Value,a=Ke()(Ut,o);return $e()(a).map(function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,r)||Wt(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{name:n[0],label:n[1]}})}(e),{type:f,wfsFormats:t};var t})})},tr=function(e,t){return e.ofType(s).switchMap(function(r){var n,o,a,i,l,s,u,c=t.getState(),d=(c.featuregrid||{}).virtualScroll,p=void 0!==d&&d,f=I(c),m=(0,L.ZT)(c),y=_(c),v=m||y,w=(0,ut.HC)(c),O=(0,W.Pd)(c),h=r.downloadOptions.propertyName?[(0,xt.Dh)((0,x.uT)(c,v.name))].concat(Mt(r.downloadOptions.propertyName)):null,S=v.layerFilter;return"wps"===f?(o=!(null===(n=v.search)||void 0===n||!n.url),a=r.downloadOptions.cropDataSet&&!!w&&!!w.bounds,i=Bt(v),l={layerName:v.name,outputFormat:r.downloadOptions.selectedFormat,asynchronous:!0,outputAsReference:!0,targetCRS:r.downloadOptions.selectedSrs&&"native"!==r.downloadOptions.selectedSrs?r.downloadOptions.selectedSrs:void 0,cropToROI:a,dataFilter:r.downloadOptions.downloadFilteredDataSet?{type:"TEXT",data:{mimeType:"text/xml; subtype=filter/1.1",data:(0,Dt.o2)({ogcVersion:"1.1.0",addXmlnsToRoot:!0,xmlnsToAdd:['xmlns:ogc="http://www.opengis.net/ogc"','xmlns:gml="http://www.opengis.net/gml"']},v.layerFilter,r.filterObj,i)}}:void 0,ROI:a?{type:"TEXT",data:{mimeType:"application/wkt",data:(0,Lt.U)((0,Ct.bboxToFeatureGeometry)(w.bounds))}}:void 0,roiCRS:a?w.crs||"EPSG:4326":void 0,writeParameters:_t(_t(_t({},r.downloadOptions.tileWidth?{tilewidth:r.downloadOptions.tileWidth}:{}),r.downloadOptions.tileHeight?{tileheight:r.downloadOptions.tileHeight}:{}),r.downloadOptions.compression?_t({compression:r.downloadOptions.compression},r.downloadOptions.quality?{quality:r.downloadOptions.quality}:{}):{}),notifyDownloadEstimatorSuccess:!0,attribute:o&&h?h:void 0},s={id:rt()(),layerName:v.name,layerTitle:v.title,status:"pending"},u={outputsExtractor:(0,bt.$t)(bt.$V)},jt(r.url,l,u).takeUntil(e.ofType(g).filter(function(e){return e.id===s.id}).take(1)).flatMap(function(e){var t,r;return"DownloadEstimatorSuccess"===e?qe().Observable.of((r=_t(_t({},s),{},{startTime:(new Date).getTime()}),{type:b,result:r}),(0,at.pq)({position:"tc",message:"layerdownload.exportResultsMessages.newExport"}),P(),(0,C.KP)("layerdownload","enabled")):(t=qe().Observable).of.apply(t,Mt(e&&e.length>0&&e[0].href?[D(s.id,{status:"completed",result:e[0].href}),(0,at.kX)({position:"tc",message:"layerdownload.exportResultsMessages.exportSuccess",values:{layerTitle:(0,_e.ez)(v,O)}})]:[D(s.id,{status:"failed",result:{msgId:"layerdonwload.exportResultsMessages.invalidHref"}}),(0,at.z3)({position:"tc",message:"layerdownload.exportResultsMessages.exportFailure",values:{layerTitle:(0,_e.ez)(v,O)},autoDismiss:5})]))}).catch(function(e){var t;return(t=qe().Observable).of.apply(t,Mt(e.message&&e.message.indexOf("DownloadEstimator")>-1?[(0,at.z3)({error:e,position:"tc",title:"layerdownload.error.downloadEstimatorTitle",message:"layerdownload.error.downloadEstimatorFailed",autoDismiss:5}),P()]:[D(s.id,{status:"failed",result:$t(e)}),(0,at.z3)({position:"tc",message:"layerdownload.exportResultsMessages.exportFailure",values:{layerTitle:(0,_e.ez)(v,O)},autoDismiss:5})]))})):zt({url:r.url,downloadOptions:r.downloadOptions,filterObj:He()(r.filterObj)?{}:r.filterObj,layer:v,layerFilter:S,options:{pagination:!p&&oe()(r,"downloadOptions.singlePage")?r.filterObj&&r.filterObj.pagination:null,propertyNames:h}}).do(function(e){var t=e.data;if("application/xml"===e.headers["content-type"]){var r=String.fromCharCode.apply(null,new Uint8Array(t));if(0===r.indexOf("<ows:ExceptionReport"))throw r}}).catch(function(){return zt({url:r.url,downloadOptions:r.downloadOptions,filterObj:r.filterObj,layer:v,layerFilter:S,options:{pagination:!p&&oe()(r,"downloadOptions.singlePage")?r.filterObj&&r.filterObj.pagination:null,sortOptions:(e=Zt(t.getState()),e?{sortBy:e,sortOrder:"A"}:{}),propertyNames:r.downloadOptions.propertyName?[].concat(Mt(r.downloadOptions.propertyName),[(0,xt.Dh)((0,x.uT)(c,v.name))]):null}}).do(function(e){var t=e.data,n=e.headers;if("application/xml"===n["content-type"]){var o=String.fromCharCode.apply(null,new Uint8Array(t));if(0===o.indexOf("<ows:ExceptionReport"))throw o}(0,et.saveAs)(new Blob([t],{type:n&&n["content-type"]}),Kt(r))});var e}).do(function(e){var t=e.data,n=e.headers;(0,et.saveAs)(new Blob([t],{type:n&&n["content-type"]}),Kt(r))}).map(function(){return P()}).catch(function(e){return qe().Observable.of((0,at.z3)({error:e,title:"layerdownload.error.title",message:"layerdownload.error.invalidOutputFormat",autoDismiss:5,position:"tr"}),P())})})},rr=function(e,t){return e.ofType(C.x7).filter(function(e){return"queryPanel"===e.control&&!(0,st.sY)(t.getState())&&(0,st.sl)(t.getState())}).switchMap(function(){return qe().Observable.of((0,C.KP)("layerdownload"))})},nr=function(e,t){return e.ofType(h).exhaustMap(function(){var e=t.getState(),r=(M(e)||[]).filter(function(e){return"completed"===e.status});return r.length>0?qe().Observable.forkJoin(r.map(function(e){var t=e.result,r=t.indexOf("executionId="),n=t.slice(r),o=n.indexOf("&"),a=(o>-1?n.slice(0,o):n).slice(12),i=t.indexOf("?"),l=t.slice(0,i);return(0,bt.HN)(l,a).let(Tt.m9).catch(function(){return qe().Observable.of(null)}).map(function(t){return t?null:e.id})})).flatMap(function(e){return qe().Observable.of((t=e.filter(function(e){return!!e}),{type:O,ids:t}),{type:E},R(!1));var t}).startWith(R(!0)):qe().Observable.empty()})},or=function(e,t){return e.ofType(b,g,w,E).filter(function(){return(0,ct.M3)(t.getState())}).do(function(){var e=t.getState(),r=M(e),n=(0,ct.dt)(e).id,o=JSON.stringify({results:r});document.cookie="exportDataResults_".concat(n,"=").concat(encodeURIComponent(o))}).flatMap(function(){return qe().Observable.empty()})},ar=function(e){return e.ofType(lt.mO).switchMap(function(){return e.ofType(it.T_).switchMap(function(){return qe().Observable.of(j([]))}).takeUntil(e.ofType(nt.LK))})},ir=function(e,t){return e.ofType(lt.mO).switchMap(function(){return Jt(t.getState()).concat(e.ofType(it._x).switchMap(function(){return Jt(t.getState())}).takeUntil(e.ofType(nt.LK)))})};function lr(e){return lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lr(e)}function sr(e){return function(e){if(Array.isArray(e))return ur(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ur(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ur(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ur(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function cr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function dr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?cr(Object(r),!0).forEach(function(t){pr(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function pr(e,t,r){return(t=function(e){var t=function(e){if("object"!=lr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=lr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==lr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var fr=r(393149);function mr(e){return mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mr(e)}var yr=["onClick","selectedNodes","status","itemComponent","statusTypes"];function vr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function br(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vr(Object(r),!0).forEach(function(t){wr(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function wr(e,t,r){return(t=function(e){var t=function(e){if("object"!=mr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=mr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==mr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gr(){return gr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gr.apply(null,arguments)}var Or=(0,i.connect)(function(){return{}},{onClick:T.RG})(function(e){var t,r=e.onClick,n=e.selectedNodes,o=e.status,i=e.itemComponent,l=e.statusTypes,s=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,yr),u=i,c=null==n||null===(t=n[0])||void 0===t?void 0:t.node;return![l.LAYER].includes(o)||!("wms"===(null==c?void 0:c.type)||null!=c&&c.search)||null!=c&&c.error?null:a().createElement(u,gr({},s,{glyph:"download",tooltipId:"toc.toolDownloadTooltip",onClick:function(){var e;return r({url:(null===(e=c.search)||void 0===e?void 0:e.url)||c.url,name:c.name,id:c.id})}}))}),hr=(0,i.connect)(null,{onClick:T.RG})(function(e){var t=e.onClick,r=e.itemComponent,n=e.layer,o=e.widgetId,i=r;return a().createElement(i,{glyph:"download",textId:"widgets.widget.menu.downloadData",onClick:function(){return t(br(br({},n),{},{widgetId:o}))}})});const Sr=(0,fr.i1)("LayerDownload",{component:(0,i.connect)((0,l.j8)({filterObj:k,enabled:function(e){var t;return null==e||null===(t=e.controls)||void 0===t||null===(t=t.layerdownload)||void 0===t?void 0:t.enabled},downloadOptions:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.downloadOptions},loading:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.loading},wfsFormats:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.wfsFormats},formatsLoading:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.formatsLoading},mapLayer:L.ZT,downloadLayer:_,wpsAvailable:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.wpsAvailable},service:I,checkingWPSAvailability:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.checkingWPSAvailability},virtualScroll:function(e){return e&&e.featuregrid&&e.featuregrid.virtualScroll},customAttributeSettings:F.b0,attributes:x.NY}),{onExport:function(e,t,r){return{type:s,url:e,filterObj:t,downloadOptions:r}},onSetService:function(e){return{type:y,service:e}},onSetWPSAvailability:function(e){return{type:m,value:e}},onDownloadOptionChange:A,onClearDownloadOptions:function(e){return{type:d,defaultSelectedService:e}},onFormatOptionsFetch:function(e){return{type:p,layer:e}},onClose:function(){return(0,C.KP)("layerdownload")}})(xe),containers:{Widgets:{doNotHide:!0,name:"LayerDownload",target:"table-menu-download",position:11,Component:hr},Dashboard:{doNotHide:!0,name:"LayerDownload",target:"table-menu-download",position:11,Component:hr},TOC:{doNotHide:!0,name:"LayerDownload",target:"toolbar",Component:Or,position:11},FeatureEditor:{doNotHide:!0,name:"LayerDownload",position:20,target:"toolbar",Component:(0,i.connect)((0,l.j8)({isDownloadOpen:function(e){var t;return null==e||null===(t=e.controls)||void 0===t||null===(t=t.layerdownload)||void 0===t?void 0:t.enabled}}),{onClick:function(){return(0,C.KP)("layerdownload")}})(function(e){var t=e.disabled,r=e.results,n=void 0===r?[]:r,o=e.mode,i=e.isDownloadOpen,l=e.onClick,s=void 0===l?function(){}:l;return a().createElement(Ue,{id:"download-grid",keyProp:"download-grid",tooltipId:"featuregrid.toolbar.downloadGridData",disabled:t||0===n.length,active:i,visible:"VIEW"===o,onClick:s,glyph:"download"})})},BrandNavbar:{doNotHide:!0,name:"LayerDownload",target:"right-menu",position:-1,Component:(0,i.connect)((0,l.j8)({active:function(e){var t;return null==e||null===(t=e.controls)||void 0===t||null===(t=t.exportDataResults)||void 0===t?void 0:t.enabled},checkingExportDataEntries:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.checkingExportDataEntries},results:M,currentLocale:W.Pd}),{onToggle:C.KP.bind(null,"exportDataResults","enabled"),onActive:function(){return{type:h}},onRemoveResult:function(e){return{type:g,id:e}}})(function(e){var t=e.active,r=void 0!==t&&t,n=e.checkingExportDataEntries,o=e.results,i=void 0===o?[]:o,l=e.currentLocale,s=e.onToggle,u=void 0===s?function(){}:s,c=e.onActive,d=void 0===c?function(){}:c,p=e.onRemoveResult,f=a().useRef();return a().useEffect(function(){r&&d()},[r]),a().createElement(a().Fragment,null,i.length>0?a().createElement("div",{id:"mapstore-export-data-results-button-container"},a().createElement(Ie.A,{placement:"left",overlay:a().createElement(z.m_,{id:"mapstore-export-data-results-tooltip"},a().createElement(ee.A,{msgId:"exportDataResults.title"}))},a().createElement(z.$n,{ref:f,bsStyle:"primary",bsSize:"small",onClick:function(){return u()}},a().createElement(z.e6,{glyph:"download"})))):null,a().createElement("div",null,r&&a().createElement(Q.A,null,a().createElement(J.A,{id:"mapstore-export-data-results",draggable:!1,modal:!0},a().createElement("span",{role:"header"},a().createElement("span",{className:"modal-title about-panel-title"},a().createElement(ee.A,{msgId:"exportDataResults.title"})),a().createElement("button",{onClick:function(){return u()},className:"settings-panel-close close"},a().createElement(z.e6,{glyph:"1-close"}))),a().createElement("div",{role:"body"},a().createElement(Me,{loading:n,results:i,currentLocale:l,onRemoveResult:p}))))))})}},epics:n,reducers:{layerdownload:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{downloadOptions:{singlePage:!0}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T.dC:return dr(dr({},e),{},{downloadLayer:t.layer});case s:return dr(dr({},e),{},{loading:!0});case c:return dr(dr({},e),{},{downloadOptions:dr(dr({},e.downloadOptions),{},pr({},t.key,t.value))});case d:return dr(dr({},e),{},{downloadOptions:{singlePage:!0},service:t.defaultSelectedService});case p:return dr(dr({},e),{},{layer:t.layer,wfsFormats:[],formatsLoading:!0});case u:return dr(dr({},e),{},{loading:!1});case f:return dr(dr({},e),{},{wfsFormats:t.wfsFormats,formatsLoading:!1});case y:return dr(dr({},e),{},{service:t.service});case m:return dr(dr({},e),{},{wpsAvailable:t.value});case"LAYERDOWNLOAD:CHECKING_WPS_AVAILABILITY":return dr(dr({},e),{},{checkingWPSAvailability:t.checking});case v:return dr(dr({},e),{},{results:t.results});case b:return dr(dr({},e),{},{results:[].concat(sr(e.results||[]),[t.result])});case w:var r=q()(e.results||[],{id:t.id});return dr(dr({},e),{},{results:r>-1?[].concat(sr(e.results.slice(0,r)),[dr(dr({},e.results[r]),t.newProps||{})],sr(e.results.slice(r+1))):e.results});case g:return dr(dr({},e),{},{results:(e.results||[]).filter(function(e){return e.id!==t.id})});case O:return dr(dr({},e),{},{results:(e.results||[]).filter(function(e){return-1===q()(t.ids,function(t){return t===e.id})})});case S:return dr(dr({},e),{},{checkingExportDataEntries:t.checking});default:return e}}}})},791936:function(e,t,r){var n,o=o||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,r=function(){return e.URL||e.webkitURL||e},n=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in n,a=/constructor/i.test(e.HTMLElement)||e.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent),l=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},s=function(e){setTimeout(function(){"string"==typeof e?r().revokeObjectURL(e):e.remove()},4e4)},u=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},c=function(t,c,d){d||(t=u(t));var p,f=this,m="application/octet-stream"===t.type,y=function(){!function(e,t){for(var r=(t=[].concat(t)).length;r--;){var n=e["on"+t[r]];if("function"==typeof n)try{n.call(e,e)}catch(e){l(e)}}}(f,"writestart progress write writeend".split(" "))};if(f.readyState=f.INIT,o)return p=r().createObjectURL(t),void setTimeout(function(){var e,t;n.href=p,n.download=c,e=n,t=new MouseEvent("click"),e.dispatchEvent(t),y(),s(p),f.readyState=f.DONE});!function(){if((i||m&&a)&&e.FileReader){var n=new FileReader;return n.onloadend=function(){var t=i?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,f.readyState=f.DONE,y()},n.readAsDataURL(t),void(f.readyState=f.INIT)}p||(p=r().createObjectURL(t)),m?e.location.href=p:e.open(p,"_blank")||(e.location.href=p),f.readyState=f.DONE,y(),s(p)}()},d=c.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,r){return t=t||e.name||"download",r||(e=u(e)),navigator.msSaveOrOpenBlob(e,t)}:(d.abort=function(){},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=d.onwritestart=d.onprogress=d.onwrite=d.onabort=d.onerror=d.onwriteend=null,function(e,t,r){return new c(e,t||e.name||"download",r)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);e.exports?e.exports.saveAs=o:null!==r.amdD&&null!==r.amdO&&(void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n))},913195:e=>{var t=Math.floor,r=Math.random;e.exports=function(e,n){return e+t(r()*(n-e+1))}},258253:(e,t,r)=>{var n=r(913195),o=r(936800),a=r(217400),i=parseFloat,l=Math.min,s=Math.random;e.exports=function(e,t,r){if(r&&"boolean"!=typeof r&&o(e,t,r)&&(t=r=void 0),void 0===r&&("boolean"==typeof t?(r=t,t=void 0):"boolean"==typeof e&&(r=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=a(e),void 0===t?(t=e,e=0):t=a(t)),e>t){var u=e;e=t,t=u}if(r||e%1||t%1){var c=s();return l(e+c*(t-e+i("1e-"+((c+"").length-1))),t)}return n(e,t)}}}]);