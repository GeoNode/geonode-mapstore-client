(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[62933],{603475:(e,t,n)=>{"use strict";n.d(t,{hn:()=>j,ZP:()=>T});var r=n(375875),o=n.n(r),i=n(737275),a=n(472500),c=n.n(a),l=n(727418),u=n.n(l),s=n(505055),p=n.n(s),f=n(984596),d=n.n(f),y=n(916651),m=n(611847),b=n(707294);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return(t=function(e){var t=function(e){if("object"!=v(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==v(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w={},S=function(e){var t=c().parse((0,m.eW)(e),!0);return c().format(u()({},t,{search:null},{query:u()({SERVICE:"WMTS",VERSION:"1.0.0",REQUEST:"GetCapabilities"},t.query)}))},P=function(e,t,n,r,o){for(var i=e.Capabilities.Contents,a=(0,b.G6)(e),c=(0,b.s5)(e),l=i.TileMatrixSet&&d()(i.TileMatrixSet)||[],s=[],p=l.length,f=0;f<p;f++)s.push((0,y.getEPSGCode)(l[f]["ows:SupportedCRS"]));var m=i.Layer,v=d()(m).filter((function(e){return!r||-1!==e["ows:Identifier"].toLowerCase().indexOf(r.toLowerCase())||e["ows:Title"]&&-1!==e["ows:Title"].toLowerCase().indexOf(r.toLowerCase())}));return{numberOfRecordsMatched:v.length,numberOfRecordsReturned:Math.min(n,v.length),nextRecord:t+Math.min(n,v.length)+1,records:v.filter((function(e,r){return r>=t-1&&r<t-1+n})).map((function(e){return u()({},e,{SRS:s,TileMatrixSet:l,queryable:!!(0,b.b4)(a,"GetFeatureInfo","KVP"),requestEncoding:c,style:(0,b.EN)(e),format:(0,b.JY)(e),formats:d()(e.Format),GetTileURL:(0,b.b4)(a,"GetTile",c),capabilitiesURL:o})}))}},E={parseUrl:S,getRecords:function(e,t,n,r){var a=w[e];return a&&(new Date).getTime()<a.timestamp+1e3*((0,i.u8)("cacheExpire")||60)?new Promise((function(o){o(P(a.data,t,n,r,e))})):o().get(S(e)).then((function(o){var i;return p().parseString(o.data,{explicitArray:!1},(function(e,t){i=t})),w[e]={timestamp:(new Date).getTime(),data:i},P(i,t,n,r,e)}))},getCapabilities:function(e,t){null!=t&&t.force&&w[e]&&delete w[e];var n=w[e];return n&&(new Date).getTime()<n.timestamp+1e3*((0,i.u8)("cacheExpire")||60)?new Promise((function(e){e(n.data)})):o().get(S(e)).then((function(t){var n;return p().parseString(t.data,{explicitArray:!1},(function(e,t){n=t})),w[e]={timestamp:(new Date).getTime(),data:n},n}))},textSearch:function(e,t,n,r){return E.getRecords(e,t,n,r)},reset:function(){Object.keys(w).forEach((function(e){delete w[e]}))}},j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;return E.getCapabilities(e,{force:null==n?void 0:n.force}).then((function(e){var n,r,o,i,a=t.split(":"),c=d()((null==e||null===(n=e.Capabilities)||void 0===n||null===(r=n.Contents)||void 0===r?void 0:r.Layer)||[]).find((function(e){return e["ows:Identifier"]===a[1]||e["ows:Identifier"]===t})),l=d()((null==c?void 0:c.TileMatrixSetLink)||[]).map((function(e){return e.TileMatrixSet})),u=d()((null==e||null===(o=e.Capabilities)||void 0===o||null===(i=o.Contents)||void 0===i?void 0:i.TileMatrixSet)||[]).filter((function(e){return l.includes(e["ows:Identifier"])})),s=u.map((function(e){var t=e.TileMatrix.map((function(e){return e.TopLeftCorner.split(" ").map(parseFloat)})),n=e.TileMatrix.map((function(e){return[parseFloat(e.TileWidth),parseFloat(e.TileHeight)]})),r=t[0],o=n[0],i=t.every((function(e){return r[0]===e[0]&&r[1]===e[1]})),a=n.every((function(e){return o[0]===e[0]&&o[1]===e[1]}));return h(h({id:e["ows:Identifier"],crs:(0,y.getEPSGCode)(e["ows:SupportedCRS"]),scales:e.TileMatrix.map((function(e){return parseFloat(e.ScaleDenominator)}))},i?{origin:r}:{origins:t}),a?{tileSize:o}:{tileSizes:n})}));return{tileMatrixSets:u,tileMatrixSetLinks:l,tileGrids:s,styles:d()((null==c?void 0:c.Style)||[]).map((function(e){return e["ows:Identifier"]})),formats:d()((null==c?void 0:c.Format)||[])}}))};const T=E},911766:(e,t,n)=>{"use strict";n.d(t,{H:()=>E,Z:()=>j});var r=n(124852),o=n.n(r),i=n(212961),a=n(513218),c=n.n(a),l=n(717621),u=n.n(l),s=n(480681),p=n(38560),f=n(725288),d=n(145869),y=n(805346),m=n(615402),b=n(815135),v=["boxShadow","MozBoxShadow","WebkitBoxShadow"];function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return(t=function(e){var t=function(e){if("object"!=g(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=(0,b.Z)(p.Z);function P(e){var t=e.themeStyle,n=e.disableBackgroundPicker,a=void 0!==n&&n,c=e.disableBackgroundAlpha,l=e.disableTextColor,p=e.disableShadow,b=e.onChange,g=void 0===b?function(){}:b,h=e.onOpen,w=void 0===h?function(){}:h,P=e.placement,E=(0,r.useRef)(),j=null==t?void 0:t.backgroundColor,T=null==t?void 0:t.color,C=!l&&j&&T&&!u().isReadable(T,j)?u().mostReadable(j,[T,"#000000","#ffffff"],{includeFallbackColors:!0}).toHexString():null;return o().createElement(o().Fragment,null,!a&&o().createElement("div",{className:"ms-custom-theme-picker-field"},o().createElement("div",null,o().createElement(y.Z,{msgId:"geostory.customizeTheme.backgroundColorLabel"})),o().createElement("div",null,o().createElement(i.Z,{placement:P,key:j,onOpen:w,color:j,format:c?"hex":"rgb",disableAlpha:c,presetColors:[],onChangeColor:function(e){var n=u()(e).isLight()?u()(e).darken(10).toHexString():u()(e).lighten(15).toHexString(),r=!l&&!(null!=t&&t.color)&&{color:u().mostReadable(e,["#000000","#ffffff"],{includeFallbackColors:!0}).toHexString()};g(O(O({},t),{},{backgroundColor:e,borderColor:n},!l&&r))}}))),!l&&o().createElement("div",{className:"ms-custom-theme-picker-field"},o().createElement("div",null,o().createElement("div",null,o().createElement(y.Z,{msgId:"geostory.customizeTheme.textColorLabel"})),o().createElement(f.Z,{className:"ms-custom-theme-picker-popover",ref:function(e){e&&(E.current=e.trigger)},placement:"top",content:o().createElement(o().Fragment,null,o().createElement(m.Z,{msgId:"geostory.customizeTheme.alternativeTextColorPopover",msgParams:{color:C}}),o().createElement(S,{bsSize:"xs",bsStyle:"primary",style:{margin:"auto",display:"block"},onClick:function(){var e,n;g(O(O({},t),{},{color:C})),null===(e=E.current)||void 0===e||null===(n=e.hide)||void 0===n||n.call(e)}},o().createElement(y.Z,{msgId:"geostory.customizeTheme.useAlternativeTextColor"})))},C&&o().createElement(S,{className:"square-button-md no-border",style:{display:C?"block":"none"}},o().createElement(s.gG,{glyph:"exclamation-mark"}))||o().createElement("div",null))),o().createElement("div",null,o().createElement(i.Z,{placement:P,key:T,color:T,onOpen:w,format:"hex",disableAlpha:!0,presetColors:[],onChangeColor:function(e){g(O(O({},t),{},{color:e}))}}))),!p&&o().createElement("div",{className:"ms-custom-theme-picker-field"},o().createElement("div",null,o().createElement(y.Z,{msgId:"geostory.customizeTheme.shadowLabel"})),o().createElement("div",null,o().createElement(d.Z,{checked:null==t?void 0:t.boxShadow,onChange:function(){var e=t||{},n=e.boxShadow,r=(e.MozBoxShadow,e.WebkitBoxShadow,function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,v));g(n?O({},r):O(O({},r),{},{boxShadow:"0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22)"}))}}))))}function E(e){var t=e.selected,n=e.value,r=e.storyTheme,i=e.onUpdate,a=e.onActive,l=e.disableBackgroundAlpha,u=e.disableTextColor,p=e.disableShadow,f=function(e,r){var o=c()(t)&&t;return i("theme",O(O({},o),{},r?w({value:e},n,O({},r)):{value:e}))},d=r||{},m=d.color,b=d.backgroundColor,v=b&&{backgroundColor:b},g=O(O({},!u&&m&&{color:m}),v),h=(null==t?void 0:t.value)===n,E=(null==t?void 0:t[n])||g;return o().createElement(o().Fragment,null,h?o().createElement("div",{className:"ms-custom-theme-picker-menuitem-header"},o().createElement("div",null,o().createElement(y.Z,{msgId:"geostory.contentToolbar.customizeThemeLabel"})),o().createElement(S,{tooltipId:"geostory.contentToolbar.customizeThemeRemoveLabel",className:"square-button-md no-border",onClick:function(e){e.stopPropagation(),f("")}},o().createElement(s.gG,{glyph:"trash"}))):o().createElement(o().Fragment,null,o().createElement(s.sN,{active:h,onClick:function(){return f(n,E)}},o().createElement(y.Z,{msgId:"geostory.contentToolbar.customizeThemeLabel"}))),h&&o().createElement("div",{className:"ms-custom-theme-picker-menuitem"},o().createElement(P,{disableBackgroundAlpha:l,disableTextColor:u,disableShadow:p,themeStyle:E,onChange:function(e){return f(n,e)},onOpen:a})))}const j=P},725288:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var r=n(124852),o=n.n(r),i=n(45697),a=n.n(i),c=n(480681),l=n(737275);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function p(e,t,n){return t=d(t),function(e,t){if(t&&("object"==u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,f()?Reflect.construct(t,n||[],d(e).constructor):t.apply(e,n))}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(f=function(){return!!e})()}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function m(e,t,n){return(t=b(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}var v=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return m(e=p(this,t,[].concat(r)),"getContainerNode",(function(t){return t?document.body:e.parentNode||document.querySelector("."+(l.ZP.getConfigProp("themePrefix")||"ms2")+" > div")||document.body})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this,t=this.getContainerNode(this.props.useBody);return o().createElement("div",{ref:function(t){e.parentNode=t&&t.parentNode},className:this.props.className,style:this.props.style},o().createElement(c.Ox,{ref:function(t){e.trigger=t},trigger:["click"],container:t,placement:this.props.placement,rootClose:!0,overlay:o().createElement(c.J2,{id:this.props.id,title:this.props.title,className:this.props.popoverClassName},this.props.content)},this.props.children))}}])&&s(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o().Component);m(v,"propTypes",{id:a().string,style:a().object,className:a().string,popoverClassName:a().string,placement:a().string,title:a().node,content:a().node,useBody:a().bool}),m(v,"defaultProps",{id:"",useBody:!1});const g=v},323010:(e,t,n)=>{"use strict";n.d(t,{d:()=>A,Z:()=>R});var r=n(124852),o=n.n(r),i=n(867076),a=n(423570),c=n.n(a),l=n(747359),u=n(1979),s=n(618446),p=n.n(s),f=n(624262),d=n(454037),y=n(49977),m=n(249243),b=n(313311),v=n.n(b),g=n(171703),h=n(134990),O=n(866113);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}var S=["rawPos"],P=["PopupSupport","tools"];function E(){return E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},E.apply(null,arguments)}function j(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return(t=function(e){var t=function(e){if("object"!=w(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return D(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function M(e){return e&&0===e.indexOf("geostory-vector")}var A=(0,i.compose)((0,g.connect)((function(e){return{sections:(0,O.NR)(e)}}),{onClickMarker:h.Vx}),(0,i.withHandlers)({onClickMarker:function(e){var t=e.onClickMarker,n=void 0===t?function(){}:t;return function(e,t,r){var i=v()(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.queryParams,r=(void 0===n?{}:n).request,o=e.layerMetadata,i=(void 0===o?{}:o).layerId;return!r&&i.toLowerCase()===t}))||{},a=i.response,c=(void 0===a?{}:a).features,l=k(void 0===c?[]:c,1)[0],u={popups:[]};if(null!=l&&l.properties){var s=null==l?void 0:l.properties,p=s.sectionId,f=s.contentId,d=s.title;n('sections[{"id":"'.concat(p,'"}].contents[{"id":"').concat(f,'"}].carouselToggle'),!0),d&&(u={popups:r.map((function(e){return C(C({},e),{},{component:function(){return o().createElement("div",{className:"ms-geostory-carousel-viewer"},d)}})}))})}return u}}})),x=(0,i.mapPropsStream)((function(e){var t=(0,i.createEventHandler)(),n=t.stream,r=t.handler;return n.withLatestFrom(e.map((function(e){return{map:e.map,layers:e.layers,options:e.options}})).distinctUntilChanged((function(e,t){return p()(e,t)}))).switchMap((function(e){var t=k(e,2),n=t[0],r=n.point,o=n.layerInfo,i=t[1],a=i.map,l=i.layers,s=void 0===l?[]:l,p=i.options,b=(void 0===p?{}:p).mapOptions,v=(void 0===b?{}:b).mapInfoFormat,g=void 0===v?(0,u.GA)():v,h=s.filter((function(e){return(0,f.T4)(e,a.resolution)&&(0,d.y_)(e)}));M(o)&&(h=h.filter((function(e){var t=e.id;return o===t})));var O=["SLD_BODY"],w=["buffer","cql_filter","filter","propertyName"];return 0===h.length?y.Observable.of({requests:[{}],responses:[{response:{features:[]}}],validResponses:[]}):y.Observable.from(h).mergeMap((function(e){var t=(0,d.Fm)(e,{format:g,map:a,point:r,currentLocale:"en-US"}),n=t.url,o=t.request,i=t.metadata,l=n,u=o,s=C(C({},(0,d.K7)(e,w,O)),u),p=c()();return(n?(0,m.y)(l,s,e).map((function(e){return e.data.exceptions?{reqId:p,exceptions:e.data.exceptions,queryParams:u,layerMetadata:i}:{data:e.data,reqId:p,queryParams:u,layerMetadata:C(C({},i),{},{features:e.features,featuresCrs:e.featuresCrs})}})):y.Observable.empty()).catch((function(e){return{error:e.data||e.statusText||e.status,reqId:p,queryParams:u,layerMetadata:i}})).startWith({start:!0,reqId:p,request:s})})).scan((function(e,t){var n=e.requests,r=e.responses,i=e.validResponses;if(t.start){var a=t.reqId,c=t.request;return{requests:n.concat({reqId:a,request:c}),responses:r,validResponses:i}}var l=t.data,u=t.queryParams,s=t.layerMetadata,p=(0,d.Te)(g),f=r.concat({response:l,queryParams:u,layerMetadata:s});return{requests:n,validResponses:p.getValidResponses(f),responses:f,layerInfo:o}}),{requests:[],responses:[],validResponses:[],layerInfo:o})})).startWith({requests:[],responses:[]}).combineLatest(e,(function(e){return C(C({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{},{mapInfo:e,getFeatureInfoHandler:r})}))}));const R=(0,i.branch)((function(e){var t=e.map,n=(void 0===t?{}:t).mapInfoControl,r=void 0!==n&&n;return!e.isDrawEnabled&&r}),(0,i.compose)(x,(0,i.withStateHandlers)({popups:[]},{onClick:function(e,t){var n=t.getFeatureInfoHandler,r=void 0===n?function(){}:n,o=t.map,i=(void 0===o?{}:o).mapInfoControl;return function(e,t){var n=e.rawPos,o=void 0===n?[]:n,a=j(e,S);return M(t)||i?(r({point:a,layerInfo:t}),{popups:[{position:{coordinates:o},id:c()()}]}):{popups:[]}}},onPopupClose:function(){return function(){return{popups:[]}}}}),(0,i.withPropsOnChange)(["mapInfo","popups"],(function(e){var t=e.mapInfo,n=e.popups,r=e.options,i=(void 0===r?{}:r).mapOptions,a=(void 0===i?{}:i).mapInfoFormat,c=void 0===a?(0,u.GA)():a,s=e.onClickMarker,p=void 0===s?function(){}:s,f=t.responses,d=t.requests,y=t.validResponses,m=t.layerInfo;return M(m)?p(y,m,n):{popups:n.map((function(e){return C(C({},e),{},{component:function(){return o().createElement(l.Z,{renderValidOnly:!0,responses:f,requests:d,validResponses:y,format:c,showEmptyMessageGFI:!0,missingResponses:(d||[]).length-(f||[]).length})}})}))}})),(0,i.withPropsOnChange)(["plugins","onPopupClose","popups"],(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.plugins,n=e.popups,r=e.onPopupClose,i=t.PopupSupport,a=t.tools,c=void 0===a?{}:a,l=j(t,P);return i?{plugins:C(C({},l),{},{tools:C(C({},c),{},{popup:function(e){return o().createElement(i,E({},e,{popups:n,onPopupClose:r}))}})})}:{}}))))},240986:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var r=n(124852),o=n(45697),i=n.n(o),a=n(916651),c=n(752043),l=n(898631);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(e,t,n){return(t=function(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var f=s(s({},l.Bk.OPENLAYERS,{fit:function(e){var t,n=e.map,r=e.geometry,o=e.padding,i=e.geometryProjection,l=e.fixedZoom,u=e.maxZoom,s=e.duration,p=n.getView(),f=p.getProjection().getCode();if(2===r.length){var d=(0,a.reproject)(r,i,f),y=d.x,m=d.y;t=new c.Z([y,m])}else t=(0,a.reprojectBbox)(r,i,f);var b=o||{},v=b.top,g=void 0===v?0:v,h=b.right,O=void 0===h?0:h,w=b.bottom,S=void 0===w?0:w,P=b.left,E=void 0===P?0:P;p.fit(t,{padding:[g,O,S,E],maxZoom:l?p.getZoom():u,duration:s})}}),l.Bk.LEAFLET,{fit:function(e){var t,n,r,o=e.map,i=e.geometry,c=e.padding,l=e.geometryProjection,u=e.fixedZoom,s=e.maxZoom,f=e.duration,d=u?o.getZoom():s,y=c.top,m=void 0===y?0:y,b=c.right,v=void 0===b?0:b,g=c.bottom,h=void 0===g?0:g,O=c.left,w=void 0===O?0:O;if(2===i.length){var S=(0,a.reproject)(i,l,"EPSG:4326"),P=S.x,E=S.y;t=[[E,P],[E,P]]}else{var j=(n=(0,a.reprojectBbox)(i,l,"EPSG:4326"),r=4,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(n,r)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),T=j[0],C=j[1],I=j[2];t=[[C,T],[j[3],I]]}o.flyToBounds(t,{paddingTopLeft:[w,m],paddingBottomRight:[v,h],maxZoom:d,animate:!!f,duration:f/1e3})}});function d(e){var t=e.map,n=e.mapType,o=e.active,i=e.geometry,a=e.geometryProjection,c=void 0===a?"EPSG:4326":a,l=e.padding,u=e.maxZoom,s=e.fixedZoom,p=e.duration,d=(0,r.useRef)();return d.current=function(){t&&f[n]&&f[n].fit({map:t,geometry:i,padding:l,geometryProjection:c,maxZoom:u,fixedZoom:s,duration:p})},(0,r.useEffect)((function(){o&&i&&d.current()}),[i,o]),null}d.propTypes={id:i().string,map:i().object,mapType:i().string,active:i().bool,geometry:i().array,geometryProjection:i().string,padding:i().object,maxZoom:i().number,fixedZoom:i().bool,duration:i().number},d.defaultProps={geometryProjection:"EPSG:4326",padding:{top:0,right:0,bottom:0,left:0}};const y=d},743837:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var r=n(124852),o=n.n(r),i=n(45697),a=n.n(i),c=n(706909),l=n(898631);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}var s=["map","active","method","mapId","mapType","features","options","onChange"];function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(null,arguments)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return(t=function(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function b(e){var t,n,i=e.map,a=e.active,u=e.method,f=e.mapId,y=e.mapType,b=e.features,v=e.options,g=e.onChange,h=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,s),O=(t=(0,r.useState)(null),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),w=O[0],S=O[1];return(0,r.useEffect)((function(){S(a?"drawOrEdit":"clean")}),[a]),y!==l.Bk.OPENLAYERS?null:o().createElement(c.Z,p({},h,{map:i,drawOwner:f,drawStatus:w,drawMethod:u,features:b,options:d({drawEnabled:a,addClickCallback:!0,editEnabled:!0,featureProjection:"EPSG:4326",geodesic:!1,stopAfterDrawing:!1,transformToFeatureCollection:!0,translateEnabled:!1,useSelectedStyle:!0},v),onDrawingFeatures:g.bind(null,f)}))}b.propTypes={active:a().bool,method:a().string,features:a().array,onChange:a().func,options:a().object},b.defaultProps={active:!1,method:"Point",features:[],onChange:function(){},options:{}};const v=b},916788:(e,t,n)=>{"use strict";n.d(t,{Z:()=>P});var r=n(124852),o=n.n(r),i=n(45697),a=n.n(i),c=n(1206),l=n.n(c),u=n(196797),s=n.n(u),p=n(867076);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,w(r.key),r)}}function b(e,t,n){return t=g(t),function(e,t){if(t&&("object"==f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,v()?Reflect.construct(t,n||[],g(e).constructor):t.apply(e,n))}function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(v=function(){return!!e})()}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function O(e,t,n){return(t=w(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}var S=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),b(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){s()(this._node)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.src!==this.props.src&&s()(this._node)}},{key:"render",value:function(){var e=this,t=this.props,n=t.id,r=t.src,i=t.fit,a=void 0===i?"cover":i,c=t.enableFullscreen,u=void 0===c||c,s=t.fullscreen,p=t.onClick,f=t.description,d=t.showCaption,m=t.caption,b=void 0===m?f:m,v=t.credits,g=t.loaderStyle,h=this.props.loaderComponent,O=this.props.errorComponent;return o().createElement("div",{id:n,className:"ms-media ms-media-image"},r&&"error"!==this.props.status&&o().createElement("img",{ref:function(t){e._node=t},src:r,onLoad:function(){return e.props.onChangeStatus("loaded")},onError:function(){return e.props.onChangeStatus("error")},onClick:u?function(){return p(!0)}:void 0,style:{objectFit:a,fontFamily:"object-fit: ".concat(a),cursor:u?"pointer":"default"}}),r&&!this.props.status&&h&&o().createElement(h,{style:y({},g)}),"error"===this.props.status&&O&&o().createElement(O,null),v&&o().createElement("div",{className:"ms-media-credits"},o().createElement("small",null,v)),d&&b&&o().createElement("div",{className:"ms-media-caption"},o().createElement("small",null,b)),u&&s?o().createElement(l(),{mainSrc:r,onCloseRequest:function(){return p(!1)}}):null)}}])&&m(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(r.Component);O(S,"propTypes",{src:a().string,id:a().string,fit:a().string,description:a().string,showCaption:a().bool,credits:a().string,altText:a().string,enableFullscreen:a().bool,fullscreen:a().bool,onClick:a().func,onChangeStatus:a().func,status:a().string,loaderComponent:a().oneOfType([a().element,a().func]),errorComponent:a().oneOfType([a().element,a().func]),caption:a().string,loaderStyle:a().object});const P=(0,p.compose)((0,p.withState)("fullscreen","onClick",!1),(0,p.withState)("status","onChangeStatus",""))(S)},437034:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Z});var r=n(124852),o=n.n(r),i=n(867076),a=n(480681),c=n(319180),l=n(91812),u=n(937981),s=n(469705),p=n(57068),f=n(1979),d=n(323010),y=n(461928);const m=(0,i.compose)(s.Z,(0,l.Z)(0),c.Z,d.Z,f.yM,u.Z,p.e)(y.Z);var b=n(192579),v=n(727693),g=n(399534),h=n(815135),O=n(580628),w=n(898631),S=n(624262),P=n(38560);function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}var j=["id","map","fit","editMap","onMapViewChanges","eventHandlers","expandable","active","setActive","width","height","size","showCaption","caption","mapType","onMapTypeLoaded","layers","children"],T=["layers","groups","mapOptions","description"];function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},C.apply(null,arguments)}function I(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return(t=function(e){var t=function(e){if("object"!=E(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==E(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var R=(0,h.Z)(P.Z);const Z=(0,i.compose)((0,i.withState)("active","setActive",!1),O.Z)((function(e){var t=e.id,n=e.map,i=void 0===n?{layers:[v.D]}:n,c=e.fit,l=e.editMap,u=void 0!==l&&l,s=e.onMapViewChanges,p=e.eventHandlers,f=e.expandable,d=void 0!==f&&f,y=e.active,h=e.setActive,O=e.width,P=e.height,E=e.size,k=e.showCaption,D=e.caption,A=e.mapType,Z=void 0===A?w.Bk.OPENLAYERS:A,N=e.onMapTypeLoaded,L=e.layers,W=e.children,B=x(e,j),_=i.data?i.data:i,z=_.layers,F=void 0===z?[]:z,U=_.groups,V=void 0===U?[]:U,H=_.mapOptions,G=void 0===H?{}:H,q=_.description,$=x(_,T),K=(0,S.Ku)(F,V),J=D||q,Y=d?y?{zoomControl:!1,interactive:!0,mapOptions:{scrollWheelZoom:!0,interactions:{mouseWheelZoom:!0,dragPan:!0}}}:{zoomControl:!1,interactive:!1,mapOptions:{scrollWheelZoom:!1,interactions:{mouseWheelZoom:!1,dragPan:!1}}}:{mapOptions:G},Q=u?{mapOptions:M(M({},G),{},{interactions:M(M({},G.interactions),{},{mouseWheelZoom:$.zoomControl})})}:Y,X=!B.isDrawEnabled&&$.mapInfoControl&&!(d&&!y),ee=o().createElement(o().Fragment,null,o().createElement(m,C({},B,{key:d?"overlay":"block",onMapViewChanges:s,eventHandlers:p,map:M(M({},$),{},{id:"media-".concat(t),resize:O+"-"+P+"_"+E,className:"aaaa",style:M({cursor:X?"pointer":"default"},d&&!y&&{pointerEvents:"none",touchAction:"none"})}),layers:L?[].concat(I(K),I(L)):K,tools:X?["popup"]:[],options:(0,b.kn)(Q),mapType:Z,onMapTypeLoaded:N}),r.Children.map(W,(function(e){return e?(0,r.cloneElement)(e,{mapType:Z}):null}))),d&&!u&&o().createElement(R,{className:"ms-expand-media-button",onClick:function(){return h(!y)},tooltipId:y?"geostory.closeFullscreenMap":"geostory.showFullscreenMap",tooltipPosition:"left"},o().createElement(a.gG,{glyph:y?"1-close":"1-full-screen"})));return o().createElement("div",{className:"ms-media ms-media-map ".concat(G.zoomPosition||""),style:{objectFit:c}},y&&d?o().createElement(g.Z,null,o().createElement("div",{className:"ms-expanded-media-container"},ee)):ee,k&&J&&o().createElement("div",{className:"ms-media-caption"},o().createElement("small",null,J)))}))},882017:(e,t,n)=>{"use strict";n.d(t,{Ln:()=>y,ZP:()=>b});var r=n(124852),o=n.n(r),i=n(45697),a=n.n(i),c=n(916788),l=n(437034),u=n(452826),s=["debounceTime","mediaViewer","children"];function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(null,arguments)}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var d=c.Z,y={image:c.Z,map:l.Z,video:u.Z},m=function(e){var t,n,i=e.debounceTime,a=e.mediaViewer,c=e.children,l=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,s),u="".concat(l.id).concat(l.resourceId?"-".concat(l.resourceId):""),m=(t=(0,r.useState)({}),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),b=m[0],v=m[1],g=void 0===b[u]||b[u],h=a||y[l.mediaType||l.type]||d;return o().createElement(h,p({sectionType:l.sectionType,debounceTime:i,loading:b,isLoading:g,onLoad:v,loadingId:u},l),c)};m.propTypes={id:a().string,lazy:a().bool,mediaType:a().string,type:a().string,debounceTime:a().number},m.defaultProps={id:"",lazy:!0,mediaType:"",type:""};const b=m},771335:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var r=n(124852),o=n.n(r),i=n(45697),a=n.n(i),c=n(805346),l=n(913718),u=n(42648),s=n(314068);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(null,arguments)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function y(e,t,n){return t=b(t),function(e,t){if(t&&("object"==p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,m()?Reflect.construct(t,n||[],b(e).constructor):t.apply(e,n))}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(m=function(){return!!e})()}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function g(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){var t=function(e){if("object"!=p(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}var O={FORMAT:o().createElement(c.Z,{msgId:"map.errorFormat"}),SIZE:o().createElement(c.Z,{msgId:"map.errorSize"})},w=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return g(e=y(this,t,[].concat(r)),"state",{}),g(e,"getThumbnailUrl",(function(){return e.props.map&&e.props.map.newThumbnail&&"NODATA"!==e.props.map.newThumbnail?decodeURIComponent(e.props.map.newThumbnail):null})),g(e,"getDataUri",(function(e,t){var n=e;if(n&&n.length>0){var r=n[0],o=new FileReader;return o.onload=function(e){return t(e.target.result,r.size)},o.readAsDataURL(r)}return t(null)})),g(e,"getThumbnailDataUri",(function(t){e.getDataUri(e.files,t)})),g(e,"generateUUID",(function(){var e=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+(0,u.I)(16))%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))})),g(e,"processUpdateThumbnail",(function(t,n,r){var o=e.generateUUID(),i="THUMBNAIL";!e.props.map||r||!e.props.map.thumbnail||e.refs.imgThumbnail||n||e.deleteThumbnail(e.props.map.thumbnail,e.props.map.id,!0),e.props.map&&!r&&e.props.map.newThumbnail&&!e.refs.imgThumbnail&&n&&(e.deleteThumbnail(e.props.map.thumbnail,e.props.map.id,!1),e.props.onSaveAll(t,n,o,r,i,e.props.map.id)),e.props.map.newThumbnail&&r&&e.refs.imgThumbnail&&(e.deleteThumbnail(e.props.map.thumbnail,null,!1),e.props.onSaveAll(t,n,o,r,i,e.props.map.id)),e.props.map.newThumbnail&&!r&&e.refs.imgThumbnail&&e.props.onSaveAll(t,n,o,r,i,e.props.map.id),e.props.map.newThumbnail||r||e.refs.imgThumbnail||(e.props.map.thumbnail&&n&&e.deleteThumbnail(e.props.map.thumbnail,e.props.map.id,!1),e.props.onSaveAll(t,n,o,r,i,e.props.map.id))})),g(e,"updateThumbnail",(function(t,n){e.props.map.errors&&e.props.map.errors.length||e.getDataUri(e.files,(function(r){return e.processUpdateThumbnail(t,n,r),r}))})),g(e,"deleteThumbnail",(function(t,n){if(t&&-1!==t.indexOf("geostore")){var r=(0,l.C)(t);r&&e.props.onDeleteThumbnail(r,n)}})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(t,e),n=t,(r=[{key:"renderThumbnailErrors",value:function(){return this.props.thumbnailErrors&&this.props.thumbnailErrors.length>0?o().createElement("div",{className:"dropzone-errorBox alert-danger"},o().createElement("p",null,o().createElement(c.Z,{msgId:"map.error"})),this.props.thumbnailErrors.map((function(e){return o().createElement("div",{id:"error"+e,key:"error"+e,className:"error"+e},O[e])}))):null}},{key:"render",value:function(){var e=this;return o().createElement(s.Z,f({ref:"imgThumbnail",thumbnail:this.getThumbnailUrl(),className:null,checkOriginalFileSize:this.props.checkOriginalFileSize,dropZoneProps:{className:"dropzone alert alert-info",rejectClassName:"alert-danger"},loading:this.props.loading,maxFileSize:this.props.maxFileSize,style:{pointerEvents:this.props.map.saving?"none":"auto"},label:this.props.withLabel&&o().createElement("label",{className:"control-label"},o().createElement(c.Z,{msgId:"map.thumbnail"})),ù:!0,message:o().createElement(o().Fragment,null,this.props.message,o().createElement("br",null),this.props.suggestion),error:this.renderThumbnailErrors(),onUpdate:function(t,n){var r;e.props.onError([],e.props.map.id),e.files=n,e.props.onUpdate(t,null==n||null===(r=n[0])||void 0===r?void 0:r.preview)},onError:function(t,n){e.props.onError(t,e.props.map.id),e.files=n,e.props.onUpdate(null,null)},onRemove:function(){e.files=null,e.props.onUpdate(null,null),e.props.onRemoveThumbnail(),e.props.onError([],e.props.map.id)}},this.props.thumbnailOptions&&{thumbnailOptions:this.props.thumbnailOptions}))}}])&&d(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o().Component);g(w,"propTypes",{glyphiconRemove:a().string,style:a().object,thumbnailErrors:a().array,loading:a().bool,withLabel:a().bool,map:a().object,maxFileSize:a().number,thumbnailOptions:a().object,onDrop:a().func,onError:a().func,onUpdate:a().func,onSaveAll:a().func,onCreateThumbnail:a().func,onDeleteThumbnail:a().func,onRemoveThumbnail:a().func,message:a().oneOfType([a().string,a().element]),suggestion:a().oneOfType([a().string,a().element]),checkOriginalFileSize:a().bool}),g(w,"contextTypes",{messages:a().object}),g(w,"defaultProps",{loading:!1,withLabel:!0,glyphiconRemove:"remove-circle",maxFileSize:5e5,onDrop:function(){},onError:function(){},onUpdate:function(){},onSaveAll:function(){},onRemoveThumbnail:function(){},onCreateThumbnail:function(){},onDeleteThumbnail:function(){},message:o().createElement(c.Z,{msgId:"map.message"}),suggestion:o().createElement(c.Z,{msgId:"map.suggestion"}),map:{},thumbnailErrors:[],thumbnailOptions:null});const S=w},638445:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var r=n(124852),o=n.n(r),i=n(480681),a=n(697111),c=n(993451),l=["debounceTime"],u=["fallbackValue"];function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(null,arguments)}function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var y=(0,a.Z)("onChange","value")((0,c.Z)("placeholder")((function(e){e.debounceTime;var t=d(e,l);return o().createElement(i.NI,f({},t,{onChange:function(e){return t.onChange(e.target.value)}}))})));const m=function(e){var t,n,i=e.fallbackValue,a=d(e,u),c=s((0,r.useState)(null!==(t=a.value)&&void 0!==t?t:i),2),l=c[0],p=c[1],m=s((0,r.useState)(null!==(n=a.value)&&void 0!==n?n:i),2),b=m[0],v=m[1],g=s((0,r.useState)(0),2),h=g[0],O=g[1],w=(0,r.useRef)(!1),S=(0,r.useRef)();function P(e){var t=!isNaN(parseFloat(e));return t&&void 0!==a.min&&e<a.min?{changed:!0,value:a.min}:t&&void 0!==a.max&&e>a.max?{changed:!0,value:a.max}:{changed:!1,value:t?parseFloat(e):e}}return S.current=l,(0,r.useEffect)((function(){var e;S.current!==a.value&&p(null!==(e=a.value)&&void 0!==e?e:i)}),[a.value]),o().createElement(y,f({},a,{key:h,value:l,onChange:function(e){if(w.current){var t=e,n=!0;if("number"===a.type){var r=P(t).changed;(""===t||r)&&(n=!1)}p(t),n&&a.onChange(t)}},onChangeNoDebounce:v,onBlur:function(){if("number"===a.type)if(""===b)a.onChange(void 0),p(i),O((function(e){return e+1}));else{var e=P(b).value;a.onChange(e),O((function(e){return e+1})),p(e)}w.current=!1},onFocus:function(){w.current=!0}}))}},487320:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var r=n(124852),o=n.n(r),i=n(45697),a=n.n(i),c=n(454037),l=n(743129),u=n(480681),s=n(352595);function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var f=function(e){var t,n,i=e.text,a=e.placement,c=e.bsStyle,l=e.left,f=e.top,d=e.title,y=e.glyph,m=e.id,b=(0,r.useRef)(),v=(t=(0,r.useState)(!1),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),g=v[0],h=v[1];return o().createElement("span",{className:"mapstore-info-popover",onMouseLeave:function(){return h(!1)}},o().createElement(u.gG,{onMouseEnter:function(){h(!0)},ref:function(e){b.current=e},className:"text-".concat(c),glyph:y}),o().createElement(s.Z,{placement:a,show:g,target:function(){return b.current}},o().createElement(u.J2,{id:m,placement:a,positionLeft:l,positionTop:f,title:d},o().createElement("div",{style:{display:"flex"}},i))))};f.propTypes={id:a().string,title:a().string,text:a().string,glyph:a().string,bsStyle:a().string,placement:a().string,left:a().number,top:a().number,trigger:a().oneOfType([a().array,a().bool])},f.defaultProps={id:"",title:"",text:"",placement:"right",left:200,top:50,glyph:"question-sign",bsStyle:"info"};const d=f;var y=n(615402),m=n(453005);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v.apply(null,arguments)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return(t=function(e){var t=function(e){if("object"!=b(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){var t=e.id,n=e.label,r=e.infoFormat,i=e.availableInfoFormat,a=e.popoverMessage,s=e.disabled,p=e.onInfoFormatChange,f=e.selectProps,b=Object.keys(i).reduce((function(e,t){var n=i[t]===m.qk;return Object.keys(e).map((function(t){return e[t]})).some((function(e){return e===i[t]}))||n?e:h(h({},e),{},O({},t,i[t]))}),{}),g=Object.keys(b).map((function(e){return{value:b[e],label:(0,c.kR)(b[e])||e}})),w=o().createElement(o().Fragment,null,"   ",a&&o().createElement(d,{text:o().createElement(y.Z,{msgId:a})}),o().createElement(l.ZP,v({},f,{id:t,value:r,clearable:!1,disabled:s,options:g,onChange:function(e){return p(null==e?void 0:e.value)}})));return n?o().createElement(u.cw,{bsSize:"small"},o().createElement(u.J$,null,n),w):w}w.propTypes={id:a().string,label:a().oneOfType([a().func,a().string,a().object]),availableInfoFormat:a().object,infoFormat:a().string,popoverMessage:a().string,onInfoFormatChange:a().func,disabled:a().bool,selectProps:a().object},w.defaultProps={id:"mapstore-feature-format-selector",availableInfoFormat:(0,c.eq)(),infoFormat:(0,c.wR)(),popoverMessage:"",onInfoFormatChange:function(){},selectProps:{}};const S=w},352595:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=(0,n(461365).Z)(n(480681).aV)},61018:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(124852),o=n.n(r),i=n(807472),a=n(480681);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}var l=["show","style","modal","draggable","closeGlyph","closable","onClose","title","header","footer","children"];function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(null,arguments)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=function(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const d=function(e){var t=e.show,n=e.style,r=void 0===n?{}:n,c=e.modal,s=e.draggable,f=void 0!==s&&s,d=e.closeGlyph,y=void 0===d?"1-close":d,m=e.closable,b=void 0===m||m,v=e.onClose,g=void 0===v?function(){}:v,h=e.title,O=e.header,w=e.footer,S=e.children,P=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,l);return t?o().createElement(i.Z,u({modal:c,onClickOut:b&&c?function(){return g()}:null,style:p(p({},r),{},{display:t?"block":"none"}),draggable:f},P),o().createElement("span",{role:"header"},h||O||o().createElement("span",null," "),b?o().createElement("button",{onClick:function(){return g()},className:"settings-panel-close close"},o().createElement(a.gG,{glyph:y})):null),o().createElement("span",{role:"body"},S),w?o().createElement("span",{role:"footer"},w):null):null}},625311:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(124852),o=n.n(r),i=n(590937),a=n(867076),c=["connectDragSource","connectDragPreview","connectDropTarget","isDragging","isOver"];function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(null,arguments)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e,t,n){return(t=function(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f={beginDrag:function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e)}};const d=(0,a.branch)((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).isDraggable}),(0,a.compose)((0,i.Ej)("row",f,(function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging(),draggingItem:t.getItem()||null}})),(0,i.GR)("row",{drop:function(e,t){var n=t.getItem();n.sortId!==e.sortId&&e.onSort(e.sortId,n.sortId,{id:e.id,containerId:e.containerId},{id:n.id,containerId:n.containerId})}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}})),(function(e){return function(t){var n=t.connectDragSource,r=t.connectDragPreview,i=t.connectDropTarget,a=t.isDragging,l=t.isOver,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,c),p=s.draggingItem&&s.draggingItem.sortId<s.sortId,f=s.draggingItem&&s.draggingItem.containerId===s.containerId,d=f&&a?" ms-dragging":"",y=f&&l?" ms-over":"",m=f&&p?" ms-above":" ms-below";return r(i(o().createElement("div",{className:"ms-dragg".concat(d).concat(y," ").concat(m)},o().createElement("div",null,o().createElement(e,u({},s,{connectDragSource:n,isDragging:a,isOver:l,onDrop:function(e){return e.stopPropagation()}}))))))}})))},245567:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n(124852),o=n.n(r),i=n(867076);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}var c=["onSort","isDraggable","items","containerId"];function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(null,arguments)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=function(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const f=(0,i.compose)((0,i.branch)((function(e){var t=e.isDraggable;return void 0===t||t}),(function(e){return function(t){var n=t.onSort,r=t.isDraggable,i=t.items,a=void 0===i?[]:i,u=t.containerId,p=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,c),f=a.map((function(e,t){return s(s({},e),{},{onSort:n,isDraggable:r,sortId:t,key:e.id||t,containerId:u})}));return o().createElement(e,l({},s(s({},p),{},{isDraggable:r}),{items:f}))}})))},5993:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var r=n(45697),o=n.n(r),i=n(984596),a=n.n(i),c=n(867076),l=n(86638),u=["locale"];function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return(t=function(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const y=function(e){return(0,c.compose)((0,c.getContext)({locale:o().string}),(0,c.mapProps)((function(t){var n=t.locale,r=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,u);return f(f({},r),a()(e).reduce(function(e,t){return function(){var n=arguments.length>1?arguments[1]:void 0;return f(f({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),{},d({},n,e[n]&&(0,l.MZ)(t,e[n])))}}(r,n),{}))})))}},979105:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(867076);const o=function(e,t,n){return(0,r.branch)((function(){return!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})[t]}),(0,r.withState)(e,t,n))}},145869:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var r=n(124852),o=n.n(r),i=n(45697),a=n.n(i);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function u(e,t,n){return t=p(t),function(e,t){if(t&&("object"==c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,s()?Reflect.construct(t,n||[],p(e).constructor):t.apply(e,n))}function s(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(s=function(){return!!e})()}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function d(e,t,n){return(t=y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this;return o().createElement("label",{className:"mapstore-switch-btn ".concat(this.props.className)},o().createElement("input",{type:"checkbox",disabled:this.props.disabled,checked:this.props.checked,onChange:function(){return e.props.onChange(!e.props.checked)}}),o().createElement("span",{onClick:function(){return e.props.onClick(!e.props.checked)},className:"m-slider"}))}}])&&l(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o().Component);d(m,"propTypes",{disabled:a().bool,className:a().string,checked:a().bool,onChange:a().func,onClick:a().func}),d(m,"defaultProps",{className:"",checked:!1,onChange:function(){},onClick:function(){}});const b=m},212961:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(124852),o=n.n(r),i=n(45697),a=n.n(i),c=n(480681),l=n(857037);function u(e){var t=e.color,n=e.format,r=e.line,i=e.onChangeColor,a=e.disableAlpha,u=e.containerNode,s=e.onOpen,p=e.disabled,f=e.presetColors,d=e.placement;return o().createElement("div",{className:"ms-color-selector"},o().createElement(l.Z,{text:o().createElement(c.gG,{glyph:"dropper"}),format:n,line:r,value:t,onChangeColor:i,pickerProps:{disableAlpha:a,presetColors:f},containerNode:u,disabled:p,onOpen:s,placement:d}))}u.propTypes={color:a().oneOfType([a().string,a().shape({r:a().number,g:a().number,b:a().number,a:a().number})]),format:a().string,line:a().bool,onChangeColor:a().func,disableAlpha:a().bool,containerNode:a().node,disabled:a().bool,onOpen:a().func,presetColors:a().array,placement:a().string},u.defaultProps={line:!1,onChangeColor:function(){},onOpen:function(){}};const s=u},75927:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var r=n(513218),o=n.n(r),i=n(124852),a=n.n(i),c=n(480681),l=n(805346),u=n(815135),s=n(898631);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}var f=["settings","element","tabs","activeTab","width","groups","isLocalizedLayerStylesEnabled","setActiveTab","onUpdateParams","onRetrieveLayerData","realtimeUpdate"];function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(null,arguments)}var y=(0,u.Z)(c.LY);const m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.settings,n=e.element,r=void 0===n?{}:n,i=e.tabs,u=void 0===i?[]:i,m=e.activeTab,b=e.width,v=e.groups,g=e.isLocalizedLayerStylesEnabled,h=e.setActiveTab,O=void 0===h?function(){}:h,w=e.onUpdateParams,S=void 0===w?function(){}:w,P=e.onRetrieveLayerData,E=void 0===P?function(){}:P,j=e.realtimeUpdate,T=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,f);return a().createElement(c.X2,{key:"ms-toc-settings-navbar",className:"ms-row-tab"},a().createElement(c.JX,{xs:12},a().createElement(c.JL,{bsStyle:"tabs",activeKey:m,justified:!0},u.map((function(e){return a().createElement(y,{key:"ms-tab-settings-"+e.id,tooltip:a().createElement(l.Z,{msgId:e.tooltipId}),eventKey:e.id,onClick:function(){return O(e.id)}},a().createElement(c.gG,{glyph:e.glyph}))})))),a().createElement(c.JX,{xs:12},u.filter((function(e){return e.id&&e.id===m})).filter((function(e){return e.Component})).map((function(e){var n,i;return a().createElement(e.Component,d({},T,{hideInteractiveLegendOption:!0,key:"ms-tab-settings-body-"+e.id,containerWidth:b,element:r,groups:v,nodeType:t.nodeType,settings:t,retrieveLayerData:E,isLocalizedLayerStylesEnabled:g,projection:null===(n=T.map)||void 0===n?void 0:n.projection,isCesiumActive:(null===(i=T.map)||void 0===i?void 0:i.visualizationMode)===s.nU._3D,onChange:function(e,t){return o()(e)?S(e,j):S((n={},i=t,(r=function(e){var t=function(e){if("object"!=p(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}(r=e))in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n),j);var n,r,i}}))}))))}},618300:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(124852),o=n.n(r),i=n(867076),a=n(442367),c=n(803307);function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onSelect,n=e.selectedNodes,r=e.updateMapEntries,i=void 0===r?function(){}:r,c=e.map;return o().createElement(a.Z,{map:c,selectedNodes:n,onSelectNode:t,config:{hideOpacitySlider:!1,showFullTitle:!0,showOpacityTooltip:!0,showTitleTooltip:!0,sortable:!0,visualizationMode:null==c?void 0:c.visualizationMode,layerOptions:{legendOptions:{WMSLegendOptions:"forceLabels:on",scaleDependent:!0,legendWidth:12,legendHeight:12},hideLegend:!1}},onChangeMap:function(e){i({layers:null==e?void 0:e.layers,groups:null==e?void 0:e.groups},"replace")}})}const u=(0,i.compose)(c.Z)((function(e){return o().createElement(l,e)}))},803307:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(984596),o=n.n(r),i=n(630998),a=n.n(i),c=n(867076),l=n(624262),u=function(e){return"".concat(e.mapId?"maps[".concat(e.mapId,"]"):"map")};const s=(0,c.withHandlers)({changeLayerProperty:function(e){var t=e.onChange,n=void 0===t?function(){}:t,r=e.map,o=void 0===r?{}:r;return function(e,t,r){var i=a()(o.layers||[],{id:e});n("".concat(u(o),".layers[").concat(i,"].").concat(t),r)}},changeLayerPropertyByGroup:function(e){var t=e.onChange,n=void 0===t?function(){}:t,r=e.map,o=void 0===r?{}:r;return function(e,t,r){return o.layers.filter((0,l.CK)(e)).map((function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id;return a()(o.layers||[],{id:e})})).filter((function(e){return e>=0})).map((function(e){return n("".concat(u(o),".layers[").concat(e,"].").concat(t),r)}))}},changeGroupProperty:function(e){var t=e.onChange,n=void 0===t?function(){}:t,r=e.map,i=void 0===r?{}:r;return function(e,t,r){var c,l=i.groups?o()(i.groups):[],s=a()(l,(function(t){return e===t.id})),p=-1===s?l.length:s;"expanded"!==t||null!=l&&null!==(c=l[p])&&void 0!==c&&c.id||n("".concat(u(i),".groups[").concat(p,"].id"),e),n("".concat(u(i),".groups[").concat(p,"].").concat(t),r)}},updateMapEntries:function(e){var t=e.onChange,n=void 0===t?function(){}:t,r=e.map,o=void 0===r?{}:r;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object.keys(e).map((function(r){return n("".concat(u(o),"[").concat(r,"]"),e[r],t)}))}}})},648860:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(867076),o=n(624262);function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const c=(0,r.compose)((0,r.withStateHandlers)((function(){return{selectedLayers:[],selectedGroups:[]}}),{onNodeSelect:function(e){var t=e.selectedLayers,n=void 0===t?[]:t,r=e.selectedGroups,a=void 0===r?[]:r;return function(e,t,r){var c=(0,o.WR)([].concat(i(n),i(a)),e,r),l="layer"===t?[].concat(i(n),[e]):n,u="group"===t?[].concat(i(a),[e]):a;return{selectedLayers:c.filter((function(e){return l.includes(e)})),selectedGroups:c.filter((function(e){return u.includes(e)}))}}}}),(0,r.withProps)((function(e){var t=e.selectedLayers,n=e.selectedGroups;return{selectedNodes:[].concat(i(t),i(n))}})))},910336:(e,t,n)=>{"use strict";n.d(t,{Z:()=>X});var r=n(227361),o=n.n(r),i=n(867076),a=n(624262),c=n(979105),l=n(487427),u=n(33848),s=n(363209),p=n(630998),f=n.n(p),d=n(45697),y=n.n(d),m=n(124852),b=n.n(m),v=n(480681),g=n(743129),h=n(38560),O=n(805346);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,I(r.key),r)}}function P(e,t,n){return t=j(t),function(e,t){if(t&&("object"==w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,E()?Reflect.construct(t,n||[],j(e).constructor):t.apply(e,n))}function E(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(E=function(){return!!e})()}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}function C(e,t,n){return(t=I(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){var t=function(e){if("object"!=w(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(t)?t:t+""}var k=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return C(e=P(this,t,[].concat(r)),"renderLegend",(function(){return null})),C(e,"renderItemLabel",(function(e){return b().createElement("div",null,b().createElement("div",{key:"item-title"},e.title||e.name),b().createElement("div",null,b().createElement("small",{className:"text-muted",key:"item-key-description"},e.name)))})),C(e,"renderError",(function(){return e.props.element&&e.props.element.capabilities&&e.props.element&&e.props.element.capabilities.error?b().createElement(v.bZ,{bsStyle:"danger"},b().createElement(O.Z,{msgId:"layerProperties.styleListLoadError"})):null})),C(e,"updateEntry",(function(t,n){var r=n.target.value;e.props.onChange(t,r)})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this,t=[{label:"Default Style",value:""}].concat((this.props.element.availableStyles||[]).map((function(t){return{label:e.renderItemLabel(t),value:t.name}})));return(this.props.element.style&&this.props.element.availableStyles&&f()(this.props.element.availableStyles,(function(t){return t.name===e.props.element.style})))>=0||!this.props.element.style||t.push({label:this.props.element.style,value:this.props.element.style}),b().createElement(v.rj,{fluid:!0,style:{paddingTop:15,paddingBottom:15}},b().createElement("form",{ref:"style"},b().createElement(g.ZP.Creatable,{key:"styles-dropdown",options:t,isLoading:this.props.element&&this.props.element.capabilitiesLoading,value:this.props.element.style||"",onOpen:function(){!e.props.element||e.props.element.capabilities&&e.props.element.availableStyles||e.props.retrieveLayerData(e.props.element)},promptTextCreator:function(e){return b().createElement(O.Z,{msgId:"layerProperties.styleCustom",msgParams:{value:e}})},onChange:function(t){e.updateEntry("style",{target:{value:t&&t.value||""}})}}),b().createElement("br",null),this.renderLegend(),this.renderError(),b().createElement(h.Z,{bsStyle:"primary",style:{float:"right"},onClick:function(){return e.props.retrieveLayerData(e.props.element)}},b().createElement(v.gG,{glyph:"refresh"})," ",b().createElement(O.Z,{msgId:"layerProperties.stylesRefreshList"})),b().createElement("br",null)))}}])&&S(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(b().Component);C(k,"propTypes",{retrieveLayerData:y().func,onChange:y().func,element:y().object,groups:y().array}),C(k,"defaultProps",{element:{},retrieveLayerData:function(){},onChange:function(){}});const D=k;var M=n(803307);const A=(0,i.withProps)((function(e){var t,n,r,o=e.map;return{nodes:(t=(0,a.DN)(o),n=t.layers,r=void 0===n?{}:n,(0,a.C1)(r.flat||[],r.groups||[]).groups)}}));var x=n(49977),R=n.n(x),Z=n(680833),N=n(577215);function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return(t=function(e){var t=function(e){if("object"!=L(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=L(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==L(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const z=(0,i.mapPropsStream)((function(e){var t=(0,i.createEventHandler)(),n=t.stream,r=t.handler;return e.pluck("element").distinctUntilChanged((function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id===e.id})).switchMap((function(){return n.switchMap((function(e){return(0,Z.kB)(e).map((function(e){return B(B({},(0,N.Br)(e)),{},{capabilitiesLoading:null})})).startWith({capabilitiesLoading:!0})})).catch((function(e){return R().Observable.of({capabilitiesLoading:null,capabilities:{error:"error getting capabilities",details:e},description:null})}))})).startWith({}).combineLatest(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return B(B({},t),{},{retrieveLayerData:r,element:B(B({},t.element),e)})}))}));var F=n(666379),U=n.n(F);function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}var H=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;for(var o in t)null!==t[o]&&"object"===V(t[o])&&(U()(t[o],n)&&r.apply(void 0,[t[o]]),e(t[o],n,r))};const G=(0,i.withProps)((function(e){var t=e.nodes,n=void 0===t?{}:t,r=e.editNode,o={};return r&&H(n,{id:r},(function(e){o=e})),{selectedNode:o}}));function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e,t,n){return(t=function(e){var t=function(e){if("object"!=q(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==q(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y=z(D),Q=(0,i.withProps)((function(e){return{tabs:(e.tabs||[{id:"general",titleId:"layerProperties.general",tooltipId:"layerProperties.general",glyph:"wrench",visible:!0,Component:s.Z},{id:"display",titleId:"layerProperties.display",tooltipId:"layerProperties.display",glyph:"eye-open",visible:e.settings&&"layers"===e.settings.nodeType,Component:u.Z},{id:"style",titleId:"layerProperties.style",tooltipId:"layerProperties.style",glyph:"dropper",visible:e.settings&&"layers"===e.settings.nodeType&&e.element&&"wms"===e.element.type,Component:Y}]).filter((function(e){return!!e.visible}))}}));const X=(0,i.compose)(A,G,(0,i.withState)("settings","onUpdateSettings",{}),(0,i.withProps)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,n=void 0===t?{}:t,r=e.selectedNode,i=e.settings,c=void 0===i?{}:i;return{element:r,settings:K(K({},c),{},{nodeType:r&&r.nodes?"groups":"layers",options:{opacity:c.opacity>=0?c.opacity:r.opacity>=0?r.opacity:1}}),groups:o()((0,a.DN)(n),"layers.groups")}})),(0,i.compose)(M.Z,(0,i.withHandlers)({onUpdateNode:function(e){var t=e.changeLayerProperty,n=void 0===t?function(){}:t,r=e.changeGroupProperty,o=void 0===r?function(){}:r,i=e.editNode;return function(e,t,r){"layers"===t&&Object.keys(r).map((function(e){return n(i,e,r[e])})),"groups"===t&&Object.keys(r).map((function(e){return o(i,e,r[e])}))}}}),(0,i.withHandlers)({onUpdateParams:function(e){var t=e.settings,n=void 0===t?{}:t,r=e.onUpdateNode,o=void 0===r?function(){}:r;return function(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&o(n.node,n.nodeType,K(K({},n.props),e))}}})),l.kZ,(0,c.Z)("activeTab","setActiveTab","general"),Q)},202576:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var r=n(124852),o=n.n(r),i=n(180307),a=n.n(i),c=n(45697),l=n.n(c),u=n(480681),s=n(352595),p=n(950966);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function y(e,t,n){return t=b(t),function(e,t){if(t&&("object"==f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,m()?Reflect.construct(t,n||[],b(e).constructor):t.apply(e,n))}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(m=function(){return!!e})()}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function g(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}var O=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),y(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(t,e),n=t,(r=[{key:"renderPopover",value:function(){return o().createElement(u.J2,{id:this.props.id,placement:this.props.placement,positionLeft:this.props.left,positionTop:this.props.top,title:this.props.title,style:this.props.popoverStyle},this.props.text)}},{key:"renderContent",value:function(){var e=this;return o().createElement(u.gG,{ref:function(t){e.target=t},className:"text-".concat(this.props.bsStyle),glyph:this.props.glyph})}},{key:"render",value:function(){var e=this,t=!0===this.props.trigger?["hover","focus"]:this.props.trigger;return o().createElement("span",{className:"mapstore-info-popover"},this.props.trigger?o().createElement(p.Z,{trigger:t,placement:this.props.placement,overlay:this.renderPopover()},this.renderContent()):[this.renderContent(),o().createElement(s.Z,{placement:this.props.placement,show:!0,target:function(){return a().findDOMNode(e.target)}},this.renderPopover())])}}])&&d(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o().Component);g(O,"propTypes",{id:l().string,title:l().string,text:l().string,glyph:l().string,bsStyle:l().string,placement:l().string,left:l().number,top:l().number,trigger:l().oneOfType([l().array,l().bool]),popoverStyle:l().object}),g(O,"defaultProps",{id:"",title:"",text:"",placement:"right",left:200,top:50,glyph:"question-sign",bsStyle:"info",trigger:["hover","focus"]});const w=O},589919:(e,t,n)=>{"use strict";n.d(t,{hP:()=>u});var r=n(984596),o=n.n(r),i=n(49977),a=n.n(i);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var l=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.startWith.apply(e,function(e){if(Array.isArray(e))return c(e)}(t=n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())},u=function(e,t,n){return function(r){return(n?l(r,o()(e)).catch(n):l(r,o()(e))).concat(a().Observable.from(o()(t)))}}},680833:(e,t,n)=>{"use strict";n.d(t,{kB:()=>g,HI:()=>h});var r=n(472500),o=n.n(r),i=(n(91175),n(490173)),a=n(49977),c=n(501157),l=n(375875),u=n.n(l),s=(n(916651),n(624262)),p=n(510284),f=n(233044),d=n(611847);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return(t=function(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}i.default;var g=function(e){return a.Observable.defer((function(){return c.ZP.getCapabilities((0,s.Fh)(e))})).let(p.oB).map((function(t){return c.ZP.parseLayerCapabilities(t,e)}))},h=function(e){return function(e){return a.Observable.defer((function(){return u().get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.search,r=void 0===n?{}:n,i=e.url,a=o().parse((0,d.eW)(r.url||i),!0);return o().format(b(b({},a),{},{search:void 0,query:b(b({},a.query),{},{service:"WMS",version:c.ID,layers:t,outputFormat:"application/json",request:"DescribeLayer"})}))}(e))})).let(p.oB)}(e).map((function(e){var t=e.data,n=void 0===t?{}:t;return n&&n.layerDescriptions[0]})).map((function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).owsURL;return b(b({},e),{},{params:{},search:t?{type:"wfs",url:(0,f.cleanAuthParamsFromURL)(t)}:void 0})}))}},159817:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ic});var r={};n.r(r),n.d(r,{cleanUpEmptyStoryContainers:()=>ge,closeShareOnGeostoryChangeMode:()=>Pe,editMediaForBackgroundEpic:()=>me,editWebPageComponent:()=>fe,exportGeostory:()=>ke,handlePendingGeoStoryChanges:()=>Ee,hideCarouselItemsOnUpdateCurrentPage:()=>we,importGeostory:()=>De,inlineEditorEditMap:()=>Se,loadGeostoryEpic:()=>be,loadStoryOnHistoryPop:()=>Ce,openMediaEditorForNewMedia:()=>ue,openWebPageComponentCreator:()=>pe,reloadGeoStoryOnLoginLogout:()=>ve,saveGeoStoryResource:()=>de,scrollOnLoad:()=>Te,scrollSideBar:()=>Ie,scrollToContentEpic:()=>ye,setFocusOnMapEditing:()=>Oe,sortContentEpic:()=>he,urlUpdateOnScroll:()=>je});var o=n(124852),i=n.n(o),a=n(171703),c=n(22222),l=n(375933),u=n.n(l),s=n(322843),p=n(192579),f=n(86638),d=n(531398),y=n(134990),m=n(93848),b=n(49977),v=n(91175),g=n.n(v),h=n(807654),O=n.n(h),w=n(747037),S=n.n(w),P=n(414293),E=n.n(P),j=n(595825),T=n.n(j),C=n(158748),I=n.n(C),k=n(227361),D=n.n(k),M=n(701469),A=n.n(M),x=n(441609),R=n.n(x),Z=n(275982),N=n(423570),L=n.n(N),W=n(375875),B=n.n(W),_=n(291312),z=n(782904),F=n(197395),U=n(263516),V=n(274621),H=n(866113),G=n(107501),q=n(589919),$=n(988753),K=n(727693),J=n(282385);function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}var Q=["status","statusText","data","message"],X=["data","isStatic"];function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||ae(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e,t,n){return(t=function(e){var t=function(e){if("object"!=Y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function ie(e){return function(e){if(Array.isArray(e))return ce(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ae(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){if(e){if("string"==typeof e)return ce(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ce(e,t):void 0}}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var le=function(e,t,n){return function(r){return r.ofType(m.AQ).switchMap((function(r){var o=r.resource,i=void 0===o?{}:o,a=[],c=e.getState(),l=(0,G.hb)(c),u=(0,G.IQ)(c),s=g()((0,H.jq)(c).filter((function(e){return e.data&&(u!==K.r.GEOSTORY&&e.data.id||e.id)===i.id}))),f=i.id;s?f=s.id:R()(i)?a=[].concat(ie(a),[(0,y.Od)("".concat(t)),(0,m.Cp)()]):(f=i.id||L()(),a=[].concat(ie(a),[(0,y.rp)(f,l,i.data?i.data:i)]));var d=l===p.Tr.MAP?{resourceId:f,type:l,map:void 0}:{resourceId:f,type:l},v=[(0,y.Vx)("".concat(t),d,"merge")];return n===p.ID.CAROUSEL&&v.push((0,y.Vx)("".concat(t,".map"),{mapInfoControl:!0},"merge")),a=[].concat(ie(a),v,[(0,m.Cp)()]),b.Observable.from(a)}))}},ue=function(e,t){return e.ofType(y.D7).filter((function(e){var t=e.element,n=void 0===t?{}:t;return n.type===p.bT.MEDIA||(0,p.lt)(n)})).switchMap((function(n){var r=n.path,o=n.element,i="";(0,p.lt)(o)&&"sections"===r&&(i=".contents[0].contents[0]");var a="".concat(r,'[{"id":"').concat(o.id,'"}]').concat(i),c=(0,H.X6)(t.getState());return b.Observable.of((0,m.$Z)("geostory",c)).merge(e.let(le(t,a)),e.ofType(m.B8).switchMap((function(){return b.Observable.of((0,y.Od)(a))})).takeUntil(e.ofType(y.wb))).takeUntil(e.ofType(m.wd))}))},se=function(e){return function(t){return t.ofType(y.Hb).switchMap((function(t){var n=t.src;return b.Observable.of((0,y.Vx)("".concat(e),{src:n,editURL:!1},"merge"))}))}},pe=function(e){return e.ofType(y.D7).filter((function(e){var t=e.element,n=void 0===t?{}:t;return n.type===p.bT.WEBPAGE&&!1!==n.editURL||(0,p.NC)(n)})).switchMap((function(t){var n=t.path,r=t.element,o="";(0,p.NC)(r)&&"sections"===n&&(o=".contents[0].contents[0]");var i="".concat(n,'[{"id":"').concat(r.id,'"}]').concat(o);return b.Observable.of((0,y.Vx)(i,{editURL:!0},"merge")).merge(e.let(se(i))).takeUntil(e.ofType(y.cc))}))},fe=function(e){return e.ofType(y.cc).switchMap((function(t){var n=t.path;return b.Observable.of((0,y.Vx)(n,{editURL:!0},"merge")).merge(e.let(se(n))).takeUntil(e.ofType(y.D7))}))},de=function(e){return e.ofType(y.LE).exhaustMap((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.resource,n=e.delay,r=void 0===n?1e3:n;return(t.id?(0,_.id)(t):(0,_.SN)(t)).switchMap((function(e){return b.Observable.of((0,y.GD)(e),(0,y.g5)(p.ZX.SHOW_SAVE,!1),t.id?(0,y.wJ)(e):(0,Z.VF)("/geostory/".concat(e))).merge(b.Observable.of((0,F.$Z)({id:"STORY_SAVE_SUCCESS",title:"saveDialog.saveSuccessTitle",message:"saveDialog.saveSuccessMessage"})).delay(t.id?0:r))})).let((0,q.hP)((0,y.YP)(!0,"loading"),(0,y.YP)(!1,"loading"))).catch((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.status,n=e.statusText,r=e.data,o=e.message,i=oe(e,Q);return b.Observable.of((0,y.y6)(t?{status:t,statusText:n,data:r}:o||i),(0,y.YP)(!1,"loading"))}))}))},ye=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,n=void 0===t?function(){}:t;return e.ofType(y.D7).switchMap((function(e){var t=e.path,r=e.element;return b.Observable.of(r).switchMap((function(){if(document.getElementById(r.id)){var e=(0,p.u0)(t).sectionId,o=(0,H.I0)(e)(n())?e:r.id;return(0,p.M1)(o,{behavior:"auto",block:"center"}),b.Observable.empty()}throw new Error("Item not mounted yet")})).retryWhen((function(e){return e.delay(200).take(10)}))}))},me=function(e,t){return e.ofType(m.wd).switchMap((function(n){var r=n.path,o=n.owner,i=n.sectionType,a=(0,H.vv)(r)(t.getState()),c=(0,H.Tr)(a)(t.getState());return b.Observable.of((0,G.hb)(t.getState())).filter((function(e){return c&&c.type!==e})).map((function(){return(0,m.y5)(c.type)})).merge(b.Observable.of((0,m.$Z)(o,(0,H.X6)(t.getState())),(0,m.Gh)(a),(0,m.Tk)(i===p.ID.CAROUSEL?["image","video"]:[])).merge(e.let(le(t,r,i)).takeUntil(e.ofType(m.B8,y.D7))))}))},be=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.XH).switchMap((function(e){var t=e.id;return b.Observable.defer((function(){return t&&O()(parseInt(t,10))?B().get("configs/".concat(t,".json")).then((function(e){var t=e.data,n=t.sections,r=A()(n)&&n.map((function(e){return ne(ne({},e),{},{id:L()()})}));return{data:r.length?ne(ne({},t),{},{sections:r}):t,isStatic:!0,canEdit:!0}})):(0,_.RX)(t)})).do((function(e){if(!e.data)throw Error("Wrong data format");return!0})).switchMap((function(e){var n=e.data,o=e.isStatic,i=void 0!==o&&o,a=oe(e,X),c=r(),l=(0,V.qg)(c),u=(0,V.jl)(c),s=S()(n)?JSON.parse(n):n;if(!u&&O()(parseInt(t,10)))return b.Observable.of((0,y.Ct)({status:403}));var f=(0,H.eK)(c)===p.nl.EDIT;return b.Observable.from([].concat(ie(i||f?[(0,y.D_)(a&&a.canEdit||l)]:[]),[(0,y.OS)(t),(0,y.K0)(s),(0,y.DF)(a)]))})).let((0,q.hP)((0,y.YP)(!0,"loading"),(0,y.YP)(!1,"loading"),(function(e){var t=(0,p.of)(),n=t+".errors.loading.unknownError";return 403===e.status?(n=t+".errors.loading.pleaseLogin",((0,V.jl)(r())||(0,H.JM)(r()))&&(n=t+".errors.loading.geostoryNotAccessible")):404===e.status?n=t+".errors.loading.geostoryDoesNotExist":E()(e.status)&&(n=e.message),b.Observable.of((0,F.vU)({title:t+".errors.loading.title",message:n}),(0,y.K0)({}),(0,y.Ct)(ne(ne({},e),{},{messageId:n})))}))).startWith((0,y.K0)({}))}))},ve=function(e){return e.ofType(y.XH).switchMap((function(t){var n=t.id;return e.ofType(U.XP,U.Nv).switchMap((function(){return b.Observable.of((0,y.wJ)(n)).delay(500)})).takeUntil(e.ofType(Z.nk))}))},ge=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.Dq).switchMap((function(e){var t=e.path,n=(0,p.Ll)(t,(0,H.Kg)(r())),o=T()(n,"contents");if(o>0){var i=n.splice(0,o),a=(0,H.$F)(i.join("."))(r());if(a&&a.contents&&0===a.contents.length)return b.Observable.of((0,y.Od)(i.join(".")))}return b.Observable.empty()}))},he=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.tP).switchMap((function(e){var t=e.source,n=e.target,o=e.position,i=r(),a=(0,H.$F)(t)(i);return b.Observable.from([(0,y.Od)(t),(0,y.IH)(n,o,a)])}))},Oe=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.wb).filter((function(e){var t=e.path;return(void 0===t?"":t).endsWith("editMap")})).switchMap((function(e){var t=e.path,n=e.element,o=(0,p.ln)(t,(0,H.Kg)(r())),i=o.flatPath,a=o.path,c=1===i.length,l=c?i[0]:i.pop(),u=c?i[0]:i.shift(),s="background"===a[a.length-2],f=s&&"#".concat(u.id," .ms-section-background-container")||"#".concat(l.id);return(0,p.M1)(l.id),b.Observable.from([(0,y.$A)(n,l,f,s,t.replace(".editMap",""))])}))},we=function(e,t){var n=t.getState;return e.ofType(y.wb).filter((function(e){var t=e.path,n=e.element;return t&&t.endsWith("carouselToggle")&&n})).switchMap((function(e){var t=e.path,r=(0,p.u0)(t)||{},o=r.sectionId,i=r.contentId,a=(0,H.eB)(o)(n())||[];return i&&!R()(a)?b.Observable.from([(0,y.fD)(o,i)]).concat(b.Observable.of((0,y.Vx)(t,!1))):b.Observable.empty()}))},Se=function(e,t){var n=t.getState;return e.ofType(J.nr).filter((function(e){var t=e.owner,n=e.map;return"inlineEditor"===t&&!!n})).switchMap((function(){return e.ofType(J.LE).switchMap((function(t){var r=t.map,o=(0,H.FW)(n()).path;return b.Observable.of((0,y.Vx)("".concat(o,".map"),r,"merge"),(0,y.Vx)("".concat(o,".editMap"),!1),(0,J.Cp)()).takeUntil(e.ofType(J.B8))}))}))},Pe=function(e){return e.ofType(y.vb).switchMap((function(){return b.Observable.of((0,z.Xg)("share","enabled",!1))}))},Ee=function(e){return b.Observable.merge(e.ofType(y.XH).switchMap((function(){return e.ofType(y.Zf)}))).switchMap((function(){return e.ofType(y.D7,y.wb,y.Dq,y.mN,y.QK,y.km).take(1).switchMap((function(){return b.Observable.of((0,y.c0)(!0)).concat(e.ofType(y.si,Z.nk,U.Nv).take(1).switchMap((function(){return b.Observable.of((0,y.c0)(!1))})))}))}))},je=function(e,t){var n=t.getState;return e.ofType(y.un).let(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};return function(r){return r.withLatestFrom(e.startWith(t)).filter((function(e){var t=ee(e,2)[1];return n(t)})).map((function(e){return ee(e,1)[0]}))}}(e.ofType(y.Gx).map((function(e){return!e.status})).startWith(!0))).debounceTime(50).switchMap((function(e){var t=e.sectionId,r=e.columnId;if("edit"!==(0,H.eK)(n())&&(r||t)&&(0,H.bU)(n())){var o,i,a=D()(n(),"geostory.resource.id"),c=(0,p.NP)(window.location.href,null===(o=window)||void 0===o||null===(i=o.location)||void 0===i?void 0:i.hash,a,t,r);c&&history.pushState(null,"",c)}return b.Observable.empty()}))},Te=function(e){return e.ofType(y.ij).switchMap((function(e){var t,n,r,o=e.delay,i=void 0===o?2e3:o,a=null===(t=window)||void 0===t||null===(n=t.location)||void 0===n||null===(r=n.hash)||void 0===r?void 0:r.split("/");return b.Observable.of(a).do((function(){var e,t,n;null!==(e=window)&&void 0!==e&&null!==(t=e.location)&&void 0!==t&&null!==(n=t.hash)&&void 0!==n&&n.includes("shared")?(0,p.M1)(a[7]||a[5],{block:"start",behavior:"auto"}):a.length>5?(0,p.M1)(a[6],{block:"start",behavior:"auto"}):5===a.length&&(0,p.M1)(a[4],{block:"start",behavior:"auto"})})).ignoreElements().startWith((0,y.WE)(!0)).concat(b.Observable.of((0,y.WE)(!1)).delay(i))}))},Ce=function(e){return e.ofType(Z.nk).switchMap((function(e){var t,n=e.payload;if((null==n||null===(t=n.location)||void 0===t?void 0:t.pathname.includes("/geostory/"))&&"POP"===n.action&&!n.isFirstRendering){var r,o=I()(null==n||null===(r=n.location)||void 0===r?void 0:r.pathname);return o.find((function(e){return"shared"===e}))?b.Observable.of((0,y.wJ)(o[2])).delay(500):b.Observable.of((0,y.wJ)(o[1])).delay(500)}return b.Observable.empty()}))},Ie=function(e,t){var n=t.getState;return e.ofType(y.un).filter((function(e){var t=e.columnId,r=e.sectionId;return!("edit"!==(0,H.eK)(n())||!t&&!r)})).debounceTime(50).switchMap((function(){return b.Observable.of(Array.from(document.querySelectorAll(".ms-geostory-builder .mapstore-side-card.ms-highlight")).pop()).filter((function(e){return!!e})).withLatestFrom(b.Observable.of(document.querySelector(".ms-geostory-builder .ms2-border-layout-body")).filter((function(e){return!!e}))).map((function(e){var t=ee(e,2),n=t[0],r=t[1];return function(){var e=n.getBoundingClientRect(),t=e.top,o=e.bottom,i=r.getBoundingClientRect(),a=i.top,c=i.bottom;t<a?r.scrollBy({top:t-a-10,behavior:"smooth"}):o>c&&r.scrollBy({top:o-c+10,behavior:"smooth"})}})).do((function(e){return window.requestAnimationFrame(e)})).ignoreElements()}))},ke=function(e){return e.ofType(y.U3).switchMap((function(e){var t=e.data,n=e.fileName;return b.Observable.of([JSON.stringify(ne({},t)),n,"application/json"]).do((function(e){return $.LR.apply(void 0,ie(e))})).map((function(){return(0,y.g5)("export",!1)}))}))},De=function(e){return e.ofType(y.aF).switchMap((function(e){var t=e.file;return b.Observable.defer((function(){return(0,$.zr)(t[0]).then((function(e){return e}))})).switchMap((function(e){return b.Observable.of((0,y.K0)(e),(0,y.g5)("import",!1))})).catch((function(e){return b.Observable.of((0,F.vU)({title:"dashboard.errors.loading.title"}),(0,y.Ct)(ne({},e)))}))}))},Me=n(308316),Ae=n(166190),xe=n(965539),Re=n(496259),Ze=n(867076),Ne=n(828878);function Le(e){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(e)}function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?We(Object(n),!0).forEach((function(t){_e(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _e(e,t,n){return(t=function(e){var t=function(e){if("object"!=Le(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Le(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}(0,Ze.setObservableConfig)(Ne.Z);var Fe=(0,Ze.compose)((0,Ze.mapPropsStream)((function(e){var t=(0,Ze.createEventHandler)(),n=t.handler,r=t.stream,o="EMPTY",i="EMPTY";return b.Observable.combineLatest(e,r.filter((function(e){var t=e.columnId,n=e.sectionId;return t&&o!==t?(o=t,!0):!(!n||i===n||(i=n,0))})).withLatestFrom(e.pluck("updateCurrentPage")).do((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return ze(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ze(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];return i&&i(o)})).ignoreElements().startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Be(Be({},t.reduce((function(){var e=arguments.length>1?arguments[1]:void 0;return Be(Be({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),e)}),{})),{},{updateCurrentPage:n})}))}))),Ue=n(982030),Ve=n(322762),He=n.n(Ve);function Ge(e){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ge(e)}function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){Ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ke(e,t,n){return(t=function(e){var t=function(e){if("object"!=Ge(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ge(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,Ze.setObservableConfig)(Ne.Z);const Je=(0,Ze.compose)((0,Ze.mapPropsStream)((function(e){var t=(0,Ze.createEventHandler)(),n=t.handler,r=t.stream;return b.Observable.combineLatest(e,function(e,t){return t.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{interceptorTime:e.interceptorTime,updateCurrentPage:e.updateCurrentPage}})).distinctUntilKeyChanged("interceptorTime").switchMap((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.interceptorTime,r=void 0===n?100:n,o=t.updateCurrentPage;return e.scan((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.visible,o=t.entry;return $e($e({},e),{},Ke({},n,{visible:r,entry:o}))}),{}).debounceTime(r).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return He()(Object.keys(e),(function(t){return e[t].visible?D()(e[t],"entry.boundingClientRect.top"):1/0}))})).do((function(e){o&&o({sectionId:e})})).ignoreElements()}))}(r,e).startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return $e($e({},t.reduce((function(){var e=arguments.length>1?arguments[1]:void 0;return $e($e({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),e)}),{})),{},{onVisibilityChange:n})}))})));var Ye=n(45697),Qe=n.n(Ye),Xe=n(218291),et=n(882017),tt=n(61018),nt=n(480681),rt=n(38560),ot=n(805346),it=n(399534),at=(0,Ze.branch)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.viewHeight,o=e.size;return!n||!r||!o}),(0,Ue.Z)((function(){return!0}),(function(){return{glyph:"code"}})));const ct=(0,Ze.compose)(at)((function(e){var t=e.src,n=e.size,r=e.viewHeight;return i().createElement("div",{className:"ms-webpage-wrapper"},i().createElement("iframe",{src:t,height:"".concat((0,p.t4)(n,r),"px")}))}));var lt=n(611847),ut=n(697658),st=n(23279),pt=n.n(st);function ft(e){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ft(e)}function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mt(e,t,n){return(t=function(e){var t=function(e){if("object"!=ft(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ft(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var vt=function(e){var t,n,r=e.id,a=e.onLoad,c=e.loading,l=e.debounceTime,u=e.children,s=e.loaderComponent,p=e.loaderStyle,f=(t=(0,ut.YD)(),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return bt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bt(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=f[0],y=f[1],m=(0,o.useRef)(null),b=s;return(0,o.useEffect)((function(){return m.current=pt()((function(e){a(e)}),l),function(){m.current.cancel()}}),[]),(0,o.useEffect)((function(){y&&c&&m.current(r),!y&&c&&m.current.cancel()}),[y,c,r]),i().createElement("div",{ref:d,className:"ms-visibility-container"},c?b?i().createElement(b,{style:yt({},p)}):null:(0,o.cloneElement)(u,{inView:y}))};vt.propTypes={id:Qe().string,debounceTime:Qe().number,loading:Qe().bool,onLoad:Qe().func,loaderComponent:Qe().oneOfType([Qe().element,Qe().func])},vt.defaultProps={id:"",debounceTime:300,loading:!0,onLoad:function(){},loaderComponent:null};const gt=vt;var ht=n(532425);function Ot(e){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ot(e)}function wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ct(r.key),r)}}function St(e,t,n){return t=Et(t),function(e,t){if(t&&("object"==Ot(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Pt()?Reflect.construct(t,n||[],Et(e).constructor):t.apply(e,n))}function Pt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Pt=function(){return!!e})()}function Et(e){return Et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Et(e)}function jt(e,t){return jt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},jt(e,t)}function Tt(e,t,n){return(t=Ct(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ct(e){var t=function(e){if("object"!=Ot(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ot(t)?t:t+""}var It=function(){return i().createElement("div",{className:"ms-media-loader"},i().createElement(ht.Z,{size:52}))},kt=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Tt(e=St(this,t,[].concat(r)),"state",{url:e.props.src||"",error:!1,loading:!0}),Tt(e,"updateURL",(function(t){var n=t.target.value;e.setState({url:n})})),Tt(e,"save",(function(){var t=e.state.url,n=!(0,lt.K2)(t);e.setState({error:n}),n||e.props.onChange(t)})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jt(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.editURL,o=this.state,a=o.url,c=o.error;return i().createElement(i().Fragment,null,i().createElement(it.Z,null,i().createElement(tt.Z,{modal:!0,show:r,onClickOut:function(e){return e.preventDefault()&&e.stopPropagation()},title:i().createElement(ot.Z,{msgId:"geostory.webPageCreator.title"}),onClose:n,id:"web-page-creator",footer:i().createElement(rt.Z,{bsSize:"small",onClick:this.save},i().createElement(ot.Z,{msgId:"geostory.webPageCreator.saveButton"}))},c&&i().createElement("div",{className:"dropzone-errorBox alert-danger"},i().createElement(ot.Z,{msgId:"geostory.webPageCreator.error"})),i().createElement(nt.cw,{controlId:"WEBPAGE_URL",validationState:c&&"error"},i().createElement(nt.J$,null,i().createElement(ot.Z,{msgId:"geostory.webPageCreator.url.label"})),i().createElement(nt.NI,{label:"URL",type:"text",value:a,onChange:this.updateURL,required:!0})))),this.props.lazy?i().createElement(gt,{key:this.props.id,id:this.props.id,debounceTime:this.props.debounceTime,loading:this.state.loading,onLoad:function(){return e.setState({loading:!1})},loaderComponent:It},i().createElement(ct,this.props)):i().createElement(ct,this.props))}}],r&&wt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().PureComponent);Tt(kt,"propTypes",{editURL:Qe().bool,onClose:Qe().func,onChange:Qe().func,src:Qe().string,id:Qe().string,debounceTime:Qe().number,lazy:Qe().bool}),Tt(kt,"defaultProps",{lazy:!0});var Dt=(0,Ze.compose)((0,Ze.withHandlers)({onClose:function(e){var t=e.update,n=void 0===t?function(){}:t;return function(){return n("editURL",!1,"merge")}}}))(kt);const Mt=(0,a.connect)(null,{onChange:y.YM})(Dt);var At=["type"];function xt(){return xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xt.apply(null,arguments)}var Rt=(0,Xe.Z)()((0,o.lazy)((function(){return Promise.all([n.e(82515),n.e(60808),n.e(25972)]).then(n.bind(n,325972))}))),Zt=function(e){var t=e.type;return i().createElement("div",{className:"ms-content ms-content-unknown"},'warning: unknown content type "'.concat(t,'"'))};const Nt=function(e){var t=e.type,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,At),r=function(e){switch(e){case p.bT.TEXT:return Rt;case p.bT.MEDIA:case p.Tr.IMAGE:case p.Tr.MAP:case p.Tr.VIDEO:return et.ZP;case p.bT.WEBPAGE:return Mt;default:return Zt}}(t);return i().createElement(r,xt({type:t},n))};var Lt=n(725288),Wt=n(80717),Bt=["onClick"];function _t(e){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_t(e)}function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(n),!0).forEach((function(t){$t(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Kt(r.key),r)}}function Vt(e,t,n){return t=Gt(t),function(e,t){if(t&&("object"==_t(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ht()?Reflect.construct(t,n||[],Gt(e).constructor):t.apply(e,n))}function Ht(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ht=function(){return!!e})()}function Gt(e){return Gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gt(e)}function qt(e,t){return qt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qt(e,t)}function $t(e,t,n){return(t=Kt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kt(e){var t=function(e){if("object"!=_t(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=_t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_t(t)?t:t+""}var Jt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Vt(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qt(e,t)}(t,e),n=t,r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){!this.trigger||e.containerWidth===this.props.containerWidth&&e.containerHeight===this.props.containerHeight||this.trigger.hide()}},{key:"render",value:function(){var e=this;return i().createElement(Lt.Z,{className:"add-bar",popoverClassName:"add-bar-popover",content:i().createElement(Wt.Z,{btnDefaultProps:{className:"square-button btn-tray"},buttons:this.props.buttons.map((function(t){var n=t.onClick,r=void 0===n?function(){}:n;return Ft(Ft({},function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,Bt)),{},{onClick:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];r.apply(void 0,n),e.trigger.hide(),n[0]&&n[0].preventDefault&&n[0].preventDefault()}})}))}),ref:function(t){t&&(e.trigger=t.trigger)},placement:"top"},i().createElement(rt.Z,{className:this.props.addButtonClassName},i().createElement(nt.gG,{glyph:"plus"})))}}],r&&Ut(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);$t(Jt,"propTypes",{id:Qe().string,type:Qe().string,buttons:Qe().array,containerWidth:Qe().oneOfType([Qe().number,Qe().string]),containerHeight:Qe().oneOfType([Qe().number,Qe().string]),addButtonClassName:Qe().string}),$t(Jt,"defaultProps",{id:"",type:"",buttons:[],containerWidth:0,containerHeight:0,addButtonClassName:""});const Yt=Jt;function Qt(e){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qt(e)}var Xt=["id"];function en(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tn(Object(n),!0).forEach((function(t){rn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rn(e,t,n){return(t=function(e){var t=function(e){if("object"!=Qt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Qt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function on(){return on=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},on.apply(null,arguments)}const an=function(e){var t=e.viewWidth,n=e.viewHeight,r=e.className,o=e.contentProps,a=void 0===o?{}:o,c=e.addButtons,l=void 0===c?[]:c,u=e.tools,s=void 0===u?[]:u,f=e.contents,d=void 0===f?[]:f,y=e.ContentComponent,m=void 0===y?Nt:y,b=e.mode,v=e.sectionType,g=e.editMedia,h=void 0===g?function(){}:g,O=e.editWebPage,w=void 0===O?function(){}:O,S=e.add,P=void 0===S?function(){}:S,E=e.update,j=void 0===E?function(){}:E,T=e.remove,C=void 0===T?function(){}:T,I=e.bubblingTextEditing,k=void 0===I?function(){}:I,D=e.storyTheme,M=e.sections,A=void 0===M?[]:M,x=e.storyFonts,R=e.innerRef;return i().createElement("div",{ref:R,className:r},d.reduce((function(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1?arguments[1]:void 0,c=o.id,u=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(o,Xt),f=[i().createElement(m,on({id:c,key:"".concat(c,"-content"),mode:b,viewWidth:t,sectionType:v,viewHeight:n,editMedia:function(e){for(var t=e.path,n=void 0===t?"":t,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return h.apply(void 0,[{path:'contents[{"id": "'.concat(c,'"}]')+n}].concat(o))},editWebPage:function(e){for(var t=e.path,n=void 0===t?"":t,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return w.apply(void 0,[{path:'contents[{"id": "'.concat(c,'"}]')+n}].concat(o))},add:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return P.apply(void 0,['contents[{"id": "'.concat(c,'"}].')+e].concat(n))},update:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return j.apply(void 0,['contents[{"id": "'.concat(c,'"}].')+e].concat(n))},remove:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return C.apply(void 0,['contents[{"id": "'.concat(c,'"}]')+(e?"."+e:"")].concat(n))}},a,u,{storyTheme:D,storyFonts:x,bubblingTextEditing:k,tools:s&&s[u.type],sections:A}))];return b===p.nl.EDIT&&l.length>0&&f.push(i().createElement(Yt,{key:"".concat(c,"-content-add-buttons"),containerWidth:t,containerHeight:n,buttons:l.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return nn(nn({},e),{},{onClick:function(){return P("contents",c,e.template)}})}))})),[].concat(function(e){if(Array.isArray(e))return en(e)}(e=r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return en(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?en(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),f)}),[]))};n(966337);var cn=["onVisibilityChange","rootSelector"],ln=["intersectionObserverOptions","onVisibilityChange"];function un(){return un=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},un.apply(null,arguments)}function sn(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const pn=function(e){return(0,Ze.compose)((0,Ze.withHandlers)({onVisibilityChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.onVisibilityChange,r=void 0===n?function(){}:n;return function(e,n){return r({id:t,visible:e,entry:n})}}}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onVisibilityChange,n=(e.rootSelector,sn(e,cn));return function(e){return function(r){var o=r.intersectionObserverOptions,a=void 0===o?{}:o,c=r.onVisibilityChange,l=sn(r,ln),u=t||c;return i().createElement(ut.df,un({},n,a,{onChange:u}),(function(t){var n=t.inView,r=t.ref,o=t.entry;return i().createElement(e,un({},l,{inView:n,inViewRef:r,inViewEntry:o}))}))}}}(e))};var fn=n(90085),dn=n(212610),yn=n(313311),mn=n.n(yn),bn=n(623560),vn=n.n(bn),gn=n(618446),hn=n.n(gn);function On(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return wn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Sn=(0,dn.Z)(nt.PS);function Pn(e){var t=e.value,n=e.options,r=void 0===n?[]:n,a=e.onSelect,c=void 0===a?function(){}:a,l=e.glyph,u=void 0===l?"":l,s=e.tooltipId,p=e.pullRight,f=void 0!==p&&p,d=e.className,y=void 0===d?"square-button-md no-border":d,m=e.disabled,b=e.noTooltipWhenDisabled,v=void 0!==b&&b,g=e.hideMenuItem,h=void 0===g?function(){return!1}:g,O=e.shouldClose,w=e.showSelectionInTitle,S=void 0===w||w,P=On((0,o.useState)(!1),2),j=P[0],T=P[1],C=On((0,o.useState)(!1),2),I=C[0],k=C[1],D=(mn()(r,(function(e){return hn()(e.value,t)}))||{}).glyph;return(0,o.useEffect)((function(){m&&T(!1)}),[m]),i().createElement(Sn,{noCaret:!0,open:j,noTooltipWhenDisabled:v,tooltipId:s,pullRight:f,className:y,disabled:m,title:i().createElement(nt.gG,{glyph:S&&D||u}),onToggle:function(e,n,r){return I||"select"===(null==r?void 0:r.source)||O&&!O(t,n)?null:T(e)}},r.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(null==e?void 0:e.Component)||nt.sN;return h(t,e)?null:i().createElement(n,{key:e.value,selected:t,value:e.value,active:vn()(null==e?void 0:e.isActive)&&e.isActive(t)||!E()(t)&&t===e.value,onClick:null!=e&&e.Component?c:function(){return c(e.value)},onActive:function(e){return k(e)}},e.label)})))}var En=n(312122),jn=n(911766),Tn=n(513218),Cn=n.n(Tn);function In(e){return In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},In(e)}function kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kn(Object(n),!0).forEach((function(t){Mn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mn(e,t,n){return(t=function(e){var t=function(e){if("object"!=In(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=In(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==In(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function An(){return An=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},An.apply(null,arguments)}function xn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Rn=(0,En.Z)(fn.Z),Zn={primary:"btn-primary",default:"btn-default"},Nn=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.align,o=e.sectionType,a=e.size,c=e.update,l=void 0===c?function(){}:c,u=e.filterOptions,s=e.pullRight,p=e.sizeType,f=function(e,t){var n,r,o="horizontal",i="",a=(n=e&&e.split(",")||[],r=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(n,r)||function(e,t){if(e){if("string"==typeof e)return xn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xn(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=a[0],l=a[1],u=e,s="resize-horizontal";return t===o?(i="h-",u=c):"vertical"===t&&(i="v-",u=l,s="resize-vertical"),{sizeProp:function(e){return t?"".concat(t===o?e:c,",").concat("vertical"===t?e:l):e},pre:i,_size:u,glyph:s}}(a,p),d=f.pre,y=f._size,m=f.glyph,b=f.sizeProp;return i().createElement(Pn,An({value:y,noTooltipWhenDisabled:!0,disabled:n,glyph:m,pullRight:s||("right"===r||y==="".concat(d,"full")||y==="".concat(d,"large"))&&!o,tooltipId:"geostory.contentToolbar.contentSize",options:[{value:"".concat(d,"small"),glyph:"size-small",label:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.smallSizeLabel"})},{value:"".concat(d,"medium"),glyph:"size-medium",label:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.mediumSizeLabel"})},{value:"".concat(d,"large"),glyph:"size-large",label:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.largeSizeLabel"})},{value:"".concat(d,"full"),glyph:"size-extra-large",label:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.fullSizeLabel"})}].filter((function(e){return!u||u(e)})),onSelect:function(e){return l("size",b(e))}},p&&{showSelectionInTitle:!1}))},Ln=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.align,o=e.sectionType,a=e.size,c=e.update,l=void 0===c?function(){}:c;return i().createElement(Pn,{value:r,noTooltipWhenDisabled:!0,disabled:"full"===a||n,glyph:"align-center",pullRight:("right"===r||"full"===a||"large"===a)&&!o,tooltipId:"geostory.contentToolbar.contentAlign",options:[{value:"left",label:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.leftAlignLabel"}),glyph:"align-left"},{value:"center",label:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.centerAlignLabel"}),glyph:"align-center"},{value:"right",label:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.rightAlignLabel"}),glyph:"align-right"}],onSelect:function(e){return l("align",e)}})},Wn=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.theme,o=e.storyTheme,a=e.align,c=e.sectionType,l=e.update,u=void 0===l?function(){}:l,s=e.themeProps,p=e.size;return i().createElement(Pn,{value:r,noTooltipWhenDisabled:!0,pullRight:("right"===a||"full"===p||"large"===p)&&!c,glyph:"dropper",tooltipId:"geostory.contentToolbar.contentTheme",disabled:n,shouldClose:function(e,t){var n,r;return Cn()(e)&&"ms-color-picker-cover"!==(null==t||null===(n=t.target)||void 0===n||null===(r=n.getAttribute)||void 0===r?void 0:r.call(n,"class"))||S()(e)||void 0===e},hideMenuItem:function(e,t){return"custom"===(null==e?void 0:e.value)&&"custom"!==(null==t?void 0:t.value)},options:[{value:"",isActive:function(e){return void 0===e||""===e||Cn()(e)&&(void 0===e.value||""===e.value)},label:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.defaultThemeLabel"})},{value:"bright",isActive:function(e){return"bright"===(null==e?void 0:e.value)||"bright"===e},label:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.brightThemeLabel"})},{value:"dark",isActive:function(e){return"dark"===(null==e?void 0:e.value)||"dark"===e},label:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.darkThemeLabel"})},{value:"custom",Component:function(e){return i().createElement(jn.H,An({},e,{disableBackgroundAlpha:null==s?void 0:s.disableBackgroundAlpha,disableShadow:null==s?void 0:s.disableShadow,disableTextColor:null==s?void 0:s.disableTextColor,onUpdate:u,storyTheme:o}))}}],onSelect:function(e){return u("theme",Dn(Dn({},Cn()(r)&&r),{},{value:e}))}})},Bn=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.forceDelBtnDisable,o=void 0!==r&&r,a=e.path,c=e.remove,l=void 0===c?function(){}:c,u=e.bsStyle;return i().createElement(Rn,{glyph:"trash",visible:!0,noTooltipWhenDisabled:!0,disabled:n||o,className:"".concat("square-button-md no-border"," ").concat(u&&Zn[u]),tooltipId:"geostory.contentToolbar.remove",confirmTitle:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.removeConfirmTitle"}),confirmContent:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.removeConfirmContent"}),onClick:function(){l(a)}})},_n=n(455877),zn=n.n(_n);function Fn(e){return Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fn(e)}var Un=["editMap","map","update"],Vn=["tools","children"];function Hn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hn(Object(n),!0).forEach((function(t){qn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qn(e,t,n){return(t=function(e){var t=function(e){if("object"!=Fn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Fn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Fn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $n(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Kn={size:function(e){return{renderButton:i().createElement(Nn,e)}},align:function(e){return{renderButton:i().createElement(Ln,e)}},theme:function(e){return{renderButton:i().createElement(Wn,e)}},fit:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.fit,o=e.update,i=void 0===o?function(){}:o;return{value:r,glyph:"contain"===r?"fit-cover":"fit-contain",disabled:n,visible:!0,tooltipId:"contain"===r?"geostory.contentToolbar.cover":"geostory.contentToolbar.fit",onClick:function(){return i("fit","contain"===r?"cover":"contain")}}},cover:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.cover,o=e.updateSection,i=void 0===o?function(){}:o;return{value:r,glyph:r?"height-auto":"height-view",visible:!0,disabled:n,tooltipId:r?"geostory.contentToolbar.contentHeightAuto":"geostory.contentToolbar.contentHeightView",onClick:function(){return i({cover:!r},"merge")}}},editMedia:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.path,o=e.editMedia,i=void 0===o?function(){}:o,a=e.sectionType;return{glyph:"pencil","data-button":"pencil",visible:!0,disabled:n,tooltipId:"geostory.contentToolbar.editMedia",onClick:function(){i({path:r},r?a:"")}}},remove:function(e){return{renderButton:i().createElement(Bn,e)}},editMap:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.map,o=e.update,i=void 0===o?function(){}:o,a=$n(e,Un);return{glyph:"map-edit",visible:!0,disabled:n,bsStyle:n?"success":"default",tooltipId:"geostory.contentToolbar.editMap",onClick:function(){var e=null!=r?r:a,t=e.center,o=e.zoom,c=e.resolution;i("editMap",!n),!n&&i("map",{center:t,zoom:o,mapStateSource:zn()(),resolution:c,resetPanAndZoom:!1},"merge")}}},editURL:function(e){var t=e.editURL,n=void 0!==t&&t,r=e.path,o=e.editWebPage,i=void 0===o?function(){}:o;return{glyph:"pencil",visible:!0,disabled:n,bsStyle:n?"success":"default",tooltipId:"geostory.contentToolbar.editURL",onClick:function(){i({path:r})}}},muted:function(e){var t=e.update,n=e.muted;return{glyph:n?"muted":"audio",visible:!0,active:!n,tooltipId:n?"geostory.contentToolbar.enableAudio":"geostory.contentToolbar.disableAudio",onClick:function(){t("muted",!n)}}},autoplay:function(e){var t=e.update,n=e.autoplay;return{glyph:"play-circle",visible:!("cover"===e.fit),active:n,tooltipId:n?"geostory.contentToolbar.disableAutoplay":"geostory.contentToolbar.enableAutoplay",onClick:function(){t("autoplay",!n)}}},loop:function(e){var t=e.update,n=e.loop;return{glyph:"loop",visible:!("cover"===e.fit),active:n,tooltipId:n?"geostory.contentToolbar.disableLoop":"geostory.contentToolbar.enableLoop",onClick:function(){t("loop",!n)}}},showCaption:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.update,o=e.showCaption,i=e.caption,a=e.description;return{glyph:"caption",visible:!(!i&&!a),disabled:n,active:!(!o||n),tooltipId:o?"geostory.contentToolbar.hideCaption":"geostory.contentToolbar.showCaption",onClick:function(){r("showCaption",!o)}}},add:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.addDisabled,o=void 0!==r&&r,i=e.add,a=void 0===i?function(){}:i,c=e.bsStyle;return{glyph:"plus",visible:!0,bsStyle:void 0===c?"default":c,tooltipId:"geostory.contentToolbar.add",disabled:n||o,onClick:a}},edit:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.edit,o=void 0===r?function(){}:r,i=e.bsStyle;return{glyph:"pencil",visible:!0,bsStyle:void 0===i?"default":i,tooltipId:"geostory.contentToolbar.edit",disabled:n,onClick:o}},marker:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.markerDisabled,o=void 0!==r&&r,i=e.marker,a=void 0===i?function(){}:i,c=e.bsStyle;return{glyph:"map-marker",visible:!0,tooltipId:"geostory.contentToolbar.marker",bsStyle:void 0===c?"default":c,disabled:n||o,onClick:a}},closeDraw:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.bsStyle,o=void 0===r?"default":r,i=e.update,a=void 0===i?function(){}:i,c=e.onEnableDraw,l=void 0===c?function(){}:c;return{glyph:"1-close",visible:!0,tooltipId:"geostory.contentToolbar.closeMapEditing",bsStyle:o,disabled:!n,onClick:function(){l(null),a("editMap",!n)}}}};function Jn(e){var t=e.tools,n=void 0===t?[]:t,r=e.children,o=$n(e,Vn);return i().createElement("div",{className:"ms-content-toolbar"},i().createElement(Wt.Z,{btnDefaultProps:{className:"square-button-md no-border",noTooltipWhenDisabled:!0},buttons:n.filter((function(e){return(null==e?void 0:e.id)&&Kn[e.id]||Kn[e]})).map((function(e){return(null==e?void 0:e.id)&&Kn[e.id](Gn(Gn({},o),e))||Kn[e](o)}))}),r)}function Yn(e){return Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yn(e)}var Qn=["id","inViewRef","innerRef","children","type","contentWrapperStyle","contentToolbar","mode"];function Xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function er(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xn(Object(n),!0).forEach((function(t){tr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tr(e,t,n){return(t=function(e){var t=function(e){if("object"!=Yn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Yn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Yn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const nr=function(e){var t=e.id,n=e.inViewRef,r=e.innerRef,o=e.children,a=e.type,c=e.contentWrapperStyle,l=e.contentToolbar,u=e.mode,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Qn),f=l||Jn;return i().createElement("div",{id:t,ref:n,style:er(er({},c),s.hideContent&&{display:"none"}),className:"ms-content ms-content-".concat(a).concat((0,p.w)(s))},i().createElement("div",{className:"ms-content-body",ref:r,style:(0,p.cy)(s)},u===p.nl.EDIT&&i().createElement(f,s),o))};function rr(e){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rr(e)}function or(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ir(e,t,n){return(t=function(e){var t=function(e){if("object"!=rr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=rr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==rr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ar=(0,Ze.compose)(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return Ze.nest.apply(void 0,t.concat([e]))}}(nr),(0,Ze.setDisplayName)("ColumnContent"))(Nt),cr=function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?or(Object(n),!0).forEach((function(t){ir(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):or(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:"size",filterOptions:function(e){return"full"!==e.value},pullRight:e},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})};const lr=(0,Ze.compose)((0,Ze.branch)((function(e){var t=e.type,n=e.sectionType;return[p.ID.IMMERSIVE,p.ID.CAROUSEL].includes(n)&&t===p.bT.COLUMN}),pn({threshold:[0,.25,.5,.75]})),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return Ze.nest.apply(void 0,t.concat([e]))}}(nr),(0,Ze.setDisplayName)("SectionContent"),(0,Ze.branch)((function(e){return e.type===p.bT.COLUMN}),(0,Ze.renderComponent)((function(e){var t=e.viewWidth,n=e.viewHeight,r=e.contents,o=void 0===r?[]:r,a=e.mode,c=e.add,l=void 0===c?function(){}:c,u=e.editMedia,s=void 0===u?function(){}:u,f=e.editWebPage,d=void 0===f?function(){}:f,y=e.update,m=void 0===y?function(){}:y,b=e.remove,v=void 0===b?function(){}:b,g=e.bubblingTextEditing,h=void 0===g?function(){}:g,O=e.expandable,w=e.mediaViewer,S=e.contentToolbar,P=e.sections,E=void 0===P?[]:P,j=e.sectionType,T=e.overrideTools,C=void 0===T?function(e){return e}:T,I=e.storyFonts;return i().createElement(an,{className:"ms-column-contents",ContentComponent:ar,contents:o,mode:a,add:l,editMedia:s,editWebPage:d,update:m,remove:v,viewWidth:t,viewHeight:n,bubblingTextEditing:h,sectionType:j,contentProps:{expandable:O,mediaViewer:w,contentToolbar:S},sections:E,storyFonts:I,tools:C(ir(ir(ir(ir(ir({},p.bT.TEXT,["remove"]),p.Tr.IMAGE,["editMedia",cr(),"showCaption","remove"]),p.Tr.MAP,["editMedia","editMap",cr(!0),"showCaption","remove"]),p.bT.WEBPAGE,[cr(!0,{sizeType:"horizontal"}),"editURL",cr(!0,{sizeType:"vertical",filterOptions:function(e){return"v-full"!==e.value}}),"remove"]),p.Tr.VIDEO,["editMedia","muted","autoplay","loop","showCaption","remove"])),addButtons:[{glyph:"sheet",tooltipId:"geostory.addTextContent",template:p.bT.TEXT},{glyph:"picture",tooltipId:"geostory.addMediaContent",template:p.bT.MEDIA},{glyph:"webpage",tooltipId:"geostory.addWebPageContent",template:p.bT.WEBPAGE}]})}))))(Nt),ur=(0,Ze.compose)((0,Ze.defaultProps)({ContentComponent:lr}),(0,Ze.withHandlers)({editMedia:function(e){var t=e.editMedia,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=e.path,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return n.apply(void 0,[{path:'sections[{"id": "'.concat(r,'"}].')+t}].concat(i))}},editWebPage:function(e){var t=e.editWebPage,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=e.path,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return n.apply(void 0,[{path:'sections[{"id": "'.concat(r,'"}].')+t}].concat(i))}},add:function(e){var t=e.add,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}},update:function(e){var t=e.update,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}},remove:function(e){var t=e.remove,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}}}),(0,Ze.setDisplayName)("SectionContents"))(an);var sr=n(630998),pr=n.n(sr),fr=n(84753),dr=n.n(fr);function yr(e){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yr(e)}function mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function br(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?br(Object(n),!0).forEach((function(t){gr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):br(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gr(e,t,n){return(t=function(e){var t=function(e){if("object"!=yr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=yr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==yr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,Ze.setObservableConfig)(Ne.Z);var hr=function(e,t){var n=pr()(e,{id:t});return e[-1!==n&&n?n:0]},Or=(0,Ze.withProps)((function(e){var t=e.id,n=e.backgroundId,r=e.contents,o=hr(void 0===r?[]:r,n)||{},i=o&&o.id;return{background:D()(o,"background")||{type:"none"},contentId:i,sectionId:t,path:'sections[{"id": "'.concat(t,'"}].contents[{"id": "').concat(i,'"}].background')}})),wr=(0,Ze.withHandlers)({updateBackground:function(e){var t=e.sectionId,n=e.contentId,r=e.update,o=void 0===r?function(){}:r;return function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return o.apply(void 0,['sections[{"id": "'.concat(t,'"}].contents[{"id": "').concat(n,'"}].background.')+e].concat(i))}},updateSection:function(e){var t=e.sectionId,n=e.update,r=void 0===n?function(){}:n;return function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return r.apply(void 0,['sections[{"id": "'.concat(t,'"}]')].concat(n))}}}),Sr=(0,Ze.compose)(Or,wr),Pr=(0,Ze.mapPropsStream)((function(e){var t=(0,Ze.createEventHandler)(),n=t.handler,r=t.stream;return b.Observable.combineLatest(e,function(e,t){var n=e.scan((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.visible,o=t.entry;return vr(vr({},e),{},gr({},n,{visible:r,entry:o}))}),{}).debounceTime(100).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{maxItem:dr()(Object.keys(e),(function(t){return e[t].visible?D()(e[t],"entry.intersectionRatio"):-1/0})),items:e}}));return b.Observable.merge(n.pluck("maxItem").distinctUntilChanged().map((function(e){return{backgroundId:e}})),n.map((function(e){var t=e.maxItem,n=e.items;return 0===D()(n[t],"entry.intersectionRatio")?"EMPTY":t})).withLatestFrom(t.pluck("updateCurrentPage")).do((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return mr(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mr(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];return i&&i({columnId:o})})).ignoreElements())}(r,e).startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return vr(vr({},t.reduce((function(){var e=arguments.length>1?arguments[1]:void 0;return vr(vr({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),e)}),{})),{},{onVisibilityChange:n})}))}));const Er=(0,Ze.compose)(Pr,Sr);var jr=n(689438);function Tr(e){return Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tr(e)}function Cr(){return Cr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Cr.apply(null,arguments)}function Ir(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ir(Object(n),!0).forEach((function(t){Zr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ir(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Dr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Nr(r.key),r)}}function Mr(e,t,n){return t=xr(t),function(e,t){if(t&&("object"==Tr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ar()?Reflect.construct(t,n||[],xr(e).constructor):t.apply(e,n))}function Ar(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ar=function(){return!!e})()}function xr(e){return xr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xr(e)}function Rr(e,t){return Rr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Rr(e,t)}function Zr(e,t,n){return(t=Nr(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nr(e){var t=function(e){if("object"!=Tr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Tr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Tr(t)?t:t+""}var Lr=n(356936),Wr=n(683255),Br=n.n(Wr);function _r(e){return _r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_r(e)}function zr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zr(Object(n),!0).forEach((function(t){Kr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ur(){return Ur=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ur.apply(null,arguments)}function Vr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Jr(r.key),r)}}function Hr(e,t,n){return t=qr(t),function(e,t){if(t&&("object"==_r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Gr()?Reflect.construct(t,n||[],qr(e).constructor):t.apply(e,n))}function Gr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Gr=function(){return!!e})()}function qr(e){return qr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qr(e)}function $r(e,t){return $r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$r(e,t)}function Kr(e,t,n){return(t=Jr(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jr(e){var t=function(e){if("object"!=_r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=_r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_r(t)?t:t+""}var Yr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Hr(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$r(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=(0,p.cy)(this.props),t=!this.props.disableToolbarPortal&&this.refs&&this.refs.div&&this.refs.div.parentNode,n=this.props.sectionType===p.ID.TITLE?["editMedia","cover"]:["editMedia"],r=this.props.contentToolbar||Jn,o=i().createElement(r,Ur({},this.props,{themeProps:{disableBackgroundAlpha:!0,disableTextColor:!0,disableShadow:!0},tools:this.props.tools&&this.props.type&&this.props.tools[this.props.type]||this.props.sectionType===p.ID.BANNER&&[].concat(n,["cover","remove"])||n}),this.props.contentToolbarChildren),a="".concat(this.props.sectionId||"ms","-media-").concat(this.props.id||this.props.resourceId);return i().createElement("div",{ref:"div",className:"ms-section-background",style:Fr({},this.props.style)},i().createElement("div",{className:"ms-section-background-container".concat((0,p.w)(this.props)),ref:this.props.innerRef,style:Fr(Fr({height:this.props.height},e),null!==et.Ln&&void 0!==et.Ln&&et.Ln[this.props.type]?{}:this.props.backgroundPlaceholder)},i().createElement(et.ZP,Ur({id:a},this.props,{enableFullscreen:!1,descriptionEnabled:!1,mediaViewer:this.props.mediaViewer,containerInView:this.props.inView}),this.props.children),this.props.mode===p.nl.EDIT&&(t?i().createElement(Lr.h_,{container:t},o):o)))}}])&&Vr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o.Component);Kr(Yr,"propTypes",{id:Qe().string,resourceId:Qe().string,sectionId:Qe().string,mode:Qe().string,fit:Qe().string,size:Qe().string,path:Qe().string,credits:Qe().string,description:Qe().string,height:Qe().number,width:Qe().number,tools:Qe().object,style:Qe().object,add:Qe().func,editMedia:Qe().func,update:Qe().func,updateSection:Qe().func,remove:Qe().func,type:Qe().oneOf(p.lg.MediaTypes),disableToolbarPortal:Qe().bool,backgroundPlaceholder:Qe().object,sectionType:Qe().string,src:Qe().string,theme:Qe().string,mediaViewer:Qe().func,contentToolbar:Qe().func,inView:Qe().bool,sections:Qe().array,innerRef:Qe().oneOfType([Qe().func,Qe().object]),contentToolbarChildren:Qe().node}),Kr(Yr,"defaultProps",{height:0,size:"full",width:0,style:{},backgroundPlaceholder:{background:"url(".concat(Br(),")"),backgroundSize:"256px auto"}});const Qr=(Xr=Yr,eo=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Zr(e=Mr(this,t,[].concat(r)),"state",{style:{}}),Zr(e,"update",(function(t){if(e._stickybits){var n=document.querySelector(t);-1===e._stickybits.definePosition().indexOf("sticky")&&n&&(e._stickybits.update(),setTimeout((function(){var t=n.getBoundingClientRect(),r=t.top,o=t.left;e.setState({style:{top:r,left:o,width:n.scrollWidth-2}})})))}})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rr(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){this._stickybits=this._node&&(0,jr.Z)(this._node,{scrollEl:this.props.scrollContainerSelector,noStyles:!0,useGetBoundingClientRect:!0}),this.update(this.props.scrollContainerSelector)}},{key:"componentWillReceiveProps",value:function(e){!this._stickybits||e.viewWidth===this.props.viewWidth&&e.viewHeight===this.props.viewHeight||this.update(e.scrollContainerSelector)}},{key:"componentWillUnmount",value:function(){this._stickybits&&this._stickybits.cleanup()}},{key:"render",value:function(){var e=this;return i().createElement(Xr,Cr({ref:function(t){t&&t.refs&&t.refs[e.props.refId]&&(e._node=t.refs[e.props.refId])},style:kr({},this.state.style)},this.props),this.props.children)}}])&&Dr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o.Component),Zr(eo,"propTypes",{scrollContainerSelector:Qe().string,height:Qe().number,width:Qe().number,refId:Qe().string}),Zr(eo,"defaultProps",{scrollContainerSelector:"body",height:0,width:0,refId:"div"}),eo);var Xr,eo,to=n(911636),no=n.n(to);function ro(e){return ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ro(e)}function oo(){return oo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oo.apply(null,arguments)}function io(e,t,n){return(t=function(e){var t=function(e){if("object"!=ro(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ro(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ro(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ao=(0,Ze.compose)(Er,(0,Ze.withStateHandlers)({textEditorActive:!1},{bubblingTextEditing:function(){return function(e){return{textEditorActiveClass:e?" ms-text-editor-active":""}}}}))((function(e){var t=e.add,n=void 0===t?function(){}:t,r=e.editMedia,o=void 0===r?function(){}:r,a=e.editWebPage,c=void 0===a?function(){}:a,l=e.onVisibilityChange,u=void 0===l?function(){}:l,s=e.update,f=void 0===s?function(){}:s,d=e.updateBackground,y=void 0===d?function(){}:d,m=e.updateCurrentPage,b=void 0===m?function(){}:m,v=e.remove,g=void 0===v?function(){}:v,h=e.id,O=e.background,w=void 0===O?{}:O,S=e.path,P=e.contents,E=void 0===P?[]:P,j=e.mode,T=e.sectionType,C=e.inViewRef,I=e.viewWidth,k=e.viewHeight,M=e.focusedContent,A=e.contentId,x=e.bubblingTextEditing,R=void 0===x?function(){}:x,Z=e.textEditorActiveClass,N=void 0===Z?"":Z,L=e.expandableMedia,W=void 0!==L&&L,B=e.storyTheme,_=e.mediaViewer,z=e.contentToolbar,F=e.inView,U=e.sections,V=void 0===U?[]:U,H=e.storyFonts,G=M&&M.hideContent&&D()(M,"target.id")===A,q=G?"hidden":"visible",$=W&&w&&"map"===w.type?" ms-expandable-background":"",K=(null==B?void 0:B.overlay)||{},J=(null==B?void 0:B.general)||{};return i().createElement("section",{className:"ms-section ms-section-immersive".concat($),id:h,ref:C},i().createElement(Qr,oo({},w,{mode:j,disableToolbarPortal:!0,tools:io(io(io({},p.Tr.IMAGE,["editMedia","fit","size","align","theme"]),p.Tr.MAP,["editMedia","editMap","size","align","theme"]),p.Tr.VIDEO,["editMedia","fit","size","align","theme","muted","autoplay","loop"]),scrollContainerSelector:"#ms-sections-container",add:n,editMedia:o,expandable:W,path:S,update:y,updateCurrentPage:b,remove:g,sectionType:T,sectionId:h,backgroundId:w.id,key:w.id,width:I,height:k,backgroundPlaceholder:{background:"url(".concat(no(),")"),backgroundSize:"600px auto"},storyTheme:J,mediaViewer:_,contentToolbar:z,inView:F})),i().createElement(ur,{tools:io({},p.bT.COLUMN,["size","align","theme"]),className:"ms-section-contents".concat(N),contents:E,mode:j,add:n,updateCurrentPage:b,editMedia:o,editWebPage:c,update:f,remove:g,sectionId:h,viewWidth:I,viewHeight:k,contentProps:{onVisibilityChange:u,contentWrapperStyle:{minHeight:k,visibility:q},expandable:W,mediaViewer:_,contentToolbar:z},focusedContent:M,bubblingTextEditing:R,sectionType:T,storyTheme:K,sections:V,storyFonts:H}),j===p.nl.EDIT&&!G&&i().createElement(Yt,{containerWidth:I,containerHeight:k,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){n("sections",h,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){n("sections",h,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){n("sections",h,p.ID.PARAGRAPH)}},{glyph:"story-immersive-content",tooltipId:"geostory.addImmersiveContent",onClick:function(){n('sections[{"id": "'.concat(h,'"}].contents'),void 0,p.bT.COLUMN,"geostory.builder.defaults.titleImmersiveContent")}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){n("sections",h,p.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){n("sections",h,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){n("sections",h,p.tQ.WEBPAGE)}}]}))}));function co(e){return co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},co(e)}function lo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function uo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lo(Object(n),!0).forEach((function(t){so(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function so(e,t,n){return(t=function(e){var t=function(e){if("object"!=co(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=co(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==co(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const po=function(e){var t=e.id,n=e.contents,r=e.mode,o=e.add,a=void 0===o?function(){}:o,c=e.update,l=void 0===c?function(){}:c,u=e.editMedia,s=void 0===u?function(){}:u,f=e.editWebPage,d=void 0===f?function(){}:f,y=e.remove,m=void 0===y?function(){}:y,b=e.inViewRef,v=e.viewWidth,g=e.viewHeight,h=e.expandableMedia,O=e.mediaViewer,w=e.contentToolbar,S=e.sections,P=void 0===S?[]:S,E=e.sectionType,j=e.storyFonts;return i().createElement("section",{className:"ms-section ms-section-paragraph",id:t,ref:b},i().createElement(ur,{className:"ms-section-contents",contents:n,mode:r,add:a,editMedia:s,editWebPage:d,update:l,remove:m,sectionId:t,viewWidth:v,viewHeight:g,sectionType:E,contentProps:{expandable:h,mediaViewer:O,contentToolbar:w,overrideTools:function(e){return uo(uo({},e),{},so({},p.bT.TEXT,[{id:"size",filterOptions:function(e){return"full"!==e.value},pullRight:true},"remove"]))}},sections:P,storyFonts:j}),r===p.nl.EDIT&&i().createElement(Yt,{containerWidth:v,containerHeight:g,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){a("sections",t,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){a("sections",t,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){a("sections",t,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){a("sections",t,p.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){a("sections",t,p.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){a("sections",t,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){a("sections",t,p.tQ.WEBPAGE)}}]}))};var fo=n(875492),yo=n.n(fo);function mo(e){return mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mo(e)}function bo(){return bo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bo.apply(null,arguments)}function vo(e,t,n){return(t=function(e){var t=function(e){if("object"!=mo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=mo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==mo(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const go=(0,Ze.compose)(Sr,(0,Ze.withStateHandlers)({textEditorActive:!1},{bubblingTextEditing:function(){return function(e){return{textEditorActiveClass:e?" ms-text-editor-active":""}}}}))((function(e){var t=e.id,n=e.background,r=void 0===n?{}:n,o=e.contents,a=void 0===o?[]:o,c=e.mode,l=e.contentId,u=e.path,s=e.sectionType,f=e.cover,d=e.viewWidth,y=e.viewHeight,m=e.inViewRef,b=e.add,v=void 0===b?function(){}:b,g=e.update,h=void 0===g?function(){}:g,O=e.updateSection,w=void 0===O?function(){}:O,S=e.remove,P=void 0===S?function(){}:S,E=e.updateBackground,j=void 0===E?function(){}:E,T=e.editMedia,C=void 0===T?function(){}:T,I=e.focusedContent,k=e.bubblingTextEditing,M=void 0===k?function(){}:k,A=e.textEditorActiveClass,x=void 0===A?"":A,R=e.expandableMedia,Z=void 0!==R&&R,N=e.storyTheme,L=e.mediaViewer,W=e.contentToolbar,B=e.inView,_=e.sections,z=void 0===_?[]:_,F=e.storyFonts,U=D()(I,"target.id")===l,V=U?"hidden":"visible",H=Z&&r&&"map"===r.type?" ms-expandable-background":"",G=(null==N?void 0:N.overlay)||{},q=(null==N?void 0:N.general)||{};return i().createElement("section",{ref:m,className:"ms-section ms-section-title".concat(H),id:t},i().createElement(Re.Z,null,(function(e){var t=e.height;return i().createElement(Qr,bo({},r,{scrollContainerSelector:"#ms-sections-container",key:r.id,mode:c,id:l,path:u,update:j,add:v,editMedia:C,expandable:Z,updateSection:w,cover:f,remove:P,width:d,sectionType:s,backgroundPlaceholder:{background:"url(".concat(f?Br():yo(),")"),backgroundSize:"".concat(f?64:600,"px auto")},tools:vo(vo(vo({},p.Tr.IMAGE,["editMedia","cover","fit","size","align","theme"]),p.Tr.MAP,["editMedia","cover","editMap","size","align","theme"]),p.Tr.VIDEO,["editMedia","cover","fit","size","align","theme","muted","autoplay","loop"]),height:t>=y?y:t,storyTheme:q,mediaViewer:L,contentToolbar:W,inView:B}))})),i().createElement(ur,{className:"ms-section-contents".concat(x),contents:a,mode:c,add:v,sectionType:s,update:h,remove:P,sectionId:t,contentProps:{contentWrapperStyle:f?{minHeight:y,visibility:V}:{visibility:V},mediaViewer:L,contentToolbar:W},tools:vo({},p.bT.TEXT,["size","align","theme","remove"]),focusedContent:I,bubblingTextEditing:M,storyTheme:G,sections:z,storyFonts:F}),c===p.nl.EDIT&&!U&&i().createElement(Yt,{containerWidth:d,containerHeight:y,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){v("sections",t,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){v("sections",t,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){v("sections",t,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){v("sections",t,p.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){v("sections",t,p.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){v("sections",t,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){v("sections",t,p.tQ.WEBPAGE)}}]}))}));function ho(e){return ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ho(e)}function Oo(){return Oo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Oo.apply(null,arguments)}function wo(e,t,n){return(t=function(e){var t=function(e){if("object"!=ho(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ho(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ho(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const So=(0,Ze.compose)(Sr,(0,Ze.withStateHandlers)({textEditorActive:!1}))((function(e){var t=e.id,n=e.background,r=void 0===n?{}:n,o=e.mode,a=e.contentId,c=e.path,l=e.sectionType,u=void 0===l?p.ID.BANNER:l,s=e.cover,f=e.viewWidth,d=e.viewHeight,y=e.inViewRef,m=e.add,b=void 0===m?function(){}:m,v=e.updateSection,g=void 0===v?function(){}:v,h=e.remove,O=void 0===h?function(){}:h,w=e.updateBackground,S=void 0===w?function(){}:w,P=e.editMedia,E=void 0===P?function(){}:P,j=e.focusedContent,T=e.expandableMedia,C=void 0!==T&&T,I=e.storyTheme,k=e.mediaViewer,M=e.contentToolbar,A=e.inView,x=D()(j,"target.id")===a,R=C&&r&&"map"===r.type?" ms-expandable-background":"",Z=c.replace(".background","");return i().createElement("section",{ref:y,className:"ms-section ms-section-banner".concat(R),id:t},i().createElement(Re.Z,null,(function(e){var t=e.height;return i().createElement(Qr,Oo({},r,{scrollContainerSelector:"#ms-sections-container",key:r.id,mode:o,id:a,path:c,update:S,add:b,editMedia:E,expandable:C,updateSection:g,cover:s,remove:function(){return O(Z)},width:f,sectionType:u,backgroundPlaceholder:{background:"url(".concat(s?Br():yo(),")"),backgroundSize:"".concat(s?64:600,"px auto")},tools:wo(wo(wo({},p.Tr.IMAGE,["editMedia","cover","fit","size","align","theme","remove"]),p.Tr.MAP,["editMedia","cover","editMap","size","align","theme","remove"]),p.Tr.VIDEO,["editMedia","cover","fit","size","align","theme","muted","autoplay","loop","remove"]),height:t>=d?d:t,storyTheme:I,mediaViewer:k,contentToolbar:M,inView:A}))})),i().createElement("div",{style:{minHeight:s?d:300,pointerEvents:"none"}}),o===p.nl.EDIT&&!x&&i().createElement(Yt,{containerWidth:f,containerHeight:d,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){b("sections",t,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){b("sections",t,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){b("sections",t,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){b("sections",t,p.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){b("sections",t,p.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){b("sections",t,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){b("sections",t,p.tQ.WEBPAGE)}}]}))}));var Po=n(294184),Eo=n.n(Po),jo=n(771335),To=n(694745),Co=n(993451);function Io(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ko(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ko(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ko(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Do=(0,Co.Z)("placeholder")(nt.NI);const Mo=function(e){var t,n,r,a=Io((0,o.useState)([]),2),c=a[0],l=a[1],u=Io((0,o.useState)({data:null==e||null===(t=e.thumbnail)||void 0===t?void 0:t.image}),2),s=u[0],p=u[1],f=Io((0,o.useState)(null==e?void 0:e.title),2),d=f[0],y=f[1];return i().createElement(To.Z,{fitContent:!0,title:i().createElement(ot.Z,{msgId:e.editing?"geostory.carouselEditTitle":"geostory.carouselAddTitle"}),show:!0,fade:!0,clickOutEnabled:!1,bodyClassName:"ms-flex modal-properties-container background-dialog",onClose:e.onClose,buttons:e.loading?[]:[{text:i().createElement(ot.Z,{msgId:e.editing?"save":"backgroundDialog.add"}),bsStyle:"primary",onClick:function(){e.update("thumbnail",{image:s.data}),e.update("title",d),e.onClose()}}]},i().createElement(nt.l0,{style:{width:"100%"}},(r={FORMAT:i().createElement(ot.Z,{msgId:"map.errorFormat"}),SIZE:i().createElement(ot.Z,{msgId:"map.errorSize"})},c.length>0?i().createElement("div",{className:"dropzone-errorBox alert-danger"},i().createElement("p",null,i().createElement(ot.Z,{msgId:"map.error"})),c.map((function(e){return i().createElement("div",{id:"error"+e,key:"error"+e,className:"error"+e},r[e])}))):null),i().createElement(jo.Z,{onUpdate:function(e,t){return p({data:e,url:t})},onError:function(e){return l(e)},message:i().createElement(ot.Z,{msgId:"backgroundDialog.imageUploadMessage"}),suggestion:"",map:{newThumbnail:D()(s,"url")||(null===(n=e.thumbnail)||void 0===n?void 0:n.image)||"NODATA"},thumbnailOptions:{contain:!1,width:128,height:128,quality:1,type:"image/jpeg"}}),i().createElement(nt.cw,null,i().createElement(nt.J$,null,i().createElement(ot.Z,{msgId:"layerProperties.title"})),i().createElement(Do,{value:d,placeholder:"backgroundDialog.titlePlaceholder",onChange:function(e){return y(e.target.value)}}))))};var Ao=n(625311),xo=n(245567),Ro=n(773723),Zo=n.n(Ro),No=n(615402);const Lo=function(e){return t=e.type,n="",r="","addMap"===t?(n="ms-carousel-map-info",r="geostory.carouselAddMapInfo"):"addMarker"===t?(n="ms-carousel-marker-info",r="geostory.carouselPlaceMarkerInfo"):(n="ms-carousel-add-info",r="geostory.carouselAddItemInfo"),i().createElement("div",{className:n},i().createElement(No.Z,{msgId:r}));var t,n,r};var Wo=n(81593);function Bo(e){return Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bo(e)}var _o=["title","thumbnail","index","isSelected"],zo=["onSort","sectionId","contents","onEnableDraw","isEditMap","isDrawEnabled"];function Fo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Uo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fo(Object(n),!0).forEach((function(t){Vo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vo(e,t,n){return(t=function(e){var t=function(e){if("object"!=Bo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Bo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Bo(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ho(){return Ho=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ho.apply(null,arguments)}function Go(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return qo(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function $o(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Ko=(0,Ao.Z)((function(e){var t=e.title,n=e.thumbnail,r=e.index,o=e.isSelected,a=$o(e,_o),c=i().createElement("div",{className:Eo()("ms-geo-carousel-item",{"ms-geo-carousel-item-selected":o}),onClick:a.onClick},i().createElement("div",{className:"ms-geo-carousel-item-inner-wrapper",style:{backgroundImage:"url(".concat((null==n?void 0:n.image)||Zo(),")")}},i().createElement("span",{className:"ms-geo-carousel-item-inner"},t||"Item ".concat(r+1)),i().createElement("span",{className:"ms-geo-carousel-item-inner-index"},r+1)));return a.isDraggable&&a.connectDragSource?a.connectDragSource(c):c})),Jo=(0,xo.Z)((function(e){var t=e.mode,n=e.add,r=e.update,a=void 0===r?function(){}:r,c=e.remove,l=e.sectionId,u=e.isMapBackground,s=e.contentId,f=e.items,d=e.contentToolbar,y=void 0===d?Jn:d,m=e.cardComponent,b=e.containerWidth,v=e.isDrawEnabled,g=e.onEnableDraw,h=e.isEditMap,O=e.innerRef,w=e.deltaSwipeSize,S=void 0===w?200:w,P=e.transition,E=void 0===P?300:P,j=e.style,T=e.controlStyle,C=Go((0,o.useState)(!1),2),I=C[0],k=C[1],D=Go((0,o.useState)(void 0),2),M=D[0],A=D[1],x=Go((0,o.useState)(""),2),Z=x[0],N=x[1],L=Go((0,o.useState)({}),2),W=L[0],B=L[1],_=(0,Wo.Z)({direction:"horizontal",width:b,deltaScroll:S,transition:E},[f.length]),z=_.isStartControlActive,F=_.isEndControlActive,U=_.containerPropsHandlers,V=_.contentPropsHandlers,H=_.itemPropsHandlers,G=_.moveToDeltaSize,q=_.moveItemInViewById,$=t===p.nl.EDIT;(0,o.useEffect)((function(){s&&q(s,{margin:32})}),[s]);var K=!(u&&!mn()(f,(function(e){var t;return 0===((null==e||null===(t=e.features)||void 0===t?void 0:t.length)||0)})));return i().createElement(i().Fragment,null,i().createElement("div",{ref:O,style:j,className:"ms-geo-carousel"},$&&1===f.length&&K&&!h&&i().createElement(Lo,{type:"addInfo"}),h&&$&&v&&!!mn()(f,(function(e){var t;return e.id===s&&0===((null==e||null===(t=e.features)||void 0===t?void 0:t.length)||0)}))&&i().createElement(Lo,{type:"addMarker"}),$&&i().createElement(y,{addDisabled:K,add:n,editMap:h,remove:function(){return c('sections[{"id":"'.concat(l,'"}]'))},tools:["add","remove"]}),i().createElement("div",Ho({},U(),{className:"ms-horizontal-menu"}),i().createElement("div",V(),f.map((function(e,t){var r=H({id:e.id,onClick:h?void 0:function(){a('sections[{"id":"'.concat(l,'"}].contents[{"id":"').concat(e.id,'"}].carouselToggle'),!0)}});return i().createElement("div",Ho({key:t},r,{className:"ms-geo-carousel-item-wrapper",style:h?{pointerEvents:"none"}:{}}),$&&i().createElement(y,{editMap:h,markerDisabled:!u||(null==e?void 0:e.id)!==s,edit:function(t){t.stopPropagation(),function(e){A(null==e?void 0:e.id),k(!0),B(null==e?void 0:e.thumbnail),N(null==e?void 0:e.title)}(e)},remove:function(){var n,r,o,i;return o=null==e?void 0:e.id,i=0===t&&f.length>0?null===(n=f[t+1])||void 0===n?void 0:n.id:null===(r=f[t-1])||void 0===r?void 0:r.id,c('sections[{"id":"'.concat(l,'"}].contents[{"id":"').concat(o,'"}]')),void(s===o&&a('sections[{"id":"'.concat(l,'"}].contents[{"id":"').concat(i,'"}].hideContent'),!1))},forceDelBtnDisable:(null==e?void 0:e.id)===s,add:n,marker:function(t){t.stopPropagation(),g(e)},tools:["edit","remove","marker"]}),i().createElement(m,Ho({key:t,index:t,items:f,update:a,sectionId:l,selectedId:s,isSelected:(null==e?void 0:e.id)===s},e)))}))),z&&i().createElement(rt.Z,{className:"square-button-md no-border ms-geo-carousel-control",style:Uo(Uo({},T),{},{position:"absolute"}),onClick:function(){return G(S)}},i().createElement(nt.gG,{glyph:"chevron-left"})),F&&i().createElement(rt.Z,{className:"square-button-md no-border ms-geo-carousel-control",style:Uo(Uo({},T),{},{position:"absolute",right:0}),onClick:function(){return G(-S)}},i().createElement(nt.gG,{glyph:"chevron-right"})))),I&&i().createElement(Mo,{title:Z,thumbnail:W,update:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"replace",o=R()(e)?"":".".concat(e);a('sections[{"id":"'.concat(l,'"}].contents[{"id":"').concat(n,'"}]')+o,t,r)},onClose:function(){return k(!1)}}))}));const Yo=function(e){var t=e.onSort,n=e.sectionId,r=e.contents,o=void 0===r?[]:r,a=e.onEnableDraw,c=void 0===a?function(){}:a,l=e.isEditMap,u=e.isDrawEnabled,s=$o(e,zo);return i().createElement(Jo,Ho({containerId:n,isDraggable:s.mode===p.nl.EDIT,onSort:function(e,r,o,i){if(o.containerId===i.containerId){var a='sections[{ "id": "'.concat(n,'" }].contents[{"id":"').concat(i.id,'"}]'),c='sections[{ "id": "'.concat(n,'" }].contents'),l=e,u=zn()();t(a,c,l,u,'sections[{ "id": "'.concat(n,'" }].contents[{"id":"').concat(u,'"}]'))}}},Uo(Uo({},s),{},{sectionId:n}),{cardComponent:Ko,items:o.map((function(e){var t=e.id,n=e.thumbnail;return{id:t,thumbnail:void 0===n?{}:n,features:e.features,title:e.title}})),isDrawEnabled:u,onEnableDraw:c,isEditMap:l}))};var Qo=n(743837),Xo=n(240986);const ei=function(e){var t=e.currentIndex,n=e.contents,r=void 0===n?[]:n,o=e.onTraverseCard,a=void 0===o?function(){}:o;return i().createElement(i().Fragment,null,i().createElement(rt.Z,{className:"ms-carousel-slider left-arrow",disabled:0===t,onClick:function(){return a()}},i().createElement(nt.gG,{style:{fontSize:22},glyph:"chevron-left"})),i().createElement(rt.Z,{className:"ms-carousel-slider right-arrow",onClick:function(){return a("right")},disabled:t===r.length-1},i().createElement(nt.gG,{style:{fontSize:22},glyph:"chevron-right"})))};function ti(e){return ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ti(e)}function ni(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ri(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ri(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ri(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function oi(){return oi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oi.apply(null,arguments)}function ii(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ai(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ii(Object(n),!0).forEach((function(t){ci(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ii(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ci(e,t,n){return(t=function(e){var t=function(e){if("object"!=ti(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ti(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ti(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const li=(0,Ze.compose)(Pr,(function(e){return function(t){var n=hr(t.contents||[],t.backgroundId)||{},r=n&&n.id,o=vr(vr({},t),{},{contentId:r,sectionId:t.id,path:'sections[{"id": "'.concat(t.id,'"}].background')});return i().createElement(e,o)}}),(function(e){return function(t){var n=vr(vr({},t),{},{updateBackground:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.update.apply(t,['sections[{"id": "'.concat(t.sectionId,'"}].background.')+e].concat(r))},updateSection:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.update.apply(t,['sections[{"id": "'.concat(t.sectionId,'"}]')].concat(n))}});return i().createElement(e,n)}}),(function(e){return function(t){var n=ni((0,o.useState)(""),2),r=n[0],a=n[1];return i().createElement(e,oi({},t,{textEditorActiveClass:r,bubblingTextEditing:function(e){return a(e?" ms-text-editor-active":"")}}))}}))((function(e){var t,n,r=e.add,a=void 0===r?function(){}:r,c=e.editMedia,l=void 0===c?function(){}:c,u=e.editWebPage,s=void 0===u?function(){}:u,f=e.onVisibilityChange,d=void 0===f?function(){}:f,y=e.update,m=void 0===y?function(){}:y,b=e.updateBackground,v=void 0===b?function(){}:b,g=e.updateCurrentPage,h=void 0===g?function(){}:g,O=e.remove,w=void 0===O?function(){}:O,S=e.id,P=e.background,E=void 0===P?{}:P,j=e.path,T=e.contents,C=void 0===T?[]:T,I=e.mode,k=e.sectionType,M=e.inViewRef,A=e.viewWidth,x=e.viewHeight,R=e.focusedContent,Z=e.contentId,N=e.bubblingTextEditing,L=void 0===N?function(){}:N,W=e.textEditorActiveClass,B=void 0===W?"":W,_=e.expandableMedia,z=void 0!==_&&_,F=e.storyTheme,U=e.mediaViewer,V=e.contentToolbar,H=e.inView,G=e.sections,q=void 0===G?[]:G,$=e.storyFonts,K=e.onSort,J=void 0===K?function(){}:K,Y=e.onEnableDraw,Q=void 0===Y?function(){}:Y,X=e.isDrawEnabled,ee=e.defaultMarkerStyle,te=void 0===ee?{iconColor:"cyan",iconShape:"circle"}:ee,ne=e.highlightedMarkerStyle,re=void 0===ne?{iconColor:"green",iconShape:"circle"}:ne,oe=(0,o.useRef)(),ie=(0,o.useRef)(),ae=(0,o.useRef)();function ce(e,t){return t-(e.left+e.right)<128?{top:0,left:0,bottom:0,right:0}:e}var le=R&&R.hideContent&&D()(R,"target.id")===S,ue=le?"hidden":"visible",se=z&&E&&"map"===E.type?" ms-expandable-background":"",pe=ai(ai({},null==F?void 0:F.overlay),I===p.nl.VIEW&&{maxHeight:x-350,overflowY:"auto"})||{},fe=(null==F?void 0:F.general)||{},de=x-(I===p.nl.EDIT?220:200),ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(mn()(C,{id:Z})||{}).contents,n=void 0===t?[]:t;return e.filter((function(e){return p.ID.CAROUSEL===k&&1===n.length?"remove"!==e:e}))},me=(null==E?void 0:E.type)===p.Tr.MAP,be=(C.find((function(e){return e.id===Z}))||{}).features,ve=void 0===be?[]:be,ge=pr()(C,(function(e){var t=e.id;return Z===t})),he=(0,p.Yh)({id:S,contents:C.filter((function(e){return e.id!==Z})),featureStyle:function(e){var t=e.content,n=e.feature;return(0,p.c0)(te,C,t,Z,n)}}),Oe=(0,p.Yh)({id:"".concat(S,"-highlighted"),contents:C.filter((function(e){return e.id===Z})),featureStyle:function(e){var t=e.content,n=e.feature;return(0,p.c0)(re,C,t,Z,n)}});return i().createElement("section",{className:"ms-section ms-section-carousel".concat(se),id:S,ref:M},i().createElement(Qr,oi({},E,{mode:I,innerRef:oe,disableToolbarPortal:!0,tools:ci(ci(ci({},p.Tr.IMAGE,["editMedia","fit","size","align","theme"]),p.Tr.MAP,["editMedia","editMap","size","align","theme"].concat(X?"closeDraw":[])),p.Tr.VIDEO,["editMedia","fit","size","align","theme","muted","autoplay","loop"]),scrollContainerSelector:"#ms-sections-container",add:a,editMedia:l,expandable:z,path:j,update:v,updateCurrentPage:h,remove:w,sectionType:k,sectionId:S,backgroundId:E.id,key:E.id,width:A,height:x,backgroundPlaceholder:{background:"url(".concat(no(),")"),backgroundSize:"600px auto"},storyTheme:fe,mediaViewer:U,contentToolbar:V,inView:H,layers:[he,Oe],isDrawEnabled:X,onEnableDraw:Q,contentToolbarChildren:!me&&I===p.nl.EDIT&&i().createElement(Lo,{type:"addMap"})}),i().createElement(Qo.Z,{active:X,features:ve,method:"Point",onChange:function(e,t){m('sections[{"id":"'.concat(S,'"}].contents[{"id":"').concat(Z,'"}].features'),t)}}),i().createElement(Xo.Z,{active:!(X||null!=E&&E.editMap),geometry:null==ve||null===(t=ve[0])||void 0===t||null===(n=t.geometry)||void 0===n?void 0:n.coordinates,padding:function(){var e={top:0,left:0,bottom:0,right:0},t=oe.current&&oe.current.querySelector(".ms-media-map"),n=ie.current&&ie.current.querySelector("[id='".concat(Z,"']"));if(t&&n){var r=oe.current.getBoundingClientRect()||{},o=t.getBoundingClientRect()||{},i=n.getBoundingClientRect()||{};if(ae.current){var a=ae.current.getBoundingClientRect()||{};e.bottom=r.height-(a.top-r.top)}var c=o.left-r.left,l=c+o.width,u=i.left-r.left,s=u+i.width;if(u>=c&&s<=l){var p=u-c,f=l-s;return f>=p?e.left=p+i.width:e.right=f+i.width,ce(e,o.width)}if(s>=c&&s<=l)return e.left=s-c,ce(e,o.width);if(u>=c&&u<=l)return e.right=l-u,ce(e,o.width)}return e}(),fixedZoom:!0,duration:300})),i().createElement(ur,{innerRef:ie,tools:ci({},p.bT.COLUMN,["size","align","theme"]),className:"ms-section-contents".concat(B),contents:C,mode:I,add:a,updateCurrentPage:h,editMedia:l,editWebPage:s,update:m,remove:w,sectionId:S,viewWidth:A,viewHeight:x,contentProps:{onVisibilityChange:d,contentWrapperStyle:{minHeight:de,visibility:ue},expandable:z,mediaViewer:U,contentToolbar:V,overrideTools:function(e){return Object.fromEntries(Object.entries(e).map((function(e){var t=ni(e,2),n=t[0],r=t[1];return[n,ye(r)]})))}},focusedContent:R,bubblingTextEditing:L,sectionType:k,storyTheme:pe,sections:q,storyFonts:$}),i().createElement(Yo,{innerRef:ae,style:null!=F&&F.overlay?ai({},F.overlay):{},controlStyle:fe?ai({},fe):{},sectionId:S,contentId:Z,contents:C,update:m,remove:w,expandable:z,add:function(){return e=ai(ai({},(0,p.nq)(p.bT.COLUMN)),{},{title:"Item "+(C.length+1),background:{}}),a('sections[{"id": "'.concat(S,'"}].contents'),void 0,e,"geostory.builder.defaults.titleGeocarouselContent"),void m('sections[{"id":"'.concat(S,'"}].contents[{"id":"').concat(Z,'"}].hideContent'),!0);var e},contentToolbar:V,mode:I,onSort:J,isMapBackground:me,isEditMap:null==E?void 0:E.editMap,containerWidth:A,isDrawEnabled:X,onEnableDraw:function(e){m('sections[{"id":"'.concat(S,'"}].background.editMap'),!0,"replace"),Q({contentId:e.id,sectionId:S})}}),I===p.nl.VIEW&&!z&&i().createElement(ei,{currentIndex:ge,contents:C,onTraverseCard:function(){var e,t,n;e="left"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"left")?null==C||null===(t=C[0===ge?0:ge-1])||void 0===t?void 0:t.id:null==C||null===(n=C[ge===C.length-1?ge:ge+1])||void 0===n?void 0:n.id,m('sections[{"id":"'.concat(S,'"}].contents[{"id":"').concat(e,'"}].carouselToggle'),!0)}}),I===p.nl.EDIT&&!le&&i().createElement(Yt,{containerWidth:A,containerHeight:x,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){a("sections",S,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){a("sections",S,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){a("sections",S,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){return a("sections",S,p.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){a("sections",S,p.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){a("sections",S,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){a("sections",S,p.tQ.WEBPAGE)}}]}))}));function ui(e){return ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ui(e)}function si(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,bi(r.key),r)}}function pi(e,t,n){return t=di(t),function(e,t){if(t&&("object"==ui(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,fi()?Reflect.construct(t,n||[],di(e).constructor):t.apply(e,n))}function fi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fi=function(){return!!e})()}function di(e){return di=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},di(e)}function yi(e,t){return yi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yi(e,t)}function mi(e,t,n){return(t=bi(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bi(e){var t=function(e){if("object"!=ui(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ui(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ui(t)?t:t+""}var vi=mi(mi(mi(mi(mi(mi(mi(mi({},p.ID.IMMERSIVE,ao),p.ID.CAROUSEL,li),p.ID.PARAGRAPH,po),p.tQ.MEDIA,po),p.tQ.WEBPAGE,po),p.ID.TITLE,go),p.ID.BANNER,So),"UNKNOWN",(function(e){var t=e.type,n=e.inViewRef;return i().createElement("div",{ref:n,className:"ms-section ms-section-unknown"},"WARNING: unknown session of type ",t)})),gi=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return mi(e=pi(this,t,[].concat(r)),"state",{height:0}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yi(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=vi[this.props.type]||vi.UNKNOWN;return i().createElement(e,{sectionType:this.props.type,id:this.props.id,add:this.props.add,update:this.props.update,inViewRef:this.props.inViewRef,editMedia:this.props.editMedia,expandableMedia:this.props.expandableMedia,editWebPage:this.props.editWebPage,updateCurrentPage:this.props.updateCurrentPage,remove:this.props.remove,mode:this.props.mode,cover:this.props.cover,contents:this.props.contents,viewWidth:this.props.viewWidth,viewHeight:this.props.viewHeight,focusedContent:this.props.focusedContent,storyTheme:this.props.storyTheme,mediaViewer:this.props.mediaViewer,contentToolbar:this.props.contentToolbar,inView:this.props.inView,sections:this.props.sections,storyFonts:this.props.storyFonts,onSort:this.props.onSort,isDrawEnabled:this.props.isDrawEnabled,background:this.props.background,onEnableDraw:this.props.onEnableDraw,defaultMarkerStyle:this.props.defaultMarkerStyle,highlightedMarkerStyle:this.props.highlightedMarkerStyle})}}])&&si(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);mi(gi,"propTypes",{id:Qe().string,type:Qe().oneOf(p.lg.SectionTypes),storyType:Qe().oneOf(p.lg.StoryTypes),add:Qe().func,update:Qe().func,editMedia:Qe().func,editWebPage:Qe().func,remove:Qe().func,updateCurrentPage:Qe().func,mode:Qe().oneOf(p.lg.Modes),contents:Qe().array,viewHeight:Qe().number,viewWidth:Qe().number,inViewRef:Qe().func,excludeClassName:Qe().string,cover:Qe().bool,focusedContent:Qe().object,expandableMedia:Qe().bool,storyTheme:Qe().object,mediaViewer:Qe().func,contentToolbar:Qe().func,inView:Qe().bool,sections:Qe().array,storyFonts:Qe().array,onSort:Qe().func,isDrawEnabled:Qe().bool,onEnableDraw:Qe().func,background:Qe().object,defaultMarkerStyle:Qe().object,highlightedMarkerStyle:Qe().object}),mi(gi,"defaultProps",{id:"",add:function(){},update:function(){},editMedia:function(){},editWebPage:function(){},updateCurrentPage:function(){},remove:function(){},onSort:function(){},storyType:p.Ln.CASCADE,viewHeight:0,viewWidth:0,mode:p.nl.VIEW,expandableMedia:!1,sections:[],storyFonts:[],onEnableDraw:function(){}});const hi=pn({threshold:[0,.25,.5,.75,1],rootMargin:"-200px 0px 0px 0px"})(gi);function Oi(e){return Oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oi(e)}function wi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ci(r.key),r)}}function Si(e,t,n){return t=Ei(t),function(e,t){if(t&&("object"==Oi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Pi()?Reflect.construct(t,n||[],Ei(e).constructor):t.apply(e,n))}function Pi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Pi=function(){return!!e})()}function Ei(e){return Ei=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ei(e)}function ji(e,t){return ji=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ji(e,t)}function Ti(e,t,n){return(t=Ci(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ci(e){var t=function(e){if("object"!=Oi(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Oi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Oi(t)?t:t+""}var Ii=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Ti(e=Si(this,t,[].concat(r)),"getAdjustedSelector",(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/#\d|^#-\d/g,(function(e,t){return t?"#\\"+t[1]+t[2]:"#\\3"+e[1]+" "}))})),Ti(e,"getFocusedTarget",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.targets,n=e.props.padding,r=void 0===n?{}:n;return t.map((function(t){var n=t.selector,o=null;try{var i=window.document.querySelector(e.getAdjustedSelector(n));if(i){var a=i.getBoundingClientRect(),c=a.top,l=a.right,u=a.bottom,s=a.left;o={x:s-r,y:c-r,w:l-s+2*r,h:u-c+2*r}}}catch(e){console.warn(e)}finally{return o}})).filter((function(e){return e}))})),Ti(e,"getHolePath",(function(t){var n=t.x,r=t.y,o=t.w,i=t.h,a=e.props.borderRadius,c=void 0===a?8:a;return"M ".concat(n," ").concat(r+c," q 0 -").concat(c," ").concat(c," -").concat(c," h ").concat(o-2*c," q ").concat(c," 0 ").concat(c," ").concat(c," v ").concat(i-2*c," q 0 ").concat(c," -").concat(c," ").concat(c," h-").concat(o-2*c," q -").concat(c," 0 -").concat(c," -").concat(c," v-").concat(i-2*c)})),Ti(e,"getPath",(function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getFocusedTarget();return"M 0 0 h ".concat(n," v ").concat(t," h -").concat(n," v -").concat(t)+r.map(e.getHolePath).join(" ")})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ji(e,t)}(t,e),n=t,r=[{key:"render",value:function(){var e=this,t=this.props,n=t.onMaskClicked,r=t.stopEventsOnTargets,o=void 0!==r&&r,a=t.targets,c=this.getFocusedTarget(a.filter((function(e){var t=e.stopEventsOnTarget;return o||t})));return i().createElement("div",{style:{position:"fixed",height:"100vh",width:"100vw",top:0,left:0,zIndex:1e6,pointerEvents:"none"}},i().createElement(Re.Z,null,(function(t){var r=t.width,o=t.height;return i().createElement("svg",{width:r,height:o,xmlns:"http://www.w3.org/2000/svg"},i().createElement("path",{d:e.getPath(o,r),fill:"rgba(0,0,0,0.7)",fillRule:"evenodd",pointerEvents:"visiblePainted",onClick:n}),c.map((function(t,n){return i().createElement("path",{key:n,d:e.getHolePath(t),fill:"transparent",pointerEvents:"visiblePainted"})})))})))}}],r&&wi(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(i().Component);function ki(e){return ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ki(e)}function Di(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Di(Object(n),!0).forEach((function(t){Ai(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Di(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ai(e,t,n){return(t=function(e){var t=function(e){if("object"!=ki(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ki(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ki(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ti(Ii,"propTypes",{targets:Qe().arrayOf(Qe().shape({selector:Qe().string,stopEventsOnTarget:Qe().bool})),padding:Qe().number,borderRadius:Qe().number,onMaskClicked:Qe().func,stopEventsOnTargets:Qe().bool}),Ti(Ii,"defaultProps",{targets:[],padding:0,borderRadius:8,onMaskClicked:function(){},stopEventsOnTargets:!1});var xi=(0,Ue.Z)((function(e){var t=e.sections;return 0===(void 0===t?[]:t).length}),(function(e){var t=e.add,n=void 0===t?function(){}:t;return{iconFit:!1,style:{position:"relative",width:"50%",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},glyph:"geostory",title:i().createElement(ot.Z,{msgId:"geostory.emptyTitle"}),description:i().createElement(ot.Z,{msgId:"geostory.emptyDescription"}),content:i().createElement(Yt,{addButtonClassName:"square-button-md",containerWidth:"100%",containerHeight:"100%",buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){n("sections",0,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){n("sections",0,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){n("sections",0,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveContent",onClick:function(){n("sections",0,p.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselContent",onClick:function(){n("sections",0,p.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){n("sections",0,p.tQ.MEDIA)}},{glyph:"code",tooltipId:"geostory.addWebPageSection",onClick:function(){n("sections",0,p.tQ.WEBPAGE)}}]})}}))(Re.Z),Ri=function(e){var t=e.width;return e.mode===p.nl.EDIT?"":t<640?"sm":t>=640&&t<1024?"md":""};const Zi=(0,Ze.compose)(Fe,Je,function(e){var t=e.showFocusMask,n=void 0===t?function(){}:t,r=e.defaultTargets,o=void 0===r?{selector:".ms-geostory-map-editor"}:r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=a.padding,l=void 0===c?0:c,u=a.borderRadius,s=void 0===u?8:u,p=a.stopEventsOnTargets,f=void 0!==p&&p,d=a.onMaskClicked,y=void 0===d?function(){}:d;return(0,Ze.branch)(n,(function(e){return(0,Ze.nest)((function(e){var t=e.focusedContent,n=e.children;return i().createElement(i().Fragment,null,n,i().createElement(Ii,{targets:[t,o],padding:l,borderRadius:s,stopEventsOnTargets:f,onMaskClicked:y}))}),e)}))}({showFocusMask:function(e){var t=e.focusedContent,n=(void 0===t?{}:t).target;return(void 0===n?{}:n).id}}))((function(e){var t=e.mode,n=void 0===t?p.nl.VIEW:t,r=e.sections,o=void 0===r?[]:r,a=e.add,c=void 0===a?function(){}:a,l=e.onVisibilityChange,u=void 0===l?function(){}:l,s=e.updateCurrentPage,f=void 0===s?function(){}:s,d=e.editMedia,y=void 0===d?function(){}:d,m=e.editWebPage,b=void 0===m?function(){}:m,v=e.update,g=void 0===v?function(){}:v,h=e.remove,O=void 0===h?function(){}:h,w=e.focusedContent,S=e.isContentFocused,P=void 0!==S&&S,E=e.getSize,j=void 0===E?Ri:E,T=e.theme,C=void 0===T?{}:T,I=e.mediaViewer,k=e.contentToolbar,D=e.storyFonts,M=e.onSort,A=void 0===M?function(){}:M,x=e.isDrawEnabled,R=void 0!==x&&x,Z=e.onEnableDraw,N=void 0===Z?function(){}:Z,L=e.defaultMarkerStyle,W=e.highlightedMarkerStyle;return i().createElement(xe.Z,{className:"ms-cascade-story ms-".concat(n)},i().createElement(xi,{sections:o,add:c},(function(e){var t,r=e.width,a=e.height,l=j({width:r,height:a,mode:n}),s=l?" ms-".concat(l):"",p="sm"===l,d=C&&Cn()(C)&&C||{};return i().createElement("div",{id:"ms-sections-container",className:"ms-sections-container".concat(s," ms-sections-hyperlinks"),style:Mi(Mi({},null==d?void 0:d.general),P&&{overflow:"hidden"})},(null==d||null===(t=d.link)||void 0===t?void 0:t.color)&&i().createElement("style",{dangerouslySetInnerHTML:{__html:"\n            .ms-sections-hyperlinks .ms-text-editor-main a,\n            .ms-sections-hyperlinks .ms-text-wrapper a,\n            .ms-sections-hyperlinks .ms-text-editor-main a:link,\n            .ms-sections-hyperlinks .ms-text-wrapper a:link,\n            .ms-sections-hyperlinks .ms-text-editor-main a:visited,\n            .ms-sections-hyperlinks .ms-text-wrapper a:visited,\n            .ms-sections-hyperlinks .ms-text-editor-main a:active,\n            .ms-sections-hyperlinks .ms-text-wrapper a:active {\n                color: ".concat(d.link.color,";\n                opacity: 1;\n            }\n            .ms-sections-hyperlinks .ms-text-editor-main a:hover,\n            .ms-sections-hyperlinks .ms-text-wrapper a:hover {\n                color: ").concat(d.link.color,";\n                opacity: 0.75;\n            }\n        ")}}),o.map((function(e){var t=e.contents,l=void 0===t?[]:t,s=e.id,m=e.type,v=e.cover,h=e.background;return i().createElement(hi,{focusedContent:w,onVisibilityChange:u,add:c,editMedia:y,expandableMedia:p,editWebPage:b,updateCurrentPage:f,update:g,remove:O,key:s,id:s,viewHeight:a,viewWidth:r,type:m,mode:n,contents:l,cover:v,storyTheme:d,mediaViewer:I,contentToolbar:k,sections:o,storyFonts:D,onSort:A,isDrawEnabled:R,onEnableDraw:N,background:h,defaultMarkerStyle:L,highlightedMarkerStyle:W})})))})))}));var Ni=n(957557),Li=n.n(Ni),Wi=n(648860);function Bi(e){return Bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bi(e)}function _i(e){return function(e){if(Array.isArray(e))return zi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return zi(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zi(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Fi(){return Fi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fi.apply(null,arguments)}function Ui(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ui(Object(n),!0).forEach((function(t){Hi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ui(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Hi(e,t,n){return(t=function(e){var t=function(e){if("object"!=Bi(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Bi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Bi(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gi=(0,En.Z)(fn.Z);const qi=(0,Ze.compose)((0,a.connect)((0,c.P1)(H.jq,H.z7,(function(e,t){return{resources:e,isContentFocused:t}}))),(0,Ze.withProps)((function(e){var t=e.resources,n=e.resourceId,r=e.map,o=void 0===r?{}:r,i=Vi(Vi({},o),{},{layers:(o.layers||[]).map((function(e){return e||void 0}))}),a=mn()(t,{id:n})||{};return{map:(0,p.oH)(Li()(a.data,["context"]),i)}})));var $i=(0,Ze.compose)((0,a.connect)((0,c.P1)(H.GC,(function(){return{focusedEl:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}))),(0,Ze.withProps)((function(e){var t=e.focusedEl,n=void 0===t?{}:t,r=n.resourceId,o=n.map;return{map:o||{},resourceId:r,disableReset:!o}}))),Ki=(0,Ze.withHandlers)({onChangeMap:function(e){var t=e.update,n=e.focusedContent,r=void 0===n?{}:n;return function(e,n){t("".concat(r.path,".map.").concat(e),n,"merge")}},onChange:function(e){var t=e.update,n=e.focusedContent,r=void 0===n?{}:n;return function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"merge";t(r.path+".".concat(e),n,o)}}}),Ji=(0,Ze.withHandlers)({toggleEditing:function(e){var t=e.editMap,n=e.update,r=e.focusedContent;return function(){return n(r.path+".editMap",!t)}},onReset:function(e){var t=e.update,n=e.focusedContent,r=(void 0===n?{}:n).path,o=void 0===r?"":r;return function(){t(o+".map",void 0)}}}),Yi=function(e){return i().createElement(Gi,Fi({glyph:"repeat",bsStyle:"primary",className:"square-button-md no-border",tooltipId:"geostory.contentToolbar.resetMap",confirmTitle:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.resetMapConfirm"}),confirmContent:i().createElement(ot.Z,{msgId:"geostory.contentToolbar.resetConfirmContent"})},e))},Qi=(0,Ze.compose)((0,Ze.withProps)((function(e){var t=e.disableReset,n=e.onReset,r=e.buttonItems,o=void 0===r?[]:r,a=e.map;return{buttons:[{renderButton:i().createElement(Yi,{disabled:t,onClick:n})}].concat(_i(o.map((function(e){var t=e.Component;return{renderButton:i().createElement(t,{map:a})}}))))}})),Wi.Z,(0,Ze.withStateHandlers)((function(){return{editNode:void 0}}),{setEditNode:function(){return function(e){return{editNode:e}}},closeNodeEditor:function(){return function(){return{editNode:void 0}}}}),(0,Ze.branch)((function(e){return!!e.editNode}),(0,Ze.withProps)((function(e){var t=e.selectedNodes,n=void 0===t?[]:t,r=e.closeNodeEditor,o=void 0===r?function(){}:r;return{buttons:[{visible:1===n.length,tooltipId:"close",glyph:"1-close",onClick:o}]}})),(0,Ze.withProps)((function(e){var t=e.selectedNodes,n=void 0===t?[]:t,r=e.setEditNode,o=void 0===r?function(){}:r,i=e.buttons,a=void 0===i?[]:i;return{buttons:[{visible:1===n.length,glyph:"wrench",tooltipId:"toc.toolLayerSettingsTooltip",onClick:function(){o(n[0])}}].concat(_i(a))}})))),Xi=(0,Ze.compose)((0,Ze.withPropsOnChange)(["focusedContent"],(function(e){var t=e.map,n=e.focusedEl;return{contentMap:(void 0===n?{}:n).map,lastSavedMap:t}})),(0,Ze.withPropsOnChange)(["map"],(function(e){var t=e.map,n=e.lastSavedMap;return{pendingChanges:!hn()(n,t)}}))),ea=(0,Ze.compose)((0,Ze.withProps)((function(e){var t=e.toggleEditing;return{CloseBtn:function(e){return i().createElement(fn.Z,Fi({onClick:t},e))}}}))),ta=(0,Ze.mapPropsStream)((function(e){var t=(0,Ze.createEventHandler)(),n=t.stream,r=t.handler;return e.pluck("map").distinctUntilChanged((function(e,t){return hn()(e,t)})).switchMap((function(e){return n.map((function(t){return{map:Vi(Vi({},e),t)}})).startWith({map:e})})).combineLatest(e,(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).map;return Vi(Vi({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{},{onMapViewLocalChanges:r,map:e})}))})),na=function(e,t){return void 0!==e&&void 0!==t&&e.toFixed(12)-t.toFixed(12)==0},ra=(0,Ze.withHandlers)({onMapViewChanges:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.update,n=e.editMap,r=void 0!==n&&n,o=e.onMapViewLocalChanges,i=e.map,a=void 0===i?{}:i,c=a.center,l=void 0===c?{}:c,u=a.zoom,s=a.mapStateSource,p=a.resolution,f=a.resetPanAndZoom;return function(e){var n=e.center,i=void 0===n?{}:n,a=e.zoom,c=e.mapStateSource,d=e.resolution,y=na(l.x,i.x)&&na(l.y,i.y);!r||y&&u===a?f?t("map",{center:l,zoom:u,mapStateSource:s,resolution:p,resetPanAndZoom:!1},"merge"):o({center:i,zoom:a,mapStateSource:c,resolution:d}):t("map",{center:i,zoom:a,mapStateSource:zn()(),resolution:d,resetPanAndZoom:!1},"merge")}}}),oa=n(5993),ia=n(75927),aa=n(910336),ca=n(815135),la=["tabs","activeTab","width","setActiveTab"];function ua(){return ua=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ua.apply(null,arguments)}var sa=(0,ca.Z)(nt.LY);var pa=n(979105),fa=n(743129),da=n(898631),ya=n(145869),ma=n(487320),ba=["map","onChangeMap"],va=(0,Co.Z)(["placeholder","options"])(fa.ZP);const ga=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,n=void 0===t?{zoomControl:!0,mapInfoControl:!1}:t,r=e.onChangeMap,o=void 0===r?function(){}:r,a=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,ba),c=n&&n.mapOptions||{},l=(0,p.kn)({mapOptions:c,zoomControl:!!E()(n.zoomControl)||n.zoomControl,mapInfoControl:!E()(n.mapInfoControl)&&n.mapInfoControl}),u=(0,da.kq)(n);return i().createElement(nt.l0,{className:"ms-geostory-map-controls"},!u&&i().createElement(nt.cw,null,i().createElement(nt.J$,null,i().createElement(ot.Z,{msgId:"geostory.mapEditor.zoom"})),i().createElement(ya.Z,{onChange:function(){var e=!l.zoomControl;o("zoomControl",e),o("mapOptions.interactions",{doubleClickZoom:e,shiftDragZoom:e,pinchZoom:e})},className:"ms-geostory-map-controls-switch",checked:l.zoomControl}),i().createElement(va,{options:[{label:"geostory.mapEditor.topLeft",value:"topLeft"},{label:"geostory.mapEditor.topRight",value:"topRight"},{label:"geostory.mapEditor.bottomLeft",value:"bottomLeft"},{label:"geostory.mapEditor.bottomRight",value:"bottomRight"}],wrapperStyle:{marginTop:"10px"},value:l.mapOptions&&l.mapOptions.zoomPosition||"topLeft",clearable:!1,disabled:!l.zoomControl,onChange:function(e){return o("mapOptions.zoomPosition",e&&e.value?e.value:"topLeft")},placeholder:"geostory.builder.settings.titlePlaceholder"})),i().createElement(nt.cw,null,i().createElement(nt.J$,null,i().createElement(ot.Z,{msgId:"geostory.mapEditor.pan"})),i().createElement(ya.Z,{onChange:function(){var e=!(l.mapOptions&&l.mapOptions.interactions&&l.mapOptions.interactions.dragPan);o("mapOptions.interactions",{dragPan:e,keyboardPan:e})},className:"ms-geostory-map-controls-switch",checked:l.mapOptions&&l.mapOptions.interactions&&l.mapOptions.interactions.dragPan})),!u&&i().createElement(nt.cw,null,i().createElement(nt.J$,null,i().createElement(ot.Z,{msgId:"geostory.mapEditor.identify"})),i().createElement(ya.Z,{onChange:function(){var e=!l.mapInfoControl;o("mapInfoControl",e)},className:"ms-geostory-map-controls-switch",checked:l.mapInfoControl}),l.mapInfoControl&&!a.hideIdentifyOptions&&i().createElement(ma.Z,{disabled:!l.mapInfoControl,popoverMessage:"geostory.builder.settings.templateTooltip",infoFormat:l.mapOptions&&l.mapOptions.mapInfoFormat||"application/json",onInfoFormatChange:function(e){return o("mapOptions.mapInfoFormat",e)},selectProps:{wrapperStyle:{marginTop:10}}})))};var ha=n(618300),Oa=(0,Ze.withProps)((function(e){return{tabs:e.tabs||[{id:"toc",titleId:"geostory.mapEditor.toc",tooltipId:"geostory.mapEditor.toc",glyph:"1-layer",visible:!0,Component:ha.Z},{id:"settings",titleId:"geostory.mapEditor.settings",tooltipId:"geostory.mapEditor.settings",glyph:"wrench",visible:!0,Component:ga}]}}));const wa=(0,Ze.compose)((0,pa.Z)("activeTab","setActiveTab","toc"),Oa);var Sa=(0,Ze.compose)(aa.Z,(0,Ze.withProps)((function(e){var t=e.selectedNode;return{title:t&&t.title}})),(0,oa.Z)("title"))((function(e){var t=e.title,n=e.description;return i().createElement("div",{className:"text-center"},i().createElement("div",{className:"mapstore-step-title"},t),i().createElement("div",{className:"mapstore-step-description"},n))})),Pa=(0,aa.Z)(ia.Z),Ea=wa((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tabs,n=void 0===t?[]:t,r=e.activeTab,o=(e.width,e.setActiveTab),a=void 0===o?function(){}:o,c=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,la);return i().createElement("div",{key:"ms-geostory-map-settings-navbar",className:"ms-row-tab"},i().createElement("div",null,i().createElement(nt.JL,{bsStyle:"tabs",activeKey:r,justified:!0},n.map((function(e){return i().createElement(sa,{key:"ms-tab-settings-"+e.id,tooltipId:e.tooltipId,eventKey:e.id,onClick:function(){return a(e.id)}},i().createElement(nt.gG,{glyph:e.glyph}))})))),i().createElement("div",null,n.filter((function(e){return e.id&&e.id===r})).filter((function(e){return e.Component})).map((function(e){return i().createElement(e.Component,ua({},c,{key:"ms-geostory-tab-settings-body-"+e.id}))}))))}));const ja=(0,Ze.branch)((function(e){var t=e.focusedContent;return(void 0===t?{}:t).path}),(0,Ze.compose)((0,Ze.defaultProps)({isFocused:!0,editMap:!0}),$i,qi,Xi,Ki,Ji,Qi,ea))((function(e){var t=e.mode,n=void 0===t?p.nl.VIEW:t,r=e.isFocused,o=void 0!==r&&r,a=e.map,c=void 0===a?{}:a,l=e.onChange,u=void 0===l?function(){}:l,s=e.onChangeMap,f=void 0===s?function(){}:s,d=e.onNodeSelect,y=void 0===d?function(){}:d,m=e.selectedNodes,b=e.buttons,v=void 0===b?[]:b,g=e.editNode,h=e.closeNodeEditor,O=e.CloseBtn,w=void 0===O?function(){return null}:O,S=e.isDrawEnabled,P=e.hideIdentifyOptions;return n===p.nl.EDIT&&o?i().createElement("div",{key:"left-column",style:{order:-1,width:400,position:"relative"}},!S&&i().createElement(xe.Z,{className:"ms-geostory-map-editor",header:i().createElement("div",{className:"ms-geostory-map-editor-header text-center"},i().createElement(nt.X2,null,i().createElement(nt.JX,{md:12,className:"text-center",style:{overflow:"hidden",lineHeight:"52px"}},i().createElement(w,{glyph:"1-close",className:"pull-left on-close-btn square-button no-border ",tooltipId:"geostory.contentToolbar.closeMapEditing"}),i().createElement("div",{className:"mapstore-step-title"},i().createElement(ot.Z,{msgId:"geostory.mapEditor.configureMapOptions"})))),i().createElement(Wt.Z,{transitionProps:!1,btnGroupProps:{className:"ms-geostory-map-editor-toolbar"},btnDefaultProps:{className:"square-button-md no-border",bsStyle:"primary",noTooltipWhenDisabled:!0},buttons:v}))},!!g&&[i().createElement(Sa,{map:c,editNode:g}),i().createElement(Pa,{closeNodeEditor:h,editNode:g,map:c,onChange:u})]||[i().createElement(Ea,{map:c,onChange:u,onChangeMap:f,selectedNodes:m,onSelect:y,hideIdentifyOptions:P})])):null}));var Ta=n(264721),Ca=n.n(Ta),Ia=n(916788),ka=n(437034),Da=n(452826),Ma=n(624262);function Aa(e){return Aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Aa(e)}function xa(){return xa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xa.apply(null,arguments)}function Ra(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Za(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ra(Object(n),!0).forEach((function(t){Na(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ra(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Na(e,t,n){return(t=function(e){var t=function(e){if("object"!=Aa(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Aa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Aa(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const La=function(e){var t=function(){return i().createElement("div",{className:"ms-media-error"},i().createElement(nt.gG,{glyph:"exclamation-sign"}))},n=function(e){var t=e.style,n=void 0===t?{}:t;return i().createElement("div",{style:n,className:"ms-media-loader"},i().createElement(ht.Z,{size:52}))};return function(r){var o={},a=r.sectionType;if((a===p.ID.PARAGRAPH||a===p.ID.IMMERSIVE||a===p.ID.CAROUSEL)&&r.type===p.Tr.IMAGE){var c=((null==r?void 0:r.imgHeight)||9)/((null==r?void 0:r.imgWidth)||16)*100;o={paddingTop:"".concat(c,"%")}}return r.lazy?i().createElement(gt,{key:r.loadingId,id:r.loadingId,debounceTime:r.debounceTime,loading:r.isLoading,onLoad:function(e){return r.onLoad(Za(Za({},r.loading),{},Na({},e,!1)))},loaderComponent:n,loaderStyle:o},i().createElement(e,xa({},r,{type:r.type,loaderComponent:n,loaderStyle:o,errorComponent:t}))):i().createElement(e,xa({},r,{key:r.id,type:r.mediaType||r.type,loaderComponent:n,errorComponent:t}))}};var Wa=n(507848),Ba=n(819983),_a=n(323010),za=["autoplay"],Fa=["type"];function Ua(e){return Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ua(e)}function Va(){return Va=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Va.apply(null,arguments)}function Ha(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Ga(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ga(Object(n),!0).forEach((function(t){$a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ga(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $a(e,t,n){return(t=function(e){var t=function(e){if("object"!=Ua(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ua(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ua(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ka=(0,Ze.branch)((function(e){return e.resourceId}),(0,Ze.compose)((0,a.connect)((0,c.P1)(H.jq,(function(e){return{resources:e}}))),(0,Ze.withProps)((function(e){var t=e.resources,n=e.resourceId;return(mn()(t,{id:n})||{}).data}))),(0,Ue.Z)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.sectionType;return!n&&r!==p.ID.TITLE&&!Ca()([p.ID.IMMERSIVE,p.ID.CAROUSEL],r)}),(function(){return{glyph:"picture"}})))(La(Ia.Z)),Ja=(0,Ze.compose)((0,Ze.branch)((function(e){return e.resourceId}),qi),(0,Ze.withProps)((function(e){var t=e.map,n=void 0===t?{}:t;return{map:qa(qa({},n),{},{layers:n.layers&&n.layers.map((function(e){if(e.tileMatrixSet&&n.sources){var t=(0,Ma.gv)(n.sources,e);return qa(qa({},e),t)}return e}))})}})),Wa.Z,Ba.Z,ta,ra,_a.d)(La(ka.Z)),Ya={image:Ka,map:Ja,video:(0,Ze.branch)((function(e){return e.resourceId}),(0,Ze.compose)((0,a.connect)((0,c.P1)(H.jq,(function(e){return{resources:e}}))),(0,Ze.withProps)((function(e){var t=e.resources,n=e.resourceId,r=e.autoplay,o=(mn()(t,{id:n})||{}).data||{},i=o.autoplay;return qa(qa({},Ha(o,za)),{},{autoplay:void 0!==r?r:i})}))),(0,Ue.Z)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.sectionType;return!n&&r!==p.ID.TITLE&&!Ca()([p.ID.IMMERSIVE,p.ID.CAROUSEL],r)}),(function(){return{glyph:"play"}})))(La(Da.Z))};const Qa=function(e){var t=e.type,n=Ha(e,Fa),r=Ya[t];return r?i().createElement(r,Va({type:t},n)):null};var Xa=["resources"];function ec(){return ec=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ec.apply(null,arguments)}const tc=(0,a.connect)((0,c.P1)(H.jq,(function(e){return{resources:e}})))((function(e){var t=e.resources,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Xa);if(n.resourceId){var r=(mn()(t,{id:n.resourceId})||{}).data||{};return i().createElement(Jn,ec({},r,n))}return i().createElement(Jn,n)}));var nc=["story","mode","onAdd","messages","fontFamilies","storyFonts","webFont","onUpdate","onBasicError","onUpdateMediaEditorSetting","mediaEditorSettings"];function rc(){return rc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rc.apply(null,arguments)}var oc=function(e){var t,n=e.story,r=e.mode,a=void 0===r?p.nl.VIEW:r,c=e.onAdd,l=e.messages,s=e.fontFamilies,d=void 0===s?[]:s,y=e.storyFonts,m=void 0===y?[]:y,b=e.webFont,v=void 0===b?u():b,g=e.onUpdate,h=void 0===g?function(){}:g,O=e.onBasicError,w=void 0===O?function(){}:O,S=e.onUpdateMediaEditorSetting,P=e.mediaEditorSettings,E=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,nc),j=(0,o.useCallback)((function(e){return(0,f.S$)(l,e)}),[l]),T=function(e,t,n,r){return c(e,t,n,r?j(r):j)};return(0,o.useEffect)((function(){window.__geostory_interaction=function(e,t){"scrollTo"===e&&(0,p.M1)(t,{behavior:"smooth"})}}),[]),(0,o.useEffect)((function(){h("settings.theme.fontFamilies",d,"merge",{uniqueByKey:"family"}),P&&S(P)}),[]),(0,o.useEffect)((function(){m.length>0&&m.filter((function(e){var t=e.src;return t&&!document.head.querySelector("link[href='".concat(t,"']"))})).length>0&&v.load((0,p.bm)(m,(function(){}),(function(){return w({message:"geostory.builder.settings.webFontLoadError"})})))}),[m]),i().createElement(xe.Z,{className:"ms-geostory",columns:[i().createElement(ja,rc({},E,{buttonItems:null===(t=E.items)||void 0===t?void 0:t.filter((function(e){return"mapEditorToolbar"===e.target})),add:T,update:h,mode:a,hideIdentifyOptions:E.hideIdentifyOptions}))]},i().createElement(Zi,rc({},n,E,{storyFonts:(0,p._R)(m),add:T,update:h,mode:a,mediaViewer:Qa,contentToolbar:tc})))};oc.defaultProps={storyFonts:[],fontFamilies:[],onUpdateMediaEditorSetting:function(){}};const ic=(0,s.rx)("GeoStory",{component:(0,a.connect)((0,c.zB)({mode:H.eK,story:H.Kg,messages:Me.Ps,focusedContent:H.FW,isContentFocused:H.z7,theme:function(e){var t;return(null===(t=(0,H.TQ)(e))||void 0===t?void 0:t.theme)||{}},storyFonts:H.mm,isDrawEnabled:H.HB}),{onAdd:y.IH,onUpdate:y.Vx,updateCurrentPage:y.RZ,onUpdateSetting:y.m7,remove:y.Od,onSort:y.pB,editMedia:m.Ql,editWebPage:y.o2,onBasicError:d.d,onUpdateMediaEditorSetting:y.Fu,onEnableDraw:y.EE})(oc),reducers:{geostory:Ae.Z},epics:r})},531398:(e,t,n)=>{"use strict";n.d(t,{d:()=>o});var r=n(197395),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.title,n=void 0===t?"notification.warning":t,o=e.autoDismiss,i=void 0===o?6:o,a=e.position,c=void 0===a?"tc":a,l=e.message,u=void 0===l?"Error":l;return(0,r.vU)({title:n,autoDismiss:i,position:c,message:u})}},683255:(e,t,n)=>{e.exports=n.p+"grid.svg"},911636:(e,t,n)=>{e.exports=n.p+"world.svg"},773723:(e,t,n)=>{e.exports=n.p+"MapStore2/web/client/components/geostory/contents/carousel/img/default.jpg"},875492:(e,t,n)=>{e.exports=n.p+"MapStore2/web/client/components/geostory/layouts/sections/patterns/dots.png"}}]);