"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[8102],{109351(e,t,n){n.d(t,{A:()=>s});var r=n(273517),o=n.n(r),i=n(76941),a=n(8571),l=n(711030);const s=function(e){var t=e.title,n=void 0===t?o().createElement(a.A,{msgId:"warning"}):t,r=e.cancelText,s=void 0===r?o().createElement(a.A,{msgId:"no"}):r,c=e.confirmText,u=void 0===c?o().createElement(a.A,{msgId:"yes"}):c,p=e.onClose,f=void 0===p?function(){}:p,d=e.onConfirm,m=void 0===d?function(){}:d,g=e.show,b=e.children,v=e.className,y=void 0===v?"":v,h=e.buttonSize,E=e.running,P=void 0!==E&&E,S=o().createElement("span",{role:"footer"},o().createElement("div",{style:{float:"left"}}),o().createElement(l.A,{disabled:P,className:y,key:"confirmButton",bsStyle:"primary",bsSize:h,onClick:function(){m()}},u),o().createElement(l.A,{key:"cancelButton",bsSize:h,disabled:P,onClick:f},s));return o().createElement(i.A,{show:g,onHide:f},o().createElement(i.A.Header,{key:"dialogHeader",closeButton:!0},o().createElement(i.A.Title,null,n)),o().createElement(i.A.Body,null,b),o().createElement(i.A.Footer,null,S))}},204903(e,t,n){n.d(t,{A:()=>U});var r=n(273517),o=n.n(r),i=n(605556),a=n.n(i),l=n(811668),s=n(23412),c=n.n(s),u=n(809136),p=n.n(u),f=n(779893),d=n(393149),m=n(702749),g=n(50906),b=n(480521);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}var y=["onLoaded","pluginsConfig","plugins","loaderComponent"];function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(null,arguments)}function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach(function(t){S(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function S(e,t,n){return(t=function(e){var t=function(e){if("object"!=v(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==v(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.in;return function(t){return function(n){var i=n.onLoaded,a=void 0===i?function(){}:i,l=n.pluginsConfig,s=n.plugins,c=void 0===s?{}:s,u=n.loaderComponent,p=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(n,y),f=e(P({pluginsConfig:l},p)),d=(0,g.A)({pluginsEntries:(0,b.x)(c,"module"),pluginsConfig:f}),m=d.plugins,v=d.pending,E=(0,r.useMemo)(function(){return P(P({},m),(0,b.x)(c))},[m]),S=v,O=u;return(0,r.useEffect)(function(){S||a(!0)},[S]),S&&u?o().createElement(O,null):o().createElement(t,h({},p,{pluginsConfig:l,plugins:E,allPlugins:c}))}}}()(m.A);var C=n(588100),w=n(715773);function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,I(r.key),r)}}function j(e,t,n){return t=D(t),function(e,t){if(t&&("object"==T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,A()?Reflect.construct(t,n||[],D(e).constructor):t.apply(e,n))}function A(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(A=function(){return!!e})()}function D(e){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},D(e)}function N(e,t){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},N(e,t)}function k(e,t,n){return(t=I(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){var t=function(e){if("object"!=T(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==T(t)?t:t+""}var F=c().parse(window.location.href,!0).query,R=(0,l.connect)((0,C.UU)(p())(function(e){return e.plugins},function(e){return e.mode},function(e){var t;return null==e||null===(t=e.browser)||void 0===t?void 0:t.mobile},function(e){return e.controls},function(e){return(0,d.Rj)(e,f.Ay.getConfigProp("monitorState"))},function(e,t,n,r,o){return{statePluginsConfig:e,mode:F.mode||t||(n?"mobile":"desktop"),pluginsState:r,monitoredState:o}}))(O),M=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),j(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N(e,t)}(t,e),n=t,(r=[{key:"UNSAFE_componentWillMount",value:function(){this.props.loadMapConfig()}},{key:"render",value:function(){return o().createElement(R,{key:"viewer",id:"viewer",className:this.props.className,pluginsConfig:this.props.pluginsConfig||this.props.statePluginsConfig||f.Ay.getConfigProp("plugins"),plugins:this.props.plugins,params:this.props.params,loaderComponent:this.props.loaderComponent,onLoaded:this.props.onLoaded,component:this.props.component||w.A})}}])&&x(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o().Component);k(M,"propTypes",{className:a().string,params:a().object,statePluginsConfig:a().object,pluginsConfig:a().object,loadMapConfig:a().func,plugins:a().object,loaderComponent:a().func,onLoaded:a().func,component:a().any}),k(M,"defaultProps",{mode:"desktop",className:"viewer",loadMapConfig:function(){},onLoaded:function(){}});const U=M},224952(e,t,n){n.d(t,{A:()=>o});var r=n(916589);const o=(0,r.compose)((0,r.withState)("showDetailsSheet","setShowDetailsSheet",!1),(0,r.withState)("editorState","setEditorState"),(0,r.withState)("detailsBackup","setDetailsBackup"),(0,r.withHandlers)({onShowDetailsSheet:function(e){var t=e.setShowDetailsSheet,n=void 0===t?function(){}:t;return function(){return n(!0)}},onHideDetailsSheet:function(e){var t=e.setShowDetailsSheet,n=void 0===t?function(){}:t;return function(){return n(!1)}}}),(0,r.withProps)(function(e){var t,n,r=e.linkedResources,o=void 0===r?{}:r;return{savedDetailsText:"NODATA"===(null==o||null===(t=o.details)||void 0===t?void 0:t.data)||null==o||null===(n=o.details)||void 0===n?void 0:n.data}}))},266437(e,t,n){n.r(t),n.d(t,{contextCreatorSelector:()=>ni,default:()=>ri});var r={};n.r(r),n.d(r,{checkIfContextExists:()=>Be,contextCreatorLoadContext:()=>Me,contextCreatorShowTutorialEpic:()=>Ve,deleteTemplateEpic:()=>Ie,disablePluginsEpic:()=>Je,editPluginEpic:()=>tt,editTemplateEpic:()=>Fe,enableInitialPlugins:()=>Ge,enableMandatoryPluginsEpic:()=>He,enablePluginsEpic:()=>Ke,exportContextEpic:()=>rt,handleUserExtensionsPlugin:()=>Ye,importContextEpic:()=>ot,invalidateContextName:()=>_e,loadMapViewerOnStepChange:()=>ze,loadTemplateEpic:()=>ke,loadTutorialOnStepChange:()=>Ze,mapViewerLoadEpic:()=>qe,mapViewerReload:()=>We,resetConfigOnPluginKeyChange:()=>Xe,resetOnShowDialog:()=>Re,saveContextResource:()=>De,savePluginCfgEpic:()=>nt,saveTemplateEpic:()=>Ne,setValidationStatusOnEditedCfgUpdate:()=>$e,uninstallPluginEpic:()=>Le,updateEditedCfgEpic:()=>Qe,uploadPluginEpic:()=>Ue,validateEditedCfgEpic:()=>et});var o=n(811668),i=n(801081),a=n(779893),l=n(393149),s=n(638560),c=n(747135),u=n(550719),p=n(978632),f=n.n(p),d=n(874295),m=n.n(d),g=n(802401),b=n.n(g),v=n(962028),y=n.n(v),h=n(356513),E=n.n(h),P=n(255435),S=n.n(P),O=n(505275),C=n.n(O),w=n(905185),T=n(909328),x=["data"],j=["plugins","userPlugins","templates","theme","customVariablesEnabled"],A=["type"];function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function N(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function k(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return I(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach(function(t){M(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function M(e,t,n){return(t=function(e){var t=function(e){if("object"!=D(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==D(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var U=[{name:"TOC",label:"List of layers",children:[{name:"TOCItemSettings",label:"Layer settings"},{name:"FeaturesGrid",label:"Attribute Table"}]},{name:"MapTemplates",label:"Map Templates"},{name:"MetadataExplorer",label:"MetadataExplorer"},{name:"Scale",label:"Scale"},{name:"ZoomIn",label:"Zoom In"},{name:"ZoomOut",label:"Zoom Out"}],L=function(e,t,n,r){return e&&e.map(function(e){return R(R({},t.reduce(function(t,n){return t||n===e.name},!1)?(0,w.hZ)(n,r,e):e),{},{children:L(e.children,t,n,r)})})},_=function(e){return b()(e)?e.name:e},B=function(e,t){return e&&e.reduce(function(e,n){return e||t===_(n)&&n||B(n.children,t)},null)},G=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return{name:e.name,title:e.title,description:e.description,version:e.version,docUrl:e.docUrl,glyph:e.glyph,parent:n,mandatory:!!e.mandatory,forcedMandatory:!1,enabledDependentPlugins:[],hidden:!!e.hidden,dependencies:e.dependencies||[],enabled:!1,active:!1,denyUserSelection:e.denyUserSelection||!1,isUserPlugin:!1,isExtension:null!==(t=e.extension)&&void 0!==t&&t,pluginConfig:R(R({override:e.defaultOverride},m().apply(void 0,[y()(o.filter(function(t){return t.name===e.name}))||{},"cfg"].concat(k(e.defaultOverride?["override"]:[])))),{},{name:e.name,cfg:e.defaultConfig}),autoEnableChildren:e.autoEnableChildren||[],children:f()(e,"children",[]).map(function(e){return y()(r.filter(function(t){return t.name===e}))}).filter(function(e){return void 0!==e}).map(function(t){return G(t,e.name,r,o)})}},z=n(45388),Z=n.n(z),V=n(462271),q=n.n(V),W=n(638283),H=n.n(W),K=n(162162),J=n.n(K),X=n(212388),Y=n.n(X),$=n(684157),Q=n.n($),ee=n(325235),te=n.n(ee),ne=n(192779),re=n.n(ne),oe=n(227341),ie=n.n(oe),ae=n(980971),le=n(392347),se=n(233999),ce=n(501719),ue=n(883832),pe=function(e,t,n){return{type:"CHANGE_PRESET",preset:e,presetGroup:t,ignoreDisabled:n}},fe=n(273494),de=n(538704),me=n(622795),ge=n(792744),be=n(995531),ve=n(327229),ye=n(415392),he=n(967858);function Ee(e){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ee(e)}function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach(function(t){Oe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Oe(e,t,n){return(t=function(e){var t=function(e){if("object"!=Ee(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ee(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ee(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ce(e){return function(e){if(Array.isArray(e))return Te(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||we(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function we(e,t){if(e){if("string"==typeof e)return Te(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Te(e,t):void 0}}function Te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var xe=function(e){return 409===e?"contextCreator.saveErrorNotification.conflict":"contextCreator.saveErrorNotification.defaultMessage"},je=function(e){return 403===e?"contextCreator.loadTemplateErrorNotification.forbidden":"contextCreator.loadTemplateErrorNotification.defaultMessage"},Ae=function(e,t){return e&&e.reduce(function(e,n){return e||t===n.name&&n||Ae(n.children,t)},null)},De=function(e,t){return e.ofType(u.oP).exhaustMap(function(e){var n=e.destLocation,r=t.getState(),o=(0,s.oz)(r),i=(0,s.Xj)(r),a=(0,s.p3)(r);return(o&&o.id?me.Uh:me.Zg)(i).switchMap(function(e){return Z().Observable.merge(Z().Observable.of((0,u.Fb)(e),(0,ue.WU)({title:"saveDialog.saveSuccessTitle",message:"saveDialog.saveSuccessMessage",autoDismiss:1})),Z().Observable.defer(function(){return Promise.resolve()}).delay(1e3).switchMap(function(){var e;return(e=Z().Observable).of.apply(e,[(0,u.Lq)(!1,"contextSaving"),(0,ae.VC)(n||"/context/".concat(o.name))].concat(Ce(a?[(0,u.tF)()]:[])))}))}).catch(function(e){var t=e.status,n=e.data;return Z().Observable.of((0,ue.z3)({title:"contextCreator.saveErrorNotification.titleContext",message:xe(t),position:"tc",autoDismiss:5,values:{data:n}}),(0,u.Lq)(!1,"contextSaving"))}).startWith((0,u.Lq)(!0,"contextSaving"))})},Ne=function(e){return e.ofType(u.fc).switchMap(function(e){var t=e.resource;return(t&&t.id?me.Uh:me.Zg)(t).switchMap(function(e){return Z().Observable.of((0,u.g_)(e),(0,u.ui)("uploadTemplate",!1),(0,ue.WU)({title:"saveDialog.saveSuccessTitle",message:"saveDialog.saveSuccessMessage"}))}).let((0,se.TC)((0,u.Lq)(!0,"templateSaving"),(0,u.Lq)(!1,"templateSaving"),function(e,t){var n=e.status,r=e.data;return 404===n&&re()(r)&&r.indexOf("Resource Category not found")>-1?(0,me.zZ)("TEMPLATE").switchMap(function(){return t.skip(1)}).catch(function(){return Z().Observable.of((0,ue.z3)({title:"contextCreator.saveErrorNotification.titleTemplate",message:"contextCreator.saveErrorNotification.categoryError",position:"tc",autoDismiss:5,values:{categoryName:"TEMPLATE"}}))}):Z().Observable.of((0,ue.z3)({title:"contextCreator.saveErrorNotification.titleTemplate",message:xe(n),position:"tc",autoDismiss:5,values:{data:r}}))}))})},ke=function(e){return e.ofType(u.Y$).switchMap(function(e){var t=e.id;return(0,me.hZ)(t,{includeAttributes:!0,withData:!1,withPermissions:!1}).switchMap(function(e){var t=f()(e,"attributes.thumbnail"),n=f()(e,"attributes.format");return Z().Observable.of((0,u.ub)(Se(Se(Se({},e),{},{attributes:Se(Se({},t?{thumbnail:decodeURIComponent(t)}:{}),n?{format:n}:{})},t?{thumbnail:decodeURIComponent(t)}:{}),n?{format:n}:{})))}).let((0,se.TC)((0,u.Lq)(!0,"templateLoading"),(0,u.Lq)(!1,"templateLoading")))})},Ie=function(e,t){return e.ofType(u.FC).switchMap(function(e){var n=e.resource;return(0,me.o8)(n).map(function(){var e=t.getState(),r=(0,s.oH)(e)||[];return(0,u._v)(r.filter(function(e){return e.id!==n.id}))}).let((0,se.TC)((0,u.Lq)(!0,"loading"),(0,u.Lq)(!1,"loading"),function(){return Z().Observable.of((0,ue.z3)({title:"notification.error",message:"contextCreator.configureTemplates.deleteError",autoDismiss:6,position:"tc"}))}))})},Fe=function(e,t){return e.ofType(u.IR).switchMap(function(e){var n=e.id,r=t.getState(),o=E()((0,s.oH)(r),function(e){return e.id===n})||{};return(n?Z().Observable.defer(function(){return le.A.getData(n)}):Z().Observable.of(null)).switchMap(function(e){var t;return(t=Z().Observable).of.apply(t,[(0,u.uY)(n)].concat(Ce(n?[(0,u.kT)("Template Data",e,o.format),(0,u.A4)("accepted")]:[]),[(0,u.ui)("uploadTemplate",!0)]))}).let((0,se.TC)((0,u.Lq)(!0,"templateDataLoading"),(0,u.Lq)(!1,"templateDataLoading"),function(e){var t=e.status;return Z().Observable.of((0,ue.z3)({title:"notification.error",message:je(t),position:"tc",autoDismiss:5}))}))})},Re=function(e,t){return e.ofType(u.xO).flatMap(function(e){var n,r=e.dialogName,o=e.show,i=t.getState(),a=(0,s.bg)(i),l=(0,s.oH)(i)||[];return o?(n=Z().Observable).of.apply(n,Ce("uploadTemplate"!==r||a?[]:[(0,u.A4)(),(0,u.kT)()]).concat(Ce("mapTemplatesConfig"===r?[(0,u.zE)(l.map(function(e){return e.id}),"selected",!1)]:[]))):Z().Observable.empty()})},Me=function(e,t){return e.ofType(u.V0).switchMap(function(e){var n=e.id,r=e.pluginsConfig;return Z().Observable.of((0,u.t9)()).concat(Z().Observable.forkJoin(Z().Observable.defer(function(){return(0,ge.A)(r)}),Z().Observable.defer(function(){return le.A.getResourcesByCategory("TEMPLATE","*",{params:{start:0,limit:1e4,includeAttributes:!0}})}).map(function(e){return 1===e.totalCount?[e.results]:Y()(e.results)}),"new"===n?Z().Observable.of(null):(0,me.hZ)(n)).switchMap(function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||we(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,3),n=t[0],r=t[1],o=t[2];return Z().Observable.of((0,u.Hc)(o,n,r)).concat(Z().Observable.of((0,u.h$)(),(0,u.fW)(),(0,u.C2)("general-settings")))})).let((0,se.TC)((0,u.Lq)(!0,"loading"),(0,u.Lq)(!1,"loading"),function(e){var n="context.errors.context.unknownError";return 403===e.status&&(n="context.errors.context.pleaseLogin",(0,ce.M3)(t.getState())&&(n="context.errors.context.notAccessible")),404===e.status&&(n="context.errors.context.notFound"),Z().Observable.of((0,u.aJ)({error:Se(Se({},e.originalError),{},{message:n})}))}))})},Ue=function(e){return e.ofType(u.Aq).switchMap(function(e){var t=e.files;return Z().Observable.defer(function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rest/config/uploadPlugin";return Promise.all(e.map(function(e){return(0,ve.ue)(e).then(function(e){return be.A.post(t,e,{headers:{"Content-Type":"application/octet-stream"}})})})).then(function(e){return e.map(function(e){return e.data})})}(t.map(function(e){return e.file}))}).switchMap(function(e){return Z().Observable.of((0,u.eH)(e))}).let((0,se.TC)((0,u.R4)(!0,t.map(function(e){return e.name})),(0,u.R4)(!1,t.map(function(e){return e.name})),function(e){return Z().Observable.of((0,u.zw)(t,e))}))})},Le=function(e){return e.ofType(u.x4).switchMap(function(e){var t=e.plugin;return Z().Observable.defer(function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rest/config/uninstallPlugin";return be.A.delete(t+"/"+e).then(function(e){return e.data})}(t)}).switchMap(function(e){return Z().Observable.of((0,u.zD)(t,e),(0,u.ui)("confirmRemovePlugin",!1))}).let((0,se.TC)((0,u.qM)(!0,t),(0,u.qM)(!1,t),function(){return Z().Observable.of((0,ue.z3)({title:"notification.error",message:"context.errors.plugins.uninstall",autoDismiss:6,position:"tc"}))}))})},_e=function(e,t){return e.ofType(u.Gj).filter(function(e){return"name"===e.key}).switchMap(function(){var e=t.getState(),n=(0,s.hm)(e);return n||void 0===n?Z().Observable.of((0,u.sf)(!1)):Z().Observable.empty()})},Be=function(e,t){return e.ofType(u.Gj).filter(function(e){return"name"===e.key}).debounceTime(500).switchMap(function(){var e=t.getState(),n=(0,s.oz)(e),r=n&&n.name;return(r?Z().Observable.defer(function(){return le.A.searchListByAttributes({AND:{FIELD:{field:["NAME"],operator:["EQUAL_TO"],value:[r]}}})}).switchMap(function(e){var t=e.ExtResourceList,r=t.Resource,o=t.ResourceCount;return f()(r,"id")!==f()(n,"id")&&o>0?Z().Observable.of((0,ue.z3)({title:"contextCreator.contextNameErrorNotification.title",message:"contextCreator.saveErrorNotification.conflict",position:"tc",autoDismiss:5}),(0,u.tf)(!1)):Z().Observable.of((0,u.tf)(!0))}).let((0,se.TC)((0,u.Lq)(!0,"contextNameCheck"),(0,u.Lq)(!1,"contextNameCheck"),function(){return Z().Observable.of((0,ue.z3)({title:"contextCreator.contextNameErrorNotification.title",message:"contextCreator.contextNameErrorNotification.unknownError",position:"tc",autoDismiss:5}))})):Z().Observable.empty()).concat(Z().Observable.of((0,u.sf)(!0)))})},Ge=function(e,t){return e.ofType(u.sb).switchMap(function(){var e=t.getState(),n=(0,s.ZE)(e);return n&&n.length>0?Z().Observable.of((0,u.Uk)(n,!0)):Z().Observable.empty()})},ze=function(e){return e.ofType(u.YF).filter(function(e){return"configure-map"===e.stepId}).switchMap(function(){return Z().Observable.of((0,u.v6)())})},Ze=function(e,t){return e.ofType(u.YF).switchMap(function(e){var n=e.stepId,r=(0,s.b7)(t.getState())||{};return(0,s.IP)(n)(t.getState())?Z().Observable.empty():Z().Observable.of(pe(r[n],Y()(r)),(0,u.NX)(n))})},Ve=function(e,t){return e.ofType(u.dn).switchMap(function(e){var n=e.stepId,r=(0,s.b7)(t.getState())||{};return Z().Observable.of((0,u.RB)(),pe(r[n],Y()(r),!0))})},qe=function(e,t){return e.ofType(u.zh).switchMap(function(){var e=t.getState(),n=(0,s.Le)(e),r=(0,s.om)(e),o=a.Ay.getConfigUrl({mapId:"new",config:null}).configUrl;return n?Z().Observable.empty():Z().Observable.merge(Z().Observable.of((0,fe.vU)(!0),(0,de.De)(o,null,te()(r),void 0,{}),(0,u.q1)(!0)))})},We=function(e,t){return e.ofType(u.sN).switchMap(function(){var e=t.getState();return"configure-map"!==(0,s.hl)(e)?Z().Observable.empty():Z().Observable.of((0,u.q1)(!1),(0,u.v6)())})},He=function(e,t){return e.ofType(u.BS).switchMap(function(){var e=t.getState(),n=(0,s.yj)(e);return Z().Observable.of((0,u.Uk)(n.filter(function(e){return e.mandatory}).map(function(e){return e.name})))})},Ke=function(e,t){return e.ofType(u.N6).switchMap(function(e){var n,r=e.plugins,o=e.isInitial,i=t.getState(),a=(0,s.yj)(i),l={},c=[],p=[],f=function(e){var t=function(e,t){t.children.forEach(function(e){e.mandatory&&f(e.name)}),o||t.mandatory||t.autoEnableChildren.forEach(function(t){e(null,Ae(a,t),!0)})},n=function(e,r){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!r.mandatory){var i=r.enabled||c.reduce(function(e,t){return e||t===r.name},!1);e&&!o&&(l[r.name]||(l[r.name]=r.enabledDependentPlugins.slice()),l[r.name].push(e)),r.forcedMandatory||p.reduce(function(e,t){return e||t===r.name},!1)||(o||p.push(r.name),i||c.push(r.name),r.dependencies.forEach(function(e){n(r.name,Ae(a,e))}),i||t(n,r))}},r=Ae(a,e);!r.enabled&&c.reduce(function(t,n){return t&&n!==e},!0)&&(c.push(e),r.dependencies.forEach(function(t){n(e,Ae(a,t))}),t(n,r))};return r.forEach(function(e){f(e)}),(n=Z().Observable).of.apply(n,[(0,u.I6)(c,"enabled",!0)].concat(Ce(o?[]:[(0,u.I6)(C()([].concat(c,p)),"isUserPlugin",!1)]),[(0,u.I6)(p,"forcedMandatory",!0)],Ce(J()(l).map(function(e){return(0,u.I6)([e],"enabledDependentPlugins",C()(l[e]))}))))})},Je=function(e,t){return e.ofType(u.QV).switchMap(function(e){var n=e.plugins,r=t.getState(),o=(0,s.yj)(r),i=(0,T.S$)(o).map(function(e){return e.name}),a=o.map(function(e){return e.name}),l=o.filter(function(e){return e.enabled&&!e.mandatory&&!e.forcedMandatory}).length;if(H()(n,a).length<l){var c,p={},f=[],d=[],m=function(e,t){var n=Ae(o,e);0!==(p[n.name]||n.enabledDependentPlugins.slice()).length||!f.reduce(function(e,t){return e&&t!==n.name},!0)||n.mandatory&&!t||(f.push(n.name),n.dependencies.forEach(function(t){!function(e,t){var n=p[t.name]||t.enabledDependentPlugins.slice(),r=Q()(n,function(t){return t===e});r>-1&&(p[t.name]||(p[t.name]=n),p[t.name].splice(r,1)),p[t.name]&&0!==p[t.name].length||!f.reduce(function(e,n){return e&&n!==t.name},!0)||(d.push(t.name),t.mandatory||m(t.name))}(e,Ae(o,t))}),n.children.filter(function(e){return e.enabled}).forEach(function(e){m(e.name,!0)}))};return n.forEach(function(e){m(e)}),(c=Z().Observable).of.apply(c,[(0,u.I6)(f,"enabled",!1)].concat(Ce(J()(p).map(function(e){return(0,u.I6)([e],"enabledDependentPlugins",p[e])})),[(0,u.I6)(C()(d),"forcedMandatory",!1)]))}return Z().Observable.of((0,u.I6)(i,"enabled",!1),(0,u.I6)(i,"enabledDependentPlugins",[]),(0,u.I6)(i,"forcedMandatory",!1),(0,u.h$)())})},Xe=function(e,t){return e.ofType(u.aP).switchMap(function(e){var n=e.ids,r=e.key,o=e.value,i=t.getState(),a=(0,s.ir)(i),l=(0,s.yj)(i);if("enabled"===r&&!1===o){var c=function(e){return e.reduce(function(e,t){return e||a===t.name||c(t.children)},!1)};return c(n.map(function(e){return y()(l.filter(function(t){return t.name===e}))}).filter(function(e){return!!e}))?Z().Observable.of((0,u.Jh)(),(0,u.pY)()):Z().Observable.empty()}return Z().Observable.empty()})},Ye=function(e,t){return e.ofType(u.aP).filter(function(e){var t=e.key;return"enabled"===t||"isUserPlugin"===t}).mergeMap(function(){var e=t.getState(),n=(0,T.S$)((0,s.yj)(e)),r=n.filter(function(e){var t=e.name,n=e.enabled,r=e.isUserPlugin;return"UserExtensions"!==t&&n&&r}).length,o=(E()(n,function(e){return"UserExtensions"===e.name})||{}).enabled,i=r>0&&!o?u.Uk:0===r&&o?u.ti:null;return i?Z().Observable.of(i(["UserExtensions"])):Z().Observable.empty()})},$e=function(e,t){return e.ofType(u.DN).mergeMap(function(){var e=t.getState();return(0,s.po)(e)?Z().Observable.of((0,u.ME)(!1)):Z().Observable.empty()})},Qe=function(e){return e.ofType(u.DN).debounceTime(500).switchMap(function(){return Z().Observable.of((0,u.sp)(),(0,u.JR)(),(0,u.ME)(!0))})},et=function(e,t){return e.ofType(u.Wm).switchMap(function(){var e=t.getState(),n=(0,s.BT)(e);if(n)try{var r=q().parse(n);return Z().Observable.of((0,u.K0)(r),(0,u.Jh)())}catch(e){return Z().Observable.of((0,u.Jh)({message:e.message,lineNumber:function(e){var t=e.message.match(/line ([0-9]*)/);return t&&t.length>1?+t[1]:void 0}(e)}))}return Z().Observable.empty()})},tt=function(e,t){return e.ofType(u.jX).switchMap(function(e){var n=e.pluginName,r=t.getState(),o=(0,s.ir)(r),i=(0,s.E5)(r),a=(0,s.po)(r)||!1;return!i&&a?Z().Observable.of((0,u.pY)(n),(0,u.cJ)(n)):i?Z().Observable.of((0,ue.z3)({title:"contextCreator.configurePlugins.saveCfgErrorNotification.title",message:"contextCreator.configurePlugins.saveCfgErrorNotification.message",position:"tc",autoDismiss:5,values:{pluginName:o}})):Z().Observable.empty()})},nt=function(e,t){return e.ofType(u.$M).switchMap(function(){var e=t.getState(),n=(0,s.ir)(e),r=(0,s.jG)(e),o=(0,s.E5)(e);return n&&r&&!o?Z().Observable.of((0,u.I6)([n],"pluginConfig.cfg",r.cfg),(0,u.I6)([n],"pluginConfig.override",r.override)):Z().Observable.empty()})},rt=function(e,t){var n=t.getState;return e.ofType(u.RZ).switchMap(function(e){var t=e.fileName,r=(0,s.M4)(n()),o=(0,s.Xj)(n()).data,i=Se(Se({},o),{},{mapConfig:ie()(null==o?void 0:o.mapConfig)?f()(r,"resource.data.mapConfig",{}):o.mapConfig});return Z().Observable.of([JSON.stringify(Se({},i)),t,"application/json"]).do(function(e){return ve.RG.apply(void 0,Ce(e))}).map(function(){return(0,ye.KP)(he.d)}).catch(function(){return Z().Observable.of((0,ue.z3)({title:"contextCreator.errors.loading.title",message:"contextCreator.errors.loading.export"}))})})},ot=function(e,t){return e.ofType(u.sD).switchMap(function(e){var n=e.file;return Z().Observable.defer(function(){return(0,ve.Vh)(n[0]).then(function(e){return e})}).switchMap(function(e){var n=(0,s.M4)(t.getState()),r=S()(n,["pluginsConfig","allTemplates"]),o=r.pluginsConfig,i=r.allTemplates,a=S()((0,s.oz)(t.getState()),["id","name"]),l=Se({data:Se({},e)},a);return Z().Observable.of((0,u.Hc)(l,o,i),(0,ye.KP)("import")).concat(Z().Observable.of((0,u.h$)(),(0,u.fW)(),(0,u.q1)(!1)))}).catch(function(){return Z().Observable.of((0,ue.z3)({title:"contextCreator.errors.loading.title",message:"contextCreator.errors.loading.import"}))})})},it=n(273517),at=n.n(it),lt=n(605556),st=n.n(lt),ct=n(8117),ut=n(711030),pt=n(8571),ft=n(154150),dt=n(534332),mt=n(406250);const gt=function(e){var t=e.style,n=e.showConfirm,r=void 0!==n&&n,o=e.onShowConfirm,i=void 0===o?function(){}:o,a=e.onConfirm,l=void 0===a?function(){}:a,s=e.onClose,c=void 0===s?function(){}:s,u=e.onClick,p=void 0===u?function(){}:u,f=e.className,d=void 0===f?"":f,m=e.title,g=e.confirmMessage,b=e.bsStyle,v=void 0===b?"default":b,y=e.bsSize,h=void 0===y?"sm":y;return at().createElement(at().Fragment,null,at().createElement(ut.A,{style:t,bsSize:h,bsStyle:v,className:d,onClick:p},m),g&&at().createElement(mt.A,null,at().createElement(dt.A,{show:r,onCancel:function(){c(),i(!1)},onConfirm:function(){l(),i(!1)},titleId:g,preventHide:!0,variant:"danger",confirmId:"confirm",cancelId:"cancel"})))};var bt=n(275705);const vt=function(e){var t=e.loading,n=void 0!==t&&t,r=e.steps,o=void 0===r?[]:r,i=e.hideNamesExceptCurrent,a=void 0!==i&&i,l=e.currentStepId,s=e.onSetStep,c=void 0===s?function(){}:s,u=e.onSave,p=void 0===u?function(){}:u,f=e.onShowBackToPageConfirmation,d=void 0===f?function(){}:f,m=e.showBackToPageConfirmation,g=void 0!==m&&m,b=e.backToPageConfirmationMessage,v=void 0===b?"contextCreator.undo":b,y=e.onConfirmBackToPage,h=void 0===y?function(){}:y,E=e.enableClickOnStep,P=void 0!==E&&E,S=e.hideSaveButton,O=e.hideCloseButton,C=o.findIndex(function(e){return e.id===l}),w=S&&C===o.length-1,T=C>-1?at().createElement("div",{className:"ms2-stepper"},at().createElement("div",{className:"footer-button-toolbar-div"},at().createElement(ct._O,{className:"footer-button-toolbar-extra"},(o[C].extraToolbarButtons||[]).map(function(e,t){var n=e.component,r=e.onClick,o=void 0===r?function(){}:r,i=e.label,a=e.id;return n?at().createElement(n,null):at().createElement(ut.A,{key:a||i||t,bsStyle:"primary",bsSize:"sm",onClick:o},at().createElement(pt.A,{msgId:i}))})),at().createElement(ct._O,{className:"footer-button-toolbar"},!w&&at().createElement(ut.A,{bsStyle:"primary",bsSize:"sm",disabled:o[C].disableNext||n,onClick:function(){return C<o.length-1?c(o[C+1].id):p()}},at().createElement(pt.A,{msgId:C<o.length-1?"stepper.next":"save"})),at().createElement(ut.A,{style:{height:"100%"},bsSize:"sm",className:"no-border",disabled:0===C||n,onClick:function(){return c(o[C-1].id)}},at().createElement(pt.A,{msgId:"stepper.back"})),!O&&at().createElement(gt,{style:{height:"100%"},className:"no-border",title:n?at().createElement(bt.A,{size:14}):at().createElement(pt.A,{msgId:"close"}),showConfirm:g,onShowConfirm:d,onConfirm:h,onClick:function(){return d(!0)},confirmMessage:v}))),at().createElement("div",{className:"footer-step-bar"},o.map(function(e,t){var n=at().createElement(pt.A,{msgId:e.label});return at().createElement(at().Fragment,null,t>0&&at().createElement("div",{key:"line"+e.id,style:{flex:1,display:"flex",alignItems:"center"}},at().createElement("div",{style:{backgroundColor:t<=C?"#777":"#ddd",height:1,width:"100%"}})),at().createElement("div",{key:"label"+e.id,style:{padding:8,display:"flex",alignItems:"center",cursor:P?"pointer":"default"},onClick:function(){return P&&c(e.id)},role:"button",tabIndex:"0",onKeyDown:function(t){return(" "===t.key||"Enter"===t.key||"Spacebar"===t.key)&&P&&c(e.id)}},at().createElement(ct.JU,{bsStyle:t===C?"success":"primary",style:t<=C?{}:{backgroundColor:"#aaa"}},t+1),(!a||t===C)&&at().createElement("span",{style:{padding:8}},t===C?at().createElement("strong",null,n):n)))}))):null;return C>-1?at().createElement(ft.A,{className:"ms-stepper-container",footer:1===(null==o?void 0:o.length)?null:T},o[C].component):null};var yt=n(750042),ht=n.n(yt),Et=n(628017);const Pt=function(e){var t=e.contextId,n=e.contextName,r=void 0===n?"":n,o=e.windowTitle,i=void 0===o?"":o,a=e.isValidContextName,l=void 0===a||a,s=e.contextNameChecked,c=void 0===s||s,u=e.loading,p=void 0!==u&&u,f=e.onChange,d=void 0===f?function(){}:f,m=e.context,g=void 0===m?{}:m;return at().createElement("div",{className:"general-settings-step"},at().createElement("div",{style:{margin:"auto"}},at().createElement("div",{className:"text-center"},at().createElement(ct.e6,{glyph:"wrench",style:{fontSize:128}})),at().createElement("h1",{className:"text-center"},"new"===t?at().createElement(pt.A,{msgId:"contextCreator.generalSettings.title"}):at().createElement(pt.A,{msgId:"contextCreator.generalSettings.edit"})),at().createElement(ct.gE,{validationState:r.length>0&&c?l?"success":"error":null},at().createElement(ct.mq,null,at().createElement(pt.A,{msgId:"contextCreator.generalSettings.name"}),p?at().createElement(ht(),{spinnerName:"circle",noFadeIn:!0,overrideSpinnerClassName:"spinner"}):null),at().createElement(ct.MJ,{type:"text",value:r,placeholder:(0,Et.kA)(g.messages,"contextCreator.generalSettings.namePlaceholder"),onChange:function(e){return d("name",e.target.value&&e.target.value.replace(/[^a-zA-Z0-9\-_]/g,""))}})),at().createElement(ct.gE,{validationState:i.length>0?"success":null},at().createElement(ct.mq,null,at().createElement(pt.A,{msgId:"contextCreator.generalSettings.windowTitle"})),at().createElement(ct.MJ,{type:"text",value:i,placeholder:(0,Et.kA)(g.messages,"contextCreator.generalSettings.windowTitlePlaceholder"),onChange:function(e){return d("windowTitle",e.target.value)}}))))};var St=n(916589),Ot=n(237811),Ct=n(347837),wt=n(256951),Tt=n(724183),xt=n(563864),jt=n(306840);function At(e){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},At(e)}function Dt(){return Dt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Dt.apply(null,arguments)}function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach(function(t){It(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function It(e,t,n){return(t=function(e){var t=function(e){if("object"!=At(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=At(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==At(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Rt=function(e){var t=e.items,n=void 0===t?[]:t,r=e.side,o=e.selectedItems,i=void 0===o?[]:o,a=e.selectedSide,l=e.allowCtrlMultiSelect,s=void 0!==l&&l,c=e.onSelect,u=void 0===c?function(){}:c,p=e.isRoot,f=void 0===p||p;return at().createElement("div",{className:"ms2-transfer-sidegrid"},n.map(function(e,t){var o=e.id&&i.reduce(function(t,n){return t||n.id===e.id},!1);return at().createElement(Tt.A,Dt({onClick:function(t,n){return f?u(o?i.filter(function(t){return t.id!==e.id}):s&&n.ctrlKey&&r===a?[].concat(function(e){return function(e){if(Array.isArray(e))return Ft(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ft(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ft(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i),[e]):[e],r):{}}},e,{key:e.id||t,size:e.cardSize,className:(e.className?"".concat(e.className," "):" ")+(t===n.length-1?"ms2-transfer-lastcard":""),selected:null!=o?o:e.selected,tools:e.tools&&e.tools.length>0?at().createElement(wt.A,{buttons:e.tools.map(function(e){return kt(kt({},e),{},{className:"square-button no-border",onClick:function(t){t.stopPropagation(),e.onClick&&e.onClick()}})})}):void 0,preview:e.preview,description:e.showDescriptionTooltip&&e.description?at().createElement(jt.A,{delayShow:e.descriptionTooltipDelay,placement:"top",overlay:at().createElement(ct.m_,{id:e.id},e.description)},at().createElement("span",null,e.description)):e.description,body:at().createElement("div",{className:"ms2-transfer-body-container"},e.component&&at().createElement("div",{className:"ms2-transfer-bodycomponent-container",onClick:function(e){return e.stopPropagation()}},e.component),e.children&&at().createElement("div",{className:"ms2-transfer-children-container"},at().createElement(Rt,{items:e.children,side:r,selectedItems:i,selectedSide:a,allowCtrlMultiSelect:s,onSelect:u,isRoot:!1})))}))}))};const Mt=(0,xt.A)(function(e){var t=e.items;return!(void 0===t?[]:t).length},function(e){return e.emptyStateProps})(Rt);function Ut(e){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ut(e)}var Lt=["title","description","children"];function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach(function(t){Gt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Gt(e,t,n){return(t=function(e){var t=function(e){if("object"!=Ut(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ut(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zt=function(e,t){var n=t.title,r=t.description,o=t.children;return Bt(Bt({},function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,Lt)),{},{title:n&&(0,Et.kA)(e,n),description:r&&(0,Et.kA)(e,r),children:o&&o.map(function(t){return zt(e,t)})})},Zt=function(e,t,n,r,o,i,a,l,s,c){var u=r.items,p=void 0===u?[]:u,f=r.title,d=void 0===f?"":f,m=r.filterText,g=void 0===m?"":m,b=r.filterPlaceholder,v=void 0===b?"":b,y=r.tools,h=void 0===y?[]:y,E=r.emptyStateProps,P=void 0===E?{}:E,S=r.emptyStateSearchProps,O=void 0===S?{}:S,C=r.onFilter,w=void 0===C?function(){}:C;return at().createElement("div",{className:"ms2-transfer-subpanel ms2-transfer-".concat(n)},at().createElement("div",{className:"ms2-transfer-header"},at().createElement("div",{className:"ms2-transfer-title-area"},at().createElement("h4",null,at().createElement(pt.A,{msgId:d}),function(e){return at().createElement(wt.A,{btnDefaultProps:{className:"square-button",bsStyle:"primary"},buttons:e})}(h))),at().createElement(Ct.A,{filterText:g,filterPlaceholder:(0,Et.kA)(t,v),onFilter:w})),at().createElement(Mt,{items:s(c(g,p.map(function(n){return e?zt(t,n):n}))),emptyStateProps:zt(t,p.length>0&&g.length>0?O:P),side:n,selectedItems:i,selectedSide:a,allowCtrlMultiSelect:o,messages:t,onSelect:l}))},Vt=function(e,t){var n=e.localizeItems,r=void 0!==n&&n,o=e.leftColumn,i=void 0===o?{}:o,a=e.rightColumn,l=void 0===a?{}:a,s=e.allowCtrlMultiSelect,c=void 0!==s&&s,u=e.selectedItems,p=void 0===u?[]:u,f=e.selectedSide,d=e.className,m=e.filter,g=void 0===m?function(e,t){return t}:m,b=e.sortStrategy,v=void 0===b?function(e){return e}:b,y=e.onSelect,h=void 0===y?function(){}:y,E=e.onTransfer,P=void 0===E?function(){}:E,S=e.moveButtons,O=void 0===S?[{id:"all-right",label:">>",disabled:!i.items||(i.emptyTest?i.emptyTest(i.items):!i.items.length),onClick:function(){P(i.items,"right"),h([])}},{id:"right",label:">",disabled:"left"!==f||!p||!p.length,onClick:function(){P(p,"right"),h([])}},{id:"left",label:"<",disabled:"right"!==f||!p||!p.length,onClick:function(){P(p,"left"),h([])}},{id:"all-left",label:"<<",disabled:!l.items||(l.emptyTest?l.emptyTest(l.items):!l.items.length),onClick:function(){P(l.items,"left"),h([])}}]:S;return at().createElement("div",{className:"ms2-transfer".concat(d?" "+d:"")},Zt(r,t.messages,"left",i,c,p,f,h,v,g),function(e){return at().createElement(ct.e2,{vertical:!0},e.map(function(e,t){var n=e.id,r=e.label,o=e.onClick,i=void 0===o?function(){}:o,a=e.disabled;return at().createElement(ut.A,{key:n||t,bsStyle:"primary",className:"square-button",disabled:a,onClick:i},r)}))}(O),Zt(r,t.messages,"right",l,c,p,f,h,v,g))};Vt.contextTypes={messages:st().object};const qt=Vt;var Wt=n(229710),Ht=n(892509),Kt=n(564116),Jt=n(809136),Xt=n.n(Jt);const Yt=(0,St.compose)((0,St.withState)("newGroup","onNewGroupChoose"),(0,St.withState)("newPermission","onNewPermissionChoose"));var $t={FORMAT:"map.errorFormat",SIZE:"map.errorSize",409:"dashboard.errors.resourceAlreadyExists",403:"dashboard.errors.forbidden",405:"dashboard.errors.forbidden405"},Qt=function(e){return"string"==typeof e?e:e.statusText||e.message},en=function(e){return"string"==typeof e?void 0:e};const tn=function(e){var t=e.errors,n=void 0===t?[]:t;return at().createElement(ct.fI,null,n.length>0?at().createElement("div",{className:"dropzone-errorBox alert-danger"},n.map(function(e){return at().createElement("div",{key:"error"+Qt(e),className:"error"+Qt(e)},function(e){var t,n="string"==typeof(t=e)?t:t.status;return at().createElement(pt.A,{msgId:$t[n]||Qt(e),msgParams:en(e)})}(e))})):null)};var nn=n(541033),rn=n.n(nn),on=n(618093),an=n.n(on);const ln=function(e){var t=e.acceptedFileName,n=e.label,r=e.status,o=void 0===r?"clear":r,i=e.errorMessage,a=e.clearMessage,l=e.onDrop,s=void 0===l?function(){}:l,c=e.onClear,u=void 0===c?function(){}:c,p=e.onError,f=void 0===p?function(){}:p;return at().createElement("div",{className:"dropzone-filedrop-container"},at().createElement("label",{className:"control-label"},at().createElement(pt.A,{msgId:n})),at().createElement(an(),{multiple:!1,className:"dropzone alert alert-info".concat("accepted"===o?" filedrop-accepted":""),rejectClassName:"alert-danger",onDrop:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(void 0,[f].concat(t))}},"accepted"===o&&at().createElement("div",{className:"dropzone-filedrop-remove",onClick:function(e){e.stopPropagation(),u()}},at().createElement(ct.e6,{glyph:"remove"})),at().createElement("div",{className:"dropzone-content"},at().createElement(ct.e6,{glyph:"clear"===o?"upload":"accepted"===o?"ok-circle":"remove-circle"}),"accepted"===o?at().createElement("span",null,t):null,"rejected"===o?i:null,"clear"===o?a:null)))};var sn=n(795093),cn=n.n(sn),un=n(551783);function pn(e){return pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pn(e)}function fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,yn(r.key),r)}}function dn(e,t,n){return t=gn(t),function(e,t){if(t&&("object"==pn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,mn()?Reflect.construct(t,n||[],gn(e).constructor):t.apply(e,n))}function mn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(mn=function(){return!!e})()}function gn(e){return gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gn(e)}function bn(e,t){return bn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bn(e,t)}function vn(e,t,n){return(t=yn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yn(e){var t=function(e){if("object"!=pn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=pn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==pn(t)?t:t+""}var hn=(0,un.A)("placeholder")(ct.MJ),En=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return vn(e=dn(this,t,[].concat(r)),"renderDate",function(t){if(!t)return"";var n=a.Ay.getConfigProp("forceDateFormat"),r=a.Ay.getConfigProp("forceTimeFormat"),o=n?cn()(t).format(n):e.context.intl?e.context.intl.formatDate(t):"",i=r?cn()(t).format(r):e.context.intl?e.context.intl.formatTime(t):"";return"".concat(o," ").concat(i)||""}),vn(e,"changeName",function(t){e.props.onChange("metadata.name",e.props.nameFieldFilter(t.target.value)||t.target.value)}),vn(e,"changeDescription",function(t){e.props.onChange("metadata.description",t.target.value)}),vn(e,"changeTitle",function(t){e.props.onChange("attributes.title",t.target.value)}),vn(e,"changeAdvertised",function(t){e.props.onChange("metadata.advertised",!t.target.checked)}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bn(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e,t=f()(this.props.resource,"attributes.title","");return at().createElement("form",{ref:"metadataForm",onSubmit:this.handleSubmit},at().createElement(ct.gE,null,at().createElement(ct.mq,null,this.props.nameFieldText),at().createElement(hn,{key:"mapName",type:"text",onChange:this.changeName,disabled:this.props.resource.saving,placeholder:this.props.namePlaceholderText,defaultValue:this.props.resource?this.props.resource.name:"",value:this.props.resource&&this.props.resource.metadata&&this.props.resource.metadata.name||""})),!!t&&at().createElement(ct.gE,null,at().createElement(ct.mq,null,this.props.titleFieldText),at().createElement(hn,{key:"mapTitle",type:"text",onChange:this.changeTitle,disabled:this.props.resource.saving,placeholder:this.props.titlePlaceholderText,defaultValue:t,value:t})),at().createElement(ct.gE,null,at().createElement(ct.mq,null,this.props.descriptionFieldText),at().createElement(hn,{key:"mapDescription",type:"text",onChange:this.changeDescription,disabled:this.props.resource.saving,placeholder:this.props.descriptionPlaceholderText,defaultValue:this.props.resource?this.props.resource.description:"",value:this.props.resource&&this.props.resource.metadata&&this.props.resource.metadata.description||""})),this.props.resource&&this.props.resource.creator&&at().createElement(ct.gE,null,at().createElement(ct.mq,null,this.props.creatorFieldText),at().createElement(ct.mq,null,this.props.resource.creator)),this.props.resource&&this.props.resource.createdAt&&at().createElement(ct.gE,null,at().createElement(ct.mq,null,this.props.createdAtFieldText),at().createElement(ct.mq,null,this.props.resource&&this.renderDate(this.props.resource.createdAt)||"")),this.props.resource&&this.props.resource.editor&&at().createElement(ct.gE,null,at().createElement(ct.mq,null,this.props.editorFieldText),at().createElement(ct.mq,null,this.props.resource.editor)),this.props.resource&&this.props.resource.createdAt&&at().createElement(ct.gE,null,at().createElement(ct.mq,null,this.props.modifiedAtFieldText),at().createElement(ct.mq,null,this.props.resource&&this.renderDate(this.props.resource.modifiedAt||this.props.resource.createdAt)||"")),at().createElement(ct.gE,null,at().createElement(ct.mq,null,this.props.unadvertisedText),at().createElement(ct.Sc,{checked:!(null!==(e=this.props.resource)&&void 0!==e&&null!==(e=e.metadata)&&void 0!==e&&e.advertised),onChange:this.changeAdvertised,"aria-label":"advertisedResource"})))}}])&&fn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(at().Component);vn(En,"propTypes",{resource:st().object,onChange:st().func,nameFieldText:st().node,titleFieldText:st().node,descriptionFieldText:st().node,nameFieldFilter:st().func,namePlaceholderText:st().string,descriptionPlaceholderText:st().string,titlePlaceholderText:st().string,createdAtFieldText:st().string,modifiedAtFieldText:st().string,unadvertisedText:st().string,creatorFieldText:st().string,editorFieldText:st().string}),vn(En,"contextTypes",{intl:st().object}),vn(En,"defaultProps",{onChange:function(){},resource:{},nameFieldText:"Name",descriptionFieldText:"Description",nameFieldFilter:function(){},namePlaceholderText:"Map Name",descriptionPlaceholderText:"Map Description",unadvertisedText:"Unadvertised",creatorFieldText:"Creator",editorFieldText:"Editor"});const Pn=En;var Sn=n(750354);function On(e){return On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},On(e)}function Cn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Dn(r.key),r)}}function wn(e,t,n){return t=xn(t),function(e,t){if(t&&("object"==On(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Tn()?Reflect.construct(t,n||[],xn(e).constructor):t.apply(e,n))}function Tn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Tn=function(){return!!e})()}function xn(e){return xn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xn(e)}function jn(e,t){return jn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},jn(e,t)}function An(e,t,n){return(t=Dn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dn(e){var t=function(e){if("object"!=On(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=On(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==On(t)?t:t+""}var Nn=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return An(e=wn(this,t,[].concat(r)),"state",{}),An(e,"getThumbnailUrl",function(){return e.props.thumbnail&&"NODATA"!==e.props.thumbnail?decodeURIComponent(e.props.thumbnail):null}),An(e,"getDataUri",function(e,t){var n=e;if(n&&n.length>0){var r=n[0],o=new FileReader;return o.onload=function(e){return t(e.target.result)},o.readAsDataURL(r)}return t(null)}),An(e,"getThumbnailDataUri",function(t){e.getDataUri(e.files,t)}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jn(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this;return at().createElement(Sn.A,{thumbnail:this.getThumbnailUrl(),className:null,dropZoneProps:{className:"dropzone alert alert-info",rejectClassName:"alert-danger"},loading:this.props.loading,message:at().createElement(at().Fragment,null,this.props.message,at().createElement("br",null),this.props.suggestion),maxFileSize:this.props.maxFileSize,style:{pointerEvents:this.props.resource.saving?"none":"auto"},label:at().createElement("label",{className:"control-label"},at().createElement(pt.A,{msgId:"map.thumbnail"})),onUpdate:function(t,n){var r;e.props.onError([],e.props.resource.id),e.files=n,e.props.onUpdate(t,null==n||null===(r=n[0])||void 0===r?void 0:r.preview)},onError:function(t,n){e.props.onError(t,e.props.resource.id),e.files=n},onRemove:function(){e.files=null,e.props.onUpdate(null,null),e.props.onRemove(),e.props.onError([],e.props.resource.id)}})}}])&&Cn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(at().Component);An(Nn,"propTypes",{glyphiconRemove:st().string,style:st().object,loading:st().bool,resource:st().object,thumbnail:st().string,onError:st().func,onUpdate:st().func,onRemove:st().func,maxFileSize:st().number,message:st().oneOfType([st().string,st().element]),suggestion:st().oneOfType([st().string,st().element])}),An(Nn,"contextTypes",{messages:st().object}),An(Nn,"defaultProps",{loading:!1,glyphiconRemove:"trash",resource:{},onError:function(){},onUpdate:function(){},onSaveAll:function(){},onRemove:function(){},message:at().createElement(pt.A,{msgId:"map.message"}),suggestion:at().createElement(pt.A,{msgId:"map.suggestion"}),maxFileSize:5e5});const kn=Nn;function In(e){return In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},In(e)}function Fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Rn(r.key),r)}}function Rn(e){var t=function(e){if("object"!=In(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=In(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==In(t)?t:t+""}function Mn(e,t,n){return t=Ln(t),function(e,t){if(t&&("object"==In(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Un()?Reflect.construct(t,n||[],Ln(e).constructor):t.apply(e,n))}function Un(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Un=function(){return!!e})()}function Ln(e){return Ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ln(e)}function _n(e,t){return _n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_n(e,t)}var Bn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Mn(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_n(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.resource,n=e.linkedResources,r=void 0===n?{}:n,o=e.enableFileDrop,i=void 0!==o&&o,a=e.acceptedDropFileName,l=e.fileDropLabel,s=e.fileDropStatus,c=e.fileDropErrorMessage,u=e.fileDropClearMessage,p=e.onFileDrop,f=void 0===p?function(){}:p,d=e.onFileDropClear,m=void 0===d?function(){}:d,g=e.onError,b=void 0===g?function(){}:g,v=e.onUpdate,y=void 0===v?function(){}:v,h=e.nameFieldFilter,E=void 0===h?function(){}:h,P=e.onUpdateLinkedResource,S=void 0===P?function(){}:P;return at().createElement(ct.fI,null,i&&at().createElement(ct.fv,{xs:12},at().createElement(ln,{acceptedFileName:a,label:l,status:s,errorMessage:c,clearMessage:u,onDrop:f,onClear:m,onError:b})),at().createElement(ct.fv,{xs:12},at().createElement(kn,{resource:t,thumbnail:r&&r.thumbnail&&r.thumbnail.data||t&&t.attributes&&t.attributes.thumbnail,onError:b,onRemove:function(){return S("thumbnail","NODATA","THUMBNAIL",{tail:"/raw?decode=datauri&v=".concat(rn()())})},onUpdate:function(e){return S("thumbnail",e||"NODATA","THUMBNAIL",{tail:"/raw?decode=datauri&v=".concat(rn()())})}})),at().createElement(ct.fv,{xs:12},at().createElement(Pn,{role:"body",ref:"mapMetadataForm",onChange:y,resource:t,nameFieldText:at().createElement(pt.A,{msgId:"saveDialog.name"}),titleFieldText:at().createElement(pt.A,{msgId:"saveDialog.titleInput"}),descriptionFieldText:at().createElement(pt.A,{msgId:"saveDialog.description"}),nameFieldFilter:E,createdAtFieldText:at().createElement(pt.A,{msgId:"saveDialog.createdAt"}),modifiedAtFieldText:at().createElement(pt.A,{msgId:"saveDialog.modifiedAt"}),namePlaceholderText:"saveDialog.namePlaceholder",descriptionPlaceholderText:"saveDialog.descriptionPlaceholder",titlePlaceholderText:"saveDialog.titlePlaceholder",unadvertisedText:at().createElement(pt.A,{msgId:"saveDialog.unadvertised"}),creatorFieldText:at().createElement(pt.A,{msgId:"saveDialog.creator"}),editorFieldText:at().createElement(pt.A,{msgId:"saveDialog.editor"})})))}}])&&Fn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(at().Component);const Gn=Bn;var zn=n(192016),Zn=n(584153);function Vn(e){return Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vn(e)}function qn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Yn(r.key),r)}}function Wn(e,t,n){return t=Kn(t),function(e,t){if(t&&("object"==Vn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Hn()?Reflect.construct(t,n||[],Kn(e).constructor):t.apply(e,n))}function Hn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Hn=function(){return!!e})()}function Kn(e){return Kn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Kn(e)}function Jn(e,t){return Jn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Jn(e,t)}function Xn(e,t,n){return(t=Yn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yn(e){var t=function(e){if("object"!=Vn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Vn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Vn(t)?t:t+""}var $n=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Xn(e=Wn(this,t,[].concat(r)),"onGroupChange",function(t){e.props.onNewGroupChoose(E()(e.props.availableGroups,function(e){return e.id===t.value}))}),Xn(e,"onAddPermission",function(){e.isPermissionPresent(e.props.newGroup.groupName)?e.props.onUpdateRules(e.props.rules.map(function(t){return t.group&&t.group.groupName===e.props.newGroup.groupName?"canWrite"===e.props.newPermission?Object.assign({},t,{canRead:!0,canWrite:!0}):Object.assign({},t,{canRead:!0,canWrite:!1}):t},e).filter(function(e){return e.canRead||e.canWrite})):e.props.onUpdateRules(e.props.rules.concat([{canRead:!0,canWrite:"canWrite"===e.props.newPermission,group:e.props.newGroup}]))}),Xn(e,"onChangePermission",function(t,n){e.props.onUpdateRules(e.props.rules.filter(function(e){return!("delete"===n&&e.group&&e.group.groupName===t)}).map(function(e){return e.group&&e.group.groupName===t?"canWrite"===n?Object.assign({},e,{canRead:!0,canWrite:!0}):"canRead"===n?Object.assign({},e,{canRead:!0,canWrite:!1}):Object.assign({},e,{canRead:!1,canWrite:!1}):e}).filter(function(e){return e.canRead||e.canWrite}))}),Xn(e,"getCurrentPermission",function(){return e.props.newPermission||y()(e.props.availablePermissions)}),Xn(e,"getSelectableGroups",function(){return e.props.availableGroups&&e.props.availableGroups.filter(function(t){return!e.isPermissionPresent(t.groupName)}).filter(function(t){return"canWrite"!==e.getCurrentPermission()||t.groupName!==Zn.Ay.USER_GROUP_ALL}).map(function(e){return{label:e.groupName,value:e.id}})}),Xn(e,"getPermissionLabel",function(t){switch(t){case"canRead":return(0,Et.kA)(e.context.messages,"map.permissions.canView");case"canWrite":return(0,Et.kA)(e.context.messages,"map.permissions.canWrite");default:return t}}),Xn(e,"getAvailablePermissions",function(t){return e.props.availablePermissions.map(function(t){return{value:t,label:e.getPermissionLabel(t)}}).filter(function(n){var r;return(null!=t?t:null===(r=e.props.newGroup)||void 0===r?void 0:r.groupName)!==Zn.Ay.USER_GROUP_ALL||"canWrite"!==n.value})}),Xn(e,"renderPermissionRows",function(){var t=e.props.rules.filter(function(e){return e.group});return 0===t.length?at().createElement("tr",null,at().createElement("td",{colSpan:"3"},at().createElement(pt.A,{msgId:"map.permissions.noRules"}))):t.map(function(t,n){var r=t.canWrite,o=t.group;return at().createElement("tr",{key:n,className:n/2==0?"even":"odd"},at().createElement("td",null,o.groupName),at().createElement("td",{style:{width:"150px"}},at().createElement(zn.Ay,{ref:"permChoice"+n,onChange:function(t){e.onChangePermission.call(e,o.groupName,t.value)},clearable:!1,options:e.getAvailablePermissions(o.groupName),value:r?"canWrite":"canRead"})),at().createElement("td",{style:{width:"50px"}},at().createElement(ut.A,{key:"deleteButton"+n,ref:"deleteButton",bsStyle:"danger",className:"square-button",disabled:e.props.disabled,onClick:e.onChangePermission.bind(e,o.groupName,"delete")},at().createElement(ct.e6,{glyph:"1-close"}))))})}),Xn(e,"isPermissionPresent",function(t){return e.props.rules&&Q()(e.props.rules,function(e){return e.group&&e.group.groupName===t})>=0}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jn(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this;return at().createElement("div",null,at().createElement(ct.XI,{className:"permissions-table",stripped:!0,condensed:!0,hover:!0},at().createElement("thead",null,at().createElement("tr",null,at().createElement("th",{colSpan:"3"},at().createElement(pt.A,{msgId:"map.permissions.title"})))),at().createElement("tbody",null,this.props.loading?at().createElement("tr",null,at().createElement("td",{colSpan:"3"},at().createElement("div",null,at().createElement(ht(),{noFadeIn:!0,overrideSpinnerClassName:"spinner",spinnerName:"circle"})))):this.renderPermissionRows(),at().createElement("tr",null,at().createElement("th",{colSpan:"3"},at().createElement(pt.A,{msgId:"map.permissions.addRule"}))),at().createElement("tr",{key:"addRowKey",className:"insert-row"},at().createElement("td",null,at().createElement(zn.Ay,{noResultsText:(0,Et.kA)(this.context.messages,"map.permissions.noResult"),ref:"newGroup",isLoading:!this.getSelectableGroups(),clearable:!1,placeholder:(0,Et.kA)(this.context.messages,"map.permissions.selectGroup"),options:this.getSelectableGroups(),value:this.props.newGroup&&this.props.newGroup.id,onChange:this.onGroupChange})),at().createElement("td",{style:{width:"150px"}},at().createElement(zn.Ay,{ref:"newChoice",clearable:!1,options:this.getAvailablePermissions(),value:this.getCurrentPermission(),onChange:function(t){e.props.onNewPermissionChoose(t&&t.value)}})),at().createElement("td",{style:{width:"50px"}},at().createElement(ut.A,{ref:"buttonAdd",disabled:this.props.disabled||!this.props.newGroup||this.isPermissionPresent(this.props.newGroup&&this.props.newGroup.groupName),className:"square-button",bsStyle:"success",onClick:this.onAddPermission},at().createElement(ct.e6,{glyph:"plus"})))))))}},{key:"disablePermission",value:function(e,t){return e||!t}}])&&qn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(at().Component);Xn($n,"propTypes",{id:st().string,user:st().object,loading:st().bool,onUpdateRules:st().func,buttonSize:st().string,disabled:st().bool,style:st().object,fluid:st().bool,onErrorCurrentMap:st().func,onUpdateCurrentMap:st().func,onNewGroupChoose:st().func,onNewPermissionChoose:st().func,availablePermissions:st().arrayOf(st().string),availableGroups:st().arrayOf(st().object),updatePermissions:st().func,rules:st().arrayOf(st().object),newGroup:st().object,newPermission:st().string}),Xn($n,"contextTypes",{messages:st().object}),Xn($n,"defaultProps",{disabled:!1,id:"PermissionEditor",onUpdateRules:function(){},onNewGroupChoose:function(){},onNewPermissionChoose:function(){},user:{name:"Guest"},style:{},buttonSize:"small",onErrorCurrentMap:function(){},onUpdateCurrentMap:function(){},availablePermissions:["canRead","canWrite"],availableGroups:[],updatePermissions:function(){},rules:[]});const Qn=$n;function er(e){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er(e)}function tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tr(Object(n),!0).forEach(function(t){sr(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function rr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,cr(r.key),r)}}function or(e,t,n){return t=ar(t),function(e,t){if(t&&("object"==er(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ir()?Reflect.construct(t,n||[],ar(e).constructor):t.apply(e,n))}function ir(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ir=function(){return!!e})()}function ar(e){return ar=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ar(e)}function lr(e,t){return lr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lr(e,t)}function sr(e,t,n){return(t=cr(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cr(e){var t=function(e){if("object"!=er(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==er(t)?t:t+""}var ur=(0,n(432060).A)()((0,it.lazy)(function(){return Promise.all([n.e(953),n.e(5096),n.e(5451),n.e(3111)]).then(n.bind(n,785492))})),pr=Yt(Qn),fr=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return sr(e=or(this,t,[].concat(r)),"onCloseMapPropertiesModal",function(){e.props.onClose()}),sr(e,"onSave",function(){e.setState({loading:!0}),e.props.onSave(nr(nr({},e.props.resource),{},{permission:e.props.rules}))}),sr(e,"isValidForm",function(){return f()(e.props.resource,"metadata.name")&&(!e.props.enableFileDrop||"accepted"===e.props.fileDropStatus)}),sr(e,"isLoading",function(){var t,n;return e.props.loading||(null===(t=e.props.resource)||void 0===t?void 0:t.loading)||(null===(n=e.state)||void 0===n?void 0:n.loading)}),sr(e,"isSaveDisabled",function(){return!e.isValidForm()||e.isLoading()||!e.props.canSave}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lr(e,t)}(t,e),n=t,r=[{key:"componentDidUpdate",value:function(e){var t;this.props.errors&&this.props.errors.length>0&&!Xt()(this.props.errors,e.errors)&&null!==(t=this.state)&&void 0!==t&&t.loading&&this.setState({loading:!1})}},{key:"render",value:function(){var e,t=this,n=!this.props.disablePermission&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(!e)return!1;var n=e.role,r=e.name;if("ADMIN"===n)return!0;var o=t&&t.attributes&&t.attributes.owner;return!o||o===r}(this.props.user,this.props.resource),r=this.props.detailsComponent;return at().createElement(mt.A,{key:"saveDialog"},at().createElement(Wt.A,{loading:this.props.loading||(null===(e=this.state)||void 0===e?void 0:e.loading),title:at().createElement(pt.A,{msgId:this.props.title}),show:this.props.show,clickOutEnabled:this.props.clickOutEnabled,bodyClassName:"ms-flex modal-properties-container",fitContent:this.props.disablePermission,dialogClassName:this.props.dialogClassName,buttons:[{text:at().createElement(pt.A,{msgId:"close"}),onClick:this.onCloseMapPropertiesModal,disabled:this.isLoading()},{text:at().createElement("span",null,at().createElement(pt.A,{msgId:this.props.saveButtonLabel})),onClick:function(){t.onSave()},disabled:this.isSaveDisabled()}],showClose:!this.isLoading(),onClose:this.onCloseMapPropertiesModal},at().createElement(ct.xA,{fluid:!0},at().createElement("div",{className:"ms-map-properties"},at().createElement(tn,{errors:this.props.errors}),at().createElement(Gn,{resource:this.props.resource,onUpdateLinkedResource:this.props.onUpdateLinkedResource,linkedResources:this.props.linkedResources,enableFileDrop:this.props.enableFileDrop,acceptedDropFileName:this.props.acceptedDropFileName,fileDropLabel:this.props.fileDropLabel,fileDropStatus:this.props.fileDropStatus,fileDropErrorMessage:this.props.fileDropErrorMessage,fileDropClearMessage:this.props.fileDropClearMessage,onMetadataChanged:this.props.metadataChanged,onFileDrop:this.props.onFileDrop,onFileDropClear:this.props.onFileDropClear,onError:this.props.onError,nameFieldFilter:this.props.nameFieldFilter,onUpdate:this.props.onUpdate}),this.props.enableDetails&&at().createElement(r,{editor:this.props.detailsEditor,editorProps:this.props.detailsEditorProps,loading:this.props.loading,resource:this.props.resource,linkedResources:this.props.linkedResources,onUpdateResource:this.props.onUpdate,onUpdateLinkedResource:this.props.onUpdateLinkedResource}),!!n&&at().createElement(pr,{rules:this.props.rules,onUpdateRules:this.props.onUpdateRules,availableGroups:this.props.availableGroups})))))}}],r&&rr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(at().Component);sr(fr,"propTypes",{show:st().bool,loading:st().bool,title:st().string,clickOutEnabled:st().bool,canSave:st().bool,errors:st().array,rules:st().array,enableFileDrop:st().bool,saveButtonLabel:st().string,onSave:st().func,acceptedDropFileName:st().string,fileDropLabel:st().string,fileDropStatus:st().string,fileDropErrorMessage:st().element,fileDropClearMessage:st().element,onUpdateRules:st().func,nameFieldFilter:st().func,resource:st().object,linkedResources:st().object,style:st().object,modalSize:st().string,enableDetails:st().bool,detailsComponent:st().func,detailsEditor:st().string,detailsEditorProps:st().object,onError:st().func,onUpdate:st().func,onUpdateLinkedResource:st().func,onClose:st().func,onFileDrop:st().func,onFileDropClear:st().func,metadataChanged:st().func,disablePermission:st().bool,availablePermissions:st().arrayOf(st().string),availableGroups:st().arrayOf(st().object),user:st().object,dialogClassName:st().string}),sr(fr,"contextTypes",{messages:st().object}),sr(fr,"defaultProps",{id:"MetadataModal",title:"saveDialog.title",saveButtonLabel:"save",modalSize:"",resource:{},linkedResources:{},onUpdateRules:function(){},nameFieldFilter:function(){},metadataChanged:function(){},metadata:{name:"",description:""},options:{},style:{},onClose:function(){},onError:function(){},onUpdate:function(){},onUpdateLinkedResource:function(){},onDeleteLinkedResource:function(){},onSave:function(){},disablePermission:!1,availablePermissions:["canRead","canWrite"],availableGroups:[],canSave:!0,user:{},dialogClassName:"",detailsComponent:n(224952).A(ur)});const dr=fr;var mr=n(224348),gr=n.n(mr),br=n(109351);function vr(e){return vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vr(e)}function yr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function hr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yr(Object(n),!0).forEach(function(t){Er(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Er(e,t,n){return(t=function(e){var t=function(e){if("object"!=vr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=vr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==vr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Pr=(0,St.compose)((0,St.withStateHandlers)(function(e){var t,n=e.resource,r=void 0===n?{}:n,o=e.linkedResources,i=void 0===o?{}:o,a=e.user,l=void 0===a?{}:a,s=r.detailsSettings||(null===(t=r.attributes)||void 0===t?void 0:t.detailsSettings),c={};if(re()(s))try{c=JSON.parse(s)}catch(e){c={}}else c=s||{};return{originalData:r,metadata:{name:r.name,description:r.description},attributes:hr(hr({},r.attributes),{},{context:r.context||r.attributes&&r.attributes.context,detailsSettings:c}),resource:{id:r.id,attributes:hr(hr({},r.attributes),{},{context:r.context||r.attributes&&r.attributes.context,detailsSettings:c}),metadata:{name:r.name,description:r.description,advertised:!!gr()(r.advertised)||r.advertised},createdAt:r.creation,modifiedAt:r.lastUpdate,creator:"ADMIN"===(null==l?void 0:l.role)?r.creator:"",editor:"ADMIN"===(null==l?void 0:l.role)?r.editor:""},linkedResources:i}},{onUpdate:function(e){var t=e.resource;return function(e,n){return{hasChanges:!0,resource:(0,w.hZ)(e,n,t)}}},onUpdateLinkedResource:function(e){var t=e.linkedResources,n=void 0===t?{}:t;return function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return{linkedResources:(0,w.hZ)(e,hr({category:r,data:t},o),n)}}}}),(0,St.withState)("confirmClose","onCloseConfirm",!1),(0,St.branch)(function(e){return e.confirmClose},(0,St.renderComponent)(function(e){var t=e.onCloseConfirm,n=e.onClose;return at().createElement(br.A,{show:!0,confirmText:at().createElement(pt.A,{msgId:"saveDialog.close"}),cancelText:at().createElement(pt.A,{msgId:"saveDialog.cancel"}),onConfirm:function(){return n()},onClose:function(){return t(!1)}},at().createElement(pt.A,{msgId:"map.details.fieldsChanged"}),at().createElement("br",null),at().createElement(pt.A,{msgId:"map.details.sureToClose"}))})),(0,St.withHandlers)({onClose:function(e){var t=e.hasChanges,n=e.onClose,r=void 0===n?function(){}:n,o=e.onCloseConfirm,i=void 0===o?function(){}:o;return function(){return t?i(!0):r()}}}),(0,St.withHandlers)({onSave:function(e){var t=e.onSave,n=void 0===t?function(){}:t,r=e.category,o=void 0===r?"DASHBOARD":r,i=e.data,a=e.additionalAttributes,l=void 0===a?{}:a,s=e.linkedResources;return function(e){return n(hr(hr({category:o,linkedResources:s,data:i},e),{},{attributes:hr(hr({},e.attributes),l)}))}}}));function Sr(e){return Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sr(e)}function Or(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Cr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Or(Object(n),!0).forEach(function(t){wr(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Or(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function wr(e,t,n){return(t=function(e){var t=function(e){if("object"!=Sr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Sr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Sr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tr=(0,St.withStateHandlers)(function(){return{}},{onUpdateRules:function(){return function(e){return{rules:e}}}});function xr(e){return function(e){if(Array.isArray(e))return jr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return jr(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jr(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const Ar=(0,St.compose)((0,St.withStateHandlers)(function(){return{}},{onError:function(){return function(e){return{formErrors:e}}}}),(0,St.withProps)(function(e){var t=e.errors,n=void 0===t?[]:t,r=e.formErrors,o=void 0===r?[]:r;return{errors:[].concat(xr(n),xr(o))}}));var Dr=n(6683);function Nr(e){return Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nr(e)}function kr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ir(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kr(Object(n),!0).forEach(function(t){Fr(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Fr(e,t,n){return(t=function(e){var t=function(e){if("object"!=Nr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Nr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Nr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Rr=(0,St.mapPropsStream)(function(e){return e.combineLatest(e.filter(function(e){var t=e.resource;return t&&t.id}).distinctUntilChanged(function(e,t){var n=e.resource,r=t.resource;return n.id===r.id}).switchMap(function(e){var t,n,r;return(n=null===(t=e.resource.attributes)||void 0===t?void 0:t.details,r=Dr.Ay.getIdFromUri(n),Z().Observable.defer(function(){return r?le.A.getData(r):Promise.resolve()})).map(function(t){var n=Ir(Ir({},e.linkedResources||{}),{},{details:{category:"DETAILS",data:t||"NODATA"}});return e.onResourceLoad&&e.onResourceLoad(e.resource,n),{loading:!1,resource:e.resource,linkedResources:n}}).catch(function(e){return Z().Observable.of({loading:!1,errors:[e]})}).startWith({loading:!0,resource:!1})}).startWith({}),function(e,t){return Ir(Ir({},e),t)})});var Mr=(0,St.compose)(Pr,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le.A;return(0,St.branch)(function(e){return!e.disablePermission},(0,St.compose)(function(e){return(0,St.mapPropsStream)(function(t){return t.combineLatest(t.take(1).switchMap(function(t){var n=t.user;return Z().Observable.defer(function(){return e.getAvailableGroups(n)}).map(function(e){return{availableGroups:e}}).startWith({loading:!0})}).startWith({}).catch(function(){return Z().Observable.of({})}),function(e,t){return Cr(Cr({},e),t)})})}(e),function(e){return(0,St.mapPropsStream)(function(t){return t.combineLatest(t.distinctUntilKeyChanged("resource").pluck("resource").filter(function(e){return e.id}).pluck("id").distinctUntilChanged().switchMap(function(t){return Z().Observable.defer(function(){return e.getResourcePermissions(t)}).map(function(e){return{rules:e}}).startWith({loading:!0})}).startWith({}).catch(function(){return Z().Observable.of({})}),function(e,t){return Cr(Cr({},e),t)})})}(e),Tr))}(),Ar);function Ur(e){return Ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ur(e)}function Lr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lr(Object(n),!0).forEach(function(t){Br(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Br(e,t,n){return(t=function(e){var t=function(e){if("object"!=Ur(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ur(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ur(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return zr(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Zr=(0,St.compose)((0,St.branch)(function(e){return!e.show},St.renderNothing),(0,St.branch)(function(e){return!e.isNewResource},(0,St.compose)(Rr,(0,St.branch)(function(e){var t=e.resource;return t&&t.id},Mr)),Mr))(dr),Vr=function(e,t,n){return{id:n.id,title:n.name||n.id.toString(),description:n.description,tools:[{glyph:"pencil",tooltipId:"contextCreator.configureTemplates.tooltips.editTemplate",onClick:function(){return e(n.id)}},{glyph:"trash",tooltipId:"contextCreator.configureTemplates.tooltips.deleteTemplate",onClick:function(){return t(n)}}],preview:at().createElement("div",{className:"configure-map-templates-preview"},n.thumbnail&&"NODATA"!==n.thumbnail?at().createElement("img",{src:n.thumbnail}):at().createElement(ct.e6,{glyph:"1-map"})),infoExtra:n.format&&at().createElement("div",{className:"configure-map-templates-formaticon"},at().createElement(ct.e6,{glyph:Kt.x9[n.format]}),at().createElement("span",null,Kt.Ud[n.format]))}},qr=function(e){return e&&e.map(function(e){return e.id})},Wr=function(e,t,n,r,o,i){re()(r)&&re()(i)&&(r.indexOf("application/xml")>-1||r.indexOf("text/xml")>-1||0===i.indexOf("<?xml")?(e(o,i,"wmc"),t("accepted"),n([])):function(){try{var r=q().parse(i);e(o,r,"json"),t("accepted"),n([])}catch(e){t("clear"),n([{statusText:"contextCreator.configureTemplates.uploadDialog.jsonParsingError",error:e.message}])}}())},Hr=function(e,t,n,r){if(r&&r.length>0){var o=new FileReader;o.onload=function(o){return Wr(e,t,n,r[0].type,r[0].name,o.target.result)},o.onerror=function(){o.abort(),t("clear"),n(["contextCreator.configureTemplates.uploadDialog.fileReadError"])},o.readAsText(r[0])}};const Kr=function(e){var t=e.user,n=e.loading,r=e.loadFlags,o=e.mapTemplates,i=void 0===o?[]:o,a=e.availableTemplatesFilterText,l=void 0===a?"":a,s=e.enabledTemplatesFilterText,c=void 0===s?"":s,u=e.availableTemplatesFilterPlaceholder,p=void 0===u?"contextCreator.configureTemplates.templatesFilterPlaceholder":u,d=e.enabledTemplatesFilterPlaceholder,m=void 0===d?"contextCreator.configureTemplates.templatesFilterPlaceholder":d,g=e.showUploadDialog,v=void 0!==g&&g,y=e.parsedTemplate,h=void 0===y?{}:y,E=e.editedTemplate,P=e.fileDropStatus,S=e.changeTemplatesKey,O=void 0===S?function(){}:S,C=e.setSelectedTemplates,w=void 0===C?function(){}:C,T=e.setParsedTemplate,x=void 0===T?function(){}:T,j=e.setFileDropStatus,A=void 0===j?function(){}:j,D=e.onSave,N=void 0===D?function(){}:D,k=e.onDelete,I=void 0===k?function(){}:k,F=e.onEditTemplate,R=void 0===F?function(){}:F,M=e.onFilterAvailableTemplates,U=void 0===M?function(){}:M,L=e.onFilterEnabledTemplates,_=void 0===L?function(){}:L,B=e.onShowUploadDialog,G=void 0===B?function(){}:B,z=Gr(at().useState(!1),2),Z=z[0],V=z[1],q=Gr(at().useState(),2),W=q[0],H=q[1],K=Vr.bind(null,R,function(e){H(e),V(!0)});return at().createElement(at().Fragment,null,at().createElement(qt,{className:"configure-map-templates-transfer",leftColumn:{items:i.filter(function(e){return!e.enabled}).map(K),title:"contextCreator.configureTemplates.availableTemplates",tools:[{id:"upload-tool",glyph:"upload",tooltipId:"contextCreator.configureTemplates.tooltips.uploadTool",onClick:function(){return R()}}],filterText:l,filterPlaceholder:p,emptyStateProps:{glyph:"1-map",title:"contextCreator.configureTemplates.availableTemplatesEmpty"},emptyStateSearchProps:{glyph:"info-sign",title:"contextCreator.configureTemplates.searchResultsEmpty"},onFilter:U},rightColumn:{items:i.filter(function(e){return e.enabled}).map(K),title:"contextCreator.configureTemplates.enabledTemplates",filterText:c,filterPlaceholder:m,emptyStateProps:{glyph:"1-map",title:"contextCreator.configureTemplates.enabledTemplatesEmpty"},emptyStateSearchProps:{glyph:"info-sign",title:"contextCreator.configureTemplates.searchResultsEmpty"},onFilter:_},allowCtrlMultiSelect:!0,selectedItems:i.filter(function(e){return e.selected}).map(K),selectedSide:i.reduce(function(e,t){return t.selected&&t.enabled||e},!1)?"right":"left",sortStrategy:function(e){return e.slice().sort(function(e,t){return e.title<t.title?-1:e.title>t.title?1:0})},filter:function(e,t){return t.filter(function(t){return t.title.toLowerCase().indexOf(e.toLowerCase())>-1})},onSelect:function(e){return w(qr(e))},onTransfer:function(e,t){return O(qr(e),"enabled","right"===t)}}),at().createElement(Zr,{user:t,loading:n&&(r.templateSaving||r.templateLoading),resource:E,isNewResource:!E,clickOutEnabled:!1,category:"TEMPLATE",show:v,title:E?void 0:"contextCreator.configureTemplates.uploadDialog.title",data:h.data,additionalAttributes:{format:h.format},enableFileDrop:!0,acceptedDropFileName:h.fileName,fileDropStatus:P,fileDropLabel:"contextCreator.configureTemplates.fileDrop.label",fileDropClearMessage:at().createElement(pt.A,{msgId:"contextCreator.configureTemplates.fileDrop.clear"}),dialogClassName:" modal-higher",onFileDrop:Hr.bind(null,x,A),onFileDropClear:function(){x(),A()},onSave:function(e){var t=e.attributes.format;return t||(re()(e.data)?Wr(function(e,n,r){t=r},function(){},function(){},"application/text",h.fileName,e.data):b()(e.data)&&(t="json")),N(_r(_r({},e),{},{metadata:_r(_r({},e.metadata),{},{attributes:_r(_r({},e.attributes.thumbnail?{thumbnail:encodeURIComponent(e.attributes.thumbnail)}:{}),t?{format:t}:{})})}))},onClose:function(){return G(!1)}}),at().createElement(dt.A,{show:Z,onCancel:function(){H(),V(!1)},onConfirm:function(){I(W),H(),V(!1)},titleId:"contextCreator.configureTemplates.deleteConfirm",titleParams:{templateName:f()(W,"name")},preventHide:!0,variant:"danger",confirmId:"confirm",cancelId:"cancel"}))};var Jr=["tutorialMode","tutorialStep"];function Xr(){return Xr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xr.apply(null,arguments)}function Yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var $r,Qr=[{name:"TestPlugin1",title:"contextCreator.configurePlugins.tutorialPlugins.enabledTitle",description:"contextCreator.configurePlugins.tutorialPlugins.enabledDescription",isExtension:!1,enabled:!0,isUserPlugin:!0,active:!1},{name:"TestPlugin2",title:"contextCreator.configurePlugins.tutorialPlugins.availableTitle",description:"contextCreator.configurePlugins.tutorialPlugins.availableDescription",isExtension:!1,enabled:!1},{name:"TestPlugin3",title:"contextCreator.configurePlugins.tutorialPlugins.availableTitle",description:"contextCreator.configurePlugins.tutorialPlugins.availableDescription",isExtension:!0,enabled:!1},{name:"MapTemplates",title:"Map Templates",description:"contextCreator.configurePlugins.tutorialPlugins.enabledDescription",isExtension:!1,enabled:!0,isUserPlugin:!1}],eo={"configureplugins-initial":{disablePluginSort:!0,allPlugins:Qr},"configureplugins-cfgeditor":{disablePluginSort:!0,allPlugins:[{name:"TestPlugin1",title:"contextCreator.configurePlugins.tutorialPlugins.enabledTitle",description:"contextCreator.configurePlugins.tutorialPlugins.enabledDescription",isExtension:!1,enabled:!0,isUserPlugin:!0,active:!1}].concat(($r=Qr.slice(1),function(e){if(Array.isArray(e))return Yr(e)}($r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}($r)||function(e,t){if(e){if("string"==typeof e)return Yr(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yr(e,t):void 0}}($r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),editedPlugin:"TestPlugin1",editedCfg:'{\n    "cfg": {\n        "exampleProp": 8\n    },\n    "override": {}\n}'}},to=n(771710),no=n.n(to);function ro(e){return ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ro(e)}function oo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function io(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oo(Object(n),!0).forEach(function(t){ao(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oo(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ao(e,t,n){return(t=function(e){var t=function(e){if("object"!=ro(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ro(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ro(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lo={WRONG_FORMAT:"WRONG_FORMAT",MISSING_INDEX:"MISSING_INDEX",MALFORMED_INDEX:"MALFORMED_INDEX",MISSING_PLUGIN:"MISSING_PLUGIN",MISSING_BUNDLE:"MISSING_BUNDLE",TOO_MANY_PLUGINS:"TOO_MANY_BUNDLES",ALREADY_INSTALLED:"ALREADY_INSTALLED"},so=n(76941);function co(e){return co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},co(e)}function uo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function po(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uo(Object(n),!0).forEach(function(t){fo(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uo(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function fo(e,t,n){return(t=function(e){var t=function(e){if("object"!=co(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=co(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==co(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mo=function(e,t,n,r,o,i,a,l){return[{visible:"MapTemplates"===e.name,glyph:"1-map",tooltipId:"contextCreator.configurePlugins.tooltips.mapTemplatesConfig",onClick:function(){return i("mapTemplatesConfig",!0)}},{visible:!t&&!e.denyUserSelection,glyph:"1-user-mod",tooltipId:e.isUserPlugin?"contextCreator.configurePlugins.tooltips.disableUserPlugin":"contextCreator.configurePlugins.tooltips.enableUserPlugin",bsStyle:e.isUserPlugin?"success":void 0,onClick:function(){return a([e.name],"isUserPlugin",!e.isUserPlugin)}},{visible:e.isUserPlugin&&!e.denyUserSelection,glyph:e.active?"check":"unchecked",tooltipId:e.active?"contextCreator.configurePlugins.tooltips.deactivatePlugin":"contextCreator.configurePlugins.tooltips.activatePlugin",onClick:function(){return a([e.name],"active",!e.active)}},{glyph:"wrench",tooltipId:"contextCreator.configurePlugins.tooltips.editConfiguration",active:e.name===n,onClick:function(){return o(e.name===n?void 0:e.name)}},{visible:!(!e.docUrl&&!r),glyph:"question-sign",tooltipId:"contextCreator.configurePlugins.tooltips.pluginDocumentation",Element:function(t){return at().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:e.docUrl||r&&r+"#plugins."+(e.docName||e.name)},at().createElement(Ht.A,t))}},{visible:!(l||!e.isExtension),glyph:"trash",tooltipId:"contextCreator.configurePlugins.tooltips.removePlugin",onClick:function(){return i("confirmRemovePlugin",!0,e.name)}}]},go=function(e,t,n){return[{visible:!(n||!e.isExtension),glyph:"trash",tooltipId:"contextCreator.configurePlugins.tooltips.removePlugin",onClick:function(){return t("confirmRemovePlugin",!0,e.name)}}]},bo=function(e){var t="";return e.version&&"undefined"!==e.version&&(t=" ("+e.version+")"),(e.title||e.label||e.name)+t},vo=function(e){return e.description||"plugin name: "+e.name},yo=function(e){var t=e.editedPlugin,n=e.editedCfg,r=e.cfgError,o=e.setEditor,i=e.documentationBaseURL,a=e.showDescriptionTooltip,l=e.descriptionTooltipDelay,s=e.onEditPlugin,c=e.onEnablePlugins,u=e.onDisablePlugins,p=e.onUpdateCfg,f=e.onShowDialog,d=e.changePluginsKey,m=e.isRoot,g=e.hideUploadExtension,b=e.plugins,v=void 0===b?[]:b,y=e.processChildren,h=e.parentIsEnabled;return v.filter(function(e){return!e.hidden}).map(function(e){var b=m||h,v=e.forcedMandatory||e.mandatory;return{id:e.name,title:bo(e),cardSize:"sm",description:vo(e),showDescriptionTooltip:a,descriptionTooltipDelay:l,mandatory:v,className:m||!h||e.enabled?"":"plugin-card-disabled",tools:b?e.enabled?mo(e,v,t,i,s,f,d,g):go(e,f,g):[],component:b&&e.enabled&&e.name===t?at().createElement("div",{className:"plugin-configuration-editor"},at().createElement(Ot.A,{value:n,editorDidMount:function(e){return o(e)},onBeforeChange:function(e,t,n){return p(n)},options:{theme:"lesser-dark",mode:"application/json",lineNumbers:!0,styleSelectedText:!0,indentUnit:2,tabSize:2}}),r&&at().createElement("div",{className:"plugin-configuration-errorarea"},at().createElement("div",{className:"plugin-configuration-errorarea-header"},at().createElement(pt.A,{msgId:"contextCreator.configurePlugins.cfgParsingError.title"})),at().createElement("div",{className:"plugin-configuration-errorarea-body"},at().createElement(pt.A,{msgId:"contextCreator.configurePlugins.cfgParsingError.body",msgParams:{error:r.message}},function(e){return at().createElement("pre",{className:"plugin-configuration-errormsg"},e)})))):null,preview:at().createElement(at().Fragment,null,!m&&h&&!v&&at().createElement(ut.A,{style:{left:"-4px",position:"relative"},key:"checkbox",className:"square-button no-border",onClick:function(t){t.stopPropagation(),v||(e.enabled?u:c)([e.name])}},at().createElement(ct.e6,{glyph:e.enabled?"check":"unchecked"})),e.glyph?at().createElement(ct.e6,{key:"icon",glyph:e.glyph}):at().createElement(ct.e6,{key:"icon",glyph:"plug"})),children:y&&yo({editedPlugin:t,editedCfg:n,cfgError:r,setEditor:o,documentationBaseURL:i,showDescriptionTooltip:a,descriptionTooltipDelay:l,onEditPlugin:s,onEnablePlugins:c,onDisablePlugins:u,onUpdateCfg:p,onShowDialog:f,changePluginsKey:d,isRoot:!1,hideUploadExtension:g,plugins:e.children,processChildren:!0,parentIsEnabled:e.enabled})||[]}})},ho=function(e){return e&&e.map(function(e){return e.id})},Eo=function(e){return e&&e.filter(function(e){return!e.mandatory})};const Po=(0,St.compose)((0,St.withState)("errorLineNumber","setErrorLineNumber"),(0,St.withState)("editor","setEditor"),(0,St.getContext)({messages:st().object}),(0,St.lifecycle)({componentDidUpdate:function(){var e=this.props,t=e.cfgError,n=e.editor,r=e.errorLineNumber,o=e.setErrorLineNumber,i=f()(t,"lineNumber");n&&i!==r&&(r&&n.removeLineClass(r-1,"background","plugin-configuration-line-error"),o(i),i&&n.addLineClass(i-1,"background","plugin-configuration-line-error"))}}),function(e){return function(t){var n=t.tutorialMode,r=void 0!==n&&n,o=t.tutorialStep,i=void 0===o?"configureplugins-initial":o,a=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,Jr);return at().createElement(e,Xr({},a,r?eo[i]:{}))}})(function(e){var t=e.user,n=e.loading,r=e.loadFlags,o=e.allPlugins,i=void 0===o?[]:o,a=e.editedPlugin,l=e.editedCfg,s=e.cfgError,c=e.parsedTemplate,u=e.editedTemplate,p=e.fileDropStatus,f=e.availablePluginsFilterText,d=void 0===f?"":f,m=e.enabledPluginsFilterText,g=void 0===m?"":m,b=e.availablePluginsFilterPlaceholder,v=void 0===b?"contextCreator.configurePlugins.pluginsFilterPlaceholder":b,y=e.enabledPluginsFilterPlaceholder,h=void 0===y?"contextCreator.configurePlugins.pluginsFilterPlaceholder":y,E=e.documentationBaseURL,P=e.showDescriptionTooltip,S=void 0===P||P,O=e.descriptionTooltipDelay,C=void 0===O?600:O,w=e.uploadEnabled,T=void 0!==w&&w,x=e.pluginsToUpload,j=void 0===x?[]:x,A=e.uploading,D=void 0===A?[]:A,N=e.uploadResult,k=e.showDialog,I=void 0===k?{}:k,F=e.mapTemplates,R=e.availableTemplatesFilterText,M=e.enabledTemplatesFilterText,U=e.availableTemplatesFilterPlaceholder,L=e.enabledTemplatesFilterPlaceholder,_=e.disablePluginSort,B=void 0!==_&&_,G=e.onFilterAvailablePlugins,z=void 0===G?function(){}:G,Z=e.onFilterEnabledPlugins,V=void 0===Z?function(){}:Z,q=e.onEditPlugin,W=void 0===q?function(){}:q,H=e.onEnablePlugins,K=void 0===H?function(){}:H,J=e.onDisablePlugins,X=void 0===J?function(){}:J,Y=e.onUpdateCfg,$=void 0===Y?function(){}:Y,Q=e.setSelectedPlugins,ee=void 0===Q?function(){}:Q,te=e.changePluginsKey,ne=void 0===te?function(){}:te,re=e.setEditor,oe=void 0===re?function(){}:re,ie=e.onEnableUpload,ae=void 0===ie?function(){}:ie,le=e.onUpload,se=void 0===le?function(){}:le,ce=e.onAddUpload,ue=void 0===ce?function(){}:ce,pe=e.onRemoveUpload,fe=void 0===pe?function(){}:pe,de=e.onShowDialog,me=void 0===de?function(){}:de,ge=e.onRemovePlugin,be=void 0===ge?function(){}:ge,ye=e.onSaveTemplate,he=e.onDeleteTemplate,Ee=e.onEditTemplate,Pe=e.onFilterAvailableTemplates,Se=e.onFilterEnabledTemplates,Oe=e.changeTemplatesKey,Ce=e.setSelectedTemplates,we=e.setParsedTemplate,Te=e.setFileDropStatus,xe=e.messages,je=void 0===xe?{}:xe,Ae=e.hideUploadExtension,De=fo(fo(fo(fo(fo(fo(fo({},lo.WRONG_FORMAT,"contextCreator.configurePlugins.uploadWrongFileFormatError"),lo.MISSING_INDEX,"contextCreator.configurePlugins.uploadMissingIndexError"),lo.MALFORMED_INDEX,"contextCreator.configurePlugins.uploadParseError"),lo.MISSING_PLUGIN,"contextCreator.configurePlugins.uploadMissingPluginError"),lo.MISSING_BUNDLE,"contextCreator.configurePlugins.uploadMissingBundleError"),lo.TOO_MANY_BUNDLES,"contextCreator.configurePlugins.uploadTooManyBundlesError"),lo.ALREADY_INSTALLED,"contextCreator.configurePlugins.uploadAlreadyInstalledError"),Ne=i.filter(function(e){return e.selected}),ke=i.filter(function(e){return!e.enabled}),Ie=i.filter(function(e){return e.enabled}),Fe={editedPlugin:a,editedCfg:l,cfgError:s,setEditor:oe,documentationBaseURL:E,showDescriptionTooltip:S,descriptionTooltipDelay:C,onEditPlugin:W,onEnablePlugins:K,onDisablePlugins:X,onUpdateCfg:$,onShowDialog:me,changePluginsKey:ne,isRoot:!0,hideUploadExtension:Ae},Re=yo(po(po({},Fe),{},{plugins:Ne,processChildren:!1})),Me=yo(po(po({},Fe),{},{plugins:ke,processChildren:!0})),Ue=yo(po(po({},Fe),{},{plugins:Ie,processChildren:!0}));return at().createElement("div",{className:"configure-plugins-step"},at().createElement(qt,{localizeItems:!0,leftColumn:{items:Me,title:"contextCreator.configurePlugins.availablePlugins",filterText:d,filterPlaceholder:v,emptyStateProps:{glyph:"wrench",title:"contextCreator.configurePlugins.availablePluginsEmpty"},emptyStateSearchProps:{glyph:"info-sign",title:"contextCreator.configurePlugins.searchResultsEmpty"},onFilter:z,tools:Ae?[]:[{id:"upload",glyph:"upload",onClick:function(){return ae(!0)},tooltipId:"contextCreator.configurePlugins.tooltips.uploadPlugin"}]},rightColumn:{items:Ue,title:"contextCreator.configurePlugins.enabledPlugins",filterText:g,filterPlaceholder:h,emptyStateProps:{glyph:"wrench",title:"contextCreator.configurePlugins.enabledPluginsEmpty"},emptyStateSearchProps:{glyph:"info-sign",title:"contextCreator.configurePlugins.searchResultsEmpty"},emptyTest:function(e){return!e.filter(function(e){return!e.mandatory}).length},onFilter:V},allowCtrlMultiSelect:!0,selectedItems:Re,selectedSide:i.reduce(function(e,t){return t.selected&&t.enabled||e},!1)?"right":"left",sortStrategy:function(e){if(B)return e;var t=function(e){return e&&e.map(function(e){return po(po({},e),{},{children:t(e.children)})}).sort(function(e,t){return e.title<t.title?-1:1})};return t(e)},filter:function(e,t){var n=e.toLowerCase(),r=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(e){return po(po({},e),{},{children:r(e.children)})}).filter(function(e){return e.children.length>0||e.title.toLowerCase().indexOf(n)>-1})};return r(t)},onSelect:function(e){return ee(ho(Eo(e)))},onTransfer:function(e,t){return("right"===t?K:X)(ho(Eo(e)))}}),at().createElement(Wt.A,{loading:n&&r.templateDataLoading,showFullscreen:!0,title:at().createElement(pt.A,{msgId:"contextCreator.configureTemplates.title"}),show:I.mapTemplatesConfig,fullscreenType:"vertical",clickOutEnabled:!1,size:"lg",onClose:function(){return me("mapTemplatesConfig",!1)}},at().createElement(Kr,{user:t,loading:n,loadFlags:r,mapTemplates:F,parsedTemplate:c,editedTemplate:u,fileDropStatus:p,availableTemplatesFilterText:R,enabledTemplatesFilterText:M,availableTemplatesFilterPlaceholder:U,enabledTemplatesFilterPlaceholder:L,showUploadDialog:I.uploadTemplate,changeTemplatesKey:Oe,setSelectedTemplates:Ce,setParsedTemplate:we,setFileDropStatus:Te,onSave:ye,onDelete:he,onEditTemplate:Ee,onFilterAvailableTemplates:Pe,onFilterEnabledTemplates:Se,onShowUploadDialog:me.bind(null,"uploadTemplate")})),at().createElement(br.A,{onClose:me.bind(null,"confirmRemovePlugin",!1),onConfirm:be.bind(null,I.confirmRemovePluginPayload),show:I.confirmRemovePlugin,buttonSize:"large"},at().createElement(pt.A,{msgId:"contextCreator.configurePlugins.confirmRemovePlugin"})),T&&function(e){var t=e.toUpload,n=e.onClose,r=e.onUpload,o=e.onInstall,i=e.onRemove,a=e.isUploading,l=e.uploadStatus;return at().createElement(so.A,{show:!0},at().createElement(so.A.Header,{key:"dialogHeader"},at().createElement(so.A.Title,null,at().createElement(pt.A,{msgId:"contextCreator.configurePlugins.uploadTitle"}))),at().createElement(so.A.Body,null,a?at().createElement(ht(),null):at().createElement("div",{className:"configure-plugins-step-upload"},at().createElement(an(),{key:"dropzone",rejectClassName:"dropzone-danger",className:"dropzone",activeClassName:"active",onDrop:r},at().createElement("div",{style:{display:"flex",alignItems:"center",width:"100%",height:"100%",justifyContent:"center"}},at().createElement("span",{style:{textAlign:"center"}},at().createElement(pt.A,{msgId:"contextCreator.configurePlugins.uploadLabel"})))),at().createElement("div",{className:"uploads-list"},t.map(function(e,t){return function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=e.error?at().createElement(ct.e6,{glyph:"remove"}):at().createElement(ct.e6,{glyph:"ok"});return at().createElement("div",{key:e.name,className:"uploading-file"},o,at().createElement("span",{className:"plugin-name"},e.name),at().createElement("span",{className:"upload-remove",onClick:r},at().createElement(ct.e6,{glyph:"trash"})),at().createElement("span",{className:"upload-error"},e.error&&(t=e.error,n=at().createElement(ct.m_,null,t.message),at().createElement(ct.N,{placement:"top",overlay:n},at().createElement(ct.e6,{glyph:"warning-sign"})))))}(e,function(){return i(t)})})),l&&"error"===l.result&&at().createElement(ct.Fc,{bsStyle:"danger"},at().createElement(pt.A,{msgId:"contextCreator.configurePlugins.uploadError"}),l.error.message),l&&"ok"===l.result&&at().createElement(ct.Fc,{bsStyle:"info"},at().createElement(pt.A,{msgId:"contextCreator.configurePlugins.uploadOk"})))),at().createElement(so.A.Footer,null,at().createElement(ut.A,{onClick:n},at().createElement(pt.A,{msgId:"contextCreator.configurePlugins.cancelUpload"})),at().createElement(ut.A,{bsStyle:"primary",onClick:o,disabled:0===t.filter(function(e){return!e.error}).length},at().createElement(pt.A,{msgId:"contextCreator.configurePlugins.install"}))))}({toUpload:j,onClose:function(){return ae(!1)},onUpload:function(e){Promise.all(e.map(function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(0,ve.ue)(e).then(function(e){return(new(no())).loadAsync(e).catch(function(){throw lo.WRONG_FORMAT})}).then(function(n){if(!n.files["index.json"])throw lo.MISSING_INDEX;if(0===n.file(/index\.js$/).length)throw lo.MISSING_BUNDLE;return n.files["index.json"].async("text").then(function(n){var r=function(e,t){try{var n=JSON.parse(e);if(n.plugins&&n.plugins.length&&n.plugins[0].name){var r=n.plugins[0].name;return-1!==t.indexOf(r)?{error:lo.ALREADY_INSTALLED}:{name:r}}return{error:lo.MISSING_PLUGIN}}catch(e){return{error:lo.MALFORMED_INDEX}}}(n,t);if(r.error)throw r.error;return io(io({},r),{},{file:e})})})}(e,i.map(function(e){return e.name})).catch(function(e){throw new Error((0,Et.kA)(je,De[e]))})})).then(function(e){ue(e)}).catch(function(t){ue(e.map(function(e){return{name:e.name,file:e,error:t}}))})},onInstall:function(){var e=j.filter(function(e){return!e.error});se(e)},onRemove:fe,isUploading:D.filter(function(e){return e.uploading}).length>0,uploadStatus:N}))});var So=n(204903),Oo=n(444003);const Co=function(e){var t=e.pluginsConfig,n=void 0===t?{}:t,r=e.plugins,o=void 0===r?{}:r,i=e.mapType,a=void 0===i?Oo.Av.OPENLAYERS:i,l=e.className,s=void 0===l?"viewer context-creator-viewer":l,c=e.showConfirm,u=void 0!==c&&c,p=e.confirmMessage,f=void 0===p?"contextCreator.configureMap.confirm":p,d=e.onReloadConfirm,m=void 0===d?function(){}:d,g=e.onMapViewerReload,b=void 0===g?function(){}:g;return at().createElement(at().Fragment,null,at().createElement(dt.A,{show:u,onCancel:function(){m(!1)},onConfirm:function(){m(!1),b()},titleId:f,preventHide:!0,variant:"danger",confirmId:"confirm",cancelId:"cancel"}),at().createElement(So.A,{className:s,pluginsConfig:n,plugins:o,params:{mapType:a,mapId:"new"}}))};var wo=n(987021),To=n.n(wo),xo=n(595535),jo=n(7235),Ao=n(596006),Do=n(168995),No=n(348317);function ko(e){return ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ko(e)}function Io(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Fo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Io(Object(n),!0).forEach(function(t){Ro(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Io(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ro(e,t,n){return(t=function(e){var t=function(e){if("object"!=ko(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ko(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ko(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mo=(0,un.A)("noResultsText")(zn.Ay),Uo="ms-main-color",Lo="ms-main-bg",_o="ms-primary-contrast",Bo="ms-primary",Go="ms-success-contrast",zo="ms-success",Zo=function(e,t,n,r){return!To().equals(null==e?void 0:e[r],(null==t?void 0:t[r])||n[r])};const Vo=function(e){var t=e.themes,n=void 0===t?[]:t,r=e.setSelectedTheme,o=void 0===r?function(){}:r,i=e.onToggleCustomVariables,a=void 0===i?function(){}:i,l=e.selectedTheme,s=void 0===l?{}:l,c=e.customVariablesEnabled,u=void 0!==c&&c,p=e.context,f=void 0===p?{}:p,d=e.basicVariables,m=void 0===d?Ro(Ro(Ro(Ro(Ro(Ro({},Uo,"#000000"),Lo,"#FFFFFF"),_o,"#FFFFFF"),Bo,"#0D7185"),Go,"#FFFFFF"),zo,"#398439"):d,g=(0,it.useRef)(),b=(0,it.useRef)(),v=(0,it.useRef)(),y=(E()(n,{id:s.id})||{}).defaultVariables,h=Fo(Fo(Fo({},m),y),null==s?void 0:s.variables),P=h[Uo]&&h[Lo]&&!To().isReadable(h[Uo],h[Lo])?To().mostReadable(h[Lo],[h[Uo],"#ffffff","#000000"],{includeFallbackColors:!0}).toHexString():null,S=h[Bo]&&h[_o]&&!To().isReadable(h[Bo],h[_o])?To().mostReadable(h[_o],[h[Bo],"#ffffff","#000000"],{includeFallbackColors:!0}).toHexString():null,O=h[zo]&&h[Go]&&!To().isReadable(h[zo],h[Go])?To().mostReadable(h[Go],[h[zo],"#ffffff","#000000"],{includeFallbackColors:!0}).toHexString():null,C=h[zo]&&h[Bo]&&!To().isReadable(h[zo],h[Bo])?To().mostReadable(h[Bo],[h[zo],"#ffffff","#000000"],{includeFallbackColors:!0}).toHexString():null,w=Zo(h,y,m,Uo),T=Zo(h,y,m,Lo),x=Zo(h,y,m,_o),j=Zo(h,y,m,Bo),A=Zo(h,y,m,Go),D=Zo(h,y,m,zo);return at().createElement("div",{className:"configure-themes-step"},at().createElement("div",{className:"choose-theme"},at().createElement("div",{className:"text-center"},at().createElement(ct.e6,{glyph:"dropper",style:{fontSize:128}})),at().createElement("h1",{className:"text-center"},at().createElement(pt.A,{msgId:"contextCreator.configureThemes.title"})),at().createElement(ct.mq,{className:"label-theme"},at().createElement(pt.A,{msgId:"contextCreator.configureThemes.themes"})),at().createElement(Mo,{clearable:!0,onChange:function(e){var t=null==e?void 0:e.theme;o(u?t?Fo(Fo({},t),{},{variables:Fo(Fo({},m),t.defaultVariables)}):{variables:m}:t)},value:null==s?void 0:s.id,options:n.map(function(e){return{value:e.id,label:(null==e?void 0:e.label)&&(0,Et.kA)(f,null==e?void 0:e.label)||(null==e?void 0:e.id),theme:e}}),noResultsText:"contextCreator.configureThemes.noThemes"}),at().createElement("div",{className:"custom-variables"},at().createElement(ct.mq,null,at().createElement(pt.A,{msgId:"contextCreator.configureThemes.customVariables"})),at().createElement(Do.A,{bsStyle:"link",text:at().createElement(pt.A,{msgId:"contextCreator.configureThemes.tooltips.customColorsDescription"})}),at().createElement(ut.A,{key:"clear-all",onClick:function(){o(Fo(Fo({},s),{},{variables:Fo(Fo({},m),y)}))},className:"clear-all no-border"},"clear all"),at().createElement(No.A,{onChange:function(e){a(),e&&o(Fo(Fo({},s),{},{variables:h}))},className:"ms-geostory-settings-switch",checked:u})),at().createElement("div",{className:"color-item"},at().createElement(ct.mq,{className:"label-theme"},at().createElement(pt.A,{msgId:"contextCreator.configureThemes.main"}),at().createElement(Do.A,{bsStyle:"link",text:at().createElement(pt.A,{msgId:"contextCreator.configureThemes.tooltips.main"})}),P?at().createElement(Ao.A,{useBody:!0,className:"ms-custom-theme-picker-popover",ref:function(e){e&&(g.current=e.trigger)},placement:"top",content:at().createElement("div",null,at().createElement(xo.A,{msgId:"geostory.customizeTheme.alternativeTextColorPopover",msgParams:{color:P}}),at().createElement(ut.A,{bsSize:"xs",bsStyle:"primary",style:{margin:"auto",display:"block"},onClick:function(){var e,t;o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},Uo,P))})),null===(e=g.current)||void 0===e||null===(t=e.hide)||void 0===t||t.call(e)}},at().createElement(pt.A,{msgId:"geostory.customizeTheme.useAlternativeTextColor"})))},at().createElement(ut.A,{disabled:!u,className:"square-button no-border",style:{display:P?"block":"none"}},at().createElement(ct.e6,{glyph:"exclamation-mark"}))):null),at().createElement("div",{className:"color-choice"},at().createElement(jo.A,{disabled:!u,onOpen:function(){return{}},color:h[Uo],line:!1,disableAlpha:!1,onChangeColor:function(e){o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},Uo,To()(e).toHexString()))}))}}),at().createElement(ut.A,{disabled:!w||!u,key:Uo,onClick:function(){o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},Uo,(null==y?void 0:y[Uo])||m[Uo]))}))},className:"no-border"},at().createElement(ct.e6,{glyph:"repeat"})))),at().createElement("div",{className:"color-item"},at().createElement(ct.mq,{className:"label-theme"},at().createElement(pt.A,{msgId:"contextCreator.configureThemes.background"}),at().createElement(Do.A,{bsStyle:"link",text:at().createElement(pt.A,{msgId:"contextCreator.configureThemes.tooltips.background"})})),at().createElement("div",{className:"color-choice"},at().createElement(jo.A,{disabled:!u,onOpen:function(){return{}},color:h[Lo],line:!1,disableAlpha:!1,onChangeColor:function(e){o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},Lo,To()(e).toHexString()))}))}}),at().createElement(ut.A,{disabled:!T||!u,key:Lo,onClick:function(){o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},Lo,(null==y?void 0:y[Lo])||m[Lo]))}))},className:"no-border"},at().createElement(ct.e6,{glyph:"repeat"})))),at().createElement("div",{className:"color-item"},at().createElement(ct.mq,{className:"label-theme"},at().createElement(pt.A,{msgId:"contextCreator.configureThemes.primaryContrast"}),at().createElement(Do.A,{bsStyle:"link",text:at().createElement(pt.A,{msgId:"contextCreator.configureThemes.tooltips.primaryContrast"})}),S?at().createElement(Ao.A,{useBody:!0,className:"ms-custom-theme-picker-popover",ref:function(e){e&&(b.current=e.trigger)},placement:"top",content:at().createElement("div",null,at().createElement(xo.A,{msgId:"geostory.customizeTheme.alternativeTextColorPopover",msgParams:{color:S}}),at().createElement(ut.A,{bsSize:"xs",bsStyle:"primary",style:{margin:"auto",display:"block"},onClick:function(){var e,t;o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},_o,S))})),null===(e=b.current)||void 0===e||null===(t=e.hide)||void 0===t||t.call(e)}},at().createElement(pt.A,{msgId:"geostory.customizeTheme.useAlternativeTextColor"})))},at().createElement(ut.A,{disabled:!u,className:"square-button no-border",style:{display:S?"block":"none"}},at().createElement(ct.e6,{glyph:"exclamation-mark"}))):null),at().createElement("div",{className:"color-choice"},at().createElement(jo.A,{disabled:!u,onOpen:function(){return{}},color:h[_o],line:!1,disableAlpha:!1,onChangeColor:function(e){o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},_o,To()(e).toHexString()))}))}}),at().createElement(ut.A,{disabled:!x||!u,key:_o,onClick:function(){o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},_o,(null==y?void 0:y[_o])||m[_o]))}))},className:"no-border"},at().createElement(ct.e6,{glyph:"repeat"})))),at().createElement("div",{className:"color-item"},at().createElement(ct.mq,{className:"label-theme"},at().createElement(pt.A,{msgId:"contextCreator.configureThemes.primary"}),at().createElement(Do.A,{bsStyle:"link",text:at().createElement(pt.A,{msgId:"contextCreator.configureThemes.tooltips.primary"})})),at().createElement("div",{className:"color-choice"},at().createElement(jo.A,{disabled:!u,onOpen:function(){return{}},color:h[Bo],line:!1,disableAlpha:!1,onChangeColor:function(e){o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},Bo,To()(e).toHexString()))}))}}),at().createElement(ut.A,{disabled:!j||!u,key:Bo,onClick:function(){o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},Bo,(null==y?void 0:y[Bo])||m[Bo]))}))},className:"no-border"},at().createElement(ct.e6,{glyph:"repeat"})))),at().createElement("div",{className:"color-item"},at().createElement(ct.mq,{className:"label-theme"},at().createElement(pt.A,{msgId:"contextCreator.configureThemes.successContrast"}),at().createElement(Do.A,{bsStyle:"link",text:at().createElement(pt.A,{msgId:"contextCreator.configureThemes.tooltips.successContrast"})}),O?at().createElement(Ao.A,{useBody:!0,className:"ms-custom-theme-picker-popover",ref:function(e){e&&(v.current=e.trigger)},placement:"top",content:at().createElement("div",null,at().createElement(xo.A,{msgId:"geostory.customizeTheme.alternativeTextColorPopover",msgParams:{color:O}}),at().createElement(ut.A,{bsSize:"xs",bsStyle:"primary",style:{margin:"auto",display:"block"},onClick:function(){var e,t;o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},Go,O))})),null===(e=v.current)||void 0===e||null===(t=e.hide)||void 0===t||t.call(e)}},at().createElement(pt.A,{msgId:"geostory.customizeTheme.useAlternativeTextColor"})))},at().createElement(ut.A,{disabled:!u,className:"square-button no-border",style:{display:O?"block":"none"}},at().createElement(ct.e6,{glyph:"exclamation-mark"}))):null),at().createElement("div",{className:"color-choice"},at().createElement(jo.A,{disabled:!u,onOpen:function(){return{}},color:h[Go],line:!1,disableAlpha:!1,onChangeColor:function(e){o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},Go,To()(e).toHexString()))}))}}),at().createElement(ut.A,{disabled:!A||!u,key:Go,onClick:function(){o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},Go,(null==y?void 0:y[Go])||m[Go]))}))},className:"no-border"},at().createElement(ct.e6,{glyph:"repeat"})))),at().createElement("div",{className:"color-item"},at().createElement(ct.mq,{className:"label-theme"},at().createElement(pt.A,{msgId:"contextCreator.configureThemes.success"}),at().createElement(Do.A,{bsStyle:"link",text:at().createElement(pt.A,{msgId:"contextCreator.configureThemes.tooltips.success"})}),C?at().createElement(Ao.A,{useBody:!0,className:"ms-custom-theme-picker-popover",ref:function(e){e&&(v.current=e.trigger)},placement:"top",content:at().createElement("div",null,at().createElement(xo.A,{msgId:"contextCreator.configureThemes.alternativeTextPrimarySecondary",msgParams:{color:C}}),at().createElement(ut.A,{bsSize:"xs",bsStyle:"primary",style:{margin:"auto",display:"block"},onClick:function(){var e,t;o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},zo,C))})),null===(e=v.current)||void 0===e||null===(t=e.hide)||void 0===t||t.call(e)}},at().createElement(pt.A,{msgId:"geostory.customizeTheme.useAlternativeTextColor"})))},at().createElement(ut.A,{disabled:!u,className:"square-button no-border",style:{display:C?"block":"none"}},at().createElement(ct.e6,{glyph:"exclamation-mark"}))):null),at().createElement("div",{className:"color-choice"},at().createElement(jo.A,{disabled:!u,onOpen:function(){return{}},color:h[zo],line:!1,disableAlpha:!1,onChangeColor:function(e){o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},zo,To()(e).toHexString()))}))}}),at().createElement(ut.A,{disabled:!D||!u,key:zo,onClick:function(){o(Fo(Fo({},s),{},{variables:Fo(Fo({},h),{},Ro({},zo,(null==y?void 0:y[zo])||m[zo]))}))},className:"no-border"},at().createElement(ct.e6,{glyph:"repeat"})))),at().createElement("p",null,at().createElement(pt.A,{msgId:"contextCreator.configureThemes.guidelines"}))))};function qo(e){return qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qo(e)}function Wo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ei(r.key),r)}}function Ho(e,t,n){return t=Jo(t),function(e,t){if(t&&("object"==qo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ko()?Reflect.construct(t,n||[],Jo(e).constructor):t.apply(e,n))}function Ko(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ko=function(){return!!e})()}function Jo(e){return Jo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Jo(e)}function Xo(e,t){return Xo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Xo(e,t)}function Yo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yo(Object(n),!0).forEach(function(t){Qo(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yo(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Qo(e,t,n){return(t=ei(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ei(e){var t=function(e){if("object"!=qo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=qo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==qo(t)?t:t+""}var ti=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ho(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xo(e,t)}(t,e),function(e,t){return t&&Wo(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"componentDidMount",value:function(){this.props.onInit({tutorials:this.props.tutorials})}},{key:"componentDidUpdate",value:function(){this.props.tutorialsList||this.props.onInit({tutorials:this.props.tutorials})}},{key:"render",value:function(){var e=this,t=function(t){var n,r,o=e.props.tutorials[t]?[{id:"show-tutorial",onClick:function(){return e.props.onShowTutorial(t)},label:"contextCreator.showTutorial"}]:[],i=null!==(n=null===(r=e.props.items)||void 0===r?void 0:r.map(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).toolbarBtn}))&&void 0!==n?n:[];return o=o.concat(i),"configure-map"===t&&(o=o.concat({id:"map-reload",onClick:function(){return e.props.onReloadConfirm(!0)},label:"contextCreator.configureMap.reload"})),o},n=[{id:"general-settings",label:"contextCreator.generalSettings.label",extraToolbarButtons:t("general-settings"),disableNext:!this.props.resource.name||!this.props.newContext.windowTitle||!this.props.newContext.windowTitle.length||this.props.loading||!this.props.isValidContextName||!this.props.contextNameChecked,component:at().createElement(Pt,{contextId:this.props.contextId,contextName:this.props.resource.name,windowTitle:this.props.newContext.windowTitle,isValidContextName:this.props.isValidContextName,contextNameChecked:this.props.contextNameChecked,loading:this.props.loading&&this.props.loadFlags.contextNameCheck,context:this.context,onChange:this.props.onChangeAttribute})},{id:"configure-map",label:"contextCreator.configureMap.label",extraToolbarButtons:t("configure-map"),component:at().createElement(Co,{pluginsConfig:this.props.ignoreViewerPlugins?this.props.pluginsConfig:J()(this.props.pluginsConfig).reduce(function(t,n){return $o($o({},t),{},Qo({},n,(r=e.props.pluginsConfig[n],e.props.viewerPlugins.map(function(e){var t=b()(e)?e.name:e,n=E()(r,function(e){return t===(b()(e)?e.name:e)});if(n){if(b()(e)&&e.overrides){var o=b()(n)?n:{name:n},i=$o($o({},n.cfg||{}),e.overrides&&e.overrides.cfg||{});return $o($o({},o),{},{cfg:i})}return n}return e}))));var r},{}),plugins:this.context.plugins,mapType:this.props.mapType,showConfirm:this.props.showReloadConfirm,onReloadConfirm:this.props.onReloadConfirm,onMapViewerReload:this.props.onMapViewerReload})},{id:"configure-plugins",label:"contextCreator.configurePlugins.label",extraToolbarButtons:t("configure-plugins"),disableNext:!this.props.allAvailablePlugins.filter(function(e){return e.enabled&&void 0===f()(e,"pluginConfig.cfg.containerPosition")}).length||!!this.props.cfgError||!this.props.isCfgValidated,component:at().createElement(Po,{user:this.props.user,loading:this.props.loading,loadFlags:this.props.loadFlags,tutorialMode:"run"===this.props.tutorialStatus,tutorialStep:this.props.tutorialStep,allPlugins:this.props.allAvailablePlugins,editedPlugin:this.props.editedPlugin,editedCfg:this.props.editedCfg,cfgError:this.props.cfgError,availablePluginsFilterText:this.props.availablePluginsFilterText,enabledPluginsFilterText:this.props.enabledPluginsFilterText,documentationBaseURL:this.props.documentationBaseURL,showDescriptionTooltip:this.props.showPluginDescriptionTooltip,descriptionTooltipDelay:this.props.pluginDescriptionTooltipDelay,showDialog:this.props.showDialog,mapTemplates:this.props.mapTemplates,parsedTemplate:this.props.parsedTemplate,editedTemplate:this.props.editedTemplate,fileDropStatus:this.props.fileDropStatus,availableTemplatesFilterText:this.props.availableTemplatesFilterText,enabledTemplatesFilterText:this.props.enabledTemplatesFilterText,onFilterAvailablePlugins:this.props.onFilterAvailablePlugins,onFilterEnabledPlugins:this.props.onFilterEnabledPlugins,onEditPlugin:this.props.onEditPlugin,onEnablePlugins:this.props.onEnablePlugins,onDisablePlugins:this.props.onDisablePlugins,onUpdateCfg:this.props.onUpdateCfg,setSelectedPlugins:this.props.setSelectedPlugins,changePluginsKey:this.props.changePluginsKey,uploading:this.props.uploading,uploadResult:this.props.uploadResult,onEnableUpload:this.props.onEnableUploadPlugin,uploadEnabled:this.props.uploadEnabled,pluginsToUpload:this.props.pluginsToUpload,onUpload:this.props.onUploadPlugin,onAddUpload:this.props.onAddUploadPlugin,onRemoveUpload:this.props.onRemoveUploadPlugin,changeTemplatesKey:this.props.changeTemplatesKey,setSelectedTemplates:this.props.setSelectedTemplates,setParsedTemplate:this.props.setParsedTemplate,setFileDropStatus:this.props.setFileDropStatus,onShowDialog:this.props.onShowDialog,onRemovePlugin:this.props.onRemovePlugin,onSaveTemplate:this.props.onSaveTemplate,onDeleteTemplate:this.props.onDeleteTemplate,onEditTemplate:this.props.onEditTemplate,onFilterAvailableTemplates:this.props.onFilterAvailableTemplates,onFilterEnabledTemplates:this.props.onFilterEnabledTemplates,hideUploadExtension:this.props.hideUploadExtension})},{id:"configure-themes",label:"contextCreator.configureThemes.label",extraToolbarButtons:t("configure-themes"),disableNext:!1,component:at().createElement(Vo,{themes:this.props.themes,customVariablesEnabled:this.props.customVariablesEnabled,basicVariables:this.props.basicVariables,setSelectedTheme:this.props.setSelectedTheme,onToggleCustomVariables:this.props.onToggleCustomVariables,selectedTheme:this.props.selectedTheme})}];return at().createElement(vt,{enableClickOnStep:this.props.enableClickOnStep,loading:this.props.loading&&this.props.loadFlags.contextSaving,currentStepId:this.props.curStepId,onSetStep:this.props.onSetStep,onSave:function(){return e.props.onSave(e.props.saveDestLocation)},onShowBackToPageConfirmation:this.props.onShowBackToPageConfirmation,showBackToPageConfirmation:this.props.showBackToPageConfirmation,backToPageConfirmationMessage:this.props.backToPageConfirmationMessage,onConfirmBackToPage:function(){return e.context.router.history.push(e.props.backToPageDestRoute)},steps:this.props.stepIds.map(function(e){return n.find(function(t){return t.id===e})}),hideSaveButton:this.props.hideSaveButton,hideCloseButton:this.props.hideCloseButton})}}])}(at().Component);Qo(ti,"propTypes",{user:lt.object,loading:lt.bool,loadFlags:lt.object,contextId:lt.object,isValidContextName:lt.bool,contextNameChecked:lt.bool,curStepId:lt.string,tutorialStatus:lt.string,tutorialStep:lt.string,newContext:lt.object,resource:lt.object,pluginsConfig:lt.object,pluginsToUpload:lt.array,viewerPlugins:lt.array,ignoreViewerPlugins:lt.bool,allAvailablePlugins:lt.array,editedPlugin:lt.string,editedCfg:lt.string,isCfgValidated:lt.bool,cfgError:lt.object,mapTemplates:lt.array,parsedTemplate:lt.object,editedTemplate:lt.object,fileDropStatus:lt.string,availablePluginsFilterText:lt.string,enabledPluginsFilterText:lt.string,availableTemplatesFilterText:lt.string,enabledTemplatesFilterText:lt.string,documentationBaseURL:lt.string,showPluginDescriptionTooltip:lt.bool,pluginDescriptionTooltipDelay:lt.number,onFilterAvailablePlugins:lt.func,onFilterEnabledPlugins:lt.func,onFilterAvailableTemplates:lt.func,onFilterEnabledTemplates:lt.func,setSelectedPlugins:lt.func,setSelectedTemplates:lt.func,setParsedTemplate:lt.func,setFileDropStatus:lt.func,changePluginsKey:lt.func,changeTemplatesKey:lt.func,mapType:lt.string,showReloadConfirm:lt.bool,showDialog:lt.object,onInit:lt.func,onSetStep:lt.func,onShowTutorial:lt.func,onChangeAttribute:lt.func,onSave:lt.func,onSaveTemplate:lt.func,onDeleteTemplate:lt.func,onEditTemplate:lt.func,onEditPlugin:lt.func,onEnablePlugins:lt.func,onDisablePlugins:lt.func,onUpdateCfg:lt.func,onEnableUploadPlugin:lt.func,onUploadPlugin:lt.func,onAddUploadPlugin:lt.func,onRemoveUploadPlugin:lt.func,uploadEnabled:lt.bool,onMapViewerReload:lt.func,onReloadConfirm:lt.func,saveDestLocation:lt.string,uploading:lt.array,uploadResult:lt.object,onShowDialog:lt.func,onRemovePlugin:lt.func,onShowBackToPageConfirmation:lt.func,showBackToPageConfirmation:lt.bool,backToPageDestRoute:lt.string,backToPageConfirmationMessage:lt.string,tutorials:lt.object,tutorialsList:lt.oneOfType([lt.bool,lt.object]),themes:lt.array,setSelectedTheme:lt.func,selectedTheme:lt.string,basicVariables:lt.object,customVariablesEnabled:lt.bool,onToggleCustomVariables:lt.func,enableClickOnStep:lt.bool,items:lt.array,stepIds:lt.array,hideUploadExtension:lt.bool,hideSaveButton:lt.bool,hideCloseButton:lt.bool}),Qo(ti,"contextTypes",{messages:lt.object,plugins:lt.object,router:lt.object}),Qo(ti,"defaultProps",{loading:!1,loadFlags:{},isValidContextName:!0,contextNameChecked:!0,newContext:{},resource:{},themes:[{id:"dark",label:"Dark",type:"link",href:"/static/mapstore/dist/themes/dark.css",defaultVariables:{"ms-main-color":"#eeeeee","ms-main-bg":"#333333","ms-primary-contrast":"#111111","ms-primary":"#43a4ff","ms-success-contrast":"#111111","ms-success":"#398439"}}],viewerPlugins:["Map","BackgroundSelector","MetadataExplorer",{name:"TOC",overrides:{cfg:{activateQueryTool:!0}}},"TOCItemsSettings","SecurityPopup","DrawerMenu","OmniBar","Search","BurgerMenu","AddGroup","Notifications","QueryPanel","MapFooter","CRSSelector","MousePosition","ScaleBox","Toolbar","MapLoading","StyleEditor",{name:"Identify",overrides:{cfg:{showEdit:!1}}},"Locate","ZoomIn","ZoomOut","ZoomAll","Annotations","MapImport","MapExport","Undo","Redo","Expander","FilterLayer","GlobeViewSwitcher",{name:"FeatureEditor",overrides:{cfg:{editingAllowedRoles:[]}}}],ignoreViewerPlugins:!1,allAvailablePlugins:[],isCfgValidated:!1,curStepId:"general-settings",saveDestLocation:"/",onInit:function(){},onSetStep:function(){},onShowTutorial:function(){},onChangeAttribute:function(){},onToggleCustomVariables:function(){},onReloadConfirm:function(){},uploadEnabled:!1,pluginsToUpload:[],onShowBackToPageConfirmation:function(){},showBackToPageConfirmation:!1,backToPageDestRoute:"/",backToPageConfirmationMessage:"contextCreator.undo",tutorials:u.k9,tutorialsList:!1,stepIds:["general-settings","configure-map","configure-plugins","configure-themes"]});var ni=(0,i.j8)({user:ce.dt,curStepId:s.hl,tutorialStatus:function(e){var t;return null===(t=function(e){return e&&e.tutorial}(e))||void 0===t?void 0:t.status},tutorialsList:s.b7,tutorialStep:s.ue,newContext:s.pu,resource:s.oz,allAvailablePlugins:s.yj,editedPlugin:s.ir,editedCfg:s.BT,isCfgValidated:s.po,cfgError:s.E5,mapTemplates:s.oH,parsedTemplate:s.bU,editedTemplate:s.bg,fileDropStatus:s.fD,availablePluginsFilterText:s.Cw,enabledPluginsFilterText:s.en,availableTemplatesFilterText:s.r8,enabledTemplatesFilterText:s.bF,mapType:c.GS,showReloadConfirm:s.x6,showDialog:s.HV,loading:s.QW,loadFlags:s.PH,isValidContextName:s.iX,contextNameChecked:s.hm,uploadEnabled:function(e){return e.contextcreator&&e.contextcreator.uploadPluginEnabled},uploading:function(e){return e.contextcreator&&e.contextcreator.uploadingPlugin},uploadResult:function(e){return e.contextcreator&&e.contextcreator.uploadResult},pluginsToUpload:function(e){var t;return null===(t=e.contextcreator)||void 0===t?void 0:t.pluginsToUpload},pluginsConfig:function(){return a.Ay.getConfigProp("plugins")},showBackToPageConfirmation:s.n7,selectedTheme:s.c9,customVariablesEnabled:s.BE,enableClickOnStep:function(e){return!(0,s._E)(e)},hideUploadExtension:s.wJ});const ri=(0,l.i1)("ContextCreator",{component:(0,o.connect)(ni,{onFilterAvailablePlugins:u.og.bind(null,"availablePlugins"),onFilterEnabledPlugins:u.og.bind(null,"enabledPlugins"),onFilterAvailableTemplates:u.og.bind(null,"availableTemplates"),onFilterEnabledTemplates:u.og.bind(null,"enabledTemplates"),setSelectedPlugins:u.qL,setSelectedTemplates:u.Js,setSelectedTheme:u.fg,setParsedTemplate:u.kT,setFileDropStatus:u.A4,onEditPlugin:u.c4,onEditTemplate:u.X_,onUpdateCfg:u.Jk,changePluginsKey:u.I6,changeTemplatesKey:u.zE,onEnablePlugins:u.Uk,onDisablePlugins:u.ti,onInit:u.Ts,onSetStep:u.C2,onShowTutorial:u.Ox,onChangeAttribute:u.XM,onSave:u.Zq,onSaveTemplate:u.AI,onDeleteTemplate:u.I7,onMapViewerReload:u.e7,onReloadConfirm:u.L4,onEnableUploadPlugin:u.eM,onUploadPlugin:u.Hs,onAddUploadPlugin:u.rE,onRemoveUploadPlugin:u.zu,onShowDialog:u.ui,onRemovePlugin:u.cu,onShowBackToPageConfirmation:u.s9,onToggleCustomVariables:u.eg})(ti),reducers:{contextcreator:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.Zz:return R(R({},e),t.initState||{});case u.YF:return(0,w.hZ)("stepId",t.stepId,e);case u.Ys:return(0,w.hZ)("wasTutorialShown[".concat(t.stepId,"]"),!0,e);case u.Ud:return(0,w.hZ)("tutorialStep",t.stepId,e);case u.l7:return(0,w.hZ)("selectedTheme",t.theme,e);case u.QT:return(0,w.hZ)("mapViewerLoaded",t.status,e);case u.PM:return(0,w.hZ)("showReloadConfirm",t.show,e);case u.k5:return R(R({},e),{},{uploadPluginEnabled:t.enable,uploadingPlugin:[],pluginsToUpload:[],uploadResult:null});case u.A:return R(R({},e),{},{uploadResult:null,pluginsToUpload:[].concat(k(e.pluginsToUpload||[]),k(t.files))});case u.v9:return R(R({},e),{},{pluginsToUpload:e.pluginsToUpload.filter(function(e,n){return n!==t.index})});case u.os:var n=t.plugins.map(function(e){return{name:e,uploading:t.status}});return(0,w.hZ)("uploadingPlugin",[].concat(k((e.uploadingPlugin||[]).filter(function(e){return 0===n.filter(function(t){return t.name===e.name}).length})),k(n)),e);case u.X4:return(0,w.hZ)("uploadResult",{result:"error",files:t.files,error:t.error},e);case u.X8:var r,o,i=t.plugins.map(G);return R(R({},e),{},{pluginsToUpload:[],uploadResult:{result:"ok"},plugins:[].concat(k((e.plugins||[]).filter(function(e){return 0===i.filter(function(t){return t.name===e.name}).length})),k(i)),uploadedPlugins:C()((null!==(r=e.uploadedPlugins)&&void 0!==r?r:[]).concat((null!==(o=t.plugins)&&void 0!==o?o:[]).map(function(e){return e.name})))});case u.tL:return t.status?(0,w.hZ)("uninstallingPlugin",{name:t.plugin,uninstalling:!0},e):(0,w.hZ)("uninstallingPlugin",void 0,e);case u.Wq:return(0,w.hZ)("uninstallingPlugin",{name:t.plugin,uninstalling:!1,error:t.error},e);case u.iD:var l;return R(R({},e),{},{plugins:e.plugins.filter(function(e){return e.name!==t.plugin}),uploadedPlugins:(null!==(l=e.uploadedPlugins)&&void 0!==l?l:[]).filter(function(e){return e!==t.plugin})});case u.sb:var s,c=t.resource||{},p=c.data,d=void 0===p?{plugins:{desktop:[]}}:p,g=N(c,x),v=(0,T.RE)(d),h=v.plugins,P=void 0===h?{desktop:[]}:h,O=v.userPlugins,D=void 0===O?[]:O,I=v.templates,F=void 0===I?[]:I,z=v.theme,Z=v.customVariablesEnabled,V=N(v,j),q=f()(P,"desktop",[]),W=function(e,t){var n=f()(t,"desktop",[]).map(function(e){return b()(e)?e:{name:e}});return e?e.reduce(function(e,t){return f()(t,"children",[]).reduce(function(e,t){return e.filter(function(e){return e.name!==t})},e)},e).map(function(t){return G(t,null,e,n)}):U}(f()(t.pluginsConfig,"plugins"),a.Ay.getConfigProp("plugins")),H=[],K=function(e){return e.map(function(e){var t=function(t){return y()(t.filter(function(t){return _(t)===e.name}))},n=t(q),r=t(D),o=n||r;return o?(H.push(o.name),R(R({},e),{},{pluginConfig:R(R({},f()(e,"pluginConfig",{})),{},{cfg:f()(o,"cfg"),override:f()(o,"override")}),isUserPlugin:!!r,active:o.active||!1,children:K(e.children)})):e})},J=K(W),X=null===(s=B(J,"MapTemplates"))||void 0===s||null===(s=s.pluginConfig)||void 0===s||null===(s=s.cfg)||void 0===s?void 0:s.allowedTemplates,Y=(t.type,N(t,A));return(0,w.hZ)("initialEnabledPlugins",H,(0,w.hZ)("templates",(t.allTemplates||[]).map(function(e){return R(R(R({},e),e.thumbnail?{thumbnail:decodeURIComponent(e.thumbnail)}:{}),{},{attributes:R(R({},e.thumbnail?{thumbnail:decodeURIComponent(e.thumbnail)}:{}),e.format?{format:e.format}:{}),enabled:(X||F||[]).reduce(function(t,n){return t||n.id===e.id},!1),selected:!1})}),(0,w.hZ)("newContext",V,(0,w.hZ)("plugins",J,(0,w.hZ)("resource",g,(0,w.hZ)("selectedTheme",z,(0,w.hZ)("customVariablesEnabled",Z,(0,w.hZ)("prefetchedData",Y,e))))))));case u.hn:var $=t.resource||{},Q=f()(e,"templates",[]),ee=E()(Q,function(e){return e.id===$.id});return t.resource?(0,w.hZ)("templates",[].concat(k(Q.filter(function(e){return e.id!==$.id})),[R(R({},$),S()(ee,"enabled","selected"))]),e):e;case u.Ic:return(0,w.hZ)("isValidContextName",t.valid,e);case u.W4:return(0,w.hZ)("contextNameChecked",t.checked,e);case u.HF:return{};case u.V0:return R(R({},e),{},{contextId:t.id});case u.GM:return(0,w.hZ)("filterText.".concat(t.propName),t.text,e);case u.Au:var te=t.ids||[];return(0,w.hZ)("plugins",f()(e,"plugins",[]).map(function(e){return R(R({},e),{},{selected:te.reduce(function(t,n){return t||n===e.name},!1)})}),e);case u.Fo:var ne=t.ids||[];return(0,w.hZ)("templates",f()(e,"templates",[]).map(function(e){return R(R({},e),{},{selected:ne.reduce(function(t,n){return t||n===e.id},!1)})}),e);case u.gh:return(0,w.hZ)("parsedTemplate",{fileName:t.fileName,data:t.data,format:t.format},e);case u.Fi:return(0,w.hZ)("fileDropStatus",t.status,e);case u.EH:return(0,w.hZ)("editedTemplate",E()(f()(e,"templates",[]),function(e){return e.id===t.id}),e);case u.vi:return(0,w.hZ)("templates",t.templates,e);case u.$F:return(0,w.hZ)("editedPlugin",t.pluginName,e);case u.aP:return(0,w.hZ)("plugins",L(f()(e,"plugins",[]),t.ids||[],t.key,t.value),e);case u.Zy:return(0,w.hZ)("templates",f()(e,"templates",[]).map(function(e){return R(R({},e),{},M({},t.key,(t.ids||[]).reduce(function(t,n){return t||n===e.id},!1)?t.value:e[t.key]))}),e);case u.SU:var re=B(f()(e,"plugins",[]),t.pluginName);return t.pluginName?(0,w.hZ)("editedCfg",JSON.stringify({cfg:m().apply(void 0,[f()(re,"pluginConfig.cfg",{})].concat(k("MapTemplates"===t.pluginName?["allowedTemplates"]:[]))),override:f()(re,"pluginConfig.override",{})},null,2),e):e;case u.DN:return(0,w.hZ)("editedCfg",t.cfg,e);case u.m7:return(0,w.hZ)("validationStatus",t.status,e);case u.KG:return(0,w.hZ)("parsedCfg",t.parsedCfg,e);case u.jE:return(0,w.hZ)("cfgError",t.error,e);case u.Gj:return"name"===t.key?(0,w.hZ)("resource.name",t.value,e):(0,w.hZ)("newContext.".concat(t.key),t.value,e);case u.xO:return(0,w.hZ)("showDialog.".concat(t.dialogName),t.show,(0,w.hZ)("showDialog.".concat(t.dialogName,"Payload"),t.payload,e));case u.F5:return(0,w.hZ)("loading"===t.name?"loading":"loadFlags.".concat(t.name),t.value,(0,w.hZ)("loading",t.value,e));case u.gf:return(0,w.hZ)("showBackToPageConfirmation",t.show,e);case u.$g:return(0,w.hZ)("customVariablesEnabled",!e.customVariablesEnabled,e);default:return e}}},epics:r})},347837(e,t,n){n.d(t,{A:()=>E});var r=n(785072),o=n.n(r),i=n(664727);o()(i.A,{insert:"head",singleton:!1}),i.A.locals;var a=n(605556),l=n.n(a),s=n(273517),c=n.n(s),u=n(8117);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function d(e,t,n){return t=g(t),function(e,t){if(t&&("object"==p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,m()?Reflect.construct(t,n||[],g(e).constructor):t.apply(e,n))}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(m=function(){return!!e})()}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}function v(e,t,n){return(t=y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e){var t=function(e){if("object"!=p(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}var h=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return v(e=d(this,t,[].concat(r)),"onFilter",function(t){e.props.onFilter(t.target.value)}),v(e,"onClear",function(){e.props.onFilter("")}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.props.filterText?c().createElement(u.N,{placement:"bottom",overlay:c().createElement(u.m_,{id:"mapstore-toc-filter"},this.props.tooltipClear)},c().createElement(u.e6,{glyph:"1-close",className:"text-primary close-filter",onClick:this.onClear})):c().createElement(u.e6,{className:"text-primary",glyph:"filter"});return c().createElement(u.gE,{className:"mapstore-filter"},c().createElement(u.MG,null,c().createElement(u.MJ,{value:this.props.filterText,placeholder:this.props.filterPlaceholder,onChange:this.onFilter,onFocus:this.props.onFocus,type:"text"}),c().createElement(u.MG.Addon,{className:"square-button"},this.props.loading?c().createElement("div",{className:"toc-inline-loader"}):e)))}}])&&f(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(c().Component);v(h,"propTypes",{loading:l().bool,filterText:l().string,filterPlaceholder:l().oneOfType([l().object,l().string]),onFilter:l().func,onFocus:l().func,tooltipClear:l().oneOfType([l().object,l().string])}),v(h,"defaultProps",{loading:!1,filterText:"",filterPlaceholder:"",onFilter:function(){},onFocus:function(){},tooltipClear:"Clear"});const E=h},564116(e,t,n){n.d(t,{Ud:()=>a,ic:()=>s,x9:()=>i});var r=n(962028),o=n.n(r),i={json:"ext-json",wmc:"ext-wmc"},a={json:"JSON",wmc:"WMC"},l=[{outputFormat:"shape-zip",extension:"zip"},{outputFormat:"csv",extension:"csv"},{outputFormat:"excel",extension:"xls"},{outputFormat:"excel2007",extension:"xlsx"},{outputFormat:"dxf",extension:"dxf"},{outputFormat:"dxf-zip",extension:"zip"},{outputFormat:"application/vnd.google-earth.kml+xml",extension:"kml"},{outputFormat:"application/json",extension:"json"},{outputFormat:"gml3",extension:"gml"},{outputFormat:"GML2",extension:"gml"},{outputFormat:"application/vnd.googlxml",extension:"kml"},{outputFormat:"OGR-CSV",extension:"csv"},{outputFormat:"OGR-FileGDB",extension:"gdb"},{outputFormat:"OGR-GPKG",extension:"gpkg"},{outputFormat:"OGR-KML",extension:"kml"},{outputFormat:"OGR-MIF",extension:"mif"},{outputFormat:"OGR-TAB",extension:"tab"},{outputFormat:"SHAPE-ZIP",extension:"zip"},{outputFormat:"gml32",extension:"gml"},{outputFormat:"application/x-gpk",extension:"gpk"}],s=function(e){return o()(l.filter(function(t){return t.outputFormat===e}))||function(e){var t=e.split(/[^\w]/)[1];return t?{outputFormat:e,extension:t.toLowerCase()}:void 0}(e)}},596006(e,t,n){n.d(t,{A:()=>y});var r=n(273517),o=n.n(r),i=n(605556),a=n.n(i),l=n(8117),s=n(779893);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function p(e,t,n){return t=d(t),function(e,t){if(t&&("object"==c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,f()?Reflect.construct(t,n||[],d(e).constructor):t.apply(e,n))}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(f=function(){return!!e})()}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function g(e,t,n){return(t=b(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}var v=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return g(e=p(this,t,[].concat(r)),"getContainerNode",function(t){return t?document.body:e.parentNode||document.querySelector("."+(s.Ay.getConfigProp("themePrefix")||"ms2")+" > div")||document.body}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this,t=this.getContainerNode(this.props.useBody);return o().createElement("div",{ref:function(t){e.parentNode=t&&t.parentNode},className:this.props.className,style:this.props.style},o().createElement(l.N,{ref:function(t){e.trigger=t},trigger:["click"],container:t,placement:this.props.placement,rootClose:!0,overlay:o().createElement(l.AM,{id:this.props.id,title:this.props.title,className:this.props.popoverClassName},this.props.content)},this.props.children))}}])&&u(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o().Component);g(v,"propTypes",{id:a().string,style:a().object,className:a().string,popoverClassName:a().string,placement:a().string,title:a().node,content:a().node,useBody:a().bool}),g(v,"defaultProps",{id:"",useBody:!1});const y=v},664727(e,t,n){n.d(t,{A:()=>i});var r=n(576314),o=n.n(r)()(function(e){return e[1]});o.push([e.id,".msgapi .mapstore-filter input::-ms-clear,\n.msgapi .mapstore-filter input::-ms-reveal {\n  display: none;\n}\n",""]);const i=o},715773(e,t,n){n.d(t,{A:()=>f});var r=n(273517),o=n.n(r),i=n(109766),a=n(271020);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(null,arguments)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){p(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function p(e,t,n){return(t=function(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const f=(0,n(811668).connect)(function(e){return{mapLayout:e.maplayout}},{onContentResize:a.Ix})(function(e){return o().createElement(i.A,s({},e,{onResize:function(t){if(void 0!==t.bottom){var n=Math.max(0,t.bottom-35),r=e.mapLayout,o=r.boundingMapRect,i=r.layout,a=r.boundingSidebarRect;e.onContentResize(u(u(u({},i),a),{},{boundingMapRect:u(u({},o),{},{bottom:n})}))}}}))})},717140(e,t,n){n.d(t,{Ij:()=>g,Jb:()=>o,Kf:()=>s,Lu:()=>i,Ly:()=>p,Mm:()=>m,Mr:()=>v,Ne:()=>c,Nu:()=>O,Q4:()=>a,S$:()=>u,V9:()=>r,VX:()=>b,ZM:()=>l,d:()=>y,et:()=>d,jx:()=>E,tq:()=>h,uw:()=>P,vK:()=>f,vw:()=>S});var r="CHANGE_DRAWING_STATUS",o="DRAW:END_DRAWING",i="DRAW:SET_CURRENT_STYLE",a="DRAW:GEOMETRY_CHANGED",l="DRAW:DRAW_SUPPORT_STOPPED",s="DRAW:SET_SNAPPING_LAYER",c="DRAW:SNAPPING_IS_LOADING",u="DRAW:TOGGLE_SNAPPING",p="DRAW:SET_SNAPPING_CONFIG";function f(e,t,n,r,o){return{type:a,features:e,owner:t,enableEdit:n,textChanged:r,circleChanged:o}}function d(){return{type:"DRAW:FEATURES_SELECTED",features:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}}function m(){return{type:"DRAW:DRAWING_FEATURES",features:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}}function g(){return{type:l}}function b(e,t,n,o,i,a){return{type:r,status:e,method:t,owner:n,features:o,options:i,style:a}}function v(e,t){return{type:o,geometry:e,owner:t}}function y(e){return{type:i,currentStyle:e}}var h=function(e){return b("clean","",e,[],{})};function E(){return{type:u}}function P(e){return{type:s,snappingLayer:e}}function S(){return{type:c}}function O(e,t,n){return{type:p,value:e,prop:t,pluginCfg:n}}},967858(e,t,n){n.d(t,{d:()=>u,p:()=>p});var r=n(415392),o=n(45388),i=n.n(o),a=n(130711),l=n(717140),s=n(273494),c=n(762686),u="export-context",p=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e,t){return i().Observable.from([(0,r.fN)(t,"enabled",null)])},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e,t){return(0,a.cU)(t)(e)};return e.ofType(l.V9,s.QH,c.Pn).filter(function(e){var r=e.type,o=e.status,i=e.owner,a=e.eventName,p=e.toolName,f=u(t.getState(),n);switch(r){case c.Pn:return"featureGrid"!==n;case s.QH:return f&&"click"===a&&p!==n;case l.V9:return f&&("drawOrEdit"===o||"start"===o)&&i!==n;default:return f&&"annotations"!==n}}).switchMap(function(e){return u(t.getState(),n)?o(t.getState(),n,e):i().Observable.empty()})}}}]);