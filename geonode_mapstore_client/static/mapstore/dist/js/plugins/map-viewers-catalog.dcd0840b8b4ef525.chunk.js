"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[8650],{777693:(e,t,n)=>{n.d(t,{A:()=>O});var r=n(273517),o=n.n(r),l=n(605556),i=n.n(l),a=n(8117),c=n(8571),u=n(836970);var s=n(890559),f=n(275705),m=n(753103),p=n(221604);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function y(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){v(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function v(e,t,n){return(t=function(e){var t=function(e){if("object"!=d(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,l,i,a=[],c=!0,u=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=l.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return a}}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return S(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function E(e){var t=e.request,n=e.responseToEntries,l=e.pageSize,i=e.style,d=e.placeholderId,g=e.onSelect,v=e.onClose,h=e.titleId,S=e.noResultId,E=e.loading,O=e.params,P=(0,r.useRef)(),j=w((0,r.useState)([]),2),A=j[0],C=j[1],k=w((0,r.useState)(!1),2),I=k[0],N=k[1],R=w((0,r.useState)(1),2),T=R[0],M=R[1],V=w((0,r.useState)(!1),2),L=V[0],x=V[1],D=w((0,r.useState)(""),2),z=D[0],U=D[1],_=(0,r.useRef)(),H=I||!!E;!function(e){var t=e.scrollContainer,n=e.shouldScroll,o=void 0===n?function(){return!0}:n,l=e.onLoad,i=e.offset,a=void 0===i?200:i,c=(0,r.useRef)({});c.current=function(){(t?t.scrollTop:document.body.scrollTop||document.documentElement.scrollTop)+(t?t.clientHeight:window.innerHeight)>=(t?t.scrollHeight:document.body.scrollHeight||document.documentElement.scrollHeight)-a&&o()&&l()},(0,r.useEffect)(function(){var e=t||window;function n(){c.current()}return e.addEventListener("scroll",n),function(){e.removeEventListener("scroll",n)}},[t])}({scrollContainer:P.current,shouldScroll:function(){return!I&&L},onLoad:function(){M(T+1)}});var q=(0,r.useRef)();return q.current=function(e){!I&&t&&(P.current&&e.reset&&(P.current.scrollTop=0),N(!0),t(b(b({},O),{},{q:z,page:e.page,pageSize:l})).then(function(t){if(_.current){var r=n(t);x(t.isNextPageAvailable),C(1===e.page?r:[].concat(y(A),y(r))),N(!1)}}).catch(function(){_.current&&N(!1)}))},(0,r.useEffect)(function(){return _.current=!0,function(){_.current=!1}},[]),(0,r.useEffect)(function(){T>1&&q.current({page:T})},[T]),(0,r.useEffect)(function(){M(1),q.current({page:1,reset:!0})},[z]),o().createElement("div",{className:"gn-resources-catalog",style:i},v&&o().createElement("div",{className:"gn-resources-catalog-head"},o().createElement("div",{className:"gn-resources-catalog-title"},o().createElement(c.A,{msgId:h})),o().createElement(u.A,{className:"square-button",onClick:function(){return v()}},o().createElement(a.e6,{glyph:"1-close"}))),o().createElement("div",{className:"gn-resources-catalog-filter"},o().createElement(p.A,{placeholder:d,value:z,debounceTime:300,onChange:function(e){return U(e)}}),z&&!I&&o().createElement(u.A,{onClick:function(){return U("")}},o().createElement(a.e6,{glyph:"remove"})),I&&o().createElement(s.A,null)),o().createElement("div",{ref:P,className:"gn-resources-catalog-body"},o().createElement("ul",{className:"gn-resources-catalog-list"},A.map(function(e){return o().createElement("li",{key:e.pk},o().createElement(m.A,{data:b(b({},e),{},{"@extras":{info:{thumbnailUrl:null==e?void 0:e.thumbnail_url}}}),readOnly:!0,layoutCardsStyle:"grid",metadata:[{path:"title",target:"header",width:100}],onClick:function(){return function(e){g(e)}(e)}}))}),0===A.length&&!I&&o().createElement("div",{className:"gn-resources-catalog-alert"},o().createElement(c.A,{msgId:S})))),H&&o().createElement("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:2,display:"flex",alignItems:"center",justifyContent:"center"}},o().createElement(f.A,{size:70})))}E.propTypes={request:i().func,responseToEntries:i().func,pageSize:i().number,placeholderId:i().string,onClose:i().func,onSelect:i().func,titleId:i().string,noResultId:i().string},E.defaultProps={responseToEntries:function(e){return e.resources},pageSize:10,placeholderId:"gnviewer.resourcesCatalogFilterPlaceholder",titleId:"gnviewer.resourcesCatalogTitle",noResultId:"gnviewer.resourcesCatalogEntriesNoResults",onSelect:function(){}};const O=E},337686:(e,t,n)=>{n.d(t,{A:()=>m});var r=n(415392),o=n(271020),l=n(97401),i=n(779893),a=n(959314);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){f(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function f(e,t,n){return(t=function(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const m={gnUpdateDatasetsCatalogMapLayout:function(e,t){return e.ofType(o.a,r.$4).filter(function(){var e;return null===(e=t.getState())||void 0===e||null===(e=e.controls)||void 0===e||null===(e=e.datasetsCatalog)||void 0===e?void 0:e.enabled}).filter(function(e){return e.source!==a.v.PANEL}).map(function(e){var n,r=e.layout,c=(0,i.Uh)("mapLayout")||{left:{sm:300,md:500,lg:600},right:{md:658},bottom:{sm:30}},u=(0,l.iS)(t.getState()),f=null!==(n=t.getState())&&void 0!==n&&null!==(n=n.controls)&&void 0!==n&&null!==(n=n.drawer)&&void 0!==n&&n.enabled?c.left.sm:null,m=(0,o.Ix)(s(s(s(s({},(0,l.u$)(t.getState())),r),{},{right:c.right.md},f&&{left:f}),{},{boundingMapRect:s(s({},(null==r?void 0:r.boundingMapRect)||{}),{},{right:c.right.md},f&&{left:f}),boundingSidebarRect:s(s({},u),null==r?void 0:r.boundingSidebarRect)}));return s(s({},m),{},{source:a.v.PANEL})})}}},761972:(e,t,n)=>{n.r(t),n.d(t,{default:()=>U});var r=n(273517),o=n.n(r),l=n(393149),i=n(811668),a=n(980971),c=n(801081),u=n(8117),s=n(8571),f=n(836970),m=n(794689),p=n(550501),d=n(415392),y=n(337686),g=n(45388),b=n(227341),v=n.n(b),w=n(638560),h=n(550719),S=n(172175),E=n(66178);const O={gnSetDefaultViewerEnabledPlugins:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState;return e.ofType(h.SG).filter(function(){return!v()((0,S.ly)(t()))}).switchMap(function(){var e,n,r=t(),o=null!==(e=null==r||null===(n=r.gnresource)||void 0===n?void 0:n.params)&&void 0!==e?e:{},l=o.pk,i=o.mapPk;if("new"===l&&i){var a,c,u=(null!==(a=(0,w.yj)(r))&&void 0!==a?a:[]).map(function(e){return e.name}),s=(null!==(c=(0,S.ly)(r))&&void 0!==c?c:[]).filter(function(e){return u.includes(e)});return g.Observable.of((0,h.Uk)(s))}return g.Observable.of((0,E.UY)([]))})}};var P=n(777693),j=n(229710),A=n(406250),C=n(425380),k=n(298013),I=n(267767);function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}var R=["enabled","onSetControl","match","resourcesParams","location","defaultViewerPlugins","onReplaceLocation","onSetMapViewer","onManageLinkedResource","onSetDefaultViewerPlugins"];function T(){return T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},T.apply(null,arguments)}function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach(function(t){L(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function L(e,t,n){return(t=function(e){var t=function(e){if("object"!=N(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==N(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var D=(0,i.connect)((0,c.Mz)([function(e){var t;return null==e||null===(t=e.controls)||void 0===t||null===(t=t.mapViewersCatalog)||void 0===t?void 0:t.enabled},function(e){var t;return null==e||null===(t=e.gnresource)||void 0===t?void 0:t.params},function(e){var t;return null==e||null===(t=e.controls)||void 0===t||null===(t=t[k.b.LINK_RESOURCE])||void 0===t?void 0:t.loading},function(e){var t;return null==e||null===(t=e.router)||void 0===t?void 0:t.location}],function(e,t,n,r){return{enabled:e,resourcesParams:t,loading:n,location:r}}),{onSetControl:d.fN.bind(null,"mapViewersCatalog","enabled"),onReplaceLocation:a.HC,onSetMapViewer:h.Hc,onManageLinkedResource:E.av,onSetDefaultViewerPlugins:E.UY})(function(e){var t,n,l=e.enabled,i=e.onSetControl,a=(e.match,e.resourcesParams),c=(e.location,e.defaultViewerPlugins),d=void 0===c?["Annotations","TOC","BackgroundSelector","Identify","QueryPanel","Measure","Print","MousePosition","Search","ScaleBox","GlobeViewSwitcher","ZoomAll","ZoomIn","ZoomOut","Timeline","MetadataExplorer","Widgets"]:c,y=(e.onReplaceLocation,e.onSetMapViewer),g=e.onManageLinkedResource,b=e.onSetDefaultViewerPlugins,v=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,R),w=(t=(0,r.useState)(""),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,l,i,a=[],c=!0,u=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=l.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return a}}(t,n)||function(e,t){if(e){if("string"==typeof e)return x(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),h=w[0],S=w[1],E=a||{},O=E.pk,N=E.mapPk;return(0,r.useEffect)(function(){return"new"===O&&N&&(S("select"),b(d)),function(){S("")}},[O,N]),o().createElement(o().Fragment,null,o().createElement(A.A,null,o().createElement(j.A,{title:o().createElement(s.A,{msgId:"link"===h?"gnviewer.selectLinkedMapViewer":"gnviewer.copyConfigurationFromTitle"}),show:l,size:"lg",clickOutEnabled:!1,onClose:function(){i(!1),S("")}},o().createElement(P.A,T({},v,{placeholderId:"gnviewer.mapViewersCatalogFilterPlaceholder",noResultId:"gnviewer.mapViewersCatalogEntriesNoResults",onSelect:function(e){"link"===h?g({resourceType:C.cI.VIEWER,source:N,target:e.pk,processType:k.b.LINK_RESOURCE}):((0,p.ax)().then(function(t){y({data:e.data},t)}),i(!1)),S("")},request:function(e){return(0,m.MZ)(V(V(V({},e),{},{"filter{resource_type}":"mapviewer"},O&&"new"!==O&&{"filter{-pk}":O}),"link"!==h&&{"include[]":"data"}))},style:{position:"relative",width:"100%",height:"100%"}})))),o().createElement(A.A,null,o().createElement(j.A,{title:"",show:"select"===h,clickOutEnabled:!1,onClose:null,fitContent:!0,modalClassName:"gn-new-map-viewer-action"},o().createElement("div",{className:"gn-new-map-viewer-action-wrapper"},o().createElement("div",{className:"gn-new-map-viewer-action-card"},o().createElement("div",null,o().createElement(I.A,{fontSize:"xxl"},o().createElement(u.e6,{glyph:"link"}))),o().createElement(f.A,{variant:"primary",onClick:function(){S("link"),i(!0)}},o().createElement(s.A,{msgId:"gnviewer.linkToViewer"}))),o().createElement("div",{className:"gn-new-map-viewer-action-card"},o().createElement("div",null,o().createElement(I.A,{fontSize:"xxl"},o().createElement(u.e6,{glyph:"context"}))),o().createElement(f.A,{variant:"primary",onClick:function(){return S("")}},o().createElement(s.A,{msgId:"gnviewer.createNewViewer"})))))))}),z=(0,i.connect)((0,c.Mz)([],function(){return{}}),{onClick:d.fN.bind(null,"mapViewersCatalog","enabled",!0)})(function(e){var t=e.onClick,n=e.size,r=e.variant;return o().createElement(f.A,{size:n,onClick:function(){t()},variant:r},o().createElement(s.A,{msgId:"gnviewer.copyConfigurationFrom"}))});const U=(0,l.i1)("MapViewersCatalog",{component:D,containers:{ActionNavbar:{name:"MapViewersCatalog",Component:z}},epics:V(V({},y.A),O),reducers:{}})},959314:(e,t,n)=>{n.d(t,{v:()=>r});var r={PANEL:"PANEL"}}}]);