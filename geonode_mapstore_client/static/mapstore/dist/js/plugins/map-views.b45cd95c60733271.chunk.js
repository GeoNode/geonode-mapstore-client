"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[7883],{221867(e,r,t){t.d(r,{Y:()=>o});var n=t(181817),i=t(731807),o=function(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r.resourceId,o=r.layer,u=r.resources,a=r.inverse,c=void 0!==a&&a,l=r.offset,f=void 0===l?0:l,s=null!=t?t:function(e,r){var t=r.inverse,n=r.offset;return"".concat(e.id,";inverse:").concat(t,";offset:").concat(n)}(o,{inverse:c,offset:f}),d=null==u?void 0:u.find(function(e){return e.id===s});return null!=d&&null!==(e=d.data)&&void 0!==e&&e.collection?Promise.resolve(d):{wfs:function(){return(0,n.x$)(o.url,o.name,{outputFormat:"application/json",srsname:"EPSG:4326"}).then(function(e){return e.data})},vector:function(){var e;return Promise.resolve({type:"FeatureCollection",features:null!==(e=o.features)&&void 0!==e?e:[]})}}[o.type]().then(function(e){return c?(0,i.rM)(e,{offset:f}):e}).then(function(e){return{id:s,updated:!0,data:{type:o.type,name:o.name,title:o.title,url:o.url,id:o.id,collection:e}}})}},665424(e,r,t){t.r(r),t.d(r,{default:()=>he});var n=t(273517),i=t.n(n),o=t(811668),u=t(393149),a=t(801081),c=t(958642);var l="MAP_VIEWS:SETUP_VIEWS",f="MAP_VIEWS:ACTIVATE_VIEWS",s="MAP_VIEWS:HIDE_VIEWS",d="MAP_VIEWS:SELECT_VIEW",p="MAP_VIEWS:UPDATE_VIEWS",v="MAP_VIEWS:UPDATE_RESOURCES",y="MAP_VIEWS:SET_PREVIOUS_VIEW",m=function(e){return{type:s,hide:e}},b=function(e){return{type:v,resources:e}},g=function(e){return{type:y,view:e}},w=t(538704),O=t(731807),E=t(668414),S=t.n(E);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function P(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return I(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?I(e,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function j(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function M(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?j(Object(t),!0).forEach(function(r){A(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):j(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function A(e,r,t){return(r=function(e){var r=function(e){if("object"!=h(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var t=r.call(e,"string");if("object"!=h(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==h(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var V={};var U=t(307679),T=t(508828),_=t(45388),k=t(227341),C=t.n(k),D=t(192779),z=t.n(D),W=t(415392),R=t(593429),L=t(621939),N=t(995134),H=t(165561),$=t(904059),x=t(762686),B=t(588100),Y=t(221867),F=t(747135),G=t(112585);function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}var J=["updated"];function q(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function X(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?q(Object(t),!0).forEach(function(r){Q(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):q(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function Q(e,r,t){return(r=function(e){var r=function(e){if("object"!=K(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var t=r.call(e,"string");if("object"!=K(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==K(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Z(e){return function(e){if(Array.isArray(e))return ee(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return ee(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ee(e,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}var re=(0,B.YH)(),te=["drawer","metadataexplorer","print","queryPanel"];const ne={updateMapViewsLayers:function(e,r){return e.ofType(d,p,f,s,l,w.mO,N.g$).filter(function(){var e=r.getState();return!(0,H.bJ)(e)&&(0,H.Bp)(e)}).switchMap(function(e){var t=r.getState(),n=(0,H.Bn)(t),i=(0,H.xc)(t),o=i||{},u=o.layers,a=void 0===u?[]:u,c=o.groups,l=void 0===c?[]:c,f=o.mask,s=void 0===f?{}:f,d=o.id;if(e.type!==N.g$&&re((null==n?void 0:n.layers)||[],a)&&re((null==n?void 0:n.mask)||{},s)&&re((null==n?void 0:n.groups)||[],l))return _.Observable.of(g(i));var p=(0,U.Kv)(t),v=(0,O.Wb)((0,U.mo)(t),i,!0),y=(0,O.wX)(p,i),m=(0,G.UA)(y,v).filter(function(e){var t=(p||[]).find(function(r){return r.id===e.id}),n=(0,O.jG)(e,t),o=e.group;if(o){var u,a=!1!==((null==i||null===(u=i.groups)||void 0===u||null===(u=u.find(function(e){return e.id===o}))||void 0===u?void 0:u.visibility)||!1),c=(0,U.mo)(r.getState()),l=(0,O.L9)(c||[],o);if(a!==(!1!==((null==l?void 0:l.visibility)||!1)))return!0}return n}),w=(0,H.sp)(t);return function(e,r){var t=r.getState(),n=(0,H.sp)(t),i=e||{},o=i.layers,u=void 0===o?[]:o,a=i.mask,c=void 0===a?{}:a;return _.Observable.defer(function(){var e=(0,U.Kv)(t),r=z()(c.resourceId)?(0,H.$E)(t,c.resourceId):void 0,i=null==e?void 0:e.find(function(e){var t;return e.id===(null==r||null===(t=r.data)||void 0===t?void 0:t.id)}),o=[{resource:r,options:c,vectorLayer:i}].concat(Z(u.filter(function(e){return e.clippingLayerResourceId}).map(function(r){var n=r.clippingLayerResourceId,i=z()(n)?(0,H.$E)(t,n):void 0,o=null==e?void 0:e.find(function(e){var r;return e.id===(null==i||null===(r=i.data)||void 0===r?void 0:r.id)});return{resource:i,vectorLayer:o}})));return Promise.all(o.filter(function(e){return e.resource}).map(function(e){var r=e.resource,t=e.options,i=e.vectorLayer;return(0,Y.Y)({resourceId:r.id,layer:X(X({},(null==i?void 0:i.features)&&{features:null==i?void 0:i.features}),r.data),inverse:null==t?void 0:t.inverse,offset:null==t?void 0:t.offset,resources:n}).then(function(e){return e}).catch(function(){return{id:r.id,error:!0}})}))})}(i,r).switchMap(function(e){var r,n=e.filter(function(e){return!e.error}),o=n.filter(function(e){return e.updated}),u=z()(s.resourceId)&&n.find(function(e){return e.id===s.resourceId});return _.Observable.of.apply(_.Observable,Z(o.length>0?[b(w.map(function(e){var r=o.find(function(r){return r.id===e.id})||{},t=(r.updated,function(e,r){if(null==e)return{};var t,n,i=function(e,r){if(null==e)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==r.indexOf(n))continue;t[n]=e[n]}return t}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],-1===r.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}(r,J));return C()(t)?e:t}))]:[]).concat([g(i),(0,R.v9)({owner:O.zU})],Z(m.map(function(e){var r,t,i=z()(e.clippingLayerResourceId)&&n.find(function(r){return r.id===e.clippingLayerResourceId}),o=z()(e.clippingPolygonFeatureId)&&(null===(r=(0,O.J1)(null==i||null===(t=i.data)||void 0===t||null===(t=t.collection)||void 0===t?void 0:t.features))||void 0===r?void 0:r.find(function(r){return r.id===e.clippingPolygonFeatureId}));return(0,R.E)(e.id,O.zU,"override",X(X({},e),o&&{clippingPolygon:o}))})),Z((0,F.NR)(t)&&null!=u&&null!==(r=u.data)&&void 0!==r&&null!==(r=r.collection)&&void 0!==r&&r.features?[(0,R.E)("".concat(d,"-mask"),O.zU,"overlay",{id:"".concat(d,"-mask"),type:"vector",features:u.data.collection.features,visibility:!0,style:{format:"geostyler",body:{name:"",rules:[{name:"",symbolizers:[{kind:"Fill",color:"#ffffff",fillOpacity:0,msClampToGround:!0,msClassificationType:"3d"}]}]}}})]:[])))})})},removeMapViewsLayersWhenDeactivated:function(e){return e.ofType(f).filter(function(e){return!e.active}).switchMap(function(){return _.Observable.of((0,R.v9)({owner:O.zU}),g())})},closePluginWhenMapViewsActivate:function(e,r){return e.ofType(f).filter(function(e){return e.active}).switchMap(function(){var e=r.getState();return te.find(function(r){var t;return!(null==e||null===(t=e.controls)||void 0===t||null===(t=t[r])||void 0===t||!t.enabled)})?_.Observable.of.apply(_.Observable,Z(te.map(function(e){return(0,W.fN)(e,"enabled",!1)}))):_.Observable.empty()})},hideMapViewsBasedOnLayoutChanges:function(e,r){return e.ofType(W.x7,W.$4,L.dP,w.mO,$.mU,x.lP).filter(function(e){return[L.dP,w.mO,$.mU,x.lP].includes(e.type)||te.includes(e.control)}).switchMap(function(){var e,t=r.getState();return te.find(function(e){var r;return!(null==t||null===(r=t.controls)||void 0===r||null===(r=r[e])||void 0===r||!r.enabled)})||null!=t&&null!==(e=t.featuregrid)&&void 0!==e&&e.open?_.Observable.of((0,R.v9)({owner:O.zU}),g(),m(!0)):_.Observable.of(m(!1))})}};var ie=t(275705),oe=t(802401),ue=t.n(oe),ae=["pluginName","mapConfig","onSetup","active","onHideViews","initialized","updateUUID"];function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},ce.apply(null,arguments)}var le=(0,n.lazy)(function(){return t.e(8477).then(t.bind(t,208477))}),fe={mapviews:function(){var e,r,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case w.mO:return M({initialized:!0,hide:null==t?void 0:t.hide,updateUUID:S()()},(null==n||null===(e=n.config)||void 0===e?void 0:e[O.VT])||{});case d:return M(M({},t),{},{selectedId:n.id});case p:return M(M({},t),{},{views:P(n.views)});case v:return M(M({},t),{},{resources:P(n.resources)});case f:return M(M({},t),{},{active:n.active});case s:return M(M({},t),{},{hide:n.hide});case l:return t.initialized?t:M({initialized:!0,updateUUID:S()()},null!==(r=n.config)&&void 0!==r?r:{});case y:return M(M({},t),{},{previousView:n.view});default:return t}}},se=(0,o.connect)((0,a.Mz)([H.e8,H.ns,U.Kv,T.Pd,function(e){return null==e?void 0:e.mapConfigRawData},H.sp,H.Bp,H.bJ,H.tY,H.RQ,U.mo],function(e,r,t,n,i,o,u,a,c,l,f){return{selectedId:e,views:r,layers:t.filter(function(e){return"background"!==e.group}),locale:n,mapConfig:i,resources:o,active:u,hide:a,initialized:c,updateUUID:l,groups:(0,G.Xl)(f).filter(ue())}}),{onSelectView:function(e){return{type:d,id:e}},onUpdateViews:function(e){return{type:p,views:e}},onSetup:function(e){return{type:l,config:e}},onUpdateResources:b,onHideViews:m})(function(e){var r=e.pluginName,t=e.mapConfig,o=e.onSetup,a=void 0===o?function(){}:o,l=e.active,f=(e.onHideViews,e.initialized),s=e.updateUUID,d=function(e,r){if(null==e)return{};var t,n,i=function(e,r){if(null==e)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==r.indexOf(n))continue;t[n]=e[n]}return t}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],-1===r.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}(e,ae);return function(e,r){var t=r.reducers,i=r.epics,o=r.removeReducers,a=r.muteEpics,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];(0,n.useEffect)(function(){var r=(0,u.Pc)(e),n=(0,c.KA)();return t&&Object.keys(t).forEach(function(e){return n.storeManager.addReducer(e,t[e])}),i&&(n.storeManager.addEpics(r,i),n.storeManager.unmuteEpics(r)),function(){t&&o&&Object.keys(t).forEach(function(e){return n.storeManager.removeReducer(e)}),i&&a&&n.storeManager.muteEpics(r)}},l)}(r,{reducers:fe,epics:ne}),(0,n.useEffect)(function(){!f&&null!=t&&t[O.VT]&&a(t[O.VT])},[null==t?void 0:t[O.VT],f]),l?i().createElement(n.Suspense,{fallback:i().createElement("div",{className:"ms-map-views"},i().createElement("div",{className:"ms-map-views-wrapper"},i().createElement("div",{className:"ms-map-views-header",style:{justifyContent:"center"}},i().createElement(ie.A,{size:30}))))},i().createElement(le,ce({key:s},d))):null});const de=se;var pe=t(8117),ve=t(711030),ye=t(8571),me=t(164045),be=t(914950),ge=t(501719),we=(0,me.A)(ve.A);(0,be.yp)(O.VT,function(e){return(0,O.wI)({active:(0,H.Bp)(e),selectedId:(0,H.e8)(e),views:(0,H.ns)(e),resources:(0,H.sp)(e)},(0,U.Kv)(e))});var Oe="MapViews",Ee=(0,o.connect)((0,a.Mz)([ge.M3],function(e){return{pluginName:Oe,edit:!!e}}))(de),Se=(0,o.connect)((0,a.Mz)([H.Bp,ge.M3,H.ns],function(e,r,t){return{active:e,visible:!!r||!r&&((null==t?void 0:t.length)||0)}}),{onClick:function(e){return{type:f,active:e}}})(function(e){var r=e.active,t=e.onClick,n=e.visible,o=e.menuItem;if(!n)return null;var u=r?"mapViews.deactivateMapViews":"mapViews.activateMapViews";return o?i().createElement(pe.Dr,{active:r,onClick:function(){return t(!r)}},i().createElement(pe.e6,{glyph:"map-view"}),i().createElement(ye.A,{msgId:u})):i().createElement(we,{className:"square-button",bsStyle:r?"primary":"tray",active:r,onClick:function(){return t(!r)},tooltipId:u,tooltipPosition:"left"},i().createElement(pe.e6,{glyph:"map-view"}))});const he=(0,u.i1)(Oe,{component:function(){return null},containers:{SidebarMenu:{name:"mapViews",position:2e3,tool:Se,priority:1},BurgerMenu:{name:"mapviews",position:9,tool:function(){return i().createElement(Se,{menuItem:!0})},priority:2},Map:{name:Oe,Tool:Ee,alwaysRender:!0}}})},995134(e,r,t){t.d(r,{HH:()=>n,g$:()=>i,k5:()=>o});var n="MAP_TYPE_CHANGED",i="MAP_TYPE:VISUALIZATION_MODE_CHANGED";function o(e){return{type:i,visualizationMode:e}}}}]);