(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[5872],{72737(t,e,r){"use strict";r.r(e),r.d(e,{default:()=>ot});var n={};r.r(n),r.d(n,{exportMapContext:()=>Q});var o=r(273517),a=r.n(o),i=r(8117),l=r(255435),c=r.n(l),u=r(978632),m=r.n(u),s=r(811668),p=r(916589),f=r(801081),d=r(8571),y=r(595535),b=r(415392),v="EXPORT::EXPORT_MAP",g=function(){return{type:v,format:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mapstore2"}},h=r(130711),E=r(522158),x=r.n(E),w=r(711030),A=r(406250);function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}const O=function(t){var e=t.show,r=void 0!==e&&e,n=t.formats,o=void 0===n?{}:n,l=t.selectedFormat,c=t.exportButtonLabel,u=void 0===c?a().createElement(d.A,{msgId:"mapExport.exportPanel.exportButtonLabel"}):c,s=t.exportPanelTitle,p=void 0===s?a().createElement(y.A,{msgId:"mapExport.exportPanel.title"}):s,f=t.onSelect,b=void 0===f?function(){}:f,v=t.onExport,g=void 0===v?function(){}:v,h=t.onClose,E=void 0===h?function(){}:h;return r&&a().createElement(A.A,null,a().createElement("div",{className:"export-panel"},a().createElement(w.A,{style:{border:"none",background:"transparent",color:"white",fontSize:35,top:0,right:0,position:"absolute"},onClick:function(){return E()}},a().createElement(i.e6,{glyph:"1-close"})),a().createElement("div",{style:{margin:"auto",maxWidth:550}},a().createElement("div",null,a().createElement("div",{className:"export-panel-heading-icon"},a().createElement(i.e6,{glyph:"upload"})),a().createElement("div",null,p),a().createElement("br",null),a().createElement("div",{className:"export-panel-formats-container"},x()(o).map(function(t){var e,r,n=(r=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,r)||function(t,e){if(t){if("string"==typeof t)return S(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(t,e):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],c=n[1],u=c.label,m=c.glyph;return a().createElement(w.A,{key:o,bsStyle:"default",className:l===o?"format-selected":"",onClick:function(){return b(o)}},a().createElement("div",null,a().createElement(i.e6,{style:{marginRight:"4px"},glyph:m}),u))})),a().createElement("br",null),a().createElement(w.A,{bsStyle:"primary",onClick:function(){return g(l)}},u),a().createElement("br",null),a().createElement("br",null),m()(o,"".concat(l,".description"),null),m()(o,"".concat(l,".note"))&&a().createElement(a().Fragment,null,a().createElement("hr",null),m()(o,"".concat(l,".note")))))))};var j=r(45388),P=r.n(j),I=r(209167),C=r.n(I),M=r(6683),k=r(434164),F=r(153986),T=r(327229),N=r(905185),D=r(131127),_=r(307679),K=r(148936),U=r(914950),R=r(958722),X=r(628017),B=r(761455);function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function $(t){return function(t){if(Array.isArray(t))return H(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||z(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(t,e){if(t){if("string"==typeof t)return H(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?H(t,e):void 0}}function H(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function J(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function G(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?J(Object(r),!0).forEach(function(e){W(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function W(t,e,r){return(e=function(t){var e=function(t){if("object"!=L(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==L(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y(t,e){this.title=t,this.message=e}var Z=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=M.Ay.saveMapConfiguration((0,D.mg)(t),(0,_.Kv)(t),(0,_.eK)(t),(0,K.U3)(t),(0,B.r)(t),(0,B.Y)(t),(0,U.a_)(t));return e?G(G({},r),{},{map:G(G({},r.map),{},{bbox:(0,D.mg)(t).bbox})}):r},q={mapstore2:function(t){return P().Observable.of([JSON.stringify(Z(t)),"map.json","application/json"])},wmc:function(t){var e,r=Z(t,!0),n=m()(r,"map.layers",[]).filter(function(t){return!!t.url&&"wms"===t.type});if(0===n.length)throw new Y("mapExport.errorTitle","mapExport.wmcNoLayersError");return(e=P().Observable).forkJoin.apply(e,$(n.map(function(t){return(0,k.aF)(t).catch(function(){return P().Observable.of(null)})}))).switchMap(function(t){return P().Observable.of([(0,F.F)((0,N.hZ)("map.layers",C()(n,t).map(function(t){var e,r,n=(r=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,r)||z(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],a=n[1];return G(G({},o),{},{capabilities:a})}),r),{}),"context.wmc","application/xml"])})}},Q=function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,r=void 0===e?function(){}:e;return t.ofType(v).switchMap(function(t){var e=t.format;return q[e](r()).do(function(t){return T.RG.apply(void 0,$(t))}).map(function(){return(0,b.fN)("export","enabled",!1)})}).catch(function(t,e){return P().Observable.of((0,R.X)(G(G({},t instanceof Y?t:(0,X.u1)(t)),{},{autoDismiss:6,position:"tc"}))).concat(e)})},V=r(393149);function tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var et=["mapstore2","wmc"],rt=(0,h.cU)("export"),nt=(0,p.compose)((0,s.connect)((0,f.j8)({enabled:rt}),{onClose:function(){return(0,b.KP)("export")},onExport:g}),(0,p.defaultProps)({formats:{mapstore2:{label:a().createElement(d.A,{msgId:"mapExport.formats.mapstore2.label"}),description:a().createElement(y.A,{msgId:"mapExport.formats.mapstore2.description"}),glyph:"ext-json"},wmc:{label:a().createElement(d.A,{msgId:"mapExport.formats.wmc.label"}),description:a().createElement(y.A,{msgId:"mapExport.formats.wmc.description"}),note:a().createElement(y.A,{msgId:"mapExport.formats.wmc.note"}),glyph:"ext-wmc"}}}),(0,p.withState)("format","setFormat","mapstore2"))(function(t){var e,r=t.enabled,n=t.format,o=t.formats,i=t.enabledFormats,l=void 0===i?et:i,u=t.setFormat,m=void 0===u?function(){}:u,s=t.onExport,p=void 0===s?function(){}:s,f=t.onClose,d=void 0===f?function(){}:f;return a().createElement(O,{show:r,formats:c().apply(void 0,[o].concat((e=l,function(t){if(Array.isArray(t))return tt(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return tt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tt(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))),selectedFormat:n,onSelect:m,onExport:p,onClose:d})});const ot=(0,V.i1)("MapExport",{component:nt,containers:{SidebarMenu:function(t){var e=m()(t,"cfg.enabledFormats",et);return{name:"export",position:4,tooltip:"mapExport.tooltip",text:a().createElement(d.A,{msgId:"mapExport.title"}),icon:a().createElement(i.e6,{glyph:"download"}),action:e.length>1?function(){return(0,b.KP)("export")}:function(){return g(e[0]||"mapstore2")},priority:1,toggle:!0,doNotHide:!0}},BurgerMenu:function(t){var e=m()(t,"cfg.enabledFormats",et);return{name:"export",position:4,tooltip:"mapExport.tooltip",text:a().createElement(d.A,{msgId:"mapExport.title"}),icon:a().createElement(i.e6,{glyph:"download"}),action:e.length>1?function(){return(0,b.KP)("export")}:function(){return g(e[0]||"mapstore2")},priority:2,toggle:!0,doNotHide:!0}}},epics:n})},209167(t,e,r){var n=r(97082)(r(911486));t.exports=n},911486(t,e,r){var n=r(618222),o=r(906488),a=r(191745),i=r(202852),l=r(156217),c=Math.max;t.exports=function(t){if(!t||!t.length)return[];var e=0;return t=n(t,function(t){if(l(t))return e=c(t.length,e),!0}),i(e,function(e){return o(t,a(e))})}},958722(t,e,r){"use strict";r.d(e,{X:()=>o});var n=r(883832),o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.title,r=void 0===e?"notification.warning":e,o=t.autoDismiss,a=void 0===o?6:o,i=t.position,l=void 0===i?"tc":i,c=t.message,u=void 0===c?"Error":c;return(0,n.z3)({title:r,autoDismiss:a,position:l,message:u})}}}]);