/*! For license information please see layer-download.6f6a2e248d47918a.chunk.js.LICENSE.txt */
(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[17004],{654456:(e,t,r)=>{"use strict";r.d(t,{GW:()=>c,IY:()=>a,Ii:()=>g,Jj:()=>y,KF:()=>l,LO:()=>w,Lk:()=>C,Lm:()=>n,MN:()=>E,Mb:()=>S,P:()=>R,Rb:()=>m,UR:()=>h,V8:()=>v,VZ:()=>F,Ve:()=>d,Xi:()=>b,Z4:()=>j,ZJ:()=>i,_Z:()=>f,cv:()=>u,f4:()=>p,jF:()=>O,oR:()=>x,pF:()=>s,qD:()=>o,qu:()=>A,x5:()=>P}),r(995531);var n="LAYER_SELECTED_FOR_SEARCH",o="FEATURE_TYPE_SELECTED",a="FEATURE_TYPE_LOADED",i="FEATURE_LOADED",l="FEATURE_LOADING",s="FEATURE_TYPE_ERROR",c="FEATURE_ERROR",u="QUERY_CREATE",p="QUERY:UPDATE_QUERY",d="QUERY_RESULT",f="QUERY_ERROR",m="RESET_QUERY",y="QUERY",v="INIT_QUERY_PANEL",b="QUERY:TOGGLE_SYNC_WMS",g="QUERY:TOGGLE_LAYER_FILTER";function w(){return{type:b}}function h(){return{type:g}}function O(){return{type:v}}function S(e,t){return{type:o,url:e,typeName:t,fields:arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],owner:arguments.length>3?arguments[3]:void 0}}function E(e,t,r){return{type:a,typeName:e,featureType:t,owner:r}}function j(e,t){return{type:s,typeName:e,error:t}}function P(e){return{type:l,isLoading:e}}function A(e,t,r,n,o){return{type:d,searchUrl:t,filterObj:r,result:e,queryOptions:n,reason:o}}function C(e){return{type:f,error:e}}function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.updates,r=e.reason,n=e.useLayerFilter;return{type:p,updates:t,reason:r,useLayerFilter:n}}function F(e,t,r){return{type:u,searchUrl:e,filterObj:t,owner:r}}function R(e,t,r,n){return{type:y,searchUrl:e,filterObj:t,queryOptions:r,reason:n}}},926560:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(916589),o=r(164045),a=r(509820);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var l=["renderPopover","popoverOptions"];function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function c(e,t,r){return(t=function(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const u=(0,n.compose)((0,n.withProps)(function(e){var t=e.renderPopover,r=e.popoverOptions;return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}(t?{renderPopover:t,popoverOptions:r}:{},function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,l))}),(0,n.branch)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.renderPopover,r=e.popoverOptions;return t&&!!r},a.A,o.A))},509820:(e,t,r)=>{"use strict";r.d(t,{A:()=>w});var n=r(273517),o=r.n(n),a=r(551258),i=r(8117),l=r(590179),s=r.n(l),c=r(310340),u=r.n(c);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}var d=["popoverOptions","keyProp"];function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f.apply(null,arguments)}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e){if("object"!=p(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(v=function(){return!!e})()}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}const w=function(e){return function(t){function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),function(e,t,r){return t=b(t),function(e,t){if(t&&("object"==p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,v()?Reflect.construct(t,r||[],b(e).constructor):t.apply(e,r))}(this,r,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(r,t),n=r,l=[{key:"render",value:function(){var t=null,r=this.props,n=r.popoverOptions,l=r.keyProp,c=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(r,d);return o().createElement("span",{className:"mapstore-info-popover"},o().createElement(e,f({},s()(c,["renderPopover","tooltipId"]),{key:l,ref:function(e){t=e}})),o().createElement(a.A,{placement:n.placement,shouldUpdatePosition:!0,show:!0,target:function(){return u().findDOMNode(t)}},o().createElement(i.AM,n.props,n.content)))}}],l&&m(n.prototype,l),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,l}(o().Component)}},628304:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(273517),o=r.n(n),a=r(8117),i=r(711030),l=["disabled","id","visible","onClick","glyph","active","className"];function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(null,arguments)}var c={width:0,padding:0,borderWidth:0},u={},p=function(e){return e?u:c};const d=(0,n.forwardRef)(function(e,t){var r=e.disabled,n=e.id,c=e.visible,u=e.onClick,d=e.glyph,f=e.active,m=e.className,y=void 0===m?"square-button-md":m,v=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,l);return o().createElement(i.A,s({ref:t},v,{bsStyle:f?"success":"primary",disabled:r,id:"fg-".concat(n),style:p(c),className:y,onClick:function(){return!r&&u()}}),o().createElement(a.e6,{glyph:d}))})},551258:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const n=(0,r(380959).A)(r(8117).hJ)},348317:(e,t,r)=>{"use strict";r.d(t,{A:()=>y});var n=r(273517),o=r.n(n),a=r(605556),i=r.n(a);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function c(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(c=function(){return!!e})()}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t,r){return(t=f(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,r){return t=u(t),function(e,t){if(t&&("object"==l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,c()?Reflect.construct(t,r||[],u(e).constructor):t.apply(e,r))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this;return o().createElement("label",{className:"mapstore-switch-btn ".concat(this.props.className)},o().createElement("input",{type:"checkbox",disabled:this.props.disabled,checked:this.props.checked,onChange:function(){return e.props.onChange(!e.props.checked)}}),o().createElement("span",{onClick:function(){return e.props.onClick(!e.props.checked)},className:"m-slider"}))}}])&&s(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(o().Component);d(m,"propTypes",{disabled:i().bool,className:i().string,checked:i().bool,onChange:i().func,onClick:i().func}),d(m,"defaultProps",{className:"",checked:!1,onChange:function(){},onClick:function(){}});const y=m},168995:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=r(273517),o=r.n(n),a=r(310340),i=r.n(a),l=r(605556),s=r.n(l),c=r(8117),u=r(551258),p=r(306840);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(m=function(){return!!e})()}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function b(e,t,r){return(t=g(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e){var t=function(e){if("object"!=d(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}var w=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,r){return t=y(t),function(e,t){if(t&&("object"==d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,m()?Reflect.construct(t,r||[],y(e).constructor):t.apply(e,r))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(t,e),r=t,(n=[{key:"renderPopover",value:function(){return o().createElement(c.AM,{id:this.props.id,placement:this.props.placement,positionLeft:this.props.left,positionTop:this.props.top,title:this.props.title,style:this.props.popoverStyle},this.props.text)}},{key:"renderContent",value:function(){var e=this;return o().createElement(c.e6,{ref:function(t){e.target=t},className:"text-".concat(this.props.bsStyle),glyph:this.props.glyph})}},{key:"render",value:function(){var e=this,t=!0===this.props.trigger?["hover","focus"]:this.props.trigger;return o().createElement("span",{className:"mapstore-info-popover"},this.props.trigger?o().createElement(p.A,{trigger:t,placement:this.props.placement,overlay:this.renderPopover()},this.renderContent()):[this.renderContent(),o().createElement(u.A,{placement:this.props.placement,show:!0,target:function(){return i().findDOMNode(e.target)}},this.renderPopover())])}}])&&f(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(o().Component);b(w,"propTypes",{id:s().string,title:s().string,text:s().string,glyph:s().string,bsStyle:s().string,placement:s().string,left:s().number,top:s().number,trigger:s().oneOfType([s().array,s().bool]),popoverStyle:s().object}),b(w,"defaultProps",{id:"",title:"",text:"",placement:"right",left:200,top:50,glyph:"question-sign",bsStyle:"info",trigger:["hover","focus"]});const h=w},545567:(e,t,r)=>{"use strict";r.d(t,{EV:()=>W,Gw:()=>q,o0:()=>M,sq:()=>U});var n=r(23412),o=r.n(n),a=r(956449),i=r.n(a),l=r(499084),s=r.n(l),c=r(269843),u=r.n(c),p=r(223805),d=r.n(p),f=r(45388),m=r.n(f),y=r(738805),v=r(692114),b=r(995531),g=r(102685),w=r(112585),h=r(492312),O=r(193275),S=r(79738),E=["totalFeatures","features"],j=["sortOptions","propertyName"];function P(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?A(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function x(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach(function(t){D(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function D(e,t,r){return(t=function(e){var t=function(e){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==C(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var T=(0,O.A)({wfsVersion:"1.1.0"}),N=T.getFeature,I=T.query,k=T.sortBy,L=T.propertyName,_=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"json",a=(0,g.zD)(t,r),i=o().parse((0,S.t)(e),!0),l=d()(i.query)?i.query:{};l.service="WFS",l.outputFormat=n;var s=o().format({protocol:i.protocol,host:i.host,pathname:i.pathname,query:l});return r.layer&&"vector"===r.layer.type?m().Observable.defer(function(){return new Promise(function(e){var n,o=function(e,t){if(t.filterFields&&0!==t.filterFields.length){var r=e.features.filter((0,g.Jt)(t));e.features=r,e.numberMatched=r.length,e.numberReturned=r.length,e.totalFeatures=r.length}return t.sortOptions&&t.sortOptions.sortBy&&t.sortOptions.sortOrder&&"NONE"!==t.sortOptions.sortOrder&&e.features.sort(function(e,r){var n=e.properties[t.sortOptions.sortBy],o=r.properties[t.sortOptions.sortBy],a=n.toLowerCase().localeCompare(o.toLowerCase());return"ASC"===t.sortOptions.sortOrder?a:-1*a}),e}({crs:{type:"name",properties:{name:"urn:ogc:def:crs:EPSG::4326"}},numberMatched:(n=r.layer.features).length,numberReturned:n.length,timeStamp:"2020-07-20T11:36:20.118Z",totalFeatures:n.length,type:"FeatureCollection",features:n},t);e(o)})}):{data:a,queryString:s}},M=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;if(r.layer&&"vector"===r.layer.type)return _(e,t,r,n);var o=_(e,t,r,n),a=o.data,i=o.queryString;return m().Observable.defer(function(){return b.A.post(i,a,{timeout:6e4,responseType:"arraybuffer",headers:{Accept:"application/xml","Content-Type":"application/xml"}})})},G=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(r.layer&&"vector"===r.layer.type)return _(e,t,r);var n=_(e,t,r),o=n.data,a=n.queryString;return m().Observable.defer(function(){return b.A.post(a,o,R({timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/xml"}},null==r?void 0:r.requestOptions))}).let(h.m9).map(function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.totalFeatures,r=e.features,n=x(e,E),o=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).startIndex,a=arguments.length>2?arguments[2]:void 0;return a>t&&a===o+r.length&&t===r.length?R(R({},n),{},{features:r,totalFeatures:a}):R(R({},n),{},{features:r,totalFeatures:t})}(e.data,function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).pagination||!u()(e.startIndex)&&!u()(e.maxFeatures)&&{startIndex:e.startIndex,maxFeatures:e.maxFeatures}}(t,r),r.totalFeatures)})},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.search,r=void 0===t?{}:t,n=e.url,o=e.name,a=arguments.length>1?arguments[1]:void 0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=l.sortOptions,u=l.propertyName,p=x(l,j);return G(r.url||n,a&&"object"===C(a)?R(R({},a),{},{typeName:o||a.typeName}):N(I(o,[].concat(P(c?[k(c.sortBy,c.sortOrder)]:[]),P(u?[L(u)]:[]),P(a?s()(a):[]))),p),p).catch(function(e){if("OGCError"===e.name&&"NoApplicableCode"===e.code&&!c&&u&&u[0])return G(r.url||n,a&&"object"===C(a)?R(R({},a),{},{typeName:o||a.typeName}):N(I(o,[k(i()(u)?u[0]:u)].concat(P(u?[L(u)]:[]),P(a?s()(a):[]))),p),p);throw e})},U=function(e){var t=e.layer;return m().Observable.defer(function(){return b.A.get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.search,n=void 0===r?{}:r,a=e.url,i=e.describeFeatureTypeURL,l=o().parse((0,S.t)(i||n.url||a),!0);return o().format(R(R({},l),{},{search:void 0,query:R(R({},l.query),{},{service:"WFS",version:"1.1.0",typeName:t,outputFormat:"application/json",request:"DescribeFeatureType"})}))}(t))}).let(h.m9)},W=function(e){var t=e.layer;return m().Observable.defer(function(){return b.A.get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.search,n=void 0===r?{}:r,a=e.url,i=(0,w.wk)({name:t,url:n&&n.url||a}),l=o().parse(i,!0);return o().format(R(R({},l),{},{search:void 0,query:R(R({},l.query),{},{service:"WFS",version:"1.1.1",request:"GetCapabilities"})}))}(t))}).let(h.m9).switchMap(function(e){return m().Observable.bindNodeCallback(function(e,t){return(0,y.parseString)(e,{tagNameProcessors:[v.stripPrefix],explicitArray:!1,mergeAttrs:!0},t)})(e.data)})}},909309:(e,t,r)=>{"use strict";r.d(t,{l:()=>l});var n=r(45388),o=r(995531),a=r(492312),i=r(325177),l=function(e,t){return n.Observable.defer(function(){return o.A.get((0,i.Sd)(e,{version:"1.0.0",REQUEST:"DescribeProcess",IDENTIFIER:t}),{timeout:5e3,headers:{Accept:"application/json","Content-Type":"application/xml"}})}).let(a.m9)}},571534:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Kt});var n={};r.r(n),r.d(n,{checkExportDataEntriesEpic:()=>Rt,closeExportDownload:()=>Ft,fetchFormatsWFSDownload:()=>Ct,openDownloadTool:()=>At,resetExportDataResultsOnLogout:()=>Tt,serializeCookieOnExportDataChange:()=>Dt,setExportDataResultsOnLoginSuccessAndMapConfigLoaded:()=>Nt,startFeatureExportDownload:()=>xt});var o=r(273517),a=r.n(o),i=r(811668),l=r(801081),s=r(61173),c=r(415392),u=r(904059),p=r(509092),d=r(806653),f=r(307679),m=r(286447),y=r(401631),v=r(605556),b=r.n(v),g=r(324713),w=r.n(g),h=r(400912),O=r.n(h),S=r(45228),E=r.n(S),j=r(8117),P=r(750042),A=r.n(P),C=r(275705),x=r(711520),F=r(406250),R=r(8571),D=r(3162),T=r(192016),N=r(858156),I=r.n(N),k=r(223805),L=r.n(k),_=r(962193),M=r.n(_),G=r(302404),q=r.n(G),U=r(168995),W=r(185015),V=r.n(W),H=r(348317);function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const X=function(e){var t,r,n=e.advancedOptionsVisible,i=void 0===n||n,l=e.cropDataSetVisible,s=void 0!==l&&l,c=e.cropDataSetEnabled,u=void 0!==c&&c,p=e.downloadFilteredVisible,d=void 0!==p&&p,f=e.downloadFilteredEnabled,m=void 0!==f&&f,y=e.rasterOptionsVisibile,v=void 0!==y&&y,b=e.compressionOptions,g=void 0===b?["Deflate","JPEG","PackBits","LZW","CCITT RLE","ZLib"]:b,w=e.selectedCompression,h=e.tileWidth,S=e.tileHeight,E=e.quality,P=e.placeholders,A=void 0===P?{tileWidth:"256",tileHeight:"256",quality:"0.75"}:P,C=e.srsList,x=e.selectedSrs,F=e.onChange,D=void 0===F?function(){}:F,N=(t=(0,o.useState)(!1),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(t,r)||function(e,t){if(e){if("string"==typeof e)return B(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),I=N[0],k=N[1];return(0,o.useEffect)(function(){D("compression",w||O()(g))},[]),a().createElement(a().Fragment,null,i&&a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-options"},a().createElement(j.$n,{className:"no-border",onClick:function(){return k(!I)}},a().createElement(j.e6,{glyph:"chevron-".concat(I?"down":"right")}),"   ",a().createElement(R.A,{msgId:"layerdownload.advancedOptions"}))),I&&i&&a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced"},a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement("label",null,a().createElement(R.A,{msgId:"layerdownload.srs"})),a().createElement(T.Ay,{clearable:!1,value:x,onChange:function(e){return D("selectedSrs",e.value)},options:C.map(function(e){return{value:e.name,label:e.label||e.name}})}))),s&&a().createElement(a().Fragment,null,a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(H.A,{checked:u,onClick:function(e){return D("cropDataSet",e)}}),a().createElement(R.A,{msgId:"layerdownload.cropDataSet"})))),d&&a().createElement(a().Fragment,null,a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(H.A,{checked:m,onClick:function(e){return D("downloadFilteredDataSet",e)}}),a().createElement(R.A,{msgId:"layerdownload.downloadFilteredDataSet"})))),v&&a().createElement(a().Fragment,null,a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement(R.A,{msgId:"layerdownload.compression"}),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(T.Ay,{clearable:!1,value:w,options:g.map(function(e){return V()(e)?{value:e,label:e}:e}),onChange:function(e){return D("compression",null==e?void 0:e.value)}}))),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement(R.A,{msgId:"layerdownload.quality"}),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(j.MJ,{placeholder:A.quality,type:"number",size:"4",min:"0",max:"1",step:"0.1",value:E||"",onChange:function(e){return D("quality",e.target.value)}}))),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement(R.A,{msgId:"layerdownload.tileWidth"}),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(j.MJ,{placeholder:A.tileWidth,type:"number",size:"4",min:"0",value:h||"",onChange:function(e){return D("tileWidth",e.target.value&&e.target.value.length>0?"".concat(parseInt(e.target.value,10)):"")}}),a().createElement("span",null,"px"))),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},a().createElement(R.A,{msgId:"layerdownload.tileHeight"}),a().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},a().createElement(j.MJ,{placeholder:A.tileHeight,type:"number",size:"4",min:"0",value:S||"",onChange:function(e){return D("tileHeight",e.target.value&&e.target.value.length>0?"".concat(parseInt(e.target.value,10)):"")}}),a().createElement("span",null,"px"))))))};function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function Y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$(n.key),n)}}function K(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(K=function(){return!!e})()}function J(e){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},J(e)}function Z(e,t){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Z(e,t)}function Q(e,t,r){return(t=$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $(e){var t=function(e){if("object"!=z(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==z(t)?t:t+""}var ee=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Q(r=function(e,t,r){return t=J(t),function(e,t){if(t&&("object"==z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,K()?Reflect.construct(t,r||[],J(e).constructor):t.apply(e,r))}(this,t,[e]),"componentDidMount",function(){r.props.onClearDownloadOptions(r.props.service||r.props.defaultSelectedService);var e=I()(r.props,"downloadOptions.selectedFormat")||I()(O()(r.props.formats),"name"),t=I()(r.props,"downloadOptions.selectedSrs")||I()(r.props,"defaultSrs")||I()(O()(r.props.srsList),"name"),n=I()(r.props,"layer.layerFilter"),o=L()(n)&&!M()(n)||r.props.filterObj;r.props.onChange("selectedFormat",e),r.props.onChange("selectedSrs",t),r.props.onChange("downloadFilteredDataSet",o),r.props.formatOptionsFetch(r.props.layer)}),Q(r,"componentWillReceiveProps",function(e){if(!q()(r.props.formats,e.formats)){var t=I()(e,"downloadOptions.selectedFormat")||I()(O()(e.formats),"name");e.onChange("selectedFormat",t)}if(q()(r.props.service,e.service)||e.formatOptionsFetch(e.layer),!q()(r.props.layer,e.layer)){var n=I()(e,"layer.layerFilter"),o=L()(n)&&!M()(n)||e.filterObj;e.onChange("downloadFilteredDataSet",o)}if(!q()(r.props.srsList,e.srsList)){var a=I()(e,"downloadOptions.selectedSrs")||I()(e,"defaultSrs")||I()(O()(e.srsList),"name");e.onChange("selectedSrs",a)}}),Q(r,"componentWillUnmount",function(){r.props.onClearDownloadOptions(r.props.defaultSelectedService)}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e,t,r=this,n=this.props.formats.some(function(e){return"raster"===e.type});return a().createElement("form",null,!this.props.hideServiceSelector&&this.props.wpsAvailable&&this.props.wfsAvailable&&a().createElement("div",{className:"mapstore-downloadoptions downloadMode"},a().createElement("label",null,a().createElement(R.A,{msgId:"layerdownload.downloadMode"})),a().createElement("div",{className:"mapstore-downloadoptions-row"},a().createElement(T.Ay,{clearable:!1,value:this.props.service,onChange:function(e){return r.props.onSetService(e.value)},options:this.props.services})," ",a().createElement(U.A,{text:a().createElement(R.A,{msgId:"layerdownload.services.".concat(this.props.service,".tooltip")})}))),a().createElement("div",{className:"mapstore-downloadoptions"},a().createElement("label",null,a().createElement(R.A,{msgId:"layerdownload.format"})),a().createElement(T.Ay,{clearable:!1,isLoading:this.props.formatsLoading,onOpen:function(){return r.props.formatOptionsFetch(r.props.layer)},value:null===(e=this.props.downloadOptions)||void 0===e?void 0:e.selectedFormat,noResultsText:a().createElement(R.A,{msgId:"layerdownload.format"}),onChange:function(e){return r.props.onChange("selectedFormat",e.value)},options:this.props.formats.map(function(e){return{value:e.name,label:e.label||e.name}})})),a().createElement(X,{srsList:this.props.srsList,selectedSrs:null===(t=this.props.downloadOptions)||void 0===t?void 0:t.selectedSrs,cropDataSetVisible:this.props.cropDataSetVisible,advancedOptionsVisible:!0,wpsOptionsVisible:!0,rasterOptionsVisibile:n,downloadFilteredVisible:this.props.downloadFilteredVisible,downloadFilteredEnabled:this.props.downloadOptions.downloadFilteredDataSet,cropDataSetEnabled:this.props.downloadOptions.cropDataSet,selectedCompression:this.props.downloadOptions.compression,quality:this.props.downloadOptions.quality,tileWidth:this.props.downloadOptions.tileWidth,tileHeight:this.props.downloadOptions.tileHeight,onChange:this.props.onChange}),this.props.virtualScroll?null:a().createElement(j.Sc,{checked:this.props.downloadOptions.singlePage,onChange:function(){return r.props.onChange("singlePage",!r.props.downloadOptions.singlePage)}},a().createElement(R.A,{msgId:"layerdownload.downloadonlycurrentpage"})))}}])&&Y(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);Q(ee,"propTypes",{cropDataSetVisible:b().bool,defaultSelectedService:b().bool,defaultSrs:b().string,downloadFilteredVisible:b().bool,downloadOptions:b().object,formatOptionsFetch:b().func,formats:b().array,formatsLoading:b().bool,filterObj:b().object,hideServiceSelector:b().bool,layer:b().object,onChange:b().func,onClearDownloadOptions:b().func,onSetService:b().func,service:b().string,services:b().arrayOf(b().object),srsList:b().array,virtualScroll:b().bool,wfsAvailable:b().bool,wpsAdvancedOptionsVisible:b().bool,wpsAvailable:b().bool,wpsOptionsVisible:b().bool}),Q(ee,"defaultProps",{cropDataSetVisible:!0,wpsAvailable:!1,wfsAvailable:!0,downloadOptions:{},formats:[],onChange:function(){},onClearDownloadOptions:function(){},formatOptionsFetch:function(){},formatsLoading:!1,srsList:[],wpsOptionsVisible:!1,wpsAdvancedOptionsVisible:!1,downloadFilteredVisible:!1,virtualScroll:!0,services:[{value:"wps",label:a().createElement(R.A,{msgId:"layerdownload.services.wps.title"})},{value:"wfs",label:a().createElement(R.A,{msgId:"layerdownload.services.wfs.title"})}],hideServiceSelector:!1});const te=ee;var re=r(711030),ne=r(525859),oe=r(738805),ae=r(692114),ie=r(909309);function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var se=function(e){var t,r,n,i,l,s,c=e.attributes,u=e.checkingWPSAvailability,p=e.closeGlyph,d=e.cropDataSetVisible,f=e.customAttributeSettings,m=e.defaultSelectedService,y=e.defaultSrs,v=e.downloadLayer,b=e.downloadOptions,g=e.enabled,h=e.filterObj,S=e.formats,P=e.formatsLoading,T=e.hideServiceSelector,N=e.loading,I=e.mapLayer,k=e.onClearDownloadOptions,L=e.onClose,_=e.onDownloadOptionChange,M=e.onExport,G=e.onFormatOptionsFetch,q=e.onSetService,U=e.onSetWPSAvailability,W=e.service,V=e.srsList,H=e.virtualScroll,B=e.wfsFormats,X=e.wpsAvailable,z=I||v||{},Y=(l=(0,o.useState)(!1),s=2,function(e){if(Array.isArray(e))return e}(l)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(l,s)||function(e,t){if(e){if("string"==typeof e)return le(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?le(e,t):void 0}}(l,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),K=Y[0],J=Y[1];(0,o.useEffect)(function(){var e,t;g&&(k(m),e=z,t=m,J(!0),(0,ie.l)(e.url,"gs:DownloadEstimator,gs:Download").toPromise().then(function(e){return new Promise(function(t,r){return(0,oe.parseString)(e.data,{tagNameProcessors:[ae.stripPrefix]},function(e,n){return e?r(e):t(n)})})}).then(function(r){var n,o,a,i=[null==r||null===(n=r.ProcessDescriptions)||void 0===n||null===(n=n.ProcessDescription)||void 0===n||null===(n=n[0])||void 0===n||null===(n=n.Identifier)||void 0===n?void 0:n[0],null==r||null===(o=r.ProcessDescriptions)||void 0===o||null===(o=o.ProcessDescription)||void 0===o||null===(o=o[1])||void 0===o||null===(o=o.Identifier)||void 0===o?void 0:o[0]],l=w()(i,function(e){return"gs:DownloadEstimator"===e})>-1&&w()(i,function(e){return"gs:Download"===e})>-1,s=null===(a=e.search)||void 0===a?void 0:a.url,c=l&&("wps"===t||!s);q(c?"wps":"wfs"),U(c)}).catch(function(){q("wfs"),U(!1)}).finally(function(){J(!1)}))},[g,z,m]);var Z=function(e){return S.filter(function(t){var r,n,o=t.validServices,a=t.type,i=void 0===a?"vector":a;return(!o||w()(o,function(t){return t===e})>-1)&&("vector"===i&&(null==z||null===(r=z.search)||void 0===r?void 0:r.url)||"raster"===i&&!(null!=z&&null!==(n=z.search)&&void 0!==n&&n.url))})},Q=Z("wfs"),$=Z("wps"),ee=Q.length>0?Q.filter(function(e){return B.find(function(t){return t.name.toLowerCase()===e.name.toLowerCase()})}):B,se=Boolean(null==z||null===(t=z.search)||void 0===t?void 0:t.url),ce="wfs"===W?ee:$,ue=!se&&!X;return g?a().createElement(F.A,null,a().createElement(x.A,{id:"mapstore-export",draggable:!1,modal:!0},a().createElement("span",{role:"header"},a().createElement("span",{className:"modal-title  about-panel-title"},a().createElement(R.A,{msgId:"layerdownload.title"})),a().createElement("button",{onClick:L,className:"settings-panel-close close"},p?a().createElement(j.e6,{glyph:p}):a().createElement("span",null,"×"))),a().createElement("div",{role:"body"},K?a().createElement(C.A,{size:100,style:{margin:"0 auto"}}):ue?a().createElement(D.A,{title:a().createElement(R.A,{msgId:"layerdownload.noSupportedServiceFound"})}):a().createElement(te,{attributes:c,cropDataSetVisible:d,customAttributesSettings:f,defaultSelectedService:m,defaultSrs:y,downloadFilteredVisible:!(null==z||!z.layerFilter)||!(null==h||null===(r=h.filterFields)||void 0===r||!r.length)||(null==h||null===(n=h.spatialFields)||void 0===n?void 0:n.length),downloadOptions:b,filterObj:h,formatOptionsFetch:"wfs"===W?G:function(){},formats:ce,formatsLoading:P,hideServiceSelector:T,layer:z,onChange:_,onClearDownloadOptions:k,onSetService:q,service:W,srsList:V,virtualScroll:H,wfsAvailable:se,wpsAdvancedOptionsVisible:!(null!=z&&null!==(i=z.search)&&void 0!==i&&i.url),wpsAvailable:X})),!u&&!ue&&a().createElement("div",{role:"footer"},a().createElement(re.A,{bsStyle:"primary",className:"download-button",disabled:P||0===S.length,onClick:function(){var e=b&&b.selectedSrs||y||(O()(V)||{}).name,t=(0,ne.Eo)(c,f);M(null==z?void 0:z.url,h,E()({},b,{selectedSrs:e},{propertyName:t}))}},N?a().createElement("div",{style:{float:"left"}},a().createElement(A(),{spinnerName:"circle",noFadeIn:!0})):a().createElement(j.e6,{glyph:"download"})," ",a().createElement(R.A,{msgId:"layerdownload.export"}))))):null};se.propTypes={attributes:b().array,checkingWPSAvailability:b().bool,closeGlyph:b().string,cropDataSetVisible:b().bool,customAttributeSettings:b().object,defaultSelectedService:b().string,defaultSrs:b().string,downloadLayer:b().object,downloadOptions:b().object,enabled:b().bool,filterObj:b().object,formats:b().array,formatsLoading:b().bool,hideServiceSelector:b().bool,loading:b().bool,mapLayer:b().object,onCheckWPSAvailability:b().func,onClearDownloadOptions:b().func,onClose:b().func,onDownloadOptionChange:b().func,onExport:b().func,onFormatOptionsFetch:b().func,onSetService:b().func,onSetWPSAvailability:b().func,service:b().string,srsList:b().array,virtualScroll:b().bool,wfsFormats:b().array,wpsAvailable:b().bool},se.defaultProps={onExport:function(){},onClose:function(){},onCheckWPSAvailability:function(){},onSetService:function(){},onSetWPSAvailability:function(){},onDownloadOptionChange:function(){},onClearDownloadOptions:function(){},onFormatOptionsFetch:function(){},checkingWPSAvailability:!1,closeGlyph:"1-close",wpsAvailable:!1,service:"wfs",defaultSelectedService:"wps",wfsFormats:[],formats:[{name:"image/tiff",label:"TIFF",type:"raster",validServices:["wps"]},{name:"application/arcgrid",label:"ArcGrid",type:"raster",validServices:["wps"]},{name:"application/json",label:"GeoJSON",type:"vector",validServices:["wps"]},{name:"application/zip",label:"Shapefile",type:"vector",validServices:["wps"]},{name:"text/csv",label:"CSV",type:"vector",validServices:["wps"]},{name:"application/wfs-collection-1.0",label:"GML2",type:"vector",validServices:["wps"]},{name:"application/wfs-collection-1.1",label:"GML3",type:"vector",validServices:["wps"]}],formatsLoading:!1,srsList:[{name:"native",label:"Native"},{name:"EPSG:4326",label:"WGS84"}],virtualScroll:!0,downloadOptions:{},hideServiceSelector:!1};const ce=se;var ue=r(908714),pe=r(926560),de=r(628304),fe=(0,pe.A)(de.A),me=r(45388),ye=r.n(me),ve=r(269843),be=r.n(ve),ge=r(907309),we=r.n(ge),he=r(244383),Oe=r.n(he),Se=r(318938),Ee=r.n(Se),je=r(499084),Pe=r.n(je),Ae=r(791936),Ce=r(541033),xe=r.n(Ce),Fe=r(980971),Re=r(654456),De=r(883832),Te=r(754364),Ne=r(538704),Ie=r(130711),ke=r(131127),Le=r(501719),_e=r(545567),Me=r(395950),Ge=r.n(Me),qe=r(590179),Ue=r.n(qe),We=r(325177),Ve=r(264053);function He(e){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},He(e)}function Be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(r),!0).forEach(function(t){ze(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Be(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ze(e,t,r){return(t=function(e){var t=function(e){if("object"!=He(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=He(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==He(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ye(e){return function(e){if(Array.isArray(e))return Je(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ke(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ke(e,t){if(e){if("string"==typeof e)return Je(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Je(e,t):void 0}}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Ze=function(e){var t=e.type,r=e.data;return"TEXT"===t?(0,We.oW)((0,We.Xs)((0,We.Gr)(r.data),r.mimeType)):(0,We.Nj)(r.mimeType,r.href,r.method,(0,We.Gr)(r.requestBodyData))},Qe=function(e,t,r){if(e&&t){var n=(0,Ve.p4)(e,(l=(i={layerName:t.layerName,ROI:t.ROI,roiCRS:t.roiCRS,dataFilter:t.dataFilter,targetCRS:t.targetCRS}).layerName,s=i.ROI,c=i.roiCRS,u=i.dataFilter,p=i.targetCRS,(0,Ve.Yy)("gs:DownloadEstimator",[(0,We.XH)("layerName",(0,We.oW)((0,We.mC)(l)))].concat(Ye(s?[(0,We.XH)("ROI",Ze(s))]:[]),Ye(c?[(0,We.XH)("RoiCRS",(0,We.oW)((0,We.mC)(c)))]:[]),Ye(u?[(0,We.XH)("filter",Ze(u))]:[]),Ye(p?[(0,We.XH)("targetCRS",(0,We.oW)((0,We.mC)(p)))]:[])))),{outputsExtractor:(0,Ve.$t)(Ve.J7)}),o=t.resultOutput||t.outputFormat||"application/zip",a=(0,Ve.p4)(e,function(e){var t=e.layerName,r=e.dataFilter,n=e.outputFormat,o=e.targetCRS,a=e.roiCRS,i=e.ROI,l=e.cropToROI,s=e.asynchronous,c=e.outputAsReference,u=e.resultOutput,p=e.writeParameters;return(0,Ve.Yy)("gs:Download",[(0,We.XH)("layerName",(0,We.oW)((0,We.mC)(t))),(0,We.XH)("outputFormat",(0,We.oW)((0,We.mC)(n)))].concat(Ye(i?[(0,We.XH)("ROI",Ze(i))]:[]),Ye(r?[(0,We.XH)("filter",Ze(r))]:[]),Ye(o?[(0,We.XH)("targetCRS",(0,We.oW)((0,We.mC)(o)))]:[]),Ye(a?[(0,We.XH)("RoiCRS",(0,We.oW)((0,We.mC)(a)))]:[]),[(0,We.XH)("cropToROI",(0,We.oW)((0,We.mC)(l?"true":"false")))],Ye(p&&Ge()(p).length>0?[(0,We.Xk)(Ee()(p).map(function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(t,r)||Ke(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],a=n[1];return(0,We._y)(o,a)}).join(""))]:[])),(0,We.mk)(s?(0,We.ru)(!0,!0,c?(0,We.Xi)(u,!0,"result"):(0,We.Cs)("result",u)):(0,We.Cs)("result",u)))}(Xe(Xe({},Ue()(t,"notifyDownloadEstimatorSuccess","attribute")),{},{outputAsReference:!!t.asynchronous&&t.outputAsReference,resultOutput:o})),r,{headers:{"Content-Type":"application/xml",Accept:"application/xml, ".concat(o)}});return n.catch(function(){throw new Error("DownloadEstimatorException")}).mergeMap(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length>0&&"result"===e[0].identifier&&"true"===e[0].data)return t.notifyDownloadEstimatorSuccess?me.Observable.of("DownloadEstimatorSuccess").concat(a):a;throw new Error("DownloadEstimatorFailed")})}var i,l,s,c,u,p;return me.Observable.empty()},$e=r(102685),et=r(564116),tt=r(112585),rt=r(764932),nt=r(492312),ot=r(193275),at=r(184435),it=r(112206);function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function st(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ct(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?st(Object(r),!0).forEach(function(t){ut(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):st(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ut(e,t,r){return(t=function(e){var t=function(e){if("object"!=lt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==lt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pt(e){return function(e){if(Array.isArray(e))return ft(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||dt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dt(e,t){if(e){if("string"==typeof e)return ft(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ft(e,t):void 0}}function ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var mt={gml3:"GML3.1",GML2:"GML2","DXF-ZIP":"DXF-ZIP","application/vnd.google-earth.kml+xml":"KML","OGR-CSV":"OGR-CSV","OGR-FileGDB":"OGR-GeoDatabase","OGR-GPKG":"OGR-GeoPackage","OGR-KML":"OGR-KML","OGR-MIF":"OGR-MIF","OGR-TAB":"OGR-TAB","SHAPE-ZIP":"Shapefile",gml32:"GML3.2","application/json":"GeoJSON",csv:"CSV","application/x-gpkg":"GeoPackage",excel:"excel",excel2007:"excel2007"},yt=(0,ot.A)({wfsVersion:"1.1.0"}),vt=yt.getFeature,bt=yt.query,gt=yt.sortBy,wt=yt.propertyName,ht=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=null!==(e=null==t?void 0:t.params)&&void 0!==e?e:{};return null==r?void 0:r[Object.keys(r).find(function(e){return"cql_filter"===(null==e?void 0:e.toLowerCase())})]},Ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.filterObj,n=void 0===r?{}:r,o=e.layerFilter,a=e.layer,i=e.downloadOptions,l=void 0===i?{}:i,s=e.options,c=s.sortOptions,u=s.propertyNames,p=ht(a),d=(0,$e.o2)({ogcVersion:"1.1.0",addXmlnsToRoot:!0,xmlnsToAdd:['xmlns:ogc="http://www.opengis.net/ogc"','xmlns:gml="http://www.opengis.net/gml"']},l.downloadFilteredDataSet?o:{},l.downloadFilteredDataSet?n:{},p);return(0,_e.o0)(t,vt(bt(n.featureTypeName,[].concat(pt(c?[gt(c.sortBy,c.sortOrder)]:[]),pt(u?[wt(u)]:[]),pt(d?Pe()(d):[])),{srsName:l.selectedSrs})),s,l.selectedFormat)},St=function(e){var t=I()(e,"filterObj.featureTypeName")||"suca",r=(0,et.ic)(I()(e,"downloadOptions.selectedFormat"));return r&&r.extension?t+"."+r.extension:t},Et=function(e){return e.query&&e.query.featureTypes&&e.query.featureTypes[e.query.typeName]&&e.query.featureTypes[e.query.typeName].attributes&&e.query.featureTypes[e.query.typeName].attributes[0]&&e.query.featureTypes[e.query.typeName].attributes[0].attribute||null},jt=function(e){switch(e.code){case"ProcessFailed":return{msgId:"layerdownload.wpsExecuteError.processFailed",msgParams:{exceptionReport:e.message}};case"NoStatusLocation":case"NoExecutionId":case"UnexpectedProcessStatus":return{msgId:"layerdownload.wpsExecuteError.badResponse",msgParams:{eCode:e.code}};case"ExecuteProcessXHRFailed":return{msgId:"layerdownload.wpsExecuteError.executeProcessXhrFailed"};case"GetExecutionStatusXHRFailed":return{msgId:"layerdonwload.wpsExecuteError.getExecutionStatusXhrFailed"};default:return{msgId:"layerdownload.wpsExecuteError.unexpectedError"}}},Pt=function(e){var t=(0,Le.dt)(e);if(null!=t&&t.id){var r=document.cookie.split(";").filter(function(e){return e.indexOf("exportDataResults_".concat(t.id,"="))>-1})[0];if(r){var n=JSON.parse(decodeURIComponent(r.split("=")[1])).results;return ye().Observable.of((0,s.D5)(n.filter(function(e){return"pending"!==e.status})))}}return ye().Observable.empty()},At=function(e){return e.ofType(u.dC).switchMap(function(e){var t;return ye().Observable.from([(0,c.KP)("layerdownload"),(0,s.Nw)("singlePage",!1)].concat(pt(null!==(t=e.layer.search)&&void 0!==t&&t.url?[(0,Re.VZ)(e.layer.url,{featureTypeName:e.layer.name})]:[])))})},Ct=function(e){return e.ofType(s.cl).switchMap(function(e){return(0,_e.EV)(e).map(function(e){return(0,s.Ur)(function(e){var t=I()(e,"WFS_Capabilities.OperationsMetadata.Operation"),r=we()(t,function(e){return"GetFeature"===e.name}),n=I()(r,"Parameter"),o=we()(n,function(e){return"outputFormat"===e.name}).Value,a=Oe()(mt,o);return Ee()(a).map(function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],s=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(t,r)||dt(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{name:n[0],label:n[1]}})}(e))})})},xt=function(e,t){return e.ofType(s.Ne).switchMap(function(r){var n,o,a,i,l,u,y,v,b=t.getState(),g=(b.featuregrid||{}).virtualScroll,w=void 0!==g&&g,h=(0,p.TH)(b),O=(0,f.ZT)(b),S=(0,p.RF)(b),E=O||S,j=(0,ke.HC)(b),P=(0,m.Pd)(b),A=r.downloadOptions.propertyName?[(0,it.Dh)((0,d.uT)(b,E.name))].concat(pt(r.downloadOptions.propertyName)):null,C=E.layerFilter;return"wps"===h?(o=!(null===(n=E.search)||void 0===n||!n.url),a=r.downloadOptions.cropDataSet&&!!j&&!!j.bounds,i=ht(E),l=(0,$e.o2)({ogcVersion:"1.1.0",addXmlnsToRoot:!0,xmlnsToAdd:['xmlns:ogc="http://www.opengis.net/ogc"','xmlns:gml="http://www.opengis.net/gml"']},E.layerFilter,r.filterObj,i),u={layerName:E.name,outputFormat:r.downloadOptions.selectedFormat,asynchronous:!0,outputAsReference:!0,targetCRS:r.downloadOptions.selectedSrs&&"native"!==r.downloadOptions.selectedSrs?r.downloadOptions.selectedSrs:void 0,cropToROI:a,dataFilter:r.downloadOptions.downloadFilteredDataSet&&!M()(l)?{type:"TEXT",data:{mimeType:"text/xml; subtype=filter/1.1",data:l}}:void 0,ROI:a?{type:"TEXT",data:{mimeType:"application/wkt",data:(0,at.U)((0,rt.bboxToFeatureGeometry)(j.bounds))}}:void 0,roiCRS:a?j.crs||"EPSG:4326":void 0,writeParameters:ct(ct(ct({},r.downloadOptions.tileWidth?{tilewidth:r.downloadOptions.tileWidth}:{}),r.downloadOptions.tileHeight?{tileheight:r.downloadOptions.tileHeight}:{}),r.downloadOptions.compression?ct({compression:r.downloadOptions.compression},r.downloadOptions.quality?{quality:r.downloadOptions.quality}:{}):{}),notifyDownloadEstimatorSuccess:!0,attribute:o&&A?A:void 0},y={id:xe()(),layerName:E.name,layerTitle:E.title,status:"pending"},v={outputsExtractor:(0,Ve.$t)(Ve.$V)},Qe(r.url,u,v).takeUntil(e.ofType(s.jK).filter(function(e){return e.id===y.id}).take(1)).flatMap(function(e){var t;return"DownloadEstimatorSuccess"===e?ye().Observable.of((0,s.ZL)(ct(ct({},y),{},{startTime:(new Date).getTime()})),(0,De.pq)({position:"tc",message:"layerdownload.exportResultsMessages.newExport"}),(0,s.iR)(),(0,c.KP)("layerdownload","enabled")):(t=ye().Observable).of.apply(t,pt(e&&e.length>0&&e[0].href?[(0,s.q9)(y.id,{status:"completed",result:e[0].href}),(0,De.kX)({position:"tc",message:"layerdownload.exportResultsMessages.exportSuccess",values:{layerTitle:(0,tt.ez)(E,P)}})]:[(0,s.q9)(y.id,{status:"failed",result:{msgId:"layerdonwload.exportResultsMessages.invalidHref"}}),(0,De.z3)({position:"tc",message:"layerdownload.exportResultsMessages.exportFailure",values:{layerTitle:(0,tt.ez)(E,P)},autoDismiss:5})]))}).catch(function(e){var t;return(t=ye().Observable).of.apply(t,pt(e.message&&e.message.indexOf("DownloadEstimator")>-1?[(0,De.z3)({error:e,position:"tc",title:"layerdownload.error.downloadEstimatorTitle",message:"layerdownload.error.downloadEstimatorFailed",autoDismiss:5}),(0,s.iR)()]:[(0,s.q9)(y.id,{status:"failed",result:jt(e)}),(0,De.z3)({position:"tc",message:"layerdownload.exportResultsMessages.exportFailure",values:{layerTitle:(0,tt.ez)(E,P)},autoDismiss:5})]))})):Ot({url:r.url,downloadOptions:r.downloadOptions,filterObj:be()(r.filterObj)?{}:r.filterObj,layer:E,layerFilter:C,options:{pagination:!w&&I()(r,"downloadOptions.singlePage")?r.filterObj&&r.filterObj.pagination:null,propertyNames:A}}).do(function(e){var t=e.data;if("application/xml"===e.headers["content-type"]){var r=String.fromCharCode.apply(null,new Uint8Array(t));if(0===r.indexOf("<ows:ExceptionReport"))throw r}}).catch(function(){return Ot({url:r.url,downloadOptions:r.downloadOptions,filterObj:r.filterObj,layer:E,layerFilter:C,options:{pagination:!w&&I()(r,"downloadOptions.singlePage")?r.filterObj&&r.filterObj.pagination:null,sortOptions:(e=Et(t.getState()),e?{sortBy:e,sortOrder:"A"}:{}),propertyNames:r.downloadOptions.propertyName?[].concat(pt(r.downloadOptions.propertyName),[(0,it.Dh)((0,d.uT)(b,E.name))]):null}}).do(function(e){var t=e.data,n=e.headers;if("application/xml"===n["content-type"]){var o=String.fromCharCode.apply(null,new Uint8Array(t));if(0===o.indexOf("<ows:ExceptionReport"))throw o}(0,Ae.saveAs)(new Blob([t],{type:n&&n["content-type"]}),St(r))});var e}).do(function(e){var t=e.data,n=e.headers;(0,Ae.saveAs)(new Blob([t],{type:n&&n["content-type"]}),St(r))}).map(function(){return(0,s.iR)()}).catch(function(e){return ye().Observable.of((0,De.z3)({error:e,title:"layerdownload.error.title",message:"layerdownload.error.invalidOutputFormat",autoDismiss:5,position:"tr"}),(0,s.iR)())})})},Ft=function(e,t){return e.ofType(c.x7).filter(function(e){return"queryPanel"===e.control&&!(0,Ie.sY)(t.getState())&&(0,Ie.sl)(t.getState())}).switchMap(function(){return ye().Observable.of((0,c.KP)("layerdownload"))})},Rt=function(e,t){return e.ofType(s._m).exhaustMap(function(){var e=t.getState(),r=((0,p.kI)(e)||[]).filter(function(e){return"completed"===e.status});return r.length>0?ye().Observable.forkJoin(r.map(function(e){var t=e.result,r=t.indexOf("executionId="),n=t.slice(r),o=n.indexOf("&"),a=(o>-1?n.slice(0,o):n).slice(12),i=t.indexOf("?"),l=t.slice(0,i);return(0,Ve.HN)(l,a).let(nt.m9).catch(function(){return ye().Observable.of(null)}).map(function(t){return t?null:e.id})})).flatMap(function(e){return ye().Observable.of((0,s.FJ)(e.filter(function(e){return!!e})),(0,s.X8)(),(0,s.VO)(!1))}).startWith((0,s.VO)(!0)):ye().Observable.empty()})},Dt=function(e,t){return e.ofType(s.W2,s.jK,s.m8,s.kT).filter(function(){return(0,Le.M3)(t.getState())}).do(function(){var e=t.getState(),r=(0,p.kI)(e),n=(0,Le.dt)(e).id,o=JSON.stringify({results:r});document.cookie="exportDataResults_".concat(n,"=").concat(encodeURIComponent(o))}).flatMap(function(){return ye().Observable.empty()})},Tt=function(e){return e.ofType(Ne.mO).switchMap(function(){return e.ofType(Te.T_).switchMap(function(){return ye().Observable.of((0,s.D5)([]))}).takeUntil(e.ofType(Fe.LK))})},Nt=function(e,t){return e.ofType(Ne.mO).switchMap(function(){return Pt(t.getState()).concat(e.ofType(Te._x).switchMap(function(){return Pt(t.getState())}).takeUntil(e.ofType(Fe.LK)))})};function It(e){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},It(e)}function kt(e){return function(e){if(Array.isArray(e))return Lt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Lt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Mt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(r),!0).forEach(function(t){Gt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_t(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Gt(e,t,r){return(t=function(e){var t=function(e){if("object"!=It(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=It(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==It(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var qt=r(393149);function Ut(e){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ut(e)}var Wt=["onClick","selectedNodes","status","itemComponent","statusTypes"];function Vt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ht(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Vt(Object(r),!0).forEach(function(t){Bt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vt(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Bt(e,t,r){return(t=function(e){var t=function(e){if("object"!=Ut(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ut(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xt(){return Xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xt.apply(null,arguments)}var zt=(0,i.connect)(function(){return{}},{onClick:u.RG})(function(e){var t,r=e.onClick,n=e.selectedNodes,o=e.status,i=e.itemComponent,l=e.statusTypes,s=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,Wt),c=i,u=null==n||null===(t=n[0])||void 0===t?void 0:t.node;return![l.LAYER].includes(o)||!("wms"===(null==u?void 0:u.type)||null!=u&&u.search)||null!=u&&u.error?null:a().createElement(c,Xt({},s,{glyph:"download",tooltipId:"toc.toolDownloadTooltip",onClick:function(){var e;return r({url:(null===(e=u.search)||void 0===e?void 0:e.url)||u.url,name:u.name,id:u.id})}}))}),Yt=(0,i.connect)(null,{onClick:u.RG})(function(e){var t=e.onClick,r=e.itemComponent,n=e.layer,o=e.widgetId,i=r;return a().createElement(i,{glyph:"download",textId:"widgets.widget.menu.downloadData",onClick:function(){return t(Ht(Ht({},n),{},{widgetId:o}))}})});const Kt=(0,qt.i1)("LayerDownload",{component:(0,i.connect)((0,l.j8)({filterObj:p._V,enabled:p.lI,downloadOptions:p.Cg,loading:p.Uc,wfsFormats:p.Cb,formatsLoading:p.uy,mapLayer:f.ZT,downloadLayer:p.RF,wpsAvailable:p.hz,service:p.TH,checkingWPSAvailability:p.B_,virtualScroll:function(e){return e&&e.featuregrid&&e.featuregrid.virtualScroll},customAttributeSettings:y.b0,attributes:d.NY}),{onExport:s._n,onSetService:s._1,onSetWPSAvailability:s.yV,onDownloadOptionChange:s.Nw,onClearDownloadOptions:s.q_,onFormatOptionsFetch:s.$1,onClose:function(){return(0,c.KP)("layerdownload")}})(ce),containers:{Widgets:{doNotHide:!0,name:"LayerDownload",target:"table-menu-download",position:11,Component:Yt},Dashboard:{doNotHide:!0,name:"LayerDownload",target:"table-menu-download",position:11,Component:Yt},TOC:{doNotHide:!0,name:"LayerDownload",target:"toolbar",Component:zt,position:11},FeatureEditor:{doNotHide:!0,name:"LayerDownload",position:20,target:"toolbar",Component:(0,i.connect)((0,l.j8)({isDownloadOpen:function(e){var t;return null==e||null===(t=e.controls)||void 0===t||null===(t=t.layerdownload)||void 0===t?void 0:t.enabled}}),{onClick:function(){return(0,c.KP)("layerdownload")}})(function(e){var t=e.disabled,r=e.results,n=void 0===r?[]:r,o=e.mode,i=e.isDownloadOpen,l=e.onClick,s=void 0===l?function(){}:l;return a().createElement(fe,{id:"download-grid",keyProp:"download-grid",tooltipId:"featuregrid.toolbar.downloadGridData",disabled:t||0===n.length,active:i,visible:"VIEW"===o,onClick:s,glyph:"download"})})},BrandNavbar:{doNotHide:!0,name:"LayerDownload",target:"right-menu",position:-1,Component:(0,i.connect)((0,l.j8)({active:p.M1,checkingExportDataEntries:p.gL,results:p.kI,currentLocale:m.Pd}),{onToggle:c.KP.bind(null,"exportDataResults","enabled"),onActive:s.HS,onRemoveResult:s.WL})(ue.A)}},epics:n,reducers:{layerdownload:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{downloadOptions:{singlePage:!0}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.dC:return Mt(Mt({},e),{},{downloadLayer:t.layer});case s.Ne:return Mt(Mt({},e),{},{loading:!0});case s.VA:return Mt(Mt({},e),{},{downloadOptions:Mt(Mt({},e.downloadOptions),{},Gt({},t.key,t.value))});case s.GD:return Mt(Mt({},e),{},{downloadOptions:{singlePage:!0},service:t.defaultSelectedService});case s.cl:return Mt(Mt({},e),{},{layer:t.layer,wfsFormats:[],formatsLoading:!0});case s.eK:return Mt(Mt({},e),{},{loading:!1});case s.vp:return Mt(Mt({},e),{},{wfsFormats:t.wfsFormats,formatsLoading:!1});case s.Vz:return Mt(Mt({},e),{},{service:t.service});case s.WR:return Mt(Mt({},e),{},{wpsAvailable:t.value});case s.Ex:return Mt(Mt({},e),{},{checkingWPSAvailability:t.checking});case s.qp:return Mt(Mt({},e),{},{results:t.results});case s.W2:return Mt(Mt({},e),{},{results:[].concat(kt(e.results||[]),[t.result])});case s.m8:var r=w()(e.results||[],{id:t.id});return Mt(Mt({},e),{},{results:r>-1?[].concat(kt(e.results.slice(0,r)),[Mt(Mt({},e.results[r]),t.newProps||{})],kt(e.results.slice(r+1))):e.results});case s.jK:return Mt(Mt({},e),{},{results:(e.results||[]).filter(function(e){return e.id!==t.id})});case s.GS:return Mt(Mt({},e),{},{results:(e.results||[]).filter(function(e){return-1===w()(t.ids,function(t){return t===e.id})})});case s.mf:return Mt(Mt({},e),{},{checkingExportDataEntries:t.checking});default:return e}}}})},564116:(e,t,r)=>{"use strict";r.d(t,{Ud:()=>i,ic:()=>s,x9:()=>a});var n=r(400912),o=r.n(n),a={json:"ext-json",wmc:"ext-wmc"},i={json:"JSON",wmc:"WMC"},l=[{outputFormat:"shape-zip",extension:"zip"},{outputFormat:"csv",extension:"csv"},{outputFormat:"excel",extension:"xls"},{outputFormat:"excel2007",extension:"xlsx"},{outputFormat:"dxf",extension:"dxf"},{outputFormat:"dxf-zip",extension:"zip"},{outputFormat:"application/vnd.google-earth.kml+xml",extension:"kml"},{outputFormat:"application/json",extension:"json"},{outputFormat:"gml3",extension:"gml"},{outputFormat:"GML2",extension:"gml"},{outputFormat:"application/vnd.googlxml",extension:"kml"},{outputFormat:"OGR-CSV",extension:"csv"},{outputFormat:"OGR-FileGDB",extension:"gdb"},{outputFormat:"OGR-GPKG",extension:"gpkg"},{outputFormat:"OGR-KML",extension:"kml"},{outputFormat:"OGR-MIF",extension:"mif"},{outputFormat:"OGR-TAB",extension:"tab"},{outputFormat:"SHAPE-ZIP",extension:"zip"},{outputFormat:"gml32",extension:"gml"},{outputFormat:"application/x-gpk",extension:"gpk"}],s=function(e){return o()(l.filter(function(t){return t.outputFormat===e}))||function(e){var t=e.split(/[^\w]/)[1];return t?{outputFormat:e,extension:t.toLowerCase()}:void 0}(e)}},791936:function(e,t,r){var n,o=o||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,r=function(){return e.URL||e.webkitURL||e},n=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in n,a=/constructor/i.test(e.HTMLElement)||e.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent),l=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},s=function(e){setTimeout(function(){"string"==typeof e?r().revokeObjectURL(e):e.remove()},4e4)},c=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},u=function(t,u,p){p||(t=c(t));var d,f=this,m="application/octet-stream"===t.type,y=function(){!function(e,t){for(var r=(t=[].concat(t)).length;r--;){var n=e["on"+t[r]];if("function"==typeof n)try{n.call(e,e)}catch(e){l(e)}}}(f,"writestart progress write writeend".split(" "))};if(f.readyState=f.INIT,o)return d=r().createObjectURL(t),void setTimeout(function(){var e,t;n.href=d,n.download=u,e=n,t=new MouseEvent("click"),e.dispatchEvent(t),y(),s(d),f.readyState=f.DONE});!function(){if((i||m&&a)&&e.FileReader){var n=new FileReader;return n.onloadend=function(){var t=i?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,f.readyState=f.DONE,y()},n.readAsDataURL(t),void(f.readyState=f.INIT)}d||(d=r().createObjectURL(t)),m?e.location.href=d:e.open(d,"_blank")||(e.location.href=d),f.readyState=f.DONE,y(),s(d)}()},p=u.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,r){return t=t||e.name||"download",r||(e=c(e)),navigator.msSaveOrOpenBlob(e,t)}:(p.abort=function(){},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,function(e,t,r){return new u(e,t||e.name||"download",r)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);e.exports?e.exports.saveAs=o:null!==r.amdD&&null!==r.amdO&&(void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n))},913195:e=>{var t=Math.floor,r=Math.random;e.exports=function(e,n){return e+t(r()*(n-e+1))}},258253:(e,t,r)=>{var n=r(913195),o=r(936800),a=r(217400),i=parseFloat,l=Math.min,s=Math.random;e.exports=function(e,t,r){if(r&&"boolean"!=typeof r&&o(e,t,r)&&(t=r=void 0),void 0===r&&("boolean"==typeof t?(r=t,t=void 0):"boolean"==typeof e&&(r=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=a(e),void 0===t?(t=e,e=0):t=a(t)),e>t){var c=e;e=t,t=c}if(r||e%1||t%1){var u=s();return l(e+u*(t-e+i("1e-"+((u+"").length-1))),t)}return n(e,t)}}}]);