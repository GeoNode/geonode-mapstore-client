"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[59606],{271020:(e,t,n)=>{n.d(t,{Ix:()=>l,W:()=>a,a:()=>r,bq:()=>u,oR:()=>o,qg:()=>i});var r="MAP_LAYOUT:UPDATE_MAP_LAYOUT",o="MAP_LAYOUT:UPDATE_DOCK_PANELS",i="MAP_LAYOUT:FORCE_UPDATE_MAP_LAYOUT";function l(e){return{type:r,layout:e}}function a(e){return{type:o,name:e,action:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",location:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"right"}}function u(){return{type:i}}},792744:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(995531),o=n(779893),i=n(499084),l=n.n(i),a=n(730886);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function s(e){var t=e||o.Ay.getConfigProp("contextPluginsConfiguration")||"configs/pluginsConfig.json",n=l()(t);return r.A.all(n.map((function(e){return r.A.get(e).then((function(e){return e.data})).catch((function(){return null}))}))).then((function(e){var t,n=function(e){if(Array.isArray(e))return e}(t=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),r=n[0],o=n.slice(1);if(!r)throw new Error("plugins configuration file is broken");return(0,a.Kw)(r,o.filter((function(e){return e&&"object"===u(e)})))}))}},97401:(e,t,n)=>{n.d(t,{MA:()=>E,SU:()=>O,iS:()=>p,lU:()=>S,o:()=>v,o7:()=>b,si:()=>w,tV:()=>h,u$:()=>m,wd:()=>g});var r=n(400912),o=n.n(r),i=n(150104),l=n.n(i),a=n(131127),u=n(6683),c=n(779893);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return(t=function(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){return e.maplayout&&e.maplayout.layout||{}},v=function(e){return e.maplayout&&e.maplayout.boundingMapRect||{}},p=function(e){return e.maplayout&&e.maplayout.boundingSidebarRect||{}},b=l()((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=m(e),o=p(e);return r&&Object.keys(r).filter((function(e){return t[e]})).reduce((function(e,t){var i;return y(y({},e),{},d({},t,n&&null!==(i=o[t])&&void 0!==i?i:r[t]))}),{})||{}}),(function(e,t,n){return JSON.stringify(m(e))+JSON.stringify(p(e))+JSON.stringify(t)+(n?"_isDock":"")})),g=function(e){var t;return!(null===(t=m(e))||void 0===t||!t.rightPanel)},S=function(e){var t,n=c.Ay.getConfigProp("mapLayout")||u.OH;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=m(e);return!!o()(t.filter((function(e){return n[e.key]})).map((function(e){return"not"===e.type?n[e.key]!==e.value&&n[e.key]:n[e.key]===e.value})))}(e,[{key:"bottom",value:null!==(t=null==n?void 0:n.bottom.sm)&&void 0!==t?t:0,type:"not"}])},h=function(e){var t=(0,a.mg)(e),n=v(e);return n&&t&&t.size&&{left:(0,u.n_)(n.left,t.size.width),bottom:(0,u.n_)(n.bottom,t.size.height),right:(0,u.n_)(n.right,t.size.width),top:(0,u.n_)(n.top,t.size.height)}},O=function(e){var t,n;return null!==(t=null==e||null===(n=e.maplayout)||void 0===n?void 0:n.dockPanels)&&void 0!==t?t:{left:[],right:[]}},w=function(e){return b(e,{height:!0,right:!0},!0)},E=function(e){return b(e,{right:!0},!0)}},550501:(e,t,n)=>{n.d(t,{BD:()=>c,LO:()=>a,Vz:()=>u,ax:()=>s});var r=n(995531),o=n(792744),i=n(733120),l={},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/static/mapstore/configs/map.json";return l.newMapConfig?new Promise((function(e){return e(l.newMapConfig)})):r.A.get(e).then((function(e){var t=e.data;return l.newMapConfig=t,t})).then((function(e){return window.overrideNewMapConfig?window.overrideNewMapConfig(e):e}))},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/static/mapstore/configs/geostory.json";return l.newGeoStoryConfig?new Promise((function(e){return e(l.newGeoStoryConfig)})):r.A.get(e).then((function(e){var t=e.data;return l.newGeoStoryConfig=t,t})).then((function(e){return window.overrideNewGeoStoryConfig?window.overrideNewGeoStoryConfig(e):e}))},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/static/mapstore/configs/styleTemplates.json";return l.styleTemplatesConfig?new Promise((function(e){return e(l.styleTemplatesConfig)})):r.A.get(e).then((function(e){var t=e.data;return l.styleTemplatesConfig=null==t?void 0:t.templates,l.styleTemplatesConfig}))},s=function(){return null!=l&&l.pluginsConfig?Promise.resolve(l.pluginsConfig):(0,o.A)((0,i.d6)("geoNodeSettings.staticPath","/static/")+"mapstore/configs/pluginsConfig.json").then((function(e){return l.pluginsConfig=e,e}))}},344720:(e,t,n)=>{n.d(t,{J:()=>c});var r=n(403467);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var i=["msForceVisual"];function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return(t=function(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){var t=e.baseUrl,o=e.styleName;return n.e(83503).then(n.t.bind(n,883503,23)).then((function(e){var n=e.default;return(0,r.Fr)({baseUrl:t,styleName:o}).then((function(e){var l=(null==e?void 0:e.metadata)||{},u=l.msForceVisual,c=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(l,i);if(!u||""===u)return e;var s=a(a({},c),{},{msForceVisual:"",msEditorType:"visual",msStyleJSON:"",msMD5Hash:n(null==e?void 0:e.code)});return(0,r.nn)(a(a({},e),{},{baseUrl:t,styleName:o,metadata:s,options:{params:{raw:!0}}})).then((function(){return a(a({},e),{},{metadata:s})}))}))}))}},575011:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(273517);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const i=function(e,t){var n,i,l=function(){if("undefined"==typeof window)return t;try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(n){return console.log("Error to get item key “".concat(e,"”:"),n),t}},a=(n=(0,r.useState)(l),i=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,a=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(n,i)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(n,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=a[0],c=a[1];return(0,r.useEffect)((function(){c(l())}),[]),(0,r.useEffect)((function(){var e=function(){c(l())};return window.addEventListener("localStorage",e),function(){window.removeEventListener("localStorage",e)}}),[]),[u,function(t){try{var n=t instanceof Function?t(u):t;c(n),window.localStorage.setItem(e,JSON.stringify(n)),window.dispatchEvent(new Event("localStorage"))}catch(t){console.log("Error “".concat(e,"”:"),t)}}]}},758684:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ye});var r=n(273517),o=n.n(r),i=n(393149),l=n(811668),a=n(801081),u=n(8117),c=n(234164),s=n(620864),f=n(549111),y=n(415392),d=n(972192),m=n(904059),v=n(348081),p=n(8571),b=n(406250),g=n(229710),S=n(403467),h=n(97401),O=n(164045),w=n(307679),E=n(320089),j=n(45388),A=n(541033),P=n.n(A),C=n(593429),N=n(714905),T=n(987021),k=n.n(T),U=n(425380),I=n(344720),M=n(271020),D=n(779893),L=n(959314);function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e,t,n){return(t=function(e){var t=function(e){if("object"!=_(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e){var t=e.type,n=e.title,r=k()("hsl(".concat(Math.floor(270*Math.random()),", 90%, 70%)")).toHexString();switch(t){case"raster":return"@mode 'Flat'; @styleTitle '"+n+"'; \n* {\n\traster-channels: auto;\n\traster-opacity: 1;\n}\n";case"point":default:return"@mode 'Flat'; @styleTitle '"+n+"'; \n* {\n\tmark: symbol('square');\n\t:mark {\n\t\tfill: "+r+";\n\t\tsize: 4;\n\t}\n}\n";case"linestring":return"@mode 'Flat'; @styleTitle '"+n+"'; \n* {\n\tstroke: "+r+";\n}\n";case"polygon":return"@mode 'Flat'; @styleTitle '"+n+"'; \n* {\n\tfill: "+r+";\n}\n"}}const V={gnRequestDatasetAvailableStyles:function(e,t){return e.ofType("GEONODE:REQUEST_DATASET_AVAILABLE_STYLES").switchMap((function(e){var n,r=t.getState(),o=(null==e||null===(n=e.options)||void 0===n?void 0:n.styleService)||(0,v.gr)(r);return j.Observable.concat(j.Observable.of((0,y.fN)("visualStyleEditor","enabled",!0),(0,d.bM)(o,{editingAllowedRoles:["ALL"],editingAllowedGroups:[]})),j.Observable.defer((function(){return function(e){var t,n,r=e.layer,o=e.styleService,i=null==r||null===(t=r.extendedParams)||void 0===t||null===(t=t.mapLayer)||void 0===t||null===(t=t.dataset)||void 0===t?void 0:t.subtype,l=(null==r?void 0:r.availableStyles)||[];return 0===l.length?function(e,t){var n,r="visual";return e?(0,I.J)({baseUrl:null==t?void 0:t.baseUrl,styleName:(0,U.A2)(e)}).then((function(e){var t=e||{},n=t.metadata,r=void 0===n?{}:n,o=t.code,i=t.format,l=t.languageVersion;return{msEditorType:null==r?void 0:r.msEditorType,msStyleJSON:null==r?void 0:r.msStyleJSON,code:o,format:i,languageVersion:l}})).catch((function(){return{msEditorType:r,msStyleJSON:null,code:n}})):new Promise((function(e){return e({msStyleJSON:null,msEditorType:r,code:n})}))}(null==r||null===(n=r.extendedParams)||void 0===n||null===(n=n.mapLayer)||void 0===n||null===(n=n.dataset)||void 0===n?void 0:n.default_style,o).then((function(e){var t,n,l=e||{},a=l.msEditorType,u=l.msStyleJSON,c=l.code,s=l.format,f=l.languageVersion,y=r.name.split(":"),d=1===y.length?y[0]:y[y.length-1],m=(n=d,"geonode:".concat(P()(),"_ms_").concat(n)),v={title:d,description:"",msStyleJSON:u,msEditorType:a,gnDatasetPk:null==r||null===(t=r.extendedParams)||void 0===t||null===(t=t.mapLayer)||void 0===t||null===(t=t.dataset)||void 0===t?void 0:t.pk};return S.Ay.createStyle(R({baseUrl:null==o?void 0:o.baseUrl,code:c||F({type:i,title:d}),format:c&&s?s:"css",styleName:m,metadata:v,options:{params:{raw:!0}}},c&&s&&{languageVersion:f})).then((function(){return[[{name:m,title:d,metadata:v,format:s}],!0]}))})):new Promise((function(e){return e([l])}))}({layer:e.layer,styleService:o})})).switchMap((function(t){var n,r,i,l,a=(i=t,l=1,function(e){if(Array.isArray(e))return e}(i)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,a=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(i,l)||function(e,t){if(e){if("string"==typeof e)return x(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}(i,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],u=(null==e||null===(n=e.options)||void 0===n?void 0:n.style)||(null==a||null===(r=a[0])||void 0===r?void 0:r.name);return j.Observable.concat(j.Observable.defer((function(){return S.Ay.getStylesInfo({baseUrl:null==o?void 0:o.baseUrl,styles:a})})).switchMap((function(t){return j.Observable.of((0,m.OK)(e.layer.id,"layer",{availableStyles:t}),(0,m.b6)({style:u},!0),(0,C.E)(e.layer.id,N.gt,"override",{}),(0,d.yB)("edit"))})))})))}))},gnUpdateStyleInfoOnSave:function(e,t){return e.ofType(d.I4).switchMap((function(){var e=t.getState(),n=(0,v.Nh)(e);return j.Observable.of((0,m.OK)(n.id,"layers",{style:n.style}))}))},gnUpdateVisualStyleEditorMapLayout:function(e,t){return e.ofType(M.a,y.$4).filter((function(){var e;return null===(e=t.getState())||void 0===e||null===(e=e.controls)||void 0===e||null===(e=e.visualStyleEditor)||void 0===e?void 0:e.enabled})).filter((function(e){return e.source!==L.v.PANEL})).map((function(e){var n=e.layout,r=(0,D.Uh)("mapLayout")||{left:{sm:300,md:500,lg:600},right:{md:658},bottom:{sm:30}},o=(0,h.iS)(t.getState()),i=(0,M.Ix)(R(R(R({},(0,h.u$)(t.getState())),n),{},{left:r.left.md,boundingMapRect:R(R({},(null==n?void 0:n.boundingMapRect)||{}),{},{left:r.left.md}),boundingSidebarRect:R(R({},o),null==n?void 0:n.boundingSidebarRect)}));return R(R({},i),{},{source:L.v.PANEL})}))}};var G=n(172175),$=n(575011),B=n(720538),K=n(232877),Y=n(491281),q=n(550501);function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t,n){return(t=function(e){var t=function(e){if("object"!=H(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=H(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==H(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,a=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ee(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var te=(0,O.A)(E.A);function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ie(e,t,n){return(t=function(e){var t=function(e){if("object"!=ne(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ne(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ne(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,a=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ae(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ae(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ue=(0,O.A)(E.A),ce=(0,l.connect)((0,a.Mz)([v.GZ,v.Ux,v.tg,v.zs,w.Kv],(function(e,t,n,r,o){var i;return{isStyleChanged:void 0!==e&&void 0!==t&&e!==t,loading:n,error:!(null==r||null===(i=r.edit)||void 0===i||!i.status),layerLoading:o&&o.some((function(e){return e.loading}))}})),{onClick:d.kX})((function(e){var t=e.variant,n=e.onClick,r=e.size,i=e.isStyleChanged,l=e.error,a=e.loading,u=e.layerLoading,c=e.msgId,s=void 0===c?"gnviewer.applyStyle":c,f=!!(a||u||l);return i?o().createElement(ue,{variant:t||"primary",className:i?"gn-pending-changes-icon":"",size:r,disabled:f,onClick:f?function(){}:function(){return n()}},o().createElement(p.A,{msgId:s})):null})),se=(0,l.connect)((0,a.Mz)([v.Nh,v.oN,v.hl,v.Ux,v.mA,function(e){var t;return null==e||null===(t=e.controls)||void 0===t||null===(t=t.visualStyleEditor)||void 0===t?void 0:t.tmpCode}],(function(e,t,n,r,o,i){var l;return{geometryType:t,format:n,selectedStyle:null==e||null===(l=e.availableStyles)||void 0===l?void 0:l.find((function(e){return e.name===o})),code:r,tmpCode:i}})),{onSelect:d.Bd,onUpdateMetadata:d.SI,onStoreTmpCode:y.fN.bind(null,"visualStyleEditor","tmpCode")})((function(e){var t=e.code,n=e.format,i=e.geometryType,l=e.onSelect,a=e.selectedStyle,u=e.onUpdateMetadata,c=e.tmpCode,s=e.onStoreTmpCode,f=(0,r.useRef)(),y=W((0,r.useState)([]),2),d=y[0],m=y[1],v=W((0,r.useState)(),2),b=v[0],g=v[1],S=W((0,r.useState)(!1),2),h=S[0],O=S[1];(0,r.useEffect)((function(){return f.current=!0,(0,q.BD)().then((function(e){f.current&&m(e)})),function(){f.current=!1}}),[]);var w=(0,r.useRef)();w.current=function(e){e?s(t):(g(void 0),c&&l(c))},(0,r.useEffect)((function(){return function(){s("")}}),[]);var E=d.filter((function(e){return e.types.includes(i)}));return(null==E?void 0:E.length)>0?o().createElement(K.A,{key:h,placement:"right",open:h,onOpen:function(e){O(e),w.current(e)},content:o().createElement("div",{className:"gn-visual-style-editor-templates"},o().createElement("ul",null,E.map((function(e,t){var r;return o().createElement("li",{key:t,className:"gn-visual-style-editor-template".concat(b===t?" selected":""),onClick:function(){return function(e,t){var r,o=e.code;g(t);var i=(null==a||null===(r=a.metadata)||void 0===r?void 0:r.title)||(null==a?void 0:a.label)||(null==a?void 0:a.title)||(null==a?void 0:a.name)||"";(0,Y.getStyleParser)(n).then((function(e){e.writeStyle(X(X({},o),{},{name:i})).then((function(e){f.current&&l(e)}))}))}(e,t)}},o().createElement("div",{className:"gn-visual-style-editor-template-preview"},null!=e&&null!==(r=e.preview)&&void 0!==r&&r.config?o().createElement(B.A,e.preview.config):null==e?void 0:e.preview),o().createElement("div",{className:"gn-visual-style-editor-template-title"},e.title))}))),o().createElement("div",{className:"gn-visual-style-editor-templates-footer"},o().createElement(te,{size:"xs",disabled:void 0===b,variant:"primary",onClick:function(){s(t),u({styleJSON:null,editorType:"visual"}),O(!1)}},o().createElement(p.A,{msgId:"gnviewer.copy"}))))},o().createElement(te,{size:"xs"},o().createElement(p.A,{msgId:"gnviewer.copyFrom"}))):null})),fe=(0,l.connect)((0,a.Mz)([v.Nh,v.sD,v.gr,v.GZ,function(e){var t;return null==e||null===(t=e.controls)||void 0===t||null===(t=t.visualStyleEditor)||void 0===t?void 0:t.enabled},function(e){return(0,h.o7)(e,{height:!0})},w.ZT,v.Ux,G.H2],(function(e,t,n,r,o,i,l,a,u){return{layer:e,temporaryStyleId:t,styleService:n,initialCode:r,enabled:o,style:i,originalStyle:null==l?void 0:l.style,isStyleChanged:void 0!==r&&void 0!==a&&r!==a,resourceType:u}})),{onUpdateStatus:d.yB,onUpdateParams:m.b6,onInit:d.bM,onReset:d.hD.bind(null,void 0,!1),onSave:d.kX,onClose:y.fN.bind(null,"visualStyleEditor","enabled",!1),onUpdateNode:m.OK},(function(e,t,n){var r,o,i,l=(null===(r=n.styleService)||void 0===r?void 0:r.baseUrl)===(null===(o=e.styleService)||void 0===o?void 0:o.baseUrl)&&(null===(i=e.styleService)||void 0===i?void 0:i.isStatic),a=n.styleService&&!l?oe(oe({},n.styleService),{},{isStatic:!0}):oe({},e.styleService);return oe(oe(oe(oe({},n),e),t),{},{styleService:a})}))((function(e){var t=e.layer,n=e.editorConfig,i=e.styleService,l=e.onInit,a=e.onReset,s=e.temporaryStyleId,f=e.showLayerProperties,y=e.initialCode,d=e.enabled,m=e.onClose,v=e.style,h=e.isStyleChanged,O=e.resourceType,w=le((0,r.useState)(!1),2),E=w[0],j=w[1],A=le((0,$.A)("style-notifcation",!1),2),P=A[0],C=A[1],N=le((0,r.useState)(!1),2),T=N[0],k=N[1],U=(0,r.useRef)();function I(e){e?(a(),m()):j(!0)}return U.current=function(){s&&S.Ay.deleteStyle({baseUrl:i.baseUrl,styleName:s})},(0,r.useEffect)((function(){function e(){U.current()}return l(i),window.addEventListener("beforeunload",e),function(){window.removeEventListener("beforeunload",e),a()}}),[]),d&&t.id?o().createElement("div",{className:"gn-visual-style-editor",style:v},f&&o().createElement("div",{className:"gn-visual-style-editor-layer-info"},o().createElement("div",{className:"gn-visual-style-editor-layer-title"},t.title),o().createElement(ue,{onClick:I.bind(null,!h),className:"square-button"},o().createElement(u.e6,{glyph:"1-close"}))),!T&&!P&&"map"===O&&o().createElement("div",{className:"gn-visual-style-editor-alert alert-info"},o().createElement("div",{className:"gn-visual-style-editor-alert-message"},o().createElement(p.A,{msgId:"gnviewer.stylesFirstClone"}),o().createElement(ue,{size:"xs",variant:"transparent",onClick:function(){C(!0)}},o().createElement("p",null,o().createElement(p.A,{msgId:"gnviewer.dismissMessage"})))),o().createElement(ue,{size:"xs",variant:"transparent",onClick:function(){k(!0)}},o().createElement(u.e6,{glyph:"remove"}))),o().createElement("div",{className:"gn-visual-style-editor-body"},o().createElement("div",null,o().createElement(c.ah,{key:y,config:n,header:o().createElement(o().Fragment,null,o().createElement(se,null),o().createElement(ce,{variant:"primary",size:"xs"}))}))),o().createElement(b.A,null,o().createElement(g.A,{title:o().createElement(p.A,{msgId:"gnviewer.styleEditorCloseTitle"}),fitContent:!0,clickOutEnabled:!1,show:E,onClose:function(){j(!1)},buttons:[{text:o().createElement(p.A,{msgId:"gnviewer.styleEditorCloseCancel"}),onClick:function(){j(!1)}},{text:o().createElement(p.A,{msgId:"gnviewer.styleEditorCloseConfirm"}),bsStyle:"primary",onClick:function(){j(!1),I(!0)}}]},o().createElement("div",{style:{padding:"1rem"}},o().createElement(p.A,{msgId:"gnviewer.styleEditorCloseMessage"}))))):null}));const ye=(0,i.i1)("VisualStyleEditor",{component:fe,containers:{},reducers:{styleeditor:s.A},epics:oe(oe({},f.Ay),V)})},959314:(e,t,n)=>{n.d(t,{v:()=>r});var r={PANEL:"PANEL"}}}]);