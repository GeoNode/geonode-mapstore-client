"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[9412],{447430:(e,t,r)=>{r.d(t,{A:()=>v});var n=r(605556),o=r.n(n),i=r(273517),a=r.n(i),l=r(750042),u=r.n(l);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(f=function(){return!!e})()}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function p(e,t,r){return(t=m(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}r.e(4434).then(r.bind(r,664434));var b=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,r){return t=d(t),function(e,t){if(t&&("object"==c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,f()?Reflect.construct(t,r||[],d(e).constructor):t.apply(e,r))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){return this.props.loading?a().createElement("div",{className:this.props.className,id:this.props.id},a().createElement(u(),{noFadeIn:!0,overrideSpinnerClassName:"spinner",spinnerName:this.props.spinner})):null}}])&&s(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);p(b,"propTypes",{id:o().string,loading:o().bool,className:o().string,spinner:o().string}),p(b,"defaultProps",{id:"mapstore-globalspinner",loading:!1,className:"ms2-loading",spinner:"circle"});const v=b},629692:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Ke});var n=r(605556),o=r.n(n),i=r(273517),a=r.n(i),l=r(292935),u=r(811668),c=r(916589),s=r(801081),f=r(227341),d=r.n(f),y=r(71665),p=r(8571),m=r(697950),b=r(563864);const v=(0,c.branch)(function(e){return e.selectionActive},(0,c.compose)((0,c.withProps)(function(e){var t=e.className;return{className:"".concat(t," selection-active")}}),(0,c.withHandlers)({getWidgetClass:function(e){var t=e.getWidgetClass,r=void 0===t?function(){}:t,n=e.isWidgetSelectable,o=void 0===n?function(){return!0}:n;return function(e){return r(e)?r(e)+(o(e)?void 0:" disabled"):o(e)?void 0:" disabled"}},onWidgetClick:function(e){var t=e.onWidgetSelected,r=void 0===t?function(){}:t,n=e.isWidgetSelectable,o=void 0===n?function(){return!0}:n;return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return o(e)?r.apply(void 0,[e].concat(n)):null}}})));var g=r(8117),h=r(694838),w=r(132672);function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?j(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach(function(t){A(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function A(e,t,r){return(t=function(e){var t=function(e){if("object"!=S(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==S(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return x(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var I=(0,h.A)(g.Dr),C=function(e){var t=e.handleSelect,r=e.isSelected,n=e.id,o=e.color,l=e.name,u=e.onRemove,c=e.onMove,s=e.canDelete,f=e.onConfigure,d=e.canMoveLeft,y=e.canMoveRight,m=e.canEdit,b=D((0,i.useState)({left:0,bottom:0,right:0}),2),v=b[0],h=b[1],w=(0,i.useRef)(null);return a().createElement(g.ms,{dropup:!0,bsStyle:"default",id:n,className:"".concat(r?"is-selected ":"","ms-layout-view"),style:{borderBottom:"2px solid ".concat(o)}},a().createElement(g.$n,{onClick:function(){return t(n)},bsStyle:"default"},l),m&&a().createElement(g.ms.Toggle,{onClick:function(){if(t(n),w.current){var e=w.current.getBoundingClientRect();window.innerWidth-e.right<200?h({right:window.innerWidth-e.right-4,bottom:window.innerHeight-e.top+10,left:"auto"}):h({left:e.left-4,bottom:window.innerHeight-e.top+10,right:"auto"})}},noCaret:!0},a().createElement("div",{ref:w},a().createElement(g.e6,{glyph:"option-vertical"}))),a().createElement(g.ms.Menu,{className:"_fixed",style:P({},v)},a().createElement(I,{confirmTitle:a().createElement(p.A,{msgId:"dashboard.view.removeConfirmTitle"}),confirmContent:a().createElement(p.A,{msgId:"dashboard.view.removeConfirmContent"}),onClick:function(){return u(n)},disabled:!s},a().createElement(g.e6,{glyph:"trash"}),a().createElement(p.A,{msgId:"dashboard.view.delete"})),a().createElement(g.Dr,{onClick:function(){f()}},a().createElement(g.e6,{glyph:"cog"}),a().createElement(p.A,{msgId:"dashboard.view.configure"})),a().createElement(g.Dr,{onClick:function(){c(n,"right")},disabled:!y},a().createElement(g.e6,{glyph:"arrow-right"}),a().createElement(p.A,{msgId:"dashboard.view.moveRight"})),a().createElement(g.Dr,{onClick:function(){c(n,"left")},disabled:!d},a().createElement(g.e6,{glyph:"arrow-left"}),a().createElement(p.A,{msgId:"dashboard.view.moveLeft"}))))};const k=function(e){var t=e.layouts,r=void 0===t?[]:t,n=e.selectedLayoutId,o=e.onSelect,l=e.onAdd,u=e.onRemove,c=e.onMove,s=e.onConfigure,f=e.canEdit,d=function(e){null==o||o(e)},y=function(e){var t=e.data,r=(0,i.useRef)(null),n=O((0,i.useState)(!0),2),o=n[0],a=n[1],l=O((0,i.useState)(!0),2),u=l[0],c=l[1],s=O((0,i.useState)(!1),2),f=s[0],d=s[1];return(0,i.useEffect)(function(){var e=function(){var e=r.current;if(e){var t=e.scrollLeft,n=e.scrollWidth,o=e.clientWidth;d(n>o+1),a(t<=0),c(t+o>=n-1)}},t=r.current;return t&&(e(),t.addEventListener("scroll",e),window.addEventListener("resize",e)),function(){null==t||t.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[t]),[r,f,o,u,function(e){var t=r.current;if(t){var n=.8*t.clientWidth;t.scrollBy({left:"left"===e?-n:n,behavior:"smooth"})}}]}({data:r}),p=D(y,5),m=p[0],b=p[1],v=p[2],h=p[3],j=p[4];return a().createElement(w.A,{gap:"xs",centerChildrenVertically:!0,className:"view-switcher-container"},f&&a().createElement(g.$n,{onClick:l,className:"square-button-md _margin-l-xs _margin-tb-xs",title:"Add a layout view to the dashboard"},a().createElement(g.e6,{glyph:"plus"})),a().createElement(w.A,{centerChildrenVertically:!0,ref:m,className:"_overflow-auto _fill view-switcher-tabs"},r.map(function(e,t){var o=e.id||t+1;return a().createElement(C,{key:o,id:o,name:e.name,color:e.color,handleSelect:d,isSelected:n===o,onRemove:u,onMove:c,onConfigure:s,canDelete:r.length>1,canMoveRight:t!==r.length-1,canMoveLeft:0!==t,canEdit:f})})),b&&a().createElement(w.A,{gap:"xs",centerChildrenVertically:!0,className:"view-scroll-buttons"},a().createElement(g.$n,{className:"square-button-md",bsStyle:"primary",onClick:function(){return j("left")},disabled:v,title:"Scroll left"},a().createElement(g.e6,{glyph:"chevron-left"})),a().createElement(g.$n,{className:"square-button-md",bsStyle:"primary",onClick:function(){return j("right")},disabled:h,title:"Scroll right"},a().createElement(g.e6,{glyph:"chevron-right"}))))};var T=r(541033),L=r.n(T),_=r(549112),W=r(711520),N=r(7235),M=r(192016),R=r(406250),V=r(622795);function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||$(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,t){if(e){if("string"==typeof e)return B(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(e,t):void 0}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach(function(t){Z(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Z(e,t,r){return(t=function(e){var t=function(e){if("object"!=H(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=H(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==H(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var J=(0,r(164045).A)(g.e6);const X=function(e){var t,r,n=e.active,o=e.onToggle,l=e.data,u=e.onSave,c=e.user,s=e.configureViewOptions,f=z((0,i.useState)(l),2),d=f[0],y=f[1],m=z((0,i.useState)([]),2),b=m[0],v=m[1];(0,i.useEffect)(function(){if(n&&c){var e=function(e){var t=e.configureViewOptions,r=e.user,n=t.query,o=void 0===n?{}:n,i=t.resourcesType,a=void 0===i?[]:i;return[{params:U({pageSize:9999999},o)},{user:r},a]}({configureViewOptions:s,user:c});V.Bv.apply(void 0,(t=e,function(e){if(Array.isArray(e))return B(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||$(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).toPromise().then(function(e){var t=e.resources.map(function(e){return{value:e.id||e.pk,label:e.name}});v(t)})}var t},[n,c]);var h=!!l.dashboard||0===(null===(t=l.layoutsData)||void 0===t||null===(t=t.md)||void 0===t?void 0:t.length)&&0===(null===(r=l.layoutsData)||void 0===r||null===(r=r.xxs)||void 0===r?void 0:r.length);return n&&a().createElement(R.A,null,a().createElement(W.A,{id:"mapstore-export-data-results",draggable:!1,containerClassName:"configure-view-dialog-container",modal:!0},a().createElement("span",{role:"header"},a().createElement("span",{className:"modal-title about-panel-title"},a().createElement(p.A,{msgId:"dashboard.view.configure"})),a().createElement("button",{onClick:function(){return o()},className:"settings-panel-close close"},a().createElement(g.e6,{glyph:"1-close"}))),a().createElement("div",{role:"body",className:"_padding-lg"},a().createElement(g.gE,null,a().createElement(g.mq,null,a().createElement(p.A,{msgId:"dashboard.view.name"})),a().createElement(g.MJ,{type:"text",value:d.name,onChange:function(e){var t=(e.target||{}).value;y(function(e){return U(U({},e),{},{name:t})})}})),a().createElement(g.gE,{className:"ms-flex-box _flex _flex-gap-sm _flex-center-v _relative _padding-b-sm"},a().createElement(g.mq,null,a().createElement(p.A,{msgId:"dashboard.view.color"})),a().createElement(g.MG,{className:"dashboard-color-picker _relative"},a().createElement(N.A,{format:"rgb",color:d.color,onChangeColor:function(e){return e&&y(function(t){return U(U({},t),{},{color:e})})},placement:"right"}))),a().createElement(g.gE,{controlId:"thumbnail",key:"thumbnail",className:"ms-flex-box _flex _flex-gap-sm _flex-center-v _padding-b-sm"},a().createElement(g.Sc,{onChange:function(){return y(function(e){return U(U({},e),{},{linkExistingDashboard:!e.linkExistingDashboard})})},checked:d.linkExistingDashboard,disabled:!h},a().createElement(p.A,{msgId:"dashboard.view.linkExistingDashboard"})),!h&&a().createElement(J,{glyph:"info-sign",tooltipId:"dashboard.view.cannotAddExistingDashboard"})),d.linkExistingDashboard&&a().createElement(g.gE,null,a().createElement(g.mq,null,a().createElement(p.A,{msgId:"dashboard.view.selectDashboard"})),a().createElement(M.Ay,{value:d.dashboard||"",options:b,name:"dashboard",onChange:function(e){return y(function(t){return U(U({},t),{},{dashboard:null==e?void 0:e.value})})}}))),a().createElement("div",{role:"footer"},a().createElement(g.$n,{bsStyle:"default",onClick:function(){return o()}},a().createElement(p.A,{msgId:"dashboard.view.cancel"})),a().createElement(g.$n,{bsStyle:"primary",onClick:function(){return u(d)}},a().createElement(p.A,{msgId:"dashboard.view.save"})))))};var F=r(672975),G=r(639996);function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function K(e){return function(e){if(Array.isArray(e))return oe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ne(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(r),!0).forEach(function(t){te(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function te(e,t,r){return(t=function(e){var t=function(e){if("object"!=Q(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Q(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||ne(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){if(e){if("string"==typeof e)return oe(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?oe(e,t):void 0}}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ie=r(3162);function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}var le=["selectedLayout","layoutsData"];function ue(){return ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ue.apply(null,arguments)}function ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function se(e,t,r){return(t=function(e){var t=function(e){if("object"!=ae(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ae(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function de(e){var t,r,n=e.selectedLayout,o=e.layoutsData,l=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,le),u=function(e){var t=e.props,r=e.dashboard,n=re((0,i.useState)(!1),2),o=n[0],a=n[1],l=re((0,i.useState)({}),2),u=l[0],c=l[1],s=(0,i.useRef)({}),f=(0,i.useRef)(!1),d=t||{},y=d.layouts,p=void 0===y?[]:y,m=d.selectedLayoutId,b=d.onLinkedDashboardDataLoad,v=d.widgets,g=void 0===v?[]:v,h=(0,i.useMemo)(function(){return p&&m?p.find(function(e){return e.id===m}):null},[m,p]);return(0,i.useEffect)(function(){var e,t;if(r&&h){var n=s.current[m];c(function(e){return ee(ee({},e),{},te({},m,null))}),((null==h||null===(e=h.md)||void 0===e?void 0:e.length)>0||(null==h||null===(t=h.xxs)||void 0===t?void 0:t.length)>0)&&n===r||f.current||(f.current=!0,a(!0),(0,V.hZ)(r,"dashboard").toPromise().then(function(e){var t=Array.isArray(e.data.layouts)?e.data.layouts:[e.data.layouts];if((null==t?void 0:t.length)>1)c(function(e){return ee(ee({},e),{},te({},m,{messageId:"dashboard.errors.multipleDashboardError"}))});else{var n=null==t?void 0:t[0],o=e.data.widgets.map(function(e){return ee(ee({},e),{},{id:"".concat(m,"-").concat(e.id),layoutId:m},e.dependenciesMap&&{dependenciesMap:(0,_.tg)(e.dependenciesMap,m)})}),i=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(e){return ee(ee({},e),{},{i:"".concat(m,"-").concat(e.i)})})},a=p.map(function(e){return e.id===m?ee(ee({},e),{},{md:i(n.md),xxs:i(n.xxs)}):e});b({widgets:[].concat(K(g.filter(function(e){return e.layoutId!==m})),K(o)),layouts:a}),s.current[m]=r}}).catch(function(e){var t=(0,_.Jv)(e);c(function(e){return ee(ee({},e),{},te({},m,{messageId:t}))})}).finally(function(){f.current=!1,a(!1)}))}},[r,h,p,b,m,g]),[o,u[m]]}({props:l,dashboard:n.dashboard}),c=(r=2,function(e){if(Array.isArray(e))return e}(t=u)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,r)||function(e,t){if(e){if("string"==typeof e)return fe(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fe(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=c[0],f=c[1],d=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(r),!0).forEach(function(t){se(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},l);return l.widgets&&(d.widgets=l.widgets.filter(function(e){return e.layoutId===l.selectedLayoutId})),f?a().createElement("div",{style:{margin:"auto",fontWeight:"bold"}},a().createElement(ie.A,{title:a().createElement(p.A,{msgId:f.messageId})})):s?a().createElement("div",{style:{margin:"auto",fontWeight:"bold"}},a().createElement(F.A,{style:{display:"inline-block",verticalAlign:"middle"}}),a().createElement(p.A,{msgId:"loading"})):a().createElement(w.A.Fill,{classNames:["_relative","_overflow-auto"]},a().createElement(G.A,ue({},d,{layouts:o,canEdit:!n.dashboard&&l.canEdit})))}function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}var pe=["id","name","color","linkExistingDashboard","dashboard"];function me(){return me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},me.apply(null,arguments)}function be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?be(Object(r),!0).forEach(function(t){ge(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ge(e,t,r){return(t=function(e){var t=function(e){if("object"!=ye(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ye(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function he(e){return function(e){if(Array.isArray(e))return we(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return we(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?we(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Oe(e){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oe(e)}function je(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?je(Object(r),!0).forEach(function(t){Ee(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):je(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ee(e,t,r){return(t=function(e){var t=function(e){if("object"!=Oe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Oe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Oe(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Pe=(0,c.compose)(c.pure,(0,c.defaultProps)({breakpoints:{md:480,xxs:0},cols:{md:6,xxs:1},minLayoutWidth:480}),(0,m.Qy)({overrideWidthProvider:!0}),(0,c.withProps)(function(e){var t=e.width;return{width:t<=e.minLayoutWidth?t-18:t,toolsOptions:{showMaximize:!0}}}),(0,c.withProps)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,r=e.height,n=e.maximized,o=e.minLayoutWidth,i=e.cols,a=null!=n&&n.widget?{width:"100%",height:"100%",marginTop:0,bottom:"auto",top:0,left:0,zIndex:99}:{},l=null!=n&&n.widget?{width:t,useDefaultWidthProvider:!1,rowHeight:r-50,breakpoints:{xxs:0},cols:{xxs:1}}:{};return Se({className:"on-map",breakpoints:{md:o,xxs:0},cols:i||{md:6,xxs:1},style:Se({position:"absolute",zIndex:50},a)},l)}),(0,c.withStateHandlers)(function(e){return function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),{viewConfigurationActive:!1}},{setViewConfigurationActive:function(){return function(e){return{viewConfigurationActive:e}}}}),(0,b.A)(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).layouts,t=void 0===e?[]:e;return!t||0===t.length},function(e){var t=e.loading,r=e.layouts,n=void 0===r?[]:r,o=e.onLayoutViewReplace,i=[{id:L()(),name:"Main view",color:null}];return n&&0!==n.length||o(i),{glyph:"dashboard",title:t?a().createElement(p.A,{msgId:"loading"}):a().createElement(p.A,{msgId:"dashboard.emptyTitle"})}}),(0,c.defaultProps)({isWidgetSelectable:function(){return!0}}),(0,c.withHandlers)({onLayoutChange:function(e){return function(t,r){var n=(Array.isArray(e.layouts)?e.layouts:[e.layouts]).map(function(t){return null!=t&&t.id&&(null==t?void 0:t.id)===e.selectedLayoutId?Se(Se(Se({},t),r),{},{id:t.id,name:t.name,color:t.color}):t});return e.onLayoutChange&&e.onLayoutChange(t,n),{layout:t,allLayouts:n}}}}),v)(function(e){var t=e.layouts,r=void 0===t?[]:t,n=e.onLayoutViewReplace,o=e.selectedLayoutId,i=e.onLayoutViewSelected,l=e.widgets,u=void 0===l?[]:l,c=e.onWidgetsReplace,s=e.user,f=e.viewConfigurationActive,d=e.setViewConfigurationActive,y=e.canEdit,p=e.configureViewOptions,m=Array.isArray(r)?r.find(function(e){return(null==e?void 0:e.id)===o})||{}:r,b=m.id,v=m.name,g=m.color,h=m.linkExistingDashboard,O=m.dashboard,j=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(m,pe),S=Array.isArray(r)?r:[r];return a().createElement(w.A,{column:!0,classNames:["_relative","_fill"]},a().createElement(de,me({selectedLayout:m,layoutsData:j},e)),(y||S.length>1)&&a().createElement(k,{layouts:Array.isArray(r)?r:[r],selectedLayoutId:o,onSelect:function(e){i(e)},onAdd:function(){var e={id:L()(),name:(0,_.iB)(r),color:null,md:[],xxs:[]},t=[].concat(he(r),[e]);null==n||n(t),i(e.id),d(!0)},onRemove:function(e){var t,o=r.filter(function(t){return t.id!==e});n(o),i(null==o||null===(t=o[o.length-1])||void 0===t?void 0:t.id);var a=u.filter(function(t){return t.layoutId!==e});c(a)},onMove:function(e,t){var o=r.findIndex(function(t){return t.id===e});if(-1!==o){var i=he(r);if("left"===t&&o>0){var a=[i[o],i[o-1]];i[o-1]=a[0],i[o]=a[1]}else if("right"===t&&o<i.length-1){var l=[i[o+1],i[o]];i[o]=l[0],i[o+1]=l[1]}n(i)}},onConfigure:function(){return d(!0)},canEdit:y}),f&&a().createElement(X,{active:f,onToggle:function(){return d(!1)},onSave:function(e){var t=r.map(function(t){return t.id===b?ve(ve({},t),{},{name:e.name,color:e.color,linkExistingDashboard:e.linkExistingDashboard,dashboard:e.dashboard}):t});n(t),d(!1)},data:{name:v,color:g,linkExistingDashboard:h,dashboard:O,layoutsData:j},user:s,configureViewOptions:p}))});var Ae=r(795153),De=r(589769),xe=r(508828),Ie=r(344297),Ce=r(737704),ke=r(102780),Te=r(635666),Le=r(779956),_e=r(699518),We=r(447430),Ne=r(393149),Me=r(891543),Re=r(501719);function Ve(e){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ve(e)}function He(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ze(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?He(Object(r),!0).forEach(function(t){Je(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):He(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function $e(){return $e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$e.apply(null,arguments)}function Be(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xe(n.key),n)}}function qe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(qe=function(){return!!e})()}function Ue(e){return Ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ue(e)}function Ze(e,t){return Ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ze(e,t)}function Je(e,t,r){return(t=Xe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xe(e){var t=function(e){if("object"!=Ve(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ve(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ve(t)?t:t+""}var Fe=(0,c.compose)((0,u.connect)((0,s.Mz)(De.N9,Ce.mT,Ce.Cs,Ce.lo,Ce.Zh,function(e){return(0,Ce.bz)(e)},Ce.Re,De.m4,De.Nq,De.Xt,xe.Bv,Ie.f8,Ie.RU,Ce.Og,xe.Pd,De.aH,Ce.jT,De.DJ,Re.dt,function(e,t,r,n,o,i,a,l,u,c,s,f,y,p,m,b,v,g,h){return{resource:e,loading:u,canEdit:g,layouts:r,dependencies:n,selectionActive:o,editingWidget:i,widgets:!d()(p)&&Array.isArray(p.widget)&&p.widget.some(function(e){return e.layoutId===v})?t.filter(function(e){return p.widget.some(function(t){return t.id===e.id})}):t,groups:a,showGroupColor:l,language:f?s:null,env:y,maximized:!d()(p)&&(Array.isArray(p.widget)?p.widget.every(function(e){return e.layoutId!==v}):p.widget.layoutId!==v)?{}:p,currentLocale:m,isDashboardOpened:b,selectedLayoutId:v,user:h}}),{editWidget:y.Pd,updateWidgetProperty:y.Dr,exportCSV:y.HX,deleteWidget:y.uv,onWidgetSelected:y.Xj,onLayoutChange:y.ZJ,toggleMaximize:y.th,onLayoutViewReplace:y.WA,onWidgetsReplace:y.ID,onLayoutViewSelected:y.q4,onLinkedDashboardDataLoad:y.mz}),(0,c.withProps)(function(){return{style:{height:"100%",overflow:"auto"}}}),(0,c.withHandlers)({isWidgetSelectable:function(e){var t=e.editingWidget;return function(e){return("map"===e.widgetType||"table"===e.widgetType&&(0,_.Ls)(t,e)&&!e.mapSync)&&e.id!==t.id}}}))(Pe),Ge=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,r){return t=Ue(t),function(e,t){if(t&&("object"==Ve(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,qe()?Reflect.construct(t,r||[],Ue(e).constructor):t.apply(e,r))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ze(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){var e;(null===(e=this.props)||void 0===e?void 0:e.did)&&(this.oldDocumentTitle=document.title)}},{key:"componentDidUpdate",value:function(){var e,t=null===(e=this.props)||void 0===e?void 0:e.did;this.props.dashboardTitle&&t&&(document.title=this.props.dashboardTitle)}},{key:"componentWillUnmount",value:function(){var e;(null===(e=this.props)||void 0===e?void 0:e.did)&&(document.title=this.oldDocumentTitle)}},{key:"render",value:function(){return this.props.enabled?a().createElement(Fe,{items:this.props.items,width:this.props.width,height:this.props.height,rowHeight:this.props.rowHeight,cols:this.props.cols,minLayoutWidth:this.props.minLayoutWidth,enableZoomInTblWidget:this.props.enableZoomInTblWidget,widgetOpts:this.props.widgetOpts,isDashboardWidget:!0,configureViewOptions:this.props.configureViewOptions}):null}}])&&Be(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a().Component);Je(Ge,"propTypes",{items:o().array,enabled:o().bool,rowHeight:o().number,cols:o().object,minLayoutWidth:o().number,widgetOpts:o().object,enableZoomInTblWidget:o().bool,dashboardTitle:o().string,configureViewOptions:o().object}),Je(Ge,"defaultProps",{enabled:!0,minLayoutWidth:480,enableZoomInTblWidget:!0,configureViewOptions:{resourcesType:["DASHBOARD"]}});var Qe=function(e,t){var r=t.loadedPlugins,n=(0,Me.A)({items:e.items,loadedPlugins:r}).filter(function(e){return"menu"===e.target});return a().createElement(Ge,$e({},e,{items:n}))};Qe.contextTypes={loadedPlugins:o().object};const Ke=(0,Ne.i1)("Dashboard",{component:(0,u.connect)(function(e){return{dashboardTitle:(0,De.gm)(e)}})((0,l.A)(Qe)),reducers:{dashboard:ke.A,widgets:Ae.A},containers:{SidebarMenu:{name:"Dashboard-spinner",alwaysVisible:!0,position:2e3,tool:(0,u.connect)(function(e){return{loading:(0,De.Nq)(e)}})(We.A)}},epics:ze(ze(ze({},Te.Ay),Le.Ay),_e.Ay)})}}]);