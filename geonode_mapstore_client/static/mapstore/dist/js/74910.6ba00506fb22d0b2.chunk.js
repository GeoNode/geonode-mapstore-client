"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[74910],{174910:(e,t,i)=>{i.d(t,{A:()=>R});var r=i(273517),n=i.n(r),o=i(605556),l=i.n(o),a=i(8117),s=i(611741),u=i.n(s),c=i(269843),m=i.n(c),p=i(192016),y=i(551783),d=i(256951),f=i(348317),v=i(434164),b=i(8571),h=i(6683),g=["labelId"];function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,l,a=[],s=!0,u=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;s=!1}else for(;!(s=(r=o.call(i)).done)&&(a.push(r.value),a.length!==t);s=!0);}catch(e){u=!0,n=e}finally{try{if(!s&&null!=i.return&&(l=i.return(),Object(l)!==l))return}finally{if(u)throw n}}return a}}(e,t)||E(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){if(e){if("string"==typeof e)return S(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function w(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function I(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?w(Object(i),!0).forEach(function(t){x(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):w(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function x(e,t,i){return(t=function(e){var t=function(e){if("object"!=P(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=P(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==P(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var T=(0,y.A)(["placeholder","noResultsText"])(p.Ay.Creatable),j=(0,y.A)(["placeholder","noResultsText"])(p.Ay);function A(e){var t,i=e.label,r=e.showArrow,o=e.limitsType;return n().createElement("span",null,(t=i,"scale"===o?"1 : "+Math.round(t):t),r&&n().createElement(n().Fragment,null,"Â ",n().createElement(a.e6,{glyph:"arrow-left"})))}function L(e){var t=e.id,i=e.value,r=e.placeholderId,o=e.noResultsTextId,l=e.createTextId,a=e.options,s=e.isValidNewOption,c=void 0===s?function(){return!0}:s,m=e.onChange,p=void 0===m?function(){}:m,y=e.disabled,d=e.loading;return n().createElement(T,{inputProps:{id:t},placeholder:r,noResultsText:o,value:i,isLoading:d,options:a,disabled:y,optionRenderer:A,valueRenderer:A,promptTextCreator:function(e){return n().createElement(b.A,{msgId:l,msgParams:{label:e}})},isValidNewOption:function(e){if(e.label){var t=parseFloat(e.label);return!u()(t)&&c(t)}return!1},onChange:function(e){var t=(null==e?void 0:e.value)&&parseFloat(e.value);p(u()(t)?void 0:I(I({},e),{},{value:t}))}})}function z(e){var t=e.title,i=e.layer,o=e.zoom,l=e.projection,s=e.resolutions,u=void 0===s?(0,h._7)():s,c=e.defaultLimitsType,p=e.limitsTypesOptions,y=e.dpi,P=e.onChange,w=Math.round(o||0),x=O((0,r.useState)(c||p[0].value),2),T=x[0],A=x[1],z=i.maxResolution,R=i.minResolution,C=i.disableResolutionLimits,V=(0,h.dQ)(y,l);function F(e,t){var i,r=e.map(function(e){return e[T]});return m()(t[T])||-1!==r.indexOf(t[T])?e:[t].concat((i=e,function(e){if(Array.isArray(e))return S(e)}(i)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||E(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).sort(function(e,t){return e[T]>t[T]?-1:1})}function N(e,t){return(0,h.oq)(e,t,{projection:l,resolutions:u})}var k=O((0,r.useState)([]),2),M=k[0],D=k[1],U=O((0,r.useState)(z&&{resolution:z,scale:z*V,zoom:(0,h.Yc)(z,u)}),2),_=U[0],Y=U[1],q=O((0,r.useState)(R&&{resolution:R,scale:R*V,zoom:(0,h.Yc)(R,u)}),2),Q=q[0],W=q[1],Z=O((0,r.useState)(!1),2),$=Z[0],B=Z[1],G=O((0,r.useState)(),2),H=G[0],J=G[1],K=O((0,r.useState)(),2),X=K[0],ee=K[1],te=(0,r.useRef)();function ie(){ee(void 0),J(void 0)}(0,r.useEffect)(function(){return te.current=!0,function(){te.current=!1}},[]);var re=u.join(",");return(0,r.useEffect)(function(){var e=R&&{resolution:R,scale:R*V,zoom:(0,h.Yc)(R,u)},t=z&&{resolution:z,scale:z*V,zoom:(0,h.Yc)(z,u)},i=[e,t].filter(function(e){return e}).reduce(F,u.map(function(e,t){return{resolution:e,scale:e*V,zoom:t}}));Y(t),W(e),D(i),ie()},[V,re]),n().createElement("div",{className:"ms-visibility-limits-form"},n().createElement("div",{className:"ms-visibility-limits-form-title",style:{display:"flex",alignItems:"center"}},n().createElement("div",{style:{flex:1}},t),n().createElement(d.A,{btnDefaultProps:{className:"square-button-md no-border"},buttons:[{glyph:"refresh",disabled:!(!C&&!$),visible:"wms"===i.type,onClick:function(){"wms"!==i.type||$||(B(!0),ie(),(0,v.aF)(i).toPromise().then(function(e){if(te.current){var t,i,r=e.MaxScaleDenominator,n=e.MinScaleDenominator,o=!m()(r)&&N(r,"scale"),l=!m()(n)&&N(n,"scale");(function(e,t){var i,r,n=(i=e,r=t,m()(i)&&m()(r)?"layerProperties.visibilityLimits.serverValuesUpdateUndefined":m()(i)&&!m()(r)?"layerProperties.visibilityLimits.serverValuesUpdateMinScale":!m()(i)&&m()(r)?"layerProperties.visibilityLimits.serverValuesUpdateMaxScale":"layerProperties.visibilityLimits.serverValuesUpdate");J(n)})(r,n),l&&W(l),o&&Y(o),P(I(I({},o&&{maxResolution:o.resolution}),l&&{minResolution:l.resolution}));var a=(null===(t=l||Q)||void 0===t?void 0:t.resolution)||-1/0;((null===(i=o||_)||void 0===i?void 0:i.resolution)||1/0)<a&&ee("layerProperties.visibilityLimits.rangeError"),B(!1)}}).catch(function(){te.current&&(B(!1),ee("layerProperties.visibilityLimits.serverValuesError"))}))},tooltipId:"layerProperties.visibilityLimits.updateWMSCapabilities"},{Element:function(){return n().createElement(f.A,{checked:!C,onClick:function(){P({disableResolutionLimits:!C}),ie()}})}}]})),n().createElement("label",{htmlFor:"ms-visibility-limits-max"},n().createElement(b.A,{msgId:"layerProperties.visibilityLimits.maxValue"})),n().createElement(L,{id:"ms-visibility-limits-max",value:(null==_?void 0:_[T])&&{value:_[T],label:_[T],zoom:_.zoom,limitsType:T},placeholderId:"layerProperties.visibilityLimits.maxValuePlaceholder",noResultsTextId:"layerProperties.visibilityLimits.valueNoResultsText",createTextId:"layerProperties.visibilityLimits.createOption",loading:$,isValidNewOption:function(e){return e>=((null==Q?void 0:Q[T])||0)},options:M.map(function(e){return I(I({},e),{},{value:e[T]+(e.delta||0),label:e[T],showArrow:e.zoom===w,disabled:!m()(null==Q?void 0:Q[T])&&e[T]<=Q[T],limitsType:T})}),disabled:C||$,onChange:function(e){var t=void 0===e.value?{}:m()(e.zoom)?N(e.value,T):{resolution:e.resolution,scale:e.scale,zoom:e.zoom};if(P({maxResolution:t.resolution}),Y(t),void 0!==e.value&&m()(e.zoom)){var i=F(M,t);D(i)}ie()}}),n().createElement("label",{htmlFor:"ms-visibility-limits-min"},n().createElement(b.A,{msgId:"layerProperties.visibilityLimits.minValue"})),n().createElement(L,{id:"ms-visibility-limits-min",value:(null==Q?void 0:Q[T])&&{value:Q[T],label:Q[T],zoom:Q.zoom,limitsType:T},placeholderId:"layerProperties.visibilityLimits.minValuePlaceholder",noResultsTextId:"layerProperties.visibilityLimits.valueNoResultsText",createTextId:"layerProperties.visibilityLimits.createOption",loading:$,isValidNewOption:function(e){return e<=((null==_?void 0:_[T])||1/0)},options:M.map(function(e){return I(I({},e),{},{value:e[T],label:e[T],showArrow:e.zoom===w,disabled:!m()(null==_?void 0:_[T])&&e[T]>=_[T],limitsType:T})}),disabled:C||$,onChange:function(e){var t=void 0===e.value?{}:m()(e.zoom)?N(e.value,T):{resolution:e.resolution,scale:e.scale,zoom:e.zoom};if(P({minResolution:t.resolution}),W(t),void 0!==e.value&&m()(e.zoom)){var i=F(M,t);D(i)}ie()}}),n().createElement("label",{htmlFor:"ms-visibility-limits-type"},n().createElement(b.A,{msgId:"layerProperties.visibilityLimits.type"})),n().createElement(j,{inputProps:{id:"ms-visibility-limits-type"},value:T,clearable:!1,options:p.map(function(e){var t=e.labelId;return I(I({},function(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;i[r]=e[r]}return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)i=o[r],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(e,g)),t&&{label:n().createElement(b.A,{msgId:t})})}),disabled:C||$,onChange:function(e){var t=e.value;A(t),P({visibilityLimitType:t}),ie()}}),H&&n().createElement(a.Fc,{bsStyle:"success"},n().createElement(b.A,{msgId:H})),X&&n().createElement(a.Fc,{bsStyle:"danger"},n().createElement(b.A,{msgId:X})))}z.propTypes={layer:l().object,zoom:l().number,onChange:l().func,resolutions:l().array,limitsTypesOptions:l().array,projection:l().string,dpi:l().number,defaultLimitsType:l().string},z.defaultProps={layer:{},onChange:function(){},limitsTypesOptions:[{value:"scale",labelId:"layerProperties.visibilityLimits.scale"},{value:"resolution",labelId:"layerProperties.visibilityLimits.resolution"}],dpi:h.Zl};const R=z}}]);