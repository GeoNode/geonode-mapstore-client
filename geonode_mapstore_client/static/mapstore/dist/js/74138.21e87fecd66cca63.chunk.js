"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[74138],{940190:(t,e,i)=>{i.d(e,{A:()=>h});var s=i(108143),n=i(511078),r=i(568711),o=i(643938);class a extends s.A{constructor(t,e,i,s,n,r){super(t,e,r),this.crossOrigin_=s,this.src_=i,this.key=i,this.image_=new Image,null!==s&&(this.image_.crossOrigin=s),this.unlisten_=null,this.tileLoadFunction_=n}getImage(){return this.image_}setImage(t){this.image_=t,this.state=n.A.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=n.A.ERROR,this.unlistenImage_(),this.image_=function(){const t=(0,r.Y)(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=n.A.LOADED:this.state=n.A.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==n.A.ERROR&&(this.state=n.A.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==n.A.IDLE&&(this.state=n.A.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(0,o.f)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}const h=a},108143:(t,e,i)=>{i.d(e,{A:()=>l});var s=i(79332),n=i(506837),r=i(511078),o=i(104087),a=i(293474);class h extends s.A{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(n.A.CHANGE)}release(){this.state===r.A.ERROR&&this.setState(r.A.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){if(!this.interimTile)return this;let t=this.interimTile;do{if(t.getState()==r.A.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){if(!this.interimTile)return;let t=this.interimTile,e=this;do{if(t.getState()==r.A.LOADED){t.interimTile=null;break}t.getState()==r.A.LOADING?e=t:t.getState()==r.A.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==r.A.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){(0,o.b0)()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;const s=e-i+1e3/60;return s>=this.transition_?1:(0,a.a6)(s/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}}const l=h},291110:(t,e,i)=>{i.d(e,{A:()=>r,N:()=>n});class s{constructor(t,e,i,s){this.minX=t,this.maxX=e,this.minY=i,this.maxY=s}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function n(t,e,i,n,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=i,r.maxY=n,r):new s(t,e,i,n)}const r=s},511078:(t,e,i)=>{i.d(e,{A:()=>s});const s={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}},622808:(t,e,i)=>{i.d(e,{A:()=>o});var s=i(160764),n=i(445360);class r extends s.A{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getPreload(){return this.get(n.A.PRELOAD)}setPreload(t){this.set(n.A.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(n.A.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(n.A.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}const o=r},925388:(t,e,i)=>{i.d(e,{A:()=>m});var s=i(160764);class n extends s.A{constructor(t){super(t=t||{})}}const r=n;var o=i(996769),a=i(706141),h=i(162703),l=i(609703),c=i(570915),u=i(207434);class d extends o.A{constructor(t){super(t),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(t){const e=t.layerStatesArray[t.layerIndex],i=t.pixelRatio,s=t.viewState,n=s.resolution,r=this.getLayer().getSource(),o=t.viewHints;let l=t.extent;if(void 0!==e.extent&&(l=(0,c._N)(l,(0,u.SD)(e.extent,s.projection))),!o[h.A.ANIMATING]&&!o[h.A.INTERACTING]&&!(0,c.Im)(l))if(r){const t=s.projection,e=r.getImage(l,n,i,t);e&&(this.loadImage(e)?this.image_=e:e.getState()===a.A.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),s=(0,l.Bb)(e.pixelToCoordinateTransform,t.slice()),n=i.getExtent();if(n&&!(0,c.Ym)(n,s))return null;const r=this.image_.getExtent(),o=this.getImage(),a=(0,c.RG)(r),h=Math.floor(o.width*((s[0]-r[0])/a));if(h<0||h>=o.width)return null;const u=(0,c.Oq)(r),d=Math.floor(o.height*((r[3]-s[1])/u));return d<0||d>=o.height?null:this.getImageData(o,h,d)}renderFrame(t,e){const i=this.image_,s=i.getExtent(),n=i.getResolution(),r=i.getPixelRatio(),o=t.layerStatesArray[t.layerIndex],a=t.pixelRatio,h=t.viewState,d=h.center,g=a*n/(h.resolution*r),m=t.extent,_=h.resolution,T=h.rotation,x=Math.round((0,c.RG)(m)/_*a),f=Math.round((0,c.Oq)(m)/_*a);(0,l.Zz)(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/a,1/a,T,-x/2,-f/2),(0,l.T9)(this.inversePixelTransform,this.pixelTransform);const p=(0,l.dI)(this.pixelTransform);this.useContainer(e,p,this.getBackground(t));const E=this.context,A=E.canvas;A.width!=x||A.height!=f?(A.width=x,A.height=f):this.containerReused||E.clearRect(0,0,x,f);let R=!1,I=!0;if(o.extent){const e=(0,u.SD)(o.extent,h.projection);I=(0,c.HY)(e,t.extent),R=I&&!(0,c.ms)(e,t.extent),R&&this.clipUnrotated(E,t,e)}const v=this.getImage(),S=(0,l.Zz)(this.tempTransform,x/2,f/2,g,g,0,r*(s[0]-d[0])/n,r*(d[1]-s[3])/n);this.renderedResolution=n*a/r;const w=v.width*S[0],P=v.height*S[3];if(this.getLayer().getSource().getInterpolate()||(E.imageSmoothingEnabled=!1),this.preRender(E,t),I&&w>=.5&&P>=.5){const t=S[4],e=S[5],i=o.opacity;let s;1!==i&&(s=E.globalAlpha,E.globalAlpha=i),E.drawImage(v,0,0,+v.width,+v.height,t,e,w,P),1!==i&&(E.globalAlpha=s)}return this.postRender(E,t),R&&E.restore(),E.imageSmoothingEnabled=!0,p!==A.style.transform&&(A.style.transform=p),this.container}}const g=d,m=class extends r{constructor(t){super(t)}createRenderer(){return new g(this)}getData(t){return super.getData(t)}}},130945:(t,e,i)=>{i.d(e,{A:()=>o});var s=i(622808),n=i(424029);class r extends s.A{constructor(t){super(t)}createRenderer(){return new n.A(this)}}const o=r},445360:(t,e,i)=>{i.d(e,{A:()=>s});const s={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"}},424029:(t,e,i)=>{i.d(e,{A:()=>_});var s=i(996769),n=i(940190),r=i(897404),o=i(291110),a=i(511078),h=i(609703),l=i(166514),c=i(570915),u=i(207434),d=i(104087),g=i(6782);class m extends s.A{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=(0,c.S5)(),this.tmpTileRange_=new o.A(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),i=t.getState(),s=e.getUseInterimTilesOnError();return i==a.A.LOADED||i==a.A.EMPTY||i==a.A.ERROR&&!s}getTile(t,e,i,s){const n=s.pixelRatio,r=s.viewState.projection,o=this.getLayer();let h=o.getSource().getTile(t,e,i,n,r);return h.getState()==a.A.ERROR&&o.getUseInterimTilesOnError()&&o.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(h)||(h=h.getInterimTile()),h}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),s=(0,h.Bb)(e.pixelToCoordinateTransform,t.slice()),o=i.getExtent();if(o&&!(0,c.Ym)(o,s))return null;const l=e.pixelRatio,u=e.viewState.projection,d=e.viewState,m=i.getRenderSource(),_=m.getTileGridForProjection(d.projection),T=m.getTilePixelRatio(e.pixelRatio);for(let t=_.getZForResolution(d.resolution);t>=_.getMinZoom();--t){const e=_.getTileCoordForCoordAndZ(s,t),i=m.getTile(t,e[1],e[2],l,u);if(!(i instanceof n.A||i instanceof r.A)||i instanceof r.A&&i.getState()===a.A.EMPTY)return null;if(i.getState()!==a.A.LOADED)continue;const o=_.getOrigin(t),h=(0,g.xq)(_.getTileSize(t)),c=_.getResolution(t),x=Math.floor(T*((s[0]-o[0])/c-e[1]*h[0])),f=Math.floor(T*((o[1]-s[1])/c-e[2]*h[1])),p=Math.round(T*m.getGutterForProjection(d.projection));return this.getImageData(i.getImage(),x+p,f+p)}return null}loadedTileCallback(t,e,i){return!!this.isDrawableTile(i)&&super.loadedTileCallback(t,e,i)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex],s=t.viewState,n=s.projection,r=s.resolution,o=s.center,g=s.rotation,m=t.pixelRatio,_=this.getLayer(),T=_.getSource(),x=T.getRevision(),f=T.getTileGridForProjection(n),p=f.getZForResolution(r,T.zDirection),E=f.getResolution(p);let A=t.extent;const R=t.viewState.resolution,I=T.getTilePixelRatio(m),v=Math.round((0,c.RG)(A)/R*m),S=Math.round((0,c.Oq)(A)/R*m),w=i.extent&&(0,u.SD)(i.extent,n);w&&(A=(0,c._N)(A,(0,u.SD)(i.extent,n)));const P=E*v/2/I,Y=E*S/2/I,O=[o[0]-P,o[1]-Y,o[0]+P,o[1]+Y],D=f.getTileRangeForExtentAndZ(A,p),C={};C[p]={};const y=this.createLoadedTileFinder(T,n,C),M=this.tmpExtent,b=this.tmpTileRange_;this.newTiles_=!1;const L=g?(0,c.Yw)(s.center,R,g,t.size):void 0;for(let e=D.minX;e<=D.maxX;++e)for(let s=D.minY;s<=D.maxY;++s){if(g&&!f.tileCoordIntersectsViewport([p,e,s],L))continue;const n=this.getTile(p,e,s,t);if(this.isDrawableTile(n)){const e=(0,d.v6)(this);if(n.getState()==a.A.LOADED){C[p][n.tileCoord.toString()]=n;let t=n.inTransition(e);t&&1!==i.opacity&&(n.endTransition(e),t=!1),this.newTiles_||!t&&this.renderedTiles.includes(n)||(this.newTiles_=!0)}if(1===n.getAlpha(e,t.time))continue}const r=f.getTileCoordChildTileRange(n.tileCoord,b,M);let o=!1;r&&(o=y(p+1,r)),o||f.forEachTileCoordParentTileRange(n.tileCoord,y,b,M)}const X=E/r*m/I;(0,h.Zz)(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/m,1/m,g,-v/2,-S/2);const F=(0,h.dI)(this.pixelTransform);this.useContainer(e,F,this.getBackground(t));const G=this.context,W=G.canvas;(0,h.T9)(this.inversePixelTransform,this.pixelTransform),(0,h.Zz)(this.tempTransform,v/2,S/2,X,X,0,-v/2,-S/2),W.width!=v||W.height!=S?(W.width=v,W.height=S):this.containerReused||G.clearRect(0,0,v,S),w&&this.clipUnrotated(G,t,w),T.getInterpolate()||(G.imageSmoothingEnabled=!1),this.preRender(G,t),this.renderedTiles.length=0;let j,N,U,Z=Object.keys(C).map(Number);Z.sort(l.V_),1!==i.opacity||this.containerReused&&!T.getOpaque(t.viewState.projection)?(j=[],N=[]):Z=Z.reverse();for(let e=Z.length-1;e>=0;--e){const i=Z[e],s=T.getTilePixelSize(i,m,n),r=f.getResolution(i)/E,o=s[0]*r*X,a=s[1]*r*X,l=f.getTileCoordForCoordAndZ((0,c.Py)(O),i),u=f.getTileCoordExtent(l),g=(0,h.Bb)(this.tempTransform,[I*(u[0]-O[0])/E,I*(O[3]-u[3])/E]),_=I*T.getGutterForProjection(n),x=C[i];for(const e in x){const s=x[e],n=s.tileCoord,r=l[1]-n[1],h=Math.round(g[0]-(r-1)*o),u=l[2]-n[2],m=Math.round(g[1]-(u-1)*a),f=Math.round(g[0]-r*o),E=Math.round(g[1]-u*a),A=h-f,R=m-E,I=p===i,v=I&&1!==s.getAlpha((0,d.v6)(this),t.time);let S=!1;if(!v)if(j){U=[f,E,f+A,E,f+A,E+R,f,E+R];for(let t=0,e=j.length;t<e;++t)if(p!==i&&i<N[t]){const e=j[t];(0,c.HY)([f,E,f+A,E+R],[e[0],e[3],e[4],e[7]])&&(S||(G.save(),S=!0),G.beginPath(),G.moveTo(U[0],U[1]),G.lineTo(U[2],U[3]),G.lineTo(U[4],U[5]),G.lineTo(U[6],U[7]),G.moveTo(e[6],e[7]),G.lineTo(e[4],e[5]),G.lineTo(e[2],e[3]),G.lineTo(e[0],e[1]),G.clip())}j.push(U),N.push(i)}else G.clearRect(f,E,A,R);this.drawTileImage(s,t,f,E,A,R,_,I),j&&!v?(S&&G.restore(),this.renderedTiles.unshift(s)):this.renderedTiles.push(s),this.updateUsedTiles(t.usedTiles,T,s)}}return this.renderedRevision=x,this.renderedResolution=E,this.extentChanged=!this.renderedExtent_||!(0,c.aI)(this.renderedExtent_,O),this.renderedExtent_=O,this.renderedPixelRatio=m,this.renderedProjection=n,this.manageTilePyramid(t,T,f,m,n,A,p,_.getPreload()),this.scheduleExpireCache(t,T),this.postRender(G,t),i.extent&&G.restore(),G.imageSmoothingEnabled=!0,F!==W.style.transform&&(W.style.transform=F),this.container}drawTileImage(t,e,i,s,n,r,o,a){const h=this.getTileImage(t);if(!h)return;const l=(0,d.v6)(this),c=e.layerStatesArray[e.layerIndex],u=c.opacity*(a?t.getAlpha(l,e.time):1),g=u!==this.context.globalAlpha;g&&(this.context.save(),this.context.globalAlpha=u),this.context.drawImage(h,o,o,h.width-2*o,h.height-2*o,i,s,n,r),g&&this.context.restore(),u!==c.opacity?e.animate=!0:a&&t.endTransition(l)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const i=function(t,e,i){const s=(0,d.v6)(t);s in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[s])}.bind(null,e);t.postRenderFunctions.push(i)}}updateUsedTiles(t,e,i){const s=(0,d.v6)(e);s in t||(t[s]={}),t[s][i.getKey()]=!0}manageTilePyramid(t,e,i,s,n,r,o,h,l){const u=(0,d.v6)(e);u in t.wantedTiles||(t.wantedTiles[u]={});const g=t.wantedTiles[u],m=t.tileQueue,_=i.getMinZoom(),T=t.viewState.rotation,x=T?(0,c.Yw)(t.viewState.center,t.viewState.resolution,T,t.size):void 0;let f,p,E,A,R,I,v=0;for(I=_;I<=o;++I)for(p=i.getTileRangeForExtentAndZ(r,I,p),E=i.getResolution(I),A=p.minX;A<=p.maxX;++A)for(R=p.minY;R<=p.maxY;++R)T&&!i.tileCoordIntersectsViewport([I,A,R],x)||(o-I<=h?(++v,f=e.getTile(I,A,R,s,n),f.getState()==a.A.IDLE&&(g[f.getKey()]=!0,m.isKeyQueued(f.getKey())||m.enqueue([f,u,i.getTileCoordCenter(f.tileCoord),E])),void 0!==l&&l(f)):e.useTile(I,A,R,n));e.updateCacheSize(v,n)}}const _=m},633513:(t,e,i)=>{i.d(e,{BV:()=>h,KQ:()=>u,XX:()=>g,aY:()=>d});var s=i(570915),n=i(568711),r=i(207434),o=i(61597);let a;const h=[];function l(t,e,i,s,n){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(s,n),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,s)+1,Math.max(i,n)),t.restore()}function c(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function u(t,e,i,n){const o=(0,r.pd)(i,e,t);let a=(0,r.hO)(e,n,i);const h=e.getMetersPerUnit();void 0!==h&&(a*=h);const l=t.getMetersPerUnit();void 0!==l&&(a/=l);const c=t.getExtent();if(!c||(0,s.Ym)(c,o)){const e=(0,r.hO)(t,a,o)/a;isFinite(e)&&e>0&&(a/=e)}return a}function d(t,e,i,n){const r=(0,s.q1)(i);let o=u(t,e,r,n);return(!isFinite(o)||o<=0)&&(0,s.sB)(i,(function(i){return o=u(t,e,i,n),isFinite(o)&&o>0})),o}function g(t,e,i,r,u,d,g,m,_,T,x,f){const p=(0,n.Y)(Math.round(i*t),Math.round(i*e),h);if(f||(p.imageSmoothingEnabled=!1),0===_.length)return p.canvas;function E(t){return Math.round(t*i)/i}p.scale(i,i),p.globalCompositeOperation="lighter";const A=(0,s.S5)();_.forEach((function(t,e,i){(0,s.X$)(A,t.extent)}));const R=(0,s.RG)(A),I=(0,s.Oq)(A),v=(0,n.Y)(Math.round(i*R/r),Math.round(i*I/r),h);f||(v.imageSmoothingEnabled=!1);const S=i/r;_.forEach((function(t,e,i){const n=t.extent[0]-A[0],r=-(t.extent[3]-A[3]),o=(0,s.RG)(t.extent),a=(0,s.Oq)(t.extent);t.image.width>0&&t.image.height>0&&v.drawImage(t.image,T,T,t.image.width-2*T,t.image.height-2*T,n*S,r*S,o*S,a*S)}));const w=(0,s.Py)(g);return m.getTriangles().forEach((function(t,e,s){const u=t.source,g=t.target;let m=u[0][0],_=u[0][1],T=u[1][0],x=u[1][1],R=u[2][0],I=u[2][1];const S=E((g[0][0]-w[0])/d),P=E(-(g[0][1]-w[1])/d),Y=E((g[1][0]-w[0])/d),O=E(-(g[1][1]-w[1])/d),D=E((g[2][0]-w[0])/d),C=E(-(g[2][1]-w[1])/d),y=m,M=_;m=0,_=0,T-=y,x-=M,R-=y,I-=M;const b=[[T,x,0,0,Y-S],[R,I,0,0,D-S],[0,0,T,x,O-P],[0,0,R,I,C-P]],L=(0,o.KU)(b);if(L){if(p.save(),p.beginPath(),function(){if(void 0===a){const t=(0,n.Y)(6,6,h);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",l(t,4,5,4,0),l(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;a=c(e,0)||c(e,4)||c(e,8),(0,n.Yg)(t),h.push(t.canvas)}return a}()||!f){p.moveTo(Y,O);const t=4,e=S-Y,i=P-O;for(let s=0;s<t;s++)p.lineTo(Y+E((s+1)*e/t),O+E(s*i/(t-1))),s!=t-1&&p.lineTo(Y+E((s+1)*e/t),O+E((s+1)*i/(t-1)));p.lineTo(D,C)}else p.moveTo(Y,O),p.lineTo(S,P),p.lineTo(D,C);p.clip(),p.transform(L[0],L[2],L[1],L[3],S,P),p.translate(A[0]-y,A[3]-M),p.scale(r/i,-r/i),p.drawImage(v.canvas,0,0),p.restore()}})),(0,n.Yg)(v),h.push(v.canvas),x&&(p.save(),p.globalCompositeOperation="source-over",p.strokeStyle="black",p.lineWidth=1,m.getTriangles().forEach((function(t,e,i){const s=t.target,n=(s[0][0]-w[0])/d,r=-(s[0][1]-w[1])/d,o=(s[1][0]-w[0])/d,a=-(s[1][1]-w[1])/d,h=(s[2][0]-w[0])/d,l=-(s[2][1]-w[1])/d;p.beginPath(),p.moveTo(o,a),p.lineTo(n,r),p.lineTo(h,l),p.closePath(),p.stroke()})),p.restore()),p.canvas}},897404:(t,e,i)=>{i.d(e,{A:()=>m});var s=i(793101),n=i(506837),r=i(108143),o=i(511078),a=i(452913),h=i(633513),l=i(61597),c=i(570915),u=i(209438),d=i(568711);class g extends r.A{constructor(t,e,i,n,r,u,d,g,m,_,T,x){super(r,o.A.IDLE,{interpolate:!!x}),this.renderEdges_=void 0!==T&&T,this.pixelRatio_=d,this.gutter_=g,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=u||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const f=n.getTileCoordExtent(this.wrappedTileCoord_),p=this.targetTileGrid_.getExtent();let E=this.sourceTileGrid_.getExtent();const A=p?(0,c._N)(f,p):f;if(0===(0,c.UG)(A))return void(this.state=o.A.EMPTY);const R=t.getExtent();R&&(E=E?(0,c._N)(E,R):R);const I=n.getResolution(this.wrappedTileCoord_[0]),v=(0,h.aY)(t,i,A,I);if(!isFinite(v)||v<=0)return void(this.state=o.A.EMPTY);const S=void 0!==_?_:s.l;if(this.triangulation_=new a.A(t,i,A,E,v*S,I),0===this.triangulation_.getTriangles().length)return void(this.state=o.A.EMPTY);this.sourceZ_=e.getZForResolution(v);let w=this.triangulation_.calculateSourceExtent();if(E&&(t.canWrapX()?(w[1]=(0,l.qE)(w[1],E[1],E[3]),w[3]=(0,l.qE)(w[3],E[1],E[3])):w=(0,c._N)(w,E)),(0,c.UG)(w)){const t=e.getTileRangeForExtentAndZ(w,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=m(this.sourceZ_,e,i,d);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=o.A.EMPTY)}else this.state=o.A.EMPTY}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{e&&e.getState()==o.A.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})})),this.sourceTiles_.length=0,0===t.length)this.state=o.A.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),s="number"==typeof i?i:i[0],n="number"==typeof i?i:i[1],r=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=(0,h.XX)(s,n,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),r,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=o.A.LOADED}this.changed()}load(){if(this.state==o.A.IDLE){this.state=o.A.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((e=>{const i=e.getState();if(i==o.A.IDLE||i==o.A.LOADING){t++;const i=(0,u.KT)(e,n.A.CHANGE,(function(s){const n=e.getState();n!=o.A.LOADED&&n!=o.A.ERROR&&n!=o.A.EMPTY||((0,u.JH)(i),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(i)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,i){t.getState()==o.A.IDLE&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(u.JH),this.sourcesListenerKeys_=null}release(){this.canvas_&&((0,d.Yg)(this.canvas_.getContext("2d")),h.BV.push(this.canvas_),this.canvas_=null),super.release()}}const m=g},452913:(t,e,i)=>{i.d(e,{A:()=>o});var s=i(570915),n=i(207434),r=i(61597);const o=class{constructor(t,e,i,r,o,a){this.sourceProj_=t,this.targetProj_=e;let h={};const l=(0,n.RG)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return h[e]||(h[e]=l(t)),h[e]},this.maxSourceExtent_=r,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&(0,s.RG)(r)>=(0,s.RG)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,s.RG)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,s.RG)(this.targetProj_.getExtent()):null;const c=(0,s.Py)(i),u=(0,s.WU)(i),d=(0,s.k_)(i),g=(0,s.R)(i),m=this.transformInv_(c),_=this.transformInv_(u),T=this.transformInv_(d),x=this.transformInv_(g),f=10+(a?Math.max(0,Math.ceil(Math.log2((0,s.UG)(i)/(a*a*256*256)))):0);if(this.addQuad_(c,u,d,g,m,_,T,x,f),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,i,s){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);const s=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-s<this.sourceWorldWidth_/2&&(e.source=i)}}))}h={}}addTriangle_(t,e,i,s,n,r){this.triangles_.push({source:[s,n,r],target:[t,e,i]})}addQuad_(t,e,i,n,o,a,h,l,c){const u=(0,s.Tr)([o,a,h,l]),d=this.sourceWorldWidth_?(0,s.RG)(u)/this.sourceWorldWidth_:null,g=this.sourceWorldWidth_,m=this.sourceProj_.canWrapX()&&d>.5&&d<1;let _=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const r=(0,s.Tr)([t,e,i,n]);_=(0,s.RG)(r)/this.targetWorldWidth_>.25||_}!m&&this.sourceProj_.isGlobal()&&d&&(_=d>.25||_)}if(!_&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!(0,s.HY)(u,this.maxSourceExtent_))return;let T=0;if(!(_||isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(h[0])&&isFinite(h[1])&&isFinite(l[0])&&isFinite(l[1])))if(c>0)_=!0;else if(T=(isFinite(o[0])&&isFinite(o[1])?0:8)+(isFinite(a[0])&&isFinite(a[1])?0:4)+(isFinite(h[0])&&isFinite(h[1])?0:2)+(isFinite(l[0])&&isFinite(l[1])?0:1),1!=T&&2!=T&&4!=T&&8!=T)return;if(c>0){if(!_){const e=[(t[0]+i[0])/2,(t[1]+i[1])/2],s=this.transformInv_(e);let n;n=m?((0,r.xP)(o[0],g)+(0,r.xP)(h[0],g))/2-(0,r.xP)(s[0],g):(o[0]+h[0])/2-s[0];const a=(o[1]+h[1])/2-s[1];_=n*n+a*a>this.errorThresholdSquared_}if(_){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const s=[(e[0]+i[0])/2,(e[1]+i[1])/2],r=this.transformInv_(s),u=[(n[0]+t[0])/2,(n[1]+t[1])/2],d=this.transformInv_(u);this.addQuad_(t,e,s,u,o,a,r,d,c-1),this.addQuad_(u,s,i,n,d,r,h,l,c-1)}else{const s=[(t[0]+e[0])/2,(t[1]+e[1])/2],r=this.transformInv_(s),u=[(i[0]+n[0])/2,(i[1]+n[1])/2],d=this.transformInv_(u);this.addQuad_(t,s,u,n,o,r,d,l,c-1),this.addQuad_(s,e,i,u,r,a,h,d,c-1)}return}}if(m){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}11&T||this.addTriangle_(t,i,n,o,h,l),14&T||this.addTriangle_(t,i,e,o,h,a),T&&(13&T||this.addTriangle_(e,n,t,a,l,o),7&T||this.addTriangle_(e,n,i,a,l,h))}calculateSourceExtent(){const t=(0,s.S5)();return this.triangles_.forEach((function(e,i,n){const r=e.source;(0,s.$C)(t,r[0]),(0,s.$C)(t,r[1]),(0,s.$C)(t,r[2])})),t}getTriangles(){return this.triangles_}}},793101:(t,e,i)=>{i.d(e,{l:()=>s});const s=.5}}]);