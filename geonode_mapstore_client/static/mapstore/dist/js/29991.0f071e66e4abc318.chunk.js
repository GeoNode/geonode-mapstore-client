"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[29991],{277327:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(273517),o=r.n(n),i=r(8571),a=r(904072);function l(e){var t=e.msgId,r=e.icon;return o().createElement("div",{className:"gn-main-event-container"},o().createElement("div",{className:"gn-main-event-content"},o().createElement("div",{className:"gn-main-event-text"},o().createElement("div",{className:"gn-main-icon"},o().createElement(a.A,{glyph:r})),t&&o().createElement(i.A,{msgId:t}))))}l.defaultProps={msgId:"",icon:"exclamation"};const u=l},29991:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Re});var n=r(273517),o=r.n(n),i=r(605556),a=r.n(i),l=r(548975),u=r(466732),c=r(8117),s=r(962193),m=r.n(s),f=r(192202),d=r(899703);var p=r(487581),y=(0,n.lazy)(function(){return Promise.all([r.e(50953),r.e(15096),r.e(53651)]).then(r.bind(r,653651))});const v={SelectWidget:function(e){return o().createElement(d.A,e)},TextareaWidget:function(e){var t=e.id,r=e.options,i=void 0===r?{}:r,a=e.value,l=e.onChange;return null!=i&&i["geonode-ui:richTextEditor"]?o().createElement(n.Suspense,{fallback:null},o().createElement(y,{id:t,value:a,onChange:l})):o().createElement(p.A,e)}};var b=r(836970);var g=r(770491),h=["key"];function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},O.apply(null,arguments)}var E=r(904072),S=r(8571),j=r(628017),w=r(221604);function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach(function(t){T(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function T(e,t,r){return(t=function(e){var t=function(e){if("object"!=P(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==P(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"==typeof e)return N(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?N(e,t):void 0}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var F=function(e){var t=document.querySelector("[for=".concat(e,"]"))||document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth",block:"start"})};function I(e){var t=e.idSchema,r=e.title,i=e.group,a=e.expanded,l=C((0,n.useState)(!1),2),u=l[0],s=l[1],m=i.some(function(e){return e.error}),f=void 0===a?u:a;return o().createElement("li",null,o().createElement(b.A,{className:m?"gn-metadata-error":"",size:"xs",onClick:function(){return s(function(e){return!e})}},o().createElement(c.e6,{glyph:f?"bottom":"next"})," ",r,m?o().createElement(o().Fragment,null," ",o().createElement(E.A,{glyph:"exclamation"})):null),f?o().createElement("ul",null,i.map(function(e){return o().createElement("li",{key:e.name},o().createElement(b.A,{size:"xs",className:e.error?"gn-metadata-error":"",onClick:function(){var r;return F(null===(r=t[e.name])||void 0===r?void 0:r.$id)}},e.title,e.error?o().createElement(o().Fragment,null," ",o().createElement(E.A,{glyph:"exclamation"})):null))})):null)}function q(e,t){var r=e.idSchema,i=e.schema,a=e.uiSchema,l=e.properties,u=e.errorSchema,c=e.formContext.title,s=C((0,n.useState)(""),2),m=s[0],f=s[1],d=l.reduce(function(e,r){var n,o,l=(null==i||null===(n=i.properties)||void 0===n||null===(n=n[r.name])||void 0===n?void 0:n.title)||r.name,c=(null==a?void 0:a[null==r?void 0:r.name])||{},s=(null==c?void 0:c["ui:options"])||{};if("hidden"===((null==c?void 0:c["ui:widget"])||s.widget)||!l.toLowerCase().includes((m||"").toLowerCase()))return e;var f,d=(null==s?void 0:s["geonode-ui:group"])||(0,j.kA)(t.messages,"gnviewer.metadataGroupTitle"),p=e[d]||[];return k(k({},e),{},T({},d,[].concat(function(e){if(Array.isArray(e))return N(e)}(f=p)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(f)||x(f)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[k(k({},r),{},{uiSchema:c,schema:null==i||null===(o=i.properties)||void 0===o?void 0:o[r.name],error:u[r.name],title:l})])))},{}),p="gn-metadata-title",y=!Object.keys(d).some(function(e){return d[e].length>0});return o().createElement("div",{className:"gn-metadata-layout"},o().createElement("ul",{className:"gn-metadata-list"},o().createElement(w.A,{placeholder:"gnviewer.filterMetadata",value:m,onChange:function(e){return f(e)}}),c?o().createElement("li",null,o().createElement(b.A,{size:"xs",onClick:function(){return F(p)}},o().createElement(S.A,{msgId:"gnviewer.metadataFor"})," ",c)):null,Object.keys(d).filter(function(e){return d[e].length>0}).map(function(e){var t=d[e];return o().createElement(I,{key:e,idSchema:r,title:e,group:t,expanded:!!m||void 0})})),o().createElement("div",{className:"gn-metadata-groups"},c?o().createElement("div",{id:p,className:"gn-metadata-title"},o().createElement(S.A,{msgId:"gnviewer.metadataFor"})," ",c):null,y?o().createElement("div",{className:"field"},o().createElement(S.A,{msgId:"gnviewer.noMetadataFound"})):null,Object.keys(d).filter(function(e){return d[e].length>0}).map(function(e,t){var r=d[e];return o().createElement("div",{className:"gn-metadata-group",key:t},o().createElement("div",{className:"gn-metadata-group-title"},e),r.map(function(e,r){return o().createElement(o().Fragment,{key:"".concat(t,"_").concat(r)},e.content)}))})))}q.contextTypes={messages:a().object};const D=(0,r(164045).A)(function(e){return o().createElement("span",e,o().createElement(E.A,{glyph:"info-circle"}))}),K={ArrayFieldItemTemplate:function(e){var t=e.children,r=e.className,n=e.disabled,i=e.hasToolbar,a=e.hasMoveDown,l=e.hasMoveUp,u=e.hasRemove,c=e.hasCopy,s=e.index,m=e.onCopyIndexClick,f=e.onDropIndexClick,d=e.onReorderClick,p=e.readonly,y=e.registry,v=e.uiSchema,b=y.templates.ButtonTemplates,g=b.CopyButton,h=b.MoveDownButton,O=b.MoveUpButton,E=b.RemoveButton;return o().createElement("div",{className:r},t,i&&o().createElement(o().Fragment,null,(l||a)&&o().createElement(O,{disabled:n||p||!l,onClick:d(s,s-1),uiSchema:v,registry:y}),(l||a)&&o().createElement(h,{disabled:n||p||!a,onClick:d(s,s+1),uiSchema:v,registry:y}),c&&o().createElement(g,{disabled:n||p,onClick:m(s),uiSchema:v,registry:y}),u&&o().createElement(E,{disabled:n||p,onClick:f(s),uiSchema:v,registry:y})))},ArrayFieldTemplate:function(e){var t=e.canAdd,r=e.disabled,n=e.idSchema,i=e.uiSchema,a=e.items,l=e.onAddClick,u=e.readonly,c=e.registry,s=e.required,m=e.schema,f=e.title,d=(0,g.$R)(i),p=(0,g.$F)("ArrayFieldDescriptionTemplate",c,d),y=(0,g.$F)("ArrayFieldItemTemplate",c,d),v=(0,g.$F)("ArrayFieldTitleTemplate",c,d),b=c.templates.ButtonTemplates.AddButton;return o().createElement("div",{id:n.$id},o().createElement("div",{className:"field-array-header"},o().createElement(v,{idSchema:n,title:d.title||f,required:s,schema:m,uiSchema:i,registry:c,description:o().createElement(p,{idSchema:n,description:d.description||m.description,schema:m,uiSchema:i,registry:c})}),t&&o().createElement(b,{className:"array-item-add",onClick:l,disabled:r||u,uiSchema:i,registry:c})),o().createElement("div",{className:"array-item-list"},a&&a.map(function(e){var t=e.key,r=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,h);return o().createElement(y,O({key:t},r))})))},ArrayFieldTitleTemplate:function(e){var t=e.idSchema,r=e.title,n=e.schema,i=e.uiSchema,a=e.required,l=e.registry,u=e.description,c=(0,g.$R)(i,l.globalUiOptions),s=c.label;if(!r||void 0!==s&&!s)return null;var m=(0,g.$F)("TitleFieldTemplate",l,c);return o().createElement(m,{id:(0,g.EH)(t),title:r,required:a,schema:n,uiSchema:i,registry:l,description:u})},ObjectFieldTemplate:function(e){var t;if("root"===(null==e||null===(t=e.idSchema)||void 0===t?void 0:t.$id))return o().createElement(q,e);var r=e.description,n=e.disabled,i=e.formData,a=e.idSchema,l=e.onAddClick,u=e.properties,c=e.readonly,s=e.registry,m=e.required,f=e.schema,d=e.title,p=e.uiSchema,y=(0,g.$R)(p),v=(0,g.$F)("TitleFieldTemplate",s,y),b=(0,g.$F)("DescriptionFieldTemplate",s,y),h=s.templates.ButtonTemplates.AddButton;return o().createElement("div",{id:a.$id},d&&o().createElement(v,{id:(0,g.EH)(a),title:d,required:m,schema:f,uiSchema:p,registry:s,description:o().createElement(b,{id:(0,g.IR)(a),description:r,schema:f,uiSchema:p,registry:s})}),null!=u&&u.length?o().createElement("div",{className:"field-object-properties"},u.map(function(e){return e.content})):null,(0,g.Xl)(f,p,i)&&o().createElement(h,{onClick:l(f),disabled:n||c,uiSchema:p,registry:s}))},TitleFieldTemplate:function(e){var t=e.id,r=e.required,n=e.title,i=e.description;return o().createElement("div",{id:t},o().createElement("label",null,n,r&&o().createElement("span",{className:"required"}," ","*"),i?o().createElement(o().Fragment,null," ",i):null))},DescriptionFieldTemplate:function(e){var t=e.description,r=e.id;return m()(t)?null:o().createElement(D,{id:r,tooltip:t,tooltipPosition:"right"})},ErrorListTemplate:function(){return null},FieldTemplate:function(e){var t=e.id,r=e.label,n=e.children,i=e.errors,a=e.help,l=e.description,u=e.hidden,c=e.required,s=e.displayLabel,m=e.registry,f=e.uiSchema,d=(0,g.$R)(f),p=(0,g.$F)("WrapIfAdditionalTemplate",m,d);return u?o().createElement("div",{className:"hidden"},n):o().createElement(p,e,s&&o().createElement("label",{className:"control-label",htmlFor:t},r,c&&o().createElement("span",{className:"required"}," ","*"),l?o().createElement(o().Fragment,null," ",l):null),n,i,a)},ButtonTemplates:{AddButton:function(e){var t=e.onClick,r=e.disabled;return o().createElement(b.A,{disabled:r,className:"square-button-md",onClick:t,variant:"primary"},o().createElement(c.e6,{glyph:"plus"}))},MoveUpButton:function(e){var t=e.onClick,r=e.disabled;return o().createElement(b.A,{disabled:r,className:"square-button-md",onClick:t,style:r?{visibility:"hidden"}:{}},o().createElement(c.e6,{glyph:"arrow-up"}))},MoveDownButton:function(e){var t=e.onClick,r=e.disabled;return o().createElement(b.A,{disabled:r,className:"square-button-md",onClick:t,style:r?{visibility:"hidden"}:{}},o().createElement(c.e6,{glyph:"arrow-down"}))},RemoveButton:function(e){var t=e.onClick,r=e.disabled;return o().createElement(b.A,{disabled:r,className:"square-button-md",onClick:t},o().createElement(c.e6,{glyph:"trash"}))}}};var _=r(995531),$=r(499084),R=r.n($),B=r(185015),M=r.n(B),L=r(730872),U=r.n(L),z=r(956449),V=r.n(z),W=r(738221),H=r.n(W),G=r(192016),X=r(551783);function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}var Q=["loadOptions","pageSize","debounceTime","labelKey","valueKey","newOptionPromptText"];function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Y.apply(null,arguments)}function Z(e){return function(e){if(Array.isArray(e))return ne(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||re(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t,r){return(t=function(e){var t=function(e){if("object"!=J(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=J(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==J(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||re(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){if(e){if("string"==typeof e)return ne(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ne(e,t):void 0}}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var oe=(0,X.A)("placeholder")(G.Ay);const ie=function(e){var t=e.loadOptions,r=e.pageSize,i=void 0===r?20:r,a=e.debounceTime,l=void 0===a?500:a,u=e.labelKey,c=void 0===u?"label":u,s=e.valueKey,f=void 0===s?"value":s,d=e.newOptionPromptText,p=void 0===d?"Create option":d,y=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,Q),v=te((0,n.useState)(""),2),b=v[0],g=v[1],h=te((0,n.useState)(!1),2),O=h[0],E=h[1],S=te((0,n.useState)(!1),2),j=S[0],w=S[1],P=te((0,n.useState)(!1),2),A=P[0],k=P[1],T=te((0,n.useState)(1),2),C=T[0],x=T[1],N=te((0,n.useState)([]),2),F=N[0],I=N[1],q=(0,n.useRef)(),D=(0,n.useRef)(),K=(0,n.useRef)();return K.current=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(){var e;q.current&&(null===(e=q.current)||void 0===e||e.cancel(),q.current=void 0);var t=_.A.CancelToken;q.current=t.source()}();var r=e.q,n=null!=r?r:b;E(!0);var o=e.page||C;t({q:n,page:o,pageSize:i,config:{cancelToken:q.current.token}}).then(function(e){var t=e.results.map(function(e){return e.selectOption});t=function(e,t){if(y.creatable&&!m()(t)){var r,n=function(e){var r;return(null==e||null===(r=e[c])||void 0===r?void 0:r.toLowerCase())===t.toLowerCase()},o=null===(r=y.value)||void 0===r?void 0:r.some(n),i=e.some(n);return o||i?e:[ee(ee(ee({},c,"".concat(p,' "').concat(t,'"')),f,t),"result",ee(ee({},f,t),c,t))].concat(e)}return e}(t=1===o?t:[].concat(Z(F),Z(t)),n),I(t),w(e.isNextPageAvailable),E(!1),q.current=void 0}).catch(function(){I([]),w(!1),E(!1),q.current=void 0})},(0,n.useEffect)(function(){D.current=H()(function(e){e!==b&&(g(e),x(1),I([]),K.current({q:e,page:1}))},l)},[b]),(0,n.useEffect)(function(){A&&(g(""),x(1),I([]),K.current({q:"",page:1}))},[A]),(0,n.useEffect)(function(){C>1&&K.current()},[C]),o().createElement(oe,Y({},y,{isLoading:O,options:F,labelKey:c,valueKey:f,onOpen:function(){return k(!0)},onClose:function(){return k(!1)},filterOptions:function(e){return e.map(function(e){var t=/\"(.*?)\"/.exec(b);return t?t[1]:e})},onInputChange:function(e){return t=e,q.current&&(null===(r=q.current)||void 0===r||r.cancel(),q.current=void 0),D.current.cancel(),void D.current(t);var t,r},onMenuScrollToBottom:function(){!O&&j&&x(C+1)}}))};function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}var le=["className","description","error","helpTitleIcon","id","labelKey","name","title","value","valueKey","showLabel","required"];function ue(){return ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ue.apply(null,arguments)}function ce(e,t,r){return(t=function(e){var t=function(e){if("object"!=ae(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ae(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var se=function(e){var t=e.className,r=e.description,n=e.error,i=e.helpTitleIcon,a=e.id,l=e.labelKey,u=void 0===l?"label":l,c=e.name,s=e.title,f=e.value,d=e.valueKey,p=void 0===d?"value":d,y=e.showLabel,v=void 0===y||y,b=e.required,g=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,le);return o().createElement("div",{className:"form-group".concat(t?" "+t:"").concat(n?" has-error":"")},v?o().createElement("label",{className:"control-label",htmlFor:a},s||c,b?o().createElement("span",{className:"required"}," ","*"):null,i&&!m()(r)?o().createElement(o().Fragment,null," ",o().createElement(D,{tooltip:r,tooltipPosition:"right"})):null):null,o().createElement(ie,ue({},g,{id:a,value:f&&V()(f)?f.map(function(e){return ce(ce({result:e},p,M()(e)?e:e[p]),u,M()(e)?e:e[u])}):f,valueKey:p,labelKey:u})),n)};se.propTypes={className:a().string,description:a().string,error:a().element,helpTitleIcon:a().bool,id:a().string.isRequired,labelKey:a().string,name:a().string,title:a().string,value:a().any.isRequired,valueKey:a().string,showLabel:a().bool};const me=se;var fe=r(283306),de=r(858156),pe=r.n(de);function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}function ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(r),!0).forEach(function(t){ge(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ge(e,t,r){return(t=function(e){var t=function(e){if("object"!=ye(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ye(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function he(e){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(e)}var Oe=["name"],Ee=["result"],Se=["q","config"];function je(){return je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},je.apply(null,arguments)}function we(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?we(Object(r),!0).forEach(function(t){Ae(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):we(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ae(e,t,r){return(t=function(e){var t=function(e){if("object"!=he(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=he(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==he(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ke(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Te(e,t){return Object.keys(t||{}).some(function(r){var n;return r===e||!(null===(n=t[r])||void 0===n||!n.properties)&&Te(e,t[r].properties)})}function Ce(e){var t,r=e.name,n=ke(e,Oe),o=(r||"").split("-"),i=parseFloat(o[o.length-1]);return!isNaN(i)&&!Te(r,null==n||null===(t=n.registry)||void 0===t||null===(t=t.rootSchema)||void 0===t?void 0:t.properties)}const xe={SchemaField:function(e){var t,r,i,a,l=e.onChange,u=e.schema,c=e.formData,s=e.idSchema,f=e.name,d=e.errorSchema,p=e.uiSchema,y=e.required,v=null==p?void 0:p["ui:options"],b=null==v?void 0:v["geonode-ui:autocomplete"],g="string"===(null==u||null===(t=u.items)||void 0===t?void 0:t.type),h="object"===(null==u||null===(r=u.items)||void 0===r?void 0:r.type),O="array"===(null==u?void 0:u.type)&&(g||h&&!m()(null==u||null===(i=u.items)||void 0===i?void 0:i.properties)),E="object"===(null==u?void 0:u.type)&&!m()(null==u?void 0:u.properties),S=function(e){var t=e.uiSchema,r=e.idSchema,o=e.onChange,i=e.isMultiSelect,a=e.formContext,l=e.name,u=null==t?void 0:t["ui:options"],c=null==u?void 0:u["geonode-ui:referencevalue"],s=null==u?void 0:u["geonode-ui:referencekey"],m=r.$id.match(/_(\d+)(_|$)/),f=m?parseInt(m[1],10):null,d=c?pe()(a,"metadata.".concat(U()(c)({index:f}))):null,p=(0,n.useRef)(null),y=function(e){p.current=be(be({},p.current),{},ge({},l,e))};return(0,n.useEffect)(function(){null===p.current&&c&&y(d)},[]),(0,n.useEffect)(function(){var e;c&&d!==(null===(e=p.current)||void 0===e?void 0:e[l])&&(y(d),o(i?[]:{}))},[c,d]),{referenceValue:d,referenceKey:s}}(Pe(Pe({},e),{},{isMultiSelect:O})),j=S.referenceValue,w=S.referenceKey;if(b&&(O||E)){var P,A=v.classNames,k=v.style,T=v.description,C=v.disabled,x=v.help,N=v.hideError,F=v.label,I=v.placeholder,q=v.title,D=(N?[]:R()(d)).reduce(function(e,t){return null!=t&&t.__errors?e.push({messages:t.__errors}):Object.keys(t||{}).forEach(function(r){var n;null!==(n=t[r])&&void 0!==n&&n.__errors&&e.push({key:r,messages:t[r].__errors})}),e},[]),K=M()(b)?{url:b}:b,$=null==K?void 0:K.url;j&&($=U()($)(Ae({},null!=w?w:"id",j)));var B=(null==K?void 0:K.queryKey)||"q",L=(null==K?void 0:K.resultsKey)||"results",z=(null==K?void 0:K.valueKey)||"id",V=(null==K?void 0:K.labelKey)||"label",W=!(null==K||!K.creatable),H=null!=I?I:" ",G={className:"field".concat(A?" "+A:""),clearable:!y,creatable:W,id:s.$id,labelKey:V,multi:O,name:f,placeholder:H,showLabel:null==F||F,title:null!=q?q:u.title,value:c,valueKey:z,helpTitleIcon:!0,description:null!==(P=null!=x?x:T)&&void 0!==P?P:u.description,disabled:C||(null==e?void 0:e.readonly)||(null==u?void 0:u.readOnly),style:k,required:y,onChange:function(e){var t,r=null!==(t=null==e?void 0:e.result)&&void 0!==t?t:void 0;return l(O?e.map(function(e){var t,r=e.result,n=ke(e,Ee);return void 0===r?n:M()(r)?r:g?r[z]:Object.fromEntries(Object.keys(null===(t=u.items)||void 0===t?void 0:t.properties).map(function(e){return[e,r[e]]}))}):r)},loadOptions:function(e){var t=e.q,r=e.config,n=ke(e,Se);return _.A.get($,Pe(Pe({},r),{},{params:Pe(Pe(Pe({},n),t&&Ae({},B,t)),{},{page:n.page})})).then(function(e){var t,r=e.data;return{isNextPageAvailable:!(null===(t=r.pagination)||void 0===t||!t.more),results:null==r?void 0:r[L].map(function(e){return{selectOption:Ae(Ae({result:e},z,M()(e)?e:e[z]),V,M()(e)?e:e[V])}})}})},error:m()(D)?null:o().createElement(o().Fragment,null,D.map(function(e,t){return o().createElement("ul",{key:t,className:"text-danger"},R()(e.messages).map(function(t,r){return o().createElement("li",{key:r},e.key?"".concat(e.key,": "):"",t)}))}))};return o().createElement(me,G)}var X=Ce(e);return o().createElement(fe.A,je({},e,{uiSchema:X?Pe(Pe({},e.uiSchema),{},{"ui:label":!1,"ui:options":Pe(Pe({},null===(a=e.uiSchema)||void 0===a?void 0:a["ui:options"]),{},{label:!1})}):p}))}};var Ne=r(277327),Fe=r(866875);function Ie(e){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ie(e)}var qe=["__errors"];function De(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ke(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?De(Object(r),!0).forEach(function(t){_e(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _e(e,t,r){return(t=function(e){var t=function(e){if("object"!=Ie(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ie(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $e(e,t){var r=e.pk,i=e.loading,a=e.error,s=e.extraErrors,d=e.metadata,p=e.schema,y=e.uiSchema,b=e.updateError,g=e.setLoading,h=e.setError,O=e.setUISchema,E=e.setSchema,S=e.setMetadata,w=e.setInitialMetadata,P=e.setUpdateError,A=e.setResource,k=e.updating,T=e.setExtraErrors,C=e.readOnly,x=t.messages,N=(0,n.useRef)(!1),F=(0,n.useRef)(),I=null!=s?s:{},q=I.__errors,D=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(I,qe);return F.current=function(e){null!=e&&e.validateForm&&!N.current&&(N.current=!0,m()(D)&&e.validateForm())},(0,n.useEffect)(function(){r&&(g(!0),h(!1),(0,f._T)(r).then(function(e){O(e.uiSchema),E(e.schema),S(e.metadata),w(e.metadata),A(e.resource),T(e.extraErrors)}).catch(function(){h(!0)}).finally(function(){g(!1)}))},[r]),(0,n.useEffect)(function(){return function(){P(null),T({})}},[]),i?o().createElement(Fe.A,null):a?o().createElement(Ne.A,{msgId:"gnviewer.metadataNotFound"}):d||p?o().createElement("div",{className:"gn-metadata"},o().createElement("div",{className:"gn-metadata-header"},!m()(b)&&o().createElement(c.Fc,{bsStyle:b.type,style:{margin:"0.25rem 0"}},b.message,!m()(q)&&o().createElement("ul",null,q.map(function(e,t){return o().createElement("li",{key:t},e)})))),o().createElement("div",{className:"gn-metadata-container"},o().createElement(u.Ay,{liveValidate:!0,readonly:C,ref:F.current,formContext:{title:null==d?void 0:d.title,metadata:d},schema:p,widgets:v,uiSchema:y,formData:d,validator:l.Ay,templates:K,fields:xe,extraErrors:D,transformErrors:function(e){return e.filter(function(e){return"must be equal to constant"!==e.message}).map(function(e){var t=(e.message||"").startsWith("must have required property")?"must have required property":e.message,r="metadata.error.".concat(t),n=(0,j.kA)(x,r);return Ke(Ke({},e),{},{message:r===n?t:n})})},experimental_defaultFormStateBehavior:{arrayMinItems:{populate:"never",mergeExtraDefaults:!1}},onChange:function(e){var t;t=e.formData,P(null),S(t)}},o().createElement(o().Fragment,null))),k?o().createElement(Fe.A,{style:{opacity:.5}}):null):null}$e.contextTypes={messages:a().object};const Re=$e}}]);