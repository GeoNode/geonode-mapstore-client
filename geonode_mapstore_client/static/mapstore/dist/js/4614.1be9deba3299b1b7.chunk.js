(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[4614],{150802(e,t,r){"use strict";r.d(t,{A:()=>o});var i=r(230669),n=r(629987);function o(e,t){return void 0===t&&(t={}),(0,n.OQ)(e,function(e,r){var n=r.geometry.coordinates;return e+(0,i.A)(n[0],n[1],t)},0)}},230669(e,t,r){"use strict";r.d(t,{A:()=>o});var i=r(145046),n=r(893279);const o=function(e,t,r){void 0===r&&(r={});var o=(0,i.uG)(e),l=(0,i.uG)(t),a=(0,n.tR)(l[1]-o[1]),u=(0,n.tR)(l[0]-o[0]),s=(0,n.tR)(o[1]),c=(0,n.tR)(l[1]),m=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(s)*Math.cos(c);return(0,n.cJ)(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),r.units)}},301979(e){var t=Math.ceil,r=Math.max;e.exports=function(e,i,n,o){for(var l=-1,a=r(t((i-e)/(n||1)),0),u=Array(a);a--;)u[o?a:++l]=e,e+=n;return u}},323111(e,t,r){"use strict";r.d(t,{A:()=>u});var i=r(893279),n=r(145046);function o(e,t,r){if(void 0===r&&(r={}),!0===r.final)return function(e,t){var r=o(t,e);return(r+180)%360}(e,t);var l=(0,n.uG)(e),a=(0,n.uG)(t),u=(0,i.tR)(l[0]),s=(0,i.tR)(a[0]),c=(0,i.tR)(l[1]),m=(0,i.tR)(a[1]),p=Math.sin(s-u)*Math.cos(m),y=Math.cos(c)*Math.sin(m)-Math.sin(c)*Math.cos(m)*Math.cos(s-u);return(0,i.nv)(Math.atan2(p,y))}function l(e,t,r,o){void 0===o&&(o={});var l=(0,n.uG)(e),a=(0,i.tR)(l[0]),u=(0,i.tR)(l[1]),s=(0,i.tR)(r),c=(0,i.Gf)(t,o.units),m=Math.asin(Math.sin(u)*Math.cos(c)+Math.cos(u)*Math.sin(c)*Math.cos(s)),p=a+Math.atan2(Math.sin(s)*Math.sin(c)*Math.cos(u),Math.cos(c)-Math.sin(u)*Math.sin(m)),y=(0,i.nv)(p),d=(0,i.nv)(m);return(0,i.zx)([y,d],o.properties)}var a=r(230669);function u(e,t,r){void 0===r&&(r={});for(var u=(0,n.bg)(e).coordinates,s=0,c=0;c<u.length&&!(t>=s&&c===u.length-1);c++){if(s>=t){var m=t-s;if(m){var p=o(u[c],u[c-1])-180;return l(u[c],m,p,r)}return(0,i.zx)(u[c])}s+=(0,a.A)(u[c],u[c+1],r)}return(0,i.zx)(u[u.length-1])}},341785(e,t,r){var i=r(705624)();e.exports=i},593131(e,t,r){"use strict";r.r(t),r.d(t,{default:()=>ge});var i=r(501144),n=r(215327),o=r(434067),l=r(267980),a=r(336946),u=r(41476),s=r(707568),c=r(953612),m=r(367817),p=r(584164),y=r(744603),d=r(543622),f=r(491446),v=r(252544),h=r(448871),g=r(424620),T=r(71578),b=r(63316),A=r(337632),O=r(15817),E=r(742558),C=r(938487),R=r.n(C),L=r(39128),w=r.n(L),S=r(65747),x=r.n(S),P=r(809136),G=r.n(P),M=r(341785),H=r.n(M),I=r(226001),z=r.n(I),N=r(417497),j=r(399392),D=r(684633),_=r(290505),k=r(715726),F=r(302982);function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}var B=["msTranslateX","msTranslateY","msHeight"],U=["msGeometry"],Y=["msGeometry"];function V(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,$(i.key),i)}}function X(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;r[i]=e[i]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach(function(t){Q(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Q(e,t,r){return(t=$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $(e){var t=function(e){if("object"!=W(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=W(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==W(t)?t:t+""}function K(e){return function(e){if(Array.isArray(e))return ee(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Z(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){if(e){if("string"==typeof e)return ee(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ee(e,t):void 0}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var te=_.R.cesium({Cesium:i});function re(e){var t=e.color,r=e.opacity;if(!t)return new u.A(0,0,0,0);var i=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,o,l,a=[],u=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(i=o.call(r)).done)&&(a.push(i.value),a.length!==t);u=!0);}catch(e){s=!0,n=e}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(s)throw n}}return a}}(e,t)||Z(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(R()(t).gl(),4),n=i[0],o=i[1],l=i[2],a=i[3];return void 0!==r?new u.A(n,o,l,r):new u.A(n,o,l,a)}function ie(e){var t=e.color,r=e.opacity,i=e.dasharray;if((null==i?void 0:i.length)<=0)return re({color:t,opacity:r});var n=i.reduce(function(e,t){return e+t},0);return new g.A({color:re({color:t,opacity:r}),dashLength:n,dashPattern:parseInt(i.map(function(e){return Math.floor(e/n*16)}).map(function(e,t){return H()(e).map(function(){return t%2==0?"1":"0"}).join("")}).join(""),2)})}var ne=function(e){var t=parseFloat(e);return!z()(t)&&x()(t)?t:null},oe=function(e){var t,r=e.map,i=e.positions,n=e.heightReference,o=e.sampleTerrain,u=e.initialHeight,s=null!=n?n:"none",c={none:function(e){return e},relative:function(e,t){return e+t},clamp:function(e,t){return t}},m=[],p=function(e){var t=c[s],r=1/0,i=-1/0,n=1/0,o=-1/0,a=e.map(function(e,a){var u=m[a]||0,c="none"===s?0:e.height||0,p=t(u,c);return r=p<r?p:r,i=p>i?p:i,n=c<n?c:n,o=c>o?c:o,l.A.fromRadians(e.longitude,e.latitude,p)});return{height:{min:r,max:i},sampledHeight:{min:n,max:o},positions:a}},y=i.map(function(e){var t,r=a.A.fromCartesian(e);return m.push(null!==(t=null!=u?u:r.height)&&void 0!==t?t:0),new a.A(r.longitude,r.latitude,null!=u?u:0)}),d=null==r?void 0:r.terrainProvider;if("none"===s||!d)return Promise.resolve(p(y));var v,g,T=null!=d&&d.availability?h.A(d,y):o(d,null!==(t=null==d?void 0:d.sampleTerrainZoomLevel)&&void 0!==t?t:18,y);return f.A(T)?null===(v=T.then(function(e){return p(e)}))||void 0===v||null===(g=v.catch)||void 0===g?void 0:g.call(v,function(){return p(y)}):p(y)},le={};function ae(e){var t=e.offset,r=void 0===t?[]:t,i=e.msLeaderLineWidth,n=null!=i?i:1,o=Math.abs(r[0]||1),l=Math.abs(r[1]||1),a=Math.sign(r[0])===Math.sign(r[1]),u=[o,l,n,a].join(";");if(le[u])return le[u];var s=document.createElement("canvas");s.setAttribute("width",o),s.setAttribute("height",l);var c=s.getContext("2d");return c.strokeStyle="#ffffff",c.lineWidth=n,c.beginPath(),c.moveTo.apply(c,K(a?[0,0]:[o,0])),c.lineTo.apply(c,K(a?[o,l]:[0,l])),c.stroke(),le[u]=s,s}var ue=function(e,t){var r=t||{},i=r.msTranslateX,n=r.msTranslateY,o=ne(i),a=ne(n);return o||a?p.A.multiplyByPoint(d.A.eastNorthUpToFixedFrame(e),new l.A(o||0,a||0,0),new l.A):e},se={none:"NONE",relative:"RELATIVE_TO_GROUND",clamp:"CLAMP_TO_GROUND"},ce=function(e){switch(e){case"top-left":return{horizontalOrigin:A.A.LEFT,verticalOrigin:E.A.TOP};case"top":return{horizontalOrigin:A.A.CENTER,verticalOrigin:E.A.TOP};case"top-right":return{horizontalOrigin:A.A.RIGHT,verticalOrigin:E.A.TOP};case"left":return{horizontalOrigin:A.A.LEFT,verticalOrigin:E.A.CENTER};case"center":default:return{horizontalOrigin:A.A.CENTER,verticalOrigin:E.A.CENTER};case"right":return{horizontalOrigin:A.A.RIGHT,verticalOrigin:E.A.CENTER};case"bottom-left":return{horizontalOrigin:A.A.LEFT,verticalOrigin:E.A.BOTTOM};case"bottom":return{horizontalOrigin:A.A.CENTER,verticalOrigin:E.A.BOTTOM};case"bottom-right":return{horizontalOrigin:A.A.RIGHT,verticalOrigin:E.A.BOTTOM}}},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Square",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if("Circle"===e){for(var r=[],i=0;i<360;i++){var n=m.A.toRadians(i);r.push(new o.A(t*Math.cos(n),t*Math.sin(n)))}return r}return"Square"===e?[new o.A(-t,-t),new o.A(t,-t),new o.A(t,t),new o.A(-t,t)]:[]},pe=function(e,t){var r=t||{},i=r.heading,n=r.pitch,o=r.roll;if(i||n||o){var l=new c.A(m.A.toRadians(null!=i?i:0),m.A.toRadians(null!=n?n:0),m.A.toRadians(null!=o?o:0));return d.A.headingPitchRollQuaternion(e,l)}return null},ye=function(e,t){var r,i=t.radius,n=e;if(t.geodesic){var o=k.A.computeEllipsePositions({granularity:.02,semiMajorAxis:i,semiMinorAxis:i,rotation:0,center:n},!1,!0).outerPositions;r=l.A.unpackArray(o),r=[].concat(K(r),[r[0]])}else{var a=p.A.multiplyByTranslation(d.A.eastNorthUpToFixedFrame(n),new l.A(0,0,0),new p.A);r=F.A.computePositions(0,i,i,128,!1),r=(r=K((r=l.A.unpackArray(r)).splice(0,Math.ceil(r.length/2)))).map(function(e){return p.A.multiplyByPoint(a,e,new l.A)}),r=[].concat(K(r),[r[0]])}return r},de=function(e,t){var r=(t||{}).msHeight,i=ne(r);if(null!==i){var n=a.A.fromCartesian(e);return l.A.fromRadians(n.longitude,n.latitude,i)}return e},fe={point:function(e){var t=e.feature,r=e.primitive,i=e.parsedSymbolizer;if("Point"===t.geometry.type){var n=de(t.positions[0][0],i),o=pe(n,i);return J(J({},e),{},{primitive:J(J({},r),{},{orientation:o,geometry:ue(n,i)})})}var l=te(J({msGeometry:{name:"centerPoint"}},i))(t).position,a=pe(l,i);return J(J({},e),{},{primitive:J(J({},r),{},{orientation:a,geometry:ue(de(l,i),i)})})},leaderLine:function(e,t){var r=t.map,i=t.sampleTerrain,n=e.parsedSymbolizer,o=(n.msTranslateX,n.msTranslateY,n.msHeight,X(n,B)),l=fe.point(J(J({},e),{},{parsedSymbolizer:o})).primitive;return Promise.all([oe({map:r,positions:[l.geometry],heightReference:"clamp",sampleTerrain:i}).then(function(e){return e.positions[0]}),oe({map:r,positions:[ue(de(l.geometry,n),n)],heightReference:n.msHeightReference,sampleTerrain:i}).then(function(e){return e.positions[0]})]).then(function(t){return J(J({},e),{},{primitive:J(J({},l),{},{geometry:[t]})})})},polyline:function(e,t){var r=t.map,i=t.sampleTerrain,n=e.feature,o=e.primitive,l=e.parsedSymbolizer,a=ne(l.msExtrudedHeight),u=ne(l.msHeight);if(null!==u||l.msExtrusionRelativeToGeometry){var s=1/0,c=-1/0;return Promise.all(null==n?void 0:n.positions.map(function(e){return oe({map:r,positions:e,heightReference:l.msHeightReference,sampleTerrain:i,initialHeight:u}).then(function(e){var t=e[l.msExtrusionRelativeToGeometry?"height":"sampledHeight"];return s=t.min<s?t.min:s,c=t.max>c?t.max:c,e.positions})})).then(function(t){return J(J({},e),{},{primitive:J(J({},o),{},{geometry:t,extrudedHeight:a?a+(a>0?c:s):void 0})})})}return J(J({},e),{},{primitive:J(J({},o),{},{geometry:null==n?void 0:n.positions},null!==a&&{extrudedHeight:a})})},wall:function(e,t){return Promise.resolve(fe.polyline(e,t)).then(function(t){var r,i,n=t.primitive;return J(J({},e),{},{primitive:J(J({},n),{},{geometry:null==n?void 0:n.geometry,minimumHeights:null==n||null===(r=n.geometry)||void 0===r?void 0:r.map(function(e){return e.map(function(e){return a.A.fromCartesian(e).height})}),maximumHeights:null==n||null===(i=n.geometry)||void 0===i?void 0:i.map(function(e){return e.map(function(){return n.extrudedHeight})})})})})},polygon:function(e,t){var r,i,n=t.map,o=t.sampleTerrain,l=e.feature,a=e.primitive,u=e.parsedSymbolizer,s=ne(u.msExtrudedHeight),c=ne(u.msHeight);if("none"!==(u.msHeightReference||"none")||u.msExtrusionRelativeToGeometry){var m=1/0,p=-1/0;return Promise.all(null==l?void 0:l.positions.map(function(e){return oe({map:n,positions:e,heightReference:u.msHeightReference,sampleTerrain:o,initialHeight:c}).then(function(e){var t=e[u.msExtrusionRelativeToGeometry?"height":"sampledHeight"];return m=t.min<m?t.min:m,p=t.max>p?t.max:p,e.positions})})).then(function(t){var r,i,n={height:void 0,extrudedHeight:s?s+(s>0?p:m):void 0};return J(J({},e),{},{primitive:J(J({},a),{},{geometry:t},null!=a&&null!==(r=a.entity)&&void 0!==r&&r.polygon?{entity:{polygon:J(J({},null==a||null===(i=a.entity)||void 0===i?void 0:i.polygon),n)}}:n)})})}var y=J(J({},null!==s&&{extrudedHeight:s}),null!==c&&{height:c,perPositionHeight:!1});return J(J({},e),{},{primitive:J(J({},a),{},{geometry:null==l?void 0:l.positions},null!=a&&null!==(r=a.entity)&&void 0!==r&&r.polygon?{entity:{polygon:J(J({},null==a||null===(i=a.entity)||void 0===i?void 0:i.polygon),y)}}:y)})},circlePolyline:function(e){var t=e.feature,r=e.primitive,i=e.parsedSymbolizer;if("Point"===t.geometry.type){var n=l.A.fromDegrees(t.geometry.coordinates[0],t.geometry.coordinates[1],t.geometry.coordinates[2]||0),o=ye(n,i);return J(J({},e),{},{primitive:J(J({},r),{},{geometry:[o]})})}return e},circlePolygon:function(e){var t=e.feature,r=e.primitive,i=e.parsedSymbolizer;if("Point"===t.geometry.type){var n=l.A.fromDegrees(t.geometry.coordinates[0],t.geometry.coordinates[1],t.geometry.coordinates[2]||0),o=ye(n,i);return J(J({},e),{},{primitive:J(J({},r),{},{geometry:[o]})})}return e}},ve={Mark:function(e){var t,r=e.parsedSymbolizer,i=e.globalOpacity,n=e.images,o=e.symbolizer,l=n.find(function(e){return e.id===(0,j.RU)(r,o)})||{},a=l.src,u=l.width,s=l.height,c=u>s?u:s,p=2*r.radius/c;return a&&!z()(p)?[{type:"point",geometryType:"point",entity:{billboard:{image:a,scale:p,rotation:m.A.toRadians(-1*r.rotate||0),disableDepthTestDistance:r.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:b.Ay[se[r.msHeightReference]||"NONE"],color:re({color:"#ffffff",opacity:1*i})}}}].concat(K(r.msLeaderLineWidth?[{type:"leaderLine",geometryType:"leaderLine",entity:{polyline:{material:re({color:r.msLeaderLineColor||"#000000",opacity:(null!==(t=r.msLeaderLineOpacity)&&void 0!==t?t:1)*i}),width:r.msLeaderLineWidth}}}]:[])):[]},Icon:function(e){var t,r=e.parsedSymbolizer,i=e.globalOpacity,n=e.images,l=e.symbolizer,a=n.find(function(e){return e.id===(0,j.RU)(r,l)})||{},u=a.src,s=a.width,c=a.height,p=s>c?s:c,y=r.size/p;return u&&!z()(y)?[{type:"point",geometryType:"point",entity:{billboard:J(J({image:u,scale:y},ce(r.anchor)),{},{pixelOffset:r.offset?new o.A(r.offset[0],r.offset[1]):null,rotation:m.A.toRadians(-1*r.rotate||0),disableDepthTestDistance:r.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:b.Ay[se[r.msHeightReference]||"NONE"],color:re({color:"#ffffff",opacity:r.opacity*i})})}}].concat(K(r.msLeaderLineWidth?[{type:"leaderLine",geometryType:"leaderLine",entity:{polyline:{material:re({color:r.msLeaderLineColor||"#000000",opacity:(null!==(t=r.msLeaderLineOpacity)&&void 0!==t?t:1)*i}),width:r.msLeaderLineWidth}}}]:[])):[]},Text:function(e){var t,r,i,n,l=e.parsedSymbolizer,a=e.feature,u=e.globalOpacity,s=ne(null==l||null===(t=l.offset)||void 0===t?void 0:t[0]),c=ne(null==l||null===(r=l.offset)||void 0===r?void 0:r[1]);return[{type:"point",geometryType:"point",entity:{label:J(J({text:(0,j.vK)({properties:a.properties},l.label,""),font:[l.fontStyle,l.fontWeight,"".concat(l.size,"px"),w()(l.font||["serif"]).join(", ")].filter(function(e){return e}).join(" "),fillColor:re({color:l.color,opacity:1*u})},ce(l.anchor)),{},{disableDepthTestDistance:l.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:b.Ay[se[l.msHeightReference]||"NONE"],pixelOffset:new o.A(null!=s?s:0,null!=c?c:0)},l.haloWidth>0&&{style:O.A.FILL_AND_OUTLINE,outlineColor:re({color:l.haloColor,opacity:1*u}),outlineWidth:l.haloWidth})}}].concat(K(l.msLeaderLineWidth?[{type:"leaderLine",geometryType:"leaderLine",entity:{polyline:{material:re({color:l.msLeaderLineColor||"#000000",opacity:(null!==(i=l.msLeaderLineOpacity)&&void 0!==i?i:1)*u}),width:l.msLeaderLineWidth}}}]:[]),K(l.msLeaderLineWidth&&(s||c)?[{type:"offset",geometryType:"point",entity:{billboard:{image:ae(l),scale:1,pixelOffset:new o.A((s||0)/2,(c||0)/2),color:re({color:l.msLeaderLineColor||"#000000",opacity:(null!==(n=l.msLeaderLineOpacity)&&void 0!==n?n:1)*u})}}}]:[]))},Model:function(e){var t,r,i,n,o=e.parsedSymbolizer,l=e.globalOpacity;return null!=o&&o.model?[{type:"point",geometryType:"point",entity:{model:{uri:new y.A({proxy:(0,N.jG)(null==o?void 0:o.model)?new s.A((0,N.s_)()):void 0,url:null==o?void 0:o.model}),color:re({color:null!==(t=o.color)&&void 0!==t?t:"#ffffff",opacity:(null!==(r=o.opacity)&&void 0!==r?r:1)*l}),scale:null!==(i=null==o?void 0:o.scale)&&void 0!==i?i:1,heightReference:b.Ay[se[o.msHeightReference]||"NONE"]}}}].concat(K(o.msLeaderLineWidth?[{type:"leaderLine",geometryType:"leaderLine",entity:{polyline:{material:re({color:o.msLeaderLineColor||"#000000",opacity:(null!==(n=o.msLeaderLineOpacity)&&void 0!==n?n:1)*l}),width:o.msLeaderLineWidth}}}]:[])):[]},Line:function(e){var t,r,i=e.parsedSymbolizer,o=e.feature,l=e.globalOpacity,a=te(i),u=a?a(o):{};return[].concat(K(i.color&&0!==i.width?[{type:"polyline",geometryType:"polyline",entity:{polyline:J({material:null!=i&&i.dasharray?ie({color:i.color,opacity:i.opacity*l,dasharray:i.dasharray}):re({color:i.color,opacity:i.opacity*l}),width:i.width,clampToGround:i.msClampToGround,arcType:i.msClampToGround?n.A.GEODESIC:n.A.NONE},u)}}]:[]),K(i.msClampToGround||!i.msExtrudedHeight||i.msExtrusionType?[]:[{type:"polylineVolume",geometryType:"wall",entity:{wall:{material:re({color:i.msExtrusionColor||"#000000",opacity:(null!==(t=i.msExtrusionOpacity)&&void 0!==t?t:1)*l})}}}]),K(!i.msClampToGround&&i.msExtrudedHeight&&i.msExtrusionType?[{type:"polylineVolume",geometryType:"polyline",entity:{polylineVolume:{material:re({color:i.msExtrusionColor||"#000000",opacity:(null!==(r=i.msExtrusionOpacity)&&void 0!==r?r:1)*l}),shape:me(i.msExtrusionType,i.msExtrudedHeight/2)}}}]:[]))},Fill:function(e){var t=e.parsedSymbolizer,r=e.feature,i=e.globalOpacity,o=!t.msClampToGround&&!!t.msExtrudedHeight,l=te(t),a=l?l(r):{};return[{type:"polygon",geometryType:"polygon",clampToGround:t.msClampToGround,entity:{polygon:J(J({material:re({color:t.color,opacity:t.fillOpacity*i}),perPositionHeight:!t.msClampToGround},t.msClampToGround?{classificationType:"terrain"===t.msClassificationType?T.A.TERRAIN:"3d"===t.msClassificationType?T.A.CESIUM_3D_TILE:T.A.BOTH}:void 0),{},{arcType:t.msClampToGround?n.A.GEODESIC:void 0},a)}}].concat(K(t.outlineColor&&0!==t.outlineWidth&&!o?[{type:"polyline",geometryType:"polyline",entity:{polyline:J(J({material:null!=t&&t.outlineDasharray?ie({color:t.outlineColor,opacity:t.outlineOpacity*i,dasharray:t.outlineDasharray}):re({color:t.outlineColor,opacity:t.outlineOpacity*i}),width:t.outlineWidth,clampToGround:t.msClampToGround},t.msClampToGround?{classificationType:"terrain"===t.msClassificationType?T.A.TERRAIN:"3d"===t.msClassificationType?T.A.CESIUM_3D_TILE:T.A.BOTH}:void 0),{},{arcType:t.msClampToGround?n.A.GEODESIC:n.A.NONE},a)}}]:[]))},Circle:function(e){var t=e.parsedSymbolizer,r=e.globalOpacity;return[{type:"polygon",geometryType:"circlePolygon",clampToGround:t.msClampToGround,entity:{polygon:J({material:re({color:t.color,opacity:t.opacity*r})},t.geodesic?J(J({perPositionHeight:!t.msClampToGround},t.msClampToGround?{classificationType:"terrain"===t.msClassificationType?T.A.TERRAIN:"3d"===t.msClassificationType?T.A.CESIUM_3D_TILE:T.A.BOTH}:void 0),{},{arcType:n.A.GEODESIC}):{perPositionHeight:!0,arcType:void 0})}}].concat(K(t.outlineColor&&0!==t.outlineWidth?[{type:"polyline",geometryType:"circlePolyline",entity:{polyline:J({material:null!=t&&t.outlineDasharray?ie({color:t.outlineColor,opacity:t.outlineOpacity*r,dasharray:t.outlineDasharray}):re({color:t.outlineColor,opacity:t.outlineOpacity*r}),width:t.outlineWidth},t.geodesic?J(J({clampToGround:t.msClampToGround},t.msClampToGround?{classificationType:"terrain"===t.msClassificationType?T.A.TERRAIN:"3d"===t.msClassificationType?T.A.CESIUM_3D_TILE:T.A.BOTH}:void 0),{},{arcType:n.A.GEODESIC}):{clampToGround:!1,arcType:n.A.NONE})}}]:[]))}},he=function(e,t){e.msGeometry;var r=X(e,U),i=(t.msGeometry,X(t,Y));return!G()(r,i)};const ge=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},(t=[{key:"readStyle",value:function(){return new Promise(function(e,t){try{e(null)}catch(e){t(e)}})}},{key:"writeStyle",value:function(e){return new Promise(function(t,r){try{t(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).rules,t=void 0===e?[]:e;return function(e){var r=e.opacity,i=void 0===r?1:r,n=e.features,o=e.getPreviousStyledFeature,l=void 0===o?function(){}:o,a=e.map,u=e.sampleTerrain,s=void 0===u?v.A:u;return(0,D.J)({rules:t},{features:n}).then(function(e){var r=function(e){var t=e.rules,r=e.features,i=e.globalOpacity,n=e.images;return null==t?void 0:t.map(function(e){var t=r.filter(function(t){var r=t.properties;return!e.filter||(0,j.Cx)({properties:r||{}},e.filter)});return e.symbolizers.map(function(e){return t.filter(function(t){return function(e){var t=e.geometry,r=e.symbolizer;return!("Point"===t.type&&["Fill","Line"].includes(r.kind)||"LineString"===t.type&&["Fill"].includes(r.kind)||"Polygon"===t.type&&["Line"].includes(r.kind))}({geometry:t.geometry,symbolizer:e})}).map(function(t){var r=(0,j.$k)(e,t);return(ve[r.kind]?ve[r.kind]:function(){return[]})({feature:t,symbolizer:e,images:n,parsedSymbolizer:r,globalOpacity:i}).map(function(i){return{id:"".concat(t.id,":").concat(r.symbolizerId,":").concat(i.type),feature:t,primitive:i,symbolizer:e,parsedSymbolizer:r}})}).flat()}).flat()}).flat()}({rules:t,features:n,globalOpacity:i,images:e});return Promise.all(r.map(function(e){var t,r,i,n,o,u,c=l(e);if(!c||(i=c.parsedSymbolizer,n=e.parsedSymbolizer,(null==i||null===(o=i.msGeometry)||void 0===o?void 0:o.name)!==(null==n||null===(u=n.msGeometry)||void 0===u?void 0:u.name)||(null==i?void 0:i.msHeight)!==(null==n?void 0:n.msHeight)||(null==i?void 0:i.msHeightReference)!==(null==n?void 0:n.msHeightReference)||(null==i?void 0:i.msExtrudedHeight)!==(null==n?void 0:n.msExtrudedHeight)||(null==i?void 0:i.msExtrusionRelativeToGeometry)!==(null==n?void 0:n.msExtrusionRelativeToGeometry)||(null==i?void 0:i.msExtrusionType)!==(null==n?void 0:n.msExtrusionType)||(null==i?void 0:i.msTranslateX)!==(null==n?void 0:n.msTranslateX)||(null==i?void 0:i.msTranslateY)!==(null==n?void 0:n.msTranslateY)||(null==i?void 0:i.heading)!==(null==n?void 0:n.heading)||(null==i?void 0:i.pitch)!==(null==n?void 0:n.pitch)||(null==i?void 0:i.roll)!==(null==n?void 0:n.roll))){var m,p,y=fe[null==e||null===(m=e.primitive)||void 0===m?void 0:m.geometryType]?fe[null==e||null===(p=e.primitive)||void 0===p?void 0:p.geometryType]:function(){return e};return Promise.resolve(y(e,{map:a,sampleTerrain:s})).then(function(e){return J(J({},e),{},{action:"replace"})})}return Promise.resolve(J(J({},e),{},{primitive:J(J(J({},null==c?void 0:c.primitive),null==e?void 0:e.primitive),{},{geometry:null==c||null===(t=c.primitive)||void 0===t?void 0:t.geometry,entity:J({},Object.keys((null==e||null===(r=e.primitive)||void 0===r?void 0:r.entity)||{}).reduce(function(t,r){var i,n;return J(J({},t),{},Q({},r,J(J({},null==c||null===(i=c.primitive)||void 0===i||null===(i=i.entity)||void 0===i?void 0:i[r]),null==e||null===(n=e.primitive)||void 0===n||null===(n=n.entity)||void 0===n?void 0:n[r])))},{}))}),action:he(c.parsedSymbolizer,e.parsedSymbolizer)?"update":"none"}))}))}).then(function(e){return e.filter(function(e){return!!e.primitive.geometry})})}}(e))}catch(e){r(e)}})}}])&&V(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()},705624(e,t,r){var i=r(301979),n=r(449300),o=r(273364);e.exports=function(e){return function(t,r,l){return l&&"number"!=typeof l&&n(t,r,l)&&(r=l=void 0),t=o(t),void 0===r?(r=t,t=0):r=o(r),l=void 0===l?t<r?1:-1:o(l),i(t,r,l,e)}}}}]);