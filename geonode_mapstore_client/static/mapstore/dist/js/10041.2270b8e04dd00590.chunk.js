/*! For license information please see 10041.2270b8e04dd00590.chunk.js.LICENSE.txt */
(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[10041],{24827:(e,t)=>{var n,i,o,r,s,a,c,l,u,d,h,A,p;i={defaultNoDataValue:-34027999387901484e22,decode:function(e,t){var n=(t=t||{}).encodedMaskData||null===t.encodedMaskData,c=a(e,t.inputOffset||0,n),l=null!==t.noDataValue?t.noDataValue:i.defaultNoDataValue,u=o(c,t.pixelType||Float32Array,t.encodedMaskData,l,t.returnMask),d={width:c.width,height:c.height,pixelData:u.resultPixels,minValue:u.minValue,maxValue:c.pixels.maxValue,noDataValue:l};return u.resultMask&&(d.maskData=u.resultMask),t.returnEncodedMask&&c.mask&&(d.encodedMaskData=c.mask.bitset?c.mask.bitset:null),t.returnFileInfo&&(d.fileInfo=r(c),t.computeUsedBitDepths&&(d.fileInfo.bitDepths=s(c))),d}},o=function(e,t,n,i,o){var r,s,a,l=0,u=e.pixels.numBlocksX,d=e.pixels.numBlocksY,h=Math.floor(e.width/u),A=Math.floor(e.height/d),p=2*e.maxZError,f=Number.MAX_VALUE;n=n||(e.mask?e.mask.bitset:null),s=new t(e.width*e.height),o&&n&&(a=new Uint8Array(e.width*e.height));for(var m,g,_=new Float32Array(h*A),y=0;y<=d;y++){var v=y!==d?A:e.height%d;if(0!==v)for(var T=0;T<=u;T++){var b=T!==u?h:e.width%u;if(0!==b){var w,x,C,E,S=y*e.width*A+T*h,I=e.width-b,P=e.pixels.blocks[l];if(P.encoding<2?(0===P.encoding?w=P.rawData:(c(P.stuffedData,P.bitsPerPixel,P.numValidPixels,P.offset,p,_,e.pixels.maxValue),w=_),x=0):C=2===P.encoding?0:P.offset,n)for(g=0;g<v;g++){for(7&S&&(E=n[S>>3],E<<=7&S),m=0;m<b;m++)7&S||(E=n[S>>3]),128&E?(a&&(a[S]=1),f=f>(r=P.encoding<2?w[x++]:C)?r:f,s[S++]=r):(a&&(a[S]=0),s[S++]=i),E<<=1;S+=I}else if(P.encoding<2)for(g=0;g<v;g++){for(m=0;m<b;m++)f=f>(r=w[x++])?r:f,s[S++]=r;S+=I}else for(f=f>C?C:f,g=0;g<v;g++){for(m=0;m<b;m++)s[S++]=C;S+=I}if(1===P.encoding&&x!==P.numValidPixels)throw"Block and Mask do not match";l++}}}return{resultPixels:s,resultMask:a,minValue:f}},r=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,noDataValue:e.noDataValue}}},s=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,n={},i=0;i<t;i++){var o=e.pixels.blocks[i];0===o.encoding?n.float32=!0:1===o.encoding?n[o.bitsPerPixel]=!0:n[0]=!0}return Object.keys(n)},a=function(e,t,n){var i={},o=new Uint8Array(e,t,10);if(i.fileIdentifierString=String.fromCharCode.apply(null,o),"CntZImage"!==i.fileIdentifierString.trim())throw"Unexpected file identifier string: "+i.fileIdentifierString;t+=10;var r=new DataView(e,t,24);if(i.fileVersion=r.getInt32(0,!0),i.imageType=r.getInt32(4,!0),i.height=r.getUint32(8,!0),i.width=r.getUint32(12,!0),i.maxZError=r.getFloat64(16,!0),t+=24,!n)if(r=new DataView(e,t,16),i.mask={},i.mask.numBlocksY=r.getUint32(0,!0),i.mask.numBlocksX=r.getUint32(4,!0),i.mask.numBytes=r.getUint32(8,!0),i.mask.maxValue=r.getFloat32(12,!0),t+=16,i.mask.numBytes>0){var s=new Uint8Array(Math.ceil(i.width*i.height/8)),a=(r=new DataView(e,t,i.mask.numBytes)).getInt16(0,!0),c=2,l=0;do{if(a>0)for(;a--;)s[l++]=r.getUint8(c++);else{var u=r.getUint8(c++);for(a=-a;a--;)s[l++]=u}a=r.getInt16(c,!0),c+=2}while(c<i.mask.numBytes);if(-32768!==a||l<s.length)throw"Unexpected end of mask RLE encoding";i.mask.bitset=s,t+=i.mask.numBytes}else 0===(i.mask.numBytes|i.mask.numBlocksY|i.mask.maxValue)&&(i.mask.bitset=new Uint8Array(Math.ceil(i.width*i.height/8)));r=new DataView(e,t,16),i.pixels={},i.pixels.numBlocksY=r.getUint32(0,!0),i.pixels.numBlocksX=r.getUint32(4,!0),i.pixels.numBytes=r.getUint32(8,!0),i.pixels.maxValue=r.getFloat32(12,!0),t+=16;var d=i.pixels.numBlocksX,h=i.pixels.numBlocksY,A=d+(i.width%d>0?1:0),p=h+(i.height%h>0?1:0);i.pixels.blocks=new Array(A*p);for(var f=0,m=0;m<p;m++)for(var g=0;g<A;g++){var _=0,y=e.byteLength-t;r=new DataView(e,t,Math.min(10,y));var v={};i.pixels.blocks[f++]=v;var T=r.getUint8(0);if(_++,v.encoding=63&T,v.encoding>3)throw"Invalid block encoding ("+v.encoding+")";if(2!==v.encoding){if(0!==T&&2!==T){if(T>>=6,v.offsetType=T,2===T)v.offset=r.getInt8(1),_++;else if(1===T)v.offset=r.getInt16(1,!0),_+=2;else{if(0!==T)throw"Invalid block offset type";v.offset=r.getFloat32(1,!0),_+=4}if(1===v.encoding)if(T=r.getUint8(_),_++,v.bitsPerPixel=63&T,T>>=6,v.numValidPixelsType=T,2===T)v.numValidPixels=r.getUint8(_),_++;else if(1===T)v.numValidPixels=r.getUint16(_,!0),_+=2;else{if(0!==T)throw"Invalid valid pixel count type";v.numValidPixels=r.getUint32(_,!0),_+=4}}var b;if(t+=_,3!==v.encoding)if(0===v.encoding){var w=(i.pixels.numBytes-1)/4;if(w!==Math.floor(w))throw"uncompressed block has invalid length";b=new ArrayBuffer(4*w),new Uint8Array(b).set(new Uint8Array(e,t,4*w));var x=new Float32Array(b);v.rawData=x,t+=4*w}else if(1===v.encoding){var C=Math.ceil(v.numValidPixels*v.bitsPerPixel/8),E=Math.ceil(C/4);b=new ArrayBuffer(4*E),new Uint8Array(b).set(new Uint8Array(e,t,C)),v.stuffedData=new Uint32Array(b),t+=C}}else t++}return i.eofOffset=t,i},c=function(e,t,n,i,o,r,s){var a,c,l,u=(1<<t)-1,d=0,h=0,A=Math.ceil((s-i)/o),p=4*e.length-Math.ceil(t*n/8);for(e[e.length-1]<<=8*p,a=0;a<n;a++){if(0===h&&(l=e[d++],h=32),h>=t)c=l>>>h-t&u,h-=t;else{var f=t-h;c=(l&u)<<f&u,c+=(l=e[d++])>>>(h=32-f)}r[a]=c<A?i+c*o:s}return r},d=i,h=function(){"use strict";var e=function(e,t,n,i,o,r,s,a){var c,l,u,d,h,A=(1<<n)-1,p=0,f=0,m=4*e.length-Math.ceil(n*i/8);if(e[e.length-1]<<=8*m,o)for(c=0;c<i;c++)0===f&&(u=e[p++],f=32),f>=n?(l=u>>>f-n&A,f-=n):(l=(u&A)<<(d=n-f)&A,l+=(u=e[p++])>>>(f=32-d)),t[c]=o[l];else for(h=Math.ceil((a-r)/s),c=0;c<i;c++)0===f&&(u=e[p++],f=32),f>=n?(l=u>>>f-n&A,f-=n):(l=(u&A)<<(d=n-f)&A,l+=(u=e[p++])>>>(f=32-d)),t[c]=l<h?r+l*s:a},t=function(e,t,n,i,o,r,s,a){var c,l,u,d,h=(1<<n)-1,A=0,p=0,f=0;if(o)for(c=0;c<i;c++)0===p&&(u=e[A++],p=32,f=0),p>=n?(l=u>>>f&h,p-=n,f+=n):(l=u>>>f&h,p=32-(d=n-p),l|=((u=e[A++])&(1<<d)-1)<<n-d,f=d),t[c]=o[l];else{var m=Math.ceil((a-r)/s);for(c=0;c<i;c++)0===p&&(u=e[A++],p=32,f=0),p>=n?(l=u>>>f&h,p-=n,f+=n):(l=u>>>f&h,p=32-(d=n-p),l|=((u=e[A++])&(1<<d)-1)<<n-d,f=d),t[c]=l<m?r+l*s:a}return t},n={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(e){for(var t=65535,n=65535,i=e.length,o=Math.floor(i/2),r=0;o;){var s=o>=359?359:o;o-=s;do{t+=e[r++]<<8,n+=t+=e[r++]}while(--s);t=(65535&t)+(t>>>16),n=(65535&n)+(n>>>16)}return 1&i&&(n+=t+=e[r]<<8),((n=(65535&n)+(n>>>16))<<16|(t=(65535&t)+(t>>>16)))>>>0},readHeaderInfo:function(e,t){var n=t.ptr,i=new Uint8Array(e,n,6),o={};if(o.fileIdentifierString=String.fromCharCode.apply(null,i),0!==o.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+o.fileIdentifierString;n+=6;var r,s=new DataView(e,n,8),a=s.getInt32(0,!0);if(o.fileVersion=a,n+=4,a>=3&&(o.checksum=s.getUint32(4,!0),n+=4),s=new DataView(e,n,12),o.height=s.getUint32(0,!0),o.width=s.getUint32(4,!0),n+=8,a>=4?(o.numDims=s.getUint32(8,!0),n+=4):o.numDims=1,s=new DataView(e,n,40),o.numValidPixel=s.getUint32(0,!0),o.microBlockSize=s.getInt32(4,!0),o.blobSize=s.getInt32(8,!0),o.imageType=s.getInt32(12,!0),o.maxZError=s.getFloat64(16,!0),o.zMin=s.getFloat64(24,!0),o.zMax=s.getFloat64(32,!0),n+=40,t.headerInfo=o,t.ptr=n,a>=3&&(r=a>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(e,n-r,o.blobSize-14))!==o.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(e,t){var n=t.headerInfo,i=this.getDataTypeArray(n.imageType),o=n.numDims*this.getDataTypeSize(n.imageType),r=this.readSubArray(e,t.ptr,i,o),s=this.readSubArray(e,t.ptr+o,i,o);t.ptr+=2*o;var a,c=!0;for(a=0;a<n.numDims;a++)if(r[a]!==s[a]){c=!1;break}return n.minValues=r,n.maxValues=s,c},readSubArray:function(e,t,n,i){var o;if(n===Uint8Array)o=new Uint8Array(e,t,i);else{var r=new ArrayBuffer(i);new Uint8Array(r).set(new Uint8Array(e,t,i)),o=new n(r)}return o},readMask:function(e,t){var n,i,o=t.ptr,r=t.headerInfo,s=r.width*r.height,a=r.numValidPixel,c=new DataView(e,o,4),l={};if(l.numBytes=c.getUint32(0,!0),o+=4,(0===a||s===a)&&0!==l.numBytes)throw"invalid mask";if(0===a)n=new Uint8Array(Math.ceil(s/8)),l.bitset=n,i=new Uint8Array(s),t.pixels.resultMask=i,o+=l.numBytes;else if(l.numBytes>0){n=new Uint8Array(Math.ceil(s/8));var u=(c=new DataView(e,o,l.numBytes)).getInt16(0,!0),d=2,h=0,A=0;do{if(u>0)for(;u--;)n[h++]=c.getUint8(d++);else for(A=c.getUint8(d++),u=-u;u--;)n[h++]=A;u=c.getInt16(d,!0),d+=2}while(d<l.numBytes);if(-32768!==u||h<n.length)throw"Unexpected end of mask RLE encoding";i=new Uint8Array(s);var p=0,f=0;for(f=0;f<s;f++)7&f?(p=n[f>>3],p<<=7&f):p=n[f>>3],128&p&&(i[f]=1);t.pixels.resultMask=i,l.bitset=n,o+=l.numBytes}return t.ptr=o,t.mask=l,!0},readDataOneSweep:function(e,t,i){var o,r=t.ptr,s=t.headerInfo,a=s.numDims,c=s.width*s.height,l=s.imageType,u=s.numValidPixel*n.getDataTypeSize(l)*a,d=t.pixels.resultMask;if(i===Uint8Array)o=new Uint8Array(e,r,u);else{var h=new ArrayBuffer(u);new Uint8Array(h).set(new Uint8Array(e,r,u)),o=new i(h)}if(o.length===c*a)t.pixels.resultPixels=o;else{t.pixels.resultPixels=new i(c*a);var A=0,p=0,f=0,m=0;if(a>1)for(f=0;f<a;f++)for(m=f*c,p=0;p<c;p++)d[p]&&(t.pixels.resultPixels[m+p]=o[A++]);else for(p=0;p<c;p++)d[p]&&(t.pixels.resultPixels[p]=o[A++])}return r+=u,t.ptr=r,!0},readHuffmanTree:function(e,t){var o=this.HUFFMAN_LUT_BITS_MAX,r=new DataView(e,t.ptr,16);if(t.ptr+=16,r.getInt32(0,!0)<2)throw"unsupported Huffman version";var s=r.getInt32(4,!0),a=r.getInt32(8,!0),c=r.getInt32(12,!0);if(a>=c)return!1;var l=new Uint32Array(c-a);n.decodeBits(e,t,l);var u,d,h,A,p=[];for(u=a;u<c;u++)p[d=u-(u<s?0:s)]={first:l[u-a],second:null};var f=e.byteLength-t.ptr,m=Math.ceil(f/4),g=new ArrayBuffer(4*m);new Uint8Array(g).set(new Uint8Array(e,t.ptr,f));var _,y=new Uint32Array(g),v=0,T=0;for(_=y[0],u=a;u<c;u++)(A=p[d=u-(u<s?0:s)].first)>0&&(p[d].second=_<<v>>>32-A,32-v>=A?32===(v+=A)&&(v=0,_=y[++T]):(v+=A-32,_=y[++T],p[d].second|=_>>>32-v));var b,w=0,x=new i;for(u=0;u<p.length;u++)void 0!==p[u]&&(w=Math.max(w,p[u].first));b=w>=o?o:w,w>=30&&console.log("WARning, large NUM LUT BITS IS "+w);var C,E,S,I,P,D=[];for(u=a;u<c;u++)if((A=p[d=u-(u<s?0:s)].first)>0)if(C=[A,d],A<=b)for(E=p[d].second<<b-A,S=1<<b-A,h=0;h<S;h++)D[E|h]=C;else for(E=p[d].second,P=x,I=A-1;I>=0;I--)E>>>I&1?(P.right||(P.right=new i),P=P.right):(P.left||(P.left=new i),P=P.left),0!==I||P.val||(P.val=C[1]);return{decodeLut:D,numBitsLUTQick:b,numBitsLUT:w,tree:x,stuffedData:y,srcPtr:T,bitPos:v}},readHuffman:function(e,t,n){var i,o,r,s,a,c,l,u,d,h=t.headerInfo,A=h.numDims,p=t.headerInfo.height,f=t.headerInfo.width,m=f*p,g=this.readHuffmanTree(e,t),_=g.decodeLut,y=g.tree,v=g.stuffedData,T=g.srcPtr,b=g.bitPos,w=g.numBitsLUTQick,x=g.numBitsLUT,C=0===t.headerInfo.imageType?128:0,E=t.pixels.resultMask,S=0;b>0&&(T++,b=0);var I,P=v[T],D=1===t.encodeMode,O=new n(m*A),R=O;for(I=0;I<h.numDims;I++){if(A>1&&(R=new n(O.buffer,m*I,m),S=0),t.headerInfo.numValidPixel===f*p)for(u=0,c=0;c<p;c++)for(l=0;l<f;l++,u++){if(o=0,a=s=P<<b>>>32-w,32-b<w&&(a=s|=v[T+1]>>>64-b-w),_[a])o=_[a][1],b+=_[a][0];else for(a=s=P<<b>>>32-x,32-b<x&&(a=s|=v[T+1]>>>64-b-x),i=y,d=0;d<x;d++)if(!(i=s>>>x-d-1&1?i.right:i.left).left&&!i.right){o=i.val,b=b+d+1;break}b>=32&&(b-=32,P=v[++T]),r=o-C,D?(r+=l>0?S:c>0?R[u-f]:S,r&=255,R[u]=r,S=r):R[u]=r}else for(u=0,c=0;c<p;c++)for(l=0;l<f;l++,u++)if(E[u]){if(o=0,a=s=P<<b>>>32-w,32-b<w&&(a=s|=v[T+1]>>>64-b-w),_[a])o=_[a][1],b+=_[a][0];else for(a=s=P<<b>>>32-x,32-b<x&&(a=s|=v[T+1]>>>64-b-x),i=y,d=0;d<x;d++)if(!(i=s>>>x-d-1&1?i.right:i.left).left&&!i.right){o=i.val,b=b+d+1;break}b>=32&&(b-=32,P=v[++T]),r=o-C,D?(l>0&&E[u-1]?r+=S:c>0&&E[u-f]?r+=R[u-f]:r+=S,r&=255,R[u]=r,S=r):R[u]=r}t.ptr=t.ptr+4*(T+1)+(b>0?4:0)}t.pixels.resultPixels=O},decodeBits:function(n,i,o,r,s){var a=i.headerInfo,c=a.fileVersion,l=0,u=new DataView(n,i.ptr,5),d=u.getUint8(0);l++;var h=d>>6,A=0===h?4:3-h,p=(32&d)>0,f=31&d,m=0;if(1===A)m=u.getUint8(l),l++;else if(2===A)m=u.getUint16(l,!0),l+=2;else{if(4!==A)throw"Invalid valid pixel count type";m=u.getUint32(l,!0),l+=4}var g,_,y,v,T,b,w,x,C,E=2*a.maxZError,S=a.numDims>1?a.maxValues[s]:a.zMax;if(p){for(i.counter.lut++,x=u.getUint8(l),l++,v=Math.ceil((x-1)*f/8),T=Math.ceil(v/4),_=new ArrayBuffer(4*T),y=new Uint8Array(_),i.ptr+=l,y.set(new Uint8Array(n,i.ptr,v)),w=new Uint32Array(_),i.ptr+=v,C=0;x-1>>>C;)C++;v=Math.ceil(m*C/8),T=Math.ceil(v/4),_=new ArrayBuffer(4*T),(y=new Uint8Array(_)).set(new Uint8Array(n,i.ptr,v)),g=new Uint32Array(_),i.ptr+=v,b=c>=3?function(e,t,n,i,o,r){var s,a=(1<<t)-1,c=0,l=0,u=0,d=0,h=0,A=0,p=[],f=Math.ceil((r-i)/o);for(l=0;l<n;l++)0===d&&(s=e[c++],d=32,A=0),d>=t?(h=s>>>A&a,d-=t,A+=t):(h=s>>>A&a,d=32-(u=t-d),h|=((s=e[c++])&(1<<u)-1)<<t-u,A=u),p[l]=h<f?i+h*o:r;return p.unshift(i),p}(w,f,x-1,r,E,S):function(e,t,n,i,o,r){var s,a=(1<<t)-1,c=0,l=0,u=0,d=0,h=0,A=[],p=4*e.length-Math.ceil(t*n/8);e[e.length-1]<<=8*p;var f=Math.ceil((r-i)/o);for(l=0;l<n;l++)0===d&&(s=e[c++],d=32),d>=t?(h=s>>>d-t&a,d-=t):(h=(s&a)<<(u=t-d)&a,h+=(s=e[c++])>>>(d=32-u)),A[l]=h<f?i+h*o:r;return A.unshift(i),A}(w,f,x-1,r,E,S),c>=3?t(g,o,C,m,b):e(g,o,C,m,b)}else i.counter.bitstuffer++,C=f,i.ptr+=l,C>0&&(v=Math.ceil(m*C/8),T=Math.ceil(v/4),_=new ArrayBuffer(4*T),(y=new Uint8Array(_)).set(new Uint8Array(n,i.ptr,v)),g=new Uint32Array(_),i.ptr+=v,c>=3?null==r?function(e,t,n,i){var o,r,s,a,c=(1<<n)-1,l=0,u=0,d=0;for(o=0;o<i;o++)0===u&&(s=e[l++],u=32,d=0),u>=n?(r=s>>>d&c,u-=n,d+=n):(r=s>>>d&c,u=32-(a=n-u),r|=((s=e[l++])&(1<<a)-1)<<n-a,d=a),t[o]=r}(g,o,C,m):t(g,o,C,m,!1,r,E,S):null==r?function(e,t,n,i){var o,r,s,a,c=(1<<n)-1,l=0,u=0,d=4*e.length-Math.ceil(n*i/8);for(e[e.length-1]<<=8*d,o=0;o<i;o++)0===u&&(s=e[l++],u=32),u>=n?(r=s>>>u-n&c,u-=n):(r=(s&c)<<(a=n-u)&c,r+=(s=e[l++])>>>(u=32-a)),t[o]=r}(g,o,C,m):e(g,o,C,m,!1,r,E,S))},readTiles:function(e,t,i){var o=t.headerInfo,r=o.width,s=o.height,a=o.microBlockSize,c=o.imageType,l=n.getDataTypeSize(c),u=Math.ceil(r/a),d=Math.ceil(s/a);t.pixels.numBlocksY=d,t.pixels.numBlocksX=u,t.pixels.ptr=0;var h,A,p,f,m,g,_,y,v=0,T=0,b=0,w=0,x=0,C=0,E=0,S=0,I=0,P=0,D=0,O=0,R=0,M=0,L=0,N=new i(a*a),B=s%a||a,F=r%a||a,U=o.numDims,k=t.pixels.resultMask,V=t.pixels.resultPixels;for(b=0;b<d;b++)for(x=b!==d-1?a:B,w=0;w<u;w++)for(P=b*r*a+w*a,D=r-(C=w!==u-1?a:F),y=0;y<U;y++){if(U>1&&(V=new i(t.pixels.resultPixels.buffer,r*s*y*l,r*s)),E=e.byteLength-t.ptr,A={},L=0,L++,I=(S=(h=new DataView(e,t.ptr,Math.min(10,E))).getUint8(0))>>6&255,(S>>2&15)!=(w*a>>3&15))throw"integrity issue";if((m=3&S)>3)throw t.ptr+=L,"Invalid block encoding ("+m+")";if(2!==m)if(0===m){if(t.counter.uncompressed++,t.ptr+=L,O=(O=x*C*l)<(R=e.byteLength-t.ptr)?O:R,p=new ArrayBuffer(O%l===0?O:O+l-O%l),new Uint8Array(p).set(new Uint8Array(e,t.ptr,O)),f=new i(p),M=0,k)for(v=0;v<x;v++){for(T=0;T<C;T++)k[P]&&(V[P]=f[M++]),P++;P+=D}else for(v=0;v<x;v++){for(T=0;T<C;T++)V[P++]=f[M++];P+=D}t.ptr+=M*l}else if(g=n.getDataTypeUsed(c,I),_=n.getOnePixel(A,L,g,h),L+=n.getDataTypeSize(g),3===m)if(t.ptr+=L,t.counter.constantoffset++,k)for(v=0;v<x;v++){for(T=0;T<C;T++)k[P]&&(V[P]=_),P++;P+=D}else for(v=0;v<x;v++){for(T=0;T<C;T++)V[P++]=_;P+=D}else if(t.ptr+=L,n.decodeBits(e,t,N,_,y),L=0,k)for(v=0;v<x;v++){for(T=0;T<C;T++)k[P]&&(V[P]=N[L++]),P++;P+=D}else for(v=0;v<x;v++){for(T=0;T<C;T++)V[P++]=N[L++];P+=D}else t.counter.constant++,t.ptr+=L}},formatFileInfo:function(e){return{fileIdentifierString:e.headerInfo.fileIdentifierString,fileVersion:e.headerInfo.fileVersion,imageType:e.headerInfo.imageType,height:e.headerInfo.height,width:e.headerInfo.width,numValidPixel:e.headerInfo.numValidPixel,microBlockSize:e.headerInfo.microBlockSize,blobSize:e.headerInfo.blobSize,maxZError:e.headerInfo.maxZError,pixelType:n.getPixelType(e.headerInfo.imageType),eofOffset:e.eofOffset,mask:e.mask?{numBytes:e.mask.numBytes}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,maxValue:e.headerInfo.zMax,minValue:e.headerInfo.zMin,noDataValue:e.noDataValue}}},constructConstantSurface:function(e){var t=e.headerInfo.zMax,n=e.headerInfo.numDims,i=e.headerInfo.height*e.headerInfo.width,o=i*n,r=0,s=0,a=0,c=e.pixels.resultMask;if(c)if(n>1)for(r=0;r<n;r++)for(a=r*i,s=0;s<i;s++)c[s]&&(e.pixels.resultPixels[a+s]=t);else for(s=0;s<i;s++)c[s]&&(e.pixels.resultPixels[s]=t);else if(e.pixels.resultPixels.fill)e.pixels.resultPixels.fill(t);else for(s=0;s<o;s++)e.pixels.resultPixels[s]=t},getDataTypeArray:function(e){var t;switch(e){case 0:t=Int8Array;break;case 1:t=Uint8Array;break;case 2:t=Int16Array;break;case 3:t=Uint16Array;break;case 4:t=Int32Array;break;case 5:t=Uint32Array;break;case 6:default:t=Float32Array;break;case 7:t=Float64Array}return t},getPixelType:function(e){var t;switch(e){case 0:t="S8";break;case 1:t="U8";break;case 2:t="S16";break;case 3:t="U16";break;case 4:t="S32";break;case 5:t="U32";break;case 6:default:t="F32";break;case 7:t="F64"}return t},isValidPixelValue:function(e,t){if(null==t)return!1;var n;switch(e){case 0:n=t>=-128&&t<=127;break;case 1:n=t>=0&&t<=255;break;case 2:n=t>=-32768&&t<=32767;break;case 3:n=t>=0&&t<=65536;break;case 4:n=t>=-2147483648&&t<=2147483647;break;case 5:n=t>=0&&t<=4294967296;break;case 6:n=t>=-34027999387901484e22&&t<=34027999387901484e22;break;case 7:n=t>=5e-324&&t<=17976931348623157e292;break;default:n=!1}return n},getDataTypeSize:function(e){var t=0;switch(e){case 0:case 1:t=1;break;case 2:case 3:t=2;break;case 4:case 5:case 6:t=4;break;case 7:t=8;break;default:t=e}return t},getDataTypeUsed:function(e,t){var n=e;switch(e){case 2:case 4:n=e-t;break;case 3:case 5:n=e-2*t;break;case 6:n=0===t?e:1===t?2:1;break;case 7:n=0===t?e:e-2*t+1;break;default:n=e}return n},getOnePixel:function(e,t,n,i){var o=0;switch(n){case 0:o=i.getInt8(t);break;case 1:o=i.getUint8(t);break;case 2:o=i.getInt16(t,!0);break;case 3:o=i.getUint16(t,!0);break;case 4:o=i.getInt32(t,!0);break;case 5:o=i.getUInt32(t,!0);break;case 6:o=i.getFloat32(t,!0);break;case 7:o=i.getFloat64(t,!0);break;default:throw"the decoder does not understand this pixel type"}return o}},i=function(e,t,n){this.val=e,this.left=t,this.right=n};return{decode:function(e,t){var i=(t=t||{}).noDataValue,o=0,r={};if(r.ptr=t.inputOffset||0,r.pixels={},n.readHeaderInfo(e,r)){var s=r.headerInfo,a=s.fileVersion,c=n.getDataTypeArray(s.imageType);n.readMask(e,r),s.numValidPixel===s.width*s.height||r.pixels.resultMask||(r.pixels.resultMask=t.maskData);var l,u=s.width*s.height;if(r.pixels.resultPixels=new c(u*s.numDims),r.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0},0!==s.numValidPixel)if(s.zMax===s.zMin)n.constructConstantSurface(r);else if(a>=4&&n.checkMinMaxRanges(e,r))n.constructConstantSurface(r);else{var d=new DataView(e,r.ptr,2),h=d.getUint8(0);if(r.ptr++,h)n.readDataOneSweep(e,r,c);else if(a>1&&s.imageType<=1&&Math.abs(s.maxZError-.5)<1e-5){var A=d.getUint8(1);if(r.ptr++,r.encodeMode=A,A>2||a<4&&A>1)throw"Invalid Huffman flag "+A;A?n.readHuffman(e,r,c):n.readTiles(e,r,c)}else n.readTiles(e,r,c)}r.eofOffset=r.ptr,t.inputOffset?(l=r.headerInfo.blobSize+t.inputOffset-r.ptr,Math.abs(l)>=1&&(r.eofOffset=t.inputOffset+r.headerInfo.blobSize)):(l=r.headerInfo.blobSize-r.ptr,Math.abs(l)>=1&&(r.eofOffset=r.headerInfo.blobSize));var p={width:s.width,height:s.height,pixelData:r.pixels.resultPixels,minValue:s.zMin,maxValue:s.zMax,validPixelCount:s.numValidPixel,dimCount:s.numDims,dimStats:{minValues:s.minValues,maxValues:s.maxValues},maskData:r.pixels.resultMask};if(r.pixels.resultMask&&n.isValidPixelValue(s.imageType,i)){var f=r.pixels.resultMask;for(o=0;o<u;o++)f[o]||(p.pixelData[o]=i);p.noDataValue=i}return r.noDataValue=i,t.returnFileInfo&&(p.fileInfo=n.formatFileInfo(r)),p}},getBandCount:function(e){for(var t=0,i=0,o={ptr:0,pixels:{}};i<e.byteLength-58;)n.readHeaderInfo(e,o),i+=o.headerInfo.blobSize,t++,o.ptr=i;return t}}}(),l=new ArrayBuffer(4),u=new Uint8Array(l),new Uint32Array(l)[0]=1,A=1===u[0],p={decode:function(e,t){if(!A)throw"Big endian system is not supported.";var n,i,o=(t=t||{}).inputOffset||0,r=new Uint8Array(e,o,10),s=String.fromCharCode.apply(null,r);if("CntZImage"===s.trim())n=d,i=1;else{if("Lerc2"!==s.substring(0,5))throw"Unexpected file identifier string: "+s;n=h,i=2}for(var a,c,l,u,p,f,m=0,g=e.byteLength-10,_=[],y={width:0,height:0,pixels:[],pixelType:t.pixelType,mask:null,statistics:[]};o<g;){var v=n.decode(e,{inputOffset:o,encodedMaskData:a,maskData:l,returnMask:0===m,returnEncodedMask:0===m,returnFileInfo:!0,pixelType:t.pixelType||null,noDataValue:t.noDataValue||null});o=v.fileInfo.eofOffset,0===m&&(a=v.encodedMaskData,l=v.maskData,y.width=v.width,y.height=v.height,y.dimCount=v.dimCount||1,y.pixelType=v.pixelType||v.fileInfo.pixelType,y.mask=v.maskData),i>1&&v.fileInfo.mask&&v.fileInfo.mask.numBytes>0&&_.push(v.maskData),m++,y.pixels.push(v.pixelData),y.statistics.push({minValue:v.minValue,maxValue:v.maxValue,noDataValue:v.noDataValue,dimStats:v.dimStats})}if(i>1&&_.length>1){for(f=y.width*y.height,y.bandMasks=_,(l=new Uint8Array(f)).set(_[0]),u=1;u<_.length;u++)for(c=_[u],p=0;p<f;p++)l[p]=l[p]&c[p];y.maskData=l}return y}},void 0===(n=function(){return p}.apply(t,[]))||(e.exports=n)},957171:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;module=__webpack_require__.nmd(module),function(undefined){"use strict";var modules,cache,entries,protobuf;modules={1:[function(e,t,n){t.exports=function(e,t){for(var n=new Array(arguments.length-1),i=0,o=2,r=!0;o<arguments.length;)n[i++]=arguments[o++];return new Promise(function(o,s){n[i]=function(e){if(r)if(r=!1,e)s(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];o.apply(null,t)}};try{e.apply(t||null,n)}catch(e){r&&(r=!1,s(e))}})}},{}],2:[function(e,t,n){var i=n;i.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var o=new Array(64),r=new Array(123),s=0;s<64;)r[o[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;i.encode=function(e,t,n){for(var i,r=null,s=[],a=0,c=0;t<n;){var l=e[t++];switch(c){case 0:s[a++]=o[l>>2],i=(3&l)<<4,c=1;break;case 1:s[a++]=o[i|l>>4],i=(15&l)<<2,c=2;break;case 2:s[a++]=o[i|l>>6],s[a++]=o[63&l],c=0}a>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=o[i],s[a++]=61,1===c&&(s[a++]=61)),r?(a&&r.push(String.fromCharCode.apply(String,s.slice(0,a))),r.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var a="invalid encoding";i.decode=function(e,t,n){for(var i,o=n,s=0,c=0;c<e.length;){var l=e.charCodeAt(c++);if(61===l&&s>1)break;if((l=r[l])===undefined)throw Error(a);switch(s){case 0:i=l,s=1;break;case 1:t[n++]=i<<2|(48&l)>>4,i=l,s=2;break;case 2:t[n++]=(15&i)<<4|(60&l)>>2,i=l,s=3;break;case 3:t[n++]=(3&i)<<6|l,s=0}}if(1===s)throw Error(a);return n-o},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},{}],3:[function(e,t,n){function i(){this._listeners={}}t.exports=i,i.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},i.prototype.off=function(e,t){if(e===undefined)this._listeners={};else if(t===undefined)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this},i.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this}},{}],4:[function(e,t,n){function i(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),i=128===n[3];function o(e,i,o){t[0]=e,i[o]=n[0],i[o+1]=n[1],i[o+2]=n[2],i[o+3]=n[3]}function r(e,i,o){t[0]=e,i[o]=n[3],i[o+1]=n[2],i[o+2]=n[1],i[o+3]=n[0]}function s(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],t[0]}function a(e,i){return n[3]=e[i],n[2]=e[i+1],n[1]=e[i+2],n[0]=e[i+3],t[0]}e.writeFloatLE=i?o:r,e.writeFloatBE=i?r:o,e.readFloatLE=i?s:a,e.readFloatBE=i?a:s}():function(){function t(e,t,n,i){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,n,i);else if(isNaN(t))e(2143289344,n,i);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,n,i);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,n,i);else{var r=Math.floor(Math.log(t)/Math.LN2);e((o<<31|r+127<<23|8388607&Math.round(t*Math.pow(2,-r)*8388608))>>>0,n,i)}}function n(e,t,n){var i=e(t,n),o=2*(i>>31)+1,r=i>>>23&255,s=8388607&i;return 255===r?s?NaN:o*(1/0):0===r?1401298464324817e-60*o*s:o*Math.pow(2,r-150)*(s+8388608)}e.writeFloatLE=t.bind(null,o),e.writeFloatBE=t.bind(null,r),e.readFloatLE=n.bind(null,s),e.readFloatBE=n.bind(null,a)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),i=128===n[7];function o(e,i,o){t[0]=e,i[o]=n[0],i[o+1]=n[1],i[o+2]=n[2],i[o+3]=n[3],i[o+4]=n[4],i[o+5]=n[5],i[o+6]=n[6],i[o+7]=n[7]}function r(e,i,o){t[0]=e,i[o]=n[7],i[o+1]=n[6],i[o+2]=n[5],i[o+3]=n[4],i[o+4]=n[3],i[o+5]=n[2],i[o+6]=n[1],i[o+7]=n[0]}function s(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],n[4]=e[i+4],n[5]=e[i+5],n[6]=e[i+6],n[7]=e[i+7],t[0]}function a(e,i){return n[7]=e[i],n[6]=e[i+1],n[5]=e[i+2],n[4]=e[i+3],n[3]=e[i+4],n[2]=e[i+5],n[1]=e[i+6],n[0]=e[i+7],t[0]}e.writeDoubleLE=i?o:r,e.writeDoubleBE=i?r:o,e.readDoubleLE=i?s:a,e.readDoubleBE=i?a:s}():function(){function t(e,t,n,i,o,r){var s=i<0?1:0;if(s&&(i=-i),0===i)e(0,o,r+t),e(1/i>0?0:2147483648,o,r+n);else if(isNaN(i))e(0,o,r+t),e(2146959360,o,r+n);else if(i>17976931348623157e292)e(0,o,r+t),e((s<<31|2146435072)>>>0,o,r+n);else{var a;if(i<22250738585072014e-324)e((a=i/5e-324)>>>0,o,r+t),e((s<<31|a/4294967296)>>>0,o,r+n);else{var c=Math.floor(Math.log(i)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=i*Math.pow(2,-c))>>>0,o,r+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,o,r+n)}}}function n(e,t,n,i,o){var r=e(i,o+t),s=e(i,o+n),a=2*(s>>31)+1,c=s>>>20&2047,l=4294967296*(1048575&s)+r;return 2047===c?l?NaN:a*(1/0):0===c?5e-324*a*l:a*Math.pow(2,c-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,o,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=n.bind(null,s,0,4),e.readDoubleBE=n.bind(null,a,4,0)}(),e}function o(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function r(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}t.exports=i(i)},{}],5:[function(require,module,exports){function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},{}],6:[function(e,t,n){t.exports=function(e,t,n){var i=n||8192,o=i>>>1,r=null,s=i;return function(n){if(n<1||n>o)return e(n);s+n>i&&(r=e(i),s=0);var a=t.call(r,s,s+=n);return 7&s&&(s=1+(7|s)),a}}},{}],7:[function(e,t,n){var i=n;i.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)(n=e.charCodeAt(i))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},i.read=function(e,t,n){if(n-t<1)return"";for(var i,o=null,r=[],s=0;t<n;)(i=e[t++])<128?r[s++]=i:i>191&&i<224?r[s++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,r[s++]=55296+(i>>10),r[s++]=56320+(1023&i)):r[s++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,r)),s=0);return o?(s&&o.push(String.fromCharCode.apply(String,r.slice(0,s))),o.join("")):String.fromCharCode.apply(String,r.slice(0,s))},i.write=function(e,t,n){for(var i,o,r=n,s=0;s<e.length;++s)(i=e.charCodeAt(s))<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&56320==(64512&(o=e.charCodeAt(s+1)))?(i=65536+((1023&i)<<10)+(1023&o),++s,t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128);return n-r}},{}],8:[function(e,t,n){var i=n;function o(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}i.build="minimal",i.Writer=e(16),i.BufferWriter=e(17),i.Reader=e(9),i.BufferReader=e(10),i.util=e(15),i.rpc=e(12),i.roots=e(11),i.configure=o,o()},{10:10,11:11,12:12,15:15,16:16,17:17,9:9}],9:[function(e,t,n){t.exports=c;var i,o=e(15),r=o.LongBits,s=o.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l,u="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},d=function(){return o.Buffer?function(e){return(c.create=function(e){return o.Buffer.isBuffer(e)?new i(e):u(e)})(e)}:u};function h(){var e=new r(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function A(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new r(A(this.buf,this.pos+=4),A(this.buf,this.pos+=4))}c.create=d(),c.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,c.prototype.uint32=(l=4294967295,function(){if(l=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return l;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return l}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return A(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|A(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,n);if(t===n){var i=o.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){i=e,c.create=d(),i._configure();var t=o.Long?"toLong":"toNumber";o.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},{15:15}],10:[function(e,t,n){t.exports=r;var i=e(9);(r.prototype=Object.create(i.prototype)).constructor=r;var o=e(15);function r(e){i.call(this,e)}r._configure=function(){o.Buffer&&(r.prototype._slice=o.Buffer.prototype.slice)},r.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},r._configure()},{15:15,9:9}],11:[function(e,t,n){t.exports={}},{}],12:[function(e,t,n){n.Service=e(13)},{13:13}],13:[function(e,t,n){t.exports=o;var i=e(15);function o(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(o.prototype=Object.create(i.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function e(t,n,o,r,s){if(!r)throw TypeError("request must be specified");var a=this;if(!s)return i.asPromise(e,a,t,n,o,r);if(!a.rpcImpl)return setTimeout(function(){s(Error("already ended"))},0),undefined;try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](r).finish(),function(e,n){if(e)return a.emit("error",e,t),s(e);if(null===n)return a.end(!0),undefined;if(!(n instanceof o))try{n=o[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",n,t),s(null,n)})}catch(e){return a.emit("error",e,t),setTimeout(function(){s(e)},0),undefined}},o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},{15:15}],14:[function(e,t,n){t.exports=o;var i=e(15);function o(e,t){this.lo=e>>>0,this.hi=t>>>0}var r=o.zero=new o(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1};var s=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(e){if(0===e)return r;var t=e<0;t&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new o(n,i)},o.from=function(e){if("number"==typeof e)return o.fromNumber(e);if(i.isString(e)){if(!i.Long)return o.fromNumber(parseInt(e,10));e=i.Long.fromString(e)}return e.low||e.high?new o(e.low>>>0,e.high>>>0):r},o.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(e){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;o.fromHash=function(e){return e===s?r:new o((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},o.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},o.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},{15:15}],15:[function(e,t,n){var i=n;function o(e,t,n){for(var i=Object.keys(t),o=0;o<i.length;++o)e[i[o]]!==undefined&&n||(e[i[o]]=t[i[o]]);return e}function r(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&o(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:undefined,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}i.asPromise=e(1),i.base64=e(2),i.EventEmitter=e(3),i.float=e(4),i.inquire=e(5),i.utf8=e(7),i.pool=e(6),i.LongBits=e(14),i.isNode=Boolean(void 0!==__webpack_require__.g&&__webpack_require__.g&&__webpack_require__.g.process&&__webpack_require__.g.process.versions&&__webpack_require__.g.process.versions.node),i.global=i.isNode&&__webpack_require__.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},i.isString=function(e){return"string"==typeof e||e instanceof String},i.isObject=function(e){return e&&"object"==typeof e},i.isset=i.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},i.Buffer=function(){try{var e=i.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(e){return"number"==typeof e?i.Buffer?i._Buffer_allocUnsafe(e):new i.Array(e):i.Buffer?i._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},i.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(e){return e?i.LongBits.from(e).toHash():i.LongBits.zeroHash},i.longFromHash=function(e,t){var n=i.LongBits.fromHash(e);return i.Long?i.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},i.merge=o,i.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},i.newError=r,i.ProtocolError=r("ProtocolError"),i.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&this[e[n]]!==undefined&&null!==this[e[n]])return e[n]}},i.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var e=i.Buffer;e?(i._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},i._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):i._Buffer_from=i._Buffer_allocUnsafe=null}},{1:1,14:14,2:2,3:3,4:4,5:5,6:6,7:7}],16:[function(e,t,n){t.exports=d;var i,o=e(15),r=o.LongBits,s=o.base64,a=o.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=undefined,this.val=n}function l(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var h=function(){return o.Buffer?function(){return(d.create=function(){return new i})()}:function(){return new d}};function A(e,t,n){t[n]=255&e}function p(e,t){this.len=e,this.next=undefined,this.val=t}function f(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function m(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}d.create=h(),d.alloc=function(e){return new o.Array(e)},o.Array!==Array&&(d.alloc=o.pool(d.alloc,o.Array.prototype.subarray)),d.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},p.prototype=Object.create(c.prototype),p.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(f,10,r.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=r.from(e);return this._push(f,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=r.from(e).zzEncode();return this._push(f,t.length(),t)},d.prototype.bool=function(e){return this._push(A,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(m,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=r.from(e);return this._push(m,4,t.lo)._push(m,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(o.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(o.float.writeDoubleLE,8,e)};var g=o.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(A,1,0);if(o.isString(e)){var n=d.alloc(t=s.length(e));s.decode(e,n,0),e=n}return this.uint32(t)._push(g,t,e)},d.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(A,1,0)},d.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},d._configure=function(e){i=e,d.create=h(),i._configure()}},{15:15}],17:[function(e,t,n){t.exports=r;var i=e(16);(r.prototype=Object.create(i.prototype)).constructor=r;var o=e(15);function r(){i.call(this)}function s(e,t,n){e.length<40?o.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}r._configure=function(){r.alloc=o._Buffer_allocUnsafe,r.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&"set"===o.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]}},r.prototype.bytes=function(e){o.isString(e)&&(e=o._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(r.writeBytesBuffer,t,e),this},r.prototype.string=function(e){var t=o.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},r._configure()},{15:15,16:16}]},cache={},entries=[8],protobuf=function e(t){var n=cache[t];return n||modules[t][0].call(n=cache[t]={exports:{}},e,n,n.exports),n.exports}(entries[0]),protobuf.util.global.protobuf=protobuf,__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(935017)],(__WEBPACK_AMD_DEFINE_RESULT__=function(e){return e&&e.isLong&&(protobuf.util.Long=e,protobuf.configure()),protobuf}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))===undefined||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__),module&&module.exports&&(module.exports=protobuf)}()},789344:(e,t,n)=>{"use strict";function i(e){return e}function o(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return r(e,t)})}:r(e,t)}function r(e,t){var n=t.id,o=t.bbox,r=null==t.properties?{}:t.properties,s=function(e,t){var n=function(e){if(null==e)return i;var t,n,o=e.scale[0],r=e.scale[1],s=e.translate[0],a=e.translate[1];return function(e,i){i||(t=n=0);var c=2,l=e.length,u=new Array(l);for(u[0]=(t+=e[0])*o+s,u[1]=(n+=e[1])*r+a;c<l;)u[c]=e[c],++c;return u}}(e.transform),o=e.arcs;function r(e,t){t.length&&t.pop();for(var i=o[e<0?~e:e],r=0,s=i.length;r<s;++r)t.push(n(i[r],r));e<0&&function(e,t){for(var n,i=e.length,o=i-t;o<--i;)n=e[o],e[o++]=e[i],e[i]=n}(t,s)}function s(e){return n(e)}function a(e){for(var t=[],n=0,i=e.length;n<i;++n)r(e[n],t);return t.length<2&&t.push(t[0]),t}function c(e){for(var t=a(e);t.length<4;)t.push(t[0]);return t}function l(e){return e.map(c)}return function e(t){var n,i=t.type;switch(i){case"GeometryCollection":return{type:i,geometries:t.geometries.map(e)};case"Point":n=s(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(s);break;case"LineString":n=a(t.arcs);break;case"MultiLineString":n=t.arcs.map(a);break;case"Polygon":n=l(t.arcs);break;case"MultiPolygon":n=t.arcs.map(l);break;default:return null}return{type:i,coordinates:n}}(t)}(e,t);return null==n&&null==o?{type:"Feature",properties:r,geometry:s}:null==o?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:o,properties:r,geometry:s}}n.d(t,{A:()=>o})},935017:function(e,t){var n;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,n=function(){var e={};return function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function i(e){return!0===(e&&e.__isLong__)}function o(e){var t=Math.clz32(e&-e);return e?31-t:t}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=i;var r={},s={};function a(e,t){var n,i,o;return t?(o=0<=(e>>>=0)&&e<256)&&(i=s[e])?i:(n=l(e,0,!0),o&&(s[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(i=r[e])?i:(n=l(e,e<0?-1:0,!1),o&&(r[e]=n),n)}function c(e,t){if(isNaN(e))return t?_:g;if(t){if(e<0)return _;if(e>=p)return w}else{if(e<=-f)return x;if(e+1>=f)return b}return e<0?c(-e,t).neg():l(e%A|0,e/A|0,t)}function l(e,t,i){return new n(e,t,i)}n.fromInt=a,n.fromNumber=c,n.fromBits=l;var u=Math.pow;function d(e,t,n){if(0===e.length)throw Error("empty string");if("number"==typeof t?(n=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?_:g;if((n=n||10)<2||36<n)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return d(e.substring(1),t,n).neg();for(var o=c(u(n,8)),r=g,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),l=parseInt(e.substring(s,s+a),n);if(a<8){var h=c(u(n,a));r=r.mul(h).add(c(l))}else r=(r=r.mul(o)).add(c(l))}return r.unsigned=t,r}function h(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?d(e,t):l(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}n.fromString=d,n.fromValue=h;var A=4294967296,p=A*A,f=p/2,m=a(1<<24),g=a(0);n.ZERO=g;var _=a(0,!0);n.UZERO=_;var y=a(1);n.ONE=y;var v=a(1,!0);n.UONE=v;var T=a(-1);n.NEG_ONE=T;var b=l(-1,2147483647,!1);n.MAX_VALUE=b;var w=l(-1,-1,!0);n.MAX_UNSIGNED_VALUE=w;var x=l(0,-2147483648,!1);n.MIN_VALUE=x;var C=n.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*A+(this.low>>>0):this.high*A+(this.low>>>0)},C.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(x)){var t=c(e),n=this.div(t),i=n.mul(t).sub(this);return n.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=c(u(e,6),this.unsigned),r=this,s="";;){var a=r.div(o),l=(r.sub(a.mul(o)).toInt()>>>0).toString(e);if((r=a).isZero())return l+s;for(;l.length<6;)l="0"+l;s=""+l+s}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(x)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},C.isSafeInteger=function(){var e=this.high>>21;return!e||!this.unsigned&&-1===e&&!(0===this.low&&-2097152===this.high)},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return!(1&~this.low)},C.isEven=function(){return!(1&this.low)},C.equals=function(e){return i(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(e){return this.comp(e)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return this.comp(e)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(e){if(i(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(x)?x:this.not().add(y)},C.neg=C.negate,C.add=function(e){i(e)||(e=h(e));var t=this.high>>>16,n=65535&this.high,o=this.low>>>16,r=65535&this.low,s=e.high>>>16,a=65535&e.high,c=e.low>>>16,u=0,d=0,A=0,p=0;return A+=(p+=r+(65535&e.low))>>>16,d+=(A+=o+c)>>>16,u+=(d+=n+a)>>>16,u+=t+s,l((A&=65535)<<16|(p&=65535),(u&=65535)<<16|(d&=65535),this.unsigned)},C.subtract=function(e){return i(e)||(e=h(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){if(this.isZero())return this;if(i(e)||(e=h(e)),t)return l(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return this.unsigned?_:g;if(this.eq(x))return e.isOdd()?x:g;if(e.eq(x))return this.isOdd()?x:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return c(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,o=65535&this.high,r=this.low>>>16,s=65535&this.low,a=e.high>>>16,u=65535&e.high,d=e.low>>>16,A=65535&e.low,p=0,f=0,y=0,v=0;return y+=(v+=s*A)>>>16,f+=(y+=r*A)>>>16,y&=65535,f+=(y+=s*d)>>>16,p+=(f+=o*A)>>>16,f&=65535,p+=(f+=r*d)>>>16,f&=65535,p+=(f+=s*u)>>>16,p+=n*A+o*d+r*u+s*a,l((y&=65535)<<16|(v&=65535),(p&=65535)<<16|(f&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(e){if(i(e)||(e=h(e)),e.isZero())throw Error("division by zero");var n,o,r;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?_:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return _;if(e.gt(this.shru(1)))return v;r=_}else{if(this.eq(x))return e.eq(y)||e.eq(T)?x:e.eq(x)?y:(n=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?y:T:(o=this.sub(e.mul(n)),r=n.add(o.div(e)));if(e.eq(x))return this.unsigned?_:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=g}for(o=this;o.gte(e);){n=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),a=s<=48?1:u(2,s-48),d=c(n),A=d.mul(e);A.isNegative()||A.gt(o);)A=(d=c(n-=a,this.unsigned)).mul(e);d.isZero()&&(d=y),r=r.add(d),o=o.sub(A)}return r},C.div=C.divide,C.modulo=function(e){return i(e)||(e=h(e)),t?l((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return l(~this.low,~this.high,this.unsigned)},C.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},C.clz=C.countLeadingZeros,C.countTrailingZeros=function(){return this.low?o(this.low):o(this.high)+32},C.ctz=C.countTrailingZeros,C.and=function(e){return i(e)||(e=h(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return i(e)||(e=h(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return i(e)||(e=h(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):l(32===e?this.high:this.high>>>e-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.rotateLeft=function(e){var t;return i(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?l(this.high,this.low,this.unsigned):e<32?(t=32-e,l(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),l(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},C.rotl=C.rotateLeft,C.rotateRight=function(e){var t;return i(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?l(this.high,this.low,this.unsigned):e<32?(t=32-e,l(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),l(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},C.rotr=C.rotateRight,C.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,i){return i?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},"function"==typeof BigInt&&(n.fromBigInt=function(e,t){return l(Number(BigInt.asIntN(32,e)),Number(BigInt.asIntN(32,e>>BigInt(32))),t)},n.fromValue=function(e,t){return"bigint"==typeof e?n.fromBigInt(e,t):h(e,t)},C.toBigInt=function(){var e=BigInt(this.low>>>0);return BigInt(this.unsigned?this.high>>>0:this.high)<<BigInt(32)|e}),e.default=n}(e),function(e){return e.default||e}(e)}.apply(t,[]),void 0===n||(e.exports=n)},794282:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({XTRANSLATE:"xTranslate",YTRANSLATE:"yTranslate",ZTRANSLATE:"zTranslate",XROTATE:"xRotate",YROTATE:"yRotate",ZROTATE:"zRotate",XSCALE:"xScale",YSCALE:"yScale",ZSCALE:"zScale",UNIFORMSCALE:"uniformScale"})},854894:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var i=n(660662),o=n(267980),r=n(369031),s=n(571804),a=n(915325),c=n(491446),l=n(605971),u=n(944479),d=n(305439),h=n(46362),A=n(794554),p=n(402330);const f=new o.A;function m(e){const t=(e=e??a.A.EMPTY_OBJECT).minimum,n=e.maximum;if(r.A.typeOf.object("min",t),r.A.typeOf.object("max",n),(0,c.A)(e.offsetAttribute)&&e.offsetAttribute===A.A.TOP)throw new l.A("GeometryOffsetAttribute.TOP is not a supported options.offsetAttribute for this geometry.");this._min=o.A.clone(t),this._max=o.A.clone(n),this._offsetAttribute=e.offsetAttribute,this._workerName="createBoxOutlineGeometry"}m.fromDimensions=function(e){const t=(e=e??a.A.EMPTY_OBJECT).dimensions;r.A.typeOf.object("dimensions",t),r.A.typeOf.number.greaterThanOrEquals("dimensions.x",t.x,0),r.A.typeOf.number.greaterThanOrEquals("dimensions.y",t.y,0),r.A.typeOf.number.greaterThanOrEquals("dimensions.z",t.z,0);const n=o.A.multiplyByScalar(t,.5,new o.A);return new m({minimum:o.A.negate(n,new o.A),maximum:n,offsetAttribute:e.offsetAttribute})},m.fromAxisAlignedBoundingBox=function(e){return r.A.typeOf.object("boundindBox",e),new m({minimum:e.minimum,maximum:e.maximum})},m.packedLength=2*o.A.packedLength+1,m.pack=function(e,t,n){return r.A.typeOf.object("value",e),r.A.defined("array",t),n=n??0,o.A.pack(e._min,t,n),o.A.pack(e._max,t,n+o.A.packedLength),t[n+2*o.A.packedLength]=e._offsetAttribute??-1,t};const g=new o.A,_=new o.A,y={minimum:g,maximum:_,offsetAttribute:void 0};m.unpack=function(e,t,n){r.A.defined("array",e),t=t??0;const i=o.A.unpack(e,t,g),s=o.A.unpack(e,t+o.A.packedLength,_),a=e[t+2*o.A.packedLength];return(0,c.A)(n)?(n._min=o.A.clone(i,n._min),n._max=o.A.clone(s,n._max),n._offsetAttribute=-1===a?void 0:a,n):(y.offsetAttribute=-1===a?void 0:a,new m(y))},m.createGeometry=function(e){const t=e._min,n=e._max;if(o.A.equals(t,n))return;const r=new h.A,a=new Uint16Array(24),l=new Float64Array(24);l[0]=t.x,l[1]=t.y,l[2]=t.z,l[3]=n.x,l[4]=t.y,l[5]=t.z,l[6]=n.x,l[7]=n.y,l[8]=t.z,l[9]=t.x,l[10]=n.y,l[11]=t.z,l[12]=t.x,l[13]=t.y,l[14]=n.z,l[15]=n.x,l[16]=t.y,l[17]=n.z,l[18]=n.x,l[19]=n.y,l[20]=n.z,l[21]=t.x,l[22]=n.y,l[23]=n.z,r.position=new d.A({componentDatatype:s.A.DOUBLE,componentsPerAttribute:3,values:l}),a[0]=4,a[1]=5,a[2]=5,a[3]=6,a[4]=6,a[5]=7,a[6]=7,a[7]=4,a[8]=0,a[9]=1,a[10]=1,a[11]=2,a[12]=2,a[13]=3,a[14]=3,a[15]=0,a[16]=0,a[17]=4,a[18]=1,a[19]=5,a[20]=2,a[21]=6,a[22]=3,a[23]=7;const m=o.A.subtract(n,t,f),g=.5*o.A.magnitude(m);if((0,c.A)(e._offsetAttribute)){const t=l.length,n=e._offsetAttribute===A.A.NONE?0:1,i=new Uint8Array(t/3).fill(n);r.applyOffset=new d.A({componentDatatype:s.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}return new u.A({attributes:r,indices:a,primitiveType:p.A.LINES,boundingSphere:new i.A(o.A.ZERO,g),offsetAttribute:e._offsetAttribute})};const v=m},931806:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(369031),o=n(605971),r=n(437266);function s(e){this._value=e,this._valueType=r.A.getPointType(e)}Object.defineProperties(s.prototype,{value:{get:function(){return this._value}}}),s.prototype.findTimeInterval=function(e){throw new o.A("findTimeInterval cannot be called on a ConstantSpline.")},s.prototype.wrapTime=function(e){return i.A.typeOf.number("time",e),0},s.prototype.clampTime=function(e){return i.A.typeOf.number("time",e),0},s.prototype.evaluate=function(e,t){i.A.typeOf.number("time",e);const n=this._value,o=this._valueType;return o===Number?n:o.clone(n,t)};const a=s},246520:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var i=n(434067),o=n(267980),r=n(369031),s=n(331185),a=n(832698);const c={},l=new o.A,u=new o.A,d=new o.A,h=new o.A,A=new a.A;function p(e,t,n,r,s){const a=o.A.subtract(e,t,l),c=o.A.dot(n,a),u=o.A.dot(r,a);return i.A.fromElements(c,u,s)}c.validOutline=function(e){r.A.defined("positions",e);const t=a.A.fromPoints(e,A).halfAxes,n=s.A.getColumn(t,0,u),i=s.A.getColumn(t,1,d),c=s.A.getColumn(t,2,h),l=o.A.magnitude(n),p=o.A.magnitude(i),f=o.A.magnitude(c);return!(0===l&&(0===p||0===f)||0===p&&0===f)},c.computeProjectTo2DArguments=function(e,t,n,i){r.A.defined("positions",e),r.A.defined("centerResult",t),r.A.defined("planeAxis1Result",n),r.A.defined("planeAxis2Result",i);const c=a.A.fromPoints(e,A),l=c.halfAxes,p=s.A.getColumn(l,0,u),f=s.A.getColumn(l,1,d),m=s.A.getColumn(l,2,h),g=o.A.magnitude(p),_=o.A.magnitude(f),y=o.A.magnitude(m),v=Math.min(g,_,y);if(0===g&&(0===_||0===y)||0===_&&0===y)return!1;let T,b;return v!==_&&v!==y||(T=p),v===g?T=f:v===y&&(b=f),v!==g&&v!==_||(b=m),o.A.normalize(T,n),o.A.normalize(b,i),o.A.clone(c.center,t),!0},c.createProjectPointsTo2DFunction=function(e,t,n){return function(i){const o=new Array(i.length);for(let r=0;r<i.length;r++)o[r]=p(i[r],e,t,n);return o}},c.createProjectPointTo2DFunction=function(e,t,n){return function(i,o){return p(i,e,t,n,o)}};const f=c},173885:(e,t,n)=>{"use strict";n.d(t,{A:()=>b});var i=n(263604),o=n(660662),r=n(267980),s=n(369031),a=n(571804),c=n(246520),l=n(915325),u=n(491446),d=n(944479),h=n(305439),A=n(46362),p=n(75200),f=n(34233),m=n(874915),g=n(71694),_=n(402330);function y(e){const t=e.length,n=new Float64Array(3*t),i=m.A.createTypedArray(t,2*t);let o=0,r=0;for(let s=0;s<t;s++){const a=e[s];n[o++]=a.x,n[o++]=a.y,n[o++]=a.z,i[r++]=s,i[r++]=(s+1)%t}const s=new A.A({position:new h.A({componentDatatype:a.A.DOUBLE,componentsPerAttribute:3,values:n})});return new d.A({attributes:s,indices:i,primitiveType:_.A.LINES})}function v(e){const t=(e=e??l.A.EMPTY_OBJECT).polygonHierarchy;s.A.defined("options.polygonHierarchy",t),this._polygonHierarchy=t,this._workerName="createCoplanarPolygonOutlineGeometry",this.packedLength=g.A.computeHierarchyPackedLength(t,r.A)+1}v.fromPositions=function(e){return e=e??l.A.EMPTY_OBJECT,s.A.defined("options.positions",e.positions),new v({polygonHierarchy:{positions:e.positions}})},v.pack=function(e,t,n){return s.A.typeOf.object("value",e),s.A.defined("array",t),n=n??0,t[n=g.A.packPolygonHierarchy(e._polygonHierarchy,t,n,r.A)]=e.packedLength,t};const T={polygonHierarchy:{}};v.unpack=function(e,t,n){s.A.defined("array",e),t=t??0;const i=g.A.unpackPolygonHierarchy(e,t,r.A);t=i.startingIndex,delete i.startingIndex;const o=e[t];return(0,u.A)(n)||(n=new v(T)),n._polygonHierarchy=i,n.packedLength=o,n},v.createGeometry=function(e){const t=e._polygonHierarchy;let n=t.positions;if(n=(0,i.A)(n,r.A.equalsEpsilon,!0),n.length<3)return;if(!c.A.validOutline(n))return;const s=g.A.polygonOutlinesFromHierarchy(t,!1);if(0===s.length)return;const a=[];for(let e=0;e<s.length;e++){const t=new p.A({geometry:y(s[e])});a.push(t)}const l=f.A.combineInstances(a)[0],u=o.A.fromPoints(t.positions);return new d.A({attributes:l.attributes,indices:l.indices,primitiveType:l.primitiveType,boundingSphere:u})};const b=v},317061:(e,t,n)=>{"use strict";n.d(t,{A:()=>I});var i=n(660662),o=n(434067),r=n(267980),s=n(571804),a=n(302982),c=n(915325),l=n(491446),u=n(605971),d=n(944479),h=n(305439),A=n(46362),p=n(794554),f=n(874915),m=n(367817),g=n(402330),_=n(769534);const y=new o.A,v=new r.A,T=new r.A,b=new r.A,w=new r.A;function x(e){const t=(e=e??c.A.EMPTY_OBJECT).length,n=e.topRadius,i=e.bottomRadius,o=e.vertexFormat??_.A.DEFAULT,r=e.slices??128;if(!(0,l.A)(t))throw new u.A("options.length must be defined.");if(!(0,l.A)(n))throw new u.A("options.topRadius must be defined.");if(!(0,l.A)(i))throw new u.A("options.bottomRadius must be defined.");if(r<3)throw new u.A("options.slices must be greater than or equal to 3.");if((0,l.A)(e.offsetAttribute)&&e.offsetAttribute===p.A.TOP)throw new u.A("GeometryOffsetAttribute.TOP is not a supported options.offsetAttribute for this geometry.");this._length=t,this._topRadius=n,this._bottomRadius=i,this._vertexFormat=_.A.clone(o),this._slices=r,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderGeometry"}x.packedLength=_.A.packedLength+5,x.pack=function(e,t,n){if(!(0,l.A)(e))throw new u.A("value is required");if(!(0,l.A)(t))throw new u.A("array is required");return n=n??0,_.A.pack(e._vertexFormat,t,n),n+=_.A.packedLength,t[n++]=e._length,t[n++]=e._topRadius,t[n++]=e._bottomRadius,t[n++]=e._slices,t[n]=e._offsetAttribute??-1,t};const C=new _.A,E={vertexFormat:C,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};let S;x.unpack=function(e,t,n){if(!(0,l.A)(e))throw new u.A("array is required");t=t??0;const i=_.A.unpack(e,t,C);t+=_.A.packedLength;const o=e[t++],r=e[t++],s=e[t++],a=e[t++],c=e[t];return(0,l.A)(n)?(n._vertexFormat=_.A.clone(i,n._vertexFormat),n._length=o,n._topRadius=r,n._bottomRadius=s,n._slices=a,n._offsetAttribute=-1===c?void 0:c,n):(E.length=o,E.topRadius=r,E.bottomRadius=s,E.slices=a,E.offsetAttribute=-1===c?void 0:c,new x(E))},x.createGeometry=function(e){let t=e._length;const n=e._topRadius,c=e._bottomRadius,u=e._vertexFormat,_=e._slices;if(t<=0||n<0||c<0||0===n&&0===c)return;const x=_+_,C=_+x,E=x+x,S=a.A.computePositions(t,n,c,_,!0),I=u.st?new Float32Array(2*E):void 0,P=u.normal?new Float32Array(3*E):void 0,D=u.tangent?new Float32Array(3*E):void 0,O=u.bitangent?new Float32Array(3*E):void 0;let R;const M=u.normal||u.tangent||u.bitangent;if(M){const e=u.tangent||u.bitangent;let i=0,o=0,s=0;const a=Math.atan2(c-n,t),l=v;l.z=Math.sin(a);const d=Math.cos(a);let h=b,A=T;for(R=0;R<_;R++){const t=R/_*m.A.TWO_PI,n=d*Math.cos(t),a=d*Math.sin(t);M&&(l.x=n,l.y=a,e&&(h=r.A.normalize(r.A.cross(r.A.UNIT_Z,l,h),h)),u.normal&&(P[i++]=l.x,P[i++]=l.y,P[i++]=l.z,P[i++]=l.x,P[i++]=l.y,P[i++]=l.z),u.tangent&&(D[o++]=h.x,D[o++]=h.y,D[o++]=h.z,D[o++]=h.x,D[o++]=h.y,D[o++]=h.z),u.bitangent&&(A=r.A.normalize(r.A.cross(l,h,A),A),O[s++]=A.x,O[s++]=A.y,O[s++]=A.z,O[s++]=A.x,O[s++]=A.y,O[s++]=A.z))}for(R=0;R<_;R++)u.normal&&(P[i++]=0,P[i++]=0,P[i++]=-1),u.tangent&&(D[o++]=1,D[o++]=0,D[o++]=0),u.bitangent&&(O[s++]=0,O[s++]=-1,O[s++]=0);for(R=0;R<_;R++)u.normal&&(P[i++]=0,P[i++]=0,P[i++]=1),u.tangent&&(D[o++]=1,D[o++]=0,D[o++]=0),u.bitangent&&(O[s++]=0,O[s++]=1,O[s++]=0)}const L=12*_-12,N=f.A.createTypedArray(E,L);let B=0,F=0;for(R=0;R<_-1;R++)N[B++]=F,N[B++]=F+2,N[B++]=F+3,N[B++]=F,N[B++]=F+3,N[B++]=F+1,F+=2;for(N[B++]=x-2,N[B++]=0,N[B++]=1,N[B++]=x-2,N[B++]=1,N[B++]=x-1,R=1;R<_-1;R++)N[B++]=x+R+1,N[B++]=x+R,N[B++]=x;for(R=1;R<_-1;R++)N[B++]=C,N[B++]=C+R,N[B++]=C+R+1;let U=0;if(u.st){const e=Math.max(n,c);for(R=0;R<E;R++){const t=r.A.fromArray(S,3*R,w);I[U++]=(t.x+e)/(2*e),I[U++]=(t.y+e)/(2*e)}}const k=new A.A;u.position&&(k.position=new h.A({componentDatatype:s.A.DOUBLE,componentsPerAttribute:3,values:S})),u.normal&&(k.normal=new h.A({componentDatatype:s.A.FLOAT,componentsPerAttribute:3,values:P})),u.tangent&&(k.tangent=new h.A({componentDatatype:s.A.FLOAT,componentsPerAttribute:3,values:D})),u.bitangent&&(k.bitangent=new h.A({componentDatatype:s.A.FLOAT,componentsPerAttribute:3,values:O})),u.st&&(k.st=new h.A({componentDatatype:s.A.FLOAT,componentsPerAttribute:2,values:I})),y.x=.5*t,y.y=Math.max(c,n);const V=new i.A(r.A.ZERO,o.A.magnitude(y));if((0,l.A)(e._offsetAttribute)){t=S.length;const n=e._offsetAttribute===p.A.NONE?0:1,i=new Uint8Array(t/3).fill(n);k.applyOffset=new h.A({componentDatatype:s.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}return new d.A({attributes:k,indices:N,primitiveType:g.A.TRIANGLES,boundingSphere:V,offsetAttribute:e._offsetAttribute})},x.getUnitCylinder=function(){return(0,l.A)(S)||(S=x.createGeometry(new x({topRadius:1,bottomRadius:1,length:1,vertexFormat:_.A.POSITION_ONLY}))),S};const I=x},302982:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(367817);const o={computePositions:function(e,t,n,o,r){const s=.5*e,a=-s,c=o+o,l=new Float64Array(3*(r?2*c:c));let u,d=0,h=0;const A=r?3*c:0,p=r?3*(c+o):3*o;for(u=0;u<o;u++){const e=u/o*i.A.TWO_PI,c=Math.cos(e),f=Math.sin(e),m=c*n,g=f*n,_=c*t,y=f*t;l[h+A]=m,l[h+A+1]=g,l[h+A+2]=a,l[h+p]=_,l[h+p+1]=y,l[h+p+2]=s,h+=3,r&&(l[d++]=m,l[d++]=g,l[d++]=a,l[d++]=_,l[d++]=y,l[d++]=s)}return l}}},707568:(e,t,n)=>{"use strict";function i(e){this.proxy=e}n.d(t,{A:()=>o}),i.prototype.getURL=function(e){const t=-1===this.proxy.indexOf("?")?"?":"";return this.proxy+t+encodeURIComponent(e)};const o=i},606707:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(491446);function o(){this.head=void 0,this.tail=void 0,this._length=0}function r(e,t,n){this.item=e,this.previous=t,this.next=n}function s(e,t){(0,i.A)(t.previous)&&(0,i.A)(t.next)?(t.previous.next=t.next,t.next.previous=t.previous):(0,i.A)(t.previous)?(t.previous.next=void 0,e.tail=t.previous):(0,i.A)(t.next)?(t.next.previous=void 0,e.head=t.next):(e.head=void 0,e.tail=void 0),t.next=void 0,t.previous=void 0}Object.defineProperties(o.prototype,{length:{get:function(){return this._length}}}),o.prototype.add=function(e){const t=new r(e,this.tail,void 0);return(0,i.A)(this.tail)?(this.tail.next=t,this.tail=t):(this.head=t,this.tail=t),++this._length,t},o.prototype.remove=function(e){(0,i.A)(e)&&(s(this,e),--this._length)},o.prototype.splice=function(e,t){if(e===t)return;s(this,t);const n=e.next;e.next=t,this.tail===e?this.tail=t:n.previous=t,t.next=n,t.previous=e};const a=o},602317:(e,t,n)=>{"use strict";n.d(t,{A:()=>ee});var i=n(660662),o=n(434067),r=n(267980),s=n(336946),a=n(369031),c=n(571804),l=n(915325),u=n(491446),d=n(605971),h=n(715726),A=n(610750),p=n(653577),f=n(944479),m=n(305439),g=n(46362),_=n(75200),y=n(794554),v=n(34233),T=n(874915),b=n(367817),w=n(331185),x=n(402330),C=n(99479),E=n(697422),S=n(769534);const I=new r.A,P=new r.A,D=new r.A,O=new r.A,R=new o.A,M=new w.A,L=new w.A,N=new C.A,B=new r.A,F=new r.A,U=new r.A,k=new s.A,V=new r.A,z=new o.A,H=new o.A;function G(e,t,n){const i=t.vertexFormat,s=t.center,a=t.semiMajorAxis,l=t.semiMinorAxis,d=t.ellipsoid,A=t.stRotation,f=n?e.length/3*2:e.length/3,_=t.shadowVolume,v=i.st?new Float32Array(2*f):void 0,T=i.normal?new Float32Array(3*f):void 0,b=i.tangent?new Float32Array(3*f):void 0,x=i.bitangent?new Float32Array(3*f):void 0,E=_?new Float32Array(3*f):void 0;let S=0,O=B,G=F,W=U;const Y=new p.A(d),q=Y.project(d.cartesianToCartographic(s,k),V),j=d.scaleToGeodeticSurface(s,I);d.geodeticSurfaceNormal(j,j);let Q=M,X=L;if(0!==A){let e=C.A.fromAxisAngle(j,A,N);Q=w.A.fromQuaternion(e,Q),e=C.A.fromAxisAngle(j,-A,N),X=w.A.fromQuaternion(e,X)}else Q=w.A.clone(w.A.IDENTITY,Q),X=w.A.clone(w.A.IDENTITY,X);const K=o.A.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,z),$=o.A.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,H);let J=e.length;const Z=n?J:0,ee=Z/3*2;for(let t=0;t<J;t+=3){const o=t+1,s=t+2,c=r.A.fromArray(e,t,I);if(i.st){const e=w.A.multiplyByVector(Q,c,P),t=Y.project(d.cartesianToCartographic(e,k),D);r.A.subtract(t,q,t),R.x=(t.x+a)/(2*a),R.y=(t.y+l)/(2*l),K.x=Math.min(R.x,K.x),K.y=Math.min(R.y,K.y),$.x=Math.max(R.x,$.x),$.y=Math.max(R.y,$.y),n&&(v[S+ee]=R.x,v[S+1+ee]=R.y),v[S++]=R.x,v[S++]=R.y}(i.normal||i.tangent||i.bitangent||_)&&(O=d.geodeticSurfaceNormal(c,O),_&&(E[t+Z]=-O.x,E[o+Z]=-O.y,E[s+Z]=-O.z),(i.normal||i.tangent||i.bitangent)&&((i.tangent||i.bitangent)&&(G=r.A.normalize(r.A.cross(r.A.UNIT_Z,O,G),G),w.A.multiplyByVector(X,G,G)),i.normal&&(T[t]=O.x,T[o]=O.y,T[s]=O.z,n&&(T[t+Z]=-O.x,T[o+Z]=-O.y,T[s+Z]=-O.z)),i.tangent&&(b[t]=G.x,b[o]=G.y,b[s]=G.z,n&&(b[t+Z]=-G.x,b[o+Z]=-G.y,b[s+Z]=-G.z)),i.bitangent&&(W=r.A.normalize(r.A.cross(O,G,W),W),x[t]=W.x,x[o]=W.y,x[s]=W.z,n&&(x[t+Z]=W.x,x[o+Z]=W.y,x[s+Z]=W.z))))}if(i.st){J=v.length;for(let e=0;e<J;e+=2)v[e]=(v[e]-K.x)/($.x-K.x),v[e+1]=(v[e+1]-K.y)/($.y-K.y)}const te=new g.A;if(i.position){const i=h.A.raisePositionsToHeight(e,t,n);te.position=new m.A({componentDatatype:c.A.DOUBLE,componentsPerAttribute:3,values:i})}if(i.st&&(te.st=new m.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:2,values:v})),i.normal&&(te.normal=new m.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:3,values:T})),i.tangent&&(te.tangent=new m.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:3,values:b})),i.bitangent&&(te.bitangent=new m.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:3,values:x})),_&&(te.extrudeDirection=new m.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:3,values:E})),n&&(0,u.A)(t.offsetAttribute)){let e=new Uint8Array(f);if(t.offsetAttribute===y.A.TOP)e=e.fill(1,0,f/2);else{const n=t.offsetAttribute===y.A.NONE?0:1;e=e.fill(n)}te.applyOffset=new m.A({componentDatatype:c.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:e})}return te}function W(e){const t=new Array(e*(e+1)*12-6);let n,i,o,r,s,a=0;for(n=0,o=1,r=0;r<3;r++)t[a++]=o++,t[a++]=n,t[a++]=o;for(r=2;r<e+1;++r){for(o=r*(r+1)-1,n=(r-1)*r-1,t[a++]=o++,t[a++]=n,t[a++]=o,i=2*r,s=0;s<i-1;++s)t[a++]=o,t[a++]=n++,t[a++]=n,t[a++]=o++,t[a++]=n,t[a++]=o;t[a++]=o++,t[a++]=n,t[a++]=o}for(i=2*e,++o,++n,r=0;r<i-1;++r)t[a++]=o,t[a++]=n++,t[a++]=n,t[a++]=o++,t[a++]=n,t[a++]=o;for(t[a++]=o,t[a++]=n++,t[a++]=n,t[a++]=o++,t[a++]=n++,t[a++]=n,++n,r=e-1;r>1;--r){for(t[a++]=n++,t[a++]=n,t[a++]=o,i=2*r,s=0;s<i-1;++s)t[a++]=o,t[a++]=n++,t[a++]=n,t[a++]=o++,t[a++]=n,t[a++]=o;t[a++]=n++,t[a++]=n++,t[a++]=o++}for(r=0;r<3;r++)t[a++]=n++,t[a++]=n,t[a++]=o;return t}let Y=new r.A;const q=new i.A,j=new i.A;function Q(e,t,n,i,o,s,a){const c=h.A.computeEllipsePositions({center:e,semiMajorAxis:t,semiMinorAxis:n,rotation:i,granularity:o},!1,!0).outerPositions,l=c.length/3,u=new Array(l);for(let e=0;e<l;++e)u[e]=r.A.fromArray(c,3*e);const d=E.A.fromCartesianArray(u,s,a);return d.width>b.A.PI&&(d.north=d.north>0?b.A.PI_OVER_TWO-b.A.EPSILON7:d.north,d.south=d.south<0?b.A.EPSILON7-b.A.PI_OVER_TWO:d.south,d.east=b.A.PI,d.west=-b.A.PI),d}function X(e){const t=(e=e??l.A.EMPTY_OBJECT).center,n=e.ellipsoid??A.A.default,i=e.semiMajorAxis,o=e.semiMinorAxis,s=e.granularity??b.A.RADIANS_PER_DEGREE,c=e.vertexFormat??S.A.DEFAULT;if(a.A.defined("options.center",t),a.A.typeOf.number("options.semiMajorAxis",i),a.A.typeOf.number("options.semiMinorAxis",o),i<o)throw new d.A("semiMajorAxis must be greater than or equal to the semiMinorAxis.");if(s<=0)throw new d.A("granularity must be greater than zero.");const u=e.height??0,h=e.extrudedHeight??u;this._center=r.A.clone(t),this._semiMajorAxis=i,this._semiMinorAxis=o,this._ellipsoid=A.A.clone(n),this._rotation=e.rotation??0,this._stRotation=e.stRotation??0,this._height=Math.max(h,u),this._granularity=s,this._vertexFormat=S.A.clone(c),this._extrudedHeight=Math.min(h,u),this._shadowVolume=e.shadowVolume??!1,this._workerName="createEllipseGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0}X.packedLength=r.A.packedLength+A.A.packedLength+S.A.packedLength+9,X.pack=function(e,t,n){return a.A.defined("value",e),a.A.defined("array",t),n=n??0,r.A.pack(e._center,t,n),n+=r.A.packedLength,A.A.pack(e._ellipsoid,t,n),n+=A.A.packedLength,S.A.pack(e._vertexFormat,t,n),n+=S.A.packedLength,t[n++]=e._semiMajorAxis,t[n++]=e._semiMinorAxis,t[n++]=e._rotation,t[n++]=e._stRotation,t[n++]=e._height,t[n++]=e._granularity,t[n++]=e._extrudedHeight,t[n++]=e._shadowVolume?1:0,t[n]=e._offsetAttribute??-1,t};const K=new r.A,$=new A.A,J=new S.A,Z={center:K,ellipsoid:$,vertexFormat:J,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,stRotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,shadowVolume:void 0,offsetAttribute:void 0};X.unpack=function(e,t,n){a.A.defined("array",e),t=t??0;const i=r.A.unpack(e,t,K);t+=r.A.packedLength;const o=A.A.unpack(e,t,$);t+=A.A.packedLength;const s=S.A.unpack(e,t,J);t+=S.A.packedLength;const c=e[t++],l=e[t++],d=e[t++],h=e[t++],p=e[t++],f=e[t++],m=e[t++],g=1===e[t++],_=e[t];return(0,u.A)(n)?(n._center=r.A.clone(i,n._center),n._ellipsoid=A.A.clone(o,n._ellipsoid),n._vertexFormat=S.A.clone(s,n._vertexFormat),n._semiMajorAxis=c,n._semiMinorAxis=l,n._rotation=d,n._stRotation=h,n._height=p,n._granularity=f,n._extrudedHeight=m,n._shadowVolume=g,n._offsetAttribute=-1===_?void 0:_,n):(Z.height=p,Z.extrudedHeight=m,Z.granularity=f,Z.stRotation=h,Z.rotation=d,Z.semiMajorAxis=c,Z.semiMinorAxis=l,Z.shadowVolume=g,Z.offsetAttribute=-1===_?void 0:_,new X(Z))},X.computeRectangle=function(e,t){const n=(e=e??l.A.EMPTY_OBJECT).center,i=e.ellipsoid??A.A.default,o=e.semiMajorAxis,r=e.semiMinorAxis,s=e.granularity??b.A.RADIANS_PER_DEGREE,c=e.rotation??0;if(a.A.defined("options.center",n),a.A.typeOf.number("options.semiMajorAxis",o),a.A.typeOf.number("options.semiMinorAxis",r),o<r)throw new d.A("semiMajorAxis must be greater than or equal to the semiMinorAxis.");if(s<=0)throw new d.A("granularity must be greater than zero.");return Q(n,o,r,c,s,i,t)},X.createGeometry=function(e){if(e._semiMajorAxis<=0||e._semiMinorAxis<=0)return;const t=e._height,n=e._extrudedHeight,s=!b.A.equalsEpsilon(t,n,0,b.A.EPSILON2);e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);const a={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:t,granularity:e._granularity,vertexFormat:e._vertexFormat,stRotation:e._stRotation};let l;if(s)a.extrudedHeight=n,a.shadowVolume=e._shadowVolume,a.offsetAttribute=e._offsetAttribute,l=function(e){const t=e.center,n=e.ellipsoid,s=e.semiMajorAxis;let a=r.A.multiplyByScalar(n.geodeticSurfaceNormal(t,I),e.height,I);q.center=r.A.add(t,a,q.center),q.radius=s,a=r.A.multiplyByScalar(n.geodeticSurfaceNormal(t,a),e.extrudedHeight,a),j.center=r.A.add(t,a,j.center),j.radius=s;const l=h.A.computeEllipsePositions(e,!0,!0),d=l.positions,A=l.numPts,b=l.outerPositions,E=i.A.union(q,j),S=G(d,e,!0);let L=W(A);const Y=L.length;L.length=2*Y;const Q=d.length/3;for(let e=0;e<Y;e+=3)L[e+Y]=L[e+2]+Q,L[e+1+Y]=L[e+1]+Q,L[e+2+Y]=L[e]+Q;const X=T.A.createTypedArray(2*Q/3,L),K=new f.A({attributes:S,indices:X,primitiveType:x.A.TRIANGLES}),$=function(e,t){const n=t.vertexFormat,i=t.center,s=t.semiMajorAxis,a=t.semiMinorAxis,l=t.ellipsoid,d=t.height,h=t.extrudedHeight,A=t.stRotation,f=e.length/3*2,_=new Float64Array(3*f),v=n.st?new Float32Array(2*f):void 0,T=n.normal?new Float32Array(3*f):void 0,b=n.tangent?new Float32Array(3*f):void 0,x=n.bitangent?new Float32Array(3*f):void 0,E=t.shadowVolume,S=E?new Float32Array(3*f):void 0;let L=0,G=B,W=F,Y=U;const q=new p.A(l),j=q.project(l.cartesianToCartographic(i,k),V),Q=l.scaleToGeodeticSurface(i,I);l.geodeticSurfaceNormal(Q,Q);const X=C.A.fromAxisAngle(Q,A,N),K=w.A.fromQuaternion(X,M),$=o.A.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,z),J=o.A.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,H);let Z=e.length;const ee=Z/3*2;for(let t=0;t<Z;t+=3){const i=t+1,o=t+2;let c,u=r.A.fromArray(e,t,I);if(n.st){const e=w.A.multiplyByVector(K,u,P),t=q.project(l.cartesianToCartographic(e,k),D);r.A.subtract(t,j,t),R.x=(t.x+s)/(2*s),R.y=(t.y+a)/(2*a),$.x=Math.min(R.x,$.x),$.y=Math.min(R.y,$.y),J.x=Math.max(R.x,J.x),J.y=Math.max(R.y,J.y),v[L+ee]=R.x,v[L+1+ee]=R.y,v[L++]=R.x,v[L++]=R.y}u=l.scaleToGeodeticSurface(u,u),c=r.A.clone(u,P),G=l.geodeticSurfaceNormal(u,G),E&&(S[t+Z]=-G.x,S[i+Z]=-G.y,S[o+Z]=-G.z);let A=r.A.multiplyByScalar(G,d,O);if(u=r.A.add(u,A,u),A=r.A.multiplyByScalar(G,h,A),c=r.A.add(c,A,c),n.position&&(_[t+Z]=c.x,_[i+Z]=c.y,_[o+Z]=c.z,_[t]=u.x,_[i]=u.y,_[o]=u.z),n.normal||n.tangent||n.bitangent){Y=r.A.clone(G,Y);const s=r.A.fromArray(e,(t+3)%Z,O);r.A.subtract(s,u,s);const a=r.A.subtract(c,u,D);G=r.A.normalize(r.A.cross(a,s,G),G),n.normal&&(T[t]=G.x,T[i]=G.y,T[o]=G.z,T[t+Z]=G.x,T[i+Z]=G.y,T[o+Z]=G.z),n.tangent&&(W=r.A.normalize(r.A.cross(Y,G,W),W),b[t]=W.x,b[i]=W.y,b[o]=W.z,b[t+Z]=W.x,b[t+1+Z]=W.y,b[t+2+Z]=W.z),n.bitangent&&(x[t]=Y.x,x[i]=Y.y,x[o]=Y.z,x[t+Z]=Y.x,x[i+Z]=Y.y,x[o+Z]=Y.z)}}if(n.st){Z=v.length;for(let e=0;e<Z;e+=2)v[e]=(v[e]-$.x)/(J.x-$.x),v[e+1]=(v[e+1]-$.y)/(J.y-$.y)}const te=new g.A;if(n.position&&(te.position=new m.A({componentDatatype:c.A.DOUBLE,componentsPerAttribute:3,values:_})),n.st&&(te.st=new m.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:2,values:v})),n.normal&&(te.normal=new m.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:3,values:T})),n.tangent&&(te.tangent=new m.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:3,values:b})),n.bitangent&&(te.bitangent=new m.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:3,values:x})),E&&(te.extrudeDirection=new m.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:3,values:S})),(0,u.A)(t.offsetAttribute)){let e=new Uint8Array(f);if(t.offsetAttribute===y.A.TOP)e=e.fill(1,0,f/2);else{const n=t.offsetAttribute===y.A.NONE?0:1;e=e.fill(n)}te.applyOffset=new m.A({componentDatatype:c.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:e})}return te}(b,e);L=function(e){const t=e.length/3,n=T.A.createTypedArray(t,6*t);let i=0;for(let e=0;e<t;e++){const o=e,r=e+t,s=(o+1)%t,a=s+t;n[i++]=o,n[i++]=r,n[i++]=s,n[i++]=s,n[i++]=r,n[i++]=a}return n}(b);const J=T.A.createTypedArray(2*b.length/3,L),Z=new f.A({attributes:$,indices:J,primitiveType:x.A.TRIANGLES}),ee=v.A.combineInstances([new _.A({geometry:K}),new _.A({geometry:Z})]);return{boundingSphere:E,attributes:ee[0].attributes,indices:ee[0].indices}}(a);else if(l=function(e){const t=e.center;Y=r.A.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(t,Y),e.height,Y),Y=r.A.add(t,Y,Y);const n=new i.A(Y,e.semiMajorAxis),o=h.A.computeEllipsePositions(e,!0,!1),s=o.positions,a=o.numPts,c=G(s,e,!1);let l=W(a);return l=T.A.createTypedArray(s.length/3,l),{boundingSphere:n,attributes:c,indices:l}}(a),(0,u.A)(e._offsetAttribute)){const t=l.attributes.position.values.length,n=e._offsetAttribute===y.A.NONE?0:1,i=new Uint8Array(t/3).fill(n);l.attributes.applyOffset=new m.A({componentDatatype:c.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}return new f.A({attributes:l.attributes,indices:l.indices,primitiveType:x.A.TRIANGLES,boundingSphere:l.boundingSphere,offsetAttribute:e._offsetAttribute})},X.createShadowVolume=function(e,t,n){const i=e._granularity,o=e._ellipsoid,r=t(i,o),s=n(i,o);return new X({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:o,rotation:e._rotation,stRotation:e._stRotation,granularity:i,extrudedHeight:r,height:s,vertexFormat:S.A.POSITION_ONLY,shadowVolume:!0})},Object.defineProperties(X.prototype,{rectangle:{get:function(){return(0,u.A)(this._rectangle)||(this._rectangle=Q(this._center,this._semiMajorAxis,this._semiMinorAxis,this._rotation,this._granularity,this._ellipsoid)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return(0,u.A)(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=function(e){const t=-e._stRotation;if(0===t)return[0,0,0,1,1,0];const n=h.A.computeEllipsePositions({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,rotation:e._rotation,granularity:e._granularity},!1,!0).outerPositions,i=n.length/3,o=new Array(i);for(let e=0;e<i;++e)o[e]=r.A.fromArray(n,3*e);const s=e._ellipsoid,a=e.rectangle;return f.A._textureCoordinateRotationPoints(o,t,s,a)}(this)),this._textureCoordinateRotationPoints}}});const ee=X},715726:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var i=n(267980),o=n(367817),r=n(331185),s=n(99479);const a={},c=new i.A,l=new i.A,u=new s.A,d=new r.A;function h(e,t,n,o,a,h,A,p,f,m){const g=e+t;i.A.multiplyByScalar(o,Math.cos(g),c),i.A.multiplyByScalar(n,Math.sin(g),l),i.A.add(c,l,c);let _=Math.cos(e);_*=_;let y=Math.sin(e);y*=y;const v=h/Math.sqrt(A*_+a*y)/p;return s.A.fromAxisAngle(c,v,u),r.A.fromQuaternion(u,d),r.A.multiplyByVector(d,f,m),i.A.normalize(m,m),i.A.multiplyByScalar(m,p,m),m}const A=new i.A,p=new i.A,f=new i.A,m=new i.A;a.raisePositionsToHeight=function(e,t,n){const o=t.ellipsoid,r=t.height,s=t.extrudedHeight,a=n?e.length/3*2:e.length/3,c=new Float64Array(3*a),l=e.length,u=n?l:0;for(let t=0;t<l;t+=3){const a=t+1,l=t+2,d=i.A.fromArray(e,t,A);o.scaleToGeodeticSurface(d,d);const h=i.A.clone(d,p),g=o.geodeticSurfaceNormal(d,m),_=i.A.multiplyByScalar(g,r,f);i.A.add(d,_,d),n&&(i.A.multiplyByScalar(g,s,_),i.A.add(h,_,h),c[t+u]=h.x,c[a+u]=h.y,c[l+u]=h.z),c[t]=d.x,c[a]=d.y,c[l]=d.z}return c};const g=new i.A,_=new i.A,y=new i.A;a.computeEllipsePositions=function(e,t,n){const r=e.semiMinorAxis,s=e.semiMajorAxis,a=e.rotation,c=e.center,l=8*e.granularity,u=r*r,d=s*s,m=s*r,v=i.A.magnitude(c),T=i.A.normalize(c,g);let b=i.A.cross(i.A.UNIT_Z,c,_);b=i.A.normalize(b,b);const w=i.A.cross(T,b,y);let x=1+Math.ceil(o.A.PI_OVER_TWO/l);const C=o.A.PI_OVER_TWO/(x-1);let E=o.A.PI_OVER_TWO-x*C;E<0&&(x-=Math.ceil(Math.abs(E)/C));const S=t?new Array(x*(x+2)*2*3):void 0;let I=0,P=A,D=p;const O=4*x*3;let R=O-1,M=0;const L=n?new Array(O):void 0;let N,B,F,U,k;for(E=o.A.PI_OVER_TWO,P=h(E,a,w,b,u,m,d,v,T,P),t&&(S[I++]=P.x,S[I++]=P.y,S[I++]=P.z),n&&(L[R--]=P.z,L[R--]=P.y,L[R--]=P.x),E=o.A.PI_OVER_TWO-C,N=1;N<x+1;++N){if(P=h(E,a,w,b,u,m,d,v,T,P),D=h(Math.PI-E,a,w,b,u,m,d,v,T,D),t){for(S[I++]=P.x,S[I++]=P.y,S[I++]=P.z,F=2*N+2,B=1;B<F-1;++B)U=B/(F-1),k=i.A.lerp(P,D,U,f),S[I++]=k.x,S[I++]=k.y,S[I++]=k.z;S[I++]=D.x,S[I++]=D.y,S[I++]=D.z}n&&(L[R--]=P.z,L[R--]=P.y,L[R--]=P.x,L[M++]=D.x,L[M++]=D.y,L[M++]=D.z),E=o.A.PI_OVER_TWO-(N+1)*C}for(N=x;N>1;--N){if(E=o.A.PI_OVER_TWO-(N-1)*C,P=h(-E,a,w,b,u,m,d,v,T,P),D=h(E+Math.PI,a,w,b,u,m,d,v,T,D),t){for(S[I++]=P.x,S[I++]=P.y,S[I++]=P.z,F=2*(N-1)+2,B=1;B<F-1;++B)U=B/(F-1),k=i.A.lerp(P,D,U,f),S[I++]=k.x,S[I++]=k.y,S[I++]=k.z;S[I++]=D.x,S[I++]=D.y,S[I++]=D.z}n&&(L[R--]=P.z,L[R--]=P.y,L[R--]=P.x,L[M++]=D.x,L[M++]=D.y,L[M++]=D.z)}E=o.A.PI_OVER_TWO,P=h(-E,a,w,b,u,m,d,v,T,P);const V={};return t&&(S[I++]=P.x,S[I++]=P.y,S[I++]=P.z,V.positions=S,V.numPts=x),n&&(L[R--]=P.z,L[R--]=P.y,L[R--]=P.x,V.outerPositions=L),V};const v=a},594706:(e,t,n)=>{"use strict";n.d(t,{A:()=>x});var i=n(660662),o=n(267980),r=n(571804),s=n(915325),a=n(491446),c=n(605971),l=n(610750),u=n(944479),d=n(305439),h=n(46362),A=n(794554),p=n(874915),f=n(367817),m=n(402330);const g=new o.A(1,1,1),_=Math.cos,y=Math.sin;function v(e){const t=(e=e??s.A.EMPTY_OBJECT).radii??g,n=e.innerRadii??t,i=e.minimumClock??0,r=e.maximumClock??f.A.TWO_PI,l=e.minimumCone??0,u=e.maximumCone??f.A.PI,d=Math.round(e.stackPartitions??10),h=Math.round(e.slicePartitions??8),p=Math.round(e.subdivisions??128);if(d<1)throw new c.A("options.stackPartitions cannot be less than 1");if(h<0)throw new c.A("options.slicePartitions cannot be less than 0");if(p<0)throw new c.A("options.subdivisions must be greater than or equal to zero.");if((0,a.A)(e.offsetAttribute)&&e.offsetAttribute===A.A.TOP)throw new c.A("GeometryOffsetAttribute.TOP is not a supported options.offsetAttribute for this geometry.");this._radii=o.A.clone(t),this._innerRadii=o.A.clone(n),this._minimumClock=i,this._maximumClock=r,this._minimumCone=l,this._maximumCone=u,this._stackPartitions=d,this._slicePartitions=h,this._subdivisions=p,this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipsoidOutlineGeometry"}v.packedLength=2*o.A.packedLength+8,v.pack=function(e,t,n){if(!(0,a.A)(e))throw new c.A("value is required");if(!(0,a.A)(t))throw new c.A("array is required");return n=n??0,o.A.pack(e._radii,t,n),n+=o.A.packedLength,o.A.pack(e._innerRadii,t,n),n+=o.A.packedLength,t[n++]=e._minimumClock,t[n++]=e._maximumClock,t[n++]=e._minimumCone,t[n++]=e._maximumCone,t[n++]=e._stackPartitions,t[n++]=e._slicePartitions,t[n++]=e._subdivisions,t[n]=e._offsetAttribute??-1,t};const T=new o.A,b=new o.A,w={radii:T,innerRadii:b,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0,offsetAttribute:void 0};v.unpack=function(e,t,n){if(!(0,a.A)(e))throw new c.A("array is required");t=t??0;const i=o.A.unpack(e,t,T);t+=o.A.packedLength;const r=o.A.unpack(e,t,b);t+=o.A.packedLength;const s=e[t++],l=e[t++],u=e[t++],d=e[t++],h=e[t++],A=e[t++],p=e[t++],f=e[t];return(0,a.A)(n)?(n._radii=o.A.clone(i,n._radii),n._innerRadii=o.A.clone(r,n._innerRadii),n._minimumClock=s,n._maximumClock=l,n._minimumCone=u,n._maximumCone=d,n._stackPartitions=h,n._slicePartitions=A,n._subdivisions=p,n._offsetAttribute=-1===f?void 0:f,n):(w.minimumClock=s,w.maximumClock=l,w.minimumCone=u,w.maximumCone=d,w.stackPartitions=h,w.slicePartitions=A,w.subdivisions=p,w.offsetAttribute=-1===f?void 0:f,new v(w))},v.createGeometry=function(e){const t=e._radii;if(t.x<=0||t.y<=0||t.z<=0)return;const n=e._innerRadii;if(n.x<=0||n.y<=0||n.z<=0)return;const o=e._minimumClock,s=e._maximumClock,c=e._minimumCone,g=e._maximumCone,v=e._subdivisions,T=l.A.fromCartesian3(t);let b=e._slicePartitions+1,w=e._stackPartitions+1;b=Math.round(b*Math.abs(s-o)/f.A.TWO_PI),w=Math.round(w*Math.abs(g-c)/f.A.PI),b<2&&(b=2),w<2&&(w=2);let x=0,C=1;const E=n.x!==t.x||n.y!==t.y||n.z!==t.z;let S=!1,I=!1;E&&(C=2,c>0&&(S=!0,x+=b),g<Math.PI&&(I=!0,x+=b));const P=v*C*(w+b),D=new Float64Array(3*P),O=2*(P+x-(b+w)*C),R=p.A.createTypedArray(P,O);let M,L,N,B,F=0;const U=new Array(w),k=new Array(w);for(M=0;M<w;M++)B=c+M*(g-c)/(w-1),U[M]=y(B),k[M]=_(B);const V=new Array(v),z=new Array(v);for(M=0;M<v;M++)N=o+M*(s-o)/(v-1),V[M]=y(N),z[M]=_(N);for(M=0;M<w;M++)for(L=0;L<v;L++)D[F++]=t.x*U[M]*z[L],D[F++]=t.y*U[M]*V[L],D[F++]=t.z*k[M];if(E)for(M=0;M<w;M++)for(L=0;L<v;L++)D[F++]=n.x*U[M]*z[L],D[F++]=n.y*U[M]*V[L],D[F++]=n.z*k[M];for(U.length=v,k.length=v,M=0;M<v;M++)B=c+M*(g-c)/(v-1),U[M]=y(B),k[M]=_(B);for(V.length=b,z.length=b,M=0;M<b;M++)N=o+M*(s-o)/(b-1),V[M]=y(N),z[M]=_(N);for(M=0;M<v;M++)for(L=0;L<b;L++)D[F++]=t.x*U[M]*z[L],D[F++]=t.y*U[M]*V[L],D[F++]=t.z*k[M];if(E)for(M=0;M<v;M++)for(L=0;L<b;L++)D[F++]=n.x*U[M]*z[L],D[F++]=n.y*U[M]*V[L],D[F++]=n.z*k[M];for(F=0,M=0;M<w*C;M++){const e=M*v;for(L=0;L<v-1;L++)R[F++]=e+L,R[F++]=e+L+1}let H=w*v*C;for(M=0;M<b;M++)for(L=0;L<v-1;L++)R[F++]=H+M+L*b,R[F++]=H+M+(L+1)*b;if(E)for(H=w*v*C+b*v,M=0;M<b;M++)for(L=0;L<v-1;L++)R[F++]=H+M+L*b,R[F++]=H+M+(L+1)*b;if(E){let e=w*v*C,t=e+v*b;if(S)for(M=0;M<b;M++)R[F++]=e+M,R[F++]=t+M;if(I)for(e+=v*b-b,t+=v*b-b,M=0;M<b;M++)R[F++]=e+M,R[F++]=t+M}const G=new h.A({position:new d.A({componentDatatype:r.A.DOUBLE,componentsPerAttribute:3,values:D})});if((0,a.A)(e._offsetAttribute)){const t=D.length,n=e._offsetAttribute===A.A.NONE?0:1,i=new Uint8Array(t/3).fill(n);G.applyOffset=new d.A({componentDatatype:r.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}return new u.A({attributes:G,indices:R,primitiveType:m.A.LINES,boundingSphere:i.A.fromEllipsoid(T),offsetAttribute:e._offsetAttribute})};const x=v},961136:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var i=n(267980),o=n(626809),r=n(915325),s=n(491446),a=n(605971),c=n(153127),l=n(584164),u=n(437266),d=n(710551);const h=[],A=[],p=[],f=[];function m(e){const t=(e=e??r.A.EMPTY_OBJECT).points,n=e.times,i=e.inTangents,o=e.outTangents;if(!((0,s.A)(t)&&(0,s.A)(n)&&(0,s.A)(i)&&(0,s.A)(o)))throw new a.A("times, points, inTangents, and outTangents are required.");if(t.length<2)throw new a.A("points.length must be greater than or equal to 2.");if(n.length!==t.length)throw new a.A("times.length must be equal to points.length.");if(i.length!==o.length||i.length!==t.length-1)throw new a.A("inTangents and outTangents must have a length equal to points.length - 1.");if(this._times=n,this._points=t,this._pointType=u.A.getPointType(t[0]),this._pointType!==u.A.getPointType(i[0])||this._pointType!==u.A.getPointType(o[0]))throw new a.A("inTangents and outTangents must be of the same type as points.");this._inTangents=i,this._outTangents=o,this._lastTimeIndex=0}Object.defineProperties(m.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},inTangents:{get:function(){return this._inTangents}},outTangents:{get:function(){return this._outTangents}}}),m.createC1=function(e){const t=(e=e??r.A.EMPTY_OBJECT).times,n=e.points,i=e.tangents;if(!(0,s.A)(n)||!(0,s.A)(t)||!(0,s.A)(i))throw new a.A("points, times and tangents are required.");if(n.length<2)throw new a.A("points.length must be greater than or equal to 2.");if(t.length!==n.length||t.length!==i.length)throw new a.A("times, points and tangents must have the same length.");const o=i.slice(0,i.length-1);return new m({times:t,points:n,inTangents:i.slice(1,i.length),outTangents:o})},m.createNaturalCubic=function(e){const t=(e=e??r.A.EMPTY_OBJECT).times,n=e.points;if(!(0,s.A)(n)||!(0,s.A)(t))throw new a.A("points and times are required.");if(n.length<2)throw new a.A("points.length must be greater than or equal to 2.");if(t.length!==n.length)throw new a.A("times.length must be equal to points.length.");if(n.length<3)return new c.A({points:n,times:t});const o=function(e){const t=h,n=p,o=A,r=f;let a;t.length=n.length=e.length-1,o.length=r.length=e.length,t[0]=n[0]=1,o[0]=2;let c=r[0];for((0,s.A)(c)||(c=r[0]=new i.A),i.A.subtract(e[1],e[0],c),i.A.multiplyByScalar(c,3,c),a=1;a<t.length;++a)t[a]=n[a]=1,o[a]=4,c=r[a],(0,s.A)(c)||(c=r[a]=new i.A),i.A.subtract(e[a+1],e[a-1],c),i.A.multiplyByScalar(c,3,c);return o[a]=2,c=r[a],(0,s.A)(c)||(c=r[a]=new i.A),i.A.subtract(e[a],e[a-1],c),i.A.multiplyByScalar(c,3,c),d.A.solve(t,o,n,r)}(n),l=o.slice(0,o.length-1);return new m({times:t,points:n,inTangents:o.slice(1,o.length),outTangents:l})},m.createClampedCubic=function(e){const t=(e=e??r.A.EMPTY_OBJECT).times,n=e.points,o=e.firstTangent,l=e.lastTangent;if(!((0,s.A)(n)&&(0,s.A)(t)&&(0,s.A)(o)&&(0,s.A)(l)))throw new a.A("points, times, firstTangent and lastTangent are required.");if(n.length<2)throw new a.A("points.length must be greater than or equal to 2.");if(t.length!==n.length)throw new a.A("times.length must be equal to points.length.");const g=u.A.getPointType(n[0]);if(g!==u.A.getPointType(o)||g!==u.A.getPointType(l))throw new a.A("firstTangent and lastTangent must be of the same type as points.");if(n.length<3)return new c.A({points:n,times:t});const _=function(e,t,n){const o=h,r=p,a=A,c=f;let l;o.length=r.length=e.length-1,a.length=c.length=e.length,o[0]=a[0]=1,r[0]=0;let u=c[0];for((0,s.A)(u)||(u=c[0]=new i.A),i.A.clone(t,u),l=1;l<o.length-1;++l)o[l]=r[l]=1,a[l]=4,u=c[l],(0,s.A)(u)||(u=c[l]=new i.A),i.A.subtract(e[l+1],e[l-1],u),i.A.multiplyByScalar(u,3,u);return o[l]=0,r[l]=1,a[l]=4,u=c[l],(0,s.A)(u)||(u=c[l]=new i.A),i.A.subtract(e[l+1],e[l-1],u),i.A.multiplyByScalar(u,3,u),a[l+1]=1,u=c[l+1],(0,s.A)(u)||(u=c[l+1]=new i.A),i.A.clone(n,u),d.A.solve(o,a,r,c)}(n,o,l),y=_.slice(0,_.length-1);return new m({times:t,points:n,inTangents:_.slice(1,_.length),outTangents:y})},m.hermiteCoefficientMatrix=new l.A(2,-3,0,1,-2,3,0,0,1,-2,1,0,1,-1,0,0),m.prototype.findTimeInterval=u.A.prototype.findTimeInterval;const g=new o.A,_=new i.A;m.prototype.wrapTime=u.A.prototype.wrapTime,m.prototype.clampTime=u.A.prototype.clampTime,m.prototype.evaluate=function(e,t){const n=this.points,i=this.times,o=this.inTangents,r=this.outTangents;this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex);const a=this._lastTimeIndex,c=i[a+1]-i[a],u=(e-i[a])/c,d=g;d.z=u,d.y=u*u,d.x=d.y*u,d.w=1;const h=l.A.multiplyByVector(m.hermiteCoefficientMatrix,d,d);h.z*=c,h.w*=c;const A=this._pointType;return A===Number?n[a]*h.x+n[a+1]*h.y+r[a]*h.z+o[a]*h.w:((0,s.A)(t)||(t=new A),t=A.multiplyByScalar(n[a],h.x,t),A.multiplyByScalar(n[a+1],h.y,_),A.add(t,_,t),A.multiplyByScalar(r[a],h.z,_),A.add(t,_,t),A.multiplyByScalar(o[a],h.w,_),A.add(t,_,t))};const y=m},416721:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(369031),o=n(605971);const r={};function s(e,t,n,i){if(0!==i)return;1===n&&(t.x=e-1-t.x,t.y=e-1-t.y);const o=t.x;t.x=t.y,t.y=o}r.encode2D=function(e,t,n){const r=Math.pow(2,e);if(i.A.typeOf.number("level",e),i.A.typeOf.number("x",t),i.A.typeOf.number("y",n),e<1)throw new o.A("Hilbert level cannot be less than 1.");if(t<0||t>=r||n<0||n>=r)throw new o.A("Invalid coordinates for given level.");const a={x:t,y:n};let c,l,u,d=BigInt(0);for(u=r/2;u>0;u/=2)c=(a.x&u)>0?1:0,l=(a.y&u)>0?1:0,d+=BigInt((3*c^l)*u*u),s(r,a,c,l);return d},r.decode2D=function(e,t){if(i.A.typeOf.number("level",e),i.A.typeOf.bigint("index",t),e<1)throw new o.A("Hilbert level cannot be less than 1.");if(t<BigInt(0)||t>=BigInt(Math.pow(4,e)))throw new o.A("Hilbert index exceeds valid maximum for given level.");const n=Math.pow(2,e),r={x:0,y:0};let a,c,l,u;for(l=1,u=t;l<n;l*=2)a=1&Number(u/BigInt(2)),c=1&Number(u^BigInt(a)),s(l,r,a,c),r.x+=l*a,r.y+=l*c,u/=BigInt(4);return[r.x,r.y]};const a=r},92457:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({STEP:0,LINEAR:1,CUBICSPLINE:2})},153127:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(267980),o=n(915325),r=n(491446),s=n(605971),a=n(437266);function c(e){const t=(e=e??o.A.EMPTY_OBJECT).points,n=e.times;if(!(0,r.A)(t)||!(0,r.A)(n))throw new s.A("points and times are required.");if(t.length<2)throw new s.A("points.length must be greater than or equal to 2.");if(n.length!==t.length)throw new s.A("times.length must be equal to points.length.");this._times=n,this._points=t,this._pointType=a.A.getPointType(t[0]),this._lastTimeIndex=0}Object.defineProperties(c.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}}),c.prototype.findTimeInterval=a.A.prototype.findTimeInterval,c.prototype.wrapTime=a.A.prototype.wrapTime,c.prototype.clampTime=a.A.prototype.clampTime,c.prototype.evaluate=function(e,t){const n=this.points,o=this.times,s=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),a=(e-o[s])/(o[s+1]-o[s]);return this._pointType===Number?(1-a)*n[s]+a*n[s+1]:((0,r.A)(t)||(t=new i.A),i.A.lerp(n[s],n[s+1],a,t))};const l=c},981757:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(369031);function o(e){e=e??0,this._array=new Array(e),this._length=e}Object.defineProperties(o.prototype,{length:{get:function(){return this._length},set:function(e){i.A.typeOf.number.greaterThanOrEquals("length",e,0);const t=this._array,n=this._length;if(e<n)for(let i=e;i<n;++i)t[i]=void 0;else e>t.length&&(t.length=e);this._length=e}},values:{get:function(){return this._array}}}),o.prototype.get=function(e){return i.A.typeOf.number.lessThan("index",e,this._array.length),this._array[e]},o.prototype.set=function(e,t){i.A.typeOf.number("index",e),e>=this._length&&(this.length=e+1),this._array[e]=t},o.prototype.peek=function(){return this._array[this._length-1]},o.prototype.push=function(e){const t=this.length++;this._array[t]=e},o.prototype.pop=function(){if(0===this._length)return;const e=this._array[this._length-1];return--this.length,e},o.prototype.reserve=function(e){i.A.typeOf.number.greaterThanOrEquals("length",e,0),e>this._array.length&&(this._array.length=e)},o.prototype.resize=function(e){i.A.typeOf.number.greaterThanOrEquals("length",e,0),this.length=e},o.prototype.trim=function(e){e=e??this._length,this._array.length=e};const r=o},245226:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(369031),o=n(491446),r=n(605971);const s={};function a(e){return 1431655765&((e=858993459&((e=252645135&((e=16711935&(e^e<<8))^e<<4))^e<<2))^e<<1)}function c(e){return 153391689&((e=51130563&((e=50393103&((e=50331903&(e^e<<16))^e<<8))^e<<4))^e<<2)}function l(e){return 65535&((e=16711935&((e=252645135&((e=858993459&((e&=1431655765)^e>>1))^e>>2))^e>>4))^e>>8)}function u(e){return 1023&((e=4278190335&((e=50393103&((e=51130563&((e&=153391689)^e>>2))^e>>4))^e>>8))^e>>16)}s.encode2D=function(e,t){if(i.A.typeOf.number("x",e),i.A.typeOf.number("y",t),e<0||e>65535||t<0||t>65535)throw new r.A("inputs must be 16-bit unsigned integers");return(a(e)|a(t)<<1)>>>0},s.decode2D=function(e,t){if(i.A.typeOf.number("mortonIndex",e),e<0||e>4294967295)throw new r.A("input must be a 32-bit unsigned integer");return(0,o.A)(t)||(t=new Array(2)),t[0]=l(e),t[1]=l(e>>1),t},s.encode3D=function(e,t,n){if(i.A.typeOf.number("x",e),i.A.typeOf.number("y",t),i.A.typeOf.number("z",n),e<0||e>1023||t<0||t>1023||n<0||n>1023)throw new r.A("inputs must be 10-bit unsigned integers");return c(e)|c(t)<<1|c(n)<<2},s.decode3D=function(e,t){if(i.A.typeOf.number("mortonIndex",e),e<0||e>1073741823)throw new r.A("input must be a 30-bit unsigned integer");return(0,o.A)(t)||(t=new Array(3)),t[0]=u(e),t[1]=u(e>>1),t[2]=u(e>>2),t};const d=s},335385:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(303578),o=n(41476),r=n(491446),s=n(605971),a=n(744603),c=n(517638);function l(){this._cache={}}l.prototype.fromColor=function(e,t){if(!(0,r.A)(e))throw new s.A("color is required");if(!(0,r.A)(t))throw new s.A("size is required");return A(void 0,void 0,e,t,this._cache)},l.prototype.fromUrl=function(e,t,n){if(!(0,r.A)(e))throw new s.A("url is required");if(!(0,r.A)(t))throw new s.A("color is required");if(!(0,r.A)(n))throw new s.A("size is required");return A(e,void 0,t,n,this._cache)},l.prototype.fromMakiIconId=function(e,t,n){if(!(0,r.A)(e))throw new s.A("id is required");if(!(0,r.A)(t))throw new s.A("color is required");if(!(0,r.A)(n))throw new s.A("size is required");return A((0,i.A)(`Assets/Textures/maki/${encodeURIComponent(e)}.png`),void 0,t,n,this._cache)},l.prototype.fromText=function(e,t,n){if(!(0,r.A)(e))throw new s.A("text is required");if(!(0,r.A)(t))throw new s.A("color is required");if(!(0,r.A)(n))throw new s.A("size is required");return A(void 0,e,t,n,this._cache)};const u=new o.A;function d(e,t,n){const i=n/2.5;let r=i,s=i;t.width>t.height?s=i*(t.height/t.width):t.width<t.height&&(r=i*(t.width/t.height));const a=Math.round((n-r)/2),c=Math.round(7/24*n-s/2);e.globalCompositeOperation="destination-out",e.drawImage(t,a-1,c,r,s),e.drawImage(t,a,c-1,r,s),e.drawImage(t,a+1,c,r,s),e.drawImage(t,a,c+1,r,s),e.globalCompositeOperation="destination-over",e.fillStyle=o.A.BLACK.toCssColorString(),e.fillRect(a-1,c-1,r+2,s+2),e.globalCompositeOperation="destination-out",e.drawImage(t,a,c,r,s),e.globalCompositeOperation="destination-over",e.fillStyle=o.A.WHITE.toCssColorString(),e.fillRect(a-1,c-2,r+2,s+2)}const h=new Array(4);function A(e,t,n,i,o){h[0]=e,h[1]=t,h[2]=n,h[3]=i;const s=JSON.stringify(h),l=o[s];if((0,r.A)(l))return l;const A=document.createElement("canvas");A.width=i,A.height=i;const p=A.getContext("2d");if(function(e,t,n){e.save(),e.scale(n/24,n/24),e.fillStyle=t.toCssColorString(),e.strokeStyle=t.brighten(.6,u).toCssColorString(),e.lineWidth=.846,e.beginPath(),e.moveTo(6.72,.422),e.lineTo(17.28,.422),e.bezierCurveTo(18.553,.422,19.577,1.758,19.577,3.415),e.lineTo(19.577,10.973),e.bezierCurveTo(19.577,12.63,18.553,13.966,17.282,13.966),e.lineTo(14.386,14.008),e.lineTo(11.826,23.578),e.lineTo(9.614,14.008),e.lineTo(6.719,13.965),e.bezierCurveTo(5.446,13.983,4.422,12.629,4.422,10.972),e.lineTo(4.422,3.416),e.bezierCurveTo(4.423,1.76,5.447,.423,6.718,.423),e.closePath(),e.fill(),e.stroke(),e.restore()}(p,n,i),(0,r.A)(e)){const t=a.A.createIfNeeded(e).fetchImage().then(function(e){return d(p,e,i),o[s]=A,A});return o[s]=t,t}if((0,r.A)(t)){const e=(0,c.A)(t,{font:`bold ${i}px sans-serif`});d(p,e,i)}return o[s]=A,A}const p=l},151949:(e,t,n)=>{"use strict";n.d(t,{A:()=>pe});var i=n(215327),o=n(647934),r=n(660662),s=n(434067),a=n(267980),c=n(336946),l=n(369031),u=n(571804),d=n(915325),h=n(491446),A=n(605971),p=n(610750),f=n(658091),m=n(944479),g=n(305439),_=n(75200),y=n(794554),v=n(34233),T=n(874915),b=n(367817),w=n(331185),x=n(71694),C=n(576770),E=n(99479),S=n(697422),I=n(465159),P=n(769534),D=n(666765);const O=new c.A,R=new c.A;function M(e,t,n,i){const o=i.cartesianToCartographic(e,O).height,r=i.cartesianToCartographic(t,R);r.height=o,i.cartographicToCartesian(r,t);const s=i.cartesianToCartographic(n,R);s.height=o-100,i.cartographicToCartesian(s,n)}const L=new o.A,N=new a.A,B=new a.A,F=new a.A,U=new a.A,k=new a.A,V=new a.A;let z=new a.A,H=new a.A,G=new a.A;const W=new s.A,Y=new s.A,q=new a.A,j=new E.A,Q=new w.A,X=new w.A;function K(e){const t=e.vertexFormat,n=e.geometry,i=e.shadowVolume,o=n.attributes.position.values,r=(0,h.A)(n.attributes.st)?n.attributes.st.values:void 0;let c=o.length;const l=e.wall,d=e.top||l,A=e.bottom||l;if(t.st||t.normal||t.tangent||t.bitangent||i){const p=e.boundingRectangle,f=e.rotationAxis,m=e.projectTo2d,_=e.ellipsoid,y=e.stRotation,v=e.perPositionHeight,T=W;T.x=p.x,T.y=p.y;const x=t.st?new Float32Array(c/3*2):void 0;let C;t.normal&&(C=v&&d&&!l?n.attributes.normal.values:new Float32Array(c));const S=t.tangent?new Float32Array(c):void 0,I=t.bitangent?new Float32Array(c):void 0,P=i?new Float32Array(c):void 0;let D=0,O=0,R=B,L=F,K=U,$=!0,J=Q,Z=X;if(0!==y){let e=E.A.fromAxisAngle(f,y,j);J=w.A.fromQuaternion(e,J),e=E.A.fromAxisAngle(f,-y,j),Z=w.A.fromQuaternion(e,Z)}else J=w.A.clone(w.A.IDENTITY,J),Z=w.A.clone(w.A.IDENTITY,Z);let ee=0,te=0;d&&A&&(ee=c/2,te=c/3,c/=2);for(let n=0;n<c;n+=3){const u=a.A.fromArray(o,n,q);if(t.st&&!(0,h.A)(r)){let e=w.A.multiplyByVector(J,u,N);e=_.scaleToGeodeticSurface(e,e);const t=m([e],Y)[0];s.A.subtract(t,T,t);const n=b.A.clamp(t.x/p.width,0,1),i=b.A.clamp(t.y/p.height,0,1);A&&(x[D+te]=n,x[D+1+te]=i),d&&(x[D]=n,x[D+1]=i),D+=2}if(t.normal||t.tangent||t.bitangent||i){const r=O+1,s=O+2;if(l){if(n+3<c){const e=a.A.fromArray(o,n+3,k);if($){const t=a.A.fromArray(o,n+c,V);v&&M(u,e,t,_),a.A.subtract(e,u,e),a.A.subtract(t,u,t),R=a.A.normalize(a.A.cross(t,e,R),R),$=!1}a.A.equalsEpsilon(e,u,b.A.EPSILON10)&&($=!0)}(t.tangent||t.bitangent)&&(K=_.geodeticSurfaceNormal(u,K),t.tangent&&(L=a.A.normalize(a.A.cross(K,R,L),L)))}else R=_.geodeticSurfaceNormal(u,R),(t.tangent||t.bitangent)&&(v&&(z=a.A.fromArray(C,O,z),H=a.A.cross(a.A.UNIT_Z,z,H),H=a.A.normalize(w.A.multiplyByVector(Z,H,H),H),t.bitangent&&(G=a.A.normalize(a.A.cross(z,H,G),G))),L=a.A.cross(a.A.UNIT_Z,R,L),L=a.A.normalize(w.A.multiplyByVector(Z,L,L),L),t.bitangent&&(K=a.A.normalize(a.A.cross(R,L,K),K)));t.normal&&(e.wall?(C[O+ee]=R.x,C[r+ee]=R.y,C[s+ee]=R.z):A&&(C[O+ee]=-R.x,C[r+ee]=-R.y,C[s+ee]=-R.z),(d&&!v||l)&&(C[O]=R.x,C[r]=R.y,C[s]=R.z)),i&&(l&&(R=_.geodeticSurfaceNormal(u,R)),P[O+ee]=-R.x,P[r+ee]=-R.y,P[s+ee]=-R.z),t.tangent&&(e.wall?(S[O+ee]=L.x,S[r+ee]=L.y,S[s+ee]=L.z):A&&(S[O+ee]=-L.x,S[r+ee]=-L.y,S[s+ee]=-L.z),d&&(v?(S[O]=H.x,S[r]=H.y,S[s]=H.z):(S[O]=L.x,S[r]=L.y,S[s]=L.z))),t.bitangent&&(A&&(I[O+ee]=K.x,I[r+ee]=K.y,I[s+ee]=K.z),d&&(v?(I[O]=G.x,I[r]=G.y,I[s]=G.z):(I[O]=K.x,I[r]=K.y,I[s]=K.z))),O+=3}}t.st&&!(0,h.A)(r)&&(n.attributes.st=new g.A({componentDatatype:u.A.FLOAT,componentsPerAttribute:2,values:x})),t.normal&&(n.attributes.normal=new g.A({componentDatatype:u.A.FLOAT,componentsPerAttribute:3,values:C})),t.tangent&&(n.attributes.tangent=new g.A({componentDatatype:u.A.FLOAT,componentsPerAttribute:3,values:S})),t.bitangent&&(n.attributes.bitangent=new g.A({componentDatatype:u.A.FLOAT,componentsPerAttribute:3,values:I})),i&&(n.attributes.extrudeDirection=new g.A({componentDatatype:u.A.FLOAT,componentsPerAttribute:3,values:P}))}if(e.extrude&&(0,h.A)(e.offsetAttribute)){const t=o.length/3;let i=new Uint8Array(t);if(e.offsetAttribute===y.A.TOP)d&&A||l?i=i.fill(1,0,t/2):d&&(i=i.fill(1));else{const t=e.offsetAttribute===y.A.NONE?0:1;i=i.fill(t)}n.attributes.applyOffset=new g.A({componentDatatype:u.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}return n}const $=[];function J(e,t,n,i,o,r,s,a,c,l){const u={walls:[]};let d;if(s||a){const o=x.A.createGeometryFromPositions(e,t,n,i,r,c,l),A=o.attributes.position.values,p=o.indices;let f,m;if(s&&a){const e=A.concat(A);f=e.length/3,m=T.A.createTypedArray(f,2*p.length),m.set(p);const t=p.length,i=f/2;for(d=0;d<t;d+=3){const e=m[d]+i,n=m[d+1]+i,o=m[d+2]+i;m[d+t]=o,m[d+1+t]=n,m[d+2+t]=e}if(o.attributes.position.values=e,r&&c.normal){const t=o.attributes.normal.values;o.attributes.normal.values=new Float32Array(e.length),o.attributes.normal.values.set(t)}if(c.st&&(0,h.A)(n)){const e=o.attributes.st.values;o.attributes.st.values=new Float32Array(2*f),o.attributes.st.values=e.concat(e)}o.indices=m}else if(a){for(f=A.length/3,m=T.A.createTypedArray(f,p.length),d=0;d<p.length;d+=3)m[d]=p[d+2],m[d+1]=p[d+1],m[d+2]=p[d];o.indices=m}u.topAndBottom=new _.A({geometry:o})}let A=o.outerRing;const p=f.A.fromPoints(A,e);let m=p.projectPointsOntoPlane(A,$),g=C.A.computeWindingOrder2D(m);g===D.A.CLOCKWISE&&(A=A.slice().reverse());let y=x.A.computeWallGeometry(A,n,e,i,r,l);u.walls.push(new _.A({geometry:y}));const v=o.holes;for(d=0;d<v.length;d++){let t=v[d];m=p.projectPointsOntoPlane(t,$),g=C.A.computeWindingOrder2D(m),g===D.A.COUNTER_CLOCKWISE&&(t=t.slice().reverse()),y=x.A.computeWallGeometry(t,n,e,i,r,l),u.walls.push(new _.A({geometry:y}))}return u}function Z(e){if(l.A.typeOf.object("options",e),l.A.typeOf.object("options.polygonHierarchy",e.polygonHierarchy),(0,h.A)(e.perPositionHeight)&&e.perPositionHeight&&(0,h.A)(e.height))throw new A.A("Cannot use both options.perPositionHeight and options.height");if((0,h.A)(e.arcType)&&e.arcType!==i.A.GEODESIC&&e.arcType!==i.A.RHUMB)throw new A.A("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");const t=e.polygonHierarchy,n=e.vertexFormat??P.A.DEFAULT,o=e.ellipsoid??p.A.default,r=e.granularity??b.A.RADIANS_PER_DEGREE,c=e.stRotation??0,u=e.textureCoordinates,d=e.perPositionHeight??!1,f=d&&(0,h.A)(e.extrudedHeight);let m=e.height??0,g=e.extrudedHeight??m;if(!f){const e=Math.max(m,g);g=Math.min(m,g),m=e}this._vertexFormat=P.A.clone(n),this._ellipsoid=p.A.clone(o),this._granularity=r,this._stRotation=c,this._height=m,this._extrudedHeight=g,this._closeTop=e.closeTop??!0,this._closeBottom=e.closeBottom??!0,this._polygonHierarchy=t,this._perPositionHeight=d,this._perPositionHeightExtrude=f,this._shadowVolume=e.shadowVolume??!1,this._workerName="createPolygonGeometry",this._offsetAttribute=e.offsetAttribute,this._arcType=e.arcType??i.A.GEODESIC,this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0,this._textureCoordinates=u,this.packedLength=x.A.computeHierarchyPackedLength(t,a.A)+p.A.packedLength+P.A.packedLength+(u?x.A.computeHierarchyPackedLength(u,s.A):1)+12}Z.fromPositions=function(e){return e=e??d.A.EMPTY_OBJECT,l.A.defined("options.positions",e.positions),new Z({polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,closeTop:e.closeTop,closeBottom:e.closeBottom,offsetAttribute:e.offsetAttribute,arcType:e.arcType,textureCoordinates:e.textureCoordinates})},Z.pack=function(e,t,n){return l.A.typeOf.object("value",e),l.A.defined("array",t),n=n??0,n=x.A.packPolygonHierarchy(e._polygonHierarchy,t,n,a.A),p.A.pack(e._ellipsoid,t,n),n+=p.A.packedLength,P.A.pack(e._vertexFormat,t,n),n+=P.A.packedLength,t[n++]=e._height,t[n++]=e._extrudedHeight,t[n++]=e._granularity,t[n++]=e._stRotation,t[n++]=e._perPositionHeightExtrude?1:0,t[n++]=e._perPositionHeight?1:0,t[n++]=e._closeTop?1:0,t[n++]=e._closeBottom?1:0,t[n++]=e._shadowVolume?1:0,t[n++]=e._offsetAttribute??-1,t[n++]=e._arcType,(0,h.A)(e._textureCoordinates)?n=x.A.packPolygonHierarchy(e._textureCoordinates,t,n,s.A):t[n++]=-1,t[n++]=e.packedLength,t};const ee=p.A.clone(p.A.UNIT_SPHERE),te=new P.A,ne={polygonHierarchy:{}};Z.unpack=function(e,t,n){l.A.defined("array",e),t=t??0;const i=x.A.unpackPolygonHierarchy(e,t,a.A);t=i.startingIndex,delete i.startingIndex;const o=p.A.unpack(e,t,ee);t+=p.A.packedLength;const r=P.A.unpack(e,t,te);t+=P.A.packedLength;const c=e[t++],u=e[t++],d=e[t++],A=e[t++],f=1===e[t++],m=1===e[t++],g=1===e[t++],_=1===e[t++],y=1===e[t++],v=e[t++],T=e[t++],b=-1===e[t]?void 0:x.A.unpackPolygonHierarchy(e,t,s.A);(0,h.A)(b)?(t=b.startingIndex,delete b.startingIndex):t++;const w=e[t++];return(0,h.A)(n)||(n=new Z(ne)),n._polygonHierarchy=i,n._ellipsoid=p.A.clone(o,n._ellipsoid),n._vertexFormat=P.A.clone(r,n._vertexFormat),n._height=c,n._extrudedHeight=u,n._granularity=d,n._stRotation=A,n._perPositionHeightExtrude=f,n._perPositionHeight=m,n._closeTop=g,n._closeBottom=_,n._shadowVolume=y,n._offsetAttribute=-1===v?void 0:v,n._arcType=T,n._textureCoordinates=b,n.packedLength=w,n};const ie=new s.A,oe=new s.A,re=new I.A;function se(e,t,n,o,r,a){const c=e.longitude,l=c>=0?c:c+b.A.TWO_PI;r.westOverIdl=Math.min(r.westOverIdl,l),r.eastOverIdl=Math.max(r.eastOverIdl,l),a.west=Math.min(a.west,c),a.east=Math.max(a.east,c);const u=e.getLatitude(n);let d=u;if(a.south=Math.min(a.south,u),a.north=Math.max(a.north,u),o!==i.A.RHUMB){const i=s.A.subtract(t.position,e.position,ie),o=s.A.dot(t.position,i)/s.A.dot(i,i);if(o>0&&o<1){const e=s.A.add(t.position,s.A.multiplyByScalar(i,-o,i),oe),r=I.A.clone(t,re);r.position=e;const c=r.getLatitude(n);a.south=Math.min(a.south,c),a.north=Math.max(a.north,c),Math.abs(u)>Math.abs(c)&&(d=c)}}const h=t.x*e.y-e.x*t.y;let A=Math.sign(h);0!==A&&(A*=s.A.angleBetween(t.position,e.position)),d>=0&&(r.northAngle+=A),d<=0&&(r.southAngle+=A)}const ae=new I.A,ce=new I.A,le={northAngle:0,southAngle:0,westOverIdl:0,eastOverIdl:0};Z.computeRectangleFromPositions=function(e,t,n,i){if(l.A.defined("positions",e),(0,h.A)(i)||(i=new S.A),e.length<3)return i;i.west=Number.POSITIVE_INFINITY,i.east=Number.NEGATIVE_INFINITY,i.south=Number.POSITIVE_INFINITY,i.north=Number.NEGATIVE_INFINITY,le.northAngle=0,le.southAngle=0,le.westOverIdl=Number.POSITIVE_INFINITY,le.eastOverIdl=Number.NEGATIVE_INFINITY;const o=e.length;let r=I.A.fromCartesian(e[0],ce);for(let s=1;s<o;s++){const o=I.A.fromCartesian(e[s],ae);se(o,r,t,n,le,i),r=I.A.clone(o,r)}return se(I.A.fromCartesian(e[0],ae),r,t,n,le,i),i.east-i.west>le.eastOverIdl-le.westOverIdl&&(i.west=le.westOverIdl,i.east=le.eastOverIdl,i.east>b.A.PI&&(i.east=i.east-b.A.TWO_PI),i.west>b.A.PI&&(i.west=i.west-b.A.TWO_PI)),b.A.equalsEpsilon(Math.abs(le.northAngle),b.A.TWO_PI,b.A.EPSILON10)&&(i.north=b.A.PI_OVER_TWO,i.east=b.A.PI,i.west=-b.A.PI),b.A.equalsEpsilon(Math.abs(le.southAngle),b.A.TWO_PI,b.A.EPSILON10)&&(i.south=-b.A.PI_OVER_TWO,i.east=b.A.PI,i.west=-b.A.PI),i};const ue=new I.A;function de(e,t,n){return e.height>=b.A.PI||e.width>=b.A.PI?I.A.fromCartesian(t[0],ue).tangentPlane:f.A.fromPoints(t,n)}const he=new c.A;function Ae(e,t,n){if(e.height>=b.A.PI||e.width>=b.A.PI)return(t,i)=>{if(e.south<0&&e.north>0){const e=n.cartesianToCartographic(t,he);return(0,h.A)(i)||(i=new s.A),i.x=e.longitude/b.A.PI,i.y=e.latitude/b.A.PI_OVER_TWO,i}return I.A.fromCartesian(t,i)};const i=f.A.fromPoints(t,n);return(e,t)=>i.projectPointsOntoPlane(e,t)}Z.createGeometry=function(e){const t=e._vertexFormat,n=e._ellipsoid,i=e._granularity,a=e._stRotation,c=e._polygonHierarchy,l=e._perPositionHeight,d=e._closeTop,A=e._closeBottom,p=e._arcType,w=e._textureCoordinates,E=(0,h.A)(w),S=c.positions;if(S.length<3)return;const P=e.rectangle,D=x.A.polygonsFromHierarchy(c,E,function(e,t,n){return(i,o)=>{if(e.height>=b.A.PI||e.width>=b.A.PI){if(e.south<0&&e.north>0){(0,h.A)(o)||(o=[]);for(let e=0;e<i.length;++e){const t=n.cartesianToCartographic(i[e],he);o[e]=new s.A(t.longitude/b.A.PI,t.latitude/b.A.PI_OVER_TWO)}return o.length=i.length,o}return I.A.fromCartesianArray(i,o)}return f.A.fromPoints(t,n).projectPointsOntoPlane(i,o)}}(P,S,n),!l,n,function(e,t,n,i){return(o,r)=>!i&&(e.height>=b.A.PI_OVER_TWO||e.width>=2*b.A.PI_OVER_THREE)?x.A.splitPolygonsOnEquator(o,t,n,r):o}(P,n,p,l)),O=D.hierarchy,R=D.polygons,M=E?x.A.polygonsFromHierarchy(w,!0,function(e){return e},!1,n).polygons:void 0;if(0===O.length)return;const N=O[0].outerRing,B=function(e,t,n,i){if(t.height>=b.A.PI||t.width>=b.A.PI)return o.A.fromRectangle(t,void 0,L);const r=e,s=f.A.fromPoints(r,n);return x.A.computeBoundingRectangle(s.plane.normal,s.projectPointOntoPlane.bind(s),r,i,L)}(N,P,n,a),F=[],U=e._height,k=e._extrudedHeight,V=e._perPositionHeightExtrude||!b.A.equalsEpsilon(U,k,0,b.A.EPSILON2),z={perPositionHeight:l,vertexFormat:t,geometry:void 0,rotationAxis:de(P,N,n).plane.normal,projectTo2d:Ae(P,N,n),boundingRectangle:B,ellipsoid:n,stRotation:a,textureCoordinates:void 0,bottom:!1,top:!0,wall:!1,extrude:!1,arcType:p};let H;if(V)for(z.extrude=!0,z.top=d,z.bottom=A,z.shadowVolume=e._shadowVolume,z.offsetAttribute=e._offsetAttribute,H=0;H<R.length;H++){const e=J(n,R[H],E?M[H]:void 0,i,O[H],l,d,A,t,p);let o;d&&A?(o=e.topAndBottom,z.geometry=x.A.scaleToGeodeticHeightExtruded(o.geometry,U,k,n,l)):d?(o=e.topAndBottom,o.geometry.attributes.position.values=C.A.scaleToGeodeticHeight(o.geometry.attributes.position.values,U,n,!l),z.geometry=o.geometry):A&&(o=e.topAndBottom,o.geometry.attributes.position.values=C.A.scaleToGeodeticHeight(o.geometry.attributes.position.values,k,n,!0),z.geometry=o.geometry),(d||A)&&(z.wall=!1,o.geometry=K(z),F.push(o));const r=e.walls;z.wall=!0;for(let e=0;e<r.length;e++){const t=r[e];z.geometry=x.A.scaleToGeodeticHeightExtruded(t.geometry,U,k,n,l),t.geometry=K(z),F.push(t)}}else for(H=0;H<R.length;H++){const o=new _.A({geometry:x.A.createGeometryFromPositions(n,R[H],E?M[H]:void 0,i,l,t,p)});if(o.geometry.attributes.position.values=C.A.scaleToGeodeticHeight(o.geometry.attributes.position.values,U,n,!l),z.geometry=o.geometry,o.geometry=K(z),(0,h.A)(e._offsetAttribute)){const t=o.geometry.attributes.position.values.length,n=e._offsetAttribute===y.A.NONE?0:1,i=new Uint8Array(t/3).fill(n);o.geometry.attributes.applyOffset=new g.A({componentDatatype:u.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}F.push(o)}const G=v.A.combineInstances(F)[0];G.attributes.position.values=new Float64Array(G.attributes.position.values),G.indices=T.A.createTypedArray(G.attributes.position.values.length/3,G.indices);const W=G.attributes,Y=r.A.fromVertices(W.position.values);return t.position||delete W.position,new m.A({attributes:W,indices:G.indices,primitiveType:G.primitiveType,boundingSphere:Y,offsetAttribute:e._offsetAttribute})},Z.createShadowVolume=function(e,t,n){const i=e._granularity,o=e._ellipsoid,r=t(i,o),s=n(i,o);return new Z({polygonHierarchy:e._polygonHierarchy,ellipsoid:o,stRotation:e._stRotation,granularity:i,perPositionHeight:!1,extrudedHeight:r,height:s,vertexFormat:P.A.POSITION_ONLY,shadowVolume:!0,arcType:e._arcType})},Object.defineProperties(Z.prototype,{rectangle:{get:function(){if(!(0,h.A)(this._rectangle)){const e=this._polygonHierarchy.positions;this._rectangle=Z.computeRectangleFromPositions(e,this._ellipsoid,this._arcType)}return this._rectangle}},textureCoordinateRotationPoints:{get:function(){return(0,h.A)(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=function(e){const t=-e._stRotation;if(0===t)return[0,0,0,1,1,0];const n=e._ellipsoid,i=e._polygonHierarchy.positions,o=e.rectangle;return m.A._textureCoordinateRotationPoints(i,t,n,o)}(this)),this._textureCoordinateRotationPoints}}});const pe=Z},71694:(e,t,n)=>{"use strict";n.d(t,{A:()=>ee});var i=n(215327),o=n(263604),r=n(434067),s=n(267980),a=n(336946),c=n(571804),l=n(491446),u=n(610750),d=n(551824),h=n(944479),A=n(305439),p=n(46362),f=n(34233),m=n(874915),g=n(150429),_=n(367817),y=n(331185),v=n(257941),T=n(105330),b=n(576770),w=n(402330),x=n(99479),C=n(67988),E=n(666765);const S={computeHierarchyPackedLength:function(e,t){let n=0;const i=[e];for(;i.length>0;){const e=i.pop();if(!(0,l.A)(e))continue;n+=2;const o=e.positions,r=e.holes;if((0,l.A)(o)&&o.length>0&&(n+=o.length*t.packedLength),(0,l.A)(r)){const e=r.length;for(let t=0;t<e;++t)i.push(r[t])}}return n},packPolygonHierarchy:function(e,t,n,i){const o=[e];for(;o.length>0;){const e=o.pop();if(!(0,l.A)(e))continue;const r=e.positions,s=e.holes;if(t[n++]=(0,l.A)(r)?r.length:0,t[n++]=(0,l.A)(s)?s.length:0,(0,l.A)(r)){const e=r.length;for(let o=0;o<e;++o,n+=i.packedLength)i.pack(r[o],t,n)}if((0,l.A)(s)){const e=s.length;for(let t=0;t<e;++t)o.push(s[t])}}return n},unpackPolygonHierarchy:function(e,t,n){const i=e[t++],o=e[t++],r=new Array(i),s=o>0?new Array(o):void 0;for(let o=0;o<i;++o,t+=n.packedLength)r[o]=n.unpack(e,t);for(let i=0;i<o;++i)s[i]=S.unpackPolygonHierarchy(e,t,n),t=s[i].startingIndex,delete s[i].startingIndex;return{positions:r,holes:s,startingIndex:t}}},I=new r.A;function P(e,t,n,i){return r.A.subtract(t,e,I),r.A.multiplyByScalar(I,n/i,I),r.A.add(e,I,I),[I.x,I.y]}const D=new s.A;function O(e,t,n,i){return s.A.subtract(t,e,D),s.A.multiplyByScalar(D,n/i,D),s.A.add(e,D,D),[D.x,D.y,D.z]}S.subdivideLineCount=function(e,t,n){const i=s.A.distance(e,t)/n,o=Math.max(0,Math.ceil(_.A.log2(i)));return Math.pow(2,o)};const R=new a.A,M=new a.A,L=new a.A,N=new s.A,B=new d.A;S.subdivideRhumbLineCount=function(e,t,n,i){const o=e.cartesianToCartographic(t,R),r=e.cartesianToCartographic(n,M),s=new d.A(o,r,e).surfaceDistance/i,a=Math.max(0,Math.ceil(_.A.log2(s)));return Math.pow(2,a)},S.subdivideTexcoordLine=function(e,t,n,i,o,s){const a=S.subdivideLineCount(n,i,o),c=r.A.distance(e,t),l=c/a,u=s;u.length=2*a;let d=0;for(let n=0;n<a;n++){const i=P(e,t,n*l,c);u[d++]=i[0],u[d++]=i[1]}return u},S.subdivideLine=function(e,t,n,i){const o=S.subdivideLineCount(e,t,n),r=s.A.distance(e,t),a=r/o;(0,l.A)(i)||(i=[]);const c=i;c.length=3*o;let u=0;for(let n=0;n<o;n++){const i=O(e,t,n*a,r);c[u++]=i[0],c[u++]=i[1],c[u++]=i[2]}return c},S.subdivideTexcoordRhumbLine=function(e,t,n,i,o,s,a){const c=n.cartesianToCartographic(i,R),l=n.cartesianToCartographic(o,M);B.setEndPoints(c,l);const u=B.surfaceDistance/s,d=Math.max(0,Math.ceil(_.A.log2(u))),h=Math.pow(2,d),A=r.A.distance(e,t),p=A/h,f=a;f.length=2*h;let m=0;for(let n=0;n<h;n++){const i=P(e,t,n*p,A);f[m++]=i[0],f[m++]=i[1]}return f},S.subdivideRhumbLine=function(e,t,n,i,o){const r=e.cartesianToCartographic(t,R),s=e.cartesianToCartographic(n,M),a=new d.A(r,s,e);if((0,l.A)(o)||(o=[]),a.surfaceDistance<=i)return o.length=3,o[0]=t.x,o[1]=t.y,o[2]=t.z,o;const c=a.surfaceDistance/i,u=Math.max(0,Math.ceil(_.A.log2(c))),h=Math.pow(2,u),A=a.surfaceDistance/h,p=o;p.length=3*h;let f=0;for(let t=0;t<h;t++){const n=a.interpolateUsingSurfaceDistance(t*A,L),i=e.cartographicToCartesian(n,N);p[f++]=i.x,p[f++]=i.y,p[f++]=i.z}return p};const F=new s.A,U=new s.A,k=new s.A,V=new s.A;S.scaleToGeodeticHeightExtruded=function(e,t,n,i,o){i=i??u.A.default;const r=F;let a=U;const c=k;let d=V;if((0,l.A)(e)&&(0,l.A)(e.attributes)&&(0,l.A)(e.attributes.position)){const l=e.attributes.position.values,u=l.length/2;for(let e=0;e<u;e+=3)s.A.fromArray(l,e,c),i.geodeticSurfaceNormal(c,r),d=i.scaleToGeodeticSurface(c,d),a=s.A.multiplyByScalar(r,n,a),a=s.A.add(d,a,a),l[e+u]=a.x,l[e+1+u]=a.y,l[e+2+u]=a.z,o&&(d=s.A.clone(c,d)),a=s.A.multiplyByScalar(r,t,a),a=s.A.add(d,a,a),l[e]=a.x,l[e+1]=a.y,l[e+2]=a.z}return e},S.polygonOutlinesFromHierarchy=function(e,t,n){const i=[],r=new C.A;let a,c,u;for(r.enqueue(e);0!==r.length;){const e=r.dequeue();let d=e.positions;if(t)for(u=d.length,a=0;a<u;a++)n.scaleToGeodeticSurface(d[a],d[a]);if(d=(0,o.A)(d,s.A.equalsEpsilon,!0),d.length<3)continue;const h=e.holes?e.holes.length:0;for(a=0;a<h;a++){const d=e.holes[a];let h=d.positions;if(t)for(u=h.length,c=0;c<u;++c)n.scaleToGeodeticSurface(h[c],h[c]);if(h=(0,o.A)(h,s.A.equalsEpsilon,!0),h.length<3)continue;i.push(h);let A=0;for((0,l.A)(d.holes)&&(A=d.holes.length),c=0;c<A;c++)r.enqueue(d.holes[c])}i.push(d)}return i};const z=new a.A;function H(e,t,n,o){if(o===i.A.RHUMB)return function(e,t,n){const i=n.cartesianToCartographic(e,R),o=n.cartesianToCartographic(t,M);if(Math.sign(i.latitude)===Math.sign(o.latitude))return;B.setEndPoints(i,o);const r=B.findIntersectionWithLatitude(0,z);if(!(0,l.A)(r))return;let s=Math.min(i.longitude,o.longitude),a=Math.max(i.longitude,o.longitude);if(Math.abs(a-s)>_.A.PI){const e=s;s=a,a=e}return r.longitude<s||r.longitude>a?void 0:n.cartographicToCartesian(r)}(e,t,n);const r=g.A.lineSegmentPlane(e,t,v.A.ORIGIN_XY_PLANE);return(0,l.A)(r)?n.scaleToGeodeticSurface(r,r):void 0}const G=new a.A;function W(e,t,n){const i=[];let o,r,s,a,c,u=0;for(;u<e.length;){o=e[u],r=e[(u+1)%e.length],s=_.A.sign(o.z),a=_.A.sign(r.z);const d=e=>t.cartesianToCartographic(e,G).longitude;if(0===s)i.push({position:u,type:s,visited:!1,next:a,theta:d(o)});else if(0!==a){if(c=H(o,r,t,n),++u,!(0,l.A)(c))continue;e.splice(u,0,c),i.push({position:u,type:s,visited:!1,next:a,theta:d(c)})}++u}return i}function Y(e,t,n,i,o,r,s){const a=[];let c=r;const u=e=>t=>t.position===e,d=[];do{const e=n[c];a.push(e);const t=i.findIndex(u(c)),o=i[t];if(!(0,l.A)(o)){++c;continue}const{visited:h,type:A,next:p}=o;if(o.visited=!0,0===A){if(0===p){const e=i[t-(s?1:-1)];if(e?.position!==c+1){++c;continue}e.visited=!0}if(!h&&s&&p>0||r===c&&!s&&p<0){++c;continue}}if(!(s?A>=0:A<=0)){++c;continue}h||d.push(c);const f=i[t+(s?1:-1)];(0,l.A)(f)?c=f.position:++c}while(c<n.length&&c>=0&&c!==r&&a.length<n.length);e.splice(t,o,a);for(const o of d)t=Y(e,++t,n,i,0,o,!s);return t}S.splitPolygonsOnEquator=function(e,t,n,i){(0,l.A)(i)||(i=[]),i.splice(0,0,...e),i.length=e.length;let o=0;for(;o<i.length;){const e=i[o],r=e.slice();if(e.length<3){i[o]=r,++o;continue}const s=W(r,t,n);r.length===e.length||s.length<=1?(i[o]=r,++o):(s.sort((e,t)=>e.theta-t.theta),o=Y(i,o,r,s,1,0,r[0].z>=0))}return i},S.polygonsFromHierarchy=function(e,t,n,i,r,a){const c=[],u=[],d=new C.A;d.enqueue(e);let h=(0,l.A)(a);for(;0!==d.length;){const e=d.dequeue();let A=e.positions;const p=e.holes;let f,m;if(i)for(m=A.length,f=0;f<m;f++)r.scaleToGeodeticSurface(A[f],A[f]);if(t||(A=(0,o.A)(A,s.A.equalsEpsilon,!0)),A.length<3)continue;let g=n(A);if(!(0,l.A)(g))continue;const _=[];let y=b.A.computeWindingOrder2D(g);if(y===E.A.CLOCKWISE&&(g.reverse(),A=A.slice().reverse()),h){h=!1;let e=[A];if(e=a(e,e),e.length>1){for(const t of e)d.enqueue(new T.A(t,p));continue}}let v=A.slice();const w=(0,l.A)(p)?p.length:0,x=[];let C;for(f=0;f<w;f++){const e=p[f];let a=e.positions;if(i)for(m=a.length,C=0;C<m;++C)r.scaleToGeodeticSurface(a[C],a[C]);if(t||(a=(0,o.A)(a,s.A.equalsEpsilon,!0)),a.length<3)continue;const c=n(a);if(!(0,l.A)(c))continue;y=b.A.computeWindingOrder2D(c),y===E.A.CLOCKWISE&&(c.reverse(),a=a.slice().reverse()),x.push(a),_.push(v.length),v=v.concat(a),g=g.concat(c);let u=0;for((0,l.A)(e.holes)&&(u=e.holes.length),C=0;C<u;C++)d.enqueue(e.holes[C])}c.push({outerRing:A,holes:x}),u.push({positions:v,positions2D:g,holes:_})}return{hierarchy:c,polygons:u}};const q=new r.A,j=new s.A,Q=new x.A,X=new y.A;S.computeBoundingRectangle=function(e,t,n,i,o){const r=x.A.fromAxisAngle(e,i,Q),a=y.A.fromQuaternion(r,X);let c=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,d=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY;const A=n.length;for(let e=0;e<A;++e){const i=s.A.clone(n[e],j);y.A.multiplyByVector(a,i,i);const o=t(i,q);(0,l.A)(o)&&(c=Math.min(c,o.x),u=Math.max(u,o.x),d=Math.min(d,o.y),h=Math.max(h,o.y))}return o.x=c,o.y=d,o.width=u-c,o.height=h-d,o},S.createGeometryFromPositions=function(e,t,n,o,s,a,u){let d=b.A.triangulate(t.positions2D,t.holes);d.length<3&&(d=[0,1,2]);const p=t.positions,m=(0,l.A)(n),g=m?n.positions:void 0;if(s){const e=p.length,t=new Array(3*e);let n=0;for(let i=0;i<e;i++){const e=p[i];t[n++]=e.x,t[n++]=e.y,t[n++]=e.z}const i={attributes:{position:new A.A({componentDatatype:c.A.DOUBLE,componentsPerAttribute:3,values:t})},indices:d,primitiveType:w.A.TRIANGLES};m&&(i.attributes.st=new A.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:2,values:r.A.packArray(g)}));const o=new h.A(i);return a.normal?f.A.computeNormal(o):o}return u===i.A.GEODESIC?b.A.computeSubdivision(e,p,d,g,o):u===i.A.RHUMB?b.A.computeRhumbLineSubdivision(e,p,d,g,o):void 0};const K=[],$=[],J=new s.A,Z=new s.A;S.computeWallGeometry=function(e,t,n,o,r,a){let u,d,f,g,y,v,T,b,x,C=e.length,E=0,I=0;const P=(0,l.A)(t),D=P?t.positions:void 0;if(r)for(d=3*C*2,u=new Array(2*d),P&&(x=2*C*2,b=new Array(2*x)),f=0;f<C;f++)g=e[f],y=e[(f+1)%C],u[E]=u[E+d]=g.x,++E,u[E]=u[E+d]=g.y,++E,u[E]=u[E+d]=g.z,++E,u[E]=u[E+d]=y.x,++E,u[E]=u[E+d]=y.y,++E,u[E]=u[E+d]=y.z,++E,P&&(v=D[f],T=D[(f+1)%C],b[I]=b[I+x]=v.x,++I,b[I]=b[I+x]=v.y,++I,b[I]=b[I+x]=T.x,++I,b[I]=b[I+x]=T.y,++I);else{const t=_.A.chordLength(o,n.maximumRadius);let r=0;if(a===i.A.GEODESIC)for(f=0;f<C;f++)r+=S.subdivideLineCount(e[f],e[(f+1)%C],t);else if(a===i.A.RHUMB)for(f=0;f<C;f++)r+=S.subdivideRhumbLineCount(n,e[f],e[(f+1)%C],t);for(d=3*(r+C),u=new Array(2*d),P&&(x=2*(r+C),b=new Array(2*x)),f=0;f<C;f++){let o,r;g=e[f],y=e[(f+1)%C],P&&(v=D[f],T=D[(f+1)%C]),a===i.A.GEODESIC?(o=S.subdivideLine(g,y,t,$),P&&(r=S.subdivideTexcoordLine(v,T,g,y,t,K))):a===i.A.RHUMB&&(o=S.subdivideRhumbLine(n,g,y,t,$),P&&(r=S.subdivideTexcoordRhumbLine(v,T,n,g,y,t,K)));const s=o.length;for(let e=0;e<s;++e,++E)u[E]=o[e],u[E+d]=o[e];if(u[E]=y.x,u[E+d]=y.x,++E,u[E]=y.y,u[E+d]=y.y,++E,u[E]=y.z,u[E+d]=y.z,++E,P){const e=r.length;for(let t=0;t<e;++t,++I)b[I]=r[t],b[I+x]=r[t];b[I]=T.x,b[I+x]=T.x,++I,b[I]=T.y,b[I+x]=T.y,++I}}}C=u.length;const O=m.A.createTypedArray(C/3,C-6*e.length);let R=0;for(C/=6,f=0;f<C;f++){const e=f,t=e+1,n=e+C,i=n+1;g=s.A.fromArray(u,3*e,J),y=s.A.fromArray(u,3*t,Z),s.A.equalsEpsilon(g,y,_.A.EPSILON10,_.A.EPSILON10)||(O[R++]=e,O[R++]=n,O[R++]=t,O[R++]=t,O[R++]=n,O[R++]=i)}const M={attributes:new p.A({position:new A.A({componentDatatype:c.A.DOUBLE,componentsPerAttribute:3,values:u})}),indices:O,primitiveType:w.A.TRIANGLES};return P&&(M.attributes.st=new A.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:2,values:b})),new h.A(M)};const ee=S},576770:(e,t,n)=>{"use strict";function i(e,t,n,i,o){let r;if(o===function(e,t,n,i){let o=0;for(let r=t,s=n-i;r<n;r+=i)o+=(e[s]-e[r])*(e[r+1]+e[s+1]),s=r;return o}(e,t,n,i)>0)for(let o=t;o<n;o+=i)r=C(o/i|0,e[o],e[o+1],r);else for(let o=n-i;o>=t;o-=i)r=C(o/i|0,e[o],e[o+1],r);return r&&y(r,r.next)&&(E(r),r=r.next),r}function o(e,t){if(!e)return e;t||(t=e);let n,i=e;do{if(n=!1,i.steiner||!y(i,i.next)&&0!==_(i.prev,i,i.next))i=i.next;else{if(E(i),i=t=i.prev,i===i.next)break;n=!0}}while(n||i!==t);return t}function r(e,t,n,i,u,d,h){if(!e)return;!h&&d&&function(e,t,n,i){let o=e;do{0===o.z&&(o.z=A(o.x,o.y,t,n,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){let t,n=1;do{let i,o=e;e=null;let r=null;for(t=0;o;){t++;let s=o,a=0;for(let e=0;e<n&&(a++,s=s.nextZ,s);e++);let c=n;for(;a>0||c>0&&s;)0!==a&&(0===c||!s||o.z<=s.z)?(i=o,o=o.nextZ,a--):(i=s,s=s.nextZ,c--),r?r.nextZ=i:e=i,i.prevZ=r,r=i;o=s}r.nextZ=null,n*=2}while(t>1)}(o)}(e,i,u,d);let p=e;for(;e.prev!==e.next;){const A=e.prev,f=e.next;if(d?a(e,i,u,d):s(e))t.push(A.i,e.i,f.i),E(e),e=f.next,p=f.next;else if((e=f)===p){h?1===h?r(e=c(o(e),t),t,n,i,u,d,2):2===h&&l(e,t,n,i,u,d):r(o(e),t,n,i,u,d,1);break}}}function s(e){const t=e.prev,n=e,i=e.next;if(_(t,n,i)>=0)return!1;const o=t.x,r=n.x,s=i.x,a=t.y,c=n.y,l=i.y,u=Math.min(o,r,s),d=Math.min(a,c,l),h=Math.max(o,r,s),A=Math.max(a,c,l);let p=i.next;for(;p!==t;){if(p.x>=u&&p.x<=h&&p.y>=d&&p.y<=A&&m(o,a,r,c,s,l,p.x,p.y)&&_(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function a(e,t,n,i){const o=e.prev,r=e,s=e.next;if(_(o,r,s)>=0)return!1;const a=o.x,c=r.x,l=s.x,u=o.y,d=r.y,h=s.y,p=Math.min(a,c,l),f=Math.min(u,d,h),g=Math.max(a,c,l),y=Math.max(u,d,h),v=A(p,f,t,n,i),T=A(g,y,t,n,i);let b=e.prevZ,w=e.nextZ;for(;b&&b.z>=v&&w&&w.z<=T;){if(b.x>=p&&b.x<=g&&b.y>=f&&b.y<=y&&b!==o&&b!==s&&m(a,u,c,d,l,h,b.x,b.y)&&_(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,w.x>=p&&w.x<=g&&w.y>=f&&w.y<=y&&w!==o&&w!==s&&m(a,u,c,d,l,h,w.x,w.y)&&_(w.prev,w,w.next)>=0)return!1;w=w.nextZ}for(;b&&b.z>=v;){if(b.x>=p&&b.x<=g&&b.y>=f&&b.y<=y&&b!==o&&b!==s&&m(a,u,c,d,l,h,b.x,b.y)&&_(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;w&&w.z<=T;){if(w.x>=p&&w.x<=g&&w.y>=f&&w.y<=y&&w!==o&&w!==s&&m(a,u,c,d,l,h,w.x,w.y)&&_(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function c(e,t){let n=e;do{const i=n.prev,o=n.next.next;!y(i,o)&&v(i,n,n.next,o)&&w(i,o)&&w(o,i)&&(t.push(i.i,n.i,o.i),E(n),E(n.next),n=e=o),n=n.next}while(n!==e);return o(n)}function l(e,t,n,i,s,a){let c=e;do{let e=c.next.next;for(;e!==c.prev;){if(c.i!==e.i&&g(c,e)){let l=x(c,e);return c=o(c,c.next),l=o(l,l.next),r(c,t,n,i,s,a,0),void r(l,t,n,i,s,a,0)}e=e.next}c=c.next}while(c!==e)}function u(e,t){let n=e.x-t.x;return 0===n&&(n=e.y-t.y,0===n)&&(n=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)),n}function d(e,t){const n=function(e,t){let n=t;const i=e.x,o=e.y;let r,s=-1/0;if(y(e,n))return n;do{if(y(e,n.next))return n.next;if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){const e=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=i&&e>s&&(s=e,r=n.x<n.next.x?n:n.next,e===i))return r}n=n.next}while(n!==t);if(!r)return null;const a=r,c=r.x,l=r.y;let u=1/0;n=r;do{if(i>=n.x&&n.x>=c&&i!==n.x&&f(o<l?i:s,o,c,l,o<l?s:i,o,n.x,n.y)){const t=Math.abs(o-n.y)/(i-n.x);w(n,e)&&(t<u||t===u&&(n.x>r.x||n.x===r.x&&h(r,n)))&&(r=n,u=t)}n=n.next}while(n!==a);return r}(e,t);if(!n)return t;const i=x(n,e);return o(i,i.next),o(n,n.next)}function h(e,t){return _(e.prev,e,t.prev)<0&&_(t.next,e,e.next)<0}function A(e,t,n,i,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function p(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function f(e,t,n,i,o,r,s,a){return(o-s)*(t-a)>=(e-s)*(r-a)&&(e-s)*(i-a)>=(n-s)*(t-a)&&(n-s)*(r-a)>=(o-s)*(i-a)}function m(e,t,n,i,o,r,s,a){return!(e===s&&t===a)&&f(e,t,n,i,o,r,s,a)}function g(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&v(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(w(e,t)&&w(t,e)&&function(e,t){let n=e,i=!1;const o=(e.x+t.x)/2,r=(e.y+t.y)/2;do{n.y>r!=n.next.y>r&&n.next.y!==n.y&&o<(n.next.x-n.x)*(r-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(_(e.prev,e,t.prev)||_(e,t.prev,t))||y(e,t)&&_(e.prev,e,e.next)>0&&_(t.prev,t,t.next)>0)}function _(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function y(e,t){return e.x===t.x&&e.y===t.y}function v(e,t,n,i){const o=b(_(e,t,n)),r=b(_(e,t,i)),s=b(_(n,i,e)),a=b(_(n,i,t));return o!==r&&s!==a||!(0!==o||!T(e,n,t))||!(0!==r||!T(e,i,t))||!(0!==s||!T(n,e,i))||!(0!==a||!T(n,t,i))}function T(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function b(e){return e>0?1:e<0?-1:0}function w(e,t){return _(e.prev,e,e.next)<0?_(e,t,e.next)>=0&&_(e,e.prev,t)>=0:_(e,t,e.prev)<0||_(e,e.next,t)<0}function x(e,t){const n=S(e.i,e.x,e.y),i=S(t.i,t.x,t.y),o=e.next,r=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,i.next=n,n.prev=i,r.next=i,i.prev=r,i}function C(e,t,n,i){const o=S(e,t,n);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function E(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function S(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}n.d(t,{A:()=>re});var I=n(434067),P=n(267980),D=n(336946),O=n(369031),R=n(571804),M=n(491446),L=n(610750),N=n(551824),B=n(944479),F=n(305439),U=n(367817),k=n(402330),V=n(666765);const z=new P.A,H=new P.A,G={computeArea2D:function(e){O.A.defined("positions",e),O.A.typeOf.number.greaterThanOrEquals("positions.length",e.length,3);const t=e.length;let n=0;for(let i=t-1,o=0;o<t;i=o++){const t=e[i],r=e[o];n+=t.x*r.y-r.x*t.y}return.5*n},computeWindingOrder2D:function(e){return G.computeArea2D(e)>0?V.A.COUNTER_CLOCKWISE:V.A.CLOCKWISE},triangulate:function(e,t){return O.A.defined("positions",e),function(e,t,n=2){const o=t&&t.length,s=o?t[0]*n:e.length;let a=i(e,0,s,n,!0);const c=[];if(!a||a.next===a.prev)return c;let l,h,A;if(o&&(a=function(e,t,n,o){const r=[];for(let n=0,s=t.length;n<s;n++){const a=i(e,t[n]*o,n<s-1?t[n+1]*o:e.length,o,!1);a===a.next&&(a.steiner=!0),r.push(p(a))}r.sort(u);for(let e=0;e<r.length;e++)n=d(r[e],n);return n}(e,t,a,n)),e.length>80*n){l=e[0],h=e[1];let t=l,i=h;for(let o=n;o<s;o+=n){const n=e[o],r=e[o+1];n<l&&(l=n),r<h&&(h=r),n>t&&(t=n),r>i&&(i=r)}A=Math.max(t-l,i-h),A=0!==A?32767/A:0}return r(a,c,n,l,h,A,0),c}(I.A.packArray(e),t,2)}},W=new P.A,Y=new P.A,q=new P.A,j=new P.A,Q=new P.A,X=new P.A,K=new P.A,$=new I.A,J=new I.A,Z=new I.A,ee=new I.A;G.computeSubdivision=function(e,t,n,i,o){o=o??U.A.RADIANS_PER_DEGREE;const r=(0,M.A)(i);O.A.typeOf.object("ellipsoid",e),O.A.defined("positions",t),O.A.defined("indices",n),O.A.typeOf.number.greaterThanOrEquals("indices.length",n.length,3),O.A.typeOf.number.equals("indices.length % 3","0",n.length%3,0),O.A.typeOf.number.greaterThan("granularity",o,0);const s=n.slice(0);let a;const c=t.length,l=new Array(3*c),u=new Array(2*c);let d=0,h=0;for(a=0;a<c;a++){const e=t[a];if(l[d++]=e.x,l[d++]=e.y,l[d++]=e.z,r){const e=i[a];u[h++]=e.x,u[h++]=e.y}}const A=[],p={},f=e.maximumRadius,m=U.A.chordLength(o,f),g=m*m;for(;s.length>0;){const e=s.pop(),t=s.pop(),n=s.pop(),i=P.A.fromArray(l,3*n,W),o=P.A.fromArray(l,3*t,Y),c=P.A.fromArray(l,3*e,q);let d,h,m;r&&(d=I.A.fromArray(u,2*n,$),h=I.A.fromArray(u,2*t,J),m=I.A.fromArray(u,2*e,Z));const _=P.A.multiplyByScalar(P.A.normalize(i,j),f,j),y=P.A.multiplyByScalar(P.A.normalize(o,Q),f,Q),v=P.A.multiplyByScalar(P.A.normalize(c,X),f,X),T=P.A.magnitudeSquared(P.A.subtract(_,y,K)),b=P.A.magnitudeSquared(P.A.subtract(y,v,K)),w=P.A.magnitudeSquared(P.A.subtract(v,_,K)),x=Math.max(T,b,w);let C,E,S;x>g?T===x?(C=`${Math.min(n,t)} ${Math.max(n,t)}`,a=p[C],(0,M.A)(a)||(E=P.A.add(i,o,K),P.A.multiplyByScalar(E,.5,E),l.push(E.x,E.y,E.z),a=l.length/3-1,p[C]=a,r&&(S=I.A.add(d,h,ee),I.A.multiplyByScalar(S,.5,S),u.push(S.x,S.y))),s.push(n,a,e),s.push(a,t,e)):b===x?(C=`${Math.min(t,e)} ${Math.max(t,e)}`,a=p[C],(0,M.A)(a)||(E=P.A.add(o,c,K),P.A.multiplyByScalar(E,.5,E),l.push(E.x,E.y,E.z),a=l.length/3-1,p[C]=a,r&&(S=I.A.add(h,m,ee),I.A.multiplyByScalar(S,.5,S),u.push(S.x,S.y))),s.push(t,a,n),s.push(a,e,n)):w===x&&(C=`${Math.min(e,n)} ${Math.max(e,n)}`,a=p[C],(0,M.A)(a)||(E=P.A.add(c,i,K),P.A.multiplyByScalar(E,.5,E),l.push(E.x,E.y,E.z),a=l.length/3-1,p[C]=a,r&&(S=I.A.add(m,d,ee),I.A.multiplyByScalar(S,.5,S),u.push(S.x,S.y))),s.push(e,a,t),s.push(a,n,t)):(A.push(n),A.push(t),A.push(e))}const _={attributes:{position:new F.A({componentDatatype:R.A.DOUBLE,componentsPerAttribute:3,values:l})},indices:A,primitiveType:k.A.TRIANGLES};return r&&(_.attributes.st=new F.A({componentDatatype:R.A.FLOAT,componentsPerAttribute:2,values:u})),new B.A(_)};const te=new D.A,ne=new D.A,ie=new D.A,oe=new D.A;G.computeRhumbLineSubdivision=function(e,t,n,i,o){o=o??U.A.RADIANS_PER_DEGREE;const r=(0,M.A)(i);O.A.typeOf.object("ellipsoid",e),O.A.defined("positions",t),O.A.defined("indices",n),O.A.typeOf.number.greaterThanOrEquals("indices.length",n.length,3),O.A.typeOf.number.equals("indices.length % 3","0",n.length%3,0),O.A.typeOf.number.greaterThan("granularity",o,0);const s=n.slice(0);let a;const c=t.length,l=new Array(3*c),u=new Array(2*c);let d=0,h=0;for(a=0;a<c;a++){const e=t[a];if(l[d++]=e.x,l[d++]=e.y,l[d++]=e.z,r){const e=i[a];u[h++]=e.x,u[h++]=e.y}}const A=[],p={},f=e.maximumRadius,m=U.A.chordLength(o,f),g=new N.A(void 0,void 0,e),_=new N.A(void 0,void 0,e),y=new N.A(void 0,void 0,e);for(;s.length>0;){const t=s.pop(),n=s.pop(),i=s.pop(),o=P.A.fromArray(l,3*i,W),c=P.A.fromArray(l,3*n,Y),d=P.A.fromArray(l,3*t,q);let h,f,v;r&&(h=I.A.fromArray(u,2*i,$),f=I.A.fromArray(u,2*n,J),v=I.A.fromArray(u,2*t,Z));const T=e.cartesianToCartographic(o,te),b=e.cartesianToCartographic(c,ne),w=e.cartesianToCartographic(d,ie);g.setEndPoints(T,b);const x=g.surfaceDistance;_.setEndPoints(b,w);const C=_.surfaceDistance;y.setEndPoints(w,T);const E=y.surfaceDistance,S=Math.max(x,C,E);let D,O,R,L,N;S>m?x===S?(D=`${Math.min(i,n)} ${Math.max(i,n)}`,a=p[D],(0,M.A)(a)||(O=g.interpolateUsingFraction(.5,oe),R=.5*(T.height+b.height),L=P.A.fromRadians(O.longitude,O.latitude,R,e,K),l.push(L.x,L.y,L.z),a=l.length/3-1,p[D]=a,r&&(N=I.A.add(h,f,ee),I.A.multiplyByScalar(N,.5,N),u.push(N.x,N.y))),s.push(i,a,t),s.push(a,n,t)):C===S?(D=`${Math.min(n,t)} ${Math.max(n,t)}`,a=p[D],(0,M.A)(a)||(O=_.interpolateUsingFraction(.5,oe),R=.5*(b.height+w.height),L=P.A.fromRadians(O.longitude,O.latitude,R,e,K),l.push(L.x,L.y,L.z),a=l.length/3-1,p[D]=a,r&&(N=I.A.add(f,v,ee),I.A.multiplyByScalar(N,.5,N),u.push(N.x,N.y))),s.push(n,a,i),s.push(a,t,i)):E===S&&(D=`${Math.min(t,i)} ${Math.max(t,i)}`,a=p[D],(0,M.A)(a)||(O=y.interpolateUsingFraction(.5,oe),R=.5*(w.height+T.height),L=P.A.fromRadians(O.longitude,O.latitude,R,e,K),l.push(L.x,L.y,L.z),a=l.length/3-1,p[D]=a,r&&(N=I.A.add(v,h,ee),I.A.multiplyByScalar(N,.5,N),u.push(N.x,N.y))),s.push(t,a,n),s.push(a,i,n)):(A.push(i),A.push(n),A.push(t))}const v={attributes:{position:new F.A({componentDatatype:R.A.DOUBLE,componentsPerAttribute:3,values:l})},indices:A,primitiveType:k.A.TRIANGLES};return r&&(v.attributes.st=new F.A({componentDatatype:R.A.FLOAT,componentsPerAttribute:2,values:u})),new B.A(v)},G.scaleToGeodeticHeight=function(e,t,n,i){n=n??L.A.default;let o=z,r=H;if(t=t??0,i=i??!0,(0,M.A)(e)){const s=e.length;for(let a=0;a<s;a+=3)P.A.fromArray(e,a,r),i&&(r=n.scaleToGeodeticSurface(r,r)),0!==t&&(o=n.geodeticSurfaceNormal(r,o),P.A.multiplyByScalar(o,t,o),P.A.add(r,o,r)),e[a]=r.x,e[a+1]=r.y,e[a+2]=r.z}return e};const re=G},977363:(e,t,n)=>{"use strict";n.d(t,{A:()=>R});var i=n(215327),o=n(263604),r=n(660662),s=n(267980),a=n(41476),c=n(571804),l=n(915325),u=n(491446),d=n(605971),h=n(610750),A=n(944479),p=n(305439),f=n(46362),m=n(597751),g=n(874915),_=n(367817),y=n(870349),v=n(402330),T=n(769534);const b=[];function w(e,t,n,i,o){const r=b;let s;r.length=o;const c=n.red,l=n.green,u=n.blue,d=n.alpha,h=i.red,A=i.green,p=i.blue,f=i.alpha;if(a.A.equals(n,i)){for(s=0;s<o;s++)r[s]=a.A.clone(n);return r}const m=(h-c)/o,g=(A-l)/o,_=(p-u)/o,y=(f-d)/o;for(s=0;s<o;s++)r[s]=new a.A(c+s*m,l+s*g,u+s*_,d+s*y);return r}function x(e){const t=(e=e??l.A.EMPTY_OBJECT).positions,n=e.colors,o=e.width??1,r=e.colorsPerVertex??!1;if(!(0,u.A)(t)||t.length<2)throw new d.A("At least two positions are required.");if("number"!=typeof o)throw new d.A("width must be a number");if((0,u.A)(n)&&(r&&n.length<t.length||!r&&n.length<t.length-1))throw new d.A("colors has an invalid length.");this._positions=t,this._colors=n,this._width=o,this._colorsPerVertex=r,this._vertexFormat=T.A.clone(e.vertexFormat??T.A.DEFAULT),this._arcType=e.arcType??i.A.GEODESIC,this._granularity=e.granularity??_.A.RADIANS_PER_DEGREE,this._ellipsoid=h.A.clone(e.ellipsoid??h.A.default),this._workerName="createPolylineGeometry";let c=1+t.length*s.A.packedLength;c+=(0,u.A)(n)?1+n.length*a.A.packedLength:1,this.packedLength=c+h.A.packedLength+T.A.packedLength+4}x.pack=function(e,t,n){if(!(0,u.A)(e))throw new d.A("value is required");if(!(0,u.A)(t))throw new d.A("array is required");let i;n=n??0;const o=e._positions;let r=o.length;for(t[n++]=r,i=0;i<r;++i,n+=s.A.packedLength)s.A.pack(o[i],t,n);const c=e._colors;for(r=(0,u.A)(c)?c.length:0,t[n++]=r,i=0;i<r;++i,n+=a.A.packedLength)a.A.pack(c[i],t,n);return h.A.pack(e._ellipsoid,t,n),n+=h.A.packedLength,T.A.pack(e._vertexFormat,t,n),n+=T.A.packedLength,t[n++]=e._width,t[n++]=e._colorsPerVertex?1:0,t[n++]=e._arcType,t[n]=e._granularity,t};const C=h.A.clone(h.A.UNIT_SPHERE),E=new T.A,S={positions:void 0,colors:void 0,ellipsoid:C,vertexFormat:E,width:void 0,colorsPerVertex:void 0,arcType:void 0,granularity:void 0};x.unpack=function(e,t,n){if(!(0,u.A)(e))throw new d.A("array is required");let i;t=t??0;let o=e[t++];const r=new Array(o);for(i=0;i<o;++i,t+=s.A.packedLength)r[i]=s.A.unpack(e,t);o=e[t++];const c=o>0?new Array(o):void 0;for(i=0;i<o;++i,t+=a.A.packedLength)c[i]=a.A.unpack(e,t);const l=h.A.unpack(e,t,C);t+=h.A.packedLength;const A=T.A.unpack(e,t,E);t+=T.A.packedLength;const p=e[t++],f=1===e[t++],m=e[t++],g=e[t];return(0,u.A)(n)?(n._positions=r,n._colors=c,n._ellipsoid=h.A.clone(l,n._ellipsoid),n._vertexFormat=T.A.clone(A,n._vertexFormat),n._width=p,n._colorsPerVertex=f,n._arcType=m,n._granularity=g,n):(S.positions=r,S.colors=c,S.width=p,S.colorsPerVertex=f,S.arcType=m,S.granularity=g,new x(S))};const I=new s.A,P=new s.A,D=new s.A,O=new s.A;x.createGeometry=function(e){const t=e._width,n=e._vertexFormat;let l=e._colors;const d=e._colorsPerVertex,h=e._arcType,T=e._granularity,x=e._ellipsoid;let C,E,S;const R=[];let M=(0,o.A)(e._positions,s.A.equalsEpsilon,!1,R);if((0,u.A)(l)&&R.length>0){let e=0,t=R[0];l=l.filter(function(n,i){let o=!1;return o=d?i===t||0===i&&1===t:i+1===t,!o||(e++,t=R[e],!1)})}let L=M.length;if(L<2||t<=0)return;if(h===i.A.GEODESIC||h===i.A.RHUMB){let e,t;h===i.A.GEODESIC?(e=_.A.chordLength(T,x.maximumRadius),t=y.A.numberOfPoints):(e=T,t=y.A.numberOfPointsRhumbLine);const n=y.A.extractHeights(M,x);if((0,u.A)(l)){let n=1;for(C=0;C<L-1;++C)n+=t(M[C],M[C+1],e);const i=new Array(n);let o=0;for(C=0;C<L-1;++C){const r=M[C],s=M[C+1],c=l[C],u=t(r,s,e);if(d&&C<n){const e=w(0,0,c,l[C+1],u),t=e.length;for(E=0;E<t;++E)i[o++]=e[E]}else for(E=0;E<u;++E)i[o++]=a.A.clone(c)}i[o]=a.A.clone(l[l.length-1]),l=i,b.length=0}M=h===i.A.GEODESIC?y.A.generateCartesianArc({positions:M,minDistance:e,ellipsoid:x,height:n}):y.A.generateCartesianRhumbArc({positions:M,granularity:e,ellipsoid:x,height:n})}L=M.length;const N=4*L-4,B=new Float64Array(3*N),F=new Float64Array(3*N),U=new Float64Array(3*N),k=new Float32Array(2*N),V=n.st?new Float32Array(2*N):void 0,z=(0,u.A)(l)?new Uint8Array(4*N):void 0;let H,G=0,W=0,Y=0,q=0;for(E=0;E<L;++E){let e,i;0===E?(H=I,s.A.subtract(M[0],M[1],H),s.A.add(M[0],H,H)):H=M[E-1],s.A.clone(H,D),s.A.clone(M[E],P),E===L-1?(H=I,s.A.subtract(M[L-1],M[L-2],H),s.A.add(M[L-1],H,H)):H=M[E+1],s.A.clone(H,O),(0,u.A)(z)&&(e=0===E||d?l[E]:l[E-1],E!==L-1&&(i=l[E]));const o=E===L-1?2:4;for(S=0===E?2:0;S<o;++S){s.A.pack(P,B,G),s.A.pack(D,F,G),s.A.pack(O,U,G),G+=3;const o=S-2<0?-1:1;if(k[W++]=S%2*2-1,k[W++]=o*t,n.st&&(V[Y++]=E/(L-1),V[Y++]=Math.max(k[W-2],0)),(0,u.A)(z)){const t=S<2?e:i;z[q++]=a.A.floatToByte(t.red),z[q++]=a.A.floatToByte(t.green),z[q++]=a.A.floatToByte(t.blue),z[q++]=a.A.floatToByte(t.alpha)}}}const j=new f.A;j.position=new p.A({componentDatatype:c.A.DOUBLE,componentsPerAttribute:3,values:B}),j.prevPosition=new p.A({componentDatatype:c.A.DOUBLE,componentsPerAttribute:3,values:F}),j.nextPosition=new p.A({componentDatatype:c.A.DOUBLE,componentsPerAttribute:3,values:U}),j.expandAndWidth=new p.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:2,values:k}),n.st&&(j.st=new p.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:2,values:V})),(0,u.A)(z)&&(j.color=new p.A({componentDatatype:c.A.UNSIGNED_BYTE,componentsPerAttribute:4,values:z,normalize:!0}));const Q=g.A.createTypedArray(N,6*L-6);let X=0,K=0;const $=L-1;for(E=0;E<$;++E)Q[K++]=X,Q[K++]=X+2,Q[K++]=X+1,Q[K++]=X+1,Q[K++]=X+2,Q[K++]=X+3,X+=4;return new A.A({attributes:j,indices:Q,primitiveType:v.A.TRIANGLES,boundingSphere:r.A.fromPoints(M),geometryType:m.A.POLYLINES})};const R=x},870349:(e,t,n)=>{"use strict";n.d(t,{A:()=>F});var i=n(267980),o=n(336946),r=n(491446),s=n(605971),a=n(610750),c=n(602289),l=n(551824),u=n(150429),d=n(367817),h=n(584164),A=n(257941);const p={numberOfPoints:function(e,t,n){const o=i.A.distance(e,t);return Math.ceil(o/n)},numberOfPointsRhumbLine:function(e,t,n){const i=Math.pow(e.longitude-t.longitude,2)+Math.pow(e.latitude-t.latitude,2);return Math.max(1,Math.ceil(Math.sqrt(i/(n*n))))}},f=new o.A;p.extractHeights=function(e,t){const n=e.length,i=new Array(n);for(let o=0;o<n;o++){const n=e[o];i[o]=t.cartesianToCartographic(n,f).height}return i};const m=new h.A,g=new i.A,_=new i.A,y=new A.A(i.A.UNIT_X,0),v=new i.A,T=new A.A(i.A.UNIT_X,0),b=new i.A,w=new i.A,x=[];function C(e,t,n){const i=x;let o;if(i.length=e,t===n){for(o=0;o<e;o++)i[o]=t;return i}const r=(n-t)/e;for(o=0;o<e;o++){const e=t+o*r;i[o]=e}return i}const E=new o.A,S=new o.A,I=new i.A,P=new i.A,D=new i.A,O=new c.A;let R=new l.A;function M(e,t,n,o,r,s,a,c){const l=o.scaleToGeodeticSurface(e,P),u=o.scaleToGeodeticSurface(t,D),d=p.numberOfPoints(e,t,n),h=o.cartesianToCartographic(l,E),A=o.cartesianToCartographic(u,S),f=C(d,r,s);O.setEndPoints(h,A);const m=O.surfaceDistance/d;let g=c;h.height=r;let _=o.cartographicToCartesian(h,I);i.A.pack(_,a,g),g+=3;for(let e=1;e<d;e++){const t=O.interpolateUsingSurfaceDistance(e*m,S);t.height=f[e],_=o.cartographicToCartesian(t,I),i.A.pack(_,a,g),g+=3}return g}function L(e,t,n,o,r,s,a,c){const u=o.cartesianToCartographic(e,E),d=o.cartesianToCartographic(t,S),h=p.numberOfPointsRhumbLine(u,d,n);u.height=0,d.height=0;const A=C(h,r,s);R.ellipsoid.equals(o)||(R=new l.A(void 0,void 0,o)),R.setEndPoints(u,d);const f=R.surfaceDistance/h;let m=c;u.height=r;let g=o.cartographicToCartesian(u,I);i.A.pack(g,a,m),m+=3;for(let e=1;e<h;e++){const t=R.interpolateUsingSurfaceDistance(e*f,S);t.height=A[e],g=o.cartographicToCartesian(t,I),i.A.pack(g,a,m),m+=3}return m}p.wrapLongitude=function(e,t){const n=[],o=[];if((0,r.A)(e)&&e.length>0){t=t??h.A.IDENTITY;const s=h.A.inverseTransformation(t,m),a=h.A.multiplyByPoint(s,i.A.ZERO,g),c=i.A.normalize(h.A.multiplyByPointAsVector(s,i.A.UNIT_Y,_),_),l=A.A.fromPointNormal(a,c,y),d=i.A.normalize(h.A.multiplyByPointAsVector(s,i.A.UNIT_X,v),v),p=A.A.fromPointNormal(a,d,T);let f=1;n.push(i.A.clone(e[0]));let x=n[0];const C=e.length;for(let t=1;t<C;++t){const s=e[t];if(A.A.getPointDistance(p,x)<0||A.A.getPointDistance(p,s)<0){const e=u.A.lineSegmentPlane(x,s,l,b);if((0,r.A)(e)){const t=i.A.multiplyByScalar(c,5e-9,w);A.A.getPointDistance(l,x)<0&&i.A.negate(t,t),n.push(i.A.add(e,t,new i.A)),o.push(f+1),i.A.negate(t,t),n.push(i.A.add(e,t,new i.A)),f=1}}n.push(i.A.clone(e[t])),f++,x=s}o.push(f)}return{positions:n,lengths:o}},p.generateArc=function(e){(0,r.A)(e)||(e={});const t=e.positions;if(!(0,r.A)(t))throw new s.A("options.positions is required.");const n=t.length,o=e.ellipsoid??a.A.default;let c=e.height??0;const l=Array.isArray(c);if(n<1)return[];if(1===n){const e=o.scaleToGeodeticSurface(t[0],P);if(c=l?c[0]:c,0!==c){const t=o.geodeticSurfaceNormal(e,I);i.A.multiplyByScalar(t,c,t),i.A.add(e,t,e)}return[e.x,e.y,e.z]}let u=e.minDistance;if(!(0,r.A)(u)){const t=e.granularity??d.A.RADIANS_PER_DEGREE;u=d.A.chordLength(t,o.maximumRadius)}let h,A=0;for(h=0;h<n-1;h++)A+=p.numberOfPoints(t[h],t[h+1],u);const f=3*(A+1),m=new Array(f);let g=0;for(h=0;h<n-1;h++)g=M(t[h],t[h+1],u,o,l?c[h]:c,l?c[h+1]:c,m,g);x.length=0;const _=t[n-1],y=o.cartesianToCartographic(_,E);y.height=l?c[n-1]:c;const v=o.cartographicToCartesian(y,I);return i.A.pack(v,m,f-3),m};const N=new o.A,B=new o.A;p.generateRhumbArc=function(e){(0,r.A)(e)||(e={});const t=e.positions;if(!(0,r.A)(t))throw new s.A("options.positions is required.");const n=t.length,c=e.ellipsoid??a.A.default;let l=e.height??0;const u=Array.isArray(l);if(n<1)return[];if(1===n){const e=c.scaleToGeodeticSurface(t[0],P);if(l=u?l[0]:l,0!==l){const t=c.geodeticSurfaceNormal(e,I);i.A.multiplyByScalar(t,l,t),i.A.add(e,t,e)}return[e.x,e.y,e.z]}const h=e.granularity??d.A.RADIANS_PER_DEGREE;let A,f,m=0,g=c.cartesianToCartographic(t[0],N);for(A=0;A<n-1;A++)f=c.cartesianToCartographic(t[A+1],B),m+=p.numberOfPointsRhumbLine(g,f,h),g=o.A.clone(f,N);const _=3*(m+1),y=new Array(_);let v=0;for(A=0;A<n-1;A++)v=L(t[A],t[A+1],h,c,u?l[A]:l,u?l[A+1]:l,y,v);x.length=0;const T=t[n-1],b=c.cartesianToCartographic(T,E);b.height=u?l[n-1]:l;const w=c.cartographicToCartesian(b,I);return i.A.pack(w,y,_-3),y},p.generateCartesianArc=function(e){const t=p.generateArc(e),n=t.length/3,o=new Array(n);for(let e=0;e<n;e++)o[e]=i.A.unpack(t,3*e);return o},p.generateCartesianRhumbArc=function(e){const t=p.generateRhumbArc(e),n=t.length/3,o=new Array(n);for(let e=0;e<n;e++)o[e]=i.A.unpack(t,3*e);return o};const F=p},259690:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(915325),o=n(491446),r=n(605971),s=n(99479),a=n(437266);function c(e){const t=(e=e??i.A.EMPTY_OBJECT).points,n=e.times;if(!(0,o.A)(t)||!(0,o.A)(n))throw new r.A("points and times are required.");if(t.length<2)throw new r.A("points.length must be greater than or equal to 2.");if(n.length!==t.length)throw new r.A("times.length must be equal to points.length.");this._times=n,this._points=t,this._evaluateFunction=function(e){const t=e.points,n=e.times;return function(i,r){(0,o.A)(r)||(r=new s.A);const a=e._lastTimeIndex=e.findTimeInterval(i,e._lastTimeIndex),c=(i-n[a])/(n[a+1]-n[a]),l=t[a],u=t[a+1];return s.A.fastSlerp(l,u,c,r)}}(this),this._lastTimeIndex=0}Object.defineProperties(c.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}}),c.prototype.findTimeInterval=a.A.prototype.findTimeInterval,c.prototype.wrapTime=a.A.prototype.wrapTime,c.prototype.clampTime=a.A.prototype.clampTime,c.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};const l=c},67988:(e,t,n)=>{"use strict";function i(){this._array=[],this._offset=0,this._length=0}n.d(t,{A:()=>o}),Object.defineProperties(i.prototype,{length:{get:function(){return this._length}}}),i.prototype.enqueue=function(e){this._array.push(e),this._length++},i.prototype.dequeue=function(){if(0===this._length)return;const e=this._array;let t=this._offset;const n=e[t];return e[t]=void 0,t++,t>10&&2*t>e.length&&(this._array=e.slice(t),t=0),this._offset=t,this._length--,n},i.prototype.peek=function(){if(0!==this._length)return this._array[this._offset]},i.prototype.contains=function(e){return-1!==this._array.indexOf(e)},i.prototype.clear=function(){this._array.length=this._offset=this._length=0},i.prototype.sort=function(e){this._offset>0&&(this._array=this._array.slice(this._offset),this._offset=0),this._array.sort(e)};const o=i},512827:(e,t,n)=>{"use strict";n.d(t,{A:()=>b});var i=n(267980),o=n(336946),r=n(491446),s=n(605971),a=n(610750),c=n(653577),l=n(367817),u=n(463298),d=n(697422);const h=Math.cos,A=Math.sin,p=Math.sqrt,f={computePosition:function(e,t,n,i,o,s,a){const c=t.radiiSquared,l=e.nwCorner,u=e.boundingRectangle;let d=l.latitude-e.granYCos*i+o*e.granXSin;const f=h(d),m=A(d),g=c.z*m;let _=l.longitude+i*e.granYSin+o*e.granXCos;const y=f*h(_),v=f*A(_),T=c.x*y,b=c.y*v,w=p(T*y+b*v+g*m);if(s.x=T/w,s.y=b/w,s.z=g/w,n){const t=e.stNwCorner;(0,r.A)(t)?(d=t.latitude-e.stGranYCos*i+o*e.stGranXSin,_=t.longitude+i*e.stGranYSin+o*e.stGranXCos,a.x=(_-e.stWest)*e.lonScalar,a.y=(d-e.stSouth)*e.latScalar):(a.x=(_-u.west)*e.lonScalar,a.y=(d-u.south)*e.latScalar)}}},m=new u.A;let g=new i.A;const _=new o.A;let y=new i.A;const v=new c.A;function T(e,t,n,o,r,s,c){const l=Math.cos(t),d=o*l,h=n*l,A=Math.sin(t),p=o*A,f=n*A;v._ellipsoid=a.A.default,g=v.project(e,g),g=i.A.subtract(g,y,g);const _=u.A.fromRotation(t,m);g=u.A.multiplyByVector(_,g,g),g=i.A.add(g,y,g),s-=1,c-=1;const T=(e=v.unproject(g,e)).latitude,b=T+s*f,w=T-d*c,x=T-d*c+s*f,C=Math.max(T,b,w,x),E=Math.min(T,b,w,x),S=e.longitude,I=S+s*h,P=S+c*p,D=S+c*p+s*h;return{north:C,south:E,east:Math.max(S,I,P,D),west:Math.min(S,I,P,D),granYCos:d,granYSin:p,granXCos:h,granXSin:f,nwCorner:e}}f.computeOptions=function(e,t,n,i,o,r,c){let u,h=e.east,A=e.west,p=e.north,f=e.south,m=!1,g=!1;p===l.A.PI_OVER_TWO&&(m=!0),f===-l.A.PI_OVER_TWO&&(g=!0);const b=p-f;u=A>h?l.A.TWO_PI-A+h:h-A;const w=Math.ceil(u/t)+1,x=Math.ceil(b/t)+1,C=u/(w-1),E=b/(x-1),S=d.A.northwest(e,r),I=d.A.center(e,_);0===n&&0===i||(I.longitude<S.longitude&&(I.longitude+=l.A.TWO_PI),v._ellipsoid=a.A.default,y=v.project(I,y));const P=E,D=C,O=d.A.clone(e,o),R={granYCos:P,granYSin:0,granXCos:D,granXSin:0,nwCorner:S,boundingRectangle:O,width:w,height:x,northCap:m,southCap:g};if(0!==n){const e=T(S,n,C,E,0,w,x);if(p=e.north,f=e.south,h=e.east,A=e.west,p<-l.A.PI_OVER_TWO||p>l.A.PI_OVER_TWO||f<-l.A.PI_OVER_TWO||f>l.A.PI_OVER_TWO)throw new s.A("Rotated rectangle is invalid.  It crosses over either the north or south pole.");R.granYCos=e.granYCos,R.granYSin=e.granYSin,R.granXCos=e.granXCos,R.granXSin=e.granXSin,O.north=p,O.south=f,O.east=h,O.west=A}if(0!==i){n-=i;const e=d.A.northwest(O,c),t=T(e,n,C,E,0,w,x);R.stGranYCos=t.granYCos,R.stGranXCos=t.granXCos,R.stGranYSin=t.granYSin,R.stGranXSin=t.granXSin,R.stNwCorner=e,R.stWest=t.west,R.stSouth=t.south}return R};const b=f},406882:(e,t,n)=>{"use strict";n.d(t,{A:()=>O});var i=n(660662),o=n(267980),r=n(336946),s=n(571804),a=n(915325),c=n(491446),l=n(605971),u=n(610750),d=n(944479),h=n(305439),A=n(46362),p=n(794554),f=n(874915),m=n(367817),g=n(576770),_=n(402330),y=n(697422),v=n(512827);const T=new i.A,b=new i.A,w=new o.A,x=new y.A;function C(e,t){const n=e._ellipsoid,i=t.height,o=t.width,r=t.northCap,a=t.southCap;let c=i,l=2,u=0,p=4;r&&(l-=1,c-=1,u+=1,p-=2),a&&(l-=1,c-=1,u+=1,p-=2),u+=l*o+2*c-p;const m=new Float64Array(3*u);let g,y=0,T=0;const b=w;if(r)v.A.computePosition(t,n,!1,T,0,b),m[y++]=b.x,m[y++]=b.y,m[y++]=b.z;else for(g=0;g<o;g++)v.A.computePosition(t,n,!1,T,g,b),m[y++]=b.x,m[y++]=b.y,m[y++]=b.z;for(g=o-1,T=1;T<i;T++)v.A.computePosition(t,n,!1,T,g,b),m[y++]=b.x,m[y++]=b.y,m[y++]=b.z;if(T=i-1,!a)for(g=o-2;g>=0;g--)v.A.computePosition(t,n,!1,T,g,b),m[y++]=b.x,m[y++]=b.y,m[y++]=b.z;for(g=0,T=i-2;T>0;T--)v.A.computePosition(t,n,!1,T,g,b),m[y++]=b.x,m[y++]=b.y,m[y++]=b.z;const x=m.length/3*2,C=f.A.createTypedArray(m.length/3,x);let E=0;for(let e=0;e<m.length/3-1;e++)C[E++]=e,C[E++]=e+1;C[E++]=m.length/3-1,C[E++]=0;const S=new d.A({attributes:new A.A,primitiveType:_.A.LINES});return S.attributes.position=new h.A({componentDatatype:s.A.DOUBLE,componentsPerAttribute:3,values:m}),S.indices=C,S}function E(e){const t=(e=e??a.A.EMPTY_OBJECT).rectangle,n=e.granularity??m.A.RADIANS_PER_DEGREE,i=e.ellipsoid??u.A.default,o=e.rotation??0;if(!(0,c.A)(t))throw new l.A("rectangle is required.");if(y.A._validate(t),t.north<t.south)throw new l.A("options.rectangle.north must be greater than options.rectangle.south");const r=e.height??0,s=e.extrudedHeight??r;this._rectangle=y.A.clone(t),this._granularity=n,this._ellipsoid=i,this._surfaceHeight=Math.max(r,s),this._rotation=o,this._extrudedHeight=Math.min(r,s),this._offsetAttribute=e.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}E.packedLength=y.A.packedLength+u.A.packedLength+5,E.pack=function(e,t,n){if(!(0,c.A)(e))throw new l.A("value is required");if(!(0,c.A)(t))throw new l.A("array is required");return n=n??0,y.A.pack(e._rectangle,t,n),n+=y.A.packedLength,u.A.pack(e._ellipsoid,t,n),n+=u.A.packedLength,t[n++]=e._granularity,t[n++]=e._surfaceHeight,t[n++]=e._rotation,t[n++]=e._extrudedHeight,t[n]=e._offsetAttribute??-1,t};const S=new y.A,I=u.A.clone(u.A.UNIT_SPHERE),P={rectangle:S,ellipsoid:I,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};E.unpack=function(e,t,n){if(!(0,c.A)(e))throw new l.A("array is required");t=t??0;const i=y.A.unpack(e,t,S);t+=y.A.packedLength;const o=u.A.unpack(e,t,I);t+=u.A.packedLength;const r=e[t++],s=e[t++],a=e[t++],d=e[t++],h=e[t];return(0,c.A)(n)?(n._rectangle=y.A.clone(i,n._rectangle),n._ellipsoid=u.A.clone(o,n._ellipsoid),n._surfaceHeight=s,n._rotation=a,n._extrudedHeight=d,n._offsetAttribute=-1===h?void 0:h,n):(P.granularity=r,P.height=s,P.rotation=a,P.extrudedHeight=d,P.offsetAttribute=-1===h?void 0:h,new E(P))};const D=new r.A;E.createGeometry=function(e){const t=e._rectangle,n=e._ellipsoid,o=v.A.computeOptions(t,e._granularity,e._rotation,0,x,D);let r,a;if(m.A.equalsEpsilon(t.north,t.south,m.A.EPSILON10)||m.A.equalsEpsilon(t.east,t.west,m.A.EPSILON10))return;const l=e._surfaceHeight,u=e._extrudedHeight;let A;if(m.A.equalsEpsilon(l,u,0,m.A.EPSILON2)){if(r=C(e,o),r.attributes.position.values=g.A.scaleToGeodeticHeight(r.attributes.position.values,l,n,!1),(0,c.A)(e._offsetAttribute)){const t=r.attributes.position.values.length;A=e._offsetAttribute===p.A.NONE?0:1;const n=new Uint8Array(t/3).fill(A);r.attributes.applyOffset=new h.A({componentDatatype:s.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}a=i.A.fromRectangle3D(t,n,l)}else{if(r=function(e,t){const n=e._surfaceHeight,i=e._extrudedHeight,o=e._ellipsoid,r=C(e,t),s=t.height,a=t.width,c=g.A.scaleToGeodeticHeight(r.attributes.position.values,n,o,!1);let l=c.length;const u=new Float64Array(2*l);u.set(c);const d=g.A.scaleToGeodeticHeight(r.attributes.position.values,i,o);u.set(d,l),r.attributes.position.values=u;const h=t.northCap,A=t.southCap;let p=4;h&&(p-=1),A&&(p-=1);const m=2*(u.length/3+p),_=f.A.createTypedArray(u.length/3,m);l=u.length/6;let y,v=0;for(let e=0;e<l-1;e++)_[v++]=e,_[v++]=e+1,_[v++]=e+l,_[v++]=e+l+1;if(_[v++]=l-1,_[v++]=0,_[v++]=l+l-1,_[v++]=l,_[v++]=0,_[v++]=l,h)y=s-1;else{const e=a-1;_[v++]=e,_[v++]=e+l,y=a+s-2}if(_[v++]=y,_[v++]=y+l,!A){const e=a+y-1;_[v++]=e,_[v]=e+l}return r.indices=_,r}(e,o),(0,c.A)(e._offsetAttribute)){const t=r.attributes.position.values.length/3;let n=new Uint8Array(t);e._offsetAttribute===p.A.TOP?n=n.fill(1,0,t/2):(A=e._offsetAttribute===p.A.NONE?0:1,n=n.fill(A)),r.attributes.applyOffset=new h.A({componentDatatype:s.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}const d=i.A.fromRectangle3D(t,n,l,b),m=i.A.fromRectangle3D(t,n,u,T);a=i.A.union(d,m)}return new d.A({attributes:r.attributes,indices:r.indices,primitiveType:_.A.LINES,boundingSphere:a,offsetAttribute:e._offsetAttribute})};const O=E},252538:(e,t,n)=>{"use strict";n.d(t,{A:()=>x});var i=n(267980),o=n(336946),r=n(369031),s=n(491446),a=n(605971),c=n(610750),l=n(520098),u=n(123245);const d=[],h=[],A=[[0,1,3,2],[0,2,3,1],[3,2,0,1],[3,1,0,2]],p=[1,0,0,3];function f(e){if(!l.A.supportsBigInt())throw new u.A("S2 required BigInt support");if(!(0,s.A)(e))throw new a.A("cell ID is required.");if(!f.isValidId(e))throw new a.A("cell ID is invalid.");this._cellId=e,this._level=f.getLevel(e)}function m(e){0===d.length&&(T(0,0,0,0,0,0),T(0,0,0,1,0,1),T(0,0,0,2,0,2),T(0,0,0,3,0,3));const t=Number(e>>BigInt(61));let n=1&t,i=0,o=0;for(let t=7;t>=0;t--){const r=(1<<2*(7===t?2:4))-1;n+=Number(e>>BigInt(2*t*4+1)&BigInt(r))<<2,n=h[n];const s=4*t;i+=n>>6<<s,o+=(n>>2&15)<<s,n&=3}return[t,i,o]}function g(e,t,n){switch(e){case 0:return new i.A(1,t,n);case 1:return new i.A(-t,1,n);case 2:return new i.A(-t,-n,1);case 3:return new i.A(-1,-n,-t);case 4:return new i.A(n,-1,-t);default:return new i.A(n,t,-1)}}function _(e){return e>=.5?1/3*(4*e*e-1):1/3*(1-4*(1-e)*(1-e))}function y(e){return 1/2147483648*e}function v(e){return 1/1073741824*e}function T(e,t,n,i,o,r){if(4===e){const e=(t<<4)+n;d[(e<<2)+i]=(o<<2)+r,h[(o<<2)+i]=(e<<2)+r}else{e++,n<<=1,o<<=2;const s=A[r];T(e,(t<<=1)+(s[0]>>1),n+(1&s[0]),i,o,r^p[0]),T(e,t+(s[1]>>1),n+(1&s[1]),i,o+1,r^p[1]),T(e,t+(s[2]>>1),n+(1&s[2]),i,o+2,r^p[2]),T(e,t+(s[3]>>1),n+(1&s[3]),i,o+3,r^p[3])}}function b(e){return e&~e+BigInt(1)}f.fromToken=function(e){if(r.A.typeOf.string("token",e),!f.isValidToken(e))throw new a.A("token is invalid.");return new f(f.getIdFromToken(e))},f.isValidId=function(e){return r.A.typeOf.bigint("cellId",e),!(e<=0)&&(!(e>>BigInt(61)>5)&&!!(e&~e+BigInt(1)&BigInt("0x1555555555555555")))},f.isValidToken=function(e){return r.A.typeOf.string("token",e),!!/^[0-9a-fA-F]{1,16}$/.test(e)&&f.isValidId(f.getIdFromToken(e))},f.getIdFromToken=function(e){return r.A.typeOf.string("token",e),BigInt("0x"+e+"0".repeat(16-e.length))},f.getTokenFromId=function(e){r.A.typeOf.bigint("cellId",e);const t=Math.floor(w[(-(n=e)&n)%BigInt(67)]/4);var n;const i=e.toString(16).replace(/0*$/,"");return Array(17-t-i.length).join("0")+i},f.getLevel=function(e){if(r.A.typeOf.bigint("cellId",e),!f.isValidId(e))throw new a.A;let t=0;for(;e!==BigInt(0)&&!(e&BigInt(1));)t++,e>>=BigInt(1);return 30-(t>>1)},f.prototype.getChild=function(e){if(r.A.typeOf.number("index",e),e<0||e>3)throw new a.A("child index must be in the range [0-3].");if(30===this._level)throw new a.A("cannot get child of leaf cell.");const t=b(this._cellId)>>BigInt(2);return new f(this._cellId+BigInt(2*e+1-4)*t)},f.prototype.getParent=function(){if(0===this._level)throw new a.A("cannot get parent of root cell.");const e=b(this._cellId)<<BigInt(2);return new f(this._cellId&~e+BigInt(1)|e)},f.prototype.getParentAtLevel=function(e){if(0===this._level||e<0||this._level<e)throw new a.A("cannot get parent at invalid level.");const t=function(e){return BigInt(1)<<BigInt(2*(30-e))}(e);return new f(this._cellId&-t|t)},f.prototype.getCenter=function(e){e=e??c.A.WGS84;let t=function(e,t){const n=function(e,t){const n=m(e),i=n[0],o=n[1],r=n[2],s=30===t,a=!s&&(BigInt(o)^e>>BigInt(2))&BigInt(1),c=s?1:a?2:0;return[i,(o<<1)+c,(r<<1)+c]}(e,t);return function(e,t,n){const i=y(t),o=y(n);return g(e,_(i),_(o))}(n[0],n[1],n[2])}(this._cellId,this._level);t=i.A.normalize(t,t);const n=new o.A.fromCartesian(t,c.A.UNIT_SPHERE);return o.A.toCartesian(n,e,new i.A)},f.prototype.getVertex=function(e,t){if(r.A.typeOf.number("index",e),e<0||e>3)throw new a.A("vertex index must be in the range [0-3].");t=t??c.A.WGS84;let n=function(e,t,n){const i=m(e),o=function(e,t){const n=[[],[]],i=function(e){return 1<<30-e>>>0}(t);for(let t=0;t<2;++t){const o=e[t]&-i,r=o+i;n[t][0]=_(v(o)),n[t][1]=_(v(r))}return n}([i[1],i[2]],t),r=n>>1&1;return g(i[0],o[0][r^1&n],o[1][r])}(this._cellId,this._level,e);n=i.A.normalize(n,n);const s=new o.A.fromCartesian(n,c.A.UNIT_SPHERE);return o.A.toCartesian(s,t,new i.A)},f.fromFacePositionLevel=function(e,t,n){if(r.A.typeOf.bigint("position",t),e<0||e>5)throw new a.A("Invalid S2 Face (must be within 0-5)");if(n<0||n>30)throw new a.A("Invalid level (must be within 0-30)");if(t<0||t>=Math.pow(4,n))throw new a.A("Invalid Hilbert position for level");const i=(e<4?"0":"")+(e<2?"0":"")+e.toString(2),o=t.toString(2),s=Array(2*n-o.length+1).join("0"),c=Array(61-2*n).join("0");return new f(BigInt(`0b${i}${s}${o}1${c}`))};const w=[64,0,1,39,2,15,40,23,3,12,16,59,41,19,24,54,4,64,13,10,17,62,60,28,42,30,20,51,25,44,55,47,5,32,65,38,14,22,11,58,18,53,63,9,61,27,29,50,43,46,31,37,21,57,52,8,26,49,45,36,56,7,48,35,6,34,33,0],x=f},708857:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(571804),o=n(491446),r=n(605971);function s(e){e=e??!0,this.value=s.toValue(e)}Object.defineProperties(s.prototype,{componentDatatype:{get:function(){return i.A.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 1}},normalize:{get:function(){return!1}}}),s.toValue=function(e,t){if(!(0,o.A)(e))throw new r.A("show is required.");return(0,o.A)(t)?(t[0]=e,t):new Uint8Array([e])};const a=s},6874:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(267980),o=n(369031),r=n(491446),s=n(594706);function a(e){const t=e.radius??1,n={radii:new i.A(t,t,t),stackPartitions:e.stackPartitions,slicePartitions:e.slicePartitions,subdivisions:e.subdivisions};this._ellipsoidGeometry=new s.A(n),this._workerName="createSphereOutlineGeometry"}a.packedLength=s.A.packedLength,a.pack=function(e,t,n){return o.A.typeOf.object("value",e),s.A.pack(e._ellipsoidGeometry,t,n)};const c=new s.A,l={radius:void 0,radii:new i.A,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0};a.unpack=function(e,t,n){const o=s.A.unpack(e,t,c);return l.stackPartitions=o._stackPartitions,l.slicePartitions=o._slicePartitions,l.subdivisions=o._subdivisions,(0,r.A)(n)?(i.A.clone(o._radii,l.radii),n._ellipsoidGeometry=new s.A(l),n):(l.radius=o._radii.x,new a(l))},a.createGeometry=function(e){return s.A.createGeometry(e._ellipsoidGeometry)};const u=a},437266:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(267980),o=n(369031),r=n(367817),s=n(605971),a=n(99479);function c(){this.times=void 0,this.points=void 0,s.A.throwInstantiationError()}c.getPointType=function(e){if("number"==typeof e)return Number;if(e instanceof i.A)return i.A;if(e instanceof a.A)return a.A;throw new s.A("point must be a Cartesian3, Quaternion, or number.")},c.prototype.evaluate=s.A.throwInstantiationError,c.prototype.findTimeInterval=function(e,t){const n=this.times,i=n.length;if(o.A.typeOf.number("time",e),e<n[0]||e>n[i-1])throw new s.A("time is out of range.");if(e>=n[t=t??0]){if(t+1<i&&e<n[t+1])return t;if(t+2<i&&e<n[t+2])return t+1}else if(t-1>=0&&e>=n[t-1])return t-1;let r;if(e>n[t])for(r=t;r<i-1&&!(e>=n[r]&&e<n[r+1]);++r);else for(r=t-1;r>=0&&!(e>=n[r]&&e<n[r+1]);--r);return r===i-1&&(r=i-2),r},c.prototype.wrapTime=function(e){o.A.typeOf.number("time",e);const t=this.times,n=t[t.length-1],i=t[0],r=n-i;let s;return e<i&&(s=Math.floor((i-e)/r)+1,e+=s*r),e>n&&(s=Math.floor((e-n)/r)+1,e-=s*r),e},c.prototype.clampTime=function(e){o.A.typeOf.number("time",e);const t=this.times;return r.A.clamp(e,t[0],t[t.length-1])};const l=c},587841:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(915325),o=n(491446),r=n(605971),s=n(437266);function a(e){const t=(e=e??i.A.EMPTY_OBJECT).points,n=e.times;if(!(0,o.A)(t)||!(0,o.A)(n))throw new r.A("points and times are required.");if(t.length<2)throw new r.A("points.length must be greater than or equal to 2.");if(n.length!==t.length)throw new r.A("times.length must be equal to points.length.");this._times=n,this._points=t,this._pointType=s.A.getPointType(t[0]),this._lastTimeIndex=0}Object.defineProperties(a.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}}),a.prototype.findTimeInterval=s.A.prototype.findTimeInterval,a.prototype.wrapTime=s.A.prototype.wrapTime,a.prototype.clampTime=s.A.prototype.clampTime,a.prototype.evaluate=function(e,t){const n=this.points;this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex);const i=this._lastTimeIndex,r=this._pointType;return r===Number?n[i]:((0,o.A)(t)||(t=new r),r.clone(n[i],t))};const c=a},465159:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var i=n(434067),o=n(267980),r=n(336946),s=n(369031),a=n(491446),c=n(610750),l=n(658091),u=n(150429),d=n(367817),h=n(766067);function A(e,t){this.position=e,(0,a.A)(this.position)||(this.position=new i.A),this.tangentPlane=t,(0,a.A)(this.tangentPlane)||(this.tangentPlane=A.NORTH_POLE_TANGENT_PLANE)}Object.defineProperties(A.prototype,{ellipsoid:{get:function(){return this.tangentPlane.ellipsoid}},x:{get:function(){return this.position.x}},y:{get:function(){return this.position.y}},conformalLatitude:{get:function(){const e=i.A.magnitude(this.position),t=2*this.ellipsoid.maximumRadius;return this.tangentPlane.plane.normal.z*(d.A.PI_OVER_TWO-2*Math.atan2(e,t))}},longitude:{get:function(){let e=d.A.PI_OVER_TWO+Math.atan2(this.y,this.x);return e>Math.PI&&(e-=d.A.TWO_PI),e}}});const p=new r.A,f=new o.A;A.prototype.getLatitude=function(e){(0,a.A)(e)||(e=c.A.default),p.latitude=this.conformalLatitude,p.longitude=this.longitude,p.height=0;const t=this.ellipsoid.cartographicToCartesian(p,f);return e.cartesianToCartographic(t,p),p.latitude};const m=new h.A,g=new o.A,_=new o.A;A.fromCartesian=function(e,t){s.A.defined("cartesian",e);const n=d.A.signNotZero(e.z);let r=A.NORTH_POLE_TANGENT_PLANE,c=A.SOUTH_POLE;n<0&&(r=A.SOUTH_POLE_TANGENT_PLANE,c=A.NORTH_POLE);const l=m;l.origin=r.ellipsoid.scaleToGeocentricSurface(e,l.origin),l.direction=o.A.subtract(l.origin,c,g),o.A.normalize(l.direction,l.direction);const h=u.A.rayPlane(l,r.plane,_),p=o.A.subtract(h,c,h),f=o.A.dot(r.xAxis,p),y=n*o.A.dot(r.yAxis,p);return(0,a.A)(t)?(t.position=new i.A(f,y),t.tangentPlane=r,t):new A(new i.A(f,y),r)},A.fromCartesianArray=function(e,t){s.A.defined("cartesians",e);const n=e.length;(0,a.A)(t)?t.length=n:t=new Array(n);for(let i=0;i<n;i++)t[i]=A.fromCartesian(e[i],t[i]);return t},A.clone=function(e,t){if((0,a.A)(e))return(0,a.A)(t)?(t.position=e.position,t.tangentPlane=e.tangentPlane,t):new A(e.position,e.tangentPlane)},A.HALF_UNIT_SPHERE=Object.freeze(new c.A(.5,.5,.5)),A.NORTH_POLE=Object.freeze(new o.A(0,0,.5)),A.SOUTH_POLE=Object.freeze(new o.A(0,0,-.5)),A.NORTH_POLE_TANGENT_PLANE=Object.freeze(new l.A(A.NORTH_POLE,A.HALF_UNIT_SPHERE)),A.SOUTH_POLE_TANGENT_PLANE=Object.freeze(new l.A(A.SOUTH_POLE,A.HALF_UNIT_SPHERE));const y=A},710551:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(267980),o=n(491446),r=n(605971);const s={solve:function(e,t,n,s){if(!((0,o.A)(e)&&e instanceof Array))throw new r.A("The array lower is required.");if(!((0,o.A)(t)&&t instanceof Array))throw new r.A("The array diagonal is required.");if(!((0,o.A)(n)&&n instanceof Array))throw new r.A("The array upper is required.");if(!((0,o.A)(s)&&s instanceof Array))throw new r.A("The array right is required.");if(t.length!==s.length)throw new r.A("diagonal and right must have the same lengths.");if(e.length!==n.length)throw new r.A("lower and upper must have the same lengths.");if(e.length!==t.length-1)throw new r.A("lower and upper must be one less than the length of diagonal.");const a=new Array(n.length),c=new Array(s.length),l=new Array(s.length);let u,d;for(u=0;u<c.length;u++)c[u]=new i.A,l[u]=new i.A;for(a[0]=n[0]/t[0],c[0]=i.A.multiplyByScalar(s[0],1/t[0],c[0]),u=1;u<a.length;++u)d=1/(t[u]-a[u-1]*e[u-1]),a[u]=n[u]*d,c[u]=i.A.subtract(s[u],i.A.multiplyByScalar(c[u-1],e[u-1],c[u]),c[u]),c[u]=i.A.multiplyByScalar(c[u],d,c[u]);for(d=1/(t[u]-a[u-1]*e[u-1]),c[u]=i.A.subtract(s[u],i.A.multiplyByScalar(c[u-1],e[u-1],c[u]),c[u]),c[u]=i.A.multiplyByScalar(c[u],d,c[u]),l[l.length-1]=c[c.length-1],u=l.length-2;u>=0;--u)l[u]=i.A.subtract(c[u],i.A.multiplyByScalar(l[u+1],a[u],l[u]),l[u]);return l}}},635692:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(491446),o=n(874915),r=n(402330);const s={createWireframeIndices:function(e,t,n){const s=(0,i.A)(n);return e===r.A.TRIANGLES?s?function(e,t){const n=t.length,i=o.A.createTypedArray(e,2*n);let r=0;for(let e=0;e<n;e+=3){const n=t[e],o=t[e+1],s=t[e+2];i[r++]=n,i[r++]=o,i[r++]=o,i[r++]=s,i[r++]=s,i[r++]=n}return i}(t,n):function(e){const t=o.A.createTypedArray(e,2*e),n=e;let i=0;for(let e=0;e<n;e+=3)t[i++]=e,t[i++]=e+1,t[i++]=e+1,t[i++]=e+2,t[i++]=e+2,t[i++]=e;return t}(t):e===r.A.TRIANGLE_STRIP?s?function(e,t){const n=t.length-2,i=2+4*n,r=o.A.createTypedArray(e,i);let s=0;r[s++]=t[0],r[s++]=t[1];for(let e=0;e<n;e++){const n=t[e],i=t[e+1],o=t[e+2];r[s++]=i,r[s++]=o,r[s++]=o,r[s++]=n}return r}(t,n):function(e){const t=e-2,n=2+4*t,i=o.A.createTypedArray(e,n);let r=0;i[r++]=0,i[r++]=1;for(let e=0;e<t;e++)i[r++]=e+1,i[r++]=e+2,i[r++]=e+2,i[r++]=e;return i}(t):e===r.A.TRIANGLE_FAN?s?function(e,t){const n=t.length-2,i=2+4*n,r=o.A.createTypedArray(e,i);let s=0;const a=t[0];r[s++]=a,r[s++]=t[1];for(let e=0;e<n;e++){const n=t[e+1],i=t[e+2];r[s++]=n,r[s++]=i,r[s++]=i,r[s++]=a}return r}(t,n):function(e){const t=e-2,n=2+4*t,i=o.A.createTypedArray(e,n);let r=0;i[r++]=0,i[r++]=1;for(let e=0;e<t;e++)i[r++]=e+1,i[r++]=e+2,i[r++]=e+2,i[r++]=0;return i}(t):void 0},getWireframeIndicesCount:function(e,t){return e===r.A.TRIANGLES?2*t:e===r.A.TRIANGLE_STRIP||e===r.A.TRIANGLE_FAN?2+4*(t-2):t}},a=s},702247:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(491446);const o=function(e,t){if(!(0,i.A)(t))return;const n=t.length;if(0===n)return;const o=e.length;e.length+=n;for(let i=0;i<n;i++)e[o+i]=t[i]}},394290:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(564453),o=n(915325);const r=function(e){return e=e??o.A.EMPTY_OBJECT,i.A.fromIonAssetId(2426648,{requestVertexNormals:e.requestVertexNormals??!1})}},75584:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(564453),o=n(915325),r=n(610750);const s=function(e){return e=e??o.A.EMPTY_OBJECT,i.A.fromIonAssetId(1,{requestVertexNormals:e.requestVertexNormals??!1,requestWaterMask:e.requestWaterMask??!1,ellipsoid:r.A.WGS84})}},223460:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(961645),o=n(267980),r=n(336946),s=n(367817);const a=32767,c=new r.A,l=new o.A,u=function(e,t,n,u,d){const h=e.length/3,A=e.subarray(0,h),p=e.subarray(h,2*h),f=e.subarray(2*h,3*h);i.A.zigZagDeltaDecode(A,p,f);const m=new Float64Array(e.length);for(let e=0;e<h;++e){const i=A[e],h=p[e],g=f[e],_=s.A.lerp(t.west,t.east,i/a),y=s.A.lerp(t.south,t.north,h/a),v=s.A.lerp(n,u,g/a),T=r.A.fromRadians(_,y,v,c),b=d.cartographicToCartesian(T,l);o.A.pack(b,m,3*e)}return m}},419061:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(786101),o=n(915325);function r(e,t){return(0,i.A)("defaultValue","defaultValue has been deprecated and will be removed in Cesium 1.134. Use the nullish coalescing operator instead: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing"),null!=e?e:t}Object.defineProperty(r,"EMPTY_OBJECT",{get:function(){return(0,i.A)("defaultValue.EMPTY_OBJECT","defaultValue.EMPTY_OBJECT has been deprecated and will be removed in Cesium 1.134. Use Frozen.EMPTY_OBJECT instead"),o.A.EMPTY_OBJECT}});const s=r},786101:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(491446),o=n(605971),r=n(983884);const s=function(e,t){if(!(0,i.A)(e)||!(0,i.A)(t))throw new o.A("identifier and message are required.");(0,r.A)(e,t)}},3858:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(484193),o=n(491446),r=n(605971);const s=function(e){if(!(0,o.A)(e))throw new r.A("uri is required.");const t=new i(e);t.normalize();let n=t.path();const s=n.lastIndexOf("/");return-1!==s&&(n=n.substr(s+1)),n}},452684:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(241839);const o=function(e,t){return t=t??0,(0,i.A)(e,t,Math.min(4,e.length))}},404547:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(369031),o=n(491446),r=n(744603);const s=function(e){const t=e.uint8Array,n=e.format,s=e.request,a=e.flipY??!1,c=e.skipColorSpaceConversion??!1;i.A.typeOf.object("uint8Array",t),i.A.typeOf.string("format",n);const l=new Blob([t],{type:n});let u;return r.A.supportsImageBitmapOptions().then(function(e){return e?Promise.resolve(r.A.createImageBitmapFromBlob(l,{flipY:a,premultiplyAlpha:!1,skipColorSpaceConversion:c})):(u=window.URL.createObjectURL(l),new r.A({url:u,request:s}).fetchImage({flipY:a,skipColorSpaceConversion:c}))}).then(function(e){return(0,o.A)(u)&&window.URL.revokeObjectURL(u),e}).catch(function(e){return(0,o.A)(u)&&window.URL.revokeObjectURL(u),Promise.reject(e)})}},983884:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(491446),o=n(605971);const r={};function s(e,t){if(!(0,i.A)(e))throw new o.A("identifier is required.");(0,i.A)(r[e])||(r[e]=!0,console.warn(t??e))}s.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",s.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",s.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored",s.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored";const a=s},271868:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(367817);const o=function(e){const t=document.createElement("canvas");return t.width=i.A.nextPowerOfTwo(e.width),t.height=i.A.nextPowerOfTwo(e.height),t.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),t}},252544:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(369031),o=n(491446);function r(e,t,n){return e.length?function(e,t,n){const i=e[0],o=i.terrainProvider.requestTileGeometry(i.x,i.y,i.level);if(!o)return!1;let r;return r=n?o.then(a(i)):o.then(a(i)).catch(function(e){const t=e.positions;return function(){for(let e=0;e<t.length;++e)t[e].height=void 0}}(i)),e.shift(),t.push(r),!0}(e,t,n)?r(e,t,n):new Promise(function(e){setTimeout(e,100)}).then(()=>r(e,t,n)):Promise.resolve()}function s(e,t,n){const i=t.interpolateHeight(n,e.longitude,e.latitude);return void 0!==i&&(e.height=i,!0)}function a(e){const t=e.positions,n=e.tilingScheme.tileXYToRectangle(e.x,e.y,e.level);return function(i){let o=!1;for(let e=0;e<t.length;++e)if(!s(t[e],i,n)){o=!0;break}return o?i.createMesh({tilingScheme:e.tilingScheme,x:e.x,y:e.y,level:e.level,throttle:!1}).then(function(){for(let e=0;e<t.length;++e)s(t[e],i,n)}):Promise.resolve()}}const c=async function(e,t,n,s){return(0,o.A)(s)||(s=!1),i.A.typeOf.object("terrainProvider",e),i.A.typeOf.number("level",t),i.A.typeOf.bool("rejectOnTileFail",s),i.A.defined("positions",n),function(e,t,n,i){const s=e.tilingScheme;let a;const c=[],l={};for(a=0;a<n.length;++a){const i=s.positionToTileXY(n[a],t);if(!(0,o.A)(i))continue;const r=i.toString();if(!l.hasOwnProperty(r)){const n={x:i.x,y:i.y,level:t,tilingScheme:s,terrainProvider:e,positions:[]};l[r]=n,c.push(n)}l[r].positions.push(n[a])}const u=[];return r(c,u,i).then(function(){return Promise.all(u).then(function(){return n})})}(e,t,n,s)}},448871:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(434067),o=n(491446),r=n(605971),s=n(252544);const a=new i.A,c=async function e(t,n,i){if((0,o.A)(i)||(i=!1),!(0,o.A)(t))throw new r.A("terrainProvider is required.");if(!(0,o.A)(n))throw new r.A("positions is required.");const c=[],l=[],u=t.availability;if(!(0,o.A)(u))throw new r.A("sampleTerrainMostDetailed requires a terrain provider that has tile availability.");const d=[];for(let e=0;e<n.length;++e){const i=n[e],r=u.computeMaximumLevelAtPosition(i);if(l[e]=r,0===r){t.tilingScheme.positionToTileXY(i,1,a);const e=t.loadTileDataAvailability(a.x,a.y,1);(0,o.A)(e)&&d.push(e)}let s=c[r];(0,o.A)(s)||(c[r]=s=[]),s.push(i)}await Promise.all(d),await Promise.all(c.map(function(e,n){if((0,o.A)(e))return(0,s.A)(t,n,e,i)}));const h=[];for(let e=0;e<n.length;++e){const t=n[e];u.computeMaximumLevelAtPosition(t)!==l[e]&&h.push(t)}return h.length>0&&await e(t,h,i),n}},10082:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(491446),o=n(605971),r=n(955943),s=n(591978);function a(e,t){this._callback=void 0,this._isConstant=void 0,this._definitionChanged=new r.A,this.setCallback(e,t)}Object.defineProperties(a.prototype,{isConstant:{get:function(){return this._isConstant}},definitionChanged:{get:function(){return this._definitionChanged}}});const c=new s.A;a.prototype.getValue=function(e,t){return(0,i.A)(e)||(e=s.A.now(c)),this._callback(e,t)},a.prototype.setCallback=function(e,t){if(!(0,i.A)(e))throw new o.A("callback is required.");if(!(0,i.A)(t))throw new o.A("isConstant is required.");const n=this._callback!==e||this._isConstant!==t;this._callback=e,this._isConstant=t,n&&this._definitionChanged.raiseEvent(this)},a.prototype.equals=function(e){return this===e||e instanceof a&&this._callback===e._callback&&this._isConstant===e._isConstant};const l=a},590108:(e,t,n)=>{"use strict";n.d(t,{A:()=>le});var i=n(215327),o=n(267980),r=n(41476),s=n(673874),a=n(607502),c=n(915325),l=n(491446),u=n(605971),d=n(955943),h=n(3858),A=n(335385),p=n(105330),f=n(744603),m=n(123245),g=n(63316),_=n(742558),y=n(789344),v=n(470540),T=n(10082),b=n(312421),w=n(808938),x=n(969077),C=n(367725),E=n(707221),S=n(151075),I=n(193189),P=n(998261);function D(e){return o.A.fromDegrees(e[0],e[1],e[2])}const O={"urn:ogc:def:crs:OGC:1.3:CRS84":D,"EPSG:4326":D,"urn:ogc:def:crs:EPSG::4326":D},R={},M={};let L,N=48,B=r.A.ROYALBLUE,F=r.A.YELLOW,U=2,k=r.A.fromBytes(255,255,0,100),V=!1;const z={small:24,medium:48,large:64},H=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function G(e,t){let n="";for(const i in e)if(e.hasOwnProperty(i)){if(i===t||-1!==H.indexOf(i))continue;const o=e[i];(0,l.A)(o)&&(n+="object"==typeof o?`<tr><th>${i}</th><td>${G(o)}</td></tr>`:`<tr><th>${i}</th><td>${o}</td></tr>`)}return n.length>0&&(n=`<table class="cesium-infoBox-defaultTable"><tbody>${n}</tbody></table>`),n}function W(e,t){return new T.A(function(e,t,n){let i;return function(o,r){return(0,l.A)(i)||(i=e(t,n)),i}}(G,e,t),!0)}function Y(e,t,n){let i=e.id;if((0,l.A)(i)&&"Feature"===e.type){let e=2,n=i;for(;(0,l.A)(t.getById(n));)n=`${i}_${e}`,e++;i=n}else i=(0,s.A)();const o=t.getOrCreateEntity(i),r=e.properties;if((0,l.A)(r)){let e;o.properties=r;const t=r.title;if((0,l.A)(t))o.name=t,e="title";else{let t=Number.MAX_VALUE;for(const n in r)if(r.hasOwnProperty(n)&&r[n]){const i=n.toLowerCase();if(t>1&&"title"===i){t=1,e=n;break}t>2&&"name"===i?(t=2,e=n):t>3&&/title/i.test(n)?(t=3,e=n):t>4&&/name/i.test(n)&&(t=4,e=n)}(0,l.A)(e)&&(o.name=r[e])}const i=r.description;null!==i&&(o.description=(0,l.A)(i)?new x.A(i):n(r,e))}return o}function q(e,t){const n=new Array(e.length);for(let i=0;i<e.length;i++)n[i]=t(e[i]);return n}const j={Feature:X,FeatureCollection:function(e,t,n,i,o){const r=t.features;for(let t=0,n=r.length;t<n;t++)X(e,r[t],0,i,o)},GeometryCollection:K,LineString:te,MultiLineString:ne,MultiPoint:Z,MultiPolygon:re,Point:J,Polygon:oe,Topology:se},Q={GeometryCollection:K,LineString:te,MultiLineString:ne,MultiPoint:Z,MultiPolygon:re,Point:J,Polygon:oe,Topology:se};function X(e,t,n,i,o){if(null===t.geometry)return void Y(t,e._entityCollection,o.describe);if(!(0,l.A)(t.geometry))throw new m.A("feature.geometry is required.");const r=t.geometry.type,s=Q[r];if(!(0,l.A)(s))throw new m.A(`Unknown geometry type: ${r}`);s(e,t,t.geometry,i,o)}function K(e,t,n,i,o){const r=n.geometries;for(let n=0,s=r.length;n<s;n++){const s=r[n],a=s.type,c=Q[a];if(!(0,l.A)(c))throw new m.A(`Unknown geometry type: ${a}`);c(e,t,s,i,o)}}function $(e,t,n,i,o){let s=o.markerSymbol,a=o.markerColor,c=o.markerSize;const u=t.properties;if((0,l.A)(u)){const e=u["marker-color"];(0,l.A)(e)&&(a=r.A.fromCssColorString(e)),c=z[u["marker-size"]]??c;const t=u["marker-symbol"];(0,l.A)(t)&&(s=t)}let d;d=(0,l.A)(s)?1===s.length?e._pinBuilder.fromText(s.toUpperCase(),a,c):e._pinBuilder.fromMakiIconId(s,a,c):e._pinBuilder.fromColor(a,c);const h=new v.A;h.verticalOrigin=new x.A(_.A.BOTTOM),2===i.length&&o.clampToGround&&(h.heightReference=g.Ay.CLAMP_TO_GROUND);const A=Y(t,e._entityCollection,o.describe);A.billboard=h,A.position=new w.A(n(i));const p=Promise.resolve(d).then(function(e){h.image=new x.A(e)}).catch(function(){h.image=new x.A(e._pinBuilder.fromColor(a,c))});e._promises.push(p)}function J(e,t,n,i,o){$(e,t,i,n.coordinates,o)}function Z(e,t,n,i,o){const r=n.coordinates;for(let n=0;n<r.length;n++)$(e,t,i,r[n],o)}function ee(e,t,n,o,s){let a=s.strokeMaterialProperty,c=s.strokeWidthProperty;const u=t.properties;if((0,l.A)(u)){const e=u["stroke-width"];let t;(0,l.A)(e)&&(c=new x.A(e));const n=u.stroke;(0,l.A)(n)&&(t=r.A.fromCssColorString(n));const i=u["stroke-opacity"];(0,l.A)(i)&&1!==i&&((0,l.A)(t)||(t=a.color.getValue().clone()),t.alpha=i),(0,l.A)(t)&&(a=new b.A(t))}const d=Y(t,e._entityCollection,s.describe),h=new P.A;d.polyline=h,h.clampToGround=s.clampToGround,h.material=a,h.width=c,h.positions=new x.A(q(o,n)),h.arcType=i.A.RHUMB}function te(e,t,n,i,o){ee(e,t,i,n.coordinates,o)}function ne(e,t,n,i,o){const r=n.coordinates;for(let n=0;n<r.length;n++)ee(e,t,i,r[n],o)}function ie(e,t,n,o,s){if(0===o.length||0===o[0].length)return;let a=s.strokeMaterialProperty.color,c=s.fillMaterialProperty,u=s.strokeWidthProperty;const d=t.properties;if((0,l.A)(d)){const e=d["stroke-width"];let t;(0,l.A)(e)&&(u=new x.A(e));const n=d.stroke;(0,l.A)(n)&&(t=r.A.fromCssColorString(n));let i,o=d["stroke-opacity"];(0,l.A)(o)&&1!==o&&((0,l.A)(t)||(t=a.getValue().clone()),t.alpha=o),(0,l.A)(t)&&(a=new x.A(t));const s=d.fill,h=c.color.getValue();(0,l.A)(s)&&(i=r.A.fromCssColorString(s),i.alpha=h.alpha),o=d["fill-opacity"],(0,l.A)(o)&&o!==h.alpha&&((0,l.A)(i)||(i=h.clone()),i.alpha=o),(0,l.A)(i)&&(c=new b.A(i))}const h=new I.A;h.outline=new x.A(!0),h.outlineColor=a,h.outlineWidth=u,h.material=c,h.arcType=i.A.RHUMB;const A=[];for(let e=1,t=o.length;e<t;e++)A.push(new p.A(q(o[e],n)));const f=o[0];h.hierarchy=new x.A(new p.A(q(f,n),A)),f[0].length>2?h.perPositionHeight=new x.A(!0):s.clampToGround||(h.height=0),Y(t,e._entityCollection,s.describe).polygon=h}function oe(e,t,n,i,o){ie(e,t,i,n.coordinates,o)}function re(e,t,n,i,o){const r=n.coordinates;for(let n=0;n<r.length;n++)ie(e,t,i,r[n],o)}function se(e,t,n,i,o){for(const t in n.objects)if(n.objects.hasOwnProperty(t)){const r=y.A(n,n.objects[t]);(0,j[r.type])(e,r,r,i,o)}}function ae(e){this._name=e,this._changed=new d.A,this._error=new d.A,this._isLoading=!1,this._loading=new d.A,this._entityCollection=new S.A(this),this._promises=[],this._pinBuilder=new A.A,this._entityCluster=new E.A,this._credit=void 0,this._resourceCredits=[]}function ce(e,t,n,i){if(!(0,l.A)(t))throw new u.A("data is required.");C.A.setLoading(e,!0);let o=(n=n??c.A.EMPTY_OBJECT).credit;"string"==typeof o&&(o=new a.A(o)),e._credit=o;let r=t,s=n.sourceUri;if("string"==typeof t||t instanceof f.A){r=(t=f.A.createIfNeeded(t)).fetchJson(),s=s??t.getUrlComponent();const n=e._resourceCredits,i=t.credits;if((0,l.A)(i)){const e=i.length;for(let t=0;t<e;t++)n.push(i[t])}}return n={describe:n.describe??W,markerSize:n.markerSize??N,markerSymbol:n.markerSymbol??L,markerColor:n.markerColor??B,strokeWidthProperty:new x.A(n.strokeWidth??U),strokeMaterialProperty:new b.A(n.stroke??F),fillMaterialProperty:new b.A(n.fill??k),clampToGround:n.clampToGround??V},Promise.resolve(r).then(function(t){return function(e,t,n,i,o){let r;(0,l.A)(i)&&(r=(0,h.A)(i)),(0,l.A)(r)&&e._name!==r&&(e._name=r,e._changed.raiseEvent(e));const s=j[t.type];if(!(0,l.A)(s))throw new m.A(`Unsupported GeoJSON object type: ${t.type}`);const a=t.crs;let c=null!==a?D:null;if((0,l.A)(a)){if(!(0,l.A)(a.properties))throw new m.A("crs.properties is undefined.");const e=a.properties;if("name"===a.type){if(c=O[e.name],!(0,l.A)(c))throw new m.A(`Unknown crs name: ${e.name}`)}else if("link"===a.type){let t=R[e.href];if((0,l.A)(t)||(t=M[e.type]),!(0,l.A)(t))throw new m.A(`Unable to resolve crs link: ${JSON.stringify(e)}`);c=t(e)}else{if("EPSG"!==a.type)throw new m.A(`Unknown crs type: ${a.type}`);if(c=O[`EPSG:${e.code}`],!(0,l.A)(c))throw new m.A(`Unknown crs EPSG code: ${e.code}`)}}return Promise.resolve(c).then(function(i){return o&&e._entityCollection.removeAll(),null!==i&&s(e,t,t,i,n),Promise.all(e._promises).then(function(){return e._promises.length=0,C.A.setLoading(e,!1),e})})}(e,t,n,s,i)}).catch(function(t){throw C.A.setLoading(e,!1),e._error.raiseEvent(e,t),t})}ae.load=function(e,t){return(new ae).load(e,t)},Object.defineProperties(ae,{markerSize:{get:function(){return N},set:function(e){N=e}},markerSymbol:{get:function(){return L},set:function(e){L=e}},markerColor:{get:function(){return B},set:function(e){B=e}},stroke:{get:function(){return F},set:function(e){F=e}},strokeWidth:{get:function(){return U},set:function(e){U=e}},fill:{get:function(){return k},set:function(e){k=e}},clampToGround:{get:function(){return V},set:function(e){V=e}},crsNames:{get:function(){return O}},crsLinkHrefs:{get:function(){return R}},crsLinkTypes:{get:function(){return M}}}),Object.defineProperties(ae.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{value:void 0,writable:!1},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!(0,l.A)(e))throw new u.A("value must be defined.");this._entityCluster=e}},credit:{get:function(){return this._credit}}}),ae.prototype.load=function(e,t){return ce(this,e,t,!0)},ae.prototype.process=function(e,t){return ce(this,e,t,!1)},ae.prototype.update=function(e){return!0};const le=ae},424620:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(41476),o=n(915325),r=n(491446),s=n(955943),a=n(591978),c=n(819488),l=n(46257);const u=i.A.WHITE,d=i.A.TRANSPARENT;function h(e){e=e??o.A.EMPTY_OBJECT,this._definitionChanged=new s.A,this._color=void 0,this._colorSubscription=void 0,this._gapColor=void 0,this._gapColorSubscription=void 0,this._dashLength=void 0,this._dashLengthSubscription=void 0,this._dashPattern=void 0,this._dashPatternSubscription=void 0,this.color=e.color,this.gapColor=e.gapColor,this.dashLength=e.dashLength,this.dashPattern=e.dashPattern}Object.defineProperties(h.prototype,{isConstant:{get:function(){return l.A.isConstant(this._color)&&l.A.isConstant(this._gapColor)&&l.A.isConstant(this._dashLength)&&l.A.isConstant(this._dashPattern)}},definitionChanged:{get:function(){return this._definitionChanged}},color:(0,c.A)("color"),gapColor:(0,c.A)("gapColor"),dashLength:(0,c.A)("dashLength"),dashPattern:(0,c.A)("dashPattern")}),h.prototype.getType=function(e){return"PolylineDash"};const A=new a.A;h.prototype.getValue=function(e,t){return(0,r.A)(e)||(e=a.A.now(A)),(0,r.A)(t)||(t={}),t.color=l.A.getValueOrClonedDefault(this._color,e,u,t.color),t.gapColor=l.A.getValueOrClonedDefault(this._gapColor,e,d,t.gapColor),t.dashLength=l.A.getValueOrDefault(this._dashLength,e,16,t.dashLength),t.dashPattern=l.A.getValueOrDefault(this._dashPattern,e,255,t.dashPattern),t},h.prototype.equals=function(e){return this===e||e instanceof h&&l.A.equals(this._color,e._color)&&l.A.equals(this._gapColor,e._gapColor)&&l.A.equals(this._dashLength,e._dashLength)&&l.A.equals(this._dashPattern,e._dashPattern)};const p=h},769493:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(41476),o=n(915325);function r(e){e=e??o.A.EMPTY_OBJECT,this.color=e.color,this.depth=e.depth,this.stencil=e.stencil,this.renderState=e.renderState,this.framebuffer=e.framebuffer,this.owner=e.owner,this.pass=e.pass}r.ALL=Object.freeze(new r({color:new i.A(0,0,0,0),depth:1,stencil:0})),r.prototype.execute=function(e,t){e.clear(this,t)};const s=r},718289:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(915325),o=n(760866);function r(e){e=e??i.A.EMPTY_OBJECT,this.vertexArray=e.vertexArray,this.fragmentShaderSource=e.fragmentShaderSource,this.shaderProgram=e.shaderProgram,this.uniformMap=e.uniformMap,this.outputTexture=e.outputTexture,this.preExecute=e.preExecute,this.postExecute=e.postExecute,this.canceled=e.canceled,this.persists=e.persists??!1,this.pass=o.A.COMPUTE,this.owner=e.owner}r.prototype.execute=function(e){e.execute(this)};const s=r},804701:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var i=n(483128),o=n(915777),r=n(57775),s=n(557053),a=n(100482),c=n(654799),l=n(616e3),u=n(915325),d=n(491446),h=n(605971),A=n(276904);function p(e){if(e=e??u.A.EMPTY_OBJECT,this._numSamples=e.numSamples??1,this._colorAttachmentsLength=e.colorAttachmentsLength??1,this._color=e.color??!0,this._depth=e.depth??!1,this._depthStencil=e.depthStencil??!1,this._supportsDepthTexture=e.supportsDepthTexture??!1,!this._color&&!this._depth&&!this._depthStencil)throw new h.A("Must enable at least one type of framebuffer attachment.");if(this._depth&&this._depthStencil)throw new h.A("Cannot have both a depth and depth-stencil attachment.");this._createColorAttachments=e.createColorAttachments??!0,this._createDepthAttachments=e.createDepthAttachments??!0,this._pixelDatatype=e.pixelDatatype,this._pixelFormat=e.pixelFormat,this._width=void 0,this._height=void 0,this._framebuffer=void 0,this._multisampleFramebuffer=void 0,this._colorTextures=void 0,this._color&&(this._colorTextures=new Array(this._colorAttachmentsLength),this._colorRenderbuffers=new Array(this._colorAttachmentsLength)),this._colorRenderbuffer=void 0,this._depthStencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthRenderbuffer=void 0,this._depthTexture=void 0,this._attachmentsDirty=!1}Object.defineProperties(p.prototype,{framebuffer:{get:function(){return this._numSamples>1?this._multisampleFramebuffer.getRenderFramebuffer():this._framebuffer}},numSamples:{get:function(){return this._numSamples}},status:{get:function(){return this.framebuffer.status}}}),p.prototype.isDirty=function(e,t,n,i,o){n=n??1;const r=this._width!==e||this._height!==t,s=this._numSamples!==n,a=(0,d.A)(i)&&this._pixelDatatype!==i||(0,d.A)(o)&&this._pixelFormat!==o,c=1===n?(0,d.A)(this._framebuffer):(0,d.A)(this._multisampleFramebuffer);return this._attachmentsDirty||r||s||a||!c||this._color&&!(0,d.A)(this._colorTextures[0])},p.prototype.update=function(e,t,n,u,p,f){if(!(0,d.A)(t)||!(0,d.A)(n))throw new h.A("width and height must be defined.");if(u=e.msaa?u??1:1,p=p??(this._color?this._pixelDatatype??r.A.UNSIGNED_BYTE:void 0),f=f??(this._color?this._pixelFormat??A.A.RGBA:void 0),this.isDirty(t,n,u,p,f)){if(this.destroy(),this._width=t,this._height=n,this._numSamples=u,this._pixelDatatype=p,this._pixelFormat=f,this._attachmentsDirty=!1,this._color&&this._createColorAttachments)for(let i=0;i<this._colorAttachmentsLength;++i)if(this._colorTextures[i]=new l.A({context:e,width:t,height:n,pixelFormat:f,pixelDatatype:p,sampler:c.A.NEAREST}),this._numSamples>1){const o=a.A.getColorFormat(p);this._colorRenderbuffers[i]=new s.A({context:e,width:t,height:n,format:o,numSamples:this._numSamples})}this._depthStencil&&this._createDepthAttachments&&(this._supportsDepthTexture&&e.depthTexture?(this._depthStencilTexture=new l.A({context:e,width:t,height:n,pixelFormat:A.A.DEPTH_STENCIL,pixelDatatype:r.A.UNSIGNED_INT_24_8,sampler:c.A.NEAREST}),this._numSamples>1&&(this._depthStencilRenderbuffer=new s.A({context:e,width:t,height:n,format:a.A.DEPTH24_STENCIL8,numSamples:this._numSamples}))):this._depthStencilRenderbuffer=new s.A({context:e,width:t,height:n,format:a.A.DEPTH_STENCIL})),this._depth&&this._createDepthAttachments&&(this._supportsDepthTexture&&e.depthTexture?this._depthTexture=new l.A({context:e,width:t,height:n,pixelFormat:A.A.DEPTH_COMPONENT,pixelDatatype:r.A.UNSIGNED_INT,sampler:c.A.NEAREST}):this._depthRenderbuffer=new s.A({context:e,width:t,height:n,format:a.A.DEPTH_COMPONENT16})),this._numSamples>1?this._multisampleFramebuffer=new o.A({context:e,width:this._width,height:this._height,colorTextures:this._colorTextures,colorRenderbuffers:this._colorRenderbuffers,depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1}):this._framebuffer=new i.A({context:e,colorTextures:this._colorTextures,depthTexture:this._depthTexture,depthRenderbuffer:this._depthRenderbuffer,depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1})}},p.prototype.getColorTexture=function(e){if((e=e??0)>=this._colorAttachmentsLength)throw new h.A("index must be smaller than total number of color attachments.");return this._colorTextures[e]},p.prototype.setColorTexture=function(e,t){if(t=t??0,this._createColorAttachments)throw new h.A("createColorAttachments must be false if setColorTexture is called.");if(t>=this._colorAttachmentsLength)throw new h.A("index must be smaller than total number of color attachments.");this._attachmentsDirty=e!==this._colorTextures[t],this._colorTextures[t]=e},p.prototype.getColorRenderbuffer=function(e){if((e=e??0)>=this._colorAttachmentsLength)throw new h.A("index must be smaller than total number of color attachments.");return this._colorRenderbuffers[e]},p.prototype.setColorRenderbuffer=function(e,t){if(t=t??0,this._createColorAttachments)throw new h.A("createColorAttachments must be false if setColorRenderbuffer is called.");if(t>=this._colorAttachmentsLength)throw new h.A("index must be smaller than total number of color attachments.");this._attachmentsDirty=e!==this._colorRenderbuffers[t],this._colorRenderbuffers[t]=e},p.prototype.getDepthRenderbuffer=function(){return this._depthRenderbuffer},p.prototype.setDepthRenderbuffer=function(e){if(this._createDepthAttachments)throw new h.A("createDepthAttachments must be false if setDepthRenderbuffer is called.");this._attachmentsDirty=e!==this._depthRenderbuffer,this._depthRenderbuffer=e},p.prototype.getDepthTexture=function(){return this._depthTexture},p.prototype.setDepthTexture=function(e){if(this._createDepthAttachments)throw new h.A("createDepthAttachments must be false if setDepthTexture is called.");this._attachmentsDirty=e!==this._depthTexture,this._depthTexture=e},p.prototype.getDepthStencilRenderbuffer=function(){return this._depthStencilRenderbuffer},p.prototype.setDepthStencilRenderbuffer=function(e){if(this._createDepthAttachments)throw new h.A("createDepthAttachments must be false if setDepthStencilRenderbuffer is called.");this._attachmentsDirty=e!==this._depthStencilRenderbuffer,this._depthStencilRenderbuffer=e},p.prototype.getDepthStencilTexture=function(){return this._depthStencilTexture},p.prototype.setDepthStencilTexture=function(e){if(this._createDepthAttachments)throw new h.A("createDepthAttachments must be false if setDepthStencilTexture is called.");this._attachmentsDirty=e!==this._depthStencilTexture,this._depthStencilTexture=e},p.prototype.prepareTextures=function(e,t){this._numSamples>1&&this._multisampleFramebuffer.blitFramebuffers(e,t)},p.prototype.clear=function(e,t,n){const i=t.framebuffer;t.framebuffer=this.framebuffer,t.execute(e,n),t.framebuffer=i},p.prototype.destroyFramebuffer=function(){this._framebuffer=this._framebuffer&&this._framebuffer.destroy(),this._multisampleFramebuffer=this._multisampleFramebuffer&&this._multisampleFramebuffer.destroy()},p.prototype.destroy=function(){if(this._color){const e=this._colorTextures,t=this._colorRenderbuffers;for(let n=0;n<e.length;++n){const i=e[n];this._createColorAttachments&&(0,d.A)(i)&&!i.isDestroyed()&&i.destroy(),(0,d.A)(i)&&i.isDestroyed()&&(e[n]=void 0);const o=t[n];this._createColorAttachments&&(0,d.A)(o)&&!o.isDestroyed()&&o.destroy(),(0,d.A)(o)&&o.isDestroyed()&&(t[n]=void 0)}}this._depthStencil&&(this._createDepthAttachments&&(this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()),(0,d.A)(this._depthStencilTexture)&&this._depthStencilTexture.isDestroyed()&&(this._depthStencilTexture=void 0),(0,d.A)(this._depthStencilRenderbuffer)&&this._depthStencilRenderbuffer.isDestroyed()&&(this._depthStencilRenderbuffer=void 0)),this._depth&&(this._createDepthAttachments&&(this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy()),(0,d.A)(this._depthTexture)&&this._depthTexture.isDestroyed()&&(this._depthTexture=void 0),(0,d.A)(this._depthRenderbuffer)&&this._depthRenderbuffer.isDestroyed()&&(this._depthRenderbuffer=void 0)),this.destroyFramebuffer()};const f=p},915777:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(369031),o=n(915325),r=n(491446),s=n(677354),a=n(605971),c=n(483128);function l(e){e=e??o.A.EMPTY_OBJECT;const{context:t,width:n,height:s,colorRenderbuffers:l,colorTextures:u,depthStencilRenderbuffer:d,depthStencilTexture:h,destroyAttachments:A}=e;if(i.A.defined("options.context",t),i.A.defined("options.width",n),i.A.defined("options.height",s),this._width=n,this._height=s,(0,r.A)(l)!==(0,r.A)(u))throw new a.A("Both color renderbuffer and texture attachments must be provided.");if((0,r.A)(d)!==(0,r.A)(h))throw new a.A("Both depth-stencil renderbuffer and texture attachments must be provided.");this._renderFramebuffer=new c.A({context:t,colorRenderbuffers:l,depthStencilRenderbuffer:d,destroyAttachments:A}),this._colorFramebuffer=new c.A({context:t,colorTextures:u,depthStencilTexture:h,destroyAttachments:A})}l.prototype.getRenderFramebuffer=function(){return this._renderFramebuffer},l.prototype.getColorFramebuffer=function(){return this._colorFramebuffer},l.prototype.blitFramebuffers=function(e,t){this._renderFramebuffer.bindRead(),this._colorFramebuffer.bindDraw();const n=e._gl;let i=0;this._colorFramebuffer._colorTextures.length>0&&(i|=n.COLOR_BUFFER_BIT),(0,r.A)(this._colorFramebuffer.depthStencilTexture)&&(i|=n.DEPTH_BUFFER_BIT|(t?n.STENCIL_BUFFER_BIT:0)),n.blitFramebuffer(0,0,this._width,this._height,0,0,this._width,this._height,i,n.NEAREST),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null)},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return this._renderFramebuffer.destroy(),this._colorFramebuffer.destroy(),(0,s.A)(this)};const u=l},557053:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(369031),o=n(915325),r=n(491446),s=n(677354),a=n(605971),c=n(430332),l=n(100482);function u(e){e=e??o.A.EMPTY_OBJECT,i.A.defined("options.context",e.context);const t=e.context,n=t._gl,s=c.A.maximumRenderbufferSize,u=e.format??l.A.RGBA4,d=(0,r.A)(e.width)?e.width:t.drawingBufferWidth,h=(0,r.A)(e.height)?e.height:t.drawingBufferHeight,A=e.numSamples??1;if(!l.A.validate(u))throw new a.A("Invalid format.");if(i.A.typeOf.number.greaterThan("width",d,0),d>s)throw new a.A(`Width must be less than or equal to the maximum renderbuffer size (${s}).  Check maximumRenderbufferSize.`);if(i.A.typeOf.number.greaterThan("height",h,0),h>s)throw new a.A(`Height must be less than or equal to the maximum renderbuffer size (${s}).  Check maximumRenderbufferSize.`);this._gl=n,this._format=u,this._width=d,this._height=h,this._renderbuffer=this._gl.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,this._renderbuffer),A>1?n.renderbufferStorageMultisample(n.RENDERBUFFER,A,u,d,h):n.renderbufferStorage(n.RENDERBUFFER,u,d,h),n.bindRenderbuffer(n.RENDERBUFFER,null)}Object.defineProperties(u.prototype,{format:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}}),u.prototype._getRenderbuffer=function(){return this._renderbuffer},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){return this._gl.deleteRenderbuffer(this._renderbuffer),(0,s.A)(this)};const d=u},100482:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(352581);const o={RGBA4:i.A.RGBA4,RGBA8:i.A.RGBA8,RGBA16F:i.A.RGBA16F,RGBA32F:i.A.RGBA32F,RGB5_A1:i.A.RGB5_A1,RGB565:i.A.RGB565,DEPTH_COMPONENT16:i.A.DEPTH_COMPONENT16,STENCIL_INDEX8:i.A.STENCIL_INDEX8,DEPTH_STENCIL:i.A.DEPTH_STENCIL,DEPTH24_STENCIL8:i.A.DEPTH24_STENCIL8,validate:function(e){return e===o.RGBA4||e===o.RGBA8||e===o.RGBA16F||e===o.RGBA32F||e===o.RGB5_A1||e===o.RGB565||e===o.DEPTH_COMPONENT16||e===o.STENCIL_INDEX8||e===o.DEPTH_STENCIL||e===o.DEPTH24_STENCIL8},getColorFormat:function(e){return e===i.A.FLOAT?o.RGBA32F:e===i.A.HALF_FLOAT_OES?o.RGBA16F:o.RGBA8}},r=Object.freeze(o)},469635:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(369031),o=n(376758),r=n(491446),s=n(605971),a=n(624512),c=n(302836),l=n(342875),u=n(693299),d=n(539846),h=n(702247);function A(){this._positionAttributeLine=void 0,this._nextAttributeLocation=1,this._attributeLocations={},this._attributeLines=[],this._structs={},this._functions={},this._vertexShaderParts={defineLines:[],uniformLines:[],shaderLines:[],varyingLines:[],structIds:[],functionIds:[]},this._fragmentShaderParts={defineLines:[],uniformLines:[],shaderLines:[],varyingLines:[],structIds:[],functionIds:[]}}Object.defineProperties(A.prototype,{attributeLocations:{get:function(){return this._attributeLocations}}}),A.prototype.addDefine=function(e,t,n){i.A.typeOf.string("identifier",e),n=n??a.A.BOTH;let o=e;(0,r.A)(t)&&(o+=` ${t.toString()}`),a.A.includesVertexShader(n)&&this._vertexShaderParts.defineLines.push(o),a.A.includesFragmentShader(n)&&this._fragmentShaderParts.defineLines.push(o)},A.prototype.addStruct=function(e,t,n){i.A.typeOf.string("structId",e),i.A.typeOf.string("structName",t),i.A.typeOf.number("destination",n),this._structs[e]=new u.A(t),a.A.includesVertexShader(n)&&this._vertexShaderParts.structIds.push(e),a.A.includesFragmentShader(n)&&this._fragmentShaderParts.structIds.push(e)},A.prototype.addStructField=function(e,t,n){i.A.typeOf.string("structId",e),i.A.typeOf.string("type",t),i.A.typeOf.string("identifier",n),this._structs[e].addField(t,n)},A.prototype.addFunction=function(e,t,n){i.A.typeOf.string("functionName",e),i.A.typeOf.string("signature",t),i.A.typeOf.number("destination",n),this._functions[e]=new d.A(t),a.A.includesVertexShader(n)&&this._vertexShaderParts.functionIds.push(e),a.A.includesFragmentShader(n)&&this._fragmentShaderParts.functionIds.push(e)},A.prototype.addFunctionLines=function(e,t){if(i.A.typeOf.string("functionName",e),"string"!=typeof t&&!Array.isArray(t))throw new s.A(`Expected lines to be a string or an array of strings, actual value was ${t}`);this._functions[e].addLines(t)},A.prototype.addUniform=function(e,t,n){i.A.typeOf.string("type",e),i.A.typeOf.string("identifier",t),n=n??a.A.BOTH;const o=`uniform ${e} ${t};`;a.A.includesVertexShader(n)&&this._vertexShaderParts.uniformLines.push(o),a.A.includesFragmentShader(n)&&this._fragmentShaderParts.uniformLines.push(o)},A.prototype.setPositionAttribute=function(e,t){if(i.A.typeOf.string("type",e),i.A.typeOf.string("identifier",t),(0,r.A)(this._positionAttributeLine))throw new s.A("setPositionAttribute() must be called exactly once for the attribute used for gl_Position. For other attributes, use addAttribute()");return this._positionAttributeLine=`in ${e} ${t};`,this._attributeLocations[t]=0,0},A.prototype.addAttribute=function(e,t){i.A.typeOf.string("type",e),i.A.typeOf.string("identifier",t);const n=`in ${e} ${t};`;this._attributeLines.push(n);const o=this._nextAttributeLocation;return this._attributeLocations[t]=o,this._nextAttributeLocation+=function(e){switch(e){case"mat2":return 2;case"mat3":return 3;case"mat4":return 4;default:return 1}}(e),o},A.prototype.addVarying=function(e,t,n){i.A.typeOf.string("type",e),i.A.typeOf.string("identifier",t),n=(0,r.A)(n)?`${n} `:"";const o=`${e} ${t};`;this._vertexShaderParts.varyingLines.push(`${n}out ${o}`),this._fragmentShaderParts.varyingLines.push(`${n}in ${o}`)},A.prototype.addVertexLines=function(e){if("string"!=typeof e&&!Array.isArray(e))throw new s.A(`Expected lines to be a string or an array of strings, actual value was ${e}`);const t=this._vertexShaderParts.shaderLines;Array.isArray(e)?(0,h.A)(t,e):t.push(e)},A.prototype.addFragmentLines=function(e){if("string"!=typeof e&&!Array.isArray(e))throw new s.A(`Expected lines to be a string or an array of strings, actual value was ${e}`);const t=this._fragmentShaderParts.shaderLines;Array.isArray(e)?(0,h.A)(t,e):t.push(e)},A.prototype.buildShaderProgram=function(e){i.A.typeOf.object("context",e);const t=(0,r.A)(this._positionAttributeLine)?[this._positionAttributeLine]:[],n=function(e){const t=[],n=[];let i,o,r,s,a=e._vertexShaderParts.structIds;for(i=0;i<a.length;i++)o=a[i],r=e._structs[o],s=r.generateGlslLines(),(0,h.A)(t,s);for(a=e._fragmentShaderParts.structIds,i=0;i<a.length;i++)o=a[i],r=e._structs[o],s=r.generateGlslLines(),(0,h.A)(n,s);return{vertexLines:t,fragmentLines:n}}(this),o=function(e){const t=[],n=[];let i,o,r,s,a=e._vertexShaderParts.functionIds;for(i=0;i<a.length;i++)o=a[i],r=e._functions[o],s=r.generateGlslLines(),(0,h.A)(t,s);for(a=e._fragmentShaderParts.functionIds,i=0;i<a.length;i++)o=a[i],r=e._functions[o],s=r.generateGlslLines(),(0,h.A)(n,s);return{vertexLines:t,fragmentLines:n}}(this),s=t.concat(this._attributeLines,this._vertexShaderParts.uniformLines,this._vertexShaderParts.varyingLines,n.vertexLines,o.vertexLines,this._vertexShaderParts.shaderLines).join("\n"),a=new l.A({defines:this._vertexShaderParts.defineLines,sources:[s]}),u=this._fragmentShaderParts.uniformLines.concat(this._fragmentShaderParts.varyingLines,n.fragmentLines,o.fragmentLines,this._fragmentShaderParts.shaderLines).join("\n"),d=new l.A({defines:this._fragmentShaderParts.defineLines,sources:[u]});return c.A.fromCache({context:e,vertexShaderSource:a,fragmentShaderSource:d,attributeLocations:this._attributeLocations})},A.prototype.clone=function(){return(0,o.A)(this,!0)};const p=A},624512:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(369031);const o={VERTEX:0,FRAGMENT:1,BOTH:2,includesVertexShader:function(e){return i.A.typeOf.number("destination",e),e===o.VERTEX||e===o.BOTH},includesFragmentShader:function(e){return i.A.typeOf.number("destination",e),e===o.FRAGMENT||e===o.BOTH}},r=Object.freeze(o)},539846:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(605971);function o(e){this.signature=e,this.body=[]}o.prototype.addLines=function(e){if("string"!=typeof e&&!Array.isArray(e))throw new i.A(`Expected lines to be a string or an array of strings, actual value was ${e}`);const t=this.body;if(Array.isArray(e)){const n=e.length;for(let i=0;i<n;i++)t.push(`    ${e[i]}`)}else t.push(`    ${e}`)},o.prototype.generateGlslLines=function(){return[].concat(this.signature,"{",this.body,"}")};const r=o},693299:(e,t,n)=>{"use strict";function i(e){this.name=e,this.fields=[]}n.d(t,{A:()=>o}),i.prototype.addField=function(e,t){const n=`    ${e} ${t};`;this.fields.push(n)},i.prototype.generateGlslLines=function(){let e=this.fields;return 0===e.length&&(e=["    float _empty;"]),[].concat(`struct ${this.name}`,"{",e,"};")};const o=i},953019:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"})},418510:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({SATELLITE:1,OCEANS:2,HILLSHADE:3})},531573:(e,t,n)=>{"use strict";n.d(t,{A:()=>I});var i=n(434067),o=n(267980),r=n(336946),s=n(369031),a=n(607502),c=n(915325),l=n(491446),u=n(955943),d=n(653577),h=n(182348),A=n(367817),p=n(697422),f=n(744603),m=n(123245),g=n(414305),_=n(41076),y=n(95146),v=n(836721),T=n(789989),b=n(553909),w=n(418510),x=n(605971);function C(e){this.useTiles=e.usePreCachedTilesIfAvailable??!0;const t=e.ellipsoid;this.tilingScheme=e.tilingScheme??new h.A({ellipsoid:t}),this.rectangle=e.rectangle??this.tilingScheme.rectangle,this.ellipsoid=t;let n=e.credit;"string"==typeof n&&(n=new a.A(n)),this.credit=n,this.tileCredits=void 0,this.tileDiscardPolicy=e.tileDiscardPolicy,this.tileWidth=e.tileWidth??256,this.tileHeight=e.tileHeight??256,this.maximumLevel=e.maximumLevel}function E(e){e=e??c.A.EMPTY_OBJECT,this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tileDiscardPolicy=e.tileDiscardPolicy,this._tileWidth=e.tileWidth??256,this._tileHeight=e.tileHeight??256,this._maximumLevel=e.maximumLevel,this._tilingScheme=e.tilingScheme??new h.A({ellipsoid:e.ellipsoid}),this._useTiles=e.usePreCachedTilesIfAvailable??!0,this._rectangle=e.rectangle??this._tilingScheme.rectangle,this._layers=e.layers,this._credit=e.credit,this._tileCredits=void 0;let t=e.credit;"string"==typeof t&&(t=new a.A(t)),this.enablePickFeatures=e.enablePickFeatures??!0,this._errorEvent=new u.A}function S(e,t,n,i,o){let r;if(e._useTiles)r=e._resource.getDerivedResource({url:`tile/${i}/${n}/${t}`,request:o});else{const s=e._tilingScheme.tileXYToNativeRectangle(t,n,i),a={bbox:`${s.west},${s.south},${s.east},${s.north}`,size:`${e._tileWidth},${e._tileHeight}`,format:"png32",transparent:!0,f:"image"};e._tilingScheme.projection instanceof d.A?(a.bboxSR=4326,a.imageSR=4326):(a.bboxSR=3857,a.imageSR=3857),e.layers&&(a.layers=`show:${e.layers}`),r=e._resource.getDerivedResource({url:"export",request:o,queryParameters:a})}return r}C.prototype.build=function(e){e._useTiles=this.useTiles,e._tilingScheme=this.tilingScheme,e._rectangle=this.rectangle,e._credit=this.credit,e._tileCredits=this.tileCredits,e._tileDiscardPolicy=this.tileDiscardPolicy,e._tileWidth=this.tileWidth,e._tileHeight=this.tileHeight,e._maximumLevel=this.maximumLevel,this.useTiles&&!(0,l.A)(this.tileDiscardPolicy)&&(e._tileDiscardPolicy=new v.A({missingImageUrl:S(e,0,0,this.maximumLevel).url,pixelsToCheck:[new i.A(0,0),new i.A(200,20),new i.A(20,200),new i.A(80,110),new i.A(160,130)],disableCheckIfAllPixelsAreTransparent:!0}))},E.fromBasemapType=async function(e,t){let n,i,o;switch(s.A.defined("style",e),t=t??c.A.EMPTY_OBJECT,e){case w.A.SATELLITE:{n=t.token??y.A.defaultAccessToken,i=f.A.createIfNeeded(y.A.defaultWorldImageryServer),i.appendForwardSlash();const e=y.A.getDefaultTokenCredit(n);(0,l.A)(e)&&(o=a.A.clone(e))}break;case w.A.OCEANS:{n=t.token??y.A.defaultAccessToken,i=f.A.createIfNeeded(y.A.defaultWorldOceanServer),i.appendForwardSlash();const e=y.A.getDefaultTokenCredit(n);(0,l.A)(e)&&(o=a.A.clone(e))}break;case w.A.HILLSHADE:{n=t.token??y.A.defaultAccessToken,i=f.A.createIfNeeded(y.A.defaultWorldHillshadeServer),i.appendForwardSlash();const e=y.A.getDefaultTokenCredit(n);(0,l.A)(e)&&(o=a.A.clone(e))}break;default:throw new x.A(`Unsupported basemap type: ${e}`)}return E.fromUrl(i,{...t,token:n,credit:o,usePreCachedTilesIfAvailable:!0})},Object.defineProperties(E.prototype,{url:{get:function(){return this._resource._url}},token:{get:function(){return this._resource.queryParameters.token}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return!0}},layers:{get:function(){return this._layers}}}),E.fromUrl=async function(e,t){s.A.defined("url",e),t=t??c.A.EMPTY_OBJECT;const n=f.A.createIfNeeded(e);n.appendForwardSlash(),(0,l.A)(t.token)&&n.setQueryParameters({token:t.token});const i=new E(t);i._resource=n;const r=new C(t);return(t.usePreCachedTilesIfAvailable??!0)&&await async function(e,t){const n=e.getDerivedResource({queryParameters:{f:"json"}});try{!function(e,t){const n=e.tileInfo;if((0,l.A)(n)){if(t.tileWidth=n.rows,t.tileHeight=n.cols,102100===n.spatialReference.wkid||102113===n.spatialReference.wkid)t.tilingScheme=new _.A({ellipsoid:t.ellipsoid});else{if(4326!==e.tileInfo.spatialReference.wkid){const t=`Tile spatial reference WKID ${e.tileInfo.spatialReference.wkid} is not supported.`;throw new m.A(t)}t.tilingScheme=new h.A({ellipsoid:t.ellipsoid})}if(t.maximumLevel=e.tileInfo.lods.length-1,(0,l.A)(e.fullExtent)){if((0,l.A)(e.fullExtent.spatialReference)&&(0,l.A)(e.fullExtent.spatialReference.wkid))if(102100===e.fullExtent.spatialReference.wkid||102113===e.fullExtent.spatialReference.wkid){const n=new g.A,i=e.fullExtent,r=n.unproject(new o.A(Math.max(i.xmin,-t.tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.max(i.ymin,-t.tilingScheme.ellipsoid.maximumRadius*Math.PI),0)),s=n.unproject(new o.A(Math.min(i.xmax,t.tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.min(i.ymax,t.tilingScheme.ellipsoid.maximumRadius*Math.PI),0));t.rectangle=new p.A(r.longitude,r.latitude,s.longitude,s.latitude)}else{if(4326!==e.fullExtent.spatialReference.wkid){const t=`fullExtent.spatialReference WKID ${e.fullExtent.spatialReference.wkid} is not supported.`;throw new m.A(t)}t.rectangle=p.A.fromDegrees(e.fullExtent.xmin,e.fullExtent.ymin,e.fullExtent.xmax,e.fullExtent.ymax)}}else t.rectangle=t.tilingScheme.rectangle;t.useTiles=!0}else t.useTiles=!1;(0,l.A)(e.copyrightText)&&e.copyrightText.length>0&&((0,l.A)(t.credit)?t.tileCredits=[new a.A(e.copyrightText)]:t.credit=new a.A(e.copyrightText))}(await n.fetchJson(),t)}catch(t){!function(e,t){let n=`An error occurred while accessing ${e.url}`;throw(0,l.A)(t)&&(0,l.A)(t.message)&&(n+=`: ${t.message}`),new m.A(n)}(e,t)}}(n,r),r.build(i),i},E.prototype.getTileCredits=function(e,t,n){return this._tileCredits},E.prototype.requestImage=function(e,t,n,i){return b.A.loadImage(this,S(this,e,t,n,i))},E.prototype.pickFeatures=function(e,t,n,i,s){if(!this.enablePickFeatures)return;const a=this._tilingScheme.tileXYToNativeRectangle(e,t,n);let c,u,h;if(this._tilingScheme.projection instanceof d.A)c=A.A.toDegrees(i),u=A.A.toDegrees(s),h="4326";else{const e=this._tilingScheme.projection.project(new r.A(i,s,0));c=e.x,u=e.y,h="3857"}let p="visible";(0,l.A)(this._layers)&&(p+=`:${this._layers}`);const f={f:"json",tolerance:2,geometryType:"esriGeometryPoint",geometry:`${c},${u}`,mapExtent:`${a.west},${a.south},${a.east},${a.north}`,imageDisplay:`${this._tileWidth},${this._tileHeight},96`,sr:h,layers:p};return this._resource.getDerivedResource({url:"identify",queryParameters:f}).fetchJson().then(function(e){const t=[],n=e.results;if(!(0,l.A)(n))return t;for(let e=0;e<n.length;++e){const i=n[e],s=new T.A;if(s.data=i,s.name=i.value,s.properties=i.attributes,s.configureDescriptionFromProperties(i.attributes),"esriGeometryPoint"===i.geometryType&&i.geometry){const e=i.geometry.spatialReference&&i.geometry.spatialReference.wkid?i.geometry.spatialReference.wkid:4326;if(4326===e||4283===e)s.position=r.A.fromDegrees(i.geometry.x,i.geometry.y,i.geometry.z);else if(102100===e||900913===e||3857===e){const e=new g.A;s.position=e.unproject(new o.A(i.geometry.x,i.geometry.y,i.geometry.z))}}t.push(s)}return t})},E._metadataCache={};const I=E},95146:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(607502),o=n(491446),r=n(744603);let s;const a="AAPTxy8BH1VEsoebNVZXo8HurEOF051kAEKlhkOhBEc9BmRXcPUeuOd6ZTh-Z86vRv6teqZdBYLUWIxB6HTYajPhFtAlXhMdqTg07UwlBQ59KbiReC5wCeOF4LzLTW4oaSPp-t4pEcJHnFePlnFcIPXM7R565gTy6f6fMuZAXPvUEuZSMf8dvTqHyV9-Zd9eZGWokDzKC4uEtHME7OeAk3oyZ7vzkjEo8fpuIfFw0sH8vQU.AT1_PLgWE6Lc",c={};c.defaultAccessToken=a,c.defaultWorldImageryServer=new r.A({url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}),c.defaultWorldHillshadeServer=new r.A({url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}),c.defaultWorldOceanServer=new r.A({url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"}),c.getDefaultTokenCredit=function(e){if(e===a){if(!(0,o.A)(s)){const e='<b>             This application is using a default ArcGIS access token. Please assign <i>Cesium.ArcGisMapService.defaultAccessToken</i>             with an API key from your ArcGIS Developer account before using the ArcGIS tile services.             You can sign up for a free ArcGIS Developer account at <a href="https://developers.arcgis.com/">https://developers.arcgis.com/</a>.</b>';s=new i.A(e,!0)}return s}};const l=c},153662:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(267980),o=n(367817),r=n(226381);function s(){this.lightIntensity=10,this.rayleighCoefficient=new i.A(55e-7,13e-6,284e-7),this.mieCoefficient=new i.A(21e-6,21e-6,21e-6),this.rayleighScaleHeight=1e4,this.mieScaleHeight=3200,this.mieAnisotropy=.9,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this.dynamicLighting=r.A.NONE}s.requiresColorCorrect=function(e){return!(o.A.equalsEpsilon(e.hueShift,0,o.A.EPSILON7)&&o.A.equalsEpsilon(e.saturationShift,0,o.A.EPSILON7)&&o.A.equalsEpsilon(e.brightnessShift,0,o.A.EPSILON7))};const a=s},320475:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(369031),o=n(331185),r=n(584164);const s={X:0,Y:1,Z:2};s.Y_UP_TO_Z_UP=r.A.fromRotationTranslation(o.A.fromArray([1,0,0,0,0,1,0,-1,0])),s.Z_UP_TO_Y_UP=r.A.fromRotationTranslation(o.A.fromArray([1,0,0,0,0,-1,0,1,0])),s.X_UP_TO_Z_UP=r.A.fromRotationTranslation(o.A.fromArray([0,0,1,0,1,0,-1,0,0])),s.Z_UP_TO_X_UP=r.A.fromRotationTranslation(o.A.fromArray([0,0,-1,0,1,0,1,0,0])),s.X_UP_TO_Y_UP=r.A.fromRotationTranslation(o.A.fromArray([0,1,0,-1,0,0,0,0,1])),s.Y_UP_TO_X_UP=r.A.fromRotationTranslation(o.A.fromArray([0,-1,0,1,0,0,0,0,1])),s.fromName=function(e){return i.A.typeOf.string("name",e),s[e]};const a=Object.freeze(s)},511517:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(369031),o=n(786101),r=n(604752),s=n(123245);const a={};a._deprecationWarning=o.A;const c=Uint32Array.BYTES_PER_ELEMENT;a.parse=function(e,t){const n=t??0;i.A.defined("arrayBuffer",e),t=n;const o=new Uint8Array(e),l=new DataView(e);t+=c;const u=l.getUint32(t,!0);if(1!==u)throw new s.A(`Only Batched 3D Model version 1 is supported.  Version ${u} is not.`);t+=c;const d=l.getUint32(t,!0);t+=c;let h=l.getUint32(t,!0);t+=c;let A=l.getUint32(t,!0);t+=c;let p=l.getUint32(t,!0);t+=c;let f,m,g=l.getUint32(t,!0);t+=c,p>=570425344?(t-=2*c,f=h,p=A,g=0,h=0,A=0,a._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Batched3DModel.")):g>=570425344&&(t-=c,f=p,p=h,g=A,h=0,A=0,a._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Batched3DModel.")),0===h?m={BATCH_LENGTH:f??0}:(m=(0,r.A)(o,t,h),t+=h);const _=new Uint8Array(e,t,A);let y,v;t+=A,p>0&&(y=(0,r.A)(o,t,p),t+=p,g>0&&(v=new Uint8Array(e,t,g),v=new Uint8Array(v),t+=g));const T=n+d-t;if(0===T)throw new s.A("glTF byte length must be greater than 0.");let b;return t%4==0?b=new Uint8Array(e,t,T):(a._deprecationWarning("b3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),b=new Uint8Array(o.subarray(t,t+T))),{batchLength:f,featureTableJson:m,featureTableBinary:_,batchTableJson:y,batchTableBinary:v,gltf:b}};const l=a},744671:(e,t,n)=>{"use strict";n.d(t,{A:()=>T});var i=n(730839),o=n(369031),r=n(376758),s=n(430346),a=n(571804),c=n(491446),l=n(605971),u=n(351554),d=n(123245);function h(e){this._classes=void 0,this._classIds=void 0,this._classIndexes=void 0,this._parentCounts=void 0,this._parentIndexes=void 0,this._parentIds=void 0,this._byteLength=0,o.A.typeOf.object("options.extension",e.extension),function(e,t,n){let o,r,l;const d=t.instancesLength,h=t.classes;let f,m=t.classIds,g=t.parentCounts,_=t.parentIds,y=d,v=0;if((0,c.A)(m.byteOffset)&&(m.componentType=m.componentType??a.A.UNSIGNED_SHORT,m.type=i.A.SCALAR,l=(0,u.A)(m),m=l.createArrayBufferView(n.buffer,n.byteOffset+m.byteOffset,d),v+=m.byteLength),(0,c.A)(g)){for((0,c.A)(g.byteOffset)&&(g.componentType=g.componentType??a.A.UNSIGNED_SHORT,g.type=i.A.SCALAR,l=(0,u.A)(g),g=l.createArrayBufferView(n.buffer,n.byteOffset+g.byteOffset,d),v+=g.byteLength),f=new Uint16Array(d),y=0,o=0;o<d;++o)f[o]=y,y+=g[o];v+=f.byteLength}(0,c.A)(_)&&(0,c.A)(_.byteOffset)&&(_.componentType=_.componentType??a.A.UNSIGNED_SHORT,_.type=i.A.SCALAR,l=(0,u.A)(_),_=l.createArrayBufferView(n.buffer,n.byteOffset+_.byteOffset,y),v+=_.byteLength);const T=h.length;for(o=0;o<T;++o){const e=h[o].length,t=h[o].instances,i=A(e,t,n);v+=p(i),h[o].instances=(0,s.A)(i,t)}const b=new Array(T).fill(0),w=new Uint16Array(d);for(o=0;o<d;++o)r=m[o],w[o]=b[r],++b[r];v+=w.byteLength,e._classes=h,e._classIds=m,e._classIndexes=w,e._parentCounts=g,e._parentIndexes=f,e._parentIds=_,e._byteLength=v}(this,e.extension,e.binaryBody),function(e){const t=f;t.length=0;const n=e._classIds.length;for(let i=0;i<n;++i)m(e,i,t)}(this)}function A(e,t,n){let i;for(const o in t)if(t.hasOwnProperty(o)){const r=t[o],s=r.byteOffset;if((0,c.A)(s)){const t=r.componentType,a=r.type;if(!(0,c.A)(t))throw new d.A("componentType is required.");if(!(0,c.A)(a))throw new d.A("type is required.");if(!(0,c.A)(n))throw new d.A(`Property ${o} requires a batch table binary.`);const l=(0,u.A)(r),h=l.componentsPerAttribute,A=l.classType,p=l.createArrayBufferView(n.buffer,n.byteOffset+s,e);(0,c.A)(i)||(i={}),i[o]={typedArray:p,componentCount:h,type:A}}}return i}function p(e){let t=0;for(const n in e)e.hasOwnProperty(n)&&(t+=e[n].typedArray.byteLength);return t}Object.defineProperties(h.prototype,{byteLength:{get:function(){return this._byteLength}}});const f=[];function m(e,t,n){const i=e._parentCounts,o=e._parentIds,r=e._parentIndexes,s=e._classIds.length;if(!(0,c.A)(o))return;if(t>=s)throw new l.A(`Parent index ${t} exceeds the total number of instances: ${s}`);if(n.indexOf(t)>-1)throw new l.A("Circular dependency detected in the batch table hierarchy.");n.push(t);const a=(0,c.A)(i)?i[t]:1,u=(0,c.A)(i)?r[t]:t;for(let i=0;i<a;++i){const r=o[u+i];r!==t&&m(e,r,n)}n.pop(t)}const g=[],_=[];let y=0;function v(e,t,n){const i=e._parentCounts,o=e._parentIds;return(0,c.A)(o)?(0,c.A)(i)?function(e,t,n){const i=e._classIds,o=e._parentCounts,r=e._parentIds,s=e._parentIndexes,a=i.length,l=g;l.length=Math.max(l.length,a);const u=++y,d=_;for(d.length=0,d.push(t);d.length>0;){if(l[t=d.pop()]===u)continue;l[t]=u;const i=n(e,t);if((0,c.A)(i))return i;const a=o[t],h=s[t];for(let e=0;e<a;++e){const n=r[h+e];n!==t&&d.push(n)}}}(e,t,n):function(e,t,n){let i=!0;for(;i;){const o=n(e,t);if((0,c.A)(o))return o;const r=e._parentIds[t];i=r!==t,t=r}}(e,t,n):n(e,t)}h.prototype.hasProperty=function(e,t){const n=v(this,e,function(e,n){const i=e._classIds[n],o=e._classes[i].instances;if((0,c.A)(o[t]))return!0});return(0,c.A)(n)},h.prototype.propertyExists=function(e){const t=this._classes,n=t.length;for(let i=0;i<n;++i){const n=t[i].instances;if((0,c.A)(n[e]))return!0}return!1},h.prototype.getPropertyIds=function(e,t){return(t=(0,c.A)(t)?t:[]).length=0,v(this,e,function(e,n){const i=e._classIds[n],o=e._classes[i].instances;for(const e in o)o.hasOwnProperty(e)&&-1===t.indexOf(e)&&t.push(e)}),t},h.prototype.getProperty=function(e,t){return v(this,e,function(e,n){const i=e._classIds[n],o=e._classes[i],s=e._classIndexes[n],a=o.instances[t];if((0,c.A)(a))return(0,c.A)(a.typedArray)?function(e,t){const n=e.typedArray,i=e.componentCount;return 1===i?n[t]:e.type.unpack(n,t*i)}(a,s):(0,r.A)(a[s],!0)})},h.prototype.setProperty=function(e,t,n){const i=v(this,e,function(i,o){const s=i._classIds[o],a=i._classes[s],u=i._classIndexes[o],d=a.instances[t];if((0,c.A)(d)){if(o!==e)throw new l.A(`Inherited property "${t}" is read-only.`);return(0,c.A)(d.typedArray)?function(e,t,n){const i=e.typedArray,o=e.componentCount;1===o?i[t]=n:e.type.pack(n,i,t*o)}(d,u,n):d[u]=(0,r.A)(n,!0),!0}});return(0,c.A)(i)},h.prototype.isClass=function(e,t){const n=v(this,e,function(e,n){const i=e._classIds[n];if(e._classes[i].name===t)return!0});return(0,c.A)(n)},h.prototype.getClassName=function(e){const t=this._classIds[e];return this._classes[t].name};const T=h},653565:(e,t,n)=>{"use strict";n.d(t,{A:()=>w});var i=n(434067),o=n(626809),r=n(369031),s=n(41476),a=n(673874),c=n(491446),l=n(677354),u=n(605971),d=n(276904),h=n(430332),A=n(57775),p=n(654799),f=n(616e3);function m(e){r.A.typeOf.number("options.featuresLength",e.featuresLength),r.A.typeOf.object("options.owner",e.owner),this._id=(0,a.A)();const t=e.featuresLength;let n,s;if(this._showAlphaProperties=void 0,this._batchValues=void 0,this._batchValuesDirty=!1,this._batchTexture=void 0,this._defaultTexture=void 0,this._pickTexture=void 0,this._pickIds=[],t>0){const e=Math.min(t,h.A.maximumTextureSize),r=Math.ceil(t/h.A.maximumTextureSize),a=1/e,c=.5*a,l=1/r,u=.5*l;n=new i.A(e,r),s=new o.A(a,c,l,u)}this._translucentFeaturesLength=0,this._featuresLength=t,this._textureDimensions=n,this._textureStep=s,this._owner=e.owner,this._statistics=e.statistics,this._colorChangedCallback=e.colorChangedCallback}function g(e){const t=e._textureDimensions;return t.x*t.y*4}function _(e){if(!(0,c.A)(e._batchValues)){const t=g(e),n=new Uint8Array(t).fill(255);e._batchValues=n}return e._batchValues}function y(e){if(!(0,c.A)(e._showAlphaProperties)){const t=2*e._featuresLength,n=new Uint8Array(t).fill(255);e._showAlphaProperties=n}return e._showAlphaProperties}function v(e,t){if(!(0,c.A)(e)||e<0||e>=t)throw new u.A(`batchId is required and between zero and featuresLength - 1 (${t}`-NaN)}Object.defineProperties(m.prototype,{translucentFeaturesLength:{get:function(){return this._translucentFeaturesLength}},byteLength:{get:function(){let e=0;return(0,c.A)(this._pickTexture)&&(e+=this._pickTexture.sizeInBytes),(0,c.A)(this._batchTexture)&&(e+=this._batchTexture.sizeInBytes),e}},textureDimensions:{get:function(){return this._textureDimensions}},textureStep:{get:function(){return this._textureStep}},batchTexture:{get:function(){return this._batchTexture}},defaultTexture:{get:function(){return this._defaultTexture}},pickTexture:{get:function(){return this._pickTexture}}}),m.DEFAULT_COLOR_VALUE=s.A.WHITE,m.DEFAULT_SHOW_VALUE=!0,m.prototype.setShow=function(e,t){if(v(e,this._featuresLength),r.A.typeOf.bool("show",t),t&&!(0,c.A)(this._showAlphaProperties))return;const n=y(this),i=2*e,o=t?255:0;n[i]!==o&&(n[i]=o,_(this)[4*e+3]=t?n[i+1]:0,this._batchValuesDirty=!0)},m.prototype.setAllShow=function(e){r.A.typeOf.bool("show",e);const t=this._featuresLength;for(let n=0;n<t;++n)this.setShow(n,e)},m.prototype.getShow=function(e){if(v(e,this._featuresLength),!(0,c.A)(this._showAlphaProperties))return!0;const t=2*e;return 255===this._showAlphaProperties[t]};const T=new Array(4);function b(e,t,n){const i=e._textureDimensions;return new f.A({context:t,pixelFormat:d.A.RGBA,pixelDatatype:A.A.UNSIGNED_BYTE,source:{width:i.x,height:i.y,arrayBufferView:n},flipY:!1,sampler:p.A.NEAREST})}m.prototype.setColor=function(e,t){if(v(e,this._featuresLength),r.A.typeOf.object("color",t),s.A.equals(t,m.DEFAULT_COLOR_VALUE)&&!(0,c.A)(this._batchValues))return;const n=t.toBytes(T),i=n[3],o=_(this),a=4*e,l=y(this),u=2*e;if(o[a]!==n[0]||o[a+1]!==n[1]||o[a+2]!==n[2]||l[u+1]!==i){o[a]=n[0],o[a+1]=n[1],o[a+2]=n[2];const r=255!==l[u+1],s=0!==l[u];o[a+3]=s?i:0,l[u+1]=i;const d=255!==i;d&&!r?++this._translucentFeaturesLength:!d&&r&&--this._translucentFeaturesLength,this._batchValuesDirty=!0,(0,c.A)(this._colorChangedCallback)&&this._colorChangedCallback(e,t)}},m.prototype.setAllColor=function(e){r.A.typeOf.object("color",e);const t=this._featuresLength;for(let n=0;n<t;++n)this.setColor(n,e)},m.prototype.getColor=function(e,t){if(v(e,this._featuresLength),r.A.typeOf.object("result",t),!(0,c.A)(this._batchValues))return s.A.clone(m.DEFAULT_COLOR_VALUE,t);const n=this._batchValues,i=4*e,o=this._showAlphaProperties,a=2*e;return s.A.fromBytes(n[i],n[i+1],n[i+2],o[a+1],t)},m.prototype.getPickColor=function(e){return v(e,this._featuresLength),this._pickIds[e]},m.prototype.update=function(e,t){const n=t.context;this._defaultTexture=n.defaultTexture;const i=t.passes;(i.pick||i.postProcess)&&function(e,t){const n=e._featuresLength;if(!(0,c.A)(e._pickTexture)&&n>0){const i=e._pickIds,o=g(e),r=new Uint8Array(o),a=e._owner,l=e._statistics;for(let e=0;e<n;++e){const n=t.createPickId(a.getFeature(e));i.push(n);const o=n.color,c=4*e;r[c]=s.A.floatToByte(o.red),r[c+1]=s.A.floatToByte(o.green),r[c+2]=s.A.floatToByte(o.blue),r[c+3]=s.A.floatToByte(o.alpha)}e._pickTexture=b(e,t,r),(0,c.A)(l)&&(l.batchTableByteLength+=e._pickTexture.sizeInBytes)}}(this,n),this._batchValuesDirty&&(this._batchValuesDirty=!1,(0,c.A)(this._batchTexture)||(this._batchTexture=b(this,n,this._batchValues),(0,c.A)(this._statistics)&&(this._statistics.batchTableByteLength+=this._batchTexture.sizeInBytes)),function(e){const t=e._textureDimensions;e._batchTexture.copyFrom({source:{width:t.x,height:t.y,arrayBufferView:e._batchValues}})}(this))},m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),this._pickTexture=this._pickTexture&&this._pickTexture.destroy();const e=this._pickIds,t=e.length;for(let n=0;n<t;++n)e[n].destroy();return(0,l.A)(this)};const w=m},886626:(e,t,n)=>{"use strict";n.d(t,{A:()=>b});var i=n(303578),o=n(369031),r=n(607502),s=n(915325),a=n(491446),c=n(955943),l=n(367817),u=n(697422),d=n(744603),h=n(123245),A=n(705302),p=n(41076),f=n(74006),m=n(253478),g=n(553909);function _(e){this.tileWidth=void 0,this.tileHeight=void 0,this.maximumLevel=void 0,this.imageUrlSubdomains=void 0,this.imageUrlTemplate=void 0,this.attributionList=void 0}function y(e){e=e??s.A.EMPTY_OBJECT,this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=1,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._mapStyle=e.mapStyle??f.A.AERIAL,this._mapLayer=e.mapLayer,this._culture=e.culture??"",this._key=e.key,this._tileDiscardPolicy=e.tileDiscardPolicy,(0,a.A)(this._tileDiscardPolicy)||(this._tileDiscardPolicy=new m.A),this._proxy=e.proxy,this._credit=new r.A(`<a href="https://www.microsoft.com/en-us/maps/bing-maps/product"><img src="${y.logoUrl}" title="Bing Imagery"/></a>`),this._tilingScheme=new p.A({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:e.ellipsoid}),this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._imageUrlTemplate=void 0,this._imageUrlSubdomains=void 0,this._attributionList=void 0,this._errorEvent=new c.A}_.prototype.build=function(e){e._tileWidth=this.tileWidth,e._tileHeight=this.tileHeight,e._maximumLevel=this.maximumLevel,e._imageUrlSubdomains=this.imageUrlSubdomains,e._imageUrlTemplate=this.imageUrlTemplate;let t=e._attributionList=this.attributionList;t||(t=[]),e._attributionList=t;for(let e=0,n=t.length;e<n;++e){const n=t[e];if(n.credit instanceof r.A)break;n.credit=new r.A(n.attribution);const i=n.coverageAreas;for(let e=0,t=n.coverageAreas.length;e<t;++e){const t=i[e],n=t.bbox;t.bbox=new u.A(l.A.toRadians(n[1]),l.A.toRadians(n[0]),l.A.toRadians(n[3]),l.A.toRadians(n[2]))}}},Object.defineProperties(y.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},key:{get:function(){return this._key}},mapStyle:{get:function(){return this._mapStyle}},mapLayer:{get:function(){return this._mapLayer}},culture:{get:function(){return this._culture}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return(0,a.A)(this.mapLayer)}}}),y.fromUrl=async function(e,t){t=t??s.A.EMPTY_OBJECT,o.A.defined("url",e),o.A.defined("options.key",t.key);let n=t.tileProtocol;(0,a.A)(n)?n.length>0&&":"===n[n.length-1]&&(n=n.substr(0,n.length-1)):n="http:"===document.location.protocol?"http":"https";const i=t.mapStyle??f.A.AERIAL,r=d.A.createIfNeeded(e);r.appendForwardSlash();const c={incl:"ImageryProviders",key:t.key,uriScheme:n};(0,a.A)(t.mapLayer)&&(c.mapLayer=t.mapLayer),(0,a.A)(t.culture)&&(c.culture=t.culture);const l=r.getDerivedResource({url:`REST/v1/Imagery/Metadata/${i}`,queryParameters:c}),u=new y(t);u._resource=r;const p=new _(t);return await async function(e,t,n){const i=e.url;let o=y._metadataCache[i];(0,a.A)(o)||(o=e.fetchJson(),y._metadataCache[i]=o);try{return function(e,t){if(1!==e.resourceSets.length)throw new h.A("metadata does not specify one resource in resourceSets");const n=e.resourceSets[0].resources[0];t.tileWidth=n.imageWidth,t.tileHeight=n.imageHeight,t.maximumLevel=n.zoomMax-1,t.imageUrlSubdomains=n.imageUrlSubdomains,t.imageUrlTemplate=n.imageUrl;let i=n.imageryProviders;(0,a.A)(n.imageryProviders)&&(i=n.imageryProviders.filter(e=>e.coverageAreas?.some(e=>(0,a.A)(e.bbox)))),t.attributionList=i}(await o,t)}catch(t){!function(e,t,n){let i=`An error occurred while accessing ${e.url}`;throw(0,a.A)(t)&&(0,a.A)(t.message)&&(i+=`: ${t.message}`),A.A.reportError(void 0,n,(0,a.A)(n)?n._errorEvent:void 0,i,void 0,void 0,void 0,t),new h.A(i)}(e,t,n)}}(l,p),p.build(u),u};const v=new u.A;y.prototype.getTileCredits=function(e,t,n){const i=this._tilingScheme.tileXYToRectangle(e,t,n,v),o=function(e,t,n){++t;const i=[];for(let o=0,r=e.length;o<r;++o){const r=e[o],s=r.coverageAreas;let c=!1;for(let e=0,i=r.coverageAreas.length;!c&&e<i;++e){const i=s[e];if(t>=i.zoomMin&&t<=i.zoomMax){const e=u.A.intersection(n,i.bbox,T);(0,a.A)(e)&&(c=!0)}}c&&i.push(r.credit)}return i}(this._attributionList,n,i);return o},y.prototype.requestImage=function(e,t,n,i){const o=g.A.loadImage(this,function(e,t,n,i,o){const r=e._imageUrlTemplate,s=e._imageUrlSubdomains,a=(t+n+i)%s.length;return e._resource.getDerivedResource({url:r,request:o,templateValues:{quadkey:y.tileXYToQuadKey(t,n,i),subdomain:s[a],culture:e._culture},queryParameters:{n:"z"}})}(this,e,t,n,i));if((0,a.A)(o))return o.catch(function(e){return(0,a.A)(e.blob)&&0===e.blob.size?m.A.EMPTY_IMAGE:Promise.reject(e)})},y.prototype.pickFeatures=function(e,t,n,i,o){},y.tileXYToQuadKey=function(e,t,n){let i="";for(let o=n;o>=0;--o){const n=1<<o;let r=0;0!==(e&n)&&(r|=1),0!==(t&n)&&(r|=2),i+=r}return i},y.quadKeyToTileXY=function(e){let t=0,n=0;const i=e.length-1;for(let o=i;o>=0;--o){const r=1<<o,s=+e[i-o];1&s&&(t|=r),2&s&&(n|=r)}return{x:t,y:n,level:i}},y._logoUrl=void 0,Object.defineProperties(y,{logoUrl:{get:function(){return(0,a.A)(y._logoUrl)||(y._logoUrl=(0,i.A)("Assets/Images/bing_maps_credit.png")),y._logoUrl},set:function(e){o.A.defined("value",e),y._logoUrl=e}}});const T=new u.A;y._metadataCache={};const b=y},74006:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({AERIAL:"Aerial",AERIAL_WITH_LABELS:"AerialWithLabels",AERIAL_WITH_LABELS_ON_DEMAND:"AerialWithLabelsOnDemand",ROAD:"Road",ROAD_ON_DEMAND:"RoadOnDemand",CANVAS_DARK:"CanvasDark",CANVAS_LIGHT:"CanvasLight",CANVAS_GRAY:"CanvasGray",ORDNANCE_SURVEY:"OrdnanceSurvey",COLLINS_BART:"CollinsBart"})},655979:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(369031),o=n(491446),r=n(605971);const s={parseAllBoundingVolumeSemantics:function(e){return i.A.typeOf.object("tileMetadata",e),{tile:{boundingVolume:s.parseBoundingVolumeSemantic("TILE",e),minimumHeight:s._parseMinimumHeight("TILE",e),maximumHeight:s._parseMaximumHeight("TILE",e)},content:{boundingVolume:s.parseBoundingVolumeSemantic("CONTENT",e),minimumHeight:s._parseMinimumHeight("CONTENT",e),maximumHeight:s._parseMaximumHeight("CONTENT",e)}}},parseBoundingVolumeSemantic:function(e,t){if(i.A.typeOf.string("prefix",e),"TILE"!==e&&"CONTENT"!==e)throw new r.A("prefix must be either 'TILE' or 'CONTENT'");i.A.typeOf.object("tileMetadata",t);const n=`${e}_BOUNDING_BOX`,s=t.getPropertyBySemantic(n);if((0,o.A)(s))return{box:s};const a=`${e}_BOUNDING_REGION`,c=t.getPropertyBySemantic(a);if((0,o.A)(c))return{region:c};const l=`${e}_BOUNDING_SPHERE`,u=t.getPropertyBySemantic(l);return(0,o.A)(u)?{sphere:u}:void 0},_parseMinimumHeight:function(e,t){if(i.A.typeOf.string("prefix",e),"TILE"!==e&&"CONTENT"!==e)throw new r.A("prefix must be either 'TILE' or 'CONTENT'");i.A.typeOf.object("tileMetadata",t);const n=`${e}_MINIMUM_HEIGHT`;return t.getPropertyBySemantic(n)},_parseMaximumHeight:function(e,t){if(i.A.typeOf.string("prefix",e),"TILE"!==e&&"CONTENT"!==e)throw new r.A("prefix must be either 'TILE' or 'CONTENT'");i.A.typeOf.object("tileMetadata",t);const n=`${e}_MAXIMUM_HEIGHT`;return t.getPropertyBySemantic(n)}},a=s},452663:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(915325),o=n(491446),r=n(605971),s=n(569445),a=n(48660);function c(e){const t=(e=e??i.A.EMPTY_OBJECT).typedArray,n=e.resource,s=e.cacheKey;if((0,o.A)(t)===(0,o.A)(n))throw new r.A("One of options.typedArray and options.resource must be defined.");this._typedArray=t,this._resource=n,this._cacheKey=s,this._state=a.A.UNLOADED,this._promise=void 0}(0,o.A)(Object.create)&&(c.prototype=Object.create(s.A.prototype),c.prototype.constructor=c),Object.defineProperties(c.prototype,{cacheKey:{get:function(){return this._cacheKey}},typedArray:{get:function(){return this._typedArray}}}),c.prototype.load=async function(){return(0,o.A)(this._promise)?this._promise:(0,o.A)(this._typedArray)?(this._promise=Promise.resolve(this),this._promise):(this._promise=async function(e){const t=e._resource;e._state=a.A.LOADING;try{const n=await c._fetchArrayBuffer(t);if(e.isDestroyed())return;return e._typedArray=new Uint8Array(n),e._state=a.A.READY,e}catch(n){if(e.isDestroyed())return;e._state=a.A.FAILED;const i=`Failed to load external buffer: ${t.url}`;throw e.getError(i,n)}}(this),this._promise)},c._fetchArrayBuffer=function(e){return e.fetchArrayBuffer()},c.prototype.unload=function(){this._typedArray=void 0};const l=c},308695:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(369031),o=n(915325);function r(e){e=e??o.A.EMPTY_OBJECT,i.A.typeOf.object("options.metadata",e.metadata),this._metadata=e.metadata}Object.defineProperties(r.prototype,{metadata:{get:function(){return this._metadata}}});const s=r},474751:(e,t,n)=>{"use strict";n.d(t,{A:()=>pe});var i=n(660662),o=n(267980),r=n(41476),s=n(433235),a=n(400793),c=n(491446),l=n(786101),u=n(677354),d=n(610750),h=n(647326),A=n(591978),p=n(367817),f=n(331185),m=n(584164),g=n(832698),_=n(811203),y=n(697422),v=n(209202),T=n(866569),b=n(83181),w=n(307898),x=n(744603),C=n(123245),E=n(308695),S=n(891846),I=n(621065),P=n(223702),D=n(45679),O=n(581010),R=n(661314),M=n(84269),L=n(635649),N=n(217543),B=n(961624),F=n(800859),U=n(409816),k=n(655979),V=n(192518),z=n(62467),H=n(413690),G=n(224159),W=n(315747),Y=n(11745),q=n(760866),j=n(717339);function Q(e,t,n,i){this._tileset=e,this._header=n;const o=(0,c.A)(n.contents),s=o&&n.contents.length>1||(0,F.A)(n,"3DTILES_multiple_contents"),a=o&&!s?n.contents[0]:n.content;this._contentHeader=a,this.transform=(0,c.A)(n.transform)?m.A.unpack(n.transform):m.A.clone(m.A.IDENTITY);const l=(0,c.A)(i)?i.computedTransform:e.modelMatrix,u=m.A.multiply(l,this.transform,new m.A),d=(0,c.A)(i)?i._initialTransform:m.A.IDENTITY;let h,p,f,g;this._initialTransform=m.A.multiply(d,this.transform,new m.A),this.computedTransform=u,this.metadata=(0,B.A)(e,n),this._verticalExaggeration=1,this._verticalExaggerationRelativeHeight=0,this._boundingVolume=this.createBoundingVolume(n.boundingVolume,u),this._boundingVolume2D=void 0,(0,c.A)(a)&&(0,c.A)(a.boundingVolume)&&(h=this.createBoundingVolume(a.boundingVolume,u)),this._contentBoundingVolume=h,this._contentBoundingVolume2D=void 0,(0,c.A)(n.viewerRequestVolume)&&(p=this.createBoundingVolume(n.viewerRequestVolume,u)),this._viewerRequestVolume=p,this.geometricError=n.geometricError,this._geometricError=n.geometricError,(0,c.A)(this._geometricError)||(this._geometricError=(0,c.A)(i)?i._geometricError:e._geometricError,Q._deprecationWarning("geometricErrorUndefined","Required property geometricError is undefined for this tile. Using parent's geometric error instead.")),this.updateGeometricErrorScale(),(0,c.A)(n.refine)?("replace"!==n.refine&&"add"!==n.refine||Q._deprecationWarning("lowercase-refine",`This tile uses a lowercase refine "${n.refine}". Instead use "${n.refine.toUpperCase()}".`),f="REPLACE"===n.refine.toUpperCase()?R.A.REPLACE:R.A.ADD):f=(0,c.A)(i)?i.refine:R.A.REPLACE,this.refine=f,this.children=[],this.parent=i;let _,y,v,b=!1;if(t=x.A.createIfNeeded(t),s)_=I.A.UNLOADED,y=t.clone();else if((0,c.A)(a)){let n=a.uri;(0,c.A)(a.url)&&(Q._deprecationWarning("contentUrl",'This tileset JSON uses the "content.url" property which has been deprecated. Use "content.uri" instead.'),n=a.url),""===n?(Q._deprecationWarning("contentUriEmpty","content.uri property is an empty string, which creates a circular dependency, making this tileset invalid. Omit the content property instead"),g=new M.A(e,this),b=!0,_=I.A.READY):(_=I.A.UNLOADED,y=t.getDerivedResource({url:n}),v=T.A.getServerKey(y.getUrlComponent()))}else g=new M.A(e,this),b=!0,_=I.A.READY;this._content=g,this._contentResource=y,this._contentState=_,this._expiredContent=void 0,this._serverKey=v,this.hasEmptyContent=b,this.hasTilesetContent=!1,this.hasImplicitContent=!1,this.hasRenderableContent=!b,this.hasImplicitContentMetadata=!1,this.hasMultipleContents=s,this.cacheNode=void 0;const w=n.expire;let C,E;(0,c.A)(w)&&(C=w.duration,(0,c.A)(w.date)&&(E=A.A.fromIso8601(w.date))),this.expireDuration=C,this.expireDate=E,this.lastStyleTime=0,this._optimChildrenWithinParent=D.A.NOT_COMPUTED,this.clippingPlanesDirty=!1,this.clippingPolygonsDirty=!1,this.priorityDeferred=!1,this.implicitTileset=void 0,this.implicitCoordinates=void 0,this.implicitSubtree=void 0,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._screenSpaceErrorProgressiveResolution=0,this._visibilityPlaneMask=0,this._visible=!1,this._inRequestVolume=!1,this._finalResolution=!0,this._depth=0,this._stackLength=0,this._selectionDepth=0,this._updatedVisibilityFrame=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._wasSelectedLastFrame=!1,this._requestedFrame=0,this._ancestorWithContent=void 0,this._ancestorWithContentAvailable=void 0,this._refines=!1,this._shouldSelect=!1,this._isClipped=!0,this._isClippedByPolygon=!1,this._clippingPlanesState=0,this._clippingPolygonsState=0,this._debugBoundingVolume=void 0,this._debugContentBoundingVolume=void 0,this._debugViewerRequestVolume=void 0,this._debugColor=r.A.fromRandom({alpha:1}),this._debugColorizeTiles=!1,this._priority=0,this._priorityHolder=this,this._priorityProgressiveResolution=!1,this._priorityProgressiveResolutionScreenSpaceErrorLeaf=!1,this._priorityReverseScreenSpaceError=0,this._foveatedFactor=0,this._wasMinPriorityChild=!1,this._loadTimestamp=new A.A,this._commandsLength=0,this._color=void 0,this._colorDirty=!1,this._request=void 0}Q._deprecationWarning=l.A,Object.defineProperties(Q.prototype,{tileset:{get:function(){return this._tileset}},content:{get:function(){return this._content}},boundingVolume:{get:function(){return this._boundingVolume}},contentBoundingVolume:{get:function(){return this._contentBoundingVolume??this._boundingVolume}},boundingSphere:{get:function(){return this._boundingVolume.boundingSphere}},isVisible:{get:function(){return this._visible&&this._inRequestVolume}},extras:{get:function(){return this._header.extras}},color:{get:function(){return(0,c.A)(this._color)||(this._color=new r.A),r.A.clone(this._color)},set:function(e){this._color=r.A.clone(e,this._color),this._colorDirty=!0}},contentAvailable:{get:function(){return this.contentReady&&this.hasRenderableContent||(0,c.A)(this._expiredContent)&&!this.contentFailed}},contentReady:{get:function(){return this._contentState===I.A.READY}},contentUnloaded:{get:function(){return this._contentState===I.A.UNLOADED}},hasUnloadedRenderableContent:{get:function(){return this.hasRenderableContent&&this.contentUnloaded}},contentExpired:{get:function(){return this._contentState===I.A.EXPIRED}},contentFailed:{get:function(){return this._contentState===I.A.FAILED}},commandsLength:{get:function(){return this._commandsLength}}});const X=new o.A,K=new A.A;function $(e){return function(){return e._priority}}Q.prototype.getScreenSpaceError=function(e,t,n){const i=this._tileset,o=n??1,r=(0,c.A)(this.parent)?this.parent.geometricError:i._scaledGeometricError,s=t?r:this.geometricError;if(0===s)return 0;const{camera:a,context:l}=e;let u=a.frustum;const d=l.drawingBufferWidth,h=l.drawingBufferHeight*o;let A;if(e.mode===z.A.SCENE2D||u instanceof _.A){const e=u.offCenterFrustum;(0,c.A)(e)&&(u=e),A=s/(Math.max(u.top-u.bottom,u.right-u.left)/Math.max(d,h))}else{const e=Math.max(this._distanceToCamera,p.A.EPSILON7);if(A=s*h/(e*u.sseDenominator),i.dynamicScreenSpaceError){const t=i._dynamicScreenSpaceErrorComputedDensity,n=i.dynamicScreenSpaceErrorFactor;A-=p.A.fog(e,t)*n}}return A/=e.pixelRatio,A},Q.prototype.updateVisibility=function(e){const{parent:t,tileset:n}=this;if(this._updatedVisibilityFrame===n._updatedVisibilityFrame)return;const i=(0,c.A)(t)?t.computedTransform:n.modelMatrix,r=(0,c.A)(t)?t._visibilityPlaneMask:a.A.MASK_INDETERMINATE;this.updateTransform(i,e),this._distanceToCamera=this.distanceToTile(e),this._centerZDepth=this.distanceToTileCenter(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._screenSpaceErrorProgressiveResolution=this.getScreenSpaceError(e,!1,n.progressiveResolutionHeightFraction),this._visibilityPlaneMask=this.visibility(e,r),this._visible=this._visibilityPlaneMask!==a.A.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._priorityReverseScreenSpaceError=function(e,t){const n=t.parent,i=(0,c.A)(n)&&(!e.isSkippingLevelOfDetail||0===t._screenSpaceError||n.hasTilesetContent||n.hasImplicitContent)?n._screenSpaceError:t._screenSpaceError;return e.root._screenSpaceError-i}(n,this),this._priorityProgressiveResolution=function(e,t){if(e.progressiveResolutionHeightFraction<=0||e.progressiveResolutionHeightFraction>.5)return!1;const n=e.memoryAdjustedScreenSpaceError;let i=t._screenSpaceErrorProgressiveResolution>n;t._priorityProgressiveResolutionScreenSpaceErrorLeaf=!1;const o=t.parent,r=t._screenSpaceErrorProgressiveResolution<=n,s=(0,c.A)(o)&&o._screenSpaceErrorProgressiveResolution>n;return r&&s&&(t._priorityProgressiveResolutionScreenSpaceErrorLeaf=!0,i=!0),i}(n,this),this.priorityDeferred=function(e,t){const{tileset:n,boundingSphere:i}=e,{radius:r,center:s}=i,{camera:a}=t,l=o.A.multiplyByScalar(a.directionWC,e._centerZDepth,X),u=o.A.add(a.positionWC,l,X),d=o.A.subtract(u,s,X);if(o.A.magnitude(d)>r){const t=o.A.normalize(d,X),n=o.A.multiplyByScalar(t,r,X),i=o.A.add(s,n,X),c=o.A.subtract(i,a.positionWC,X),l=o.A.normalize(c,X);e._foveatedFactor=1-Math.abs(o.A.dot(a.directionWC,l))}else e._foveatedFactor=0;const h=e.refine===R.A.REPLACE,A=n.isSkippingLevelOfDetail;if(h&&!A||!n.foveatedScreenSpaceError||1===n.foveatedConeSize||e._priorityProgressiveResolution&&h&&A||n._pass===O.A.PRELOAD_FLIGHT||n._pass===O.A.PRELOAD)return!1;const f=1-Math.cos(.5*a.frustum.fov),m=n.foveatedConeSize*f;if(e._foveatedFactor<=m)return!1;const g=f-m,_=p.A.clamp((e._foveatedFactor-m)/g,0,1),y=n.foveatedInterpolationCallback(n.foveatedMinimumScreenSpaceErrorRelaxation,n.memoryAdjustedScreenSpaceError,_),v=0===e._screenSpaceError&&(0,c.A)(e.parent)?.5*e.parent._screenSpaceError:e._screenSpaceError;return n.memoryAdjustedScreenSpaceError-y<=v}(this,e),this._updatedVisibilityFrame=n._updatedVisibilityFrame},Q.prototype.updateExpiration=function(){if((0,c.A)(this.expireDate)&&this.contentReady&&!this.hasEmptyContent&&!this.hasMultipleContents){const e=A.A.now(K);A.A.lessThan(this.expireDate,e)&&(this._contentState=I.A.EXPIRED,this._expiredContent=this._content)}},Q.prototype.requestContent=function(){if(!this.hasEmptyContent)return this.hasMultipleContents?function(e){let t=e._content;const n=e._tileset;if(!(0,c.A)(t)){const i=(0,F.A)(e._header,"3DTILES_multiple_contents")?e._header.extensions["3DTILES_multiple_contents"]:e._header;t=new U.A(n,e,e._contentResource.clone(),i),e._content=t}const i=t.requestInnerContents();if((0,c.A)(i))return e._contentState=I.A.LOADING,i.then(n=>{if(!e.isDestroyed()&&(0,c.A)(n))return e._contentState=I.A.PROCESSING,t}).catch(t=>{if(!e.isDestroyed())throw e._contentState=I.A.FAILED,t})}(this):function(e){const t=e._contentResource.clone(),n=e.contentExpired;n&&t.setQueryParameters({expired:e.expireDate.toString()});const i=new v.A({throttle:!0,throttleByServer:!0,type:w.A.TILES3D,priorityFunction:$(e),serverKey:e._serverKey});e._request=i,t.request=i;const o=e._tileset,r=t.fetchArrayBuffer();if((0,c.A)(r))return async function(e,t,n,i,o){const r=e._contentState;let s;e._contentState=I.A.LOADING,++t.statistics.numberOfPendingRequests;try{s=await o}catch(i){if(--t.statistics.numberOfPendingRequests,e.isDestroyed())return;if(n.cancelled||n.state===b.A.CANCELLED)return e._contentState=r,void++t.statistics.numberOfAttemptedRequests;throw e._contentState=I.A.FAILED,i}if(e.isDestroyed())--t.statistics.numberOfPendingRequests;else{if(n.cancelled||n.state===b.A.CANCELLED)return e._contentState=r,--t.statistics.numberOfPendingRequests,void++t.statistics.numberOfAttemptedRequests;try{const n=await async function(e,t){const n=(0,V.A)(t),i=e._tileset;let o;i._disableSkipLevelOfDetail=i._disableSkipLevelOfDetail||n.contentType===P.A.GEOMETRY||n.contentType===P.A.VECTOR,(n.contentType===P.A.IMPLICIT_SUBTREE||n.contentType===P.A.IMPLICIT_SUBTREE_JSON)&&(e.hasImplicitContent=!0,e.hasRenderableContent=!1),n.contentType===P.A.EXTERNAL_TILESET&&(e.hasTilesetContent=!0,e.hasRenderableContent=!1);const r=S.A[n.contentType];if(e.isDestroyed())return;o=(0,c.A)(n.binaryPayload)?await Promise.resolve(r(i,e,e._contentResource,n.binaryPayload.buffer,0)):await Promise.resolve(r(i,e,e._contentResource,n.jsonPayload));const s=e._contentHeader;if(e.hasImplicitContentMetadata){const t=e.implicitSubtree,n=e.implicitCoordinates;o.metadata=t.getContentMetadataView(n,0)}else e.hasImplicitContent||(o.metadata=(0,L.A)(i,s));const a=(0,N.A)(i,s);return(0,c.A)(a)&&(o.group=new E.A({metadata:a})),o}(e,s);if(--t.statistics.numberOfPendingRequests,e.isDestroyed())return;return i&&(e.expireDate=void 0),e._content=n,e._contentState=I.A.PROCESSING,n}catch(n){if(--t.statistics.numberOfPendingRequests,e.isDestroyed())return;throw e._contentState=I.A.FAILED,n}}}(e,o,i,n,r);++o.statistics.numberOfAttemptedRequests}(this)},Q.prototype.cancelRequests=function(){this.hasMultipleContents?this._content.cancelRequests():this._request.cancel()},Q.prototype.unloadContent=function(){this.hasRenderableContent&&(this._content=this._content&&this._content.destroy(),this._contentState=I.A.UNLOADED,this.lastStyleTime=0,this.clippingPlanesDirty=0===this._clippingPlanesState,this._clippingPlanesState=0,this.clippingPolygonsDirty=0===this._clippingPolygonsState,this._clippingPolygonsState=0,this._debugColorizeTiles=!1,this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy())};const J=new i.A;function Z(e,t){if(t.mode!==z.A.SCENE3D&&!(0,c.A)(e._boundingVolume2D)){const n=e._boundingVolume.boundingSphere,o=i.A.projectTo2D(n,t.mapProjection,J);e._boundingVolume2D=new W.A(o.center,o.radius)}return t.mode!==z.A.SCENE3D?e._boundingVolume2D:e._boundingVolume}Q.prototype.visibility=function(e,t){const n=e.cullingVolume,i=Z(this,e),o=this._tileset,r=o.clippingPlanes;if((0,c.A)(r)&&r.enabled){const e=r.computeIntersectionWithBoundingVolume(i,o.clippingPlanesOriginMatrix);if(this._isClipped=e!==h.A.INSIDE,e===h.A.OUTSIDE)return a.A.MASK_OUTSIDE}const s=o.clippingPolygons;if((0,c.A)(s)&&s.enabled){const e=s.computeIntersectionWithBoundingVolume(i);this._isClippedByPolygon=e!==h.A.OUTSIDE}return n.computeVisibilityWithPlaneMask(i,t)},Q.prototype.contentVisibility=function(e){if(!(0,c.A)(this._contentBoundingVolume))return h.A.INSIDE;if(this._visibilityPlaneMask===a.A.MASK_INSIDE)return h.A.INSIDE;const t=e.cullingVolume,n=function(e,t){if(t.mode!==z.A.SCENE3D&&!(0,c.A)(e._contentBoundingVolume2D)){const n=e._contentBoundingVolume.boundingSphere,o=i.A.projectTo2D(n,t.mapProjection,J);e._contentBoundingVolume2D=new W.A(o.center,o.radius)}return t.mode!==z.A.SCENE3D?e._contentBoundingVolume2D:e._contentBoundingVolume}(this,e),o=this._tileset,r=o.clippingPlanes;if((0,c.A)(r)&&r.enabled){const e=r.computeIntersectionWithBoundingVolume(n,o.clippingPlanesOriginMatrix);if(this._isClipped=e!==h.A.INSIDE,e===h.A.OUTSIDE)return h.A.OUTSIDE}const s=o.clippingPolygons;if((0,c.A)(s)&&s.enabled){const e=s.computeIntersectionWithBoundingVolume(n);if(this._isClippedByPolygon=e!==h.A.OUTSIDE,e===h.A.INSIDE)return h.A.OUTSIDE}return t.computeVisibility(n)},Q.prototype.distanceToTile=function(e){return Z(this,e).distanceToCamera(e)};const ee=new o.A;Q.prototype.distanceToTileCenter=function(e){const t=Z(this,e).boundingVolume,n=o.A.subtract(t.center,e.camera.positionWC,ee);return o.A.dot(e.camera.directionWC,n)},Q.prototype.insideViewerRequestVolume=function(e){const t=this._viewerRequestVolume;return!(0,c.A)(t)||0===t.distanceToCamera(e)};const te=new f.A,ne=new o.A,ie=new f.A,oe=new o.A,re=new y.A,se=new g.A,ae=new m.A;function ce(e,t,n,i){const o=y.A.unpack(e,0,re),r=e[4],s=e[5],a=g.A.fromRectangle(o,r,s,d.A.WGS84,se);let l=a.center,u=a.halfAxes;t=m.A.multiplyTransformation(t,m.A.inverseTransformation(n,ae),ae),l=m.A.multiplyByPoint(t,l,l);const h=m.A.getMatrix3(t,te);return u=f.A.multiply(h,u,u),(0,c.A)(i)&&i instanceof Y.A?(i.update(l,u),i):new Y.A(l,u)}Q.prototype.createBoundingVolume=function(e,t,n){const i=this.metadata;let r;if((0,c.A)(i)&&(r=k.A.parseBoundingVolumeSemantic("TILE",i)),(0,c.A)(r)&&(e=r),!(0,c.A)(e))throw new C.A("boundingVolume must be defined");if((0,F.A)(e,"3DTILES_bounding_volume_S2"))return new G.A(e.extensions["3DTILES_bounding_volume_S2"]);const{box:s,region:a,sphere:l}=e;if((0,c.A)(s)){const e=function(e,t,n){let i=o.A.fromElements(e[0],e[1],e[2],oe),r=f.A.fromArray(e,3,ie);i=m.A.multiplyByPoint(t,i,i);const s=m.A.getMatrix3(t,te);return r=f.A.multiply(s,r,r),(0,c.A)(n)?(n.update(i,r),n):new Y.A(i,r)}(s,t,n);return 1!==this._verticalExaggeration&&ue(e,this._verticalExaggeration,this._verticalExaggerationRelativeHeight),e}if((0,c.A)(a)){const e=function(e,t,n,i){if(!m.A.equalsEpsilon(t,n,p.A.EPSILON8))return i instanceof Y.A?ce(e,t,n,i):ce(e,t,n,void 0);const o=y.A.unpack(e,0,re);return i instanceof H.A?(i.rectangle=y.A.clone(o,i.rectangle),i.minimumHeight=e[4],i.maximumHeight=e[5],i.computeBoundingVolumes(d.A.WGS84),i):new H.A({rectangle:o,minimumHeight:e[4],maximumHeight:e[5]})}(a,t,this._initialTransform,n);return 1===this._verticalExaggeration||(e instanceof Y.A?ue(e,this._verticalExaggeration,this._verticalExaggerationRelativeHeight):(e.minimumHeight=j.A.getHeight(e.minimumHeight,this._verticalExaggeration,this._verticalExaggerationRelativeHeight),e.maximumHeight=j.A.getHeight(e.maximumHeight,this._verticalExaggeration,this._verticalExaggerationRelativeHeight),e.computeBoundingVolumes(d.A.WGS84))),e}if((0,c.A)(l)){const e=function(e,t,n){let i=o.A.fromElements(e[0],e[1],e[2],oe),r=e[3];i=m.A.multiplyByPoint(t,i,i);const s=m.A.getScale(t,ne);return r*=o.A.maximumComponent(s),(0,c.A)(n)?(n.update(i,r),n):new W.A(i,r)}(l,t,n);if(1!==this._verticalExaggeration){const t=j.A.getPosition(e.center,d.A.WGS84,this._verticalExaggeration,this._verticalExaggerationRelativeHeight,oe),n=e.radius*this._verticalExaggeration;e.update(t,n)}return e}throw new C.A("boundingVolume must contain a sphere, region, or box")};const le=o.A.unpackArray(new Array(24).fill(0));function ue(e,t,n){const i=e.boundingVolume.computeCorners(le).map(e=>j.A.getPosition(e,d.A.WGS84,t,n,e)),o=g.A.fromPoints(i,se);e.update(o.center,o.halfAxes)}Q.prototype.updateTransform=function(e,t){e=e??m.A.IDENTITY;const n=m.A.multiplyTransformation(e,this.transform,ae),i=!m.A.equals(n,this.computedTransform),o=(0,c.A)(t)&&(this._verticalExaggeration!==t.verticalExaggeration||this._verticalExaggerationRelativeHeight!==t.verticalExaggerationRelativeHeight);if(!i&&!o)return;i&&m.A.clone(n,this.computedTransform),o&&(this._verticalExaggeration=t.verticalExaggeration,this._verticalExaggerationRelativeHeight=t.verticalExaggerationRelativeHeight);const r=this._header,s=this._contentHeader;this._boundingVolume=this.createBoundingVolume(r.boundingVolume,this.computedTransform,this._boundingVolume),(0,c.A)(this._contentBoundingVolume)&&(this._contentBoundingVolume=this.createBoundingVolume(s.boundingVolume,this.computedTransform,this._contentBoundingVolume)),(0,c.A)(this._viewerRequestVolume)&&(this._viewerRequestVolume=this.createBoundingVolume(r.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)),this.updateGeometricErrorScale(),this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy()},Q.prototype.updateGeometricErrorScale=function(){const e=m.A.getScale(this.computedTransform,ne),t=o.A.maximumComponent(e);if(this.geometricError=this._geometricError*t,!(0,c.A)(this.parent)){const e=this._tileset;e._scaledGeometricError=e._geometricError*t}},Q.prototype.update=function(e,t,n){const{commandList:i}=t,o=i.length;!function(e,t){const n=t.clippingPlanes;let i=0;(0,c.A)(n)&&e._isClipped&&n.enabled&&(i=n.clippingPlanesState),i!==e._clippingPlanesState&&(e._clippingPlanesState=i,e.clippingPlanesDirty=!0)}(this,e),function(e,t){const n=t.clippingPolygons;let i=0;(0,c.A)(n)&&e._isClippedByPolygon&&n.enabled&&(i=n.clippingPolygonsState),i!==e._clippingPolygonsState&&(e._clippingPolygonsState=i,e.clippingPolygonsDirty=!0)}(this,e),function(e,t,n,i){if(!i.isRender)return;const o=(0,c.A)(e._contentHeader)&&(0,c.A)(e._contentHeader.boundingVolume),a=t.debugShowBoundingVolume||t.debugShowContentBoundingVolume&&!o;if(a){let t;t=e._finalResolution?e.hasRenderableContent?r.A.WHITE:r.A.DARKGRAY:r.A.YELLOW,(0,c.A)(e._debugBoundingVolume)||(e._debugBoundingVolume=e._boundingVolume.createDebugVolume(t)),e._debugBoundingVolume.update(n);const i=e._debugBoundingVolume.getGeometryInstanceAttributes("outline");i.color=s.A.toValue(t,i.color)}else!a&&(0,c.A)(e._debugBoundingVolume)&&(e._debugBoundingVolume=e._debugBoundingVolume.destroy());t.debugShowContentBoundingVolume&&o?((0,c.A)(e._debugContentBoundingVolume)||(e._debugContentBoundingVolume=e._contentBoundingVolume.createDebugVolume(r.A.BLUE)),e._debugContentBoundingVolume.update(n)):!t.debugShowContentBoundingVolume&&(0,c.A)(e._debugContentBoundingVolume)&&(e._debugContentBoundingVolume=e._debugContentBoundingVolume.destroy()),t.debugShowViewerRequestVolume&&(0,c.A)(e._viewerRequestVolume)?((0,c.A)(e._debugViewerRequestVolume)||(e._debugViewerRequestVolume=e._viewerRequestVolume.createDebugVolume(r.A.YELLOW)),e._debugViewerRequestVolume.update(n)):!t.debugShowViewerRequestVolume&&(0,c.A)(e._debugViewerRequestVolume)&&(e._debugViewerRequestVolume=e._debugViewerRequestVolume.destroy());const l=t.debugColorizeTiles&&!e._debugColorizeTiles||(0,c.A)(t._heatmap.tilePropertyName),u=!t.debugColorizeTiles&&e._debugColorizeTiles;l?(t._heatmap.colorize(e,n),e._debugColorizeTiles=!0,e.color=e._debugColor):u&&(e._debugColorizeTiles=!1,e.color=r.A.WHITE),e._colorDirty&&(e._colorDirty=!1,e._content.applyDebugSettings(!0,e._color)),u&&t.makeStyleDirty()}(this,e,t,n),function(e,t,n){const i=e._expiredContent;if(!e.hasMultipleContents&&(0,c.A)(i)){if(!e.contentReady){try{i.update(t,n)}catch(e){}return}e._expiredContent.destroy(),e._expiredContent=void 0}if((0,c.A)(e.content))try{e.content.update(t,n)}catch(t){throw e._contentState=I.A.FAILED,t}}(this,e,t);const a=i.length;this._commandsLength=a-o;for(let e=o;e<a;++e){const t=i[e],n=t.pass===q.A.TRANSLUCENT;t.depthForTranslucentClassification=n}this.clippingPlanesDirty=!1,this.clippingPolygonsDirty=!1};const de=[];function he(e,t,n){const i=e*Math.pow(10,t);return parseInt(i)*Math.pow(10,n)}function Ae(e,t,n){return Math.max(p.A.normalize(e,t,n)-p.A.EPSILON7,0)}Q.prototype.process=function(e,t){this.contentExpired||this.contentReady||!this._content.ready||(function(e){if(!(0,c.A)(e.expireDuration))return;const t=A.A.now(K);A.A.addSeconds(t,e.expireDuration,t),(0,c.A)(e.expireDate)?A.A.lessThan(e.expireDate,t)&&A.A.clone(t,e.expireDate):e.expireDate=A.A.clone(t)}(this),this._selectedFrame=0,this.lastStyleTime=0,A.A.now(this._loadTimestamp),this._contentState=I.A.READY,this.hasTilesetContent||this.hasImplicitContent||(e._statistics.incrementLoadCounts(this.content),++e._statistics.numberOfTilesWithContentReady,++e._statistics.numberOfLoadedTilesTotal,e._cache.add(this)));const n=t.commandList;t.commandList=de;try{this._content.update(e,t)}catch(e){throw this._contentState=I.A.FAILED,e}de.length=0,t.commandList=n},Q.prototype.updatePriority=function(){const e=this.tileset,t=e.preferLeaves,n=e._minimumPriority,i=e._maximumPriority,o=Math.pow(10,8),r=Math.pow(10,9),s=Math.pow(10,10);let a=Ae(this._depth,n.depth,i.depth);a=t?1-a:a;const c=he(e.isSkippingLevelOfDetail||this.refine!==R.A.REPLACE?Ae(this._priorityReverseScreenSpaceError,n.reverseScreenSpaceError,i.reverseScreenSpaceError):Ae(this._priorityHolder._distanceToCamera,n.distance,i.distance),4,0),l=this._priorityProgressiveResolution?0:o,u=he(Ae(this._priorityHolder._foveatedFactor,n.foveatedFactor,i.foveatedFactor),4,4),d=this.priorityDeferred?r:0,h=e._pass===O.A.PRELOAD_FLIGHT?0:s;this._priority=a+c+l+u+d+h},Q.prototype.isDestroyed=function(){return!1},Q.prototype.destroy=function(){return this._content=this._content&&this._content.destroy(),this._expiredContent=this._expiredContent&&!this._expiredContent.isDestroyed()&&this._expiredContent.destroy(),this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy(),(0,u.A)(this)};const pe=Q},184483:(e,t,n)=>{"use strict";n.d(t,{A:()=>G});var i=n(434067),o=n(369031),r=n(376758),s=n(41476),a=n(430346),c=n(491446),l=n(786101),u=n(677354),d=n(605971),h=n(367817),A=n(123245),p=n(430332),f=n(377496),m=n(760866),g=n(40118),_=n(342875),y=n(653565),v=n(744671),T=n(200646),b=n(716750),w=n(527083),x=n(351554),C=n(938987),E=n(896464),S=n(138151),I=n(702247);const P=y.A.DEFAULT_COLOR_VALUE,D=y.A.DEFAULT_SHOW_VALUE;function O(e,t,n,i,o){let s;this.featuresLength=t,(0,c.A)(n)&&(s=n.extensions),this._extensions=s??{};const a=function(e){const t={};if(!(0,c.A)(e))return t;for(const n in e)e.hasOwnProperty(n)&&"HIERARCHY"!==n&&"extensions"!==n&&"extras"!==n&&(t[n]=(0,r.A)(e[n],!0));return t}(n);this._properties=a,this._batchTableHierarchy=function(e,t,n){if(!(0,c.A)(t))return;let i=e._extensions["3DTILES_batch_table_hierarchy"];const o=t.HIERARCHY;return(0,c.A)(o)&&(O._deprecationWarning("batchTableHierarchyExtension","The batch table HIERARCHY property has been moved to an extension. Use extensions.3DTILES_batch_table_hierarchy instead."),e._extensions["3DTILES_batch_table_hierarchy"]=o,i=o),(0,c.A)(i)?new v.A({extension:i,binaryBody:n}):void 0}(this,n,i);const l=R(t,a,i);this._binaryPropertiesByteLength=function(e){if(!(0,c.A)(e))return 0;let t=0;for(const n in e)e.hasOwnProperty(n)&&(t+=e[n].typedArray.byteLength);return t}(l),this._batchTableBinaryProperties=l,this._content=e,this._batchTexture=new y.A({featuresLength:t,colorChangedCallback:o,owner:e,statistics:e.tileset.statistics})}function R(e,t,n){let i;for(const o in t)if(t.hasOwnProperty(o)){const r=t[o],s=r.byteOffset;if((0,c.A)(s)){const t=r.componentType,a=r.type;if(!(0,c.A)(t))throw new A.A("componentType is required.");if(!(0,c.A)(a))throw new A.A("type is required.");if(!(0,c.A)(n))throw new A.A(`Property ${o} requires a batch table binary.`);const l=(0,x.A)(r),u=l.componentsPerAttribute,d=l.classType,h=l.createArrayBufferView(n.buffer,n.byteOffset+s,e);(0,c.A)(i)||(i={}),i[o]={typedArray:h,componentCount:u,type:d}}}return i}O._deprecationWarning=l.A,Object.defineProperties(O.prototype,{batchTableByteLength:{get:function(){let e=this._binaryPropertiesByteLength;return(0,c.A)(this._batchTableHierarchy)&&(e+=this._batchTableHierarchy.byteLength),e+=this._batchTexture.byteLength,e}}}),O.getBinaryProperties=function(e,t,n){return R(e,t,n)},O.prototype.setShow=function(e,t){this._batchTexture.setShow(e,t)},O.prototype.setAllShow=function(e){this._batchTexture.setAllShow(e)},O.prototype.getShow=function(e){return this._batchTexture.getShow(e)},O.prototype.setColor=function(e,t){this._batchTexture.setColor(e,t)},O.prototype.setAllColor=function(e){this._batchTexture.setAllColor(e)},O.prototype.getColor=function(e,t){return this._batchTexture.getColor(e,t)},O.prototype.getPickColor=function(e){return this._batchTexture.getPickColor(e)};const M=new s.A;function L(e,t){if(!(0,c.A)(e)||e<0||e>=t)throw new d.A(`batchId is required and must be between zero and featuresLength - 1 (${t}`-NaN)}function N(e,t){return e=_.A.replaceMain(e,"tile_main"),t?`${e}uniform float tile_colorBlend; \nvoid tile_color(vec4 tile_featureColor) \n{ \n    tile_main(); \n    tile_featureColor = czm_gammaCorrect(tile_featureColor); \n    out_FragColor.a *= tile_featureColor.a; \n    float highlight = ceil(tile_colorBlend); \n    out_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); \n} \n`:`${e}void tile_color(vec4 tile_featureColor) \n{ \n    tile_main(); \n} \n`}function B(e,t,n){if(!(0,c.A)(t))return N(e,n);let i=new RegExp(`(uniform|attribute|in)\\s+(vec[34]|sampler2D)\\s+${t};`);const o=e.match(i);if(!(0,c.A)(o))return N(e,n);const r=o[0],s=o[2];let a;if(e=(e=_.A.replaceMain(e,"tile_main")).replace(r,""),"vec3"===s||"vec4"===s){const n="vec3"===s?`vec4(${t}, 1.0)`:t,o="vec3"===s?"tile_diffuse.xyz":"tile_diffuse";i=new RegExp(t,"g"),e=e.replace(i,o),a=`    vec4 source = ${n}; \n    tile_diffuse = tile_diffuse_final(source, tile_featureColor); \n    tile_main(); \n`}else"sampler2D"===s&&(e=function(e,t){const n=`texture(${t}`;let i,o=0,r=e.indexOf(n,o);for(;r>-1;){let t=0;for(let n=r;n<e.length;++n){const o=e.charAt(n);if("("===o)++t;else if(")"===o&&(--t,0===t)){i=n+1;break}}const s=`tile_diffuse_final(${e.slice(r,i)}, tile_diffuse)`;e=e.slice(0,r)+s+e.slice(i),o=r+s.length,r=e.indexOf(n,o)}return e}(e,t),a="    tile_diffuse = tile_featureColor; \n    tile_main(); \n");return e=`uniform float tile_colorBlend; \nvec4 tile_diffuse = vec4(1.0); \nbool isWhite(vec3 color) \n{ \n    return all(greaterThan(color, vec3(1.0 - czm_epsilon3))); \n} \nvec4 tile_diffuse_final(vec4 sourceDiffuse, vec4 tileDiffuse) \n{ \n    vec4 blendDiffuse = mix(sourceDiffuse, tileDiffuse, tile_colorBlend); \n    vec4 diffuse = isWhite(tileDiffuse.rgb) ? sourceDiffuse : blendDiffuse; \n    return vec4(diffuse.rgb, sourceDiffuse.a); \n} \n${r}\n${e}\nvoid tile_color(vec4 tile_featureColor) \n{ \n${a}`,n&&(e+="    tile_featureColor = czm_gammaCorrect(tile_featureColor); \n    out_FragColor.a *= tile_featureColor.a; \n    float highlight = ceil(tile_colorBlend); \n    out_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); \n"),e+"} \n"}O.prototype.applyStyle=function(e){if(!(0,c.A)(e))return this.setAllColor(P),void this.setAllShow(D);const t=this._content,n=this.featuresLength;for(let i=0;i<n;++i){const n=t.getFeature(i),o=(0,c.A)(e.color)?e.color.evaluateColor(n,M)??P:P,r=(0,c.A)(e.show)?e.show.evaluate(n)??D:D;this.setColor(i,o),this.setShow(i,r)}},O.prototype.isClass=function(e,t){L(e,this.featuresLength),o.A.typeOf.string("className",t);const n=this._batchTableHierarchy;return!!(0,c.A)(n)&&n.isClass(e,t)},O.prototype.isExactClass=function(e,t){return o.A.typeOf.string("className",t),this.getExactClassName(e)===t},O.prototype.getExactClassName=function(e){L(e,this.featuresLength);const t=this._batchTableHierarchy;if((0,c.A)(t))return t.getClassName(e)},O.prototype.hasProperty=function(e,t){return L(e,this.featuresLength),o.A.typeOf.string("name",t),(0,c.A)(this._properties[t])||(0,c.A)(this._batchTableHierarchy)&&this._batchTableHierarchy.hasProperty(e,t)},O.prototype.hasPropertyBySemantic=function(){return!1},O.prototype.getPropertyIds=function(e,t){L(e,this.featuresLength),(t=(0,c.A)(t)?t:[]).length=0;const n=Object.keys(this._properties);if((0,I.A)(t,n),(0,c.A)(this._batchTableHierarchy)){const i=this._batchTableHierarchy.getPropertyIds(e,n);(0,I.A)(t,i)}return t},O.prototype.getPropertyBySemantic=function(e,t){},O.prototype.getProperty=function(e,t){if(L(e,this.featuresLength),o.A.typeOf.string("name",t),(0,c.A)(this._batchTableBinaryProperties)){const n=this._batchTableBinaryProperties[t];if((0,c.A)(n))return function(e,t){const n=e.typedArray,i=e.componentCount;return 1===i?n[t]:e.type.unpack(n,t*i)}(n,e)}const n=this._properties[t];if((0,c.A)(n))return(0,r.A)(n[e],!0);if((0,c.A)(this._batchTableHierarchy)){const n=this._batchTableHierarchy.getProperty(e,t);if((0,c.A)(n))return n}},O.prototype.setProperty=function(e,t,n){const i=this.featuresLength;if(L(e,i),o.A.typeOf.string("name",t),(0,c.A)(this._batchTableBinaryProperties)){const i=this._batchTableBinaryProperties[t];if((0,c.A)(i))return void function(e,t,n){const i=e.typedArray,o=e.componentCount;1===o?i[t]=n:e.type.pack(n,i,t*o)}(i,e,n)}if((0,c.A)(this._batchTableHierarchy)&&this._batchTableHierarchy.setProperty(e,t,n))return;let s=this._properties[t];(0,c.A)(s)||(this._properties[t]=new Array(i),s=this._properties[t]),s[e]=(0,r.A)(n,!0)},O.prototype.getVertexShaderCallback=function(e,t,n){if(0===this.featuresLength)return;const i=this;return function(o){const r=B(o,n,!1);let s;return p.A.maximumVertexTextureImageUnits>0?(s="",e&&(s+="uniform bool tile_translucentCommand; \n"),s+=`uniform sampler2D tile_batchTexture; \nout vec4 tile_featureColor; \nout vec2 tile_featureSt; \nvoid main() \n{ \n    vec2 st = computeSt(${t}); \n    vec4 featureProperties = texture(tile_batchTexture, st); \n    tile_color(featureProperties); \n    float show = ceil(featureProperties.a); \n    gl_Position *= show; \n`,e&&(s+="    bool isStyleTranslucent = (featureProperties.a != 1.0); \n    if (czm_pass == czm_passTranslucent) \n    { \n        if (!isStyleTranslucent && !tile_translucentCommand) \n        { \n            gl_Position *= 0.0; \n        } \n    } \n    else \n    { \n        if (isStyleTranslucent) \n        { \n            gl_Position *= 0.0; \n        } \n    } \n"),s+="    tile_featureColor = featureProperties; \n    tile_featureSt = st; \n}"):s=`out vec2 tile_featureSt; \nvoid main() \n{ \n    tile_color(vec4(1.0)); \n    tile_featureSt = computeSt(${t}); \n}`,`${r}\n${a=i,1===a._batchTexture.textureDimensions.y?"uniform vec4 tile_textureStep; \nvec2 computeSt(float batchId) \n{ \n    float stepX = tile_textureStep.x; \n    float centerX = tile_textureStep.y; \n    return vec2(centerX + (batchId * stepX), 0.5); \n} \n":"uniform vec4 tile_textureStep; \nuniform vec2 tile_textureDimensions; \nvec2 computeSt(float batchId) \n{ \n    float stepX = tile_textureStep.x; \n    float centerX = tile_textureStep.y; \n    float stepY = tile_textureStep.z; \n    float centerY = tile_textureStep.w; \n    float xId = mod(batchId, tile_textureDimensions.x); \n    float yId = floor(batchId / tile_textureDimensions.x); \n    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); \n} \n"}${s}`;var a}},O.prototype.getFragmentShaderCallback=function(e,t,n){if(0!==this.featuresLength)return function(i){return i=B(i,t,!0),p.A.maximumVertexTextureImageUnits>0?(i+="uniform sampler2D tile_pickTexture; \nin vec2 tile_featureSt; \nin vec4 tile_featureColor; \nvoid main() \n{ \n    tile_color(tile_featureColor); \n",n&&(i+="    out_FragColor.rgb *= out_FragColor.a; \n"),i+="}"):(e&&(i+="uniform bool tile_translucentCommand; \n"),i+="uniform sampler2D tile_pickTexture; \nuniform sampler2D tile_batchTexture; \nin vec2 tile_featureSt; \nvoid main() \n{ \n    vec4 featureProperties = texture(tile_batchTexture, tile_featureSt); \n    if (featureProperties.a == 0.0) { \n        discard; \n    } \n",e&&(i+="    bool isStyleTranslucent = (featureProperties.a != 1.0); \n    if (czm_pass == czm_passTranslucent) \n    { \n        if (!isStyleTranslucent && !tile_translucentCommand) \n        { \n            discard; \n        } \n    } \n    else \n    { \n        if (isStyleTranslucent) \n        { \n            discard; \n        } \n    } \n"),i+="    tile_color(featureProperties); \n",n&&(i+="    out_FragColor.rgb *= out_FragColor.a; \n"),i+="} \n"),i}},O.prototype.getUniformMapCallback=function(){if(0===this.featuresLength)return;const e=this;return function(t){const n={tile_batchTexture:function(){return e._batchTexture.batchTexture??e._batchTexture.defaultTexture},tile_textureDimensions:function(){return e._batchTexture.textureDimensions},tile_textureStep:function(){return e._batchTexture.textureStep},tile_colorBlend:function(){return function(e){const t=e._content.tileset,n=t.colorBlendMode,i=t.colorBlendAmount;if(n===b.A.HIGHLIGHT)return 0;if(n===b.A.REPLACE)return 1;if(n===b.A.MIX)return h.A.clamp(i,h.A.EPSILON4,1);throw new d.A(`Invalid color blend mode "${n}".`)}(e)},tile_pickTexture:function(){return e._batchTexture.pickTexture}};return(0,a.A)(t,n)}},O.prototype.getPickId=function(){return"texture(tile_pickTexture, tile_featureSt)"};function F(e){const t=f.A.shallowClone(e),n=t.pass===m.A.TRANSLUCENT;return t.uniformMap=(0,c.A)(t.uniformMap)?t.uniformMap:{},t.uniformMap.tile_translucentCommand=function(){return n},t}function U(e){const t=f.A.shallowClone(e);return t.pass=m.A.TRANSLUCENT,t.renderState=function(e){const t=(0,r.A)(e,!0);return t.cull.enabled=!1,t.depthTest.enabled=!0,t.depthMask=!1,t.blending=T.A.ALPHA_BLEND,t.stencilTest=C.A.setCesium3DTileBit(),t.stencilMask=C.A.CESIUM_3D_TILE_MASK,g.A.fromCache(t)}(e.renderState),t}function k(e){const t=f.A.shallowClone(e);return t.renderState=function(e){const t=(0,r.A)(e,!0);return t.stencilTest=C.A.setCesium3DTileBit(),t.stencilMask=C.A.CESIUM_3D_TILE_MASK,g.A.fromCache(t)}(e.renderState),t}function V(e,t){const n=f.A.shallowClone(t),o=(0,r.A)(n.renderState,!0);o.cull.enabled=!0,o.cull.face=w.A.FRONT,o.colorMask={red:!1,green:!1,blue:!1,alpha:!1},o.polygonOffset={enabled:!0,factor:5,units:5},o.stencilTest=C.A.setCesium3DTileBit(),o.stencilMask=C.A.CESIUM_3D_TILE_MASK,n.renderState=g.A.fromCache(o),n.castShadows=!1,n.receiveShadows=!1,n.uniformMap=(0,r.A)(t.uniformMap);const s=new i.A(5,5);return n.uniformMap.u_polygonOffset=function(){return s},n.shaderProgram=function(e,t){let n=e.shaderCache.getDerivedShaderProgram(t,"zBackfaceLogDepth");if(!(0,c.A)(n)){const i=t.fragmentShaderSource.clone();i.defines=(0,c.A)(i.defines)?i.defines.slice(0):[],i.defines.push("POLYGON_OFFSET"),n=e.shaderCache.createDerivedShaderProgram(t,"zBackfaceLogDepth",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:i,attributeLocations:t._attributeLocations})}return n}(e,t.shaderProgram),n}function z(e,t){const n=f.A.shallowClone(e),i=(0,r.A)(n.renderState,!0);return i.stencilTest.enabled=!0,i.stencilTest.mask=C.A.SKIP_LOD_MASK,i.stencilTest.reference=C.A.CESIUM_3D_TILE_MASK|t<<C.A.SKIP_LOD_BIT_SHIFT,i.stencilTest.frontFunction=E.A.GREATER_OR_EQUAL,i.stencilTest.frontOperation.zPass=S.A.REPLACE,i.stencilTest.backFunction=E.A.GREATER_OR_EQUAL,i.stencilTest.backOperation.zPass=S.A.REPLACE,i.stencilMask=C.A.CESIUM_3D_TILE_MASK|C.A.SKIP_LOD_MASK,n.renderState=g.A.fromCache(i),n}function H(e){return(e.renderState.stencilTest.reference&C.A.SKIP_LOD_MASK)>>>C.A.SKIP_LOD_BIT_SHIFT}O.prototype.addDerivedCommands=function(e,t){const n=e.commandList,i=n.length,o=this._content._tile,r=o._finalResolution,s=o.tileset,a=s.isSkippingLevelOfDetail&&s.hasMixedContent&&e.context.stencilBuffer,l=function(e){const t=e._batchTexture.translucentFeaturesLength;return 0===t?0:t===e.featuresLength?1:2}(this);for(let u=t;u<i;++u){const t=n[u];if(t.pass===m.A.COMPUTE)continue;let i=t.derivedCommands.tileset;(0,c.A)(i)&&!t.dirty||(i={},t.derivedCommands.tileset=i,i.originalCommand=F(t),t.dirty=!1);const d=i.originalCommand;0!==l&&t.pass!==m.A.TRANSLUCENT&&((0,c.A)(i.translucent)||(i.translucent=U(d))),1!==l&&t.pass!==m.A.TRANSLUCENT&&((0,c.A)(i.opaque)||(i.opaque=k(d)),a&&(r||((0,c.A)(i.zback)||(i.zback=V(e.context,d)),s._backfaceCommands.push(i.zback)),(0,c.A)(i.stencil)&&o._selectionDepth===H(i.stencil)||(t.renderState.depthMask?i.stencil=z(d,o._selectionDepth):i.stencil=i.opaque)));const h=a?i.stencil:i.opaque,A=i.translucent;t.pass!==m.A.TRANSLUCENT?(0===l&&(n[u]=h),1===l&&(n[u]=A),2===l&&(n[u]=h,n.push(A))):n[u]=d}},O.prototype.update=function(e,t){this._batchTexture.update(e,t)},O.prototype.isDestroyed=function(){return!1},O.prototype.destroy=function(){return this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),(0,u.A)(this)};const G=O},716750:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({HIGHLIGHT:0,REPLACE:1,MIX:2})},891846:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var i=n(583511),o=n(823064),r=n(961965),s=n(224975),a=n(323314),c=n(868897),l=n(271845),u=n(123245);const d={b3dm:function(e,t,n,i,o){return s.A.fromB3dm(e,t,n,i,o)},pnts:function(e,t,n,i,o){return s.A.fromPnts(e,t,n,i,o)},i3dm:function(e,t,n,i,o){return s.A.fromI3dm(e,t,n,i,o)},cmpt:function(e,t,n,o,r){return i.A.fromTileType(e,t,n,o,r,d)},externalTileset:function(e,t,n,i){return a.A.fromJson(e,t,n,i)},geom:function(e,t,n,i,r){return new o.A(e,t,n,i,r)},vctr:function(e,t,n,i,o){return new c.A(e,t,n,i,o)},subt:function(e,t,n,i,o){return r.A.fromSubtreeJson(e,t,n,void 0,i,o)},subtreeJson:function(e,t,n,i){return r.A.fromSubtreeJson(e,t,n,i)},glb:function(e,t,n,i,o){if(i.byteLength<12)throw new u.A("Invalid glb content");const r=new DataView(i,o).getUint32(8,!0),a=new Uint8Array(i,o,r);return l.A.tilesetRequiresGaussianSplattingExt(e)?l.A.fromGltf(e,t,n,a):s.A.fromGltf(e,t,n,a)},gltf:function(e,t,n,i){return l.A.tilesetRequiresGaussianSplattingExt(e)?l.A.fromGltf(e,t,n,i):s.A.fromGltf(e,t,n,i)},geoJson:function(e,t,n,i){return s.A.fromGeoJson(e,t,n,i)}},h=d},621065:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5})},223702:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});const i={BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",COMPOSITE:"cmpt",POINT_CLOUD:"pnts",VECTOR:"vctr",GEOMETRY:"geom",GLTF:"gltf",GLTF_BINARY:"glb",IMPLICIT_SUBTREE:"subt",IMPLICIT_SUBTREE_JSON:"subtreeJson",EXTERNAL_TILESET:"externalTileset",MULTIPLE_CONTENT:"multipleContent",GEOJSON:"geoJson",VOXEL_BINARY:"voxl",VOXEL_JSON:"voxelJson",isBinaryFormat:function(e){switch(e){case i.BATCHED_3D_MODEL:case i.INSTANCED_3D_MODEL:case i.COMPOSITE:case i.POINT_CLOUD:case i.VECTOR:case i.GEOMETRY:case i.IMPLICIT_SUBTREE:case i.VOXEL_BINARY:case i.GLTF_BINARY:return!0;default:return!1}}},o=Object.freeze(i)},468741:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(571804),o=n(491446);function r(e,t){this.json=e,this.buffer=t,this._cachedTypedArrays={},this.featuresLength=0}function s(e,t,n,r,s,a){const c=e._cachedTypedArrays;let l=c[t];return(0,o.A)(l)||(l=i.A.createArrayBufferView(n,e.buffer.buffer,e.buffer.byteOffset+a,s*r),c[t]=l),l}r.prototype.getGlobalProperty=function(e,t,n){const r=this.json[e];if((0,o.A)(r))return(0,o.A)(r.byteOffset)?s(this,e,t=t??i.A.UNSIGNED_INT,n=n??1,1,r.byteOffset):r},r.prototype.hasProperty=function(e){return(0,o.A)(this.json[e])},r.prototype.getPropertyArray=function(e,t,n){const r=this.json[e];if((0,o.A)(r))return(0,o.A)(r.byteOffset)?((0,o.A)(r.componentType)&&(t=i.A.fromName(r.componentType)),s(this,e,t,n,this.featuresLength,r.byteOffset)):function(e,t,n,r){const s=e._cachedTypedArrays;let a=s[t];return(0,o.A)(a)||(a=i.A.createTypedArray(n,r),s[t]=a),a}(this,e,t,r)},r.prototype.getProperty=function(e,t,n,i,r){const s=this.json[e];if(!(0,o.A)(s))return;const a=this.getPropertyArray(e,t,n);if(1===n)return a[i];for(let e=0;e<n;++e)r[e]=a[n*i+e];return r};const a=r},45679:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0})},649413:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(267980),o=n(369031),r=n(45679),s=n(413690),a=n(11745);const c={},l=new i.A;c.checkChildrenWithinParent=function(e){o.A.typeOf.object("tile",e);const t=e.children,n=t.length,c=e.boundingVolume;if(c instanceof a.A||c instanceof s.A){const o=c._orientedBoundingBox;e._optimChildrenWithinParent=r.A.USE_OPTIMIZATION;for(let c=0;c<n;++c){const n=t[c].boundingVolume;if(!(n instanceof a.A||n instanceof s.A)){e._optimChildrenWithinParent=r.A.SKIP_OPTIMIZATION;break}const u=n._orientedBoundingBox,d=i.A.subtract(u.center,o.center,l),h=i.A.magnitude(d);if(i.A.divideByScalar(d,h,d),Math.abs(o.halfAxes[0]*d.x)+Math.abs(o.halfAxes[1]*d.y)+Math.abs(o.halfAxes[2]*d.z)+Math.abs(o.halfAxes[3]*d.x)+Math.abs(o.halfAxes[4]*d.y)+Math.abs(o.halfAxes[5]*d.z)+Math.abs(o.halfAxes[6]*d.x)+Math.abs(o.halfAxes[7]*d.y)+Math.abs(o.halfAxes[8]*d.z)<=Math.abs(u.halfAxes[0]*d.x)+Math.abs(u.halfAxes[1]*d.y)+Math.abs(u.halfAxes[2]*d.z)+Math.abs(u.halfAxes[3]*d.x)+Math.abs(u.halfAxes[4]*d.y)+Math.abs(u.halfAxes[5]*d.z)+Math.abs(u.halfAxes[6]*d.x)+Math.abs(u.halfAxes[7]*d.y)+Math.abs(u.halfAxes[8]*d.z)+h){e._optimChildrenWithinParent=r.A.SKIP_OPTIMIZATION;break}}}return e._optimChildrenWithinParent===r.A.USE_OPTIMIZATION};const u=c},581010:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const i={RENDER:0,PICK:1,SHADOW:2,PRELOAD:3,PRELOAD_FLIGHT:4,REQUEST_RENDER_MODE_DEFER_CHECK:5,MOST_DETAILED_PRELOAD:6,MOST_DETAILED_PICK:7,NUMBER_OF_PASSES:8},o=new Array(i.NUMBER_OF_PASSES);o[i.RENDER]=Object.freeze({pass:i.RENDER,isRender:!0,requestTiles:!0,ignoreCommands:!1}),o[i.PICK]=Object.freeze({pass:i.PICK,isRender:!1,requestTiles:!1,ignoreCommands:!1}),o[i.SHADOW]=Object.freeze({pass:i.SHADOW,isRender:!1,requestTiles:!0,ignoreCommands:!1}),o[i.PRELOAD]=Object.freeze({pass:i.PRELOAD,isRender:!1,requestTiles:!0,ignoreCommands:!0}),o[i.PRELOAD_FLIGHT]=Object.freeze({pass:i.PRELOAD_FLIGHT,isRender:!1,requestTiles:!0,ignoreCommands:!0}),o[i.REQUEST_RENDER_MODE_DEFER_CHECK]=Object.freeze({pass:i.REQUEST_RENDER_MODE_DEFER_CHECK,isRender:!1,requestTiles:!0,ignoreCommands:!0}),o[i.MOST_DETAILED_PRELOAD]=Object.freeze({pass:i.MOST_DETAILED_PRELOAD,isRender:!1,requestTiles:!0,ignoreCommands:!0}),o[i.MOST_DETAILED_PICK]=Object.freeze({pass:i.MOST_DETAILED_PICK,isRender:!1,requestTiles:!1,ignoreCommands:!1}),i.getPassOptions=function(e){return o[e]};const r=Object.freeze(i)},294023:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(336946),o=n(41476),r=n(491446),s=n(622569),a=n(883734);function c(e,t,n,i,o){this._content=e,this._billboard=n,this._label=i,this._polyline=o,this._batchId=t,this._billboardImage=void 0,this._billboardColor=void 0,this._billboardOutlineColor=void 0,this._billboardOutlineWidth=void 0,this._billboardSize=void 0,this._pointSize=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._heightOffset=void 0,this._pickIds=new Array(3),u(this)}const l=new i.A;function u(e){const t=e._billboard;if((0,r.A)(e._billboardImage)&&e._billboardImage!==t.image)return void(t.image=e._billboardImage);if((0,r.A)(e._billboardImage))return;const n=e._color??c.defaultColor,i=e._pointOutlineColor??c.defaultPointOutlineColor,s=e._pointOutlineWidth??c.defaultPointOutlineWidth,l=e._pointSize??c.defaultPointSize,u=e._billboardColor,d=e._billboardOutlineColor,h=e._billboardOutlineWidth,A=e._billboardSize;if(o.A.equals(n,u)&&o.A.equals(i,d)&&s===h&&l===A)return;e._billboardColor=o.A.clone(n,e._billboardColor),e._billboardOutlineColor=o.A.clone(i,e._billboardOutlineColor),e._billboardOutlineWidth=s,e._billboardSize=l;const p=n.alpha,f=n.toCssColorString(),m=i.toCssColorString(),g=JSON.stringify([f,l,m,s]);t.setImage(g,(0,a.A)(p,f,m,s,l))}Object.defineProperties(c.prototype,{show:{get:function(){return this._label.show},set:function(e){this._label.show=e,this._billboard.show=e,this._polyline.show=e}},color:{get:function(){return this._color},set:function(e){this._color=o.A.clone(e,this._color),u(this)}},pointSize:{get:function(){return this._pointSize},set:function(e){this._pointSize=e,u(this)}},pointOutlineColor:{get:function(){return this._pointOutlineColor},set:function(e){this._pointOutlineColor=o.A.clone(e,this._pointOutlineColor),u(this)}},pointOutlineWidth:{get:function(){return this._pointOutlineWidth},set:function(e){this._pointOutlineWidth=e,u(this)}},labelColor:{get:function(){return this._label.fillColor},set:function(e){this._label.fillColor=e,this._polyline.show=this._label.show&&e.alpha>0}},labelOutlineColor:{get:function(){return this._label.outlineColor},set:function(e){this._label.outlineColor=e}},labelOutlineWidth:{get:function(){return this._label.outlineWidth},set:function(e){this._label.outlineWidth=e}},font:{get:function(){return this._label.font},set:function(e){this._label.font=e}},labelStyle:{get:function(){return this._label.style},set:function(e){this._label.style=e}},labelText:{get:function(){return this._label.text},set:function(e){(0,r.A)(e)||(e=""),this._label.text=e}},backgroundColor:{get:function(){return this._label.backgroundColor},set:function(e){this._label.backgroundColor=e}},backgroundPadding:{get:function(){return this._label.backgroundPadding},set:function(e){this._label.backgroundPadding=e}},backgroundEnabled:{get:function(){return this._label.showBackground},set:function(e){this._label.showBackground=e}},scaleByDistance:{get:function(){return this._label.scaleByDistance},set:function(e){this._label.scaleByDistance=e,this._billboard.scaleByDistance=e}},translucencyByDistance:{get:function(){return this._label.translucencyByDistance},set:function(e){this._label.translucencyByDistance=e,this._billboard.translucencyByDistance=e}},distanceDisplayCondition:{get:function(){return this._label.distanceDisplayCondition},set:function(e){this._label.distanceDisplayCondition=e,this._polyline.distanceDisplayCondition=e,this._billboard.distanceDisplayCondition=e}},heightOffset:{get:function(){return this._heightOffset},set:function(e){const t=this._heightOffset??0,n=this._content.tileset.ellipsoid,i=n.cartesianToCartographic(this._billboard.position,l);i.height=i.height-t+e;const o=n.cartographicToCartesian(i);this._billboard.position=o,this._label.position=this._billboard.position,this._polyline.positions=[this._polyline.positions[0],o],this._heightOffset=e}},anchorLineEnabled:{get:function(){return this._polyline.show},set:function(e){this._polyline.show=e}},anchorLineColor:{get:function(){return this._polyline.material.uniforms.color},set:function(e){this._polyline.material.uniforms.color=o.A.clone(e,this._polyline.material.uniforms.color)}},image:{get:function(){return this._billboardImage},set:function(e){const t=this._billboardImage!==e;this._billboardImage=e,t&&u(this)}},disableDepthTestDistance:{get:function(){return this._label.disableDepthTestDistance},set:function(e){this._label.disableDepthTestDistance=e,this._billboard.disableDepthTestDistance=e}},horizontalOrigin:{get:function(){return this._billboard.horizontalOrigin},set:function(e){this._billboard.horizontalOrigin=e}},verticalOrigin:{get:function(){return this._billboard.verticalOrigin},set:function(e){this._billboard.verticalOrigin=e}},labelHorizontalOrigin:{get:function(){return this._label.horizontalOrigin},set:function(e){this._label.horizontalOrigin=e}},labelVerticalOrigin:{get:function(){return this._label.verticalOrigin},set:function(e){this._label.verticalOrigin=e}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}},pickIds:{get:function(){const e=this._pickIds;return e[0]=this._billboard.pickId,e[1]=this._label.pickId,e[2]=this._polyline.pickId,e}}}),c.defaultColor=o.A.WHITE,c.defaultPointOutlineColor=o.A.BLACK,c.defaultPointOutlineWidth=0,c.defaultPointSize=8,c.prototype.hasProperty=function(e){return this._content.batchTable.hasProperty(this._batchId,e)},c.prototype.getPropertyIds=function(e){return this._content.batchTable.getPropertyIds(this._batchId,e)},c.prototype.getProperty=function(e){return this._content.batchTable.getProperty(this._batchId,e)},c.prototype.getPropertyInherited=function(e){return s.A.getPropertyInherited(this._content,this._batchId,e)},c.prototype.setProperty=function(e,t){this._content.batchTable.setProperty(this._batchId,e,t),this._content.featurePropertiesDirty=!0},c.prototype.isExactClass=function(e){return this._content.batchTable.isExactClass(this._batchId,e)},c.prototype.isClass=function(e){return this._content.batchTable.isClass(this._batchId,e)},c.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)};const d=c},661314:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({ADD:0,REPLACE:1})},629606:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(702247),o=n(376758),r=n(915325),s=n(491446),a=n(605971),c=n(744603),l=n(33138),u=n(168064);function d(e){this._style={},this._ready=!1,this._show=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._labelColor=void 0,this._labelOutlineColor=void 0,this._labelOutlineWidth=void 0,this._font=void 0,this._labelStyle=void 0,this._labelText=void 0,this._backgroundColor=void 0,this._backgroundPadding=void 0,this._backgroundEnabled=void 0,this._scaleByDistance=void 0,this._translucencyByDistance=void 0,this._distanceDisplayCondition=void 0,this._heightOffset=void 0,this._anchorLineEnabled=void 0,this._anchorLineColor=void 0,this._image=void 0,this._disableDepthTestDistance=void 0,this._horizontalOrigin=void 0,this._verticalOrigin=void 0,this._labelHorizontalOrigin=void 0,this._labelVerticalOrigin=void 0,this._meta=void 0,this._colorShaderFunction=void 0,this._showShaderFunction=void 0,this._pointSizeShaderFunction=void 0,this._colorShaderFunctionReady=!1,this._showShaderFunctionReady=!1,this._pointSizeShaderFunctionReady=!1,this._colorShaderTranslucent=!1,function(e,t){t=(0,o.A)(t,!0)??e._style,e._style=t,e.show=t.show,e.color=t.color,e.pointSize=t.pointSize,e.pointOutlineColor=t.pointOutlineColor,e.pointOutlineWidth=t.pointOutlineWidth,e.labelColor=t.labelColor,e.labelOutlineColor=t.labelOutlineColor,e.labelOutlineWidth=t.labelOutlineWidth,e.labelStyle=t.labelStyle,e.font=t.font,e.labelText=t.labelText,e.backgroundColor=t.backgroundColor,e.backgroundPadding=t.backgroundPadding,e.backgroundEnabled=t.backgroundEnabled,e.scaleByDistance=t.scaleByDistance,e.translucencyByDistance=t.translucencyByDistance,e.distanceDisplayCondition=t.distanceDisplayCondition,e.heightOffset=t.heightOffset,e.anchorLineEnabled=t.anchorLineEnabled,e.anchorLineColor=t.anchorLineColor,e.image=t.image,e.disableDepthTestDistance=t.disableDepthTestDistance,e.horizontalOrigin=t.horizontalOrigin,e.verticalOrigin=t.verticalOrigin,e.labelHorizontalOrigin=t.labelHorizontalOrigin,e.labelVerticalOrigin=t.labelVerticalOrigin;const n={};if((0,s.A)(t.meta)){const e=t.defines,i=t.meta??r.A.EMPTY_OBJECT;for(const t in i)i.hasOwnProperty(t)&&(n[t]=new u.A(i[t],e))}e._meta=n,e._ready=!0}(this,e)}function h(e,t){const n=(e._style??r.A.EMPTY_OBJECT).defines;if((0,s.A)(t))return"boolean"==typeof t||"number"==typeof t?new u.A(String(t)):"string"==typeof t?new u.A(t,n):(0,s.A)(t.conditions)?new l.A(t,n):t}function A(e){if((0,s.A)(e))return(0,s.A)(e.expression)?e.expression:(0,s.A)(e.conditionsExpression)?(0,o.A)(e.conditionsExpression,!0):e}Object.defineProperties(d.prototype,{style:{get:function(){return this._style}},show:{get:function(){return this._show},set:function(e){this._show=h(this,e),this._style.show=A(this._show),this._showShaderFunctionReady=!1}},color:{get:function(){return this._color},set:function(e){this._color=h(this,e),this._style.color=A(this._color),this._colorShaderFunctionReady=!1}},pointSize:{get:function(){return this._pointSize},set:function(e){this._pointSize=h(this,e),this._style.pointSize=A(this._pointSize),this._pointSizeShaderFunctionReady=!1}},pointOutlineColor:{get:function(){return this._pointOutlineColor},set:function(e){this._pointOutlineColor=h(this,e),this._style.pointOutlineColor=A(this._pointOutlineColor)}},pointOutlineWidth:{get:function(){return this._pointOutlineWidth},set:function(e){this._pointOutlineWidth=h(this,e),this._style.pointOutlineWidth=A(this._pointOutlineWidth)}},labelColor:{get:function(){return this._labelColor},set:function(e){this._labelColor=h(this,e),this._style.labelColor=A(this._labelColor)}},labelOutlineColor:{get:function(){return this._labelOutlineColor},set:function(e){this._labelOutlineColor=h(this,e),this._style.labelOutlineColor=A(this._labelOutlineColor)}},labelOutlineWidth:{get:function(){return this._labelOutlineWidth},set:function(e){this._labelOutlineWidth=h(this,e),this._style.labelOutlineWidth=A(this._labelOutlineWidth)}},font:{get:function(){return this._font},set:function(e){this._font=h(this,e),this._style.font=A(this._font)}},labelStyle:{get:function(){return this._labelStyle},set:function(e){this._labelStyle=h(this,e),this._style.labelStyle=A(this._labelStyle)}},labelText:{get:function(){return this._labelText},set:function(e){this._labelText=h(this,e),this._style.labelText=A(this._labelText)}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=h(this,e),this._style.backgroundColor=A(this._backgroundColor)}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){this._backgroundPadding=h(this,e),this._style.backgroundPadding=A(this._backgroundPadding)}},backgroundEnabled:{get:function(){return this._backgroundEnabled},set:function(e){this._backgroundEnabled=h(this,e),this._style.backgroundEnabled=A(this._backgroundEnabled)}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){this._scaleByDistance=h(this,e),this._style.scaleByDistance=A(this._scaleByDistance)}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){this._translucencyByDistance=h(this,e),this._style.translucencyByDistance=A(this._translucencyByDistance)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=h(this,e),this._style.distanceDisplayCondition=A(this._distanceDisplayCondition)}},heightOffset:{get:function(){return this._heightOffset},set:function(e){this._heightOffset=h(this,e),this._style.heightOffset=A(this._heightOffset)}},anchorLineEnabled:{get:function(){return this._anchorLineEnabled},set:function(e){this._anchorLineEnabled=h(this,e),this._style.anchorLineEnabled=A(this._anchorLineEnabled)}},anchorLineColor:{get:function(){return this._anchorLineColor},set:function(e){this._anchorLineColor=h(this,e),this._style.anchorLineColor=A(this._anchorLineColor)}},image:{get:function(){return this._image},set:function(e){this._image=h(this,e),this._style.image=A(this._image)}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance=h(this,e),this._style.disableDepthTestDistance=A(this._disableDepthTestDistance)}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin=h(this,e),this._style.horizontalOrigin=A(this._horizontalOrigin)}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){this._verticalOrigin=h(this,e),this._style.verticalOrigin=A(this._verticalOrigin)}},labelHorizontalOrigin:{get:function(){return this._labelHorizontalOrigin},set:function(e){this._labelHorizontalOrigin=h(this,e),this._style.labelHorizontalOrigin=A(this._labelHorizontalOrigin)}},labelVerticalOrigin:{get:function(){return this._labelVerticalOrigin},set:function(e){this._labelVerticalOrigin=h(this,e),this._style.labelVerticalOrigin=A(this._labelVerticalOrigin)}},meta:{get:function(){return this._meta},set:function(e){this._meta=e}}}),d.fromUrl=function(e){if(!(0,s.A)(e))throw new a.A("url is required");return c.A.createIfNeeded(e).fetchJson(e).then(function(e){return new d(e)})},d.prototype.getColorShaderFunction=function(e,t,n){return this._colorShaderFunctionReady?(n.translucent=this._colorShaderTranslucent,this._colorShaderFunction):(this._colorShaderFunctionReady=!0,(0,s.A)(this.color)&&(0,s.A)(this.color.getShaderFunction)?this._colorShaderFunction=this.color.getShaderFunction(e,t,n,"vec4"):this._colorShaderFunction=void 0,this._colorShaderTranslucent=n.translucent,this._colorShaderFunction)},d.prototype.getShowShaderFunction=function(e,t,n){return this._showShaderFunctionReady||(this._showShaderFunctionReady=!0,(0,s.A)(this.show)&&(0,s.A)(this.show.getShaderFunction)?this._showShaderFunction=this.show.getShaderFunction(e,t,n,"bool"):this._showShaderFunction=void 0),this._showShaderFunction},d.prototype.getPointSizeShaderFunction=function(e,t,n){return this._pointSizeShaderFunctionReady||(this._pointSizeShaderFunctionReady=!0,(0,s.A)(this.pointSize)&&(0,s.A)(this.pointSize.getShaderFunction)?this._pointSizeShaderFunction=this.pointSize.getShaderFunction(e,t,n,"float"):this._pointSizeShaderFunction=void 0),this._pointSizeShaderFunction},d.prototype.getVariables=function(){let e=[];return(0,s.A)(this.color)&&(0,s.A)(this.color.getVariables)&&(0,i.A)(e,this.color.getVariables()),(0,s.A)(this.show)&&(0,s.A)(this.show.getVariables)&&(0,i.A)(e,this.show.getVariables()),(0,s.A)(this.pointSize)&&(0,s.A)(this.pointSize.getVariables)&&(0,i.A)(e,this.pointSize.getVariables()),e=e.filter(function(e,t,n){return n.indexOf(e)===t}),e};const p=d},816968:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(491446);function o(){this._style=void 0,this._styleDirty=!1,this._lastStyleTime=0}Object.defineProperties(o.prototype,{style:{get:function(){return this._style},set:function(e){e!==this._style&&(this._style=e,this._styleDirty=!0)}}}),o.prototype.makeDirty=function(){this._styleDirty=!0},o.prototype.resetDirty=function(){this._styleDirty=!1},o.prototype.applyStyle=function(e){if(!(0,i.A)(e.root))return;if((0,i.A)(this._style)&&!this._style._ready)return;const t=this._styleDirty;t&&++this._lastStyleTime;const n=this._lastStyleTime,o=e._statistics,r=t?e._selectedTiles:e._selectedTilesToStyle,s=r.length;for(let e=0;e<s;++e){const t=r[e];if(t.lastStyleTime!==n){const e=t.content;t.lastStyleTime=n,e.applyStyle(this._style),o.numberOfFeaturesStyled+=e.featuresLength,++o.numberOfTilesStyled}}};const r=o},855927:(e,t,n)=>{"use strict";n.d(t,{A:()=>Ye});var i=n(564886),o=n(660662),r=n(434067),s=n(267980),a=n(336946),c=n(369031),l=n(376758),u=n(41476),d=n(607502),h=n(915325),A=n(491446),p=n(786101),f=n(677354),m=n(610750),g=n(955943),_=n(208198),y=n(33914),v=n(150429),T=n(954865),b=n(591978),w=n(981757),x=n(367817),C=n(331185),E=n(584164),S=n(744603),I=n(123245),P=n(543622),D=n(769493),O=n(760866),R=n(40118),M=n(320475),L=n(474751),N=n(716750),B=n(621065),F=n(979830),U=n(649413),k=n(581010),V=n(661314),z=n(648117),H=n(529755),G=n(485760),W=n(816968),Y=n(711284),q=n(348460),j=n(800859),Q=n(834957),X=n(410974),K=n(465674),$=n(983884),J=n(534135),Z=n(929771),ee=n(872182),te=n(62467),ne=n(988609),ie=n(913419),oe=n(938987),re=n(413690),se=n(315747),ae=n(11745),ce=n(741740),le=n(329554),ue=n(724812),de=n(766067),he=n(615557),Ae=n(869327);function pe(e){e=e??h.A.EMPTY_OBJECT,this._url=void 0,this._basePath=void 0,this._root=void 0,this._resource=void 0,this._asset=void 0,this._properties=void 0,this._geometricError=void 0,this._scaledGeometricError=void 0,this._extensionsUsed=void 0,this._extensions=void 0,this._modelUpAxis=void 0,this._modelForwardAxis=void 0,this._cache=new z.A,this._processingQueue=[],this._selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this._selectedTilesToStyle=[],this._loadTimestamp=void 0,this._timeSinceLoad=0,this._updatedVisibilityFrame=0,this._updatedModelMatrixFrame=0,this._modelMatrixChanged=!1,this._previousModelMatrix=void 0,this._extras=void 0,this._credits=void 0,this._showCreditsOnScreen=e.showCreditsOnScreen??!1,this._cullWithChildrenBounds=e.cullWithChildrenBounds??!0,this._allTilesAdditive=!0,this._hasMixedContent=!1,this._stencilClearCommand=void 0,this._backfaceCommands=new w.A,this._maximumScreenSpaceError=e.maximumScreenSpaceError??16,this._memoryAdjustedScreenSpaceError=this._maximumScreenSpaceError,this._cacheBytes=e.cacheBytes??536870912,c.A.typeOf.number.greaterThanOrEquals("cacheBytes",this._cacheBytes,0);const t=e.maximumCacheOverflowBytes??536870912;c.A.typeOf.number.greaterThanOrEquals("maximumCacheOverflowBytes",t,0),this._maximumCacheOverflowBytes=t,this._styleEngine=new W.A,this._styleApplied=!1,this._modelMatrix=(0,A.A)(e.modelMatrix)?E.A.clone(e.modelMatrix):E.A.clone(E.A.IDENTITY),this._addHeightCallbacks=[],this._statistics=new G.A,this._statisticsLast=new G.A,this._statisticsPerPass=new Array(k.A.NUMBER_OF_PASSES);for(let e=0;e<k.A.NUMBER_OF_PASSES;++e)this._statisticsPerPass[e]=new G.A;this._requestedTilesInFlight=[],this._maximumPriority={foveatedFactor:-Number.MAX_VALUE,depth:-Number.MAX_VALUE,distance:-Number.MAX_VALUE,reverseScreenSpaceError:-Number.MAX_VALUE},this._minimumPriority={foveatedFactor:Number.MAX_VALUE,depth:Number.MAX_VALUE,distance:Number.MAX_VALUE,reverseScreenSpaceError:Number.MAX_VALUE},this._heatmap=new H.A(e.debugHeatmapTilePropertyName),this.cullRequestsWhileMoving=e.cullRequestsWhileMoving??!0,this._cullRequestsWhileMoving=!1,this.cullRequestsWhileMovingMultiplier=e.cullRequestsWhileMovingMultiplier??60,this.progressiveResolutionHeightFraction=x.A.clamp(e.progressiveResolutionHeightFraction??.3,0,.5),this.preferLeaves=e.preferLeaves??!1,this._tilesLoaded=!1,this._initialTilesLoaded=!1,this._tileDebugLabels=void 0,this._classificationType=e.classificationType,this._heightReference=e.heightReference,this._scene=e.scene,this._ellipsoid=e.ellipsoid??m.A.WGS84,this._initialClippingPlanesOriginMatrix=E.A.IDENTITY,this._clippingPlanesOriginMatrix=void 0,this._clippingPlanesOriginMatrixDirty=!0,this._vectorClassificationOnly=e.vectorClassificationOnly??!1,this._vectorKeepDecodedPositions=e.vectorKeepDecodedPositions??!1,this._imageryLayers=new Ae.A(this),this._imageryLayersModificationCounter=0,this._imageryLayersListener=()=>{this._imageryLayersModificationCounter++},this.imageryLayers.layerAdded.addEventListener(this._imageryLayersListener),this.imageryLayers.layerRemoved.addEventListener(this._imageryLayersListener),this.imageryLayers.layerMoved.addEventListener(this._imageryLayersListener),this.imageryLayers.layerShownOrHidden.addEventListener(this._imageryLayersListener),this._asynchronouslyLoadImagery=e.asynchronouslyLoadImagery??!1,this.preloadWhenHidden=e.preloadWhenHidden??!1,this.preloadFlightDestinations=e.preloadFlightDestinations??!0,this._pass=void 0,this.dynamicScreenSpaceError=e.dynamicScreenSpaceError??!0,this.foveatedScreenSpaceError=e.foveatedScreenSpaceError??!0,this._foveatedConeSize=e.foveatedConeSize??.1,this._foveatedMinimumScreenSpaceErrorRelaxation=e.foveatedMinimumScreenSpaceErrorRelaxation??0,this.foveatedInterpolationCallback=e.foveatedInterpolationCallback??x.A.lerp,this.foveatedTimeDelay=e.foveatedTimeDelay??.2,this.dynamicScreenSpaceErrorDensity=e.dynamicScreenSpaceErrorDensity??2e-4,this.dynamicScreenSpaceErrorFactor=e.dynamicScreenSpaceErrorFactor??24,this.dynamicScreenSpaceErrorHeightFalloff=e.dynamicScreenSpaceErrorHeightFalloff??.25,this._dynamicScreenSpaceErrorComputedDensity=0,this.shadows=e.shadows??ne.A.ENABLED,this.show=e.show??!0,this.colorBlendMode=N.A.HIGHLIGHT,this.colorBlendAmount=.5,this._pointCloudShading=new Z.A(e.pointCloudShading),this._pointCloudEyeDomeLighting=new J.A,this.loadProgress=new g.A,this.allTilesLoaded=new g.A,this.initialTilesLoaded=new g.A,this.tileLoad=new g.A,this.tileUnload=new g.A,this.tileFailed=new g.A,this.tileVisible=new g.A,this.skipLevelOfDetail=e.skipLevelOfDetail??!1,this._disableSkipLevelOfDetail=!1,this.baseScreenSpaceError=e.baseScreenSpaceError??1024,this.skipScreenSpaceErrorFactor=e.skipScreenSpaceErrorFactor??16,this.skipLevels=e.skipLevels??1,this.immediatelyLoadDesiredLevelOfDetail=e.immediatelyLoadDesiredLevelOfDetail??!1,this.loadSiblings=e.loadSiblings??!1,this._clippingPlanes=void 0,(0,A.A)(e.clippingPlanes)&&Y.A.setOwner(e.clippingPlanes,this,"_clippingPlanes"),this._clippingPolygons=void 0,(0,A.A)(e.clippingPolygons)&&q.A.setOwner(e.clippingPolygons,this,"_clippingPolygons"),(0,A.A)(e.imageBasedLighting)?(this._imageBasedLighting=e.imageBasedLighting,this._shouldDestroyImageBasedLighting=!1):(this._imageBasedLighting=new _.A,this._shouldDestroyImageBasedLighting=!0),this._environmentMapManager=new he.A(e.environmentMapOptions),this.lightColor=e.lightColor,this.backFaceCulling=e.backFaceCulling??!0,this._enableShowOutline=e.enableShowOutline??!0,this.showOutline=e.showOutline??!0,this.outlineColor=e.outlineColor??u.A.BLACK,this.splitDirection=e.splitDirection??ie.A.NONE,this.enableCollision=e.enableCollision??!1,this._projectTo2D=e.projectTo2D??!1,this._enablePick=e.enablePick??!1,this.debugFreezeFrame=e.debugFreezeFrame??!1,this.debugColorizeTiles=e.debugColorizeTiles??!1,this._enableDebugWireframe=e.enableDebugWireframe??!1,this.debugWireframe=e.debugWireframe??!1,!0===this.debugWireframe&&!1===this._enableDebugWireframe&&(0,$.A)("tileset-debug-wireframe-ignored","enableDebugWireframe must be set to true in the Cesium3DTileset constructor, otherwise debugWireframe will be ignored."),this.debugShowBoundingVolume=e.debugShowBoundingVolume??!1,this.debugShowContentBoundingVolume=e.debugShowContentBoundingVolume??!1,this.debugShowViewerRequestVolume=e.debugShowViewerRequestVolume??!1,this._tileDebugLabels=void 0,this.debugPickedTileLabelOnly=!1,this.debugPickedTile=void 0,this.debugPickPosition=void 0,this.debugShowGeometricError=e.debugShowGeometricError??!1,this.debugShowRenderingStatistics=e.debugShowRenderingStatistics??!1,this.debugShowMemoryUsage=e.debugShowMemoryUsage??!1,this.debugShowUrl=e.debugShowUrl??!1,this.examineVectorLinesFunction=void 0,this._metadataExtension=void 0,this._customShader=e.customShader;let n=e.featureIdLabel??"featureId_0";"number"==typeof n&&(n=`featureId_${n}`),this._featureIdLabel=n;let i=e.instanceFeatureIdLabel??"instanceFeatureId_0";"number"==typeof i&&(i=`instanceFeatureId_${i}`),this._instanceFeatureIdLabel=i}function fe(e,t,n,i){if(!(0,A.A)(n.implicitTiling)&&!(0,j.A)(n,"3DTILES_implicit_tiling"))return new L.A(e,t,n,i);const o=e.schema,r=new Q.A(t,n,o),s=new X.A({subdivisionScheme:r.subdivisionScheme,subtreeLevels:r.subtreeLevels,level:0,x:0,y:0,z:0}),a=r.subtreeUriTemplate.getDerivedResource({templateValues:s.getTemplateValues()}).url,c=(0,l.A)(n,!0);c.contents=[{uri:a}],delete c.content,delete c.extensions;const u=new L.A(e,t,c,i);return u.implicitTileset=r,u.implicitCoordinates=s,u}Object.defineProperties(pe.prototype,{isCesium3DTileset:{get:function(){return!0}},asset:{get:function(){return this._asset}},extensions:{get:function(){return this._extensions}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){Y.A.setOwner(e,this,"_clippingPlanes")}},clippingPolygons:{get:function(){return this._clippingPolygons},set:function(e){q.A.setOwner(e,this,"_clippingPolygons")}},imageryLayers:{get:function(){return this._imageryLayers}},imageryLayersModificationCounter:{get:function(){return this._imageryLayersModificationCounter}},asynchronouslyLoadImagery:{get:function(){return this._asynchronouslyLoadImagery}},properties:{get:function(){return this._properties}},tilesLoaded:{get:function(){return this._tilesLoaded}},resource:{get:function(){return this._resource}},basePath:{get:function(){return(0,p.A)("Cesium3DTileset.basePath","Cesium3DTileset.basePath has been deprecated. All tiles are relative to the url of the tileset JSON file that contains them. Use the url property instead."),this._basePath}},style:{get:function(){return this._styleEngine.style},set:function(e){this._styleEngine.style=e}},customShader:{get:function(){return this._customShader},set:function(e){this._customShader=e}},hasMixedContent:{get:function(){return this._hasMixedContent},set:function(e){c.A.typeOf.bool("value",e),this._hasMixedContent=e}},isSkippingLevelOfDetail:{get:function(){return this.skipLevelOfDetail&&!(0,A.A)(this._classificationType)&&!this._disableSkipLevelOfDetail&&!this._allTilesAdditive}},metadataExtension:{get:function(){return this._metadataExtension}},metadata:{get:function(){if((0,A.A)(this._metadataExtension))return this._metadataExtension.tileset}},schema:{get:function(){if((0,A.A)(this._metadataExtension))return this._metadataExtension.schema}},maximumScreenSpaceError:{get:function(){return this._maximumScreenSpaceError},set:function(e){c.A.typeOf.number.greaterThanOrEquals("maximumScreenSpaceError",e,0),this._maximumScreenSpaceError=e,this._memoryAdjustedScreenSpaceError=e}},cacheBytes:{get:function(){return this._cacheBytes},set:function(e){c.A.typeOf.number.greaterThanOrEquals("value",e,0),this._cacheBytes=e}},maximumCacheOverflowBytes:{get:function(){return this._maximumCacheOverflowBytes},set:function(e){c.A.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumCacheOverflowBytes=e}},memoryAdjustedScreenSpaceError:{get:function(){return this._memoryAdjustedScreenSpaceError}},pointCloudShading:{get:function(){return this._pointCloudShading},set:function(e){c.A.defined("pointCloudShading",e),this._pointCloudShading=e}},root:{get:function(){return this._root}},boundingSphere:{get:function(){return this._root.updateTransform(this._modelMatrix),this._root.boundingSphere}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=E.A.clone(e,this._modelMatrix)}},timeSinceLoad:{get:function(){return this._timeSinceLoad}},totalMemoryUsageInBytes:{get:function(){const e=this._statistics;return e.texturesByteLength+e.geometryByteLength+e.batchTableByteLength}},clippingPlanesOriginMatrix:{get:function(){return(0,A.A)(this._clippingPlanesOriginMatrix)?(this._clippingPlanesOriginMatrixDirty&&(E.A.multiply(this.root.computedTransform,this._initialClippingPlanesOriginMatrix,this._clippingPlanesOriginMatrix),this._clippingPlanesOriginMatrixDirty=!1),this._clippingPlanesOriginMatrix):E.A.IDENTITY}},styleEngine:{get:function(){return this._styleEngine}},statistics:{get:function(){return this._statistics}},classificationType:{get:function(){return this._classificationType}},heightReference:{get:function(){return this._heightReference}},scene:{get:function(){return this._scene}},ellipsoid:{get:function(){return this._ellipsoid}},foveatedConeSize:{get:function(){return this._foveatedConeSize},set:function(e){c.A.typeOf.number.greaterThanOrEquals("foveatedConeSize",e,0),c.A.typeOf.number.lessThanOrEquals("foveatedConeSize",e,1),this._foveatedConeSize=e}},foveatedMinimumScreenSpaceErrorRelaxation:{get:function(){return this._foveatedMinimumScreenSpaceErrorRelaxation},set:function(e){c.A.typeOf.number.greaterThanOrEquals("foveatedMinimumScreenSpaceErrorRelaxation",e,0),c.A.typeOf.number.lessThanOrEquals("foveatedMinimumScreenSpaceErrorRelaxation",e,this.maximumScreenSpaceError),this._foveatedMinimumScreenSpaceErrorRelaxation=e}},extras:{get:function(){return this._extras}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){c.A.typeOf.object("imageBasedLighting",this._imageBasedLighting),e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1)}},environmentMapManager:{get:function(){return this._environmentMapManager}},vectorClassificationOnly:{get:function(){return this._vectorClassificationOnly}},vectorKeepDecodedPositions:{get:function(){return this._vectorKeepDecodedPositions}},showCreditsOnScreen:{get:function(){return this._showCreditsOnScreen},set:function(e){this._showCreditsOnScreen=e,ke(this)}},featureIdLabel:{get:function(){return this._featureIdLabel},set:function(e){"number"==typeof e&&(e=`featureId_${e}`),c.A.typeOf.string("value",e),this._featureIdLabel=e}},instanceFeatureIdLabel:{get:function(){return this._instanceFeatureIdLabel},set:function(e){"number"==typeof e&&(e=`instanceFeatureId_${e}`),c.A.typeOf.string("value",e),this._instanceFeatureIdLabel=e}}}),pe.fromIonAssetId=async function(e,t){c.A.defined("assetId",e);const n=await T.A.fromAssetId(e);return pe.fromUrl(n,t)},pe.fromUrl=async function(e,t){c.A.defined("url",e),t=t??h.A.EMPTY_OBJECT;const n=S.A.createIfNeeded(e);let o;"json"===n.extension?o=n.getBaseUri(!0):n.isDataUri&&(o="");const r=await pe.loadJson(n),s=await async function(e,t){const n=(0,j.A)(t,"3DTILES_metadata")?t.extensions["3DTILES_metadata"]:t;let i;if((0,A.A)(n.schemaUri))e=e.getDerivedResource({url:n.schemaUri}),i=ee.A.getSchemaLoader({resource:e});else{if(!(0,A.A)(n.schema))return;i=ee.A.getSchemaLoader({schema:n.schema})}await i.load();const o=new F.A({schema:i.schema,metadataJson:n});return ee.A.unload(i),o}(n,r),a=new pe(t);a._resource=n,a._url=n.url,a._basePath=o,a._metadataExtension=s,a._geometricError=r.geometricError,a._scaledGeometricError=r.geometricError;const l=r.asset;a._asset=l,a._extras=r.extras,ke(a);const u=(0,A.A)(r.asset.gltfUpAxis)?M.A.fromName(r.asset.gltfUpAxis):M.A.Y,d=t.modelUpAxis??u,p=t.modelForwardAxis??M.A.X;a._properties=r.properties,a._extensionsUsed=r.extensionsUsed,a._extensions=r.extensions,a._modelUpAxis=d,a._modelForwardAxis=p,a._root=a.loadTileset(n,r);const f=a._root.createBoundingVolume(r.root.boundingVolume,E.A.IDENTITY).boundingSphere.center,m=a._ellipsoid.cartesianToCartographic(f);return(0,A.A)(m)&&m.height>i.A._defaultMinTerrainHeight&&(a._initialClippingPlanesOriginMatrix=P.A.eastNorthUpToFixedFrame(f)),a._clippingPlanesOriginMatrix=E.A.clone(a._initialClippingPlanesOriginMatrix),a},pe.loadJson=function(e){return S.A.createIfNeeded(e).fetchJson()},pe.prototype.makeStyleDirty=function(){this._styleEngine.makeDirty()},pe.prototype.loadTileset=function(e,t,n){const i=t.asset;if(!(0,A.A)(i))throw new I.A("Tileset must have an asset property.");if("0.0"!==i.version&&"1.0"!==i.version&&"1.1"!==i.version)throw new I.A("The tileset must be 3D Tiles version 0.0, 1.0, or 1.1");(0,A.A)(t.extensionsRequired)&&pe.checkSupportedExtensions(t.extensionsRequired);const o=this._statistics,r=i.tilesetVersion;(0,A.A)(r)&&(this._basePath+=`?v=${r}`,(e=e.clone()).setQueryParameters({v:r}));const s=fe(this,e,t.root,n);(0,A.A)(n)&&(n.children.push(s),s._depth=n._depth+1);const a=[];for(a.push(s);a.length>0;){const t=a.pop();++o.numberOfTilesTotal,this._allTilesAdditive=this._allTilesAdditive&&t.refine===V.A.ADD;const n=t._header.children;if((0,A.A)(n))for(let i=0;i<n.length;++i){const o=fe(this,e,n[i],t);t.children.push(o),o._depth=t._depth+1,a.push(o)}this._cullWithChildrenBounds&&U.A.checkChildrenWithinParent(t)}return s};const me=new s.A,ge=new a.A,_e=new E.A,ye=new s.A,ve=new s.A,Te=new s.A,be=new s.A;function we(e,t){if(t.hasEmptyContent)return;const{statistics:n}=e,i=t.contentExpired,o=t.requestContent();(0,A.A)(o)&&(o.then(i=>{!(0,A.A)(i)||t.isDestroyed()||e.isDestroyed()||(e._processingQueue.push(t),++n.numberOfTilesProcessing)}).catch(n=>{Ce(n,e,t)}),i&&(t.hasTilesetContent||t.hasImplicitContent?function(e,t){const n=t,i=Ne;for(i.push(t);i.length>0;){const o=(t=i.pop()).children;for(let e=0;e<o.length;++e)i.push(o[e]);t!==n&&(Fe(e,t),--e._statistics.numberOfTilesTotal)}n.children=[]}(e,t):(n.decrementLoadCounts(t.content),--n.numberOfTilesWithContentReady)),e._requestedTilesInFlight.push(t))}function xe(e,t){return e._priority-t._priority}function Ce(e,t,n){if(t.isDestroyed())return;let i;n.isDestroyed()||(i=n._contentResource.url);const o=(0,A.A)(e.message)?e.message:e.toString();t.tileFailed.numberOfListeners>0?t.tileFailed.raiseEvent({url:i,message:o}):(console.log(`A 3D tile failed to load: ${i}`),console.log(`Error: ${o}`),console.log(e.stack))}pe.prototype.postPassesUpdate=function(e){(0,A.A)(this._root)&&(function(e,t){const n=e._requestedTilesInFlight;let i=0;for(let e=0;e<n.length;++e){const o=n[e],r=t.frameNumber-o._touchedFrame>=1;o._contentState===B.A.LOADING?r?(o.cancelRequests(),++i):i>0&&(n[e-i]=o):++i}n.length-=i}(this,e),function(e,t){const n=e._statistics,i=e._statisticsLast,o=n.numberOfPendingRequests,r=n.numberOfTilesProcessing,s=i.numberOfPendingRequests,a=i.numberOfTilesProcessing;G.A.clone(n,i);const c=o!==s||r!==a;c&&t.afterRender.push(function(){return e.loadProgress.raiseEvent(o,r),!0}),e._tilesLoaded=0===n.numberOfPendingRequests&&0===n.numberOfTilesProcessing&&0===n.numberOfAttemptedRequests,c&&e._tilesLoaded&&(t.afterRender.push(function(){return e.allTilesLoaded.raiseEvent(),!0}),e._initialTilesLoaded||(e._initialTilesLoaded=!0,t.afterRender.push(function(){return e.initialTilesLoaded.raiseEvent(),!0})))}(this,e),this._cache.unloadTiles(this,Be),this._styleApplied&&this._styleEngine.resetDirty(),this._styleApplied=!1)},pe.prototype.prePassesUpdate=function(e){if(!(0,A.A)(this._root))return;!function(e,t){!function(e){const t=e._processingQueue;let n=0;for(let e=0;e<t.length;++e){const i=t[e];i.isDestroyed()||i._contentState!==B.A.PROCESSING?++n:n>0&&(t[e-n]=i)}t.length-=n}(e);const n=e._processingQueue,{cacheBytes:i,maximumCacheOverflowBytes:o,statistics:r}=e,s=i+o;let a=!1;for(let i=0;i<n.length;++i){if(e.totalMemoryUsageInBytes>s){a=!0;break}const o=n[i];try{o.process(e,t),o.contentReady&&(--r.numberOfTilesProcessing,e.tileLoad.raiseEvent(o))}catch(t){--r.numberOfTilesProcessing,Ce(t,e,o)}}e.totalMemoryUsageInBytes<i?function(e){e._memoryAdjustedScreenSpaceError=Math.max(e.memoryAdjustedScreenSpaceError/1.02,e.maximumScreenSpaceError)}(e):a&&n.length>0&&function(e){(0,$.A)("increase-screenSpaceError","The tiles needed to meet maximumScreenSpaceError would use more memory than allocated for this tileset.\n    The tileset will be rendered with a larger screen space error (see memoryAdjustedScreenSpaceError).\n    Consider using larger values for cacheBytes and maximumCacheOverflowBytes."),e._memoryAdjustedScreenSpaceError*=1.02;const t=e._processingQueue;for(let e=0;e<t.length;++e)t[e].updatePriority();t.sort(xe)}(e)}(this,e);const t=this._clippingPlanes;this._clippingPlanesOriginMatrixDirty=!0,(0,A.A)(t)&&t.enabled&&t.update(e);const n=this._clippingPolygons;(0,A.A)(n)&&n.enabled&&n.update(e),(0,A.A)(this._loadTimestamp)||(this._loadTimestamp=b.A.clone(e.time)),this._timeSinceLoad=Math.max(1e3*b.A.secondsDifference(e.time,this._loadTimestamp),0),this.dynamicScreenSpaceError&&function(e,t){let n,i,o,r,c;const l=t.camera,u=e._root,d=u.contentBoundingVolume;if(d instanceof re.A)n=s.A.normalize(l.positionWC,me),i=l.directionWC,o=l.positionCartographic.height,r=d.minimumHeight,c=d.maximumHeight;else{const e=E.A.inverseTransformation(u.computedTransform,_e),h=t.mapProjection.ellipsoid,A=d.boundingVolume,p=E.A.multiplyByPoint(e,A.center,ye);if(s.A.magnitude(p)>h.minimumRadius){const e=a.A.fromCartesian(p,h,ge);n=s.A.normalize(l.positionWC,me),i=l.directionWC,o=l.positionCartographic.height,r=0,c=2*e.height}else{const t=E.A.multiplyByPoint(e,l.positionWC,ve);if(n=s.A.UNIT_Z,i=E.A.multiplyByPointAsVector(e,l.directionWC,Te),i=s.A.normalize(i,i),o=t.z,d instanceof ae.A){const e=C.A.getColumn(A.halfAxes,2,be),t=s.A.magnitude(e);r=p.z-t,c=p.z+t}else if(d instanceof se.A){const e=A.radius;r=p.z-e,c=p.z+e}}}const h=r+(c-r)*e.dynamicScreenSpaceErrorHeightFalloff,A=c,p=x.A.clamp((o-h)/(A-h),0,1);let f=1-Math.abs(s.A.dot(i,n));f*=1-p,e._dynamicScreenSpaceErrorComputedDensity=e.dynamicScreenSpaceErrorDensity*f}(this,e),e.newFrame&&this._cache.reset()};const Ee=new a.A,Se=new a.A,Ie=new s.A;function Pe(e,t,n){if(!e.enableCollision||!e.show)return;const i=e._addHeightCallbacks,o=t.boundingSphere;for(const e of i){if(e.invoked||t._wasSelectedLastFrame)continue;const i=e.ellipsoid,r=a.A.clone(e.positionCartographic,Ee),c=a.A.fromCartesian(o.center,i,Se);(0,A.A)(c)&&(r.height=c.height);const l=a.A.toCartesian(r,i,Ie);s.A.distance(l,o.center)<=o.radius&&(e.invoked=!0,n.afterRender.push(()=>{(0,A.A)(e.callback)&&e.callback(),e.invoked=!1}))}}const De=new s.A,Oe={maximumFractionDigits:3};function Re(e){const t=e/1048576;return t<1?t.toLocaleString(void 0,Oe):Math.round(t).toLocaleString()}function Me(e){const{halfAxes:t,radius:n,center:i}=e.boundingVolume.boundingVolume;let o=s.A.clone(i,De);if((0,A.A)(t))o.x+=.75*(t[0]+t[3]+t[6]),o.y+=.75*(t[1]+t[4]+t[7]),o.z+=.75*(t[2]+t[5]+t[8]);else if((0,A.A)(n)){let e=s.A.normalize(i,De);e=s.A.multiplyByScalar(e,.75*n,De),o=s.A.add(e,i,De)}return o}function Le(e,t,n){let i="",o=0;if(t.debugShowGeometricError&&(i+=`\nGeometric error: ${e.geometricError}`,o++),t.debugShowRenderingStatistics&&(i+=`\nCommands: ${e.commandsLength}`,o++,e.content.pointsLength>0&&(i+=`\nPoints: ${e.content.pointsLength}`,o++),e.content.trianglesLength>0&&(i+=`\nTriangles: ${e.content.trianglesLength}`,o++),i+=`\nFeatures: ${e.content.featuresLength}`,o++),t.debugShowMemoryUsage&&(i+=`\nTexture Memory: ${Re(e.content.texturesByteLength)}`,i+=`\nGeometry Memory: ${Re(e.content.geometryByteLength)}`,o+=2),t.debugShowUrl)if(e.hasMultipleContents){i+="\nUrls:";const t=e.content.innerContentUrls;for(let e=0;e<t.length;e++)i+=`\n- ${t[e]}`;o+=t.length}else i+=`\nUrl: ${e._contentHeader.uri}`,o++;const r={text:i.substring(1),position:n,font:19-o+"px sans-serif",showBackground:!0,disableDepthTestDistance:Number.POSITIVE_INFINITY};return t._tileDebugLabels.add(r)}const Ne=[];function Be(e,t){e.tileUnload.raiseEvent(t),e._statistics.decrementLoadCounts(t.content),--e._statistics.numberOfTilesWithContentReady,t.unloadContent()}function Fe(e,t){e._cache.unloadTile(e,t,Be),t.destroy()}function Ue(e,t,n,i){if(t.mode===te.A.MORPHING)return!1;if(!(0,A.A)(e._root))return!1;const o=e._statistics;o.clear(),++e._updatedVisibilityFrame,function(e){e._heatmap.resetMinimumMaximum(),e._minimumPriority.depth=Number.MAX_VALUE,e._maximumPriority.depth=-Number.MAX_VALUE,e._minimumPriority.foveatedFactor=Number.MAX_VALUE,e._maximumPriority.foveatedFactor=-Number.MAX_VALUE,e._minimumPriority.distance=Number.MAX_VALUE,e._maximumPriority.distance=-Number.MAX_VALUE,e._minimumPriority.reverseScreenSpaceError=Number.MAX_VALUE,e._maximumPriority.reverseScreenSpaceError=-Number.MAX_VALUE}(e),function(e,t){t.frameNumber===e._updatedModelMatrixFrame&&(0,A.A)(e._previousModelMatrix)||(e._updatedModelMatrixFrame=t.frameNumber,e._modelMatrixChanged=!E.A.equals(e.modelMatrix,e._previousModelMatrix),e._modelMatrixChanged&&(e._previousModelMatrix=E.A.clone(e.modelMatrix,e._previousModelMatrix)))}(e,t),e._cullRequestsWhileMoving=e.cullRequestsWhileMoving&&!e._modelMatrixChanged;const s=e.getTraversal(i).selectTiles(e,t);if(i.requestTiles&&function(e){const t=e._requestedTiles;t.sort(xe);for(let n=0;n<t.length;++n)we(e,t[n])}(e),function(e,t,n){e._styleEngine.applyStyle(e),e._styleApplied=!0;const{commandList:i,context:o}=t,s=i.length,a=e._selectedTiles,c=e.isSkippingLevelOfDetail&&e._hasMixedContent&&o.stencilBuffer&&a.length>0;e._backfaceCommands.length=0,c&&((0,A.A)(e._stencilClearCommand)||(e._stencilClearCommand=new D.A({stencil:0,pass:O.A.CESIUM_3D_TILE,renderState:R.A.fromCache({stencilMask:oe.A.SKIP_LOD_MASK})})),i.push(e._stencilClearCommand));const{statistics:l,tileVisible:u}=e,d=n.isRender,h=i.length;for(let i=0;i<a.length;++i){const o=a[i];d&&u.raiseEvent(o),Pe(e,o,t),o.update(e,t,n),l.incrementSelectionCounts(o.content),++l.selected}const p=e._emptyTiles;for(let i=0;i<p.length;++i)p[i].update(e,t,n);let f=i.length-h;if(e._backfaceCommands.trim(),c){const t=e._backfaceCommands.values,n=t.length;i.length+=n;for(let e=f-1;e>=0;--e)i[h+n+e]=i[h+e];for(let e=0;e<n;++e)i[h+e]=t[e]}f=i.length-s,l.numberOfCommands=f,d&&(e.pointCloudShading.attenuation&&e.pointCloudShading.eyeDomeLighting&&f>0&&e._pointCloudEyeDomeLighting.update(t,s,e.pointCloudShading,e.boundingSphere),e.debugShowGeometricError||e.debugShowRenderingStatistics||e.debugShowMemoryUsage||e.debugShowUrl?((0,A.A)(e._tileDebugLabels)||(e._tileDebugLabels=new K.A),function(e,t){const n=e._selectedTiles,i=n.length,o=e._emptyTiles,s=o.length;if(e._tileDebugLabels.removeAll(),e.debugPickedTileLabelOnly){if((0,A.A)(e.debugPickedTile)){const t=(0,A.A)(e.debugPickPosition)?e.debugPickPosition:Me(e.debugPickedTile);Le(e.debugPickedTile,e,t).pixelOffset=new r.A(15,-15)}}else{for(let t=0;t<i;++t){const i=n[t];Le(i,e,Me(i))}for(let t=0;t<s;++t){const n=o[t];(n.hasTilesetContent||n.hasImplicitContent)&&Le(n,e,Me(n))}}e._tileDebugLabels.update(t)}(e,t)):e._tileDebugLabels=e._tileDebugLabels&&e._tileDebugLabels.destroy())}(e,t,i),G.A.clone(o,n),i.isRender){const n=e._credits;if((0,A.A)(n)&&0!==o.selected)for(let e=0;e<n.length;++e){const i=n[e];t.creditDisplay.addCreditToNextFrame(i)}}return s}function ke(e){let t=e._credits;(0,A.A)(t)||(t=[]),t.length=0,(0,A.A)(e.resource.credits)&&e.resource.credits.forEach(e=>{t.push(d.A.clone(e))});const n=e.asset.extras;if((0,A.A)(n)&&(0,A.A)(n.cesium)&&(0,A.A)(n.cesium.credits)){const e=n.cesium.credits;for(let n=0;n<e.length;++n){const i=e[n];t.push(new d.A(i.html))}}t.forEach(t=>t.showOnScreen=t.showOnScreen||e._showCreditsOnScreen),e._credits=t}pe.prototype.trimLoadedTiles=function(){this._cache.trim()},pe.prototype.getTraversal=function(e){const{pass:t}=e;return t===k.A.MOST_DETAILED_PRELOAD||t===k.A.MOST_DETAILED_PICK?ce.A:this.isSkippingLevelOfDetail?ue.A:le.A},pe.prototype.update=function(e){this.updateForPass(e,e.tilesetPassState)},pe.prototype.updateForPass=function(e,t){c.A.typeOf.object("frameState",e),c.A.typeOf.object("tilesetPassState",t),this.imageryLayers._update();const n=t.pass;if(n===k.A.PRELOAD&&(!this.preloadWhenHidden||this.show)||n===k.A.PRELOAD_FLIGHT&&(!this.preloadFlightDestinations||!this.show&&!this.preloadWhenHidden)||n===k.A.REQUEST_RENDER_MODE_DEFER_CHECK&&(!this._cullRequestsWhileMoving&&this.foveatedTimeDelay<=0||!this.show))return;const i=e.commandList,o=e.camera,r=e.cullingVolume;t.ready=!1;const s=k.A.getPassOptions(n),a=s.ignoreCommands,l=t.commandList??i,u=l.length;if(e.commandList=l,e.camera=t.camera??o,e.cullingVolume=t.cullingVolume??r,s.isRender){const t=this._environmentMapManager;(0,A.A)(this._root)&&(t.position=this.boundingSphere.center),t.update(e)}const d=this._clippingPolygons;(0,A.A)(d)&&d.enabled&&d.queueCommands(e);const h=this._statisticsPerPass[n];(this.show||a)&&(this._pass=n,t.ready=Ue(this,e,h,s)),a&&(l.length=u),e.commandList=i,e.camera=o,e.cullingVolume=r},pe.prototype.hasExtension=function(e){return!!(0,A.A)(this._extensionsUsed)&&this._extensionsUsed.indexOf(e)>-1},pe.prototype.isDestroyed=function(){return!1},pe.prototype.destroy=function(){if(this._tileDebugLabels=this._tileDebugLabels&&this._tileDebugLabels.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),this._clippingPolygons=this._clippingPolygons&&this._clippingPolygons.destroy(),(0,A.A)(this._root)){const e=Ne;for(e.push(this._root);e.length>0;){const t=e.pop();t.destroy();const n=t.children;for(let t=0;t<n.length;++t)e.push(n[t])}}return this._root=void 0,this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,this._environmentMapManager.isDestroyed()||this._environmentMapManager.destroy(),this._environmentMapManager=void 0,this._imageryLayers.isDestroyed()||(this.imageryLayers.layerAdded.removeEventListener(this._imageryLayersListener),this.imageryLayers.layerRemoved.removeEventListener(this._imageryLayersListener),this.imageryLayers.layerMoved.removeEventListener(this._imageryLayersListener),this.imageryLayers.layerShownOrHidden.removeEventListener(this._imageryLayersListener),this._imageryLayers.destroy()),this._imageryLayers=void 0,(0,f.A)(this)},pe.supportedExtensions={"3DTILES_metadata":!0,"3DTILES_implicit_tiling":!0,"3DTILES_content_gltf":!0,"3DTILES_multiple_contents":!0,"3DTILES_bounding_volume_S2":!0,"3DTILES_batch_table_hierarchy":!0,"3DTILES_draco_point_compression":!0,MAXAR_content_geojson:!0},pe.checkSupportedExtensions=function(e){for(let t=0;t<e.length;t++)if(!pe.supportedExtensions[e[t]])throw new I.A(`Unsupported 3D Tiles Extension: ${e[t]}`)};const Ve=new de.A,ze=new s.A,He=new a.A;pe.prototype.getHeight=function(e,t){c.A.typeOf.object("cartographic",e),c.A.typeOf.object("scene",t);let n=t.ellipsoid;(0,A.A)(n)||(n=m.A.WGS84);const i=Ve,o=n.cartographicToCartesian(e,i.direction);s.A.normalize(i.direction,i.direction),i.direction=s.A.normalize(o,i.direction),i.direction=s.A.negate(o,i.direction),i.origin=s.A.multiplyByScalar(i.direction,-2*n.maximumRadius,i.origin);const r=this.pick(i,t.frameState,ze);if((0,A.A)(r))return n.cartesianToCartographic(r,He)?.height},pe.prototype.updateHeight=function(e,t,n){const i={positionCartographic:e,ellipsoid:n=n??m.A.WGS84,callback:t,invoked:!1};return this._addHeightCallbacks.push(i),()=>{const e=this._addHeightCallbacks,t=e.length;for(let n=0;n<t;++n)if(e[n]===i){e.splice(n,1);break}i.callback&&(i.callback=void 0)}};const Ge=new y.A,We=new s.A;pe.prototype.pick=function(e,t,n){if(!t.context.webgl2&&!this._enablePick)return;const i=this._selectedTiles,r=i.length,a=[];for(let t=0;t<r;++t){const n=i[t],o=v.A.raySphere(e,n.contentBoundingVolume.boundingSphere,Ge);(0,A.A)(o)&&(0,A.A)(n.content)&&a.push(n)}const c=a.length;let l;a.sort((t,n)=>o.A.distanceSquaredTo(t.contentBoundingVolume.boundingSphere,e.origin)-o.A.distanceSquaredTo(n.contentBoundingVolume.boundingSphere,e.origin));for(let i=0;i<c;++i){const o=a[i].content.pick(e,t,We);if((0,A.A)(o))return l=s.A.clone(o,n),l}},pe.prototype.isGltfExtensionUsed=function(e){if(this.hasExtension("3DTILES_content_gltf")){if(!(0,A.A)(this.extensions))return!1;const t=this.extensions["3DTILES_content_gltf"]?.extensionsUsed;return!!(0,A.A)(t)&&t.indexOf(e)>-1}return!1},pe.prototype.isGltfExtensionRequired=function(e){if(this.isGltfExtensionUsed(e)){const t=this.extensions["3DTILES_content_gltf"].extensionsRequired;return!!(0,A.A)(t)&&t.indexOf(e)>-1}return!1};const Ye=pe},329554:(e,t,n)=>{"use strict";n.d(t,{A:()=>A});var i=n(491446),o=n(981757),r=n(661314),s=n(727541);function a(){}const c={stack:new o.A,stackMaximumLength:0},l={stack:new o.A,stackMaximumLength:0};function u(e,t){e.contentAvailable&&s.A.selectTile(e,t)}function d(e,t,n){const i=e.refine===r.A.REPLACE,{tileset:o,children:a}=e,{updateTile:c,loadTile:l,touchTile:u}=s.A;for(let e=0;e<a.length;++e)c(a[e],n);a.sort(s.A.sortChildrenByDistanceToCamera);const d=i&&e.hasRenderableContent;let A=!0,p=!1,f=-1,m=Number.MAX_VALUE;for(let e=0;e<a.length;++e){const i=a[e];if(i.isVisible?(t.push(i),i._foveatedFactor<m&&(f=e,m=i._foveatedFactor),p=!0):(d||o.loadSiblings)&&(i._foveatedFactor<m&&(f=e,m=i._foveatedFactor),l(i,n),u(i,n)),d){let e;e=!!i._inRequestVolume&&(i.hasRenderableContent?i.contentAvailable:h(i,n)),A=A&&e}}if(p||(A=!1),-1!==f&&i){const t=a[f];t._wasMinPriorityChild=!0;const n=(e._wasMinPriorityChild||e===o.root)&&m<=e._priorityHolder._foveatedFactor?e._priorityHolder:e;n._foveatedFactor=Math.min(t._foveatedFactor,n._foveatedFactor),n._distanceToCamera=Math.min(t._distanceToCamera,n._distanceToCamera);for(let e=0;e<a.length;++e)a[e]._priorityHolder=n}return A}function h(e,t){const{canTraverse:n,updateTile:i,loadTile:o,touchTile:r}=s.A;let a=!0;const c=l.stack;for(c.push(e);c.length>0;){l.stackMaximumLength=Math.max(l.stackMaximumLength,c.length);const e=c.pop(),s=e.children,u=s.length,d=!e.hasRenderableContent&&n(e);if(d||e.contentAvailable||(a=!1),i(e,t),e.isVisible||(o(e,t),r(e,t)),d)for(let e=0;e<u;++e){const t=s[e];c.push(t)}}return e.hasEmptyContent||a}a.selectTiles=function(e,t){if(e._requestedTiles.length=0,e.debugFreezeFrame)return;e._selectedTiles.length=0,e._selectedTilesToStyle.length=0,e._emptyTiles.length=0,e.hasMixedContent=!1;const n=e.root;if(s.A.updateTile(n,t),!n.isVisible)return;if(n.getScreenSpaceError(t,!0)<=e.memoryAdjustedScreenSpaceError)return;!function(e,t){const{tileset:n}=e,{canTraverse:o,loadTile:a,visitTile:l,touchTile:h}=s.A,A=c.stack;for(A.push(e);A.length>0;){c.stackMaximumLength=Math.max(c.stackMaximumLength,A.length);const e=A.pop(),s=e.parent,p=!(0,i.A)(s)||s._refines;e._refines=!!o(e)&&d(e,A,t)&&p;const f=!e._refines&&p;e.hasRenderableContent?e.refine===r.A.ADD?(u(e,t),a(e,t)):e.refine===r.A.REPLACE&&(a(e,t),f&&u(e,t)):(n._emptyTiles.push(e),a(e,t),f&&u(e,t)),l(e,t),h(e,t)}}(n,t),c.stack.trim(c.stackMaximumLength),l.stack.trim(l.stackMaximumLength);const o=e._requestedTiles;for(let e=0;e<o.length;++e)o[e].updatePriority()};const A=a},648117:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(491446),o=n(606707);function r(){this._list=new o.A,this._sentinel=this._list.add(),this._trimTiles=!1}r.prototype.reset=function(){this._list.splice(this._list.tail,this._sentinel)},r.prototype.touch=function(e){const t=e.cacheNode;(0,i.A)(t)&&this._list.splice(this._sentinel,t)},r.prototype.add=function(e){(0,i.A)(e.cacheNode)||(e.cacheNode=this._list.add(e))},r.prototype.unloadTile=function(e,t,n){const o=t.cacheNode;(0,i.A)(o)&&(this._list.remove(o),t.cacheNode=void 0,n(e,t))},r.prototype.unloadTiles=function(e,t){const n=this._trimTiles;this._trimTiles=!1;const i=this._list,o=this._sentinel;let r=i.head;for(;r!==o&&(e.totalMemoryUsageInBytes>e.cacheBytes||n);){const n=r.item;r=r.next,this.unloadTile(e,n,t)}},r.prototype.trim=function(){this._trimTiles=!0};const s=r},529755:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(41476),o=n(491446),r=n(591978),s=n(367817);function a(e){this.tilePropertyName=e,this._minimum=Number.MAX_VALUE,this._maximum=-Number.MAX_VALUE,this._previousMinimum=Number.MAX_VALUE,this._previousMaximum=-Number.MAX_VALUE,this._referenceMinimum={},this._referenceMaximum={}}function c(e,t){let n;return n="_loadTimestamp"===t?r.A.toDate(e).getTime():e,n}a.prototype.setReferenceMinimumMaximum=function(e,t,n){this._referenceMinimum[n]=c(e,n),this._referenceMaximum[n]=c(t,n)};const l=[new i.A(.1,.1,.1,1),new i.A(.153,.278,.878,1),new i.A(.827,.231,.49,1),new i.A(.827,.188,.22,1),new i.A(1,.592,.259,1),new i.A(1,.843,0,1)];a.prototype.colorize=function(e,t){const n=this.tilePropertyName;if(!(0,o.A)(n)||!e.contentAvailable||e._selectedFrame!==t.frameNumber)return;const r=function(e,t){const n=e.tilePropertyName;if((0,o.A)(n)){const i=c(t[n],n);return(0,o.A)(i)?(e._maximum=Math.max(i,e._maximum),e._minimum=Math.min(i,e._minimum),i):(e.tilePropertyName=void 0,i)}}(this,e),a=this._previousMinimum,u=this._previousMaximum;if(a===Number.MAX_VALUE||u===-Number.MAX_VALUE)return;const d=u-a+s.A.EPSILON7,h=s.A.clamp(r-a,0,d)/d*(l.length-1),A=Math.floor(h),p=Math.ceil(h),f=h-A,m=l[A],g=l[p],_=i.A.clone(i.A.WHITE);_.red=s.A.lerp(m.red,g.red,f),_.green=s.A.lerp(m.green,g.green,f),_.blue=s.A.lerp(m.blue,g.blue,f),e._debugColor=_},a.prototype.resetMinimumMaximum=function(){const e=this.tilePropertyName;if((0,o.A)(e)){const t=this._referenceMinimum[e],n=this._referenceMaximum[e],i=(0,o.A)(t)&&(0,o.A)(n);this._previousMinimum=i?t:this._minimum,this._previousMaximum=i?n:this._maximum,this._minimum=Number.MAX_VALUE,this._maximum=-Number.MAX_VALUE}};const u=a},979830:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(369031),o=n(915325),r=n(491446),s=n(834298),a=n(751069);function c(e){const t=(e=e??o.A.EMPTY_OBJECT).metadataJson,n=e.schema;i.A.typeOf.object("options.metadataJson",t),i.A.typeOf.object("options.schema",n);const c=t.metadata??t.tileset;let l;(0,r.A)(c)&&(l=new a.A({tileset:c,class:n.classes[c.class]}));let u=[];const d=[],h=t.groups;if(Array.isArray(h)){const e=h.length;for(let t=0;t<e;t++){const e=h[t];d.push(new s.A({group:e,class:n.classes[e.class]}))}}else if((0,r.A)(h)){u=Object.keys(h).sort();const e=u.length;for(let t=0;t<e;t++){const e=u[t];if(h.hasOwnProperty(e)){const t=h[e];d.push(new s.A({id:e,group:h[e],class:n.classes[t.class]}))}}}this._schema=n,this._groups=d,this._groupIds=u,this._tileset=l,this._statistics=t.statistics,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(c.prototype,{schema:{get:function(){return this._schema}},groups:{get:function(){return this._groups}},groupIds:{get:function(){return this._groupIds}},tileset:{get:function(){return this._tileset}},statistics:{get:function(){return this._statistics}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});const l=c},741740:(e,t,n)=>{"use strict";n.d(t,{A:()=>A});var i=n(647326),o=n(981757),r=n(661314),s=n(727541);function a(){}const c={stack:new o.A,stackMaximumLength:0};function l(e){return 0!==e.children.length&&(e.hasTilesetContent||e.hasImplicitContent?!e.contentExpired:(e.hasEmptyContent,!0))}function u(e,t,n){const{children:i}=e;for(let e=0;e<i.length;++e){const o=i[e];o.updateVisibility(n),o.isVisible&&t.push(o)}}function d(e,t){(t.hasUnloadedRenderableContent||t.contentExpired)&&(t._priority=0,e._requestedTiles.push(t))}function h(e,t){e.contentAvailable&&e.contentVisibility(t)!==i.A.OUTSIDE&&e.tileset._selectedTiles.push(e)}a.selectTiles=function(e,t){e._selectedTiles.length=0,e._requestedTiles.length=0,e.hasMixedContent=!1;let n=!0;const i=e.root;if(i.updateVisibility(t),!i.isVisible)return n;const{touchTile:o,visitTile:a}=s.A,A=c.stack;for(A.push(i);A.length>0;){c.stackMaximumLength=Math.max(c.stackMaximumLength,A.length);const i=A.pop(),s=i.refine===r.A.ADD,p=i.refine===r.A.REPLACE,f=l(i);f&&u(i,A,t),(s||p&&!f)&&(d(e,i),o(i,t),h(i,t),i.hasRenderableContent&&!i.contentAvailable&&(n=!1)),a(i,t)}return c.stack.trim(c.stackMaximumLength),n};const A=a},724812:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var i=n(491446),o=n(981757),r=n(661314),s=n(727541);function a(){}const c={stack:new o.A,stackMaximumLength:0},l={stack:new o.A,stackMaximumLength:0},u={stack:new o.A,stackMaximumLength:0,ancestorStack:new o.A,ancestorStackMaximumLength:0};function d(e,t){const n=e.contentAvailable?e:e._ancestorWithContentAvailable;(0,i.A)(n)?n._shouldSelect=!0:function(e,t){const{updateTile:n,touchTile:i,selectTile:o}=s.A,r=l.stack;for(r.push(e);r.length>0;){l.stackMaximumLength=Math.max(l.stackMaximumLength,r.length);const s=r.pop().children;for(let a=0;a<s.length;++a){const c=s[a];c.isVisible&&(c.contentAvailable?(n(c,t),i(c,t),o(c,t)):c._depth-e._depth<2&&r.push(c))}}}(e,t)}function h(e,t){e._ancestorWithContent=void 0,e._ancestorWithContentAvailable=void 0;const{parent:n}=e;if(!(0,i.A)(n))return;const o=!n.hasUnloadedRenderableContent||n._requestedFrame===t.frameNumber;e._ancestorWithContent=o?n:n._ancestorWithContent,e._ancestorWithContentAvailable=n.contentAvailable?n:n._ancestorWithContentAvailable}function A(e,t){const n=t._ancestorWithContent;return!e.immediatelyLoadDesiredLevelOfDetail&&(t._priorityProgressiveResolutionScreenSpaceErrorLeaf||(0,i.A)(n)&&t._screenSpaceError<n._screenSpaceError/e.skipScreenSpaceErrorFactor&&t._depth>n._depth+e.skipLevels)}function p(e,t,n){const{tileset:i,children:o}=e,{updateTile:r,loadTile:a,touchTile:c}=s.A;for(let e=0;e<o.length;++e)r(o[e],n);o.sort(s.A.sortChildrenByDistanceToCamera);let l=!1;for(let e=0;e<o.length;++e){const r=o[e];r.isVisible?(t.push(r),l=!0):i.loadSiblings&&(a(r,n),c(r,n))}return l}function f(e,t){const{tileset:n}=e;return!n.immediatelyLoadDesiredLevelOfDetail&&(!(0,i.A)(e._ancestorWithContent)||(0===e._screenSpaceError?e.parent._screenSpaceError>t:e._screenSpaceError>t))}a.selectTiles=function(e,t){if(e._requestedTiles.length=0,e.debugFreezeFrame)return;e._selectedTiles.length=0,e._selectedTilesToStyle.length=0,e._emptyTiles.length=0,e.hasMixedContent=!1;const n=e.root;if(s.A.updateTile(n,t),!n.isVisible)return;if(n.getScreenSpaceError(t,!0)<=e.memoryAdjustedScreenSpaceError)return;!function(e,t){const{tileset:n}=e,o=n.immediatelyLoadDesiredLevelOfDetail?Number.MAX_VALUE:Math.max(n.baseScreenSpaceError,n.memoryAdjustedScreenSpaceError),{canTraverse:a,loadTile:l,visitTile:u,touchTile:m}=s.A,g=c.stack;for(g.push(e);g.length>0;){c.stackMaximumLength=Math.max(c.stackMaximumLength,g.length);const e=g.pop();h(e,t);const s=e.parent,_=!(0,i.A)(s)||s._refines;e._refines=!!a(e)&&p(e,g,t)&&_;const y=!e._refines&&_;e.hasRenderableContent?e.refine===r.A.ADD?(d(e,t),l(e,t)):e.refine===r.A.REPLACE&&(f(e,o)?(l(e,t),y&&d(e,t)):y?(d(e,t),l(e,t)):A(n,e)&&l(e,t)):(n._emptyTiles.push(e),l(e,t),y&&d(e,t)),u(e,t),m(e,t)}}(n,t),function(e,t){const{selectTile:n,canTraverse:o}=s.A,{stack:a,ancestorStack:c}=u;let l;for(a.push(e);a.length>0||c.length>0;){if(u.stackMaximumLength=Math.max(u.stackMaximumLength,a.length),u.ancestorStackMaximumLength=Math.max(u.ancestorStackMaximumLength,c.length),c.length>0){const e=c.peek();if(e._stackLength===a.length){c.pop(),e!==l&&(e._finalResolution=!1),n(e,t);continue}}const e=a.pop();if(!(0,i.A)(e))continue;const s=o(e);if(e._shouldSelect)if(e.refine===r.A.ADD)n(e,t);else{if(e._selectionDepth=c.length,e._selectionDepth>0&&(e.tileset.hasMixedContent=!0),l=e,!s){n(e,t);continue}c.push(e),e._stackLength=a.length}if(s){const t=e.children;for(let e=0;e<t.length;++e){const n=t[e];n.isVisible&&a.push(n)}}}}(n,t),c.stack.trim(c.stackMaximumLength),l.stack.trim(l.stackMaximumLength),u.stack.trim(u.stackMaximumLength),u.ancestorStack.trim(u.ancestorStackMaximumLength);const o=e._requestedTiles;for(let e=0;e<o.length;++e)o[e].updatePriority()};const m=a},485760:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(491446),o=n(224975);function r(){this.selected=0,this.visited=0,this.numberOfCommands=0,this.numberOfAttemptedRequests=0,this.numberOfPendingRequests=0,this.numberOfTilesProcessing=0,this.numberOfTilesWithContentReady=0,this.numberOfTilesTotal=0,this.numberOfLoadedTilesTotal=0,this.numberOfFeaturesSelected=0,this.numberOfFeaturesLoaded=0,this.numberOfPointsSelected=0,this.numberOfPointsLoaded=0,this.numberOfTrianglesSelected=0,this.numberOfTilesStyled=0,this.numberOfFeaturesStyled=0,this.numberOfTilesCulledWithChildrenUnion=0,this.geometryByteLength=0,this.texturesByteLength=0,this.texturesReferenceCounterById={},this.batchTableByteLength=0}r.prototype.clear=function(){this.selected=0,this.visited=0,this.numberOfCommands=0,this.numberOfAttemptedRequests=0,this.numberOfFeaturesSelected=0,this.numberOfPointsSelected=0,this.numberOfTrianglesSelected=0,this.numberOfTilesStyled=0,this.numberOfFeaturesStyled=0,this.numberOfTilesCulledWithChildrenUnion=0},r.prototype.incrementSelectionCounts=function(e){this.numberOfFeaturesSelected+=e.featuresLength,this.numberOfPointsSelected+=e.pointsLength,this.numberOfTrianglesSelected+=e.trianglesLength;const t=e.innerContents;if((0,i.A)(t)){const e=t.length;for(let n=0;n<e;++n)this.incrementSelectionCounts(t[n])}},r.prototype.incrementLoadCounts=function(e){if(this.numberOfFeaturesLoaded+=e.featuresLength,this.numberOfPointsLoaded+=e.pointsLength,this.geometryByteLength+=e.geometryByteLength,this.batchTableByteLength+=e.batchTableByteLength,e instanceof o.A){const t=e.getTextureIds();for(const n of t){const t=this.texturesReferenceCounterById[n]??0;if(0===t){const t=e.getTextureByteLengthById(n);this.texturesByteLength+=t}this.texturesReferenceCounterById[n]=t+1}}else this.texturesByteLength+=e.texturesByteLength;const t=e.innerContents;if((0,i.A)(t)){const e=t.length;for(let n=0;n<e;++n)this.incrementLoadCounts(t[n])}},r.prototype.decrementLoadCounts=function(e){if(this.numberOfFeaturesLoaded-=e.featuresLength,this.numberOfPointsLoaded-=e.pointsLength,this.geometryByteLength-=e.geometryByteLength,this.batchTableByteLength-=e.batchTableByteLength,e instanceof o.A){const t=e.getTextureIds();for(const n of t){const t=this.texturesReferenceCounterById[n];if(1===t){delete this.texturesReferenceCounterById[n];const t=e.getTextureByteLengthById(n);this.texturesByteLength-=t}else this.texturesReferenceCounterById[n]=t-1}}else this.texturesByteLength-=e.texturesByteLength;const t=e.innerContents;if((0,i.A)(t)){const e=t.length;for(let n=0;n<e;++n)this.decrementLoadCounts(t[n])}},r.clone=function(e,t){t.selected=e.selected,t.visited=e.visited,t.numberOfCommands=e.numberOfCommands,t.numberOfAttemptedRequests=e.numberOfAttemptedRequests,t.numberOfPendingRequests=e.numberOfPendingRequests,t.numberOfTilesProcessing=e.numberOfTilesProcessing,t.numberOfTilesWithContentReady=e.numberOfTilesWithContentReady,t.numberOfTilesTotal=e.numberOfTilesTotal,t.numberOfFeaturesSelected=e.numberOfFeaturesSelected,t.numberOfFeaturesLoaded=e.numberOfFeaturesLoaded,t.numberOfPointsSelected=e.numberOfPointsSelected,t.numberOfPointsLoaded=e.numberOfPointsLoaded,t.numberOfTrianglesSelected=e.numberOfTrianglesSelected,t.numberOfTilesStyled=e.numberOfTilesStyled,t.numberOfFeaturesStyled=e.numberOfFeaturesStyled,t.numberOfTilesCulledWithChildrenUnion=e.numberOfTilesCulledWithChildrenUnion,t.geometryByteLength=e.geometryByteLength,t.texturesByteLength=e.texturesByteLength,t.texturesReferenceCounterById={...e.texturesReferenceCounterById},t.batchTableByteLength=e.batchTableByteLength};const s=r},727541:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(491446),o=n(605971),r=n(647326),s=n(45679),a=n(661314);function c(){}function l(e,t){if(e.updateVisibility(t),!e.isVisible)return;const n=e.children.length>0;if((e.hasTilesetContent||e.hasImplicitContent)&&n){const n=e.children[0];return l(n,t),void(e._visible=n._visible)}if(function(e,t){const{parent:n,tileset:o}=e;return!(!(0,i.A)(n)||n.hasTilesetContent||n.hasImplicitContent||n.refine!==a.A.ADD)&&e.getScreenSpaceError(t,!0)<=o.memoryAdjustedScreenSpaceError}(e,t))return void(e._visible=!1);const o=e.refine===a.A.REPLACE,r=e._optimChildrenWithinParent===s.A.USE_OPTIMIZATION;return o&&r&&n&&!function(e,t){let n=!1;const i=e.children;for(let e=0;e<i.length;++e){const o=i[e];o.updateVisibility(t),n=n||o.isVisible}return n}(e,t)?(++e.tileset._statistics.numberOfTilesCulledWithChildrenUnion,void(e._visible=!1)):void 0}c.selectTiles=function(e,t){o.A.throwInstantiationError()},c.sortChildrenByDistanceToCamera=function(e,t){return 0===t._distanceToCamera&&0===e._distanceToCamera?t._centerZDepth-e._centerZDepth:t._distanceToCamera-e._distanceToCamera},c.canTraverse=function(e){return 0!==e.children.length&&(e.hasTilesetContent||e.hasImplicitContent?!e.contentExpired:e._screenSpaceError>e.tileset.memoryAdjustedScreenSpaceError)},c.selectTile=function(e,t){if(e.contentVisibility(t)===r.A.OUTSIDE)return;e._wasSelectedLastFrame=!0;const{content:n,tileset:i}=e;n.featurePropertiesDirty?(n.featurePropertiesDirty=!1,e.lastStyleTime=0,i._selectedTilesToStyle.push(e)):e._selectedFrame<t.frameNumber-1&&(i._selectedTilesToStyle.push(e),e._wasSelectedLastFrame=!1),e._selectedFrame=t.frameNumber,i._selectedTiles.push(e)},c.visitTile=function(e,t){++e.tileset._statistics.visited,e._visitedFrame=t.frameNumber},c.touchTile=function(e,t){e._touchedFrame!==t.frameNumber&&(e.tileset._cache.touch(e),e._touchedFrame=t.frameNumber)},c.loadTile=function(e,t){const{tileset:n}=e;if(e._requestedFrame===t.frameNumber||!e.hasUnloadedRenderableContent&&!e.contentExpired)return;if(!function(e,t){const{tileset:n}=e;if(!n._cullRequestsWhileMoving)return!0;const{positionWCDeltaMagnitude:i,positionWCDeltaMagnitudeLastFrame:o}=t.camera,r=0!==i?i:o,s=Math.max(2*e.boundingSphere.radius,1);return n.cullRequestsWhileMovingMultiplier*r/s<1}(e,t))return;const i=t.camera.timeSinceMoved<n.foveatedTimeDelay;e.priorityDeferred&&i||(e._requestedFrame=t.frameNumber,n._requestedTiles.push(e))},c.updateTile=function(e,t){l(e,t),e.updateExpiration(),e._wasMinPriorityChild=!1,e._priorityHolder=e,function(e){const t=e.tileset._minimumPriority,n=e.tileset._maximumPriority,i=e._priorityHolder;n.distance=Math.max(i._distanceToCamera,n.distance),t.distance=Math.min(i._distanceToCamera,t.distance),n.depth=Math.max(e._depth,n.depth),t.depth=Math.min(e._depth,t.depth),n.foveatedFactor=Math.max(i._foveatedFactor,n.foveatedFactor),t.foveatedFactor=Math.min(i._foveatedFactor,t.foveatedFactor),n.reverseScreenSpaceError=Math.max(e._priorityReverseScreenSpaceError,n.reverseScreenSpaceError),t.reverseScreenSpaceError=Math.min(e._priorityReverseScreenSpaceError,t.reverseScreenSpaceError)}(e),e._shouldSelect=!1,e._finalResolution=!0};const u=c},23708:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(267980),o=n(369031),r=n(491446);function s(e,t){o.A.typeOf.object("normal",e),o.A.typeOf.number("distance",t),this._distance=t,this._normal=new a(e,this),this.onChangeCallback=void 0,this.index=-1}function a(e,t){this._clippingPlane=t,this._cartesian3=i.A.clone(e)}Object.defineProperties(s.prototype,{distance:{get:function(){return this._distance},set:function(e){o.A.typeOf.number("value",e),(0,r.A)(this.onChangeCallback)&&e!==this._distance&&this.onChangeCallback(this.index),this._distance=e}},normal:{get:function(){return this._normal},set:function(e){o.A.typeOf.object("value",e),(0,r.A)(this.onChangeCallback)&&!i.A.equals(this._normal._cartesian3,e)&&this.onChangeCallback(this.index),i.A.clone(e,this._normal._cartesian3)}}}),s.fromPlane=function(e,t){return o.A.typeOf.object("plane",e),(0,r.A)(t)?(t.normal=e.normal,t.distance=e.distance):t=new s(e.normal,e.distance),t},s.clone=function(e,t){return(0,r.A)(t)?(t.normal=e.normal,t.distance=e.distance,t):new s(e.normal,e.distance)},Object.defineProperties(a.prototype,{x:{get:function(){return this._cartesian3.x},set:function(e){o.A.typeOf.number("value",e),(0,r.A)(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.x&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.x=e}},y:{get:function(){return this._cartesian3.y},set:function(e){o.A.typeOf.number("value",e),(0,r.A)(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.y&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.y=e}},z:{get:function(){return this._cartesian3.z},set:function(e){o.A.typeOf.number("value",e),(0,r.A)(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.z&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.z=e}}});const c=s},711284:(e,t,n)=>{"use strict";n.d(t,{A:()=>B});var i=n(961645),o=n(434067),r=n(267980),s=n(626809),a=n(369031),c=n(41476),l=n(915325),u=n(491446),d=n(677354),h=n(605971),A=n(955943),p=n(647326),f=n(584164),m=n(276904),g=n(257941),_=n(430332),y=n(57775),v=n(654799),T=n(616e3),b=n(23708);function w(e){e=e??l.A.EMPTY_OBJECT,this._planes=[],this._dirtyIndex=-1,this._multipleDirtyPlanes=!1,this._enabled=e.enabled??!0,this.modelMatrix=f.A.clone(e.modelMatrix??f.A.IDENTITY),this.edgeColor=c.A.clone(e.edgeColor??c.A.WHITE),this.edgeWidth=e.edgeWidth??0,this.planeAdded=new A.A,this.planeRemoved=new A.A,this._owner=void 0;const t=e.unionClippingRegions??!1;this._unionClippingRegions=t,this._testIntersection=t?x:C,this._uint8View=void 0,this._float32View=void 0,this._clippingPlanesTexture=void 0;const n=e.planes;if((0,u.A)(n)){const e=n.length;for(let t=0;t<e;++t)this.add(n[t])}}function x(e){return e===p.A.OUTSIDE}function C(e){return e===p.A.INSIDE}function E(e,t){e._multipleDirtyPlanes=e._multipleDirtyPlanes||-1!==e._dirtyIndex&&e._dirtyIndex!==t,e._dirtyIndex=t}function S(e,t){const n=e.length;for(let i=0;i<n;++i)if(g.A.equals(e[i],t))return i;return-1}Object.defineProperties(w.prototype,{length:{get:function(){return this._planes.length}},unionClippingRegions:{get:function(){return this._unionClippingRegions},set:function(e){this._unionClippingRegions!==e&&(this._unionClippingRegions=e,this._testIntersection=e?x:C)}},enabled:{get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e)}},texture:{get:function(){return this._clippingPlanesTexture}},owner:{get:function(){return this._owner}},clippingPlanesState:{get:function(){return this._unionClippingRegions?this._planes.length:-this._planes.length}}}),w.prototype.add=function(e){const t=this._planes.length,n=this;e.onChangeCallback=function(e){E(n,e)},e.index=t,E(this,t),this._planes.push(e),this.planeAdded.raiseEvent(e,t)},w.prototype.get=function(e){return a.A.typeOf.number("index",e),this._planes[e]},w.prototype.contains=function(e){return-1!==S(this._planes,e)},w.prototype.remove=function(e){const t=this._planes,n=S(t,e);if(-1===n)return!1;e instanceof b.A&&(e.onChangeCallback=void 0,e.index=-1);const i=t.length-1;for(let e=n;e<i;++e){const n=t[e+1];t[e]=n,n instanceof b.A&&(n.index=e)}return this._multipleDirtyPlanes=!0,t.length=i,this.planeRemoved.raiseEvent(e,n),!0},w.prototype.removeAll=function(){const e=this._planes,t=e.length;for(let n=0;n<t;++n){const t=e[n];t instanceof b.A&&(t.onChangeCallback=void 0,t.index=-1),this.planeRemoved.raiseEvent(t,n)}this._multipleDirtyPlanes=!0,this._planes=[]};const I=new s.A,P=new s.A;function D(e,t,n){const o=e._uint8View,r=e._planes;let a=0;for(let e=t;e<n;++e){const t=r[e],n=i.A.octEncodeToCartesian4(t.normal,P);o[a]=n.x,o[a+1]=n.y,o[a+2]=n.z,o[a+3]=n.w;const c=s.A.packFloat(t.distance,I);o[a+4]=c.x,o[a+5]=c.y,o[a+6]=c.z,o[a+7]=c.w,a+=8}}function O(e,t,n){const i=e._float32View,o=e._planes;let r=0;for(let e=t;e<n;++e){const t=o[e],n=t.normal;i[r]=n.x,i[r+1]=n.y,i[r+2]=n.z,i[r+3]=t.distance,r+=4}}function R(e,t){const n=_.A.maximumTextureSize;return t.x=Math.min(e,n),t.y=Math.ceil(e/t.x),t}const M=new o.A;w.prototype.update=function(e){let t=this._clippingPlanesTexture;const n=e.context,i=w.useFloatTexture(n),o=i?this.length:2*this.length;if((0,u.A)(t)){const e=t.width*t.height;(e<o||o<.25*e)&&(t.destroy(),t=void 0,this._clippingPlanesTexture=void 0)}if(0===this.length)return;if(!(0,u.A)(t)){const e=R(o,M);e.y*=2,i?(t=new T.A({context:n,width:e.x,height:e.y,pixelFormat:m.A.RGBA,pixelDatatype:y.A.FLOAT,sampler:v.A.NEAREST,flipY:!1}),this._float32View=new Float32Array(e.x*e.y*4)):(t=new T.A({context:n,width:e.x,height:e.y,pixelFormat:m.A.RGBA,pixelDatatype:y.A.UNSIGNED_BYTE,sampler:v.A.NEAREST,flipY:!1}),this._uint8View=new Uint8Array(e.x*e.y*4)),this._clippingPlanesTexture=t,this._multipleDirtyPlanes=!0}const r=this._dirtyIndex;if(this._multipleDirtyPlanes||-1!==r){if(this._multipleDirtyPlanes)i?(O(this,0,this._planes.length),t.copyFrom({source:{width:t.width,height:t.height,arrayBufferView:this._float32View}})):(D(this,0,this._planes.length),t.copyFrom({source:{width:t.width,height:t.height,arrayBufferView:this._uint8View}}));else{let e=0,n=0;i?(n=Math.floor(r/t.width),e=Math.floor(r-n*t.width),O(this,r,r+1),t.copyFrom({source:{width:1,height:1,arrayBufferView:this._float32View},xOffset:e,yOffset:n})):(n=Math.floor(2*r/t.width),e=Math.floor(2*r-n*t.width),D(this,r,r+1),t.copyFrom({source:{width:2,height:1,arrayBufferView:this._uint8View},xOffset:e,yOffset:n}))}this._multipleDirtyPlanes=!1,this._dirtyIndex=-1}};const L=new f.A,N=new g.A(r.A.UNIT_X,0);w.prototype.computeIntersectionWithBoundingVolume=function(e,t){const n=this._planes,i=n.length;let o=this.modelMatrix;(0,u.A)(t)&&(o=f.A.multiply(t,o,L));let r=p.A.INSIDE;!this.unionClippingRegions&&i>0&&(r=p.A.OUTSIDE);for(let t=0;t<i;++t){const i=n[t];g.A.transform(i,o,N);const s=e.intersectPlane(N);if(s===p.A.INTERSECTING)r=s;else if(this._testIntersection(s))return s}return r},w.setOwner=function(e,t,n){if(e!==t[n]&&(t[n]=t[n]&&t[n].destroy(),(0,u.A)(e))){if((0,u.A)(e._owner))throw new h.A("ClippingPlaneCollection should only be assigned to one object");e._owner=t,t[n]=e}},w.useFloatTexture=function(e){return e.floatingPointTexture},w.getTextureResolution=function(e,t,n){const i=e.texture;if((0,u.A)(i))return n.x=i.width,n.y=i.height,n;const o=R(w.useFloatTexture(t)?e.length:2*e.length,n);return o.y*=2,o},w.prototype.isDestroyed=function(){return!1},w.prototype.destroy=function(){return this._clippingPlanesTexture=this._clippingPlanesTexture&&this._clippingPlanesTexture.destroy(),(0,d.A)(this)};const B=w},506964:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(369031),o=n(267980),r=n(336946),s=n(491446),a=n(610750),c=n(367817),l=n(151949),u=n(697422);function d(e){i.A.typeOf.object("options",e),i.A.typeOf.object("options.positions",e.positions),i.A.typeOf.number.greaterThanOrEquals("options.positions.length",e.positions.length,3),this._ellipsoid=e.ellipsoid??a.A.default,this._positions=[...e.positions]}Object.defineProperties(d.prototype,{length:{get:function(){return this._positions.length}},positions:{get:function(){return this._positions}},ellipsoid:{get:function(){return this._ellipsoid}}}),d.clone=function(e,t){return i.A.typeOf.object("polygon",e),(0,s.A)(t)?(t._ellipsoid=e.ellipsoid,t._positions.length=0,t._positions.push(...e.positions),t):new d({positions:e.positions,ellipsoid:e.ellipsoid})},d.equals=function(e,t){return i.A.typeOf.object("left",e),i.A.typeOf.object("right",t),e.ellipsoid.equals(t.ellipsoid)&&e.positions===t.positions},d.prototype.computeRectangle=function(e){return l.A.computeRectangleFromPositions(this.positions,this.ellipsoid,void 0,e)};const h=new u.A,A=new o.A;d.prototype.computeSphericalExtents=function(e){(0,s.A)(e)||(e=new u.A);const t=this.computeRectangle(h);let n=r.A.toCartesian(u.A.southwest(t),this.ellipsoid,A),i=Math.sqrt(n.x*n.x+n.y*n.y),o=c.A.fastApproximateAtan2(i,n.z),a=c.A.fastApproximateAtan2(n.x,n.y);return e.south=o,e.west=a,n=r.A.toCartesian(u.A.northeast(t),this.ellipsoid,A),i=Math.sqrt(n.x*n.x+n.y*n.y),o=c.A.fastApproximateAtan2(i,n.z),a=c.A.fastApproximateAtan2(n.x,n.y),e.north=o,e.east=a,e};const p=d},348460:(e,t,n)=>{"use strict";n.d(t,{A:()=>D});var i=n(434067),o=n(367817),r=n(369031),s=n(915325),a=n(491446),c=n(677354),l=n(605971),u=n(955943),d=n(647326),h=n(276904),A=n(697422),p=n(430332),f=n(57775),m=n(123245),g=n(654799),_=n(616e3),y=n(957233),v=n(78078),T=n(557448),b=n(506964),w=n(718289),x=n(291848);function C(e){e=e??s.A.EMPTY_OBJECT,this._polygons=[],this._totalPositions=0,this.enabled=e.enabled??!0,this.inverse=e.inverse??!1,this.polygonAdded=new u.A,this.polygonRemoved=new u.A,this._owner=void 0,this._float32View=void 0,this._extentsFloat32View=void 0,this._extentsCount=0,this._polygonsTexture=void 0,this._extentsTexture=void 0,this._signedDistanceTexture=void 0,this._signedDistanceComputeCommand=void 0;const t=e.polygons;if((0,a.A)(t)){const e=t.length;for(let n=0;n<e;++n)this._polygons.push(t[n])}}Object.defineProperties(C.prototype,{length:{get:function(){return this._polygons.length}},totalPositions:{get:function(){return this._totalPositions}},extentsTexture:{get:function(){return this._extentsTexture}},extentsCount:{get:function(){return this._extentsCount}},pixelsNeededForExtents:{get:function(){return this.length}},pixelsNeededForPolygonPositions:{get:function(){return this.totalPositions+this.length}},clippingTexture:{get:function(){return this._signedDistanceTexture}},owner:{get:function(){return this._owner}},clippingPolygonsState:{get:function(){return this.inverse?-this.extentsCount:this.extentsCount}}}),C.prototype.add=function(e){r.A.typeOf.object("polygon",e);const t=this._polygons.length;return this._polygons.push(e),this.polygonAdded.raiseEvent(e,t),e},C.prototype.get=function(e){return r.A.typeOf.number("index",e),this._polygons[e]},C.prototype.contains=function(e){return r.A.typeOf.object("polygon",e),this._polygons.some(t=>b.A.equals(t,e))},C.prototype.remove=function(e){r.A.typeOf.object("polygon",e);const t=this._polygons,n=t.findIndex(t=>b.A.equals(t,e));return-1!==n&&(t.splice(n,1),this.polygonRemoved.raiseEvent(e,n),!0)};const E=new A.A;C.prototype.removeAll=function(){const e=this._polygons,t=e.length;for(let n=0;n<t;++n){const t=e[n];this.polygonRemoved.raiseEvent(t,n)}this._polygons=[]};const S=new i.A;C.prototype.update=function(e){const t=e.context;if(!C.isSupported(e))throw new m.A("ClippingPolygonCollections are only supported for WebGL 2.");const n=this._polygons.reduce((e,t)=>e+t.length,0);if(n===this.totalPositions)return;if(this._totalPositions=n,0===this.length)return;(0,a.A)(this._signedDistanceComputeCommand)&&(this._signedDistanceComputeCommand.canceled=!0,this._signedDistanceComputeCommand=void 0);let i=this._polygonsTexture,r=this._extentsTexture,s=this._signedDistanceTexture;if((0,a.A)(i)){const e=i.width*i.height;(e<this.pixelsNeededForPolygonPositions||this.pixelsNeededForPolygonPositions<.25*e)&&(i.destroy(),i=void 0,this._polygonsTexture=void 0)}if(!(0,a.A)(i)){const e=C.getTextureResolution(i,this.pixelsNeededForPolygonPositions,S);i=new _.A({context:t,width:e.x,height:e.y,pixelFormat:h.A.RG,pixelDatatype:f.A.FLOAT,sampler:g.A.NEAREST,flipY:!1}),this._float32View=new Float32Array(e.x*e.y*2),this._polygonsTexture=i}if((0,a.A)(r)){const e=r.width*r.height;(e<this.pixelsNeededForExtents||this.pixelsNeededForExtents<.25*e)&&(r.destroy(),r=void 0,this._extentsTexture=void 0)}if(!(0,a.A)(r)){const e=C.getTextureResolution(r,this.pixelsNeededForExtents,S);r=new _.A({context:t,width:e.x,height:e.y,pixelFormat:h.A.RGBA,pixelDatatype:f.A.FLOAT,sampler:g.A.NEAREST,flipY:!1}),this._extentsFloat32View=new Float32Array(e.x*e.y*4),this._extentsTexture=r}if(function(e){const t=e._float32View,n=e._extentsFloat32View,i=e._polygons,{extentsList:r,extentsIndexByPolygon:s}=function(e){const t=[],n=[],i=e.length;for(let o=0;o<i;++o){const i=e[o].computeSphericalExtents();let r=Math.max(2.5*i.height,.001),s=Math.max(2.5*i.width,.001),c=A.A.clone(i);c.south-=r,c.west-=s,c.north+=r,c.east+=s,c.south=Math.max(c.south,-Math.PI),c.west=Math.max(c.west,-Math.PI),c.north=Math.min(c.north,Math.PI),c.east=Math.min(c.east,Math.PI);const l=[o];for(let o=0;o<t.length;++o){const u=t[o];if((0,a.A)(u)&&(0,a.A)(A.A.simpleIntersection(u,c))&&!A.A.equals(u,c)){const a=n[o];l.push(...a),a.reduce((t,n)=>A.A.union(e[n].computeSphericalExtents(E),t,t),i),t[o]=void 0,n[o]=void 0,r=Math.max(2.5*i.height,.001),s=Math.max(2.5*i.width,.001),c=A.A.clone(i,c),c.south-=r,c.west-=s,c.north+=r,c.east+=s,c.south=Math.max(c.south,-Math.PI),c.west=Math.max(c.west,-Math.PI),c.north=Math.min(c.north,Math.PI),c.east=Math.min(c.east,Math.PI),o=-1}}t.push(c),n.push(l)}const o=new Map;return n.filter(a.A).forEach((e,t)=>e.forEach(e=>o.set(e,t))),{extentsList:t.filter(a.A),extentsIndexByPolygon:o}}(i);let c=0;for(const[e,n]of i.entries()){const i=n.length;t[c++]=i,t[c++]=s.get(e);for(let e=0;e<i;++e){const i=n.positions[e],r=Math.hypot(i.x,i.y),s=o.A.fastApproximateAtan2(r,i.z),a=o.A.fastApproximateAtan2(i.x,i.y);t[c++]=s,t[c++]=a}}let l=0;for(const e of r){const t=1/(e.east-e.west),i=1/(e.north-e.south);n[l++]=e.south,n[l++]=e.west,n[l++]=i,n[l++]=t}e._extentsCount=r.length}(this),r.copyFrom({source:{width:r.width,height:r.height,arrayBufferView:this._extentsFloat32View}}),i.copyFrom({source:{width:i.width,height:i.height,arrayBufferView:this._float32View}}),!(0,a.A)(s)){const e=C.getClippingDistanceTextureResolution(this,S);s=new _.A({context:t,width:e.x,height:e.y,pixelFormat:t.webgl2?h.A.RED:h.A.LUMINANCE,pixelDatatype:f.A.FLOAT,sampler:new g.A({wrapS:T.A.CLAMP_TO_EDGE,wrapT:T.A.CLAMP_TO_EDGE,minificationFilter:v.A.LINEAR,magnificationFilter:y.A.LINEAR}),flipY:!1}),this._signedDistanceTexture=s}this._signedDistanceComputeCommand=function(e){const t=e._polygonsTexture,n=e._extentsTexture;return new w.A({fragmentShaderSource:x.A,outputTexture:e._signedDistanceTexture,uniformMap:{u_polygonsLength:function(){return e.length},u_extentsLength:function(){return e.extentsCount},u_extentsTexture:function(){return n},u_polygonTexture:function(){return t}},persists:!1,owner:e,postExecute:()=>{e._signedDistanceComputeCommand=void 0}})}(this)},C.prototype.queueCommands=function(e){(0,a.A)(this._signedDistanceComputeCommand)&&e.commandList.push(this._signedDistanceComputeCommand)};const I=new A.A,P=new A.A;C.prototype.computeIntersectionWithBoundingVolume=function(e,t){const n=this._polygons,i=n.length;let o=d.A.OUTSIDE;this.inverse&&(o=d.A.INSIDE);for(let r=0;r<i;++r){const i=n[r].computeRectangle();let s=e.rectangle;if(!(0,a.A)(s)&&(0,a.A)(e.boundingVolume?.computeCorners)){const n=e.boundingVolume.computeCorners();s=A.A.fromCartesianArray(n,t,I)}(0,a.A)(s)||(s=A.A.fromBoundingSphere(e.boundingSphere,t,I));const c=A.A.simpleIntersection(s,i,P);(0,a.A)(c)&&(o=d.A.INTERSECTING)}return o},C.setOwner=function(e,t,n){if(e!==t[n]&&(t[n]=t[n]&&t[n].destroy(),(0,a.A)(e))){if((0,a.A)(e._owner))throw new l.A("ClippingPolygonCollection should only be assigned to one object");e._owner=t,t[n]=e}},C.isSupported=function(e){return e?.context.webgl2},C.getTextureResolution=function(e,t,n){if((0,a.A)(e))return n.x=e.width,n.y=e.height,n;const i=p.A.maximumTextureSize;return n.x=Math.min(t,i),n.y=Math.ceil(t/n.x),n.y*=2,n},C.getClippingDistanceTextureResolution=function(e,t){const n=e.signedDistanceTexture;return(0,a.A)(n)?(t.x=n.width,t.y=n.height,t):(t.x=Math.min(p.A.maximumTextureSize,4096),t.y=Math.min(p.A.maximumTextureSize,4096),t)},C.getClippingExtentsTextureResolution=function(e,t){const n=e.extentsTexture;return(0,a.A)(n)?(t.x=n.width,t.y=n.height,t):C.getTextureResolution(n,e.pixelsNeededForExtents,t)},C.prototype.isDestroyed=function(){return!1},C.prototype.destroy=function(){return(0,a.A)(this._signedDistanceComputeCommand)&&(this._signedDistanceComputeCommand.canceled=!0),this._polygonsTexture=this._polygonsTexture&&this._polygonsTexture.destroy(),this._extentsTexture=this._extentsTexture&&this._extentsTexture.destroy(),this._signedDistanceTexture=this._signedDistanceTexture&&this._signedDistanceTexture.destroy(),(0,c.A)(this)};const D=C},428027:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(367817);const o={HIGHLIGHT:0,REPLACE:1,MIX:2,getColorBlend:function(e,t){return e===o.HIGHLIGHT?0:e===o.REPLACE?1:e===o.MIX?i.A.clamp(t,i.A.EPSILON4,1):void 0}},r=Object.freeze(o)},583511:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(267980),o=n(491446),r=n(677354),s=n(452684),a=n(123245);function c(e,t,n,i){this._tileset=e,this._tile=t,this._resource=n,(0,o.A)(i)||(i=[]),this._contents=i,this._metadata=void 0,this._group=void 0,this._ready=!1}Object.defineProperties(c.prototype,{featurePropertiesDirty:{get:function(){const e=this._contents,t=e.length;for(let n=0;n<t;++n)if(e[n].featurePropertiesDirty)return!0;return!1},set:function(e){const t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].featurePropertiesDirty=e}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e;const t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].metadata=e}},batchTable:{get:function(){}},group:{get:function(){return this._group},set:function(e){this._group=e;const t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].group=e}}});const l=Uint32Array.BYTES_PER_ELEMENT;c.fromTileType=async function(e,t,n,i,r,u){r=r??0;const d=new Uint8Array(i),h=new DataView(i);r+=l;const A=h.getUint32(r,!0);if(1!==A)throw new a.A(`Only Composite Tile version 1 is supported. Version ${A} is not.`);r+=l,r+=l;const p=h.getUint32(r,!0);r+=l;let f=n.queryParameters.compositeIndex;f=(0,o.A)(f)?`${f}_`:"";const m=[];m.length=p;for(let c=0;c<p;++c){const A=(0,s.A)(d,r),p=h.getUint32(r+2*l,!0),g=u[A],_=`${f}${c}`,y=n.getDerivedResource({queryParameters:{compositeIndex:_}});if(!(0,o.A)(g))throw new a.A(`Unknown tile content type, ${A}, inside Composite tile`);m[c]=Promise.resolve(g(e,t,y,i,r)),r+=p}return new c(e,t,n,await Promise.all(m))},c.prototype.hasProperty=function(e,t){return!1},c.prototype.getFeature=function(e){},c.prototype.applyDebugSettings=function(e,t){const n=this._contents,i=n.length;for(let o=0;o<i;++o)n[o].applyDebugSettings(e,t)},c.prototype.applyStyle=function(e){const t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].applyStyle(e)},c.prototype.update=function(e,t){const n=this._contents,i=n.length;let o=!0;for(let r=0;r<i;++r)n[r].update(e,t),o=o&&n[r].ready;!this._ready&&o&&(this._ready=!0)},c.prototype.pick=function(e,t,n){if(!this._ready)return;let r,s=Number.POSITIVE_INFINITY;const a=this._contents,c=a.length;for(let l=0;l<c;++l){const c=a[l].pick(e,t,n);if(!(0,o.A)(c))continue;const u=i.A.distance(e.origin,c);u<s&&(r=c,s=u)}return(0,o.A)(r)?n:void 0},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){const e=this._contents,t=e.length;for(let n=0;n<t;++n)e[n].destroy();return(0,r.A)(this)};const u=c},33138:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(702247),o=n(376758),r=n(491446),s=n(168064);function a(e,t){this._conditionsExpression=(0,o.A)(e,!0),this._conditions=e.conditions,this._runtimeConditions=void 0,function(e,t){const n=[],i=e._conditions;if(!(0,r.A)(i))return;const o=i.length;for(let e=0;e<o;++e){const o=i[e],r=String(o[0]),a=String(o[1]);n.push(new c(new s.A(r,t),new s.A(a,t)))}e._runtimeConditions=n}(this,t)}function c(e,t){this.condition=e,this.expression=t}Object.defineProperties(a.prototype,{conditionsExpression:{get:function(){return this._conditionsExpression}}}),a.prototype.evaluate=function(e,t){const n=this._runtimeConditions;if(!(0,r.A)(n))return;const i=n.length;for(let o=0;o<i;++o){const i=n[o];if(i.condition.evaluate(e))return i.expression.evaluate(e,t)}},a.prototype.evaluateColor=function(e,t){const n=this._runtimeConditions;if(!(0,r.A)(n))return;const i=n.length;for(let o=0;o<i;++o){const i=n[o];if(i.condition.evaluate(e))return i.expression.evaluateColor(e,t)}},a.prototype.getShaderFunction=function(e,t,n,i){const o=this._runtimeConditions;if(!(0,r.A)(o)||0===o.length)return;let s="";const a=o.length;for(let e=0;e<a;++e){const i=o[e];s+=`    ${0===e?"if":"else if"} (${i.condition.getShaderExpression(t,n)})\n    {\n        return ${i.expression.getShaderExpression(t,n)};\n    }\n`}return s=`${i} ${e}\n{\n${s}    return ${i}(1.0);\n}\n`,s},a.prototype.getVariables=function(){let e=[];const t=this._runtimeConditions;if(!(0,r.A)(t)||0===t.length)return e;const n=t.length;for(let o=0;o<n;++o){const n=t[o];(0,i.A)(e,n.condition.getVariables()),(0,i.A)(e,n.expression.getVariables())}return e=e.filter(function(e,t,n){return n.indexOf(e)===t}),e};const l=a},35204:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(369031),o=n(915325),r=n(965976);function s(e){const t=(e=e??o.A.EMPTY_OBJECT).content,n=e.class;i.A.typeOf.object("options.content",t),i.A.typeOf.object("options.class",n),this._class=n,this._properties=t.properties,this._extensions=t.extensions,this._extras=t.extras}Object.defineProperties(s.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),s.prototype.hasProperty=function(e){return r.A.hasProperty(e,this._properties,this._class)},s.prototype.hasPropertyBySemantic=function(e){return r.A.hasPropertyBySemantic(e,this._properties,this._class)},s.prototype.getPropertyIds=function(e){return r.A.getPropertyIds(this._properties,this._class,e)},s.prototype.getProperty=function(e){return r.A.getProperty(e,this._properties,this._class)},s.prototype.setProperty=function(e,t){return r.A.setProperty(e,t,this._properties,this._class)},s.prototype.getPropertyBySemantic=function(e){return r.A.getPropertyBySemantic(e,this._properties,this._class)},s.prototype.setPropertyBySemantic=function(e,t){return r.A.setPropertyBySemantic(e,t,this._properties,this._class)};const a=s},253478:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(491446);function o(e){}let r;o.prototype.isReady=function(){return!0},o.prototype.shouldDiscardImage=function(e){return o.EMPTY_IMAGE===e},Object.defineProperties(o,{EMPTY_IMAGE:{get:function(){return(0,i.A)(r)||(r=new Image,r.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="),r}}});const s=o},836721:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(915325),o=n(491446),r=n(605971),s=n(85935),a=n(744603);function c(e){if(e=e??i.A.EMPTY_OBJECT,!(0,o.A)(e.missingImageUrl))throw new r.A("options.missingImageUrl is required.");if(!(0,o.A)(e.pixelsToCheck))throw new r.A("options.pixelsToCheck is required.");this._pixelsToCheck=e.pixelsToCheck,this._missingImagePixels=void 0,this._missingImageByteLength=void 0,this._isReady=!1;const t=a.A.createIfNeeded(e.missingImageUrl),n=this;t.fetchImage({preferBlob:!0,preferImageBitmap:!0,flipY:!0}).then(function(t){(0,o.A)(t.blob)&&(n._missingImageByteLength=t.blob.size);let i=(0,s.A)(t);if(e.disableCheckIfAllPixelsAreTransparent){let n=!0;const o=t.width,r=e.pixelsToCheck;for(let e=0,t=r.length;n&&e<t;++e){const t=r[e];i[4*t.x+t.y*o+3]>0&&(n=!1)}n&&(i=void 0)}n._missingImagePixels=i,n._isReady=!0}).catch(function(){n._missingImagePixels=void 0,n._isReady=!0})}c.prototype.isReady=function(){return this._isReady},c.prototype.shouldDiscardImage=function(e){if(!this._isReady)throw new r.A("shouldDiscardImage must not be called before the discard policy is ready.");const t=this._pixelsToCheck,n=this._missingImagePixels;if(!(0,o.A)(n))return!1;if((0,o.A)(e.blob)&&e.blob.size!==this._missingImageByteLength)return!1;const i=(0,s.A)(e),a=e.width;for(let e=0,o=t.length;e<o;++e){const o=t[e],r=4*o.x+o.y*a;for(let e=0;e<4;++e){const t=r+e;if(i[t]!==n[t])return!1}}return!0};const l=c},445848:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(491446),o=n(520098),r=n(123245),s=n(971724);function a(){}a._maxDecodingConcurrency=Math.max(o.A.hardwareConcurrency-1,1),a._decoderTaskProcessor=void 0,a._taskProcessorReady=!1,a._error=void 0,a._getDecoderTaskProcessor=function(){if(!(0,i.A)(a._decoderTaskProcessor)){const e=new s.A("decodeDraco",a._maxDecodingConcurrency);e.initWebAssemblyModule({wasmBinaryFile:"ThirdParty/draco_decoder.wasm"}).then(function(e){e?a._taskProcessorReady=!0:a._error=new r.A("Draco decoder could not be initialized.")}).catch(e=>{a._error=e}),a._decoderTaskProcessor=e}return a._decoderTaskProcessor},a.decodePointCloud=function(e){const t=a._getDecoderTaskProcessor();if((0,i.A)(a._error))throw a._error;if(a._taskProcessorReady)return t.scheduleTask(e,[e.buffer.buffer])},a.decodeBufferView=function(e){const t=a._getDecoderTaskProcessor();if((0,i.A)(a._error))throw a._error;if(a._taskProcessorReady)return t.scheduleTask(e,[e.array.buffer])};const c=a},226381:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});const i={NONE:0,SCENE_LIGHT:1,SUNLIGHT:2,fromGlobeFlags:function(e){return e.enableLighting&&e.dynamicAtmosphereLighting?e.dynamicAtmosphereLightingFromSun?i.SUNLIGHT:i.SCENE_LIGHT:i.NONE}},o=Object.freeze(i)},615557:(e,t,n)=>{"use strict";n.d(t,{A:()=>z});var i=n(434067),o=n(267980),r=n(626809),s=n(41476),a=n(915325),c=n(491446),l=n(677354),u=n(605971),d=n(591978),h=n(584164),A=n(276904),p=n(62467),f=n(543622),m=n(718289),g=n(430332),_=n(346154),y=n(483128),v=n(616e3),T=n(57775),b=n(654799),w=n(302836),x=n(342875),C=n(78078),E=n(153662),S=n(226381),I=n(468649),P=n(635582),D=n(198709),O=n(722856),R=n(864248);function M(e){this._position=void 0,this._radianceMapDirty=!1,this._radianceCommandsDirty=!1,this._convolutionsCommandsDirty=!1,this._irradianceCommandDirty=!1,this._irradianceTextureDirty=!1,this._sphericalHarmonicCoefficientsDirty=!1,this._shouldRegenerateShaders=!1,this._shouldReset=!1,e=e??a.A.EMPTY_OBJECT;const t=Math.min(e.mipmapLevels??7,Math.log2(g.A.maximumCubeMapSize));this._mipmapLevels=t,this._radianceMapComputeCommands=new Array(6),this._convolutionComputeCommands=new Array(6*(t-1)),this._irradianceComputeCommand=void 0,this._radianceMapFS=void 0,this._irradianceMapFS=void 0,this._convolveSP=void 0,this._va=void 0,this._radianceMapTextures=new Array(6),this._specularMapTextures=new Array(6*(t-1)),this._radianceCubeMap=void 0,this._irradianceMapTexture=void 0,this._sphericalHarmonicCoefficients=M.DEFAULT_SPHERICAL_HARMONIC_COEFFICIENTS.slice(),this._lastTime=new d.A;const n=Math.pow(2,t-1);this._textureDimensions=new i.A(n,n),this._radiiAndDynamicAtmosphereColor=new o.A,this._sceneEnvironmentMap=void 0,this._backgroundColor=void 0,this._owner=void 0,this.enabled=e.enabled??!0,this.shouldUpdate=!0,this.maximumSecondsDifference=e.maximumSecondsDifference??3600,this.maximumPositionEpsilon=e.maximumPositionEpsilon??1e3,this.atmosphereScatteringIntensity=e.atmosphereScatteringIntensity??2,this.gamma=e.gamma??1,this.brightness=e.brightness??1,this.saturation=e.saturation??1,this.groundColor=e.groundColor??M.AVERAGE_EARTH_GROUND_COLOR,this.groundAlbedo=e.groundAlbedo??.31}Object.defineProperties(M.prototype,{owner:{get:function(){return this._owner}},shouldRegenerateShaders:{get:function(){return this._shouldRegenerateShaders}},position:{get:function(){return this._position},set:function(e){o.A.equalsEpsilon(e,this._position,0,this.maximumPositionEpsilon)||(this._position=o.A.clone(e,this._position),this._shouldReset=!0)}},radianceCubeMap:{get:function(){return this._radianceCubeMap}},maximumMipmapLevel:{get:function(){return this._mipmapLevels}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients}}}),M._maximumComputeCommandCount=8,M._activeComputeCommandCount=0,M._nextFrameCommandQueue=[],M._queueCommand=(e,t)=>{M._activeComputeCommandCount>=M._maximumComputeCommandCount?M._nextFrameCommandQueue.push(e):(t.commandList.push(e),M._activeComputeCommandCount++)},M._updateCommandQueue=e=>{if(M._maximumComputeCommandCount=Math.log2(g.A.maximumCubeMapSize),M._nextFrameCommandQueue.length>0&&M._activeComputeCommandCount<M._maximumComputeCommandCount){let t=M._nextFrameCommandQueue.shift();for(;(0,c.A)(t)&&M._activeComputeCommandCount<M._maximumComputeCommandCount;)t.owner.isDestroyed()||t.canceled||(e.commandList.push(t),M._activeComputeCommandCount++),t=M._nextFrameCommandQueue.shift();(0,c.A)(t)&&M._nextFrameCommandQueue.push(t)}},M.setOwner=function(e,t,n){if(e!==t[n]&&(t[n]=t[n]&&t[n].destroy(),(0,c.A)(e))){if((0,c.A)(e._owner))throw new u.A("DynamicEnvironmentMapManager should only be assigned to one object");e._owner=t,t[n]=e}},M.prototype.reset=function(){let e=this._radianceMapComputeCommands.length;for(let t=0;t<e;++t)(0,c.A)(this._radianceMapComputeCommands[t])&&(this._radianceMapComputeCommands[t].canceled=!0),this._radianceMapComputeCommands[t]=void 0;e=this._convolutionComputeCommands.length;for(let t=0;t<e;++t)(0,c.A)(this._convolutionComputeCommands[t])&&(this._convolutionComputeCommands[t].canceled=!0),this._convolutionComputeCommands[t]=void 0;(0,c.A)(this._irradianceComputeCommand)&&(this._irradianceComputeCommand.canceled=!0,this._irradianceComputeCommand=void 0),this._radianceMapDirty=!0,this._radianceCommandsDirty=!0,this._convolutionsCommandsDirty=!1,this._irradianceCommandDirty=!1};const L=new o.A,N=new o.A,B=new o.A,F=new h.A,U=new r.A,k=new s.A,V=new i.A(3,3);M.prototype.update=function(e){const t=e.mode;if(!(M.isDynamicUpdateSupported(e)&&this.enabled&&this.shouldUpdate&&(0,c.A)(this._position)&&t!==p.A.MORPHING))return void(this._shouldRegenerateShaders=!1);M._updateCommandQueue(e);const n=e.atmosphere.dynamicLighting,i=function(e,t){const n=e._position,i=t.atmosphere,r=t.mapProjection.ellipsoid,s=r.scaleToGeodeticSurface(n,N),a=L,l=(0,c.A)(s)?o.A.magnitude(s):r.maximumRadius;return a.x=1.025*l,a.y=l,a.z=i.dynamicLighting,!(o.A.equalsEpsilon(e._radiiAndDynamicAtmosphereColor,a)&&t.environmentMap===e._sceneEnvironmentMap&&t.backgroundColor===e._backgroundColor||(o.A.clone(a,e._radiiAndDynamicAtmosphereColor),e._sceneEnvironmentMap=t.environmentMap,e._backgroundColor=t.backgroundColor,0))}(this,e)||n===S.A.SUNLIGHT&&!d.A.equalsEpsilon(e.time,this._lastTime,this.maximumSecondsDifference);return this._shouldReset||i?(this.reset(),this._shouldReset=!1,void(this._lastTime=d.A.clone(e.time,this._lastTime))):(this._radianceMapDirty&&(function(e,t){const n=t.context,i=e._textureDimensions;if((0,c.A)(e._radianceCubeMap)||(e._radianceCubeMap=new _.A({context:n,width:i.x,height:i.y,pixelDatatype:T.A.UNSIGNED_BYTE,pixelFormat:A.A.RGBA})),e._radianceCommandsDirty){let o=e._radianceMapFS;(0,c.A)(o)||(o=new x.A({sources:[I.A,D.A]}),e._radianceMapFS=o),E.A.requiresColorCorrect(t.atmosphere)&&o.defines.push("ATMOSPHERE_COLOR_CORRECT");const r=e._position,s=e._radiiAndDynamicAtmosphereColor,a=t.mapProjection.ellipsoid,l=f.A.eastNorthUpToFixedFrame(r,a,F),u=U;u.x=e.brightness,u.y=e.saturation,u.z=e.gamma,u.w=e.atmosphereScatteringIntensity,1===e.brightness&&1===e.saturation&&1===e.gamma||o.defines.push("ENVIRONMENT_COLOR_CORRECT");let d=0;for(const a of _.A.faceNames()){let h=e._radianceMapTextures[d];(0,c.A)(h)&&!h.isDestroyed()&&h.destroy(),h=new v.A({context:n,width:i.x,height:i.y,pixelDatatype:T.A.UNSIGNED_BYTE,pixelFormat:A.A.RGBA}),e._radianceMapTextures[d]=h;const p=d,f=new m.A({fragmentShaderSource:o,outputTexture:h,uniformMap:{u_radiiAndDynamicAtmosphereColor:()=>s,u_enuToFixedFrame:()=>l,u_faceDirection:()=>_.A.getDirection(a,B),u_positionWC:()=>r,u_brightnessSaturationGammaIntensity:()=>u,u_groundColor:()=>e.groundColor.withAlpha(e.groundAlbedo,k)},owner:e});f.postExecute=()=>{if(e.isDestroyed()||f.canceled)return void M._activeComputeCommandCount--;const t=e._radianceMapComputeCommands;t[p]=void 0;const i=new y.A({context:n,colorTextures:[e._radianceMapTextures[p]]});i._bind(),e._radianceCubeMap[a].copyFromFramebuffer(),i._unBind(),i.destroy(),M._activeComputeCommandCount--,t.some(c.A)||(e._convolutionsCommandsDirty=!0,e._shouldRegenerateShaders=!0)},e._radianceMapComputeCommands[d]=f,M._queueCommand(f,t),d++}e._radianceCommandsDirty=!1}}(this,e),this._radianceMapDirty=!1),this._convolutionsCommandsDirty&&(function(e,t){const n=e._radianceCubeMap;n.generateMipmap();const i=e._mipmapLevels,o=e._textureDimensions;let r=o.x/2,s=o.y/2;const a=t.context;let l=0;const u=(i,o,r,s,a)=>()=>{if(e.isDestroyed()||i.canceled)return void M._activeComputeCommandCount--;e._convolutionComputeCommands[o]=void 0,n.copyFace(t,r,s,a),l++,M._activeComputeCommandCount--,r.destroy(),e._specularMapTextures[o]=void 0;const c=e._specularMapTextures.length;l>=c&&(e._irradianceCommandDirty=!0,n.sampler=new b.A({minificationFilter:C.A.LINEAR_MIPMAP_LINEAR}),e._shouldRegenerateShaders=!0,e._va.destroy(),e._va=void 0,e._convolveSP.destroy(),e._convolveSP=void 0)};let d=0;for(let o=1;o<i;++o){for(const l of _.A.faceNames()){(0,c.A)(e._specularMapTextures[d])&&e._specularMapTextures[d].destroy();const h=e._specularMapTextures[d]=new v.A({context:a,width:r,height:s,pixelDatatype:T.A.UNSIGNED_BYTE,pixelFormat:A.A.RGBA});let p=e._va;(0,c.A)(p)||(p=_.A.createVertexArray(a,l),e._va=p);let f=e._convolveSP;(0,c.A)(f)||(f=w.A.fromCache({context:a,vertexShaderSource:R.A,fragmentShaderSource:O.A,attributeLocations:{positions:0}}),e._convolveSP=f);const g=new m.A({shaderProgram:f,vertexArray:p,outputTexture:h,persists:!0,owner:e,uniformMap:{u_roughness:()=>o/(i-1),u_radianceTexture:()=>n??a.defaultTexture,u_faceDirection:()=>_.A.getDirection(l,B)}});g.postExecute=u(g,d,h,l,o),e._convolutionComputeCommands[d]=g,M._queueCommand(g,t),++d}r/=2,s/=2}}(this,e),this._convolutionsCommandsDirty=!1),this._irradianceCommandDirty&&(function(e,t){const n=t.context,i=V;let o=e._irradianceMapTexture;(0,c.A)(o)&&!o.isDestroyed()&&o.destroy(),o=new v.A({context:n,width:i.x,height:i.y,pixelDatatype:T.A.FLOAT,pixelFormat:A.A.RGBA}),e._irradianceMapTexture=o;let r=e._irradianceMapFS;(0,c.A)(r)||(r=new x.A({sources:[P.A]}),e._irradianceMapFS=r);const s=new m.A({fragmentShaderSource:r,outputTexture:o,owner:e,uniformMap:{u_radianceMap:()=>e._radianceCubeMap??n.defaultTexture}});s.postExecute=()=>{e.isDestroyed()||s.canceled||(e._irradianceTextureDirty=!1,e._irradianceComputeCommand=void 0,e._sphericalHarmonicCoefficientsDirty=!0,e._irradianceMapFS=void 0),M._activeComputeCommandCount--},e._irradianceComputeCommand=s,M._queueCommand(s,t),e._irradianceTextureDirty=!0}(this,e),this._irradianceCommandDirty=!1),this._irradianceTextureDirty?void(this._shouldRegenerateShaders=!1):this._sphericalHarmonicCoefficientsDirty?(function(e,t){const n=t.context;if(!(0,c.A)(e._irradianceMapTexture))return;const i=new y.A({context:n,colorTextures:[e._irradianceMapTexture],destroyAttachments:!1}),r=V,s=n.readPixels({x:0,y:0,width:r.x,height:r.y,framebuffer:i});for(let t=0;t<9;++t)e._sphericalHarmonicCoefficients[t]=o.A.unpack(s,4*t),o.A.multiplyByScalar(e._sphericalHarmonicCoefficients[t],e.atmosphereScatteringIntensity,e._sphericalHarmonicCoefficients[t]);i.destroy(),e._irradianceMapTexture.destroy(),e._irradianceMapTexture=void 0,e._shouldRegenerateShaders=!0}(this,e),void(this._sphericalHarmonicCoefficientsDirty=!1)):void(this._shouldRegenerateShaders=!1))},M.prototype.isDestroyed=function(){return!1},M.prototype.destroy=function(){let e=this._radianceMapComputeCommands.length;for(let t=0;t<e;++t)this._radianceMapComputeCommands[t]=void 0;e=this._convolutionComputeCommands.length;for(let t=0;t<e;++t)this._convolutionComputeCommands[t]=void 0;this._irradianceMapComputeCommand=void 0,e=this._radianceMapTextures.length;for(let t=0;t<e;++t)this._radianceMapTextures[t]=this._radianceMapTextures[t]&&!this._radianceMapTextures[t].isDestroyed()&&this._radianceMapTextures[t].destroy();e=this._specularMapTextures.length;for(let t=0;t<e;++t)this._specularMapTextures[t]=this._specularMapTextures[t]&&!this._specularMapTextures[t].isDestroyed()&&this._specularMapTextures[t].destroy();return this._radianceCubeMap=this._radianceCubeMap&&this._radianceCubeMap.destroy(),this._irradianceMapTexture=this._irradianceMapTexture&&!this._irradianceMapTexture.isDestroyed()&&this._irradianceMapTexture.destroy(),(0,c.A)(this._va)&&this._va.destroy(),(0,c.A)(this._convolveSP)&&this._convolveSP.destroy(),(0,l.A)(this)},M.isDynamicUpdateSupported=function(e){const t=e.context;return t.halfFloatingPointTexture||t.colorBufferFloat},M.AVERAGE_EARTH_GROUND_COLOR=Object.freeze(s.A.fromCssColorString("#717145")),M.DEFAULT_SPHERICAL_HARMONIC_COEFFICIENTS=Object.freeze([Object.freeze(new o.A(.35449,.35449,.35449)),o.A.ZERO,o.A.ZERO,o.A.ZERO,o.A.ZERO,o.A.ZERO,o.A.ZERO,o.A.ZERO,o.A.ZERO]);const z=M},84269:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(677354),o=n(605971);function r(e,t){this._tileset=e,this._tile=t,this.featurePropertiesDirty=!1}Object.defineProperties(r.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},ready:{get:function(){return!0}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){}},metadata:{get:function(){},set:function(e){throw new o.A("Empty3DTileContent cannot have content metadata")}},batchTable:{get:function(){}},group:{get:function(){},set:function(e){throw new o.A("Empty3DTileContent cannot have group metadata")}}}),r.prototype.hasProperty=function(e,t){return!1},r.prototype.getFeature=function(e){},r.prototype.applyDebugSettings=function(e,t){},r.prototype.applyStyle=function(e){},r.prototype.update=function(e,t){},r.prototype.pick=function(e,t,n){},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){return(0,i.A)(this)};const s=r},168064:(e,t,n)=>{"use strict";n.d(t,{A:()=>H});var i=n(434067),o=n(267980),r=n(626809),s=n(369031),a=n(41476),c=n(491446),l=n(605971),u=n(367817),d=n(123245),h=n(469493),A=n(203576);function p(e,t){let n;s.A.typeOf.string("expression",e),this._expression=e,e=function(e,t){if(!(0,c.A)(t))return e;for(const n in t)if(t.hasOwnProperty(n)){const i=new RegExp(`\\$\\{${n}\\}`,"g"),o=`(${t[n]})`;(0,c.A)(o)&&(e=e.replace(i,o))}return e}(e,t),e=function(e){let t=e,n="",i=t.indexOf("${");for(;i>=0;){const e=t.indexOf("'"),o=t.indexOf('"');let r;if(e>=0&&e<i)r=t.indexOf("'",e+1),n+=t.substr(0,r+1),t=t.substr(r+1),i=t.indexOf("${");else if(o>=0&&o<i)r=t.indexOf('"',o+1),n+=t.substr(0,r+1),t=t.substr(r+1),i=t.indexOf("${");else{n+=t.substr(0,i);const e=t.indexOf("}");if(e<0)throw new d.A("Unmatched {.");n+=`czm_${t.substr(i+2,e-(i+2))}`,t=t.substr(e+1),i=t.indexOf("${")}}return n+=t,n}(function(e){return e.replace(y,v)}(e)),h.A.addBinaryOp("=~",0),h.A.addBinaryOp("!~",0);try{n=(0,h.A)(e)}catch(e){throw new d.A(e)}this._runtimeAst=R(this,n)}Object.defineProperties(p.prototype,{expression:{get:function(){return this._expression}}});const f={arrayIndex:0,arrayArray:[[]],cartesian2Index:0,cartesian3Index:0,cartesian4Index:0,cartesian2Array:[new i.A],cartesian3Array:[new o.A],cartesian4Array:[new r.A],reset:function(){this.arrayIndex=0,this.cartesian2Index=0,this.cartesian3Index=0,this.cartesian4Index=0},getArray:function(){this.arrayIndex>=this.arrayArray.length&&this.arrayArray.push([]);const e=this.arrayArray[this.arrayIndex++];return e.length=0,e},getCartesian2:function(){return this.cartesian2Index>=this.cartesian2Array.length&&this.cartesian2Array.push(new i.A),this.cartesian2Array[this.cartesian2Index++]},getCartesian3:function(){return this.cartesian3Index>=this.cartesian3Array.length&&this.cartesian3Array.push(new o.A),this.cartesian3Array[this.cartesian3Index++]},getCartesian4:function(){return this.cartesian4Index>=this.cartesian4Array.length&&this.cartesian4Array.push(new r.A),this.cartesian4Array[this.cartesian4Index++]}};p.prototype.evaluate=function(e,t){f.reset();const n=this._runtimeAst.evaluate(e);return t instanceof a.A&&n instanceof r.A?a.A.fromCartesian4(n,t):n instanceof i.A||n instanceof o.A||n instanceof r.A?n.clone(t):n},p.prototype.evaluateColor=function(e,t){f.reset();const n=this._runtimeAst.evaluate(e);return a.A.fromCartesian4(n,t)},p.prototype.getShaderFunction=function(e,t,n,i){let o=this.getShaderExpression(t,n);return o=`${i} ${e}\n{\n    return ${o};\n}\n`,o},p.prototype.getShaderExpression=function(e,t){return this._runtimeAst.getShaderExpression(e,t)},p.prototype.getVariables=function(){let e=[];return this._runtimeAst.getVariables(e),e=e.filter(function(e,t,n){return n.indexOf(e)===t}),e};const m=["!","-","+"],g=["+","-","*","/","%","===","!==",">",">=","<","<=","&&","||","!~","=~"],_=/\${(.*?)}/g,y=/\\/g,v="@#%",T=/@#%/g,b=new a.A,w={abs:E(Math.abs),sqrt:E(Math.sqrt),cos:E(Math.cos),sin:E(Math.sin),tan:E(Math.tan),acos:E(Math.acos),asin:E(Math.asin),atan:E(Math.atan),radians:E(u.A.toRadians),degrees:E(u.A.toDegrees),sign:E(u.A.sign),floor:E(Math.floor),ceil:E(Math.ceil),round:E(Math.round),exp:E(Math.exp),exp2:E(function(e){return Math.pow(2,e)}),log:E(Math.log),log2:E(function(e){return u.A.log2(e)}),fract:E(function(e){return e-Math.floor(e)}),length:function(e,t){if("number"==typeof t)return Math.abs(t);if(t instanceof i.A)return i.A.magnitude(t);if(t instanceof o.A)return o.A.magnitude(t);if(t instanceof r.A)return r.A.magnitude(t);throw new d.A(`Function "${e}" requires a vector or number argument. Argument is ${t}.`)},normalize:function(e,t){if("number"==typeof t)return 1;if(t instanceof i.A)return i.A.normalize(t,f.getCartesian2());if(t instanceof o.A)return o.A.normalize(t,f.getCartesian3());if(t instanceof r.A)return r.A.normalize(t,f.getCartesian4());throw new d.A(`Function "${e}" requires a vector or number argument. Argument is ${t}.`)}},x={atan2:S(Math.atan2,!1),pow:S(Math.pow,!1),min:S(Math.min,!0),max:S(Math.max,!0),distance:function(e,t,n){if("number"==typeof t&&"number"==typeof n)return Math.abs(t-n);if(t instanceof i.A&&n instanceof i.A)return i.A.distance(t,n);if(t instanceof o.A&&n instanceof o.A)return o.A.distance(t,n);if(t instanceof r.A&&n instanceof r.A)return r.A.distance(t,n);throw new d.A(`Function "${e}" requires vector or number arguments of matching types. Arguments are ${t} and ${n}.`)},dot:function(e,t,n){if("number"==typeof t&&"number"==typeof n)return t*n;if(t instanceof i.A&&n instanceof i.A)return i.A.dot(t,n);if(t instanceof o.A&&n instanceof o.A)return o.A.dot(t,n);if(t instanceof r.A&&n instanceof r.A)return r.A.dot(t,n);throw new d.A(`Function "${e}" requires vector or number arguments of matching types. Arguments are ${t} and ${n}.`)},cross:function(e,t,n){if(t instanceof o.A&&n instanceof o.A)return o.A.cross(t,n,f.getCartesian3());throw new d.A(`Function "${e}" requires vec3 arguments. Arguments are ${t} and ${n}.`)}},C={clamp:I(u.A.clamp,!0),mix:I(u.A.lerp,!0)};function E(e){return function(t,n){if("number"==typeof n)return e(n);if(n instanceof i.A)return i.A.fromElements(e(n.x),e(n.y),f.getCartesian2());if(n instanceof o.A)return o.A.fromElements(e(n.x),e(n.y),e(n.z),f.getCartesian3());if(n instanceof r.A)return r.A.fromElements(e(n.x),e(n.y),e(n.z),e(n.w),f.getCartesian4());throw new d.A(`Function "${t}" requires a vector or number argument. Argument is ${n}.`)}}function S(e,t){return function(n,s,a){if(t&&"number"==typeof a){if("number"==typeof s)return e(s,a);if(s instanceof i.A)return i.A.fromElements(e(s.x,a),e(s.y,a),f.getCartesian2());if(s instanceof o.A)return o.A.fromElements(e(s.x,a),e(s.y,a),e(s.z,a),f.getCartesian3());if(s instanceof r.A)return r.A.fromElements(e(s.x,a),e(s.y,a),e(s.z,a),e(s.w,a),f.getCartesian4())}if("number"==typeof s&&"number"==typeof a)return e(s,a);if(s instanceof i.A&&a instanceof i.A)return i.A.fromElements(e(s.x,a.x),e(s.y,a.y),f.getCartesian2());if(s instanceof o.A&&a instanceof o.A)return o.A.fromElements(e(s.x,a.x),e(s.y,a.y),e(s.z,a.z),f.getCartesian3());if(s instanceof r.A&&a instanceof r.A)return r.A.fromElements(e(s.x,a.x),e(s.y,a.y),e(s.z,a.z),e(s.w,a.w),f.getCartesian4());throw new d.A(`Function "${n}" requires vector or number arguments of matching types. Arguments are ${s} and ${a}.`)}}function I(e,t){return function(n,s,a,c){if(t&&"number"==typeof c){if("number"==typeof s&&"number"==typeof a)return e(s,a,c);if(s instanceof i.A&&a instanceof i.A)return i.A.fromElements(e(s.x,a.x,c),e(s.y,a.y,c),f.getCartesian2());if(s instanceof o.A&&a instanceof o.A)return o.A.fromElements(e(s.x,a.x,c),e(s.y,a.y,c),e(s.z,a.z,c),f.getCartesian3());if(s instanceof r.A&&a instanceof r.A)return r.A.fromElements(e(s.x,a.x,c),e(s.y,a.y,c),e(s.z,a.z,c),e(s.w,a.w,c),f.getCartesian4())}if("number"==typeof s&&"number"==typeof a&&"number"==typeof c)return e(s,a,c);if(s instanceof i.A&&a instanceof i.A&&c instanceof i.A)return i.A.fromElements(e(s.x,a.x,c.x),e(s.y,a.y,c.y),f.getCartesian2());if(s instanceof o.A&&a instanceof o.A&&c instanceof o.A)return o.A.fromElements(e(s.x,a.x,c.x),e(s.y,a.y,c.y),e(s.z,a.z,c.z),f.getCartesian3());if(s instanceof r.A&&a instanceof r.A&&c instanceof r.A)return r.A.fromElements(e(s.x,a.x,c.x),e(s.y,a.y,c.y),e(s.z,a.z,c.z),e(s.w,a.w,c.w),f.getCartesian4());throw new d.A(`Function "${n}" requires vector or number arguments of matching types. Arguments are ${s}, ${a}, and ${c}.`)}}function P(e,t,n,i,o){var r;this._type=e,this._value=t,this._left=n,this._right=i,this._test=o,this.evaluate=void 0,(r=this)._type===A.A.CONDITIONAL?r.evaluate=r._evaluateConditional:r._type===A.A.FUNCTION_CALL?"test"===r._value?r.evaluate=r._evaluateRegExpTest:"exec"===r._value?r.evaluate=r._evaluateRegExpExec:"toString"===r._value&&(r.evaluate=r._evaluateToString):r._type===A.A.UNARY?"!"===r._value?r.evaluate=r._evaluateNot:"-"===r._value?r.evaluate=r._evaluateNegative:"+"===r._value?r.evaluate=r._evaluatePositive:"isNaN"===r._value?r.evaluate=r._evaluateNaN:"isFinite"===r._value?r.evaluate=r._evaluateIsFinite:"isExactClass"===r._value?r.evaluate=r._evaluateIsExactClass:"isClass"===r._value?r.evaluate=r._evaluateIsClass:"getExactClassName"===r._value?r.evaluate=r._evaluateGetExactClassName:"Boolean"===r._value?r.evaluate=r._evaluateBooleanConversion:"Number"===r._value?r.evaluate=r._evaluateNumberConversion:"String"===r._value?r.evaluate=r._evaluateStringConversion:(0,c.A)(w[r._value])&&(r.evaluate=function(e){const t=w[e];return function(n){const i=this._left.evaluate(n);return t(e,i)}}(r._value)):r._type===A.A.BINARY?"+"===r._value?r.evaluate=r._evaluatePlus:"-"===r._value?r.evaluate=r._evaluateMinus:"*"===r._value?r.evaluate=r._evaluateTimes:"/"===r._value?r.evaluate=r._evaluateDivide:"%"===r._value?r.evaluate=r._evaluateMod:"==="===r._value?r.evaluate=r._evaluateEqualsStrict:"!=="===r._value?r.evaluate=r._evaluateNotEqualsStrict:"<"===r._value?r.evaluate=r._evaluateLessThan:"<="===r._value?r.evaluate=r._evaluateLessThanOrEquals:">"===r._value?r.evaluate=r._evaluateGreaterThan:">="===r._value?r.evaluate=r._evaluateGreaterThanOrEquals:"&&"===r._value?r.evaluate=r._evaluateAnd:"||"===r._value?r.evaluate=r._evaluateOr:"=~"===r._value?r.evaluate=r._evaluateRegExpMatch:"!~"===r._value?r.evaluate=r._evaluateRegExpNotMatch:(0,c.A)(x[r._value])&&(r.evaluate=function(e){const t=x[e];return function(n){const i=this._left.evaluate(n),o=this._right.evaluate(n);return t(e,i,o)}}(r._value)):r._type===A.A.TERNARY?r.evaluate=function(e){const t=C[e];return function(n){const i=this._left.evaluate(n),o=this._right.evaluate(n),r=this._test.evaluate(n);return t(e,i,o,r)}}(r._value):r._type===A.A.MEMBER?"brackets"===r._value?r.evaluate=r._evaluateMemberBrackets:r.evaluate=r._evaluateMemberDot:r._type===A.A.ARRAY?r.evaluate=r._evaluateArray:r._type===A.A.VARIABLE?r.evaluate=r._evaluateVariable:r._type===A.A.VARIABLE_IN_STRING?r.evaluate=r._evaluateVariableString:r._type===A.A.LITERAL_COLOR?r.evaluate=r._evaluateLiteralColor:r._type===A.A.LITERAL_VECTOR?r.evaluate=r._evaluateLiteralVector:r._type===A.A.LITERAL_STRING?r.evaluate=r._evaluateLiteralString:r._type===A.A.REGEX?r.evaluate=r._evaluateRegExp:r._type===A.A.BUILTIN_VARIABLE?"tiles3d_tileset_time"===r._value&&(r.evaluate=M):r.evaluate=r._evaluateLiteral}function D(e){return e.replace(T,"\\")}function O(e){return e._type>=A.A.LITERAL_NULL}function R(e,t){let n,i,o,r;if("Literal"===t.type)n=function(e){const t=typeof e.value;return null===e.value?new P(A.A.LITERAL_NULL,null):"boolean"===t?new P(A.A.LITERAL_BOOLEAN,e.value):"number"===t?new P(A.A.LITERAL_NUMBER,e.value):"string"===t?e.value.indexOf("${")>=0?new P(A.A.VARIABLE_IN_STRING,e.value):new P(A.A.LITERAL_STRING,D(e.value)):void 0}(t);else if("CallExpression"===t.type)n=function(e,t){const n=t.arguments,i=n.length;let o,r,s,a;if("MemberExpression"===t.callee.type){o=t.callee.property.name;const l=t.callee.object;if("test"===o||"exec"===o){if(!(0,c.A)(l.callee)||"regExp"!==l.callee.name)throw new d.A(`${o} is not a function.`);return 0===i?"test"===o?new P(A.A.LITERAL_BOOLEAN,!1):new P(A.A.LITERAL_NULL,null):(s=R(e,l),a=R(e,n[0]),new P(A.A.FUNCTION_CALL,o,s,a))}if("toString"===o)return r=R(e,l),new P(A.A.FUNCTION_CALL,o,r);throw new d.A(`Unexpected function call "${o}".`)}if(o=t.callee.name,"color"===o){if(0===i)return new P(A.A.LITERAL_COLOR,o);if(r=R(e,n[0]),(0,c.A)(n[1])){const t=R(e,n[1]);return new P(A.A.LITERAL_COLOR,o,[r,t])}return new P(A.A.LITERAL_COLOR,o,[r])}if("rgb"===o||"hsl"===o){if(i<3)throw new d.A(`${o} requires three arguments.`);return r=[R(e,n[0]),R(e,n[1]),R(e,n[2])],new P(A.A.LITERAL_COLOR,o,r)}if("rgba"===o||"hsla"===o){if(i<4)throw new d.A(`${o} requires four arguments.`);return r=[R(e,n[0]),R(e,n[1]),R(e,n[2]),R(e,n[3])],new P(A.A.LITERAL_COLOR,o,r)}if("vec2"===o||"vec3"===o||"vec4"===o){r=new Array(i);for(let t=0;t<i;++t)r[t]=R(e,n[t]);return new P(A.A.LITERAL_VECTOR,o,r)}if("isNaN"===o||"isFinite"===o)return 0===i?new P(A.A.LITERAL_BOOLEAN,"isNaN"===o):(r=R(e,n[0]),new P(A.A.UNARY,o,r));if("isExactClass"===o||"isClass"===o){if(i<1||i>1)throw new d.A(`${o} requires exactly one argument.`);return r=R(e,n[0]),new P(A.A.UNARY,o,r)}if("getExactClassName"===o){if(i>0)throw new d.A(`${o} does not take any argument.`);return new P(A.A.UNARY,o)}if((0,c.A)(w[o])){if(1!==i)throw new d.A(`${o} requires exactly one argument.`);return r=R(e,n[0]),new P(A.A.UNARY,o,r)}if((0,c.A)(x[o])){if(2!==i)throw new d.A(`${o} requires exactly two arguments.`);return s=R(e,n[0]),a=R(e,n[1]),new P(A.A.BINARY,o,s,a)}if((0,c.A)(C[o])){if(3!==i)throw new d.A(`${o} requires exactly three arguments.`);s=R(e,n[0]),a=R(e,n[1]);const t=R(e,n[2]);return new P(A.A.TERNARY,o,s,a,t)}if("Boolean"===o)return 0===i?new P(A.A.LITERAL_BOOLEAN,!1):(r=R(e,n[0]),new P(A.A.UNARY,o,r));if("Number"===o)return 0===i?new P(A.A.LITERAL_NUMBER,0):(r=R(e,n[0]),new P(A.A.UNARY,o,r));if("String"===o)return 0===i?new P(A.A.LITERAL_STRING,""):(r=R(e,n[0]),new P(A.A.UNARY,o,r));if("regExp"===o)return function(e,t){const n=t.arguments;if(0===n.length)return new P(A.A.LITERAL_REGEX,new RegExp);const i=R(e,n[0]);let o;if(n.length>1){const t=R(e,n[1]);if(O(i)&&O(t)){try{o=new RegExp(D(String(i._value)),t._value)}catch(e){throw new d.A(e)}return new P(A.A.LITERAL_REGEX,o)}return new P(A.A.REGEX,i,t)}if(O(i)){try{o=new RegExp(D(String(i._value)))}catch(e){throw new d.A(e)}return new P(A.A.LITERAL_REGEX,o)}return new P(A.A.REGEX,i)}(e,t);throw new d.A(`Unexpected function call "${o}".`)}(e,t);else if("Identifier"===t.type)n=function(e){if("czm_"===e.name.substr(0,4)){const t=e.name.substr(4);return"tiles3d_"===t.substr(0,8)?new P(A.A.BUILTIN_VARIABLE,t):new P(A.A.VARIABLE,t)}if("NaN"===e.name)return new P(A.A.LITERAL_NUMBER,NaN);if("Infinity"===e.name)return new P(A.A.LITERAL_NUMBER,1/0);if("undefined"===e.name)return new P(A.A.LITERAL_UNDEFINED,void 0);throw new d.A(`${e.name} is not defined.`)}(t);else if("UnaryExpression"===t.type){i=t.operator;const o=R(e,t.argument);if(!(m.indexOf(i)>-1))throw new d.A(`Unexpected operator "${i}".`);n=new P(A.A.UNARY,i,o)}else if("BinaryExpression"===t.type){if(i=t.operator,o=R(e,t.left),r=R(e,t.right),!(g.indexOf(i)>-1))throw new d.A(`Unexpected operator "${i}".`);n=new P(A.A.BINARY,i,o,r)}else if("LogicalExpression"===t.type)i=t.operator,o=R(e,t.left),r=R(e,t.right),g.indexOf(i)>-1&&(n=new P(A.A.BINARY,i,o,r));else if("ConditionalExpression"===t.type){const i=R(e,t.test);o=R(e,t.consequent),r=R(e,t.alternate),n=new P(A.A.CONDITIONAL,"?",o,r,i)}else if("MemberExpression"===t.type)n=function(e,t){if("Math"===t.object.name)return function(e){const t=e.property.name;return"PI"===t?new P(A.A.LITERAL_NUMBER,Math.PI):"E"===t?new P(A.A.LITERAL_NUMBER,Math.E):void 0}(t);if("Number"===t.object.name)return function(e){if("POSITIVE_INFINITY"===e.property.name)return new P(A.A.LITERAL_NUMBER,Number.POSITIVE_INFINITY)}(t);let n;const i=R(e,t.object);return t.computed?(n=R(e,t.property),new P(A.A.MEMBER,"brackets",i,n)):(n=new P(A.A.LITERAL_STRING,t.property.name),new P(A.A.MEMBER,"dot",i,n))}(e,t);else{if("ArrayExpression"!==t.type)throw"Compound"===t.type?new d.A("Provide exactly one expression."):new d.A("Cannot parse expression.");{const i=[];for(let n=0;n<t.elements.length;n++)i[n]=R(e,t.elements[n]);n=new P(A.A.ARRAY,i)}}return n}function M(e){return(0,c.A)(e)?e.content.tileset.timeSinceLoad:0}function L(e,t){if((0,c.A)(e))return e.getPropertyInherited(t)}function N(e){return"feature"===e._value}function B(e){const t=e._left,n=t.length;for(let e=0;e<n;++e)if(t[e]._type!==A.A.LITERAL_NUMBER)return;const i=t[0]._value,o=t[1]._value,r=t[2]._value,s=4===n?t[3]._value:1;return a.A.fromHsl(i,o,r,s,b)}function F(e){const t=e._left,n=t.length;for(let e=0;e<n;++e)if(t[e]._type!==A.A.LITERAL_NUMBER)return;const i=b;return i.red=t[0]._value/255,i.green=t[1]._value/255,i.blue=t[2]._value/255,i.alpha=4===n?t[3]._value:1,i}function U(e){return e%1==0?e.toFixed(1):e.toString()}function k(e){return`vec4(${U(e.red)}, ${U(e.green)}, ${U(e.blue)}, ${U(e.alpha)})`}function V(e,t,n,i){const o=e.length,r=new Array(o);for(let s=0;s<o;++s)r[s]=e[s].getShaderExpression(t,n,i);return r}function z(e,t){return(0,c.A)(t[e])?t[e]:p.NULL_SENTINEL}P.prototype._evaluateLiteral=function(){return this._value},P.prototype._evaluateLiteralColor=function(e){const t=b,n=this._left;if("color"===this._value)(0,c.A)(n)?n.length>1?(a.A.fromCssColorString(n[0].evaluate(e),t),t.alpha=n[1].evaluate(e)):a.A.fromCssColorString(n[0].evaluate(e),t):a.A.fromBytes(255,255,255,255,t);else if("rgb"===this._value)a.A.fromBytes(n[0].evaluate(e),n[1].evaluate(e),n[2].evaluate(e),255,t);else if("rgba"===this._value){const i=255*n[3].evaluate(e);a.A.fromBytes(n[0].evaluate(e),n[1].evaluate(e),n[2].evaluate(e),i,t)}else"hsl"===this._value?a.A.fromHsl(n[0].evaluate(e),n[1].evaluate(e),n[2].evaluate(e),1,t):"hsla"===this._value&&a.A.fromHsl(n[0].evaluate(e),n[1].evaluate(e),n[2].evaluate(e),n[3].evaluate(e),t);return r.A.fromColor(t,f.getCartesian4())},P.prototype._evaluateLiteralVector=function(e){const t=f.getArray(),n=this._value,s=this._left,a=s.length;for(let c=0;c<a;++c){const a=s[c].evaluate(e);if("number"==typeof a)t.push(a);else if(a instanceof i.A)t.push(a.x,a.y);else if(a instanceof o.A)t.push(a.x,a.y,a.z);else{if(!(a instanceof r.A))throw new d.A(`${n} argument must be a vector or number. Argument is ${a}.`);t.push(a.x,a.y,a.z,a.w)}}const c=t.length,l=parseInt(n.charAt(3));if(0===c)throw new d.A(`Invalid ${n} constructor. No valid arguments.`);if(c<l&&c>1)throw new d.A(`Invalid ${n} constructor. Not enough arguments.`);if(c>l&&a>1)throw new d.A(`Invalid ${n} constructor. Too many arguments.`);if(1===c){const e=t[0];t.push(e,e,e)}return"vec2"===n?i.A.fromArray(t,0,f.getCartesian2()):"vec3"===n?o.A.fromArray(t,0,f.getCartesian3()):"vec4"===n?r.A.fromArray(t,0,f.getCartesian4()):void 0},P.prototype._evaluateLiteralString=function(){return this._value},P.prototype._evaluateVariableString=function(e){let t=this._value,n=_.exec(t);for(;null!==n;){const i=n[0];let o=L(e,n[1]);(0,c.A)(o)||(o=""),t=t.replace(i,o),_.lastIndex+=o.length-i.length,n=_.exec(t)}return t},P.prototype._evaluateVariable=function(e){return L(e,this._value)},P.prototype._evaluateMemberDot=function(e){if(N(this._left))return L(e,this._right.evaluate(e));const t=this._left.evaluate(e);if(!(0,c.A)(t))return;const n=this._right.evaluate(e);if(t instanceof i.A||t instanceof o.A||t instanceof r.A){if("r"===n)return t.x;if("g"===n)return t.y;if("b"===n)return t.z;if("a"===n)return t.w}return t[n]},P.prototype._evaluateMemberBrackets=function(e){if(N(this._left))return L(e,this._right.evaluate(e));const t=this._left.evaluate(e);if(!(0,c.A)(t))return;const n=this._right.evaluate(e);if(t instanceof i.A||t instanceof o.A||t instanceof r.A){if(0===n||"r"===n)return t.x;if(1===n||"g"===n)return t.y;if(2===n||"b"===n)return t.z;if(3===n||"a"===n)return t.w}return t[n]},P.prototype._evaluateArray=function(e){const t=[];for(let n=0;n<this._value.length;n++)t[n]=this._value[n].evaluate(e);return t},P.prototype._evaluateNot=function(e){const t=this._left.evaluate(e);if("boolean"!=typeof t)throw new d.A(`Operator "!" requires a boolean argument. Argument is ${t}.`);return!t},P.prototype._evaluateNegative=function(e){const t=this._left.evaluate(e);if(t instanceof i.A)return i.A.negate(t,f.getCartesian2());if(t instanceof o.A)return o.A.negate(t,f.getCartesian3());if(t instanceof r.A)return r.A.negate(t,f.getCartesian4());if("number"==typeof t)return-t;throw new d.A(`Operator "-" requires a vector or number argument. Argument is ${t}.`)},P.prototype._evaluatePositive=function(e){const t=this._left.evaluate(e);if(!(t instanceof i.A||t instanceof o.A||t instanceof r.A||"number"==typeof t))throw new d.A(`Operator "+" requires a vector or number argument. Argument is ${t}.`);return t},P.prototype._evaluateLessThan=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);if("number"!=typeof t||"number"!=typeof n)throw new d.A(`Operator "<" requires number arguments. Arguments are ${t} and ${n}.`);return t<n},P.prototype._evaluateLessThanOrEquals=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);if("number"!=typeof t||"number"!=typeof n)throw new d.A(`Operator "<=" requires number arguments. Arguments are ${t} and ${n}.`);return t<=n},P.prototype._evaluateGreaterThan=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);if("number"!=typeof t||"number"!=typeof n)throw new d.A(`Operator ">" requires number arguments. Arguments are ${t} and ${n}.`);return t>n},P.prototype._evaluateGreaterThanOrEquals=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);if("number"!=typeof t||"number"!=typeof n)throw new d.A(`Operator ">=" requires number arguments. Arguments are ${t} and ${n}.`);return t>=n},P.prototype._evaluateOr=function(e){const t=this._left.evaluate(e);if("boolean"!=typeof t)throw new d.A(`Operator "||" requires boolean arguments. First argument is ${t}.`);if(t)return!0;const n=this._right.evaluate(e);if("boolean"!=typeof n)throw new d.A(`Operator "||" requires boolean arguments. Second argument is ${n}.`);return t||n},P.prototype._evaluateAnd=function(e){const t=this._left.evaluate(e);if("boolean"!=typeof t)throw new d.A(`Operator "&&" requires boolean arguments. First argument is ${t}.`);if(!t)return!1;const n=this._right.evaluate(e);if("boolean"!=typeof n)throw new d.A(`Operator "&&" requires boolean arguments. Second argument is ${n}.`);return t&&n},P.prototype._evaluatePlus=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);if(n instanceof i.A&&t instanceof i.A)return i.A.add(t,n,f.getCartesian2());if(n instanceof o.A&&t instanceof o.A)return o.A.add(t,n,f.getCartesian3());if(n instanceof r.A&&t instanceof r.A)return r.A.add(t,n,f.getCartesian4());if("string"==typeof t||"string"==typeof n)return t+n;if("number"==typeof t&&"number"==typeof n)return t+n;throw new d.A(`Operator "+" requires vector or number arguments of matching types, or at least one string argument. Arguments are ${t} and ${n}.`)},P.prototype._evaluateMinus=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);if(n instanceof i.A&&t instanceof i.A)return i.A.subtract(t,n,f.getCartesian2());if(n instanceof o.A&&t instanceof o.A)return o.A.subtract(t,n,f.getCartesian3());if(n instanceof r.A&&t instanceof r.A)return r.A.subtract(t,n,f.getCartesian4());if("number"==typeof t&&"number"==typeof n)return t-n;throw new d.A(`Operator "-" requires vector or number arguments of matching types. Arguments are ${t} and ${n}.`)},P.prototype._evaluateTimes=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);if(n instanceof i.A&&t instanceof i.A)return i.A.multiplyComponents(t,n,f.getCartesian2());if(n instanceof i.A&&"number"==typeof t)return i.A.multiplyByScalar(n,t,f.getCartesian2());if(t instanceof i.A&&"number"==typeof n)return i.A.multiplyByScalar(t,n,f.getCartesian2());if(n instanceof o.A&&t instanceof o.A)return o.A.multiplyComponents(t,n,f.getCartesian3());if(n instanceof o.A&&"number"==typeof t)return o.A.multiplyByScalar(n,t,f.getCartesian3());if(t instanceof o.A&&"number"==typeof n)return o.A.multiplyByScalar(t,n,f.getCartesian3());if(n instanceof r.A&&t instanceof r.A)return r.A.multiplyComponents(t,n,f.getCartesian4());if(n instanceof r.A&&"number"==typeof t)return r.A.multiplyByScalar(n,t,f.getCartesian4());if(t instanceof r.A&&"number"==typeof n)return r.A.multiplyByScalar(t,n,f.getCartesian4());if("number"==typeof t&&"number"==typeof n)return t*n;throw new d.A(`Operator "*" requires vector or number arguments. If both arguments are vectors they must be matching types. Arguments are ${t} and ${n}.`)},P.prototype._evaluateDivide=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);if(n instanceof i.A&&t instanceof i.A)return i.A.divideComponents(t,n,f.getCartesian2());if(t instanceof i.A&&"number"==typeof n)return i.A.divideByScalar(t,n,f.getCartesian2());if(n instanceof o.A&&t instanceof o.A)return o.A.divideComponents(t,n,f.getCartesian3());if(t instanceof o.A&&"number"==typeof n)return o.A.divideByScalar(t,n,f.getCartesian3());if(n instanceof r.A&&t instanceof r.A)return r.A.divideComponents(t,n,f.getCartesian4());if(t instanceof r.A&&"number"==typeof n)return r.A.divideByScalar(t,n,f.getCartesian4());if("number"==typeof t&&"number"==typeof n)return t/n;throw new d.A(`Operator "/" requires vector or number arguments of matching types, or a number as the second argument. Arguments are ${t} and ${n}.`)},P.prototype._evaluateMod=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);if(n instanceof i.A&&t instanceof i.A)return i.A.fromElements(t.x%n.x,t.y%n.y,f.getCartesian2());if(n instanceof o.A&&t instanceof o.A)return o.A.fromElements(t.x%n.x,t.y%n.y,t.z%n.z,f.getCartesian3());if(n instanceof r.A&&t instanceof r.A)return r.A.fromElements(t.x%n.x,t.y%n.y,t.z%n.z,t.w%n.w,f.getCartesian4());if("number"==typeof t&&"number"==typeof n)return t%n;throw new d.A(`Operator "%" requires vector or number arguments of matching types. Arguments are ${t} and ${n}.`)},P.prototype._evaluateEqualsStrict=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);return n instanceof i.A&&t instanceof i.A||n instanceof o.A&&t instanceof o.A||n instanceof r.A&&t instanceof r.A?t.equals(n):t===n},P.prototype._evaluateNotEqualsStrict=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);return n instanceof i.A&&t instanceof i.A||n instanceof o.A&&t instanceof o.A||n instanceof r.A&&t instanceof r.A?!t.equals(n):t!==n},P.prototype._evaluateConditional=function(e){const t=this._test.evaluate(e);if("boolean"!=typeof t)throw new d.A(`Conditional argument of conditional expression must be a boolean. Argument is ${t}.`);return t?this._left.evaluate(e):this._right.evaluate(e)},P.prototype._evaluateNaN=function(e){return isNaN(this._left.evaluate(e))},P.prototype._evaluateIsFinite=function(e){return isFinite(this._left.evaluate(e))},P.prototype._evaluateIsExactClass=function(e){return!!(0,c.A)(e)&&e.isExactClass(this._left.evaluate(e))},P.prototype._evaluateIsClass=function(e){return!!(0,c.A)(e)&&e.isClass(this._left.evaluate(e))},P.prototype._evaluateGetExactClassName=function(e){if((0,c.A)(e))return e.getExactClassName()},P.prototype._evaluateBooleanConversion=function(e){return Boolean(this._left.evaluate(e))},P.prototype._evaluateNumberConversion=function(e){return Number(this._left.evaluate(e))},P.prototype._evaluateStringConversion=function(e){return String(this._left.evaluate(e))},P.prototype._evaluateRegExp=function(e){const t=this._value.evaluate(e);let n,i="";(0,c.A)(this._left)&&(i=this._left.evaluate(e));try{n=new RegExp(t,i)}catch(e){throw new d.A(e)}return n},P.prototype._evaluateRegExpTest=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);if(!(t instanceof RegExp&&"string"==typeof n))throw new d.A(`RegExp.test requires the first argument to be a RegExp and the second argument to be a string. Arguments are ${t} and ${n}.`);return t.test(n)},P.prototype._evaluateRegExpMatch=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);if(t instanceof RegExp&&"string"==typeof n)return t.test(n);if(n instanceof RegExp&&"string"==typeof t)return n.test(t);throw new d.A(`Operator "=~" requires one RegExp argument and one string argument. Arguments are ${t} and ${n}.`)},P.prototype._evaluateRegExpNotMatch=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);if(t instanceof RegExp&&"string"==typeof n)return!t.test(n);if(n instanceof RegExp&&"string"==typeof t)return!n.test(t);throw new d.A(`Operator "!~" requires one RegExp argument and one string argument. Arguments are ${t} and ${n}.`)},P.prototype._evaluateRegExpExec=function(e){const t=this._left.evaluate(e),n=this._right.evaluate(e);if(!(t instanceof RegExp&&"string"==typeof n))throw new d.A(`RegExp.exec requires the first argument to be a RegExp and the second argument to be a string. Arguments are ${t} and ${n}.`);const i=t.exec(n);return(0,c.A)(i)?i[1]:null},P.prototype._evaluateToString=function(e){const t=this._left.evaluate(e);if(t instanceof RegExp||t instanceof i.A||t instanceof o.A||t instanceof r.A)return String(t);throw new d.A(`Unexpected function call "${this._value}".`)},p.NULL_SENTINEL="czm_infinity",P.prototype.getShaderExpression=function(e,t,n){let i,o,r,s;const u=this._type;let h,f,m,g=this._value;switch((0,c.A)(this._left)&&(o=Array.isArray(this._left)?V(this._left,e,t,this):this._left.getShaderExpression(e,t,this)),(0,c.A)(this._right)&&(r=this._right.getShaderExpression(e,t,this)),(0,c.A)(this._test)&&(s=this._test.getShaderExpression(e,t,this)),Array.isArray(this._value)&&(g=V(this._value,e,t,this)),u){case A.A.VARIABLE:if(N(this))return;return z(g,e);case A.A.UNARY:if("Boolean"===g)return`bool(${o})`;if("Number"===g)return`float(${o})`;if("round"===g)return`floor(${o} + 0.5)`;if((0,c.A)(w[g]))return`${g}(${o})`;if("isNaN"===g)return`(${o} != ${o})`;if("isFinite"===g)return`(abs(${o}) < czm_infinity)`;if("String"===g||"isExactClass"===g||"isClass"===g||"getExactClassName"===g)throw new d.A(`Error generating style shader: "${g}" is not supported.`);return g+o;case A.A.BINARY:return"%"===g?`mod(${o}, ${r})`:"==="===g?`(${o} == ${r})`:"!=="===g?`(${o} != ${r})`:"atan2"===g?`atan(${o}, ${r})`:(0,c.A)(x[g])?`${g}(${o}, ${r})`:`(${o} ${g} ${r})`;case A.A.TERNARY:if((0,c.A)(C[g]))return`${g}(${o}, ${r}, ${s})`;break;case A.A.CONDITIONAL:return`(${s} ? ${o} : ${r})`;case A.A.MEMBER:return N(this._left)?z(r,e):"r"===r||"x"===r||"0.0"===r?`${o}[0]`:"g"===r||"y"===r||"1.0"===r?`${o}[1]`:"b"===r||"z"===r||"2.0"===r?`${o}[2]`:"a"===r||"w"===r||"3.0"===r?`${o}[3]`:`${o}[int(${r})]`;case A.A.FUNCTION_CALL:throw new d.A(`Error generating style shader: "${g}" is not supported.`);case A.A.ARRAY:if(4===g.length)return`vec4(${g[0]}, ${g[1]}, ${g[2]}, ${g[3]})`;if(3===g.length)return`vec3(${g[0]}, ${g[1]}, ${g[2]})`;if(2===g.length)return`vec2(${g[0]}, ${g[1]})`;throw new d.A("Error generating style shader: Invalid array length. Array length should be 2, 3, or 4.");case A.A.REGEX:throw new d.A("Error generating style shader: Regular expressions are not supported.");case A.A.VARIABLE_IN_STRING:throw new d.A("Error generating style shader: Converting a variable to a string is not supported.");case A.A.LITERAL_NULL:return p.NULL_SENTINEL;case A.A.LITERAL_BOOLEAN:return g?"true":"false";case A.A.LITERAL_NUMBER:return U(g);case A.A.LITERAL_STRING:if((0,c.A)(n)&&n._type===A.A.MEMBER&&("r"===g||"g"===g||"b"===g||"a"===g||"x"===g||"y"===g||"z"===g||"w"===g||N(n._left)))return g;if(i=a.A.fromCssColorString(g,b),(0,c.A)(i))return function(e){return`vec3(${U(e.red)}, ${U(e.green)}, ${U(e.blue)})`}(i);throw new d.A("Error generating style shader: String literals are not supported.");case A.A.LITERAL_COLOR:if(h=o,"color"===g){if(!(0,c.A)(h))return"vec4(1.0)";if(h.length>1){const e=h[0],n=h[1];return"1.0"!==n&&(t.translucent=!0),`vec4(${e}, ${n})`}return`vec4(${h[0]}, 1.0)`}if("rgb"===g)return i=F(this),(0,c.A)(i)?k(i):`vec4(${h[0]} / 255.0, ${h[1]} / 255.0, ${h[2]} / 255.0, 1.0)`;if("rgba"===g)return"1.0"!==h[3]&&(t.translucent=!0),i=F(this),(0,c.A)(i)?k(i):`vec4(${h[0]} / 255.0, ${h[1]} / 255.0, ${h[2]} / 255.0, ${h[3]})`;if("hsl"===g)return i=B(this),(0,c.A)(i)?k(i):`vec4(czm_HSLToRGB(vec3(${h[0]}, ${h[1]}, ${h[2]})), 1.0)`;if("hsla"===g)return i=B(this),(0,c.A)(i)?(1!==i.alpha&&(t.translucent=!0),k(i)):("1.0"!==h[3]&&(t.translucent=!0),`vec4(czm_HSLToRGB(vec3(${h[0]}, ${h[1]}, ${h[2]})), ${h[3]})`);break;case A.A.LITERAL_VECTOR:if(!(0,c.A)(o))throw new l.A("left should always be defined for type ExpressionNodeType.LITERAL_VECTOR");f=o.length,m=`${g}(`;for(let e=0;e<f;++e)m+=o[e],e<f-1&&(m+=", ");return m+=")",m;case A.A.LITERAL_REGEX:throw new d.A("Error generating style shader: Regular expressions are not supported.");case A.A.LITERAL_UNDEFINED:return p.NULL_SENTINEL;case A.A.BUILTIN_VARIABLE:if("tiles3d_tileset_time"===g)return g}},P.prototype.getVariables=function(e,t){let n,i,o;const r=this._type,s=this._value;if((0,c.A)(this._left))if(Array.isArray(this._left))for(n=this._left,i=n.length,o=0;o<i;++o)n[o].getVariables(e,this);else this._left.getVariables(e,this);if((0,c.A)(this._right)&&this._right.getVariables(e,this),(0,c.A)(this._test)&&this._test.getVariables(e,this),Array.isArray(this._value))for(n=this._value,i=n.length,o=0;o<i;++o)n[o].getVariables(e,this);let a;switch(r){case A.A.VARIABLE:N(this)||e.push(s);break;case A.A.VARIABLE_IN_STRING:for(a=_.exec(s);null!==a;)e.push(a[1]),a=_.exec(s);break;case A.A.LITERAL_STRING:(0,c.A)(t)&&t._type===A.A.MEMBER&&N(t._left)&&e.push(s)}};const H=p},203576:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({VARIABLE:0,UNARY:1,BINARY:2,TERNARY:3,CONDITIONAL:4,MEMBER:5,FUNCTION_CALL:6,ARRAY:7,REGEX:8,VARIABLE_IN_STRING:9,LITERAL_NULL:10,LITERAL_BOOLEAN:11,LITERAL_NUMBER:12,LITERAL_STRING:13,LITERAL_COLOR:14,LITERAL_VECTOR:15,LITERAL_REGEX:16,LITERAL_UNDEFINED:17,BUILTIN_VARIABLE:18})},271845:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var i=n(491446),o=n(744603),r=n(982504),s=n(123245),a=n(320475),c=n(472360),l=n(677354),u=n(471147),d=n(595826),h=n(786101);function A(e,t,n,o){this._tileset=t,this._tile=n,this._resource=o,this._loader=e,(0,i.A)(this._tileset.gaussianSplatPrimitive)||(this._tileset.gaussianSplatPrimitive=new c.A({tileset:this._tileset})),this._originalPositions=void 0,this._originalRotations=void 0,this._originalScales=void 0,this.gltfPrimitive=void 0,this.worldTransform=void 0,this.featurePropertiesDirty=!1,this._metadata=void 0,this._group=void 0,this._ready=!1,this._transformed=!1,this._sphericalHarmonicsDegree=0,this._sphericalHarmonicsCoefficientCount=0,this._packedSphericalHarmonicsData=void 0}A.tilesetRequiresGaussianSplattingExt=function(e){let t=!1,n=!1;return e.isGltfExtensionRequired instanceof Function&&(t=e.isGltfExtensionRequired("KHR_gaussian_splatting")&&e.isGltfExtensionRequired("KHR_gaussian_splatting_compression_spz_2"),n=e.isGltfExtensionRequired("KHR_spz_gaussian_splats_compression")),n&&(0,h.A)("KHR_spz_gaussian_splats_compression","Support for the original KHR_spz_gaussian_splats_compression extension has been deprecated in favor of the up to date KHR_gaussian_splatting and KHR_gaussian_splatting_compression_spz_2 extensions and will be removed in CesiumJS 1.135.\n\nPlease retile your tileset with the KHR_gaussian_splatting and KHR_gaussian_splatting_compression_spz_2 extensions."),t||n},Object.defineProperties(A.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return this.gltfPrimitive.attributes[0].count}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return this.gltfPrimitive.attributes.reduce((e,t)=>e+t.byteLength,0)}},texturesByteLength:{get:function(){const e=this._tileset.gaussianSplatPrimitive.gaussianSplatTexture,t=this._tileset.gaussianSplatPrimitive.selectedTileLength;return(0,i.A)(e)&&0!==t?e.sizeInBytes/t:0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},transformed:{get:function(){return this._transformed}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},group:{get:function(){return this._group},set:function(e){this._group=e}},sphericalHarmonicsCoefficientCount:{get:function(){return this._sphericalHarmonicsCoefficientCount}},sphericalHarmonicsDegree:{get:function(){return this._sphericalHarmonicsDegree}},packedSphericalHarmonicsData:{get:function(){return this._packedSphericalHarmonicsData}}});const p=new ArrayBuffer(4),f=new Float32Array(p),m=new Uint32Array(p);function g(e){f[0]=e;const t=m[0],n=t>>31&1,i=t>>23&255,o=8388607&t;let r;if(255===i)r=n<<15|31744|(o?512:0);else if(0===i)r=n<<15;else{const e=i-127+15;r=e>=31?n<<15|31744:e<=0?n<<15:n<<15|e<<10|o>>>13}return r}function _(e){const t=function(e){return(e.startsWith("KHR_gaussian_splatting:")?"KHR_gaussian_splatting:":"_")+"SH_DEGREE_"}(e),n=t.length,i=e.indexOf("_COEF_",n);return{l:parseInt(e.slice(n,i),10),n:parseInt(e.slice(i+6),10)}}A.fromGltf=async function(e,t,n,c){const l=n,u=o.A.createIfNeeded(l),d={releaseGltfJson:!1,upAxis:a.A.Y,forwardAxis:a.A.Z};(0,i.A)(c.asset)?(d.gltfJson=c,d.baseResource=u,d.gltfResource=u):c instanceof Uint8Array?(d.typedArray=c,d.baseResource=u,d.gltfResource=u):d.gltfResource=o.A.createIfNeeded(c);const h=new r.A(d);try{await h.load()}catch(e){throw h.destroy(),new s.A(`Failed to load glTF: ${e.message}`)}return new A(h,e,t,n)},A.prototype.update=function(e,t){const n=this._loader;if(this._ready)!this._transformed&&e.root.content.ready&&(c.A.transformTile(this._tile),this._transformed=!0);else if(t.afterRender.push(()=>!0),(0,i.A)(n)){if(this._resourcesLoaded){this.gltfPrimitive=n.components.scene.nodes[0].primitives[0],this.worldTransform=n.components.scene.nodes[0].matrix,this._ready=!0,this._originalPositions=new Float32Array(u.A.getAttributeBySemantic(this.gltfPrimitive,d.A.POSITION).typedArray),this._originalRotations=new Float32Array(u.A.getAttributeBySemantic(this.gltfPrimitive,d.A.ROTATION).typedArray),this._originalScales=new Float32Array(u.A.getAttributeBySemantic(this.gltfPrimitive,d.A.SCALE).typedArray);const{l:e,n:t}=function(e){switch(e.filter(e=>e.name.includes("SH_DEGREE_")).length){default:case 0:return{l:0,n:0};case 3:return{l:1,n:9};case 8:return{l:2,n:24};case 15:return{l:3,n:45}}}(this.gltfPrimitive.attributes);return this._sphericalHarmonicsDegree=e,this._sphericalHarmonicsCoefficientCount=t,void(this._packedSphericalHarmonicsData=function(e){const t=e.sphericalHarmonicsDegree,n=e.sphericalHarmonicsCoefficientCount,i=e.pointsLength*(n*(2/3)),o=new Uint32Array(i),r=e.gltfPrimitive.attributes.filter(e=>e.name.includes("SH_DEGREE_"));let s=0;const a=[0,9,24];switch(t){case 1:s=9;break;case 2:s=24;break;case 3:s=45}r.sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0);const c=s*(2/3);for(let t=0;t<r.length;t++){const{l:n,n:i}=_(r[t].name);for(let s=0;s<e.pointsLength;s++){const e=s*c+2*a[n-1]/3+2*i,l=3*s;o[e]=g(r[t].typedArray[l])|g(r[t].typedArray[l+1])<<16,o[e+1]=g(r[t].typedArray[l+2])}}return o}(this))}this._resourcesLoaded=n.process(t)}else this._ready=!0},A.prototype.hasProperty=function(e,t){return!1},A.prototype.getFeature=function(e){},A.prototype.applyDebugSettings=function(e,t){},A.prototype.applyStyle=function(e){},A.prototype.pick=function(e,t,n){},A.prototype.isDestroyed=function(){return this.isDestroyed},A.prototype.destroy=function(){return this.splatPrimitive=void 0,(0,i.A)(this._tileset.gaussianSplatPrimitive)&&!this._tileset.gaussianSplatPrimitive.isDestroyed()&&this._tileset.gaussianSplatPrimitive.destroy(),this._tileset.gaussianSplatPrimitive=void 0,this._tile=void 0,this._tileset=void 0,this._resource=void 0,this._ready=!1,this._group=void 0,this._metadata=void 0,this._resourcesLoaded=!1,(0,i.A)(this._loader)&&(this._loader.destroy(),this._loader=void 0),(0,l.A)(this)};const y=A},472360:(e,t,n)=>{"use strict";n.d(t,{A:()=>G});var i=n(915325),o=n(584164),r=n(471147),s=n(44706),a=n(257601),c=n(571804),l=n(57775),u=n(276904),d=n(654799),h=n(616e3),A=n(873536),p=n(200646),f=n(760866),m=n(624512),g=n(988617),_=n(814617),y=n(402330),v=n(377496),T=n(944479),b=n(305439),w=n(508380),x=n(442790),C=n(40118),E=n(376758),S=n(491446),I=n(595826),P=n(730839),D=n(995537),O=n(320475),R=n(267980),M=n(99479),L=n(913419),N=n(677354),B=n(430332);const F=new o.A,U=new o.A,k=new o.A,V=new o.A;function z(e,t){return new h.A({context:e,source:{width:t.width,height:t.height,arrayBufferView:t.data},preMultiplyAlpha:!1,skipColorSpaceConversion:!0,pixelFormat:u.A.RGBA_INTEGER,pixelDatatype:l.A.UNSIGNED_INT,flipY:!1,sampler:d.A.NEAREST})}function H(e){e=e??i.A.EMPTY_OBJECT,this._positions=void 0,this._rotations=void 0,this._scales=void 0,this._colors=void 0,this._indexes=void 0,this._numSplats=0,this._needsGaussianSplatTexture=!0,this._prevViewMatrix=new o.A,this._debugShowBoundingVolume=e.debugShowBoundingVolume??!1,this.gaussianSplatTexture=void 0,this.sphericalHarmonicsTexture=void 0,this._lastTextureWidth=0,this._lastTextureHeight=0,this._vertexArray=void 0,this._vertexArrayLen=-1,this._splitDirection=L.A.NONE,this._dirty=!1,this._tileset=e.tileset,this._baseTilesetUpdate=this._tileset.update,this._tileset.update=this._wrappedUpdate.bind(this),this._tileset.tileLoad.addEventListener(this.onTileLoad,this),this._tileset.tileVisible.addEventListener(this.onTileVisible,this),this.selectedTileLength=0,this._ready=!1,this._hasGaussianSplatTexture=!1,this._gaussianSplatTexturePending=!1,this._drawCommand=void 0,this._rootTransform=void 0,this._axisCorrectionMatrix=r.A.getAxisCorrectionMatrix(O.A.Y,O.A.X,new o.A),this._isDestroyed=!1,this._sorterState=0,this._sorterPromise=void 0,this._sorterError=void 0}Object.defineProperties(H.prototype,{ready:{get:function(){return this._ready}},splitDirection:{get:function(){return this._splitDirection},set:function(e){this._splitDirection!==e&&(this._splitDirection=e,this._dirty=!0)}}}),H.prototype._wrappedUpdate=function(e){this._baseTilesetUpdate.call(this._tileset,e),this.update(e)},H.prototype.destroy=function(){this._positions=void 0,this._rotations=void 0,this._scales=void 0,this._colors=void 0,this._indexes=void 0,(0,S.A)(this.gaussianSplatTexture)&&(this.gaussianSplatTexture.destroy(),this.gaussianSplatTexture=void 0);const e=this._drawCommand;return(0,S.A)(e)&&(e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy()),(0,S.A)(this._vertexArray)&&(this._vertexArray.destroy(),this._vertexArray=void 0),this._tileset.update=this._baseTilesetUpdate.bind(this._tileset),(0,N.A)(this)},H.prototype.isDestroyed=function(){return this._isDestroyed},H.prototype.onTileLoad=function(e){this._dirty=!0},H.prototype.onTileVisible=function(e){},H.transformTile=function(e){const t=e.computedTransform,n=e.content.gltfPrimitive,i=e.tileset.gaussianSplatPrimitive,s=o.A.multiplyTransformation(t,i._axisCorrectionMatrix,F);o.A.multiplyTransformation(s,e.content.worldTransform,s);const a=o.A.multiply(e.tileset.modelMatrix,o.A.fromArray(e.tileset.root.transform),U),c=o.A.inverse(a,k),l=o.A.multiplyTransformation(c,s,F),u=e.content._originalPositions,d=e.content._originalRotations,h=e.content._originalScales,A=r.A.getAttributeBySemantic(n,I.A.POSITION).typedArray,p=r.A.getAttributeBySemantic(n,I.A.ROTATION).typedArray,f=r.A.getAttributeBySemantic(n,I.A.SCALE).typedArray,m=new R.A,g=new M.A,_=new R.A;for(let e=0;e<u.length/3;++e)m.x=u[3*e],m.y=u[3*e+1],m.z=u[3*e+2],g.x=d[4*e],g.y=d[4*e+1],g.z=d[4*e+2],g.w=d[4*e+3],_.x=h[3*e],_.y=h[3*e+1],_.z=h[3*e+2],o.A.fromTranslationQuaternionRotationScale(m,g,_,k),o.A.multiplyTransformation(l,k,k),o.A.getTranslation(k,m),o.A.getRotation(k,g),o.A.getScale(k,_),A[3*e]=m.x,A[3*e+1]=m.y,A[3*e+2]=m.z,p[4*e]=g.x,p[4*e+1]=g.y,p[4*e+2]=g.z,p[4*e+3]=g.w,f[3*e]=_.x,f[3*e+1]=_.y,f[3*e+2]=_.z},H.generateSplatTexture=function(e,t){e._gaussianSplatTexturePending=!0;const n=a.A.generateFromAttributes({attributes:{positions:new Float32Array(e._positions),scales:new Float32Array(e._scales),rotations:new Float32Array(e._rotations),colors:new Uint8Array(e._colors)},count:e._numSplats});(0,S.A)(n)?n.then(n=>{if(e._gaussianSplatTexture)if(e._lastTextureHeight!==n.height||e._lastTextureWidth!==n.width){const i=e.gaussianSplatTexture;e._gaussianSplatTexture=z(t.context,n),i.destroy()}else e.gaussianSplatTexture.copyFrom({source:{width:n.width,height:n.height,arrayBufferView:n.data}});else e.gaussianSplatTexture=z(t.context,n);e._lastTextureHeight=n.height,e._lastTextureWidth=n.width,e._hasGaussianSplatTexture=!0,e._needsGaussianSplatTexture=!1,e._gaussianSplatTexturePending=!1,(!(0,S.A)(e._indexes)||e._indexes.length<e._numSplats)&&(e._indexes=new Uint32Array(e._numSplats));for(let t=0;t<e._numSplats;++t)e._indexes[t]=t}).catch(t=>{console.error("Error generating Gaussian splat texture:",t),e._gaussianSplatTexturePending=!1}):e._gaussianSplatTexturePending=!1},H.buildGSplatDrawCommand=function(e,t){const n=e._tileset,i=new A.A(e),{shaderBuilder:s}=i,a=i.renderStateOptions;a.cull.enabled=!1,a.depthMask=!1,a.depthTest.enabled=!0,a.blending=p.A.PRE_MULTIPLIED_ALPHA_BLEND,i.alphaOptions.pass=f.A.GAUSSIAN_SPLATS,s.addAttribute("vec2","a_screenQuadPosition"),s.addAttribute("float","a_splatIndex"),s.addVarying("vec4","v_splatColor"),s.addVarying("vec2","v_vertPos"),s.addUniform("float","u_splitDirection",m.A.VERTEX),s.addVarying("float","v_splitDirection"),s.addUniform("highp usampler2D","u_splatAttributeTexture",m.A.VERTEX),s.addUniform("float","u_sphericalHarmonicsDegree",m.A.VERTEX),s.addUniform("float","u_splatScale",m.A.VERTEX),s.addUniform("vec3","u_cameraPositionWC",m.A.VERTEX),s.addUniform("mat3","u_inverseModelRotation",m.A.VERTEX);const l=i.uniformMap;l.u_splatAttributeTexture=function(){return e.gaussianSplatTexture},e._sphericalHarmonicsDegree>0&&(s.addDefine("HAS_SPHERICAL_HARMONICS","1",m.A.VERTEX),s.addUniform("highp usampler2D","u_sphericalHarmonicsTexture",m.A.VERTEX),l.u_sphericalHarmonicsTexture=function(){return e.sphericalHarmonicsTexture}),l.u_sphericalHarmonicsDegree=function(){return e._sphericalHarmonicsDegree},l.u_cameraPositionWC=function(){return R.A.clone(t.camera.positionWC)},l.u_inverseModelRotation=function(){const t=e._tileset,n=o.A.multiply(t.modelMatrix,o.A.fromArray(t.root.transform),F);return o.A.getRotation(o.A.inverse(n,k),V)},l.u_splitDirection=function(){return e.splitDirection},i.instanceCount=e._numSplats,i.count=4,i.primitiveType=y.A.TRIANGLE_STRIP,s.addVertexLines(g.A),s.addFragmentLines(_.A);const u=s.buildShaderProgram(t.context);let d=(0,E.A)(C.A.fromCache(i.renderStateOptions),!0);d.cull.face=r.A.getCullFace(n.modelMatrix,y.A.TRIANGLE_STRIP),d=C.A.fromCache(d);const h={screenQuadPosition:0,splatIndex:2},I=new D.A.Attribute;if(I.name="_SPLAT_INDEXES",I.typedArray=e._indexes,I.componentDatatype=c.A.UNSIGNED_INT,I.type=P.A.SCALAR,I.normalized=!1,I.count=i.instanceCount,I.constant=0,I.instanceDivisor=1,!(0,S.A)(e._vertexArray)||e._indexes.length>e._vertexArrayLen){const n=new T.A({attributes:{screenQuadPosition:new b.A({componentDatatype:c.A.FLOAT,componentsPerAttribute:2,values:[-1,-1,1,-1,1,1,-1,1],name:"_SCREEN_QUAD_POS",variableName:"screenQuadPosition"}),splatIndex:{...I,variableName:"splatIndex"}},primitiveType:y.A.TRIANGLE_STRIP});e._vertexArray=w.A.fromGeometry({context:t.context,geometry:n,attributeLocations:h,bufferUsage:x.A.DYNAMIC_DRAW,interleave:!1})}else e._vertexArray.getAttribute(1).vertexBuffer.copyFromArrayView(e._indexes);e._vertexArrayLen=e._indexes.length;const O=o.A.multiply(n.modelMatrix,o.A.fromArray(n.root.transform),U),M=new v.A({boundingVolume:n.boundingSphere,modelMatrix:O,uniformMap:l,renderState:d,vertexArray:e._vertexArray,shaderProgram:u,cull:a.cull.enabled,pass:f.A.GAUSSIAN_SPLATS,count:i.count,owner:this,instanceCount:i.instanceCount,primitiveType:y.A.TRIANGLE_STRIP,debugShowBoundingVolume:n.debugShowBoundingVolume,castShadows:!1,receiveShadows:!1});e._drawCommand=M},H.prototype.update=function(e){const t=this._tileset;if((0,S.A)(this._rootTransform)||(this._rootTransform=t.root.computedTransform),t.show&&0!==t._selectedTiles.length)if(this._drawCommand&&e.commandList.push(this._drawCommand),t._modelMatrixChanged)this._dirty=!0;else if(!0!==e.passes.pick){if(this.splitDirection!==t.splitDirection&&(this.splitDirection=t.splitDirection),0===this._sorterState){if(!this._dirty&&o.A.equals(e.camera.viewMatrix,this._prevViewMatrix))return;if(0!==t._selectedTiles.length&&t._selectedTiles.length!==this.selectedTileLength){this._numSplats=0,this._positions=void 0,this._rotations=void 0,this._scales=void 0,this._colors=void 0,this._indexes=void 0,this._shData=void 0,this._needsGaussianSplatTexture=!0,this._gaussianSplatTexturePending=!1;const e=t._selectedTiles,n=e.reduce((e,t)=>e+t.content.pointsLength,0),i=(t,i)=>{let o,r=0;for(const s of e){const e=i(s.content.gltfPrimitive);(0,S.A)(o)||(o=c.A.createTypedArray(t,n*P.A.getNumberOfComponents(e.type))),o.set(e.typedArray,r),r+=e.typedArray.length}return o},o=()=>{let t=0;for(const i of e){const e=i.content.packedSphericalHarmonicsData;if(i.content.sphericalHarmonicsDegree>0){if(!(0,S.A)(this._shData)){let e;switch(i.content.sphericalHarmonicsDegree){case 1:e=9;break;case 2:e=24;break;case 3:e=45}this._shData=new Uint32Array(n*(e*(2/3)))}this._shData.set(e,t),t+=e.length}}};this._positions=i(c.A.FLOAT,e=>r.A.getAttributeBySemantic(e,I.A.POSITION)),this._scales=i(c.A.FLOAT,e=>r.A.getAttributeBySemantic(e,I.A.SCALE)),this._rotations=i(c.A.FLOAT,e=>r.A.getAttributeBySemantic(e,I.A.ROTATION)),this._colors=i(c.A.UNSIGNED_BYTE,e=>r.A.getAttributeBySemantic(e,I.A.COLOR)),o(),this._sphericalHarmonicsDegree=e[0].content.sphericalHarmonicsDegree,this._numSplats=n,this.selectedTileLength=t._selectedTiles.length}if(0===this._numSplats)return;if(this._needsGaussianSplatTexture){if(!this._gaussianSplatTexturePending&&(H.generateSplatTexture(this,e),(0,S.A)(this._shData))){const o=this.sphericalHarmonicsTexture,r=B.A.maximumTextureSize,s=t._selectedTiles[0].content.sphericalHarmonicsCoefficientCount/3,a=Math.floor(r/s),c=a*(2*s),A=new Uint32Array(r*Math.ceil(this._numSplats/a)*2);let p=0;for(let e=0;p<this._shData.length;e+=2*r)A.set(this._shData.subarray(p,p+c),e),p+=c;this.sphericalHarmonicsTexture=(n=e.context,i={data:A,width:r,height:Math.ceil(this._numSplats/a)},new h.A({context:n,source:{width:i.width,height:i.height,arrayBufferView:i.data},preMultiplyAlpha:!1,skipColorSpaceConversion:!0,pixelFormat:u.A.RG_INTEGER,pixelDatatype:l.A.UNSIGNED_INT,flipY:!1,sampler:d.A.NEAREST})),(0,S.A)(o)&&o.destroy()}return}if(o.A.clone(e.camera.viewMatrix,this._prevViewMatrix),o.A.multiply(e.camera.viewMatrix,this._rootTransform,F),(0,S.A)(this._sorterPromise)||(this._sorterPromise=s.A.radixSortIndexes({primitive:{positions:new Float32Array(this._positions),modelView:Float32Array.from(F),count:this._numSplats},sortType:"Index"})),!(0,S.A)(this._sorterPromise))return void(this._sorterState=1);this._sorterPromise.catch(e=>{this._sorterState=4,this._sorterError=e}),this._sorterPromise.then(e=>{this._indexes=e,this._sorterState=3})}else if(1===this._sorterState){if((0,S.A)(this._sorterPromise)||(this._sorterPromise=s.A.radixSortIndexes({primitive:{positions:new Float32Array(this._positions),modelView:Float32Array.from(F),count:this._numSplats},sortType:"Index"})),!(0,S.A)(this._sorterPromise))return void(this._sorterState=1);this._sorterPromise.catch(e=>{this._sorterState=4,this._sorterError=e}),this._sorterPromise.then(e=>{this._indexes=e,this._sorterState=3}),this._sorterState=2}else{if(2===this._sorterState)return;if(3===this._sorterState)H.buildGSplatDrawCommand(this,e),this._sorterState=0,this._dirty=!1,this._sorterPromise=void 0;else if(4===this._sorterState)throw this._sorterError}var n,i;this._dirty=!1}};const G=H},873536:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(469635),o=n(40118),r=n(523721),s=n(56241),a=n(624512);const c=function(e){const t=new i.A;this.shaderBuilder=t,this.uniformMap={},this.renderStateOptions=o.A.getState(o.A.fromCache({depthTest:{enabled:!0,func:r.A.LESS_OR_EQUAL}})),this.alphaOptions=new s.A,this.hasSkipLevelOfDetail=!1,e._useLogDepth&&t.addDefine("LOG_DEPTH_READ_ONLY",void 0,a.A.FRAGMENT)}},44706:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(491446),o=n(520098),r=n(123245),s=n(971724);function a(){}a._maxSortingConcurrency=Math.max(o.A.hardwareConcurrency-1,1),a._sorterTaskProcessor=void 0,a._taskProcessorReady=!1,a._error=void 0,a._getSorterTaskProcessor=function(){if(!(0,i.A)(a._sorterTaskProcessor)){const e=new s.A("gaussianSplatSorter",a._maxSortingConcurrency);e.initWebAssemblyModule({wasmBinaryFile:"ThirdParty/wasm_splats_bg.wasm"}).then(function(e){e?a._taskProcessorReady=!0:a._error=new r.A("Gaussian splat sorter could not be initialized.")}).catch(e=>{a._error=e}),a._sorterTaskProcessor=e}return a._sorterTaskProcessor},a.radixSortIndexes=function(e){const t=a._getSorterTaskProcessor();if((0,i.A)(a._error))throw a._error;if(a._taskProcessorReady)return t.scheduleTask(e,[e.primitive.positions.buffer])};const c=a},257601:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(491446),o=n(520098),r=n(123245),s=n(971724);function a(){}a._maxSortingConcurrency=Math.max(o.A.hardwareConcurrency-1,1),a._textureTaskProcessor=void 0,a._taskProcessorReady=!1,a._error=void 0,a._getTextureTaskProcessor=function(){if(!(0,i.A)(a._textureTaskProcessor)){const e=new s.A("gaussianSplatTextureGenerator",a._maxSortingConcurrency);e.initWebAssemblyModule({wasmBinaryFile:"ThirdParty/wasm_splats_bg.wasm"}).then(function(e){e?a._taskProcessorReady=!0:a._error=new r.A("Gaussian splat sorter could not be initialized.")}).catch(e=>{a._error=e}),a._textureTaskProcessor=e}return a._textureTaskProcessor},a.generateFromAttributes=function(e){const t=a._getTextureTaskProcessor();if((0,i.A)(a._error))throw a._error;if(!a._taskProcessorReady)return;const{attributes:n}=e;return t.scheduleTask(e,[n.positions.buffer,n.scales.buffer,n.rotations.buffer,n.colors.buffer])};const c=a},823064:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var i=n(267980),o=n(491446),r=n(677354),s=n(605971),a=n(604752),c=n(584164),l=n(123245),u=n(184483),d=n(301350);function h(e,t,n,r,s){this._tileset=e,this._tile=t,this._resource=n,this._geometries=void 0,this._metadata=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,this._group=void 0,this._ready=!1,function(e,t,n){n=n??0;const r=new Uint8Array(t),s=new DataView(t);n+=A;const h=s.getUint32(n,!0);if(1!==h)throw new l.A(`Only Geometry tile version 1 is supported.  Version ${h} is not.`);n+=A;const p=s.getUint32(n,!0);if(n+=A,0===p)return void(e._ready=!0);const f=s.getUint32(n,!0);if(n+=A,0===f)throw new l.A("Feature table must have a byte length greater than zero");const m=s.getUint32(n,!0);n+=A;const g=s.getUint32(n,!0);n+=A;const _=s.getUint32(n,!0);n+=A;const y=(0,a.A)(r,n,f);n+=f;const v=new Uint8Array(t,n,m);let T,b;n+=m,g>0&&(T=(0,a.A)(r,n,g),n+=g,_>0&&(b=new Uint8Array(t,n,_),b=new Uint8Array(b)));const w=y.BOXES_LENGTH??0,x=y.CYLINDERS_LENGTH??0,C=y.ELLIPSOIDS_LENGTH??0,E=y.SPHERES_LENGTH??0,S=w+x+C+E,I=new u.A(e,S,T,b,function(e){return function(t,n){(0,o.A)(e._geometries)&&e._geometries.updateCommands(t,n)}}(e));if(e._batchTable=I,0===S)return;const P=e.tile.computedTransform;let D;(0,o.A)(y.RTC_CENTER)&&(D=i.A.unpack(y.RTC_CENTER),c.A.multiplyByPoint(P,D,D));const O=function(e,t){let n,i,r,s,a;const c=e.BOXES_LENGTH??0,u=e.CYLINDERS_LENGTH??0,d=e.ELLIPSOIDS_LENGTH??0,h=e.SPHERES_LENGTH??0;if(c>0&&(0,o.A)(e.BOX_BATCH_IDS)){const i=t.byteOffset+e.BOX_BATCH_IDS.byteOffset;n=new Uint16Array(t.buffer,i,c)}if(u>0&&(0,o.A)(e.CYLINDER_BATCH_IDS)){const n=t.byteOffset+e.CYLINDER_BATCH_IDS.byteOffset;i=new Uint16Array(t.buffer,n,u)}if(d>0&&(0,o.A)(e.ELLIPSOID_BATCH_IDS)){const n=t.byteOffset+e.ELLIPSOID_BATCH_IDS.byteOffset;r=new Uint16Array(t.buffer,n,d)}if(h>0&&(0,o.A)(e.SPHERE_BATCH_IDS)){const n=t.byteOffset+e.SPHERE_BATCH_IDS.byteOffset;s=new Uint16Array(t.buffer,n,h)}const A=(0,o.A)(n)||(0,o.A)(i)||(0,o.A)(r)||(0,o.A)(s),p=c>0&&!(0,o.A)(n)||u>0&&!(0,o.A)(i)||d>0&&!(0,o.A)(r)||h>0&&!(0,o.A)(s);if(A&&p)throw new l.A("If one group of batch ids is defined, then all batch ids must be defined");if(!((0,o.A)(n)||(0,o.A)(i)||(0,o.A)(r)||(0,o.A)(s))){let e=0;if(!(0,o.A)(n)&&c>0)for(n=new Uint16Array(c),a=0;a<c;++a)n[a]=e++;if(!(0,o.A)(i)&&u>0)for(i=new Uint16Array(u),a=0;a<u;++a)i[a]=e++;if(!(0,o.A)(r)&&d>0)for(r=new Uint16Array(d),a=0;a<d;++a)r[a]=e++;if(!(0,o.A)(s)&&h>0)for(s=new Uint16Array(h),a=0;a<h;++a)s[a]=e++}return{boxes:n,cylinders:i,ellipsoids:r,spheres:s}}(y,v);if(w>0||x>0||C>0||E>0){let t,n,i,o;if(w>0){const e=v.byteOffset+y.BOXES.byteOffset;t=new Float32Array(v.buffer,e,d.A.packedBoxLength*w)}if(x>0){const e=v.byteOffset+y.CYLINDERS.byteOffset;n=new Float32Array(v.buffer,e,d.A.packedCylinderLength*x)}if(C>0){const e=v.byteOffset+y.ELLIPSOIDS.byteOffset;i=new Float32Array(v.buffer,e,d.A.packedEllipsoidLength*C)}if(E>0){const e=v.byteOffset+y.SPHERES.byteOffset;o=new Float32Array(v.buffer,e,d.A.packedSphereLength*E)}return e._geometries=new d.A({boxes:t,boxBatchIds:O.boxes,cylinders:n,cylinderBatchIds:O.cylinders,ellipsoids:i,ellipsoidBatchIds:O.ellipsoids,spheres:o,sphereBatchIds:O.spheres,center:D,modelMatrix:P,batchTable:I,boundingVolume:e.tile.boundingVolume.boundingVolume}),e}Promise.resolve(e)}(this,r,s)}Object.defineProperties(h.prototype,{featuresLength:{get:function(){return(0,o.A)(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return(0,o.A)(this._geometries)?this._geometries.trianglesLength:0}},geometryByteLength:{get:function(){return(0,o.A)(this._geometries)?this._geometries.geometryByteLength:0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return(0,o.A)(this._batchTable)?this._batchTable.batchTableByteLength:0}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},batchTable:{get:function(){return this._batchTable}},group:{get:function(){return this._group},set:function(e){this._group=e}}});const A=Uint32Array.BYTES_PER_ELEMENT;function p(e){const t=e.featuresLength;if(!(0,o.A)(e._features)&&t>0){const n=new Array(t);(0,o.A)(e._geometries)&&e._geometries.createFeatures(e,n),e._features=n}}h.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},h.prototype.getFeature=function(e){const t=this.featuresLength;if(!(0,o.A)(e)||e<0||e>=t)throw new s.A(`batchId is required and between zero and featuresLength - 1 (${t-1}).`);return p(this),this._features[e]},h.prototype.applyDebugSettings=function(e,t){(0,o.A)(this._geometries)&&this._geometries.applyDebugSettings(e,t)},h.prototype.applyStyle=function(e){p(this),(0,o.A)(this._geometries)&&this._geometries.applyStyle(e,this._features)},h.prototype.update=function(e,t){(0,o.A)(this._geometries)&&(this._geometries.classificationType=this._tileset.classificationType,this._geometries.debugWireframe=this._tileset.debugWireframe,this._geometries.update(t)),(0,o.A)(this._batchTable)&&this._geometries.ready&&(this._batchTable.update(e,t),this._ready=!0)},h.prototype.pick=function(e,t,n){},h.prototype.isDestroyed=function(){return!1},h.prototype.destroy=function(){return this._geometries=this._geometries&&this._geometries.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),(0,r.A)(this)};const f=h},463823:(e,t,n)=>{"use strict";n.d(t,{A:()=>g});var i=n(336946),o=n(491446),r=n(605971),s=n(123245),a=n(789989);function c(e){const t=[],n=e.features;for(let e=0;e<n.length;++e){const r=n[e],s=new a.A;if(s.data=r,s.properties=r.properties,s.configureNameFromProperties(r.properties),s.configureDescriptionFromProperties(r.properties),(0,o.A)(r.geometry)&&"Point"===r.geometry.type){const e=r.geometry.coordinates[0],t=r.geometry.coordinates[1];s.position=i.A.fromDegrees(e,t)}t.push(s)}return t}const l="http://www.mapinfo.com/mxp";function u(e){const t=e.documentElement;if("MultiFeatureCollection"===t.localName&&t.namespaceURI===l)return function(e){const t=[],n=e.documentElement.getElementsByTagNameNS(l,"Feature");for(let e=0;e<n.length;++e){const i=n[e],o={},r=i.getElementsByTagNameNS(l,"Val");for(let e=0;e<r.length;++e){const t=r[e];if(t.hasAttribute("ref")){const e=t.getAttribute("ref"),n=t.textContent.trim();o[e]=n}}const s=new a.A;s.data=i,s.properties=o,s.configureNameFromProperties(o),s.configureDescriptionFromProperties(o),t.push(s)}return t}(e);if("FeatureInfoResponse"===t.localName&&"http://www.esri.com/wms"===t.namespaceURI)return function(e){const t=e.documentElement,n=[];let i;const o=t.getElementsByTagNameNS("*","FIELDS");if(o.length>0)for(let e=0;e<o.length;++e){const t=o[e];i={};const r=t.attributes;for(let e=0;e<r.length;++e){const t=r[e];i[t.name]=t.value}n.push(h(t,i))}else{const e=t.getElementsByTagNameNS("*","FeatureInfo");for(let t=0;t<e.length;++t){const o=e[t];i={};const r=o.childNodes;for(let e=0;e<r.length;++e){const t=r[e];t.nodeType===Node.ELEMENT_NODE&&(i[t.localName]=t.textContent)}n.push(h(o,i))}}return n}(e);if("FeatureCollection"===t.localName&&"http://www.opengis.net/wfs"===t.namespaceURI)return function(e){const t=[],n=e.documentElement.getElementsByTagNameNS("http://www.opengis.net/gml","featureMember");for(let e=0;e<n.length;++e){const i=n[e],o={};d(i,o),t.push(h(i,o))}return t}(e);if("ServiceExceptionReport"===t.localName)throw new s.A((new XMLSerializer).serializeToString(t));return"msGMLOutput"===t.localName?function(e){const t=[];let n;const i=e.documentElement.childNodes;for(let e=0;e<i.length;e++)if(i[e].nodeType===Node.ELEMENT_NODE){n=i[e];break}if(!(0,o.A)(n))throw new s.A("Unable to find first child of the feature info xml document");const r=n.childNodes;for(let e=0;e<r.length;++e){const n=r[e];if(n.nodeType===Node.ELEMENT_NODE){const e={};d(n,e),t.push(h(n,e))}}return t}(e):function(e){const t=(new XMLSerializer).serializeToString(e),n=document.createElement("div"),i=document.createElement("pre");i.textContent=t,n.appendChild(i);const o=new a.A;return o.data=e,o.description=n.innerHTML,[o]}(e)}function d(e,t){let n=!0;for(let i=0;i<e.childNodes.length;++i){const o=e.childNodes[i];o.nodeType===Node.ELEMENT_NODE&&(n=!1),"Point"!==o.localName&&"LineString"!==o.localName&&"Polygon"!==o.localName&&"boundedBy"!==o.localName&&o.hasChildNodes()&&d(o,t)&&(t[o.localName]=o.textContent)}return n}function h(e,t){const n=new a.A;return n.data=e,n.properties=t,n.configureNameFromProperties(t),n.configureDescriptionFromProperties(t),n}const A=/<body>\s*<\/body>/im,p=/<ServiceExceptionReport([\s\S]*)<\/ServiceExceptionReport>/im,f=/<title>([\s\S]*)<\/title>/im;function m(e){if(A.test(e))return;if(p.test(e))return;let t;const n=f.exec(e);n&&n.length>1&&(t=n[1]);const i=new a.A;return i.name=t,i.description=e,i.data=e,[i]}const g=function(e,t,n){if(!(0,o.A)(e))throw new r.A("type is required.");if(this.type=e,!(0,o.A)(t))if("json"===e)t="application/json";else if("xml"===e)t="text/xml";else if("html"===e)t="text/html";else{if("text"!==e)throw new r.A('format is required when type is not "json", "xml", "html", or "text".');t="text/plain"}if(this.format=t,!(0,o.A)(n))if("json"===e)n=c;else if("xml"===e)n=u;else if("html"===e)n=m;else{if("text"!==e)throw new r.A('callback is required when type is not "json", "xml", "html", or "text".');n=m}this.callback=n}},582047:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(369031),o=n(915325),r=n(491446),s=n(800859),a=n(840225),c=n(569445),l=n(48660);function u(e){const t=(e=e??o.A.EMPTY_OBJECT).resourceCache,n=e.gltf,r=e.bufferViewId,a=e.gltfResource,c=e.baseResource,u=e.cacheKey;i.A.typeOf.func("options.resourceCache",t),i.A.typeOf.object("options.gltf",n),i.A.typeOf.number("options.bufferViewId",r),i.A.typeOf.object("options.gltfResource",a),i.A.typeOf.object("options.baseResource",c);const d=n.bufferViews[r];let h,A,p,f,m=d.buffer,g=d.byteOffset,_=d.byteLength,y=!1;if((0,s.A)(d,"EXT_meshopt_compression")){const e=d.extensions.EXT_meshopt_compression;m=e.buffer,g=e.byteOffset??0,_=e.byteLength,y=!0,h=e.byteStride,A=e.count,p=e.mode,f=e.filter??"NONE"}const v=n.buffers[m];this._hasMeshopt=y,this._meshoptByteStride=h,this._meshoptCount=A,this._meshoptMode=p,this._meshoptFilter=f,this._resourceCache=t,this._gltfResource=a,this._baseResource=c,this._buffer=v,this._bufferId=m,this._byteOffset=g,this._byteLength=_,this._cacheKey=u,this._bufferLoader=void 0,this._typedArray=void 0,this._state=l.A.UNLOADED,this._promise=void 0}(0,r.A)(Object.create)&&(u.prototype=Object.create(c.A.prototype),u.prototype.constructor=u),Object.defineProperties(u.prototype,{cacheKey:{get:function(){return this._cacheKey}},typedArray:{get:function(){return this._typedArray}}}),u.prototype.load=async function(){return(0,r.A)(this._promise)||(this._state=l.A.LOADING,this._promise=async function(e){try{const t=function(e){const t=e._resourceCache,n=e._buffer;if((0,r.A)(n.uri)){const i=e._baseResource.getDerivedResource({url:n.uri});return t.getExternalBufferLoader({resource:i})}return t.getEmbeddedBufferLoader({parentResource:e._gltfResource,bufferId:e._bufferId})}(e);if(e._bufferLoader=t,await t.load(),e.isDestroyed())return;const n=t.typedArray,i=new Uint8Array(n.buffer,n.byteOffset+e._byteOffset,e._byteLength);if(e.unload(),e._typedArray=i,e._hasMeshopt){const t=e._meshoptCount,n=e._meshoptByteStride,i=new Uint8Array(t*n);a.fK.decodeGltfBuffer(i,t,n,e._typedArray,e._meshoptMode,e._meshoptFilter),e._typedArray=i}return e._state=l.A.READY,e}catch(t){if(e.isDestroyed())return;e.unload(),e._state=l.A.FAILED;const n="Failed to load buffer view";throw e.getError(n,t)}}(this)),this._promise},u.prototype.unload=function(){(0,r.A)(this._bufferLoader)&&!this._bufferLoader.isDestroyed()&&this._resourceCache.unload(this._bufferLoader),this._bufferLoader=void 0,this._typedArray=void 0};const d=u},201783:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var i=n(369031),o=n(571804),r=n(915325),s=n(491446),a=n(445848),c=n(569445),l=n(48660),u=n(595826);function d(e){const t=(e=e??r.A.EMPTY_OBJECT).resourceCache,n=e.gltf,o=e.primitive,s=e.draco,a=e.gltfResource,c=e.baseResource,u=e.cacheKey;i.A.typeOf.func("options.resourceCache",t),i.A.typeOf.object("options.gltf",n),i.A.typeOf.object("options.primitive",o),i.A.typeOf.object("options.draco",s),i.A.typeOf.object("options.gltfResource",a),i.A.typeOf.object("options.baseResource",c),this._resourceCache=t,this._gltfResource=a,this._baseResource=c,this._gltf=n,this._primitive=o,this._draco=s,this._cacheKey=u,this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodePromise=void 0,this._decodedData=void 0,this._state=l.A.UNLOADED,this._promise=void 0,this._dracoError=void 0}function h(e,t){throw e.unload(),e._state=l.A.FAILED,e.getError("Failed to load Draco",t)}(0,s.A)(Object.create)&&(d.prototype=Object.create(c.A.prototype),d.prototype.constructor=d),Object.defineProperties(d.prototype,{cacheKey:{get:function(){return this._cacheKey}},decodedData:{get:function(){return this._decodedData}}}),d.prototype.load=async function(){return(0,s.A)(this._promise)||(this._state=l.A.LOADING,this._promise=async function(e){const t=e._resourceCache;try{const n=t.getBufferViewLoader({gltf:e._gltf,bufferViewId:e._draco.bufferView,gltfResource:e._gltfResource,baseResource:e._baseResource});if(e._bufferViewLoader=n,await n.load(),e.isDestroyed())return;return e._bufferViewTypedArray=n.typedArray,e._state=l.A.PROCESSING,e}catch(t){if(e.isDestroyed())return;h(e,t)}}(this)),this._promise};const A={};function p(e){for(const t in A)if(A.hasOwnProperty(t)&&e.startsWith(t))return A[t]}A[u.A.POSITION]="POSITION",A[u.A.NORMAL]="NORMAL",A[u.A.COLOR]="COLOR",A[u.A.TEXCOORD]="TEX_COORD",d.prototype.process=function(e){if(i.A.typeOf.object("frameState",e),this._state===l.A.READY)return!0;if(this._state!==l.A.PROCESSING)return!1;if((0,s.A)(this._dracoError)&&h(this,this._dracoError),!(0,s.A)(this._bufferViewTypedArray))return!1;if((0,s.A)(this._decodePromise))return!1;const t=this._draco,n=this._primitive,r=this._gltf,c=r.bufferViews[t.bufferView],u=t.attributes,d=[];for(const e in n.attributes)if(n.attributes.hasOwnProperty(e)){const t=p(e);(0,s.A)(t)&&r.accessors[n.attributes[e]].componentType===o.A.FLOAT&&(d.includes(t)||d.push(t))}const A={array:new Uint8Array(this._bufferViewTypedArray),bufferView:c,compressedAttributes:u,dequantizeInShader:!0,attributesToSkipTransform:d},f=a.A.decodeBufferView(A);if(!(0,s.A)(f))return!1;this._decodePromise=async function(e,t){try{const n=await t;if(e.isDestroyed())return;return e.unload(),e._decodedData={indices:n.indexArray,vertexAttributes:n.attributeData},e._state=l.A.READY,e._baseResource}catch(t){if(e.isDestroyed())return;e._dracoError=t}}(this,f)},d.prototype.unload=function(){(0,s.A)(this._bufferViewLoader)&&this._resourceCache.unload(this._bufferViewLoader),this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodedData=void 0,this._gltf=void 0,this._primitive=void 0};const f=d},395989:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var i=n(369031),o=n(915325),r=n(491446),s=n(404547),a=n(471874),c=n(123245),l=n(569445),u=n(48660);function d(e){const t=(e=e??o.A.EMPTY_OBJECT).resourceCache,n=e.gltf,r=e.imageId,s=e.gltfResource,a=e.baseResource,c=e.cacheKey;i.A.typeOf.func("options.resourceCache",t),i.A.typeOf.object("options.gltf",n),i.A.typeOf.number("options.imageId",r),i.A.typeOf.object("options.gltfResource",s),i.A.typeOf.object("options.baseResource",a);const l=n.images[r],d=l.bufferView,h=l.uri;this._resourceCache=t,this._gltfResource=s,this._baseResource=a,this._gltf=n,this._bufferViewId=d,this._uri=h,this._cacheKey=c,this._bufferViewLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._state=u.A.UNLOADED,this._promise=void 0}function h(e){let t;return Array.isArray(e)&&(t=e.slice(1,e.length).map(function(e){return e.bufferView}),e=e[0]),{image:e,mipLevels:t}}function A(e,t,n){return e.unload(),e._state=u.A.FAILED,Promise.reject(e.getError(n,t))}(0,r.A)(Object.create)&&(d.prototype=Object.create(l.A.prototype),d.prototype.constructor=d),Object.defineProperties(d.prototype,{cacheKey:{get:function(){return this._cacheKey}},image:{get:function(){return this._image}},mipLevels:{get:function(){return this._mipLevels}}}),d.prototype.load=function(){return(0,r.A)(this._promise)?this._promise:(0,r.A)(this._bufferViewId)?(this._promise=async function(e){e._state=u.A.LOADING;const t=e._resourceCache;try{const n=t.getBufferViewLoader({gltf:e._gltf,bufferViewId:e._bufferViewId,gltfResource:e._gltfResource,baseResource:e._baseResource});if(e._bufferViewLoader=n,await n.load(),e.isDestroyed())return;const i=n.typedArray,o=await async function(e){const t=function(e){const t=e.subarray(0,2),n=e.subarray(0,4),i=e.subarray(8,12);if(255===t[0]&&216===t[1])return"image/jpeg";if(137===t[0]&&80===t[1])return"image/png";if(171===t[0]&&75===t[1])return"image/ktx2";if(82===n[0]&&73===n[1]&&70===n[2]&&70===n[3]&&87===i[0]&&69===i[1]&&66===i[2]&&80===i[3])return"image/webp";throw new c.A("Image format is not recognized")}(e);if("image/ktx2"===t){const t=new Uint8Array(e);return(0,a.A)(t)}return d._loadImageFromTypedArray({uint8Array:e,format:t,flipY:!1,skipColorSpaceConversion:!0})}(i);if(e.isDestroyed())return;const r=h(o);return e.unload(),e._image=r.image,e._mipLevels=r.mipLevels,e._state=u.A.READY,e}catch(t){if(e.isDestroyed())return;return A(e,t,"Failed to load embedded image")}}(this),this._promise):(this._promise=async function(e){e._state=u.A.LOADING;const t=e._baseResource,n=e._uri,i=t.getDerivedResource({url:n});try{const t=await function(e){const t=e.getUrlComponent(!1,!0);return p.test(t)?(0,a.A)(e):e.fetchImage({skipColorSpaceConversion:!0,preferImageBitmap:!0})}(i);if(e.isDestroyed())return;const n=h(t);return e.unload(),e._image=n.image,e._mipLevels=n.mipLevels,e._state=u.A.READY,e}catch(t){if(e.isDestroyed())return;return A(e,t,`Failed to load image: ${n}`)}}(this),this._promise)};const p=/(^data:image\/ktx2)|(\.ktx2$)/i;d.prototype.unload=function(){(0,r.A)(this._bufferViewLoader)&&!this._bufferViewLoader.isDestroyed()&&this._resourceCache.unload(this._bufferViewLoader),this._bufferViewLoader=void 0,this._uri=void 0,this._image=void 0,this._mipLevels=void 0,this._gltf=void 0},d._loadImageFromTypedArray=s.A;const f=d},385618:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var i=n(369031),o=n(571804),r=n(915325),s=n(491446),a=n(786101),c=n(605971),l=n(874915),u=n(641613),d=n(442790),h=n(666203),A=n(569445),p=n(48660);function f(e){const t=(e=e??r.A.EMPTY_OBJECT).resourceCache,n=e.gltf,o=e.accessorId,s=e.gltfResource,a=e.baseResource,l=e.primitive,u=e.draco,d=e.cacheKey,h=e.asynchronous??!0,A=e.loadBuffer??!1,f=e.loadTypedArray??!1;if(i.A.typeOf.func("options.resourceCache",t),i.A.typeOf.object("options.gltf",n),i.A.typeOf.number("options.accessorId",o),i.A.typeOf.object("options.gltfResource",s),i.A.typeOf.object("options.baseResource",a),!A&&!f)throw new c.A("At least one of loadBuffer and loadTypedArray must be true.");const m=n.accessors[o].componentType;this._resourceCache=t,this._gltfResource=s,this._baseResource=a,this._gltf=n,this._accessorId=o,this._indexDatatype=m,this._primitive=l,this._draco=u,this._cacheKey=d,this._asynchronous=h,this._loadBuffer=A,this._loadTypedArray=f,this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._state=p.A.UNLOADED,this._promise=void 0}(0,s.A)(Object.create)&&(f.prototype=Object.create(A.A.prototype),f.prototype.constructor=f),Object.defineProperties(f.prototype,{cacheKey:{get:function(){return this._cacheKey}},buffer:{get:function(){return this._buffer}},typedArray:{get:function(){return this._typedArray}},indexDatatype:{get:function(){return this._indexDatatype}}});const m=new _;function g(e,t){throw e.unload(),e._state=p.A.FAILED,e.getError("Failed to load index buffer",t)}function _(){this.typedArray=void 0,this.indexDatatype=void 0,this.context=void 0,this.buffer=void 0}function y(e,t,n){const i=u.A.createIndexBuffer({typedArray:e,context:n,usage:d.A.STATIC_DRAW,indexDatatype:t});return i.vertexArrayDestroyable=!1,i}f.prototype.load=async function(){return(0,s.A)(this._promise)?this._promise:(0,s.A)(this._draco)?(this._promise=async function(e){e._state=p.A.LOADING;const t=e._resourceCache;try{const n=t.getDracoLoader({gltf:e._gltf,primitive:e._primitive,draco:e._draco,gltfResource:e._gltfResource,baseResource:e._baseResource});if(e._dracoLoader=n,await n.load(),e.isDestroyed())return;return e._state=p.A.LOADED,e}catch(t){if(e.isDestroyed())return;g(e,t)}}(this),this._promise):(this._promise=async function(e){const t=e._gltf,n=e._accessorId,i=t.accessors[n].bufferView;e._state=p.A.LOADING;const o=e._resourceCache;try{const n=o.getBufferViewLoader({gltf:t,bufferViewId:i,gltfResource:e._gltfResource,baseResource:e._baseResource});if(e._bufferViewLoader=n,await n.load(),e.isDestroyed())return;const r=n.typedArray;return e._typedArray=function(e,t){const n=e._gltf,i=e._accessorId,o=n.accessors[i],r=o.count,s=o.componentType,c=l.A.getSizeInBytes(s);let u,d=t.buffer,h=t.byteOffset+o.byteOffset;if(h%c!==0){const e=new Uint8Array(d,h,r*c);d=new Uint8Array(e).buffer,h=0,(0,a.A)("index-buffer-unaligned",`The index array is not aligned to a ${c}-byte boundary.`)}return s===l.A.UNSIGNED_BYTE?u=new Uint8Array(d,h,r):s===l.A.UNSIGNED_SHORT?u=new Uint16Array(d,h,r):s===l.A.UNSIGNED_INT&&(u=new Uint32Array(d,h,r)),u}(e,r),e._state=p.A.PROCESSING,e}catch(t){if(e.isDestroyed())return;g(e,t)}}(this),this._promise)},_.prototype.set=function(e,t,n){this.typedArray=e,this.indexDatatype=t,this.context=n},_.prototype.execute=function(){this.buffer=y(this.typedArray,this.indexDatatype,this.context)},f.prototype.process=function(e){if(i.A.typeOf.object("frameState",e),this._state===p.A.READY)return!0;if(this._state!==p.A.LOADED&&this._state!==p.A.PROCESSING)return!1;let t,n=this._typedArray,r=this._indexDatatype;if((0,s.A)(this._dracoLoader))try{this._dracoLoader.process(e)&&(n=this._dracoLoader.decodedData.indices.typedArray,this._typedArray=n,r=o.A.fromTypedArray(n),this._indexDatatype=r)}catch(e){g(this,e)}if(!(0,s.A)(n))return!1;if(this._loadBuffer&&this._asynchronous){const i=m;if(i.set(n,r,e.context),!e.jobScheduler.execute(i,h.A.BUFFER))return!1;t=i.buffer}else this._loadBuffer&&(t=y(n,r,e.context));return this.unload(),this._buffer=t,this._typedArray=this._loadTypedArray?n:void 0,this._state=p.A.READY,this._resourceCache.statistics.addGeometryLoader(this),!0},f.prototype.unload=function(){(0,s.A)(this._buffer)&&this._buffer.destroy();const e=this._resourceCache;(0,s.A)(this._bufferViewLoader)&&!this._bufferViewLoader.isDestroyed()&&e.unload(this._bufferViewLoader),(0,s.A)(this._dracoLoader)&&e.unload(this._dracoLoader),this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._gltf=void 0,this._primitive=void 0};const v=f},560710:(e,t,n)=>{"use strict";n.d(t,{A:()=>C});var i=n(369031),o=n(915325),r=n(491446),s=n(604752),a=n(452684),c=n(647885),l=n(744603),u=n(123245),d=n(267047),h=n(865980),A=n(133240),p=n(512286),f=n(899557),m=n(913081),g=n(493435),_=n(569445),y=n(48660),v=n(471147);function T(e){const t=(e=e??o.A.EMPTY_OBJECT).resourceCache,n=e.gltfResource,r=e.baseResource,s=e.typedArray,a=e.gltfJson,c=e.cacheKey;i.A.typeOf.func("options.resourceCache",t),i.A.typeOf.object("options.gltfResource",n),i.A.typeOf.object("options.baseResource",r),this._resourceCache=t,this._gltfResource=n,this._baseResource=r,this._typedArray=s,this._gltfJson=a,this._cacheKey=c,this._gltf=void 0,this._bufferLoaders=[],this._state=y.A.UNLOADED,this._promise=void 0}function b(e,t){e.unload(),e._state=y.A.FAILED;const n=`Failed to load glTF: ${e._gltfResource.url}`;throw e.getError(n,t)}async function w(e,t){try{(0,h.A)(t),await function(e){const t=[];return A.A.buffer(e,function(e){const n=e.uri;!(0,r.A)(e.extras._pipeline.source)&&(0,r.A)(n)&&(0,c.A)(n)&&(delete e.uri,t.push(l.A.fetchArrayBuffer(n).then(function(t){e.extras._pipeline.source=new Uint8Array(t)})))}),Promise.all(t)}(t),await async function(e,t){if((0,r.A)(t.asset)&&"2.0"===t.asset.version&&!(0,g.A)(t,"KHR_techniques_webgl")&&!(0,g.A)(t,"KHR_materials_common"))return Promise.resolve();const n=[];A.A.buffer(t,function(t){if(!(0,r.A)(t.extras._pipeline.source)&&(0,r.A)(t.uri)){const i=e._baseResource.getDerivedResource({url:t.uri}),o=e._resourceCache.getExternalBufferLoader({resource:i});e._bufferLoaders.push(o),n.push(o.load().then(function(){o.isDestroyed()||(t.extras._pipeline.source=o.typedArray)}))}}),await Promise.all(n),(0,m.A)(t)}(e,t),(0,d.A)(t),await function(e,t){const n=[];return A.A.buffer(t,function(t,i){const o=t.extras._pipeline.source;if((0,r.A)(o)&&!(0,r.A)(t.uri)){const t=e._resourceCache.getEmbeddedBufferLoader({parentResource:e._gltfResource,bufferId:i,typedArray:o});e._bufferLoaders.push(t),n.push(t.load())}}),Promise.all(n)}(e,t),(0,f.A)(t);const n=t.asset.version;if("1.0"!==n&&"2.0"!==n)throw new u.A(`Unsupported glTF version: ${n}`);const i=t.extensionsRequired;return(0,r.A)(i)&&v.A.checkSupportedExtensions(i),e._gltf=t,e._state=y.A.READY,e}catch(t){if(e.isDestroyed())return;b(e,t)}}async function x(e,t){let n;try{n="glTF"===(0,a.A)(t)?(0,p.A)(t):(0,s.A)(t)}catch(t){if(e.isDestroyed())return;b(e,t)}return w(e,n)}(0,r.A)(Object.create)&&(T.prototype=Object.create(_.A.prototype),T.prototype.constructor=T),Object.defineProperties(T.prototype,{cacheKey:{get:function(){return this._cacheKey}},gltf:{get:function(){return this._gltf}}}),T.prototype.load=async function(){return(0,r.A)(this._promise)?this._promise:(this._state=y.A.LOADING,(0,r.A)(this._gltfJson)?(this._promise=w(this,this._gltfJson),this._promise):(0,r.A)(this._typedArray)?(this._promise=x(this,this._typedArray),this._promise):(this._promise=async function(e){let t;try{const n=await e._fetchGltf();if(e.isDestroyed())return;t=new Uint8Array(n)}catch(t){if(e.isDestroyed())return;b(e,t)}return x(e,t)}(this),this._promise))},T.prototype.unload=function(){const e=this._bufferLoaders,t=e.length;for(let n=0;n<t;++n)e[n]=!e[n].isDestroyed()&&this._resourceCache.unload(e[n]);this._bufferLoaders.length=0,this._gltf=void 0},T.prototype._fetchGltf=function(){return this._gltfResource.fetchArrayBuffer()};const C=T},982504:(e,t,n)=>{"use strict";n.d(t,{A:()=>Ve});var i=n(794282),o=n(434067),r=n(267980),s=n(626809),a=n(369031),c=n(571804),l=n(607502),u=n(915325),d=n(491446),h=n(520098),A=n(92457),p=n(584164),f=n(402330),m=n(99479),g=n(123245),_=n(654799),y=n(534702),v=n(614480),T=n(137261),b=n(582998),w=n(730839),x=n(320475),C=n(782556),E=n(800859),S=n(866857),I=n(995537),P=n(289758),D=n(872182),O=n(569445),R=n(768213),M=n(595826),L=n(659282),N=n(893828),B=n(983884),F=n(702247),U=n(63267);const{Attribute:k,Indices:V,FeatureIdAttribute:z,FeatureIdTexture:H,FeatureIdImplicitRange:G,MorphTarget:W,Primitive:Y,Instances:q,Skin:j,Node:Q,AnimatedPropertyType:X,AnimationSampler:K,AnimationTarget:$,AnimationChannel:J,Animation:Z,ArticulationStage:ee,Articulation:te,Asset:ne,Scene:ie,Components:oe,MetallicRoughness:re,SpecularGlossiness:se,Specular:ae,Anisotropy:ce,Clearcoat:le,Material:ue}=I.A;function de(e){e=e??u.A.EMPTY_OBJECT;const{gltfResource:t,typedArray:n,releaseGltfJson:i=!1,asynchronous:o=!0,incrementallyLoadTextures:r=!0,upAxis:s=x.A.Y,forwardAxis:c=x.A.Z,loadAttributesAsTypedArray:l=!1,loadAttributesFor2D:d=!1,enablePick:h=!1,loadIndicesForWireframe:A=!1,loadPrimitiveOutline:p=!0,loadForClassification:f=!1,renameBatchIdSemantic:m=!1}=e;a.A.typeOf.object("options.gltfResource",t);const{baseResource:g=t.clone()}=e;this._gltfJson=e.gltfJson,this._gltfResource=t,this._baseResource=g,this._typedArray=n,this._releaseGltfJson=i,this._asynchronous=o,this._incrementallyLoadTextures=r,this._upAxis=s,this._forwardAxis=c,this._loadAttributesAsTypedArray=l,this._loadAttributesFor2D=d,this._enablePick=h,this._loadIndicesForWireframe=A,this._loadPrimitiveOutline=p,this._loadForClassification=f,this._renameBatchIdSemantic=m,this._sortedPropertyTableIds=void 0,this._sortedFeatureTextureIds=void 0,this._gltfJsonLoader=void 0,this._state=0,this._textureState=0,this._promise=void 0,this._processError=void 0,this._textureErrors=[],this._primitiveLoadPlans=[],this._loaderPromises=[],this._textureLoaders=[],this._texturesPromises=[],this._textureCallbacks=[],this._bufferViewLoaders=[],this._geometryLoaders=[],this._geometryCallbacks=[],this._structuralMetadataLoader=void 0,this._meshPrimitiveGpmLoader=void 0,this._loadResourcesPromise=void 0,this._resourcesLoaded=!1,this._texturesLoaded=!1,this._supportedImageFormats=void 0,this._postProcessBuffers=[],this._components=void 0}function he(e,t){throw e.unload(),e.getError("Failed to load glTF",t)}function Ae(e,t){const n=e._postProcessBuffers,i=t.primitive,o=i.outlineCoordinates;(0,d.A)(o)&&n.push(o.buffer);const r=i.attributes;for(let e=0;e<r.length;e++){const t=r[e];(0,d.A)(t.buffer)&&n.push(t.buffer)}const s=i.indices;(0,d.A)(s)&&(0,d.A)(s.buffer)&&n.push(s.buffer)}function pe(e,t,n){let i=t.byteOffset;const o=(0,y.A)(e,t),r=t.count,s=(0,T.A)(t.type),a=t.componentType,l=c.A.getSizeInBytes(a),u=r*s;if(o===l*s)return n=new Uint8Array(n),c.A.createArrayBufferView(a,n.buffer,n.byteOffset+i,u);const d=c.A.createTypedArray(a,u),h=new DataView(n.buffer),A=new Array(s),p=(0,v.A)(t.componentType);i=n.byteOffset+i;for(let e=0;e<r;++e){p(h,i,s,l,A);for(let t=0;t<s;++t)d[e*s+t]=A[t];i+=o}return d}function fe(e,t,n){const i=new Array(t.count),o=t.bufferView;if((0,d.A)(o)){const r=function(e,t){const n=D.A.getBufferViewLoader({gltf:e.gltfJson,bufferViewId:t,gltfResource:e._gltfResource,baseResource:e._baseResource});return e._bufferViewLoaders.push(n),n}(e,o),s=async function(e,t,n,i,o){const{gltfJson:r}=e;await t.load(),e.isDestroyed()||function(e,t,n,i){const o=e.type,r=e.count;if(o===w.A.SCALAR)for(let e=0;e<r;e++)n[e]=t[e];else if(o===w.A.VEC4&&i)for(let e=0;e<r;e++)n[e]=m.A.unpack(t,4*e);else{const e=w.A.getMathType(o),i=w.A.getNumberOfComponents(o);for(let o=0;o<r;o++)n[o]=e.unpack(t,o*i)}}(n,pe(r,n,t.typedArray),o,i=i??!1)}(e,r,t,n,i);return e._loaderPromises.push(s),i}return function(e,t){const n=e.type;if(n===w.A.SCALAR)return t.fill(0);const i=w.A.getMathType(n);return t.fill(i.clone(i.ZERO))}(t,i)}function me(e,t){if((0,d.A)(t))return e===Number?t[0]:e.unpack(t)}(0,d.A)(Object.create)&&(de.prototype=Object.create(O.A.prototype),de.prototype.constructor=de),Object.defineProperties(de.prototype,{cacheKey:{get:function(){}},components:{get:function(){return this._components}},gltfJson:{get:function(){return(0,d.A)(this._gltfJsonLoader)?this._gltfJsonLoader.gltf:this._gltfJson}},incrementallyLoadTextures:{get:function(){return this._incrementallyLoadTextures}},texturesLoaded:{get:function(){return this._texturesLoaded}}}),de.prototype.load=async function(){return(0,d.A)(this._promise)||(this._promise=async function(e){e._state=1,e._textureState=1;try{const t=D.A.getGltfJsonLoader({gltfResource:e._gltfResource,baseResource:e._baseResource,typedArray:e._typedArray,gltfJson:e._gltfJson});if(e._gltfJsonLoader=t,await t.load(),e.isDestroyed()||e.isUnloaded()||t.isDestroyed())return;return e._state=2,e._textureState=2,e}catch(t){if(e.isDestroyed())return;e._state=7,e._textureState=7,he(e,t)}}(this)),this._promise},de.prototype._process=function(e){return 6===this._state||(3===this._state&&function(e,t){let n=!0;const i=e._geometryLoaders;for(let o=0;o<i.length;++o){const r=i[o].process(t);r&&(0,d.A)(e._geometryCallbacks[o])&&(e._geometryCallbacks[o](),e._geometryCallbacks[o]=void 0),n=n&&r}const o=e._structuralMetadataLoader;if((0,d.A)(o)){const i=o.process(t);i&&(e._components.structuralMetadata=o.structuralMetadata),n=n&&i}const r=e._meshPrimitiveGpmLoader;if((0,d.A)(r)){const i=r.process(t);i&&((0,d.A)(e._components.structuralMetadata)&&(0,B.A)("structural-metadata-gpm","The model defines both the 'EXT_structural_metadata' extension and the 'NGA_gpm_local' extension. The data from the 'EXT_structural_metadata' extension will be replaced with the data from the 'NGA_gpm_local' extension, and will no longer be available for styling and picking."),e._components.structuralMetadata=r.structuralMetadata),n=n&&i}n&&(e._state=4)}(this,e),this._resourcesLoaded&&4===this._state&&(function(e,t){const n=e._primitiveLoadPlans;for(let i=0;i<n.length;i++){const o=n[i];o.postProcess(t),(o.needsOutlines||o.needsGaussianSplats)&&Ae(e,o)}}(this,e.context),this._state=5),!(!this._resourcesLoaded||5!==this._state||(ke(this),this._typedArray=void 0,this._state=6,0)))},de.prototype._processTextures=function(e){if(6===this._textureState)return!0;if(3!==this._textureState)return!1;let t=!0;const n=this._textureLoaders;for(let i=0;i<n.length;++i){const o=n[i].process(e);o&&(0,d.A)(this._textureCallbacks[i])&&(this._textureCallbacks[i](),this._textureCallbacks[i]=void 0),t=t&&o}return!!t&&(this._textureState=6,this._texturesLoaded=!0,!0)},de.prototype.process=function(e){if(a.A.typeOf.object("frameState",e),2!==this._state||(0,d.A)(this._loadResourcesPromise)||(this._loadResourcesPromise=async function(e,t){h.A.supportsWebP.initialized||await h.A.supportsWebP.initialize(),e._supportedImageFormats=new R.A({webp:h.A.supportsWebP(),basis:t.context.supportsBasis});const n=function(e,t){const n=e.gltfJson,i=n.extensions??u.A.EMPTY_OBJECT,o=i.EXT_structural_metadata,s=i.EXT_feature_metadata,a=i.CESIUM_RTC;if((0,d.A)(s)){const t=s.featureTables,n=s.featureTextures,i=(0,d.A)(t)?t:[],o=(0,d.A)(n)?n:[];e._sortedPropertyTableIds=Object.keys(i).sort(),e._sortedFeatureTextureIds=Object.keys(o).sort()}const c=function(e,t){const n=e.gltfJson.nodes;if(!(0,d.A)(n))return[];const i=n.map(function(n,i){const o=function(e,t,n){const i=new Q;i.name=t.name,i.matrix=me(p.A,t.matrix),i.translation=me(r.A,t.translation),i.rotation=me(m.A,t.rotation),i.scale=me(r.A,t.scale);const o=t.extensions??u.A.EMPTY_OBJECT,s=o.EXT_mesh_gpu_instancing,a=o.AGI_articulations;if((0,d.A)(s)){if(e._loadForClassification)throw new g.A("Models with the EXT_mesh_gpu_instancing extension cannot be used for classification.");i.instances=function(e,t,n){const i=t.EXT_mesh_gpu_instancing,o=new q,r=i.attributes;if((0,d.A)(r))for(const t in r){if(!r.hasOwnProperty(t))continue;const i=r[t];o.attributes.push(Ce(e,i,r,t,n))}const s=i.extensions??u.A.EMPTY_OBJECT,a=t.EXT_instance_features,c=s.EXT_feature_metadata;return(0,d.A)(a)?function(e,t){const n=t.featureIds;for(let t=0;t<n.length;t++){const i=n[t],o=`instanceFeatureId_${t}`;let r;r=(0,d.A)(i.attribute)?Se(i,o):Pe(i,o),e.featureIds.push(r)}}(o,a):(0,d.A)(c)&&function(e,t,n,i){const o=e.extensions.EXT_feature_metadata.featureTables,r=n.featureIdAttributes;if((0,d.A)(r))for(let e=0;e<r.length;++e){const n=r[e],s=n.featureTable,a=i.indexOf(s),c=o[s].count,l=`instanceFeatureId_${e}`;let u;u=(0,d.A)(n.featureIds.attribute)?Ie(n,a,c,l):De(n,a,c,l),t.featureIds.push(u)}}(e.gltfJson,o,c,e._sortedPropertyTableIds),o}(e,o,n)}(0,d.A)(a)&&(i.articulationName=a.articulationName);const c=t.mesh;if((0,d.A)(c)){const o=e.gltfJson.meshes[c],r=(0,U.A)(o);for(let t=0;t<r.length;++t)i.primitives.push(Le(e,r[t],(0,d.A)(i.instances),n));const s=t.weights??o.weights,a=i.primitives[0].morphTargets;i.morphWeights=(0,d.A)(s)?s.slice():new Array(a.length).fill(0)}return i}(e,n,t);return o.index=i,o});for(let e=0;e<i.length;++e){const t=n[e].children;if((0,d.A)(t))for(let n=0;n<t.length;++n)i[e].children.push(i[t[n]])}return i}(e,t),h=function(e,t){const n=e.gltfJson.skins;if(e._loadForClassification||!(0,d.A)(n))return[];const i=n.map(function(n,i){const o=function(e,t,n){const i=new j,o=t.joints;i.joints=o.map(e=>n[e]);const r=t.inverseBindMatrices;if((0,d.A)(r)){const t=e.gltfJson.accessors[r];i.inverseBindMatrices=fe(e,t)}else i.inverseBindMatrices=new Array(o.length).fill(p.A.IDENTITY);return i}(e,n,t);return o.index=i,o}),o=e.gltfJson.nodes;for(let e=0;e<t.length;++e){const n=o[e].skin;(0,d.A)(n)&&(t[e].skin=i[n])}return i}(e,c),f=function(e,t){const n=e.gltfJson.animations;if(e._loadForClassification||!(0,d.A)(n))return[];const i=n.map(function(n,i){const o=function(e,t,n){const i=new Z;i.name=t.name;const o=t.samplers.map(function(t,n){const i=function(e,t){const n=new K,i=e.gltfJson.accessors,o=i[t.input];n.input=fe(e,o);const r=t.interpolation;n.interpolation=A.A[r]??A.A.LINEAR;const s=i[t.output];return n.output=fe(e,s,!0),n}(e,t);return i.index=n,i}),r=t.channels.map(function(e){return function(e,t,n){const i=new J,o=e.sampler;return i.sampler=t[o],i.target=function(e,t){const n=new $,i=e.node;if(!(0,d.A)(i))return;n.node=t[i];const o=e.path.toUpperCase();return n.path=X[o],n}(e.target,n),i}(e,o,n)});return i.samplers=o,i.channels=r,i}(e,n,t);return o.index=i,o});return i}(e,c),_=function(e){const t=e.extensions??u.A.EMPTY_OBJECT,n=t.AGI_articulations?.articulations;return(0,d.A)(n)?n.map(Fe):[]}(n),y=function(e,t){const n=new ie,i=function(e){let t;return(0,d.A)(e.scenes)&&(0,d.A)(e.scene)&&(t=e.scenes[e.scene].nodes),t=t??e.nodes,t=(0,d.A)(t)?t:[],t}(e);return n.nodes=i.map(function(e){return t[e]}),n}(n,c),v=new oe,T=new ne,w=n.asset.copyright;if((0,d.A)(w)){const e=w.split(";").map(function(e){return new l.A(e.trim())});T.credits=e}if(v.asset=T,v.scene=y,v.nodes=c,v.skins=h,v.animations=f,v.articulations=_,v.upAxis=e._upAxis,v.forwardAxis=e._forwardAxis,(0,d.A)(a)){const e=r.A.fromArray(a.center,0,Ue);v.transform=p.A.fromTranslation(e,v.transform)}if(e._components=v,(0,d.A)(o)||(0,d.A)(s)){const n=async function(e,t,n,i){const o=new b.A({gltf:e.gltfJson,extension:t,extensionLegacy:n,gltfResource:e._gltfResource,baseResource:e._baseResource,supportedImageFormats:e._supportedImageFormats,frameState:i,asynchronous:e._asynchronous});return e._structuralMetadataLoader=o,o.load()}(e,o,s,t);e._loaderPromises.push(n)}const x=i.NGA_gpm_local;if((0,d.A)(x)){const t=L.A.load(x);e._components.extensions.NGA_gpm_local=t}const C=n.meshes;if((0,d.A)(C))for(const i of C){const o=i.primitives;if((0,d.A)(o))for(const i of o){const o=i.extensions;if((0,d.A)(o)){const i=o.NGA_gpm_local;if((0,d.A)(i)){const o=Ne(e,n,i,t);e._loaderPromises.push(o)}}}}const E=[];return(0,F.A)(E,e._loaderPromises),e._incrementallyLoadTextures||(0,F.A)(E,e._texturesPromises),Promise.all(E)}(e,t);return e._state=3,e._textureState=3,(0,d.A)(e._gltfJsonLoader)&&e._releaseGltfJson&&(D.A.unload(e._gltfJsonLoader),e._gltfJsonLoader=void 0),n}(this,e).then(()=>{this._resourcesLoaded=!0}).catch(e=>{this._processError=e})),(0,d.A)(this._processError)){this._state=7;const e=this._processError;this._processError=void 0,he(this,e)}const t=this._textureErrors.pop();if((0,d.A)(t)){const e=this.getError("Failed to load glTF texture",t);throw e.name="TextureError",e}if(7===this._state)return!1;let n=!1;try{n=this._process(e)}catch(e){this._state=7,he(this,e)}let i=!1;try{i=this._processTextures(e)}catch(e){this._textureState=7,he(this,e)}return this._incrementallyLoadTextures?n:n&&i};const ge={VEC2:new o.A(-1,-1),VEC3:new r.A(-1,-1,-1),VEC4:new s.A(-1,-1,-1,-1)};function _e(e,t,n,i,a){const l=e.accessors[t],u=w.A.getMathType(l.type),h=l.normalized??!1,A=new k;A.name=n,A.semantic=i,A.setIndex=a,A.constant=function(e){return e===Number?0:new e}(u),A.componentDatatype=l.componentType,A.normalized=h,A.count=l.count,A.type=l.type,A.min=me(u,l.min),A.max=me(u,l.max),A.byteOffset=l.byteOffset,A.byteStride=(0,y.A)(e,l),(0,E.A)(l,"WEB3D_quantized_attributes")&&function(e,t,n){const i=e.decodeMatrix,a=me(n,e.decodedMin),c=me(n,e.decodedMax);(0,d.A)(a)&&(0,d.A)(c)&&(t.min=a,t.max=c);const l=new I.A.Quantization;l.componentDatatype=t.componentDatatype,l.type=t.type,4===i.length?(l.quantizedVolumeOffset=i[2],l.quantizedVolumeStepSize=i[0]):9===i.length?(l.quantizedVolumeOffset=new o.A(i[6],i[7]),l.quantizedVolumeStepSize=new o.A(i[0],i[4])):16===i.length?(l.quantizedVolumeOffset=new r.A(i[12],i[13],i[14]),l.quantizedVolumeStepSize=new r.A(i[0],i[5],i[10])):25===i.length&&(l.quantizedVolumeOffset=new s.A(i[20],i[21],i[22],i[23]),l.quantizedVolumeStepSize=new s.A(i[0],i[6],i[12],i[18])),t.quantization=l}(l.extensions.WEB3D_quantized_attributes,A,u);const p=A.semantic===M.A.POSITION||A.semantic===M.A.NORMAL||A.semantic===M.A.TANGENT||A.semantic===M.A.TEXCOORD||A.semantic===M.A.FEATURE_ID||A.semantic===M.A.SCALE||A.semantic===M.A.ROTATION,f=e.extensionsRequired?.includes("KHR_mesh_quantization");return f&&h&&p&&function(e,t){const n=function(e){switch(e){case c.A.BYTE:return 127;case c.A.UNSIGNED_BYTE:return 255;case c.A.SHORT:return 32767;case c.A.UNSIGNED_SHORT:return 65535;default:return 1}}(e.componentDatatype),i=ge[e.type];let o=e.min;(0,d.A)(o)&&(o=t.divideByScalar(o,n,o),o=t.maximumByComponent(o,i,o));let r=e.max;(0,d.A)(r)&&(r=t.divideByScalar(r,n,r),r=t.maximumByComponent(r,i,r)),e.min=o,e.max=r}(A,u),A}function ye(e){const t=/^\w+_(\d+)$/.exec(e);if(null!==t)return parseInt(t[1])}const ve={gltfSemantic:void 0,renamedSemantic:void 0,modelSemantic:void 0};function Te(e,t,n){let i=n;!e._renameBatchIdSemantic||"_BATCHID"!==n&&"BATCHID"!==n||(i="_FEATURE_ID_0");const o=t.fromGltfSemantic(i),r=ve;return r.gltfSemantic=n,r.renamedSemantic=i,r.modelSemantic=o,r}function be(e){const t=e===M.A.POSITION,n=e===M.A.FEATURE_ID,i=e===M.A.TEXCOORD;return t||n||i}function we(e,t,n,i,o,s,a,l,u){const h=e.gltfJson,A=h.accessors[t],p=A.bufferView,f=n.gltfSemantic,m=n.renamedSemantic,g=n.modelSemantic,_=(0,d.A)(g)?ye(m):void 0,y=_e(h,t,f,g,_);if(!(0,d.A)(o)&&!(0,d.A)(p)&&!(0,d.A)(s))return y;const v=function(e,t,n,i,o,r,s,a,c){const l=e.gltfJson,u=l.accessors[t].bufferView;return D.A.getVertexBufferLoader({gltf:l,gltfResource:e._gltfResource,baseResource:e._baseResource,frameState:c,bufferViewId:u,primitive:i,draco:o,spz:r,attributeSemantic:n,accessorId:t,asynchronous:e._asynchronous,loadBuffer:s,loadTypedArray:a})}(e,t,f,i,o,s,a,l,u),T=e._geometryLoaders.length;e._geometryLoaders.push(v);const b=v.load();return e._loaderPromises.push(b),e._geometryCallbacks[T]=()=>{(0,d.A)(o)&&(0,d.A)(o.attributes)&&(0,d.A)(o.attributes[f])?function(e,t,n,i){if(e.byteOffset=0,e.byteStride=void 0,e.quantization=t.quantization,n&&(e.buffer=t.buffer),i){const n=(0,d.A)(t.quantization)?t.quantization.componentDatatype:e.componentDatatype;e.typedArray=c.A.createArrayBufferView(n,t.typedArray.buffer)}}(y,v,a,l):(0,d.A)(s)?function(e,t,n,i){if(e.byteOffset=0,e.byteStride=void 0,n&&(e.buffer=t.buffer),i&&(0,d.A)(t.typedArray)&&(e.typedArray=c.A.createArrayBufferView(e.componentDatatype,t.typedArray.buffer)),e.semantic===M.A.POSITION){const t=e=>{let t=1/0,n=-1/0,i=1/0,o=-1/0,s=1/0,a=-1/0;for(let r=0;r<e.length;r+=3){const c=e[r],l=e[r+1],u=e[r+2];t=Math.min(t,c),n=Math.max(n,c),i=Math.min(i,l),o=Math.max(o,l),s=Math.min(s,u),a=Math.max(a,u)}return[new r.A(t,i,s),new r.A(n,o,a)]},n=e.typedArray;[e.min,e.max]=t(n)}}(y,v,a,l):function(e,t,n,i,o,r){if(o&&(n.buffer=i.buffer),r){const r=i.typedArray;n.typedArray=pe(e,t,r),o||(n.byteOffset=0,n.byteStride=void 0)}}(h,A,y,v,a,l)},y}function xe(e,t,n,i,o,r,s,a,c){const l=n.modelSemantic,u=l===M.A.POSITION,d=l===M.A.FEATURE_ID,h=u&&!s&&e._loadAttributesFor2D&&!c.scene3DOnly,A=u&&e._enablePick&&!c.context.webgl2,p=e._loadForClassification&&d,f=e._loadAttributesAsTypedArray,m=!f,g=f||h||A||p,_=we(e,t,n,i,o,r,!a&&m,!!a||g,c),y=new P.A.AttributeLoadPlan(_);return y.loadBuffer=m,y.loadTypedArray=g,y}function Ce(e,t,n,i,o){const r=e.gltfJson.accessors,s=(0,d.A)(n.ROTATION),a=(0,d.A)(n.TRANSLATION)&&(0,d.A)(r[n.TRANSLATION].min)&&(0,d.A)(r[n.TRANSLATION].max),c=Te(e,S.A,i),l=c.modelSemantic,u=l===S.A.TRANSLATION||l===S.A.ROTATION||l===S.A.SCALE,h=l===S.A.TRANSLATION,A=e._loadAttributesAsTypedArray||s&&u||!o.context.instancedArrays,p=e._enablePick&&!o.context.webgl2,f=!A,m=e._loadAttributesFor2D&&!o.scene3DOnly;return we(e,t,c,void 0,void 0,void 0,f,A||h&&(!a||m||p),o)}function Ee(e,t,n,i){const o=e.gltfJson,r=C.A.getImageIdFromTexture({gltf:o,textureId:t.index,supportedImageFormats:e._supportedImageFormats});if(!(0,d.A)(r))return;const s=D.A.getTextureLoader({gltf:o,textureInfo:t,gltfResource:e._gltfResource,baseResource:e._baseResource,supportedImageFormats:e._supportedImageFormats,frameState:n,asynchronous:e._asynchronous}),a=C.A.createModelTextureReader({textureInfo:t}),c=e._textureLoaders.length;e._textureLoaders.push(s);const l=s.load().catch(t=>{if(!e.isDestroyed()){if(!e._incrementallyLoadTextures)throw t;e._textureState=7,e._textureErrors.push(t)}});return e._texturesPromises.push(l),e._textureCallbacks[c]=()=>{a.texture=s.texture,(0,d.A)(i)&&(a.texture.sampler=i)},a}function Se(e,t){const n=new z;return n.featureCount=e.featureCount,n.nullFeatureId=e.nullFeatureId,n.propertyTableId=e.propertyTable,n.setIndex=e.attribute,n.label=e.label,n.positionalLabel=t,n}function Ie(e,t,n,i){const o=new z,r=e.featureIds;return o.featureCount=n,o.propertyTableId=t,o.setIndex=ye(r.attribute),o.positionalLabel=i,o}function Pe(e,t){const n=new G;return n.propertyTableId=e.propertyTable,n.featureCount=e.featureCount,n.nullFeatureId=e.nullFeatureId,n.label=e.label,n.positionalLabel=t,n.offset=0,n.repeat=1,n}function De(e,t,n,i){const o=new G,r=e.featureIds;o.propertyTableId=t,o.featureCount=n,o.offset=r.constant??0;const s=r.divisor??0;return o.repeat=0===s?void 0:s,o.positionalLabel=i,o}function Oe(e,t,n,i){const o=new H;o.featureCount=t.featureCount,o.nullFeatureId=t.nullFeatureId,o.propertyTableId=t.propertyTable,o.label=t.label,o.positionalLabel=i;const r=t.texture;o.textureReader=Ee(e,r,n,_.A.NEAREST);const s=((0,d.A)(r.channels)?r.channels:[0]).map(function(e){return"rgba".charAt(e)}).join("");return o.textureReader.channels=s,o}function Re(e,t,n,i,o,r){const s=new H,a=t.featureIds,c=a.texture;return s.featureCount=o,s.propertyTableId=n,s.textureReader=Ee(e,c,i,_.A.NEAREST),s.textureReader.channels=a.channels,s.positionalLabel=r,s}function Me(e,t,n,i,o){const r=new W;for(const s in t){if(!t.hasOwnProperty(s))continue;const a=xe(e,t[s],Te(e,M.A,s),void 0,void 0,void 0,!1,n,o);r.attributes.push(a.attribute),i.attributePlans.push(a)}return r}function Le(e,t,n,i){const o=new Y,a=new P.A(o);e._primitiveLoadPlans.push(a);const c=t.material;(0,d.A)(c)&&(o.material=function(e,t,n){const i=new ue,o=t.extensions??u.A.EMPTY_OBJECT,a=o.KHR_materials_pbrSpecularGlossiness,c=o.KHR_materials_specular,l=o.KHR_materials_anisotropy,h=o.KHR_materials_clearcoat,A=t.pbrMetallicRoughness;return i.unlit=(0,d.A)(o.KHR_materials_unlit),(0,d.A)(a)?i.specularGlossiness=function(e,t,n){const{diffuseTexture:i,specularGlossinessTexture:o,diffuseFactor:a,specularFactor:c,glossinessFactor:l}=t,u=new se;return(0,d.A)(i)&&(u.diffuseTexture=Ee(e,i,n)),(0,d.A)(o)&&(u.specularGlossinessTexture=Ee(e,o,n)),u.diffuseFactor=me(s.A,a),u.specularFactor=me(r.A,c),u.glossinessFactor=l,u}(e,a,n):((0,d.A)(A)&&(i.metallicRoughness=function(e,t,n){const{baseColorTexture:i,metallicRoughnessTexture:o,baseColorFactor:r,metallicFactor:a,roughnessFactor:c}=t,l=new re;return(0,d.A)(i)&&(l.baseColorTexture=Ee(e,i,n)),(0,d.A)(o)&&(l.metallicRoughnessTexture=Ee(e,o,n)),l.baseColorFactor=me(s.A,r),l.metallicFactor=a,l.roughnessFactor=c,l}(e,A,n)),(0,d.A)(c)&&!i.unlit&&(i.specular=function(e,t,n){const{specularFactor:i,specularTexture:o,specularColorFactor:s,specularColorTexture:a}=t,c=new ae;return(0,d.A)(o)&&(c.specularTexture=Ee(e,o,n)),(0,d.A)(a)&&(c.specularColorTexture=Ee(e,a,n)),c.specularFactor=i,c.specularColorFactor=me(r.A,s),c}(e,c,n)),(0,d.A)(l)&&!i.unlit&&(i.anisotropy=function(e,t,n){const{anisotropyStrength:i=ce.DEFAULT_ANISOTROPY_STRENGTH,anisotropyRotation:o=ce.DEFAULT_ANISOTROPY_ROTATION,anisotropyTexture:r}=t,s=new ce;return(0,d.A)(r)&&(s.anisotropyTexture=Ee(e,r,n)),s.anisotropyStrength=i,s.anisotropyRotation=o,s}(e,l,n)),(0,d.A)(h)&&!i.unlit&&(i.clearcoat=function(e,t,n){const{clearcoatFactor:i=le.DEFAULT_CLEARCOAT_FACTOR,clearcoatTexture:o,clearcoatRoughnessFactor:r=le.DEFAULT_CLEARCOAT_ROUGHNESS_FACTOR,clearcoatRoughnessTexture:s,clearcoatNormalTexture:a}=t,c=new le;return(0,d.A)(o)&&(c.clearcoatTexture=Ee(e,o,n)),(0,d.A)(s)&&(c.clearcoatRoughnessTexture=Ee(e,s,n)),(0,d.A)(a)&&(c.clearcoatNormalTexture=Ee(e,a,n)),c.clearcoatFactor=i,c.clearcoatRoughnessFactor=r,c}(e,h,n))),(0,d.A)(t.emissiveTexture)&&(i.emissiveTexture=Ee(e,t.emissiveTexture,n)),(0,d.A)(t.normalTexture)&&!e._loadForClassification&&(i.normalTexture=Ee(e,t.normalTexture,n)),(0,d.A)(t.occlusionTexture)&&(i.occlusionTexture=Ee(e,t.occlusionTexture,n)),i.emissiveFactor=me(r.A,t.emissiveFactor),i.alphaMode=t.alphaMode,i.alphaCutoff=t.alphaCutoff,i.doubleSided=t.doubleSided,i}(e,e.gltfJson.materials[c],i));const l=t.extensions??u.A.EMPTY_OBJECT;let h=!1;const A=l.CESIUM_primitive_outline;e._loadPrimitiveOutline&&(0,d.A)(A)&&(h=!0,a.needsOutlines=!0,a.outlineIndices=function(e,t){const n=t.indices;return fe(e,e.gltfJson.accessors[n],!1)}(e,A));const p=function(e){const t=e?.KHR_gaussian_splatting,n=t?.extensions,i=n?.KHR_gaussian_splatting_compression_spz_2;if((0,d.A)(i))return i;const o=e?.KHR_spz_gaussian_splats_compression;return(0,d.A)(o)?o:void 0}(l);(0,d.A)(p)&&(h=!0,a.needsGaussianSplats=!0);const m=e._loadForClassification,_=l.KHR_draco_mesh_compression;let y=!1;const v=t.attributes;if((0,d.A)(v))for(const r in v){if(!v.hasOwnProperty(r))continue;const s=v[r],c=Te(e,M.A,r),l=c.modelSemantic;if(m&&!be(l))continue;l===M.A.FEATURE_ID&&(y=!0);const u=xe(e,s,c,t,_,p,n,h,i);a.attributePlans.push(u),o.attributes.push(u.attribute)}const T=t.targets;if((0,d.A)(T)&&!m)for(let t=0;t<T.length;++t)o.morphTargets.push(Me(e,T[t],h,a,i));const b=t.indices;if((0,d.A)(b)){const n=function(e,t,n,i,o,r,s){const a=e.gltfJson.accessors[t],c=a.bufferView;if(!(0,d.A)(i)&&!(0,d.A)(c))return;const l=new V;l.count=a.count;const u=e._loadAttributesAsTypedArray,h=(e._loadIndicesForWireframe||e._enablePick)&&!s.context.webgl2,A=e._loadForClassification&&o,p=!u,f=u||h||A,m=function(e,t,n,i,o,r,s){return D.A.getIndexBufferLoader({gltf:e.gltfJson,accessorId:t,gltfResource:e._gltfResource,baseResource:e._baseResource,frameState:s,primitive:n,draco:i,asynchronous:e._asynchronous,loadBuffer:o,loadTypedArray:r})}(e,t,n,i,!r&&p,!!r||f,s),g=e._geometryLoaders.length;e._geometryLoaders.push(m);const _=m.load();e._loaderPromises.push(_),e._geometryCallbacks[g]=()=>{l.indexDatatype=m.indexDatatype,l.buffer=m.buffer,l.typedArray=m.typedArray};const y=new P.A.IndicesLoadPlan(l);return y.loadBuffer=p,y.loadTypedArray=f,y}(e,b,t,_,y,h,i);(0,d.A)(n)&&(a.indicesPlan=n,o.indices=n.indices)}const w=l.EXT_structural_metadata,x=l.EXT_mesh_features,C=l.EXT_feature_metadata,E=(0,d.A)(C);(0,d.A)(x)?function(e,t,n,i){let o;o=(0,d.A)(n)&&(0,d.A)(n.featureIds)?n.featureIds:[];for(let n=0;n<o.length;n++){const r=o[n],s=`featureId_${n}`;let a;a=(0,d.A)(r.texture)?Oe(e,r,i,s):(0,d.A)(r.attribute)?Se(r,s):Pe(r,s),t.featureIds.push(a)}}(e,o,x,i):E&&function(e,t,n,i){const{featureTables:o}=e.gltfJson.extensions.EXT_feature_metadata;let r=0;const s=n.featureIdAttributes;if((0,d.A)(s))for(let n=0;n<s.length;++n){const i=s[n],a=i.featureTable,c=e._sortedPropertyTableIds.indexOf(a),l=o[a].count,u=`featureId_${r}`;let h;r++,h=(0,d.A)(i.featureIds.attribute)?Ie(i,c,l,u):De(i,c,l,u),t.featureIds.push(h)}const a=n.featureIdTextures;if((0,d.A)(a))for(let n=0;n<a.length;++n){const s=a[n],c=s.featureTable,l=e._sortedPropertyTableIds.indexOf(c),u=`featureId_${r}`;r++;const d=Re(e,s,l,i,o[c].count,u);t.featureIds.push(d)}}(e,o,C,i),(0,d.A)(w)?function(e,t){if(!(0,d.A)(t))return;const{propertyTextures:n,propertyAttributes:i}=t;(0,d.A)(n)&&(e.propertyTextureIds=n),(0,d.A)(i)&&(e.propertyAttributeIds=i)}(o,w):E&&function(e,t,n){(0,d.A)(n.featureTextures)&&(t.propertyTextureIds=n.featureTextures.map(function(t){return e._sortedFeatureTextureIds.indexOf(t)}))}(e,o,C);const S=t.mode;if(m&&S!==f.A.TRIANGLES)throw new g.A("Only triangle meshes can be used for classification.");return o.primitiveType=S,o}async function Ne(e,t,n,i){const o=new N.A({gltf:t,extension:n,gltfResource:e._gltfResource,baseResource:e._baseResource,supportedImageFormats:e._supportedImageFormats,frameState:i,asynchronous:e._asynchronous});return e._meshPrimitiveGpmLoader=o,o.load()}function Be(e){const t=new ee;t.name=e.name;const n=e.type.toUpperCase();return t.type=i.A[n],t.minimumValue=e.minimumValue,t.maximumValue=e.maximumValue,t.initialValue=e.initialValue,t}function Fe(e){const t=new te;return t.name=e.name,t.stages=e.stages.map(Be),t}const Ue=new r.A;function ke(e){const t=e._bufferViewLoaders;for(let e=0;e<t.length;++e)t[e]=!t[e].isDestroyed()&&D.A.unload(t[e]);e._bufferViewLoaders.length=0}de.prototype.isUnloaded=function(){return 8===this._state},de.prototype.unload=function(){var e;(0,d.A)(this._gltfJsonLoader)&&!this._gltfJsonLoader.isDestroyed()&&D.A.unload(this._gltfJsonLoader),this._gltfJsonLoader=void 0,function(e){const t=e._textureLoaders;for(let e=0;e<t.length;++e)t[e]=!t[e].isDestroyed()&&D.A.unload(t[e]);e._textureLoaders.length=0}(this),ke(this),function(e){const t=e._geometryLoaders;for(let e=0;e<t.length;++e)t[e]=!t[e].isDestroyed()&&D.A.unload(t[e]);e._geometryLoaders.length=0}(this),function(e){const t=e._postProcessBuffers;for(let e=0;e<t.length;e++){const n=t[e];n.isDestroyed()||n.destroy()}t.length=0}(this),e=this,(0,d.A)(e._structuralMetadataLoader)&&!e._structuralMetadataLoader.isDestroyed()&&(e._structuralMetadataLoader.destroy(),e._structuralMetadataLoader=void 0),function(e){(0,d.A)(e._meshPrimitiveGpmLoader)&&!e._meshPrimitiveGpmLoader.isDestroyed()&&(e._meshPrimitiveGpmLoader.destroy(),e._meshPrimitiveGpmLoader=void 0)}(this),this._components=void 0,this._typedArray=void 0,this._state=8};const Ve=de},782556:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var i=n(434067),o=n(369031),r=n(915325),s=n(491446),a=n(331185),c=n(654799),l=n(957233),u=n(78078),d=n(557448),h=n(995537);const A={getImageIdFromTexture:function(e){e=e??r.A.EMPTY_OBJECT;const{gltf:t,textureId:n,supportedImageFormats:i}=e;o.A.typeOf.object("options.gltf",t),o.A.typeOf.number("options.textureId",n),o.A.typeOf.object("options.supportedImageFormats",i);const a=t.textures[n],c=a.extensions;if((0,s.A)(c)){if(i.webp&&(0,s.A)(c.EXT_texture_webp))return c.EXT_texture_webp.source;if(i.basis&&(0,s.A)(c.KHR_texture_basisu))return c.KHR_texture_basisu.source}return a.source},createSampler:function(e){e=e??r.A.EMPTY_OBJECT;const{gltf:t,textureInfo:n,compressedTextureNoMipmap:i=!1}=e;o.A.typeOf.object("options.gltf",t),o.A.typeOf.object("options.textureInfo",n);let a=d.A.REPEAT,h=d.A.REPEAT,A=u.A.LINEAR,p=l.A.LINEAR;const f=n.index,m=t.textures[f].sampler;if((0,s.A)(m)){const e=t.samplers[m];a=e.wrapS??a,h=e.wrapT??h,A=e.minFilter??A,p=e.magFilter??p}return i&&A!==u.A.LINEAR&&A!==u.A.NEAREST&&(A=A===u.A.NEAREST_MIPMAP_NEAREST||A===u.A.NEAREST_MIPMAP_LINEAR?u.A.NEAREST:u.A.LINEAR),new c.A({wrapS:a,wrapT:h,minificationFilter:A,magnificationFilter:p})}},p=new i.A(1,1);A.createModelTextureReader=function(e){e=e??r.A.EMPTY_OBJECT;const{textureInfo:t,channels:n,texture:c}=e;o.A.typeOf.object("options.textureInfo",t);let l,u=t.texCoord??0;const d=t.extensions?.KHR_texture_transform;if((0,s.A)(d)){u=d.texCoord??u;const e=(0,s.A)(d.offset)?i.A.unpack(d.offset):i.A.ZERO;let t=d.rotation??0;const n=(0,s.A)(d.scale)?i.A.unpack(d.scale):p;t=-t,l=new a.A(Math.cos(t)*n.x,-Math.sin(t)*n.y,e.x,Math.sin(t)*n.x,Math.cos(t)*n.y,e.y,0,0,1)}const A=new h.A.TextureReader;return A.index=t.index,A.texture=c,A.texCoord=u,A.scale=t.scale,A.transform=l,A.channels=n,A};const f=A},133240:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(493435),o=n(491446);function r(){}r.objectLegacy=function(e,t){if((0,o.A)(e))for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=t(e[n],n);if((0,o.A)(i))return i}},r.object=function(e,t){if((0,o.A)(e)){const n=e.length;for(let i=0;i<n;i++){const n=t(e[i],i);if((0,o.A)(n))return n}}},r.topLevel=function(e,t,n){const i=e[t];return(0,o.A)(i)&&!Array.isArray(i)?r.objectLegacy(i,n):r.object(i,n)},r.accessor=function(e,t){return r.topLevel(e,"accessors",t)},r.accessorWithSemantic=function(e,t,n){const i={};return r.mesh(e,function(e){return r.meshPrimitive(e,function(e){const s=r.meshPrimitiveAttribute(e,function(e,r){if(0===r.indexOf(t)&&!(0,o.A)(i[e])){i[e]=!0;const t=n(e);if((0,o.A)(t))return t}});return(0,o.A)(s)?s:r.meshPrimitiveTarget(e,function(e){return r.meshPrimitiveTargetAttribute(e,function(e,r){if(0===r.indexOf(t)&&!(0,o.A)(i[e])){i[e]=!0;const t=n(e);if((0,o.A)(t))return t}})})})})},r.accessorContainingVertexAttributeData=function(e,t){const n={};return r.mesh(e,function(e){return r.meshPrimitive(e,function(e){const i=r.meshPrimitiveAttribute(e,function(e){if(!(0,o.A)(n[e])){n[e]=!0;const i=t(e);if((0,o.A)(i))return i}});return(0,o.A)(i)?i:r.meshPrimitiveTarget(e,function(e){return r.meshPrimitiveTargetAttribute(e,function(e){if(!(0,o.A)(n[e])){n[e]=!0;const i=t(e);if((0,o.A)(i))return i}})})})})},r.accessorContainingIndexData=function(e,t){const n={};return r.mesh(e,function(e){return r.meshPrimitive(e,function(e){const i=e.indices;if((0,o.A)(i)&&!(0,o.A)(n[i])){n[i]=!0;const e=t(i);if((0,o.A)(e))return e}})})},r.animation=function(e,t){return r.topLevel(e,"animations",t)},r.animationChannel=function(e,t){const n=e.channels;return r.object(n,t)},r.animationSampler=function(e,t){const n=e.samplers;return r.object(n,t)},r.buffer=function(e,t){return r.topLevel(e,"buffers",t)},r.bufferView=function(e,t){return r.topLevel(e,"bufferViews",t)},r.camera=function(e,t){return r.topLevel(e,"cameras",t)},r.image=function(e,t){return r.topLevel(e,"images",t)},r.material=function(e,t){return r.topLevel(e,"materials",t)},r.materialValue=function(e,t){let n=e.values;(0,o.A)(e.extensions)&&(0,o.A)(e.extensions.KHR_techniques_webgl)&&(n=e.extensions.KHR_techniques_webgl.values);for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const i=t(n[e],e);if((0,o.A)(i))return i}},r.mesh=function(e,t){return r.topLevel(e,"meshes",t)},r.meshPrimitive=function(e,t){const n=e.primitives;if((0,o.A)(n)){const e=n.length;for(let i=0;i<e;i++){const e=t(n[i],i);if((0,o.A)(e))return e}}},r.meshPrimitiveAttribute=function(e,t){const n=e.attributes;for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const i=t(n[e],e);if((0,o.A)(i))return i}},r.meshPrimitiveTarget=function(e,t){const n=e.targets;if((0,o.A)(n)){const e=n.length;for(let i=0;i<e;++i){const e=t(n[i],i);if((0,o.A)(e))return e}}},r.meshPrimitiveTargetAttribute=function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=t(e[n],n);if((0,o.A)(i))return i}},r.node=function(e,t){return r.topLevel(e,"nodes",t)},r.nodeInTree=function(e,t,n){const i=e.nodes;if((0,o.A)(i)){const s=t.length;for(let a=0;a<s;a++){const s=t[a],c=i[s];if((0,o.A)(c)){let t=n(c,s);if((0,o.A)(t))return t;const i=c.children;if((0,o.A)(i)&&(t=r.nodeInTree(e,i,n),(0,o.A)(t)))return t}}}},r.nodeInScene=function(e,t,n){const i=t.nodes;if((0,o.A)(i))return r.nodeInTree(e,i,n)},r.program=function(e,t){return(0,i.A)(e,"KHR_techniques_webgl")?r.object(e.extensions.KHR_techniques_webgl.programs,t):r.topLevel(e,"programs",t)},r.sampler=function(e,t){return r.topLevel(e,"samplers",t)},r.scene=function(e,t){return r.topLevel(e,"scenes",t)},r.shader=function(e,t){return(0,i.A)(e,"KHR_techniques_webgl")?r.object(e.extensions.KHR_techniques_webgl.shaders,t):r.topLevel(e,"shaders",t)},r.skin=function(e,t){return r.topLevel(e,"skins",t)},r.skinJoint=function(e,t){const n=e.joints;if((0,o.A)(n)){const e=n.length;for(let i=0;i<e;i++){const e=t(n[i]);if((0,o.A)(e))return e}}},r.techniqueAttribute=function(e,t){const n=e.attributes;for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const i=t(n[e],e);if((0,o.A)(i))return i}},r.techniqueUniform=function(e,t){const n=e.uniforms;for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const i=t(n[e],e);if((0,o.A)(i))return i}},r.techniqueParameter=function(e,t){const n=e.parameters;for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const i=t(n[e],e);if((0,o.A)(i))return i}},r.technique=function(e,t){return(0,i.A)(e,"KHR_techniques_webgl")?r.object(e.extensions.KHR_techniques_webgl.techniques,t):r.topLevel(e,"techniques",t)},r.texture=function(e,t){return r.topLevel(e,"textures",t)};const s=r},724447:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(155463);const o=function(e,t){const n={byteLength:t.length,extras:{_pipeline:{source:t}}},o={buffer:(0,i.A)(e.buffers,n),byteOffset:0,byteLength:t.length};return(0,i.A)(e.bufferViews,o)}},267047:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(155463),o=n(133240),r=n(534702),s=n(491446),a=n(352581);function c(e){(0,s.A)(e)&&(e.texCoord=e.texCoord??0)}const l=function(e){o.A.accessor(e,function(e){(0,s.A)(e.bufferView)&&(e.byteOffset=e.byteOffset??0)}),o.A.bufferView(e,function(e){(0,s.A)(e.buffer)&&(e.byteOffset=e.byteOffset??0)}),o.A.mesh(e,function(t){o.A.meshPrimitive(t,function(t){if(t.mode=t.mode??a.A.TRIANGLES,!(0,s.A)(t.material)){(0,s.A)(e.materials)||(e.materials=[]);const n={name:"default"};t.material=(0,i.A)(e.materials,n)}})}),o.A.accessorContainingVertexAttributeData(e,function(t){const n=e.accessors[t],i=n.bufferView;if(n.normalized=n.normalized??!1,(0,s.A)(i)){const t=e.bufferViews[i];t.byteStride=(0,r.A)(e,n),t.target=a.A.ARRAY_BUFFER}}),o.A.accessorContainingIndexData(e,function(t){const n=e.accessors[t].bufferView;(0,s.A)(n)&&(e.bufferViews[n].target=a.A.ELEMENT_ARRAY_BUFFER)}),o.A.material(e,function(e){const t=e.extensions??{},n=t.KHR_materials_common;if((0,s.A)(n)){const e=n.technique,t=(0,s.A)(n.values)?n.values:{};return n.values=t,t.ambient=(0,s.A)(t.ambient)?t.ambient:[0,0,0,1],t.emission=(0,s.A)(t.emission)?t.emission:[0,0,0,1],t.transparency=t.transparency??1,"CONSTANT"!==e&&(t.diffuse=(0,s.A)(t.diffuse)?t.diffuse:[0,0,0,1],"LAMBERT"!==e&&(t.specular=(0,s.A)(t.specular)?t.specular:[0,0,0,1],t.shininess=t.shininess??0)),n.transparent=n.transparent??!1,void(n.doubleSided=n.doubleSided??!1)}e.emissiveFactor=e.emissiveFactor??[0,0,0],e.alphaMode=e.alphaMode??"OPAQUE",e.doubleSided=e.doubleSided??!1,"MASK"===e.alphaMode&&(e.alphaCutoff=e.alphaCutoff??.5);const i=t.KHR_techniques_webgl;(0,s.A)(i)&&o.A.materialValue(e,function(e){(0,s.A)(e.index)&&c(e)}),c(e.emissiveTexture),c(e.normalTexture),c(e.occlusionTexture);const r=e.pbrMetallicRoughness;(0,s.A)(r)&&(r.baseColorFactor=r.baseColorFactor??[1,1,1,1],r.metallicFactor=r.metallicFactor??1,r.roughnessFactor=r.roughnessFactor??1,c(r.baseColorTexture),c(r.metallicRoughnessTexture));const a=t.KHR_materials_pbrSpecularGlossiness;(0,s.A)(a)&&(a.diffuseFactor=a.diffuseFactor??[1,1,1,1],a.specularFactor=a.specularFactor??[1,1,1],a.glossinessFactor=a.glossinessFactor??1,c(a.specularGlossinessTexture))}),o.A.animation(e,function(e){o.A.animationSampler(e,function(e){e.interpolation=e.interpolation??"LINEAR"})});const t=function(e){const t={};return o.A.animation(e,function(e){o.A.animationChannel(e,function(e){const n=e.target,i=n.node,o=n.path;"translation"!==o&&"rotation"!==o&&"scale"!==o||(t[i]=!0)})}),t}(e);return o.A.node(e,function(e,n){(0,s.A)(t[n])||(0,s.A)(e.translation)||(0,s.A)(e.rotation)||(0,s.A)(e.scale)?(e.translation=e.translation??[0,0,0],e.rotation=e.rotation??[0,0,0,1],e.scale=e.scale??[1,1,1]):e.matrix=e.matrix??[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}),o.A.sampler(e,function(e){e.wrapS=e.wrapS??a.A.REPEAT,e.wrapT=e.wrapT??a.A.REPEAT}),(0,s.A)(e.scenes)&&!(0,s.A)(e.scene)&&(e.scene=0),e}},84334:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(114098),o=n(155463),r=n(491446);const s=function(e,t){let n=e.extensionsRequired;(0,r.A)(n)||(n=[],e.extensionsRequired=n),(0,o.A)(n,t,!0),(0,i.A)(e,t)}},114098:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(155463),o=n(491446);const r=function(e,t){let n=e.extensionsUsed;(0,o.A)(n)||(n=[],e.extensionsUsed=n),(0,i.A)(n,t,!0)}},865980:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(133240),o=n(491446);function r(e){e.extras=(0,o.A)(e.extras)?e.extras:{},e.extras._pipeline=(0,o.A)(e.extras._pipeline)?e.extras._pipeline:{}}const s=function(e){return i.A.shader(e,function(e){r(e)}),i.A.buffer(e,function(e){r(e)}),i.A.image(e,function(e){r(e)}),r(e),e}},155463:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=function(e,t,n){if(n=n??!1){const n=e.indexOf(t);if(n>-1)return n}return e.push(t),e.length-1}},839078:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(534702),o=n(614480),r=n(137261),s=n(571804),a=n(491446);const c=function(e,t){const n=e.bufferViews,c=e.buffers,l=t.bufferView,u=(0,r.A)(t.type);if(!(0,a.A)(t.bufferView))return{min:new Array(u).fill(0),max:new Array(u).fill(0)};const d=new Array(u).fill(Number.POSITIVE_INFINITY),h=new Array(u).fill(Number.NEGATIVE_INFINITY),A=n[l],p=c[A.buffer].extras._pipeline.source,f=t.count,m=(0,i.A)(e,t);let g=t.byteOffset+A.byteOffset+p.byteOffset;const _=t.componentType,y=s.A.getSizeInBytes(_),v=new DataView(p.buffer),T=new Array(u),b=(0,o.A)(_);for(let e=0;e<f;e++){b(v,g,u,y,T);for(let e=0;e<u;e++){const t=T[e];d[e]=Math.min(d[e],t),h[e]=Math.max(h[e],t)}g+=m}return{min:d,max:h}}},464335:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(133240),o=n(369031),r=n(491446);const s=function(e,t){o.A.typeOf.object("material",e),o.A.defined("handler",t);const n=e.pbrMetallicRoughness;if((0,r.A)(n)){if((0,r.A)(n.baseColorTexture)){const e=n.baseColorTexture,i=t(e.index,e);if((0,r.A)(i))return i}if((0,r.A)(n.metallicRoughnessTexture)){const e=n.metallicRoughnessTexture,i=t(e.index,e);if((0,r.A)(i))return i}}const{extensions:s}=e;if((0,r.A)(s)){const e=s.KHR_materials_pbrSpecularGlossiness;if((0,r.A)(e)){if((0,r.A)(e.diffuseTexture)){const n=e.diffuseTexture,i=t(n.index,n);if((0,r.A)(i))return i}if((0,r.A)(e.specularGlossinessTexture)){const n=e.specularGlossinessTexture,i=t(n.index,n);if((0,r.A)(i))return i}}const n=s.KHR_materials_specular;if((0,r.A)(n)){const{specularTexture:e,specularColorTexture:i}=n;if((0,r.A)(e)){const n=t(e.index,e);if((0,r.A)(n))return n}if((0,r.A)(i)){const e=t(i.index,i);if((0,r.A)(e))return e}}const i=s.KHR_materials_common;if((0,r.A)(i)&&(0,r.A)(i.values)){const{diffuse:e,ambient:n,emission:o,specular:s}=i.values;if((0,r.A)(e)&&(0,r.A)(e.index)){const n=t(e.index,e);if((0,r.A)(n))return n}if((0,r.A)(n)&&(0,r.A)(n.index)){const e=t(n.index,n);if((0,r.A)(e))return e}if((0,r.A)(o)&&(0,r.A)(o.index)){const e=t(o.index,o);if((0,r.A)(e))return e}if((0,r.A)(s)&&(0,r.A)(s.index)){const e=t(s.index,s);if((0,r.A)(e))return e}}}const a=i.A.materialValue(e,function(e){if((0,r.A)(e.index)){const n=t(e.index,e);if((0,r.A)(n))return n}});if((0,r.A)(a))return a;if((0,r.A)(e.emissiveTexture)){const n=e.emissiveTexture,i=t(n.index,n);if((0,r.A)(i))return i}if((0,r.A)(e.normalTexture)){const n=e.normalTexture,i=t(n.index,n);if((0,r.A)(i))return i}if((0,r.A)(e.occlusionTexture)){const n=e.occlusionTexture,i=t(n.index,n);if((0,r.A)(i))return i}}},534702:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(137261),o=n(571804),r=n(491446);const s=function(e,t){const n=t.bufferView;if((0,r.A)(n)){const t=e.bufferViews[n];if((0,r.A)(t.byteStride)&&t.byteStride>0)return t.byteStride}return o.A.getSizeInBytes(t.componentType)*(0,i.A)(t.type)}},614480:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(571804);const o=function(e){switch(e){case i.A.BYTE:return function(e,t,n,i,o){for(let r=0;r<n;++r)o[r]=e.getInt8(t+r*i)};case i.A.UNSIGNED_BYTE:return function(e,t,n,i,o){for(let r=0;r<n;++r)o[r]=e.getUint8(t+r*i)};case i.A.SHORT:return function(e,t,n,i,o){for(let r=0;r<n;++r)o[r]=e.getInt16(t+r*i,!0)};case i.A.UNSIGNED_SHORT:return function(e,t,n,i,o){for(let r=0;r<n;++r)o[r]=e.getUint16(t+r*i,!0)};case i.A.INT:return function(e,t,n,i,o){for(let r=0;r<n;++r)o[r]=e.getInt32(t+r*i,!0)};case i.A.UNSIGNED_INT:return function(e,t,n,i,o){for(let r=0;r<n;++r)o[r]=e.getUint32(t+r*i,!0)};case i.A.FLOAT:return function(e,t,n,i,o){for(let r=0;r<n;++r)o[r]=e.getFloat32(t+r*i,!0)};case i.A.DOUBLE:return function(e,t,n,i,o){for(let r=0;r<n;++r)o[r]=e.getFloat64(t+r*i,!0)}}}},884137:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var i=n(114098),o=n(133240),r=n(491446),s=n(352581);const a=[s.A.FUNC_ADD,s.A.FUNC_ADD],c=[s.A.ONE,s.A.ZERO,s.A.ONE,s.A.ZERO];function l(e,t){const n=e.enable;return!!(0,r.A)(n)&&n.indexOf(t)>-1}const u=[s.A.ZERO,s.A.ONE,s.A.SRC_COLOR,s.A.ONE_MINUS_SRC_COLOR,s.A.SRC_ALPHA,s.A.ONE_MINUS_SRC_ALPHA,s.A.DST_ALPHA,s.A.ONE_MINUS_DST_ALPHA,s.A.DST_COLOR,s.A.ONE_MINUS_DST_COLOR];function d(e,t){if(!(0,r.A)(e))return t;for(let n=0;n<4;n++)if(-1===u.indexOf(e[n]))return t;return e}const h=function(e){const t={},n={},u=e.techniques;return(0,r.A)(u)?(o.A.technique(e,function(e,i){const o=e.states;if((0,r.A)(o)){const u=n[i]={};if(l(o,s.A.BLEND)){u.alphaMode="BLEND";const e=o.functions;(0,r.A)(e)&&((0,r.A)(e.blendEquationSeparate)||(0,r.A)(e.blendFuncSeparate))&&(t[i]={blendEquation:e.blendEquationSeparate??a,blendFactors:d(e.blendFuncSeparate,c)})}l(o,s.A.CULL_FACE)||(u.doubleSided=!0),delete e.states}}),Object.keys(t).length>0&&((0,r.A)(e.extensions)||(e.extensions={}),(0,i.A)(e,"KHR_blend")),o.A.material(e,function(e){if((0,r.A)(e.technique)){const i=n[e.technique];o.A.objectLegacy(i,function(t,n){e[n]=t});const s=t[e.technique];(0,r.A)(s)&&((0,r.A)(e.extensions)||(e.extensions={}),e.extensions.KHR_blend=s)}}),e):e}},494490:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(114098),o=n(84334),r=n(155463),s=n(133240),a=n(491446);const c=function(e){const t=e.techniques,n={},c={},l={};if((0,a.A)(t)){const t={programs:[],shaders:[],techniques:[]},u=e.glExtensionsUsed;delete e.glExtensionsUsed,s.A.technique(e,function(i,o){const d={name:i.name,program:void 0,attributes:{},uniforms:{}};let h;if(s.A.techniqueAttribute(i,function(e,t){h=i.parameters[e],d.attributes[t]={semantic:h.semantic}}),s.A.techniqueUniform(i,function(e,t){h=i.parameters[e],d.uniforms[t]={count:h.count,node:h.node,type:h.type,semantic:h.semantic,value:h.value},(0,a.A)(n[o])||(n[o]={}),n[o][e]=t}),(0,a.A)(l[i.program]))d.program=l[i.program];else{const n=e.programs[i.program],o={name:n.name,fragmentShader:void 0,vertexShader:void 0,glExtensions:u},s=e.shaders[n.fragmentShader];o.fragmentShader=(0,r.A)(t.shaders,s,!0);const a=e.shaders[n.vertexShader];o.vertexShader=(0,r.A)(t.shaders,a,!0),d.program=(0,r.A)(t.programs,o),l[i.program]=d.program}c[o]=(0,r.A)(t.techniques,d)}),t.techniques.length>0&&((0,a.A)(e.extensions)||(e.extensions={}),e.extensions.KHR_techniques_webgl=t,(0,i.A)(e,"KHR_techniques_webgl"),(0,o.A)(e,"KHR_techniques_webgl"))}return s.A.material(e,function(e){if((0,a.A)(e.technique)){const t={technique:c[e.technique]};s.A.objectLegacy(e.values,function(i,o){(0,a.A)(t.values)||(t.values={});const r=n[e.technique][o];(0,a.A)(r)&&(t.values[r]=i)}),(0,a.A)(e.extensions)||(e.extensions={}),e.extensions.KHR_techniques_webgl=t}delete e.technique,delete e.values}),delete e.techniques,delete e.programs,delete e.shaders,e}},137261:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=function(e){switch(e){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}}},512286:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(865980),o=n(277315),r=n(491446),s=n(452684),a=n(241839),c=n(123245);function l(e,t,n){const i=new DataView(e.buffer),o=new Array(n);for(let r=0;r<n;++r)o[r]=i.getUint32(e.byteOffset+t+4*r,!0);return o}const u=function(e){if("glTF"!==(0,s.A)(e))throw new c.A("File is not valid binary glTF");const t=l(e,0,5),n=t[1];if(1!==n&&2!==n)throw new c.A("Binary glTF version is not 1 or 2");return 1===n?function(e,t){const n=t[2],s=t[3];if(0!==t[4])throw new c.A("Binary glTF scene format is not JSON");const l=20+s,u=(0,a.A)(e,20,s),d=JSON.parse(u);(0,i.A)(d);const h=e.subarray(l,n),A=d.buffers;if((0,r.A)(A)&&Object.keys(A).length>0){const e=A.binary_glTF??A.KHR_binary_glTF;(0,r.A)(e)&&(e.extras._pipeline.source=h,delete e.uri)}return(0,o.A)(d,"KHR_binary_glTF"),d}(e,t):function(e,t){const n=t[2];let o,s,c=12;for(;c<n;){const t=l(e,c,2),n=t[0],r=t[1];c+=8;const u=e.subarray(c,c+n);if(c+=n,1313821514===r){const e=(0,a.A)(u);o=JSON.parse(e),(0,i.A)(o)}else 5130562===r&&(s=u)}if((0,r.A)(o)&&(0,r.A)(s)){const e=o.buffers;(0,r.A)(e)&&e.length>0&&(e[0].extras._pipeline.source=s)}return o}(e,t)}},578283:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(534702),o=n(614480),r=n(137261),s=n(571804),a=n(491446);const c=function(e,t){const n=(0,i.A)(e,t),c=s.A.getSizeInBytes(t.componentType),l=(0,r.A)(t.type),u=t.count,d=new Array(l*u);if(!(0,a.A)(t.bufferView))return d.fill(0);const h=e.bufferViews[t.bufferView],A=e.buffers[h.buffer].extras._pipeline.source;let p=t.byteOffset+h.byteOffset+A.byteOffset;const f=new DataView(A.buffer),m=new Array(l),g=(0,o.A)(t.componentType);for(let e=0;e<u;++e){g(f,p,l,c,m);for(let t=0;t<l;++t)d[e*l+t]=m[t];p+=n}return d}},166479:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(133240),o=n(277315),r=n(491446);function s(e,t){if(Array.isArray(e)){const n=e.length;for(let i=0;i<n;++i)s(e[i],t)}else if(null!==e&&"object"==typeof e&&e.constructor===Object){const n=e.extensions;let i;(0,r.A)(n)&&(i=n[t],(0,r.A)(i)&&(delete n[t],0===Object.keys(n).length&&delete e.extensions));for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&s(e[n],t);return i}}const a=function(e,t){return(0,o.A)(e,t),"CESIUM_RTC"===t&&function(e){i.A.technique(e,function(e){i.A.techniqueUniform(e,function(e){"CESIUM_RTC_MODELVIEW"===e.semantic&&(e.semantic="MODELVIEW")})})}(e),s(e,t)}},495331:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(491446);const o=function(e,t){const n=e.extensionsRequired;if((0,i.A)(n)){const i=n.indexOf(t);i>=0&&n.splice(i,1),0===n.length&&delete e.extensionsRequired}}},277315:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(495331),o=n(491446);const r=function(e,t){const n=e.extensionsUsed;if((0,o.A)(n)){const o=n.indexOf(t);o>=0&&n.splice(o,1),(0,i.A)(e,t),0===n.length&&delete e.extensionsUsed}}},899557:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(133240),o=n(491446);function r(e){(0,o.A)(e.extras)&&((0,o.A)(e.extras._pipeline)&&delete e.extras._pipeline,0===Object.keys(e.extras).length&&delete e.extras)}const s=function(e){return i.A.shader(e,function(e){r(e)}),i.A.buffer(e,function(e){r(e)}),i.A.image(e,function(e){r(e)}),r(e),e}},330483:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var i=n(133240),o=n(464335),r=n(493435),s=n(491446);const a=["mesh","node","material","accessor","bufferView","buffer","texture","sampler","image"],c={accessor:"accessors",buffer:"buffers",bufferView:"bufferViews",image:"images",node:"nodes",material:"materials",mesh:"meshes",sampler:"samplers",texture:"textures"};function l(){}function u(){}function d(e,t,n){const i=e.nodes[t];return!((0,s.A)(i.mesh)||(0,s.A)(i.camera)||(0,s.A)(i.skin)||(0,s.A)(i.weights)||(0,s.A)(i.extras)||(0,s.A)(i.extensions)&&0!==Object.keys(i.extensions).length||(0,s.A)(n[t])||(0,s.A)(i.children)&&0!==i.children.filter(function(t){return!d(e,t,n)}).length)}l.accessor=function(e,t){e.accessors.splice(t,1),i.A.mesh(e,function(e){i.A.meshPrimitive(e,function(e){i.A.meshPrimitiveAttribute(e,function(n,i){n>t&&e.attributes[i]--}),i.A.meshPrimitiveTarget(e,function(e){i.A.meshPrimitiveTargetAttribute(e,function(n,i){n>t&&e[i]--})});const n=e.indices;(0,s.A)(n)&&n>t&&e.indices--;const o=e.extensions;(0,s.A)(o)&&(0,s.A)(o.CESIUM_primitive_outline)&&o.CESIUM_primitive_outline.indices>t&&--o.CESIUM_primitive_outline.indices})}),i.A.skin(e,function(e){(0,s.A)(e.inverseBindMatrices)&&e.inverseBindMatrices>t&&e.inverseBindMatrices--}),i.A.animation(e,function(e){i.A.animationSampler(e,function(e){(0,s.A)(e.input)&&e.input>t&&e.input--,(0,s.A)(e.output)&&e.output>t&&e.output--})})},l.buffer=function(e,t){e.buffers.splice(t,1),i.A.bufferView(e,function(e){(0,s.A)(e.buffer)&&e.buffer>t&&e.buffer--,(0,s.A)(e.extensions)&&(0,s.A)(e.extensions.EXT_meshopt_compression)&&e.extensions.EXT_meshopt_compression.buffer--})},l.bufferView=function(e,t){if(e.bufferViews.splice(t,1),i.A.accessor(e,function(e){(0,s.A)(e.bufferView)&&e.bufferView>t&&e.bufferView--}),i.A.shader(e,function(e){(0,s.A)(e.bufferView)&&e.bufferView>t&&e.bufferView--}),i.A.image(e,function(e){(0,s.A)(e.bufferView)&&e.bufferView>t&&e.bufferView--}),(0,r.A)(e,"KHR_draco_mesh_compression")&&i.A.mesh(e,function(e){i.A.meshPrimitive(e,function(e){(0,s.A)(e.extensions)&&(0,s.A)(e.extensions.KHR_draco_mesh_compression)&&e.extensions.KHR_draco_mesh_compression.bufferView>t&&e.extensions.KHR_draco_mesh_compression.bufferView--})}),(0,r.A)(e,"EXT_feature_metadata")){const n=e.extensions.EXT_feature_metadata.featureTables;for(const e in n)if(n.hasOwnProperty(e)){const i=n[e].properties;if((0,s.A)(i))for(const e in i)if(i.hasOwnProperty(e)){const n=i[e];(0,s.A)(n.bufferView)&&n.bufferView>t&&n.bufferView--,(0,s.A)(n.arrayOffsetBufferView)&&n.arrayOffsetBufferView>t&&n.arrayOffsetBufferView--,(0,s.A)(n.stringOffsetBufferView)&&n.stringOffsetBufferView>t&&n.stringOffsetBufferView--}}}if((0,r.A)(e,"EXT_structural_metadata")){const n=e.extensions.EXT_structural_metadata.propertyTables;if((0,s.A)(n)){const e=n.length;for(let i=0;i<e;++i){const e=n[i].properties;for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];(0,s.A)(i.values)&&i.values>t&&i.values--,(0,s.A)(i.arrayOffsets)&&i.arrayOffsets>t&&i.arrayOffsets--,(0,s.A)(i.stringOffsets)&&i.stringOffsets>t&&i.stringOffsets--}}}}},l.image=function(e,t){e.images.splice(t,1),i.A.texture(e,function(e){(0,s.A)(e.source)&&e.source>t&&--e.source;const n=e.extensions;(0,s.A)(n)&&(0,s.A)(n.EXT_texture_webp)&&n.EXT_texture_webp.source>t?--e.extensions.EXT_texture_webp.source:(0,s.A)(n)&&(0,s.A)(n.KHR_texture_basisu)&&n.KHR_texture_basisu.source>t&&--e.extensions.KHR_texture_basisu.source})},l.mesh=function(e,t){e.meshes.splice(t,1),i.A.node(e,function(e){(0,s.A)(e.mesh)&&(e.mesh>t?e.mesh--:e.mesh===t&&delete e.mesh)})},l.node=function(e,t){e.nodes.splice(t,1),i.A.skin(e,function(e){(0,s.A)(e.skeleton)&&e.skeleton>t&&e.skeleton--,e.joints=e.joints.map(function(e){return e>t?e-1:e})}),i.A.animation(e,function(e){i.A.animationChannel(e,function(e){(0,s.A)(e.target)&&(0,s.A)(e.target.node)&&e.target.node>t&&e.target.node--})}),i.A.technique(e,function(e){i.A.techniqueUniform(e,function(e){(0,s.A)(e.node)&&e.node>t&&e.node--})}),i.A.node(e,function(e){(0,s.A)(e.children)&&(e.children=e.children.filter(function(e){return e!==t}).map(function(e){return e>t?e-1:e}))}),i.A.scene(e,function(e){e.nodes=e.nodes.filter(function(e){return e!==t}).map(function(e){return e>t?e-1:e})})},l.material=function(e,t){e.materials.splice(t,1),i.A.mesh(e,function(e){i.A.meshPrimitive(e,function(e){(0,s.A)(e.material)&&e.material>t&&e.material--})})},l.sampler=function(e,t){e.samplers.splice(t,1),i.A.texture(e,function(e){(0,s.A)(e.sampler)&&e.sampler>t&&--e.sampler})},l.texture=function(e,t){if(e.textures.splice(t,1),i.A.material(e,function(e){(0,o.A)(e,function(e,n){n.index>t&&--n.index})}),(0,r.A)(e,"EXT_feature_metadata")){i.A.mesh(e,function(e){i.A.meshPrimitive(e,function(e){const n=e.extensions;if((0,s.A)(n)&&(0,s.A)(n.EXT_feature_metadata)){const e=n.EXT_feature_metadata.featureIdTextures;if((0,s.A)(e)){const n=e.length;for(let i=0;i<n;++i){const n=e[i].featureIds.texture;n.index>t&&--n.index}}}})});const n=e.extensions.EXT_feature_metadata.featureTextures;for(const e in n)if(n.hasOwnProperty(e)){const i=n[e].properties;if((0,s.A)(i))for(const e in i)if(i.hasOwnProperty(e)){const n=i[e].texture;n.index>t&&--n.index}}}if((0,r.A)(e,"EXT_mesh_features")&&i.A.mesh(e,function(e){i.A.meshPrimitive(e,function(e){const n=e.extensions;if((0,s.A)(n)&&(0,s.A)(n.EXT_mesh_features)){const e=n.EXT_mesh_features.featureIds;if((0,s.A)(e)){const n=e.length;for(let i=0;i<n;++i){const n=e[i];(0,s.A)(n.texture)&&n.texture.index>t&&--n.texture.index}}}})}),(0,r.A)(e,"EXT_structural_metadata")){const n=e.extensions.EXT_structural_metadata.propertyTextures;if((0,s.A)(n)){const e=n.length;for(let i=0;i<e;++i){const e=n[i].properties;for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];i.index>t&&--i.index}}}}},u.accessor=function(e){const t={};return i.A.mesh(e,function(e){i.A.meshPrimitive(e,function(e){i.A.meshPrimitiveAttribute(e,function(e){t[e]=!0}),i.A.meshPrimitiveTarget(e,function(e){i.A.meshPrimitiveTargetAttribute(e,function(e){t[e]=!0})});const n=e.indices;(0,s.A)(n)&&(t[n]=!0)})}),i.A.skin(e,function(e){(0,s.A)(e.inverseBindMatrices)&&(t[e.inverseBindMatrices]=!0)}),i.A.animation(e,function(e){i.A.animationSampler(e,function(e){(0,s.A)(e.input)&&(t[e.input]=!0),(0,s.A)(e.output)&&(t[e.output]=!0)})}),(0,r.A)(e,"EXT_mesh_gpu_instancing")&&i.A.node(e,function(e){(0,s.A)(e.extensions)&&(0,s.A)(e.extensions.EXT_mesh_gpu_instancing)&&Object.keys(e.extensions.EXT_mesh_gpu_instancing.attributes).forEach(function(n){const i=e.extensions.EXT_mesh_gpu_instancing.attributes[n];t[i]=!0})}),(0,r.A)(e,"CESIUM_primitive_outline")&&i.A.mesh(e,function(e){i.A.meshPrimitive(e,function(e){const n=e.extensions;if((0,s.A)(n)&&(0,s.A)(n.CESIUM_primitive_outline)){const e=n.CESIUM_primitive_outline.indices;(0,s.A)(e)&&(t[e]=!0)}})}),t},u.buffer=function(e){const t={};return i.A.bufferView(e,function(e){(0,s.A)(e.buffer)&&(t[e.buffer]=!0),(0,s.A)(e.extensions)&&(0,s.A)(e.extensions.EXT_meshopt_compression)&&(t[e.extensions.EXT_meshopt_compression.buffer]=!0)}),t},u.bufferView=function(e){const t={};if(i.A.accessor(e,function(e){(0,s.A)(e.bufferView)&&(t[e.bufferView]=!0)}),i.A.shader(e,function(e){(0,s.A)(e.bufferView)&&(t[e.bufferView]=!0)}),i.A.image(e,function(e){(0,s.A)(e.bufferView)&&(t[e.bufferView]=!0)}),(0,r.A)(e,"KHR_draco_mesh_compression")&&i.A.mesh(e,function(e){i.A.meshPrimitive(e,function(e){(0,s.A)(e.extensions)&&(0,s.A)(e.extensions.KHR_draco_mesh_compression)&&(t[e.extensions.KHR_draco_mesh_compression.bufferView]=!0)})}),(0,r.A)(e,"EXT_feature_metadata")){const n=e.extensions.EXT_feature_metadata.featureTables;for(const e in n)if(n.hasOwnProperty(e)){const i=n[e].properties;if((0,s.A)(i))for(const e in i)if(i.hasOwnProperty(e)){const n=i[e];(0,s.A)(n.bufferView)&&(t[n.bufferView]=!0),(0,s.A)(n.arrayOffsetBufferView)&&(t[n.arrayOffsetBufferView]=!0),(0,s.A)(n.stringOffsetBufferView)&&(t[n.stringOffsetBufferView]=!0)}}}if((0,r.A)(e,"EXT_structural_metadata")){const n=e.extensions.EXT_structural_metadata.propertyTables;if((0,s.A)(n)){const e=n.length;for(let i=0;i<e;++i){const e=n[i].properties;for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];(0,s.A)(i.values)&&(t[i.values]=!0),(0,s.A)(i.arrayOffsets)&&(t[i.arrayOffsets]=!0),(0,s.A)(i.stringOffsets)&&(t[i.stringOffsets]=!0)}}}}return t},u.image=function(e){const t={};return i.A.texture(e,function(e){(0,s.A)(e.source)&&(t[e.source]=!0),(0,s.A)(e.extensions)&&(0,s.A)(e.extensions.EXT_texture_webp)?t[e.extensions.EXT_texture_webp.source]=!0:(0,s.A)(e.extensions)&&(0,s.A)(e.extensions.KHR_texture_basisu)&&(t[e.extensions.KHR_texture_basisu.source]=!0)}),t},u.mesh=function(e){const t={};return i.A.node(e,function(n){if((0,s.A)(n.mesh&&(0,s.A)(e.meshes))){const i=e.meshes[n.mesh];(0,s.A)(i)&&(0,s.A)(i.primitives)&&i.primitives.length>0&&(t[n.mesh]=!0)}}),t},u.node=function(e){const t={};return i.A.skin(e,function(e){(0,s.A)(e.skeleton)&&(t[e.skeleton]=!0),i.A.skinJoint(e,function(e){t[e]=!0})}),i.A.animation(e,function(e){i.A.animationChannel(e,function(e){(0,s.A)(e.target)&&(0,s.A)(e.target.node)&&(t[e.target.node]=!0)})}),i.A.technique(e,function(e){i.A.techniqueUniform(e,function(e){(0,s.A)(e.node)&&(t[e.node]=!0)})}),i.A.node(e,function(n,i){d(e,i,t)||(t[i]=!0)}),t},u.material=function(e){const t={};return i.A.mesh(e,function(e){i.A.meshPrimitive(e,function(e){(0,s.A)(e.material)&&(t[e.material]=!0)})}),t},u.texture=function(e){const t={};if(i.A.material(e,function(e){(0,o.A)(e,function(e){t[e]=!0})}),(0,r.A)(e,"EXT_feature_metadata")){i.A.mesh(e,function(e){i.A.meshPrimitive(e,function(e){const n=e.extensions;if((0,s.A)(n)&&(0,s.A)(n.EXT_feature_metadata)){const e=n.EXT_feature_metadata.featureIdTextures;if((0,s.A)(e)){const n=e.length;for(let i=0;i<n;++i){const n=e[i].featureIds.texture;t[n.index]=!0}}}})});const n=e.extensions.EXT_feature_metadata.featureTextures;for(const e in n)if(n.hasOwnProperty(e)){const i=n[e].properties;if((0,s.A)(i))for(const e in i)if(i.hasOwnProperty(e)){const n=i[e].texture;t[n.index]=!0}}}if((0,r.A)(e,"EXT_mesh_features")&&i.A.mesh(e,function(e){i.A.meshPrimitive(e,function(e){const n=e.extensions;if((0,s.A)(n)&&(0,s.A)(n.EXT_mesh_features)){const e=n.EXT_mesh_features.featureIds;if((0,s.A)(e)){const n=e.length;for(let i=0;i<n;++i){const n=e[i];(0,s.A)(n.texture)&&(t[n.texture.index]=!0)}}}})}),(0,r.A)(e,"EXT_structural_metadata")){const n=e.extensions.EXT_structural_metadata.propertyTextures;if((0,s.A)(n)){const e=n.length;for(let i=0;i<e;++i){const e=n[i].properties;for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];t[i.index]=!0}}}}return t},u.sampler=function(e){const t={};return i.A.texture(e,function(e){(0,s.A)(e.sampler)&&(t[e.sampler]=!0)}),t};const h=function(e,t){return t=t??a,a.forEach(function(n){t.indexOf(n)>-1&&function(e,t){const n=e[c[t]];if((0,s.A)(n)){let i=0;const o=u[t](e),r=n.length;for(let n=0;n<r;++n)o[n]||(l[t](e,n-i),i++)}}(e,n)}),e}},94334:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(724447),o=n(133240),r=n(578283),s=n(571804),a=n(352581);function c(e,t,n){const o=s.A.createTypedArray(n,(0,r.A)(e,t)),a=new Uint8Array(o.buffer);t.bufferView=(0,i.A)(e,a),t.componentType=n,t.byteOffset=0}const l=function(e){let t;return o.A.accessorWithSemantic(e,"JOINTS_0",function(n){const i=e.accessors[n];t=i.componentType,t===a.A.BYTE?c(e,i,s.A.UNSIGNED_BYTE):t!==a.A.UNSIGNED_BYTE&&t!==a.A.UNSIGNED_SHORT&&c(e,i,s.A.UNSIGNED_SHORT)}),o.A.accessorWithSemantic(e,"WEIGHTS_0",function(n){const i=e.accessors[n];t=i.componentType,t===a.A.BYTE?c(e,i,s.A.UNSIGNED_BYTE):t===a.A.SHORT&&c(e,i,s.A.UNSIGNED_SHORT)}),e}},913081:(e,t,n)=>{"use strict";n.d(t,{A:()=>k});var i=n(114098),o=n(155463),r=n(839078),s=n(133240),a=n(534702),c=n(137261),l=n(884137),u=n(494490),d=n(330483),h=n(94334),A=n(166479),p=n(267980),f=n(626809),m=n(376758),g=n(571804),_=n(491446),y=n(584164),v=n(99479),T=n(352581);const b={.8:function(e){(0,_.A)(e.asset)||(e.asset={});const t=e.asset;if(t.version="1.0","string"==typeof t.profile){const e=t.profile.split(" ");t.profile={api:e[0],version:e[1]}}else t.profile={};if((0,_.A)(e.version)&&delete e.version,w(e),function(e){const t=e.meshes;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const n=t[e].primitives;if((0,_.A)(n)){const e=n.length;for(let t=0;t<e;++t){const e=n[t],i=e.primitive??T.A.TRIANGLES;e.mode=e.mode??i,delete e.primitive}}}}(e),function(e){const t=e.nodes,n=new p.A,i=new v.A;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const o=t[e];if((0,_.A)(o.rotation)){const e=o.rotation;p.A.fromArray(e,0,n),v.A.fromAxisAngle(n,e[3],i),o.rotation=[i.x,i.y,i.z,i.w]}const r=o.instanceSkin;(0,_.A)(r)&&(o.skeletons=r.skeletons,o.skin=r.skin,o.meshes=r.meshes,delete o.instanceSkin)}}(e),function(e){const t=e.animations,n=e.accessors,i=e.bufferViews,o=e.buffers,r={},s=new p.A,a=new v.A;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const l=t[e],u=l.channels,d=l.parameters,h=l.samplers;if((0,_.A)(u)){const e=u.length;for(let t=0;t<e;++t){const e=u[t];if("rotation"===e.target.path){const t=d[h[e.sampler].output];if((0,_.A)(r[t]))continue;r[t]=!0;const l=n[t],u=i[l.bufferView],A=o[u.buffer].extras._pipeline.source,f=A.byteOffset+u.byteOffset+l.byteOffset,m=l.componentType,y=l.count,T=(0,c.A)(l.type),b=l.count*T,w=g.A.createArrayBufferView(m,A.buffer,f,b);for(let e=0;e<y;e++){const t=e*T;p.A.unpack(w,t,s);const n=w[t+3];v.A.fromAxisAngle(s,n,a),v.A.pack(a,w,t)}}}}}}(e),function(e){const t=e.techniques;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const n=t[e],i=n.passes;if((0,_.A)(i)){const e=n.pass??"defaultPass";if(Object.prototype.hasOwnProperty.call(i,e)){const t=i[e],o=t.instanceProgram;n.attributes=n.attributes??o.attributes,n.program=n.program??o.program,n.uniforms=n.uniforms??o.uniforms,n.states=n.states??t.states}delete n.passes,delete n.pass}}}(e),(0,_.A)(e.allExtensions)&&(e.extensionsUsed=e.allExtensions,delete e.allExtensions),(0,_.A)(e.lights)){const t=e.extensions??{};e.extensions=t;const n=t.KHR_materials_common??{};t.KHR_materials_common=n,n.lights=e.lights,delete e.lights,(0,i.A)(e,"KHR_materials_common")}},"1.0":function(e){e.asset=e.asset??{},e.asset.version="2.0",w(e),function(e){const t=e.animations;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const n=t[e],i=n.parameters;if((0,_.A)(i)){const e=n.samplers;for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];n.input=i[n.input],n.output=i[n.output]}delete n.parameters}}}(e),function(e){s.A.node(e,function(t,n){P(t)&&D(e,n)})}(e),function(e){let t;const n={accessors:{},animations:{},buffers:{},bufferViews:{},cameras:{},images:{},materials:{},meshes:{},nodes:{},programs:{},samplers:{},scenes:{},shaders:{},skins:{},textures:{},techniques:{}};let i;const r={},a=e.nodes;for(const e in a)Object.prototype.hasOwnProperty.call(a,e)&&(i=a[e].jointName,(0,_.A)(i)&&(r[i]=e));for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&(0,_.A)(n[t])){const i={},o=e[t];e[t]=x(o,i),n[t]=i}for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(r[i]=n.nodes[r[i]]);(0,_.A)(e.scene)&&(e.scene=n.scenes[e.scene]),s.A.bufferView(e,function(e){(0,_.A)(e.buffer)&&(e.buffer=n.buffers[e.buffer])}),s.A.accessor(e,function(e){(0,_.A)(e.bufferView)&&(e.bufferView=n.bufferViews[e.bufferView])}),s.A.shader(e,function(e){const t=e.extensions;if((0,_.A)(t)){const i=t.KHR_binary_glTF;(0,_.A)(i)&&(e.bufferView=n.bufferViews[i.bufferView],delete t.KHR_binary_glTF),0===Object.keys(t).length&&delete e.extensions}}),s.A.program(e,function(e){(0,_.A)(e.vertexShader)&&(e.vertexShader=n.shaders[e.vertexShader]),(0,_.A)(e.fragmentShader)&&(e.fragmentShader=n.shaders[e.fragmentShader])}),s.A.technique(e,function(e){(0,_.A)(e.program)&&(e.program=n.programs[e.program]),s.A.techniqueParameter(e,function(e){(0,_.A)(e.node)&&(e.node=n.nodes[e.node]);const t=e.value;"string"==typeof t&&(e.value={index:n.textures[t]})})}),s.A.mesh(e,function(e){s.A.meshPrimitive(e,function(e){(0,_.A)(e.indices)&&(e.indices=n.accessors[e.indices]),s.A.meshPrimitiveAttribute(e,function(t,i){e.attributes[i]=n.accessors[t]}),(0,_.A)(e.material)&&(e.material=n.materials[e.material])})}),s.A.node(e,function(i){let r=i.children;if((0,_.A)(r)){const e=r.length;for(t=0;t<e;++t)r[t]=n.nodes[r[t]]}if((0,_.A)(i.meshes)){const s=i.meshes,a=s.length;if(a>0)for(i.mesh=n.meshes[s[0]],t=1;t<a;++t){const a={mesh:n.meshes[s[t]]},c=(0,o.A)(e.nodes,a);(0,_.A)(r)||(r=[],i.children=r),r.push(c)}delete i.meshes}if((0,_.A)(i.camera)&&(i.camera=n.cameras[i.camera]),(0,_.A)(i.skin)&&(i.skin=n.skins[i.skin]),(0,_.A)(i.skeletons)){const t=i.skeletons;t.length>0&&(0,_.A)(i.skin)&&(e.skins[i.skin].skeleton=n.nodes[t[0]]),delete i.skeletons}(0,_.A)(i.jointName)&&delete i.jointName}),s.A.skin(e,function(e){(0,_.A)(e.inverseBindMatrices)&&(e.inverseBindMatrices=n.accessors[e.inverseBindMatrices]);const i=e.jointNames;if((0,_.A)(i)){const n=[],o=i.length;for(t=0;t<o;++t)n[t]=r[i[t]];e.joints=n,delete e.jointNames}}),s.A.scene(e,function(e){const i=e.nodes;if((0,_.A)(i)){const e=i.length;for(t=0;t<e;++t)i[t]=n.nodes[i[t]]}}),s.A.animation(e,function(e){const t={};e.samplers=x(e.samplers,t),s.A.animationSampler(e,function(e){e.input=n.accessors[e.input],e.output=n.accessors[e.output]}),s.A.animationChannel(e,function(e){e.sampler=t[e.sampler];const i=e.target;(0,_.A)(i)&&(i.node=n.nodes[i.id],delete i.id)})}),s.A.material(e,function(e){(0,_.A)(e.technique)&&(e.technique=n.techniques[e.technique]),s.A.materialValue(e,function(t,i){"string"==typeof t&&(e.values[i]={index:n.textures[t]})});const t=e.extensions;if((0,_.A)(t)){const e=t.KHR_materials_common;(0,_.A)(e)&&(0,_.A)(e.values)&&s.A.materialValue(e,function(t,i){"string"==typeof t&&(e.values[i]={index:n.textures[t]})})}}),s.A.image(e,function(e){const t=e.extensions;if((0,_.A)(t)){const i=t.KHR_binary_glTF;(0,_.A)(i)&&(e.bufferView=n.bufferViews[i.bufferView],e.mimeType=i.mimeType,delete t.KHR_binary_glTF),0===Object.keys(t).length&&delete e.extensions}}),s.A.texture(e,function(e){(0,_.A)(e.sampler)&&(e.sampler=n.samplers[e.sampler]),(0,_.A)(e.source)&&(e.source=n.images[e.source])})}(e),function(e){s.A.animation(e,function(e){s.A.animationSampler(e,function(e){delete e.name})})}(e),function(e){const t=e.asset;delete t.profile,delete t.premultipliedAlpha}(e),function(e){const t=e.extensionsUsed;if(e.extensionsRequired=e.extensionsRequired??[],(0,_.A)(t)){const n=t.length;for(let i=0;i<n;++i){const n=t[i];(0,_.A)(C[n])&&e.extensionsRequired.push(n)}}}(e),function(e){s.A.buffer(e,function(e){(0,_.A)(e.byteLength)||(e.byteLength=e.extras._pipeline.source.length)}),s.A.accessor(e,function(t){const n=t.bufferView;if((0,_.A)(n)){const i=e.bufferViews[n],o=I(e,t),r=t.byteOffset+t.count*o;i.byteLength=Math.max(i.byteLength??0,r)}})}(e),function(e){let t,n,i;const r=e.bufferViews,a={};s.A.accessorContainingVertexAttributeData(e,function(t){const n=e.accessors[t];(0,_.A)(n.bufferView)&&(a[n.bufferView]=!0)});const c={};s.A.accessor(e,function(e){(0,_.A)(e.bufferView)&&(c[e.bufferView]=c[e.bufferView]??[],c[e.bufferView].push(e))});for(const s in c)if(Object.prototype.hasOwnProperty.call(c,s)){i=r[s];const l=c[s];l.sort(function(e,t){return e.byteOffset-t.byteOffset});let u=0,d=0;const h=l.length;for(t=0;t<h;++t){let c=l[t];const A=I(e,c),p=c.byteOffset,f=c.count*A;delete c.byteStride;const g=t<h-1;if(A!==(g?I(e,l[t+1]):void 0)){const e=(0,m.A)(i,!0);a[s]&&(e.byteStride=A),e.byteOffset+=u,e.byteLength=p+f-u;const h=(0,o.A)(r,e);for(n=d;n<=t;++n)c=l[n],c.bufferView=h,c.byteOffset=c.byteOffset-u;u=g?l[t+1].byteOffset:void 0,d=t+1}}}(0,d.A)(e,["accessor","bufferView","buffer"])}(e),function(e){s.A.accessorWithSemantic(e,"POSITION",function(t){const n=e.accessors[t];if(!(0,_.A)(n.min)||!(0,_.A)(n.max)){const t=(0,r.A)(e,n);n.min=t.min,n.max=t.max}})}(e),function(e){s.A.animation(e,function(t){s.A.animationSampler(t,function(t){const n=e.accessors[t.input];if(!(0,_.A)(n.min)||!(0,_.A)(n.max)){const t=(0,r.A)(e,n);n.min=t.min,n.max=t.max}})})}(e),function(e){s.A.accessor(e,function(t){if((0,_.A)(t.min)||(0,_.A)(t.max)){const n=(0,r.A)(e,t);(0,_.A)(t.min)&&(t.min=n.min),(0,_.A)(t.max)&&(t.max=n.max)}})}(e),function(e){s.A.buffer(e,function(e){delete e.type})}(e),function(e){s.A.texture(e,function(e){delete e.format,delete e.internalFormat,delete e.target,delete e.type})}(e),function(e){s.A.mesh(e,function(e){s.A.meshPrimitive(e,function(e){s.A.meshPrimitiveAttribute(e,function(t,n){"TEXCOORD"===n?e.attributes.TEXCOORD_0=t:"COLOR"===n&&(e.attributes.COLOR_0=t)}),delete e.attributes.TEXCOORD,delete e.attributes.COLOR})}),s.A.technique(e,function(e){s.A.techniqueParameter(e,function(e){const t=e.semantic;(0,_.A)(t)&&("TEXCOORD"===t?e.semantic="TEXCOORD_0":"COLOR"===t&&(e.semantic="COLOR_0"))})})}(e),function(e){const t={};s.A.mesh(e,function(e){s.A.meshPrimitive(e,function(e){s.A.meshPrimitiveAttribute(e,function(e,n){if("_"!==n.charAt(0)){const e=n.search(/_[0-9]+/g);let i,o=n,r="_0";e>=0&&(o=n.substring(0,e),r=n.substring(e));const s=S[o];(0,_.A)(s)?(i=s+r,t[n]=i):(0,_.A)(E[o])||(i=`_${n}`,t[n]=i)}});for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n],o=e.attributes[n];(0,_.A)(o)&&(delete e.attributes[n],e.attributes[i]=o)}})}),s.A.technique(e,function(e){s.A.techniqueParameter(e,function(e){const n=t[e.semantic];(0,_.A)(n)&&(e.semantic=n)})})}(e),(0,h.A)(e),function(e){s.A.camera(e,function(e){const t=e.perspective;if((0,_.A)(t)){const e=t.aspectRatio;(0,_.A)(e)&&0===e&&delete t.aspectRatio;const n=t.yfov;(0,_.A)(n)&&0===n&&(t.yfov=1)}})}(e),(0,l.A)(e),(0,u.A)(e),function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];Array.isArray(n)&&0===n.length&&delete e[t]}s.A.node(e,function(e){(0,_.A)(e.children)&&0===e.children.length&&delete e.children})}(e)},"2.0":void 0};function w(e){const t=e.materials;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const n=t[e],i=n.instanceTechnique;(0,_.A)(i)&&(n.technique=i.technique,n.values=i.values,delete n.instanceTechnique)}}function x(e,t){const n=[];for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)){const o=e[i];t[i]=n.length,n.push(o),(0,_.A)(o.name)||(o.name=i)}return n}const C={CESIUM_RTC:!0,KHR_materials_common:!0,WEB3D_quantized_attributes:!0},E={POSITION:!0,NORMAL:!0,TANGENT:!0},S={COLOR:"COLOR",JOINT:"JOINTS",JOINTS:"JOINTS",TEXCOORD:"TEXCOORD",WEIGHT:"WEIGHTS",WEIGHTS:"WEIGHTS"};function I(e,t){return(0,_.A)(t.byteStride)&&0!==t.byteStride?t.byteStride:(0,a.A)(e,t)}function P(e){return(!(0,_.A)(e.children)||0===e.children.length)&&(!(0,_.A)(e.meshes)||0===e.meshes.length)&&!(0,_.A)(e.camera)&&!(0,_.A)(e.skin)&&!(0,_.A)(e.skeletons)&&!(0,_.A)(e.jointName)&&(!(0,_.A)(e.translation)||p.A.fromArray(e.translation).equals(p.A.ZERO))&&(!(0,_.A)(e.scale)||p.A.fromArray(e.scale).equals(new p.A(1,1,1)))&&(!(0,_.A)(e.rotation)||f.A.fromArray(e.rotation).equals(new f.A(0,0,0,1)))&&(!(0,_.A)(e.matrix)||y.A.fromColumnMajorArray(e.matrix).equals(y.A.IDENTITY))&&!(0,_.A)(e.extensions)&&!(0,_.A)(e.extras)}function D(e,t){s.A.scene(e,function(e){const n=e.nodes;if((0,_.A)(n))for(let e=n.length;e>=0;--e)if(n[e]===t)return void n.splice(e,1)}),s.A.node(e,function(n,i){if((0,_.A)(n.children)){const o=n.children.indexOf(t);o>-1&&(n.children.splice(o,1),P(n)&&D(e,i))}}),delete e.nodes[t]}const O=["u_tex","u_diffuse","u_emission","u_diffuse_tex"],R=["u_diffuse","u_diffuse_mat"];function M(e){e.pbrMetallicRoughness=(0,_.A)(e.pbrMetallicRoughness)?e.pbrMetallicRoughness:{},e.pbrMetallicRoughness.roughnessFactor=1,e.pbrMetallicRoughness.metallicFactor=0}function L(e){return(0,_.A)(e.index)}function N(e){return Array.isArray(e)&&4===e.length}function B(e){const t=new Array(4);t[3]=e[3];for(let n=0;n<3;n++){const i=e[n];t[n]=i<=.04045?.07739938080495357*e[n]:Math.pow(.9478672985781991*(i+.055),2.4)}return t}function F(e,t){(0,_.A)(t)&&(N(t)?e.pbrMetallicRoughness.baseColorFactor=B(t):L(t)&&(e.pbrMetallicRoughness.baseColorTexture=t))}function U(e,t){(0,_.A)(t)&&(N(t)?e.emissiveFactor=t.slice(0,3):L(t)&&(e.emissiveTexture=t))}const k=function(e,t){const n=(t=t??{}).targetVersion;let o=e.version;e.asset=e.asset??{version:"1.0"},e.asset.version=e.asset.version??"1.0",o=(o??e.asset.version).toString(),Object.prototype.hasOwnProperty.call(b,o)||((0,_.A)(o)&&(o=o.substring(0,3)),Object.prototype.hasOwnProperty.call(b,o)||(o="1.0"));let r=b[o];for(;(0,_.A)(r)&&o!==n;)r(e,t),o=e.asset.version,r=b[o];return t.keepLegacyExtensions||(function(e,t){const n=(t=t??{}).baseColorTextureNames??O,i=t.baseColorFactorNames??R;s.A.material(e,function(e){s.A.materialValue(e,function(t,o){-1!==n.indexOf(o)&&L(t)?(M(e),e.pbrMetallicRoughness.baseColorTexture=t):-1!==i.indexOf(o)&&N(t)&&(M(e),e.pbrMetallicRoughness.baseColorFactor=B(t))})}),(0,A.A)(e,"KHR_techniques_webgl"),(0,A.A)(e,"KHR_blend")}(e,t),function(e){s.A.material(e,function(t){const n=(t.extensions??{}).KHR_materials_common;if(!(0,_.A)(n))return;const o=n.values??{},r=o.ambient,s=o.diffuse,a=o.emission,c=o.transparency,l=n.doubleSided,u=n.transparent;M(t),"CONSTANT"===n.technique?((0,i.A)(e,"KHR_materials_unlit"),t.extensions=(0,_.A)(t.extensions)?t.extensions:{},t.extensions.KHR_materials_unlit={},F(t,a),F(t,r)):(F(t,s),U(t,r),U(t,a)),(0,_.A)(l)&&(t.doubleSided=l),(0,_.A)(c)&&((0,_.A)(t.pbrMetallicRoughness.baseColorFactor)?t.pbrMetallicRoughness.baseColorFactor[3]*=c:t.pbrMetallicRoughness.baseColorFactor=[1,1,1,c]),(0,_.A)(u)&&(t.alphaMode=u?"BLEND":"OPAQUE")}),(0,A.A)(e,"KHR_materials_common")}(e)),e}},493435:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(491446);const o=function(e,t){return(0,i.A)(e.extensionsUsed)&&e.extensionsUsed.indexOf(t)>=0}},705919:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(369031),o=n(915325),r=n(491446),s=n(569445),a=n(48660),c=n(371898);function l(e){const t=(e=e??o.A.EMPTY_OBJECT).resourceCache,n=e.gltf,r=e.primitive,s=e.spz,c=e.gltfResource,l=e.baseResource,u=e.cacheKey;i.A.typeOf.func("options.resourceCache",t),i.A.typeOf.object("options.gltf",n),i.A.typeOf.object("options.primitive",r),i.A.typeOf.object("options.spz",s),i.A.typeOf.object("options.gltfResource",c),i.A.typeOf.object("options.baseResource",l),this._resourceCache=t,this._gltfResource=c,this._baseResource=l,this._gltf=n,this._primitive=r,this._spz=s,this._cacheKey=u,this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodePromise=void 0,this._decodedData=void 0,this._state=a.A.UNLOADED,this._promise=void 0,this._spzError=void 0}function u(e,t){throw e.unload(),e._state=a.A.FAILED,e.getError("Failed to load SPZ",t)}(0,r.A)(Object.create)&&(l.prototype=Object.create(s.A.prototype),l.prototype.constructor=l),Object.defineProperties(l.prototype,{cacheKey:{get:function(){return this._cacheKey}},decodedData:{get:function(){return this._decodedData}}}),l.prototype.load=async function(){return(0,r.A)(this._promise)||(this._state=a.A.LOADING,this._promise=async function(e){const t=e._resourceCache;try{const n=t.getBufferViewLoader({gltf:e._gltf,bufferViewId:0,gltfResource:e._gltfResource,baseResource:e._baseResource});if(e._bufferViewLoader=n,await n.load(),e.isDestroyed())return;return e._bufferViewTypedArray=n.typedArray,e._state=a.A.PROCESSING,e}catch(t){if(e.isDestroyed())return;u(e,t)}}(this)),this._promise},l.prototype.process=function(e){if(i.A.typeOf.object("frameState",e),this._state===a.A.READY)return!0;if(this._state!==a.A.PROCESSING)return!1;if((0,r.A)(this._spzError)&&u(this,this._spzError),!(0,r.A)(this._bufferViewTypedArray))return!1;if((0,r.A)(this._decodePromise))return!1;const t=(0,c.u)(this._bufferViewTypedArray,{unpackOptions:{coordinateSystem:"UNSPECIFIED"}});if(!(0,r.A)(t))return!1;this._decodePromise=async function(e,t){try{const n=await t;if(e.isDestroyed())return;return e.unload(),e._decodedData={gcloud:n},e._state=a.A.READY,e._baseResource}catch(t){if(e.isDestroyed())return;e._spzError=t}}(this,t)},l.prototype.unload=function(){(0,r.A)(this._bufferViewLoader)&&this._resourceCache.unload(this._bufferViewLoader),this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodedData=void 0,this._gltf=void 0,this._primitive=void 0};const d=l},582998:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var i=n(369031),o=n(915325),r=n(491446),s=n(605971),a=n(613161),c=n(4471),l=n(872182),u=n(569445),d=n(48660);function h(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,extension:n,extensionLegacy:a,gltfResource:c,baseResource:l,supportedImageFormats:u,frameState:h,cacheKey:A,asynchronous:p=!0}=e;if(i.A.typeOf.object("options.gltf",t),i.A.typeOf.object("options.gltfResource",c),i.A.typeOf.object("options.baseResource",l),i.A.typeOf.object("options.supportedImageFormats",u),i.A.typeOf.object("options.frameState",h),!(0,r.A)(e.extension)&&!(0,r.A)(e.extensionLegacy))throw new s.A("One of options.extension or options.extensionLegacy must be specified");this._gltfResource=c,this._baseResource=l,this._gltf=t,this._extension=n,this._extensionLegacy=a,this._supportedImageFormats=u,this._frameState=h,this._cacheKey=A,this._asynchronous=p,this._bufferViewLoaders=[],this._bufferViewIds=[],this._textureLoaders=[],this._textureIds=[],this._schemaLoader=void 0,this._structuralMetadata=void 0,this._state=d.A.UNLOADED,this._promise=void 0}function A(e,t){for(const n in e)if(e.hasOwnProperty(n)){const i=e[n],o=i.values,s=i.arrayOffsets,a=i.stringOffsets;(0,r.A)(o)&&(t[o]=!0),(0,r.A)(s)&&(t[s]=!0),(0,r.A)(a)&&(t[a]=!0)}}function p(e,t){for(const n in e)if(e.hasOwnProperty(n)){const i=e[n],o=i.bufferView,s=i.arrayOffsetBufferView,a=i.stringOffsetBufferView;(0,r.A)(o)&&(t[o]=!0),(0,r.A)(s)&&(t[s]=!0),(0,r.A)(a)&&(t[a]=!0)}}function f(e,t){for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];t[i.index]=i}}function m(e,t){for(const n in e)if(e.hasOwnProperty(n)){const i=e[n].texture;t[i.index]=i}}function g(e){const t=e._bufferViewLoaders,n=t.length;for(let e=0;e<n;++e)l.A.unload(t[e]);e._bufferViewLoaders.length=0,e._bufferViewIds.length=0}(0,r.A)(Object.create)&&(h.prototype=Object.create(u.A.prototype),h.prototype.constructor=h),Object.defineProperties(h.prototype,{cacheKey:{get:function(){return this._cacheKey}},structuralMetadata:{get:function(){return this._structuralMetadata}}}),h.prototype.load=function(){return(0,r.A)(this._promise)||(this._state=d.A.LOADING,this._promise=async function(e){try{const t=async function(e){let t;t=(0,r.A)(e._extension)?function(e){const t=e.propertyTables,n={};if((0,r.A)(t))for(let e=0;e<t.length;e++)A(t[e].properties,n);return n}(e._extension):function(e){const t=e.featureTables,n={};if((0,r.A)(t))for(const e in t)if(t.hasOwnProperty(e)){const i=t[e].properties;(0,r.A)(i)&&p(i,n)}return n}(e._extensionLegacy);const n=[];for(const i in t)if(t.hasOwnProperty(i)){const t=l.A.getBufferViewLoader({gltf:e._gltf,bufferViewId:parseInt(i),gltfResource:e._gltfResource,baseResource:e._baseResource});e._bufferViewLoaders.push(t),e._bufferViewIds.push(i),n.push(t.load())}return Promise.all(n)}(e),n=function(e){let t;t=(0,r.A)(e._extension)?function(e){const t={},n=e.propertyTextures;if((0,r.A)(n))for(let e=0;e<n.length;e++){const i=n[e].properties;(0,r.A)(i)&&f(i,t)}return t}(e._extension):function(e){const t={},n=e.featureTextures;if((0,r.A)(n))for(const e in n)if(n.hasOwnProperty(e)){const i=n[e].properties;(0,r.A)(i)&&m(i,t)}return t}(e._extensionLegacy);const n=e._gltf,i=e._gltfResource,o=e._baseResource,s=e._supportedImageFormats,a=e._frameState,c=e._asynchronous,u=[];for(const r in t)if(t.hasOwnProperty(r)){const d=l.A.getTextureLoader({gltf:n,textureInfo:t[r],gltfResource:i,baseResource:o,supportedImageFormats:s,frameState:a,asynchronous:c});e._textureLoaders.push(d),e._textureIds.push(r),u.push(d.load())}return Promise.all(u)}(e),i=async function(e){const t=e._extension??e._extensionLegacy;let n;if((0,r.A)(t.schemaUri)){const i=e._baseResource.getDerivedResource({url:t.schemaUri});n=l.A.getSchemaLoader({resource:i})}else n=l.A.getSchemaLoader({schema:t.schema});if(e._schemaLoader=n,await n.load(),!n.isDestroyed())return n.schema}(e);if(await Promise.all([t,n,i]),e.isDestroyed())return;return e._gltf=void 0,e._state=d.A.LOADED,e}catch(t){if(e.isDestroyed())return;e.unload(),e._state=d.A.FAILED;const n="Failed to load structural metadata";throw e.getError(n,t)}}(this)),this._promise},h.prototype.process=function(e){if(i.A.typeOf.object("frameState",e),this._state===d.A.READY)return!0;if(this._state!==d.A.LOADED)return!1;const t=this._textureLoaders,n=t.length;let o=!0;for(let i=0;i<n;++i){const n=t[i].process(e);o=o&&n}if(!o)return!1;const s=this._schemaLoader.schema,l={};for(let e=0;e<this._bufferViewIds.length;++e){const t=this._bufferViewIds[e],n=this._bufferViewLoaders[e];if(!n.isDestroyed()){const e=new Uint8Array(n.typedArray);l[t]=e}}const u={};for(let e=0;e<this._textureIds.length;++e){const n=this._textureIds[e],i=t[e];i.isDestroyed()||(u[n]=i.texture)}return(0,r.A)(this._extension)?this._structuralMetadata=(0,a.A)({extension:this._extension,schema:s,bufferViews:l,textures:u}):this._structuralMetadata=(0,c.A)({extension:this._extensionLegacy,schema:s,bufferViews:l,textures:u}),g(this),this._state=d.A.READY,!0},h.prototype.unload=function(){g(this),function(e){const t=e._textureLoaders,n=t.length;for(let e=0;e<n;++e)l.A.unload(t[e]);e._textureLoaders.length=0,e._textureIds.length=0}(this),(0,r.A)(this._schemaLoader)&&l.A.unload(this._schemaLoader),this._schemaLoader=void 0,this._structuralMetadata=void 0};const _=h},952575:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var i=n(369031),o=n(367817),r=n(915325),s=n(491446),a=n(276904),c=n(616e3),l=n(78078),u=n(557448),d=n(782556),h=n(666203),A=n(569445),p=n(48660),f=n(271868);function m(e){const t=(e=e??r.A.EMPTY_OBJECT).resourceCache,n=e.gltf,o=e.textureInfo,s=e.gltfResource,a=e.baseResource,c=e.supportedImageFormats,l=e.cacheKey,u=e.asynchronous??!0;i.A.typeOf.func("options.resourceCache",t),i.A.typeOf.object("options.gltf",n),i.A.typeOf.object("options.textureInfo",o),i.A.typeOf.object("options.gltfResource",s),i.A.typeOf.object("options.baseResource",a),i.A.typeOf.object("options.supportedImageFormats",c);const h=o.index,A=d.A.getImageIdFromTexture({gltf:n,textureId:h,supportedImageFormats:c});this._resourceCache=t,this._gltf=n,this._textureInfo=o,this._imageId=A,this._gltfResource=s,this._baseResource=a,this._cacheKey=l,this._asynchronous=u,this._imageLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._texture=void 0,this._state=p.A.UNLOADED,this._promise=void 0}(0,s.A)(Object.create)&&(m.prototype=Object.create(A.A.prototype),m.prototype.constructor=m),Object.defineProperties(m.prototype,{cacheKey:{get:function(){return this._cacheKey}},texture:{get:function(){return this._texture}}});const g=new _;function _(){this.gltf=void 0,this.textureInfo=void 0,this.textureId=void 0,this.image=void 0,this.context=void 0,this.texture=void 0}function y(e,t,n,i,r,h){const A=i.internalFormat;let p=!1;a.A.isCompressedFormat(A)&&!(0,s.A)(r)&&(p=!0);const m=d.A.createSampler({gltf:e,textureInfo:t,compressedTextureNoMipmap:p}),g=m.minificationFilter,_=m.wrapS,y=m.wrapT,v=g===l.A.NEAREST_MIPMAP_NEAREST||g===l.A.NEAREST_MIPMAP_LINEAR||g===l.A.LINEAR_MIPMAP_NEAREST||g===l.A.LINEAR_MIPMAP_LINEAR,T=!(0,s.A)(A)&&v,b=T||_===u.A.REPEAT||_===u.A.MIRRORED_REPEAT||y===u.A.REPEAT||y===u.A.MIRRORED_REPEAT,w=!o.A.isPowerOfTwo(i.width)||!o.A.isPowerOfTwo(i.height),x=b&&w;let C;return(0,s.A)(A)?(!h.webgl2&&a.A.isCompressedFormat(A)&&w&&b&&console.warn("Compressed texture uses REPEAT or MIRRORED_REPEAT texture wrap mode and dimensions are not powers of two. The texture may be rendered incorrectly."),C=c.A.create({id:n,context:h,source:{arrayBufferView:i.bufferView,mipLevels:r},width:i.width,height:i.height,pixelFormat:i.internalFormat,sampler:m})):(x&&(i=(0,f.A)(i)),C=c.A.create({id:n,context:h,source:i,sampler:m,flipY:!1,skipColorSpaceConversion:!0})),T&&C.generateMipmap(),C}m.prototype.load=async function(){return(0,s.A)(this._promise)||(this._state=p.A.LOADING,this._promise=async function(e){const t=e._resourceCache;try{const n=t.getImageLoader({gltf:e._gltf,imageId:e._imageId,gltfResource:e._gltfResource,baseResource:e._baseResource});if(e._imageLoader=n,await n.load(),e.isDestroyed())return;return e._image=n.image,e._mipLevels=n.mipLevels,e._state=p.A.LOADED,e}catch(t){if(e.isDestroyed())return;e.unload(),e._state=p.A.FAILED;const n="Failed to load texture";throw e.getError(n,t)}}(this)),this._promise},_.prototype.set=function(e,t,n,i,o,r){this.gltf=e,this.textureInfo=t,this.textureId=n,this.image=i,this.mipLevels=o,this.context=r},_.prototype.execute=function(){this.texture=y(this.gltf,this.textureInfo,this.textureId,this.image,this.mipLevels,this.context)},m.prototype.process=function(e){if(i.A.typeOf.object("frameState",e),this._state===p.A.READY)return!0;if(this._state!==p.A.LOADED&&this._state!==p.A.PROCESSING)return!1;if((0,s.A)(this._texture))return!1;if(!(0,s.A)(this._image))return!1;let t;if(this._state=p.A.PROCESSING,this._asynchronous){const n=g;if(n.set(this._gltf,this._textureInfo,this._cacheKey,this._image,this._mipLevels,e.context),!e.jobScheduler.execute(n,h.A.TEXTURE))return;t=n.texture}else t=y(this._gltf,this._textureInfo,this._cacheKey,this._image,this._mipLevels,e.context);return this.unload(),this._texture=t,this._state=p.A.READY,this._resourceCache.statistics.addTextureLoader(this),!0},m.prototype.unload=function(){(0,s.A)(this._texture)&&this._texture.destroy(),(0,s.A)(this._imageLoader)&&!this._imageLoader.isDestroyed()&&this._resourceCache.unload(this._imageLoader),this._imageLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._texture=void 0,this._gltf=void 0};const v=m},946240:(e,t,n)=>{"use strict";n.d(t,{A:()=>T});var i=n(369031),o=n(915325),r=n(491446),s=n(605971),a=n(641613),c=n(442790),l=n(730839),u=n(666203),d=n(995537),h=n(569445),A=n(48660),p=n(367817);function f(e){const t=(e=e??o.A.EMPTY_OBJECT).resourceCache,n=e.gltf,a=e.gltfResource,c=e.baseResource,l=e.bufferViewId,u=e.primitive,d=e.draco,h=e.attributeSemantic,p=e.accessorId,f=e.cacheKey,g=e.spz,_=e.asynchronous??!0,y=e.loadBuffer??!1,v=e.loadTypedArray??!1;if(i.A.typeOf.func("options.resourceCache",t),i.A.typeOf.object("options.gltf",n),i.A.typeOf.object("options.gltfResource",a),i.A.typeOf.object("options.baseResource",c),!y&&!v)throw new s.A("At least one of loadBuffer and loadTypedArray must be true.");const T=(0,r.A)(l),b=(0,r.A)(u),w=m(d,h),x=(0,r.A)(h),C=(0,r.A)(p);if(T===(w!==(0,r.A)(g)))throw new s.A("One of options.bufferViewId, options.draco, or options.spz must be defined.");if(w&&!x)throw new s.A("When options.draco is defined options.attributeSemantic must also be defined.");if(w&&!C)throw new s.A("When options.draco is defined options.accessorId must also be defined.");if(w&&!b)throw new s.A("When options.draco is defined options.primitive must also be defined.");w&&(i.A.typeOf.object("options.primitive",u),i.A.typeOf.object("options.draco",d),i.A.typeOf.string("options.attributeSemantic",h),i.A.typeOf.number("options.accessorId",p)),this._resourceCache=t,this._gltfResource=a,this._baseResource=c,this._gltf=n,this._bufferViewId=l,this._primitive=u,this._draco=d,this._spz=g,this._attributeSemantic=h,this._accessorId=p,this._cacheKey=f,this._asynchronous=_,this._loadBuffer=y,this._loadTypedArray=v,this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._quantization=void 0,this._typedArray=void 0,this._buffer=void 0,this._state=A.A.UNLOADED,this._promise=void 0}function m(e,t){return(0,r.A)(e)&&(0,r.A)(e.attributes)&&(0,r.A)(e.attributes[t])}function g(e,t){throw e.unload(),e._state=A.A.FAILED,e.getError("Failed to load vertex buffer",t)}function _(){this.typedArray=void 0,this.context=void 0,this.buffer=void 0}function y(e,t){const n=a.A.createVertexBuffer({typedArray:e,context:t,usage:c.A.STATIC_DRAW});return n.vertexArrayDestroyable=!1,n}(0,r.A)(Object.create)&&(f.prototype=Object.create(h.A.prototype),f.prototype.constructor=f),Object.defineProperties(f.prototype,{cacheKey:{get:function(){return this._cacheKey}},buffer:{get:function(){return this._buffer}},typedArray:{get:function(){return this._typedArray}},quantization:{get:function(){return this._quantization}}}),f.prototype.load=async function(){return(0,r.A)(this._promise)?this._promise:(0,r.A)(this._spz)?(this._promise=async function(e){e._state=A.A.LOADING;const t=e._resourceCache;try{const n=t.getSpzLoader({gltf:e._gltf,primitive:e._primitive,spz:e._spz,gltfResource:e._gltfResource,baseResource:e._baseResource});if(e._spzLoader=n,await n.load(),e.isDestroyed())return;return e._state=A.A.LOADED,e}catch{if(e.isDestroyed())return}}(this),this._promise):m(this._draco,this._attributeSemantic)?(this._promise=async function(e){e._state=A.A.LOADING;const t=e._resourceCache;try{const n=t.getDracoLoader({gltf:e._gltf,primitive:e._primitive,draco:e._draco,gltfResource:e._gltfResource,baseResource:e._baseResource});if(e._dracoLoader=n,await n.load(),e.isDestroyed())return;return e._state=A.A.LOADED,e}catch{if(e.isDestroyed())return;g(e)}}(this),this._promise):(this._promise=async function(e){e._state=A.A.LOADING;const t=e._resourceCache;try{const n=t.getBufferViewLoader({gltf:e._gltf,bufferViewId:e._bufferViewId,gltfResource:e._gltfResource,baseResource:e._baseResource});if(e._bufferViewLoader=n,await n.load(),e.isDestroyed())return;return e._typedArray=n.typedArray,e._state=A.A.PROCESSING,e}catch(t){if(e.isDestroyed())return;g(e,t)}}(this),this._promise)},_.prototype.set=function(e,t){this.typedArray=e,this.context=t},_.prototype.execute=function(){this.buffer=y(this.typedArray,this.context)};const v=new _;f.prototype.process=function(e){if(i.A.typeOf.object("frameState",e),this._state===A.A.READY)return!0;if(this._state!==A.A.LOADED&&this._state!==A.A.PROCESSING)return!1;if((0,r.A)(this._dracoLoader)){try{if(!this._dracoLoader.process(e))return!1}catch(e){g(this,e)}!function(e){e._state=A.A.PROCESSING;const t=e._dracoLoader.decodedData.vertexAttributes[e._attributeSemantic],n=e._accessorId,i=e._gltf.accessors[n].type,o=t.array,s=t.data.quantization;(0,r.A)(s)&&(e._quantization=function(e,t,n,i){const o=(1<<e.quantizationBits)-1,r=1/o,s=new d.A.Quantization;if(s.componentDatatype=t,s.octEncoded=e.octEncoded,s.octEncodedZXY=!0,s.type=i,s.octEncoded)s.type=l.A.VEC2,s.normalizationRange=o;else{const t=l.A.getMathType(i);if(t===Number){const t=e.range;s.quantizedVolumeOffset=e.minValues[0],s.quantizedVolumeDimensions=t,s.normalizationRange=o,s.quantizedVolumeStepSize=t*r}else{s.quantizedVolumeOffset=t.unpack(e.minValues),s.normalizationRange=t.unpack(new Array(n).fill(o));const i=new Array(n).fill(e.range);s.quantizedVolumeDimensions=t.unpack(i);const a=i.map(function(e){return e*r});s.quantizedVolumeStepSize=t.unpack(a)}}return s}(s,t.data.componentDatatype,t.data.componentsPerAttribute,i)),e._typedArray=new Uint8Array(o.buffer,o.byteOffset,o.byteLength)}(this)}if((0,r.A)(this._spzLoader)){try{if(!this._spzLoader.process(e))return!1}catch(e){g(this,e)}!function(e){e._state=A.A.PROCESSING;const t=e._spzLoader.decodedData.gcloud;if("POSITION"===e._attributeSemantic)e._typedArray=t.positions;else if("KHR_gaussian_splatting:SCALE"===e._attributeSemantic||"_SCALE"===e._attributeSemantic)e._typedArray=t.scales;else if("KHR_gaussian_splatting:ROTATION"===e._attributeSemantic||"_ROTATION"===e._attributeSemantic)e._typedArray=t.rotations;else if("COLOR_0"===e._attributeSemantic){const n=t.colors,i=t.alphas;e._typedArray=new Uint8Array(n.length/3*4);for(let t=0;t<n.length/3;t++)e._typedArray[4*t]=p.A.clamp(255*n[3*t],0,255),e._typedArray[4*t+1]=p.A.clamp(255*n[3*t+1],0,255),e._typedArray[4*t+2]=p.A.clamp(255*n[3*t+2],0,255),e._typedArray[4*t+3]=p.A.clamp(255*i[t],0,255)}else if(e._attributeSemantic.includes("SH_DEGREE_")){const{l:n,n:i}=function(e){const t=function(e){return(e.startsWith("KHR_gaussian_splatting:")?"KHR_gaussian_splatting:":"_")+"SH_DEGREE_"}(e),n=t.length,i=e.indexOf("_COEF_",n);return{l:parseInt(e.slice(n,i),10),n:parseInt(e.slice(i+6),10)}}(e._attributeSemantic);let o=0;const r=[0,9,24];switch(t.shDegree){case 1:o=9;break;case 2:o=24;break;case 3:o=45}const s=t.numPoints,a=t.sh;e._typedArray=new Float32Array(3*s);for(let t=0;t<s;t++){const s=t*o+r[n-1]+3*i;e._typedArray[3*t]=a[s],e._typedArray[3*t+1]=a[s+1],e._typedArray[3*t+2]=a[s+2]}}}(this)}let t;const n=this._typedArray;if(this._loadBuffer&&this._asynchronous){const i=v;if(i.set(n,e.context),!e.jobScheduler.execute(i,u.A.BUFFER))return!1;t=i.buffer}else this._loadBuffer&&(t=y(n,e.context));return this.unload(),this._buffer=t,this._typedArray=this._loadTypedArray?n:void 0,this._state=A.A.READY,this._resourceCache.statistics.addGeometryLoader(this),!0},f.prototype.unload=function(){(0,r.A)(this._buffer)&&this._buffer.destroy();const e=this._resourceCache;(0,r.A)(this._bufferViewLoader)&&!this._bufferViewLoader.isDestroyed()&&e.unload(this._bufferViewLoader),(0,r.A)(this._dracoLoader)&&e.unload(this._dracoLoader),(0,r.A)(this._spzLoader)&&e.unload(this._spzLoader),this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._spzLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._gltf=void 0,this._primitive=void 0};const T=f},38300:(e,t,n)=>{"use strict";n.d(t,{A:()=>g});var i=n(303578),o=n(369031),r=n(607502),s=n(491446),a=n(955943),c=n(182348),l=n(697422),u=n(744603),d=n(123245),h=n(705302),A=n(41076),p=n(553909);function f(e){this.channel=e.channel,this.ellipsoid=e.ellipsoid,this.tilingScheme=void 0,this.version=void 0}function m(e){e=e??{},this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=1.9,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tileDiscardPolicy=e.tileDiscardPolicy,this._channel=e.channel,this._requestType="ImageryMaps",this._credit=new r.A(`<a href="http://www.google.com/enterprise/mapsearth/products/earthenterprise.html"><img src="${m.logoUrl}" title="Google Imagery"/></a>`),this._tilingScheme=void 0,this._version=void 0,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=e.maximumLevel,this._errorEvent=new a.A}f.prototype.build=function(e){e._channel=this.channel,e._version=this.version,e._tilingScheme=this.tilingScheme},Object.defineProperties(m.prototype,{url:{get:function(){return this._url}},path:{get:function(){return this._path}},proxy:{get:function(){return this._resource.proxy}},channel:{get:function(){return this._channel}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},version:{get:function(){return this._version}},requestType:{get:function(){return this._requestType}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),m.fromUrl=async function(e,t,n){o.A.defined("url",e),o.A.defined("channel",t);const i=(n=n??{}).path??"/default_map",r=u.A.createIfNeeded(e).getDerivedResource({url:"/"===i[0]?i.substring(1):i});r.appendForwardSlash();const a=r.getDerivedResource({url:"query",queryParameters:{request:"Json",vars:"geeServerDefs",is2d:"t"}}),p=new f(n);p.channel=t,await async function(e,t,n){try{!function(e,t){let n,i;try{n=JSON.parse(e)}catch(t){n=JSON.parse(e.replace(/([\[\{,])[\n\r ]*([A-Za-z0-9]+)[\n\r ]*:/g,'$1"$2":'))}for(let e=0;e<n.layers.length;e++)if(n.layers[e].id===t.channel){i=n.layers[e];break}if(!(0,s.A)(i)){const e=`Could not find layer with channel (id) of ${t.channel}.`;throw new d.A(e)}if(!(0,s.A)(i.version)){const e=`Could not find a version in channel (id) ${t.channel}.`;throw new d.A(e)}if(t.version=i.version,(0,s.A)(n.projection)&&"flat"===n.projection)t.tilingScheme=new c.A({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new l.A(-Math.PI,-Math.PI,Math.PI,Math.PI),ellipsoid:t.ellipsoid});else{if((0,s.A)(n.projection)&&"mercator"!==n.projection){const e=`Unsupported projection ${n.projection}.`;throw new d.A(e)}t.tilingScheme=new A.A({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:t.ellipsoid})}}(await e.fetchText(),t)}catch(t){!function(e,t,n){let i=`An error occurred while accessing ${t.url}.`;throw(0,s.A)(e)&&(0,s.A)(e.message)&&(i+=`: ${e.message}`),h.A.reportError(void 0,n,(0,s.A)(n)?n._errorEvent:void 0,i),new d.A(i)}(t,e,n)}}(a,p);const g=new m(n);return p.build(g),g._resource=r,g._url=e,g._path=i,g},m.prototype.getTileCredits=function(e,t,n){},m.prototype.requestImage=function(e,t,n,i){const o=this._resource.getDerivedResource({url:"query",request:i,queryParameters:{request:this._requestType,channel:this._channel,version:this._version,x:e,y:t,z:n+1}});return p.A.loadImage(this,o)},m.prototype.pickFeatures=function(e,t,n,i,o){},m._logoUrl=void 0,Object.defineProperties(m,{logoUrl:{get:function(){return(0,s.A)(m._logoUrl)||(m._logoUrl=(0,i.A)("Assets/Images/google_earth_credit.png")),m._logoUrl},set:function(e){o.A.defined("value",e),m._logoUrl=e}}});const g=m},834298:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(369031),o=n(915325),r=n(491446),s=n(965976);function a(e){const t=(e=e??o.A.EMPTY_OBJECT).id,n=e.group,s=e.class;i.A.typeOf.object("options.group",n),i.A.typeOf.object("options.class",s);const a=(0,r.A)(n.properties)?n.properties:{};this._class=s,this._properties=a,this._id=t,this._extras=n.extras,this._extensions=n.extensions}Object.defineProperties(a.prototype,{class:{get:function(){return this._class}},id:{get:function(){return this._id}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),a.prototype.hasProperty=function(e){return s.A.hasProperty(e,this._properties,this._class)},a.prototype.hasPropertyBySemantic=function(e){return s.A.hasPropertyBySemantic(e,this._properties,this._class)},a.prototype.getPropertyIds=function(e){return s.A.getPropertyIds(this._properties,this._class,e)},a.prototype.getProperty=function(e){return s.A.getProperty(e,this._properties,this._class)},a.prototype.setProperty=function(e,t){return s.A.setProperty(e,t,this._properties,this._class)},a.prototype.getPropertyBySemantic=function(e){return s.A.getPropertyBySemantic(e,this._properties,this._class)},a.prototype.setPropertyBySemantic=function(e,t){return s.A.setPropertyBySemantic(e,t,this._properties,this._class)};const c=a},680278:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(369031),o=n(786101),r=n(604752),s=n(123245);const a={};a._deprecationWarning=o.A;const c=Uint32Array.BYTES_PER_ELEMENT;a.parse=function(e,t){i.A.defined("arrayBuffer",e);const n=t??0;t=n;const o=new Uint8Array(e),l=new DataView(e);t+=c;const u=l.getUint32(t,!0);if(1!==u)throw new s.A(`Only Instanced 3D Model version 1 is supported. Version ${u} is not.`);t+=c;const d=l.getUint32(t,!0);t+=c;const h=l.getUint32(t,!0);if(0===h)throw new s.A("featureTableJsonByteLength is zero, the feature table must be defined.");t+=c;const A=l.getUint32(t,!0);t+=c;const p=l.getUint32(t,!0);t+=c;const f=l.getUint32(t,!0);t+=c;const m=l.getUint32(t,!0);if(1!==m&&0!==m)throw new s.A(`Only glTF format 0 (uri) or 1 (embedded) are supported. Format ${m} is not.`);t+=c;const g=(0,r.A)(o,t,h);t+=h;const _=new Uint8Array(e,t,A);let y,v;t+=A,p>0&&(y=(0,r.A)(o,t,p),t+=p,f>0&&(v=new Uint8Array(e,t,f),v=new Uint8Array(v),t+=f));const T=n+d-t;if(0===T)throw new s.A("glTF byte length must be greater than 0.");let b;return t%4==0?b=new Uint8Array(e,t,T):(a._deprecationWarning("i3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),b=new Uint8Array(o.subarray(t,t+T))),{gltfFormat:m,featureTableJson:g,featureTableBinary:_,batchTableJson:y,batchTableBinary:v,gltf:b}};const l=a},208198:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(434067),o=n(369031),r=n(491446),s=n(915325),a=n(677354),c=n(605971),l=n(126797);function u(e){e=e??s.A.EMPTY_OBJECT;const t=(0,r.A)(e.imageBasedLightingFactor)?i.A.clone(e.imageBasedLightingFactor):new i.A(1,1);o.A.typeOf.object("options.imageBasedLightingFactor",t),o.A.typeOf.number.greaterThanOrEquals("options.imageBasedLightingFactor.x",t.x,0),o.A.typeOf.number.lessThanOrEquals("options.imageBasedLightingFactor.x",t.x,1),o.A.typeOf.number.greaterThanOrEquals("options.imageBasedLightingFactor.y",t.y,0),o.A.typeOf.number.lessThanOrEquals("options.imageBasedLightingFactor.y",t.y,1),this._imageBasedLightingFactor=t;const n=e.sphericalHarmonicCoefficients;if((0,r.A)(n)&&(!Array.isArray(n)||9!==n.length))throw new c.A("options.sphericalHarmonicCoefficients must be an array of 9 Cartesian3 values.");this._sphericalHarmonicCoefficients=n,this._specularEnvironmentMaps=e.specularEnvironmentMaps,this._specularEnvironmentCubeMap=void 0,this._specularEnvironmentCubeMapDirty=!0,this._specularEnvironmentMapLoaded=!1,this._previousSpecularEnvironmentMapLoaded=!1,this._useDefaultSpecularMaps=!1,this._useDefaultSphericalHarmonics=!1,this._shouldRegenerateShaders=!1,this._previousFrameNumber=void 0,this._previousFrameContext=void 0,this._previousImageBasedLightingFactor=i.A.clone(t),this._previousSphericalHarmonicCoefficients=n,this._removeErrorListener=void 0}Object.defineProperties(u.prototype,{imageBasedLightingFactor:{get:function(){return this._imageBasedLightingFactor},set:function(e){o.A.typeOf.object("imageBasedLightingFactor",e),o.A.typeOf.number.greaterThanOrEquals("imageBasedLightingFactor.x",e.x,0),o.A.typeOf.number.lessThanOrEquals("imageBasedLightingFactor.x",e.x,1),o.A.typeOf.number.greaterThanOrEquals("imageBasedLightingFactor.y",e.y,0),o.A.typeOf.number.lessThanOrEquals("imageBasedLightingFactor.y",e.y,1),this._previousImageBasedLightingFactor=i.A.clone(this._imageBasedLightingFactor,this._previousImageBasedLightingFactor),this._imageBasedLightingFactor=i.A.clone(e,this._imageBasedLightingFactor)}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients},set:function(e){if((0,r.A)(e)&&(!Array.isArray(e)||9!==e.length))throw new c.A("sphericalHarmonicCoefficients must be an array of 9 Cartesian3 values.");this._previousSphericalHarmonicCoefficients=this._sphericalHarmonicCoefficients,this._sphericalHarmonicCoefficients=e}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps},set:function(e){e!==this._specularEnvironmentMaps&&(this._specularEnvironmentCubeMapDirty=this._specularEnvironmentCubeMapDirty||e!==this._specularEnvironmentMaps,this._specularEnvironmentMapLoaded=!1),this._specularEnvironmentMaps=e}},enabled:{get:function(){return this._imageBasedLightingFactor.x>0||this._imageBasedLightingFactor.y>0}},shouldRegenerateShaders:{get:function(){return this._shouldRegenerateShaders}},specularEnvironmentCubeMap:{get:function(){return this._specularEnvironmentCubeMap}},useDefaultSphericalHarmonics:{get:function(){return this._useDefaultSphericalHarmonics}},useDefaultSpecularMaps:{get:function(){return this._useDefaultSpecularMaps}},useSpecularEnvironmentMaps:{get:function(){return(0,r.A)(this._specularEnvironmentCubeMap)&&this._specularEnvironmentCubeMap.ready||this._useDefaultSpecularMaps}}}),u.prototype.update=function(e){if(e.frameNumber===this._previousFrameNumber&&e.context===this._previousFrameContext)return;this._previousFrameNumber=e.frameNumber;const t=this._previousFrameContext=e.context;e.brdfLutGenerator.update(e),this._shouldRegenerateShaders=!1;const n=this._imageBasedLightingFactor,o=this._previousImageBasedLightingFactor;i.A.equals(n,o)||(this._shouldRegenerateShaders=n.x>0&&0===o.x||0===n.x&&o.x>0,this._shouldRegenerateShaders=this._shouldRegenerateShaders||n.y>0&&0===o.y||0===n.y&&o.y>0,this._previousImageBasedLightingFactor=i.A.clone(this._imageBasedLightingFactor,this._previousImageBasedLightingFactor)),this._previousSphericalHarmonicCoefficients!==this._sphericalHarmonicCoefficients&&(this._shouldRegenerateShaders=this._shouldRegenerateShaders||(0,r.A)(this._previousSphericalHarmonicCoefficients)!==(0,r.A)(this._sphericalHarmonicCoefficients),this._previousSphericalHarmonicCoefficients=this._sphericalHarmonicCoefficients),this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._previousSpecularEnvironmentMapLoaded!==this._specularEnvironmentMapLoaded,this._previousSpecularEnvironmentMapLoaded=this._specularEnvironmentMapLoaded,this._specularEnvironmentCubeMapDirty&&(function(e,t){if(l.A.isSupported(t)){if(e._specularEnvironmentCubeMap=e._specularEnvironmentCubeMap&&e._specularEnvironmentCubeMap.destroy(),(0,r.A)(e._specularEnvironmentMaps)){const t=new l.A(e._specularEnvironmentMaps);e._specularEnvironmentCubeMap=t,e._removeErrorListener=t.errorEvent.addEventListener(e=>{console.error(`Error loading specularEnvironmentMaps: ${e}`)})}e._shouldRegenerateShaders=!0}}(this,t),this._specularEnvironmentCubeMapDirty=!1),(0,r.A)(this._specularEnvironmentCubeMap)&&(this._specularEnvironmentCubeMap.update(e),this._specularEnvironmentCubeMap.ready&&(this._specularEnvironmentMapLoaded=!0));const s=!(0,r.A)(this._specularEnvironmentCubeMap)&&(0,r.A)(e.specularEnvironmentMaps)&&!this._useDefaultSpecularMaps,a=!(0,r.A)(e.specularEnvironmentMaps)&&this._useDefaultSpecularMaps,c=!(0,r.A)(this._sphericalHarmonicCoefficients)&&(0,r.A)(e.sphericalHarmonicCoefficients)&&!this._useDefaultSphericalHarmonics,u=!(0,r.A)(e.sphericalHarmonicCoefficients)&&this._useDefaultSphericalHarmonics;this._shouldRegenerateShaders=this._shouldRegenerateShaders||s||a||c||u,this._useDefaultSpecularMaps=!(0,r.A)(this._specularEnvironmentCubeMap)&&(0,r.A)(e.specularEnvironmentMaps),this._useDefaultSphericalHarmonics=!(0,r.A)(this._sphericalHarmonicCoefficients)&&(0,r.A)(e.sphericalHarmonicCoefficients)},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){return this._specularEnvironmentCubeMap=this._specularEnvironmentCubeMap&&this._specularEnvironmentCubeMap.destroy(),this._removeErrorListener=this._removeErrorListener&&this._removeErrorListener(),(0,a.A)(this)};const d=u},17656:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(491446),o=n(677354),r=n(921243);function s(e,t,n,o,s){if(this.imageryLayer=e,this.x=t,this.y=n,this.level=o,this.request=void 0,0!==o){const i=t/2|0,r=n/2|0,s=o-1;this.parent=e.getImageryFromCache(i,r,s)}this.state=r.A.UNLOADED,this.imageUrl=void 0,this.image=void 0,this.texture=void 0,this.textureWebMercator=void 0,this.credits=void 0,this.referenceCount=0,!(0,i.A)(s)&&e.ready&&(s=e.imageryProvider.tilingScheme.tileXYToRectangle(t,n,o)),this.rectangle=s}s.createPlaceholder=function(e){const t=new s(e,0,0,0);return t.addReference(),t.state=r.A.PLACEHOLDER,t},s.prototype.addReference=function(){++this.referenceCount},s.prototype.releaseReference=function(){return--this.referenceCount,0===this.referenceCount?(this.imageryLayer.removeImageryFromCache(this),(0,i.A)(this.parent)&&this.parent.releaseReference(),(0,i.A)(this.image)&&(0,i.A)(this.image.destroy)&&this.image.destroy(),(0,i.A)(this.texture)&&this.texture.destroy(),(0,i.A)(this.textureWebMercator)&&this.texture!==this.textureWebMercator&&this.textureWebMercator.destroy(),(0,o.A)(this),0):this.referenceCount},s.prototype.processStateMachine=function(e,t,n){this.state!==r.A.UNLOADED||n||(this.state=r.A.TRANSITIONING,this.imageryLayer._requestImagery(this)),this.state===r.A.RECEIVED&&(this.state=r.A.TRANSITIONING,this.imageryLayer._createTexture(e.context,this));const i=this.state===r.A.READY&&t&&!this.texture;(this.state===r.A.TEXTURE_LOADED||i)&&(this.state=r.A.TRANSITIONING,this.imageryLayer._reprojectTexture(e,this,t))};const a=s},451227:(e,t,n)=>{"use strict";n.d(t,{A:()=>J});var i=n(434067),o=n(626809),r=n(369031),s=n(655028),a=n(915325),c=n(491446),l=n(677354),u=n(605971),d=n(955943),h=n(520098),A=n(653577),p=n(874915),f=n(367817),m=n(276904),g=n(697422),_=n(209202),y=n(83181),v=n(307898),T=n(98055),b=n(705302),w=n(414305),x=n(641613),C=n(442790),E=n(718289),S=n(430332),I=n(418906),P=n(654799),D=n(302836),O=n(342875),R=n(616e3),M=n(957233),L=n(78078),N=n(557448),B=n(508380),F=n(275058),U=n(208898),k=n(17656),V=n(921243),z=n(913419),H=n(976092);function G(e,t){this._imageryProvider=e,this._readyEvent=new d.A,this._errorEvent=new d.A,t=t??a.A.EMPTY_OBJECT,e=e??a.A.EMPTY_OBJECT,this.alpha=t.alpha??e._defaultAlpha??1,this.nightAlpha=t.nightAlpha??e._defaultNightAlpha??1,this.dayAlpha=t.dayAlpha??e._defaultDayAlpha??1,this.brightness=t.brightness??e._defaultBrightness??G.DEFAULT_BRIGHTNESS,this.contrast=t.contrast??e._defaultContrast??G.DEFAULT_CONTRAST,this.hue=t.hue??e._defaultHue??G.DEFAULT_HUE,this.saturation=t.saturation??e._defaultSaturation??G.DEFAULT_SATURATION,this.gamma=t.gamma??e._defaultGamma??G.DEFAULT_GAMMA,this.splitDirection=t.splitDirection??G.DEFAULT_SPLIT,this.minificationFilter=t.minificationFilter??e._defaultMinificationFilter??G.DEFAULT_MINIFICATION_FILTER,this.magnificationFilter=t.magnificationFilter??e._defaultMagnificationFilter??G.DEFAULT_MAGNIFICATION_FILTER,this.show=t.show??!0,this._minimumTerrainLevel=t.minimumTerrainLevel,this._maximumTerrainLevel=t.maximumTerrainLevel,this._rectangle=t.rectangle??g.A.MAX_VALUE,this._maximumAnisotropy=t.maximumAnisotropy,this._imageryCache={},this._skeletonPlaceholder=new H.A(k.A.createPlaceholder(this)),this._show=!0,this._layerIndex=-1,this._isBaseLayer=!1,this._requestImageError=void 0,this._reprojectComputeCommands=[],this.cutoutRectangle=t.cutoutRectangle,this.colorToAlpha=t.colorToAlpha,this.colorToAlphaThreshold=t.colorToAlphaThreshold??G.DEFAULT_APPLY_COLOR_TO_ALPHA_THRESHOLD}Object.defineProperties(G.prototype,{imageryProvider:{get:function(){return this._imageryProvider}},ready:{get:function(){return(0,c.A)(this._imageryProvider)}},errorEvent:{get:function(){return this._errorEvent}},readyEvent:{get:function(){return this._readyEvent}},rectangle:{get:function(){return this._rectangle}}}),G.DEFAULT_BRIGHTNESS=1,G.DEFAULT_CONTRAST=1,G.DEFAULT_HUE=0,G.DEFAULT_SATURATION=1,G.DEFAULT_GAMMA=1,G.DEFAULT_SPLIT=z.A.NONE,G.DEFAULT_MINIFICATION_FILTER=L.A.LINEAR,G.DEFAULT_MAGNIFICATION_FILTER=M.A.LINEAR,G.DEFAULT_APPLY_COLOR_TO_ALPHA_THRESHOLD=.004,G.fromProviderAsync=function(e,t){r.A.typeOf.object("imageryProviderPromise",e);const n=new G(void 0,t);return async function(e,t){let n;try{if(n=await Promise.resolve(t),e.isDestroyed())return;e._imageryProvider=n,e._readyEvent.raiseEvent(n)}catch(t){!function(e,t){e.numberOfListeners>0?e.raiseEvent(t):console.error(t)}(e._errorEvent,t)}}(n,Promise.resolve(e)),n},G.fromWorldImagery=function(e){return e=e??a.A.EMPTY_OBJECT,G.fromProviderAsync((0,s.A)({style:e.style}),e)},G.prototype.isBaseLayer=function(){return this._isBaseLayer},G.prototype.isDestroyed=function(){return!1},G.prototype.destroy=function(){return(0,l.A)(this)};const W=new g.A,Y=new g.A,q=new g.A,j=new g.A;function Q(e,t,n){return`${e}:${t}:${n}`}function X(e,t,n){return JSON.stringify([e,t,n])}G.prototype.getImageryRectangle=function(){const e=this._imageryProvider,t=this._rectangle;return g.A.intersection(e.rectangle,t)},G.prototype._createTileImagerySkeletons=function(e,t,n){const i=e.data;if(!(0,c.A)(t)||(0,c.A)(this._minimumTerrainLevel)&&e.level<this._minimumTerrainLevel)return!1;if((0,c.A)(this._maximumTerrainLevel)&&e.level>this._maximumTerrainLevel)return!1;(0,c.A)(n)||(n=i.imagery.length);const r=this._imageryProvider;if(!this.ready)return this._skeletonPlaceholder.loadingImagery.addReference(),i.imagery.splice(n,0,this._skeletonPlaceholder),!0;const s=r.tilingScheme.projection instanceof w.A&&e.rectangle.north<w.A.MaximumLatitude&&e.rectangle.south>-w.A.MaximumLatitude,a=g.A.intersection(r.rectangle,this._rectangle,W);let l=g.A.intersection(e.rectangle,a,Y);if(!(0,c.A)(l)){if(!this.isBaseLayer())return!1;const t=a,n=e.rectangle;l=Y,n.south>=t.north?l.north=l.south=t.north:n.north<=t.south?l.north=l.south=t.south:(l.south=Math.max(n.south,t.south),l.north=Math.min(n.north,t.north)),n.west>=t.east?l.west=l.east=t.east:n.east<=t.west?l.west=l.east=t.west:(l.west=Math.max(n.west,t.west),l.east=Math.min(n.east,t.east))}let u=0;l.south>0?u=l.south:l.north<0&&(u=l.north);let d=function(e,t,n){const i=e._imageryProvider,o=i.tilingScheme,r=o.ellipsoid,s=e._imageryProvider.tilingScheme.projection instanceof A.A?1:Math.cos(n),a=o.rectangle,c=r.maximumRadius*a.width*s/(i.tileWidth*o.getNumberOfXTilesAtLevel(0))/t,l=Math.log(c)/Math.log(2);return 0|Math.round(l)}(this,1*t.getLevelMaximumGeometricError(e.level),u);d=Math.max(0,d);const h=r.maximumLevel;if(d>h&&(d=h),(0,c.A)(r.minimumLevel)){const e=r.minimumLevel;d<e&&(d=e)}const p=r.tilingScheme,f=p.positionToTileXY(g.A.northwest(l),d),m=p.positionToTileXY(g.A.southeast(l),d);let _=e.rectangle.width/512,y=e.rectangle.height/512;const v=p.tileXYToRectangle(f.x,f.y,d);Math.abs(v.south-e.rectangle.north)<y&&f.y<m.y&&++f.y,Math.abs(v.east-e.rectangle.west)<_&&f.x<m.x&&++f.x;const T=p.tileXYToRectangle(m.x,m.y,d);Math.abs(T.north-e.rectangle.south)<y&&m.y>f.y&&--m.y,Math.abs(T.west-e.rectangle.east)<_&&m.x>f.x&&--m.x;const b=g.A.clone(e.rectangle,j);let x,C,E=p.tileXYToRectangle(f.x,f.y,d),S=g.A.intersection(E,a,q);s?(p.rectangleToNativeRectangle(b,b),p.rectangleToNativeRectangle(E,E),p.rectangleToNativeRectangle(S,S),p.rectangleToNativeRectangle(a,a),x=p.tileXYToNativeRectangle.bind(p),_=b.width/512,y=b.height/512):x=p.tileXYToRectangle.bind(p);let I,P=0,D=1;!this.isBaseLayer()&&Math.abs(S.west-b.west)>=_&&(P=Math.min(1,(S.west-b.west)/b.width)),!this.isBaseLayer()&&Math.abs(S.north-b.north)>=y&&(D=Math.max(0,(S.north-b.south)/b.height));const O=D;for(let e=f.x;e<=m.x;e++)if(C=P,E=x(e,f.y,d),S=g.A.simpleIntersection(E,a,q),(0,c.A)(S)){P=Math.min(1,(S.east-b.west)/b.width),e===m.x&&(this.isBaseLayer()||Math.abs(S.east-b.east)<_)&&(P=1),D=O;for(let t=f.y;t<=m.y;t++){if(I=D,E=x(e,t,d),S=g.A.simpleIntersection(E,a,q),!(0,c.A)(S))continue;D=Math.max(0,(S.south-b.south)/b.height),t===m.y&&(this.isBaseLayer()||Math.abs(S.south-b.south)<y)&&(D=0);const r=new o.A(C,D,P,I),l=this.getImageryFromCache(e,t,d);i.imagery.splice(n,0,new H.A(l,r,s)),++n}}return!0},G.prototype._calculateTextureTranslationAndScale=function(e,t){let n=t.readyImagery.rectangle,i=e.rectangle;if(t.useWebMercatorT){const e=t.readyImagery.imageryLayer.imageryProvider.tilingScheme;n=e.rectangleToNativeRectangle(n,W),i=e.rectangleToNativeRectangle(i,j)}const r=i.width,s=i.height,a=r/n.width,c=s/n.height;return new o.A(a*(i.west-n.west)/r,c*(i.south-n.south)/s,a,c)},G.prototype._requestImagery=function(e){const t=this._imageryProvider,n=this;function i(i){if(e.request.state===y.A.CANCELLED)return e.state=V.A.UNLOADED,void(e.request=void 0);e.state=V.A.FAILED,e.request=void 0;const r=`Failed to obtain image tile X: ${e.x} Y: ${e.y} Level: ${e.level}.`;n._requestImageError=b.A.reportError(n._requestImageError,t,t.errorEvent,r,e.x,e.y,e.level,i),n._requestImageError.retry&&o()}function o(){const o=new _.A({throttle:!1,throttleByServer:!0,type:v.A.IMAGERY});e.request=o,e.state=V.A.TRANSITIONING;const r=t.requestImage(e.x,e.y,e.level,o);if(!(0,c.A)(r))return e.state=V.A.UNLOADED,void(e.request=void 0);(0,c.A)(t.getTileCredits)&&(e.credits=t.getTileCredits(e.x,e.y,e.level)),r.then(function(t){!function(t){if(!(0,c.A)(t))return i();e.image=t,e.state=V.A.RECEIVED,e.request=void 0,b.A.reportSuccess(n._requestImageError)}(t)}).catch(function(e){i(e)})}o()},G.prototype._createTextureWebGL=function(e,t){const n=new P.A({minificationFilter:this.minificationFilter,magnificationFilter:this.magnificationFilter}),i=t.image;return(0,c.A)(i.internalFormat)?new R.A({context:e,pixelFormat:i.internalFormat,width:i.width,height:i.height,source:{arrayBufferView:i.bufferView},sampler:n}):new R.A({context:e,source:i,pixelFormat:this._imageryProvider.hasAlphaChannel?m.A.RGBA:m.A.RGB,sampler:n})},G.prototype._createTexture=function(e,t){const n=this._imageryProvider,i=t.image;if((0,c.A)(n.tileDiscardPolicy)){const e=n.tileDiscardPolicy;if((0,c.A)(e)){if(!e.isReady())return void(t.state=V.A.RECEIVED);if(e.shouldDiscardImage(i))return void(t.state=V.A.INVALID)}}if(this.minificationFilter!==L.A.NEAREST&&this.minificationFilter!==L.A.LINEAR)throw new u.A("ImageryLayer minification filter must be NEAREST or LINEAR");const o=this._createTextureWebGL(e,t);n.tilingScheme.projection instanceof w.A?t.textureWebMercator=o:t.texture=o,t.image=void 0,t.state=V.A.TEXTURE_LOADED},G.prototype._finalizeReprojectTexture=function(e,t){let n=this.minificationFilter;const i=this.magnificationFilter;if(n===L.A.LINEAR&&i===M.A.LINEAR&&!m.A.isCompressedFormat(t.pixelFormat)&&f.A.isPowerOfTwo(t.width)&&f.A.isPowerOfTwo(t.height)){n=L.A.LINEAR_MIPMAP_LINEAR;const o=S.A.maximumTextureFilterAnisotropy,r=Math.min(o,this._maximumAnisotropy??o),s=Q(n,i,r);let a=e.cache.imageryLayerMipmapSamplers;(0,c.A)(a)||(a={},e.cache.imageryLayerMipmapSamplers=a);let l=a[s];(0,c.A)(l)||(l=a[s]=new P.A({wrapS:N.A.CLAMP_TO_EDGE,wrapT:N.A.CLAMP_TO_EDGE,minificationFilter:n,magnificationFilter:i,maximumAnisotropy:r})),t.generateMipmap(I.A.NICEST),t.sampler=l}else{const o=Q(n,i,0);let r=e.cache.imageryLayerNonMipmapSamplers;(0,c.A)(r)||(r={},e.cache.imageryLayerNonMipmapSamplers=r);let s=r[o];(0,c.A)(s)||(s=r[o]=new P.A({wrapS:N.A.CLAMP_TO_EDGE,wrapT:N.A.CLAMP_TO_EDGE,minificationFilter:n,magnificationFilter:i})),t.sampler=s}},G.prototype._reprojectTexture=function(e,t,n){const i=t.textureWebMercator||t.texture,o=t.rectangle,r=e.context;if((n=n??!0)&&!(this._imageryProvider.tilingScheme.projection instanceof A.A)&&o.width/i.width>1e-5){const e=this;t.addReference();const n=new E.A({persists:!0,owner:this,preExecute:function(e){!function(e,t,n,i){let o=t.cache.imageryLayer_reproject;if(!(0,c.A)(o)){o=t.cache.imageryLayer_reproject={vertexArray:void 0,shaderProgram:void 0,sampler:void 0,destroy:function(){(0,c.A)(this.framebuffer)&&this.framebuffer.destroy(),(0,c.A)(this.vertexArray)&&this.vertexArray.destroy(),(0,c.A)(this.shaderProgram)&&this.shaderProgram.destroy()}};const e=new Float32Array(256);let n=0;for(let t=0;t<64;++t){const i=t/63;e[n++]=0,e[n++]=i,e[n++]=1,e[n++]=i}const i={position:0,webMercatorT:1},r=T.A.getRegularGridIndices(2,64),s=x.A.createIndexBuffer({context:t,typedArray:r,usage:C.A.STATIC_DRAW,indexDatatype:p.A.UNSIGNED_SHORT});o.vertexArray=new B.A({context:t,attributes:[{index:i.position,vertexBuffer:x.A.createVertexBuffer({context:t,typedArray:e,usage:C.A.STATIC_DRAW}),componentsPerAttribute:2},{index:i.webMercatorT,vertexBuffer:x.A.createVertexBuffer({context:t,sizeInBytes:512,usage:C.A.STREAM_DRAW}),componentsPerAttribute:1}],indexBuffer:s});const a=new O.A({sources:[U.A]});o.shaderProgram=D.A.fromCache({context:t,vertexShaderSource:a,fragmentShaderSource:F.A,attributeLocations:i}),o.sampler=new P.A({wrapS:N.A.CLAMP_TO_EDGE,wrapT:N.A.CLAMP_TO_EDGE,minificationFilter:L.A.LINEAR,magnificationFilter:M.A.LINEAR})}n.sampler=o.sampler;const r=n.width,s=n.height;K.textureDimensions.x=r,K.textureDimensions.y=s,K.texture=n;let a=Math.sin(i.south);const l=.5*Math.log((1+a)/(1-a));a=Math.sin(i.north);const u=1/(.5*Math.log((1+a)/(1-a))-l),d=new R.A({context:t,width:r,height:s,pixelFormat:n.pixelFormat,pixelDatatype:n.pixelDatatype,preMultiplyAlpha:n.preMultiplyAlpha});f.A.isPowerOfTwo(r)&&f.A.isPowerOfTwo(s)&&d.generateMipmap(I.A.NICEST);const h=i.south,A=i.north,m=$;let g=0;for(let e=0;e<64;++e){const t=e/63,n=f.A.lerp(h,A,t);a=Math.sin(n);const i=(.5*Math.log((1+a)/(1-a))-l)*u;m[g++]=i,m[g++]=i}o.vertexArray.getAttribute(1).vertexBuffer.copyFromArrayView(m),e.shaderProgram=o.shaderProgram,e.outputTexture=d,e.uniformMap=K,e.vertexArray=o.vertexArray}(e,r,i,t.rectangle)},postExecute:function(n){t.texture=n,e._finalizeReprojectTexture(r,n),t.state=V.A.READY,t.releaseReference()},canceled:function(){t.state=V.A.TEXTURE_LOADED,t.releaseReference()}});this._reprojectComputeCommands.push(n)}else n&&(t.texture=i),this._finalizeReprojectTexture(r,i),t.state=V.A.READY},G.prototype.queueReprojectionCommands=function(e){const t=this._reprojectComputeCommands,n=t.length;for(let i=0;i<n;++i)e.commandList.push(t[i]);t.length=0},G.prototype.cancelReprojections=function(){this._reprojectComputeCommands.forEach(function(e){(0,c.A)(e.canceled)&&e.canceled()}),this._reprojectComputeCommands.length=0},G.prototype.getImageryFromCache=function(e,t,n,i){const o=X(e,t,n);let r=this._imageryCache[o];return(0,c.A)(r)||(r=new k.A(this,e,t,n,i),this._imageryCache[o]=r),r.addReference(),r},G.prototype.removeImageryFromCache=function(e){const t=X(e.x,e.y,e.level);delete this._imageryCache[t]};const K={u_textureDimensions:function(){return this.textureDimensions},u_texture:function(){return this.texture},textureDimensions:new i.A,texture:void 0},$=h.A.supportsTypedArrays()?new Float32Array(128):void 0,J=G},869327:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var i=n(491446),o=n(677354),r=n(605971),s=n(955943),a=n(367817),c=n(697422),l=n(451227);function u(){this._layers=[],this.layerAdded=new s.A,this.layerRemoved=new s.A,this.layerMoved=new s.A,this.layerShownOrHidden=new s.A}function d(e,t){if(!(0,i.A)(t))throw new r.A("layer is required.");const n=e.indexOf(t);if(-1===n)throw new r.A("layer is not in this collection.");return n}function h(e,t,n){const i=e._layers;if((t=a.A.clamp(t,0,i.length-1))===(n=a.A.clamp(n,0,i.length-1)))return;const o=i[t];i[t]=i[n],i[n]=o,e._update(),e.layerMoved.raiseEvent(o,n,t)}Object.defineProperties(u.prototype,{length:{get:function(){return this._layers.length}}}),u.prototype.add=function(e,t){const n=(0,i.A)(t);if(!(0,i.A)(e))throw new r.A("layer is required.");if(n){if(t<0)throw new r.A("index must be greater than or equal to zero.");if(t>this._layers.length)throw new r.A("index must be less than or equal to the number of layers.")}n?this._layers.splice(t,0,e):(t=this._layers.length,this._layers.push(e)),this._update(),this.layerAdded.raiseEvent(e,t);const o=e.readyEvent.addEventListener(()=>{this.layerShownOrHidden.raiseEvent(e,e._layerIndex,e.show),o()})},u.prototype.addImageryProvider=function(e,t){if(!(0,i.A)(e))throw new r.A("imageryProvider is required.");const n=new l.A(e);return this.add(n,t),n},u.prototype.remove=function(e,t){t=t??!0;const n=this._layers.indexOf(e);return-1!==n&&(this._layers.splice(n,1),this._update(),this.layerRemoved.raiseEvent(e,n),t&&e.destroy(),!0)},u.prototype.removeAll=function(e){e=e??!0;const t=this._layers;for(let n=0,i=t.length;n<i;n++){const i=t[n];this.layerRemoved.raiseEvent(i,n),e&&i.destroy()}this._layers=[]},u.prototype.contains=function(e){return-1!==this.indexOf(e)},u.prototype.indexOf=function(e){return this._layers.indexOf(e)},u.prototype.get=function(e){if(!(0,i.A)(e))throw new r.A("index is required.","index");return this._layers[e]},u.prototype.raise=function(e){const t=d(this._layers,e);h(this,t,t+1)},u.prototype.lower=function(e){const t=d(this._layers,e);h(this,t,t-1)},u.prototype.raiseToTop=function(e){const t=d(this._layers,e);t!==this._layers.length-1&&(this._layers.splice(t,1),this._layers.push(e),this._update(),this.layerMoved.raiseEvent(e,this._layers.length-1,t))},u.prototype.lowerToBottom=function(e){const t=d(this._layers,e);0!==t&&(this._layers.splice(t,1),this._layers.splice(0,0,e),this._update(),this.layerMoved.raiseEvent(e,0,t))};const A=new c.A;function p(e,t,n,o){const r=e.globe._surface._tilesToRender;let s;for(let e=0;!(0,i.A)(s)&&e<r.length;++e){const n=r[e];c.A.contains(n.rectangle,t)&&(s=n)}if(!(0,i.A)(s))return;const l=s.data.imagery;for(let e=l.length-1;e>=0;--e){const r=l[e],u=r.readyImagery;if(!(0,i.A)(u))continue;if(!u.imageryLayer.ready)continue;const d=u.imageryLayer.imageryProvider;if(n&&!(0,i.A)(d.pickFeatures))continue;if(!c.A.contains(u.rectangle,t))continue;const h=A,p=1/1024;h.west=a.A.lerp(s.rectangle.west,s.rectangle.east,r.textureCoordinateRectangle.x-p),h.east=a.A.lerp(s.rectangle.west,s.rectangle.east,r.textureCoordinateRectangle.z+p),h.south=a.A.lerp(s.rectangle.south,s.rectangle.north,r.textureCoordinateRectangle.y-p),h.north=a.A.lerp(s.rectangle.south,s.rectangle.north,r.textureCoordinateRectangle.w+p),c.A.contains(h,t)&&o(u)}}u.prototype.pickImageryLayers=function(e,t){const n=t.globe.pick(e,t);if(!(0,i.A)(n))return;const o=t.ellipsoid.cartesianToCartographic(n),r=[];return p(t,o,!1,function(e){r.push(e.imageryLayer)}),0!==r.length?r:void 0},u.prototype.pickImageryLayerFeatures=function(e,t){const n=t.globe.pick(e,t);if(!(0,i.A)(n))return;const o=t.ellipsoid.cartesianToCartographic(n),r=[],s=[];return p(t,o,!0,function(e){if(!e.imageryLayer.ready)return;const t=e.imageryLayer.imageryProvider.pickFeatures(e.x,e.y,e.level,o.longitude,o.latitude);(0,i.A)(t)&&(r.push(t),s.push(e.imageryLayer))}),0!==r.length?Promise.all(r).then(function(e){const t=[];for(let n=0;n<e.length;++n){const r=e[n],a=s[n];if((0,i.A)(r)&&r.length>0)for(let e=0;e<r.length;++e){const n=r[e];n.imageryLayer=a,(0,i.A)(n.position)||(n.position=o),t.push(n)}}return t}):void 0},u.prototype.queueReprojectionCommands=function(e){const t=this._layers;for(let n=0,i=t.length;n<i;++n)t[n].queueReprojectionCommands(e)},u.prototype.cancelReprojections=function(){const e=this._layers;for(let t=0,n=e.length;t<n;++t)e[t].cancelReprojections()},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){return this.removeAll(!0),(0,o.A)(this)},u.prototype._update=function(){let e=!0;const t=this._layers;let n,o,r,s;for(r=0,s=t.length;r<s;++r)o=t[r],o._layerIndex=r,o.show?(o._isBaseLayer=e,e=!1):o._isBaseLayer=!1,o.show!==o._show&&((0,i.A)(o._show)&&((0,i.A)(n)||(n=[]),n.push(o)),o._show=o.show);if((0,i.A)(n))for(r=0,s=n.length;r<s;++r)o=n[r],this.layerShownOrHidden.raiseEvent(o,o._layerIndex,o.show)};const f=u},789989:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(491446);function o(){this.name=void 0,this.description=void 0,this.position=void 0,this.data=void 0,this.imageryLayer=void 0}o.prototype.configureNameFromProperties=function(e){let t,n=10;for(const i in e)if(e.hasOwnProperty(i)&&e[i]){const e=i.toLowerCase();n>1&&"name"===e?(n=1,t=i):n>2&&"title"===e?(n=2,t=i):n>3&&/name/i.test(i)?(n=3,t=i):n>4&&/title/i.test(i)&&(n=4,t=i)}(0,i.A)(t)&&(this.name=e[t])},o.prototype.configureDescriptionFromProperties=function(e){this.description=function e(t){let n='<table class="cesium-infoBox-defaultTable">';for(const o in t)if(t.hasOwnProperty(o)){const r=t[o];(0,i.A)(r)&&(n+="object"==typeof r?`<tr><td>${o}</td><td>${e(r)}</td></tr>`:`<tr><td>${o}</td><td>${r}</td></tr>`)}return n+="</table>",n}(e)};const r=o},921243:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({UNLOADED:0,TRANSITIONING:1,RECEIVED:2,TEXTURE_LOADED:3,READY:4,FAILED:5,INVALID:6,PLACEHOLDER:7})},961965:(e,t,n)=>{"use strict";n.d(t,{A:()=>B});var i=n(267980),o=n(369031),r=n(376758),s=n(430346),a=n(491446),c=n(677354),l=n(605971),u=n(367817),d=n(416721),h=n(331185),A=n(697422),p=n(252538),f=n(409211),m=n(800859),g=n(165955),_=n(655979);function y(e,t,n){o.A.defined("tile.implicitTileset",t.implicitTileset),o.A.defined("tile.implicitCoordinates",t.implicitCoordinates);const i=t.implicitTileset,r=t.implicitCoordinates;this._implicitTileset=i,this._implicitCoordinates=r,this._implicitSubtree=void 0,this._tileset=e,this._tile=t,this._resource=n,this._metadata=void 0,this.featurePropertiesDirty=!1,this._group=void 0;const s=r.getTemplateValues(),a=i.subtreeUriTemplate.getDerivedResource({templateValues:s});this._url=a.getUrlComponent(!0),this._ready=!1}function v(e,t,n){const i=g.A.TILE_GEOMETRIC_ERROR;return(0,a.A)(e)&&e.hasPropertyBySemantic(i)?e.getPropertyBySemantic(i):t.geometricError/Math.pow(2,n.level)}function T(e,t,n,i,o,c){const l=e._implicitTileset;let u,d,h,A;if(u=c?n.implicitCoordinates:n.implicitCoordinates.getChildCoordinates(i),(0,a.A)(t.tilePropertyTableJson)){d=t.getTileMetadataView(u);const e=_.A.parseAllBoundingVolumeSemantics(d);h=e.tile,A=e.content}const p=t.contentPropertyTableJsons.length;let f=!1;for(let e=0;e<p;e++)if(t.contentIsAvailableAtCoordinates(u,e)){f=!0;break}const m=function(e,t,n,i,o,r){let s;return s=!(0,a.A)(r)||!(0,a.A)(r.boundingVolume)||!b(r.boundingVolume,r)&&b(e.boundingVolume,r)?C(e,t,n,i??!1,o):r.boundingVolume,w(s,r),s}(l,u,i,c,n,h),g=[];for(let e=0;e<l.contentCount;e++){if(!t.contentIsAvailableAtIndex(o,e))continue;const n={uri:l.contentUriTemplates[e].getDerivedResource({templateValues:u.getTemplateValues()}).url},i=x(m,A);(0,a.A)(i)&&(n.boundingVolume=i),g.push((0,s.A)(n,l.contentHeaders[e]))}const y={boundingVolume:m,geometricError:v(d,l,u),refine:l.refine,contents:g},T=!0,E=(0,r.A)(l.tileHeader,T);delete E.boundingVolume,delete E.transform,delete E.metadata;const S=(0,s.A)(y,E,T),I=N(e,l.baseResource,S,n);return I.implicitCoordinates=u,I.implicitSubtree=t,I.metadata=d,I.hasImplicitContentMetadata=f,I}function b(e,t){return(0,a.A)(e)&&(0,a.A)(t)&&((0,a.A)(t.minimumHeight)||(0,a.A)(t.maximumHeight))&&((0,m.A)(e,"3DTILES_bounding_volume_S2")||(0,a.A)(e.region))}function w(e,t){var n,i,o;(0,a.A)(t)&&((0,m.A)(e,"3DTILES_bounding_volume_S2")?(n=e.extensions["3DTILES_bounding_volume_S2"],i=t.minimumHeight,o=t.maximumHeight,(0,a.A)(i)&&(n.minimumHeight=i),(0,a.A)(o)&&(n.maximumHeight=o)):(0,a.A)(e.region)&&function(e,t,n){(0,a.A)(t)&&(e[4]=t),(0,a.A)(n)&&(e[5]=n)}(e.region,t.minimumHeight,t.maximumHeight))}function x(e,t){let n;return(0,a.A)(t)&&(n=t.boundingVolume),b(n,t)?w(n,t):b(e,t)&&(n=(0,r.A)(e,!0),w(n,t)),n}function C(e,t,n,i,o){const r=e.boundingVolume;return(0,m.A)(r,"3DTILES_bounding_volume_S2")?E(i,o,n,t.level,t.x,t.y,t.z):(0,a.A)(r.region)?{region:M(r.region,t.level,t.x,t.y,t.z)}:{box:O(r.box,t.level,t.x,t.y,t.z)}}function E(e,t,n,i,r,s,c){o.A.typeOf.bool("parentIsPlaceholderTile",e),o.A.typeOf.object("parentTile",t),o.A.typeOf.number("childIndex",n),o.A.typeOf.number("level",i),o.A.typeOf.number("x",r),o.A.typeOf.number("y",s),(0,a.A)(c)&&o.A.typeOf.number("z",c);const l=t._boundingVolume;if(e)return{extensions:{"3DTILES_bounding_volume_S2":{token:p.A.getTokenFromId(l.s2Cell._cellId),minimumHeight:l.minimumHeight,maximumHeight:l.maximumHeight}}};const u=Number(t._boundingVolume.s2Cell._cellId>>BigInt(61)),h=u%2==0?d.A.encode2D(i,r,s):d.A.encode2D(i,s,r),A=p.A.fromFacePositionLevel(u,BigInt(h),i);let f,m;if((0,a.A)(c)){const e=(l.maximumHeight+l.minimumHeight)/2;f=n<4?l.minimumHeight:e,m=n<4?e:l.maximumHeight}else f=l.minimumHeight,m=l.maximumHeight;return{extensions:{"3DTILES_bounding_volume_S2":{token:p.A.getTokenFromId(A._cellId),minimumHeight:f,maximumHeight:m}}}}Object.defineProperties(y.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._url}},metadata:{get:function(){},set:function(){throw new l.A("Implicit3DTileContent cannot have metadata")}},batchTable:{get:function(){}},group:{get:function(){return this._group},set:function(e){this._group=e}}}),y.fromSubtreeJson=async function(e,t,n,i,r,s){if(o.A.defined("tile.implicitTileset",t.implicitTileset),o.A.defined("tile.implicitCoordinates",t.implicitCoordinates),(0,a.A)(i)===(0,a.A)(r))throw new l.A("One of json and arrayBuffer must be defined.");let c;s=s??0,(0,a.A)(r)&&(c=new Uint8Array(r,s));const u=t.implicitTileset,d=t.implicitCoordinates,h=await f.A.fromSubtreeJson(n,i,c,u,d),A=new y(e,t,n);return A._implicitSubtree=h,function(e,t){const n=e._tile,i=function(e,t,n,i){const o=T(e,t,n,i,0,!0),r=e._tileset.statistics;let s=[o],a=[];const c=e._implicitTileset;for(let n=1;n<c.subtreeLevels;n++){const i=t.getLevelOffset(n),o=c.branchingFactor*s.length;for(let n=0;n<o;n++){const o=i+n;if(!t.tileIsAvailableAtIndex(o)){a.push(void 0);continue}const l=s[t.getParentMortonIndex(n)],u=T(e,t,l,n%c.branchingFactor,o);l.children.push(u),r.numberOfTilesTotal++,a.push(u)}s=a,a=[]}return{rootTile:o,bottomRow:s}}(e,t,n,e._implicitCoordinates.childIndex),o=e._tileset.statistics;n.children.push(i.rootTile),o.numberOfTilesTotal++;const r=function(e,t,n){const i=[],o=e._implicitTileset.branchingFactor;for(let e=0;e<n.length;e++){const r=n[e];if((0,a.A)(r))for(let n=0;n<o;n++){const s=e*o+n;t.childSubtreeIsAvailableAtIndex(s)&&i.push({tile:r,childIndex:n})}}return i}(e,t,i.bottomRow);for(let t=0;t<r.length;t++){const n=r[t],i=n.tile,s=L(e,i,n.childIndex);i.children.push(s),o.numberOfTilesTotal++}}(A,h),A._ready=!0,A};const S=new i.A,I=new i.A,P=new i.A,D=new h.A;function O(e,t,n,r,s){if(o.A.typeOf.object("rootBox",e),o.A.typeOf.number("level",t),o.A.typeOf.number("x",n),o.A.typeOf.number("y",r),(0,a.A)(s)&&o.A.typeOf.number("z",s),0===t)return e;const c=i.A.unpack(e,0,I),l=h.A.unpack(e,3,D),u=Math.pow(2,-t),d=(2*n+1)*u-1,A=(2*r+1)*u-1;let p=0;const f=i.A.fromElements(u,u,1,S);(0,a.A)(s)&&(p=(2*s+1)*u-1,f.z=u);let m=i.A.fromElements(d,A,p,P);m=h.A.multiplyByVector(l,m,P),m=i.A.add(m,c,P);let g=h.A.clone(l);g=h.A.multiplyByScale(g,f,g);const _=new Array(12);return i.A.pack(m,_),h.A.pack(g,_,3),_}const R=new A.A;function M(e,t,n,i,r){if(o.A.typeOf.object("rootRegion",e),o.A.typeOf.number("level",t),o.A.typeOf.number("x",n),o.A.typeOf.number("y",i),(0,a.A)(r)&&o.A.typeOf.number("z",r),0===t)return e.slice();const s=A.A.unpack(e,0,R),c=e[4],l=e[5],d=Math.pow(2,-t),h=d*s.width,p=u.A.negativePiToPi(s.west+n*h),f=u.A.negativePiToPi(p+h),m=d*s.height,g=u.A.negativePiToPi(s.south+i*m),_=u.A.negativePiToPi(g+m);let y=c,v=l;if((0,a.A)(r)){const e=d*(l-c);y+=r*e,v=y+e}return[p,g,f,_,y,v]}function L(e,t,n){const i=e._implicitTileset,o=t.implicitCoordinates.getChildCoordinates(n),r=C(i,o,n,!1,t),s=v(void 0,i,o),a=i.subtreeUriTemplate.getDerivedResource({templateValues:o.getTemplateValues()}).url,c={boundingVolume:r,geometricError:s,refine:i.refine,contents:[{uri:a}]},l=N(e,i.baseResource,c,t);return l.implicitTileset=i,l.implicitCoordinates=o,l}function N(e,t,n,i){return new(0,e._tile.constructor)(e._tileset,t,n,i)}y.prototype.hasProperty=function(e,t){return!1},y.prototype.getFeature=function(e){},y.prototype.applyDebugSettings=function(e,t){},y.prototype.applyStyle=function(e){},y.prototype.update=function(e,t){},y.prototype.pick=function(e,t,n){},y.prototype.isDestroyed=function(){return!1},y.prototype.destroy=function(){return this._implicitSubtree=this._implicitSubtree&&this._implicitSubtree.destroy(),(0,c.A)(this)},y._deriveBoundingBox=O,y._deriveBoundingRegion=M,y._deriveBoundingVolumeS2=E;const B=y},1235:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(369031),o=n(491446),r=n(605971),s=n(123245);function a(e){const t=e.lengthBits;let n=e.availableCount;i.A.typeOf.number("options.lengthBits",t);const r=e.constant,a=e.bitstream;if((0,o.A)(r))n=t;else{const i=Math.ceil(t/8);if(a.length!==i)throw new s.A(`Availability bitstream must be exactly ${i} bytes long to store ${t} bits. Actual bitstream was ${a.length} bytes long.`);const r=e.computeAvailableCountEnabled??!1;!(0,o.A)(n)&&r&&(n=function(e,t){let n=0;for(let i=0;i<t;i++){const t=i%8;n+=e[i>>3]>>t&1}return n}(a,t))}this._lengthBits=t,this._availableCount=n,this._constant=r,this._bitstream=a}Object.defineProperties(a.prototype,{lengthBits:{get:function(){return this._lengthBits}},availableCount:{get:function(){return this._availableCount}}}),a.prototype.getBit=function(e){if(e<0||e>=this._lengthBits)throw new r.A("Bit index out of bounds.");if((0,o.A)(this._constant))return this._constant;const t=e>>3,n=e%8;return 1==(this._bitstream[t]>>n&1)};const c=a},829513:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(369031),o=n(915325);function r(e){const t=(e=e??o.A.EMPTY_OBJECT).metadataTable,n=e.class,r=e.entityId,s=e.propertyTableJson;i.A.typeOf.object("options.metadataTable",t),i.A.typeOf.object("options.class",n),i.A.typeOf.number("options.entityId",r),i.A.typeOf.object("options.propertyTableJson",s),this._class=n,this._metadataTable=t,this._entityId=r,this._extensions=s.extensions,this._extras=s.extras}Object.defineProperties(r.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),r.prototype.hasProperty=function(e){return this._metadataTable.hasProperty(e)},r.prototype.hasPropertyBySemantic=function(e){return this._metadataTable.hasPropertyBySemantic(e)},r.prototype.getPropertyIds=function(e){return this._metadataTable.getPropertyIds(e)},r.prototype.getProperty=function(e){return this._metadataTable.getProperty(this._entityId,e)},r.prototype.setProperty=function(e,t){return this._metadataTable.setProperty(this._entityId,e,t)},r.prototype.getPropertyBySemantic=function(e){return this._metadataTable.getPropertyBySemantic(this._entityId,e)},r.prototype.setPropertyBySemantic=function(e,t){return this._metadataTable.setPropertyBySemantic(this._entityId,e,t)};const s=r},586067:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(605971);const o={QUADTREE:"QUADTREE",OCTREE:"OCTREE",getBranchingFactor:function(e){switch(e){case o.OCTREE:return 8;case o.QUADTREE:return 4;default:throw new i.A("subdivisionScheme is not a valid value.")}}},r=Object.freeze(o)},409211:(e,t,n)=>{"use strict";n.d(t,{A:()=>T});var i=n(369031),o=n(605971),r=n(491446),s=n(677354),a=n(604752),c=n(123245),l=n(800859),u=n(1235),d=n(829513),h=n(586067),A=n(123314),p=n(874403),f=n(872182);function m(e,t,n){i.A.typeOf.object("resource",e),i.A.typeOf.object("implicitTileset",t),i.A.typeOf.object("implicitCoordinates",n),this._resource=e,this._subtreeJson=void 0,this._bufferLoader=void 0,this._tileAvailability=void 0,this._contentAvailabilityBitstreams=[],this._childSubtreeAvailability=void 0,this._implicitCoordinates=n,this._subtreeLevels=t.subtreeLevels,this._subdivisionScheme=t.subdivisionScheme,this._branchingFactor=t.branchingFactor,this._metadata=void 0,this._tileMetadataTable=void 0,this._tilePropertyTableJson=void 0,this._contentMetadataTables=[],this._contentPropertyTableJsons=[],this._tileJumpBuffer=void 0,this._contentJumpBuffers=[],this._ready=!1}function g(e,t){const n=e.properties;let i;for(const e in n)if(n.hasOwnProperty(e)){const o=n[e];i=t[o.values??o.bufferView],i.isActive=!0,i.bufferHeader.isActive=!0;const s=o.stringOffsets??o.stringOffsetBufferView;(0,r.A)(s)&&(i=t[s],i.isActive=!0,i.bufferHeader.isActive=!0);const a=o.arrayOffsets??o.arrayOffsetBufferView;(0,r.A)(a)&&(i=t[a],i.isActive=!0,i.bufferHeader.isActive=!0)}}async function _(e,t){const n=e._resource.getDerivedResource({url:t.uri}),i=f.A.getExternalBufferLoader({resource:n});e._bufferLoader=i;try{await i.load()}catch(e){if(i.isDestroyed())return;throw e}return i.typedArray}function y(e,t,n,i){if((0,r.A)(e.constant))return new u.A({constant:Boolean(e.constant),lengthBits:n,availableCount:e.availableCount});let o;return(0,r.A)(e.bitstream)?o=t[e.bitstream]:(0,r.A)(e.bufferView)&&(o=t[e.bufferView]),new u.A({bitstream:o,lengthBits:n,availableCount:e.availableCount,computeAvailableCountEnabled:i})}function v(e){let t=0;const n=e.lengthBits,i=e.availableCount;let o;o=i<256?new Uint8Array(n):i<65536?new Uint16Array(n):new Uint32Array(n);for(let n=0;n<e.lengthBits;n++)e.getBit(n)&&(o[n]=t,t++);return o}Object.defineProperties(m.prototype,{ready:{get:function(){return this._ready}},metadata:{get:function(){return this._metadata}},tileMetadataTable:{get:function(){return this._tileMetadataTable}},tilePropertyTableJson:{get:function(){return this._tilePropertyTableJson}},contentMetadataTables:{get:function(){return this._contentMetadataTables}},contentPropertyTableJsons:{get:function(){return this._contentPropertyTableJsons}},implicitCoordinates:{get:function(){return this._implicitCoordinates}}}),m.prototype.tileIsAvailableAtIndex=function(e){return this._tileAvailability.getBit(e)},m.prototype.tileIsAvailableAtCoordinates=function(e){const t=this.getTileIndex(e);return this.tileIsAvailableAtIndex(t)},m.prototype.contentIsAvailableAtIndex=function(e,t){if((t=t??0)<0||t>=this._contentAvailabilityBitstreams.length)throw new o.A("contentIndex out of bounds.");return this._contentAvailabilityBitstreams[t].getBit(e)},m.prototype.contentIsAvailableAtCoordinates=function(e,t){const n=this.getTileIndex(e);return this.contentIsAvailableAtIndex(n,t)},m.prototype.childSubtreeIsAvailableAtIndex=function(e){return this._childSubtreeAvailability.getBit(e)},m.prototype.childSubtreeIsAvailableAtCoordinates=function(e){const t=this.getChildSubtreeIndex(e);return this.childSubtreeIsAvailableAtIndex(t)},m.prototype.getLevelOffset=function(e){const t=this._branchingFactor;return(Math.pow(t,e)-1)/(t-1)},m.prototype.getParentMortonIndex=function(e){let t=2;return this._subdivisionScheme===h.A.OCTREE&&(t=3),e>>t},m.fromSubtreeJson=async function(e,t,n,s,c){if(i.A.typeOf.object("resource",e),(0,r.A)(t)===(0,r.A)(n))throw new o.A("One of json and subtreeView must be defined.");i.A.typeOf.object("implicitTileset",s),i.A.typeOf.object("implicitCoordinates",c);const u=new m(e,s,c);let d;d=(0,r.A)(t)?{json:t,binary:void 0}:function(e){const t=!0,n=new DataView(e.buffer,e.byteOffset);let i=8;const o=n.getUint32(i,t);i+=8;const r=n.getUint32(i,t);i+=8;const s=(0,a.A)(e,i,o);i+=o;return{json:s,binary:e.subarray(i,i+r)}}(n);const h=d.json;let f;if(u._subtreeJson=h,(0,l.A)(h,"3DTILES_metadata"))f=h.extensions["3DTILES_metadata"];else if((0,r.A)(h.tileMetadata)){const e=h.tileMetadata;f=h.propertyTables[e]}const T=[];if((0,r.A)(h.contentMetadata)){const e=h.contentMetadata.length;for(let t=0;t<e;t++){const e=h.contentMetadata[t];T.push(h.propertyTables[e])}}let b;const w=s.metadataSchema,x=h.subtreeMetadata;if((0,r.A)(x)){const e=x.class,t=w.classes[e];b=new A.A({subtreeMetadata:x,class:t})}u._metadata=b,u._tilePropertyTableJson=f,u._contentPropertyTableJsons=T;h.contentAvailabilityHeaders=[],(0,l.A)(h,"3DTILES_multiple_contents")?h.contentAvailabilityHeaders=h.extensions["3DTILES_multiple_contents"].contentAvailability:Array.isArray(h.contentAvailability)?h.contentAvailabilityHeaders=h.contentAvailability:h.contentAvailabilityHeaders.push(h.contentAvailability??{constant:0});const C=function(e){e=(0,r.A)(e)?e:[];for(let t=0;t<e.length;t++){const n=e[t];n.isExternal=(0,r.A)(n.uri),n.isActive=!1}return e}(h.buffers),E=function(e,t){e=(0,r.A)(e)?e:[];for(let n=0;n<e.length;n++){const i=e[n],o=t[i.buffer];i.bufferHeader=o,i.isActive=!1}return e}(h.bufferViews,C);!function(e,t){let n;const i=e.tileAvailability;(0,r.A)(i.bitstream)?n=t[i.bitstream]:(0,r.A)(i.bufferView)&&(n=t[i.bufferView]),(0,r.A)(n)&&(n.isActive=!0,n.bufferHeader.isActive=!0);const o=e.contentAvailabilityHeaders;for(let e=0;e<o.length;e++)n=void 0,(0,r.A)(o[e].bitstream)?n=t[o[e].bitstream]:(0,r.A)(o[e].bufferView)&&(n=t[o[e].bufferView]),(0,r.A)(n)&&(n.isActive=!0,n.bufferHeader.isActive=!0);n=void 0;const s=e.childSubtreeAvailability;(0,r.A)(s.bitstream)?n=t[s.bitstream]:(0,r.A)(s.bufferView)&&(n=t[s.bufferView]),(0,r.A)(n)&&(n.isActive=!0,n.bufferHeader.isActive=!0)}(h,E),(0,r.A)(f)&&g(f,E);for(let e=0;e<T.length;e++)g(T[e],E);const S=await function(e,t,n){const i=[];for(let o=0;o<t.length;o++){const r=t[o];if(r.isActive)if(r.isExternal){const t=_(e,r);i.push(t)}else i.push(Promise.resolve(n));else i.push(Promise.resolve(void 0))}return Promise.all(i).then(function(e){const t={};for(let n=0;n<e.length;n++){const i=e[n];(0,r.A)(i)&&(t[n]=i)}return t})}(u,C,d.binary),I=function(e,t){const n={};for(let i=0;i<e.length;i++){const o=e[i];if(!o.isActive)continue;const r=o.byteOffset,s=r+o.byteLength,a=t[o.buffer].subarray(r,s);n[i]=a}return n}(E,S);return function(e,t,n,i){const o=n.branchingFactor,s=n.subtreeLevels,a=(Math.pow(o,s)-1)/(o-1),c=Math.pow(o,s),u=(0,l.A)(t,"3DTILES_metadata"),d=(0,r.A)(e._tilePropertyTableJson);let h=u||d;e._tileAvailability=y(t.tileAvailability,i,a,h);const A=e._contentPropertyTableJsons.length>0;h=h||A;for(let n=0;n<t.contentAvailabilityHeaders.length;n++){const o=y(t.contentAvailabilityHeaders[n],i,a,h);e._contentAvailabilityBitstreams.push(o)}e._childSubtreeAvailability=y(t.childSubtreeAvailability,i,c)}(u,h,s,I),(0,r.A)(f)&&(function(e,t,n){const i=e._tilePropertyTableJson,o=e._tileAvailability.availableCount,r=t.metadataSchema,s=i.class,a=r.classes[s];e._tileMetadataTable=new p.A({class:a,count:o,properties:i.properties,bufferViews:n})}(u,s,I),function(e){const t=v(e._tileAvailability);e._tileJumpBuffer=t}(u)),function(e,t,n){const i=e._contentPropertyTableJsons,o=e._contentAvailabilityBitstreams,r=t.metadataSchema,s=e._contentMetadataTables;for(let e=0;e<i.length;e++){const t=i[e],a=o[e].availableCount,c=t.class,l=r.classes[c],u=new p.A({class:l,count:a,properties:t.properties,bufferViews:n});s.push(u)}}(u,s,I),function(e){const t=e._contentJumpBuffers,n=e._contentAvailabilityBitstreams;for(let e=0;e<n.length;e++){const i=v(n[e]);t.push(i)}}(u),u._ready=!0,u},m.prototype.getTileIndex=function(e){const t=e.level-this._implicitCoordinates.level;if(t<0||this._subtreeLevels<=t)throw new c.A("level is out of bounds for this subtree");return e.getSubtreeCoordinates().getOffsetCoordinates(e).tileIndex},m.prototype.getChildSubtreeIndex=function(e){if(e.level-this._implicitCoordinates.level!==this._implicitCoordinates.subtreeLevels)throw new c.A("level is out of bounds for this subtree");return e.getParentSubtreeCoordinates().getOffsetCoordinates(e).mortonIndex},m.prototype.getTileMetadataView=function(e){const t=function(e,t){if(!(0,r.A)(e._tileMetadataTable))return;const n=e.getTileIndex(t);return e._tileAvailability.getBit(n)?e._tileJumpBuffer[n]:void 0}(this,e);if(!(0,r.A)(t))return;const n=this._tileMetadataTable;return new d.A({class:n.class,metadataTable:n,entityId:t,propertyTableJson:this._tilePropertyTableJson})},m.prototype.getContentMetadataView=function(e,t){const n=function(e,t,n){const i=e._contentMetadataTables;if(!(0,r.A)(i))return;const o=i[n];if(!(0,r.A)(o))return;const s=e._contentAvailabilityBitstreams[n],a=e.getTileIndex(t);return s.getBit(a)?e._contentJumpBuffers[n][a]:void 0}(this,e,t);if(!(0,r.A)(n))return;const i=this._contentMetadataTables[t],o=this._contentPropertyTableJsons[t];return new d.A({class:i.class,metadataTable:i,entityId:n,contentIndex:t,propertyTableJson:o})},m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){return(0,r.A)(this._bufferLoader)&&f.A.unload(this._bufferLoader),(0,s.A)(this)};const T=m},123314:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(369031),o=n(915325),r=n(491446),s=n(965976);function a(e){const t=(e=e??o.A.EMPTY_OBJECT).subtreeMetadata,n=e.class;i.A.typeOf.object("options.subtreeMetadata",t),i.A.typeOf.object("options.class",n);const s=(0,r.A)(t.properties)?t.properties:{};this._class=n,this._properties=s,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(a.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),a.prototype.hasProperty=function(e){return s.A.hasProperty(e,this._properties,this._class)},a.prototype.hasPropertyBySemantic=function(e){return s.A.hasPropertyBySemantic(e,this._properties,this._class)},a.prototype.getPropertyIds=function(e){return s.A.getPropertyIds(this._properties,this._class,e)},a.prototype.getProperty=function(e){return s.A.getProperty(e,this._properties,this._class)},a.prototype.setProperty=function(e,t){return s.A.setProperty(e,t,this._properties,this._class)},a.prototype.getPropertyBySemantic=function(e){return s.A.getPropertyBySemantic(e,this._properties,this._class)},a.prototype.setPropertyBySemantic=function(e,t){return s.A.setPropertyBySemantic(e,t,this._properties,this._class)};const c=a},410974:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(367817),o=n(369031),r=n(605971),s=n(245226),a=n(586067);function c(e){if(o.A.typeOf.string("options.subdivisionScheme",e.subdivisionScheme),o.A.typeOf.number("options.subtreeLevels",e.subtreeLevels),o.A.typeOf.number("options.level",e.level),o.A.typeOf.number("options.x",e.x),o.A.typeOf.number("options.y",e.y),e.subdivisionScheme===a.A.OCTREE&&o.A.typeOf.number("options.z",e.z),e.level<0)throw new r.A("level must be non-negative");if(e.x<0)throw new r.A("x must be non-negative");if(e.y<0)throw new r.A("y must be non-negative");if(e.subdivisionScheme===a.A.OCTREE&&e.z<0)throw new r.A("z must be non-negative");const t=1<<e.level;if(e.x>=t)throw new r.A("x is out of range");if(e.y>=t)throw new r.A("y is out of range");if(e.subdivisionScheme===a.A.OCTREE&&e.z>=t)throw new r.A("z is out of range");this.subdivisionScheme=e.subdivisionScheme,this.subtreeLevels=e.subtreeLevels,this.level=e.level,this.x=e.x,this.y=e.y,this.z=void 0,e.subdivisionScheme===a.A.OCTREE&&(this.z=e.z)}function l(e,t){if(e.subdivisionScheme!==t.subdivisionScheme)throw new r.A("coordinates must have same subdivisionScheme");if(e.subtreeLevels!==t.subtreeLevels)throw new r.A("coordinates must have same subtreeLevels")}Object.defineProperties(c.prototype,{childIndex:{get:function(){let e=0;return e|=1&this.x,e|=(1&this.y)<<1,this.subdivisionScheme===a.A.OCTREE&&(e|=(1&this.z)<<2),e}},mortonIndex:{get:function(){return this.subdivisionScheme===a.A.OCTREE?s.A.encode3D(this.x,this.y,this.z):s.A.encode2D(this.x,this.y)}},tileIndex:{get:function(){return(this.subdivisionScheme===a.A.OCTREE?((1<<3*this.level)-1)/7:((1<<2*this.level)-1)/3)+this.mortonIndex}}}),c.prototype.getDescendantCoordinates=function(e){o.A.typeOf.object("offsetCoordinates",e),l(this,e);const t=this.level+e.level,n=(this.x<<e.level)+e.x,i=(this.y<<e.level)+e.y;if(this.subdivisionScheme===a.A.OCTREE){const o=(this.z<<e.level)+e.z;return new c({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:n,y:i,z:o})}return new c({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:n,y:i})},c.prototype.getAncestorCoordinates=function(e){if(o.A.typeOf.number("offsetLevels",e),e<0)throw new r.A("offsetLevels must be non-negative");if(e>this.level)throw new r.A("ancestor cannot be above the tileset root");const t=1<<e,n=this.level-e,i=Math.floor(this.x/t),s=Math.floor(this.y/t);if(this.subdivisionScheme===a.A.OCTREE){const e=Math.floor(this.z/t);return new c({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:n,x:i,y:s,z:e})}return new c({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:n,x:i,y:s})},c.prototype.getOffsetCoordinates=function(e){if(o.A.typeOf.object("descendantCoordinates",e),!this.isEqual(e)&&!this.isAncestor(e))throw new r.A("this is not an ancestor of descendant");l(this,e);const t=e.level-this.level,n=1<<t,i=e.x%n,s=e.y%n;if(this.subdivisionScheme===a.A.OCTREE){const o=e.z%n;return new c({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:i,y:s,z:o})}return new c({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:i,y:s})},c.prototype.getChildCoordinates=function(e){o.A.typeOf.number("childIndex",e);const t=a.A.getBranchingFactor(this.subdivisionScheme);if(e<0||t<=e)throw new r.A(`childIndex must be at least 0 and less than ${t}`);const n=this.level+1,i=2*this.x+e%2,s=2*this.y+Math.floor(e/2)%2;if(this.subdivisionScheme===a.A.OCTREE){const t=2*this.z+Math.floor(e/4)%2;return new c({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:n,x:i,y:s,z:t})}return new c({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:n,x:i,y:s})},c.prototype.getSubtreeCoordinates=function(){return this.getAncestorCoordinates(this.level%this.subtreeLevels)},c.prototype.getParentSubtreeCoordinates=function(){return this.getAncestorCoordinates(this.level%this.subtreeLevels+this.subtreeLevels)},c.prototype.isAncestor=function(e){o.A.typeOf.object("descendantCoordinates",e),l(this,e);const t=e.level-this.level;if(t<=0)return!1;const n=e.x>>t,i=e.y>>t,r=this.x===n,s=this.y===i;if(this.subdivisionScheme===a.A.OCTREE){const n=e.z>>t,i=this.z===n;return r&&s&&i}return r&&s},c.prototype.isEqual=function(e){return o.A.typeOf.object("otherCoordinates",e),this.subdivisionScheme===e.subdivisionScheme&&this.subtreeLevels===e.subtreeLevels&&this.level===e.level&&this.x===e.x&&this.y===e.y&&(this.subdivisionScheme!==a.A.OCTREE||this.z===e.z)},c.prototype.isImplicitTilesetRoot=function(){return 0===this.level},c.prototype.isSubtreeRoot=function(){return this.level%this.subtreeLevels===0},c.prototype.isBottomOfSubtree=function(){return this.level%this.subtreeLevels===this.subtreeLevels-1},c.prototype.getTemplateValues=function(){const e={level:this.level,x:this.x,y:this.y};return this.subdivisionScheme===a.A.OCTREE&&(e.z=this.z),e};const u=[0,0,0];c.fromMortonIndex=function(e,t,n,i){let o;return e===a.A.OCTREE?(o=s.A.decode3D(i,u),new c({subdivisionScheme:e,subtreeLevels:t,level:n,x:o[0],y:o[1],z:o[2]})):(o=s.A.decode2D(i,u),new c({subdivisionScheme:e,subtreeLevels:t,level:n,x:o[0],y:o[1]}))},c.fromTileIndex=function(e,t,n){let o,r,s;return e===a.A.OCTREE?(o=Math.floor(i.A.log2(7*n+1)/3),r=((1<<3*o)-1)/7,s=n-r):(o=Math.floor(i.A.log2(3*n+1)/2),r=((1<<2*o)-1)/3,s=n-r),c.fromMortonIndex(e,t,o,s)};const d=c},834957:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(369031),o=n(376758),r=n(491446),s=n(744603),a=n(123245),c=n(800859),l=n(586067);const u=function(e,t,n){const u=(0,c.A)(t,"3DTILES_implicit_tiling")?t.extensions["3DTILES_implicit_tiling"]:t.implicitTiling;i.A.typeOf.object("implicitTiling",u),this.baseResource=e,this.geometricError=t.geometricError,this.metadataSchema=n;const d=t.boundingVolume;if(!((0,r.A)(d.box)||(0,r.A)(d.region)||(0,c.A)(d,"3DTILES_bounding_volume_S2")||(0,c.A)(d,"3DTILES_bounding_volume_cylinder")))throw new a.A("Only box, region, 3DTILES_bounding_volume_S2, and 3DTILES_bounding_volume_cylinder are supported for implicit tiling");this.boundingVolume=d,this.refine=t.refine,this.subtreeUriTemplate=new s.A({url:u.subtrees.uri}),this.contentUriTemplates=[],this.contentHeaders=[];const h=function(e){if((0,c.A)(e,"3DTILES_multiple_contents")){const t=e.extensions["3DTILES_multiple_contents"];return(0,r.A)(t.contents)?t.contents:t.content}return(0,r.A)(e.contents)?e.contents:(0,r.A)(e.content)?[e.content]:[]}(t);for(let e=0;e<h.length;e++){const t=h[e];this.contentHeaders.push((0,o.A)(t,!0));const n=new s.A({url:t.uri});this.contentUriTemplates.push(n)}this.contentCount=this.contentHeaders.length,this.tileHeader=function(e){const t=(0,o.A)(e,!0);return(0,r.A)(t.extensions)&&(delete t.extensions["3DTILES_implicit_tiling"],delete t.extensions["3DTILES_multiple_contents"],0===Object.keys(t.extensions).length&&delete t.extensions),delete t.implicitTiling,delete t.contents,delete t.content,t}(t),this.subdivisionScheme=l.A[u.subdivisionScheme],this.branchingFactor=l.A.getBranchingFactor(this.subdivisionScheme),this.subtreeLevels=u.subtreeLevels,(0,r.A)(u.availableLevels)?this.availableLevels=u.availableLevels:this.availableLevels=u.maximumLevel+1}},866857:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(369031);const o={TRANSLATION:"TRANSLATION",ROTATION:"ROTATION",SCALE:"SCALE",FEATURE_ID:"_FEATURE_ID",fromGltfSemantic:function(e){i.A.typeOf.string("gltfSemantic",e);let t=e;const n=/^(\w+)_\d+$/.exec(e);switch(null!==n&&(t=n[1]),t){case"TRANSLATION":return o.TRANSLATION;case"ROTATION":return o.ROTATION;case"SCALE":return o.SCALE;case"_FEATURE_ID":return o.FEATURE_ID}}},r=Object.freeze(o)},670549:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var i=n(369031),o=n(915325),r=n(491446),s=n(955943),a=n(954865),c=n(123245),l=n(531573),u=n(886626),d=n(829670),h=n(38300),A=n(847072),p=n(556541),f=n(66458),m=n(762270),g=n(32706);const _={ARCGIS_MAPSERVER:l.A.fromUrl,BING:async(e,t)=>u.A.fromUrl(e,t),GOOGLE_EARTH:async(e,t)=>{const n=t.channel;return delete t.channel,h.A.fromUrl(e,n,t)},MAPBOX:(e,t)=>new A.A({url:e,...t}),SINGLE_TILE:p.A.fromUrl,TMS:d.A.fromUrl,URL_TEMPLATE:(e,t)=>new f.A({url:e,...t}),WMS:(e,t)=>new m.A({url:e,...t}),WMTS:(e,t)=>new g.A({url:e,...t})};function y(e){e=e??o.A.EMPTY_OBJECT,this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tileCredits=void 0,this._errorEvent=new s.A}Object.defineProperties(y.prototype,{rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}},proxy:{get:function(){}}}),y.fromAssetId=async function(e,t){i.A.typeOf.number("assetId",e),t=t??o.A.EMPTY_OBJECT;const n=a.A._createEndpointResource(e,t),s=e.toString()+t.accessToken+t.server;let l=y._endpointCache[s];(0,r.A)(l)||(l=n.fetchJson(),y._endpointCache[s]=l);const u=await l;if("IMAGERY"!==u.type)throw new c.A(`Cesium ion asset ${e} is not an imagery asset.`);let h;const A=u.externalType;if((0,r.A)(A)){const e=_[A];if(!(0,r.A)(e))throw new c.A(`Unrecognized Cesium ion imagery type: ${A}`);const t={...u.options},n=t.url;delete t.url,h=await e(n,t)}else h=await d.A.fromUrl(new a.A(u,n));const p=new y(t);return h.errorEvent.addEventListener(function(e){e.provider=p,p._errorEvent.raiseEvent(e)}),p._tileCredits=a.A.getCreditsFromEndpoint(u,n),p._imageryProvider=h,p},y.prototype.getTileCredits=function(e,t,n){const i=this._imageryProvider.getTileCredits(e,t,n);return(0,r.A)(i)?this._tileCredits.concat(i):this._tileCredits},y.prototype.requestImage=function(e,t,n,i){return this._imageryProvider.requestImage(e,t,n,i)},y.prototype.pickFeatures=function(e,t,n,i,o){return this._imageryProvider.pickFeatures(e,t,n,i,o)},y._endpointCache={};const v=y},231097:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({AERIAL:2,AERIAL_WITH_LABELS:3,ROAD:4})},666203:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({TEXTURE:0,PROGRAM:1,BUFFER:2,NUMBER_OF_JOB_TYPES:3})},784749:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(369031),o=n(376758),r=n(491446),s=n(605971),a=n(965976);const c={};function l(e){i.A.typeOf.number.greaterThan("options.count",e.count,0),i.A.typeOf.object("options.properties",e.properties),this._count=e.count,this._properties=(0,o.A)(e.properties,!0)}l.prototype.hasProperty=function(e){return a.A.hasProperty(e,this._properties,c)},l.prototype.getPropertyIds=function(e){return a.A.getPropertyIds(this._properties,c,e)},l.prototype.getProperty=function(e,t){if(i.A.typeOf.number("index",e),i.A.typeOf.string("propertyId",t),e<0||e>=this._count)throw new s.A(`index must be in the range [0, ${this._count})`);const n=this._properties[t];if((0,r.A)(n))return(0,o.A)(n[e],!0)},l.prototype.setProperty=function(e,t,n){if(i.A.typeOf.number("index",e),i.A.typeOf.string("propertyId",t),e<0||e>=this._count)throw new s.A(`index must be in the range [0, ${this._count})`);let a=this._properties[t];(0,r.A)(a)||(a=new Array(this._count),this._properties[t]=a),a[e]=(0,o.A)(n,!0)};const u=l},847072:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var i=n(607502),o=n(915325),r=n(491446),s=n(605971),a=n(744603),c=n(66458);const l=/\/$/,u=new i.A('&copy; <a href="https://www.mapbox.com/about/maps/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/">Improve this map</a></strong>');function d(e){const t=(e=e??o.A.EMPTY_OBJECT).mapId;if(!(0,r.A)(t))throw new s.A("options.mapId is required.");const n=e.accessToken;if(!(0,r.A)(n))throw new s.A("options.accessToken is required.");this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0;const d=a.A.createIfNeeded(e.url??"https://{s}.tiles.mapbox.com/v4/");this._mapId=t,this._accessToken=n;let h=e.format??"png";/\./.test(h)||(h=`.${h}`),this._format=h;let A,p=d.getUrlComponent();l.test(p)||(p+="/"),p+=`${t}/{z}/{x}/{y}${this._format}`,d.url=p,d.setQueryParameters({access_token:n}),(0,r.A)(e.credit)?(A=e.credit,"string"==typeof A&&(A=new i.A(A))):A=u,this._resource=d,this._imageryProvider=new c.A({url:d,credit:A,ellipsoid:e.ellipsoid,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,rectangle:e.rectangle})}Object.defineProperties(d.prototype,{url:{get:function(){return this._imageryProvider.url}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}}),d.prototype.getTileCredits=function(e,t,n){},d.prototype.requestImage=function(e,t,n,i){return this._imageryProvider.requestImage(e,t,n,i)},d.prototype.pickFeatures=function(e,t,n,i,o){return this._imageryProvider.pickFeatures(e,t,n,i,o)},d._defaultCredit=u;const h=d},551549:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var i=n(915325),o=n(491446),r=n(769534),s=n(301005),a=n(980509),c=n(291192),l=n(149800),u=n(64137),d=n(373785),h=n(207828),A=n(608191);function p(e){const t=(e=e??i.A.EMPTY_OBJECT).translucent??!0,n=e.closed??!1,r=e.materialSupport??p.MaterialSupport.TEXTURED;this.material=(0,o.A)(e.material)?e.material:A.A.fromType(A.A.ColorType),this.translucent=t,this._vertexShaderSource=e.vertexShaderSource??r.vertexShaderSource,this._fragmentShaderSource=e.fragmentShaderSource??r.fragmentShaderSource,this._renderState=h.A.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._materialSupport=r,this._vertexFormat=r.vertexFormat,this._flat=e.flat??!1,this._faceForward=e.faceForward??!n}Object.defineProperties(p.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},materialSupport:{get:function(){return this._materialSupport}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}}),p.prototype.getFragmentShaderSource=h.A.prototype.getFragmentShaderSource,p.prototype.isTranslucent=h.A.prototype.isTranslucent,p.prototype.getRenderState=h.A.prototype.getRenderState,p.MaterialSupport={BASIC:Object.freeze({vertexFormat:r.A.POSITION_AND_NORMAL,vertexShaderSource:l.A,fragmentShaderSource:c.A}),TEXTURED:Object.freeze({vertexFormat:r.A.POSITION_NORMAL_AND_ST,vertexShaderSource:d.A,fragmentShaderSource:u.A}),ALL:Object.freeze({vertexFormat:r.A.ALL,vertexShaderSource:a.A,fragmentShaderSource:s.A})};const f=p},32335:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(369031),o=n(376758),r=n(915325),s=n(491446),a=n(343674);function c(e){const t=(e=e??r.A.EMPTY_OBJECT).id;i.A.typeOf.string("options.id",t);const n=e.properties??{},a={};for(const e in n)if(n.hasOwnProperty(e)){const t=n[e];(0,s.A)(t.semantic)&&(a[t.semantic]=t)}this._id=t,this._name=e.name,this._description=e.description,this._properties=n,this._propertiesBySemantic=a,this._extras=(0,o.A)(e.extras,!0),this._extensions=(0,o.A)(e.extensions,!0)}c.fromJson=function(e){const t=(e=e??r.A.EMPTY_OBJECT).id,n=e.class;i.A.typeOf.string("options.id",t),i.A.typeOf.object("options.class",n);const o={};for(const t in n.properties)if(n.properties.hasOwnProperty(t)){const i=a.A.fromJson({id:t,property:n.properties[t],enums:e.enums});o[t]=i}return new c({id:t,name:n.name,description:n.description,properties:o,extras:n.extras,extensions:n.extensions})},Object.defineProperties(c.prototype,{properties:{get:function(){return this._properties}},propertiesBySemantic:{get:function(){return this._propertiesBySemantic}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),c.BATCH_TABLE_CLASS_NAME="_batchTable";const l=c},343674:(e,t,n)=>{"use strict";n.d(t,{A:()=>x});var i=n(434067),o=n(267980),r=n(626809),s=n(369031),a=n(376758),c=n(915325),l=n(491446),u=n(605971),d=n(463298),h=n(331185),A=n(584164),p=n(374607),f=n(568748);function m(e){const t=(e=e??c.A.EMPTY_OBJECT).id,n=e.type;s.A.typeOf.string("options.id",t),s.A.typeOf.string("options.type",n);const i=e.componentType,o=e.enumType,r=(0,l.A)(i)&&f.A.isIntegerType(i)&&(e.normalized??!1);this._id=t,this._name=e.name,this._description=e.description,this._semantic=e.semantic,this._isLegacyExtension=e.isLegacyExtension,this._type=n,this._componentType=i,this._enumType=o,this._valueType=(0,l.A)(o)?o.valueType:i,this._isArray=e.isArray??!1,this._isVariableLengthArray=e.isVariableLengthArray??!1,this._arrayLength=e.arrayLength,this._min=(0,a.A)(e.min,!0),this._max=(0,a.A)(e.max,!0),this._normalized=r;let u=(0,a.A)(e.offset,!0),d=(0,a.A)(e.scale,!0);const h=(0,l.A)(u)||(0,l.A)(d),A=!0;(0,l.A)(u)||(u=this.expandConstant(0,A)),(0,l.A)(d)||(d=this.expandConstant(1,A)),this._offset=u,this._scale=d,this._hasValueTransform=h,this._noData=(0,a.A)(e.noData,!0),this._default=(0,a.A)(e.default,!0),this._required=e.required??!0,this._extras=(0,a.A)(e.extras,!0),this._extensions=(0,a.A)(e.extensions,!0)}function g(e,t){if(!Array.isArray(e))return e===t;if(!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!g(e[n],t[n]))return!1;return!0}function _(e,t){const n=e._type,s=e._componentType,a=e._enumType,c=e._normalized;return p.A.isVectorType(n)?function(e,t,n){return f.A.isVectorCompatible(n)?t!==p.A.VEC2||e instanceof i.A?t!==p.A.VEC3||e instanceof o.A?t!==p.A.VEC4||e instanceof r.A?void 0:`vector value ${e} must be a Cartesian4`:`vector value ${e} must be a Cartesian3`:`vector value ${e} must be a Cartesian2`:`componentType ${n} is incompatible with vector type ${t}`}(t,n,s):p.A.isMatrixType(n)?function(e,t,n){return f.A.isVectorCompatible(n)?t!==p.A.MAT2||e instanceof d.A?t!==p.A.MAT3||e instanceof h.A?t!==p.A.MAT4||e instanceof A.A?void 0:`matrix value ${e} must be a Matrix4`:`matrix value ${e} must be a Matrix3`:`matrix value ${e} must be a Matrix2`:`componentType ${n} is incompatible with matrix type ${t}`}(t,n,s):n===p.A.STRING?function(e){if("string"!=typeof e)return y(e,p.A.STRING)}(t):n===p.A.BOOLEAN?function(e){if("boolean"!=typeof e)return y(e,p.A.BOOLEAN)}(t):n===p.A.ENUM?function(e,t){const n=typeof e;if((0,l.A)(t))return"string"===n&&(0,l.A)(t.valuesByName[e])?void 0:`value ${e} is not a valid enum name for ${t.id}`}(t,a):function(e,t,n){const i=typeof e;switch(t){case f.A.INT8:case f.A.UINT8:case f.A.INT16:case f.A.UINT16:case f.A.INT32:case f.A.UINT32:case f.A.FLOAT32:case f.A.FLOAT64:return"number"!==i?y(e,t):isFinite(e)?T(e,t,n):b(e,t);case f.A.INT64:case f.A.UINT64:return"number"!==i&&"bigint"!==i?y(e,t):"number"!==i||isFinite(e)?T(e,t,n):b(e,t)}}(t,s,c)}function y(e,t){return`value ${e} does not match type ${t}`}function v(e,t,n){let i=`value ${e} is out of range for type ${t}`;return n&&(i+=" (normalized)"),i}function T(e,t,n){return n?e<(f.A.isUnsignedIntegerType(t)?0:-1)||e>1?v(e,t,n):void 0:e<f.A.getMinimum(t)||e>f.A.getMaximum(t)?v(e,t,n):void 0}function b(e,t){return`value ${e} of type ${t} must be finite`}function w(e,t,n){if(!Array.isArray(e))return n(e,t);for(let i=0;i<e.length;i++)e[i]=w(e[i],t,n);return e}m.fromJson=function(e){const t=(e=e??c.A.EMPTY_OBJECT).id,n=e.property;s.A.typeOf.string("options.id",t),s.A.typeOf.object("options.property",n),s.A.typeOf.string("options.property.type",n.type);const i=function(e){if("ARRAY"===e.type)return!0;const t=e.type;return t!==p.A.SCALAR&&!p.A.isMatrixType(t)&&!p.A.isVectorType(t)&&(!!(0,l.A)(f.A[t])||!((0,l.A)(e.noData)||(0,l.A)(e.scale)||(0,l.A)(e.offset)||(0,l.A)(e.required)||(0,l.A)(e.count)||(0,l.A)(e.array))&&(!(0,l.A)(e.optional)&&void 0))}(n),o=function(e,t){const n=e.type,i=e.componentType,o="ARRAY"===n;let r,s,a,c;if(o?(r=!0,s=e.componentCount,a=!(0,l.A)(s)):e.array?(r=!0,s=e.count,a=!(0,l.A)(e.count)):(r=!1,s=void 0,a=!1),(0,l.A)(e.enumType)&&(c=t[e.enumType]),n===p.A.ENUM)return{type:n,componentType:void 0,enumType:c,valueType:c.valueType,isArray:r,isVariableLengthArray:a,arrayLength:s};if(o&&i===p.A.ENUM)return{type:i,componentType:void 0,enumType:c,valueType:c.valueType,isArray:r,isVariableLengthArray:a,arrayLength:s};if(n===p.A.SCALAR||p.A.isMatrixType(n)||p.A.isVectorType(n))return{type:n,componentType:i,enumType:void 0,valueType:i,isArray:r,isVariableLengthArray:a,arrayLength:s};if(n===p.A.BOOLEAN||n===p.A.STRING)return{type:n,componentType:void 0,enumType:void 0,valueType:void 0,isArray:r,isVariableLengthArray:a,arrayLength:s};if(o&&(i===p.A.BOOLEAN||i===p.A.STRING))return{type:i,componentType:void 0,enumType:void 0,valueType:void 0,isArray:r,isVariableLengthArray:a,arrayLength:s};if((0,l.A)(i)&&(0,l.A)(f.A[i]))return{type:p.A.SCALAR,componentType:i,enumType:void 0,valueType:i,isArray:r,isVariableLengthArray:a,arrayLength:s};if((0,l.A)(f.A[n]))return{type:p.A.SCALAR,componentType:n,enumType:void 0,valueType:n,isArray:r,isVariableLengthArray:a,arrayLength:s};throw new u.A(`unknown metadata type {type: ${n}, componentType: ${i})`)}(n,e.enums);let r;return r=!!(0,l.A)(i)&&(i?!(0,l.A)(n.optional)||!n.optional:n.required??!1),new m({id:t,type:o.type,componentType:o.componentType,enumType:o.enumType,isArray:o.isArray,isVariableLengthArray:o.isVariableLengthArray,arrayLength:o.arrayLength,normalized:n.normalized,min:n.min,max:n.max,offset:n.offset,scale:n.scale,noData:n.noData,default:n.default,required:r,name:n.name,description:n.description,semantic:n.semantic,extras:n.extras,extensions:n.extensions,isLegacyExtension:i})},Object.defineProperties(m.prototype,{id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},type:{get:function(){return this._type}},enumType:{get:function(){return this._enumType}},componentType:{get:function(){return this._componentType}},valueType:{get:function(){return this._valueType}},isArray:{get:function(){return this._isArray}},isVariableLengthArray:{get:function(){return this._isVariableLengthArray}},arrayLength:{get:function(){return this._arrayLength}},normalized:{get:function(){return this._normalized}},max:{get:function(){return this._max}},min:{get:function(){return this._min}},noData:{get:function(){return this._noData}},default:{get:function(){return this._default}},required:{get:function(){return this._required}},semantic:{get:function(){return this._semantic}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),m.prototype.normalize=function(e){return this._normalized?w(e,this._valueType,f.A.normalize):e},m.prototype.unnormalize=function(e){return this._normalized?w(e,this._valueType,f.A.unnormalize):e},m.prototype.applyValueTransform=function(e){return!this._hasValueTransform||this._isVariableLengthArray?e:m.valueTransformInPlace(e,this._offset,this._scale,f.A.applyValueTransform)},m.prototype.unapplyValueTransform=function(e){return!this._hasValueTransform||this._isVariableLengthArray?e:m.valueTransformInPlace(e,this._offset,this._scale,f.A.unapplyValueTransform)},m.prototype.expandConstant=function(e,t){t=t??!1;const n=this._isArray,i=this._arrayLength,o=p.A.getComponentCount(this._type),r=n&&o>1;if(!n&&1===o)return e;if(!n)return new Array(o).fill(e);if(!r)return new Array(i).fill(e);if(!t)return new Array(this._arrayLength*o).fill(e);const s=new Array(o).fill(e);return new Array(this._arrayLength).fill(s)},m.prototype.handleNoData=function(e){const t=this._noData;return(0,l.A)(t)&&g(e,t)?void 0:e},m.prototype.unpackVectorAndMatrixTypes=function(e,t){t=t??!1;const n=p.A.getMathType(this._type),i=this._isArray,o=p.A.getComponentCount(this._type),r=i&&o>1;return(0,l.A)(n)?t&&r?e.map(function(e){return n.unpack(e)}):i?n.unpackArray(e):n.unpack(e):e},m.prototype.packVectorAndMatrixTypes=function(e,t){t=t??!1;const n=p.A.getMathType(this._type),i=this._isArray,o=p.A.getComponentCount(this._type),r=i&&o>1;return(0,l.A)(n)?t&&r?e.map(function(e){return n.pack(e,[])}):i?n.packArray(e,[]):n.pack(e,[]):e},m.prototype.validate=function(e){if((0,l.A)(e)||!(0,l.A)(this._default))return this._required&&!(0,l.A)(e)?"required property must have a value":this._isArray?function(e,t){if(!Array.isArray(t))return`value ${t} must be an array`;const n=t.length;if(!e._isVariableLengthArray&&n!==e._arrayLength)return"Array length does not match property.arrayLength";for(let i=0;i<n;i++){const n=_(e,t[i]);if((0,l.A)(n))return n}}(this,e):_(this,e)},m.valueTransformInPlace=function(e,t,n,i){if(!Array.isArray(e))return i(e,t,n);for(let o=0;o<e.length;o++)e[o]=m.valueTransformInPlace(e[o],t[o],n[o],i);return e};const x=m},568748:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(367817),o=n(369031),r=n(571804),s=n(605971),a=n(520098);const c={INT8:"INT8",UINT8:"UINT8",INT16:"INT16",UINT16:"UINT16",INT32:"INT32",UINT32:"UINT32",INT64:"INT64",UINT64:"UINT64",FLOAT32:"FLOAT32",FLOAT64:"FLOAT64",getMinimum:function(e){switch(o.A.typeOf.string("type",e),e){case c.INT8:return-128;case c.UINT8:return 0;case c.INT16:return-32768;case c.UINT16:return 0;case c.INT32:return-2147483648;case c.UINT32:return 0;case c.INT64:return a.A.supportsBigInt()?BigInt("-9223372036854775808"):-Math.pow(2,63);case c.UINT64:return a.A.supportsBigInt()?BigInt(0):0;case c.FLOAT32:return-34028234663852886e22;case c.FLOAT64:return-Number.MAX_VALUE}},getMaximum:function(e){switch(o.A.typeOf.string("type",e),e){case c.INT8:return 127;case c.UINT8:return 255;case c.INT16:return 32767;case c.UINT16:return 65535;case c.INT32:return 2147483647;case c.UINT32:return 4294967295;case c.INT64:return a.A.supportsBigInt()?BigInt("9223372036854775807"):Math.pow(2,63)-1;case c.UINT64:return a.A.supportsBigInt()?BigInt("18446744073709551615"):Math.pow(2,64)-1;case c.FLOAT32:return 34028234663852886e22;case c.FLOAT64:return Number.MAX_VALUE}},isIntegerType:function(e){switch(o.A.typeOf.string("type",e),e){case c.INT8:case c.UINT8:case c.INT16:case c.UINT16:case c.INT32:case c.UINT32:case c.INT64:case c.UINT64:return!0;default:return!1}},isUnsignedIntegerType:function(e){switch(o.A.typeOf.string("type",e),e){case c.UINT8:case c.UINT16:case c.UINT32:case c.UINT64:return!0;default:return!1}},isVectorCompatible:function(e){switch(o.A.typeOf.string("type",e),e){case c.INT8:case c.UINT8:case c.INT16:case c.UINT16:case c.INT32:case c.UINT32:case c.FLOAT32:case c.FLOAT64:return!0;default:return!1}},normalize:function(e,t){if("number"!=typeof e&&"bigint"!=typeof e)throw new s.A("value must be a number or a BigInt");if(!c.isIntegerType(t))throw new s.A("type must be an integer type");return Math.max(Number(e)/Number(c.getMaximum(t)),-1)},unnormalize:function(e,t){if(o.A.typeOf.number("value",e),!c.isIntegerType(t))throw new s.A("type must be an integer type");const n=c.getMaximum(t),r=c.isUnsignedIntegerType(t)?0:-n;return e=i.A.sign(e)*Math.round(Math.abs(e)*Number(n)),t!==c.INT64&&t!==c.UINT64||!a.A.supportsBigInt()||(e=BigInt(e)),e>n?n:e<r?r:e},applyValueTransform:function(e,t,n){return n*e+t},unapplyValueTransform:function(e,t,n){return 0===n?0:(e-t)/n},getSizeInBytes:function(e){switch(o.A.typeOf.string("type",e),e){case c.INT8:case c.UINT8:return 1;case c.INT16:case c.UINT16:return 2;case c.INT32:case c.UINT32:return 4;case c.INT64:case c.UINT64:return 8;case c.FLOAT32:return 4;case c.FLOAT64:return 8}},fromComponentDatatype:function(e){switch(o.A.typeOf.number("componentDatatype",e),e){case r.A.BYTE:return c.INT8;case r.A.UNSIGNED_BYTE:return c.UINT8;case r.A.SHORT:return c.INT16;case r.A.UNSIGNED_SHORT:return c.UINT16;case r.A.INT:return c.INT32;case r.A.UNSIGNED_INT:return c.UINT32;case r.A.FLOAT:return c.FLOAT32;case r.A.DOUBLE:return c.FLOAT64}},toComponentDatatype:function(e){switch(o.A.typeOf.string("type",e),e){case c.INT8:return r.A.BYTE;case c.UINT8:return r.A.UNSIGNED_BYTE;case c.INT16:return r.A.SHORT;case c.UINT16:return r.A.UNSIGNED_SHORT;case c.INT32:return r.A.INT;case c.UINT32:return r.A.UNSIGNED_INT;case c.FLOAT32:return r.A.FLOAT;case c.FLOAT64:return r.A.DOUBLE}}},l=Object.freeze(c)},965976:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(369031),o=n(376758),r=n(491446),s=n(605971);function a(){}Object.defineProperties(a.prototype,{class:{get:function(){s.A.throwInstantiationError()}}}),a.prototype.hasProperty=function(e){s.A.throwInstantiationError()},a.prototype.hasPropertyBySemantic=function(e){s.A.throwInstantiationError()},a.prototype.getPropertyIds=function(e){s.A.throwInstantiationError()},a.prototype.getProperty=function(e){s.A.throwInstantiationError()},a.prototype.setProperty=function(e,t){s.A.throwInstantiationError()},a.prototype.getPropertyBySemantic=function(e){s.A.throwInstantiationError()},a.prototype.setPropertyBySemantic=function(e,t){s.A.throwInstantiationError()},a.hasProperty=function(e,t,n){if(i.A.typeOf.string("propertyId",e),i.A.typeOf.object("properties",t),i.A.typeOf.object("classDefinition",n),(0,r.A)(t[e]))return!0;const o=n.properties;if(!(0,r.A)(o))return!1;const s=o[e];return!(!(0,r.A)(s)||!(0,r.A)(s.default))},a.hasPropertyBySemantic=function(e,t,n){i.A.typeOf.string("semantic",e),i.A.typeOf.object("properties",t),i.A.typeOf.object("classDefinition",n);const o=n.propertiesBySemantic;if(!(0,r.A)(o))return!1;const s=o[e];return(0,r.A)(s)},a.getPropertyIds=function(e,t,n){i.A.typeOf.object("properties",e),i.A.typeOf.object("classDefinition",t),(n=(0,r.A)(n)?n:[]).length=0;for(const t in e)e.hasOwnProperty(t)&&(0,r.A)(e[t])&&n.push(t);const o=t.properties;if((0,r.A)(o))for(const t in o)o.hasOwnProperty(t)&&!(0,r.A)(e[t])&&(0,r.A)(o[t].default)&&n.push(t);return n},a.getProperty=function(e,t,n){if(i.A.typeOf.string("propertyId",e),i.A.typeOf.object("properties",t),i.A.typeOf.object("classDefinition",n),!(0,r.A)(n.properties[e]))throw new s.A(`Class definition missing property ${e}`);const a=n.properties[e];let c=t[e];Array.isArray(c)&&(c=c.slice());const l=!0;return c=a.handleNoData(c),!(0,r.A)(c)&&(0,r.A)(a.default)?(c=(0,o.A)(a.default,!0),a.unpackVectorAndMatrixTypes(c,l)):(0,r.A)(c)?(c=a.normalize(c),c=a.applyValueTransform(c),a.unpackVectorAndMatrixTypes(c,l)):void 0},a.setProperty=function(e,t,n,o){if(i.A.typeOf.string("propertyId",e),i.A.defined("value",t),i.A.typeOf.object("properties",n),i.A.typeOf.object("classDefinition",o),!(0,r.A)(n[e]))return!1;let s;Array.isArray(t)&&(t=t.slice());const a=o.properties;return(0,r.A)(a)&&(s=a[e]),(0,r.A)(s)&&(t=s.packVectorAndMatrixTypes(t,!0),t=s.unapplyValueTransform(t),t=s.unnormalize(t)),n[e]=t,!0},a.getPropertyBySemantic=function(e,t,n){i.A.typeOf.string("semantic",e),i.A.typeOf.object("properties",t),i.A.typeOf.object("classDefinition",n);const o=n.propertiesBySemantic;if(!(0,r.A)(o))return;const s=o[e];return(0,r.A)(s)?a.getProperty(s.id,t,n):void 0},a.setPropertyBySemantic=function(e,t,n,o){i.A.typeOf.string("semantic",e),i.A.defined("value",t),i.A.typeOf.object("properties",n),i.A.typeOf.object("classDefinition",o);const s=o.propertiesBySemantic;if(!(0,r.A)(s))return!1;const c=o.propertiesBySemantic[e];return!!(0,r.A)(c)&&a.setProperty(c.id,t,n,o)};const c=a},266262:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(369031),o=n(376758),r=n(915325),s=n(901717),a=n(568748);function c(e){const t=(e=e??r.A.EMPTY_OBJECT).id,n=e.values;i.A.typeOf.string("options.id",t),i.A.defined("options.values",n);const s={},c={},l=n.length;for(let e=0;e<l;++e){const t=n[e];s[t.value]=t.name,c[t.name]=t.value}const u=e.valueType??a.A.UINT16;this._values=n,this._namesByValue=s,this._valuesByName=c,this._valueType=u,this._id=t,this._name=e.name,this._description=e.description,this._extras=(0,o.A)(e.extras,!0),this._extensions=(0,o.A)(e.extensions,!0)}c.fromJson=function(e){const t=(e=e??r.A.EMPTY_OBJECT).id,n=e.enum;return i.A.typeOf.string("options.id",t),i.A.typeOf.object("options.enum",n),new c({id:t,values:n.values.map(function(e){return s.A.fromJson(e)}),valueType:a.A[n.valueType],name:n.name,description:n.description,extras:n.extras,extensions:n.extensions})},Object.defineProperties(c.prototype,{values:{get:function(){return this._values}},namesByValue:{get:function(){return this._namesByValue}},valuesByName:{get:function(){return this._valuesByName}},valueType:{get:function(){return this._valueType}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});const l=c},901717:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(369031),o=n(376758),r=n(915325);function s(e){const t=(e=e??r.A.EMPTY_OBJECT).value,n=e.name;i.A.typeOf.number("options.value",t),i.A.typeOf.string("options.name",n),this._value=t,this._name=n,this._description=e.description,this._extras=(0,o.A)(e.extras,!0),this._extensions=(0,o.A)(e.extensions,!0)}s.fromJson=function(e){return i.A.typeOf.object("value",e),new s({value:e.value,name:e.name,description:e.description,extras:e.extras,extensions:e.extensions})},Object.defineProperties(s.prototype,{value:{get:function(){return this._value}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});const a=s},4024:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(369031),o=n(376758),r=n(915325),s=n(491446),a=n(32335),c=n(266262);function l(e){const t=(e=e??r.A.EMPTY_OBJECT).classes??{},n=e.enums??{};this._classes=t,this._enums=n,this._id=e.id,this._name=e.name,this._description=e.description,this._version=e.version,this._extras=(0,o.A)(e.extras,!0),this._extensions=(0,o.A)(e.extensions,!0)}l.fromJson=function(e){i.A.typeOf.object("schema",e);const t={};if((0,s.A)(e.enums))for(const n in e.enums)e.enums.hasOwnProperty(n)&&(t[n]=c.A.fromJson({id:n,enum:e.enums[n]}));const n={};if((0,s.A)(e.classes))for(const i in e.classes)e.classes.hasOwnProperty(i)&&(n[i]=a.A.fromJson({id:i,class:e.classes[i],enums:t}));return new l({id:e.id,name:e.name,description:e.description,version:e.version,classes:n,enums:t,extras:e.extras,extensions:e.extensions})},Object.defineProperties(l.prototype,{classes:{get:function(){return this._classes}},enums:{get:function(){return this._enums}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},version:{get:function(){return this._version}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});const u=l},729295:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(915325),o=n(491446),r=n(605971),s=n(4024),a=n(569445),c=n(48660);function l(e){const t=(e=e??i.A.EMPTY_OBJECT).schema,n=e.resource,a=e.cacheKey;if((0,o.A)(t)===(0,o.A)(n))throw new r.A("One of options.schema and options.resource must be defined.");this._schema=(0,o.A)(t)?s.A.fromJson(t):void 0,this._resource=n,this._cacheKey=a,this._state=c.A.UNLOADED,this._promise=void 0}(0,o.A)(Object.create)&&(l.prototype=Object.create(a.A.prototype),l.prototype.constructor=l),Object.defineProperties(l.prototype,{cacheKey:{get:function(){return this._cacheKey}},schema:{get:function(){return this._schema}}}),l.prototype.load=async function(){return(0,o.A)(this._promise)?this._promise:(0,o.A)(this._schema)?(this._promise=Promise.resolve(this),this._promise):(this._promise=async function(e){const t=e._resource;e._state=c.A.LOADING;try{const n=await t.fetchJson();if(e.isDestroyed())return;return e._schema=s.A.fromJson(n),e._state=c.A.READY,e}catch(n){if(e.isDestroyed())return;e._state=c.A.FAILED;const i=`Failed to load schema: ${t.url}`;throw e.getError(i,n)}}(this),this._promise)},l.prototype.unload=function(){this._schema=void 0};const u=l},165955:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({ID:"ID",NAME:"NAME",DESCRIPTION:"DESCRIPTION",TILESET_TILE_COUNT:"TILESET_TILE_COUNT",TILE_BOUNDING_BOX:"TILE_BOUNDING_BOX",TILE_BOUNDING_REGION:"TILE_BOUNDING_REGION",TILE_BOUNDING_SPHERE:"TILE_BOUNDING_SPHERE",TILE_MINIMUM_HEIGHT:"TILE_MINIMUM_HEIGHT",TILE_MAXIMUM_HEIGHT:"TILE_MAXIMUM_HEIGHT",TILE_HORIZON_OCCLUSION_POINT:"TILE_HORIZON_OCCLUSION_POINT",TILE_GEOMETRIC_ERROR:"TILE_GEOMETRIC_ERROR",CONTENT_BOUNDING_BOX:"CONTENT_BOUNDING_BOX",CONTENT_BOUNDING_REGION:"CONTENT_BOUNDING_REGION",CONTENT_BOUNDING_SPHERE:"CONTENT_BOUNDING_SPHERE",CONTENT_MINIMUM_HEIGHT:"CONTENT_MINIMUM_HEIGHT",CONTENT_MAXIMUM_HEIGHT:"CONTENT_MAXIMUM_HEIGHT",CONTENT_HORIZON_OCCLUSION_POINT:"CONTENT_HORIZON_OCCLUSION_POINT"})},874403:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(369031),o=n(376758),r=n(915325),s=n(491446),a=n(965976),c=n(140182);function l(e){const t=(e=e??r.A.EMPTY_OBJECT).count,n=e.class;i.A.typeOf.number.greaterThan("options.count",t,0),i.A.typeOf.object("options.class",n);let o=0;const a={};if((0,s.A)(e.properties))for(const i in e.properties)if(e.properties.hasOwnProperty(i)){const r=new c.A({count:t,property:e.properties[i],classProperty:n.properties[i],bufferViews:e.bufferViews});a[i]=r,o+=r.byteLength}this._count=t,this._class=n,this._properties=a,this._byteLength=o}Object.defineProperties(l.prototype,{count:{get:function(){return this._count}},class:{get:function(){return this._class}},byteLength:{get:function(){return this._byteLength}}}),l.prototype.hasProperty=function(e){return a.A.hasProperty(e,this._properties,this._class)},l.prototype.hasPropertyBySemantic=function(e){return a.A.hasPropertyBySemantic(e,this._properties,this._class)},l.prototype.getPropertyIds=function(e){return a.A.getPropertyIds(this._properties,this._class,e)},l.prototype.getProperty=function(e,t){i.A.typeOf.string("propertyId",t);const n=this._properties[t];let r;return r=(0,s.A)(n)?n.get(e):function(e,t){const n=e.properties;if(!(0,s.A)(n))return;const i=n[t];if((0,s.A)(i)&&(0,s.A)(i.default)){let e=i.default;return i.isArray&&(e=(0,o.A)(e,!0)),e=i.normalize(e),i.unpackVectorAndMatrixTypes(e)}}(this._class,t),r},l.prototype.setProperty=function(e,t,n){i.A.typeOf.string("propertyId",t);const o=this._properties[t];return!!(0,s.A)(o)&&(o.set(e,n),!0)},l.prototype.getPropertyBySemantic=function(e,t){let n;i.A.typeOf.string("semantic",t);const o=this._class.propertiesBySemantic;if((0,s.A)(o)&&(n=o[t]),(0,s.A)(n))return this.getProperty(e,n.id)},l.prototype.setPropertyBySemantic=function(e,t,n){let o;i.A.typeOf.string("semantic",t);const r=this._class.propertiesBySemantic;return(0,s.A)(r)&&(o=r[t]),!!(0,s.A)(o)&&this.setProperty(e,o.id,n)},l.prototype.getPropertyTypedArray=function(e){i.A.typeOf.string("propertyId",e);const t=this._properties[e];if((0,s.A)(t))return t.getTypedArray()},l.prototype.getPropertyTypedArrayBySemantic=function(e){let t;i.A.typeOf.string("semantic",e);const n=this._class.propertiesBySemantic;if((0,s.A)(n)&&(t=n[e]),(0,s.A)(t))return this.getPropertyTypedArray(t.id)};const u=l},140182:(e,t,n)=>{"use strict";n.d(t,{A:()=>w});var i=n(369031),o=n(376758),r=n(571804),s=n(915325),a=n(491446),c=n(605971),l=n(520098),u=n(241839),d=n(983884),h=n(568748),A=n(343674),p=n(374607),f=n(702247);function m(e){const t=(e=e??s.A.EMPTY_OBJECT).count,n=e.property,o=e.classProperty,r=e.bufferViews;i.A.typeOf.number.greaterThan("options.count",t,0),i.A.typeOf.object("options.property",n),i.A.typeOf.object("options.classProperty",o),i.A.typeOf.object("options.bufferViews",r);const c=o.type,l=o.isArray,d=o.isVariableLengthArray;let A=o.valueType;const f=o.enumType,m=c===p.A.STRING,_=c===p.A.BOOLEAN;let y,v=0;if(d){let e=n.arrayOffsetType??n.offsetType;e=h.A[e]??h.A.UINT32,y=new b(r[n.arrayOffsets??n.arrayOffsetBufferView],e,t+1),v+=y.typedArray.byteLength}const T=p.A.getComponentCount(c);let w;w=d?y.get(t)-y.get(0):l?t*o.arrayLength:t;const x=T*w;let C,E;if(m){let e=n.stringOffsetType??n.offsetType;e=h.A[e]??h.A.UINT32,C=new b(r[n.stringOffsets??n.stringOffsetBufferView],e,x+1),v+=C.typedArray.byteLength}(m||_)&&(A=h.A.UINT8),E=m?C.get(x)-C.get(0):_?Math.ceil(x/8):x;const S=new b(r[n.values??n.bufferView],A,E);v+=S.typedArray.byteLength;let I=n.offset,P=n.scale;const D=o.hasValueTransform||(0,a.A)(I)||(0,a.A)(P);let O,R;I=I??o.offset,P=P??o.scale,I=g(I),P=g(P);const M=this;m?O=function(e){return function(e,t,n){const i=n.get(e),o=n.get(e+1)-i;return(0,u.A)(t.typedArray,i,o)}(e,M._values,M._stringOffsets)}:_?(O=function(e){return function(e,t){const n=e>>3,i=e%8;return 1==(t.typedArray[n]>>i&1)}(e,M._values)},R=function(e,t){!function(e,t,n){const i=e>>3,o=e%8;n?t.typedArray[i]|=1<<o:t.typedArray[i]&=~(1<<o)}(e,M._values,t)}):(0,a.A)(f)?(O=function(e){const t=M._values.get(e);return f.namesByValue[t]},R=function(e,t){const n=f.valuesByName[t];M._values.set(e,n)}):(O=function(e){return M._values.get(e)},R=function(e,t){M._values.set(e,t)}),this._arrayOffsets=y,this._stringOffsets=C,this._values=S,this._classProperty=o,this._count=t,this._vectorComponentCount=T,this._min=n.min,this._max=n.max,this._offset=I,this._scale=P,this._hasValueTransform=D,this._getValue=O,this._setValue=R,this._unpackedValues=void 0,this._extras=n.extras,this._extensions=n.extensions,this._byteLength=v}function g(e){if(!Array.isArray(e))return e;const t=[];for(let n=0;n<e.length;n++){const i=e[n];Array.isArray(i)?(0,f.A)(t,i):t.push(i)}return t}function _(e,t){const n=e._count;if(!(0,a.A)(t)||t<0||t>=n){const e=n-1;throw new c.A(`index is required and between zero and count - 1. Actual value: ${e}`)}}function y(e,t,n){let i,o;if(t.isVariableLengthArray){i=e._arrayOffsets.get(n),o=e._arrayOffsets.get(n+1)-i;const r=p.A.getComponentCount(t.type);i*=r,o*=r}else{const r=(t.arrayLength??1)*e._vectorComponentCount;i=n*r,o=r}const r=new Array(o);for(let t=0;t<o;t++)r[t]=e._getValue(i+t);return r}function v(e){if((0,a.A)(e._unpackedValues))return!1;const t=e._classProperty,n=t.type,i=t.valueType;return n===p.A.STRING||i===h.A.INT64&&!l.A.supportsBigInt64Array()||i===h.A.UINT64&&!l.A.supportsBigUint64Array()}function T(e){e._unpackedValues=function(e){const t=e._count,n=new Array(t),i=e._classProperty,o=i.isArray,r=i.type,s=p.A.getComponentCount(r);if(!o&&1===s){for(let i=0;i<t;++i)n[i]=e._getValue(i);return n}for(let o=0;o<t;o++)n[o]=y(e,i,o);return n}(e),e._arrayOffsets=void 0,e._stringOffsets=void 0,e._values=void 0}function b(e,t,n){const i=this;let o,s,c;if(t===h.A.INT64)l.A.supportsBigInt()?l.A.supportsBigInt64Array()?(o=new BigInt64Array(e.buffer,e.byteOffset,n),c=function(e,t){i.typedArray[e]=BigInt(t)}):(o=new Uint8Array(e.buffer,e.byteOffset,8*n),s=function(e){return function(e,t){const n=t.dataView,i=8*e;let o=BigInt(0);const r=(128&n.getUint8(i+7))>0;let s=!0;for(let e=0;e<8;++e){let t=n.getUint8(i+e);r&&(s?0!==t&&(t=255&~(t-1),s=!1):t=255&~t),o+=BigInt(t)*(BigInt(1)<<BigInt(8*e))}return r&&(o=-o),o}(e,i)}):((0,d.A)("INT64 type is not fully supported on this platform. Values greater than 2^53 - 1 or less than -(2^53 - 1) may lose precision when read."),o=new Uint8Array(e.buffer,e.byteOffset,8*n),s=function(e){return function(e,t){const n=t.dataView,i=8*e;let o=0;const r=(128&n.getUint8(i+7))>0;let s=!0;for(let e=0;e<8;++e){let t=n.getUint8(i+e);r&&(s?0!==t&&(t=255&~(t-1),s=!1):t=255&~t),o+=t*Math.pow(256,e)}return r&&(o=-o),o}(e,i)});else if(t===h.A.UINT64)l.A.supportsBigInt()?l.A.supportsBigUint64Array()?(o=new BigUint64Array(e.buffer,e.byteOffset,n),c=function(e,t){i.typedArray[e]=BigInt(t)}):(o=new Uint8Array(e.buffer,e.byteOffset,8*n),s=function(e){return function(e,t){const n=t.dataView,i=8*e,o=BigInt(n.getUint32(i,!0)),r=BigInt(n.getUint32(i+4,!0));return o+BigInt(4294967296)*r}(e,i)}):((0,d.A)("UINT64 type is not fully supported on this platform. Values greater than 2^53 - 1 may lose precision when read."),o=new Uint8Array(e.buffer,e.byteOffset,8*n),s=function(e){return function(e,t){const n=t.dataView,i=8*e;return n.getUint32(i,!0)+4294967296*n.getUint32(i+4,!0)}(e,i)});else{const s=function(e){switch(e){case h.A.INT8:return r.A.BYTE;case h.A.UINT8:return r.A.UNSIGNED_BYTE;case h.A.INT16:return r.A.SHORT;case h.A.UINT16:return r.A.UNSIGNED_SHORT;case h.A.INT32:return r.A.INT;case h.A.UINT32:return r.A.UNSIGNED_INT;case h.A.FLOAT32:return r.A.FLOAT;case h.A.FLOAT64:return r.A.DOUBLE}}(t);o=r.A.createArrayBufferView(s,e.buffer,e.byteOffset,n),c=function(e,t){i.typedArray[e]=t}}(0,a.A)(s)||(s=function(e){return i.typedArray[e]}),this.typedArray=o,this.dataView=new DataView(o.buffer,o.byteOffset),this.get=s,this.set=c,this._componentType=t}Object.defineProperties(m.prototype,{hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},byteLength:{get:function(){return this._byteLength}}}),m.prototype.get=function(e){_(this,e);let t=function(e,t){v(e)&&T(e);const n=e._classProperty,i=n.isArray,r=n.type,s=p.A.getComponentCount(r);if((0,a.A)(e._unpackedValues)){const n=e._unpackedValues[t];return i?(0,o.A)(n,!0):n}return i||1!==s?y(e,n,t):e._getValue(t)}(this,e);return t=this._classProperty.handleNoData(t),(0,a.A)(t)?(t=this._classProperty.normalize(t),t=function(e,t){const n=e._classProperty.isVariableLengthArray;return!e._hasValueTransform||n?t:A.A.valueTransformInPlace(t,e._offset,e._scale,h.A.applyValueTransform)}(this,t),this._classProperty.unpackVectorAndMatrixTypes(t)):(t=this._classProperty.default,this._classProperty.unpackVectorAndMatrixTypes(t))},m.prototype.set=function(e,t){const n=this._classProperty;i.A.defined("value",t),_(this,e);const r=n.validate(t);if((0,a.A)(r))throw new c.A(r);t=function(e,t){const n=e._classProperty.isVariableLengthArray;return!e._hasValueTransform||n?t:A.A.valueTransformInPlace(t,e._offset,e._scale,h.A.unapplyValueTransform)}(this,t=n.packVectorAndMatrixTypes(t)),function(e,t,n){(function(e,t,n){if(v(e))return!0;const i=e._arrayOffsets;return!(!(0,a.A)(i)||i.get(t+1)-i.get(t)===n.length)})(e,t,n)&&T(e);const i=e._classProperty,r=i.isArray,s=i.type,c=p.A.getComponentCount(s);if((0,a.A)(e._unpackedValues))return i.isArray&&(n=(0,o.A)(n,!0)),void(e._unpackedValues[t]=n);if(!r&&1===c)return void e._setValue(t,n);let l,u;if(i.isVariableLengthArray)l=e._arrayOffsets.get(t),u=e._arrayOffsets.get(t+1)-l;else{const n=(i.arrayLength??1)*e._vectorComponentCount;l=t*n,u=n}for(let t=0;t<u;++t)e._setValue(l+t,n[t])}(this,e,t=n.unnormalize(t))},m.prototype.getTypedArray=function(){if((0,a.A)(this._values))return this._values.typedArray};const w=m},374607:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var i=n(369031),o=n(434067),r=n(267980),s=n(626809),a=n(605971),c=n(463298),l=n(331185),u=n(584164);const d={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4",BOOLEAN:"BOOLEAN",STRING:"STRING",ENUM:"ENUM",isVectorType:function(e){switch(i.A.typeOf.string("type",e),e){case d.VEC2:case d.VEC3:case d.VEC4:return!0;default:return!1}},isMatrixType:function(e){switch(i.A.typeOf.string("type",e),e){case d.MAT2:case d.MAT3:case d.MAT4:return!0;default:return!1}},getComponentCount:function(e){switch(i.A.typeOf.string("type",e),e){case d.SCALAR:case d.STRING:case d.ENUM:case d.BOOLEAN:return 1;case d.VEC2:return 2;case d.VEC3:return 3;case d.VEC4:case d.MAT2:return 4;case d.MAT3:return 9;case d.MAT4:return 16;default:throw new a.A(`Invalid metadata type ${e}`)}},getMathType:function(e){switch(e){case d.VEC2:return o.A;case d.VEC3:return r.A;case d.VEC4:return s.A;case d.MAT2:return c.A;case d.MAT3:return l.A;case d.MAT4:return u.A;default:return}}},h=Object.freeze(d)},19120:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(491446),o=n(624512),r=n(200646),s=n(760866);const a={name:"AlphaPipelineStage",process:function(e,t,n){const a=e.alphaOptions,c=e.model;a.pass=a.pass??c.opaquePass;const l=e.renderStateOptions;a.pass===s.A.TRANSLUCENT&&(l.cull.enabled=!1,l.depthMask=!1,l.blending=r.A.ALPHA_BLEND);const u=e.shaderBuilder,d=e.uniformMap;(0,i.A)(a.alphaCutoff)&&(u.addDefine("ALPHA_MODE_MASK",void 0,o.A.FRAGMENT),u.addUniform("float","u_alphaCutoff",o.A.FRAGMENT),d.u_alphaCutoff=function(){return a.alphaCutoff})}}},538198:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(267980),o=n(367817),r=n(624512),s=n(50937),a=n(390249);const c={name:"AtmospherePipelineStage",process:function(e,t,n){const c=e.shaderBuilder;c.addDefine("HAS_ATMOSPHERE",void 0,r.A.BOTH),c.addDefine("COMPUTE_POSITION_WC_ATMOSPHERE",void 0,r.A.BOTH),c.addVarying("vec3","v_atmosphereRayleighColor"),c.addVarying("vec3","v_atmosphereMieColor"),c.addVarying("float","v_atmosphereOpacity"),c.addVertexLines([a.A]),c.addFragmentLines([s.A]),c.addUniform("bool","u_isInFog",r.A.FRAGMENT),e.uniformMap.u_isInFog=function(){const e=i.A.distance(n.camera.positionWC,t.boundingSphere.center);return o.A.fog(e,n.fog.density)>o.A.EPSILON3}}}},802227:(e,t,n)=>{"use strict";n.d(t,{A:()=>x});var i=n(320475),o=n(511517),r=n(267980),s=n(468741),a=n(369031),c=n(571804),l=n(915325),u=n(491446),d=n(590732),h=n(982504),A=n(584164),p=n(32335),f=n(995537),m=n(471147),g=n(115959),_=n(287659),y=n(569445),v=n(595826);const T=f.A.FeatureIdAttribute;function b(e){const t=(e=e??l.A.EMPTY_OBJECT).b3dmResource;let n=e.baseResource;const o=e.arrayBuffer,r=e.byteOffset??0,s=e.releaseGltfJson??!1,c=e.asynchronous??!0,d=e.incrementallyLoadTextures??!0,h=e.upAxis??i.A.Y,p=e.forwardAxis??i.A.X,f=e.loadAttributesAsTypedArray??!1,m=e.loadAttributesFor2D??!1,g=e.enablePick??!1,_=e.loadIndicesForWireframe??!1,y=e.loadPrimitiveOutline??!0,v=e.loadForClassification??!1;a.A.typeOf.object("options.b3dmResource",t),a.A.typeOf.object("options.arrayBuffer",o),n=(0,u.A)(n)?n:t.clone(),this._b3dmResource=t,this._baseResource=n,this._arrayBuffer=o,this._byteOffset=r,this._releaseGltfJson=s,this._asynchronous=c,this._incrementallyLoadTextures=d,this._upAxis=h,this._forwardAxis=p,this._loadAttributesAsTypedArray=f,this._loadAttributesFor2D=m,this._enablePick=g,this._loadIndicesForWireframe=_,this._loadPrimitiveOutline=y,this._loadForClassification=v,this._state=0,this._promise=void 0,this._gltfLoader=void 0,this._batchLength=0,this._propertyTable=void 0,this._batchTable=void 0,this._components=void 0,this._transform=A.A.IDENTITY}function w(e){const t=e.children.length;for(let n=0;n<t;n++)w(e.children[n]);const n=e.primitives.length;for(let t=0;t<n;t++){const n=e.primitives[t],i=m.A.getAttributeBySemantic(n,v.A.FEATURE_ID);if((0,u.A)(i)){i.setIndex=0;const e=new T;e.propertyTableId=0,e.setIndex=0,e.positionalLabel="featureId_0",n.featureIds.push(e)}}}(0,u.A)(Object.create)&&(b.prototype=Object.create(y.A.prototype),b.prototype.constructor=b),Object.defineProperties(b.prototype,{texturesLoaded:{get:function(){return this._gltfLoader?.texturesLoaded}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}}),b.prototype.load=function(){if((0,u.A)(this._promise))return this._promise;const e=o.A.parse(this._arrayBuffer,this._byteOffset);let t=e.batchLength;const n=e.featureTableJson,i=e.featureTableBinary,a=e.batchTableJson,l=e.batchTableBinary,d=new s.A(n,i);t=d.getGlobalProperty("BATCH_LENGTH"),this._batchLength=t;const p=d.getGlobalProperty("RTC_CENTER",c.A.FLOAT,3);(0,u.A)(p)&&(this._transform=A.A.fromTranslation(r.A.fromArray(p))),this._batchTable={json:a,binary:l};const f=new h.A({typedArray:e.gltf,upAxis:this._upAxis,forwardAxis:this._forwardAxis,gltfResource:this._b3dmResource,baseResource:this._baseResource,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAttributesAsTypedArray:this._loadAttributesAsTypedArray,loadAttributesFor2D:this._loadAttributesFor2D,enablePick:this._enablePick,loadIndicesForWireframe:this._loadIndicesForWireframe,loadPrimitiveOutline:this._loadPrimitiveOutline,loadForClassification:this._loadForClassification,renameBatchIdSemantic:!0});this._gltfLoader=f,this._state=1;const m=this;return this._promise=f.load().then(function(){if(!m.isDestroyed())return m._state=2,m}).catch(function(e){if(!m.isDestroyed())return function(e,t){e.unload(),e._state=4;return t=e.getError("Failed to load b3dm",t),Promise.reject(t)}(m,e)}),this._promise},b.prototype.process=function(e){if(a.A.typeOf.object("frameState",e),3===this._state)return!0;if(2!==this._state)return!1;if(!this._gltfLoader.process(e))return!1;const t=this._gltfLoader.components;return t.transform=A.A.multiplyTransformation(this._transform,t.transform,t.transform),function(e,t){const n=e._batchTable,i=e._batchLength;if(0===i)return;let o;if((0,u.A)(n.json))o=(0,g.A)({count:i,batchTable:n.json,binaryBody:n.binary});else{const e=new _.A({name:p.A.BATCH_TABLE_CLASS_NAME,count:i});o=new d.A({schema:{},propertyTables:[e]})}const r=t.scene.nodes,s=r.length;for(let e=0;e<s;e++)w(r[e]);t.structuralMetadata=o}(this,t),this._components=t,this._arrayBuffer=void 0,this._state=3,!0},b.prototype.unload=function(){(0,u.A)(this._gltfLoader)&&!this._gltfLoader.isDestroyed()&&this._gltfLoader.unload(),this._components=void 0,this._arrayBuffer=void 0};const x=b},186919:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(430346);const o={name:"BatchTexturePipelineStage",process:function(e,t,n){const o=e.shaderBuilder,r={},s=e.model,a=s.featureTables[s.featureTableId],c=a.featuresLength;o.addUniform("int","model_featuresLength"),r.model_featuresLength=function(){return c};const l=a.batchTexture;o.addUniform("sampler2D","model_batchTexture"),r.model_batchTexture=function(){return l.batchTexture??l.defaultTexture},o.addUniform("vec4","model_textureStep"),r.model_textureStep=function(){return l.textureStep},l.textureDimensions.y>1&&(o.addDefine("MULTILINE_BATCH_TEXTURE"),o.addUniform("vec2","model_textureDimensions"),r.model_textureDimensions=function(){return l.textureDimensions}),e.uniformMap=(0,i.A)(r,e.uniformMap)}}},212642:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(428027),o=n(726401),r=n(759889),s=n(491446),a=n(542614),c=n(760866),l=n(624512);const u={name:"CPUStylingPipelineStage",process:function(e,t,n){const u=e.model,d=e.shaderBuilder;d.addVertexLines(o.A),d.addFragmentLines(r.A),d.addDefine("USE_CPU_STYLING",void 0,l.A.BOTH),(0,s.A)(u.color)||(d.addUniform("float",a.A.COLOR_BLEND_UNIFORM_NAME,l.A.FRAGMENT),e.uniformMap[a.A.COLOR_BLEND_UNIFORM_NAME]=function(){return i.A.getColorBlend(u.colorBlendMode,u.colorBlendAmount)}),d.addUniform("bool","model_commandTranslucent",l.A.BOTH),e.uniformMap.model_commandTranslucent=function(){return e.alphaOptions.pass===c.A.TRANSLUCENT}}}},503631:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=class{constructor(e,t,n,i){this._minX=e??0,this._minY=t??0,this._maxX=n??0,this._maxY=i??0}get minX(){return this._minX}set minX(e){this._minX=e}get minY(){return this._minY}set minY(e){this._minY=e}get maxX(){return this._maxX}set maxX(e){this._maxX=e}get maxY(){return this._maxY}set maxY(e){this._maxY=e}contains(e,t){return e>=this.minX&&e<this.maxX&&t>=this.minY&&t<this.maxY}containsExclusive(e,t){return e>this.minX&&e<this.maxX&&t>this.minY&&t<this.maxY}containsInclusive(e,t){return e>=this.minX&&e<=this.maxX&&t>=this.minY&&t<=this.maxY}}},899700:(e,t,n)=>{"use strict";n.d(t,{A:()=>E});var i=n(702247),o=n(660662),r=n(369031),s=n(915325),a=n(584164),c=n(377496),l=n(760866),u=n(40118),d=n(200646),h=n(71578),A=n(523721),p=n(938987),f=n(896464),m=n(138151);function g(e){const t=(e=e??s.A.EMPTY_OBJECT).command,n=e.primitiveRenderResources;r.A.typeOf.object("options.command",t),r.A.typeOf.object("options.primitiveRenderResources",n);const i=n.model;this._command=t,this._model=i,this._runtimePrimitive=n.runtimePrimitive,this._modelMatrix=t.modelMatrix,this._boundingVolume=t.boundingVolume,this._cullFace=t.renderState.cull.face;const o=i.classificationType;this._classificationType=o,this._classifiesTerrain=o!==h.A.CESIUM_3D_TILE,this._classifies3DTiles=o!==h.A.TERRAIN,this._useDebugWireframe=i._enableDebugWireframe&&i.debugWireframe,this._pickId=n.pickId,this._commandListTerrain=[],this._commandList3DTiles=[],this._commandListIgnoreShow=[],this._commandListDebugWireframe=[],this._commandListTerrainPicking=[],this._commandList3DTilesPicking=[],function(e){const t=e._command,n=v;if(e._useDebugWireframe){t.pass=l.A.OPAQUE,n.length=0,n.push(t),e._commandListDebugWireframe=T(e,n,e._commandListDebugWireframe);const i=e._commandListDebugWireframe,o=i.length;for(let e=0;e<o;e++){const t=i[e];t.count*=2,t.offset*=2}return}const i=e.model.allowPicking;if(e._classifiesTerrain){const o=l.A.TERRAIN_CLASSIFICATION,r=b(t,o),s=w(t,o);n.length=0,n.push(r,s),e._commandListTerrain=T(e,n,e._commandListTerrain),i&&(e._commandListTerrainPicking=C(e,n,e._commandListTerrainPicking))}if(e._classifies3DTiles){const o=l.A.CESIUM_3D_TILE_CLASSIFICATION,r=b(t,o),s=w(t,o);n.length=0,n.push(r,s),e._commandList3DTiles=T(e,n,e._commandList3DTiles),i&&(e._commandList3DTilesPicking=C(e,n,e._commandList3DTilesPicking))}}(this)}const _={stencilTest:{enabled:!0,frontFunction:f.A.NOT_EQUAL,frontOperation:{fail:m.A.ZERO,zFail:m.A.ZERO,zPass:m.A.ZERO},backFunction:f.A.NOT_EQUAL,backOperation:{fail:m.A.ZERO,zFail:m.A.ZERO,zPass:m.A.ZERO},reference:0,mask:p.A.CLASSIFICATION_MASK},stencilMask:p.A.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:d.A.PRE_MULTIPLIED_ALPHA_BLEND},y={stencilTest:{enabled:!0,frontFunction:f.A.NOT_EQUAL,frontOperation:{fail:m.A.ZERO,zFail:m.A.ZERO,zPass:m.A.ZERO},backFunction:f.A.NOT_EQUAL,backOperation:{fail:m.A.ZERO,zFail:m.A.ZERO,zPass:m.A.ZERO},reference:0,mask:p.A.CLASSIFICATION_MASK},stencilMask:p.A.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1},v=[];function T(e,t,n){const i=e._runtimePrimitive,o=i.batchLengths,r=i.batchOffsets,s=o.length,a=t.length;for(let e=0;e<s;e++){const i=o[e],s=r[e];for(let e=0;e<a;e++){const o=t[e],r=c.A.shallowClone(o);r.count=i,r.offset=s,n.push(r)}}return n}function b(e,t){const n=c.A.shallowClone(e);n.cull=!1,n.pass=t;const i={colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:o=t===l.A.TERRAIN_CLASSIFICATION?f.A.ALWAYS:f.A.EQUAL,frontOperation:{fail:m.A.KEEP,zFail:m.A.DECREMENT_WRAP,zPass:m.A.KEEP},backFunction:o,backOperation:{fail:m.A.KEEP,zFail:m.A.INCREMENT_WRAP,zPass:m.A.KEEP},reference:p.A.CESIUM_3D_TILE_MASK,mask:p.A.CESIUM_3D_TILE_MASK},stencilMask:p.A.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:A.A.LESS_OR_EQUAL},depthMask:!1};var o;return n.renderState=u.A.fromCache(i),n}function w(e,t){const n=c.A.shallowClone(e);return n.cull=!1,n.pass=t,n.renderState=u.A.fromCache(_),n}const x=[];function C(e,t,n){const i=u.A.fromCache(y),o=t[0],r=t[1],s=c.A.shallowClone(o);s.cull=!0,s.pickOnly=!0;const a=c.A.shallowClone(r);a.cull=!0,a.pickOnly=!0,a.renderState=i,a.pickId=e._pickId;const l=x;return l.length=0,l.push(s,a),T(e,l,n)}Object.defineProperties(g.prototype,{command:{get:function(){return this._command}},runtimePrimitive:{get:function(){return this._runtimePrimitive}},batchLengths:{get:function(){return this._runtimePrimitive.batchLengths}},batchOffsets:{get:function(){return this._runtimePrimitive.batchOffsets}},model:{get:function(){return this._model}},classificationType:{get:function(){return this._classificationType}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=a.A.clone(e,this._modelMatrix);const t=this._runtimePrimitive.boundingSphere;this._boundingVolume=o.A.transform(t,this._modelMatrix,this._boundingVolume)}},boundingVolume:{get:function(){return this._boundingVolume}},cullFace:{get:function(){return this._cullFace},set:function(e){this._cullFace=e}}}),g.prototype.pushCommands=function(e,t){const n=e.passes;if(n.render){if(this._useDebugWireframe)return void(0,i.A)(t,this._commandListDebugWireframe);if(this._classifiesTerrain&&(0,i.A)(t,this._commandListTerrain),this._classifies3DTiles&&(0,i.A)(t,this._commandList3DTiles),e.invertClassification&&this._classifies3DTiles){if(0===this._commandListIgnoreShow.length){const e=l.A.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,t=b(this._command,e),n=v;n.length=0,n.push(t),this._commandListIgnoreShow=T(this,n,this._commandListIgnoreShow)}(0,i.A)(t,this._commandListIgnoreShow)}}return n.pick&&(this._classifiesTerrain&&(0,i.A)(t,this._commandListTerrainPicking),this._classifies3DTiles&&(0,i.A)(t,this._commandList3DTilesPicking)),t};const E=g},662274:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(491446),o=n(123245),r=n(624512),s=n(595826),a=n(471147);const c={name:"ClassificationPipelineStage",process:function(e,t,n){e.shaderBuilder.addDefine("HAS_CLASSIFICATION",void 0,r.A.BOTH);const c=e.runtimePrimitive;(0,i.A)(c.batchLengths)||function(e,t){const n=a.A.getAttributeBySemantic(e,s.A.POSITION);if(!(0,i.A)(n))throw new o.A("Primitives must have a position attribute to be used for classification.");let r;const c=e.indices,l=(0,i.A)(c);l&&(r=c.typedArray,c.typedArray=void 0);const u=l?c.count:n.count,d=a.A.getAttributeBySemantic(e,s.A.FEATURE_ID,0);if(!(0,i.A)(d))return t.batchLengths=[u],void(t.batchOffsets=[0]);const h=d.typedArray;d.typedArray=void 0;const A=[],p=[0];let f=h[l?r[0]:0],m=0;for(let e=1;e<u;e++){const t=h[l?r[e]:e];if(t!==f){const n=e-m,i=e;A.push(n),p.push(i),m=i,f=t}}const g=u-m;A.push(g),t.batchLengths=A,t.batchOffsets=p}(t,c)}},l=c},212525:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({MODIFY_MATERIAL:"MODIFY_MATERIAL",REPLACE_MATERIAL:"REPLACE_MATERIAL",getDefineName:function(e){return`CUSTOM_SHADER_${e}`}})},381508:(e,t,n)=>{"use strict";n.d(t,{A:()=>w});var i=n(430346),o=n(491446),r=n(983884),s=n(624512),a=n(760866),c=n(181163),l=n(58747),u=n(212525),d=n(598073),h=n(64389),A=n(471147),p=n(747680);const f={name:"CustomShaderPipelineStage",STRUCT_ID_ATTRIBUTES_VS:"AttributesVS",STRUCT_ID_ATTRIBUTES_FS:"AttributesFS",STRUCT_NAME_ATTRIBUTES:"Attributes",STRUCT_ID_VERTEX_INPUT:"VertexInput",STRUCT_NAME_VERTEX_INPUT:"VertexInput",STRUCT_ID_FRAGMENT_INPUT:"FragmentInput",STRUCT_NAME_FRAGMENT_INPUT:"FragmentInput",FUNCTION_ID_INITIALIZE_INPUT_STRUCT_VS:"initializeInputStructVS",FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_VS:"void initializeInputStruct(out VertexInput vsInput, ProcessedAttributes attributes)",FUNCTION_ID_INITIALIZE_INPUT_STRUCT_FS:"initializeInputStructFS",FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_FS:"void initializeInputStruct(out FragmentInput fsInput, ProcessedAttributes attributes)",_oneTimeWarning:r.A,process:function(e,t,n){const{shaderBuilder:r,model:m,alphaOptions:g}=e,{customShader:y}=m,{lightingModel:w,translucencyMode:x}=y;(0,o.A)(w)&&(e.lightingOptions.lightingModel=w),x===p.A.TRANSLUCENT?g.pass=a.A.TRANSLUCENT:x===p.A.OPAQUE&&(g.pass=void 0);const C=function(e,t){const n=function(e){const t={};for(let n=0;n<e.length;n++){const i=A.A.getAttributeInfo(e[n]);t[i.variableName]=i}return t}(t.attributes),i=function(e,t){if(!(0,o.A)(e.vertexShaderText))return{enabled:!1};const n=e.usedVariablesVertex.attributeSet,i=v(t,n,!1),r=T(t,n,!1);let s;const a=[],c=[];for(const e in i){if(!i.hasOwnProperty(e))continue;const t=[i[e].glslType,e];a.push(t),s=`vsInput.attributes.${e} = attributes.${e};`,c.push(s)}for(let e=0;e<r.length;e++){const t=r[e],n=_(t);if(!(0,o.A)(n))return f._oneTimeWarning("CustomShaderPipelineStage.incompatiblePrimitiveVS",`Primitive is missing attribute ${t}, disabling custom vertex shader`),{enabled:!1};a.push(n.attributeField),s=`vsInput.attributes.${t} = ${n.value};`,c.push(s)}return{enabled:!0,attributeFields:a,initializationLines:c}}(e,n),r=function(e,t){if(!(0,o.A)(e.fragmentShaderText))return{enabled:!1};const n=e.usedVariablesFragment.attributeSet,i=v(t,n,!0),r=T(t,n,!0);let s;const a=[],c=[];for(const e in i){if(!i.hasOwnProperty(e))continue;const t=[i[e].glslType,e];a.push(t),s=`fsInput.attributes.${e} = attributes.${e};`,c.push(s)}for(let e=0;e<r.length;e++){const t=r[e],n=_(t);if(!(0,o.A)(n))return f._oneTimeWarning("CustomShaderPipelineStage.incompatiblePrimitiveFS",`Primitive is missing attribute ${t}, disabling custom fragment shader.`),{enabled:!1};a.push(n.attributeField),s=`fsInput.attributes.${t} = ${n.value};`,c.push(s)}const l=function(e){const t=[],n=[],i=e.usedVariablesFragment.attributeSet;return i.hasOwnProperty("positionWC")&&(t.push(["vec3","positionWC"]),n.push("fsInput.attributes.positionWC = attributes.positionWC;")),i.hasOwnProperty("positionEC")&&(t.push(["vec3","positionEC"]),n.push("fsInput.attributes.positionEC = attributes.positionEC;")),{attributeFields:t,initializationLines:n}}(e);return{enabled:!0,attributeFields:a.concat(l.attributeFields),initializationLines:l.initializationLines.concat(c)}}(e,n),s=e.usedVariablesFragment.attributeSet.hasOwnProperty("positionWC")&&r.enabled;return{vertexLines:i,fragmentLines:r,customShaderEnabled:i.enabled||r.enabled,shouldComputePositionWC:s}}(y,t);if(!C.customShaderEnabled)return;if(function(e,t,n){const{vertexLines:i,fragmentLines:o}=n,r=b;i.enabled&&(function(e,t){let n=f.STRUCT_ID_ATTRIBUTES_VS;e.addStruct(n,f.STRUCT_NAME_ATTRIBUTES,s.A.VERTEX);const{attributeFields:i,initializationLines:o}=t;for(let t=0;t<i.length;t++){const[o,r]=i[t];e.addStructField(n,o,r)}n=f.STRUCT_ID_VERTEX_INPUT,e.addStruct(n,f.STRUCT_NAME_VERTEX_INPUT,s.A.VERTEX),e.addStructField(n,f.STRUCT_NAME_ATTRIBUTES,"attributes"),e.addStructField(n,d.A.STRUCT_NAME_FEATURE_IDS,"featureIds"),e.addStructField(n,h.A.STRUCT_NAME_METADATA,"metadata"),e.addStructField(n,h.A.STRUCT_NAME_METADATA_CLASS,"metadataClass"),e.addStructField(n,h.A.STRUCT_NAME_METADATA_STATISTICS,"metadataStatistics");const r=f.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_VS;e.addFunction(r,f.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_VS,s.A.VERTEX),e.addFunctionLines(r,o)}(e,i),r.length=0,r.push("#line 0",t.vertexShaderText,c.A),e.addVertexLines(r)),o.enabled&&(function(e,t){let n=f.STRUCT_ID_ATTRIBUTES_FS;e.addStruct(n,f.STRUCT_NAME_ATTRIBUTES,s.A.FRAGMENT);const{attributeFields:i,initializationLines:o}=t;for(let t=0;t<i.length;t++){const[o,r]=i[t];e.addStructField(n,o,r)}n=f.STRUCT_ID_FRAGMENT_INPUT,e.addStruct(n,f.STRUCT_NAME_FRAGMENT_INPUT,s.A.FRAGMENT),e.addStructField(n,f.STRUCT_NAME_ATTRIBUTES,"attributes"),e.addStructField(n,d.A.STRUCT_NAME_FEATURE_IDS,"featureIds"),e.addStructField(n,h.A.STRUCT_NAME_METADATA,"metadata"),e.addStructField(n,h.A.STRUCT_NAME_METADATA_CLASS,"metadataClass"),e.addStructField(n,h.A.STRUCT_NAME_METADATA_STATISTICS,"metadataStatistics");const r=f.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_FS;e.addFunction(r,f.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_FS,s.A.FRAGMENT),e.addFunctionLines(r,o)}(e,o),r.length=0,r.push("#line 0",t.fragmentShaderText,l.A),e.addFragmentLines(r))}(r,y,C),C.shouldComputePositionWC&&r.addDefine("COMPUTE_POSITION_WC_CUSTOM_SHADER",void 0,s.A.BOTH),(0,o.A)(y.vertexShaderText)&&r.addDefine("HAS_CUSTOM_VERTEX_SHADER",void 0,s.A.VERTEX),(0,o.A)(y.fragmentShaderText)){r.addDefine("HAS_CUSTOM_FRAGMENT_SHADER",void 0,s.A.FRAGMENT);const e=u.A.getDefineName(y.mode);r.addDefine(e,void 0,s.A.FRAGMENT)}const E=y.uniforms;for(const e in E)if(E.hasOwnProperty(e)){const t=E[e];r.addUniform(t.type,e)}const S=y.varyings;for(const e in S)if(S.hasOwnProperty(e)){const t=S[e];r.addVarying(t,e)}e.uniformMap=(0,i.A)(e.uniformMap,y.uniformMap)}},m={position:"vec3",normal:"vec3",tangent:"vec3",bitangent:"vec3",texCoord:"vec2",color:"vec4",joints:"ivec4",weights:"vec4"},g={position:"vec3(0.0)",normal:"vec3(0.0, 0.0, 1.0)",tangent:"vec3(1.0, 0.0, 0.0)",bitangent:"vec3(0.0, 1.0, 0.0)",texCoord:"vec2(0.0)",color:"vec4(1.0)",joints:"ivec4(0)",weights:"vec4(0.0)"};function _(e){let t=e.replace(/_[0-9]+$/,"");t=t.replace(/(MC|EC)$/,"");const n=m[t],i=g[t];if((0,o.A)(n))return{attributeField:[n,e],value:i}}const y={positionWC:!0,positionEC:!0};function v(e,t,n){const i={};for(const o in e){if(!e.hasOwnProperty(o))continue;const r=e[o];let s=o;n&&"normalMC"===o?s="normalEC":n&&"tangentMC"===o&&(s="tangentEC",r.glslType="vec3"),t.hasOwnProperty(s)&&(i[s]=r)}return i}function T(e,t,n){const i=[];for(const o in t){if(!t.hasOwnProperty(o))continue;if(y.hasOwnProperty(o))continue;let r=o;n&&"normalEC"===o?r="normalMC":n&&"tangentEC"===o&&(r="tangentMC"),e.hasOwnProperty(r)||i.push(o)}return i}const b=[],w=f},747680:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({INHERIT:0,OPAQUE:1,TRANSLUCENT:2})},13916:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var i=n(491446),o=n(626809),r=n(624512),s=n(471147),a=n(595826);const c={name:"DequantizationPipelineStage",FUNCTION_ID_DEQUANTIZATION_STAGE_VS:"dequantizationStage",FUNCTION_SIGNATURE_DEQUANTIZATION_STAGE_VS:"void dequantizationStage(inout ProcessedAttributes attributes)"};function l(e,t){const n=e.shaderBuilder,i=e.uniformMap,o=t.variableName,s=t.attribute.quantization;if(s.octEncoded){const e=`model_normalizationRange_${o}`;n.addUniform("float",e,r.A.VERTEX),i[e]=function(){return s.normalizationRange}}else{const e=`model_quantizedVolumeOffset_${o}`,a=`model_quantizedVolumeStepSize_${o}`,c=t.glslType;n.addUniform(c,e,r.A.VERTEX),n.addUniform(c,a,r.A.VERTEX);let l=s.quantizedVolumeOffset,d=s.quantizedVolumeStepSize;/^color_\d+$/.test(o)&&(l=u(l,0),d=u(d,1)),i[e]=function(){return l},i[a]=function(){return d}}}function u(e,t){return e instanceof o.A?e:new o.A(e.x,e.y,e.z,t)}function d(e,t){const n=t.variableName,i=t.attribute.quantization;let o;o=i.octEncoded?function(e,t){return`${`attributes.${e}`} = czm_octDecode(${`a_quantized_${e}`}, ${`model_normalizationRange_${e}`})${t.octEncodedZXY?".zxy":".xyz"};`}(n,i):function(e){return`${`attributes.${e}`} = ${`model_quantizedVolumeOffset_${e}`} + ${`a_quantized_${e}`} * ${`model_quantizedVolumeStepSize_${e}`};`}(n),e.addFunctionLines(c.FUNCTION_ID_DEQUANTIZATION_STAGE_VS,[o])}c.process=function(e,t,n){const o=e.shaderBuilder,u=e.model,h=(0,i.A)(u.classificationType);o.addDefine("USE_DEQUANTIZATION",void 0,r.A.VERTEX),o.addFunction(c.FUNCTION_ID_DEQUANTIZATION_STAGE_VS,c.FUNCTION_SIGNATURE_DEQUANTIZATION_STAGE_VS,r.A.VERTEX);const A=t.attributes;for(let t=0;t<A.length;t++){const n=A[t],r=n.quantization;if(!(0,i.A)(r))continue;const c=n.semantic===a.A.POSITION,u=n.semantic===a.A.TEXCOORD;if(h&&!c&&!u)continue;const p=s.A.getAttributeInfo(n);d(o,p),l(e,p)}};const h=c},593920:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(369031);function o(e){i.A.typeOf.object("options.position",e.position),i.A.typeOf.object("options.adjustmentParams",e.adjustmentParams),this._position=e.position,this._adjustmentParams=e.adjustmentParams}Object.defineProperties(o.prototype,{position:{get:function(){return this._position}},adjustmentParams:{get:function(){return this._adjustmentParams}}});const r=o},316923:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(369031);function o(e){i.A.typeOf.object("options.position",e.position),i.A.typeOf.object("options.adjustmentParams",e.adjustmentParams),i.A.typeOf.object("options.covarianceMatrix",e.covarianceMatrix),this._position=e.position,this._adjustmentParams=e.adjustmentParams,this._covarianceMatrix=e.covarianceMatrix}Object.defineProperties(o.prototype,{position:{get:function(){return this._position}},adjustmentParams:{get:function(){return this._adjustmentParams}},covarianceMatrix:{get:function(){return this._covarianceMatrix}}});const r=o},882209:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(369031);function o(e){i.A.typeOf.object("options.groupFlags",e.groupFlags),i.A.typeOf.object("options.rotationThetas",e.rotationThetas),i.A.typeOf.object("options.params",e.params),this._groupFlags=e.groupFlags,this._rotationThetas=e.rotationThetas,this._params=e.params}Object.defineProperties(o.prototype,{groupFlags:{get:function(){return this._groupFlags}},rotationThetas:{get:function(){return this._rotationThetas}},params:{get:function(){return this._params}}});const r=o},659282:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var i=n(267980),o=n(369031),r=n(331185),s=n(123245),a=n(593920),c=n(316923),l=n(882209),u=n(912726),d=n(453056),h=n(844833);function A(){}function p(e){return new r.A(e[0],e[1],e[3],e[1],e[2],e[4],e[3],e[4],e[5])}function f(e){const t=i.A.fromArray(e.position,0,new i.A),n=i.A.fromArray(e.adjustmentParams,0,new i.A);return new a.A({position:t,adjustmentParams:n})}function m(e){const t=i.A.fromArray(e.position,0,new i.A),n=i.A.fromArray(e.adjustmentParams,0,new i.A),o=p(e.covarianceMatrix);return new c.A({position:t,adjustmentParams:n,covarianceMatrix:o})}function g(e){const t=e.groupFlags,n=i.A.fromArray(e.rotationThetas,0,new i.A),o=[];for(const t of e.params){const e=new d.A({A:t.A,alpha:t.alpha,beta:t.beta,T:t.T});o.push(e)}return new l.A({groupFlags:t,rotationThetas:n,params:o})}A.load=function(e){o.A.typeOf.object("gltfGpmLocalJson",e);const t=e.storageType;if(t===h.A.Direct)return A.loadDirect(e);if(t===h.A.Indirect)return A.loadIndirect(e);throw new s.A(`Invalid storage type in NGA_gpm_local - expected 'Direct' or 'Indirect', but found ${t}`)},A.loadDirect=function(e){o.A.typeOf.object("gltfGpmLocalJson",e),o.A.typeOf.object("gltfGpmLocalJson.anchorPointsDirect",e.anchorPointsDirect),o.A.typeOf.object("gltfGpmLocalJson.covarianceDirectUpperTriangle",e.covarianceDirectUpperTriangle);const t=[],n=e.anchorPointsDirect;for(const e of n){const n=f(e);t.push(n)}const i=p(e.covarianceDirectUpperTriangle);return new u.A({storageType:h.A.Direct,anchorPointsDirect:t,covarianceDirect:i})},A.loadIndirect=function(e){o.A.typeOf.object("gltfGpmLocalJson",e),o.A.typeOf.object("gltfGpmLocalJson.anchorPointsIndirect",e.anchorPointsIndirect),o.A.typeOf.object("gltfGpmLocalJson.intraTileCorrelationGroups",e.intraTileCorrelationGroups);const t=[],n=e.anchorPointsIndirect;for(const e of n){const n=m(e);t.push(n)}const i=e.intraTileCorrelationGroups,r=[];for(const e of i){const t=g(e);r.push(t)}return new u.A({storageType:h.A.Indirect,anchorPointsIndirect:t,intraTileCorrelationGroups:r})};const _=A},912726:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(491446),o=n(369031),r=n(123245),s=n(844833);function a(e){if(o.A.typeOf.string("options.storageType",e.storageType),this._storageType=e.storageType,this._anchorPointsIndirect=e.anchorPointsIndirect,this._anchorPointsDirect=e.anchorPointsDirect,this._intraTileCorrelationGroups=e.intraTileCorrelationGroups,this._covarianceDirect=e.covarianceDirect,this.storageType===s.A.Indirect){if(!(0,i.A)(this.anchorPointsIndirect))throw new r.A("The anchorPointsIndirect are required for 'Indirect' storage");if(!(0,i.A)(this.intraTileCorrelationGroups))throw new r.A("The intraTileCorrelationGroups are required for 'Indirect' storage");if((0,i.A)(this.anchorPointsDirect))throw new r.A("The anchorPointsDirect must be omitted for 'Indirect' storage");if((0,i.A)(this.covarianceDirect))throw new r.A("The covarianceDirect must be omitted for 'Indirect' storage")}else{if(!(0,i.A)(this.anchorPointsDirect))throw new r.A("The anchorPointsDirect are required for 'Direct' storage");if(!(0,i.A)(this.covarianceDirect))throw new r.A("The covarianceDirect is required for 'Direct' storage");if((0,i.A)(this.anchorPointsIndirect))throw new r.A("The anchorPointsIndirect must be omitted for 'Direct' storage");if((0,i.A)(this.intraTileCorrelationGroups))throw new r.A("The intraTileCorrelationGroups must be omitted for 'Direct' storage")}}Object.defineProperties(a.prototype,{storageType:{get:function(){return this._storageType}},anchorPointsIndirect:{get:function(){return this._anchorPointsIndirect}},anchorPointsDirect:{get:function(){return this._anchorPointsDirect}},intraTileCorrelationGroups:{get:function(){return this._intraTileCorrelationGroups}},covarianceDirect:{get:function(){return this._covarianceDirect}}});const c=a},893828:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var i=n(369031),o=n(915325),r=n(491446),s=n(872182),a=n(569445),c=n(48660),l=n(105792),u=n(590732),d=n(4024),h=n(858288),A=n(714574),p=n(47367);function f(e){const t=(e=e??o.A.EMPTY_OBJECT).gltf,n=e.extension,r=e.gltfResource,s=e.baseResource,a=e.supportedImageFormats,l=e.frameState,u=e.cacheKey,d=e.asynchronous??!0;i.A.typeOf.object("options.gltf",t),i.A.typeOf.object("options.extension",n),i.A.typeOf.object("options.gltfResource",r),i.A.typeOf.object("options.baseResource",s),i.A.typeOf.object("options.supportedImageFormats",a),i.A.typeOf.object("options.frameState",l),this._gltfResource=r,this._baseResource=s,this._gltf=t,this._extension=n,this._supportedImageFormats=a,this._frameState=l,this._cacheKey=u,this._asynchronous=d,this._textureLoaders=[],this._textureIds=[],this._meshPrimitiveGpmLocal=void 0,this._structuralMetadata=void 0,this._state=c.A.UNLOADED,this._promise=void 0}(0,r.A)(Object.create)&&(f.prototype=Object.create(a.A.prototype),f.prototype.constructor=f),Object.defineProperties(f.prototype,{cacheKey:{get:function(){return this._cacheKey}},meshPrimitiveGpmLocal:{get:function(){return this._meshPrimitiveGpmLocal}},structuralMetadata:{get:function(){return this._structuralMetadata}}}),f.prototype._loadResources=async function(){try{const e=this._loadTextures();if(await e,this.isDestroyed())return;return this._gltf=void 0,this._state=c.A.LOADED,this}catch(e){if(this.isDestroyed())return;this.unload(),this._state=c.A.FAILED;const t="Failed to load GPM data";throw this.getError(t,e)}},f.prototype.load=function(){return(0,r.A)(this._promise)||(this._state=c.A.LOADING,this._promise=this._loadResources(this)),this._promise},f.prototype._loadTextures=function(){let e;(0,r.A)(this._extension)&&(e=function(e){const t={},n=e.ppeTextures;if((0,r.A)(n))for(let e=0;e<n.length;e++){const i=n[e];t[i.index]=i}return t}(this._extension));const t=this._gltf,n=this._gltfResource,i=this._baseResource,o=this._supportedImageFormats,a=this._frameState,c=this._asynchronous,l=[];for(const r in e)if(e.hasOwnProperty(r)){const u=s.A.getTextureLoader({gltf:t,textureInfo:e[r],gltfResource:n,baseResource:i,supportedImageFormats:o,frameState:a,asynchronous:c});this._textureLoaders.push(u),this._textureIds.push(r),l.push(u.load())}return Promise.all(l)},f.ppeTexturesMetadataSchemaCache=new Map,f._createPpeTextureClassJson=function(e,t){const n=e.traits,i=n.source,o=e.offset??0,r=255*(e.scale??1);return{name:`PPE texture class ${t}`,properties:{[i]:{name:"PPE",type:"SCALAR",componentType:"UINT8",normalized:!0,offset:o,scale:r,min:n.min,max:n.max}}}},f._obtainPpeTexturesMetadataSchema=function(e){const t=f._collectPpeTexturePropertyIdentifiers(e).toString();let n=f.ppeTexturesMetadataSchemaCache.get(t);if((0,r.A)(n))return n;const i={id:`PPE_TEXTURE_SCHEMA_${f.ppeTexturesMetadataSchemaCache.size}`,classes:{}},o=e.ppeTextures;for(let e=0;e<o.length;e++){const t=o[e],n=`ppeTexture_${e}`,r=f._createPpeTextureClassJson(t,e);i.classes[n]=r}return n=d.A.fromJson(i),f.ppeTexturesMetadataSchemaCache.set(t,n),n},f._collectPpeTexturePropertyIdentifiers=function(e){const t=[],n=e.ppeTextures;for(let e=0;e<n.length;e++){const i=n[e],o=f._createPpeTextureClassJson(i,e),r=JSON.stringify(o);t.push(r)}return t},f._convertToStructuralMetadata=function(e,t){const n=[],i=f._obtainPpeTexturesMetadataSchema(e),o=e.ppeTextures;for(let e=0;e<o.length;e++){const r=o[e],s=`ppeTexture_${e}`,a=r.traits.source,c=i.classes[s],u={class:s,properties:{[a]:{index:r.index,texCoord:r.texCoord}}};n.push(new l.A({id:e,name:r.name,propertyTexture:u,class:c,textures:t}))}return new u.A({schema:i,propertyTables:[],propertyTextures:n,propertyAttributes:[]})},f.prototype.process=function(e){if(i.A.typeOf.object("frameState",e),this._state===c.A.READY)return!0;if(this._state!==c.A.LOADED)return!1;const t=this._textureLoaders,n=t.length;let o=!0;for(let i=0;i<n;++i){const n=t[i].process(e);o=o&&n}if(!o)return!1;const s={};for(let e=0;e<this._textureIds.length;++e){const n=this._textureIds[e],i=t[e];i.isDestroyed()||(s[n]=i.texture)}const a=[],l=this._extension;if((0,r.A)(l.ppeTextures)){const e=l.ppeTextures;for(const t of e){const e=t.traits,n=new A.A({min:e.min,max:e.max,source:e.source}),i=new h.A({traits:n,noData:t.noData,offset:t.offset,scale:t.scale,index:t.index,texCoord:t.texCoord});a.push(i)}}const u=new p.A(a);this._meshPrimitiveGpmLocal=u;const d=f._convertToStructuralMetadata(u,s);return this._structuralMetadata=d,this._state=c.A.READY,!0},f.prototype._unloadTextures=function(){const e=this._textureLoaders,t=e.length;for(let n=0;n<t;++n)s.A.unload(e[n]);this._textureLoaders.length=0,this._textureIds.length=0},f.prototype.unload=function(){this._unloadTextures(),this._gltf=void 0,this._extension=void 0,this._structuralMetadata=void 0};const m=f},47367:(e,t,n)=>{"use strict";function i(e){this._ppeTextures=e}n.d(t,{A:()=>o}),Object.defineProperties(i.prototype,{ppeTextures:{get:function(){return this._ppeTextures}}});const o=i},714574:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(369031);function o(e){i.A.typeOf.string("options.source",e.source),this._min=e.min,this._max=e.max,this._source=e.source}Object.defineProperties(o.prototype,{min:{get:function(){return this._min}},max:{get:function(){return this._max}},source:{get:function(){return this._source}}});const r=o},858288:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(369031);function o(e){i.A.typeOf.object("options.traits",e.traits),i.A.typeOf.number.greaterThanOrEquals("options.index",e.index,0),this._traits=e.traits,this._noData=e.noData,this._offset=e.offset,this._scale=e.scale,this._index=e.index,this._texCoord=e.texCoord}Object.defineProperties(o.prototype,{traits:{get:function(){return this._traits}},noData:{get:function(){return this._noData}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},index:{get:function(){return this._index}},texCoord:{get:function(){return this._texCoord}}});const r=o},453056:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(369031);function o(e){i.A.typeOf.number.greaterThan("options.A",e.A,0),i.A.typeOf.number.lessThanOrEquals("options.A",e.A,1),i.A.typeOf.number.greaterThanOrEquals("options.alpha",e.alpha,0),i.A.typeOf.number.lessThan("options.alpha",e.alpha,1),i.A.typeOf.number.greaterThanOrEquals("options.beta",e.beta,0),i.A.typeOf.number.lessThanOrEquals("options.beta",e.beta,10),i.A.typeOf.number.greaterThan("options.T",e.T,0),this._A=e.A,this._alpha=e.alpha,this._beta=e.beta,this._T=e.T}Object.defineProperties(o.prototype,{A:{get:function(){return this._A}},alpha:{get:function(){return this._alpha}},beta:{get:function(){return this._beta}},T:{get:function(){return this._T}}});const r=o},844833:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({Direct:"Direct",Indirect:"Indirect"})},598073:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var i=n(571804),o=n(491446),r=n(624512),s=n(641613),a=n(442790),c=n(625322),l=n(204410),u=n(995537),d=n(595826),h=n(471147),A=n(331185);const p={name:"FeatureIdPipelineStage",STRUCT_ID_FEATURE_IDS_VS:"FeatureIdsVS",STRUCT_ID_FEATURE_IDS_FS:"FeatureIdsFS",STRUCT_NAME_FEATURE_IDS:"FeatureIds",FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS:"initializeFeatureIdsVS",FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS:"initializeFeatureIdsFS",FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS:"initializeFeatureIdAliasesVS",FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS:"initializeFeatureIdAliasesFS",FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS:"void initializeFeatureIds(out FeatureIds featureIds, ProcessedAttributes attributes)",FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES:"void initializeFeatureIdAliases(inout FeatureIds featureIds)",FUNCTION_ID_SET_FEATURE_ID_VARYINGS:"setFeatureIdVaryings",FUNCTION_SIGNATURE_SET_FEATURE_ID_VARYINGS:"void setFeatureIdVaryings()"};function f(e,t,n){const i=e.shaderBuilder;i.addStructField(p.STRUCT_ID_FEATURE_IDS_VS,"int",n),i.addStructField(p.STRUCT_ID_FEATURE_IDS_FS,"int",n);const o=t.setIndex,r=n.replace(/_\d+$/,"_"),s=`a_${r}${o}`,a=`v_${r}${o}`,c=`featureIds.${n} = int(czm_round(${s}));`,l=`featureIds.${n} = int(czm_round(${a}));`;i.addFunctionLines(p.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,[c]),i.addFunctionLines(p.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[l]),i.addVarying("float",a),i.addFunctionLines(p.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,[`${a} = ${s};`])}function m(e,t,n){const i=e.shaderBuilder;i.addStructField(p.STRUCT_ID_FEATURE_IDS_VS,"int",n),i.addStructField(p.STRUCT_ID_FEATURE_IDS_FS,"int",n);const o=t.setIndex,r=n.replace(/_\d+$/,"_"),s=[`featureIds.${n} = int(czm_round(attributes.${r}${o}));`];i.addFunctionLines(p.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,s),i.addFunctionLines(p.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,s)}function g(e,t,n,r,c,l){!function(e,t,n,r,c){const l=e.model;let u,d;if((0,o.A)(t.repeat)){const e=function(e,t){const n=e.offset,i=e.repeat,o=new Float32Array(t);for(let e=0;e<t;e++)o[e]=n+Math.floor(e/i);return o}(t,n);u=s.A.createVertexBuffer({context:c.context,typedArray:e,usage:a.A.STATIC_DRAW}),u.vertexArrayDestroyable=!1,l._pipelineResources.push(u);const i=!1;l.statistics.addBuffer(u,i)}else d=[t.offset];const h={index:e.attributeIndex++,instanceDivisor:r,value:d,vertexBuffer:u,normalize:!1,componentsPerAttribute:1,componentDatatype:i.A.FLOAT,strideInBytes:i.A.getSizeInBytes(i.A.FLOAT),offsetInBytes:0};e.attributes.push(h)}(e,t,r,c,l);const u=e.shaderBuilder,d=`a_implicit_${n}`;u.addAttribute("float",d);const h=`v_implicit_${n}`;u.addVarying("float",h),u.addStructField(p.STRUCT_ID_FEATURE_IDS_VS,"int",n),u.addStructField(p.STRUCT_ID_FEATURE_IDS_FS,"int",n),u.addFunctionLines(p.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,[`${h} = ${d};`]),u.addFunctionLines(p.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,[`featureIds.${n} = int(czm_round(${d}));`]),u.addFunctionLines(p.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[`featureIds.${n} = int(czm_round(${h}));`])}function _(e,t,n,i,s){const a=`u_featureIdTexture_${i}`,c=e.uniformMap,l=t.textureReader;c[a]=function(){return l.texture??s.context.defaultTexture};const u=l.channels,d=e.shaderBuilder;d.addStructField(p.STRUCT_ID_FEATURE_IDS_FS,"int",n),d.addUniform("sampler2D",a,r.A.FRAGMENT);const h=`v_texCoord_${l.texCoord}`;let f=h;const m=l.transform;if((0,o.A)(m)&&!A.A.equals(m,A.A.IDENTITY)){const e=`${a}Transform`;d.addUniform("mat3",e,r.A.FRAGMENT),c[e]=function(){return m},f=`vec2(${e} * vec3(${h}, 1.0))`}const g=`featureIds.${n} = czm_unpackUint(texture(${a}, ${f}).${u});`;d.addFunctionLines(p.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[g])}function y(e,t,n,i){const o=e.shaderBuilder,s=r.A.includesVertexShader(i);s&&o.addStructField(p.STRUCT_ID_FEATURE_IDS_VS,"int",n),o.addStructField(p.STRUCT_ID_FEATURE_IDS_FS,"int",n);const a=[`featureIds.${n} = featureIds.${t};`];s&&o.addFunctionLines(p.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS,a),o.addFunctionLines(p.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS,a)}p.process=function(e,t,n){const i=e.shaderBuilder;!function(e){e.addStruct(p.STRUCT_ID_FEATURE_IDS_VS,p.STRUCT_NAME_FEATURE_IDS,r.A.VERTEX),e.addStruct(p.STRUCT_ID_FEATURE_IDS_FS,p.STRUCT_NAME_FEATURE_IDS,r.A.FRAGMENT),e.addFunction(p.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,p.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS,r.A.VERTEX),e.addFunction(p.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,p.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS,r.A.FRAGMENT),e.addFunction(p.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS,p.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES,r.A.VERTEX),e.addFunction(p.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS,p.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES,r.A.FRAGMENT),e.addFunction(p.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,p.FUNCTION_SIGNATURE_SET_FEATURE_ID_VARYINGS,r.A.VERTEX)}(i);const s=e.runtimeNode.node.instances;(0,o.A)(s)&&function(e,t,n){const i=t.featureIds,s=t.attributes[0].count;for(let t=0;t<i.length;t++){const a=i[t],c=a.positionalLabel;a instanceof u.A.FeatureIdAttribute?f(e,a,c):g(e,a,c,s,1,n);const l=a.label;(0,o.A)(l)&&y(e,c,l,r.A.BOTH)}}(e,s,n),function(e,t,n){const i=t.featureIds,s=h.A.getAttributeBySemantic(t,d.A.POSITION).count;for(let t=0;t<i.length;t++){const a=i[t],c=a.positionalLabel;let l=r.A.BOTH;a instanceof u.A.FeatureIdAttribute?m(e,a,c):a instanceof u.A.FeatureIdImplicitRange?g(e,a,c,s,void 0,n):(_(e,a,c,t,n),l=r.A.FRAGMENT);const d=a.label;(0,o.A)(d)&&y(e,c,d,l)}}(e,t,n),i.addVertexLines(l.A),i.addFragmentLines(c.A)};const v=p},66502:(e,t,n)=>{"use strict";n.d(t,{A:()=>B});var i=n(267980),o=n(369031),r=n(571804),s=n(915325),a=n(491446),c=n(610750),l=n(874915),u=n(584164),d=n(402330),h=n(123245),A=n(543622),p=n(730839),f=n(784749),m=n(4024),g=n(995537),_=n(287659),y=n(569445),v=n(590732),T=n(595826),b=n(641613),w=n(442790),x=n(702247);function C(e){e=e??s.A.EMPTY_OBJECT,o.A.typeOf.object("options.geoJson",e.geoJson),this._geoJson=e.geoJson,this._components=void 0}function E(){this.lines=void 0,this.points=void 0,this.properties=void 0}function S(){this.features=[]}function I(e){const t=e[0],n=e[1],o=e[2]??0;return new i.A(t,n,o)}function P(e){const t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=I(e[i]);return[n]}function D(e){const t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=P(e[i])[0];return n}(0,a.A)(Object.create)&&(C.prototype=Object.create(y.A.prototype),C.prototype.constructor=C),Object.defineProperties(C.prototype,{cacheKey:{get:function(){}},components:{get:function(){return this._components}}}),C.prototype.load=function(){return Promise.resolve(this)},C.prototype.process=function(e){return o.A.typeOf.object("frameState",e),(0,a.A)(this._components)||(this._components=function(e,t){const n=new S,o=L[e.type];(0,a.A)(o)&&o(e,n);const y=n.features,x=y.length;if(0===x)throw new h.A("GeoJSON must have at least one feature");const C={};for(let e=0;e<x;e++){const t=y[e].properties??s.A.EMPTY_OBJECT;for(const e in t)t.hasOwnProperty(e)&&((0,a.A)(C[e])||(C[e]=new Array(x)))}for(let e=0;e<x;e++){const t=y[e];for(const n in C)if(C.hasOwnProperty(n)){const i=t.properties[n]??"";C[n][e]=i}}const E=new f.A({count:x,properties:C}),I=[new _.A({id:0,count:x,jsonMetadataTable:E})],P=m.A.fromJson({}),D=new v.A({schema:P,propertyTables:I}),O=new i.A(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),R=new i.A(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);let M=!1,B=!1;for(let e=0;e<x;e++){const t=y[e];if((0,a.A)(t.lines)){M=!0;const e=t.lines.length;for(let n=0;n<e;n++){const e=t.lines[n],o=e.length;for(let t=0;t<o;t++)i.A.minimumByComponent(O,e[t],O),i.A.maximumByComponent(R,e[t],R)}}if((0,a.A)(t.points)){B=!0;const e=t.points.length;for(let n=0;n<e;n++){const e=t.points[n];i.A.minimumByComponent(O,e,O),i.A.maximumByComponent(R,e,R)}}}const F=i.A.midpoint(O,R,new i.A),U=i.A.fromDegrees(F.x,F.y,F.z,c.A.WGS84,new i.A),k=A.A.eastNorthUpToFixedFrame(U,c.A.WGS84,new u.A),V=u.A.inverseTransformation(k,new u.A),z=[];M&&z.push(function(e,t,n){let o=0,s=0;const h=e.length;for(let t=0;t<h;t++){const n=e[t];if((0,a.A)(n.lines)){const e=n.lines.length;for(let t=0;t<e;t++){const e=n.lines[t];o+=e.length,s+=2*(e.length-1)}}}const A=new Float32Array(3*o),f=new Float32Array(o),m=l.A.createTypedArray(o,s),_=l.A.fromTypedArray(m),y=new i.A(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),v=new i.A(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);let x=0,C=0;for(let n=0;n<h;n++){const o=e[n];if(!(0,a.A)(o.lines))continue;const r=o.lines.length;for(let e=0;e<r;e++){const r=o.lines[e],s=r.length;for(let e=0;e<s;e++){const o=r[e],a=i.A.fromDegrees(o.x,o.y,o.z,c.A.WGS84,N),l=u.A.multiplyByPoint(t,a,N);i.A.minimumByComponent(y,l,y),i.A.maximumByComponent(v,l,v),i.A.pack(l,A,3*x),f[x]=n,e<s-1&&(m[2*C]=x,m[2*C+1]=x+1,C++),x++}}}const E=b.A.createVertexBuffer({typedArray:A,context:n.context,usage:w.A.STATIC_DRAW});E.vertexArrayDestroyable=!1;const S=b.A.createVertexBuffer({typedArray:f,context:n.context,usage:w.A.STATIC_DRAW});S.vertexArrayDestroyable=!1;const I=b.A.createIndexBuffer({typedArray:m,context:n.context,usage:w.A.STATIC_DRAW,indexDatatype:_});I.vertexArrayDestroyable=!1;const P=new g.A.Attribute;P.semantic=T.A.POSITION,P.componentDatatype=r.A.FLOAT,P.type=p.A.VEC3,P.count=o,P.min=y,P.max=v,P.buffer=E;const D=new g.A.Attribute;D.semantic=T.A.FEATURE_ID,D.setIndex=0,D.componentDatatype=r.A.FLOAT,D.type=p.A.SCALAR,D.count=o,D.buffer=S;const O=[P,D],R=new g.A.Material;R.unlit=!0;const M=new g.A.Indices;M.indexDatatype=_,M.count=m.length,M.buffer=I;const L=new g.A.FeatureIdAttribute;L.featureCount=h,L.propertyTableId=0,L.setIndex=0,L.positionalLabel="featureId_0";const B=[L],F=new g.A.Primitive;return F.attributes=O,F.indices=M,F.featureIds=B,F.primitiveType=d.A.LINES,F.material=R,F}(y,V,t)),B&&z.push(function(e,t,n){let o=0;const s=e.length;for(let t=0;t<s;t++){const n=e[t];(0,a.A)(n.points)&&(o+=n.points.length)}const l=new Float32Array(3*o),h=new Float32Array(o),A=new i.A(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),f=new i.A(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);let m=0;for(let n=0;n<s;n++){const o=e[n];if(!(0,a.A)(o.points))continue;const r=o.points.length;for(let e=0;e<r;e++){const r=o.points[e],s=i.A.fromDegrees(r.x,r.y,r.z,c.A.WGS84,N),a=u.A.multiplyByPoint(t,s,N);i.A.minimumByComponent(A,a,A),i.A.maximumByComponent(f,a,f),i.A.pack(a,l,3*m),h[m]=n,m++}}const _=b.A.createVertexBuffer({typedArray:l,context:n.context,usage:w.A.STATIC_DRAW});_.vertexArrayDestroyable=!1;const y=b.A.createVertexBuffer({typedArray:h,context:n.context,usage:w.A.STATIC_DRAW});y.vertexArrayDestroyable=!1;const v=new g.A.Attribute;v.semantic=T.A.POSITION,v.componentDatatype=r.A.FLOAT,v.type=p.A.VEC3,v.count=o,v.min=A,v.max=f,v.buffer=_;const x=new g.A.Attribute;x.semantic=T.A.FEATURE_ID,x.setIndex=0,x.componentDatatype=r.A.FLOAT,x.type=p.A.SCALAR,x.count=o,x.buffer=y;const C=[v,x],E=new g.A.Material;E.unlit=!0;const S=new g.A.FeatureIdAttribute;S.featureCount=s,S.propertyTableId=0,S.setIndex=0,S.positionalLabel="featureId_0";const I=[S],P=new g.A.Primitive;return P.attributes=C,P.featureIds=I,P.primitiveType=d.A.POINTS,P.material=E,P}(y,V,t));const H=new g.A.Node;H.index=0,H.primitives=z;const G=[H],W=new g.A.Scene;W.nodes=G;const Y=new g.A.Components;return Y.scene=W,Y.nodes=G,Y.transform=k,Y.structuralMetadata=D,Y}(this._geoJson,e),this._geoJson=void 0),!0};const O={LineString:P,MultiLineString:function(e){const t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=P(e[i])[0];return n},MultiPolygon:function(e){const t=e.length,n=[];for(let i=0;i<t;i++){const t=D(e[i]);(0,x.A)(n,t)}return n},Polygon:D,MultiPoint:function(e){const t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=I(e[i]);return n},Point:function(e){return[I(e)]}},R={LineString:d.A.LINES,MultiLineString:d.A.LINES,MultiPolygon:d.A.LINES,Polygon:d.A.LINES,MultiPoint:d.A.POINTS,Point:d.A.POINTS};function M(e,t){if(!(0,a.A)(e.geometry))return;const n=e.geometry.type,i=O[n],o=R[n],r=e.geometry.coordinates;if(!(0,a.A)(i))return;if(!(0,a.A)(r))return;const s=new E;o===d.A.LINES?s.lines=i(r):o===d.A.POINTS&&(s.points=i(r)),s.properties=e.properties,t.features.push(s)}const L={FeatureCollection:function(e,t){const n=e.features,i=n.length;for(let e=0;e<i;e++)M(n[e],t)},Feature:M},N=new i.A;C.prototype.unload=function(){this._components=void 0};const B=C},320578:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var i=n(571804),o=n(491446),r=n(605971),s=n(402330),a=n(624512),c=n(896077),l=n(575581),u=n(730839),d=n(62467),h=n(226827),A=n(471147),p=n(391852),f=n(595826);const m={name:"GeometryPipelineStage",STRUCT_ID_PROCESSED_ATTRIBUTES_VS:"ProcessedAttributesVS",STRUCT_ID_PROCESSED_ATTRIBUTES_FS:"ProcessedAttributesFS",STRUCT_NAME_PROCESSED_ATTRIBUTES:"ProcessedAttributes",FUNCTION_ID_INITIALIZE_ATTRIBUTES:"initializeAttributes",FUNCTION_SIGNATURE_INITIALIZE_ATTRIBUTES:"void initializeAttributes(out ProcessedAttributes attributes)",FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS:"setDynamicVaryingsVS",FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS:"setDynamicVaryingsFS",FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS:"void setDynamicVaryings(inout ProcessedAttributes attributes)"};function g(e,t,n,r,s,a){const c=e.shaderBuilder,l=A.A.getAttributeInfo(t),d=s&&!a;r>1?function(e,t,n,r){const{quantization:s,normalized:a}=t,{type:c,componentDatatype:l}=(0,o.A)(s)?s:t,d=u.A.getNumberOfComponents(c)/r,h=d*i.A.getSizeInBytes(l),A=t.byteStride;for(let i=0;i<r;i++){const o=t.byteOffset+i*h,r={index:n+i,vertexBuffer:t.buffer,componentsPerAttribute:d,componentDatatype:l,offsetInBytes:o,strideInBytes:A,normalize:a};e.attributes.push(r)}}(e,t,n,r):function(e,t,n,r){const{quantization:s,semantic:a,setIndex:c}=t,{type:l,componentDatatype:d}=(0,o.A)(s)?s:t;a===f.A.FEATURE_ID&&c>=e.featureIdVertexAttributeSetIndex&&(e.featureIdVertexAttributeSetIndex=c+1);const h=a===f.A.POSITION,A=h?0:n,p=u.A.getNumberOfComponents(l),m={index:A,value:(0,o.A)(t.buffer)?void 0:t.constant,vertexBuffer:t.buffer,count:t.count,componentsPerAttribute:p,componentDatatype:d,offsetInBytes:t.byteOffset,strideInBytes:t.byteStride,normalize:t.normalized};if(e.attributes.push(m),!h||!r)return;const g={index:n,vertexBuffer:e.runtimePrimitive.positionBuffer2D,count:t.count,componentsPerAttribute:p,componentDatatype:i.A.FLOAT,offsetInBytes:0,strideInBytes:void 0,normalize:t.normalized};e.attributes.push(g)}(e,t,n,d),function(e,t,n){const i=t.attribute.semantic,o=t.variableName;let r,s;t.isQuantized?(r=`a_quantized_${o}`,s=t.quantizedGlslType):(r=`a_${o}`,s=t.glslType);const a=i===f.A.POSITION;a?e.setPositionAttribute(s,r):e.addAttribute(s,r),a&&n&&e.addAttribute("vec3","a_position2D")}(c,l,d),function(e,t){const n=t.variableName;let i,o=`v_${n}`;"normalMC"===n?(o="v_normalEC",i=t.glslType):"tangentMC"===n?(i="vec3",o="v_tangentEC"):i=t.glslType,e.addVarying(i,o)}(c,l),(0,o.A)(t.semantic)&&function(e,t){const{semantic:n,setIndex:i}=t;switch(n){case f.A.NORMAL:e.addDefine("HAS_NORMALS");break;case f.A.TANGENT:e.addDefine("HAS_TANGENTS");break;case f.A.FEATURE_ID:e.addDefine(`HAS${n}_${i}`);break;case f.A.TEXCOORD:case f.A.COLOR:e.addDefine(`HAS_${n}_${i}`)}}(c,t),function(e,t,n){const i=m.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,o=m.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,{variableName:r,glslType:s}=t;"tangentMC"===r?(e.addStructField(i,"vec3","tangentMC"),e.addStructField(i,"float","tangentSignMC"),e.addStructField(o,"vec3","tangentEC")):"normalMC"===r?(e.addStructField(i,"vec3","normalMC"),e.addStructField(o,"vec3","normalEC")):(e.addStructField(i,s,r),e.addStructField(o,s,r)),"positionMC"===r&&n&&e.addStructField(i,"vec3","position2D")}(c,l,s),function(e,t,n){const i=m.FUNCTION_ID_INITIALIZE_ATTRIBUTES,o=t.variableName;if("positionMC"===o&&n){const t="attributes.position2D = a_position2D;";e.addFunctionLines(i,[t])}if(t.isQuantized)return;const r=[];"tangentMC"===o?(r.push("attributes.tangentMC = a_tangentMC.xyz;"),r.push("attributes.tangentSignMC = a_tangentMC.w;")):r.push(`attributes.${o} = a_${o};`),e.addFunctionLines(i,r)}(c,l,d),function(e,t){const{semantic:n,setIndex:i}=t.attribute;if((0,o.A)(n)&&!(0,o.A)(i))return;let r=m.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS;const s=t.variableName;let a=`v_${s} = attributes.${s};`;e.addFunctionLines(r,[a]),r=m.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS,a=`attributes.${s} = v_${s};`,e.addFunctionLines(r,[a])}(c,l)}m.process=function(e,t,n){const{shaderBuilder:i,model:A}=e;i.addStruct(m.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,"ProcessedAttributes",a.A.VERTEX),i.addStruct(m.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"ProcessedAttributes",a.A.FRAGMENT),i.addStruct(p.A.STRUCT_ID_SELECTED_FEATURE,p.A.STRUCT_NAME_SELECTED_FEATURE,a.A.BOTH),i.addFunction(m.FUNCTION_ID_INITIALIZE_ATTRIBUTES,m.FUNCTION_SIGNATURE_INITIALIZE_ATTRIBUTES,a.A.VERTEX),i.addVarying("vec3","v_positionWC"),i.addVarying("vec3","v_positionEC"),i.addStructField(m.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","positionWC"),i.addStructField(m.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","positionEC"),i.addFunction(m.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS,m.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS,a.A.VERTEX),i.addFunction(m.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS,m.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS,a.A.FRAGMENT),A.type===h.A.TILE_PNTS&&i.addDefine("HAS_SRGB_COLOR",void 0,a.A.FRAGMENT);const _=n.mode!==d.A.SCENE3D&&!n.scene3DOnly&&A._projectTo2D,y=(0,o.A)(e.runtimeNode.node.instances),v=_&&!y,T=t.attributes.length;for(let n=0;n<T;n++){const i=t.attributes[n],s=u.A.getAttributeLocationCount(i.type);if(!(0,o.A)(i.buffer)&&!(0,o.A)(i.constant))throw new r.A("Attributes must be provided as a Buffer or constant value");const a=i.semantic===f.A.POSITION;let c;s>1?(c=e.attributeIndex,e.attributeIndex+=s):c=a&&!v?0:e.attributeIndex++,g(e,i,c,s,_,y)}!function(e,t){let n=!1,i=!1;for(let e=0;e<t.length;e++){const o=t[e];o.semantic===f.A.NORMAL?n=!0:o.semantic===f.A.TANGENT&&(i=!0)}n&&i&&(e.addDefine("HAS_BITANGENTS"),e.addVarying("vec3","v_bitangentEC"),e.addStructField(m.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,"vec3","bitangentMC"),e.addStructField(m.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","bitangentEC"))}(i,t.attributes),t.primitiveType===s.A.POINTS&&i.addDefine("PRIMITIVE_TYPE_POINTS"),i.addVertexLines(l.A),i.addFragmentLines(c.A)};const _=m},521032:(e,t,n)=>{"use strict";n.d(t,{A:()=>G});var i=n(961645),o=n(660662),r=n(267980),s=n(369031),a=n(376758),c=n(571804),l=n(915325),u=n(491446),d=n(610750),h=n(241839),A=n(331185),p=n(584164),f=n(99479),m=n(123245),g=n(543622),_=n(641613),y=n(442790),v=n(730839),T=n(320475),b=n(468741),w=n(982504),x=n(866857),C=n(680278),E=n(32335),S=n(995537),I=n(115959),P=n(287659),D=n(569445),O=n(590732);const R=S.A.Attribute,M=S.A.FeatureIdAttribute,L=S.A.Instances;function N(e){const t=(e=e??l.A.EMPTY_OBJECT).i3dmResource,n=e.arrayBuffer;let i=e.baseResource;const o=e.byteOffset??0,r=e.releaseGltfJson??!1,a=e.asynchronous??!0,c=e.incrementallyLoadTextures??!0,d=e.upAxis??T.A.Y,h=e.forwardAxis??T.A.X,A=e.loadAttributesAsTypedArray??!1,f=e.loadIndicesForWireframe??!1,m=e.loadPrimitiveOutline??!0,g=e.enablePick??!1;s.A.typeOf.object("options.i3dmResource",t),s.A.typeOf.object("options.arrayBuffer",n),i=(0,u.A)(i)?i:t.clone(),this._i3dmResource=t,this._baseResource=i,this._arrayBuffer=n,this._byteOffset=o,this._releaseGltfJson=r,this._asynchronous=a,this._incrementallyLoadTextures=c,this._upAxis=d,this._forwardAxis=h,this._loadAttributesAsTypedArray=A,this._loadIndicesForWireframe=f,this._loadPrimitiveOutline=m,this._enablePick=g,this._state=0,this._promise=void 0,this._gltfLoader=void 0,this._buffers=[],this._components=void 0,this._transform=p.A.IDENTITY,this._batchTable=void 0,this._featureTable=void 0,this._instancesLength=0}(0,u.A)(Object.create)&&(N.prototype=Object.create(D.A.prototype),N.prototype.constructor=N),Object.defineProperties(N.prototype,{texturesLoaded:{get:function(){return this._gltfLoader?.texturesLoaded}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}}),N.prototype.load=function(){if((0,u.A)(this._promise))return this._promise;const e=C.A.parse(this._arrayBuffer,this._byteOffset),t=e.featureTableJson,n=e.featureTableBinary,i=e.batchTableJson,o=e.batchTableBinary,s=e.gltfFormat,a=new b.A(t,n);this._featureTable=a;const l=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=l,!(0,u.A)(l))throw new m.A("Feature table global property: INSTANCES_LENGTH must be defined");this._instancesLength=l;const d=a.getGlobalProperty("RTC_CENTER",c.A.FLOAT,3);(0,u.A)(d)&&(this._transform=p.A.fromTranslation(r.A.fromArray(d))),this._batchTable={json:i,binary:o};const A={upAxis:this._upAxis,forwardAxis:this._forwardAxis,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAttributesAsTypedArray:this._loadAttributesAsTypedArray,enablePick:this._enablePick,loadIndicesForWireframe:this._loadIndicesForWireframe,loadPrimitiveOutline:this._loadPrimitiveOutline};if(0===s){let t=(0,h.A)(e.gltf);t=t.replace(/[\s\0]+$/,"");const n=this._baseResource.getDerivedResource({url:t});A.gltfResource=n,A.baseResource=n}else A.gltfResource=this._i3dmResource,A.typedArray=e.gltf;const f=new w.A(A);return this._gltfLoader=f,this._state=1,this._promise=f.load().then(()=>{if(!this.isDestroyed())return this._state=2,this}).catch(e=>{if(!this.isDestroyed())throw function(e,t){e.unload(),e._state=5;return e.getError("Failed to load i3dm",t)}(this,e)}),this._promise},N.prototype.process=function(e){if(s.A.typeOf.object("frameState",e),4===this._state)return!0;const t=this._gltfLoader;let n=!1;if(2===this._state&&(n=t.process(e)),!n)return!1;const i=t.components;return i.transform=p.A.multiplyTransformation(this._transform,i.transform,i.transform),function(e,t,n){let i;const s=e._featureTable,a=e._instancesLength;if(0===a)return;const l=s.getGlobalProperty("RTC_CENTER",c.A.FLOAT,3),d=s.getGlobalProperty("EAST_NORTH_UP"),h=s.hasProperty("NORMAL_UP")||s.hasProperty("NORMAL_UP_OCT32P")||d,g=s.hasProperty("SCALE")||s.hasProperty("SCALE_NON_UNIFORM"),T=function(e){if(e.hasProperty("POSITION"))return e.getPropertyArray("POSITION",c.A.FLOAT,3);if(e.hasProperty("POSITION_QUANTIZED")){const t=e.getPropertyArray("POSITION_QUANTIZED",c.A.UNSIGNED_SHORT,3),n=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",c.A.FLOAT,3);if(!(0,u.A)(n))throw new m.A("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const i=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",c.A.FLOAT,3);if(!(0,u.A)(i))throw new m.A("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const o=new Float32Array(t.length);for(let e=0;e<t.length/3;e++)for(let r=0;r<3;r++){const s=3*e+r;o[s]=t[s]/65535*i[r]+n[r]}return o}throw new m.A("Either POSITION or POSITION_QUANTIZED must be defined for each instance.")}(s);let b,w;h&&(b=new Float32Array(4*a)),g&&(w=new Float32Array(3*a));const C=new Float32Array(a),E=r.A.unpackArray(T);let S=new r.A;const I=new r.A,P=new r.A,D=new r.A,O=new A.A,N=new f.A,F=new Array(4),V=new r.A,G=new Array(3),W=new p.A;if(!(0,u.A)(l)||r.A.equals(r.A.unpack(l),r.A.ZERO)){const e=o.A.fromPoints(E);for(i=0;i<E.length;i++)r.A.subtract(E[i],e.center,B),T[3*i+0]=B.x,T[3*i+1]=B.y,T[3*i+2]=B.z;const n=p.A.fromTranslation(e.center,U);t.transform=p.A.multiplyTransformation(n,t.transform,t.transform)}for(i=0;i<a;i++){S=r.A.clone(E[i]),(0,u.A)(l)&&r.A.add(S,r.A.unpack(l),S),h&&(z(s,d,i,N,S,P,I,D,O,W),f.A.pack(N,F,0),b[4*i+0]=F[0],b[4*i+1]=F[1],b[4*i+2]=F[2],b[4*i+3]=F[3]),g&&(H(s,i,V),r.A.pack(V,G,0),w[3*i+0]=G[0],w[3*i+1]=G[1],w[3*i+2]=G[2]);let e=s.getProperty("BATCH_ID",c.A.UNSIGNED_SHORT,1,i);(0,u.A)(e)||(e=i),C[i]=e}const Y=new L;Y.transformInWorldSpace=!0;const q=e._buffers,j=new R;if(j.name="Instance Translation",j.semantic=x.A.TRANSLATION,j.componentDatatype=c.A.FLOAT,j.type=v.A.VEC3,j.count=a,j.typedArray=T,!h){const e=_.A.createVertexBuffer({context:n.context,typedArray:T,usage:y.A.STATIC_DRAW});e.vertexArrayDestroyable=!1,q.push(e),j.buffer=e}if(Y.attributes.push(j),h){const e=new R;e.name="Instance Rotation",e.semantic=x.A.ROTATION,e.componentDatatype=c.A.FLOAT,e.type=v.A.VEC4,e.count=a,e.typedArray=b,Y.attributes.push(e)}if(g){const e=new R;if(e.name="Instance Scale",e.semantic=x.A.SCALE,e.componentDatatype=c.A.FLOAT,e.type=v.A.VEC3,e.count=a,h)e.typedArray=w;else{const t=_.A.createVertexBuffer({context:n.context,typedArray:w,usage:y.A.STATIC_DRAW});t.vertexArrayDestroyable=!1,q.push(t),e.buffer=t}Y.attributes.push(e)}const Q=new R;Q.name="Instance Feature ID",Q.setIndex=0,Q.semantic=x.A.FEATURE_ID,Q.componentDatatype=c.A.FLOAT,Q.type=v.A.SCALAR,Q.count=a;const X=_.A.createVertexBuffer({context:n.context,typedArray:C,usage:y.A.STATIC_DRAW});X.vertexArrayDestroyable=!1,q.push(X),Q.buffer=X,Y.attributes.push(Q);const K=new M;K.propertyTableId=0,K.setIndex=0,K.positionalLabel="instanceFeatureId_0",Y.featureIds.push(K);const $=t.nodes,J=$.length;let Z=!1;for(i=0;i<J;i++){const e=$[i];e.primitives.length>0&&(e.instances=Z?k(Y):Y,Z=!0)}}(this,i,e),function(e,t){const n=e._batchTable,i=e._instancesLength;if(0===i)return;let o;if((0,u.A)(n.json))o=(0,I.A)({count:i,batchTable:n.json,binaryBody:n.binary});else{const e=new P.A({name:E.A.BATCH_TABLE_CLASS_NAME,count:i});o=new O.A({schema:{},propertyTables:[e]})}t.structuralMetadata=o}(this,i),this._components=i,this._arrayBuffer=void 0,this._state=4,!0};const B=new r.A,F=new Array(4),U=new p.A;function k(e){const t=new L;t.transformInWorldSpace=e.transformInWorldSpace;const n=e.attributes,i=n.length;for(let e=0;e<i;e++){const i=(0,a.A)(n[e],!1);t.attributes.push(i)}return t.featureIds=e.featureIds,t}const V=new Array(4);function z(e,t,n,o,s,a,l,h,_,y){const v=e.getProperty("NORMAL_UP",c.A.FLOAT,3,n,F),T=e.getProperty("NORMAL_RIGHT",c.A.FLOAT,3,n,V);let b=!1;if((0,u.A)(v)){if(!(0,u.A)(T))throw new m.A("To define a custom orientation, both NORMAL_UP and NORMAL_RIGHT must be defined.");r.A.unpack(v,0,a),r.A.unpack(T,0,l),b=!0}else{const o=e.getProperty("NORMAL_UP_OCT32P",c.A.UNSIGNED_SHORT,2,n,F),r=e.getProperty("NORMAL_RIGHT_OCT32P",c.A.UNSIGNED_SHORT,2,n,V);if((0,u.A)(o)){if(!(0,u.A)(r))throw new m.A("To define a custom orientation with oct-encoded vectors, both NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P must be defined.");i.A.octDecodeInRange(o[0],o[1],65535,a),i.A.octDecodeInRange(r[0],r[1],65535,l),b=!0}else t?(g.A.eastNorthUpToFixedFrame(s,d.A.WGS84,y),p.A.getMatrix3(y,_)):A.A.clone(A.A.IDENTITY,_)}b&&(r.A.cross(l,a,h),r.A.normalize(h,h),A.A.setColumn(_,0,l,_),A.A.setColumn(_,1,a,_),A.A.setColumn(_,2,h,_)),f.A.fromRotationMatrix(_,o)}function H(e,t,n){n=r.A.fromElements(1,1,1,n);const i=e.getProperty("SCALE",c.A.FLOAT,1,t);(0,u.A)(i)&&r.A.multiplyByScalar(n,i,n);const o=e.getProperty("SCALE_NON_UNIFORM",c.A.FLOAT,3,t,F);(0,u.A)(o)&&(n.x*=o[0],n.y*=o[1],n.z*=o[2])}N.prototype.isUnloaded=function(){return 6===this._state},N.prototype.unload=function(){(0,u.A)(this._gltfLoader)&&!this._gltfLoader.isDestroyed()&&this._gltfLoader.unload(),function(e){const t=e._buffers,n=t.length;for(let e=0;e<n;e++){const n=t[e];n.isDestroyed()||n.destroy()}t.length=0}(this),this._components=void 0,this._arrayBuffer=void 0,this._state=6};const G=N},3282:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(430346),o=n(491446),r=n(490129),s=n(624512),a=n(126797),c=n(434067);const l={name:"ImageBasedLightingPipelineStage"},u=new c.A;l.process=function(e,t,n){const l=t.imageBasedLighting,d=t.environmentMapManager,h=e.shaderBuilder;let A;(0,o.A)(l.specularEnvironmentMaps)||(A=d.radianceCubeMap);const p=l.sphericalHarmonicCoefficients??d.sphericalHarmonicCoefficients;h.addDefine("USE_IBL_LIGHTING",void 0,s.A.FRAGMENT),h.addUniform("vec2","model_iblFactor",s.A.FRAGMENT),a.A.isSupported(n.context)&&((l.useSphericalHarmonics||l.useSpecularEnvironmentMaps||l.enabled)&&h.addUniform("mat3","model_iblReferenceFrameMatrix",s.A.FRAGMENT),(0,o.A)(A)&&h.addDefine("COMPUTE_POSITION_WC_ATMOSPHERE",void 0,s.A.BOTH),(0,o.A)(p)&&(0,o.A)(p[0])?(h.addDefine("DIFFUSE_IBL",void 0,s.A.FRAGMENT),h.addDefine("CUSTOM_SPHERICAL_HARMONICS",void 0,s.A.FRAGMENT),h.addUniform("vec3","model_sphericalHarmonicCoefficients[9]",s.A.FRAGMENT)):l.useDefaultSphericalHarmonics&&h.addDefine("DIFFUSE_IBL",void 0,s.A.FRAGMENT),(0,o.A)(l.specularEnvironmentCubeMap)&&l.specularEnvironmentCubeMap.ready||(0,o.A)(A)?(h.addDefine("SPECULAR_IBL",void 0,s.A.FRAGMENT),h.addDefine("CUSTOM_SPECULAR_IBL",void 0,s.A.FRAGMENT),h.addUniform("samplerCube","model_specularEnvironmentMaps",s.A.FRAGMENT),h.addUniform("float","model_specularEnvironmentMapsMaximumLOD",s.A.FRAGMENT)):t.useDefaultSpecularMaps&&h.addDefine("SPECULAR_IBL",void 0,s.A.FRAGMENT)),h.addFragmentLines(r.A);const f={model_iblFactor:function(){return c.A.multiplyByScalar(l.imageBasedLightingFactor,d?.intensity||1,u)},model_iblReferenceFrameMatrix:function(){return t._iblReferenceFrameMatrix},model_sphericalHarmonicCoefficients:function(){return p},model_specularEnvironmentMaps:function(){return l.specularEnvironmentCubeMap.texture},model_specularEnvironmentMapsMaximumLOD:function(){return l.specularEnvironmentCubeMap.maximumMipmapLevel}};(0,o.A)(A)&&(f.model_specularEnvironmentMaps=function(){return A},f.model_specularEnvironmentMapsMaximumLOD=function(){return d.maximumMipmapLevel}),e.uniformMap=(0,i.A)(f,e.uniformMap)};const d=l},509830:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=class{constructor(e){this.show=e.show,this.alpha=e.alpha,this.brightness=e.brightness,this.contrast=e.contrast,this.hue=e.hue,this.saturation=e.saturation,this.gamma=e.gamma,this.colorToAlpha=e.colorToAlpha}}},890692:(e,t,n)=>{"use strict";n.d(t,{A:()=>A});var i=n(491446),o=n(697422),r=n(503631);const s=new o.A,a=new o.A,c=new o.A,l=new o.A,u=new o.A,d=new o.A;class h{constructor(e,t,n,i,o){this._x=e,this._y=t,this._level=n,this._textureCoordinateRectangle=i,this._imagery=o}get x(){return this._x}get y(){return this._y}get level(){return this._level}get textureCoordinateRectangle(){return this._textureCoordinateRectangle}get imagery(){return this._imagery}static createImageryCoverages(e,t,n){if(!t.show)return[];const r=t.imageryProvider,a=h._clampImageryLevel(r,n),A=o.A.intersection(r.rectangle,t.rectangle,s),p=r.tilingScheme,f=h._computeImageryRange(e,A,p,a),m=l;p.rectangleToNativeRectangle(e,m);const g=u;return p.rectangleToNativeRectangle(A,g),h._computeImageryCoverages(t,f,a,m,(e,t,n)=>{const r=p.tileXYToRectangle(e,t,n),s=o.A.intersection(r,A,c);if(!(0,i.A)(s))return;const a=d;return p.rectangleToNativeRectangle(s,a),a})}static _clampImageryLevel(e,t){const n=e.minimumLevel??0,i=e.maximumLevel??Number.POSITIVE_INFINITY,o=Math.min(i-1,Math.max(n,t));return Math.floor(o)}static _computeImageryRange(e,t,n,i){const s=h._computeOverlappedRectangle(e,t),a=n.positionToTileXY(o.A.northwest(s),i),c=n.positionToTileXY(o.A.southeast(s),i),l=new r.A;l.minX=a.x,l.minY=a.y,l.maxX=c.x,l.maxY=c.y;const u=e.width/512,d=e.height/512,A=n.tileXYToRectangle(l.minX,l.minY,i);Math.abs(A.south-e.north)<d&&l.minY<l.maxY&&++l.minY,Math.abs(A.east-e.west)<u&&l.minX<l.maxX&&++l.minX;const p=n.tileXYToRectangle(l.maxX,l.maxY,i);return Math.abs(p.north-e.south)<d&&l.maxY>l.minY&&--l.maxY,Math.abs(p.west-e.east)<u&&l.maxX>l.minX&&--l.maxX,l}static _clampRectangle(e,t,n){return(0,i.A)(n)||(n=new o.A),e.south>=t.north?n.north=n.south=t.north:e.north<=t.south?n.north=n.south=t.south:(n.south=Math.max(e.south,t.south),n.north=Math.min(e.north,t.north)),e.west>=t.east?n.west=n.east=t.east:e.east<=t.west?n.west=n.east=t.west:(n.west=Math.max(e.west,t.west),n.east=Math.min(e.east,t.east)),n}static _computeOverlappedRectangle(e,t){const n=o.A.intersection(e,t,a);return(0,i.A)(n)?n:h._clampRectangle(e,t,a)}static _computeImageryCoverages(e,t,n,o,r){const s=[];for(let a=t.minX;a<=t.maxX;a++){const c=r(a,t.maxY,n);if((0,i.A)(c))for(let c=t.minY;c<=t.maxY;c++){const t=r(a,c,n);if(!(0,i.A)(t))continue;const l=h._localizeToCartesianRectangle(t,o,void 0),u=e.getImageryFromCache(a,c,n),d=new h(a,c,n,l,u);s.push(d)}}return s}static _localizeToCartesianRectangle(e,t,n){(0,i.A)(n)||(n=new r.A);const o=1/t.width,s=1/t.height;return n.minX=(e.west-t.west)*o,n.minY=(e.south-t.south)*s,n.maxX=(e.east-t.west)*o,n.maxY=(e.north-t.south)*s,n}}const A=h},577847:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=class{constructor(){this.alpha=!1,this.brightness=!1,this.contrast=!1,this.hue=!1,this.saturation=!1,this.gamma=!1,this.colorToAlpha=!1}}},610084:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=class{constructor(e,t,n,i,o){this.imageryLayer=e,this.texture=t,this.textureTranslationAndScale=n,this.textureCoordinateRectangle=i,this.imageryTexCoordAttributeSetIndex=o}}},391648:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var i=n(491446),o=n(626809),r=n(369031),s=n(697422),a=n(624512),c=n(451227),l=n(730839),u=n(577847),d=n(17728),h=n(610084),A=n(921243),p=n(983884);const f=new s.A,m=new s.A;class g{static process(e,t,n){const o=e.model,r=t.modelPrimitiveImagery;if(!(0,i.A)(r))return;if(!r.ready)return;const s=o.imageryLayers,a=d.A._extractProjections(s),c=[...new Set(a)],l=g._computeIndexMapping(a,c),u=g._createImageryInputs(s,r,l);if(0===u.length)return;u.length>10&&((0,p.A)("imagery-texture-units",`Warning: Draped imagery requires ${u.length} texture units, truncating`),u.length=10),g._addImageryTexCoordAttributesToRenderResources(r,e);const h=[];for(let e=0;e<s.length;e++)h.push(s.get(e));g._processImageryInputs(h,e,u,c.length)}static _addImageryTexCoordAttributesToRenderResources(e,t){const n=e.imageryTexCoordAttributesPerProjection();for(const e of n)g._addImageryTexCoordAttributeToRenderResources(e,t)}static _addImageryTexCoordAttributeToRenderResources(e,t){const n=l.A.getNumberOfComponents(e.type),o={index:t.attributeIndex++,value:(0,i.A)(e.buffer)?void 0:e.constant,vertexBuffer:e.buffer,count:e.count,componentsPerAttribute:n,componentDatatype:e.componentDatatype,offsetInBytes:e.byteOffset,strideInBytes:e.byteStride,normalize:e.normalized};t.attributes.push(o)}static _processImageryInputs(e,t,n,i){const o=t.shaderBuilder,r=g._computeImageryFlags(e),s=n.length;o.addDefine("HAS_IMAGERY"),o.addDefine(`IMAGERY_TEXTURE_UNITS ${s}`),g._addAttributes(o,i),g._defineUniforms(o,r),g._buildSampleAndBlendFunction(o,r),g._createMainImageryShader(o,n,r);const a=t.uniformMap,c=g._createImageryUniforms(n);g._setImageryUniforms(a,c)}static _addAttributes(e,t){for(let n=0;n<t;n++)e.addAttribute("vec2",`a_imagery_texCoord_${n}`),e.addVarying("vec2",`v_imagery_texCoord_${n}`);const n="initializeImageryAttributes",i=`void ${n}()`;e.addFunction(n,i,a.A.VERTEX);for(let i=0;i<t;i++)e.addFunctionLines(n,[`v_imagery_texCoord_${i} = a_imagery_texCoord_${i};`])}static _computeImageryFlags(e){const t=new u.A;for(let n=0;n<e.length;n++){const o=e[n];t.alpha|=1!==o.alpha,t.brightness|=o.brightness!==c.A.DEFAULT_BRIGHTNESS,t.contrast|=o.contrast!==c.A.DEFAULT_CONTRAST,t.hue|=o.hue!==c.A.DEFAULT_HUE,t.saturation|=o.saturation!==c.A.DEFAULT_SATURATION,t.gamma|=o.gamma!==c.A.DEFAULT_GAMMA;const r=(0,i.A)(o.colorToAlpha)&&o.colorToAlphaThreshold>0;t.colorToAlpha|=r}return t}static _defineUniforms(e,t){e.addUniform("sampler2D","u_imageryTextures[IMAGERY_TEXTURE_UNITS]",a.A.FRAGMENT),e.addUniform("vec4","u_imageryTextureCoordinateRectangle[IMAGERY_TEXTURE_UNITS]",a.A.FRAGMENT),e.addUniform("vec4","u_imageryTextureTranslationAndScale[IMAGERY_TEXTURE_UNITS]",a.A.FRAGMENT),t.alpha&&e.addUniform("float","u_imageryTextureAlpha[IMAGERY_TEXTURE_UNITS]",a.A.FRAGMENT),t.brightness&&e.addUniform("float","u_imageryTextureBrightness[IMAGERY_TEXTURE_UNITS]",a.A.FRAGMENT),t.contrast&&e.addUniform("float","u_imageryTextureContrast[IMAGERY_TEXTURE_UNITS]",a.A.FRAGMENT),t.hue&&e.addUniform("float","u_imageryTextureHue[IMAGERY_TEXTURE_UNITS]",a.A.FRAGMENT),t.saturation&&e.addUniform("float","u_imageryTextureSaturation[IMAGERY_TEXTURE_UNITS]",a.A.FRAGMENT),t.gamma&&e.addUniform("float","u_imageryTextureOneOverGamma[IMAGERY_TEXTURE_UNITS]",a.A.FRAGMENT),t.colorToAlpha&&e.addUniform("vec4","u_imageryTextureColorToAlpha[IMAGERY_TEXTURE_UNITS]",a.A.FRAGMENT)}static _createSampleAndBlendFunctionSignature(e){const t=[];return t.push("vec4 previousColor"),t.push("sampler2D textureToSample"),t.push("vec2 textureCoordinates"),t.push("vec4 textureCoordinateRectangle"),t.push("vec4 textureCoordinateTranslationAndScale"),e.alpha&&t.push("float textureAlpha"),e.brightness&&t.push("float textureBrightness"),e.contrast&&t.push("float textureContrast"),e.hue&&t.push("float textureHue"),e.saturation&&t.push("float textureSaturation"),e.gamma&&t.push("float textureOneOverGamma"),e.colorToAlpha&&t.push("vec4 colorToAlpha"),`vec4 sampleAndBlend(${t.join(", ")})`}static _buildSampleAndBlendFunction(e,t){const n="sampleAndBlend",i=g._createSampleAndBlendFunctionSignature(t);e.addFunction(n,i,a.A.FRAGMENT),e.addFunctionLines(n,["float effectiveAlpha = 1.0;"]),t.alpha&&e.addFunctionLines(n,["effectiveAlpha = textureAlpha;"]),e.addFunctionLines(n,["if (textureCoordinates.x < textureCoordinateRectangle.x) effectiveAlpha = 0.0;","if (textureCoordinates.x > textureCoordinateRectangle.z) effectiveAlpha = 0.0;","if (textureCoordinates.y < textureCoordinateRectangle.y) effectiveAlpha = 0.0;","if (textureCoordinates.y > textureCoordinateRectangle.w) effectiveAlpha = 0.0;","vec2 translation = textureCoordinateTranslationAndScale.xy;","vec2 scale = textureCoordinateTranslationAndScale.zw;","vec2 effectiveTextureCoordinates = textureCoordinates * scale + translation;","vec4 value = texture(textureToSample, effectiveTextureCoordinates);","value = czm_srgbToLinear(value);","vec3 color = value.rgb;","float alpha = value.a;"]),t.colorToAlpha&&e.addFunctionLines(n,["vec3 colorDiff = abs(color.rgb - colorToAlpha.rgb);","colorDiff.r = czm_maximumComponent(colorDiff);","alpha = czm_branchFreeTernary(colorDiff.r < colorToAlpha.a, 0.0, alpha);"]),t.gamma?e.addFunctionLines(n,["color = pow(color, vec3(textureOneOverGamma));"]):e.addFunctionLines(n,["vec4 tempColor = czm_gammaCorrect(vec4(color, alpha));","color = tempColor.rgb;","alpha = tempColor.a;"]),t.brightness&&e.addFunctionLines(n,["color = mix(vec3(0.0), color, textureBrightness);"]),t.contrast&&e.addFunctionLines(n,["color = mix(vec3(0.5), color, textureContrast);"]),t.hue&&e.addFunctionLines(n,["color = czm_hue(color, textureHue);"]),t.saturation&&e.addFunctionLines(n,["color = czm_saturation(color, textureSaturation);"]),e.addFunctionLines(n,["float sourceAlpha = alpha * effectiveAlpha;","float outAlpha = mix(previousColor.a, 1.0, sourceAlpha);","outAlpha += sign(outAlpha) - 1.0;","vec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;","vec4 result = vec4(outColor, max(outAlpha, 0.0));"]),e.addFunctionLines(n,["return result;"])}static _createSampleAndBlendCallArguments(e,t,n){const i=`v_imagery_texCoord_${t}`,o=[];return o.push("blendedBaseColor"),o.push(`u_imageryTextures[${n}]`),o.push(`${i}`),o.push(`u_imageryTextureCoordinateRectangle[${n}]`),o.push(`u_imageryTextureTranslationAndScale[${n}]`),e.alpha&&o.push(`u_imageryTextureAlpha[${n}]`),e.brightness&&o.push(`u_imageryTextureBrightness[${n}]`),e.contrast&&o.push(`u_imageryTextureContrast[${n}]`),e.hue&&o.push(`u_imageryTextureHue[${n}]`),e.saturation&&o.push(`u_imageryTextureSaturation[${n}]`),e.gamma&&o.push(`u_imageryTextureOneOverGamma[${n}]`),e.colorToAlpha&&o.push(`u_imageryTextureColorToAlpha[${n}]`),o.join(", ")}static _createMainImageryShader(e,t,n){const i="blendBaseColorWithImagery";e.addFunction(i,"vec4 blendBaseColorWithImagery(vec4 baseColorWithAlpha)",a.A.FRAGMENT),e.addFunctionLines(i,["vec4 blendedBaseColor = baseColorWithAlpha;"]);for(let o=0;o<t.length;o++){const r=t[o].imageryTexCoordAttributeSetIndex,s=g._createSampleAndBlendCallArguments(n,r,o);e.addFunctionLines(i,[`blendedBaseColor = sampleAndBlend(${s});`])}e.addFunctionLines(i,["return blendedBaseColor;"])}static _createImageryUniforms(e){const t=e.length,n={};n.imageryTextures=Array(t),n.imageryTextureCoordinateRectangle=Array(t),n.imageryTextureTranslationAndScale=Array(t),n.imageryTextureAlpha=Array(t),n.imageryTextureBrightness=Array(t),n.imageryTextureContrast=Array(t),n.imageryTextureHue=Array(t),n.imageryTextureSaturation=Array(t),n.imageryTextureOneOverGamma=Array(t),n.imageryTextureColorToAlpha=Array(t);for(let r=0;r<t;r++){const t=e[r],s=t.imageryLayer,a=t.texture,c=t.textureCoordinateRectangle,l=t.textureTranslationAndScale;n.imageryTextures[r]=a,n.imageryTextureTranslationAndScale[r]=l,n.imageryTextureCoordinateRectangle[r]=c,n.imageryTextureAlpha[r]=s.alpha,n.imageryTextureBrightness[r]=s.brightness,n.imageryTextureContrast[r]=s.contrast,n.imageryTextureHue[r]=s.hue,n.imageryTextureSaturation[r]=s.saturation,n.imageryTextureOneOverGamma[r]=1/s.gamma;let u=n.imageryTextureColorToAlpha[r];if((0,i.A)(u)||(u=new o.A,n.imageryTextureColorToAlpha[r]=u),(0,i.A)(s.colorToAlpha)&&s.colorToAlphaThreshold>0){const e=s.colorToAlpha;u.x=e.red,u.y=e.green,u.z=e.blue,u.w=s.colorToAlphaThreshold}else u.w=-1}return n}static _setImageryUniforms(e,t){for(const n in t)t.hasOwnProperty(n)&&(e[`u_${n}`]=function(){return t[n]})}static _createImageryInputs(e,t,n){r.A.defined("imageryLayers",e),r.A.defined("modelPrimitiveImagery",t),r.A.defined("imageryTexCoordAttributeSetIndices",n);const o=[];for(let r=0;r<e.length;r++){const s=e.get(r);if(!s.show)continue;const a=n[r],c=t.mappedPositionsForImageryLayer(s).cartographicBoundingRectangle,l=t.coveragesForImageryLayer(s);for(let e=0;e<l.length;e++){const t=l[e],n=g._createImageryInput(s,t,c,a);(0,i.A)(n)&&o.push(n)}}return o}static _createImageryInput(e,t,n,s){r.A.defined("imageryLayer",e),r.A.defined("coverage",t),r.A.defined("cartographicBoundingRectangle",n),r.A.typeOf.number.greaterThanOrEquals("imageryTexCoordAttributeSetIndex",s,0);const a=t.imagery;if(a.state===A.A.FAILED||a.state===A.A.INVALID)return;let c=a.textureWebMercator;if(!(0,i.A)(c)&&(c=a.texture,!(0,i.A)(c)))return void(a.state===A.A.READY&&console.log(`Imagery at ${t.x}, ${t.y} (level ${t.level}) does not have any texture - state ${a.state}`));const l=g._computeTextureTranslationAndScale(e,n,a.rectangle),u=t.textureCoordinateRectangle,d=new o.A(u.minX,u.minY,u.maxX,u.maxY);return new h.A(e,c,l,d,s)}static _computeTextureTranslationAndScale(e,t,n){r.A.defined("imageryLayer",e),r.A.defined("nonNativeBoundingRectangle",t),r.A.defined("nonNativeImageryRectangle",n);const i=e.imageryProvider.tilingScheme,o=i.rectangleToNativeRectangle(t,f),s=i.rectangleToNativeRectangle(n,m);return g._computeTextureTranslationAndScaleFromNative(o,s)}static _computeTextureTranslationAndScaleFromNative(e,t){r.A.defined("nativeBoundingRectangle",e),r.A.defined("nativeImageryRectangle",t);const n=1/t.width,i=1/t.height,s=(e.west-t.west)*n,a=(e.south-t.south)*i,c=e.width*n,l=e.height*i;return new o.A(s,a,c,l)}static _computeIndexMapping(e,t){r.A.defined("source",e),r.A.defined("target",t);const n=[],i=e.length;for(let o=0;o<i;o++){const i=e[o],r=t.indexOf(i);n.push(r)}return n}}const _=g},281810:(e,t,n)=>{"use strict";n.d(t,{A:()=>Q});var i=n(702247),o=n(961645),r=n(267980),s=n(376758),a=n(430346),c=n(571804),l=n(491446),u=n(584164),d=n(99479),h=n(543622),A=n(641613),p=n(442790),f=n(624512),m=n(75899),g=n(295673),_=n(370988),y=n(730839),v=n(866857),T=n(62467),b=n(78173),w=n(471147);const x=new u.A,C=new u.A,E=new u.A,S={name:"InstancingPipelineStage",_getInstanceTransformsAsMatrices:W,_transformsToTypedArray:V,process:function(e,t,n){const o=t.instances,c=o.attributes[0].count,d=e.shaderBuilder;d.addDefine("HAS_INSTANCING"),d.addVertexLines(m.A);const A=e.model,p=A.sceneGraph,b=e.runtimeNode,S=n.mode!==T.A.SCENE3D&&!n.scene3DOnly&&A._projectTo2D,I=A._enablePick&&!n.context.webgl2,P=[];!function(e,t,n,i,o,a){const c=w.A.getAttributeBySemantic(n,v.A.ROTATION);(0,l.A)(c)?function(e,t,n,i,o,a){const c=e.shaderBuilder,d=t.attributes[0].count,h=e.model,A=e.runtimeNode;c.addDefine("HAS_INSTANCE_MATRICES");let p,f=A.instancingTransformsBuffer;if(!(0,l.A)(f)){p=W(t,d,e);const n=V(p);f=Y(n,i),h._modelResources.push(f),a&&(A.transformsTypedArray=n),A.instancingTransformsBuffer=f}if(q(e,f,n,"Transform"),!o)return;const m=(0,s.A)(i);m.mode=T.A.COLUMBUS_VIEW,k(e,m);let g=A.instancingTransformsBuffer2D;if(!(0,l.A)(g)){const t=function(e,t,n,i){const o=M,s=L;R(t,o,s);const a=t.runtimeNode.instancingReferencePoint2D,c=e.length;for(let t=0;t<c;t++){const c=D(e[t],o,s,n,N),l=u.A.getTranslation(c,B),d=r.A.subtract(l,a,l);i[t]=u.A.setTranslation(c,d,i[t])}return i}(p,e,m,p);g=Y(V(t),i),h._modelResources.push(g),A.instancingTransformsBuffer2D=g}q(e,g,n,"Transform2D")}(e,n,i,t,o,a):function(e,t,n,i,o){const a=e.shaderBuilder,c=e.runtimeNode,u=w.A.getAttributeBySemantic(t,v.A.TRANSLATION),d=w.A.getAttributeBySemantic(t,v.A.SCALE);if((0,l.A)(d)){a.addDefine("HAS_INSTANCE_SCALE");const t="Scale";j(e,d.buffer,d.byteOffset,d.byteStride,n,t)}if(!(0,l.A)(u))return;let h;const A=u.typedArray;(0,l.A)(A)?h=function(e,t,n){const i=new Array(t),o=e.typedArray,s=new r.A(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new r.A(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let e=0;e<t;e++){const t=new r.A(o[3*e],o[3*e+1],o[3*e+2]);i[e]=t,r.A.minimumByComponent(s,t,s),r.A.maximumByComponent(a,t,a)}const c=n.runtimeNode;return c.instancingTranslationMin=s,c.instancingTranslationMax=a,e.typedArray=void 0,i}(u,u.count,e):(0,l.A)(c.instancingTranslationMin)||(c.instancingTranslationMin=u.min,c.instancingTranslationMax=u.max),a.addDefine("HAS_INSTANCE_TRANSLATION");if(j(e,u.buffer,u.byteOffset,u.byteStride,n,"Translation"),!o)return;const p=(0,s.A)(i);p.mode=T.A.COLUMBUS_VIEW,k(e,p);let f=c.instancingTranslationBuffer2D;if(!(0,l.A)(f)){const t=function(e,t,n,i){const o=M,s=L;R(t,o,s);const a=t.runtimeNode.instancingReferencePoint2D,c=e.length;for(let t=0;t<c;t++){const c=e[t],l=O(c,o,s,n,c);i[t]=r.A.subtract(l,a,i[t])}return i}(h,e,p,h),n=function(e){const t=e.length,n=new Float32Array(3*t);for(let i=0;i<t;i++){const t=e[i],o=3*i;n[o+0]=t[0],n[o+1]=t[4],n[o+2]=t[8]}return n}(t);f=Y(n,i),e.model._modelResources.push(f),c.instancingTranslationBuffer2D=f}if(!o)return;j(e,f,0,void 0,n,"Translation2D")}(e,n,i,t,o)}(e,n,o,P,S,I),function(e,t,n,i){const o=n.attributes,r=e.shaderBuilder;for(let t=0;t<o.length;t++){const n=o[t];n.semantic===v.A.FEATURE_ID&&(n.setIndex>=e.featureIdVertexAttributeSetIndex&&(e.featureIdVertexAttributeSetIndex=n.setIndex+1),i.push({index:e.attributeIndex++,vertexBuffer:n.buffer,componentsPerAttribute:y.A.getNumberOfComponents(n.type),componentDatatype:n.componentDatatype,normalize:!1,offsetInBytes:n.byteOffset,strideInBytes:n.byteStride,instanceDivisor:1}),r.addAttribute("float",`a_instanceFeatureId_${n.setIndex}`))}}(e,0,o,P);const F={};if(o.transformInWorldSpace?(d.addDefine("USE_LEGACY_INSTANCING",void 0,f.A.VERTEX),d.addUniform("mat4","u_instance_modifiedModelView",f.A.VERTEX),d.addUniform("mat4","u_instance_nodeTransform",f.A.VERTEX),F.u_instance_modifiedModelView=function(){let e=u.A.multiplyTransformation(A.modelMatrix,p.components.transform,x);return S?u.A.multiplyTransformation(n.context.uniformState.view3D,e,x):(n.mode!==T.A.SCENE3D&&(e=h.A.basisTo2D(n.mapProjection,e,x)),u.A.multiplyTransformation(n.context.uniformState.view,e,x))},F.u_instance_nodeTransform=function(){return u.A.multiplyTransformation(p.axisCorrectionMatrix,b.computedTransform,C)},d.addVertexLines(_.A)):d.addVertexLines(g.A),S){d.addDefine("USE_2D_INSTANCING",void 0,f.A.VERTEX),d.addUniform("mat4","u_modelView2D",f.A.VERTEX);const e=n.context,t=u.A.fromTranslation(b.instancingReferencePoint2D,new u.A);F.u_modelView2D=function(){return u.A.multiplyTransformation(e.uniformState.view,t,E)}}e.uniformMap=(0,a.A)(F,e.uniformMap),e.instanceCount=c,(0,i.A)(e.attributes,P)}},I=new u.A,P=new r.A;function D(e,t,n,i,o){let r=u.A.multiplyTransformation(t,e,I);return r=u.A.multiplyTransformation(r,n,I),h.A.basisTo2D(i.mapProjection,r,o)}function O(e,t,n,i,o){const r=u.A.fromTranslation(e,I);let s=u.A.multiplyTransformation(t,r,I);s=u.A.multiplyTransformation(s,n,I);const a=u.A.getTranslation(s,P);return b.A.computeActualEllipsoidPosition(i,a,o)}function R(e,t,n){const i=e.model,o=i.sceneGraph;e.runtimeNode.node.instances.transformInWorldSpace?(t=u.A.multiplyTransformation(i.modelMatrix,o.components.transform,t),n=u.A.multiplyTransformation(o.axisCorrectionMatrix,e.runtimeNode.computedTransform,n)):(t=u.A.clone(o.computedModelMatrix,t),t=u.A.multiplyTransformation(t,e.runtimeNode.computedTransform,t),n=u.A.clone(u.A.IDENTITY,n))}const M=new u.A,L=new u.A,N=new u.A,B=new r.A,F=new r.A,U=new r.A;function k(e,t){const n=e.runtimeNode,i=e.model.sceneGraph.computedModelMatrix,o=u.A.multiplyByPoint(i,n.instancingTranslationMin,F),s=b.A.computeActualEllipsoidPosition(t,o,o),a=u.A.multiplyByPoint(i,n.instancingTranslationMax,U),c=b.A.computeActualEllipsoidPosition(t,a,a);n.instancingReferencePoint2D=r.A.lerp(s,c,.5,new r.A)}function V(e){const t=e.length,n=new Float32Array(12*t);for(let i=0;i<t;i++){const t=e[i],o=12*i;n[o+0]=t[0],n[o+1]=t[4],n[o+2]=t[8],n[o+3]=t[12],n[o+4]=t[1],n[o+5]=t[5],n[o+6]=t[9],n[o+7]=t[13],n[o+8]=t[2],n[o+9]=t[6],n[o+10]=t[10],n[o+11]=t[14]}return n}const z=new r.A,H=new d.A,G=new r.A;function W(e,t,n){const i=new Array(t),s=w.A.getAttributeBySemantic(e,v.A.TRANSLATION),a=w.A.getAttributeBySemantic(e,v.A.ROTATION),c=w.A.getAttributeBySemantic(e,v.A.SCALE),h=new r.A(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),A=new r.A(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),p=(0,l.A)(s),f=(0,l.A)(a),m=(0,l.A)(c),g=p?s.typedArray:new Float32Array(3*t);let _,y=f?a.typedArray:new Float32Array(4*t);f&&a.normalized&&(y=o.A.dequantize(y,a.componentDatatype,a.type,t)),m?_=c.typedArray:(_=new Float32Array(3*t),_.fill(1));for(let e=0;e<t;e++){const t=new r.A(g[3*e],g[3*e+1],g[3*e+2],z);r.A.maximumByComponent(h,t,h),r.A.minimumByComponent(A,t,A);const n=new d.A(y[4*e],y[4*e+1],y[4*e+2],f?y[4*e+3]:1,H),o=new r.A(_[3*e],_[3*e+1],_[3*e+2],G),s=u.A.fromTranslationQuaternionRotationScale(t,n,o,new u.A);i[e]=s}const T=n.runtimeNode;return T.instancingTranslationMin=A,T.instancingTranslationMax=h,p&&(s.typedArray=void 0),f&&(a.typedArray=void 0),m&&(c.typedArray=void 0),i}function Y(e,t){const n=A.A.createVertexBuffer({context:t.context,typedArray:e,usage:p.A.STATIC_DRAW});return n.vertexArrayDestroyable=!1,n}function q(e,t,n,o){const r=c.A.getSizeInBytes(c.A.FLOAT),s=12*r,a=[{index:e.attributeIndex++,vertexBuffer:t,componentsPerAttribute:4,componentDatatype:c.A.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:s,instanceDivisor:1},{index:e.attributeIndex++,vertexBuffer:t,componentsPerAttribute:4,componentDatatype:c.A.FLOAT,normalize:!1,offsetInBytes:4*r,strideInBytes:s,instanceDivisor:1},{index:e.attributeIndex++,vertexBuffer:t,componentsPerAttribute:4,componentDatatype:c.A.FLOAT,normalize:!1,offsetInBytes:8*r,strideInBytes:s,instanceDivisor:1}],l=e.shaderBuilder;l.addAttribute("vec4",`a_instancing${o}Row0`),l.addAttribute("vec4",`a_instancing${o}Row1`),l.addAttribute("vec4",`a_instancing${o}Row2`),(0,i.A)(n,a)}function j(e,t,n,i,o,r){o.push({index:e.attributeIndex++,vertexBuffer:t,componentsPerAttribute:3,componentDatatype:c.A.FLOAT,normalize:!1,offsetInBytes:n,strideInBytes:i,instanceDivisor:1}),e.shaderBuilder.addAttribute("vec3",`a_instance${r}`)}const Q=S},10803:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({UNLIT:0,PBR:1})},817082:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(491446),o=n(624512),r=n(419421),s=n(10803);const a={name:"LightingPipelineStage",process:function(e,t){const{model:n,lightingOptions:a,shaderBuilder:c}=e;(0,i.A)(n.lightColor)&&(c.addDefine("USE_CUSTOM_LIGHT_COLOR",void 0,o.A.FRAGMENT),c.addUniform("vec3","model_lightColorHdr",o.A.FRAGMENT),e.uniformMap.model_lightColorHdr=function(){return n.lightColor});const{lightingModel:l}=a;l===s.A.PBR?c.addDefine("LIGHTING_PBR",void 0,o.A.FRAGMENT):c.addDefine("LIGHTING_UNLIT",void 0,o.A.FRAGMENT),c.addFragmentLines(r.A)}}},736355:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(369031);const o=class{constructor(e,t,n,o){i.A.defined("cartographicPositions",e),i.A.typeOf.number.greaterThanOrEquals("numPositions",t,0),i.A.defined("cartographicBoundingRectangle",n),i.A.defined("ellipsoid",o),this._cartographicPositions=e,this._numPositions=t,this._cartographicBoundingRectangle=n,this._ellipsoid=o}get cartographicPositions(){return this._cartographicPositions}get numPositions(){return this._numPositions}get cartographicBoundingRectangle(){return this._cartographicBoundingRectangle}get ellipsoid(){return this._ellipsoid}}},193497:(e,t,n)=>{"use strict";n.d(t,{A:()=>x});var i=n(491446),o=n(267980),r=n(626809),s=n(331185),a=n(624512),c=n(760866),l=n(563402),u=n(953019),d=n(995537),h=n(595826),A=n(10803),p=n(471147);const{Material:f,MetallicRoughness:m,SpecularGlossiness:g,Specular:_,Clearcoat:y}=d.A,v={name:"MaterialPipelineStage",_processTexture:b,_processTextureTransform:T};function T(e,t,n,i,o){const r=`HAS_${o}_TEXTURE_TRANSFORM`;e.addDefine(r,void 0,a.A.FRAGMENT);const s=`${i}Transform`;e.addUniform("mat3",s,a.A.FRAGMENT),t[s]=function(){return n.transform}}function b(e,t,n,o,r,c){e.addUniform("sampler2D",o,a.A.FRAGMENT),t[o]=function(){return n.texture??c};const l=`HAS_${r}_TEXTURE`;e.addDefine(l,void 0,a.A.FRAGMENT);const u=`v_texCoord_${n.texCoord}`,d=`TEXCOORD_${r}`;e.addDefine(d,u,a.A.FRAGMENT);const h=n.transform;(0,i.A)(h)&&!s.A.equals(h,s.A.IDENTITY)&&T(e,t,n,o,r);const{scale:A}=n;(0,i.A)(A)&&1!==A&&function(e,t,n,i,o){const r=`HAS_${o}_TEXTURE_SCALE`;e.addDefine(r,void 0,a.A.FRAGMENT);const s=`${i}Scale`;e.addUniform("float",s,a.A.FRAGMENT),t[s]=function(){return n.scale}}(e,t,n,o,r)}v.process=function(e,t,n){const s=t.material,{model:d,uniformMap:v,shaderBuilder:T}=e,x=(0,i.A)(d.classificationType),C=x,{defaultTexture:E,defaultNormalTexture:S,defaultEmissiveTexture:I}=n.context;!function(e,t,n,r,s,c,l){const{emissiveFactor:u,emissiveTexture:d,normalTexture:h,occlusionTexture:A}=e;(0,i.A)(u)&&!o.A.equals(u,f.DEFAULT_EMISSIVE_FACTOR)&&(n.addUniform("vec3","u_emissiveFactor",a.A.FRAGMENT),t.u_emissiveFactor=function(){return e.emissiveFactor},n.addDefine("HAS_EMISSIVE_FACTOR",void 0,a.A.FRAGMENT),(0,i.A)(d)&&!l&&b(n,t,d,"u_emissiveTexture","EMISSIVE",c)),(0,i.A)(h)&&!l&&b(n,t,h,"u_normalTexture","NORMAL",s),(0,i.A)(A)&&!l&&b(n,t,A,"u_occlusionTexture","OCCLUSION",r)}(s,v,T,E,S,I,C),(0,i.A)(s.specularGlossiness)?function(e,t,n,s,c){const{diffuseTexture:l,diffuseFactor:u,specularGlossinessTexture:d,specularFactor:h,glossinessFactor:A}=e;n.addDefine("USE_SPECULAR_GLOSSINESS",void 0,a.A.FRAGMENT),(0,i.A)(l)&&!c&&b(n,t,l,"u_diffuseTexture","DIFFUSE",s),(0,i.A)(u)&&!r.A.equals(u,g.DEFAULT_DIFFUSE_FACTOR)&&(n.addUniform("vec4","u_diffuseFactor",a.A.FRAGMENT),t.u_diffuseFactor=function(){return e.diffuseFactor},n.addDefine("HAS_DIFFUSE_FACTOR",void 0,a.A.FRAGMENT)),(0,i.A)(d)&&!c&&b(n,t,d,"u_specularGlossinessTexture","SPECULAR_GLOSSINESS",s),(0,i.A)(h)&&!o.A.equals(h,g.DEFAULT_SPECULAR_FACTOR)&&(n.addUniform("vec3","u_legacySpecularFactor",a.A.FRAGMENT),t.u_legacySpecularFactor=function(){return e.specularFactor},n.addDefine("HAS_LEGACY_SPECULAR_FACTOR",void 0,a.A.FRAGMENT)),(0,i.A)(A)&&A!==g.DEFAULT_GLOSSINESS_FACTOR&&(n.addUniform("float","u_glossinessFactor",a.A.FRAGMENT),t.u_glossinessFactor=function(){return e.glossinessFactor},n.addDefine("HAS_GLOSSINESS_FACTOR",void 0,a.A.FRAGMENT))}(s.specularGlossiness,v,T,E,C):((0,i.A)(s.specular)&&p.A.supportedExtensions.KHR_materials_specular&&function(e,t,n,r,s){const{specularTexture:c,specularFactor:l,specularColorTexture:u,specularColorFactor:d}=e;n.addDefine("USE_SPECULAR",void 0,a.A.FRAGMENT),(0,i.A)(c)&&!s&&b(n,t,c,"u_specularTexture","SPECULAR",r),(0,i.A)(l)&&l!==_.DEFAULT_SPECULAR_FACTOR&&(n.addUniform("float","u_specularFactor",a.A.FRAGMENT),t.u_specularFactor=function(){return e.specularFactor},n.addDefine("HAS_SPECULAR_FACTOR",void 0,a.A.FRAGMENT)),(0,i.A)(u)&&!s&&b(n,t,u,"u_specularColorTexture","SPECULAR_COLOR",r),(0,i.A)(d)&&!o.A.equals(d,_.DEFAULT_SPECULAR_COLOR_FACTOR)&&(n.addUniform("vec3","u_specularColorFactor",a.A.FRAGMENT),t.u_specularColorFactor=function(){return e.specularColorFactor},n.addDefine("HAS_SPECULAR_COLOR_FACTOR",void 0,a.A.FRAGMENT))}(s.specular,v,T,E,C),(0,i.A)(s.anisotropy)&&p.A.supportedExtensions.KHR_materials_anisotropy&&function(e,t,n,r,s){const{anisotropyStrength:c,anisotropyRotation:l,anisotropyTexture:u}=e;n.addDefine("USE_ANISOTROPY",void 0,a.A.FRAGMENT),(0,i.A)(u)&&!s&&b(n,t,u,"u_anisotropyTexture","ANISOTROPY",r);const d=Math.cos(l),h=Math.sin(l);n.addUniform("vec3","u_anisotropy",a.A.FRAGMENT),t.u_anisotropy=function(){return o.A.fromElements(d,h,c,w)}}(s.anisotropy,v,T,E,C),(0,i.A)(s.clearcoat)&&p.A.supportedExtensions.KHR_materials_clearcoat&&function(e,t,n,o,r){const{clearcoatFactor:s,clearcoatTexture:c,clearcoatRoughnessFactor:l,clearcoatRoughnessTexture:u,clearcoatNormalTexture:d}=e;n.addDefine("USE_CLEARCOAT",void 0,a.A.FRAGMENT),(0,i.A)(s)&&s!==y.DEFAULT_CLEARCOAT_FACTOR&&(n.addUniform("float","u_clearcoatFactor",a.A.FRAGMENT),t.u_clearcoatFactor=function(){return e.clearcoatFactor},n.addDefine("HAS_CLEARCOAT_FACTOR",void 0,a.A.FRAGMENT)),(0,i.A)(c)&&!r&&b(n,t,c,"u_clearcoatTexture","CLEARCOAT",o),(0,i.A)(l)&&s!==y.DEFAULT_CLEARCOAT_ROUGHNESS_FACTOR&&(n.addUniform("float","u_clearcoatRoughnessFactor",a.A.FRAGMENT),t.u_clearcoatRoughnessFactor=function(){return e.clearcoatRoughnessFactor},n.addDefine("HAS_CLEARCOAT_ROUGHNESS_FACTOR",void 0,a.A.FRAGMENT)),(0,i.A)(u)&&!r&&b(n,t,u,"u_clearcoatRoughnessTexture","CLEARCOAT_ROUGHNESS",o),(0,i.A)(d)&&!r&&b(n,t,d,"u_clearcoatNormalTexture","CLEARCOAT_NORMAL",o)}(s.clearcoat,v,T,E,C),function(e,t,n,o,s){n.addDefine("USE_METALLIC_ROUGHNESS",void 0,a.A.FRAGMENT);const c=e.baseColorTexture;(0,i.A)(c)&&!s&&b(n,t,c,"u_baseColorTexture","BASE_COLOR",o);const l=e.baseColorFactor;(0,i.A)(l)&&!r.A.equals(l,m.DEFAULT_BASE_COLOR_FACTOR)&&(n.addUniform("vec4","u_baseColorFactor",a.A.FRAGMENT),t.u_baseColorFactor=function(){return e.baseColorFactor},n.addDefine("HAS_BASE_COLOR_FACTOR",void 0,a.A.FRAGMENT));const u=e.metallicRoughnessTexture;(0,i.A)(u)&&!s&&b(n,t,u,"u_metallicRoughnessTexture","METALLIC_ROUGHNESS",o);const d=e.metallicFactor;(0,i.A)(d)&&d!==m.DEFAULT_METALLIC_FACTOR&&(n.addUniform("float","u_metallicFactor",a.A.FRAGMENT),t.u_metallicFactor=function(){return e.metallicFactor},n.addDefine("HAS_METALLIC_FACTOR",void 0,a.A.FRAGMENT));const h=e.roughnessFactor;(0,i.A)(h)&&h!==m.DEFAULT_ROUGHNESS_FACTOR&&(n.addUniform("float","u_roughnessFactor",a.A.FRAGMENT),t.u_roughnessFactor=function(){return e.roughnessFactor},n.addDefine("HAS_ROUGHNESS_FACTOR",void 0,a.A.FRAGMENT))}(s.metallicRoughness,v,T,E,C));const P=p.A.getAttributeBySemantic(t,h.A.NORMAL),D=(0,i.A)(d.pointCloudShading)&&!d.pointCloudShading.normalShading,O=e.lightingOptions;s.unlit||!P||x||D?O.lightingModel=A.A.UNLIT:O.lightingModel=A.A.PBR;const R=d.backFaceCulling&&!s.doubleSided;e.renderStateOptions.cull.enabled=R;const M=e.alphaOptions;s.alphaMode===u.A.BLEND?M.pass=c.A.TRANSLUCENT:s.alphaMode===u.A.MASK&&(M.alphaCutoff=s.alphaCutoff),T.addFragmentLines(l.A),s.doubleSided&&T.addDefine("HAS_DOUBLE_SIDED_MATERIAL",void 0,a.A.BOTH)};const w=new o.A,x=v},963564:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(624512);const o={name:"MetadataPickingPipelineStage",METADATA_PICKING_ENABLED:"METADATA_PICKING_ENABLED",METADATA_PICKING_VALUE_TYPE:"METADATA_PICKING_VALUE_TYPE",METADATA_PICKING_VALUE_STRING:"METADATA_PICKING_VALUE_STRING",METADATA_PICKING_VALUE_COMPONENT_X:"METADATA_PICKING_VALUE_COMPONENT_X",METADATA_PICKING_VALUE_COMPONENT_Y:"METADATA_PICKING_VALUE_COMPONENT_Y",METADATA_PICKING_VALUE_COMPONENT_Z:"METADATA_PICKING_VALUE_COMPONENT_Z",METADATA_PICKING_VALUE_COMPONENT_W:"METADATA_PICKING_VALUE_COMPONENT_W",process:function(e,t,n){const r=e.shaderBuilder;r.addDefine(o.METADATA_PICKING_VALUE_TYPE,"float",i.A.FRAGMENT),r.addDefine(o.METADATA_PICKING_VALUE_STRING,"0.0",i.A.FRAGMENT),r.addDefine(o.METADATA_PICKING_VALUE_COMPONENT_X,"0.0",i.A.FRAGMENT),r.addDefine(o.METADATA_PICKING_VALUE_COMPONENT_Y,"0.0",i.A.FRAGMENT),r.addDefine(o.METADATA_PICKING_VALUE_COMPONENT_Z,"0.0",i.A.FRAGMENT),r.addDefine(o.METADATA_PICKING_VALUE_COMPONENT_W,"0.0",i.A.FRAGMENT),r.addFunction("metadataPickingStage","void metadataPickingStage(Metadata metadata, MetadataClass metadataClass, inout vec4 metadataValues)",i.A.FRAGMENT),r.addFunctionLines("metadataPickingStage",[`${o.METADATA_PICKING_VALUE_TYPE} value = ${o.METADATA_PICKING_VALUE_TYPE}(${o.METADATA_PICKING_VALUE_STRING});`,`metadataValues.x = ${o.METADATA_PICKING_VALUE_COMPONENT_X};`,`metadataValues.y = ${o.METADATA_PICKING_VALUE_COMPONENT_Y};`,`metadataValues.z = ${o.METADATA_PICKING_VALUE_COMPONENT_Z};`,`metadataValues.w = ${o.METADATA_PICKING_VALUE_COMPONENT_W};`],i.A.FRAGMENT)}},r=o},64389:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var i=n(331185),o=n(491446),r=n(624512),s=n(143938),a=n(801202),c=n(374607),l=n(471147);const u={name:"MetadataPipelineStage",STRUCT_ID_METADATA_VS:"MetadataVS",STRUCT_ID_METADATA_FS:"MetadataFS",STRUCT_NAME_METADATA:"Metadata",STRUCT_ID_METADATA_CLASS_VS:"MetadataClassVS",STRUCT_ID_METADATA_CLASS_FS:"MetadataClassFS",STRUCT_NAME_METADATA_CLASS:"MetadataClass",STRUCT_ID_METADATA_STATISTICS_VS:"MetadataStatisticsVS",STRUCT_ID_METADATA_STATISTICS_FS:"MetadataStatisticsFS",STRUCT_NAME_METADATA_STATISTICS:"MetadataStatistics",FUNCTION_ID_INITIALIZE_METADATA_VS:"initializeMetadataVS",FUNCTION_ID_INITIALIZE_METADATA_FS:"initializeMetadataFS",FUNCTION_SIGNATURE_INITIALIZE_METADATA:"void initializeMetadata(out Metadata metadata, out MetadataClass metadataClass, out MetadataStatistics metadataStatistics, ProcessedAttributes attributes)",FUNCTION_ID_SET_METADATA_VARYINGS:"setMetadataVaryings",FUNCTION_SIGNATURE_SET_METADATA_VARYINGS:"void setMetadataVaryings()",METADATA_CLASS_FIELDS:[{specName:"noData",shaderName:"noData"},{specName:"default",shaderName:"defaultValue"},{specName:"min",shaderName:"minValue"},{specName:"max",shaderName:"maxValue"}],METADATA_STATISTICS_FIELDS:[{specName:"min",shaderName:"minValue"},{specName:"max",shaderName:"maxValue"},{specName:"mean",shaderName:"mean",type:"float"},{specName:"median",shaderName:"median"},{specName:"standardDeviation",shaderName:"standardDeviation",type:"float"},{specName:"variance",shaderName:"variance",type:"float"},{specName:"sum",shaderName:"sum"}],process:function(e,t,n){const{shaderBuilder:i,model:d}=e,{structuralMetadata:f={},content:m}=d,g=m?.tileset.metadataExtension?.statistics,_=function(e,t,n){return(0,o.A)(e)?e.flatMap(e=>function(e,t,n){const{getAttributeByName:i,getAttributeInfo:o,sanitizeGlslIdentifier:s}=l.A,a=e.class.id,c=n?.classes[a],u=Object.entries(e.properties),d=new Array(u.length);for(let e=0;e<u.length;e++){const[n,a]=u[e],l=i(t,a.attribute),{glslType:h,variableName:A}=o(l);d[e]={metadataVariable:s(n),property:a,type:a.classProperty.type,glslType:h,variableName:A,propertyStatistics:c?.properties[n],shaderDestination:r.A.BOTH}}return d}(e,t,n)):[]}(f.propertyAttributes,t,g),y=function(e,t){return(0,o.A)(e)?e.flatMap(e=>function(e,t){const{sanitizeGlslIdentifier:n}=l.A,i=e.class.id,o=t?.classes[i],s=Object.entries(e.properties).filter(([e,t])=>t.isGpuCompatible()),a=new Array(s.length);for(let e=0;e<s.length;e++){const[t,i]=s[e];a[e]={metadataVariable:n(t),property:i,type:i.classProperty.type,glslType:i.getGlslType(),propertyStatistics:o?.properties[t],shaderDestination:r.A.FRAGMENT}}return a}(e,t)):[]}(f.propertyTextures,g);!function(e,t){const n=new Set,i=new Set;for(let e=0;e<t.length;e++){const{type:r,glslType:s,propertyStatistics:a}=t[e];n.add(s),(0,o.A)(a)&&r!==c.A.ENUM&&i.add(s)}const s=u.METADATA_CLASS_FIELDS;for(const e of n)l(`${e}MetadataClass`,e,s);const a=u.METADATA_STATISTICS_FIELDS;for(const e of i)l(`${e}MetadataStatistics`,e,a);function l(t,n,i){e.addStruct(t,t,r.A.BOTH);for(let o=0;o<i.length;o++){const{shaderName:r}=i[o],s="float"===i[o].type?h(n):n;e.addStructField(t,s,r)}}}(i,_.concat(y)),function(e){e.addStruct(u.STRUCT_ID_METADATA_VS,u.STRUCT_NAME_METADATA,r.A.VERTEX),e.addStruct(u.STRUCT_ID_METADATA_FS,u.STRUCT_NAME_METADATA,r.A.FRAGMENT),e.addStruct(u.STRUCT_ID_METADATA_CLASS_VS,u.STRUCT_NAME_METADATA_CLASS,r.A.VERTEX),e.addStruct(u.STRUCT_ID_METADATA_CLASS_FS,u.STRUCT_NAME_METADATA_CLASS,r.A.FRAGMENT),e.addStruct(u.STRUCT_ID_METADATA_STATISTICS_VS,u.STRUCT_NAME_METADATA_STATISTICS,r.A.VERTEX),e.addStruct(u.STRUCT_ID_METADATA_STATISTICS_FS,u.STRUCT_NAME_METADATA_STATISTICS,r.A.FRAGMENT),e.addFunction(u.FUNCTION_ID_INITIALIZE_METADATA_VS,u.FUNCTION_SIGNATURE_INITIALIZE_METADATA,r.A.VERTEX),e.addFunction(u.FUNCTION_ID_INITIALIZE_METADATA_FS,u.FUNCTION_SIGNATURE_INITIALIZE_METADATA,r.A.FRAGMENT),e.addFunction(u.FUNCTION_ID_SET_METADATA_VARYINGS,u.FUNCTION_SIGNATURE_SET_METADATA_VARYINGS,r.A.VERTEX)}(i),i.addVertexLines(a.A),i.addFragmentLines(s.A);for(let t=0;t<_.length;t++)A(e,_[t]);for(let t=0;t<y.length;t++)p(e,y[t])}},d={int:"float",ivec2:"vec2",ivec3:"vec3",ivec4:"vec4"};function h(e){const t=d[e];return(0,o.A)(t)?t:e}function A(e,t){!function(e,t){const{shaderBuilder:n}=e,{metadataVariable:i,property:o,glslType:s}=t,a=_({valueExpression:`attributes.${t.variableName}`,renderResources:e,glslType:s,metadataVariable:i,shaderDestination:r.A.BOTH,property:o});n.addStructField(u.STRUCT_ID_METADATA_VS,s,i),n.addStructField(u.STRUCT_ID_METADATA_FS,s,i);const c=`metadata.${i} = ${a};`;n.addFunctionLines(u.FUNCTION_ID_INITIALIZE_METADATA_VS,[c]),n.addFunctionLines(u.FUNCTION_ID_INITIALIZE_METADATA_FS,[c])}(e,t),f(e.shaderBuilder,t),m(e.shaderBuilder,t)}function p(e,t){!function(e,t){const{shaderBuilder:n,uniformMap:s}=e,{metadataVariable:a,glslType:c,property:l}=t,{texCoord:d,channels:h,index:A,texture:p,transform:f}=l.textureReader,m=`u_propertyTexture_${A}`;s.hasOwnProperty(m)||(n.addUniform("sampler2D",m,r.A.FRAGMENT),s[m]=()=>p),n.addStructField(u.STRUCT_ID_METADATA_FS,c,a);const g=`attributes.texCoord_${d}`;let y=g;if((0,o.A)(f)&&!i.A.equals(f,i.A.IDENTITY)){const e=`${m}Transform`;n.addUniform("mat3",e,r.A.FRAGMENT),s[e]=function(){return f},y=`vec2(${e} * vec3(${g}, 1.0))`}const v=`texture(${m}, ${y}).${h}`,T=`metadata.${a} = ${_({valueExpression:l.unpackInShader(v),renderResources:e,glslType:c,metadataVariable:a,shaderDestination:r.A.FRAGMENT,property:l})};`;n.addFunctionLines(u.FUNCTION_ID_INITIALIZE_METADATA_FS,[T])}(e,t),f(e.shaderBuilder,t),m(e.shaderBuilder,t)}function f(e,t){const{classProperty:n}=t.property,{metadataVariable:i,glslType:o,shaderDestination:s}=t,a=g(u.METADATA_CLASS_FIELDS,n,`metadataClass.${i}`,o),c=`${o}MetadataClass`;e.addStructField(u.STRUCT_ID_METADATA_CLASS_FS,c,i),e.addFunctionLines(u.FUNCTION_ID_INITIALIZE_METADATA_FS,a),r.A.includesVertexShader(s)&&(e.addStructField(u.STRUCT_ID_METADATA_CLASS_VS,c,i),e.addFunctionLines(u.FUNCTION_ID_INITIALIZE_METADATA_VS,a))}function m(e,t){const{propertyStatistics:n}=t;if(!(0,o.A)(n))return;const{metadataVariable:i,type:s,glslType:a}=t;if(s===c.A.ENUM)return;const l=g(u.METADATA_STATISTICS_FIELDS,n,`metadataStatistics.${i}`,a),d=`${a}MetadataStatistics`;e.addStructField(u.STRUCT_ID_METADATA_STATISTICS_FS,d,i),e.addFunctionLines(u.FUNCTION_ID_INITIALIZE_METADATA_FS,l),r.A.includesVertexShader(t.shaderDestination)&&(e.addStructField(u.STRUCT_ID_METADATA_STATISTICS_VS,d,i),e.addFunctionLines(u.FUNCTION_ID_INITIALIZE_METADATA_VS,l))}function g(e,t,n,i){return(0,o.A)(t)?e.map(function(e){const r=t[e.specName];if((0,o.A)(r))return`${n}.${e.shaderName} = ${i}(${r});`}).filter(o.A):[]}function _(e){const{valueExpression:t,property:n}=e;if(!n.hasValueTransform)return t;const i=e.metadataVariable,o=`u_${i}_offset`,r=`u_${i}_scale`,{shaderBuilder:s,uniformMap:a}=e.renderResources,{glslType:c,shaderDestination:l}=e;s.addUniform(c,o,l),s.addUniform(c,r,l);const{offset:u,scale:d}=n;return a[o]=()=>u,a[r]=()=>d,`czm_valueTransform(${o}, ${r}, ${t})`}const y=u},623379:(e,t,n)=>{"use strict";n.d(t,{A:()=>de});var i=n(660662),o=n(267980),r=n(336946),s=n(369031),a=n(607502),c=n(41476),l=n(491446),u=n(915325),d=n(605971),h=n(677354),A=n(853331),p=n(610750),f=n(955943),m=n(331185),g=n(584164),_=n(744603),y=n(123245),v=n(760866),T=n(711284),b=n(348460),w=n(615557),x=n(428027),C=n(982504),E=n(63316),S=n(208198),I=n(929771),P=n(62467),D=n(78173),O=n(988609),R=n(913419),M=n(802227),L=n(66502),N=n(521032),B=n(4773),F=n(947129),U=n(814071),k=n(650884),V=n(226827),z=n(471147),H=n(983884),G=n(31908),W=n(942836),Y=n(965020),q=n(701111);function j(e){e=e??u.A.EMPTY_OBJECT,s.A.typeOf.object("options.loader",e.loader),s.A.typeOf.object("options.resource",e.resource),this._loader=e.loader,this._resource=e.resource,this.type=e.type??V.A.GLTF,this.modelMatrix=g.A.clone(e.modelMatrix??g.A.IDENTITY),this._modelMatrix=g.A.clone(this.modelMatrix),this._scale=e.scale??1,this._minimumPixelSize=e.minimumPixelSize??0,this._maximumScale=e.maximumScale,this._clampedScale=(0,l.A)(this._maximumScale)?Math.min(this._scale,this._maximumScale):this._scale,this._computedScale=this._clampedScale,this._updateModelMatrix=!1,this.referenceMatrix=void 0,this._iblReferenceFrameMatrix=m.A.clone(m.A.IDENTITY),this._resourcesLoaded=!1,this._drawCommandsBuilt=!1,this._ready=!1,this._customShader=e.customShader,this._content=e.content,this._texturesLoaded=!1,this._defaultTexture=void 0,this._activeAnimations=new B.A(this),this._clampAnimations=e.clampAnimations??!0,this._userAnimationDirty=!1,this._id=e.id,this._idDirty=!1,this._color=c.A.clone(e.color),this._colorBlendMode=e.colorBlendMode??x.A.HIGHLIGHT,this._colorBlendAmount=e.colorBlendAmount??.5;const t=e.silhouetteColor??c.A.RED;this._silhouetteColor=c.A.clone(t),this._silhouetteSize=e.silhouetteSize??0,this._silhouetteDirty=!1,this._silhouetteId=void 0,this._cull=e.cull??!0,this._opaquePass=e.opaquePass??v.A.OPAQUE,this._allowPicking=e.allowPicking??!0,this._show=e.show??!0,this._style=void 0,this._styleDirty=!1,this._styleCommandsNeeded=void 0;let n=e.featureIdLabel??"featureId_0";"number"==typeof n&&(n=`featureId_${n}`),this._featureIdLabel=n;let r=e.instanceFeatureIdLabel??"instanceFeatureId_0";"number"==typeof r&&(r=`instanceFeatureId_${r}`),this._instanceFeatureIdLabel=r,this._featureTables=[],this._featureTableId=void 0,this._featureTableIdDirty=!0,this._pipelineResources=[],this._modelResources=[],this._pickIds=[],this._boundingSphere=new i.A,this._initialRadius=void 0,this._heightReference=e.heightReference??E.Ay.NONE,this._heightDirty=this._heightReference!==E.Ay.NONE,this._removeUpdateHeightCallback=void 0,this._enableVerticalExaggeration=e.enableVerticalExaggeration??!0,this._hasVerticalExaggeration=!1,this._clampedModelMatrix=void 0;const d=e.scene;(0,l.A)(d)&&(0,l.A)(d.terrainProviderChanged)&&(this._terrainProviderChangedCallback=d.terrainProviderChanged.addEventListener(()=>{this._heightDirty=!0})),this._scene=d,this._distanceDisplayCondition=e.distanceDisplayCondition;const h=new I.A(e.pointCloudShading);this._pointCloudShading=h,this._attenuation=h.attenuation,this._pointCloudBackFaceCulling=h.backFaceCulling;const A=e.clippingPlanes;(0,l.A)(A)&&void 0===A.owner?T.A.setOwner(A,this,"_clippingPlanes"):this._clippingPlanes=A,this._clippingPlanesState=0,this._clippingPlanesMatrix=g.A.clone(g.A.IDENTITY);const p=e.clippingPolygons;(0,l.A)(p)&&void 0===p.owner?b.A.setOwner(p,this,"_clippingPolygons"):this._clippingPolygons=p,this._clippingPolygonsState=0,this._modelImagery=new q.A(this),this._lightColor=o.A.clone(e.lightColor),this._imageBasedLighting=(0,l.A)(e.imageBasedLighting)?e.imageBasedLighting:new S.A,this._shouldDestroyImageBasedLighting=!(0,l.A)(e.imageBasedLighting),this._environmentMapManager=void 0;const _=new w.A(e.environmentMapOptions);w.A.setOwner(_,this,"_environmentMapManager"),this._backFaceCulling=e.backFaceCulling??!0,this._backFaceCullingDirty=!1,this._shadows=e.shadows??O.A.ENABLED,this._shadowsDirty=!1,this._debugShowBoundingVolumeDirty=!1,this._debugShowBoundingVolume=e.debugShowBoundingVolume??!1,this._enableDebugWireframe=e.enableDebugWireframe??!1,this._enableShowOutline=e.enableShowOutline??!0,this._debugWireframe=e.debugWireframe??!1,!0===this._debugWireframe&&!1===this._enableDebugWireframe&&this.type===V.A.GLTF&&(0,H.A)("model-debug-wireframe-ignored","enableDebugWireframe must be set to true in Model.fromGltf, otherwise debugWireframe will be ignored.");let y=e.credit;"string"==typeof y&&(y=new a.A(y)),this._credits=[],this._credit=y,this._resourceCredits=[],this._gltfCredits=[],this._showCreditsOnScreen=e.showCreditsOnScreen??!1,this._showCreditsOnScreenDirty=!0,this._splitDirection=e.splitDirection??R.A.NONE,this._enableShowOutline=e.enableShowOutline??!0,this.showOutline=e.showOutline??!0,this.outlineColor=e.outlineColor??c.A.BLACK,this._classificationType=e.classificationType,this._statistics=new k.A,this._sceneMode=void 0,this._projectTo2D=e.projectTo2D??!1,this._enablePick=e.enablePick??!1,this._fogRenderable=void 0,this._skipLevelOfDetail=!1,this._ignoreCommands=e.ignoreCommands??!1,this._errorEvent=new f.A,this._readyEvent=new f.A,this._texturesReadyEvent=new f.A,this._sceneGraph=void 0,this._nodesByName={},this.pickObject=e.pickObject}function Q(e,t){e._errorEvent.numberOfListeners>0?e._errorEvent.raiseEvent(t):console.log(t)}function X(e,t){if(!(0,l.A)(e)&&!(0,l.A)(t))return!1;if((0,l.A)(e)!==(0,l.A)(t))return!0;const n=e.alpha,i=t.alpha;return Math.floor(n)!==Math.floor(i)||Math.ceil(n)!==Math.ceil(i)}Object.defineProperties(j.prototype,{ready:{get:function(){return this._ready}},errorEvent:{get:function(){return this._errorEvent}},readyEvent:{get:function(){return this._readyEvent}},incrementallyLoadTextures:{get:function(){return this._loader.incrementallyLoadTextures??!1}},texturesReadyEvent:{get:function(){return this._texturesReadyEvent}},loader:{get:function(){return this._loader}},statistics:{get:function(){return this._statistics}},activeAnimations:{get:function(){return this._activeAnimations}},clampAnimations:{get:function(){return this._clampAnimations},set:function(e){this._clampAnimations=e}},cull:{get:function(){return this._cull}},opaquePass:{get:function(){return this._opaquePass}},pointCloudShading:{get:function(){return this._pointCloudShading},set:function(e){s.A.defined("pointCloudShading",e),e!==this._pointCloudShading&&this.resetDrawCommands(),this._pointCloudShading=e}},customShader:{get:function(){return this._customShader},set:function(e){e!==this._customShader&&this.resetDrawCommands(),this._customShader=e}},sceneGraph:{get:function(){return this._sceneGraph}},content:{get:function(){return this._content}},heightReference:{get:function(){return this._heightReference},set:function(e){e!==this._heightReference&&(this._heightDirty=!0),this._heightReference=e}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if((0,l.A)(e)&&e.far<=e.near)throw new d.A("far must be greater than near");this._distanceDisplayCondition=A.A.clone(e,this._distanceDisplayCondition)}},structuralMetadata:{get:function(){return this._sceneGraph.components.structuralMetadata}},featureTableId:{get:function(){return this._featureTableId},set:function(e){this._featureTableId=e}},featureTables:{get:function(){return this._featureTables},set:function(e){this._featureTables=e}},id:{get:function(){return this._id},set:function(e){e!==this._id&&(this._idDirty=!0),this._id=e}},allowPicking:{get:function(){return this._allowPicking}},style:{get:function(){return this._style},set:function(e){this._style=e,this._styleDirty=!0}},color:{get:function(){return this._color},set:function(e){X(e,this._color)&&this.resetDrawCommands(),this._color=c.A.clone(e,this._color)}},colorBlendMode:{get:function(){return this._colorBlendMode},set:function(e){this._colorBlendMode=e}},colorBlendAmount:{get:function(){return this._colorBlendAmount},set:function(e){this._colorBlendAmount=e}},silhouetteColor:{get:function(){return this._silhouetteColor},set:function(e){if(!c.A.equals(e,this._silhouetteColor)){const t=X(e,this._silhouetteColor);this._silhouetteDirty=this._silhouetteDirty||t}this._silhouetteColor=c.A.clone(e,this._silhouetteColor)}},silhouetteSize:{get:function(){return this._silhouetteSize},set:function(e){if(e!==this._silhouetteSize){const t=this._silhouetteSize,n=e>0&&0===t||0===e&&t>0;this._silhouetteDirty=this._silhouetteDirty||n,this._backFaceCullingDirty=this._backFaceCullingDirty||n}this._silhouetteSize=e}},boundingSphere:{get:function(){if(!this._ready)throw new d.A("The model is not loaded. Use Model.readyEvent or wait for Model.ready to be true.");return ne(this,(0,l.A)(this._clampedModelMatrix)?this._clampedModelMatrix:this.modelMatrix),this._boundingSphere}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume!==e&&(this._debugShowBoundingVolumeDirty=!0),this._debugShowBoundingVolume=e}},debugWireframe:{get:function(){return this._debugWireframe},set:function(e){this._debugWireframe!==e&&this.resetDrawCommands(),this._debugWireframe=e,!0===this._debugWireframe&&!1===this._enableDebugWireframe&&this.type===V.A.GLTF&&(0,H.A)("model-debug-wireframe-ignored","enableDebugWireframe must be set to true in Model.fromGltfAsync, otherwise debugWireframe will be ignored.")}},show:{get:function(){return this._show},set:function(e){this._show=e}},featureIdLabel:{get:function(){return this._featureIdLabel},set:function(e){"number"==typeof e&&(e=`featureId_${e}`),s.A.typeOf.string("value",e),e!==this._featureIdLabel&&(this._featureTableIdDirty=!0),this._featureIdLabel=e}},instanceFeatureIdLabel:{get:function(){return this._instanceFeatureIdLabel},set:function(e){"number"==typeof e&&(e=`instanceFeatureId_${e}`),s.A.typeOf.string("value",e),e!==this._instanceFeatureIdLabel&&(this._featureTableIdDirty=!0),this._instanceFeatureIdLabel=e}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){e!==this._clippingPlanes&&(T.A.setOwner(e,this,"_clippingPlanes"),this.resetDrawCommands())}},clippingPolygons:{get:function(){return this._clippingPolygons},set:function(e){e!==this._clippingPolygons&&(b.A.setOwner(e,this,"_clippingPolygons"),this.resetDrawCommands())}},enableVerticalExaggeration:{get:function(){return this._enableVerticalExaggeration},set:function(e){e!==this._enableVerticalExaggeration&&this.resetDrawCommands(),this._enableVerticalExaggeration=e}},hasVerticalExaggeration:{get:function(){return this._hasVerticalExaggeration}},imageryLayers:{get:function(){if((0,l.A)(this._content)){const e=this._content.tileset;if((0,l.A)(e))return e.imageryLayers}}},lightColor:{get:function(){return this._lightColor},set:function(e){(0,l.A)(e)!==(0,l.A)(this._lightColor)&&this.resetDrawCommands(),this._lightColor=o.A.clone(e,this._lightColor)}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){s.A.typeOf.object("imageBasedLighting",e),e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1,this.resetDrawCommands())}},environmentMapManager:{get:function(){return this._environmentMapManager},set:function(e){s.A.typeOf.object("environmentMapManager",e),e!==this.environmentMapManager&&(w.A.setOwner(e,this,"_environmentMapManager"),this.resetDrawCommands())}},backFaceCulling:{get:function(){return this._backFaceCulling},set:function(e){e!==this._backFaceCulling&&(this._backFaceCullingDirty=!0),this._backFaceCulling=e}},scale:{get:function(){return this._scale},set:function(e){e!==this._scale&&(this._updateModelMatrix=!0),this._scale=e}},computedScale:{get:function(){return this._computedScale}},minimumPixelSize:{get:function(){return this._minimumPixelSize},set:function(e){e!==this._minimumPixelSize&&(this._updateModelMatrix=!0),this._minimumPixelSize=e}},maximumScale:{get:function(){return this._maximumScale},set:function(e){e!==this._maximumScale&&(this._updateModelMatrix=!0),this._maximumScale=e}},shadows:{get:function(){return this._shadows},set:function(e){e!==this._shadows&&(this._shadowsDirty=!0),this._shadows=e}},credit:{get:function(){return this._credit}},showCreditsOnScreen:{get:function(){return this._showCreditsOnScreen},set:function(e){this._showCreditsOnScreen!==e&&(this._showCreditsOnScreenDirty=!0),this._showCreditsOnScreen=e}},splitDirection:{get:function(){return this._splitDirection},set:function(e){this._splitDirection!==e&&this.resetDrawCommands(),this._splitDirection=e}},classificationType:{get:function(){return this._classificationType}},pickIds:{get:function(){return this._pickIds}},styleCommandsNeeded:{get:function(){return this._styleCommandsNeeded}}}),j.prototype.getNode=function(e){if(!this._ready)throw new d.A("The model is not loaded. Use Model.readyEvent or wait for Model.ready to be true.");return s.A.typeOf.string("name",e),this._nodesByName[e]},j.prototype.setArticulationStage=function(e,t){if(s.A.typeOf.number("value",t),!this._ready)throw new d.A("The model is not loaded. Use Model.readyEvent or wait for Model.ready to be true.");this._sceneGraph.setArticulationStage(e,t)},j.prototype.applyArticulations=function(){if(!this._ready)throw new d.A("The model is not loaded. Use Model.readyEvent or wait for Model.ready to be true.");this._sceneGraph.applyArticulations()},j.prototype.getExtension=function(e){if(s.A.typeOf.string("extensionName",e),!this._ready)throw new d.A("The model is not loaded. Use Model.readyEvent or wait for Model.ready to be true.");return this._loader.components.extensions[e]},j.prototype.makeStyleDirty=function(){this._styleDirty=!0},j.prototype.resetDrawCommands=function(){this._drawCommandsBuilt=!1};const K=new g.A,$=new m.A,J=new g.A;function Z(e){const t=e.featureTables[e.featureTableId];e._styleCommandsNeeded=W.A.getStyleCommandsNeeded(t.featuresLength,t.batchTexture.translucentFeaturesLength)}j.prototype.update=function(e){let t=!1;try{t=function(e,t){return!(!e._resourcesLoaded||e._loader.incrementallyLoadTextures&&!e._texturesLoaded)||(t.afterRender.push(()=>!0),e._loader.process(t))}(this,e)}catch(e){this._loader.incrementallyLoadTextures||"TextureError"!==e.name?Q(this,z.A.getError("model",this._resource,e)):Q(this,e)}if(function(e,t){(0,l.A)(e._customShader)&&e._customShader.update(t)}(this,e),function(e,t){const n=e._environmentMapManager,i=t.passes.pick||t.passes.pickVoxel;e._ready&&n.owner===e&&!i&&(n.position=e._boundingSphere.center,n.shouldUpdate=!(0,l.A)(e._imageBasedLighting.sphericalHarmonicCoefficients)||!(0,l.A)(e._imageBasedLighting.specularEnvironmentMaps),n.update(t),n.shouldRegenerateShaders&&e.resetDrawCommands())}(this,e),function(e,t){e._imageBasedLighting.update(t),e._imageBasedLighting.shouldRegenerateShaders&&e.resetDrawCommands()}(this,e),!this._resourcesLoaded&&t){this._resourcesLoaded=!0;const e=this._loader.components;if(!(0,l.A)(e)){if(this._loader.isUnloaded())return;const e=z.A.getError("model",this._resource,new y.A("Failed to load model."));Q(e),this._rejectLoad=this._rejectLoad&&this._rejectLoad(e)}const t=e.structuralMetadata;(0,l.A)(t)&&t.propertyTableCount>0&&function(e,t){const n=e._featureTables,i=t.propertyTables,o=i.length;for(let t=0;t<o;t++){const o=i[t],r=new F.A({model:e,propertyTable:o});n.push(r)}}(this,t);const n=new U.A({model:this,modelComponents:e});this._sceneGraph=n,this._gltfCredits=n.components.asset.credits}if(!this._resourcesLoaded||e.mode===P.A.MORPHING)return;const n=this._modelImagery;var i;(n.update(e),n.ready||this._content?.tileset?._asynchronouslyLoadImagery)&&(!function(e){if(!e._featureTableIdDirty)return;e._featureTableIdDirty=!1;const t=e._sceneGraph.components,n=t.structuralMetadata;(0,l.A)(n)&&n.propertyTableCount>0&&(e.featureTableId=function(e,t){const n=t._featureIdLabel,i=t._instanceFeatureIdLabel;let o,r,s,a;for(o=0;o<e.nodes.length;o++)if(a=e.nodes[o],(0,l.A)(a.instances)&&(s=z.A.getFeatureIdsByLabel(a.instances.featureIds,i),(0,l.A)(s)&&(0,l.A)(s.propertyTableId)))return s.propertyTableId;for(o=0;o<e.nodes.length;o++)for(a=e.nodes[o],r=0;r<a.primitives.length;r++){const e=a.primitives[r],t=z.A.getFeatureIdsByLabel(e.featureIds,n);if((0,l.A)(t))return t.propertyTableId}if(1===t._featureTables.length)return 0}(t,e),e._styleDirty=!0,e.resetDrawCommands())}(this),(i=this)._styleDirty&&(i.applyStyle(i._style),i._styleDirty=!1),function(e,t){const n=e._featureTables,i=n.length;let o=!1;for(let e=0;e<i;e++)n[e].update(t),n[e].styleCommandsNeededDirty&&(o=!0);o&&Z(e)}(this,e),function(e){const t=e.pointCloudShading;t.attenuation!==e._attenuation&&(e.resetDrawCommands(),e._attenuation=t.attenuation),t.backFaceCulling!==e._pointCloudBackFaceCulling&&(e.resetDrawCommands(),e._pointCloudBackFaceCulling=t.backFaceCulling)}(this),function(e,t){e._silhouetteDirty&&(ce(t)&&e.resetDrawCommands(),e._silhouetteDirty=!1)}(this,e),function(e,t){const n=e.hasSkipLevelOfDetail(t);n!==e._skipLevelOfDetail&&(e.resetDrawCommands(),e._skipLevelOfDetail=n)}(this,e),function(e,t){let n=0;e.isClippingEnabled()&&(e._clippingPlanes.owner===e&&e._clippingPlanes.update(t),n=e._clippingPlanes.clippingPlanesState),n!==e._clippingPlanesState&&(e.resetDrawCommands(),e._clippingPlanesState=n)}(this,e),function(e,t){let n=0;e.isClippingPolygonsEnabled()&&(e._clippingPolygons.owner===e&&(e._clippingPolygons.update(t),e._clippingPolygons.queueCommands(t)),n=e._clippingPolygons.clippingPolygonsState),n!==e._clippingPolygonsState&&(e.resetDrawCommands(),e._clippingPolygonsState=n)}(this,e),function(e,t){t.mode!==e._sceneMode&&(e._projectTo2D?e.resetDrawCommands():e._updateModelMatrix=!0,e._sceneMode=t.mode)}(this,e),function(e,t){const n=t.fog.enabled&&t.fog.renderable;n!==e._fogRenderable&&(e.resetDrawCommands(),e._fogRenderable=n)}(this,e),function(e,t){if(e.enableVerticalExaggeration){const n=1!==t.verticalExaggeration;e.hasVerticalExaggeration!==n&&(e.resetDrawCommands(),e._hasVerticalExaggeration=n)}else e.hasVerticalExaggeration&&(e.resetDrawCommands(),e._hasVerticalExaggeration=!1)}(this,e),this._defaultTexture=e.context.defaultTexture,function(e,t){e._drawCommandsBuilt||(e.destroyPipelineResources(),e._sceneGraph.buildDrawCommands(t),e._drawCommandsBuilt=!0)}(this,e),function(e,t){if(!g.A.equals(e.modelMatrix,e._modelMatrix)){if(t.mode!==P.A.SCENE3D&&e._projectTo2D)throw new d.A("Model.modelMatrix cannot be changed in 2D or Columbus View if projectTo2D is true.");e._updateModelMatrix=!0,e._modelMatrix=g.A.clone(e.modelMatrix,e._modelMatrix)}}(this,e),function(e){if(!e._updateModelMatrix&&!e._heightDirty&&0===e._minimumPixelSize)return;(0,l.A)(e._removeUpdateHeightCallback)&&(e._removeUpdateHeightCallback(),e._removeUpdateHeightCallback=void 0);const t=e._scene;if(!(0,l.A)(t)||e.heightReference===E.Ay.NONE){if(e.heightReference!==E.Ay.NONE)throw new d.A("Height reference is not supported without a scene.");return void(e._clampedModelMatrix=void 0)}const n=t.ellipsoid??p.A.default,i=e.modelMatrix;ee.x=i[12],ee.y=i[13],ee.z=i[14];const o=n.cartesianToCartographic(ee);(0,l.A)(e._clampedModelMatrix)||(e._clampedModelMatrix=g.A.clone(i,new g.A)),e._removeUpdateHeightCallback=t.updateHeight(o,se(e,n,o),e.heightReference);const s=t.getHeight(o,e.heightReference);if((0,l.A)(s)){const t=se(e,n,o);r.A.clone(o,te),te.height=s,t(te)}e._heightDirty=!1,e._updateModelMatrix=!0}(this),function(e,t){if(!e._updateModelMatrix&&0===e._minimumPixelSize)return;const n=(0,l.A)(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;ne(e,n),function(e,t,n){let i=e.scale;if(0!==e.minimumPixelSize&&!e._projectTo2D){const o=n.context,r=Math.max(o.drawingBufferWidth,o.drawingBufferHeight);g.A.getTranslation(t,ee),e._sceneMode!==P.A.SCENE3D&&D.A.computeActualEllipsoidPosition(n,ee,ee);const s=e._boundingSphere.radius,a=function(e,t,n){return oe.center=e,oe.radius=t,n.camera.getPixelSize(oe,n.context.drawingBufferWidth,n.context.drawingBufferHeight)}(ee,s,n),c=1/a;Math.min(c*(2*s),r)<e.minimumPixelSize&&(i=e.minimumPixelSize*a/(2*e._initialRadius))}e._computedScale=(0,l.A)(e.maximumScale)?Math.min(e.maximumScale,i):i}(e,n,t)}(this,e),function(e,t){const n=(0,l.A)(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix,i=e.referenceMatrix??n,o=t.context;let r=$,s=K;if(s=g.A.multiply(o.uniformState.view3D,i,s),r=g.A.getRotation(s,r),r=m.A.transpose(r,r),e._iblReferenceFrameMatrix=m.A.multiply(ie,r,e._iblReferenceFrameMatrix),e.isClippingEnabled()){let t=J;t=g.A.multiply(o.uniformState.view3D,i,t),t=g.A.multiply(t,e._clippingPlanes.modelMatrix,t),e._clippingPlanesMatrix=g.A.inverseTranspose(t,e._clippingPlanesMatrix)}}(this,e),this._ready?(this._loader.incrementallyLoadTextures&&!this._texturesLoaded&&this._loader.texturesLoaded&&(this.resetDrawCommands(),this._texturesLoaded=!0,this._texturesReadyEvent.raiseEvent(this)),function(e){if(!e._idDirty)return;e._idDirty=!1;const t=e._id,n=e._pickIds,i=n.length;for(let e=0;e<i;++e)n[e].object.id=t}(this),function(e,t){const n=e._sceneGraph;if(e._updateModelMatrix||0!==e._minimumPixelSize){const i=(0,l.A)(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;n.updateModelMatrix(i,t),e._updateModelMatrix=!1}e._backFaceCullingDirty&&(n.updateBackFaceCulling(e._backFaceCulling),e._backFaceCullingDirty=!1),e._shadowsDirty&&(n.updateShadows(e._shadows),e._shadowsDirty=!1),e._debugShowBoundingVolumeDirty&&(n.updateShowBoundingVolume(e._debugShowBoundingVolume),e._debugShowBoundingVolumeDirty=!1);let i=!1;(0,l.A)(e.classificationType)||(i=e._userAnimationDirty||e._activeAnimations.update(t)),n.update(t,i),e._userAnimationDirty=!1}(this,e),function(e){if(!e._showCreditsOnScreenDirty)return;e._showCreditsOnScreenDirty=!1,e._credits.length=0;const t=e._showCreditsOnScreen;if((0,l.A)(e._credit)){const n=a.A.clone(e._credit);n.showOnScreen=n.showOnScreen||t,e._credits.push(n)}const n=e._resourceCredits,i=n.length;for(let o=0;o<i;o++){const i=a.A.clone(n[o]);i.showOnScreen=i.showOnScreen||t,e._credits.push(i)}const o=e._gltfCredits,r=o.length;for(let n=0;n<r;n++){const i=a.A.clone(o[n]);i.showOnScreen=i.showOnScreen||t,e._credits.push(i)}}(this),function(e,t){const n=function(e,t){const n=e.distanceDisplayCondition;if(!(0,l.A)(n))return!0;const i=n.near*n.near,r=n.far*n.far;let s;if(t.mode===P.A.SCENE2D){const e=.5*(t.camera.frustum.right-t.camera.frustum.left);s=e*e}else{const n=g.A.getTranslation(e.modelMatrix,ae);D.A.computeActualEllipsoidPosition(t,n,n),s=o.A.distanceSquared(n,t.camera.positionWC)}return s>=i&&s<=r}(e,t),i=e.isInvisible(),r=e.hasSilhouette(t),s=e._show&&0!==e._computedScale&&n&&(!i||r),a=t.passes,c=a.render||a.pick&&e.allowPicking;s&&!e._ignoreCommands&&c&&(function(e,t){const n=t.creditDisplay,i=e._credits,o=i.length;for(let e=0;e<o;e++)n.addCreditToNextFrame(i[e])}(e,t),e._sceneGraph.pushDrawCommands(t))}(this,e)):e.afterRender.push(()=>{this._ready=!0,this._readyEvent.raiseEvent(this)}))};const ee=new o.A,te=new r.A;function ne(e,t){e._clampedScale=(0,l.A)(e._maximumScale)?Math.min(e._scale,e._maximumScale):e._scale,e._boundingSphere.center=o.A.multiplyByScalar(e._sceneGraph.boundingSphere.center,e._clampedScale,e._boundingSphere.center),e._boundingSphere.radius=e._initialRadius*e._clampedScale,e._boundingSphere=i.A.transform(e._boundingSphere,t,e._boundingSphere)}const ie=new m.A(1,0,0,0,0,1,0,-1,0),oe=new i.A,re=new o.A;function se(e,t,n){return function(i){(0,E.Lq)(e.heightReference)&&(i.height+=n.height),t.cartographicToCartesian(i,re);const o=e._clampedModelMatrix;g.A.clone(e.modelMatrix,o),o[12]=re.x,o[13]=re.y,o[14]=re.z,e._heightDirty=!0}}const ae=new o.A;function ce(e){return e.context.stencilBuffer}j.prototype.isTranslucent=function(){const e=this.color;return(0,l.A)(e)&&e.alpha>0&&e.alpha<1},j.prototype.isInvisible=function(){const e=this.color;return(0,l.A)(e)&&0===e.alpha},j.prototype.hasSilhouette=function(e){return ce(e)&&this._silhouetteSize>0&&this._silhouetteColor.alpha>0&&!(0,l.A)(this._classificationType)},j.prototype.hasSkipLevelOfDetail=function(e){if(!V.A.is3DTiles(this.type))return!1;const t=e.context.stencilBuffer,n=this._content.tileset;return t&&n.isSkippingLevelOfDetail},j.prototype.isClippingEnabled=function(){const e=this._clippingPlanes;return(0,l.A)(e)&&e.enabled&&0!==e.length},j.prototype.pick=function(e,t,n,i,o){return(0,Y.A)(this,e,t,n,i,o)},j.prototype.isClippingPolygonsEnabled=function(){const e=this._clippingPolygons;return(0,l.A)(e)&&e.enabled&&0!==e.length},j.prototype.isDestroyed=function(){return!1},j.prototype.destroy=function(){const e=this._loader;(0,l.A)(e)&&e.destroy();const t=this._featureTables;if((0,l.A)(t)){const e=t.length;for(let n=0;n<e;n++)t[n].destroy()}this.destroyPipelineResources(),this.destroyModelResources(),(0,l.A)(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),(0,l.A)(this._terrainProviderChangedCallback)&&(this._terrainProviderChangedCallback(),this._terrainProviderChangedCallback=void 0);const n=this._clippingPlanes;(0,l.A)(n)&&!n.isDestroyed()&&n.owner===this&&n.destroy(),this._clippingPlanes=void 0;const i=this._clippingPolygons;(0,l.A)(i)&&!i.isDestroyed()&&i.owner===this&&i.destroy(),this._clippingPolygons=void 0,this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0;const o=this._environmentMapManager;o.isDestroyed()||o.owner!==this||o.destroy(),this._environmentMapManager=void 0,(0,h.A)(this)},j.prototype.destroyPipelineResources=function(){const e=this._pipelineResources;for(let t=0;t<e.length;t++)e[t].destroy();this._pipelineResources.length=0,this._pickIds.length=0},j.prototype.destroyModelResources=function(){const e=this._modelResources;for(let t=0;t<e.length;t++)e[t].destroy();this._modelResources.length=0},j.fromGltfAsync=async function(e){if(e=e??u.A.EMPTY_OBJECT,!(0,l.A)(e.url)&&!(0,l.A)(e.gltf))throw new d.A("options.url is required.");const t=e.url??e.gltf,n={releaseGltfJson:e.releaseGltfJson,asynchronous:e.asynchronous,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis,loadAttributesFor2D:e.projectTo2D,enablePick:e.enablePick,loadIndicesForWireframe:e.enableDebugWireframe,loadPrimitiveOutline:e.enableShowOutline,loadForClassification:(0,l.A)(e.classificationType)},i=e.basePath??"",o=_.A.createIfNeeded(i);(0,l.A)(t.asset)?(n.gltfJson=t,n.baseResource=o,n.gltfResource=o):t instanceof Uint8Array?(n.typedArray=t,n.baseResource=o,n.gltfResource=o):n.gltfResource=_.A.createIfNeeded(t);const r=new C.A(n),c=(0,l.A)(e.content)?V.A.TILE_GLTF:V.A.GLTF,h=n.gltfResource,A=ue(r,c,e);A.resource=h,A.environmentMapOptions=e.environmentMapOptions;try{await r.load()}catch(e){throw r.destroy(),z.A.getError("model",h,e)}const p=e.gltfCallback;(0,l.A)(p)&&(s.A.typeOf.func("options.gltfCallback",p),p(r.gltfJson));const f=new j(A),m=f._resource.credits;if((0,l.A)(m)){const e=m.length;for(let t=0;t<e;t++)f._resourceCredits.push(a.A.clone(m[t]))}return f},j.fromB3dm=async function(e){const t={b3dmResource:e.resource,arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset,releaseGltfJson:e.releaseGltfJson,asynchronous:e.asynchronous,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis,loadAttributesFor2D:e.projectTo2D,enablePick:e.enablePick,loadIndicesForWireframe:e.enableDebugWireframe,loadPrimitiveOutline:e.enableShowOutline,loadForClassification:(0,l.A)(e.classificationType)},n=new M.A(t);try{await n.load();return new j(ue(n,V.A.TILE_B3DM,e))}catch(e){throw n.destroy(),e}},j.fromPnts=async function(e){const t={arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset,loadAttributesFor2D:e.projectTo2D},n=new G.A(t);try{await n.load();return new j(ue(n,V.A.TILE_PNTS,e))}catch(e){throw n.destroy(),e}},j.fromI3dm=async function(e){const t={i3dmResource:e.resource,arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset,releaseGltfJson:e.releaseGltfJson,asynchronous:e.asynchronous,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis,loadAttributesFor2D:e.projectTo2D,enablePick:e.enablePick,loadIndicesForWireframe:e.enableDebugWireframe,loadPrimitiveOutline:e.enableShowOutline},n=new N.A(t);try{await n.load();return new j(ue(n,V.A.TILE_I3DM,e))}catch(e){throw n.destroy(),e}},j.fromGeoJson=async function(e){const t={geoJson:e.geoJson};return new j(ue(new L.A(t),V.A.TILE_GEOJSON,e))};const le=new c.A;function ue(e,t,n){return{loader:e,type:t,resource:n.resource,show:n.show,modelMatrix:n.modelMatrix,scale:n.scale,enableVerticalExaggeration:n.enableVerticalExaggeration,minimumPixelSize:n.minimumPixelSize,maximumScale:n.maximumScale,id:n.id,allowPicking:n.allowPicking,clampAnimations:n.clampAnimations,shadows:n.shadows,debugShowBoundingVolume:n.debugShowBoundingVolume,enableDebugWireframe:n.enableDebugWireframe,debugWireframe:n.debugWireframe,cull:n.cull,opaquePass:n.opaquePass,customShader:n.customShader,content:n.content,heightReference:n.heightReference,scene:n.scene,distanceDisplayCondition:n.distanceDisplayCondition,color:n.color,colorBlendAmount:n.colorBlendAmount,colorBlendMode:n.colorBlendMode,silhouetteColor:n.silhouetteColor,silhouetteSize:n.silhouetteSize,enableShowOutline:n.enableShowOutline,showOutline:n.showOutline,outlineColor:n.outlineColor,clippingPlanes:n.clippingPlanes,clippingPolygons:n.clippingPolygons,lightColor:n.lightColor,imageBasedLighting:n.imageBasedLighting,backFaceCulling:n.backFaceCulling,credit:n.credit,showCreditsOnScreen:n.showCreditsOnScreen,splitDirection:n.splitDirection,projectTo2D:n.projectTo2D,enablePick:n.enablePick,featureIdLabel:n.featureIdLabel,instanceFeatureIdLabel:n.instanceFeatureIdLabel,pointCloudShading:n.pointCloudShading,classificationType:n.classificationType,pickObject:n.pickObject}}j.prototype.applyColorAndShow=function(e){const t=c.A.clone(this._color,le),n=(0,l.A)(e)&&(0,l.A)(e.color),i=(0,l.A)(e)&&(0,l.A)(e.show);this._color=n?e.color.evaluateColor(void 0,this._color):c.A.clone(c.A.WHITE,this._color),this._show=!i||e.show.evaluate(void 0),X(t,this._color)&&this.resetDrawCommands()},j.prototype.applyStyle=function(e){const t=this.type===V.A.TILE_PNTS,n=(0,l.A)(this.featureTableId)&&this.featureTables[this.featureTableId].featuresLength>0,i=(0,l.A)(this.structuralMetadata)?this.structuralMetadata.propertyAttributes:void 0,o=(0,l.A)(i)&&(0,l.A)(i[0]);!t||n&&!o?n?(this.featureTables[this.featureTableId].applyStyle(e),Z(this)):(this.applyColorAndShow(e),this._styleCommandsNeeded=void 0):this.resetDrawCommands()};const de=j},224975:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(41476),o=n(430346),r=n(491446),s=n(677354),a=n(605971),c=n(610750),l=n(760866),u=n(598361),d=n(623379);function h(e,t,n){this._tileset=e,this._tile=t,this._resource=n,this._model=void 0,this._metadata=void 0,this._group=void 0,this._ready=!1}function A(e,t,n,i){const r={cull:!1,releaseGltfJson:!0,opaquePass:l.A.CESIUM_3D_TILE,modelMatrix:t.computedTransform,upAxis:e._modelUpAxis,forwardAxis:e._modelForwardAxis,incrementallyLoadTextures:!1,customShader:e.customShader,content:n,colorBlendMode:e.colorBlendMode,colorBlendAmount:e.colorBlendAmount,lightColor:e.lightColor,imageBasedLighting:e.imageBasedLighting,featureIdLabel:e.featureIdLabel,instanceFeatureIdLabel:e.instanceFeatureIdLabel,pointCloudShading:e.pointCloudShading,clippingPlanes:e.clippingPlanes,backFaceCulling:e.backFaceCulling,shadows:e.shadows,showCreditsOnScreen:e.showCreditsOnScreen,splitDirection:e.splitDirection,enableDebugWireframe:e._enableDebugWireframe,debugWireframe:e.debugWireframe,projectTo2D:e._projectTo2D,enablePick:e._enablePick,enableShowOutline:e._enableShowOutline,showOutline:e.showOutline,outlineColor:e.outlineColor};return(0,o.A)(i,r)}Object.defineProperties(h.prototype,{featuresLength:{get:function(){const e=this._model,t=e.featureTables,n=e.featureTableId;return(0,r.A)(t)&&(0,r.A)(t[n])?t[n].featuresLength:0}},pointsLength:{get:function(){return this._model.statistics.pointsLength}},trianglesLength:{get:function(){return this._model.statistics.trianglesLength}},geometryByteLength:{get:function(){return this._model.statistics.geometryByteLength}},texturesByteLength:{get:function(){return this._model.statistics.texturesByteLength}},batchTableByteLength:{get:function(){const e=this._model.statistics;return e.propertyTablesByteLength+e.batchTexturesByteLength}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){const e=this._model,t=e.featureTables,n=e.featureTableId;if((0,r.A)(t)&&(0,r.A)(t[n]))return t[n]}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},group:{get:function(){return this._group},set:function(e){this._group=e}}}),h.prototype.getTextureIds=function(){return this._model.statistics.getTextureIds()},h.prototype.getTextureByteLengthById=function(e){return this._model.statistics.getTextureByteLengthById(e)},h.prototype.getExtension=function(e){return this._model.getExtension(e)},h.prototype.getFeature=function(e){const t=this._model,n=t.featureTableId;if(!(0,r.A)(n))throw new a.A("No feature ID set is selected. Make sure Cesium3DTileset.featureIdLabel or Cesium3DTileset.instanceFeatureIdLabel is defined");const i=t.featureTables[n];if(!(0,r.A)(i))throw new a.A("No feature table found for the selected feature ID set");const o=i.featuresLength;if(!(0,r.A)(e)||e<0||e>=o)throw new a.A(`featureId is required and must be between 0 and featuresLength - 1 (${o-1}).`);return i.getFeature(e)},h.prototype.hasProperty=function(e,t){const n=this._model,i=n.featureTableId;return!!(0,r.A)(i)&&n.featureTables[i].hasProperty(e,t)},h.prototype.applyDebugSettings=function(e,t){t=e?t:i.A.WHITE,0===this.featuresLength?this._model.color=t:(0,r.A)(this.batchTable)&&this.batchTable.setAllColor(t)},h.prototype.applyStyle=function(e){this._model.style=e},h.prototype.update=function(e,t){const n=this._model,i=this._tile;n.colorBlendAmount=e.colorBlendAmount,n.colorBlendMode=e.colorBlendMode,n.modelMatrix=i.computedTransform,n.customShader=e.customShader,n.featureIdLabel=e.featureIdLabel,n.instanceFeatureIdLabel=e.instanceFeatureIdLabel,n.lightColor=e.lightColor,n.imageBasedLighting=e.imageBasedLighting,n.backFaceCulling=e.backFaceCulling,n.shadows=e.shadows,n.showCreditsOnScreen=e.showCreditsOnScreen,n.splitDirection=e.splitDirection,n.debugWireframe=e.debugWireframe,n.showOutline=e.showOutline,n.outlineColor=e.outlineColor,n.pointCloudShading=e.pointCloudShading;const o=e.clippingPlanes;n.referenceMatrix=e.clippingPlanesOriginMatrix,(0,r.A)(o)&&i.clippingPlanesDirty&&(n._clippingPlanes=o.enabled&&i._isClipped?o:void 0);const s=e.environmentMapManager;n.environmentMapManager!==o&&(n._environmentMapManager=s),(0,r.A)(o)&&(0,r.A)(n._clippingPlanes)&&n._clippingPlanes!==o&&(n._clippingPlanes=o,n._clippingPlanesState=0);const a=e.clippingPolygons;(0,r.A)(a)&&i.clippingPolygonsDirty&&(n._clippingPolygons=a.enabled&&i._isClippedByPolygon?a:void 0),(0,r.A)(a)&&(0,r.A)(n._clippingPolygons)&&n._clippingPolygons!==a&&(n._clippingPolygons=a,n._clippingPolygonsState=0),n.update(t),!this._ready&&n.ready&&(n.activeAnimations.addAll({loop:u.A.REPEAT}),this._ready=!0)},h.prototype.isDestroyed=function(){return!1},h.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),(0,s.A)(this)},h.fromGltf=async function(e,t,n,i){const o=new h(e,t,n),r=A(e,t,o,{gltf:i,basePath:n}),s=e.vectorClassificationOnly?void 0:e.classificationType;r.classificationType=s;const a=await d.A.fromGltfAsync(r);return o._model=a,o},h.fromB3dm=async function(e,t,n,i,o){const r=new h(e,t,n),s=A(e,t,r,{arrayBuffer:i,byteOffset:o,resource:n}),a=e.vectorClassificationOnly?void 0:e.classificationType;s.classificationType=a;const c=await d.A.fromB3dm(s);return r._model=c,r},h.fromI3dm=async function(e,t,n,i,o){const r=new h(e,t,n),s=A(e,t,r,{arrayBuffer:i,byteOffset:o,resource:n}),a=await d.A.fromI3dm(s);return r._model=a,r},h.fromPnts=async function(e,t,n,i,o){const r=new h(e,t,n),s=A(e,t,r,{arrayBuffer:i,byteOffset:o,resource:n}),a=await d.A.fromPnts(s);return r._model=a,r},h.fromGeoJson=async function(e,t,n,i){const o=new h(e,t,n),r=A(e,t,o,{geoJson:i,resource:n}),s=await d.A.fromGeoJson(r);return o._model=s,o},h.prototype.pick=function(e,t,n){if(!(0,r.A)(this._model)||!this._ready)return;const i=t.verticalExaggeration,o=t.verticalExaggerationRelativeHeight;return this._model.pick(e,t,i,o,c.A.WGS84,n)};const p=h},56241:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=function(){this.pass=void 0,this.alphaCutoff=void 0}},156621:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(491446),o=n(955943),r=n(591978),s=n(598361),a=n(304686),c=n(275670);function l(e,t,n){this._animation=t,this._name=t.name,this._runtimeChannels=void 0,this._startTime=r.A.clone(n.startTime),this._delay=n.delay??0,this._stopTime=r.A.clone(n.stopTime),this.removeOnStop=n.removeOnStop??!1,this._multiplier=n.multiplier??1,this._reverse=n.reverse??!1,this._loop=n.loop??s.A.NONE,this._animationTime=n.animationTime,this._prevAnimationDelta=void 0,this.start=new o.A,this.update=new o.A,this.stop=new o.A,this._state=a.A.STOPPED,this._computedStartTime=void 0,this._duration=void 0;const l=this;this._raiseStartEvent=function(){l.start.raiseEvent(e,l)},this._updateEventTime=0,this._raiseUpdateEvent=function(){l.update.raiseEvent(e,l,l._updateEventTime)},this._raiseStopEvent=function(){l.stop.raiseEvent(e,l)},this._model=e,this._localStartTime=void 0,this._localStopTime=void 0,function(e){let t=Number.MAX_VALUE,n=-Number.MAX_VALUE;const o=e._model.sceneGraph,r=e._animation.channels,s=r.length,a=[];for(let l=0;l<s;l++){const s=r[l],u=s.target;if(!(0,i.A)(u))continue;const d=u.node.index,h=o._runtimeNodes[d],A=new c.A({channel:s,runtimeAnimation:e,runtimeNode:h}),p=s.sampler.input;t=Math.min(t,p[0]),n=Math.max(n,p[p.length-1]),a.push(A)}e._runtimeChannels=a,e._localStartTime=t,e._localStopTime=n}(this)}Object.defineProperties(l.prototype,{animation:{get:function(){return this._animation}},name:{get:function(){return this._name}},runtimeChannels:{get:function(){return this._runtimeChannels}},model:{get:function(){return this._model}},localStartTime:{get:function(){return this._localStartTime}},localStopTime:{get:function(){return this._localStopTime}},startTime:{get:function(){return this._startTime}},delay:{get:function(){return this._delay}},stopTime:{get:function(){return this._stopTime}},multiplier:{get:function(){return this._multiplier}},reverse:{get:function(){return this._reverse}},loop:{get:function(){return this._loop}},animationTime:{get:function(){return this._animationTime}}}),l.prototype.animate=function(e){const t=this._runtimeChannels,n=t.length;for(let i=0;i<n;i++)t[i].animate(e)};const u=l},275670:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var i=n(267980),o=n(369031),r=n(931806),s=n(915325),a=n(491446),c=n(961136),l=n(92457),u=n(153127),d=n(995537),h=n(587841),A=n(99479),p=n(259690);const f=d.A.AnimatedPropertyType;function m(e){const t=(e=e??s.A.EMPTY_OBJECT).channel,n=e.runtimeAnimation,i=e.runtimeNode;o.A.typeOf.object("options.channel",t),o.A.typeOf.object("options.runtimeAnimation",n),o.A.typeOf.object("options.runtimeNode",i),this._channel=t,this._runtimeAnimation=n,this._runtimeNode=i,this._splines=[],this._path=void 0,function(e){const t=e._channel,n=t.sampler,i=n.input,o=n.output,r=n.interpolation,s=t.target.path,c=e._runtimeNode,u=function(e,t,n,i,o){const r=[];if(i===f.WEIGHTS){const s=t.length/o;let a,c;for(a=0;a<o;a++){const u=new Array(s);let d=a;if(n===l.A.CUBICSPLINE)for(c=0;c<s;c+=3)u[c]=t[d],u[c+1]=t[d+o],u[c+2]=t[d+2*o],d+=3*o;else for(c=0;c<s;c++)u[c]=t[d],d+=o;r.push(g(e,u,n,i))}}else r.push(g(e,t,n,i));return r}(i,o,r,s,(0,a.A)(c.morphWeights)?c.morphWeights.length:1);e._splines=u,e._path=s}(this)}function g(e,t,n,i){if(1===e.length&&1===t.length)return new r.A(t[0]);switch(n){case l.A.STEP:return new h.A({times:e,points:t});case l.A.CUBICSPLINE:return function(e,t){const n=[],i=[],o=[],r=t.length;for(let e=0;e<r;e+=3)i.push(t[e]),n.push(t[e+1]),o.push(t[e+2]);return i.splice(0,1),o.length=o.length-1,new c.A({times:e,points:n,inTangents:i,outTangents:o})}(e,t);case l.A.LINEAR:return i===f.ROTATION?new p.A({times:e,points:t}):new u.A({times:e,points:t})}}Object.defineProperties(m.prototype,{channel:{get:function(){return this._channel}},runtimeAnimation:{get:function(){return this._runtimeAnimation}},runtimeNode:{get:function(){return this._runtimeNode}},splines:{get:function(){return this._splines}}});const _=new i.A,y=new A.A;m.prototype.animate=function(e){const t=this._splines,n=this._path,i=this._runtimeAnimation.model,o=this._runtimeNode;if(n===f.WEIGHTS){const n=o.morphWeights,r=n.length;for(let o=0;o<r;o++){const r=t[o],s=i.clampAnimations?r.clampTime(e):r.wrapTime(e);n[o]=r.evaluate(s)}}else{if(o.userAnimated)return;{const r=t[0],s=i.clampAnimations?r.clampTime(e):r.wrapTime(e);n===f.TRANSLATION||n===f.SCALE?o[n]=r.evaluate(s,_):n===f.ROTATION&&(o[n]=r.evaluate(s,y))}}};const v=m},4773:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var i=n(915325),o=n(491446),r=n(605971),s=n(955943),a=n(591978),c=n(367817),l=n(156621),u=n(598361),d=n(304686);function h(e){this.animationAdded=new s.A,this.animationRemoved=new s.A,this.animateWhilePaused=!1,this._model=e,this._runtimeAnimations=[],this._previousTime=void 0}function A(e,t,n){const i=e._model,o=new l.A(i,t,n);return e._runtimeAnimations.push(o),e.animationAdded.raiseEvent(i,o),o}Object.defineProperties(h.prototype,{length:{get:function(){return this._runtimeAnimations.length}},model:{get:function(){return this._model}}}),h.prototype.add=function(e){e=e??i.A.EMPTY_OBJECT;const t=this._model;if(!t.ready)throw new r.A("Animations are not loaded.  Wait for Model.ready to be true.");const n=t.sceneGraph.components.animations;if(!(0,o.A)(e.name)&&!(0,o.A)(e.index))throw new r.A("Either options.name or options.index must be defined.");if((0,o.A)(e.multiplier)&&e.multiplier<=0)throw new r.A("options.multiplier must be greater than zero.");if((0,o.A)(e.index)&&(e.index>=n.length||e.index<0))throw new r.A("options.index must be a valid animation index.");let s=e.index;if((0,o.A)(s))return A(this,n[s],e);const a=n.length;for(let t=0;t<a;++t)if(n[t].name===e.name){s=t;break}if(!(0,o.A)(s))throw new r.A("options.name must be a valid animation name.");return A(this,n[s],e)},h.prototype.addAll=function(e){e=e??i.A.EMPTY_OBJECT;const t=this._model;if(!t.ready)throw new r.A("Animations are not loaded.  Wait for Model.ready to be true.");if((0,o.A)(e.multiplier)&&e.multiplier<=0)throw new r.A("options.multiplier must be greater than zero.");const n=t.sceneGraph.components.animations,s=[],a=n.length;for(let t=0;t<a;++t){const i=A(this,n[t],e);s.push(i)}return s},h.prototype.remove=function(e){if(!(0,o.A)(e))return!1;const t=this._runtimeAnimations,n=t.indexOf(e);return-1!==n&&(t.splice(n,1),this.animationRemoved.raiseEvent(this._model,e),!0)},h.prototype.removeAll=function(){const e=this._model,t=this._runtimeAnimations,n=t.length;this._runtimeAnimations.length=0;for(let i=0;i<n;++i)this.animationRemoved.raiseEvent(e,t[i])},h.prototype.contains=function(e){return!!(0,o.A)(e)&&-1!==this._runtimeAnimations.indexOf(e)},h.prototype.get=function(e){if(!(0,o.A)(e))throw new r.A("index is required.");if(e>=this._runtimeAnimations.length||e<0)throw new r.A("index must be valid within the range of the collection");return this._runtimeAnimations[e]};const p=[];function f(e,t,n){return function(){e.animationRemoved.raiseEvent(t,n)}}h.prototype.update=function(e){const t=this._runtimeAnimations;let n=t.length;if(0===n)return this._previousTime=void 0,!1;if(!this.animateWhilePaused&&a.A.equals(e.time,this._previousTime))return!1;this._previousTime=a.A.clone(e.time,this._previousTime);let i=!1;const r=e.time,s=this._model;for(let s=0;s<n;++s){const n=t[s];(0,o.A)(n._computedStartTime)||(n._computedStartTime=a.A.addSeconds(n.startTime??r,n.delay,new a.A)),(0,o.A)(n._duration)||(n._duration=n.localStopTime*(1/n.multiplier));const l=n._computedStartTime,h=n._duration,A=n.stopTime,f=a.A.lessThanOrEquals(l,r),m=(0,o.A)(A)&&a.A.greaterThan(r,A);let g=0;if(0!==h){const e=a.A.secondsDifference(m?A:r,l);g=(0,o.A)(n._animationTime)?n._animationTime(h,e):e/h}const _=n.loop===u.A.REPEAT||n.loop===u.A.MIRRORED_REPEAT,y=(f||_&&!(0,o.A)(n.startTime))&&(g<=1||_)&&!m;if((g!==n._prevAnimationDelta||y===(n._state===d.A.STOPPED))&&(n._prevAnimationDelta=g,y||n._state===d.A.ANIMATING)){if(y&&n._state===d.A.STOPPED&&(n._state=d.A.ANIMATING,n.start.numberOfListeners>0&&e.afterRender.push(n._raiseStartEvent)),n.loop===u.A.REPEAT)g-=Math.floor(g);else if(n.loop===u.A.MIRRORED_REPEAT){const e=Math.floor(g),t=g-e;g=e%2==1?1-t:t}n.reverse&&(g=1-g);let t=g*h*n.multiplier;t=c.A.clamp(t,n.localStartTime,n.localStopTime),n.animate(t),n.update.numberOfListeners>0&&(n._updateEventTime=t,e.afterRender.push(n._raiseUpdateEvent)),i=!0,y||(n._state=d.A.STOPPED,n.stop.numberOfListeners>0&&e.afterRender.push(n._raiseStopEvent),n.removeOnStop&&p.push(n))}}n=p.length;for(let i=0;i<n;++i){const n=p[i];t.splice(t.indexOf(n),1),e.afterRender.push(f(this,s,n))}return p.length=0,i};const m=h},41358:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(369031),o=n(915325),r=n(491446),s=n(584164),a=n(647478);function c(e){const t=(e=e??o.A.EMPTY_OBJECT).articulation,n=e.sceneGraph;i.A.typeOf.object("options.articulation",t),i.A.typeOf.object("options.sceneGraph",n),this._articulation=t,this._sceneGraph=n,this._name=t.name,this._runtimeStages=[],this._runtimeStagesByName={},this._runtimeNodes=[],this._dirty=!0,function(e){const t=e.articulation.stages,n=t.length,i=e._runtimeStages,o=e._runtimeStagesByName;for(let r=0;r<n;r++){const n=t[r],s=new a.A({stage:n,runtimeArticulation:e});i.push(s),o[n.name]=s}}(this)}Object.defineProperties(c.prototype,{articulation:{get:function(){return this._articulation}},sceneGraph:{get:function(){return this._sceneGraph}},name:{get:function(){return this._name}},runtimeStages:{get:function(){return this._runtimeStages}},runtimeNodes:{get:function(){return this._runtimeNodes}}}),c.prototype.setArticulationStage=function(e,t){const n=this._runtimeStagesByName[e];(0,r.A)(n)&&(n.currentValue=t)};const l=new s.A,u=new s.A;c.prototype.apply=function(){if(!this._dirty)return;this._dirty=!1;let e,t=s.A.clone(s.A.IDENTITY,l);const n=this._runtimeStages,i=n.length;for(e=0;e<i;e++)t=n[e].applyStageToMatrix(t);const o=this._runtimeNodes,r=o.length;for(e=0;e<r;e++){const n=o[e],i=s.A.multiplyTransformation(n.originalTransform,t,u);n.transform=i}};const d=c},647478:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(794282),o=n(267980),r=n(367817),s=n(369031),a=n(915325),c=n(331185),l=n(584164);const u=r.A.EPSILON16;function d(e){const t=(e=e??a.A.EMPTY_OBJECT).stage,n=e.runtimeArticulation;s.A.typeOf.object("options.stage",t),s.A.typeOf.object("options.runtimeArticulation",n),this._stage=t,this._runtimeArticulation=n,this._name=t.name,this._type=t.type,this._minimumValue=t.minimumValue,this._maximumValue=t.maximumValue,this._currentValue=t.initialValue}Object.defineProperties(d.prototype,{stage:{get:function(){return this._stage}},runtimeArticulation:{get:function(){return this._runtimeArticulation}},name:{get:function(){return this._name}},type:{get:function(){return this._type}},minimumValue:{get:function(){return this._minimumValue}},maximumValue:{get:function(){return this._maximumValue}},currentValue:{get:function(){return this._currentValue},set:function(e){s.A.typeOf.number("value",e),e=r.A.clamp(e,this.minimumValue,this.maximumValue),r.A.equalsEpsilon(this._currentValue,e,u)||(this._currentValue=e,this.runtimeArticulation._dirty=!0)}}});const h=new o.A,A=new c.A;d.prototype.applyStageToMatrix=function(e){s.A.typeOf.object("result",e);const t=this.type,n=this.currentValue,o=h;let a;switch(t){case i.A.XROTATE:a=c.A.fromRotationX(r.A.toRadians(n),A),e=l.A.multiplyByMatrix3(e,a,e);break;case i.A.YROTATE:a=c.A.fromRotationY(r.A.toRadians(n),A),e=l.A.multiplyByMatrix3(e,a,e);break;case i.A.ZROTATE:a=c.A.fromRotationZ(r.A.toRadians(n),A),e=l.A.multiplyByMatrix3(e,a,e);break;case i.A.XTRANSLATE:o.x=n,o.y=0,o.z=0,e=l.A.multiplyByTranslation(e,o,e);break;case i.A.YTRANSLATE:o.x=0,o.y=n,o.z=0,e=l.A.multiplyByTranslation(e,o,e);break;case i.A.ZTRANSLATE:o.x=0,o.y=0,o.z=n,e=l.A.multiplyByTranslation(e,o,e);break;case i.A.XSCALE:o.x=n,o.y=1,o.z=1,e=l.A.multiplyByScale(e,o,e);break;case i.A.YSCALE:o.x=1,o.y=n,o.z=1,e=l.A.multiplyByScale(e,o,e);break;case i.A.ZSCALE:o.x=1,o.y=1,o.z=n,e=l.A.multiplyByScale(e,o,e);break;case i.A.UNIFORMSCALE:e=l.A.multiplyByUniformScale(e,n,e)}return e};const p=d},303036:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(434067),o=n(711284),r=n(430346),s=n(41476),a=n(403139),c=n(624512);const l={name:"ModelClippingPlanesPipelineStage"},u=new i.A;l.process=function(e,t,n){const i=t.clippingPlanes,l=n.context,d=e.shaderBuilder;d.addDefine("HAS_CLIPPING_PLANES",void 0,c.A.FRAGMENT),d.addDefine("CLIPPING_PLANES_LENGTH",i.length,c.A.FRAGMENT),i.unionClippingRegions&&d.addDefine("UNION_CLIPPING_REGIONS",void 0,c.A.FRAGMENT),o.A.useFloatTexture(l)&&d.addDefine("USE_CLIPPING_PLANES_FLOAT_TEXTURE",void 0,c.A.FRAGMENT);const h=o.A.getTextureResolution(i,l,u);d.addDefine("CLIPPING_PLANES_TEXTURE_WIDTH",h.x,c.A.FRAGMENT),d.addDefine("CLIPPING_PLANES_TEXTURE_HEIGHT",h.y,c.A.FRAGMENT),d.addUniform("sampler2D","model_clippingPlanes",c.A.FRAGMENT),d.addUniform("vec4","model_clippingPlanesEdgeStyle",c.A.FRAGMENT),d.addUniform("mat4","model_clippingPlanesMatrix",c.A.FRAGMENT),d.addFragmentLines(a.A);const A={model_clippingPlanes:function(){return i.texture},model_clippingPlanesEdgeStyle:function(){const e=s.A.clone(i.edgeColor);return e.alpha=i.edgeWidth,e},model_clippingPlanesMatrix:function(){return t._clippingPlanesMatrix}};e.uniformMap=(0,r.A)(A,e.uniformMap)};const d=l},855692:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(430346),o=n(212143),r=n(521791),s=n(624512);const a={name:"ModelClippingPolygonsPipelineStage",process:function(e,t,n){const a=t.clippingPolygons,c=e.shaderBuilder;c.addDefine("ENABLE_CLIPPING_POLYGONS",void 0,s.A.BOTH),a.inverse&&c.addDefine("CLIPPING_INVERSE",void 0,s.A.FRAGMENT),c.addDefine("CLIPPING_POLYGON_REGIONS_LENGTH",a.extentsCount,s.A.BOTH),c.addUniform("sampler2D","model_clippingDistance",s.A.FRAGMENT),c.addUniform("sampler2D","model_clippingExtents",s.A.VERTEX),c.addVarying("vec2","v_clippingPosition"),c.addVarying("int","v_regionIndex","flat"),c.addVertexLines(o.A),c.addFragmentLines(r.A);const l={model_clippingDistance:function(){return a.clippingTexture??n.context.defaultTexture},model_clippingExtents:function(){return a.extentsTexture??n.context.defaultTexture}};e.uniformMap=(0,i.A)(l,e.uniformMap)}}},542614:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(428027),o=n(430346),r=n(325161),s=n(760866),a=n(624512);const c={name:"ModelColorPipelineStage",COLOR_UNIFORM_NAME:"model_color",COLOR_BLEND_UNIFORM_NAME:"model_colorBlend",process:function(e,t,n){const l=e.shaderBuilder;l.addDefine("HAS_MODEL_COLOR",void 0,a.A.FRAGMENT),l.addFragmentLines(r.A);const u={},d=t.color;0!==d.alpha||t.hasSilhouette(n)||(e.renderStateOptions.colorMask={red:!1,green:!1,blue:!1,alpha:!1}),d.alpha<1&&(e.alphaOptions.pass=s.A.TRANSLUCENT),l.addUniform("vec4",c.COLOR_UNIFORM_NAME,a.A.FRAGMENT),u[c.COLOR_UNIFORM_NAME]=function(){return t.color},l.addUniform("float",c.COLOR_BLEND_UNIFORM_NAME,a.A.FRAGMENT),u[c.COLOR_BLEND_UNIFORM_NAME]=function(){return i.A.getColorBlend(t.colorBlendMode,t.colorBlendAmount)},e.uniformMap=(0,o.A)(u,e.uniformMap)}},l=c},270316:(e,t,n)=>{"use strict";n.d(t,{A:()=>M});var i=n(660662),o=n(434067),r=n(367817),s=n(369031),a=n(376758),c=n(915325),l=n(491446),u=n(584164),d=n(352581),h=n(377496),A=n(760866),p=n(40118),f=n(200646),m=n(527083),g=n(62467),_=n(988609),y=n(938987),v=n(896464),T=n(138151),b=n(942836);function w(e){const t=(e=e??c.A.EMPTY_OBJECT).command,n=e.primitiveRenderResources;s.A.typeOf.object("options.command",t),s.A.typeOf.object("options.primitiveRenderResources",n);const o=n.model;this._model=o;const r=n.runtimePrimitive;this._runtimePrimitive=r;const a=t.pass===A.A.TRANSLUCENT,l=!r.primitive.material.doubleSided&&!a,d=n.hasSilhouette,h=!a&&!d,p=n.hasSkipLevelOfDetail&&!a,f=d;this._command=t,this._modelMatrix=u.A.clone(t.modelMatrix),this._boundingVolume=i.A.clone(t.boundingVolume),this._modelMatrix2D=new u.A,this._boundingVolume2D=new i.A,this._modelMatrix2DDirty=!1,this._backFaceCulling=t.renderState.cull.enabled,this._cullFace=t.renderState.cull.face,this._shadows=o.shadows,this._debugShowBoundingVolume=t.debugShowBoundingVolume,this._usesBackFaceCulling=l,this._needsTranslucentCommand=h,this._needsSkipLevelOfDetailCommands=p,this._needsSilhouetteCommands=f,this._originalCommand=void 0,this._translucentCommand=void 0,this._skipLodBackfaceCommand=void 0,this._skipLodStencilCommand=void 0,this._silhouetteModelCommand=void 0,this._silhouetteColorCommand=void 0,this._derivedCommands=[],this._has2DCommands=!1,function(e){const t=e._command;t.modelMatrix=e._modelMatrix,t.boundingVolume=e._boundingVolume;const n=e._model,i=e._usesBackFaceCulling,o=e._derivedCommands;e._originalCommand=new x({command:t,updateShadows:!0,updateBackFaceCulling:i,updateCullFace:i,updateDebugShowBoundingVolume:!0,is2D:!1}),o.push(e._originalCommand),e._needsTranslucentCommand&&(e._translucentCommand=new x({command:I(t),updateShadows:!0,updateBackFaceCulling:!1,updateCullFace:!1,updateDebugShowBoundingVolume:!0}),o.push(e._translucentCommand)),e._needsSkipLevelOfDetailCommands&&(e._skipLodBackfaceCommand=new x({command:O(t),updateShadows:!1,updateBackFaceCulling:!1,updateCullFace:i,updateDebugShowBoundingVolume:!1}),e._skipLodStencilCommand=new x({command:R(t),updateShadows:!0,updateBackFaceCulling:i,updateCullFace:i,updateDebugShowBoundingVolume:!0}),o.push(e._skipLodBackfaceCommand),o.push(e._skipLodStencilCommand)),e._needsSilhouetteCommands&&(e._silhouetteModelCommand=new x({command:P(t,n),updateShadows:!0,updateBackFaceCulling:i,updateCullFace:i,updateDebugShowBoundingVolume:!0}),e._silhouetteColorCommand=new x({command:D(t,n),updateShadows:!1,updateBackFaceCulling:!1,updateCullFace:!1,updateDebugShowBoundingVolume:!1}),o.push(e._silhouetteModelCommand),o.push(e._silhouetteColorCommand))}(this)}function x(e){this.command=e.command,this.updateShadows=e.updateShadows,this.updateBackFaceCulling=e.updateBackFaceCulling,this.updateCullFace=e.updateCullFace,this.updateDebugShowBoundingVolume=e.updateDebugShowBoundingVolume,this.is2D=e.is2D??!1,this.derivedCommand2D=void 0}function C(e,t,n){e.push(t.command),n&&e.push(t.derivedCommand2D.command)}function E(e,t){if(t.mode!==g.A.SCENE2D||e.model._projectTo2D)return!1;const n=e.model.sceneGraph._boundingSphere2D,i=n.center.y-n.radius,o=n.center.y+n.radius,s=t.mapProjection.ellipsoid.maximumRadius*r.A.PI;return i<s&&o>s||i<-s&&o>-s}function S(e,t){if(!(0,l.A)(t))return;const n=x.clone(t),i=h.A.shallowClone(t.command);return i.modelMatrix=e._modelMatrix2D,i.boundingVolume=e._boundingVolume2D,n.command=i,n.updateShadows=!1,n.is2D=!0,t.derivedCommand2D=n,e._derivedCommands.push(n),n}function I(e){const t=h.A.shallowClone(e);t.pass=A.A.TRANSLUCENT;const n=(0,a.A)(e.renderState,!0);return n.cull.enabled=!1,n.depthMask=!1,n.blending=f.A.ALPHA_BLEND,t.renderState=p.A.fromCache(n),t}function P(e,t){const n=t._silhouetteId%255,i=h.A.shallowClone(e),o=(0,a.A)(e.renderState,!0);return o.stencilTest={enabled:!0,frontFunction:d.A.ALWAYS,backFunction:d.A.ALWAYS,reference:n,mask:-1,frontOperation:{fail:d.A.KEEP,zFail:d.A.KEEP,zPass:d.A.REPLACE},backOperation:{fail:d.A.KEEP,zFail:d.A.KEEP,zPass:d.A.REPLACE}},t.isInvisible()&&(o.colorMask={red:!1,green:!1,blue:!1,alpha:!1}),i.renderState=p.A.fromCache(o),i}function D(e,t){const n=t._silhouetteId%255,i=h.A.shallowClone(e),o=(0,a.A)(e.renderState,!0);o.cull.enabled=!1,(e.pass===A.A.TRANSLUCENT||t.silhouetteColor.alpha<1)&&(i.pass=A.A.TRANSLUCENT,o.depthMask=!1,o.blending=f.A.ALPHA_BLEND),o.stencilTest={enabled:!0,frontFunction:d.A.NOTEQUAL,backFunction:d.A.NOTEQUAL,reference:n,mask:-1,frontOperation:{fail:d.A.KEEP,zFail:d.A.KEEP,zPass:d.A.KEEP},backOperation:{fail:d.A.KEEP,zFail:d.A.KEEP,zPass:d.A.KEEP}};const r=(0,a.A)(e.uniformMap);return r.model_silhouettePass=function(){return!0},i.renderState=p.A.fromCache(o),i.uniformMap=r,i.castShadows=!1,i.receiveShadows=!1,i}function O(e){const t=h.A.shallowClone(e),n=(0,a.A)(e.renderState,!0);n.cull.enabled=!0,n.cull.face=m.A.FRONT,n.colorMask={red:!1,green:!1,blue:!1,alpha:!1},n.polygonOffset={enabled:!0,factor:5,units:5};const i=(0,a.A)(t.uniformMap),r=new o.A(5,5);return i.u_polygonOffset=function(){return r},t.renderState=p.A.fromCache(n),t.uniformMap=i,t.castShadows=!1,t.receiveShadows=!1,t}function R(e){const t=h.A.shallowClone(e),n=(0,a.A)(e.renderState,!0),{stencilTest:i}=n;return i.enabled=!0,i.mask=y.A.SKIP_LOD_MASK,i.reference=y.A.CESIUM_3D_TILE_MASK,i.frontFunction=v.A.GREATER_OR_EQUAL,i.frontOperation.zPass=T.A.REPLACE,i.backFunction=v.A.GREATER_OR_EQUAL,i.backOperation.zPass=T.A.REPLACE,n.stencilMask=y.A.CESIUM_3D_TILE_MASK|y.A.SKIP_LOD_MASK,t.renderState=p.A.fromCache(n),t}x.clone=function(e){return new x({command:e.command,updateShadows:e.updateShadows,updateBackFaceCulling:e.updateBackFaceCulling,updateCullFace:e.updateCullFace,updateDebugShowBoundingVolume:e.updateDebugShowBoundingVolume,is2D:e.is2D,derivedCommand2D:e.derivedCommand2D})},Object.defineProperties(w.prototype,{command:{get:function(){return this._command}},runtimePrimitive:{get:function(){return this._runtimePrimitive}},model:{get:function(){return this._model}},primitiveType:{get:function(){return this._command.primitiveType}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=u.A.clone(e,this._modelMatrix),this._modelMatrix2DDirty=!0,this._boundingVolume=i.A.transform(this.runtimePrimitive.boundingSphere,this._modelMatrix,this._boundingVolume)}},boundingVolume:{get:function(){return this._boundingVolume}},shadows:{get:function(){return this._shadows},set:function(e){this._shadows=e,function(e){const t=e.shadows,n=_.A.castShadows(t),i=_.A.receiveShadows(t),o=e._derivedCommands;for(let e=0;e<o.length;++e){const t=o[e];if(t.updateShadows){const e=t.command;e.castShadows=n,e.receiveShadows=i}}}(this)}},backFaceCulling:{get:function(){return this._backFaceCulling},set:function(e){this._backFaceCulling!==e&&(this._backFaceCulling=e,function(e){const t=e.backFaceCulling,n=e._derivedCommands;for(let e=0;e<n.length;++e){const i=n[e];if(i.updateBackFaceCulling){const e=i.command,n=(0,a.A)(e.renderState,!0);n.cull.enabled=t,e.renderState=p.A.fromCache(n)}}}(this))}},cullFace:{get:function(){return this._cullFace},set:function(e){this._cullFace!==e&&(this._cullFace=e,function(e){const t=e.cullFace,n=e._derivedCommands;for(let e=0;e<n.length;++e){const i=n[e];if(i.updateCullFace){const e=i.command,n=(0,a.A)(e.renderState,!0);n.cull.face=t,e.renderState=p.A.fromCache(n)}}}(this))}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume!==e&&(this._debugShowBoundingVolume=e,function(e){const t=e.debugShowBoundingVolume,n=e._derivedCommands;for(let e=0;e<n.length;++e){const i=n[e];i.updateDebugShowBoundingVolume&&(i.command.debugShowBoundingVolume=t)}}(this))}}}),w.prototype.pushCommands=function(e,t){const n=E(this,e);var o;n&&!this._has2DCommands&&(S(o=this,o._originalCommand),S(o,o._translucentCommand),S(o,o._skipLodBackfaceCommand),S(o,o._skipLodStencilCommand),S(o,o._silhouetteModelCommand),S(o,o._silhouetteColorCommand),this._has2DCommands=!0,this._modelMatrix2DDirty=!0),this._modelMatrix2DDirty&&(function(e,t){const n=e._modelMatrix;e._modelMatrix2D=u.A.clone(n,e._modelMatrix2D),e._modelMatrix2D[13]-=2*r.A.sign(n[13])*r.A.PI*t.mapProjection.ellipsoid.maximumRadius,e._boundingVolume2D=i.A.transform(e.runtimePrimitive.boundingSphere,e._modelMatrix2D,e._boundingVolume2D)}(this,e),this._modelMatrix2DDirty=!1);const s=this.model.styleCommandsNeeded;if(!this._needsTranslucentCommand||!(0,l.A)(s)||(s!==b.A.ALL_OPAQUE&&C(t,this._translucentCommand,n),s!==b.A.ALL_TRANSLUCENT)){if(this._needsSkipLevelOfDetailCommands){const{tileset:e,tile:i}=this._model.content;if(e.hasMixedContent)return i._finalResolution||C(e._backfaceCommands,this._skipLodBackfaceCommand,n),function(e,t,n){const i=e._skipLodStencilCommand,o=i.command,r=t._selectionDepth,s=function(e){return(e.renderState.stencilTest.reference&y.A.SKIP_LOD_MASK)>>>y.A.SKIP_LOD_BIT_SHIFT}(o);if(r!==s){const e=function(e){return y.A.CESIUM_3D_TILE_MASK|e<<y.A.SKIP_LOD_BIT_SHIFT}(r),t=(0,a.A)(o.renderState,!0);t.stencilTest.reference=e,o.renderState=p.A.fromCache(t),n&&(i.derivedCommand2D.renderState=t)}}(this,i,n),void C(t,this._skipLodStencilCommand,n)}if(!this._needsSilhouetteCommands)return C(t,this._originalCommand,n),t;C(t,this._silhouetteModelCommand,n)}},w.prototype.pushSilhouetteCommands=function(e,t){const n=E(this,e);return C(t,this._silhouetteColorCommand,n),t};const M=w},652259:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var i=n(660662),o=n(376758),r=n(491446),s=n(584164),a=n(377496),c=n(40118),l=n(62467),u=n(988609),d=n(899700),h=n(270316),A=n(508380),p=n(501782),f=n(261126),m=n(471147),g=n(605971);function _(){}_.buildModelDrawCommand=function(e,t){const n=function(e,t,n){t.addVertexLines(p.A),t.addFragmentLines(f.A);const i=e.model,o=t.buildShaderProgram(n.context);return i._pipelineResources.push(o),o}(e,e.shaderBuilder,t),_=function(e,t,n){const d=function(e){const t=e.wireframeIndexBuffer;if((0,r.A)(t))return t;const n=e.indices;if((0,r.A)(n)){if(!(0,r.A)(n.buffer))throw new g.A("Indices must be provided as a Buffer");return n.buffer}}(e),h=new A.A({context:n.context,indexBuffer:d,attributes:e.attributes}),p=e.model;p._pipelineResources.push(h);const f=e.alphaOptions.pass,_=p.sceneGraph,y=n.mode===l.A.SCENE3D;let v,T;if(y||n.scene3DOnly||!p._projectTo2D){const t=y?_._computedModelMatrix:_._computedModelMatrix2D;v=s.A.multiplyTransformation(t,e.runtimeNode.computedTransform,new s.A),T=i.A.transform(e.boundingSphere,v)}else v=s.A.multiplyTransformation(_._computedModelMatrix,e.runtimeNode.computedTransform,new s.A),T=e.runtimePrimitive.boundingSphere2D;let b=(0,o.A)(c.A.fromCache(e.renderStateOptions),!0);b.cull.face=m.A.getCullFace(v,e.primitiveType),b=c.A.fromCache(b);const w=(0,r.A)(p.classificationType),x=!w&&u.A.castShadows(p.shadows),C=!w&&u.A.receiveShadows(p.shadows),E=w?void 0:e.pickId;return new a.A({boundingVolume:T,modelMatrix:v,uniformMap:e.uniformMap,renderState:b,vertexArray:h,shaderProgram:t,cull:p.cull,pass:f,count:e.count,owner:p,pickId:E,pickMetadataAllowed:!0,instanceCount:e.instanceCount,primitiveType:e.primitiveType,debugShowBoundingVolume:p.debugShowBoundingVolume,castShadows:x,receiveShadows:C})}(e,n,t),y=e.model;return(0,r.A)(y.classificationType)?new d.A({primitiveRenderResources:e,command:_}):new h.A({primitiveRenderResources:e,command:_})};const y=_},242893:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(41476),o=n(491446);function r(e){this._model=e.model,this._featureTable=e.featureTable,this._featureId=e.featureId,this._color=void 0}Object.defineProperties(r.prototype,{show:{get:function(){return this._featureTable.getShow(this._featureId)},set:function(e){this._featureTable.setShow(this._featureId,e)}},color:{get:function(){return(0,o.A)(this._color)||(this._color=new i.A),this._featureTable.getColor(this._featureId,this._color)},set:function(e){this._featureTable.setColor(this._featureId,e)}},primitive:{get:function(){return this._model}},featureTable:{get:function(){return this._featureTable}},featureId:{get:function(){return this._featureId}}}),r.prototype.hasProperty=function(e){return this._featureTable.hasProperty(this._featureId,e)},r.prototype.getProperty=function(e){return this._featureTable.getProperty(this._featureId,e)},r.prototype.getPropertyInherited=function(e){return this._featureTable.hasPropertyBySemantic(this._featureId,e)?this._featureTable.getPropertyBySemantic(this._featureId,e):this._featureTable.getProperty(this._featureId,e)},r.prototype.getPropertyIds=function(e){return this._featureTable.getPropertyIds(e)},r.prototype.setProperty=function(e,t){return this._featureTable.setProperty(this._featureId,e,t)};const s=r},947129:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(653565),o=n(622569),r=n(369031),s=n(41476),a=n(491446),c=n(677354),l=n(242893),u=n(942836),d=n(226827);function h(e){const t=e.model,n=e.propertyTable;r.A.typeOf.object("propertyTable",n),r.A.typeOf.object("model",t),this._propertyTable=n,this._model=t,this._features=void 0,this._featuresLength=0,this._batchTexture=void 0,this._styleCommandsNeededDirty=!1,this._styleCommandsNeeded=u.A.ALL_OPAQUE,function(e){const t=e._model,n=d.A.is3DTiles(t.type),r=e._propertyTable.count;if(0===r)return;let s;const a=new Array(r);if(n){const e=t.content;for(s=0;s<r;s++)a[s]=new o.A(e,s)}else for(s=0;s<r;s++)a[s]=new l.A({model:t,featureId:s,featureTable:e});e._features=a,e._featuresLength=r,e._batchTexture=new i.A({featuresLength:r,owner:e,statistics:n?t.content.tileset.statistics:void 0})}(this)}Object.defineProperties(h.prototype,{batchTexture:{get:function(){return this._batchTexture}},featuresLength:{get:function(){return this._featuresLength}},batchTextureByteLength:{get:function(){return(0,a.A)(this._batchTexture)?this._batchTexture.byteLength:0}},styleCommandsNeededDirty:{get:function(){return this._styleCommandsNeededDirty}}}),h.prototype.update=function(e){this._styleCommandsNeededDirty=!1,this._batchTexture.update(void 0,e);const t=u.A.getStyleCommandsNeeded(this._featuresLength,this._batchTexture.translucentFeaturesLength);this._styleCommandsNeeded!==t&&(this._styleCommandsNeededDirty=!0,this._styleCommandsNeeded=t)},h.prototype.setShow=function(e,t){this._batchTexture.setShow(e,t)},h.prototype.setAllShow=function(e){this._batchTexture.setAllShow(e)},h.prototype.getShow=function(e){return this._batchTexture.getShow(e)},h.prototype.setColor=function(e,t){this._batchTexture.setColor(e,t)},h.prototype.setAllColor=function(e){this._batchTexture.setAllColor(e)},h.prototype.getColor=function(e,t){return this._batchTexture.getColor(e,t)},h.prototype.getPickColor=function(e){return this._batchTexture.getPickColor(e)},h.prototype.getFeature=function(e){return this._features[e]},h.prototype.hasProperty=function(e,t){return this._propertyTable.hasProperty(e,t)},h.prototype.hasPropertyBySemantic=function(e,t){return this._propertyTable.hasPropertyBySemantic(e,t)},h.prototype.getProperty=function(e,t){return this._propertyTable.getProperty(e,t)},h.prototype.getPropertyBySemantic=function(e,t){return this._propertyTable.getPropertyBySemantic(e,t)},h.prototype.getPropertyIds=function(e){return this._propertyTable.getPropertyIds(e)},h.prototype.setProperty=function(e,t,n){return this._propertyTable.setProperty(e,t,n)},h.prototype.isClass=function(e,t){return this._propertyTable.isClass(e,t)},h.prototype.isExactClass=function(e,t){return this._propertyTable.isExactClass(e,t)},h.prototype.getExactClassName=function(e){return this._propertyTable.getExactClassName(e)};const A=new s.A;h.prototype.applyStyle=function(e){if(!(0,a.A)(e))return this.setAllColor(i.A.DEFAULT_COLOR_VALUE),void this.setAllShow(i.A.DEFAULT_SHOW_VALUE);for(let t=0;t<this._featuresLength;t++){const n=this.getFeature(t),o=(0,a.A)(e.color)?e.color.evaluateColor(n,A)??i.A.DEFAULT_COLOR_VALUE:i.A.DEFAULT_COLOR_VALUE,r=(0,a.A)(e.show)?e.show.evaluate(n)??i.A.DEFAULT_SHOW_VALUE:i.A.DEFAULT_SHOW_VALUE;this.setColor(t,o),this.setShow(t,r)}},h.prototype.isDestroyed=function(){return!1},h.prototype.destroy=function(e){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),(0,c.A)(this)};const p=h},701111:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(369031),o=n(491446),r=n(677354),s=n(605971),a=n(509830),c=n(17728);const l=class{constructor(e){i.A.defined("model",e),this._model=e,this._modelPrimitiveImageries=void 0,this._imageryConfigurations=[]}update(e){i.A.defined("frameState",e),this._hasImagery&&this._allImageryLayersReady&&((0,o.A)(this._modelPrimitiveImageries)||(this._modelPrimitiveImageries=this._createModelPrimitiveImageries()),this._updateModelPrimitiveImageries(e),this._checkForModifiedImageryConfigurations())}_createModelPrimitiveImageries(){const e=this._model,t=this._collectRuntimeNodesAndPrimitives(),n=[],i=t.length;for(let o=0;o<i;o++){const i=t[o],r=i.runtimeNode,s=i.runtimePrimitive,a=new c.A(e,r,s);s.primitive.modelPrimitiveImagery=a,n.push(a)}return n}_collectRuntimeNodesAndPrimitives(){const e=this._model.sceneGraph._runtimeNodes,t=[];for(let n=0;n<e.length;n++){const i=e[n];if((0,o.A)(i))for(let e=0;e<i.runtimePrimitives.length;e++){const n=i.runtimePrimitives[e];t.push({runtimeNode:i,runtimePrimitive:n})}}return t}_updateModelPrimitiveImageries(e){if(i.A.defined("frameState",e),!(0,o.A)(this._modelPrimitiveImageries))throw new s.A("The modelPrimitiveImageries have not been created");const t=this._modelPrimitiveImageries,n=t.length;for(let i=0;i<n;i++)t[i].update(e)}_deleteModelPrimitiveImageries(){const e=this._modelPrimitiveImageries;if(!(0,o.A)(e))return;const t=e.length;for(let n=0;n<t;n++)e[n].destroy();delete this._modelPrimitiveImageries}get ready(){return!this._hasImagery||!!this._allImageryLayersReady&&!!this._allModelPrimitiveImageriesReady}get _hasImagery(){const e=this._model.imageryLayers;return(0,o.A)(e)&&e.length>0}get _allImageryLayersReady(){if(!this._hasImagery)return!0;const e=this._model.imageryLayers,t=e.length;for(let n=0;n<t;n++)if(!e.get(n).ready)return!1;return!0}get _allModelPrimitiveImageriesReady(){const e=this._modelPrimitiveImageries;if(!(0,o.A)(e))return!1;const t=e.length;for(let n=0;n<t;n++)if(!e[n].ready)return!1;return!0}_checkForModifiedImageryConfigurations(){this._imageryConfigurationsModified()&&(this._updateImageryConfigurations(),this._model.resetDrawCommands())}_imageryConfigurationsModified(){const e=this._model.imageryLayers,t=this._imageryConfigurations;if(e.length!==t.length)return!0;for(let n=0;n<e.length;n++){const i=e.get(n),o=t[n];if(i.show!==o.show)return!0;if(i.alpha!==o.alpha)return!0;if(i.brightness!==o.brightness)return!0;if(i.contrast!==o.contrast)return!0;if(i.hue!==o.hue)return!0;if(i.saturation!==o.saturation)return!0;if(i.gamma!==o.gamma)return!0;if(i.colorToAlpha!==o.colorToAlpha)return!0}return!1}_updateImageryConfigurations(){const e=this._model.imageryLayers,t=this._imageryConfigurations;t.length=e.length;for(let n=0;n<e.length;n++){const i=e.get(n);t[n]=new a.A(i)}}isDestroyed(){return!1}destroy(){if(!this.isDestroyed())return this._deleteModelPrimitiveImageries(),(0,r.A)(this)}}},112497:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var i=n(491446),o=n(434067),r=n(267980),s=n(584164),a=n(697422),c=n(336946),l=n(647934),u=n(571804),d=n(369031),h=n(730839),A=n(949020),p=n(595826);class f{static createTextureCoordinatesForMappedPositions(e,t){d.A.defined("mappedPositions",e),d.A.defined("projection",t);const n=e.cartographicPositions,i=e.cartographicBoundingRectangle,o=e.numPositions;return f._createTextureCoordinates(n,o,i,t)}static _createTextureCoordinates(e,t,n,i){d.A.defined("cartographicPositions",e),d.A.typeOf.number.greaterThanOrEquals("numPositions",t,0),d.A.defined("cartographicBoundingRectangle",n),d.A.defined("projection",i);const o=new l.A;l.A.fromRectangle(n,i,o);const r=f.createProjectedPositions(e,i),s=f.computeTexCoords(r,o);return f.createTypedArrayFromCartesians2(t,s)}static createTextureCoordinatesAttributeForMappedPositions(e,t){d.A.defined("mappedPositions",e),d.A.defined("projection",t);const n=f.createTextureCoordinatesForMappedPositions(e,t);return f.createTexCoordAttribute(n)}static createCartographicPositions(e,t,n){d.A.defined("primitivePositionAttribute",e),d.A.defined("primitivePositionTransform",t),d.A.defined("ellipsoid",n);const i=A.A.readAttributeAsTypedArray(e),o=e.type,r=h.A.getNumberOfComponents(o),s=f.createIterableCartesian3FromTypedArray(i,r),a=f.transformCartesians3(s,t);return f.transformToCartographic(a,n)}static createIterableCartesian3FromTypedArray(e,t){d.A.defined("typedArray",e),d.A.typeOf.number.greaterThanOrEquals("stride",t,3);const n=new r.A,i=e.length/t;return{[Symbol.iterator]:function*(){for(let o=0;o<i;o++)n.x=e[o*t+0],n.y=e[o*t+1],n.z=e[o*t+2],yield n}}}static map(e,t){return d.A.defined("iterable",e),d.A.defined("mapper",t),{[Symbol.iterator]:function*(){for(const n of e)yield t(n)}}}static computeCartographicBoundingRectangle(e,t){d.A.defined("cartographicPositions",e),(0,i.A)(t)||(t=new a.A);let n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;for(const t of e)n=Math.max(n,t.latitude),o=Math.min(o,t.latitude),r=Math.max(r,t.longitude),s=Math.min(s,t.longitude);return t.north=n,t.south=o,t.east=r,t.west=s,t}static transformCartesians3(e,t){d.A.defined("positions",e),d.A.defined("matrix",t);const n=new r.A;return f.map(e,e=>(s.A.multiplyByPoint(t,e,n),n))}static transformToCartographic(e,t){d.A.defined("positions",e),d.A.defined("ellipsoid",t);const n=new c.A;return f.map(e,e=>(t.cartesianToCartographic(e,n),n))}static createProjectedPositions(e,t){d.A.defined("cartographicPositions",e),d.A.defined("projection",t);const n=new r.A;return f.map(e,e=>(t.project(e,n),n))}static computeTexCoords(e,t){d.A.defined("positions",e),d.A.defined("boundingRectangle",t);const n=new o.A,i=1/t.width,r=1/t.height;return f.map(e,e=>{const o=(e.x-t.x)*i,s=(e.y-t.y)*r,a=Math.min(Math.max(o,0),1),c=Math.min(Math.max(s,0),1);return n.x=a,n.y=c,n})}static createTypedArrayFromCartesians2(e,t){d.A.typeOf.number.greaterThanOrEquals("numElements",e,0),d.A.defined("elements",t);const n=new Float32Array(2*e);let i=0;for(const e of t)n[2*i+0]=e.x,n[2*i+1]=e.y,i++;return n}static createTexCoordAttribute(e){return d.A.defined("texCoordsTypedArray",e),{name:"Imagery Texture Coordinates",semantic:p.A.TEXCOORD,setIndex:0,componentDatatype:u.A.FLOAT,type:h.A.VEC2,normalized:!1,count:e.length/2,min:void 0,max:void 0,constant:new o.A(0,0),quantization:void 0,typedArray:e,byteOffset:0,byteStride:void 0}}}const m=f},127329:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(915325),o=n(10803);const r=function(e){e=e??i.A.EMPTY_OBJECT,this.lightingModel=e.lightingModel??o.A.UNLIT}},657685:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(584164),o=n(471147),r=n(62467);const s={};function a(e,t,n){e.modelMatrix=i.A.multiplyTransformation(t,n,e.modelMatrix),e.cullFace=o.A.getCullFace(e.modelMatrix,e.primitiveType)}function c(e,t,n,o){let r;o=i.A.multiplyTransformation(o,e.transform,new i.A),e.updateComputedTransform();const s=e.runtimePrimitives.length;for(r=0;r<s;r++)a(e.runtimePrimitives[r].drawCommand,n,o);const l=e.children.length;for(r=0;r<l;r++){const s=t._runtimeNodes[e.children[r]];s._transformToRoot=i.A.clone(o,s._transformToRoot),c(s,t,n,o),s._transformDirty=!1}}s.name="ModelMatrixUpdateStage",s.update=function(e,t,n){const i=n.mode!==r.A.SCENE3D;i&&t._model._projectTo2D||!e._transformDirty||(c(e,t,i?t._computedModelMatrix2D:t._computedModelMatrix,e.transformToRoot),e._transformDirty=!1)};const l=s},922167:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(369031),o=n(491446);function r(e,t){i.A.typeOf.object("model",e),i.A.typeOf.object("runtimeNode",t),this._model=e,this._runtimeNode=t}Object.defineProperties(r.prototype,{name:{get:function(){return this._runtimeNode._name}},id:{get:function(){return this._runtimeNode._id}},show:{get:function(){return this._runtimeNode.show},set:function(e){this._runtimeNode.show=e}},matrix:{get:function(){return this._runtimeNode.transform},set:function(e){(0,o.A)(e)?(this._runtimeNode.transform=e,this._runtimeNode.userAnimated=!0,this._model._userAnimationDirty=!0):(this._runtimeNode.transform=this.originalMatrix,this._runtimeNode.userAnimated=!1)}},originalMatrix:{get:function(){return this._runtimeNode.originalTransform}}});const s=r},17728:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var i=n(491446),o=n(605971),r=n(584164),s=n(369031),a=n(677354),c=n(921243),l=n(890692),u=n(112497),d=n(471147),h=n(736355),A=n(641613),p=n(442790);class f{constructor(e,t,n){s.A.defined("model",e),s.A.defined("runtimeNode",t),s.A.defined("runtimePrimitive",n),this._model=e,this._runtimeNode=t,this._runtimePrimitive=n,this._mappedPositionsPerEllipsoid=void 0,this._mappedPositionsModelMatrix=new r.A,this._lastImageryLayersModificationCounter=0,this._imageryTexCoordAttributesPerProjection=void 0,this._currentImageryLayers=void 0,this._coveragesPerLayer=void 0,this._allImageriesReady=!1}coveragesForImageryLayer(e){const t=this._model.imageryLayers.indexOf(e);if(-1===t)throw new o.A("Imagery layer is not part of the model");const n=this._coveragesPerLayer;if(!(0,i.A)(n))throw new o.A("The coveragesPerLayer have not been computed yet");return n[t]}update(e){s.A.defined("frameState",e);const t=this._model,n=t.content.tileset.imageryLayersModificationCounter;this._lastImageryLayersModificationCounter!==n&&(delete this._mappedPositionsPerEllipsoid,this._lastImageryLayersModificationCounter=n),this._mappedPositionsNeedUpdate&&(t.resetDrawCommands(),this._mappedPositionsPerEllipsoid=this._computeMappedPositionsPerEllipsoid(),this._deleteCoveragesPerLayer(),this._destroyImageryTexCoordAttributes()),(0,i.A)(this._imageryTexCoordAttributesPerProjection)||(this._imageryTexCoordAttributesPerProjection=this._computeImageryTexCoordsAttributesPerProjection(),this._uploadImageryTexCoordAttributes(e.context)),(0,i.A)(this._coveragesPerLayer)||(this._computeCoveragesPerLayer(),this._allImageriesReady=!1),this._allImageriesReady||this._updateImageries(e)}_deleteCoveragesPerLayer(){const e=this._coveragesPerLayer;if(!(0,i.A)(e))return;const t=this._currentImageryLayers,n=e.length;for(let i=0;i<n;i++){const n=t[i],o=e[i];this._deleteCoverages(n,o)}delete this._currentImageryLayers,delete this._coveragesPerLayer}_deleteCoverages(e,t){if(e.isDestroyed())return;const n=t.length;for(let e=0;e<n;e++)t[e].imagery.releaseReference()}_uploadImageryTexCoordAttributes(e){s.A.defined("context",e);const t=this._imageryTexCoordAttributesPerProjection;if(!(0,i.A)(t))return;const n=t.length;for(let i=0;i<n;i++){const n=t[i],o=A.A.createVertexBuffer({context:e,typedArray:n.typedArray,usage:p.A.STATIC_DRAW});o.vertexArrayDestroyable=!1,n.buffer=o}}_destroyImageryTexCoordAttributes(){const e=this._imageryTexCoordAttributesPerProjection;if(!(0,i.A)(e))return;const t=e.length;for(let n=0;n<t;n++){const t=e[n];(0,i.A)(t)&&((0,i.A)(t.buffer)&&(t.buffer.isDestroyed()||t.buffer.destroy()),e[n]=void 0)}delete this._imageryTexCoordAttributesPerProjection}get _mappedPositionsNeedUpdate(){if(!(0,i.A)(this._mappedPositionsPerEllipsoid))return!0;const e=this._model,t=this._mappedPositionsModelMatrix;return!r.A.equals(e.modelMatrix,t)}_computeMappedPositionsPerEllipsoid(){const e=this._model,t=this._runtimeNode,n=this._runtimePrimitive,i=f._obtainPrimitivePositionAttribute(n.primitive),o=i.count,s=f._computePrimitivePositionTransform(e,t,void 0),a=[],c=f._computeUniqueEllipsoids(e.imageryLayers),l=c.length;for(let e=0;e<l;e++){const t=c[e],n=u.A.createCartographicPositions(i,s,t),r=u.A.computeCartographicBoundingRectangle(n),l=new h.A(n,o,r,t);a.push(l)}return r.A.clone(e.modelMatrix,this._mappedPositionsModelMatrix),a}static _computeUniqueEllipsoids(e){s.A.defined("imageryLayers",e);const t=new Set,n=e.length;for(let i=0;i<n;i++){const n=e.get(i),o=f._getEllipsoid(n);t.add(o)}return[...t]}_computeImageryTexCoordsAttributesPerProjection(){const e=this._model.imageryLayers,t=f._extractProjections(e),n=[...new Set(t)];return this._createImageryTexCoordAttributes(n)}static _extractProjections(e){s.A.defined("imageryLayers",e);const t=[],n=e.length;for(let i=0;i<n;i++){const n=e.get(i),o=f._getProjection(n);t.push(o)}return t}static _getProjection(e){return s.A.defined("imageryLayer",e),e.imageryProvider.tilingScheme.projection}_createImageryTexCoordAttributes(e){s.A.defined("uniqueProjections",e);const t=[],n=e.length;for(let i=0;i<n;i++){const n=e[i],o=n.ellipsoid,r=this.mappedPositionsForEllipsoid(o),s=u.A.createTextureCoordinatesAttributeForMappedPositions(r,n);t.push(s)}return t}_computeCoveragesPerLayer(){const e=[],t=[],n=this._model.imageryLayers,i=n.length;for(let o=0;o<i;o++){const i=n.get(o),r=this._computeCoverage(i);e.push(r),t.push(i)}this._coveragesPerLayer=e,this._currentImageryLayers=t}_computeCoverage(e){const t=this.mappedPositionsForImageryLayer(e).cartographicBoundingRectangle,n=this._computeImageryLevel(e,t);return l.A.createImageryCoverages(t,e,n)}_computeImageryLevel(e,t){const n=e.imageryProvider,i=n.tilingScheme.rectangle;let o=t.width,r=i.width;t.height>t.width&&(o=t.height,r=i.height);const s=Math.log2(1*r/o);return l.A._clampImageryLevel(n,s)}_updateImageries(e){const t=this._model,n=this._coveragesPerLayer,i=n.length;let o=!0;for(let t=0;t<i;t++){const i=n[t],r=i.length;for(let t=0;t<r;t++){const n=i[t].imagery;n.state===c.A.READY||n.state===c.A.FAILED||n.state===c.A.INVALID||(o=!1,n.processStateMachine(e,!1,!1))}}o&&t.resetDrawCommands(),this._allImageriesReady=o}mappedPositionsForImageryLayer(e){const t=f._getEllipsoid(e);return this.mappedPositionsForEllipsoid(t)}mappedPositionsForEllipsoid(e){const t=this._mappedPositionsPerEllipsoid;if(!(0,i.A)(t))throw new o.A("The mappedPositions have not been computed yet");const n=t.length;for(let i=0;i<n;i++){const n=t[i];if(n.ellipsoid===e)return n}throw new o.A(`Could not find mapped positions for ellipsoid ${e}`)}imageryTexCoordAttributesPerProjection(){const e=this._imageryTexCoordAttributesPerProjection;if(!(0,i.A)(e))throw new o.A("The imagery texture coordinate attributes have not been computed yet");return this._imageryTexCoordAttributesPerProjection}get ready(){const e=this._coveragesPerLayer;return!!(0,i.A)(e)&&this._allImageriesReady}isDestroyed(){return!1}destroy(){if(!this.isDestroyed())return this._deleteCoveragesPerLayer(),this._destroyImageryTexCoordAttributes(),(0,a.A)(this)}static _computePrimitivePositionTransform(e,t,n){s.A.defined("model",e),s.A.defined("runtimeNode",t),(0,i.A)(n)||(n=new r.A);const o=e.sceneGraph;return r.A.clone(r.A.IDENTITY,n),r.A.multiply(n,e.modelMatrix,n),r.A.multiply(n,o.components.transform,n),r.A.multiply(n,o.axisCorrectionMatrix,n),r.A.multiply(n,t.computedTransform,n),n}static _obtainPrimitivePositionAttribute(e){s.A.defined("primitive",e);const t=d.A.getAttributeBySemantic(e,"POSITION");if(!(0,i.A)(t))throw new o.A("The primitive does not have a POSITION attribute");return t}static _getEllipsoid(e){return e.imageryProvider.tilingScheme.projection.ellipsoid}}const m=f},949020:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var i=n(369031),o=n(491446),r=n(434067),s=n(267980),a=n(626809),c=n(605971),l=n(571804),u=n(961645),d=n(874915),h=n(402330),A=n(584164),p=n(730839);class f{static readAttributeAsTypedArray(e){i.A.defined("attribute",e);const t=f.readAttributeAsRawCompactTypedArray(e),n=e.normalized,r=e.quantization;if(!(0,o.A)(r)&&!n)return t;const s=e.type,a=e.count;let c=t;return n&&(c=u.A.dequantize(t,e.componentDatatype,s,a)),(0,o.A)(r)?f.dequantize(c,a,s,r):c}static readAttributeAsRawCompactTypedArray(e){i.A.defined("attribute",e);const t=e.type,n=e.count,r=p.A.getNumberOfComponents(t),s=n*r;let a=e.componentDatatype;const c=e.quantization;(0,o.A)(c)&&(a=c.componentDatatype);const u=e.buffer,d=e.byteOffset,h=e.byteStride,A=r*l.A.getSizeInBytes(a);if(!(0,o.A)(h)||h===A){const e=l.A.createTypedArray(a,s);return u.getBufferData(e,d),e}const m=new Uint8Array(u.sizeInBytes);u.getBufferData(m);const g=l.A.createTypedArray(a,s),_=h??A,y=new DataView(m.buffer,m.byteOffset,m.byteLength),v=new Array(r),T=f.createComponentsReader(a);for(let e=0;e<n;++e){T(y,d+e*_,r,v);for(let t=0;t<r;++t)g[e*r+t]=v[t]}return g}static dequantize(e,t,n,o){if(i.A.defined("quantizedTypedArray",e),i.A.typeOf.number.greaterThanOrEquals("elementCount",t,0),i.A.defined("elementType",n),i.A.defined("quantization",o),o.octEncoded){const n=f.octDecode(e,t,o.normalizationRange,void 0);return o.octEncodedZXY&&f.convertZxyToXyz(n,n),n}const r=o.quantizedVolumeStepSize,s=o.quantizedVolumeOffset;if(n===p.A.SCALAR)return f.dequantize1D(e,t,r,s,void 0);if(n===p.A.VEC2)return f.dequantize2D(e,t,r,s,void 0);if(n===p.A.VEC3)return f.dequantize3D(e,t,r,s,void 0);if(n===p.A.VEC4)return f.dequantize4D(e,t,r,s,void 0);throw new c.A(`Element type for dequantization must be SCALAR, VEC2, VEC3, or VEC4, but is ${n}`)}static octDecode(e,t,n,r){i.A.defined("quantizedTypedArray",e),i.A.typeOf.number.greaterThanOrEquals("elementCount",t,0),i.A.typeOf.number.greaterThan("normalizationRange",n,0),(0,o.A)(r)||(r=new Float32Array(e.length));const a=new s.A;for(let i=0;i<t;i++)s.A.unpack(e,3*i,a),u.A.octDecodeInRange(a,n,a),s.A.pack(r,a,3*i);return r}static convertZxyToXyz(e,t,n){i.A.defined("input",e),i.A.typeOf.number.greaterThanOrEquals("elementCount",t,0),(0,o.A)(n)||(n=new Float32Array(e.length));let r=0;for(let i=0;i<t;i++,r+=3){const t=e[r+0],i=e[r+1],o=e[r+2];n[r+0]=i,n[r+1]=o,n[r+2]=t}return n}static dequantize1D(e,t,n,r,s){i.A.defined("quantizedTypedArray",e),i.A.typeOf.number.greaterThanOrEquals("elementCount",t,0),i.A.defined("stepSize",n),i.A.defined("offset",r),(0,o.A)(s)||(s=new Float32Array(e.length));for(let i=0;i<t;i++){const t=e[i]*n+r;s[i]=t}return s}static dequantize2D(e,t,n,s,a){i.A.defined("quantizedTypedArray",e),i.A.typeOf.number.greaterThanOrEquals("elementCount",t,0),i.A.defined("stepSize",n),i.A.defined("offset",s),(0,o.A)(a)||(a=new Float32Array(e.length));const c=new r.A;for(let i=0;i<t;i++)r.A.unpack(e,2*i,c),r.A.multiplyComponents(c,n,c),r.A.add(c,s,c),r.A.pack(c,a,2*i);return a}static dequantize3D(e,t,n,r,a){i.A.defined("quantizedTypedArray",e),i.A.typeOf.number.greaterThanOrEquals("elementCount",t,0),i.A.defined("stepSize",n),i.A.defined("offset",r),(0,o.A)(a)||(a=new Float32Array(e.length));const c=new s.A;for(let i=0;i<t;i++)s.A.unpack(e,3*i,c),s.A.multiplyComponents(c,n,c),s.A.add(c,r,c),s.A.pack(c,a,3*i);return a}static dequantize4D(e,t,n,r,s){i.A.defined("quantizedTypedArray",e),i.A.typeOf.number.greaterThanOrEquals("elementCount",t,0),i.A.defined("stepSize",n),i.A.defined("offset",r),(0,o.A)(s)||(s=new Float32Array(e.length));const c=new a.A;for(let i=0;i<t;i++)a.A.unpack(e,4*i,c),a.A.multiplyComponents(c,n,c),a.A.add(c,r,c),a.A.pack(c,s,4*i);return s}static createComponentsReader(e){const t=f.createComponentReader(e),n=l.A.getSizeInBytes(e);return function(e,i,o,r){let s=i;for(let i=0;i<o;++i)r[i]=t(e,s),s+=n}}static createComponentReader(e){switch(e){case l.A.BYTE:return function(e,t){return e.getInt8(t)};case l.A.UNSIGNED_BYTE:return function(e,t){return e.getUint8(t)};case l.A.SHORT:return function(e,t){return e.getInt16(t,!0)};case l.A.UNSIGNED_SHORT:return function(e,t){return e.getUint16(t,!0)};case l.A.INT:return function(e,t){return e.getInt32(t,!0)};case l.A.UNSIGNED_INT:return function(e,t){return e.getUint32(t,!0)};case l.A.FLOAT:return function(e,t){return e.getFloat32(t,!0)};case l.A.DOUBLE:return function(e,t){return e.getFloat64(t,!0)}}throw new c.A(`The componentType must be a valid ComponentDatatype, but is ${e}`)}static transform3D(e,t,n){i.A.defined("input",e),i.A.defined("matrix",t),(0,o.A)(n)||(n=new Float32Array(e.length));const r=new s.A,a=e.length/3;for(let i=0;i<a;i++)s.A.unpack(e,3*i,r),A.A.multiplyByPoint(t,r,r),s.A.pack(r,n,3*i);return n}static readIndicesAsTypedArray(e){const t=e.typedArray;if((0,o.A)(t))return t;const n=e.buffer,i=e.count,r=e.indexDatatype,s=f.createIndexTypedArray(r,i);return n.getBufferData(s),s}static readIndicesAsTriangleIndicesTypedArray(e,t){const n=f.readIndicesAsTypedArray(e);if(t===h.A.TRIANGLES)return n;if(t===h.A.TRIANGLE_STRIP)return f.convertTriangleStripToTriangleIndices(n);if(t===h.A.TRIANGLE_FAN)return f.convertTriangleFanToTriangleIndices(n);throw new c.A(`The primitiveType must be TRIANGLES (${h.A.TRIANGLES}, TRIANGLE_STRIP (${h.A.TRIANGLE_STRIP}, or TRIANGLE_FAN (${h.A.TRIANGLE_FAN}, but is ${t}`)}static convertTriangleStripToTriangleIndices(e){const t=e.constructor(3*(e.length-2));for(let n=0;n<e.length-2;n++)n%2==1?(t[3*n+0]=e[n+0],t[3*n+1]=e[n+2],t[3*n+2]=e[n+1]):(t[3*n+0]=e[n+0],t[3*n+1]=e[n+1],t[3*n+2]=e[n+2]);return t}static convertTriangleFanToTriangleIndices(e){const t=e.constructor(3*(e.length-2));for(let n=0;n<e.length-2;n++)t[3*n+0]=e[n+0],t[3*n+1]=e[n+1],t[3*n+2]=e[n+2];return t}static createIndexTypedArray(e,t){switch(i.A.typeOf.number.greaterThanOrEquals("size",t,0),e){case d.A.UNSIGNED_BYTE:return new Uint8Array(t);case d.A.UNSIGNED_SHORT:return new Uint16Array(t);case d.A.UNSIGNED_INT:return new Uint32Array(t)}throw new c.A(`The indexDatatype must be UNSIGNED_BYTE (${d.A.UNSIGNED_BYTE}, UNSIGNED_SHORT (${d.A.UNSIGNED_SHORT}, or UNSIGNED_INT (${d.A.UNSIGNED_INT}, but is ${e}`)}}const m=f},136426:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(369031),o=n(56241),r=n(40118),s=n(469635),a=n(523721);const c=function(e){i.A.typeOf.object("model",e),this.shaderBuilder=new s.A,this.model=e,this.uniformMap={},this.alphaOptions=new o.A,this.renderStateOptions=r.A.getState(r.A.fromCache({depthTest:{enabled:!0,func:a.A.LESS_OR_EQUAL}})),this.hasSilhouette=!1,this.hasSkipLevelOfDetail=!1,this.nodeRenderResources=[]}},885251:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var i=n(267980),o=n(369031),r=n(915325),s=n(491446),a=n(605971),c=n(584164),l=n(884842),u=n(99479),d=n(281810),h=n(657685),A=n(799395);function p(e){const t=(e=e??r.A.EMPTY_OBJECT).node,n=e.transform,i=e.transformToRoot,a=e.sceneGraph,u=e.children;o.A.typeOf.object("options.node",t),o.A.typeOf.object("options.transform",n),o.A.typeOf.object("options.transformToRoot",i),o.A.typeOf.object("options.sceneGraph",a),o.A.typeOf.object("options.children",u),this._node=t,this._name=t.name,this._id=t.index,this._sceneGraph=a,this._children=u,this._originalTransform=c.A.clone(n,this._originalTransform),this._transform=c.A.clone(n,this._transform),this._transformToRoot=c.A.clone(i,this._transformToRoot),this._computedTransform=new c.A,this._transformDirty=!1,this._transformParameters=void 0,this._morphWeights=[],this._runtimeSkin=void 0,this._computedJointMatrices=[],this.show=!0,this.userAnimated=!1,this.pipelineStages=[],this.runtimePrimitives=[],this.updateStages=[],this.instancingTranslationMin=void 0,this.instancingTranslationMax=void 0,this.instancingTransformsBuffer=void 0,this.instancingTransformsBuffer2D=void 0,this.instancingTranslationBuffer2D=void 0,this.instancingReferencePoint2D=void 0,function(e){const t=e.transform,n=e.transformToRoot,i=e._computedTransform;e._computedTransform=c.A.multiply(n,t,i);const o=e.node;(0,s.A)(o.matrix)||(e._transformParameters=new l.A(o.translation,o.rotation,o.scale)),(0,s.A)(o.morphWeights)&&(e._morphWeights=o.morphWeights.slice());const r=o.articulationName;if((0,s.A)(r)){const t=e.sceneGraph._runtimeArticulations[r];(0,s.A)(t)&&t.runtimeNodes.push(e)}}(this)}function f(e,t){e._transformDirty=!0,e._transform=c.A.fromTranslationRotationScale(t,e._transform)}Object.defineProperties(p.prototype,{node:{get:function(){return this._node}},sceneGraph:{get:function(){return this._sceneGraph}},children:{get:function(){return this._children}},transform:{get:function(){return this._transform},set:function(e){this._transformDirty=!0,this._transform=c.A.clone(e,this._transform)}},transformToRoot:{get:function(){return this._transformToRoot}},computedTransform:{get:function(){return this._computedTransform}},originalTransform:{get:function(){return this._originalTransform}},translation:{get:function(){return(0,s.A)(this._transformParameters)?this._transformParameters.translation:void 0},set:function(e){const t=this._transformParameters;if(!(0,s.A)(t))throw new a.A("The translation of a node cannot be set if it was defined using a matrix in the model.");const n=t.translation;i.A.equals(n,e)||(t.translation=i.A.clone(e,t.translation),f(this,t))}},rotation:{get:function(){return(0,s.A)(this._transformParameters)?this._transformParameters.rotation:void 0},set:function(e){const t=this._transformParameters;if(!(0,s.A)(t))throw new a.A("The rotation of a node cannot be set if it was defined using a matrix in the model.");const n=t.rotation;u.A.equals(n,e)||(t.rotation=u.A.clone(e,t.rotation),f(this,t))}},scale:{get:function(){return(0,s.A)(this._transformParameters)?this._transformParameters.scale:void 0},set:function(e){const t=this._transformParameters;if(!(0,s.A)(t))throw new a.A("The scale of a node cannot be set if it was defined using a matrix in the model.");const n=t.scale;i.A.equals(n,e)||(t.scale=i.A.clone(e,t.scale),f(this,t))}},morphWeights:{get:function(){return this._morphWeights},set:function(e){const t=e.length;if(this._morphWeights.length!==t)throw new a.A("value must have the same length as the original weights array.");for(let n=0;n<t;n++)this._morphWeights[n]=e[n]}},runtimeSkin:{get:function(){return this._runtimeSkin}},computedJointMatrices:{get:function(){return this._computedJointMatrices}}}),p.prototype.getChild=function(e){if(o.A.typeOf.number("index",e),e<0||e>=this.children.length)throw new a.A("index must be greater than or equal to 0 and less than the number of children.");return this.sceneGraph._runtimeNodes[this.children[e]]},p.prototype.configurePipeline=function(){const e=this.node,t=this.pipelineStages;t.length=0;const n=this.updateStages;n.length=0,(0,s.A)(e.instances)&&t.push(d.A),t.push(A.A),n.push(h.A)},p.prototype.updateComputedTransform=function(){this._computedTransform=c.A.multiply(this._transformToRoot,this._transform,this._computedTransform)},p.prototype.updateJointMatrices=function(){const e=this._runtimeSkin;if(!(0,s.A)(e))return;e.updateJointMatrices();const t=this._computedJointMatrices,n=e.jointMatrices,i=n.length;for(let e=0;e<i;e++){(0,s.A)(t[e])||(t[e]=new c.A);const i=c.A.multiplyTransformation(this.transformToRoot,this.transform,t[e]),o=c.A.inverseTransformation(i,t[e]);t[e]=c.A.multiplyTransformation(o,n[e],t[e])}};const m=p},850210:(e,t,n)=>{"use strict";n.d(t,{A:()=>N});var i=n(369031),o=n(915325),r=n(491446),s=n(402330),a=n(62467),c=n(19120),l=n(186919),u=n(662274),d=n(212642),h=n(212525),A=n(381508),p=n(13916),f=n(598073),m=n(320578),g=n(391648),_=n(817082),y=n(193497),v=n(963564),T=n(64389),b=n(471147),w=n(163010),x=n(601945),C=n(752709),E=n(366413),S=n(531218),I=n(252843),P=n(391852),D=n(456727),O=n(641882),R=n(6214),M=n(983884);function L(e){const t=(e=e??o.A.EMPTY_OBJECT).primitive,n=e.node,r=e.model;i.A.typeOf.object("options.primitive",t),i.A.typeOf.object("options.node",n),i.A.typeOf.object("options.model",r),this.primitive=t,this.node=n,this.model=r,this.pipelineStages=[],this.drawCommand=void 0,this.boundingSphere=void 0,this.boundingSphere2D=void 0,this.positionBuffer2D=void 0,this.batchLengths=void 0,this.batchOffsets=void 0,this.updateStages=[]}L.prototype.configurePipeline=function(e){const t=this.pipelineStages;t.length=0;const n=this.primitive,i=this.node,o=this.model,L=o.customShader,N=o.style,B=e.context.webgl2,F=e.mode!==a.A.SCENE3D&&!e.scene3DOnly&&o._projectTo2D,U=1!==e.verticalExaggeration&&o.hasVerticalExaggeration,k=(0,r.A)(n.morphTargets)&&n.morphTargets.length>0,V=(0,r.A)(i.skin),z=(0,r.A)(o.imageryLayers),H=(0,r.A)(L),G=!(H&&(0,r.A)(L.fragmentShaderText))||L.mode!==h.A.REPLACE_MATERIAL,W=b.A.hasQuantizedAttributes(n.attributes),Y=o.debugWireframe&&s.A.isTriangles(n.primitiveType)&&(o._enableDebugWireframe||B),q=o.pointCloudShading,j=(0,r.A)(q)&&q.attenuation,Q=(0,r.A)(q)&&q.backFaceCulling,X=n.primitiveType===s.A.POINTS&&((0,r.A)(N)||j||Q),K=o._enableShowOutline&&(0,r.A)(n.outlineCoordinates),$=function(e,t,n){let i;return(0,r.A)(t.instances)&&(i=b.A.getFeatureIdsByLabel(t.instances.featureIds,e.instanceFeatureIdLabel),(0,r.A)(i))?{hasFeatureIds:!0,hasPropertyTable:(0,r.A)(i.propertyTableId)}:(i=b.A.getFeatureIdsByLabel(n.featureIds,e.featureIdLabel),(0,r.A)(i)?{hasFeatureIds:!0,hasPropertyTable:(0,r.A)(i.propertyTableId)}:{hasFeatureIds:!1,hasPropertyTable:!1})}(o,i,n),J=(0,r.A)(o.classificationType);F&&t.push(I.A),t.push(m.A),Y&&t.push(R.A),J&&t.push(u.A),k&&t.push(w.A),V&&t.push(D.A),X&&t.push(C.A),W&&t.push(p.A),z&&(K?(0,M.A)("outlines-and-draping","Primitive outlines disable imagery draping"):t.push(g.A)),G&&t.push(y.A),t.push(f.A),t.push(T.A),t.push(v.A),$.hasPropertyTable&&(t.push(P.A),t.push(l.A),t.push(d.A)),U&&t.push(O.A),H&&t.push(A.A),t.push(_.A),o.allowPicking&&t.push(x.A),K&&t.push(E.A),t.push(c.A),t.push(S.A)};const N=L},814071:(e,t,n)=>{"use strict";n.d(t,{A:()=>$});var i=n(660662),o=n(267980),r=n(369031),s=n(915325),a=n(491446),c=n(584164),l=n(543622),u=n(62467),d=n(913419),h=n(807048),A=n(538198),p=n(3282),f=n(41358),m=n(542614),g=n(303036),_=n(855692),y=n(922167),v=n(885251),T=n(850210),b=n(496854),w=n(471147),x=n(136426),C=n(746761),E=n(566258),S=n(226827),I=n(604883),P=n(214666),D=n(652259),O=n(702247);function R(e){const t=(e=e??s.A.EMPTY_OBJECT).modelComponents;r.A.typeOf.object("options.model",e.model),r.A.typeOf.object("options.modelComponents",t),this._model=e.model,this._components=t,this._pipelineStages=[],this._updateStages=[],this._runtimeNodes=[],this._rootNodes=[],this._skinnedNodes=[],this._runtimeSkins=[],this.modelPipelineStages=[],this._boundingSphere=void 0,this._boundingSphere2D=void 0,this._computedModelMatrix=c.A.clone(c.A.IDENTITY),this._computedModelMatrix2D=c.A.clone(c.A.IDENTITY),this._axisCorrectionMatrix=w.A.getAxisCorrectionMatrix(t.upAxis,t.forwardAxis,new c.A),this._runtimeArticulations={},function(e){const t=e._components,n=t.scene;M(e,e._model.modelMatrix);const i=t.articulations,o=i.length,r=e._runtimeArticulations;for(let t=0;t<o;t++){const n=i[t],o=new f.A({articulation:n,sceneGraph:e});r[o.name]=o}const s=t.nodes,a=s.length;e._runtimeNodes=new Array(a);const l=n.nodes.length,u=c.A.IDENTITY;for(let t=0;t<l;t++){const i=N(e,n.nodes[t],u);e._rootNodes.push(i)}const d=t.skins,h=e._runtimeSkins,A=d.length;for(let t=0;t<A;t++){const n=d[t];h.push(new b.A({skin:n,sceneGraph:e}))}const p=e._skinnedNodes,m=p.length;for(let t=0;t<m;t++){const n=p[t],i=e._runtimeNodes[n],o=s[n].skin.index;i._runtimeSkin=h[o],i.updateJointMatrices()}e.applyArticulations()}(this)}function M(e,t){const n=e._components,i=e._model;e._computedModelMatrix=c.A.multiplyTransformation(t,n.transform,e._computedModelMatrix),e._computedModelMatrix=c.A.multiplyTransformation(e._computedModelMatrix,e._axisCorrectionMatrix,e._computedModelMatrix),e._computedModelMatrix=c.A.multiplyByUniformScale(e._computedModelMatrix,i.computedScale,e._computedModelMatrix)}Object.defineProperties(R.prototype,{components:{get:function(){return this._components}},computedModelMatrix:{get:function(){return this._computedModelMatrix}},axisCorrectionMatrix:{get:function(){return this._axisCorrectionMatrix}},boundingSphere:{get:function(){return this._boundingSphere}}});const L=new o.A;function N(e,t,n){const i=[],o=w.A.getNodeTransform(t),r=t.children.length;for(let s=0;s<r;s++){const r=N(e,t.children[s],c.A.multiplyTransformation(n,o,new c.A));i.push(r)}const s=new v.A({node:t,transform:o,transformToRoot:n,children:i,sceneGraph:e}),l=t.primitives.length;for(let n=0;n<l;n++)s.runtimePrimitives.push(new T.A({primitive:t.primitives[n],node:t,model:e._model}));const u=t.index;e._runtimeNodes[u]=s,(0,a.A)(t.skin)&&e._skinnedNodes.push(u);const d=t.name;if((0,a.A)(d)){const t=e._model,n=new y.A(t,s);t._nodesByName[d]=n}return u}const B=new o.A,F=new o.A,U=new o.A,k=new o.A;function V(e,t,n,i,o){if(n&&!t.show)return;const r=t.children.length;for(let s=0;s<r;s++)V(e,t.getChild(s),n,i,o);const s=t.runtimePrimitives,a=s.length;for(let e=0;e<a;e++)i(s[e],o)}function z(e,t,n,i){const o=e._rootNodes,r=o.length;for(let s=0;s<r;s++){const r=o[s];V(e,e._runtimeNodes[r],t,n,i)}}R.prototype.buildDrawCommands=function(e){const t=this.buildRenderResources(e);this.computeBoundingVolumes(t),this.createDrawCommands(t,e)},R.prototype.buildRenderResources=function(e){const t=this._model,n=new x.A(t);t.statistics.clear(),this.configurePipeline(e);const i=this.modelPipelineStages;for(let o=0;o<i.length;o++)i[o].process(n,t,e);for(let t=0;t<this._runtimeNodes.length;t++){const i=this._runtimeNodes[t];if(!(0,a.A)(i))continue;i.configurePipeline();const o=i.pipelineStages,r=new I.A(n,i);n.nodeRenderResources[t]=r;for(let t=0;t<o.length;t++)o[t].process(r,i.node,e);for(let t=0;t<i.runtimePrimitives.length;t++){const n=i.runtimePrimitives[t];n.configurePipeline(e);const o=n.pipelineStages,s=new P.A(r,n);r.primitiveRenderResources[t]=s;for(let t=0;t<o.length;t++)o[t].process(s,n.primitive,e)}}return n},R.prototype.computeBoundingVolumes=function(e){const t=this._model,n=o.A.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,B),r=o.A.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,F);for(let t=0;t<this._runtimeNodes.length;t++){const s=this._runtimeNodes[t];if(!(0,a.A)(s))continue;const l=e.nodeRenderResources[t],u=s.computedTransform;for(let e=0;e<s.runtimePrimitives.length;e++){const t=s.runtimePrimitives[e],a=l.primitiveRenderResources[e];t.boundingSphere=i.A.clone(a.boundingSphere,new i.A);const d=c.A.multiplyByPoint(u,a.positionMin,U),h=c.A.multiplyByPoint(u,a.positionMax,k);o.A.minimumByComponent(n,d,n),o.A.maximumByComponent(r,h,r)}}this._boundingSphere=i.A.fromCornerPoints(n,r,new i.A),this._boundingSphere=i.A.transformWithoutScale(this._boundingSphere,this._axisCorrectionMatrix,this._boundingSphere),this._boundingSphere=i.A.transform(this._boundingSphere,this._components.transform,this._boundingSphere),t._boundingSphere=i.A.transform(this._boundingSphere,t.modelMatrix,t._boundingSphere),t._initialRadius=t._boundingSphere.radius,t._boundingSphere.radius*=t._clampedScale},R.prototype.createDrawCommands=function(e,t){for(let n=0;n<this._runtimeNodes.length;n++){const i=this._runtimeNodes[n];if(!(0,a.A)(i))continue;const o=e.nodeRenderResources[n];for(let e=0;e<i.runtimePrimitives.length;e++){const n=i.runtimePrimitives[e],r=o.primitiveRenderResources[e],s=D.A.buildModelDrawCommand(r,t);n.drawCommand=s}}},R.prototype.configurePipeline=function(e){const t=this.modelPipelineStages;t.length=0;const n=this._model,i=e.fog.enabled&&e.fog.renderable;(0,a.A)(n.color)&&t.push(m.A),(0,a.A)(n.classificationType)||(n.imageBasedLighting.enabled&&t.push(p.A),n.isClippingEnabled()&&t.push(g.A),n.isClippingPolygonsEnabled()&&t.push(_.A),n.hasSilhouette(e)&&t.push(C.A),(0,a.A)(n.splitDirection)&&n.splitDirection!==d.A.NONE&&t.push(E.A),S.A.is3DTiles(n.type)&&t.push(h.A),i&&t.push(A.A))},R.prototype.update=function(e,t){let n,i,o;for(n=0;n<this._runtimeNodes.length;n++){const r=this._runtimeNodes[n];if(!(0,a.A)(r))continue;for(i=0;i<r.updateStages.length;i++)r.updateStages[i].update(r,this,e);const s=e.mode!==u.A.SCENE3D&&this._model._projectTo2D;for(t&&!s&&this.updateJointMatrices(),i=0;i<r.runtimePrimitives.length;i++){const e=r.runtimePrimitives[i];for(o=0;o<e.updateStages.length;o++)e.updateStages[o].update(e,this)}}},R.prototype.updateModelMatrix=function(e,t){M(this,e),t.mode!==u.A.SCENE3D&&function(e,t){const n=e._computedModelMatrix,r=c.A.getTranslation(n,L);if(o.A.equals(r,o.A.ZERO)){const i=e.boundingSphere.center,o=l.A.ellipsoidTo2DModelMatrix(t.mapProjection,i,e._computedModelMatrix2D);e._computedModelMatrix2D=c.A.multiply(o,n,e._computedModelMatrix2D)}else e._computedModelMatrix2D=l.A.basisTo2D(t.mapProjection,n,e._computedModelMatrix2D);e._boundingSphere2D=i.A.transform(e._boundingSphere,e._computedModelMatrix2D,e._boundingSphere2D)}(this,t);const n=this._rootNodes;for(let e=0;e<n.length;e++)this._runtimeNodes[n[e]]._transformDirty=!0},R.prototype.updateJointMatrices=function(){const e=this._skinnedNodes,t=e.length;for(let n=0;n<t;n++){const t=e[n];this._runtimeNodes[t].updateJointMatrices()}};const H={backFaceCulling:void 0};function G(e,t){e.drawCommand.backFaceCulling=t.backFaceCulling}R.prototype.updateBackFaceCulling=function(e){const t=H;t.backFaceCulling=e,z(this,!1,G,t)};const W={shadowMode:void 0};function Y(e,t){e.drawCommand.shadows=t.shadowMode}R.prototype.updateShadows=function(e){const t=W;t.shadowMode=e,z(this,!1,Y,t)};const q={debugShowBoundingVolume:void 0};function j(e,t){e.drawCommand.debugShowBoundingVolume=t.debugShowBoundingVolume}R.prototype.updateShowBoundingVolume=function(e){const t=q;t.debugShowBoundingVolume=e,z(this,!1,j,t)};const Q=[],X={frameState:void 0,hasSilhouette:void 0};function K(e,t){const n=t.frameState,i=t.hasSilhouette,o=n.passes,r=Q,s=e.drawCommand;s.pushCommands(n,n.commandList),i&&!o.pick&&s.pushSilhouetteCommands(n,r)}R.prototype.pushDrawCommands=function(e){const t=Q;t.length=0;const n=X;n.hasSilhouette=this._model.hasSilhouette(e),n.frameState=e,z(this,!0,K,n),(0,O.A)(e.commandList,t)},R.prototype.setArticulationStage=function(e,t){const n=e.split(" ");if(2!==n.length)return;const i=n[0],o=n[1],r=this._runtimeArticulations[i];(0,a.A)(r)&&r.setArticulationStage(o,t)},R.prototype.applyArticulations=function(){const e=this._runtimeArticulations;for(const t in e)e.hasOwnProperty(t)&&e[t].apply()};const $=R},746761:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(430346),o=n(491446),r=n(624512),s=n(221334),a=n(980678);const c={name:"ModelSilhouettePipelineStage",silhouettesLength:0,process:function(e,t,n){(0,o.A)(t._silhouetteId)||(t._silhouetteId=++c.silhouettesLength);const l=e.shaderBuilder;l.addDefine("HAS_SILHOUETTE",void 0,r.A.BOTH),l.addVertexLines(a.A),l.addFragmentLines(s.A),l.addUniform("vec4","model_silhouetteColor",r.A.FRAGMENT),l.addUniform("float","model_silhouetteSize",r.A.VERTEX),l.addUniform("bool","model_silhouettePass",r.A.BOTH);const u={model_silhouetteColor:function(){return t.silhouetteColor},model_silhouetteSize:function(){return t.silhouetteSize},model_silhouettePass:function(){return!1}};e.uniformMap=(0,i.A)(u,e.uniformMap),e.hasSilhouette=!0}},l=c},496854:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(584164),o=n(369031),r=n(915325);function s(e){e=e??r.A.EMPTY_OBJECT,o.A.typeOf.object("options.skin",e.skin),o.A.typeOf.object("options.sceneGraph",e.sceneGraph),this._sceneGraph=e.sceneGraph;const t=e.skin;this._skin=t,this._inverseBindMatrices=void 0,this._joints=[],this._jointMatrices=[],function(e){const t=e.skin,n=t.inverseBindMatrices;e._inverseBindMatrices=n;const o=t.joints,r=o.length,s=e.sceneGraph._runtimeNodes,c=e.joints,l=e._jointMatrices;for(let e=0;e<r;e++){const t=s[o[e].index];c.push(t);const r=a(t,n[e],new i.A);l.push(r)}}(this)}function a(e,t,n){const o=i.A.multiplyTransformation(e.transformToRoot,e.transform,n);return i.A.multiplyTransformation(o,t,n)}Object.defineProperties(s.prototype,{skin:{get:function(){return this._skin}},sceneGraph:{get:function(){return this._sceneGraph}},inverseBindMatrices:{get:function(){return this._inverseBindMatrices}},joints:{get:function(){return this._joints}},jointMatrices:{get:function(){return this._jointMatrices}}}),s.prototype.updateJointMatrices=function(){const e=this._jointMatrices,t=e.length;for(let n=0;n<t;n++){const t=this.joints[n],i=this.inverseBindMatrices[n];e[n]=a(t,i,e[n])}};const c=s},566258:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(430346),o=n(768601),r=n(624512);const s={name:"ModelSplitterPipelineStage",SPLIT_DIRECTION_UNIFORM_NAME:"model_splitDirection",process:function(e,t,n){const a=e.shaderBuilder;a.addDefine("HAS_MODEL_SPLITTER",void 0,r.A.FRAGMENT),a.addFragmentLines(o.A);const c={};a.addUniform("float",s.SPLIT_DIRECTION_UNIFORM_NAME,r.A.FRAGMENT),c[s.SPLIT_DIRECTION_UNIFORM_NAME]=function(){return t.splitDirection},e.uniformMap=(0,i.A)(c,e.uniformMap)}},a=s},650884:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(288787),o=n(369031);function r(){this.pointsLength=0,this.trianglesLength=0,this.geometryByteLength=0,this.texturesByteLength=0,this.propertyTablesByteLength=0,this._bufferIdSet={},this._textureIdByteLengths={},this._batchTextureIdMap=new i.A}Object.defineProperties(r.prototype,{batchTexturesByteLength:{get:function(){const e=this._batchTextureIdMap.length,t=this._batchTextureIdMap.values;let n=0;for(let i=0;i<e;i++)n+=t[i].byteLength;return n}}}),r.prototype.clear=function(){this.pointsLength=0,this.trianglesLength=0,this.geometryByteLength=0,this.texturesByteLength=0,this.propertyTablesByteLength=0,this._bufferIdSet={},this._textureIdByteLengths={},this._batchTextureIdMap.removeAll()},r.prototype.addBuffer=function(e,t){if(o.A.typeOf.object("buffer",e),o.A.typeOf.bool("hasCpuCopy",t),!this._bufferIdSet.hasOwnProperty(e._id)){const n=t?2:1;this.geometryByteLength+=e.sizeInBytes*n}this._bufferIdSet[e._id]=!0},r.prototype.addTexture=function(e){o.A.typeOf.object("texture",e),this._textureIdByteLengths.hasOwnProperty(e._id)||(this.texturesByteLength+=e.sizeInBytes,this._textureIdByteLengths[e._id]=e.sizeInBytes)},r.prototype.getTextureIds=function(){return Object.keys(this._textureIdByteLengths)},r.prototype.getTextureByteLengthById=function(e){return this._textureIdByteLengths[e]},r.prototype.addBatchTexture=function(e){o.A.typeOf.object("batchTexture",e),this._batchTextureIdMap.contains(e._id)||this._batchTextureIdMap.set(e._id,e)};const s=r},226827:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(369031),o=n(605971);const r={GLTF:"GLTF",TILE_GLTF:"TILE_GLTF",TILE_B3DM:"B3DM",TILE_I3DM:"I3DM",TILE_PNTS:"PNTS",TILE_GEOJSON:"TILE_GEOJSON",is3DTiles:function(e){switch(i.A.typeOf.string("modelType",e),e){case r.TILE_GLTF:case r.TILE_B3DM:case r.TILE_I3DM:case r.TILE_PNTS:case r.TILE_GEOJSON:return!0;case r.GLTF:return!1;default:throw new o.A("modelType is not a valid value.")}}},s=Object.freeze(r)},471147:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var i=n(267980),o=n(491446),r=n(584164),s=n(99479),a=n(123245),c=n(320475),l=n(730839),u=n(595826),d=n(527083),h=n(402330),A=n(331185);function p(){}p.getError=function(e,t,n){let i=`Failed to load ${e}: ${t}`;(0,o.A)(n)&&(0,o.A)(n.message)&&(i+=`\n${n.message}`);const r=new a.A(i);return(0,o.A)(n)&&(r.stack=`Original stack:\n${n.stack}\nHandler stack:\n${r.stack}`),r},p.getNodeTransform=function(e){return(0,o.A)(e.matrix)?e.matrix:r.A.fromTranslationQuaternionRotationScale((0,o.A)(e.translation)?e.translation:i.A.ZERO,(0,o.A)(e.rotation)?e.rotation:s.A.IDENTITY,(0,o.A)(e.scale)?e.scale:i.A.ONE)},p.getAttributeBySemantic=function(e,t,n){const i=e.attributes,r=i.length;for(let e=0;e<r;++e){const r=i[e],s=!(0,o.A)(n)||r.setIndex===n;if(r.semantic===t&&s)return r}},p.getAttributeByName=function(e,t){const n=e.attributes,i=n.length;for(let e=0;e<i;++e){const i=n[e];if(i.name===t)return i}},p.getFeatureIdsByLabel=function(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.positionalLabel===t||i.label===t)return i}},p.hasQuantizedAttributes=function(e){if(!(0,o.A)(e))return!1;for(let t=0;t<e.length;t++){const n=e[t];if((0,o.A)(n.quantization))return!0}return!1},p.getAttributeInfo=function(e){const t=e.semantic,n=e.setIndex;let i,r=!1;(0,o.A)(t)?(i=u.A.getVariableName(t,n),r=!0):(i=e.name,i=i.replace(/^_/,""),i=i.toLowerCase());const s=/^color_\d+$/.test(i),a=e.type;let c=l.A.getGlslType(a);s&&(c="vec4");const d=(0,o.A)(e.quantization);let h;return d&&(h=s?"vec4":l.A.getGlslType(e.quantization.type)),{attribute:e,isQuantized:d,variableName:i,hasSemantic:r,glslType:c,quantizedGlslType:h}};const f=new i.A,m=new i.A;p.getPositionMinMax=function(e,t,n){const r=p.getAttributeBySemantic(e,"POSITION");let s=r.max,a=r.min;return(0,o.A)(n)&&(0,o.A)(t)&&(a=i.A.add(a,t,m),s=i.A.add(s,n,f)),{min:a,max:s}},p.getAxisCorrectionMatrix=function(e,t,n){return n=r.A.clone(r.A.IDENTITY,n),e===c.A.Y?n=r.A.clone(c.A.Y_UP_TO_Z_UP,n):e===c.A.X&&(n=r.A.clone(c.A.X_UP_TO_Z_UP,n)),t===c.A.Z&&(n=r.A.multiplyTransformation(n,c.A.Z_UP_TO_X_UP,n)),n};const g=new A.A;p.getCullFace=function(e,t){if(!h.A.isTriangles(t))return d.A.BACK;const n=r.A.getMatrix3(e,g);return A.A.determinant(n)<0?d.A.FRONT:d.A.BACK},p.sanitizeGlslIdentifier=function(e){let t=e.replaceAll(/[^A-Za-z0-9]+/g,"_");return t=t.replace(/^gl_/,""),/^\d/.test(t)&&(t=`_${t}`),t},p.supportedExtensions={AGI_articulations:!0,CESIUM_primitive_outline:!0,CESIUM_RTC:!0,EXT_feature_metadata:!0,EXT_implicit_cylinder_region:!0,EXT_implicit_ellipsoid_region:!0,EXT_instance_features:!0,EXT_mesh_features:!0,EXT_mesh_gpu_instancing:!0,EXT_meshopt_compression:!0,EXT_primitive_voxels:!0,EXT_structural_metadata:!0,EXT_texture_webp:!0,KHR_blend:!0,KHR_draco_mesh_compression:!0,KHR_implicit_shapes:!0,KHR_materials_common:!0,KHR_materials_pbrSpecularGlossiness:!0,KHR_materials_specular:!0,KHR_materials_anisotropy:!0,KHR_materials_clearcoat:!0,KHR_materials_unlit:!0,KHR_mesh_quantization:!0,KHR_techniques_webgl:!0,KHR_texture_basisu:!0,KHR_texture_transform:!0,KHR_gaussian_splatting:!0,KHR_gaussian_splatting_compression_spz_2:!0,KHR_spz_gaussian_splats_compression:!0,WEB3D_quantized_attributes:!0},p.checkSupportedExtensions=function(e){const t=e.length;for(let n=0;n<t;n++){const t=e[n];if(!p.supportedExtensions[t])throw new a.A(`Unsupported glTF Extension: ${t}`)}};const _=p},163010:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var i=n(730839),o=n(430346),r=n(491446),s=n(624512),a=n(828077),c=n(595826);const l={name:"MorphTargetsPipelineStage",FUNCTION_ID_GET_MORPHED_POSITION:"getMorphedPosition",FUNCTION_SIGNATURE_GET_MORPHED_POSITION:"vec3 getMorphedPosition(in vec3 position)",FUNCTION_ID_GET_MORPHED_NORMAL:"getMorphedNormal",FUNCTION_SIGNATURE_GET_MORPHED_NORMAL:"vec3 getMorphedNormal(in vec3 normal)",FUNCTION_ID_GET_MORPHED_TANGENT:"getMorphedTangent",FUNCTION_SIGNATURE_GET_MORPHED_TANGENT:"vec3 getMorphedTangent(in vec3 tangent)",process:function(e,t){const n=e.shaderBuilder;n.addDefine("HAS_MORPH_TARGETS",void 0,s.A.VERTEX),function(e){e.addFunction(l.FUNCTION_ID_GET_MORPHED_POSITION,l.FUNCTION_SIGNATURE_GET_MORPHED_POSITION,s.A.VERTEX);e.addFunctionLines(l.FUNCTION_ID_GET_MORPHED_POSITION,["vec3 morphedPosition = position;"]),e.addFunction(l.FUNCTION_ID_GET_MORPHED_NORMAL,l.FUNCTION_SIGNATURE_GET_MORPHED_NORMAL,s.A.VERTEX);e.addFunctionLines(l.FUNCTION_ID_GET_MORPHED_NORMAL,["vec3 morphedNormal = normal;"]),e.addFunction(l.FUNCTION_ID_GET_MORPHED_TANGENT,l.FUNCTION_SIGNATURE_GET_MORPHED_TANGENT,s.A.VERTEX);e.addFunctionLines(l.FUNCTION_ID_GET_MORPHED_TANGENT,["vec3 morphedTangent = tangent;"])}(n);const i=t.morphTargets.length;for(let n=0;n<i;n++){const i=t.morphTargets[n].attributes,o=i.length;for(let t=0;t<o;t++){const o=i[t],r=o.semantic;r!==c.A.POSITION&&r!==c.A.NORMAL&&r!==c.A.TANGENT||(d(e,o,e.attributeIndex,n),e.attributeIndex++)}}!function(e){e.addFunctionLines(l.FUNCTION_ID_GET_MORPHED_POSITION,["return morphedPosition;"]);e.addFunctionLines(l.FUNCTION_ID_GET_MORPHED_NORMAL,["return morphedNormal;"]);e.addFunctionLines(l.FUNCTION_ID_GET_MORPHED_TANGENT,["return morphedTangent;"])}(n);const r=e.runtimeNode.morphWeights.length;n.addUniform("float",`u_morphWeights[${r}]`,s.A.VERTEX),n.addVertexLines(a.A);const u={u_morphWeights:function(){return e.runtimeNode.morphWeights}};e.uniformMap=(0,o.A)(u,e.uniformMap)}},u={attributeString:void 0,functionId:void 0};function d(e,t,n,o){const s=e.shaderBuilder;!function(e,t,n){const o={index:n,value:(0,r.A)(t.buffer)?void 0:t.constant,vertexBuffer:t.buffer,componentsPerAttribute:i.A.getNumberOfComponents(t.type),componentDatatype:t.componentDatatype,offsetInBytes:t.byteOffset,strideInBytes:t.byteStride,normalize:t.normalized};e.attributes.push(o)}(e,t,n);const a=function(e,t){switch(e.semantic){case c.A.POSITION:t.attributeString="Position",t.functionId=l.FUNCTION_ID_GET_MORPHED_POSITION;break;case c.A.NORMAL:t.attributeString="Normal",t.functionId=l.FUNCTION_ID_GET_MORPHED_NORMAL;break;case c.A.TANGENT:t.attributeString="Tangent",t.functionId=l.FUNCTION_ID_GET_MORPHED_TANGENT}return t}(t,u);!function(e,t,n){const i=t.attributeString,o=`a_target${i}_${n}`,r=`morphed${i} += u_morphWeights[${n}] * a_target${i}_${n};`;e.addAttribute("vec3",o),e.addFunctionLines(t.functionId,[r])}(s,a,o)}const h=l},604883:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(369031),o=n(376758);const r=function(e,t){i.A.typeOf.object("modelRenderResources",e),i.A.typeOf.object("runtimeNode",t),this.model=e.model,this.shaderBuilder=e.shaderBuilder.clone(),this.uniformMap=(0,o.A)(e.uniformMap),this.alphaOptions=(0,o.A)(e.alphaOptions),this.renderStateOptions=(0,o.A)(e.renderStateOptions,!0),this.hasSilhouette=e.hasSilhouette,this.hasSkipLevelOfDetail=e.hasSkipLevelOfDetail,this.runtimeNode=t,this.attributes=[],this.attributeIndex=1,this.featureIdVertexAttributeSetIndex=0,this.instanceCount=0,this.primitiveRenderResources=[]}},799395:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(491446);const o={name:"NodeStatisticsPipelineStage",_countInstancingAttributes:r,_countGeneratedBuffers:s};function r(e,t){if(!(0,i.A)(t))return;const n=t.attributes,o=n.length;for(let t=0;t<o;t++){const o=n[t];if((0,i.A)(o.buffer)){const t=!1;e.addBuffer(o.buffer,t)}}}function s(e,t){if((0,i.A)(t.instancingTransformsBuffer)){const n=!1;e.addBuffer(t.instancingTransformsBuffer,n)}if((0,i.A)(t.instancingTransformsBuffer2D)){const n=!1;e.addBuffer(t.instancingTransformsBuffer2D,n)}if((0,i.A)(t.instancingTranslationBuffer2D)){const n=!1;e.addBuffer(t.instancingTranslationBuffer2D,n)}}o.process=function(e,t,n){const i=e.model.statistics,o=t.instances,a=e.runtimeNode;r(i,o),s(i,a)};const a=o},601945:(e,t,n)=>{"use strict";n.d(t,{A:()=>A});var i=n(641613),o=n(442790),r=n(41476),s=n(571804),a=n(491446),c=n(624512),l=n(226827),u=n(471147);const d={name:"PickingPipelineStage"};function h(e,t){const n=e.model;if((0,a.A)(n.pickObject))return n.pickObject;const i={model:n,node:e.runtimeNode,primitive:e.runtimePrimitive};let o;if(l.A.is3DTiles(n.type)){const e=n.content;o={content:e,primitive:e.tileset,detail:i}}else o={primitive:n,detail:i};return o.id=n.id,(0,a.A)(t)&&(o.instanceId=t),o}d.process=function(e,t,n){const l=n.context,d=e.runtimeNode,A=e.shaderBuilder,p=e.model,f=d.node.instances;if(e.hasPropertyTable)!function(e,t,n){const i=e.model;let o,r;const s=i.featureIdLabel,l=i.instanceFeatureIdLabel;(0,a.A)(i.featureTableId)?o=i.featureTableId:(0,a.A)(n)?(r=u.A.getFeatureIdsByLabel(n.featureIds,l),o=r.propertyTableId):(r=u.A.getFeatureIdsByLabel(t.featureIds,s),o=r.propertyTableId);const d=i.featureTables[o];e.shaderBuilder.addUniform("sampler2D","model_pickTexture",c.A.FRAGMENT);const h=d.batchTexture;e.uniformMap.model_pickTexture=function(){return h.pickTexture??h.defaultTexture},e.pickId="((selectedFeature.id < int(model_featuresLength)) ? texture(model_pickTexture, selectedFeature.st) : vec4(0.0))"}(e,t,f);else if((0,a.A)(f))!function(e,t){const n=e.instanceCount,a=new Array(n),l=new Uint8Array(4*n),u=e.model,d=u._pipelineResources;for(let i=0;i<n;i++){const n=h(e,i),o=t.createPickId(n);d.push(o),a[i]=o;const s=o.color;l[4*i+0]=r.A.floatToByte(s.red),l[4*i+1]=r.A.floatToByte(s.green),l[4*i+2]=r.A.floatToByte(s.blue),l[4*i+3]=r.A.floatToByte(s.alpha)}u._pickIds=a;const A=i.A.createVertexBuffer({context:t,typedArray:l,usage:o.A.STATIC_DRAW});A.vertexArrayDestroyable=!1;u.statistics.addBuffer(A,!1),d.push(A);const p={index:e.attributeIndex++,vertexBuffer:A,componentsPerAttribute:4,componentDatatype:s.A.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0,instanceDivisor:1};e.attributes.push(p);const f=e.shaderBuilder;f.addDefine("USE_PICKING",void 0,c.A.BOTH),f.addAttribute("vec4","a_pickColor"),f.addVarying("vec4","v_pickColor"),e.pickId="v_pickColor"}(e,l);else{const t=h(e),n=l.createPickId(t);p._pipelineResources.push(n),p._pickIds.push(n),A.addUniform("vec4","czm_pickColor",c.A.FRAGMENT),e.uniformMap.czm_pickColor=function(){return n.color},e.pickId="czm_pickColor"}};const A=d},31908:(e,t,n)=>{"use strict";n.d(t,{A:()=>Q});var i=n(961645),o=n(267980),r=n(41476),s=n(369031),a=n(571804),c=n(915325),l=n(491446),u=n(605971),d=n(584164),h=n(402330),A=n(352581),p=n(393682),f=n(641613),m=n(442790),g=n(953019),_=n(730839),y=n(320475),v=n(115959),T=n(445848),b=n(590732),w=n(569445),x=n(995537),C=n(679854),E=n(48660),S=n(595826);const I=x.A.Components,P=x.A.Scene,D=x.A.Node,O=x.A.Primitive,R=x.A.Attribute,M=x.A.Quantization,L=x.A.FeatureIdAttribute,N=x.A.Material,B=x.A.MetallicRoughness;function F(e){const t=(e=e??c.A.EMPTY_OBJECT).arrayBuffer,n=e.byteOffset??0;s.A.typeOf.object("options.arrayBuffer",t),this._arrayBuffer=t,this._byteOffset=n,this._loadAttributesFor2D=e.loadAttributesFor2D??!1,this._parsedContent=void 0,this._decodePromise=void 0,this._decodedAttributes=void 0,this._promise=void 0,this._error=void 0,this._state=E.A.UNLOADED,this._buffers=[],this._components=void 0,this._transform=d.A.IDENTITY}function U(e){switch(e){case 1:return"SCALAR";case 2:return"VEC2";case 3:return"VEC3";case 4:return"VEC4";default:throw new u.A("componentsPerAttribute must be a number from 1-4")}}function k(e){switch(e){case A.A.BYTE:return"BYTE";case A.A.UNSIGNED_BYTE:return"UNSIGNED_BYTE";case A.A.SHORT:return"SHORT";case A.A.UNSIGNED_SHORT:return"UNSIGNED_SHORT";case A.A.INT:return"INT";case A.A.UNSIGNED_INT:return"UNSIGNED_INT";case A.A.DOUBLE:return"DOUBLE";case A.A.FLOAT:return"FLOAT";default:throw new u.A("value is not a valid WebGL constant")}}function V(e,t,n){let s,a=t.typedArray;if(t.octEncoded&&(s=new M,s.octEncoded=t.octEncoded,s.octEncodedZXY=t.octEncodedZXY,s.normalizationRange=t.quantizedRange,s.type=t.quantizedType,s.componentDatatype=t.quantizedComponentDatatype),t.isQuantized){s=new M;const e=t.quantizedRange;s.normalizationRange=e,s.quantizedVolumeOffset=o.A.ZERO;const n=t.quantizedVolumeScale;s.quantizedVolumeDimensions=n,s.quantizedVolumeStepSize=o.A.divideByScalar(n,e,new o.A),s.componentDatatype=t.quantizedComponentDatatype,s.type=t.quantizedType}const c=new R;if(c.name=t.name,c.semantic=t.semantic,c.setIndex=t.setIndex,c.componentDatatype=t.componentDatatype,c.type=t.type,c.normalized=t.normalized??!1,c.min=t.min,c.max=t.max,c.quantization=s,t.isRGB565&&(a=i.A.decodeRGB565(a)),(0,l.A)(t.constantColor)){const e=new Array(4);c.constant=r.A.pack(t.constantColor,e)}else{const t=f.A.createVertexBuffer({typedArray:a,context:n,usage:m.A.STATIC_DRAW});t.vertexArrayDestroyable=!1,e._buffers.push(t),c.buffer=t}const u=e._loadAttributesFor2D;return c.semantic===S.A.POSITION&&u&&(c.typedArray=a),c}let z,H;function G(e){if(!(0,l.A)(H)){z=new p(0),H=new Array(e);for(let t=0;t<e;++t)H[t]=z.random()}return H}(0,l.A)(Object.create)&&(F.prototype=Object.create(w.A.prototype),F.prototype.constructor=F),Object.defineProperties(F.prototype,{cacheKey:{get:function(){}},components:{get:function(){return this._components}},transform:{get:function(){return this._transform}}}),F.prototype.load=function(){if((0,l.A)(this._promise))return this._promise;this._parsedContent=C.A.parse(this._arrayBuffer,this._byteOffset),this._state=E.A.PROCESSING,this._promise=Promise.resolve(this)},F.prototype.process=function(e){if((0,l.A)(this._error)){const e=this._error;throw this._error=void 0,e}if(this._state===E.A.READY)return!0;if(this._state===E.A.PROCESSING){if((0,l.A)(this._decodePromise))return!1;this._decodePromise=function(e,t){const n=e._parsedContent.draco;let i;if(i=(0,l.A)(n)?T.A.decodePointCloud(n,t):Promise.resolve(),(0,l.A)(i))return e._decodePromise=i,i.then(function(i){if(!e.isDestroyed())return(0,l.A)(i)&&function(e,t,n){e._state=E.A.READY;const i=e._parsedContent;let r;if((0,l.A)(n.POSITION)){if(r={name:"POSITION",semantic:S.A.POSITION,typedArray:n.POSITION.array,componentDatatype:a.A.FLOAT,type:_.A.VEC3,isQuantized:!1},(0,l.A)(n.POSITION.data.quantization)){const e=n.POSITION.data.quantization,t=e.range,i=o.A.fromElements(t,t,t),s=o.A.unpack(e.minValues),c=(1<<e.quantizationBits)-1;r.isQuantized=!0,r.quantizedRange=c,r.quantizedVolumeOffset=s,r.quantizedVolumeScale=i,r.quantizedComponentDatatype=c<=255?a.A.UNSIGNED_BYTE:a.A.UNSIGNED_SHORT,r.quantizedType=_.A.VEC3}i.positions=r}if((0,l.A)(n.NORMAL)){if(r={name:"NORMAL",semantic:S.A.NORMAL,typedArray:n.NORMAL.array,componentDatatype:a.A.FLOAT,type:_.A.VEC3,isQuantized:!1,octEncoded:!1,octEncodedZXY:!1},(0,l.A)(n.NORMAL.data.quantization)){const e=(1<<n.NORMAL.data.quantization.quantizationBits)-1;r.quantizedRange=e,r.octEncoded=!0,r.octEncodedZXY=!0,r.quantizedComponentDatatype=a.A.UNSIGNED_BYTE,r.quantizedType=_.A.VEC2}i.normals=r}if((0,l.A)(n.RGBA)?i.colors={name:"COLOR",semantic:S.A.COLOR,setIndex:0,typedArray:n.RGBA.array,componentDatatype:a.A.UNSIGNED_BYTE,type:_.A.VEC4,normalized:!0,isTranslucent:!0}:(0,l.A)(n.RGB)&&(i.colors={name:"COLOR",semantic:S.A.COLOR,setIndex:0,typedArray:n.RGB.array,componentDatatype:a.A.UNSIGNED_BYTE,type:_.A.VEC3,normalized:!0,isTranslucent:!1}),(0,l.A)(n.BATCH_ID)){const e=n.BATCH_ID.array;i.batchIds={name:"_FEATURE_ID",semantic:S.A.FEATURE_ID,setIndex:0,typedArray:e,componentDatatype:a.A.fromTypedArray(e),type:_.A.SCALAR}}let s=i.batchTableJson;const c=t.batchTableProperties;for(const e in c)if(c.hasOwnProperty(e)){const t=n[e];(0,l.A)(s)||(s={}),i.hasDracoBatchTable=!0;const o=t.data;s[e]={byteOffset:o.byteOffset,type:U(o.componentsPerAttribute),componentType:k(o.componentDatatype),typedArray:t.array}}i.batchTableJson=s}(e,n,i),function(e,t){const n=e._parsedContent,i=new B;i.metallicFactor=0,i.roughnessFactor=.9;const r=new N;r.metallicRoughness=i;const s=n.colors;(0,l.A)(s)&&s.isTranslucent&&(r.alphaMode=g.A.BLEND);const a=!(0,l.A)(n.normals);r.unlit=a;const c=new O;if(c.attributes=function(e,t,n){const i=[];let r;const s=t.positions;return(0,l.A)(s)&&(function(e){const t=e.typedArray,n=t.length/3,i=Math.min(n,20),r=G(20),s=Number.MAX_VALUE,a=-Number.MAX_VALUE;let c,l,u,d=o.A.fromElements(s,s,s,W),h=o.A.fromElements(a,a,a,Y);if(e.isQuantized)d=o.A.ZERO,h=e.quantizedVolumeScale;else for(c=0;c<i;++c)l=Math.floor(r[c]*n),u=o.A.unpack(t,3*l,q),o.A.minimumByComponent(d,u,d),o.A.maximumByComponent(h,u,h);e.min=o.A.clone(d),e.max=o.A.clone(h)}(s),r=V(e,s,n),r.count=t.pointsLength,i.push(r)),(0,l.A)(t.normals)&&(r=V(e,t.normals,n),i.push(r)),(0,l.A)(t.colors)?(r=V(e,t.colors,n),i.push(r)):(r=V(e,j,n),i.push(r)),(0,l.A)(t.batchIds)&&(r=V(e,t.batchIds,n),i.push(r)),i}(e,n,t),c.primitiveType=h.A.POINTS,c.material=r,(0,l.A)(n.batchIds)){const e=new L;e.propertyTableId=0,e.setIndex=0,e.positionalLabel="featureId_0",c.featureIds.push(e)}const u=new D;u.index=0,u.primitives=[c];const A=new P;A.nodes=[u],A.upAxis=y.A.Z,A.forwardAxis=y.A.X;const p=new I;p.scene=A,p.nodes=[u];const _=[];p.structuralMetadata=function(e,t){const n=e.batchLength,i=e.pointsLength,o=e.batchTableJson,r=e.batchTableBinary,s=!(0,l.A)(e.batchIds);if((0,l.A)(r)||(0,l.A)(o)||e.hasDracoBatchTable){const e=n??i;return(0,v.A)({count:e,batchTable:o,binaryBody:r,parseAsPropertyAttributes:s,customAttributeOutput:t})}return new b.A({schema:{},propertyTables:[]})}(n,_),_.length>0&&function(e,t,n,i){const o=t.attributes,r=n.length;for(let t=0;t<r;t++){const r=n[t],s=f.A.createVertexBuffer({typedArray:r.typedArray,context:i,usage:m.A.STATIC_DRAW});s.vertexArrayDestroyable=!1,e._buffers.push(s),r.buffer=s,r.typedArray=void 0,o.push(r)}t.propertyAttributeIds=[0]}(e,c,_,t),(0,l.A)(n.rtcCenter)&&(p.transform=d.A.multiplyByTranslation(p.transform,n.rtcCenter,p.transform));const T=n.positions;(0,l.A)(T)&&T.isQuantized&&(p.transform=d.A.multiplyByTranslation(p.transform,T.quantizedVolumeOffset,p.transform)),e._components=p,e._parsedContent=void 0,e._arrayBuffer=void 0}(e,t),e._state=E.A.READY,e}).catch(function(t){e.unload(),e._state=E.A.FAILED;e._error=e.getError("Failed to load Draco pnts",t)})}(this,e.context)}return!1};const W=new o.A,Y=new o.A,q=new o.A,j={name:S.A.COLOR,semantic:S.A.COLOR,setIndex:0,constantColor:r.A.DARKGRAY,componentDatatype:a.A.FLOAT,type:_.A.VEC4,isQuantized:!1,isTranslucent:!1};F.prototype.unload=function(){const e=this._buffers;for(let t=0;t<e.length;t++)e[t].destroy();e.length=0,this._components=void 0,this._parsedContent=void 0,this._arrayBuffer=void 0};const Q=F},752709:(e,t,n)=>{"use strict";n.d(t,{A:()=>E});var i=n(267980),o=n(626809),r=n(367817),s=n(661314),a=n(376758),c=n(491446),l=n(584164),u=n(226827),d=n(471147),h=n(811203),A=n(760866),p=n(7562),f=n(123245),m=n(62467),g=n(624512),_=n(595826);const y=new o.A,v={name:"PointCloudStylingPipelineStage",process:function(e,t,n){const o=e.shaderBuilder,v=e.model,E=v.style,S=v.structuralMetadata,I=(0,c.A)(S)?S.propertyAttributes:void 0,P=(0,c.A)(v.featureTableId)&&v.featureTables[v.featureTableId].featuresLength>0,D=!(0,c.A)(I)&&P;if((0,c.A)(E)&&!D){const n=function(e){const t=(0,a.A)(w);if(!(0,c.A)(e))return t;for(let n=0;n<e.length;n++){const i=e[n].properties;for(const e in i)i.hasOwnProperty(e)&&(t[e]=`metadata.${e}`)}return t}(I),i=function(e,t){const n=b,i={translucent:!1};return n.colorStyleFunction=e.getColorShaderFunction(`getColorFromStyle(${x})`,t,i),n.showStyleFunction=e.getShowShaderFunction(`getShowFromStyle(${x})`,t,i),n.pointSizeStyleFunction=e.getPointSizeShaderFunction(`getPointSizeFromStyle(${x})`,t,i),n.styleTranslucent=(0,c.A)(n.colorStyleFunction)&&i.translucent,n}(E,n);!function(e,t){const n=t.colorStyleFunction;(0,c.A)(n)&&(e.addDefine("HAS_POINT_CLOUD_COLOR_STYLE",void 0,g.A.BOTH),e.addVertexLines(n),e.addVarying("vec4","v_pointCloudColor"));const i=t.showStyleFunction;(0,c.A)(i)&&(e.addDefine("HAS_POINT_CLOUD_SHOW_STYLE",void 0,g.A.BOTH),e.addVertexLines(i),e.addVarying("float","v_pointCloudShow"));const o=t.pointSizeStyleFunction;(0,c.A)(o)&&(e.addDefine("HAS_POINT_CLOUD_POINT_SIZE_STYLE",void 0,g.A.VERTEX),e.addVertexLines(o))}(o,i);const r=function(e){const t=e.colorStyleFunction,n=e.showStyleFunction,i=e.pointSizeStyleFunction,o=[];return(0,c.A)(t)&&C(t,o),(0,c.A)(n)&&C(n,o),(0,c.A)(i)&&C(i,o),o}(i),s=r.indexOf("normalMC")>=0,l=d.A.getAttributeBySemantic(t,_.A.NORMAL);if(s&&!l)throw new f.A("Style references the NORMAL semantic but the point cloud does not have normals");o.addDefine("COMPUTE_POSITION_WC_STYLE",void 0,g.A.VERTEX),i.styleTranslucent&&(e.alphaOptions.pass=A.A.TRANSLUCENT)}const O=v.pointCloudShading;let R,M,L;O.attenuation&&o.addDefine("HAS_POINT_CLOUD_ATTENUATION",void 0,g.A.VERTEX),O.backFaceCulling&&o.addDefine("HAS_POINT_CLOUD_BACK_FACE_CULLING",void 0,g.A.VERTEX),u.A.is3DTiles(v.type)&&(M=!0,R=v.content,L=R.tile.refine===s.A.ADD),o.addUniform("vec4","model_pointCloudParameters",g.A.VERTEX),o.addVertexLines(p.A),e.uniformMap.model_pointCloudParameters=function(){const o=y;let s=1;M&&(s=L?5:R.tileset.memoryAdjustedScreenSpaceError),o.x=O.maximumAttenuation??s,o.x*=n.pixelRatio;const a=function(e,t,n,o){if((0,c.A)(o)){const e=o.tile.geometricError;if(e>0)return e}if((0,c.A)(n.baseResolution))return n.baseResolution;const s=d.A.getAttributeBySemantic(t,_.A.POSITION),a=s.count,u=e.runtimeNode.transform;let h=i.A.subtract(s.max,s.min,T);h=l.A.multiplyByPointAsVector(u,h,T);const A=h.x*h.y*h.z;return r.A.cbrt(A/a)}(e,t,O,R);o.y=a*O.geometricErrorScale;const u=n.context,A=n.camera.frustum;let p;return p=n.mode===m.A.SCENE2D||A instanceof h.A?Number.POSITIVE_INFINITY:u.drawingBufferHeight/n.camera.frustum.sseDenominator,o.z=p,M&&(o.w=R.tileset.timeSinceLoad),o}}},T=new i.A,b={colorStyleFunction:void 0,showStyleFunction:void 0,pointSizeStyleFunction:void 0,styleTranslucent:!1},w={POSITION:"attributes.positionMC",POSITION_ABSOLUTE:"v_positionWC",COLOR:"attributes.color_0",NORMAL:"attributes.normalMC"},x="ProcessedAttributes attributes, Metadata metadata, float tiles3d_tileset_time";function C(e,t){const n=/attributes\.(\w+)/g;let i=n.exec(e);for(;null!==i;){const o=i[1];-1===t.indexOf(o)&&t.push(o),i=n.exec(e)}}const E=v},623524:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var i=n(369031),o=n(491446),r=n(915325),s=n(276904),a=n(430332),c=n(654799),l=n(616e3),u=n(957233),d=n(78078),h=n(557448);function A(e){const t=(e=e??r.A.EMPTY_OBJECT).triangleIndices,n=e.outlineIndices,s=e.originalVertexCount;i.A.typeOf.object("options.triangleIndices",t),i.A.typeOf.object("options.outlineIndices",n),i.A.typeOf.number("options.originalVertexCount",s),this._triangleIndices=t,this._originalVertexCount=s,this._edges=new _(n,s),this._outlineCoordinatesTypedArray=void 0,this._extraVertices=[],function(e){let t=e._triangleIndices;const n=e._edges,i=[],r=e._extraVertices,s=e._originalVertexCount,a={};for(let e=0;e<t.length;e+=3){let c=t[e],l=t[e+1],u=t[e+2];const d=!1,h=d||n.hasEdge(c,l),A=d||n.hasEdge(l,u),f=d||n.hasEdge(u,c);let m=p(i,c,l,u,h,A,f);for(;(0,o.A)(m);){let n=a[m];if(!(0,o.A)(n)){n=s+r.length;let e=m;for(;e>=s;)e=r[e-s];r.push(e),a[m]=n}n>65534&&(t instanceof Uint16Array||t instanceof Uint8Array)?t=new Uint32Array(t):n>255&&t instanceof Uint8Array&&(t=new Uint16Array(t)),m===c?(c=n,t[e]=n):m===l?(l=n,t[e+1]=n):(u=n,t[e+2]=n),m=p(i,c,l,u,h,A,f)}}e._triangleIndices=t,e._outlineCoordinatesTypedArray=new Float32Array(i)}(this)}function p(e,t,n,i,o,r,s){const a=s?1:0,c=o?1:0,l=f(e,t,a,c,0);if(0===l)return t;const u=o?1:0,d=r?1:0,h=f(e,n,0,u,d);if(0===h)return n;const A=s?1:0,p=r?1:0,g=f(e,i,A,0,p);if(0===g)return i;const _=l&h&g;let y,v,T;if(1&_)y=0,v=1,T=2;else if(2&_)y=0,T=1,v=2;else if(4&_)v=0,y=1,T=2;else if(8&_)v=0,T=1,y=2;else if(16&_)T=0,y=1,v=2;else{if(!(32&_)){const e=m(l),o=m(h),r=m(g);return e<o&&e<r?t:o<r?n:i}T=0,v=1,y=2}const b=3*t;e[b+y]=a,e[b+v]=c,e[b+T]=0;const w=3*n;e[w+y]=0,e[w+v]=u,e[w+T]=d;const x=3*i;e[x+y]=A,e[x+v]=0,e[x+T]=p}function f(e,t,n,i,r){const s=3*t,a=e[s],c=e[s+1],l=e[s+2];return(0,o.A)(a)?(a===n&&c===i&&l===r)|(a===n&&c===r&&l===i)<<1|(a===i&&c===n&&l===r)<<2|(a===i&&c===r&&l===n)<<3|(a===r&&c===n&&l===i)<<4|(a===r&&c===i&&l===n)<<5:63}function m(e){return(1&e)+(e>>1&1)+(e>>2&1)+(e>>3&1)+(e>>4&1)+(e>>5&1)}function g(e){const t=new Uint8Array(e);return t[e-1]=192,8===e?t[e-1]=96:4===e?t[e-1]=48:2===e?t[e-1]=24:1===e&&(t[e-1]=12),t}function _(e,t){this._originalVertexCount=t,this._edges=new Set;for(let t=0;t<e.length;t+=2){const n=e[t],i=e[t+1],o=Math.min(n,i),r=Math.max(n,i),s=o*this._originalVertexCount+r;this._edges.add(s)}}Object.defineProperties(A.prototype,{updatedTriangleIndices:{get:function(){return this._triangleIndices}},outlineCoordinates:{get:function(){return this._outlineCoordinatesTypedArray}}}),A.prototype.updateAttribute=function(e){const t=this._extraVertices,n=e.length,i=n/this._originalVertexCount,o=t.length,r=new(0,e.constructor)(e.length+o*i);r.set(e);for(let e=0;e<o;e++){const o=t[e]*i,s=n+e*i;for(let e=0;e<i;e++)r[s+e]=r[o+e]}return r},A.createTexture=function(e){let t=e.cache.modelOutliningCache;if((0,o.A)(t)||(t=e.cache.modelOutliningCache={}),(0,o.A)(t.outlineTexture))return t.outlineTexture;const n=Math.min(4096,a.A.maximumTextureSize);let i=n;const r=g(i),A=[];for(;i>1;)i>>=1,A.push(g(i));const p=new l.A({context:e,source:{arrayBufferView:r,mipLevels:A},width:n,height:1,pixelFormat:s.A.LUMINANCE,sampler:new c.A({wrapS:h.A.CLAMP_TO_EDGE,wrapT:h.A.CLAMP_TO_EDGE,minificationFilter:d.A.LINEAR_MIPMAP_LINEAR,magnificationFilter:u.A.LINEAR})});return t.outlineTexture=p,p},_.prototype.hasEdge=function(e,t){const n=Math.min(e,t),i=Math.max(e,t),o=n*this._originalVertexCount+i;return this._edges.has(o)};const y=A},366413:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(730839),o=n(624512),r=n(623524),s=n(494098),a=n(34274);const c={name:"PrimitiveOutlinePipelineStage",process:function(e,t,n){const c=e.shaderBuilder,l=e.uniformMap;c.addDefine("HAS_PRIMITIVE_OUTLINE",void 0,o.A.BOTH),c.addAttribute("vec3","a_outlineCoordinates"),c.addVarying("vec3","v_outlineCoordinates");const u=t.outlineCoordinates,d={index:e.attributeIndex++,vertexBuffer:u.buffer,componentsPerAttribute:i.A.getNumberOfComponents(u.type),componentDatatype:u.componentDatatype,offsetInBytes:u.byteOffset,strideInBytes:u.byteStride,normalize:u.normalized};e.attributes.push(d),c.addUniform("sampler2D","model_outlineTexture",o.A.FRAGMENT);const h=r.A.createTexture(n.context);l.model_outlineTexture=function(){return h};const A=e.model;c.addUniform("vec4","model_outlineColor",o.A.FRAGMENT),l.model_outlineColor=function(){return A.outlineColor},c.addUniform("bool","model_showOutline",o.A.FRAGMENT),l.model_showOutline=function(){return A.showOutline},c.addVertexLines(s.A),c.addFragmentLines(a.A)}}},214666:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(660662),o=n(267980),r=n(369031),s=n(376758),a=n(491446),c=n(471147),l=n(127329);const u=function(e,t){r.A.typeOf.object("nodeRenderResources",e),r.A.typeOf.object("runtimePrimitive",t),this.model=e.model,this.runtimeNode=e.runtimeNode,this.attributes=e.attributes.slice(),this.attributeIndex=e.attributeIndex,this.featureIdVertexAttributeSetIndex=e.featureIdVertexAttributeSetIndex,this.uniformMap=(0,s.A)(e.uniformMap),this.alphaOptions=(0,s.A)(e.alphaOptions),this.renderStateOptions=(0,s.A)(e.renderStateOptions,!0),this.hasSilhouette=e.hasSilhouette,this.hasSkipLevelOfDetail=e.hasSkipLevelOfDetail,this.shaderBuilder=e.shaderBuilder.clone(),this.instanceCount=e.instanceCount,this.runtimePrimitive=t;const n=t.primitive;this.count=(0,a.A)(n.indices)?n.indices.count:c.A.getAttributeBySemantic(n,"POSITION").count,this.hasPropertyTable=!1,this.indices=n.indices,this.wireframeIndexBuffer=void 0,this.primitiveType=n.primitiveType;const u=c.A.getPositionMinMax(n,this.runtimeNode.instancingTranslationMin,this.runtimeNode.instancingTranslationMax);this.positionMin=o.A.clone(u.min,new o.A),this.positionMax=o.A.clone(u.max,new o.A),this.boundingSphere=i.A.fromCornerPoints(this.positionMin,this.positionMax,new i.A),this.lightingOptions=new l.A,this.pickId=void 0}},531218:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(491446),o=n(402330),r=n(995537),s=n(471147);const a={name:"PrimitiveStatisticsPipelineStage",_countGeometry:c,_count2DPositions:l,_countMorphTargetAttributes:u,_countMaterialTextures:d,_countFeatureIdTextures:h,_countBinaryMetadata:A};function c(e,t){const n=(0,i.A)(t.indices)?t.indices.count:s.A.getAttributeBySemantic(t,"POSITION").count,r=t.primitiveType;r===o.A.POINTS?e.pointsLength+=n:o.A.isTriangles(r)&&(e.trianglesLength+=function(e,t){switch(e){case o.A.TRIANGLES:return t/3;case o.A.TRIANGLE_STRIP:case o.A.TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}(r,n));const a=t.attributes,c=a.length;for(let t=0;t<c;t++){const n=a[t];if((0,i.A)(n.buffer)){const t=(0,i.A)(n.typedArray);e.addBuffer(n.buffer,t)}}const l=t.outlineCoordinates;if((0,i.A)(l)&&(0,i.A)(l.buffer)){const t=!1;e.addBuffer(l.buffer,t)}const u=t.indices;if((0,i.A)(u)&&(0,i.A)(u.buffer)){const t=(0,i.A)(u.typedArray);e.addBuffer(u.buffer,t)}}function l(e,t){const n=t.positionBuffer2D;if((0,i.A)(n)){const t=!0;e.addBuffer(n,t)}}function u(e,t){const n=t.morphTargets;if(!(0,i.A)(n))return;const o=n.length;for(let t=0;t<o;t++){const o=n[t].attributes,r=o.length;for(let t=0;t<r;t++){const n=o[t];(0,i.A)(n.buffer)&&e.addBuffer(n.buffer,!1)}}}function d(e,t){const n=function(e){const t=e.metallicRoughness,n=[e.emissiveTexture,e.normalTexture,e.occlusionTexture,t.baseColorTexture,t.metallicRoughnessTexture],o=e.specularGlossiness;return(0,i.A)(o)&&(n.push(o.diffuseTexture),n.push(o.specularGlossinessTexture)),n}(t),o=n.length;for(let t=0;t<o;t++){const o=n[t];(0,i.A)(o)&&(0,i.A)(o.texture)&&e.addTexture(o.texture)}}function h(e,t){const n=t.length;for(let o=0;o<n;o++){const n=t[o];if(n instanceof r.A.FeatureIdTexture){const t=n.textureReader;(0,i.A)(t.texture)&&e.addTexture(t.texture)}}}function A(e,t){const n=t.structuralMetadata;(0,i.A)(n)&&(function(e,t){const n=t.propertyTextures;if(!(0,i.A)(n))return;const o=n.length;for(let t=0;t<o;t++){const o=n[t].properties;for(const t in o)if(o.hasOwnProperty(t)){const n=o[t].textureReader;(0,i.A)(n.texture)&&e.addTexture(n.texture)}}}(e,n),e.propertyTablesByteLength+=n.propertyTablesByteLength);const o=t.featureTables;if(!(0,i.A)(o))return;const r=o.length;for(let t=0;t<r;t++){const n=o[t];e.addBatchTexture(n.batchTexture)}}a.process=function(e,t,n){const i=e.model,o=i.statistics;c(o,t),l(o,e.runtimePrimitive),u(o,t),d(o,t.material),h(o,t.featureIds),A(o,i)};const p=a},252843:(e,t,n)=>{"use strict";n.d(t,{A:()=>b});var i=n(660662),o=n(641613),r=n(442790),s=n(267980),a=n(376758),c=n(430346),l=n(491446),u=n(584164),d=n(471147),h=n(62467),A=n(624512),p=n(595826),f=n(78173);const m=new u.A,g=new u.A,_={name:"SceneMode2DPipelineStage",process:function(e,t,n){const _=d.A.getAttributeBySemantic(t,p.A.POSITION),b=e.shaderBuilder,w=e.model,x=w.sceneGraph.computedModelMatrix,C=e.runtimeNode.computedTransform,E=u.A.multiplyTransformation(x,C,m),S=function(e,t,n){const o=u.A.multiplyByPoint(t,e.positionMin,y),r=f.A.computeActualEllipsoidPosition(n,o,o),s=u.A.multiplyByPoint(t,e.positionMax,v),a=f.A.computeActualEllipsoidPosition(n,s,s);return i.A.fromCornerPoints(r,a,new i.A)}(e,E,n),I=e.runtimePrimitive;I.boundingSphere2D=S;const P=e.runtimeNode.node.instances;if((0,l.A)(P))return;if((0,l.A)(_.typedArray)){const e=function(e,t,n,i){const c=(0,a.A)(i);c.mode=h.A.COLUMBUS_VIEW;const d=function(e,t,n,i){let o;o=(0,l.A)(e.quantization)?function(e,t){const n=e.length,i=new Float32Array(n),o=t.quantizedVolumeOffset,r=t.quantizedVolumeStepSize;for(let t=0;t<n;t+=3){const n=s.A.fromArray(e,t,T),a=s.A.multiplyComponents(n,r,n),c=s.A.add(a,o,a);i[t]=c.x,i[t+1]=c.y,i[t+2]=c.z}return i}(e.typedArray,e.quantization):e.typedArray.slice();const r=e.byteOffset/Float32Array.BYTES_PER_ELEMENT,a=o.length,c=(0,l.A)(e.byteStride)?e.byteStride/Float32Array.BYTES_PER_ELEMENT:3;for(let e=r;e<a;e+=c){const r=s.A.fromArray(o,e,T);if(isNaN(r.x)||isNaN(r.y)||isNaN(r.z))continue;const a=u.A.multiplyByPoint(t,r,r),c=f.A.computeActualEllipsoidPosition(i,a,a),l=s.A.subtract(c,n,c);o[e]=l.x,o[e+1]=l.y,o[e+2]=l.z}return o}(e,t,n.center,c),A=o.A.createVertexBuffer({context:i.context,typedArray:d,usage:r.A.STATIC_DRAW});return A.vertexArrayDestroyable=!1,A}(_,E,S,n);I.positionBuffer2D=e,w._modelResources.push(e),_.typedArray=void 0}b.addDefine("USE_2D_POSITIONS",void 0,A.A.VERTEX),b.addUniform("mat4","u_modelView2D",A.A.VERTEX);const D=u.A.fromTranslation(S.center,new u.A),O=n.context,R={u_modelView2D:function(){return u.A.multiplyTransformation(O.uniformState.view,D,g)}};e.uniformMap=(0,c.A)(R,e.uniformMap)}},y=new s.A,v=new s.A,T=new s.A,b=_},391852:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(491446),o=n(624512),r=n(443045),s=n(995537),a=n(471147);const c={name:"SelectedFeatureIdPipelineStage",STRUCT_ID_SELECTED_FEATURE:"SelectedFeature",STRUCT_NAME_SELECTED_FEATURE:"SelectedFeature"};function l(e){return e instanceof s.A.FeatureIdTexture?"HAS_SELECTED_FEATURE_ID_TEXTURE":"HAS_SELECTED_FEATURE_ID_ATTRIBUTE"}function u(e){return e instanceof s.A.FeatureIdTexture?o.A.FRAGMENT:o.A.BOTH}c.process=function(e,t,n){const s=e.shaderBuilder;e.hasPropertyTable=!0;const d=function(e,t,n){let o,r;return(0,i.A)(t.instances)&&(r=a.A.getFeatureIdsByLabel(t.instances.featureIds,e.instanceFeatureIdLabel),(0,i.A)(r))?(o=r.label??r.positionalLabel,{featureIds:r,variableName:o,shaderDestination:u(r),featureIdDefine:l(r)}):(r=a.A.getFeatureIdsByLabel(n.featureIds,e.featureIdLabel),o=r.label??r.positionalLabel,{featureIds:r,variableName:o,shaderDestination:u(r),featureIdDefine:l(r)})}(e.model,e.runtimeNode.node,t),h=d.shaderDestination;s.addDefine("HAS_SELECTED_FEATURE_ID",void 0,h),s.addDefine("SELECTED_FEATURE_ID",d.variableName,h),s.addDefine(d.featureIdDefine,void 0,h),function(e){e.addStructField(c.STRUCT_ID_SELECTED_FEATURE,"int","id"),e.addStructField(c.STRUCT_ID_SELECTED_FEATURE,"vec2","st"),e.addStructField(c.STRUCT_ID_SELECTED_FEATURE,"vec4","color")}(s);const A=d.featureIds.nullFeatureId,p=e.uniformMap;(0,i.A)(A)&&(s.addDefine("HAS_NULL_FEATURE_ID",void 0,h),s.addUniform("int","model_nullFeatureId",h),p.model_nullFeatureId=function(){return A}),d.shaderDestination===o.A.BOTH&&s.addVertexLines(r.A),s.addFragmentLines(r.A)};const d=c},456727:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(430346),o=n(624512),r=n(40640),s=n(595826);const a={name:"SkinningPipelineStage",FUNCTION_ID_GET_SKINNING_MATRIX:"getSkinningMatrix",FUNCTION_SIGNATURE_GET_SKINNING_MATRIX:"mat4 getSkinningMatrix()",process:function(e,t){const n=e.shaderBuilder;n.addDefine("HAS_SKINNING",void 0,o.A.VERTEX),function(e,t){e.addFunction(a.FUNCTION_ID_GET_SKINNING_MATRIX,a.FUNCTION_SIGNATURE_GET_SKINNING_MATRIX,o.A.VERTEX);let n,i;e.addFunctionLines(a.FUNCTION_ID_GET_SKINNING_MATRIX,["mat4 skinnedMatrix = mat4(0);"]);const r=["x","y","z","w"],c=function(e){let t=-1;const n=e.attributes,i=n.length;for(let e=0;e<i;e++){const i=n[e];(i.semantic===s.A.JOINTS||i.semantic===s.A.WEIGHTS)&&(t=Math.max(t,i.setIndex))}return t}(t);for(n=0;n<=c;n++)for(i=0;i<=3;i++){const t=r[i],o=`skinnedMatrix += a_weights_${n}.${t} * u_jointMatrices[int(a_joints_${n}.${t})];`;e.addFunctionLines(a.FUNCTION_ID_GET_SKINNING_MATRIX,[o])}e.addFunctionLines(a.FUNCTION_ID_GET_SKINNING_MATRIX,["return skinnedMatrix;"])}(n,t);const c=e.runtimeNode,l=c.computedJointMatrices;n.addUniform("mat4",`u_jointMatrices[${l.length}]`,o.A.VERTEX),n.addVertexLines(r.A);const u={u_jointMatrices:function(){return c.computedJointMatrices}};e.uniformMap=(0,i.A)(u,e.uniformMap)}},c=a},942836:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});const i={ALL_OPAQUE:0,ALL_TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2,getStyleCommandsNeeded:function(e,t){return 0===t?i.ALL_OPAQUE:t===e?i.ALL_TRANSLUCENT:i.OPAQUE_AND_TRANSLUCENT}},o=Object.freeze(i)},807048:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(430346),o=n(624512),r=n(434067),s=n(938987);const a={name:"TilesetPipelineStage",process:function(e,t,n){if(t.hasSkipLevelOfDetail(n)){e.shaderBuilder.addDefine("POLYGON_OFFSET",void 0,o.A.FRAGMENT);const t={u_polygonOffset:function(){return r.A.ZERO}};e.uniformMap=(0,i.A)(t,e.uniformMap),e.hasSkipLevelOfDetail=!0}const a=e.renderStateOptions;a.stencilTest=s.A.setCesium3DTileBit(),a.stencilMask=s.A.CESIUM_3D_TILE_MASK}}},641882:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(434067),o=n(624512),r=n(323745);const s={name:"VerticalExaggerationPipelineStage"},a=new i.A;s.process=function(e,t,n){const{shaderBuilder:s,uniformMap:c}=e;s.addVertexLines(r.A),s.addDefine("HAS_VERTICAL_EXAGGERATION",void 0,o.A.VERTEX),s.addUniform("vec2","u_verticalExaggerationAndRelativeHeight",o.A.VERTEX),c.u_verticalExaggerationAndRelativeHeight=function(){return i.A.fromElements(n.verticalExaggeration,n.verticalExaggerationRelativeHeight,a)}};const c=s},6214:(e,t,n)=>{"use strict";n.d(t,{A:()=>A});var i=n(641613),o=n(442790),r=n(491446),s=n(874915),a=n(471147),c=n(402330),l=n(624512),u=n(595826),d=n(635692);const h={name:"WireframePipelineStage",process:function(e,t,n){e.shaderBuilder.addDefine("HAS_WIREFRAME",void 0,l.A.FRAGMENT);const h=e.model,A=function(e,t,n){const c=a.A.getAttributeBySemantic(e,u.A.POSITION).count,l=n.context.webgl2;let h;if((0,r.A)(t)){const e=t.buffer,n=t.count;(0,r.A)(e)&&l?(h=e.sizeInBytes===n?new Uint8Array(n):s.A.createTypedArray(c,n),e.getBufferData(h)):h=t.typedArray}const A=e.primitiveType,p=d.A.createWireframeIndices(A,c,h),f=s.A.fromSizeInBytes(p.BYTES_PER_ELEMENT);return i.A.createIndexBuffer({context:n.context,typedArray:p,usage:o.A.STATIC_DRAW,indexDatatype:f})}(t,e.indices,n);h._pipelineResources.push(A),e.wireframeIndexBuffer=A,h.statistics.addBuffer(A,!1);const p=e.primitiveType,f=e.count;e.primitiveType=c.A.LINES,e.count=d.A.getWireframeIndicesCount(p,f)}},A=h},965020:(e,t,n)=>{"use strict";n.d(t,{A:()=>P});var i=n(961645),o=n(660662),r=n(267980),s=n(336946),a=n(369031),c=n(571804),l=n(491446),u=n(610750),d=n(874915),h=n(150429),A=n(766067),p=n(584164),f=n(543622),m=n(717339),g=n(730839),_=n(62467),y=n(595826),v=n(471147);const T=new r.A,b=new r.A,w=new r.A,x=new p.A,C=new p.A,E=new p.A,S=new s.A,I=new o.A;function P(e,t,n,s,m,P,O){if(a.A.typeOf.object("model",e),a.A.typeOf.object("ray",t),a.A.typeOf.object("frameState",n),!e._ready||n.mode===_.A.MORPHING)return;let R=Number.MAX_VALUE;const M=e.sceneGraph,L=M._runtimeNodes;for(let r=0;r<L.length;r++){const a=L[r],A=a.node;let S=p.A.clone(a.computedTransform,x),O=p.A.clone(M.computedModelMatrix,C);const N=A.instances;(0,l.A)(N)&&N.transformInWorldSpace&&(O=p.A.multiplyTransformation(e.modelMatrix,M.components.transform,O),S=p.A.multiplyTransformation(M.axisCorrectionMatrix,a.computedTransform,S));let B=p.A.multiplyTransformation(O,S,E);n.mode!==_.A.SCENE3D&&(B=f.A.basisTo2D(n.mapProjection,B,B));const F=[];if((0,l.A)(N)){const e=N.attributes[0].count,t=N.attributes[0].componentDatatype,i=12;let o=a.transformsTypedArray;if(!(0,l.A)(o)){const r=a.instancingTransformsBuffer;(0,l.A)(r)&&n.context.webgl2&&(o=c.A.createTypedArray(t,e*i),r.getBufferData(o))}if((0,l.A)(o))for(let t=0;t<e;t++){const e=t*i,n=new p.A(o[e],o[e+1],o[e+2],o[e+3],o[e+4],o[e+5],o[e+6],o[e+7],o[e+8],o[e+9],o[e+10],o[e+11],0,0,0,1);N.transformInWorldSpace?(p.A.multiplyTransformation(n,S,n),p.A.multiplyTransformation(O,n,n)):p.A.multiplyTransformation(n,B,n),F.push(n)}}0===F.length&&F.push(B);const U=a.runtimePrimitives.length;for(let r=0;r<U;r++){const A=a.runtimePrimitives[r],p=A.primitive;if((0,l.A)(A.boundingSphere)&&!(0,l.A)(N)){const e=o.A.transform(A.boundingSphere,B,I),n=h.A.raySphere(t,e);if(!(0,l.A)(n))continue}const f=v.A.getAttributeBySemantic(p,y.A.POSITION),_=f.byteOffset,x=f.byteStride,C=f.count;if(!(0,l.A)(p.indices))continue;let E=p.indices.typedArray;if(!(0,l.A)(E)){const e=p.indices.buffer,t=p.indices.count,i=p.indices.indexDatatype;(0,l.A)(e)&&n.context.webgl2&&(i===d.A.UNSIGNED_BYTE?E=new Uint8Array(t):i===d.A.UNSIGNED_SHORT?E=new Uint16Array(t):i===d.A.UNSIGNED_INT&&(E=new Uint32Array(t)),e.getBufferData(E))}let S=f.typedArray,O=f.componentDatatype,M=f.type;const L=f.quantization;(0,l.A)(L)&&(O=f.quantization.componentDatatype,M=f.quantization.type);const U=g.A.getNumberOfComponents(M),k=c.A.getSizeInBytes(O),V=!(0,l.A)(S)&&(0,l.A)(x)&&x!==U*k;let z=U,H=0;V&&(z=x/k,H=_/k);const G=C*z;if(!(0,l.A)(S)){const e=f.buffer;(0,l.A)(e)&&n.context.webgl2&&(S=c.A.createTypedArray(O,G),e.getBufferData(S,V?0:_,0,G)),L&&f.normalized&&(S=i.A.dequantize(S,O,M,C))}if(!(0,l.A)(E)||!(0,l.A)(S))return;P=P??u.A.default,s=s??1,m=m??0;const W=E.length;for(let n=0;n<W;n+=3){const i=E[n],o=E[n+1],r=E[n+2];for(const n of F){const a=D(S,i,H,z,L,n,s,m,P,T),c=D(S,o,H,z,L,n,s,m,P,b),u=D(S,r,H,z,L,n,s,m,P,w),d=h.A.rayTriangleParametric(t,a,c,u,e.backFaceCulling??!0);(0,l.A)(d)&&d<R&&d>=0&&(R=d)}}}}if(R!==Number.MAX_VALUE){if(O=A.A.getPoint(t,R,O),n.mode!==_.A.SCENE3D){r.A.fromElements(O.y,O.z,O.x,O);const e=n.mapProjection,t=e.ellipsoid,i=e.unproject(O,S);t.cartographicToCartesian(i,O)}return O}}function D(e,t,n,o,s,a,c,u,d,h){const A=n+t*o;if(h.x=e[A],h.y=e[A+1],h.z=e[A+2],(0,l.A)(s))if(s.octEncoded){if(h=i.A.octDecodeInRange(h,s.normalizationRange,h),s.octEncodedZXY){const e=h.x;h.x=h.z,h.z=h.y,h.y=e}}else h=r.A.multiplyComponents(h,s.quantizedVolumeStepSize,h),h=r.A.add(h,s.quantizedVolumeOffset,h);return h=p.A.multiplyByPoint(a,h,h),1!==c&&m.A.getPosition(h,d,c,u,h),h}},598361:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({NONE:0,REPEAT:1,MIRRORED_REPEAT:2})},304686:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({STOPPED:0,ANIMATING:1})},995537:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var i=n(953019),o=n(267980),r=n(626809),s=n(331185),a=n(584164);const c={};function l(){this.credits=[]}function u(){this.baseColorTexture=void 0,this.metallicRoughnessTexture=void 0,this.baseColorFactor=r.A.clone(u.DEFAULT_BASE_COLOR_FACTOR),this.metallicFactor=u.DEFAULT_METALLIC_FACTOR,this.roughnessFactor=u.DEFAULT_ROUGHNESS_FACTOR}function d(){this.diffuseTexture=void 0,this.specularGlossinessTexture=void 0,this.diffuseFactor=r.A.clone(d.DEFAULT_DIFFUSE_FACTOR),this.specularFactor=o.A.clone(d.DEFAULT_SPECULAR_FACTOR),this.glossinessFactor=d.DEFAULT_GLOSSINESS_FACTOR}function h(){this.specularFactor=h.DEFAULT_SPECULAR_FACTOR,this.specularTexture=void 0,this.specularColorFactor=o.A.clone(h.DEFAULT_SPECULAR_COLOR_FACTOR),this.specularColorTexture=void 0}function A(){this.anisotropyStrength=A.DEFAULT_ANISOTROPY_STRENGTH,this.anisotropyRotation=A.DEFAULT_ANISOTROPY_ROTATION,this.anisotropyTexture=void 0}function p(){this.clearcoatFactor=p.DEFAULT_CLEARCOAT_FACTOR,this.clearcoatTexture=void 0,this.clearcoatRoughnessFactor=p.DEFAULT_CLEARCOAT_ROUGHNESS_FACTOR,this.clearcoatRoughnessTexture=void 0,this.clearcoatNormalTexture=void 0}function f(){this.metallicRoughness=new u,this.specularGlossiness=void 0,this.specular=void 0,this.anisotropy=void 0,this.clearcoat=void 0,this.emissiveTexture=void 0,this.normalTexture=void 0,this.occlusionTexture=void 0,this.emissiveFactor=o.A.clone(f.DEFAULT_EMISSIVE_FACTOR),this.alphaMode=i.A.OPAQUE,this.alphaCutoff=.5,this.doubleSided=!1,this.unlit=!1}u.DEFAULT_BASE_COLOR_FACTOR=r.A.ONE,u.DEFAULT_METALLIC_FACTOR=1,u.DEFAULT_ROUGHNESS_FACTOR=1,d.DEFAULT_DIFFUSE_FACTOR=r.A.ONE,d.DEFAULT_SPECULAR_FACTOR=o.A.ONE,d.DEFAULT_GLOSSINESS_FACTOR=1,h.DEFAULT_SPECULAR_FACTOR=1,h.DEFAULT_SPECULAR_COLOR_FACTOR=o.A.ONE,A.DEFAULT_ANISOTROPY_STRENGTH=0,A.DEFAULT_ANISOTROPY_ROTATION=0,p.DEFAULT_CLEARCOAT_FACTOR=0,p.DEFAULT_CLEARCOAT_ROUGHNESS_FACTOR=0,f.DEFAULT_EMISSIVE_FACTOR=o.A.ZERO,c.Quantization=function(){this.octEncoded=!1,this.octEncodedZXY=!1,this.normalizationRange=void 0,this.quantizedVolumeOffset=void 0,this.quantizedVolumeDimensions=void 0,this.quantizedVolumeStepSize=void 0,this.componentDatatype=void 0,this.type=void 0},c.Attribute=function(){this.name=void 0,this.semantic=void 0,this.setIndex=void 0,this.componentDatatype=void 0,this.type=void 0,this.normalized=!1,this.count=void 0,this.min=void 0,this.max=void 0,this.constant=void 0,this.quantization=void 0,this.typedArray=void 0,this.buffer=void 0,this.byteOffset=0,this.byteStride=void 0},c.Indices=function(){this.indexDatatype=void 0,this.count=void 0,this.buffer=void 0,this.typedArray=void 0},c.FeatureIdAttribute=function(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.setIndex=void 0,this.label=void 0,this.positionalLabel=void 0},c.FeatureIdTexture=function(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.textureReader=void 0,this.label=void 0,this.positionalLabel=void 0},c.FeatureIdImplicitRange=function(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.offset=0,this.repeat=void 0,this.label=void 0,this.positionalLabel=void 0},c.MorphTarget=function(){this.attributes=[]},c.Primitive=function(){this.attributes=[],this.morphTargets=[],this.indices=void 0,this.material=void 0,this.primitiveType=void 0,this.featureIds=[],this.propertyTextureIds=[],this.propertyAttributeIds=[],this.outlineCoordinates=void 0,this.modelPrimitiveImagery=void 0},c.Instances=function(){this.attributes=[],this.featureIds=[],this.transformInWorldSpace=!1},c.Skin=function(){this.index=void 0,this.joints=[],this.inverseBindMatrices=[]},c.Node=function(){this.name=void 0,this.index=void 0,this.children=[],this.primitives=[],this.instances=void 0,this.skin=void 0,this.matrix=void 0,this.translation=void 0,this.rotation=void 0,this.scale=void 0,this.morphWeights=[],this.articulationName=void 0},c.Scene=function(){this.nodes=[]},c.AnimatedPropertyType=Object.freeze({TRANSLATION:"translation",ROTATION:"rotation",SCALE:"scale",WEIGHTS:"weights"}),c.AnimationSampler=function(){this.input=[],this.interpolation=void 0,this.output=[]},c.AnimationTarget=function(){this.node=void 0,this.path=void 0},c.AnimationChannel=function(){this.sampler=void 0,this.target=void 0},c.Animation=function(){this.name=void 0,this.samplers=[],this.channels=[]},c.ArticulationStage=function(){this.name=void 0,this.type=void 0,this.minimumValue=void 0,this.maximumValue=void 0,this.initialValue=void 0},c.Articulation=function(){this.name=void 0,this.stages=[]},c.Asset=l,c.Components=function(){this.asset=new l,this.scene=void 0,this.nodes=[],this.skins=[],this.animations=[],this.articulations=[],this.structuralMetadata=void 0,this.upAxis=void 0,this.forwardAxis=void 0,this.transform=a.A.clone(a.A.IDENTITY),this.extensions={}},c.TextureReader=function(){this.texture=void 0,this.index=void 0,this.texCoord=0,this.transform=s.A.clone(s.A.IDENTITY),this.scale=1,this.channels=void 0},c.MetallicRoughness=u,c.SpecularGlossiness=d,c.Specular=h,c.Anisotropy=A,c.Clearcoat=p,c.Material=f;const m=c},409816:(e,t,n)=>{"use strict";n.d(t,{A:()=>b});var i=n(267980),o=n(491446),r=n(677354),s=n(605971),a=n(209202),c=n(866569),l=n(83181),u=n(307898),d=n(308695),h=n(223702),A=n(891846),p=n(635649),f=n(217543),m=n(192518);function g(e,t,n,i){this._tileset=e,this._tile=t,this._tilesetResource=n,this._contents=[],this._contentsCreated=!1;const r=(0,o.A)(i.contents)?i.contents:i.content;this._innerContentHeaders=r,this._requestsInFlight=0,this._cancelCount=0,this._externalTilesetCount=0;const s=this._innerContentHeaders.length;this._arrayFetchPromises=new Array(s),this._requests=new Array(s),this._ready=!1,this._innerContentResources=new Array(s),this._serverKeys=new Array(s);for(let e=0;e<s;e++){const t=n.getDerivedResource({url:r[e].uri}),i=c.A.getServerKey(t.getUrlComponent());this._innerContentResources[e]=t,this._serverKeys[e]=i}}function _(e,t){e._requestsInFlight+=t,e.tileset.statistics.numberOfPendingRequests+=t}function y(e,t){e._cancelCount++,e._tile._contentState=t;const n=e.tileset.statistics;n.numberOfPendingRequests-=e._requestsInFlight,n.numberOfAttemptedRequests+=e._requestsInFlight,e._requestsInFlight=0;const i=e._innerContentHeaders.length;e._arrayFetchPromises=new Array(i)}function v(e,t,n,i){const r=e._innerContentResources[t].clone(),s=e.tile,c=e._serverKeys[t],d=new a.A({throttle:!0,throttleByServer:!0,type:u.A.TILES3D,priorityFunction:function(){return s._priority},serverKey:c});r.request=d,e._requests[t]=d;const h=r.fetchArrayBuffer();if((0,o.A)(h))return h.then(function(t){if(!(n<e._cancelCount)){if(!r.request.cancelled&&r.request.state!==l.A.CANCELLED)return _(e,-1),t;y(e,i)}}).catch(function(o){n<e._cancelCount||(r.request.cancelled||r.request.state===l.A.CANCELLED?y(e,i):(_(e,-1),T(e,t,o)))})}function T(e,t,n){const i=e._tileset,r=e._innerContentResources[t].url,s=(0,o.A)(n.message)?n.message:n.toString();i.tileFailed.numberOfListeners>0?i.tileFailed.raiseEvent({url:r,message:s}):(console.log(`A content failed to load: ${r}`),console.log(`Error: ${s}`))}Object.defineProperties(g.prototype,{featurePropertiesDirty:{get:function(){const e=this._contents,t=e.length;for(let n=0;n<t;++n)if(e[n].featurePropertiesDirty)return!0;return!1},set:function(e){const t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].featurePropertiesDirty=e}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},ready:{get:function(){return!!this._contentsCreated&&this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){}},metadata:{get:function(){},set:function(){throw new s.A("Multiple3DTileContent cannot have metadata")}},batchTable:{get:function(){}},group:{get:function(){},set:function(){throw new s.A("Multiple3DTileContent cannot have group metadata")}},innerContentUrls:{get:function(){return this._innerContentHeaders.map(function(e){return e.uri})}}}),g.prototype.requestInnerContents=function(){if(!function(e){const t={};for(let n=0;n<e.length;n++){const i=e[n];(0,o.A)(t[i])?t[i]++:t[i]=1}for(const e in t)if(t.hasOwnProperty(e)&&!c.A.serverHasOpenSlots(e,t[e]))return!1;return c.A.heapHasOpenSlots(e.length)}(this._serverKeys))return void(this.tileset.statistics.numberOfAttemptedRequests+=this._serverKeys.length);const e=this._innerContentHeaders;_(this,e.length);const t=this._cancelCount;for(let n=0;n<e.length;n++)this._arrayFetchPromises[n]=v(this,n,t,this._tile._contentState);return async function(e){const t=e._cancelCount,n=await Promise.all(e._arrayFetchPromises);if(t<e._cancelCount)return;const i=n.map((t,n)=>async function(e,t,n){if((0,o.A)(t))try{const i=(0,m.A)(t),r=e._tileset,s=e._innerContentResources[n],a=e._tile;let c;i.contentType===h.A.EXTERNAL_TILESET&&(e._externalTilesetCount++,a.hasTilesetContent=!0),e._disableSkipLevelOfDetail=e._disableSkipLevelOfDetail||i.contentType===h.A.GEOMETRY||i.contentType===h.A.VECTOR;const l=A.A[i.contentType];c=(0,o.A)(i.binaryPayload)?await Promise.resolve(l(r,a,s,i.binaryPayload.buffer,0)):await Promise.resolve(l(r,a,s,i.jsonPayload));const u=e._innerContentHeaders[n];if(a.hasImplicitContentMetadata){const e=a.implicitSubtree,t=a.implicitCoordinates;c.metadata=e.getContentMetadataView(t,n)}else a.hasImplicitContent||(c.metadata=(0,p.A)(r,u));const g=(0,f.A)(r,u);return(0,o.A)(g)&&(c.group=new d.A({metadata:g})),c}catch(t){T(e,n,t)}}(e,t,n)),r=await Promise.all(i);return e._contentsCreated=!0,e._contents=r.filter(o.A),e._externalTilesetCount===e._contents.length&&(e._tile.hasRenderableContent=!1),r}(this)},g.prototype.cancelRequests=function(){for(let e=0;e<this._requests.length;e++){const t=this._requests[e];(0,o.A)(t)&&t.cancel()}},g.prototype.hasProperty=function(e,t){return!1},g.prototype.getFeature=function(e){},g.prototype.applyDebugSettings=function(e,t){const n=this._contents,i=n.length;for(let o=0;o<i;++o)n[o].applyDebugSettings(e,t)},g.prototype.applyStyle=function(e){const t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].applyStyle(e)},g.prototype.update=function(e,t){const n=this._contents,i=n.length;let o=!0;for(let r=0;r<i;++r)n[r].update(e,t),o=o&&n[r].ready;!this._ready&&o&&(this._ready=!0)},g.prototype.pick=function(e,t,n){if(!this._ready)return;let r,s=Number.POSITIVE_INFINITY;const a=this._contents,c=a.length;for(let l=0;l<c;++l){const c=a[l].pick(e,t,n);if(!(0,o.A)(c))continue;const u=i.A.distance(e.origin,c);u<s&&(r=c,s=u)}return(0,o.A)(r)?n:void 0},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){const e=this._contents,t=e.length;for(let n=0;n<t;++n)e[n].destroy();return(0,r.A)(this)};const b=g},952392:(e,t,n)=>{"use strict";function i(e){}n.d(t,{A:()=>o}),i.prototype.isReady=function(){return!0},i.prototype.shouldDiscardImage=function(e){return!1};const o=i},679854:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var i=n(267980),o=n(369031),r=n(41476),s=n(430346),a=n(571804),c=n(491446),l=n(604752),u=n(123245),d=n(730839),h=n(468741),A=n(595826);const p={},f=Uint32Array.BYTES_PER_ELEMENT;p.parse=function(e,t){t=t??0,o.A.defined("arrayBuffer",e);const n=new Uint8Array(e),p=new DataView(e);t+=f;const m=p.getUint32(t,!0);if(1!==m)throw new u.A(`Only Point Cloud tile version 1 is supported.  Version ${m} is not.`);t+=f,t+=f;const g=p.getUint32(t,!0);if(0===g)throw new u.A("Feature table must have a byte length greater than zero");t+=f;const _=p.getUint32(t,!0);t+=f;const y=p.getUint32(t,!0);t+=f;const v=p.getUint32(t,!0);t+=f;const T=(0,l.A)(n,t,g);t+=g;const b=new Uint8Array(e,t,_);let w,x;t+=_,y>0&&(w=(0,l.A)(n,t,y),0===Object.keys(w).length&&(w=void 0),t+=y,v>0&&(x=new Uint8Array(e,t,v),x=new Uint8Array(x),t+=v));const C=new h.A(T,b),E=C.getGlobalProperty("POINTS_LENGTH");if(C.featuresLength=E,!(0,c.A)(E))throw new u.A("Feature table global property: POINTS_LENGTH must be defined");let S=C.getGlobalProperty("RTC_CENTER",a.A.FLOAT,3);(0,c.A)(S)&&(S=i.A.unpack(S));const I=function(e,t){const n=e.json;let i,o,r;const a=(0,c.A)(n.extensions)?n.extensions["3DTILES_draco_point_compression"]:void 0,l=(0,c.A)(t)&&(0,c.A)(t.extensions)?t.extensions["3DTILES_draco_point_compression"]:void 0;let d,h,A,p,f,m;if((0,c.A)(l)&&(r=l.properties),(0,c.A)(a)){o=a.properties;const t=a.byteOffset,n=a.byteLength;if(!(0,c.A)(o)||!(0,c.A)(t)||!(0,c.A)(n))throw new u.A("Draco properties, byteOffset, and byteLength must be defined");i=e.buffer.slice(t,t+n),d=(0,c.A)(o.POSITION),h=(0,c.A)(o.RGB)||(0,c.A)(o.RGBA),A=(0,c.A)(o.NORMAL),p=(0,c.A)(o.BATCH_ID),f=(0,c.A)(o.RGBA)}return(0,c.A)(i)&&(m={buffer:i,featureTableProperties:o,batchTableProperties:r,properties:(0,s.A)(o,r),dequantizeInShader:!0}),{draco:m,hasPositions:d,hasColors:h,isTranslucent:f,hasNormals:A,hasBatchIds:p}}(C,w);if(I.rtcCenter=S,I.pointsLength=E,!I.hasPositions){const e=function(e){const t=e.json;let n;if((0,c.A)(t.POSITION))return n=e.getPropertyArray("POSITION",a.A.FLOAT,3),{name:A.A.POSITION,semantic:A.A.POSITION,typedArray:n,isQuantized:!1,componentDatatype:a.A.FLOAT,type:d.A.VEC3};if((0,c.A)(t.POSITION_QUANTIZED)){n=e.getPropertyArray("POSITION_QUANTIZED",a.A.UNSIGNED_SHORT,3);const t=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",a.A.FLOAT,3);if(!(0,c.A)(t))throw new u.A("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const o=65535,r=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",a.A.FLOAT,3);if(!(0,c.A)(r))throw new u.A("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");return{name:A.A.POSITION,semantic:A.A.POSITION,typedArray:n,isQuantized:!0,componentDatatype:a.A.FLOAT,type:d.A.VEC3,quantizedRange:o,quantizedVolumeOffset:i.A.unpack(r),quantizedVolumeScale:i.A.unpack(t),quantizedComponentDatatype:a.A.UNSIGNED_SHORT,quantizedType:d.A.VEC3}}}(C);I.positions=e,I.hasPositions=I.hasPositions||(0,c.A)(e)}if(!I.hasPositions)throw new u.A("Either POSITION or POSITION_QUANTIZED must be defined.");if(!I.hasNormals){const e=function(e){const t=e.json;let n;if((0,c.A)(t.NORMAL))return n=e.getPropertyArray("NORMAL",a.A.FLOAT,3),{name:A.A.NORMAL,semantic:A.A.NORMAL,typedArray:n,octEncoded:!1,octEncodedZXY:!1,componentDatatype:a.A.FLOAT,type:d.A.VEC3};if((0,c.A)(t.NORMAL_OCT16P)){n=e.getPropertyArray("NORMAL_OCT16P",a.A.UNSIGNED_BYTE,2);const t=8;return{name:A.A.NORMAL,semantic:A.A.NORMAL,typedArray:n,octEncoded:!0,octEncodedZXY:!1,quantizedRange:(1<<t)-1,quantizedType:d.A.VEC2,quantizedComponentDatatype:a.A.UNSIGNED_BYTE,componentDatatype:a.A.FLOAT,type:d.A.VEC3}}}(C);I.normals=e,I.hasNormals=I.hasNormals||(0,c.A)(e)}if(!I.hasColors){const e=function(e){const t=e.json;let n;if((0,c.A)(t.RGBA))return n=e.getPropertyArray("RGBA",a.A.UNSIGNED_BYTE,4),{name:A.A.COLOR,semantic:A.A.COLOR,setIndex:0,typedArray:n,componentDatatype:a.A.UNSIGNED_BYTE,type:d.A.VEC4,normalized:!0,isRGB565:!1,isTranslucent:!0};if((0,c.A)(t.RGB))return n=e.getPropertyArray("RGB",a.A.UNSIGNED_BYTE,3),{name:"COLOR",semantic:A.A.COLOR,setIndex:0,typedArray:n,componentDatatype:a.A.UNSIGNED_BYTE,type:d.A.VEC3,normalized:!0,isRGB565:!1,isTranslucent:!1};if((0,c.A)(t.RGB565))return n=e.getPropertyArray("RGB565",a.A.UNSIGNED_SHORT,1),{name:"COLOR",semantic:A.A.COLOR,setIndex:0,typedArray:n,componentDatatype:a.A.FLOAT,type:d.A.VEC3,normalized:!1,isRGB565:!0,isTranslucent:!1};if((0,c.A)(t.CONSTANT_RGBA)){const t=e.getGlobalProperty("CONSTANT_RGBA",a.A.UNSIGNED_BYTE,4),n=t[3],i=r.A.fromBytes(t[0],t[1],t[2],n),o=n<255;return{name:A.A.COLOR,semantic:A.A.COLOR,setIndex:0,constantColor:i,componentDatatype:a.A.FLOAT,type:d.A.VEC4,isQuantized:!1,isTranslucent:o}}}(C);I.colors=e,I.hasColors=I.hasColors||(0,c.A)(e),I.hasConstantColor=(0,c.A)(I.constantColor),I.isTranslucent=(0,c.A)(e)&&e.isTranslucent}if(!I.hasBatchIds){const e=function(e){const t=e.json;if((0,c.A)(t.BATCH_ID)){const t=e.getPropertyArray("BATCH_ID",a.A.UNSIGNED_SHORT,1);return{name:A.A.FEATURE_ID,semantic:A.A.FEATURE_ID,setIndex:0,typedArray:t,componentDatatype:a.A.fromTypedArray(t),type:d.A.SCALAR}}}(C);I.batchIds=e,I.hasBatchIds=I.hasBatchIds||(0,c.A)(e)}if(I.hasBatchIds){const e=C.getGlobalProperty("BATCH_LENGTH");if(!(0,c.A)(e))throw new u.A("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");I.batchLength=e}return((0,c.A)(w)||(0,c.A)(x))&&(I.batchTableJson=w,I.batchTableBinary=x),I};const m=p},534135:(e,t,n)=>{"use strict";n.d(t,{A:()=>T});var i=n(434067),o=n(41476),r=n(491446),s=n(677354),a=n(402330),c=n(769493),l=n(377496),u=n(804701),d=n(760866),h=n(40118),A=n(342875),p=n(200646),f=n(938987),m=n(812178);function g(){this._framebuffer=new u.A({colorAttachmentsLength:2,depth:!0,supportsDepthTexture:!0}),this._drawCommand=void 0,this._clearCommand=void 0,this._strength=1,this._radius=1}Object.defineProperties(g.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}},colorGBuffer:{get:function(){return this._framebuffer.getColorTexture(0)}},depthGBuffer:{get:function(){return this._framebuffer.getColorTexture(1)}}});const _=new i.A;function y(e){return e.drawBuffers&&e.fragmentDepth}function v(e,t){let n=e.shaderCache.getDerivedShaderProgram(t,"EC");if(!(0,r.A)(n)){const i=t._attributeLocations,o=t.fragmentShaderSource.clone();o.sources.splice(0,0,"layout (location = 0) out vec4 out_FragData_0;\nlayout (location = 1) out vec4 out_FragData_1;"),o.sources=o.sources.map(function(e){return(e=A.A.replaceMain(e,"czm_point_cloud_post_process_main")).replaceAll(/out_FragColor/g,"out_FragData_0")}),o.sources.push("void main() \n{ \n    czm_point_cloud_post_process_main(); \n#ifdef LOG_DEPTH\n    czm_writeLogDepth();\n    out_FragData_1 = czm_packDepth(gl_FragDepth); \n#else\n    out_FragData_1 = czm_packDepth(gl_FragCoord.z);\n#endif\n}"),n=e.shaderCache.createDerivedShaderProgram(t,"EC",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:o,attributeLocations:i})}return n}g.isSupported=y,g.prototype.update=function(e,t,n,i){if(!y(e.context))return;let s;this._strength=n.eyeDomeLightingStrength,this._radius=n.eyeDomeLightingRadius*e.pixelRatio,function(e,t){const n=t.drawingBufferWidth,i=t.drawingBufferHeight;e._framebuffer.update(t,n,i),function(e,t){const n=new A.A({defines:["LOG_DEPTH_WRITE"],sources:[m.A]}),i={u_pointCloud_colorGBuffer:function(){return e.colorGBuffer},u_pointCloud_depthGBuffer:function(){return e.depthGBuffer},u_distanceAndEdlStrength:function(){return _.x=e._radius,_.y=e._strength,_}},r=h.A.fromCache({blending:p.A.ALPHA_BLEND,depthMask:!0,depthTest:{enabled:!0},stencilTest:f.A.setCesium3DTileBit(),stencilMask:f.A.CESIUM_3D_TILE_MASK});e._drawCommand=t.createViewportQuadCommand(n,{uniformMap:i,renderState:r,pass:d.A.CESIUM_3D_TILE,owner:e}),e._clearCommand=new c.A({framebuffer:e.framebuffer,color:new o.A(0,0,0,0),depth:1,renderState:h.A.fromCache(),pass:d.A.CESIUM_3D_TILE,owner:e})}(e,t)}(this,e.context);const u=e.commandList,g=u.length;for(s=t;s<g;++s){const t=u[s];if(t.primitiveType!==a.A.POINTS||t.pass===d.A.TRANSLUCENT)continue;let n,i,o=t.derivedCommands.pointCloudProcessor;(0,r.A)(o)&&(n=o.command,i=o.originalShaderProgram),(0,r.A)(n)&&!t.dirty&&i===t.shaderProgram&&n.framebuffer===this.framebuffer||(n=l.A.shallowClone(t,n),n.framebuffer=this.framebuffer,n.shaderProgram=v(e.context,t.shaderProgram),n.castShadows=!1,n.receiveShadows=!1,(0,r.A)(o)||(o={command:n,originalShaderProgram:t.shaderProgram},t.derivedCommands.pointCloudProcessor=o),o.originalShaderProgram=t.shaderProgram),u[s]=n}const T=this._clearCommand,b=this._drawCommand;b.boundingVolume=i,u.push(b),u.push(T)},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){var e;return(e=this)._framebuffer.destroy(),e._drawCommand=void 0,e._clearCommand=void 0,(0,s.A)(this)};const T=g},929771:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(534135);function o(e){const t=e??{};this.attenuation=t.attenuation??!1,this.geometricErrorScale=t.geometricErrorScale??1,this.maximumAttenuation=t.maximumAttenuation,this.baseResolution=t.baseResolution,this.eyeDomeLighting=t.eyeDomeLighting??!0,this.eyeDomeLightingStrength=t.eyeDomeLightingStrength??1,this.eyeDomeLightingRadius=t.eyeDomeLightingRadius??1,this.backFaceCulling=t.backFaceCulling??!1,this.normalShading=t.normalShading??!0}o.isSupported=function(e){return i.A.isSupported(e.context)};const r=o},154622:(e,t,n)=>{"use strict";n.d(t,{A:()=>w});var i=n(263604),o=n(660662),r=n(267980),s=n(41476),a=n(915325),c=n(491446),l=n(605971),u=n(853331),d=n(584164),h=n(870349),A=n(608191);function p(e,t){e=e??a.A.EMPTY_OBJECT,this._show=e.show??!0,this._width=e.width??1,this._loop=e.loop??!1,this._distanceDisplayCondition=e.distanceDisplayCondition,this._material=e.material,(0,c.A)(this._material)||(this._material=A.A.fromType(A.A.ColorType,{color:new s.A(1,1,1,1)}));let n,l=e.positions;(0,c.A)(l)||(l=[]),this._positions=l,this._actualPositions=(0,i.A)(l,r.A.equalsEpsilon),this._loop&&this._actualPositions.length>2&&(this._actualPositions===this._positions&&(this._actualPositions=l.slice()),this._actualPositions.push(r.A.clone(this._actualPositions[0]))),this._length=this._actualPositions.length,this._id=e.id,(0,c.A)(t)&&(n=d.A.clone(t.modelMatrix)),this._modelMatrix=n,this._segments=h.A.wrapLongitude(this._actualPositions,n),this._actualLength=void 0,this._propertiesChanged=new Uint32Array(T),this._polylineCollection=t,this._dirty=!1,this._pickId=void 0,this._boundingVolume=o.A.fromPoints(this._actualPositions),this._boundingVolumeWC=o.A.transform(this._boundingVolume,this._modelMatrix),this._boundingVolume2D=new o.A}const f=p.POSITION_INDEX=0,m=p.SHOW_INDEX=1,g=p.WIDTH_INDEX=2,_=p.MATERIAL_INDEX=3,y=p.POSITION_SIZE_INDEX=4,v=p.DISTANCE_DISPLAY_CONDITION=5,T=p.NUMBER_OF_PROPERTIES=6;function b(e,t){++e._propertiesChanged[t];const n=e._polylineCollection;(0,c.A)(n)&&(n._updatePolyline(e,t),e._dirty=!0)}Object.defineProperties(p.prototype,{show:{get:function(){return this._show},set:function(e){if(!(0,c.A)(e))throw new l.A("value is required.");e!==this._show&&(this._show=e,b(this,m))}},positions:{get:function(){return this._positions},set:function(e){if(!(0,c.A)(e))throw new l.A("value is required.");let t=(0,i.A)(e,r.A.equalsEpsilon);this._loop&&t.length>2&&(t===e&&(t=e.slice()),t.push(r.A.clone(t[0]))),this._actualPositions.length===t.length&&this._actualPositions.length===this._length||b(this,y),this._positions=e,this._actualPositions=t,this._length=t.length,this._boundingVolume=o.A.fromPoints(this._actualPositions,this._boundingVolume),this._boundingVolumeWC=o.A.transform(this._boundingVolume,this._modelMatrix,this._boundingVolumeWC),b(this,f),this.update()}},material:{get:function(){return this._material},set:function(e){if(!(0,c.A)(e))throw new l.A("material is required.");this._material!==e&&(this._material=e,b(this,_))}},width:{get:function(){return this._width},set:function(e){if(!(0,c.A)(e))throw new l.A("value is required.");e!==this._width&&(this._width=e,b(this,g))}},loop:{get:function(){return this._loop},set:function(e){if(!(0,c.A)(e))throw new l.A("value is required.");if(e!==this._loop){let t=this._actualPositions;e?t.length>2&&!r.A.equals(t[0],t[t.length-1])&&(t.length===this._positions.length&&(this._actualPositions=t=this._positions.slice()),t.push(r.A.clone(t[0]))):t.length>2&&r.A.equals(t[0],t[t.length-1])&&(t.length-1===this._positions.length?this._actualPositions=this._positions:t.pop()),this._loop=e,b(this,y)}}},id:{get:function(){return this._id},set:function(e){this._id=e,(0,c.A)(this._pickId)&&(this._pickId.object.id=e)}},pickId:{get:function(){return this._pickId}},isDestroyed:{get:function(){return!(0,c.A)(this._polylineCollection)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if((0,c.A)(e)&&e.far<=e.near)throw new l.A("far distance must be greater than near distance.");u.A.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=u.A.clone(e,this._distanceDisplayCondition),b(this,v))}}}),p.prototype.update=function(){let e=d.A.IDENTITY;(0,c.A)(this._polylineCollection)&&(e=this._polylineCollection.modelMatrix);const t=this._segments.positions.length,n=this._segments.lengths,i=this._propertiesChanged[f]>0||this._propertiesChanged[y]>0;if(d.A.equals(e,this._modelMatrix)&&!i||(this._segments=h.A.wrapLongitude(this._actualPositions,e),this._boundingVolumeWC=o.A.transform(this._boundingVolume,e,this._boundingVolumeWC)),this._modelMatrix=d.A.clone(e,this._modelMatrix),this._segments.positions.length!==t)b(this,y);else{const e=n.length;for(let t=0;t<e;++t)if(n[t]!==this._segments.lengths[t]){b(this,y);break}}},p.prototype.getPickId=function(e){return(0,c.A)(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._polylineCollection,id:this._id})),this._pickId},p.prototype._clean=function(){this._dirty=!1;const e=this._propertiesChanged;for(let t=0;t<T-1;++t)e[t]=0},p.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._material=this._material&&this._material.destroy(),this._polylineCollection=void 0};const w=p},891674:(e,t,n)=>{"use strict";n.d(t,{A:()=>Pe});var i=n(660662),o=n(434067),r=n(267980),s=n(626809),a=n(336946),c=n(41476),l=n(430346),u=n(571804),d=n(915325),h=n(491446),A=n(677354),p=n(605971),f=n(816422),m=n(520098),g=n(874915),_=n(647326),y=n(367817),v=n(584164),T=n(257941),b=n(123245),w=n(641613),x=n(442790),C=n(430332),E=n(377496),S=n(760866),I=n(40118),P=n(302836),D=n(342875),O=n(616e3),R=n(508380),M=n(78149),L=n(682091),N=n(57723),B=n(425438),F=n(200646),U=n(608191),k=n(154622),V=n(62467);const z=k.A.SHOW_INDEX,H=k.A.WIDTH_INDEX,G=k.A.POSITION_INDEX,W=k.A.MATERIAL_INDEX,Y=k.A.POSITION_SIZE_INDEX,q=k.A.DISTANCE_DISPLAY_CONDITION,j=k.A.NUMBER_OF_PROPERTIES,Q={texCoordExpandAndBatchIndex:0,position3DHigh:1,position3DLow:2,position2DHigh:3,position2DLow:4,prevPosition3DHigh:5,prevPosition3DLow:6,prevPosition2DHigh:7,prevPosition2DLow:8,nextPosition3DHigh:9,nextPosition3DLow:10,nextPosition2DHigh:11,nextPosition2DLow:12};function X(e){e=e??d.A.EMPTY_OBJECT,this.show=e.show??!0,this.modelMatrix=v.A.clone(e.modelMatrix??v.A.IDENTITY),this._modelMatrix=v.A.clone(v.A.IDENTITY),this.debugShowBoundingVolume=e.debugShowBoundingVolume??!1,this._opaqueRS=void 0,this._translucentRS=void 0,this._colorCommands=[],this._polylinesUpdated=!1,this._polylinesRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(j),this._polylines=[],this._polylineBuckets={},this._positionBufferUsage={bufferUsage:x.A.STATIC_DRAW,frameCount:0},this._mode=void 0,this._polylinesToUpdate=[],this._vertexArrays=[],this._positionBuffer=void 0,this._texCoordExpandAndBatchIndexBuffer=void 0,this._batchTable=void 0,this._createBatchTable=!1,this._useHighlightColor=!1,this._highlightColor=c.A.clone(c.A.WHITE);const t=this;this._uniformMap={u_highlightColor:function(){return t._highlightColor}}}Object.defineProperties(X.prototype,{length:{get:function(){return se(this),this._polylines.length}}}),X.prototype.add=function(e){const t=new k.A(e,this);return t._index=this._polylines.length,this._polylines.push(t),this._createVertexArray=!0,this._createBatchTable=!0,t},X.prototype.remove=function(e){if(this.contains(e)){if(this._polylinesRemoved=!0,this._createVertexArray=!0,this._createBatchTable=!0,(0,h.A)(e._bucket)){const t=e._bucket;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()}return e._destroy(),!0}return!1},X.prototype.removeAll=function(){ae(this),le(this),this._polylineBuckets={},this._polylinesRemoved=!1,this._polylines.length=0,this._polylinesToUpdate.length=0,this._createVertexArray=!0},X.prototype.contains=function(e){return(0,h.A)(e)&&e._polylineCollection===this},X.prototype.get=function(e){if(!(0,h.A)(e))throw new p.A("index is required.");return se(this),this._polylines[e]};const K=new f.A,$=new s.A,J=new o.A;X.prototype.update=function(e){if(se(this),0===this._polylines.length||!this.show)return;!function(e,t){const n=t.mode;e._mode===n&&v.A.equals(e._modelMatrix,e.modelMatrix)||(e._mode=n,e._modelMatrix=v.A.clone(e.modelMatrix),e._createVertexArray=!0)}(this,e);const t=e.context,n=e.mapProjection;let r,a=this._propertiesChanged;if(this._createBatchTable){if(0===C.A.maximumVertexTextureImageUnits)throw new b.A("Vertex texture fetch support is required to render polylines. The maximum number of vertex texture image units must be greater than zero.");!function(e,t){(0,h.A)(e._batchTable)&&e._batchTable.destroy();const n=[{functionName:"batchTable_getWidthAndShow",componentDatatype:u.A.UNSIGNED_BYTE,componentsPerAttribute:2},{functionName:"batchTable_getPickColor",componentDatatype:u.A.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0},{functionName:"batchTable_getCenterHigh",componentDatatype:u.A.FLOAT,componentsPerAttribute:3},{functionName:"batchTable_getCenterLowAndRadius",componentDatatype:u.A.FLOAT,componentsPerAttribute:4},{functionName:"batchTable_getDistanceDisplayCondition",componentDatatype:u.A.FLOAT,componentsPerAttribute:2}];e._batchTable=new B.A(t,n,e._polylines.length)}(this,t),this._createBatchTable=!1}if(this._createVertexArray||function(e){let t=!1;const n=e._propertiesChanged,i=e._positionBufferUsage;return n[G]?i.bufferUsage!==x.A.STREAM_DRAW?(t=!0,i.bufferUsage=x.A.STREAM_DRAW,i.frameCount=100):i.frameCount=100:i.bufferUsage!==x.A.STATIC_DRAW&&(0===i.frameCount?(t=!0,i.bufferUsage=x.A.STATIC_DRAW):i.frameCount--),t}(this))ne(this,t,n);else if(this._polylinesUpdated){const i=this._polylinesToUpdate;if(this._mode!==V.A.SCENE3D){const e=i.length;for(let t=0;t<e;++t)r=i[t],r.update()}if(a[Y]||a[W])ne(this,t,n);else{const t=i.length,c=this._polylineBuckets;for(let l=0;l<t;++l){r=i[l],a=r._propertiesChanged;const t=r._bucket;let u=0;for(const e in c)if(c.hasOwnProperty(e)){if(c[e]===t){a[G]&&t.writeUpdate(u,r,this._positionBuffer,n);break}u+=c[e].lengthOfPositions}if((a[z]||a[H])&&this._batchTable.setBatchedAttribute(r._index,0,new o.A(r._width,r._show)),this._batchTable.attributes.length>2){if(a[G]||a[Y]){const t=e.mode===V.A.SCENE2D?r._boundingVolume2D:r._boundingVolumeWC,n=f.A.fromCartesian(t.center,K),i=s.A.fromElements(n.low.x,n.low.y,n.low.z,t.radius,$);this._batchTable.setBatchedAttribute(r._index,2,n.high),this._batchTable.setBatchedAttribute(r._index,3,i)}if(a[q]){const e=J;e.x=0,e.y=Number.MAX_VALUE;const t=r.distanceDisplayCondition;(0,h.A)(t)&&(e.x=t.near,e.y=t.far),this._batchTable.setBatchedAttribute(r._index,4,e)}}r._clean()}}i.length=0,this._polylinesUpdated=!1}a=this._propertiesChanged;for(let e=0;e<j;++e)a[e]=0;let c=v.A.IDENTITY;e.mode===V.A.SCENE3D&&(c=this.modelMatrix);const d=e.passes,A=0!==e.morphTime;(0,h.A)(this._opaqueRS)&&this._opaqueRS.depthTest.enabled===A||(this._opaqueRS=I.A.fromCache({depthMask:A,depthTest:{enabled:A}})),(0,h.A)(this._translucentRS)&&this._translucentRS.depthTest.enabled===A||(this._translucentRS=I.A.fromCache({blending:F.A.ALPHA_BLEND,depthMask:!A,depthTest:{enabled:A}})),this._batchTable.update(e),(d.render||d.pick)&&function(e,t,n,o){const r=t.context,s=t.commandList,a=n.length;let c=0,u=!0;const d=e._vertexArrays,A=e.debugShowBoundingVolume,p=e._batchTable.getUniformMapCallback(),f=d.length;for(let m=0;m<f;++m){const f=d[m],g=f.buckets,_=g.length;for(let d=0;d<_;++d){const m=g[d];let _=m.offset;const y=m.bucket.shaderProgram,v=m.bucket.polylines,T=v.length;let b,w,x,C,I=0;for(let d=0;d<T;++d){const g=v[d],T=re(g._material);if(T!==b){if((0,h.A)(b)&&I>0){const t=w.isTranslucent();c>=a?(x=new E.A({owner:e}),n.push(x)):x=n[c],++c,C=(0,l.A)(p(w._uniforms),e._uniformMap),x.boundingVolume=i.A.clone(Z,x.boundingVolume),x.modelMatrix=o,x.shaderProgram=y,x.vertexArray=f.va,x.renderState=t?e._translucentRS:e._opaqueRS,x.pass=t?S.A.TRANSLUCENT:S.A.OPAQUE,x.debugShowBoundingVolume=A,x.pickId="v_pickColor",x.uniformMap=C,x.count=I,x.offset=_,_+=I,I=0,u=!0,s.push(x)}w=g._material,w.update(r),b=T}const P=g._locatorBuckets,D=P.length;for(let e=0;e<D;++e){const t=P[e];t.locator===m&&(I+=t.count)}let O;t.mode===V.A.SCENE3D?O=g._boundingVolumeWC:t.mode===V.A.COLUMBUS_VIEW?O=g._boundingVolume2D:t.mode===V.A.SCENE2D?(0,h.A)(g._boundingVolume2D)&&(O=i.A.clone(g._boundingVolume2D,ee),O.center.x=0):(0,h.A)(g._boundingVolumeWC)&&(0,h.A)(g._boundingVolume2D)&&(O=i.A.union(g._boundingVolumeWC,g._boundingVolume2D,ee)),u?(u=!1,i.A.clone(O,Z)):i.A.union(O,Z,Z)}(0,h.A)(b)&&I>0&&(c>=a?(x=new E.A({owner:e}),n.push(x)):x=n[c],++c,C=(0,l.A)(p(w._uniforms),e._uniformMap),x.boundingVolume=i.A.clone(Z,x.boundingVolume),x.modelMatrix=o,x.shaderProgram=y,x.vertexArray=f.va,x.renderState=w.isTranslucent()?e._translucentRS:e._opaqueRS,x.pass=w.isTranslucent()?S.A.TRANSLUCENT:S.A.OPAQUE,x.debugShowBoundingVolume=A,x.pickId="v_pickColor",x.uniformMap=C,x.count=I,x.offset=_,u=!0,s.push(x)),b=void 0}}n.length=c}(this,e,this._colorCommands,c)};const Z=new i.A,ee=new i.A;X.prototype.isDestroyed=function(){return!1},X.prototype.destroy=function(){return ce(this),ae(this),le(this),this._batchTable=this._batchTable&&this._batchTable.destroy(),(0,A.A)(this)};const te=[0,0,0];function ne(e,t,n){e._createVertexArray=!1,ae(e),ce(e),function(e){const t=e._mode,n=e._modelMatrix,i=e._polylineBuckets={},o=e._polylines,r=o.length;for(let e=0;e<r;++e){const r=o[e];if(r._actualPositions.length>1){r.update();const e=r.material;let o=i[e.type];(0,h.A)(o)||(o=i[e.type]=new de(e,t,n)),o.addPolyline(r)}}}(e);const i=[[]];let o=i[0];const r=e._batchTable,s=e._useHighlightColor,a=[0];let c=0;const l=[[]];let d=0;const A=e._polylineBuckets;let p,f;for(p in A)A.hasOwnProperty(p)&&(f=A[p],f.updateShader(t,r,s),d+=f.lengthOfPositions);if(d>0){const s=e._mode,m=new Float32Array(6*d*3),_=new Float32Array(4*d);let v,T=0,b=0,C=0;for(p in A)if(A.hasOwnProperty(p)){f=A[p],f.write(m,_,T,b,C,r,t,n),s===V.A.MORPHING&&((0,h.A)(v)||(v=new Float32Array(6*d*3)),f.writeForMorph(v,T));const e=f.lengthOfPositions;T+=6*e*3,b+=4*e,C+=4*e,c=f.updateIndices(i,a,l,c)}const E=e._positionBufferUsage.bufferUsage,S=x.A.STATIC_DRAW;let I;e._positionBuffer=w.A.createVertexBuffer({context:t,typedArray:m,usage:E}),(0,h.A)(v)&&(I=w.A.createVertexBuffer({context:t,typedArray:v,usage:E})),e._texCoordExpandAndBatchIndexBuffer=w.A.createVertexBuffer({context:t,typedArray:_,usage:S});const P=3*Float32Array.BYTES_PER_ELEMENT,D=4*Float32Array.BYTES_PER_ELEMENT;let O=0;const M=i.length;for(let n=0;n<M;++n)if(o=i[n],o.length>0){const i=new Uint16Array(o),r=w.A.createIndexBuffer({context:t,typedArray:i,usage:x.A.STATIC_DRAW,indexDatatype:g.A.UNSIGNED_SHORT});O+=a[n];const c=6*(n*(P*y.A.SIXTY_FOUR_KILOBYTES)-O*P),d=P+c,h=P+d,A=P+h,p=P+A,f=P+p,m=n*(D*y.A.SIXTY_FOUR_KILOBYTES)-O*D,_=[{index:Q.position3DHigh,componentsPerAttribute:3,componentDatatype:u.A.FLOAT,offsetInBytes:c,strideInBytes:6*P},{index:Q.position3DLow,componentsPerAttribute:3,componentDatatype:u.A.FLOAT,offsetInBytes:d,strideInBytes:6*P},{index:Q.position2DHigh,componentsPerAttribute:3,componentDatatype:u.A.FLOAT,offsetInBytes:c,strideInBytes:6*P},{index:Q.position2DLow,componentsPerAttribute:3,componentDatatype:u.A.FLOAT,offsetInBytes:d,strideInBytes:6*P},{index:Q.prevPosition3DHigh,componentsPerAttribute:3,componentDatatype:u.A.FLOAT,offsetInBytes:h,strideInBytes:6*P},{index:Q.prevPosition3DLow,componentsPerAttribute:3,componentDatatype:u.A.FLOAT,offsetInBytes:A,strideInBytes:6*P},{index:Q.prevPosition2DHigh,componentsPerAttribute:3,componentDatatype:u.A.FLOAT,offsetInBytes:h,strideInBytes:6*P},{index:Q.prevPosition2DLow,componentsPerAttribute:3,componentDatatype:u.A.FLOAT,offsetInBytes:A,strideInBytes:6*P},{index:Q.nextPosition3DHigh,componentsPerAttribute:3,componentDatatype:u.A.FLOAT,offsetInBytes:p,strideInBytes:6*P},{index:Q.nextPosition3DLow,componentsPerAttribute:3,componentDatatype:u.A.FLOAT,offsetInBytes:f,strideInBytes:6*P},{index:Q.nextPosition2DHigh,componentsPerAttribute:3,componentDatatype:u.A.FLOAT,offsetInBytes:p,strideInBytes:6*P},{index:Q.nextPosition2DLow,componentsPerAttribute:3,componentDatatype:u.A.FLOAT,offsetInBytes:f,strideInBytes:6*P},{index:Q.texCoordExpandAndBatchIndex,componentsPerAttribute:4,componentDatatype:u.A.FLOAT,vertexBuffer:e._texCoordExpandAndBatchIndexBuffer,offsetInBytes:m}];let v,T,b,C;s===V.A.SCENE3D?(T=e._positionBuffer,v="vertexBuffer",b=te,C="value"):s===V.A.SCENE2D||s===V.A.COLUMBUS_VIEW?(T=te,v="value",b=e._positionBuffer,C="vertexBuffer"):(T=I,v="vertexBuffer",b=e._positionBuffer,C="vertexBuffer"),_[0][v]=T,_[1][v]=T,_[2][C]=b,_[3][C]=b,_[4][v]=T,_[5][v]=T,_[6][C]=b,_[7][C]=b,_[8][v]=T,_[9][v]=T,_[10][C]=b,_[11][C]=b;const E=new R.A({context:t,attributes:_,indexBuffer:r});e._vertexArrays.push({va:E,buckets:l[n]})}}}function ie(e,t){return t instanceof O.A?t.id:t}const oe=[];function re(e){const t=U.A._uniformList[e.type],n=t.length;oe.length=2*n;let i=0;for(let o=0;o<n;++o){const n=t[o];oe[i]=n,oe[i+1]=e._uniforms[n](),i+=2}return`${e.type}:${JSON.stringify(oe,ie)}`}function se(e){if(e._polylinesRemoved){e._polylinesRemoved=!1;const t=[],n=[];let i,o=0;const r=e._polylines.length;for(let s=0;s<r;++s)i=e._polylines[s],i.isDestroyed||(i._index=o++,n.push(i),t.push(i));e._polylines=t,e._polylinesToUpdate=n}}function ae(e){const t=e._polylines,n=t.length;for(let e=0;e<n;++e)if(!t[e].isDestroyed){const n=t[e]._bucket;(0,h.A)(n)&&(n.shaderProgram=n.shaderProgram&&n.shaderProgram.destroy())}}function ce(e){const t=e._vertexArrays.length;for(let n=0;n<t;++n)e._vertexArrays[n].va.destroy();e._vertexArrays.length=0}function le(e){const t=e._polylines,n=t.length;for(let e=0;e<n;++e)t[e].isDestroyed||t[e]._destroy()}function ue(e,t,n){this.count=e,this.offset=t,this.bucket=n}function de(e,t,n){this.polylines=[],this.lengthOfPositions=0,this.material=e,this.shaderProgram=void 0,this.mode=t,this.modelMatrix=n}function he(e){return r.A.dot(r.A.UNIT_X,e._boundingVolume.center)<0||e._boundingVolume.intersectPlane(T.A.ORIGIN_ZX_PLANE)===_.A.INTERSECTING}X.prototype._updatePolyline=function(e,t){this._polylinesUpdated=!0,e._dirty||this._polylinesToUpdate.push(e),++this._propertiesChanged[t]},de.prototype.addPolyline=function(e){this.polylines.push(e),e._actualLength=this.getPolylinePositionsLength(e),this.lengthOfPositions+=e._actualLength,e._bucket=this},de.prototype.updateShader=function(e,t,n){if((0,h.A)(this.shaderProgram))return;const i=["DISTANCE_DISPLAY_CONDITION"];n&&i.push("VECTOR_TILE"),-1!==this.material.shaderSource.search(/in\s+float\s+v_polylineAngle;/g)&&i.push("POLYLINE_DASH"),m.A.isInternetExplorer()||i.push("CLIP_POLYLINE");const o=new D.A({defines:i,sources:["in vec4 v_pickColor;\n",this.material.shaderSource,L.A]}),r=t.getVertexShaderCallback()(N.A),s=new D.A({defines:i,sources:[M.A,r]});this.shaderProgram=P.A.fromCache({context:e,vertexShaderSource:s,fragmentShaderSource:o,attributeLocations:Q})},de.prototype.getPolylinePositionsLength=function(e){let t;if(this.mode===V.A.SCENE3D||!he(e))return t=e._actualPositions.length,4*t-4;let n=0;const i=e._segments.lengths;t=i.length;for(let e=0;e<t;++e)n+=4*i[e]-4;return n};const Ae=new r.A,pe=new r.A,fe=new r.A,me=new r.A,ge=new s.A,_e=new o.A;de.prototype.write=function(e,t,n,i,o,a,l,u){const d=this.mode,A=u.ellipsoid.maximumRadius*y.A.PI,p=this.polylines,m=p.length;for(let i=0;i<m;++i){const m=p[i],g=m.width,_=m.show&&g>0,y=m._index,v=this.getSegments(m,u),T=v.positions,b=v.lengths,w=T.length,x=m.getPickId(l).color;let C,E=0,S=0;for(let i=0;i<w;++i){0===i?m._loop?C=T[w-2]:(C=me,r.A.subtract(T[0],T[1],C),r.A.add(T[0],C,C)):C=T[i-1],r.A.clone(C,pe),r.A.clone(T[i],Ae),i===w-1?m._loop?C=T[1]:(C=me,r.A.subtract(T[w-1],T[w-2],C),r.A.add(T[w-1],C,C)):C=T[i+1],r.A.clone(C,fe);const s=b[E];i===S+s&&(S+=s,++E);const a=i-S===0,c=i===S+b[E]-1;d===V.A.SCENE2D&&(pe.z=0,Ae.z=0,fe.z=0),d!==V.A.SCENE2D&&d!==V.A.MORPHING||(a||c)&&A-Math.abs(Ae.x)<1&&((Ae.x<0&&pe.x>0||Ae.x>0&&pe.x<0)&&r.A.clone(Ae,pe),(Ae.x<0&&fe.x>0||Ae.x>0&&fe.x<0)&&r.A.clone(Ae,fe));const l=c?2:4;for(let r=a?2:0;r<l;++r){f.A.writeElements(Ae,e,n),f.A.writeElements(pe,e,n+6),f.A.writeElements(fe,e,n+12);const s=r-2<0?-1:1;t[o]=i/(w-1),t[o+1]=r%2*2-1,t[o+2]=s,t[o+3]=y,n+=18,o+=4}}const I=ge;I.x=c.A.floatToByte(x.red),I.y=c.A.floatToByte(x.green),I.z=c.A.floatToByte(x.blue),I.w=c.A.floatToByte(x.alpha);const P=_e;P.x=g,P.y=_?1:0;const D=d===V.A.SCENE2D?m._boundingVolume2D:m._boundingVolumeWC,O=f.A.fromCartesian(D.center,K),R=O.high,M=s.A.fromElements(O.low.x,O.low.y,O.low.z,D.radius,$),L=J;L.x=0,L.y=Number.MAX_VALUE;const N=m.distanceDisplayCondition;(0,h.A)(N)&&(L.x=N.near,L.y=N.far),a.setBatchedAttribute(y,0,P),a.setBatchedAttribute(y,1,I),a.attributes.length>2&&(a.setBatchedAttribute(y,2,R),a.setBatchedAttribute(y,3,M),a.setBatchedAttribute(y,4,L))}};const ye=new r.A,ve=new r.A,Te=new r.A,be=new r.A;de.prototype.writeForMorph=function(e,t){const n=this.modelMatrix,i=this.polylines,o=i.length;for(let s=0;s<o;++s){const o=i[s],a=o._segments.positions,c=o._segments.lengths,l=a.length;let u=0,d=0;for(let i=0;i<l;++i){let s;0===i?o._loop?s=a[l-2]:(s=be,r.A.subtract(a[0],a[1],s),r.A.add(a[0],s,s)):s=a[i-1],s=v.A.multiplyByPoint(n,s,ve);const h=v.A.multiplyByPoint(n,a[i],ye);let A;i===l-1?o._loop?A=a[1]:(A=be,r.A.subtract(a[l-1],a[l-2],A),r.A.add(a[l-1],A,A)):A=a[i+1],A=v.A.multiplyByPoint(n,A,Te);const p=c[u];i===d+p&&(d+=p,++u);const m=i-d===0,g=i===d+c[u]-1?2:4;for(let n=m?2:0;n<g;++n)f.A.writeElements(h,e,t),f.A.writeElements(s,e,t+6),f.A.writeElements(A,e,t+12),t+=18}}};const we=new Array(1);de.prototype.updateIndices=function(e,t,n,i){let o=n.length-1,r=new ue(0,i,this);n[o].push(r);let s=0,a=e[e.length-1],c=0;a.length>0&&(c=a[a.length-1]+1);const l=this.polylines,u=l.length;for(let d=0;d<u;++d){const u=l[d];let h;if(u._locatorBuckets=[],this.mode===V.A.SCENE3D){h=we;const e=u._actualPositions.length;if(!(e>0))continue;h[0]=e}else h=u._segments.lengths;const A=h.length;if(A>0){let l=0;for(let d=0;d<A;++d){const A=h[d]-1;for(let d=0;d<A;++d)c+4>y.A.SIXTY_FOUR_KILOBYTES&&(u._locatorBuckets.push({locator:r,count:l}),l=0,t.push(4),a=[],e.push(a),c=0,r.count=s,s=0,i=0,r=new ue(0,0,this),n[++o]=[r]),a.push(c,c+2,c+1),a.push(c+1,c+2,c+3),l+=6,s+=6,i+=6,c+=4}u._locatorBuckets.push({locator:r,count:l}),c+4>y.A.SIXTY_FOUR_KILOBYTES&&(t.push(0),a=[],e.push(a),c=0,r.count=s,i=0,s=0,r=new ue(0,0,this),n[++o]=[r])}u._clean()}return r.count=s,i},de.prototype.getPolylineStartIndex=function(e){const t=this.polylines;let n=0;const i=t.length;for(let o=0;o<i;++o){const i=t[o];if(i===e)break;n+=i._actualLength}return n};const xe={positions:void 0,lengths:void 0},Ce=new Array(1),Ee=new r.A,Se=new a.A;let Ie;de.prototype.getSegments=function(e,t){let n=e._actualPositions;if(this.mode===V.A.SCENE3D)return Ce[0]=n.length,xe.positions=n,xe.lengths=Ce,xe;he(e)&&(n=e._segments.positions);const o=t.ellipsoid,s=[],a=this.modelMatrix,c=n.length;let l,u=Ee;for(let e=0;e<c;++e)l=n[e],u=v.A.multiplyByPoint(a,l,u),s.push(t.project(o.cartesianToCartographic(u,Se)));if(s.length>0){e._boundingVolume2D=i.A.fromPoints(s,e._boundingVolume2D);const t=e._boundingVolume2D.center;e._boundingVolume2D.center=new r.A(t.z,t.x,t.y)}return xe.positions=s,xe.lengths=e._segments.lengths,xe},de.prototype.writeUpdate=function(e,t,n,i){const o=this.mode,s=i.ellipsoid.maximumRadius*y.A.PI;let a=t._actualLength;if(a){e+=this.getPolylineStartIndex(t);let c=Ie;const l=6*a*3;!(0,h.A)(c)||c.length<l?c=Ie=new Float32Array(l):c.length>l&&(c=new Float32Array(c.buffer,0,l));const u=this.getSegments(t,i),d=u.positions,A=u.lengths;let p,m=0,g=0,_=0;a=d.length;for(let e=0;e<a;++e){0===e?t._loop?p=d[a-2]:(p=me,r.A.subtract(d[0],d[1],p),r.A.add(d[0],p,p)):p=d[e-1],r.A.clone(p,pe),r.A.clone(d[e],Ae),e===a-1?t._loop?p=d[1]:(p=me,r.A.subtract(d[a-1],d[a-2],p),r.A.add(d[a-1],p,p)):p=d[e+1],r.A.clone(p,fe);const n=A[g];e===_+n&&(_+=n,++g);const i=e-_===0,l=e===_+A[g]-1;o===V.A.SCENE2D&&(pe.z=0,Ae.z=0,fe.z=0),o!==V.A.SCENE2D&&o!==V.A.MORPHING||(i||l)&&s-Math.abs(Ae.x)<1&&((Ae.x<0&&pe.x>0||Ae.x>0&&pe.x<0)&&r.A.clone(Ae,pe),(Ae.x<0&&fe.x>0||Ae.x>0&&fe.x<0)&&r.A.clone(Ae,fe));const u=l?2:4;for(let e=i?2:0;e<u;++e)f.A.writeElements(Ae,c,m),f.A.writeElements(pe,c,m+6),f.A.writeElements(fe,c,m+12),m+=18}n.copyFromArrayView(c,18*Float32Array.BYTES_PER_ELEMENT*e)}};const Pe=X},493721:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(673874),o=n(915325),r=n(491446),s=n(677354),a=n(605971),c=n(955943);function l(e){e=e??o.A.EMPTY_OBJECT,this._primitives=[],this._guid=(0,i.A)(),this._primitiveAdded=new c.A,this._primitiveRemoved=new c.A,this._zIndex=void 0,this.show=e.show??!0,this.destroyPrimitives=e.destroyPrimitives??!0,this._countReferences=e.countReferences??!1}function u(e,t){if(!e.contains(t))throw new a.A("primitive is not in this collection.");return e._primitives.indexOf(t)}Object.defineProperties(l.prototype,{length:{get:function(){return this._primitives.length}},primitiveAdded:{get:function(){return this._primitiveAdded}},primitiveRemoved:{get:function(){return this._primitiveRemoved}}}),l.prototype.add=function(e,t){const n=(0,r.A)(t);if(!(0,r.A)(e))throw new a.A("primitive is required.");if(n){if(t<0)throw new a.A("index must be greater than or equal to zero.");if(t>this._primitives.length)throw new a.A("index must be less than or equal to the number of primitives.")}const i=e._external=e._external||{};return(i._composites=i._composites||{})[this._guid]={collection:this},n?this._primitives.splice(t,0,e):this._primitives.push(e),this._countReferences&&((0,r.A)(i._referenceCount)?++i._referenceCount:i._referenceCount=1),this._primitiveAdded.raiseEvent(e),e},l.prototype.remove=function(e){if(this.contains(e)){const t=this._primitives.indexOf(e);if(-1!==t)return this._primitives.splice(t,1),delete e._external._composites[this._guid],this._countReferences&&e._external._referenceCount--,this.destroyPrimitives&&(!this._countReferences||e._external._referenceCount<=0)&&e.destroy(),this._primitiveRemoved.raiseEvent(e),!0}return!1},l.prototype.removeAndDestroy=function(e){const t=this.remove(e);return t&&!this.destroyPrimitives&&e.destroy(),t},l.prototype.removeAll=function(){const e=this._primitives,t=e.length;for(let n=0;n<t;++n){const t=e[n];delete t._external._composites[this._guid],this._countReferences&&t._external._referenceCount--,this.destroyPrimitives&&(!this._countReferences||t._external._referenceCount<=0)&&t.destroy(),this._primitiveRemoved.raiseEvent(t)}this._primitives=[]},l.prototype.contains=function(e){return!!((0,r.A)(e)&&e._external&&e._external._composites&&e._external._composites[this._guid])},l.prototype.raise=function(e){if((0,r.A)(e)){const t=u(this,e),n=this._primitives;if(t!==n.length-1){const e=n[t];n[t]=n[t+1],n[t+1]=e}}},l.prototype.raiseToTop=function(e){if((0,r.A)(e)){const t=u(this,e),n=this._primitives;t!==n.length-1&&(n.splice(t,1),n.push(e))}},l.prototype.lower=function(e){if((0,r.A)(e)){const t=u(this,e),n=this._primitives;if(0!==t){const e=n[t];n[t]=n[t-1],n[t-1]=e}}},l.prototype.lowerToBottom=function(e){if((0,r.A)(e)){const t=u(this,e),n=this._primitives;0!==t&&(n.splice(t,1),n.unshift(e))}},l.prototype.get=function(e){if(!(0,r.A)(e))throw new a.A("index is required.");return this._primitives[e]},l.prototype.update=function(e){if(!this.show)return;const t=this._primitives;for(let n=0;n<t.length;++n)t[n].update(e)},l.prototype.prePassesUpdate=function(e){const t=this._primitives;for(let n=0;n<t.length;++n){const i=t[n];(0,r.A)(i.prePassesUpdate)&&i.prePassesUpdate(e)}},l.prototype.updateForPass=function(e,t){const n=this._primitives;for(let i=0;i<n.length;++i){const o=n[i];(0,r.A)(o.updateForPass)&&o.updateForPass(e,t)}},l.prototype.postPassesUpdate=function(e){const t=this._primitives;for(let n=0;n<t.length;++n){const i=t[n];(0,r.A)(i.postPassesUpdate)&&i.postPassesUpdate(e)}},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return this.removeAll(),(0,s.A)(this)};const d=l},289758:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(369031),o=n(571804),r=n(491446),s=n(874915),a=n(641613),c=n(442790),l=n(730839),u=n(995537),d=n(623524);function h(e){i.A.typeOf.object("attribute",e),this.attribute=e,this.loadBuffer=!1,this.loadTypedArray=!1}function A(e){i.A.typeOf.object("primitive",e),this.primitive=e,this.attributePlans=[],this.indicesPlan=void 0,this.needsOutlines=!1,this.outlineIndices=void 0,this.needsGaussianSplats=!1}A.prototype.postProcess=function(e){this.needsOutlines&&(function(e){const t=e.primitive,n=t.indices,i=t.attributes[0].count,r=new d.A({triangleIndices:n.typedArray,outlineIndices:e.outlineIndices,originalVertexCount:i});n.typedArray=r.updatedTriangleIndices,n.indexDatatype=s.A.fromTypedArray(n.typedArray);const a=new h(function(e){const t=new u.A.Attribute;return t.name="_OUTLINE_COORDINATES",t.typedArray=e,t.componentDatatype=o.A.FLOAT,t.type=l.A.VEC3,t.normalized=!1,t.count=e.length/3,t}(r.outlineCoordinates));a.loadBuffer=!0,a.loadTypedArray=!1,e.attributePlans.push(a),t.outlineCoordinates=a.attribute;const c=e.attributePlans,A=e.attributePlans.length;for(let e=0;e<A;e++){const t=c[e].attribute;t.typedArray=r.updateAttribute(t.typedArray)}}(this),function(e,t){(function(e,t){const n=e.length;for(let i=0;i<n;i++){const n=e[i],o=n.attribute,r=o.typedArray;if(n.loadBuffer){const e=a.A.createVertexBuffer({typedArray:r,context:t,usage:c.A.STATIC_DRAW});e.vertexArrayDestroyable=!1,o.buffer=e}n.loadTypedArray||(o.typedArray=void 0)}})(e.attributePlans,t),(0,r.A)(e.indicesPlan)&&function(e,t){const n=e.indices;if(e.loadBuffer){const e=a.A.createIndexBuffer({typedArray:n.typedArray,context:t,usage:c.A.STATIC_DRAW,indexDatatype:n.indexDatatype});n.buffer=e,e.vertexArrayDestroyable=!1}e.loadTypedArray||(n.typedArray=void 0)}(e.indicesPlan,t)}(this,e)),this.needsGaussianSplats&&function(e){const t=e.attributePlans,n=t.length;for(let e=0;e<n;e++){const n=t[e];n.loadBuffer=!1,n.loadTypedArray=!0}}(this)},A.AttributeLoadPlan=h,A.IndicesLoadPlan=function(e){i.A.typeOf.object("indices",e),this.indices=e,this.loadBuffer=!1,this.loadTypedArray=!1};const p=A},828847:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(369031),o=n(915325),r=n(491446),s=n(663386);function a(e){const t=(e=e??o.A.EMPTY_OBJECT).propertyAttribute,n=e.class;i.A.typeOf.object("options.propertyAttribute",t),i.A.typeOf.object("options.class",n);const a={};if((0,r.A)(t.properties))for(const e in t.properties)t.properties.hasOwnProperty(e)&&(a[e]=new s.A({property:t.properties[e],classProperty:n.properties[e]}));this._name=e.name,this._id=e.id,this._class=n,this._properties=a,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(a.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},class:{get:function(){return this._class}},properties:{get:function(){return this._properties}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),a.prototype.getProperty=function(e){return i.A.typeOf.string("propertyId",e),this._properties[e]};const c=a},663386:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(369031),o=n(915325),r=n(491446);function s(e){const t=(e=e??o.A.EMPTY_OBJECT).property,n=e.classProperty;i.A.typeOf.object("options.property",t),i.A.typeOf.object("options.classProperty",n),this._attribute=t.attribute,this._classProperty=n,this._min=t.min,this._max=t.max;let s=t.offset,a=t.scale;const c=n.hasValueTransform||(0,r.A)(s)||(0,r.A)(a);s=s??n.offset,a=a??n.scale,s=n.unpackVectorAndMatrixTypes(s),a=n.unpackVectorAndMatrixTypes(a),this._offset=s,this._scale=a,this._hasValueTransform=c,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(s.prototype,{attribute:{get:function(){return this._attribute}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},classProperty:{get:function(){return this._classProperty}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});const a=s},287659:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var i=n(369031),o=n(915325),r=n(605971),s=n(491446),a=n(784749),c=n(702247);function l(e){e=e??o.A.EMPTY_OBJECT,i.A.typeOf.number("options.count",e.count),this._name=e.name,this._id=e.id,this._count=e.count,this._extras=e.extras,this._extensions=e.extensions,this._metadataTable=e.metadataTable,this._jsonMetadataTable=e.jsonMetadataTable,this._batchTableHierarchy=e.batchTableHierarchy}Object.defineProperties(l.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},count:{get:function(){return this._count}},class:{get:function(){if((0,s.A)(this._metadataTable))return this._metadataTable.class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},byteLength:{get:function(){let e=0;return(0,s.A)(this._metadataTable)&&(e+=this._metadataTable.byteLength),(0,s.A)(this._batchTableHierarchy)&&(e+=this._batchTableHierarchy.byteLength),e}}}),l.prototype.hasProperty=function(e,t){return i.A.typeOf.number("index",e),i.A.typeOf.string("propertyId",t),!(!(0,s.A)(this._metadataTable)||!this._metadataTable.hasProperty(t))||!(!(0,s.A)(this._batchTableHierarchy)||!this._batchTableHierarchy.hasProperty(e,t))||!(!(0,s.A)(this._jsonMetadataTable)||!this._jsonMetadataTable.hasProperty(t))},l.prototype.hasPropertyBySemantic=function(e,t){return i.A.typeOf.number("index",e),i.A.typeOf.string("semantic",t),!!(0,s.A)(this._metadataTable)&&this._metadataTable.hasPropertyBySemantic(t)},l.prototype.propertyExists=function(e){return i.A.typeOf.string("propertyId",e),!(!(0,s.A)(this._metadataTable)||!this._metadataTable.hasProperty(e))||!(!(0,s.A)(this._batchTableHierarchy)||!this._batchTableHierarchy.propertyExists(e))||!(!(0,s.A)(this._jsonMetadataTable)||!this._jsonMetadataTable.hasProperty(e))},l.prototype.propertyExistsBySemantic=function(e){return i.A.typeOf.string("semantic",e),!!(0,s.A)(this._metadataTable)&&this._metadataTable.hasPropertyBySemantic(e)};const u=[];function d(e,t){if(!(0,s.A)(e)||e<0||e>=t)throw new r.A(`featureId is required and must be between zero and featuresLength - 1 (${t}`-NaN)}l.prototype.getPropertyIds=function(e,t){if((t=(0,s.A)(t)?t:[]).length=0,(0,s.A)(this._metadataTable)){const e=this._metadataTable.getPropertyIds(u);(0,c.A)(t,e)}if((0,s.A)(this._batchTableHierarchy)){const n=this._batchTableHierarchy.getPropertyIds(e,u);(0,c.A)(t,n)}if((0,s.A)(this._jsonMetadataTable)){const e=this._jsonMetadataTable.getPropertyIds(u);(0,c.A)(t,e)}return t},l.prototype.getProperty=function(e,t){let n;return(0,s.A)(this._metadataTable)&&(n=this._metadataTable.getProperty(e,t),(0,s.A)(n))||(0,s.A)(this._batchTableHierarchy)&&(n=this._batchTableHierarchy.getProperty(e,t),(0,s.A)(n))||(0,s.A)(this._jsonMetadataTable)&&(n=this._jsonMetadataTable.getProperty(e,t),(0,s.A)(n))?n:void 0},l.prototype.setProperty=function(e,t,n){(0,s.A)(this._metadataTable)&&this._metadataTable.setProperty(e,t,n)||(0,s.A)(this._batchTableHierarchy)&&this._batchTableHierarchy.setProperty(e,t,n)||((0,s.A)(this._jsonMetadataTable)||(this._jsonMetadataTable=new a.A({count:this._count,properties:{}})),this._jsonMetadataTable.setProperty(e,t,n))},l.prototype.getPropertyBySemantic=function(e,t){if((0,s.A)(this._metadataTable))return this._metadataTable.getPropertyBySemantic(e,t)},l.prototype.setPropertyBySemantic=function(e,t,n){return!!(0,s.A)(this._metadataTable)&&this._metadataTable.setPropertyBySemantic(e,t,n)},l.prototype.getPropertyTypedArray=function(e){if(i.A.typeOf.string("propertyId",e),(0,s.A)(this._metadataTable))return this._metadataTable.getPropertyTypedArray(e)},l.prototype.getPropertyTypedArrayBySemantic=function(e){if(i.A.typeOf.string("semantic",e),(0,s.A)(this._metadataTable))return this._metadataTable.getPropertyTypedArrayBySemantic(e)},l.prototype.isClass=function(e,t){d(e,this.count),i.A.typeOf.string("className",t);const n=this._batchTableHierarchy;return!!(0,s.A)(n)&&n.isClass(e,t)},l.prototype.isExactClass=function(e,t){return d(e,this.count),i.A.typeOf.string("className",t),this.getExactClassName(e)===t},l.prototype.getExactClassName=function(e){d(e,this.count);const t=this._batchTableHierarchy;if((0,s.A)(t))return t.getClassName(e)};const h=l},105792:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(369031),o=n(915325),r=n(491446),s=n(875037);function a(e){const t=(e=e??o.A.EMPTY_OBJECT).propertyTexture,n=e.class,a=e.textures;i.A.typeOf.object("options.propertyTexture",t),i.A.typeOf.object("options.class",n),i.A.typeOf.object("options.textures",a);const c=t.extensions,l=t.extras,u={};if((0,r.A)(t.properties))for(const e in t.properties)t.properties.hasOwnProperty(e)&&(u[e]=new s.A({property:t.properties[e],classProperty:n.properties[e],textures:a}));this._name=e.name,this._id=e.id,this._class=n,this._properties=u,this._extras=l,this._extensions=c}Object.defineProperties(a.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},class:{get:function(){return this._class}},properties:{get:function(){return this._properties}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),a.prototype.getProperty=function(e){return i.A.typeOf.string("propertyId",e),this._properties[e]};const c=a},875037:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(369031),o=n(915325),r=n(491446),s=n(782556),a=n(374607),c=n(568748),l=n(983884);function u(e){const t=(e=e??o.A.EMPTY_OBJECT).property,n=e.classProperty,a=e.textures;i.A.typeOf.object("options.property",t),i.A.typeOf.object("options.classProperty",n),i.A.typeOf.object("options.textures",a);const c=(0,r.A)(t.channels)?t.channels:[0],l=t,u=s.A.createModelTextureReader({textureInfo:l,channels:A(c),texture:a[l.index]});this._min=t.min,this._max=t.max;let d=t.offset,h=t.scale;const p=n.hasValueTransform||(0,r.A)(d)||(0,r.A)(h);d=d??n.offset,h=h??n.scale,d=n.unpackVectorAndMatrixTypes(d),h=n.unpackVectorAndMatrixTypes(h),this._offset=d,this._scale=h,this._hasValueTransform=p,this._textureReader=u,this._classProperty=n,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(u.prototype,{textureReader:{get:function(){return this._textureReader}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},classProperty:{get:function(){return this._classProperty}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),u.prototype.isGpuCompatible=function(){const e=this._classProperty,t=e.type,n=e.componentType;return e.isArray?e.isVariableLengthArray?((0,l.A)(`Property texture property ${e.id} is a variable-length array, which is not supported`),!1):e.arrayLength>4?((0,l.A)(`Property texture property ${e.id} is an array of length ${e.arrayLength}, but may have at most a length of 4`),!1):t!==a.A.SCALAR?((0,l.A)(`Property texture property ${e.id} is an array of type ${t}, but only SCALAR is supported`),!1):n===c.A.UINT8||((0,l.A)(`Property texture property ${e.id} is an array with component type ${n}, but only UINT8 is supported`),!1):a.A.isVectorType(t)||t===a.A.SCALAR?n===c.A.UINT8||((0,l.A)(`Property texture property ${e.id} has component type ${n}, but only UINT8 is supported`),!1):((0,l.A)(`Property texture property ${e.id} has an unsupported type`),!1)};const d=[void 0,"float","vec2","vec3","vec4"],h=[void 0,"int","ivec2","ivec3","ivec4"];function A(e){return e.map(function(e){return"rgba".charAt(e)}).join("")}u.prototype.getGlslType=function(){const e=this._classProperty;let t=a.A.getComponentCount(e.type);return e.isArray&&(t=e.arrayLength),e.normalized?d[t]:h[t]},u.prototype.unpackInShader=function(e){return this._classProperty.normalized?e:`${this.getGlslType()}(255.0 * ${e})`};const p=u},872182:(e,t,n)=>{"use strict";n.d(t,{A:()=>T});var i=n(369031),o=n(915325),r=n(491446),s=n(605971),a=n(452663),c=n(582047),l=n(201783),u=n(395989),d=n(385618),h=n(560710),A=n(952575),p=n(946240),f=n(705919),m=n(729295),g=n(147795),_=n(366165);function y(){}function v(e){this.referenceCount=1,this.resourceLoader=e,this._statisticsPromise=void 0}y.cacheEntries={},y.statistics=new _.A,y.get=function(e){i.A.typeOf.string("cacheKey",e);const t=y.cacheEntries[e];if((0,r.A)(t))return++t.referenceCount,t.resourceLoader},y.add=function(e){i.A.typeOf.object("resourceLoader",e);const t=e.cacheKey;if(i.A.typeOf.string("options.resourceLoader.cacheKey",t),(0,r.A)(y.cacheEntries[t]))throw new s.A(`Resource with this cacheKey is already in the cache: ${t}`);return y.cacheEntries[t]=new v(e),e},y.unload=function(e){i.A.typeOf.object("resourceLoader",e);const t=e.cacheKey,n=y.cacheEntries[t];if(!(0,r.A)(n))throw new s.A(`Resource is not in the cache: ${t}`);--n.referenceCount,0===n.referenceCount&&(y.statistics.removeLoader(e),e.destroy(),delete y.cacheEntries[t])},y.getSchemaLoader=function(e){e=e??o.A.EMPTY_OBJECT;const{schema:t,resource:n}=e;if((0,r.A)(t)===(0,r.A)(n))throw new s.A("One of options.schema and options.resource must be defined.");const i=g.A.getSchemaCacheKey({schema:t,resource:n});let a=y.get(i);return(0,r.A)(a)?a:(a=new m.A({schema:t,resource:n,cacheKey:i}),y.add(a))},y.getEmbeddedBufferLoader=function(e){e=e??o.A.EMPTY_OBJECT;const{parentResource:t,bufferId:n,typedArray:s}=e;i.A.typeOf.object("options.parentResource",t),i.A.typeOf.number("options.bufferId",n);const c=g.A.getEmbeddedBufferCacheKey({parentResource:t,bufferId:n});let l=y.get(c);return(0,r.A)(l)?l:(i.A.typeOf.object("options.typedArray",s),l=new a.A({typedArray:s,cacheKey:c}),y.add(l))},y.getExternalBufferLoader=function(e){e=e??o.A.EMPTY_OBJECT;const{resource:t}=e;i.A.typeOf.object("options.resource",t);const n=g.A.getExternalBufferCacheKey({resource:t});let s=y.get(n);return(0,r.A)(s)?s:(s=new a.A({resource:t,cacheKey:n}),y.add(s))},y.getGltfJsonLoader=function(e){e=e??o.A.EMPTY_OBJECT;const{gltfResource:t,baseResource:n,typedArray:s,gltfJson:a}=e;i.A.typeOf.object("options.gltfResource",t),i.A.typeOf.object("options.baseResource",n);const c=g.A.getGltfCacheKey({gltfResource:t});let l=y.get(c);return(0,r.A)(l)?l:(l=new h.A({resourceCache:y,gltfResource:t,baseResource:n,typedArray:s,gltfJson:a,cacheKey:c}),y.add(l))},y.getBufferViewLoader=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,bufferViewId:n,gltfResource:s,baseResource:a}=e;i.A.typeOf.object("options.gltf",t),i.A.typeOf.number("options.bufferViewId",n),i.A.typeOf.object("options.gltfResource",s),i.A.typeOf.object("options.baseResource",a);const l=g.A.getBufferViewCacheKey({gltf:t,bufferViewId:n,gltfResource:s,baseResource:a});let u=y.get(l);return(0,r.A)(u)?u:(u=new c.A({resourceCache:y,gltf:t,bufferViewId:n,gltfResource:s,baseResource:a,cacheKey:l}),y.add(u))},y.getDracoLoader=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,primitive:n,draco:s,gltfResource:a,baseResource:c}=e;i.A.typeOf.object("options.gltf",t),i.A.typeOf.object("options.primitive",n),i.A.typeOf.object("options.draco",s),i.A.typeOf.object("options.gltfResource",a),i.A.typeOf.object("options.baseResource",c);const u=g.A.getDracoCacheKey({gltf:t,draco:s,gltfResource:a,baseResource:c});let d=y.get(u);return(0,r.A)(d)?d:(d=new l.A({resourceCache:y,gltf:t,primitive:n,draco:s,gltfResource:a,baseResource:c,cacheKey:u}),y.add(d))},y.getSpzLoader=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,primitive:n,spz:s,gltfResource:a,baseResource:c}=e;i.A.typeOf.object("options.gltf",t),i.A.typeOf.object("options.primitive",n),i.A.typeOf.object("options.spz",s),i.A.typeOf.object("options.gltfResource",a),i.A.typeOf.object("options.baseResource",c);const l=g.A.getSpzCacheKey({gltf:t,primitive:n,gltfResource:a,baseResource:c});let u=y.get(l);return(0,r.A)(u)?u:(u=new f.A({resourceCache:y,gltf:t,primitive:n,spz:s,gltfResource:a,baseResource:c,cacheKey:l}),y.add(u))},y.getVertexBufferLoader=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,gltfResource:n,baseResource:a,frameState:c,bufferViewId:l,primitive:u,draco:d,spz:h,attributeSemantic:A,accessorId:f,asynchronous:m=!0,dequantize:_=!1,loadBuffer:v=!1,loadTypedArray:T=!1}=e;if(i.A.typeOf.object("options.gltf",t),i.A.typeOf.object("options.gltfResource",n),i.A.typeOf.object("options.baseResource",a),i.A.typeOf.object("options.frameState",c),!v&&!T)throw new s.A("At least one of loadBuffer and loadTypedArray must be true.");const b=(0,r.A)(l),w=(0,r.A)(u),x=function(e,t){return(0,r.A)(e)&&(0,r.A)(e.attributes)&&(0,r.A)(e.attributes[t])}(d,A),C=(0,r.A)(A),E=(0,r.A)(f);if(b===(x!==(0,r.A)(h)))throw new s.A("One of options.bufferViewId, options.draco, or options.spz must be defined.");if(x&&!C)throw new s.A("When options.draco is defined options.attributeSemantic must also be defined.");if(x&&!E)throw new s.A("When options.draco is defined options.hasAccessorId must also be defined.");if(x&&!w)throw new s.A("When options.draco is defined options.primitive must also be defined.");x&&(i.A.typeOf.object("options.draco",d),i.A.typeOf.string("options.attributeSemantic",A),i.A.typeOf.number("options.accessorId",f));const S=g.A.getVertexBufferCacheKey({gltf:t,gltfResource:n,baseResource:a,frameState:c,bufferViewId:l,draco:d,spz:h,attributeSemantic:A,dequantize:_,loadBuffer:v,loadTypedArray:T});let I=y.get(S);return(0,r.A)(I)?I:(I=new p.A({resourceCache:y,gltf:t,gltfResource:n,baseResource:a,bufferViewId:l,primitive:u,draco:d,spz:h,attributeSemantic:A,accessorId:f,cacheKey:S,asynchronous:m,dequantize:_,loadBuffer:v,loadTypedArray:T}),y.add(I))},y.getIndexBufferLoader=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,accessorId:n,gltfResource:a,baseResource:c,frameState:l,primitive:u,draco:h,asynchronous:A=!0,loadBuffer:p=!1,loadTypedArray:f=!1}=e;if(i.A.typeOf.object("options.gltf",t),i.A.typeOf.number("options.accessorId",n),i.A.typeOf.object("options.gltfResource",a),i.A.typeOf.object("options.baseResource",c),i.A.typeOf.object("options.frameState",l),!p&&!f)throw new s.A("At least one of loadBuffer and loadTypedArray must be true.");const m=g.A.getIndexBufferCacheKey({gltf:t,accessorId:n,gltfResource:a,baseResource:c,frameState:l,draco:h,loadBuffer:p,loadTypedArray:f});let _=y.get(m);return(0,r.A)(_)?_:(_=new d.A({resourceCache:y,gltf:t,accessorId:n,gltfResource:a,baseResource:c,primitive:u,draco:h,cacheKey:m,asynchronous:A,loadBuffer:p,loadTypedArray:f}),y.add(_))},y.getImageLoader=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,imageId:n,gltfResource:s,baseResource:a}=e;i.A.typeOf.object("options.gltf",t),i.A.typeOf.number("options.imageId",n),i.A.typeOf.object("options.gltfResource",s),i.A.typeOf.object("options.baseResource",a);const c=g.A.getImageCacheKey({gltf:t,imageId:n,gltfResource:s,baseResource:a});let l=y.get(c);return(0,r.A)(l)?l:(l=new u.A({resourceCache:y,gltf:t,imageId:n,gltfResource:s,baseResource:a,cacheKey:c}),y.add(l))},y.getTextureLoader=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,textureInfo:n,gltfResource:s,baseResource:a,supportedImageFormats:c,frameState:l,asynchronous:u=!0}=e;i.A.typeOf.object("options.gltf",t),i.A.typeOf.object("options.textureInfo",n),i.A.typeOf.object("options.gltfResource",s),i.A.typeOf.object("options.baseResource",a),i.A.typeOf.object("options.supportedImageFormats",c),i.A.typeOf.object("options.frameState",l);const d=g.A.getTextureCacheKey({gltf:t,textureInfo:n,gltfResource:s,baseResource:a,supportedImageFormats:c,frameState:l});let h=y.get(d);return(0,r.A)(h)?h:(h=new A.A({resourceCache:y,gltf:t,textureInfo:n,gltfResource:s,baseResource:a,supportedImageFormats:c,cacheKey:d,asynchronous:u}),y.add(h))},y.clearForSpecs=function(){const e=[p.A,d.A,l.A,A.A,u.A,c.A,a.A,m.A,h.A];let t;const n=y.cacheEntries,i=[];for(t in n)n.hasOwnProperty(t)&&i.push(n[t]);i.sort(function(t,n){return e.indexOf(t.resourceLoader.constructor)-e.indexOf(n.resourceLoader.constructor)});const o=i.length;for(let e=0;e<o;++e){const o=i[e];t=o.resourceLoader.cacheKey,(0,r.A)(n[t])&&(o.resourceLoader.destroy(),delete n[t])}y.statistics.clear()};const T=y},147795:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var i=n(369031),o=n(915325),r=n(491446),s=n(605971),a=n(712066),c=n(782556),l=n(800859);const u={};function d(e){return(0,a.A)(e.url)}function h(e){let{byteOffset:t,byteLength:n}=e;if((0,l.A)(e,"EXT_meshopt_compression")){const i=e.extensions.EXT_meshopt_compression;t=i.byteOffset??0,n=i.byteLength}return`${t}-${t+n}`}function A(e,t){return`${d(e)}-buffer-id-${t}`}function p(e,t,n,i){return(0,r.A)(e.uri)?d(i.getDerivedResource({url:e.uri})):A(n,t)}function f(e,t,n,i){const o=t.bufferView,r=e.bufferViews[o],s=r.buffer;return`${p(e.buffers[s],s,n,i)}-range-${h(r)}`}function m(e,t,n,i){const o=e.bufferViews[0],r=o.buffer;return`${p(e.buffers[r],r,n,i)}-range-${h(o)}`}function g(e,t,n,i){const o=e.images[t],s=o.bufferView,a=o.uri;if((0,r.A)(a))return d(i.getDerivedResource({url:a}));const c=e.bufferViews[s],l=c.buffer;return`${p(e.buffers[l],l,n,i)}-range-${h(c)}`}u.getSchemaCacheKey=function(e){const{schema:t,resource:n}=e;if((0,r.A)(t)===(0,r.A)(n))throw new s.A("One of options.schema and options.resource must be defined.");return(0,r.A)(t)?`embedded-schema:${JSON.stringify(t)}`:`external-schema:${d(n)}`},u.getExternalBufferCacheKey=function(e){e=e??o.A.EMPTY_OBJECT;const{resource:t}=e;return i.A.typeOf.object("options.resource",t),`external-buffer:${d(t)}`},u.getEmbeddedBufferCacheKey=function(e){e=e??o.A.EMPTY_OBJECT;const{parentResource:t,bufferId:n}=e;return i.A.typeOf.object("options.parentResource",t),i.A.typeOf.number("options.bufferId",n),`embedded-buffer:${A(t,n)}`},u.getGltfCacheKey=function(e){e=e??o.A.EMPTY_OBJECT;const{gltfResource:t}=e;return i.A.typeOf.object("options.gltfResource",t),`gltf:${d(t)}`},u.getBufferViewCacheKey=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,bufferViewId:n,gltfResource:r,baseResource:s}=e;i.A.typeOf.object("options.gltf",t),i.A.typeOf.number("options.bufferViewId",n),i.A.typeOf.object("options.gltfResource",r),i.A.typeOf.object("options.baseResource",s);const a=t.bufferViews[n];let c=a.buffer;const u=t.buffers[c];return(0,l.A)(a,"EXT_meshopt_compression")&&(c=a.extensions.EXT_meshopt_compression.buffer),`buffer-view:${p(u,c,r,s)}-range-${h(a)}`},u.getDracoCacheKey=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,draco:n,gltfResource:r,baseResource:s}=e;return i.A.typeOf.object("options.gltf",t),i.A.typeOf.object("options.draco",n),i.A.typeOf.object("options.gltfResource",r),i.A.typeOf.object("options.baseResource",s),`draco:${f(t,n,r,s)}`},u.getSpzCacheKey=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,primitive:n,gltfResource:r,baseResource:s}=e;return i.A.typeOf.object("options.gltf",t),i.A.typeOf.object("options.primitive",n),i.A.typeOf.object("options.gltfResource",r),i.A.typeOf.object("options.baseResource",s),`spz:${m(t,0,r,s)}`},u.getVertexBufferCacheKey=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,gltfResource:n,baseResource:a,frameState:c,bufferViewId:l,draco:u,spz:d,attributeSemantic:A,dequantize:g=!1,loadBuffer:_=!1,loadTypedArray:y=!1}=e;i.A.typeOf.object("options.gltf",t),i.A.typeOf.object("options.gltfResource",n),i.A.typeOf.object("options.baseResource",a),i.A.typeOf.object("options.frameState",c);const v=(0,r.A)(l),T=function(e,t){return(0,r.A)(e)&&(0,r.A)(e.attributes)&&(0,r.A)(e.attributes[t])}(u,A),b=(0,r.A)(A);if(v===(T!==(0,r.A)(d)))throw new s.A("One of options.bufferViewId and options.draco must be defined.");if(T&&!b)throw new s.A("When options.draco is defined options.attributeSemantic must also be defined.");if(T&&(i.A.typeOf.object("options.draco",u),i.A.typeOf.string("options.attributeSemantic",A)),!_&&!y)throw new s.A("At least one of loadBuffer and loadTypedArray must be true.");let w="";if(g&&(w+="-dequantize"),_&&(w+="-buffer",w+=`-context-${c.context.id}`),y&&(w+="-typed-array"),(0,r.A)(u))return`vertex-buffer:${f(t,u,n,a)}-draco-${A}${w}`;if(d)return`vertex-buffer:${m(t,0,n,a)}-spz-${A}${w}`;const x=t.bufferViews[l],C=x.buffer;return`vertex-buffer:${p(t.buffers[C],C,n,a)}-range-${h(x)}${w}`},u.getIndexBufferCacheKey=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,accessorId:n,gltfResource:a,baseResource:c,frameState:l,draco:u,loadBuffer:d=!1,loadTypedArray:h=!1}=e;if(i.A.typeOf.object("options.gltf",t),i.A.typeOf.number("options.accessorId",n),i.A.typeOf.object("options.gltfResource",a),i.A.typeOf.object("options.baseResource",c),i.A.typeOf.object("options.frameState",l),!d&&!h)throw new s.A("At least one of loadBuffer and loadTypedArray must be true.");let A="";if(d&&(A+="-buffer",A+=`-context-${l.context.id}`),h&&(A+="-typed-array"),(0,r.A)(u))return`index-buffer:${f(t,u,a,c)}-draco${A}`;const m=t.accessors[n],g=m.bufferView,_=t.bufferViews[g],y=_.buffer,v=p(t.buffers[y],y,a,c),T=function(e,t){const n=t.byteOffset+e.byteOffset,{componentType:i,type:o,count:r}=e;return`${n}-${i}-${o}-${r}`}(m,_);return`index-buffer:${v}-accessor-${T}${A}`},u.getImageCacheKey=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,imageId:n,gltfResource:r,baseResource:s}=e;return i.A.typeOf.object("options.gltf",t),i.A.typeOf.number("options.imageId",n),i.A.typeOf.object("options.gltfResource",r),i.A.typeOf.object("options.baseResource",s),`image:${g(t,n,r,s)}`},u.getTextureCacheKey=function(e){e=e??o.A.EMPTY_OBJECT;const{gltf:t,textureInfo:n,gltfResource:r,baseResource:s,supportedImageFormats:a,frameState:l}=e;i.A.typeOf.object("options.gltf",t),i.A.typeOf.object("options.textureInfo",n),i.A.typeOf.object("options.gltfResource",r),i.A.typeOf.object("options.baseResource",s),i.A.typeOf.object("options.supportedImageFormats",a),i.A.typeOf.object("options.frameState",l);const u=n.index,d=g(t,c.A.getImageIdFromTexture({gltf:t,textureId:u,supportedImageFormats:a}),r,s),h=function(e,t){const n=c.A.createSampler({gltf:e,textureInfo:t});return`${n.wrapS}-${n.wrapT}-${n.minificationFilter}-${n.magnificationFilter}`}(t,n);return`texture:${d}-sampler-${h}-context-${l.context.id}`};const _=u},366165:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(369031),o=n(491446);function r(){this.geometryByteLength=0,this.texturesByteLength=0,this._geometrySizes={},this._textureSizes={}}r.prototype.clear=function(){this.geometryByteLength=0,this.texturesByteLength=0,this._geometrySizes={},this._textureSizes={}},r.prototype.addGeometryLoader=function(e){i.A.typeOf.object("loader",e);const t=e.cacheKey;if(this._geometrySizes.hasOwnProperty(t))return;this._geometrySizes[t]=0;const n=e.buffer,r=e.typedArray;let s=0;(0,o.A)(n)&&(s+=n.sizeInBytes),(0,o.A)(r)&&(s+=r.byteLength),this.geometryByteLength+=s,this._geometrySizes[t]=s},r.prototype.addTextureLoader=function(e){i.A.typeOf.object("loader",e);const t=e.cacheKey;if(this._textureSizes.hasOwnProperty(t))return;this._textureSizes[t]=0;const n=e.texture.sizeInBytes;this.texturesByteLength+=e.texture.sizeInBytes,this._textureSizes[t]=n},r.prototype.removeLoader=function(e){i.A.typeOf.object("loader",e);const t=e.cacheKey,n=this._geometrySizes[t];delete this._geometrySizes[t],(0,o.A)(n)&&(this.geometryByteLength-=n);const r=this._textureSizes[t];delete this._textureSizes[t],(0,o.A)(r)&&(this.texturesByteLength-=r)};const s=r},569445:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(369031),o=n(491446),r=n(677354),s=n(605971),a=n(123245);function c(){}Object.defineProperties(c.prototype,{cacheKey:{get:function(){s.A.throwInstantiationError()}}}),c.prototype.load=function(){s.A.throwInstantiationError()},c.prototype.unload=function(){},c.prototype.process=function(e){return!1},c.prototype.getError=function(e,t){i.A.typeOf.string("errorMessage",e),(0,o.A)(t)&&(0,o.A)(t.message)&&(e+=`\n${t.message}`);const n=new a.A(e);return(0,o.A)(t)&&(n.stack=`Original stack:\n${t.stack}\nHandler stack:\n${n.stack}`),n},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this.unload(),(0,r.A)(this)};const l=c},48660:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=Object.freeze({UNLOADED:0,LOADING:1,LOADED:2,PROCESSING:3,READY:4,FAILED:5})},556541:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var i=n(369031),o=n(607502),r=n(915325),s=n(491446),a=n(955943),c=n(182348),l=n(697422),u=n(744603),d=n(123245),h=n(705302),A=n(553909);function p(e){e=e??r.A.EMPTY_OBJECT,this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0;const t=e.rectangle??l.A.MAX_VALUE,n=new c.A({rectangle:t,numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid});this._tilingScheme=n,this._image=void 0,this._texture=void 0,this._hasError=!1,this._errorEvent=new a.A;let s=e.credit;"string"==typeof s&&(s=new o.A(s)),this._credit=s,i.A.defined("options.url",e.url);const d=u.A.createIfNeeded(e.url);this._resource=d,i.A.typeOf.number("options.tileWidth",e.tileWidth),i.A.typeOf.number("options.tileHeight",e.tileHeight),this._tileWidth=e.tileWidth,this._tileHeight=e.tileHeight}async function f(e,t,n){try{return await A.A.loadImage(null,e)}catch(i){return function(e,t,n,i){let o=`Failed to load image ${e.url}`;(0,s.A)(t)&&(0,s.A)(t.message)&&(o+=`: ${t.message}`);const r=h.A.reportError(i,n,(0,s.A)(n)?n._errorEvent:void 0,o,0,0,0,t);if(r.retry)return f(e,n,r);throw(0,s.A)(n)&&(n._hasError=!0),new d.A(o)}(e,i,t,n)}}Object.defineProperties(p.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 0}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),p.fromUrl=async function(e,t){i.A.defined("url",e);const n=u.A.createIfNeeded(e),o=await f(n);t=t??r.A.EMPTY_OBJECT;const s=new p({...t,url:e,tileWidth:o.width,tileHeight:o.height});return s._image=o,s},p.prototype.getTileCredits=function(e,t,n){},p.prototype.requestImage=async function(e,t,n,i){if(!this._hasError&&!(0,s.A)(this._image)){const e=await f(this._resource,this);return this._image=e,h.A.reportSuccess(this._errorEvent),e}return this._image},p.prototype.pickFeatures=function(e,t,n,i,o){};const m=p},126797:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(491446),o=n(677354),r=n(955943),s=n(471874),a=n(276904),c=n(346154),l=n(57775),u=n(654799),d=n(78078);function h(e){this._url=e,this._cubeMapBuffers=void 0,this._texture=void 0,this._maximumMipmapLevel=void 0,this._loading=!1,this._ready=!1,this._errorEvent=new r.A}function A(e){e._cubeMapBuffers=void 0}Object.defineProperties(h.prototype,{url:{get:function(){return this._url}},errorEvent:{get:function(){return this._errorEvent}},texture:{get:function(){return this._texture}},maximumMipmapLevel:{get:function(){return this._maximumMipmapLevel}},ready:{get:function(){return this._ready}}}),h.isSupported=function(e){return(e.colorBufferHalfFloat&&e.halfFloatingPointTexture||e.floatingPointTexture&&e.colorBufferFloat)&&e.supportsTextureLod},h.prototype.update=function(e){const{context:t}=e;if(!h.isSupported(t))return;if((0,i.A)(this._texture))return void A(this);if(!(0,i.A)(this._texture)&&!this._loading){const e=t.textureCache.getTexture(this._url);(0,i.A)(e)&&(A(this),this._texture=e,this._maximumMipmapLevel=this._texture.maximumMipmapLevel,this._ready=!0)}const n=this._cubeMapBuffers;if(!(0,i.A)(n)&&!this._loading){const e=this;(0,s.A)(this._url).then(function(t){e._cubeMapBuffers=t,e._loading=!1}).catch(function(t){e.isDestroyed()||e._errorEvent.raiseEvent(t)}),this._loading=!0}if(!(0,i.A)(this._cubeMapBuffers))return;let{pixelDatatype:o}=n[0].positiveX;(0,i.A)(o)||(o=t.halfFloatingPointTexture?l.A.HALF_FLOAT:l.A.FLOAT);const r=a.A.RGBA,p=n.length;this._maximumMipmapLevel=p-1;const f=n[0].positiveX.width,m=Math.log2(f)+1;if(p!==m){const e={};Object.values(c.A.FaceName).forEach(t=>{e[t]=void 0});for(let t=p;t<m;t++)n.push(e)}const g=new u.A({minificationFilter:d.A.LINEAR_MIPMAP_LINEAR}),_=new c.A({context:t,source:n[0],flipY:!1,pixelDatatype:o,pixelFormat:r,sampler:g});_.loadMipmaps(n.slice(1)),this._texture=_,this._texture.maximumMipmapLevel=this._maximumMipmapLevel,t.textureCache.addTexture(this._url,this._texture),this._ready=!0},h.prototype.isDestroyed=function(){return!1},h.prototype.destroy=function(){return A(this),this._texture=this._texture&&this._texture.destroy(),(0,o.A)(this)};const p=h},590732:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(369031),o=n(915325),r=n(491446);function s(e){e=e??o.A.EMPTY_OBJECT,i.A.typeOf.object("options.schema",e.schema),this._schema=e.schema;const t=e.propertyTables;this._propertyTableCount=(0,r.A)(t)?t.length:0,this._propertyTables=t,this._propertyTextures=e.propertyTextures,this._propertyAttributes=e.propertyAttributes,this._statistics=e.statistics,this._extras=e.extras,this._extensions=e.extensions}Object.defineProperties(s.prototype,{schema:{get:function(){return this._schema}},statistics:{get:function(){return this._statistics}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},propertyTableCount:{get:function(){return this._propertyTableCount}},propertyTables:{get:function(){return this._propertyTables}},propertyTextures:{get:function(){return this._propertyTextures}},propertyAttributes:{get:function(){return this._propertyAttributes}},propertyTablesByteLength:{get:function(){if(!(0,r.A)(this._propertyTables))return 0;let e=0;const t=this._propertyTables.length;for(let n=0;n<t;n++)e+=this._propertyTables[n].byteLength;return e}}}),s.prototype.getPropertyTable=function(e){return i.A.typeOf.number("propertyTableId",e),this._propertyTables[e]},s.prototype.getPropertyTexture=function(e){return i.A.typeOf.number("propertyTextureId",e),this._propertyTextures[e]},s.prototype.getPropertyAttribute=function(e){return i.A.typeOf.number("propertyAttributeId",e),this._propertyAttributes[e]};const a=s},768213:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(915325);const o=function(e){e=e??i.A.EMPTY_OBJECT,this.webp=e.webp??!1,this.basis=e.basis??!1}},557417:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(369031),o=n(955943),r=n(394290),s=n(75584);function a(e){i.A.typeOf.object("terrainProviderPromise",e),this._ready=!1,this._provider=void 0,this._errorEvent=new o.A,this._readyEvent=new o.A,async function(e,t){let n;try{n=await Promise.resolve(t),e._provider=n,e._ready=!0,e._readyEvent.raiseEvent(n)}catch(t){!function(e,t){e.numberOfListeners>0?e.raiseEvent(t):console.error(t)}(e._errorEvent,t)}}(this,e)}Object.defineProperties(a.prototype,{errorEvent:{get:function(){return this._errorEvent}},readyEvent:{get:function(){return this._readyEvent}},ready:{get:function(){return this._ready}},provider:{get:function(){return this._provider}}}),a.fromWorldTerrain=function(e){return new a((0,s.A)(e))},a.fromWorldBathymetry=function(e){return new a((0,r.A)(e))};const c=a},413690:(e,t,n)=>{"use strict";n.d(t,{A:()=>F});var i=n(660662),o=n(267980),r=n(336946),s=n(369031),a=n(433235),c=n(491446),l=n(610750),u=n(75200),d=n(150429),h=n(584164),A=n(832698),p=n(257941),f=n(766067),m=n(697422),g=n(406882),_=n(612123),y=n(842153),v=n(62467);function T(e){s.A.typeOf.object("options",e),s.A.typeOf.object("options.rectangle",e.rectangle),this.rectangle=m.A.clone(e.rectangle),this.minimumHeight=e.minimumHeight??0,this.maximumHeight=e.maximumHeight??0,this.southwestCornerCartesian=new o.A,this.northeastCornerCartesian=new o.A,this.westNormal=new o.A,this.southNormal=new o.A,this.eastNormal=new o.A,this.northNormal=new o.A;const t=e.ellipsoid??l.A.WGS84;!function(e,t,n){n.cartographicToCartesian(m.A.southwest(t),e.southwestCornerCartesian),n.cartographicToCartesian(m.A.northeast(t),e.northeastCornerCartesian),P.longitude=t.west,P.latitude=.5*(t.south+t.north),P.height=0;const i=n.cartographicToCartesian(P,S),r=o.A.cross(i,o.A.UNIT_Z,C);o.A.normalize(r,e.westNormal),P.longitude=t.east;const s=n.cartographicToCartesian(P,I),a=o.A.cross(o.A.UNIT_Z,s,b);o.A.normalize(a,e.eastNormal);let c=o.A.subtract(i,s,b);0===o.A.magnitude(c)&&(c=o.A.clone(r,c));const l=o.A.normalize(c,E),u=t.south;let h;if(u>0){P.longitude=.5*(t.west+t.east),P.latitude=u;const i=n.cartographicToCartesian(P,O.origin);o.A.clone(l,O.direction);const r=p.A.fromPointNormal(e.southwestCornerCartesian,e.westNormal,D);d.A.rayPlane(O,r,e.southwestCornerCartesian),h=n.geodeticSurfaceNormal(i,w)}else h=n.geodeticSurfaceNormalCartographic(m.A.southeast(t),w);const A=o.A.cross(h,c,x);o.A.normalize(A,e.southNormal);const f=t.north;let g;if(f<0){P.longitude=.5*(t.west+t.east),P.latitude=f;const i=n.cartographicToCartesian(P,O.origin);o.A.negate(l,O.direction);const r=p.A.fromPointNormal(e.northeastCornerCartesian,e.eastNormal,D);d.A.rayPlane(O,r,e.northeastCornerCartesian),g=n.geodeticSurfaceNormal(i,w)}else g=n.geodeticSurfaceNormalCartographic(m.A.northwest(t),w);const _=o.A.cross(c,g,x);o.A.normalize(_,e.northNormal)}(this,e.rectangle,t),this._orientedBoundingBox=void 0,this._boundingSphere=void 0,(e.computeBoundingVolumes??1)&&this.computeBoundingVolumes(t)}Object.defineProperties(T.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}}),T.prototype.computeBoundingVolumes=function(e){this._orientedBoundingBox=A.A.fromRectangle(this.rectangle,this.minimumHeight,this.maximumHeight,e),this._boundingSphere=i.A.fromOrientedBoundingBox(this._orientedBoundingBox)};const b=new o.A,w=new o.A,x=new o.A,C=new o.A,E=new o.A,S=new o.A,I=new o.A,P=new r.A,D=new p.A(o.A.UNIT_X,0),O=new f.A,R=new o.A,M=new o.A,L=new o.A(0,-1,0),N=new o.A(0,0,-1),B=new o.A;T.prototype.distanceToCamera=function(e){s.A.defined("frameState",e);const t=function(e,t){const n=t.camera,i=n.positionWC,r=n.positionCartographic;let s,a,c,l=0;if(!m.A.contains(e.rectangle,r)){let n=e.southwestCornerCartesian,r=e.northeastCornerCartesian,s=e.westNormal,a=e.southNormal,c=e.eastNormal,u=e.northNormal;t.mode!==v.A.SCENE3D&&(n=t.mapProjection.project(m.A.southwest(e.rectangle),R),n.z=n.y,n.y=n.x,n.x=0,r=t.mapProjection.project(m.A.northeast(e.rectangle),M),r.z=r.y,r.y=r.x,r.x=0,s=L,c=o.A.UNIT_Y,a=N,u=o.A.UNIT_Z);const d=o.A.subtract(i,n,B),h=o.A.dot(d,s),A=o.A.dot(d,a),p=o.A.subtract(i,r,B),f=o.A.dot(p,c),g=o.A.dot(p,u);h>0?l+=h*h:f>0&&(l+=f*f),A>0?l+=A*A:g>0&&(l+=g*g)}if(t.mode===v.A.SCENE3D?(s=r.height,a=e.minimumHeight,c=e.maximumHeight):(s=i.x,a=0,c=0),s>c){const e=s-c;l+=e*e}else if(s<a){const e=a-s;l+=e*e}return Math.sqrt(l)}(this,e);if(e.mode===v.A.SCENE3D&&(0,c.A)(this._orientedBoundingBox)){const n=Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(e.camera.positionWC));return Math.max(t,n)}return t},T.prototype.intersectPlane=function(e){return s.A.defined("plane",e),this._orientedBoundingBox.intersectPlane(e)},T.prototype.createDebugVolume=function(e){s.A.defined("color",e);const t=new h.A.clone(h.A.IDENTITY),n=new g.A({rectangle:this.rectangle,height:this.minimumHeight,extrudedHeight:this.maximumHeight}),i=new u.A({geometry:n,id:"outline",modelMatrix:t,attributes:{color:a.A.fromColor(e)}});return new y.A({geometryInstances:i,appearance:new _.A({translucent:!1,flat:!0}),asynchronous:!1})};const F=T},224159:(e,t,n)=>{"use strict";n.d(t,{A:()=>Z});var i=n(267980),o=n(491446),r=n(336946),s=n(610750),a=n(647326),c=n(331185),l=n(257941),u=n(173885),d=n(660662),h=n(369031),A=n(433235),p=n(75200),f=n(584164),m=n(612123),g=n(842153),_=n(252538);let y=new r.A;function v(e){h.A.typeOf.object("options",e),h.A.typeOf.string("options.token",e.token);const t=_.A.fromToken(e.token),n=e.minimumHeight??0,o=e.maximumHeight??0,r=e.ellipsoid??s.A.WGS84;this.s2Cell=t,this.minimumHeight=n,this.maximumHeight=o,this.ellipsoid=r;const a=function(e,t,n,o){const r=new Array(6),s=e.getCenter(),a=o.geodeticSurfaceNormal(s,T),c=o.cartesianToCartographic(s,b);c.height=n;const u=o.cartographicToCartesian(c,w),d=l.A.fromPointNormal(u,a);r[0]=d;let h,A=0;const p=[];let f,m;for(h=0;h<4;h++){f=e.getVertex(h),p[h]=f,m=o.cartesianToCartographic(f,x),m.height=t;const n=l.A.getPointDistance(d,o.cartographicToCartesian(m,C));n<A&&(A=n)}const g=l.A.clone(d);for(g.normal=i.A.negate(g.normal,g.normal),g.distance=-1*g.distance+A,r[1]=g,h=0;h<4;h++){f=p[h];const e=p[(h+1)%4],t=o.geodeticSurfaceNormal(f,E),n=i.A.subtract(e,f,I);let s=i.A.cross(n,t,S);s=i.A.normalize(s,s),r[2+h]=l.A.fromPointNormal(f,s)}return r}(t,n,o,r);this._boundingPlanes=a;const c=function(e){const t=new Array(8);for(let n=0;n<4;n++)t[n]=G(e[0],e[2+(n+3)%4],e[2+n%4]),t[n+4]=G(e[1],e[2+(n+3)%4],e[2+n%4]);return t}(a);let u;for(this._vertices=c,this._edgeNormals=new Array(6),this._edgeNormals[0]=q(a[0],c.slice(0,4)),u=0;u<4;u++)this._edgeNormals[0][u]=i.A.negate(this._edgeNormals[0][u],this._edgeNormals[0][u]);for(this._edgeNormals[1]=q(a[1],c.slice(4,8)),u=0;u<4;u++)this._edgeNormals[2+u]=q(a[2+u],[c[u%4],c[(u+1)%4],c[4+(u+1)%4],c[4+u]]);for(this._planeVertices=[this._vertices.slice(0,4),this._vertices.slice(4,8)],u=0;u<4;u++)this._planeVertices.push([this._vertices[u%4],this._vertices[(u+1)%4],this._vertices[4+(u+1)%4],this._vertices[4+u]]);const A=t.getCenter();y=r.cartesianToCartographic(A,y),y.height=(o+n)/2,this.center=r.cartographicToCartesian(y,A),this._boundingSphere=d.A.fromPoints(c)}const T=new i.A,b=new r.A,w=new i.A,x=new r.A,C=new i.A,E=new i.A,S=new i.A,I=new i.A;let P=new i.A,D=new i.A,O=new i.A,R=new i.A,M=new i.A,L=new i.A;const N=new i.A,B=new i.A,F=new i.A;let U=new i.A,k=new i.A,V=new i.A,z=new i.A;const H=new c.A;function G(e,t,n){P=e.normal,D=t.normal,O=n.normal,R=i.A.multiplyByScalar(e.normal,-e.distance,R),M=i.A.multiplyByScalar(t.normal,-t.distance,M),L=i.A.multiplyByScalar(n.normal,-n.distance,L),U=i.A.multiplyByScalar(i.A.cross(D,O,N),i.A.dot(R,P),U),k=i.A.multiplyByScalar(i.A.cross(O,P,B),i.A.dot(M,D),k),V=i.A.multiplyByScalar(i.A.cross(P,D,F),i.A.dot(L,O),V),H[0]=P.x,H[1]=D.x,H[2]=O.x,H[3]=P.y,H[4]=D.y,H[5]=O.y,H[6]=P.z,H[7]=D.z,H[8]=O.z;const o=c.A.determinant(H);return z=i.A.add(U,k,z),z=i.A.add(z,V,z),new i.A(z.x/o,z.y/o,z.z/o)}let W=new i.A,Y=new i.A;function q(e,t){const n=[];for(let o=0;o<4;o++)W=i.A.subtract(t[(o+1)%4],t[o],W),Y=i.A.cross(e.normal,W,Y),Y=i.A.normalize(Y,Y),n[o]=i.A.clone(Y);return n}Object.defineProperties(v.prototype,{boundingVolume:{get:function(){return this}},boundingSphere:{get:function(){return this._boundingSphere}}});const j=new i.A;v.prototype.distanceToCamera=function(e){h.A.defined("frameState",e);const t=e.camera.positionWC,n=[],o=[];let r,s,a,c,u;for(l.A.getPointDistance(this._boundingPlanes[0],t)>0?(n.push(0),o.push(this._planeVertices[0]),r=this._edgeNormals[0]):l.A.getPointDistance(this._boundingPlanes[1],t)>0&&(n.push(1),o.push(this._planeVertices[1]),r=this._edgeNormals[1]),s=0;s<4;s++)a=2+s,l.A.getPointDistance(this._boundingPlanes[a],t)>0&&(n.push(a),o.push(this._planeVertices[a]),r=this._edgeNormals[a]);if(0===n.length)return 0;if(1===n.length)return u=this._boundingPlanes[n[0]],c=J(l.A.projectPointOntoPlane(u,t,j),o[0],0,r),i.A.distance(c,t);if(2===n.length){if(0===n[0]){const e=[this._vertices[4*n[0]+(n[1]-2)],this._vertices[4*n[0]+(n[1]-2+1)%4]];return c=K(t,e[0],e[1]),i.A.distance(c,t)}let e,r=Number.MAX_VALUE;for(s=0;s<2;s++)u=this._boundingPlanes[n[s]],c=J(l.A.projectPointOntoPlane(u,t,j),o[s],0,this._edgeNormals[n[s]]),e=i.A.distanceSquared(c,t),e<r&&(r=e);return Math.sqrt(r)}if(n.length>3)return c=J(l.A.projectPointOntoPlane(this._boundingPlanes[1],t,j),this._planeVertices[1],this._boundingPlanes[1],this._edgeNormals[1]),i.A.distance(c,t);const d=2===n[1]&&5===n[2]?0:1;return 0===n[0]?i.A.distance(t,this._vertices[(n[1]-2+d)%4]):i.A.distance(t,this._vertices[4+(n[1]-2+d)%4])};const Q=new i.A,X=new i.A;function K(e,t,n){const o=i.A.subtract(n,t,Q),r=i.A.subtract(e,t,X);let s=i.A.dot(o,r);if(s<=0)return t;const a=i.A.dot(o,o);return s>=a?n:(s/=a,new i.A((1-s)*t.x+s*n.x,(1-s)*t.y+s*n.y,(1-s)*t.z+s*n.z))}const $=new l.A(i.A.UNIT_X,0);function J(e,t,n,r){let s,a,c,u=Number.MAX_VALUE;for(let n=0;n<t.length;n++){const o=l.A.fromPointNormal(t[n],r[n],$);l.A.getPointDistance(o,e)<0||(c=K(e,t[n],t[(n+1)%4]),s=i.A.distance(e,c),s<u&&(u=s,a=c))}return(0,o.A)(a)?a:e}v.prototype.intersectPlane=function(e){h.A.defined("plane",e);let t=0,n=0;for(let o=0;o<this._vertices.length;o++)i.A.dot(e.normal,this._vertices[o])+e.distance<0?n++:t++;return t===this._vertices.length?a.A.INSIDE:n===this._vertices.length?a.A.OUTSIDE:a.A.INTERSECTING},v.prototype.createDebugVolume=function(e){h.A.defined("color",e);const t=new f.A.clone(f.A.IDENTITY),n=new u.A({polygonHierarchy:{positions:this._planeVertices[0]}}),i=u.A.createGeometry(n),o=new p.A({geometry:i,id:"outline",modelMatrix:t,attributes:{color:A.A.fromColor(e)}}),r=new u.A({polygonHierarchy:{positions:this._planeVertices[1]}}),s=u.A.createGeometry(r),a=new p.A({geometry:s,id:"outline",modelMatrix:t,attributes:{color:A.A.fromColor(e)}}),c=[];for(let n=0;n<4;n++){const i=new u.A({polygonHierarchy:{positions:this._planeVertices[2+n]}}),o=u.A.createGeometry(i);c[n]=new p.A({geometry:o,id:"outline",modelMatrix:t,attributes:{color:A.A.fromColor(e)}})}return new g.A({geometryInstances:[c[0],c[1],c[2],c[3],a,o],appearance:new m.A({translucent:!1,flat:!0}),asynchronous:!1})};const Z=v},315747:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(660662),o=n(267980),r=n(369031),s=n(433235),a=n(75200),c=n(367817),l=n(584164),u=n(6874),d=n(612123),h=n(842153);function A(e,t){0===t&&(t=c.A.EPSILON7),this._boundingSphere=new i.A(e,t)}Object.defineProperties(A.prototype,{center:{get:function(){return this._boundingSphere.center}},radius:{get:function(){return this._boundingSphere.radius}},boundingVolume:{get:function(){return this._boundingSphere}},boundingSphere:{get:function(){return this._boundingSphere}}}),A.prototype.distanceToCamera=function(e){r.A.defined("frameState",e);const t=this._boundingSphere;return Math.max(0,o.A.distance(t.center,e.camera.positionWC)-t.radius)},A.prototype.intersectPlane=function(e){return r.A.defined("plane",e),i.A.intersectPlane(this._boundingSphere,e)},A.prototype.update=function(e,t){o.A.clone(e,this._boundingSphere.center),this._boundingSphere.radius=t},A.prototype.createDebugVolume=function(e){r.A.defined("color",e);const t=new u.A({radius:this.radius}),n=l.A.fromTranslation(this.center,new l.A.clone(l.A.IDENTITY)),i=new a.A({geometry:t,id:"outline",modelMatrix:n,attributes:{color:s.A.fromColor(e)}});return new h.A({geometryInstances:i,appearance:new d.A({translucent:!1,flat:!0}),asynchronous:!1})};const p=A},976092:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(491446),o=n(921243);function r(e,t,n){this.readyImagery=void 0,this.loadingImagery=e,this.textureCoordinateRectangle=t,this.textureTranslationAndScale=void 0,this.useWebMercatorT=n}r.prototype.freeResources=function(){(0,i.A)(this.readyImagery)&&this.readyImagery.releaseReference(),(0,i.A)(this.loadingImagery)&&this.loadingImagery.releaseReference()},r.prototype.processStateMachine=function(e,t,n){const r=this.loadingImagery,s=r.imageryLayer;if(r.processStateMachine(t,!this.useWebMercatorT,n),r.state===o.A.READY)return(0,i.A)(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=this.loadingImagery,this.loadingImagery=void 0,this.textureTranslationAndScale=s._calculateTextureTranslationAndScale(e,this),!0;let a,c=r.parent;for(;(0,i.A)(c)&&(c.state!==o.A.READY||!this.useWebMercatorT&&!(0,i.A)(c.texture));)c.state!==o.A.FAILED&&c.state!==o.A.INVALID&&(a=a||c),c=c.parent;return this.readyImagery!==c&&((0,i.A)(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=c,(0,i.A)(c)&&(c.addReference(),this.textureTranslationAndScale=s._calculateTextureTranslationAndScale(e,this))),!(r.state!==o.A.FAILED&&r.state!==o.A.INVALID||(0,i.A)(a)&&(a.processStateMachine(t,!this.useWebMercatorT,n),1))};const s=r},829670:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var i=n(434067),o=n(336946),r=n(369031),s=n(915325),a=n(491446),c=n(653577),l=n(182348),u=n(697422),d=n(373388),h=n(744603),A=n(123245),p=n(705302),f=n(41076),m=n(66458);function g(e){m.A.call(this,e)}function _(e,t){return e.west<t.rectangle.west&&(e.west=t.rectangle.west),e.east>t.rectangle.east&&(e.east=t.rectangle.east),e.south<t.rectangle.south&&(e.south=t.rectangle.south),e.north>t.rectangle.north&&(e.north=t.rectangle.north),e}function y(e,t,n){const i=e.positionToTileXY(u.A.southwest(t),n),o=e.positionToTileXY(u.A.northeast(t),n);return(Math.abs(o.x-i.x)+1)*(Math.abs(o.y-i.y)+1)>4?0:n}g._requestMetadata=async function(e,t,n,i){try{const o=await n.fetchXML();return g._metadataSuccess(o,e,t,n,i)}catch(n){if(n instanceof d.A)return g._metadataFailure(e,t);throw n}},g.fromUrl=async function(e,t){r.A.defined("url",e);const n=h.A.createIfNeeded(e);n.appendForwardSlash();const i=n,o=n.getDerivedResource({url:"tilemapresource.xml"});t=t??s.A.EMPTY_OBJECT;const a=await g._requestMetadata(t,i,o);return new g(a)},(0,a.A)(Object.create)&&(g.prototype=Object.create(m.A.prototype),g.prototype.constructor=g),g._metadataSuccess=function(e,t,n,r,s){const d=/tileformat/i,h=/tileset/i,m=/tilesets/i,g=/boundingbox/i;let v,T,b;const w=[],x=e.childNodes[0].childNodes;for(let e=0;e<x.length;e++)if(d.test(x.item(e).nodeName))v=x.item(e);else if(m.test(x.item(e).nodeName)){b=x.item(e);const t=x.item(e).childNodes;for(let e=0;e<t.length;e++)h.test(t.item(e).nodeName)&&w.push(t.item(e))}else g.test(x.item(e).nodeName)&&(T=x.item(e));let C;if(!(0,a.A)(b)||!(0,a.A)(T))throw C=`Unable to find expected tilesets or bbox attributes in ${r.url}.`,(0,a.A)(s)&&p.A.reportError(void 0,s,s.errorEvent,C),new A.A(C);const E=t.fileExtension??v.getAttribute("extension"),S=t.tileWidth??parseInt(v.getAttribute("width"),10),I=t.tileHeight??parseInt(v.getAttribute("height"),10);let P=t.minimumLevel??parseInt(w[0].getAttribute("order"),10);const D=t.maximumLevel??parseInt(w[w.length-1].getAttribute("order"),10),O=b.getAttribute("profile");let R=t.tilingScheme;if(!(0,a.A)(R))if("geodetic"===O||"global-geodetic"===O)R=new l.A({ellipsoid:t.ellipsoid});else{if("mercator"!==O&&"global-mercator"!==O)throw C=`${r.url} specifies an unsupported profile attribute, ${O}.`,(0,a.A)(s)&&p.A.reportError(void 0,s,s.errorEvent,C),new A.A(C);R=new f.A({ellipsoid:t.ellipsoid})}let M=u.A.clone(t.rectangle);if(!(0,a.A)(M)){let e,n,r,s;t.flipXY?(r=new i.A(parseFloat(T.getAttribute("miny")),parseFloat(T.getAttribute("minx"))),s=new i.A(parseFloat(T.getAttribute("maxy")),parseFloat(T.getAttribute("maxx")))):(r=new i.A(parseFloat(T.getAttribute("minx")),parseFloat(T.getAttribute("miny"))),s=new i.A(parseFloat(T.getAttribute("maxx")),parseFloat(T.getAttribute("maxy"))));const a="geodetic"===O||"mercator"===O;if(R.projection instanceof c.A||a)e=o.A.fromDegrees(r.x,r.y),n=o.A.fromDegrees(s.x,s.y);else{const t=R.projection;e=t.unproject(r),n=t.unproject(s)}M=new u.A(e.longitude,e.latitude,n.longitude,n.latitude)}return M=_(M,R),P=y(R,M,P),{url:n.getDerivedResource({url:`{z}/{x}/{reverseY}.${E}`}),tilingScheme:R,rectangle:M,tileWidth:S,tileHeight:I,minimumLevel:P,maximumLevel:D,tileDiscardPolicy:t.tileDiscardPolicy,credit:t.credit}},g._metadataFailure=function(e,t){const n=e.fileExtension??"png",i=e.tileWidth??256,o=e.tileHeight??256,r=e.maximumLevel,s=(0,a.A)(e.tilingScheme)?e.tilingScheme:new f.A({ellipsoid:e.ellipsoid});let c=e.rectangle??s.rectangle;c=_(c,s);const l=y(s,c,e.minimumLevel);return{url:t.getDerivedResource({url:`{z}/{x}/{reverseY}.${n}`}),tilingScheme:s,rectangle:c,tileWidth:i,tileHeight:o,minimumLevel:l,maximumLevel:r,tileDiscardPolicy:e.tileDiscardPolicy,credit:e.credit}};const v=g},335859:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(369031),o=n(915325),r=n(965976);function s(e){const t=(e=e??o.A.EMPTY_OBJECT).tile,n=e.class;i.A.typeOf.object("options.tile",t),i.A.typeOf.object("options.class",n),this._class=n,this._properties=t.properties,this._extensions=t.extensions,this._extras=t.extras}Object.defineProperties(s.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),s.prototype.hasProperty=function(e){return r.A.hasProperty(e,this._properties,this._class)},s.prototype.hasPropertyBySemantic=function(e){return r.A.hasPropertyBySemantic(e,this._properties,this._class)},s.prototype.getPropertyIds=function(e){return r.A.getPropertyIds(this._properties,this._class,e)},s.prototype.getProperty=function(e){return r.A.getProperty(e,this._properties,this._class)},s.prototype.setProperty=function(e,t){return r.A.setProperty(e,t,this._properties,this._class)},s.prototype.getPropertyBySemantic=function(e){return r.A.getPropertyBySemantic(e,this._properties,this._class)},s.prototype.setPropertyBySemantic=function(e,t){return r.A.setPropertyBySemantic(e,t,this._properties,this._class)};const a=s},11745:(e,t,n)=>{"use strict";n.d(t,{A:()=>w});var i=n(660662),o=n(854894),r=n(267980),s=n(369031),a=n(433235),c=n(75200),l=n(331185),u=n(584164),d=n(367817),h=n(832698),A=n(612123),p=n(842153);const f=new r.A,m=new r.A,g=new r.A,_=new r.A;function y(e,t,n){n=r.A.cross(e,t,n);const i=r.A.magnitude(n);return r.A.multiplyByScalar(n,d.A.EPSILON7/i,n)}function v(e,t){const n=r.A.normalize(e,_);return y(e,r.A.equalsEpsilon(n,r.A.UNIT_X,d.A.EPSILON6)?r.A.UNIT_Y:r.A.UNIT_X,t)}function T(e){let t=l.A.getColumn(e,0,f),n=l.A.getColumn(e,1,m),i=l.A.getColumn(e,2,g);const o=r.A.equals(t,r.A.ZERO),s=r.A.equals(n,r.A.ZERO),a=r.A.equals(i,r.A.ZERO);return o||s||a?o&&s&&a?(e[0]=d.A.EPSILON7,e[4]=d.A.EPSILON7,e[8]=d.A.EPSILON7,e):(!o||s||a?o||!s||a?o||s||!a?o?s?a||(t=v(i,t),n=y(i,t,n)):(t=v(n,t),i=y(n,t,i)):(n=v(t,n),i=y(n,t,i)):i=y(n,t,i):n=y(t,i,n):t=y(n,i,t),l.A.setColumn(e,0,t,e),l.A.setColumn(e,1,n,e),l.A.setColumn(e,2,i,e),e):e}function b(e,t){t=T(t),this._orientedBoundingBox=new h.A(e,t),this._boundingSphere=i.A.fromOrientedBoundingBox(this._orientedBoundingBox)}Object.defineProperties(b.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}}),b.prototype.distanceToCamera=function(e){return s.A.defined("frameState",e),Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(e.camera.positionWC))},b.prototype.intersectPlane=function(e){return s.A.defined("plane",e),this._orientedBoundingBox.intersectPlane(e)},b.prototype.update=function(e,t){r.A.clone(e,this._orientedBoundingBox.center),t=T(t),l.A.clone(t,this._orientedBoundingBox.halfAxes),i.A.fromOrientedBoundingBox(this._orientedBoundingBox,this._boundingSphere)},b.prototype.createDebugVolume=function(e){s.A.defined("color",e);const t=new o.A({minimum:new r.A(-1,-1,-1),maximum:new r.A(1,1,1)}),n=u.A.fromRotationTranslation(this.boundingVolume.halfAxes,this.boundingVolume.center),i=new c.A({geometry:t,id:"outline",modelMatrix:n,attributes:{color:a.A.fromColor(e)}});return new p.A({geometryInstances:i,appearance:new A.A({translucent:!1,flat:!0}),asynchronous:!1})};const w=b},323314:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(677354);function o(e,t,n){this._tileset=e,this._tile=t,this._resource=n,this.featurePropertiesDirty=!1,this._metadata=void 0,this._group=void 0,this._ready=!1}Object.defineProperties(o.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},group:{get:function(){return this._group},set:function(e){this._group=e}}}),o.fromJson=function(e,t,n,i){const r=new o(e,t,n);return r._tileset.loadTileset(r._resource,i,r._tile),r._ready=!0,r},o.prototype.hasProperty=function(e,t){return!1},o.prototype.getFeature=function(e){},o.prototype.applyDebugSettings=function(e,t){},o.prototype.applyStyle=function(e){},o.prototype.update=function(e,t){},o.prototype.pick=function(e,t,n){},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){return(0,i.A)(this)};const r=o},751069:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(369031),o=n(915325),r=n(491446),s=n(965976);function a(e){const t=(e=e??o.A.EMPTY_OBJECT).tileset,n=e.class;i.A.typeOf.object("options.tileset",t),i.A.typeOf.object("options.class",n);const s=(0,r.A)(t.properties)?t.properties:{};this._class=n,this._properties=s,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(a.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),a.prototype.hasProperty=function(e){return s.A.hasProperty(e,this._properties,this._class)},a.prototype.hasPropertyBySemantic=function(e){return s.A.hasPropertyBySemantic(e,this._properties,this._class)},a.prototype.getPropertyIds=function(e){return s.A.getPropertyIds(this._properties,this._class,e)},a.prototype.getProperty=function(e){return s.A.getProperty(e,this._properties,this._class)},a.prototype.setProperty=function(e,t){return s.A.setProperty(e,t,this._properties,this._class)},a.prototype.getPropertyBySemantic=function(e){return s.A.getPropertyBySemantic(e,this._properties,this._class)},a.prototype.setPropertyBySemantic=function(e,t){return s.A.setPropertyBySemantic(e,t,this._properties,this._class)};const c=a},99520:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(369031),o=n(915325),r=n(491446),s=n(605971),a=n(591978),c=n(209202),l=n(307898);function u(e){e=e??o.A.EMPTY_OBJECT,i.A.typeOf.object("options.clock",e.clock),i.A.typeOf.object("options.times",e.times),i.A.typeOf.func("options.requestImageFunction",e.requestImageFunction),i.A.typeOf.func("options.reloadFunction",e.reloadFunction),this._tileCache={},this._tilesRequestedForInterval=[];const t=this._clock=e.clock;this._times=e.times,this._requestImageFunction=e.requestImageFunction,this._reloadFunction=e.reloadFunction,this._currentIntervalIndex=-1,t.onTick.addEventListener(this._clockOnTick,this),this._clockOnTick(t)}function d(e,t,n){return`${e}-${t}-${n}`}function h(e){const t=e._times;if(!(0,r.A)(t))return;const n=e._clock,i=n.currentTime,o=n.canAnimate&&n.shouldAnimate,s=n.multiplier;if(!o&&0!==s)return;let c,l=t.indexOf(i);if(l<0)return;const u=t.get(l);return s>0?(c=a.A.secondsDifference(u.stop,i),++l):(c=a.A.secondsDifference(u.start,i),--l),c/=s,l>=0&&c<=5?t.get(l):void 0}function A(e,t,n){const i=e._times.indexOf(n.start),o=e._tileCache;let s=o[i];(0,r.A)(s)||(s=o[i]={});const a=t.key;if((0,r.A)(s[a]))return!0;const u=function(e){const t=e.split("-");if(3===t.length)return{x:Number(t[0]),y:Number(t[1]),level:Number(t[2])}}(a),d=new c.A({throttle:!1,throttleByServer:!0,type:l.A.IMAGERY,priorityFunction:t.priorityFunction}),h=e._requestImageFunction(u.x,u.y,u.level,d,n);return!!(0,r.A)(h)&&(s[a]={promise:h,request:d},!0)}Object.defineProperties(u.prototype,{clock:{get:function(){return this._clock},set:function(e){if(!(0,r.A)(e))throw new s.A("value is required.");this._clock!==e&&(this._clock=e,this._clockOnTick(e),this._reloadFunction())}},times:{get:function(){return this._times},set:function(e){if(!(0,r.A)(e))throw new s.A("value is required.");this._times!==e&&(this._times=e,this._clockOnTick(this._clock),this._reloadFunction())}},currentInterval:{get:function(){return this._times.get(this._currentIntervalIndex)}}}),u.prototype.getFromCache=function(e,t,n,i){const o=d(e,t,n);let s;const a=this._tileCache[this._currentIntervalIndex];if((0,r.A)(a)&&(0,r.A)(a[o])){const e=a[o];s=e.promise.catch(function(t){throw i.state=e.request.state,t}),delete a[o]}return s},u.prototype.checkApproachingInterval=function(e,t,n,i){const o=d(e,t,n),s=this._tilesRequestedForInterval,a=h(this),c={key:o,priorityFunction:i.priorityFunction};(0,r.A)(a)&&A(this,c,a)||s.push(c),s.length>=512&&s.splice(0,256)},u.prototype._clockOnTick=function(e){const t=e.currentTime,n=this._times.indexOf(t),i=this._currentIntervalIndex;if(n!==i){const e=this._tileCache[i];for(const t in e)e.hasOwnProperty(t)&&e[t].request.cancel();return delete this._tileCache[i],this._tilesRequestedForInterval=[],this._currentIntervalIndex=n,void this._reloadFunction()}const o=h(this);if((0,r.A)(o)){const e=this._tilesRequestedForInterval;let t=!0;for(;t&&0!==e.length;){const n=e.pop();t=A(this,n,o),t||e.push(n)}}};const p=u},28940:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=function(e){this.offset=e.offset,this.count=e.count,this.color=e.color,this.batchIds=e.batchIds}},308521:(e,t,n)=>{"use strict";n.d(t,{A:()=>W});var i=n(564886),o=n(434067),r=n(267980),s=n(41476),a=n(571804),c=n(491446),l=n(677354),u=n(610750),d=n(520098),h=n(874915),A=n(832698),p=n(584164),f=n(697422),m=n(971724),g=n(641613),_=n(442790),y=n(377496),v=n(760866),T=n(40118),b=n(302836),w=n(342875),x=n(508380),C=n(78149),E=n(296312),S=n(154920),I=n(200646),P=n(622569),D=n(71578),O=n(527083),R=n(938987),M=n(896464),L=n(138151),N=n(953681);function B(e){this._positions=e.positions,this._widths=e.widths,this._counts=e.counts,this._batchIds=e.batchIds,this._ellipsoid=e.ellipsoid??u.A.WGS84,this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._center=e.center,this._rectangle=e.rectangle,this._batchTable=e.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._minimumMaximumVectorHeights=new o.A(i.A._defaultMinTerrainHeight,i.A._defaultMaxTerrainHeight),this._boundingVolume=A.A.fromRectangle(e.rectangle,i.A._defaultMinTerrainHeight,i.A._defaultMaxTerrainHeight,this._ellipsoid),this._classificationType=e.classificationType,this._keepDecodedPositions=e.keepDecodedPositions,this._decodedPositions=void 0,this._decodedPositionOffsets=void 0,this._startEllipsoidNormals=void 0,this._endEllipsoidNormals=void 0,this._startPositionAndHeights=void 0,this._startFaceNormalAndVertexCornerIds=void 0,this._endPositionAndHeights=void 0,this._endFaceNormalAndHalfWidths=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=s.A.clone(s.A.WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._promise=void 0,this._error=void 0}Object.defineProperties(B.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}}});const F=new m.A("createVectorTileClampedPolylines"),U={startEllipsoidNormal:0,endEllipsoidNormal:1,startPositionAndHeight:2,endPositionAndHeight:3,startFaceNormalAndVertexCorner:4,endFaceNormalAndHalfWidth:5,a_batchId:6};const k=new p.A,V=new r.A;function z(e){return T.A.fromCache({cull:{enabled:!0,face:O.A.FRONT},blending:I.A.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1,stencilTest:{enabled:e,frontFunction:M.A.EQUAL,frontOperation:{fail:L.A.KEEP,zFail:L.A.KEEP,zPass:L.A.KEEP},backFunction:M.A.EQUAL,backOperation:{fail:L.A.KEEP,zFail:L.A.KEEP,zPass:L.A.KEEP},reference:R.A.CESIUM_3D_TILE_MASK,mask:R.A.CESIUM_3D_TILE_MASK}})}B.prototype.getPositions=function(e){return N.A.getPolylinePositions(this,e)},B.prototype.createFeatures=function(e,t){const n=this._batchIds,i=n.length;for(let o=0;o<i;++o){const i=n[o];t[i]=new P.A(e,i)}},B.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};const H=new s.A,G=s.A.WHITE;B.prototype.applyStyle=function(e,t){if(!(0,c.A)(e))return void function(e,t){const n=e._batchIds,i=n.length;for(let e=0;e<i;++e){const i=t[n[e]];i.show=!0,i.color=s.A.WHITE}}(this,t);const n=this._batchIds,i=n.length;for(let o=0;o<i;++o){const i=t[n[o]];i.color=(0,c.A)(e.color)?e.color.evaluateColor(i,H):G,i.show=!(0,c.A)(e.show)||e.show.evaluate(i)}},B.prototype.update=function(e){const t=e.context;if(!this._ready){if((0,c.A)(this._promise)||(this._promise=(n=this,i.A.initialize().then(function(){!function(e,t,n){const o=i.A.getMinimumMaximumHeights(t,n),r=o.minimumTerrainHeight,s=o.maximumTerrainHeight,a=e._minimumMaximumVectorHeights;a.x=r,a.y=s;const c=e._boundingVolume,l=e._rectangle;A.A.fromRectangle(l,r,s,n,c)}(n,n._rectangle,n._ellipsoid)}).catch(e=>{n.isDestroyed()||(n._error=e)})).then(function(e,t){if((0,c.A)(e._va))return;let n=e._positions,i=e._widths,o=e._counts,s=e._transferrableBatchIds,l=e._packedBuffer;(0,c.A)(l)||(n=e._positions=n.slice(),i=e._widths=i.slice(),o=e._counts=o.slice(),s=e._transferrableBatchIds=e._batchIds.slice(),l=e._packedBuffer=function(e){const t=e._rectangle,n=e._minimumHeight,i=e._maximumHeight,o=e._ellipsoid,s=e._center,a=2+f.A.packedLength+u.A.packedLength+r.A.packedLength,c=new Float64Array(a);let l=0;return c[l++]=n,c[l++]=i,f.A.pack(t,c,l),l+=f.A.packedLength,u.A.pack(o,c,l),l+=u.A.packedLength,r.A.pack(s,c,l),c}(e));const d=[n.buffer,i.buffer,o.buffer,s.buffer,l.buffer],A={positions:n.buffer,widths:i.buffer,counts:o.buffer,batchIds:s.buffer,packedBuffer:l.buffer,keepDecodedPositions:e._keepDecodedPositions},p=F.scheduleTask(A,d);return(0,c.A)(p)?p.then(function(n){if(e.isDestroyed())return;e._keepDecodedPositions&&(e._decodedPositions=new Float64Array(n.decodedPositions),e._decodedPositionOffsets=new Uint32Array(n.decodedPositionOffsets)),e._startEllipsoidNormals=new Float32Array(n.startEllipsoidNormals),e._endEllipsoidNormals=new Float32Array(n.endEllipsoidNormals),e._startPositionAndHeights=new Float32Array(n.startPositionAndHeights),e._startFaceNormalAndVertexCornerIds=new Float32Array(n.startFaceNormalAndVertexCornerIds),e._endPositionAndHeights=new Float32Array(n.endPositionAndHeights),e._endFaceNormalAndHalfWidths=new Float32Array(n.endFaceNormalAndHalfWidths),e._vertexBatchIds=new Uint16Array(n.vertexBatchIds);const i=n.indexDatatype;e._indices=i===h.A.UNSIGNED_SHORT?new Uint16Array(n.indices):new Uint32Array(n.indices),function(e,t){if(!(0,c.A)(e._va)){const n=e._startEllipsoidNormals,i=e._endEllipsoidNormals,o=e._startPositionAndHeights,r=e._endPositionAndHeights,s=e._startFaceNormalAndVertexCornerIds,c=e._endFaceNormalAndHalfWidths,l=e._vertexBatchIds,u=e._indices;let d=n.byteLength+i.byteLength;d+=o.byteLength+r.byteLength,d+=s.byteLength+c.byteLength,d+=l.byteLength+u.byteLength,e._trianglesLength=u.length/3,e._geometryByteLength=d;const A=g.A.createVertexBuffer({context:t,typedArray:n,usage:_.A.STATIC_DRAW}),p=g.A.createVertexBuffer({context:t,typedArray:i,usage:_.A.STATIC_DRAW}),f=g.A.createVertexBuffer({context:t,typedArray:o,usage:_.A.STATIC_DRAW}),m=g.A.createVertexBuffer({context:t,typedArray:r,usage:_.A.STATIC_DRAW}),y=g.A.createVertexBuffer({context:t,typedArray:s,usage:_.A.STATIC_DRAW}),v=g.A.createVertexBuffer({context:t,typedArray:c,usage:_.A.STATIC_DRAW}),T=g.A.createVertexBuffer({context:t,typedArray:l,usage:_.A.STATIC_DRAW}),b=g.A.createIndexBuffer({context:t,typedArray:u,usage:_.A.STATIC_DRAW,indexDatatype:2===u.BYTES_PER_ELEMENT?h.A.UNSIGNED_SHORT:h.A.UNSIGNED_INT}),w=[{index:U.startEllipsoidNormal,vertexBuffer:A,componentDatatype:a.A.FLOAT,componentsPerAttribute:3},{index:U.endEllipsoidNormal,vertexBuffer:p,componentDatatype:a.A.FLOAT,componentsPerAttribute:3},{index:U.startPositionAndHeight,vertexBuffer:f,componentDatatype:a.A.FLOAT,componentsPerAttribute:4},{index:U.endPositionAndHeight,vertexBuffer:m,componentDatatype:a.A.FLOAT,componentsPerAttribute:4},{index:U.startFaceNormalAndVertexCorner,vertexBuffer:y,componentDatatype:a.A.FLOAT,componentsPerAttribute:4},{index:U.endFaceNormalAndHalfWidth,vertexBuffer:v,componentDatatype:a.A.FLOAT,componentsPerAttribute:4},{index:U.a_batchId,vertexBuffer:T,componentDatatype:a.A.UNSIGNED_SHORT,componentsPerAttribute:1}];e._va=new x.A({context:t,attributes:w,indexBuffer:b}),e._positions=void 0,e._widths=void 0,e._counts=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._rectangle=void 0,e._transferrableBatchIds=void 0,e._packedBuffer=void 0,e._startEllipsoidNormals=void 0,e._endEllipsoidNormals=void 0,e._startPositionAndHeights=void 0,e._startFaceNormalAndVertexCornerIds=void 0,e._endPositionAndHeights=void 0,e._endFaceNormalAndHalfWidths=void 0,e._vertexBatchIds=void 0,e._indices=void 0}}(e,t),e._ready=!0}).catch(t=>{e.isDestroyed()||(e._error=t)}):void 0}(this,t))),(0,c.A)(this._error)){const e=this._error;throw this._error=void 0,e}return}var n,o;!function(e,t){(0,c.A)(e._uniformMap)||(e._uniformMap={u_modifiedModelView:function(){const n=t.uniformState.view;return p.A.clone(n,k),p.A.multiplyByPoint(k,e._center,V),p.A.setTranslation(k,V,k),k},u_highlightColor:function(){return e._highlightColor},u_minimumMaximumVectorHeights:function(){return e._minimumMaximumVectorHeights}})}(this,t),function(e,t){if((0,c.A)(e._sp))return;const n=e._batchTable,i=n.getVertexShaderCallback(!1,"a_batchId",void 0)(E.A),o=n.getFragmentShaderCallback(!1,void 0,!0)(S.A),r=new w.A({defines:["VECTOR_TILE",d.A.isInternetExplorer()?"":"CLIP_POLYLINE"],sources:[C.A,i]}),s=new w.A({defines:["VECTOR_TILE"],sources:[o]});e._sp=b.A.fromCache({context:t,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:U})}(this,t),o=this,(0,c.A)(o._rs)||(o._rs=z(!1),o._rs3DTiles=z(!0));const s=e.passes;(s.render||s.pick)&&function(e,t){let n=e._command;if(!(0,c.A)(e._command)){const t=e._batchTable.getUniformMapCallback()(e._uniformMap);n=e._command=new y.A({owner:e,vertexArray:e._va,renderState:e._rs,shaderProgram:e._sp,uniformMap:t,boundingVolume:e._boundingVolume,pass:v.A.TERRAIN_CLASSIFICATION,pickId:e._batchTable.getPickId()});const i=y.A.shallowClone(n,n.derivedCommands.tileset);i.renderState=e._rs3DTiles,i.pass=v.A.CESIUM_3D_TILE_CLASSIFICATION,n.derivedCommands.tileset=i}const i=e._classificationType;i!==D.A.TERRAIN&&i!==D.A.BOTH||t.commandList.push(n),i!==D.A.CESIUM_3D_TILE&&i!==D.A.BOTH||t.commandList.push(n.derivedCommands.tileset)}(this,e)},B.prototype.isDestroyed=function(){return!1},B.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),(0,l.A)(this)};const W=B},868897:(e,t,n)=>{"use strict";n.d(t,{A:()=>E});var i=n(267980),o=n(491446),r=n(677354),s=n(605971),a=n(610750),c=n(604752),l=n(571804),u=n(367817),d=n(584164),h=n(697422),A=n(123245),p=n(184483),f=n(468741),m=n(601165),g=n(566453),_=n(953681),y=n(308521),v=n(223460);function T(e,t,n,r,s){this._tileset=e,this._tile=t,this._resource=n,this._polygons=void 0,this._polylines=void 0,this._points=void 0,this._metadata=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,this._group=void 0,this._ready=!1,function(e,t,n){n=n??0;const r=new Uint8Array(t),s=new DataView(t);n+=b;const _=s.getUint32(n,!0);if(1!==_)throw new A.A(`Only Vector tile version 1 is supported.  Version ${_} is not.`);n+=b;const y=s.getUint32(n,!0);if(n+=b,0===y)return void(e._ready=!0);const T=s.getUint32(n,!0);if(n+=b,0===T)throw new A.A("Feature table must have a byte length greater than zero");const C=s.getUint32(n,!0);n+=b;const E=s.getUint32(n,!0);n+=b;const S=s.getUint32(n,!0);n+=b;const I=s.getUint32(n,!0);n+=b;const P=s.getUint32(n,!0);n+=b;const D=s.getUint32(n,!0);n+=b;const O=s.getUint32(n,!0);n+=b;const R=(0,c.A)(r,n,T);n+=T;const M=new Uint8Array(t,n,C);let L,N;n+=C,E>0&&(L=(0,c.A)(r,n,E),n+=E,S>0&&(N=new Uint8Array(t,n,S),N=new Uint8Array(N),n+=S));const B=R.POLYGONS_LENGTH??0,F=R.POLYLINES_LENGTH??0,U=R.POINTS_LENGTH??0,k=B+F+U,V=new p.A(e,k,L,N,function(e){return function(t,n){(0,o.A)(e._polygons)&&e._polygons.updateCommands(t,n)}}(e));if(e._batchTable=V,0===k)return;const z=new f.A(R,M),H=z.getGlobalProperty("REGION");if(!(0,o.A)(H))throw new A.A("Feature table global property: REGION must be defined");const G=h.A.unpack(H),W=H[4],Y=H[5],q=e._tile.computedTransform;let j=z.getGlobalProperty("RTC_CENTER",l.A.FLOAT,3);(0,o.A)(j)?(j=i.A.unpack(j),d.A.multiplyByPoint(q,j,j)):(j=h.A.center(G),j.height=u.A.lerp(W,Y,.5),j=a.A.WGS84.cartographicToCartesian(j));const Q=function(e,t){let n,i,r,s;const a=e.POLYGONS_LENGTH??0,c=e.POLYLINES_LENGTH??0,l=e.POINTS_LENGTH??0;if(a>0&&(0,o.A)(e.POLYGON_BATCH_IDS)){const i=t.byteOffset+e.POLYGON_BATCH_IDS.byteOffset;n=new Uint16Array(t.buffer,i,a)}if(c>0&&(0,o.A)(e.POLYLINE_BATCH_IDS)){const n=t.byteOffset+e.POLYLINE_BATCH_IDS.byteOffset;i=new Uint16Array(t.buffer,n,c)}if(l>0&&(0,o.A)(e.POINT_BATCH_IDS)){const n=t.byteOffset+e.POINT_BATCH_IDS.byteOffset;r=new Uint16Array(t.buffer,n,l)}const u=(0,o.A)(n)||(0,o.A)(i)||(0,o.A)(r),d=a>0&&!(0,o.A)(n)||c>0&&!(0,o.A)(i)||l>0&&!(0,o.A)(r);if(u&&d)throw new A.A("If one group of batch ids is defined, then all batch ids must be defined");if(!(0,o.A)(n)&&!(0,o.A)(i)&&!(0,o.A)(r)){let e=0;if(!(0,o.A)(n)&&a>0)for(n=new Uint16Array(a),s=0;s<a;++s)n[s]=e++;if(!(0,o.A)(i)&&c>0)for(i=new Uint16Array(c),s=0;s<c;++s)i[s]=e++;if(!(0,o.A)(r)&&l>0)for(r=new Uint16Array(l),s=0;s<l;++s)r[s]=e++}return{polygons:n,polylines:i,points:r}}(R,M);if(n+=(4-n%4)%4,B>0){z.featuresLength=B;const i=z.getPropertyArray("POLYGON_COUNTS",l.A.UNSIGNED_INT,1)??z.getPropertyArray("POLYGON_COUNT",l.A.UNSIGNED_INT,1);if(!(0,o.A)(i))throw new A.A("Feature table property: POLYGON_COUNTS must be defined when POLYGONS_LENGTH is greater than 0");const r=z.getPropertyArray("POLYGON_INDEX_COUNTS",l.A.UNSIGNED_INT,1)??z.getPropertyArray("POLYGON_INDEX_COUNT",l.A.UNSIGNED_INT,1);if(!(0,o.A)(r))throw new A.A("Feature table property: POLYGON_INDEX_COUNTS must be defined when POLYGONS_LENGTH is greater than 0");const s=i.reduce(function(e,t){return e+2*t},0),a=r.reduce(function(e,t){return e+t},0),c=new Uint32Array(t,n,a);n+=I;const u=new Uint16Array(t,n,s);let d,h;n+=P,(0,o.A)(R.POLYGON_MINIMUM_HEIGHTS)&&(0,o.A)(R.POLYGON_MAXIMUM_HEIGHTS)&&(d=z.getPropertyArray("POLYGON_MINIMUM_HEIGHTS",l.A.FLOAT,1),h=z.getPropertyArray("POLYGON_MAXIMUM_HEIGHTS",l.A.FLOAT,1)),e._polygons=new g.A({positions:u,counts:i,indexCounts:r,indices:c,minimumHeight:W,maximumHeight:Y,polygonMinimumHeights:d,polygonMaximumHeights:h,center:j,rectangle:G,boundingVolume:e.tile.boundingVolume.boundingVolume,batchTable:V,batchIds:Q.polygons,modelMatrix:q})}const X=e._tileset;if(F>0){z.featuresLength=F;const i=z.getPropertyArray("POLYLINE_COUNTS",l.A.UNSIGNED_INT,1)??z.getPropertyArray("POLYLINE_COUNT",l.A.UNSIGNED_INT,1);if(!(0,o.A)(i))throw new A.A("Feature table property: POLYLINE_COUNTS must be defined when POLYLINES_LENGTH is greater than 0");let r=z.getPropertyArray("POLYLINE_WIDTHS",l.A.UNSIGNED_SHORT,1);if(!(0,o.A)(r)){r=new Uint16Array(F);for(let e=0;e<F;++e)r[e]=2}const s=i.reduce(function(e,t){return e+3*t},0),c=new Uint16Array(t,n,s);n+=D;const u=X.examineVectorLinesFunction;(0,o.A)(u)&&function(e,t,n,i,o,r){const s=t.length;let a=0;for(let c=0;c<s;c++){const s=3*t[c],l=e.slice(a,a+s);a+=s,r(l,n[c],o,i)}}((0,v.A)(new Uint16Array(c),G,W,Y,a.A.WGS84),i,Q.polylines,V,e.url,u);let d=w;(0,o.A)(X.classificationType)&&(d=x),e._polylines=d({positions:c,widths:r,counts:i,batchIds:Q.polylines,minimumHeight:W,maximumHeight:Y,center:j,rectangle:G,boundingVolume:e.tile.boundingVolume.boundingVolume,batchTable:V,classificationType:X.classificationType,keepDecodedPositions:X.vectorKeepDecodedPositions})}if(U>0){const i=new Uint16Array(t,n,3*U);n+=O,e._points=new m.A({positions:i,batchIds:Q.points,minimumHeight:W,maximumHeight:Y,rectangle:G,batchTable:V,heightReference:X.heightReference,scene:X.scene})}}(this,r,s)}Object.defineProperties(T.prototype,{featuresLength:{get:function(){return(0,o.A)(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return(0,o.A)(this._points)?this._points.pointsLength:0}},trianglesLength:{get:function(){let e=0;return(0,o.A)(this._polygons)&&(e+=this._polygons.trianglesLength),(0,o.A)(this._polylines)&&(e+=this._polylines.trianglesLength),e}},geometryByteLength:{get:function(){let e=0;return(0,o.A)(this._polygons)&&(e+=this._polygons.geometryByteLength),(0,o.A)(this._polylines)&&(e+=this._polylines.geometryByteLength),e}},texturesByteLength:{get:function(){return(0,o.A)(this._points)?this._points.texturesByteLength:0}},batchTableByteLength:{get:function(){return(0,o.A)(this._batchTable)?this._batchTable.batchTableByteLength:0}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},batchTable:{get:function(){return this._batchTable}},group:{get:function(){return this._group},set:function(e){this._group=e}}});const b=Uint32Array.BYTES_PER_ELEMENT;function w(e){return new _.A(e)}function x(e){return new y.A(e)}function C(e){const t=e.featuresLength;if(!(0,o.A)(e._features)&&t>0){const n=new Array(t);(0,o.A)(e._polygons)&&e._polygons.createFeatures(e,n),(0,o.A)(e._polylines)&&e._polylines.createFeatures(e,n),(0,o.A)(e._points)&&e._points.createFeatures(e,n),e._features=n}}T.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},T.prototype.getFeature=function(e){const t=this.featuresLength;if(!(0,o.A)(e)||e<0||e>=t)throw new s.A(`batchId is required and between zero and featuresLength - 1 (${t-1}).`);return(0,o.A)(this._features)||C(this),this._features[e]},T.prototype.applyDebugSettings=function(e,t){(0,o.A)(this._polygons)&&this._polygons.applyDebugSettings(e,t),(0,o.A)(this._polylines)&&this._polylines.applyDebugSettings(e,t),(0,o.A)(this._points)&&this._points.applyDebugSettings(e,t)},T.prototype.applyStyle=function(e){(0,o.A)(this._features)||C(this),(0,o.A)(this._polygons)&&this._polygons.applyStyle(e,this._features),(0,o.A)(this._polylines)&&this._polylines.applyStyle(e,this._features),(0,o.A)(this._points)&&this._points.applyStyle(e,this._features)},T.prototype.update=function(e,t){let n=!0;(0,o.A)(this._polygons)&&(this._polygons.classificationType=this._tileset.classificationType,this._polygons.debugWireframe=this._tileset.debugWireframe,this._polygons.update(t),n=n&&this._polygons.ready),(0,o.A)(this._polylines)&&(this._polylines.update(t),n=n&&this._polylines.ready),(0,o.A)(this._points)&&(this._points.update(t),n=n&&this._points.ready),(0,o.A)(this._batchTable)&&n&&((0,o.A)(this._features)||C(this),this._batchTable.update(e,t),this._ready=!0)},T.prototype.pick=function(e,t,n){},T.prototype.getPolylinePositions=function(e){const t=this._polylines;if((0,o.A)(t))return t.getPositions(e)},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){return this._polygons=this._polygons&&this._polygons.destroy(),this._polylines=this._polylines&&this._polylines.destroy(),this._points=this._points&&this._points.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),(0,r.A)(this)};const E=T},301350:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var i=n(660662),o=n(267980),r=n(41476),s=n(491446),a=n(677354),c=n(584164),l=n(971724),u=n(71578),d=n(28940),h=n(471293);function A(e){this._boxes=e.boxes,this._boxBatchIds=e.boxBatchIds,this._cylinders=e.cylinders,this._cylinderBatchIds=e.cylinderBatchIds,this._ellipsoids=e.ellipsoids,this._ellipsoidBatchIds=e.ellipsoidBatchIds,this._spheres=e.spheres,this._sphereBatchIds=e.sphereBatchIds,this._modelMatrix=e.modelMatrix,this._batchTable=e.batchTable,this._boundingVolume=e.boundingVolume,this._center=e.center,(0,s.A)(this._center)||((0,s.A)(this._boundingVolume)?this._center=o.A.clone(this._boundingVolume.center):this._center=o.A.clone(o.A.ZERO)),this._boundingVolumes=void 0,this._batchedIndices=void 0,this._indices=void 0,this._indexOffsets=void 0,this._indexCounts=void 0,this._positions=void 0,this._vertexBatchIds=void 0,this._batchIds=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._ready=!1,this._promise=void 0,this._error=void 0,this._verticesPromise=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=u.A.BOTH}Object.defineProperties(A.prototype,{trianglesLength:{get:function(){return(0,s.A)(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return(0,s.A)(this._primitive)?this._primitive.geometryByteLength:0}},ready:{get:function(){return this._ready}}}),A.packedBoxLength=c.A.packedLength+o.A.packedLength,A.packedCylinderLength=c.A.packedLength+2,A.packedEllipsoidLength=c.A.packedLength+o.A.packedLength,A.packedSphereLength=o.A.packedLength+1;const p=new l.A("createVectorTileGeometries",5),f=new r.A;A.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)},A.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)},A.prototype.applyStyle=function(e,t){this._primitive.applyStyle(e,t)},A.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},A.prototype.update=function(e){if(this._ready)this._primitive.debugWireframe=this.debugWireframe,this._primitive.forceRebatch=this.forceRebatch,this._primitive.classificationType=this.classificationType,this._primitive.update(e);else if((0,s.A)(this._promise)||(this._promise=function(e){if(!(0,s.A)(e._primitive)&&!(0,s.A)(e._verticesPromise)){let t=e._boxes,n=e._boxBatchIds,a=e._cylinders,l=e._cylinderBatchIds,u=e._ellipsoids,A=e._ellipsoidBatchIds,m=e._spheres,g=e._sphereBatchIds,_=e._batchTableColors,y=e._packedBuffer;if(!(0,s.A)(_)){let i=0;(0,s.A)(e._boxes)&&(t=e._boxes=t.slice(),n=e._boxBatchIds=n.slice(),i+=n.length),(0,s.A)(e._cylinders)&&(a=e._cylinders=a.slice(),l=e._cylinderBatchIds=l.slice(),i+=l.length),(0,s.A)(e._ellipsoids)&&(u=e._ellipsoids=u.slice(),A=e._ellipsoidBatchIds=A.slice(),i+=A.length),(0,s.A)(e._spheres)&&(m=e._sphere=m.slice(),g=e._sphereBatchIds=g.slice(),i+=g.length),_=e._batchTableColors=new Uint32Array(i);const r=e._batchTable;for(let e=0;e<i;++e){const t=r.getColor(e,f);_[e]=t.toRgba()}y=e._packedBuffer=function(e){const t=new Float64Array(c.A.packedLength+o.A.packedLength);let n=0;return o.A.pack(e._center,t,n),n+=o.A.packedLength,c.A.pack(e._modelMatrix,t,n),t}(e)}const v=[];(0,s.A)(t)&&v.push(t.buffer,n.buffer),(0,s.A)(a)&&v.push(a.buffer,l.buffer),(0,s.A)(u)&&v.push(u.buffer,A.buffer),(0,s.A)(m)&&v.push(m.buffer,g.buffer),v.push(_.buffer,y.buffer);const T={boxes:(0,s.A)(t)?t.buffer:void 0,boxBatchIds:(0,s.A)(t)?n.buffer:void 0,cylinders:(0,s.A)(a)?a.buffer:void 0,cylinderBatchIds:(0,s.A)(a)?l.buffer:void 0,ellipsoids:(0,s.A)(u)?u.buffer:void 0,ellipsoidBatchIds:(0,s.A)(u)?A.buffer:void 0,spheres:(0,s.A)(m)?m.buffer:void 0,sphereBatchIds:(0,s.A)(m)?g.buffer:void 0,batchTableColors:_.buffer,packedBuffer:y.buffer},b=e._verticesPromise=p.scheduleTask(T,v);if(!(0,s.A)(b))return;return b.then(function(t){if(e.isDestroyed())return;const n=new Float64Array(t.packedBuffer),o=function(e,t){let n=0;const o=t[n++],s=t[n++],a=e._boundingVolumes=new Array(s);for(let e=0;e<s;++e)a[e]=i.A.unpack(t,n),n+=i.A.packedLength;const c=t[n++],l=e._batchedIndices=new Array(c);for(let e=0;e<c;++e){const i=r.A.unpack(t,n);n+=r.A.packedLength;const o=t[n++],s=t[n++],a=t[n++],c=new Array(a);for(let e=0;e<a;++e)c[e]=t[n++];l[e]=new d.A({color:i,offset:o,count:s,batchIds:c})}return o}(e,n);e._indices=2===o?new Uint16Array(t.indices):new Uint32Array(t.indices),e._indexOffsets=new Uint32Array(t.indexOffsets),e._indexCounts=new Uint32Array(t.indexCounts),e._positions=new Float32Array(t.positions),e._vertexBatchIds=new Uint16Array(t.vertexBatchIds),e._batchIds=new Uint16Array(t.batchIds),function(e){(0,s.A)(e._primitive)||(e._primitive=new h.A({batchTable:e._batchTable,positions:e._positions,batchIds:e._batchIds,vertexBatchIds:e._vertexBatchIds,indices:e._indices,indexOffsets:e._indexOffsets,indexCounts:e._indexCounts,batchedIndices:e._batchedIndices,boundingVolume:e._boundingVolume,boundingVolumes:e._boundingVolumes,center:e._center,pickObject:e._pickObject??e}),e._boxes=void 0,e._boxBatchIds=void 0,e._cylinders=void 0,e._cylinderBatchIds=void 0,e._ellipsoids=void 0,e._ellipsoidBatchIds=void 0,e._spheres=void 0,e._sphereBatchIds=void 0,e._center=void 0,e._modelMatrix=void 0,e._batchTable=void 0,e._boundingVolume=void 0,e._boundingVolumes=void 0,e._batchedIndices=void 0,e._indices=void 0,e._indexOffsets=void 0,e._indexCounts=void 0,e._positions=void 0,e._vertexBatchIds=void 0,e._batchIds=void 0,e._batchTableColors=void 0,e._packedBuffer=void 0,e._verticesPromise=void 0)}(e),e._ready=!0}).catch(t=>{e.isDestroyed()||(e._error=t)})}}(this)),(0,s.A)(this._error)){const e=this._error;throw this._error=void 0,e}},A.prototype.isDestroyed=function(){return!1},A.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),(0,a.A)(this)};const m=A},601165:(e,t,n)=>{"use strict";n.d(t,{A:()=>M});var i=n(434067),o=n(267980),r=n(41476),s=n(491446),a=n(677354),c=n(853331),l=n(610750),u=n(290176),d=n(697422),h=n(971724),A=n(770103),p=n(294023),f=n(337632),m=n(465674),g=n(15817),_=n(891674),y=n(742558),v=n(63316);function T(e){this._positions=e.positions,this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._rectangle=e.rectangle,this._minHeight=e.minimumHeight,this._maxHeight=e.maximumHeight,this._heightReference=e.heightReference,this._billboardCollection=new A.A({batchTable:e.batchTable,scene:e.scene}),this._labelCollection=new m.A({batchTable:e.batchTable,scene:e.scene}),this._polylineCollection=new _.A,this._polylineCollection._useHighlightColor=!0,this._packedBuffer=void 0,this._ready=!1,this._promise=void 0,this._error=void 0}Object.defineProperties(T.prototype,{ready:{get:function(){return this._ready}},pointsLength:{get:function(){return this._billboardCollection.length}},texturesByteLength:{get:function(){return this._billboardCollection.sizeInBytes+this._labelCollection.sizeInBytes}}});const b=new h.A("createVectorTilePoints",5),w=new o.A;T.prototype.createFeatures=function(e,t){const n=this._billboardCollection,i=this._labelCollection,o=this._polylineCollection,r=this._batchIds,s=r.length;for(let a=0;a<s;++a){const s=r[a],c=n.get(a),l=i.get(a),u=o.get(a);t[s]=new p.A(e,s,c,l,u)}},T.prototype.applyDebugSettings=function(e,t){e?(r.A.clone(t,this._billboardCollection._highlightColor),r.A.clone(t,this._labelCollection._highlightColor),r.A.clone(t,this._polylineCollection._highlightColor)):(r.A.clone(r.A.WHITE,this._billboardCollection._highlightColor),r.A.clone(r.A.WHITE,this._labelCollection._highlightColor),r.A.clone(r.A.WHITE,this._polylineCollection._highlightColor))};const x=new r.A,C=new r.A,E=new r.A,S=new r.A,I=new r.A,P=new r.A,D=new u.A,O=new u.A,R=new c.A;T.prototype.applyStyle=function(e,t){if(!(0,s.A)(e))return void function(e,t){const n=e._batchIds,o=n.length;for(let e=0;e<o;++e){const o=t[n[e]];o.show=!0,o.pointSize=p.A.defaultPointSize,o.color=p.A.defaultColor,o.pointOutlineColor=p.A.defaultPointOutlineColor,o.pointOutlineWidth=p.A.defaultPointOutlineWidth,o.labelColor=r.A.WHITE,o.labelOutlineColor=r.A.WHITE,o.labelOutlineWidth=1,o.font="30px sans-serif",o.labelStyle=g.A.FILL,o.labelText=void 0,o.backgroundColor=new r.A(.165,.165,.165,.8),o.backgroundPadding=new i.A(7,5),o.backgroundEnabled=!1,o.scaleByDistance=void 0,o.translucencyByDistance=void 0,o.distanceDisplayCondition=void 0,o.heightOffset=0,o.anchorLineEnabled=!1,o.anchorLineColor=r.A.WHITE,o.image=void 0,o.disableDepthTestDistance=0,o.horizontalOrigin=f.A.CENTER,o.verticalOrigin=y.A.CENTER,o.labelHorizontalOrigin=f.A.RIGHT,o.labelVerticalOrigin=y.A.BASELINE}}(this,t);const n=this._batchIds,o=n.length;for(let i=0;i<o;++i){const o=t[n[i]];if((0,s.A)(e.show)&&(o.show=e.show.evaluate(o)),(0,s.A)(e.pointSize)&&(o.pointSize=e.pointSize.evaluate(o)),(0,s.A)(e.color)&&(o.color=e.color.evaluateColor(o,x)),(0,s.A)(e.pointOutlineColor)&&(o.pointOutlineColor=e.pointOutlineColor.evaluateColor(o,C)),(0,s.A)(e.pointOutlineWidth)&&(o.pointOutlineWidth=e.pointOutlineWidth.evaluate(o)),(0,s.A)(e.labelColor)&&(o.labelColor=e.labelColor.evaluateColor(o,E)),(0,s.A)(e.labelOutlineColor)&&(o.labelOutlineColor=e.labelOutlineColor.evaluateColor(o,S)),(0,s.A)(e.labelOutlineWidth)&&(o.labelOutlineWidth=e.labelOutlineWidth.evaluate(o)),(0,s.A)(e.font)&&(o.font=e.font.evaluate(o)),(0,s.A)(e.labelStyle)&&(o.labelStyle=e.labelStyle.evaluate(o)),(0,s.A)(e.labelText)?o.labelText=e.labelText.evaluate(o):o.labelText=void 0,(0,s.A)(e.backgroundColor)&&(o.backgroundColor=e.backgroundColor.evaluateColor(o,I)),(0,s.A)(e.backgroundPadding)&&(o.backgroundPadding=e.backgroundPadding.evaluate(o)),(0,s.A)(e.backgroundEnabled)&&(o.backgroundEnabled=e.backgroundEnabled.evaluate(o)),(0,s.A)(e.scaleByDistance)){const t=e.scaleByDistance.evaluate(o);(0,s.A)(t)?(D.near=t.x,D.nearValue=t.y,D.far=t.z,D.farValue=t.w,o.scaleByDistance=D):o.scaleByDistance=void 0}else o.scaleByDistance=void 0;if((0,s.A)(e.translucencyByDistance)){const t=e.translucencyByDistance.evaluate(o);(0,s.A)(t)?(O.near=t.x,O.nearValue=t.y,O.far=t.z,O.farValue=t.w,o.translucencyByDistance=O):o.translucencyByDistance=void 0}else o.translucencyByDistance=void 0;if((0,s.A)(e.distanceDisplayCondition)){const t=e.distanceDisplayCondition.evaluate(o);(0,s.A)(t)?(R.near=t.x,R.far=t.y,o.distanceDisplayCondition=R):o.distanceDisplayCondition=void 0}else o.distanceDisplayCondition=void 0;(0,s.A)(e.heightOffset)&&(o.heightOffset=e.heightOffset.evaluate(o)),(0,s.A)(e.anchorLineEnabled)&&(o.anchorLineEnabled=e.anchorLineEnabled.evaluate(o)),(0,s.A)(e.anchorLineColor)&&(o.anchorLineColor=e.anchorLineColor.evaluateColor(o,P)),(0,s.A)(e.image)?o.image=e.image.evaluate(o):o.image=void 0,(0,s.A)(e.disableDepthTestDistance)&&(o.disableDepthTestDistance=e.disableDepthTestDistance.evaluate(o)),(0,s.A)(e.horizontalOrigin)&&(o.horizontalOrigin=e.horizontalOrigin.evaluate(o)),(0,s.A)(e.verticalOrigin)&&(o.verticalOrigin=e.verticalOrigin.evaluate(o)),(0,s.A)(e.labelHorizontalOrigin)&&(o.labelHorizontalOrigin=e.labelHorizontalOrigin.evaluate(o)),(0,s.A)(e.labelVerticalOrigin)&&(o.labelVerticalOrigin=e.labelVerticalOrigin.evaluate(o))}},T.prototype.update=function(e){if(!this._ready&&((0,s.A)(this._promise)||(this._promise=function(e,t){let n=e._positions,i=e._packedBuffer;(0,s.A)(i)||(n=e._positions=n.slice(),e._batchIds=e._batchIds.slice(),i=e._packedBuffer=function(e,t){const n=e._rectangle,i=e._minHeight,o=e._maxHeight,r=2+d.A.packedLength+l.A.packedLength,s=new Float64Array(r);let a=0;return s[a++]=i,s[a++]=o,d.A.pack(n,s,a),a+=d.A.packedLength,l.A.pack(t,s,a),s}(e,t));const r=[n.buffer,i.buffer],a={positions:n.buffer,packedBuffer:i.buffer},c=b.scheduleTask(a,r);if((0,s.A)(c))return c.then(t=>{if(e.isDestroyed())return;e._positions=new Float64Array(t.positions);const i=e._billboardCollection,r=e._labelCollection,s=e._polylineCollection;n=e._positions;const a=e._batchIds,c=n.length/3,l=e._heightReference??v.Ay.NONE;for(let e=0;e<c;++e){const t=a[e],c=o.A.unpack(n,3*e,w),u=i.add();u.position=c,u._batchIndex=t,u.heightReference=l;const d=r.add();d.text=" ",d.position=c,d._batchIndex=t,d.heightReference=l,s.add().positions=[o.A.clone(c),o.A.clone(c)]}e._positions=void 0,e._packedBuffer=void 0,e._ready=!0}).catch(t=>{e.isDestroyed()||(e._error=t)})}(this,e.mapProjection.ellipsoid)),(0,s.A)(this._error))){const e=this._error;throw this._error=void 0,e}this._polylineCollection.update(e),this._billboardCollection.update(e),this._labelCollection.update(e)},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._polylineCollection=this._polylineCollection&&this._polylineCollection.destroy(),(0,a.A)(this)};const M=T},566453:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var i=n(267980),o=n(41476),r=n(491446),s=n(677354),a=n(610750),c=n(874915),l=n(832698),u=n(697422),d=n(971724),h=n(71578),A=n(28940),p=n(471293);function f(e){this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._counts=e.counts,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._batchedPositions=void 0,this._transferrableBatchIds=void 0,this._vertexBatchIds=void 0,this._ellipsoid=e.ellipsoid??a.A.WGS84,this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._polygonMinimumHeights=e.polygonMinimumHeights,this._polygonMaximumHeights=e.polygonMaximumHeights,this._center=e.center??i.A.ZERO,this._rectangle=e.rectangle,this._center=void 0,this._boundingVolume=e.boundingVolume,this._boundingVolumes=void 0,this._batchedIndices=void 0,this._ready=!1,this._promise=void 0,this._error=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=h.A.BOTH}Object.defineProperties(f.prototype,{trianglesLength:{get:function(){return(0,r.A)(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return(0,r.A)(this._primitive)?this._primitive.geometryByteLength:0}},ready:{get:function(){return this._ready}}});const m=new d.A("createVectorTilePolygons",5),g=new o.A;f.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)},f.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)},f.prototype.applyStyle=function(e,t){this._primitive.applyStyle(e,t)},f.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},f.prototype.update=function(e){if(this._ready)this._primitive.debugWireframe=this.debugWireframe,this._primitive.forceRebatch=this.forceRebatch,this._primitive.classificationType=this.classificationType,this._primitive.update(e);else if((0,r.A)(this._promise)||(this._promise=function(e){if((0,r.A)(e._primitive))return;let t=e._positions,n=e._counts,s=e._indexCounts,d=e._indices,h=e._transferrableBatchIds,f=e._batchTableColors,_=e._packedBuffer;if(!(0,r.A)(f)){t=e._positions=e._positions.slice(),n=e._counts=e._counts.slice(),s=e._indexCounts=e._indexCounts.slice(),d=e._indices=e._indices.slice(),e._center=e._ellipsoid.cartographicToCartesian(u.A.center(e._rectangle)),h=e._transferrableBatchIds=new Uint32Array(e._batchIds),f=e._batchTableColors=new Uint32Array(h.length);const o=e._batchTable,r=f.length;for(let e=0;e<r;++e){const t=o.getColor(e,g);f[e]=t.toRgba()}_=e._packedBuffer=function(e){const t=new Float64Array(3+i.A.packedLength+a.A.packedLength+u.A.packedLength);let n=0;return t[n++]=e._indices.BYTES_PER_ELEMENT,t[n++]=e._minimumHeight,t[n++]=e._maximumHeight,i.A.pack(e._center,t,n),n+=i.A.packedLength,a.A.pack(e._ellipsoid,t,n),n+=a.A.packedLength,u.A.pack(e._rectangle,t,n),t}(e)}const y=[t.buffer,n.buffer,s.buffer,d.buffer,h.buffer,f.buffer,_.buffer],v={packedBuffer:_.buffer,positions:t.buffer,counts:n.buffer,indexCounts:s.buffer,indices:d.buffer,batchIds:h.buffer,batchTableColors:f.buffer};let T=e._polygonMinimumHeights,b=e._polygonMaximumHeights;(0,r.A)(T)&&(0,r.A)(b)&&(T=T.slice(),b=b.slice(),y.push(T.buffer,b.buffer),v.minimumHeights=T,v.maximumHeights=b);const w=m.scheduleTask(v,y);return(0,r.A)(w)?w.then(t=>{if(e.isDestroyed())return;e._positions=void 0,e._counts=void 0,e._polygonMinimumHeights=void 0,e._polygonMaximumHeights=void 0;const n=new Float64Array(t.packedBuffer),i=n[0];!function(e,t){let n=1;const i=t[n++],r=e._boundingVolumes=new Array(i);for(let e=0;e<i;++e)r[e]=l.A.unpack(t,n),n+=l.A.packedLength;const s=t[n++],a=e._batchedIndices=new Array(s);for(let e=0;e<s;++e){const i=o.A.unpack(t,n);n+=o.A.packedLength;const r=t[n++],s=t[n++],c=t[n++],l=new Array(c);for(let e=0;e<c;++e)l[e]=t[n++];a[e]=new A.A({color:i,offset:r,count:s,batchIds:l})}}(e,n),e._indices=2===c.A.getSizeInBytes(i)?new Uint16Array(t.indices):new Uint32Array(t.indices),e._indexOffsets=new Uint32Array(t.indexOffsets),e._indexCounts=new Uint32Array(t.indexCounts),e._batchedPositions=new Float32Array(t.positions),e._vertexBatchIds=new Uint16Array(t.batchIds),function(e){(0,r.A)(e._primitive)||(e._primitive=new p.A({batchTable:e._batchTable,positions:e._batchedPositions,batchIds:e._batchIds,vertexBatchIds:e._vertexBatchIds,indices:e._indices,indexOffsets:e._indexOffsets,indexCounts:e._indexCounts,batchedIndices:e._batchedIndices,boundingVolume:e._boundingVolume,boundingVolumes:e._boundingVolumes,center:e._center}),e._batchTable=void 0,e._batchIds=void 0,e._positions=void 0,e._counts=void 0,e._indices=void 0,e._indexCounts=void 0,e._indexOffsets=void 0,e._batchTableColors=void 0,e._packedBuffer=void 0,e._batchedPositions=void 0,e._transferrableBatchIds=void 0,e._vertexBatchIds=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._polygonMinimumHeights=void 0,e._polygonMaximumHeights=void 0,e._center=void 0,e._rectangle=void 0,e._boundingVolume=void 0,e._boundingVolumes=void 0,e._batchedIndices=void 0)}(e),e._ready=!0}).catch(t=>{e.isDestroyed()||(e._error=t)}):void 0}(this)),(0,r.A)(this._error)){const e=this._error;throw this._error=void 0,e}},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),(0,s.A)(this)};const _=f},953681:(e,t,n)=>{"use strict";n.d(t,{A:()=>M});var i=n(267980),o=n(41476),r=n(571804),s=n(491446),a=n(677354),c=n(610750),l=n(520098),u=n(874915),d=n(584164),h=n(697422),A=n(971724),p=n(641613),f=n(442790),m=n(377496),g=n(760866),_=n(40118),y=n(302836),v=n(342875),T=n(508380),b=n(78149),w=n(747776),x=n(200646),C=n(622569);function E(e){this._positions=e.positions,this._widths=e.widths,this._counts=e.counts,this._batchIds=e.batchIds,this._ellipsoid=e.ellipsoid??c.A.WGS84,this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._center=e.center,this._rectangle=e.rectangle,this._boundingVolume=e.boundingVolume,this._batchTable=e.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._keepDecodedPositions=e.keepDecodedPositions,this._decodedPositions=void 0,this._decodedPositionOffsets=void 0,this._currentPositions=void 0,this._previousPositions=void 0,this._nextPositions=void 0,this._expandAndWidth=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=o.A.clone(o.A.WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._promise=void 0,this._error=void 0}Object.defineProperties(E.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}}});const S=new A.A("createVectorTilePolylines",5),I={previousPosition:0,currentPosition:1,nextPosition:2,expandAndWidth:3,a_batchId:4};const P=new d.A,D=new i.A;E.getPolylinePositions=function(e,t){const n=e._batchIds,i=e._decodedPositions,o=e._decodedPositionOffsets;if(!(0,s.A)(n)||!(0,s.A)(i))return;let r,a;const c=n.length;let l=0,u=0;for(r=0;r<c;++r)n[r]===t&&(l+=o[r+1]-o[r]);if(0===l)return;const d=new Float64Array(3*l);for(r=0;r<c;++r)if(n[r]===t){const e=o[r],t=o[r+1]-e;for(a=0;a<t;++a){const t=3*(e+a);d[u++]=i[t],d[u++]=i[t+1],d[u++]=i[t+2]}}return d},E.prototype.getPositions=function(e){return E.getPolylinePositions(this,e)},E.prototype.createFeatures=function(e,t){const n=this._batchIds,i=n.length;for(let o=0;o<i;++o){const i=n[o];t[i]=new C.A(e,i)}},E.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};const O=new o.A,R=o.A.WHITE;E.prototype.applyStyle=function(e,t){if(!(0,s.A)(e))return void function(e,t){const n=e._batchIds,i=n.length;for(let e=0;e<i;++e){const i=t[n[e]];i.show=!0,i.color=o.A.WHITE}}(this,t);const n=this._batchIds,i=n.length;for(let o=0;o<i;++o){const i=t[n[o]];i.color=(0,s.A)(e.color)?e.color.evaluateColor(i,O):R,i.show=!(0,s.A)(e.show)||e.show.evaluate(i)}},E.prototype.update=function(e){const t=e.context;if(!this._ready){if((0,s.A)(this._promise)||(this._promise=function(e,t){if((0,s.A)(e._va))return;let n=e._positions,o=e._widths,a=e._counts,l=e._transferrableBatchIds,d=e._packedBuffer;(0,s.A)(d)||(n=e._positions=n.slice(),o=e._widths=o.slice(),a=e._counts=a.slice(),l=e._transferrableBatchIds=e._batchIds.slice(),d=e._packedBuffer=function(e){const t=e._rectangle,n=e._minimumHeight,o=e._maximumHeight,r=e._ellipsoid,s=e._center,a=2+h.A.packedLength+c.A.packedLength+i.A.packedLength,l=new Float64Array(a);let u=0;return l[u++]=n,l[u++]=o,h.A.pack(t,l,u),u+=h.A.packedLength,c.A.pack(r,l,u),u+=c.A.packedLength,i.A.pack(s,l,u),l}(e));const A=[n.buffer,o.buffer,a.buffer,l.buffer,d.buffer],m={positions:n.buffer,widths:o.buffer,counts:a.buffer,batchIds:l.buffer,packedBuffer:d.buffer,keepDecodedPositions:e._keepDecodedPositions},g=S.scheduleTask(m,A);return(0,s.A)(g)?g.then(function(n){if(e.isDestroyed())return;e._keepDecodedPositions&&(e._decodedPositions=new Float64Array(n.decodedPositions),e._decodedPositionOffsets=new Uint32Array(n.decodedPositionOffsets)),e._currentPositions=new Float32Array(n.currentPositions),e._previousPositions=new Float32Array(n.previousPositions),e._nextPositions=new Float32Array(n.nextPositions),e._expandAndWidth=new Float32Array(n.expandAndWidth),e._vertexBatchIds=new Uint16Array(n.batchIds);const i=n.indexDatatype;e._indices=i===u.A.UNSIGNED_SHORT?new Uint16Array(n.indices):new Uint32Array(n.indices),function(e,t){if(!(0,s.A)(e._va)){const n=e._currentPositions,i=e._previousPositions,o=e._nextPositions,s=e._expandAndWidth,a=e._vertexBatchIds,c=e._indices;let l=i.byteLength+n.byteLength+o.byteLength;l+=s.byteLength+a.byteLength+c.byteLength,e._trianglesLength=c.length/3,e._geometryByteLength=l;const d=p.A.createVertexBuffer({context:t,typedArray:i,usage:f.A.STATIC_DRAW}),h=p.A.createVertexBuffer({context:t,typedArray:n,usage:f.A.STATIC_DRAW}),A=p.A.createVertexBuffer({context:t,typedArray:o,usage:f.A.STATIC_DRAW}),m=p.A.createVertexBuffer({context:t,typedArray:s,usage:f.A.STATIC_DRAW}),g=p.A.createVertexBuffer({context:t,typedArray:a,usage:f.A.STATIC_DRAW}),_=p.A.createIndexBuffer({context:t,typedArray:c,usage:f.A.STATIC_DRAW,indexDatatype:2===c.BYTES_PER_ELEMENT?u.A.UNSIGNED_SHORT:u.A.UNSIGNED_INT}),y=[{index:I.previousPosition,vertexBuffer:d,componentDatatype:r.A.FLOAT,componentsPerAttribute:3},{index:I.currentPosition,vertexBuffer:h,componentDatatype:r.A.FLOAT,componentsPerAttribute:3},{index:I.nextPosition,vertexBuffer:A,componentDatatype:r.A.FLOAT,componentsPerAttribute:3},{index:I.expandAndWidth,vertexBuffer:m,componentDatatype:r.A.FLOAT,componentsPerAttribute:2},{index:I.a_batchId,vertexBuffer:g,componentDatatype:r.A.UNSIGNED_SHORT,componentsPerAttribute:1}];e._va=new T.A({context:t,attributes:y,indexBuffer:_}),e._positions=void 0,e._widths=void 0,e._counts=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._rectangle=void 0,e._transferrableBatchIds=void 0,e._packedBuffer=void 0,e._currentPositions=void 0,e._previousPositions=void 0,e._nextPositions=void 0,e._expandAndWidth=void 0,e._vertexBatchIds=void 0,e._indices=void 0}}(e,t),e._ready=!0}).catch(t=>{e.isDestroyed()||(e._error=t)}):void 0}(this,t)),(0,s.A)(this._error)){const e=this._error;throw this._error=void 0,e}return}var n;!function(e,t){(0,s.A)(e._uniformMap)||(e._uniformMap={u_modifiedModelView:function(){const n=t.uniformState.view;return d.A.clone(n,P),d.A.multiplyByPoint(P,e._center,D),d.A.setTranslation(P,D,P),P},u_highlightColor:function(){return e._highlightColor}})}(this,t),function(e,t){if((0,s.A)(e._sp))return;const n=e._batchTable,i=n.getVertexShaderCallback(!1,"a_batchId",void 0)(w.A),o=n.getFragmentShaderCallback(!1,void 0,!1)("uniform vec4 u_highlightColor; \nvoid main()\n{\n    out_FragColor = u_highlightColor;\n}\n"),r=new v.A({defines:["VECTOR_TILE",l.A.isInternetExplorer()?"":"CLIP_POLYLINE"],sources:[b.A,i]}),a=new v.A({defines:["VECTOR_TILE"],sources:[o]});e._sp=y.A.fromCache({context:t,vertexShaderSource:r,fragmentShaderSource:a,attributeLocations:I})}(this,t),n=this,(0,s.A)(n._rs)||(n._rs=_.A.fromCache({blending:x.A.ALPHA_BLEND,depthMask:!1,depthTest:{enabled:!0},polygonOffset:{enabled:!0,factor:-5,units:-5}}));const o=e.passes;(o.render||o.pick)&&function(e,t){if(!(0,s.A)(e._command)){const t=e._batchTable.getUniformMapCallback()(e._uniformMap);e._command=new m.A({owner:e,vertexArray:e._va,renderState:e._rs,shaderProgram:e._sp,uniformMap:t,boundingVolume:e._boundingVolume,pass:g.A.TRANSLUCENT,pickId:e._batchTable.getPickId()})}t.commandList.push(e._command)}(this,e)},E.prototype.isDestroyed=function(){return!1},E.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),(0,a.A)(this)};const M=E},471293:(e,t,n)=>{"use strict";n.d(t,{A:()=>Y});var i=n(267980),o=n(41476),r=n(571804),s=n(915325),a=n(491446),c=n(677354),l=n(874915),u=n(584164),d=n(402330),h=n(641613),A=n(442790),p=n(377496),f=n(760866),m=n(40118),g=n(302836),_=n(342875),y=n(508380),v=n(488961),T=n(971532),b=n(200646),w=n(622569),x=n(71578),C=n(523721),E=n(168064),S=n(938987),I=n(896464),P=n(138151),D=n(28940);function O(e){e=e??s.A.EMPTY_OBJECT,this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._vertexBatchIds=e.vertexBatchIds,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=e.indexOffsets,this._batchedIndices=e.batchedIndices,this._boundingVolume=e.boundingVolume,this._boundingVolumes=e.boundingVolumes,this._center=e.center??i.A.ZERO,this._va=void 0,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._uniformMap=void 0,this._vaSwap=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._rsWireframe=void 0,this._commands=[],this._commandsIgnoreShow=[],this._pickCommands=[],this._constantColor=o.A.clone(o.A.WHITE),this._highlightColor=this._constantColor,this._batchDirty=!0,this._pickCommandsDirty=!0,this._framesSinceLastRebatch=0,this._updatingAllCommands=!1,this._trianglesLength=this._indices.length/3,this._geometryByteLength=this._indices.byteLength+this._positions.byteLength+this._vertexBatchIds.byteLength,this.debugWireframe=!1,this._debugWireframe=this.debugWireframe,this._wireframeDirty=!1,this.forceRebatch=!1,this.classificationType=e.classificationType??x.A.BOTH,this._vertexShaderSource=e._vertexShaderSource,this._fragmentShaderSource=e._fragmentShaderSource,this._attributeLocations=e._attributeLocations,this._uniformMap=e._uniformMap,this._pickId=e._pickId,this._modelMatrix=e._modelMatrix,this._boundingSphere=e._boundingSphere,this._batchIdLookUp={};const t=this._batchIds.length;for(let e=0;e<t;++e){const t=this._batchIds[e];this._batchIdLookUp[t]=e}}Object.defineProperties(O.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}}});const R={position:0,a_batchId:1};function M(e){const t=e?I.A.EQUAL:I.A.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:t,frontOperation:{fail:P.A.KEEP,zFail:P.A.DECREMENT_WRAP,zPass:P.A.KEEP},backFunction:t,backOperation:{fail:P.A.KEEP,zFail:P.A.INCREMENT_WRAP,zPass:P.A.KEEP},reference:S.A.CESIUM_3D_TILE_MASK,mask:S.A.CESIUM_3D_TILE_MASK},stencilMask:S.A.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:C.A.LESS_OR_EQUAL},depthMask:!1}}const L={stencilTest:{enabled:!0,frontFunction:I.A.NOT_EQUAL,frontOperation:{fail:P.A.ZERO,zFail:P.A.ZERO,zPass:P.A.ZERO},backFunction:I.A.NOT_EQUAL,backOperation:{fail:P.A.ZERO,zFail:P.A.ZERO,zPass:P.A.ZERO},reference:0,mask:S.A.CLASSIFICATION_MASK},stencilMask:S.A.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:b.A.PRE_MULTIPLIED_ALPHA_BLEND},N={stencilTest:{enabled:!0,frontFunction:I.A.NOT_EQUAL,frontOperation:{fail:P.A.ZERO,zFail:P.A.ZERO,zPass:P.A.ZERO},backFunction:I.A.NOT_EQUAL,backOperation:{fail:P.A.ZERO,zFail:P.A.ZERO,zPass:P.A.ZERO},reference:0,mask:S.A.CLASSIFICATION_MASK},stencilMask:S.A.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1},B=new u.A,F=new i.A;function U(e,t,n,i,o,r,s){const a=e.constructor.BYTES_PER_ELEMENT,c=r.length;for(let l=0;l<c;++l){const c=s[r[l]],u=i[c],d=o[c],h=new e.constructor(e.buffer,a*u,d);t.set(h,n),i[c]=n,n+=d}return n}function k(e,t,n,i,o,r,s){const a=e.bytesPerIndex,c=r.length;for(let l=0;l<c;++l){const c=s[r[l]],u=i[c],d=o[c];t.copyFromBuffer(e,u*a,n*a,d*a),i[c]=n,n+=d}return n}function V(e,t){return t.color.toRgba()-e.color.toRgba()}O.prototype.createFeatures=function(e,t){const n=this._batchIds,i=n.length;for(let o=0;o<i;++o){const i=n[o];t[i]=new w.A(e,i)}},O.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};const z=new o.A,H=o.A.WHITE,G=/\$/;function W(e,t,n,i){const o=e.classificationType,r=o!==x.A.CESIUM_3D_TILE,s=o!==x.A.TERRAIN,c=t.commandList;let l,u,d=n.length;for(u=0;u<d;++u)r&&(l=n[u],l.pass=f.A.TERRAIN_CLASSIFICATION,c.push(l)),s&&(l=n[u].derivedCommands.tileset,l.pass=f.A.CESIUM_3D_TILE_CLASSIFICATION,c.push(l));if(t.invertClassification&&(0,a.A)(i))for(d=i.length,u=0;u<d;++u)c.push(i[u])}O.prototype.applyStyle=function(e,t){if(!(0,a.A)(e))return void function(e,t){e._updatingAllCommands=!0;const n=e._batchIds;let i,r=n.length;for(i=0;i<r;++i){const e=t[n[i]];e.show=!0,e.color=o.A.WHITE}const s=e._batchedIndices;for(r=s.length,i=0;i<r;++i)s[i].color=o.A.clone(o.A.WHITE);e._updatingAllCommands=!1,e._batchDirty=!0}(this,t);const n=e.color,i=n instanceof E.A&&!G.test(n.expression);this._updatingAllCommands=i;const r=this._batchIds;let s,c=r.length;for(s=0;s<c;++s){const n=t[r[s]];n.color=(0,a.A)(e.color)?e.color.evaluateColor(n,z):H,n.show=!(0,a.A)(e.show)||e.show.evaluate(n)}if(i){const e=this._batchedIndices;for(c=e.length,s=0;s<c;++s)e[s].color=o.A.clone(o.A.WHITE);this._updatingAllCommands=!1,this._batchDirty=!0}},O.prototype.updateCommands=function(e,t){if(this._updatingAllCommands)return;const n=this._batchIdLookUp,i=n[e];if(!(0,a.A)(i))return;const r=this._indexOffsets,s=this._indexCounts,c=r[i],l=s[i],u=this._batchedIndices,d=u.length;let h;for(h=0;h<d;++h){const e=u[h].offset,t=u[h].count;if(c>=e&&c<e+t)break}u.push(new D.A({color:o.A.clone(t),offset:c,count:l,batchIds:[e]}));const A=[],p=[],f=u[h].batchIds,m=f.length;for(let t=0;t<m;++t){const i=f[t];i!==e&&(r[n[i]]<c?A.push(i):p.push(i))}0!==p.length&&u.push(new D.A({color:o.A.clone(u[h].color),offset:c+l,count:u[h].offset+u[h].count-(c+l),batchIds:p})),0!==A.length?(u[h].count=c-u[h].offset,u[h].batchIds=A):u.splice(h,1),this._batchDirty=!0},O.prototype.update=function(e){const t=e.context;var n;!function(e,t){if((0,a.A)(e._va))return;const n=h.A.createVertexBuffer({context:t,typedArray:e._positions,usage:A.A.STATIC_DRAW}),i=h.A.createVertexBuffer({context:t,typedArray:e._vertexBatchIds,usage:A.A.STATIC_DRAW}),o=h.A.createIndexBuffer({context:t,typedArray:e._indices,usage:A.A.DYNAMIC_DRAW,indexDatatype:2===e._indices.BYTES_PER_ELEMENT?l.A.UNSIGNED_SHORT:l.A.UNSIGNED_INT}),s=[{index:0,vertexBuffer:n,componentDatatype:r.A.fromTypedArray(e._positions),componentsPerAttribute:3},{index:1,vertexBuffer:i,componentDatatype:r.A.fromTypedArray(e._vertexBatchIds),componentsPerAttribute:1}];e._va=new y.A({context:t,attributes:s,indexBuffer:o}),t.webgl2&&(e._vaSwap=new y.A({context:t,attributes:s,indexBuffer:h.A.createIndexBuffer({context:t,sizeInBytes:o.sizeInBytes,usage:A.A.DYNAMIC_DRAW,indexDatatype:o.indexDatatype})})),e._batchedPositions=void 0,e._transferrableBatchIds=void 0,e._vertexBatchIds=void 0}(this,t),function(e,t){if((0,a.A)(e._sp))return;const n=e._batchTable,i=e._attributeLocations??R;let o=e._pickId;const r=e._vertexShaderSource;let s=e._fragmentShaderSource;if((0,a.A)(r))return e._sp=g.A.fromCache({context:t,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:i}),e._spStencil=e._sp,s=_.A.replaceMain(s,"czm_non_pick_main"),s=`${s}void main() \n{ \n    czm_non_pick_main(); \n    out_FragColor = ${o}; \n} \n`,void(e._spPick=g.A.fromCache({context:t,vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:i}));const c=n.getVertexShaderCallback(!1,"a_batchId",void 0)(T.A);let l=n.getFragmentShaderCallback(!1,void 0,!0)(v.A);o=n.getPickId();let u=new _.A({sources:[c]}),d=new _.A({defines:["VECTOR_TILE"],sources:[l]});e._sp=g.A.fromCache({context:t,vertexShaderSource:u,fragmentShaderSource:d,attributeLocations:i}),u=new _.A({sources:[T.A]}),d=new _.A({defines:["VECTOR_TILE"],sources:[v.A]}),e._spStencil=g.A.fromCache({context:t,vertexShaderSource:u,fragmentShaderSource:d,attributeLocations:i}),l=_.A.replaceMain(l,"czm_non_pick_main"),l=`${l}\nvoid main() \n{ \n    czm_non_pick_main(); \n    out_FragColor = ${o}; \n} \n`;const h=new _.A({sources:[c]}),A=new _.A({defines:["VECTOR_TILE"],sources:[l]});e._spPick=g.A.fromCache({context:t,vertexShaderSource:h,fragmentShaderSource:A,attributeLocations:i})}(this,t),n=this,(0,a.A)(n._rsStencilDepthPass)||(n._rsStencilDepthPass=m.A.fromCache(M(!1)),n._rsStencilDepthPass3DTiles=m.A.fromCache(M(!0)),n._rsColorPass=m.A.fromCache(L),n._rsPickPass=m.A.fromCache(N)),function(e,t){if((0,a.A)(e._uniformMap))return;const n={u_modifiedModelViewProjection:function(){const n=t.uniformState.view,i=t.uniformState.projection;return u.A.clone(n,B),u.A.multiplyByPoint(B,e._center,F),u.A.setTranslation(B,F,B),u.A.multiply(i,B,B),B},u_highlightColor:function(){return e._highlightColor}};e._uniformMap=e._batchTable.getUniformMapCallback()(n)}(this,t);const i=e.passes;i.render&&(function(e,t){const n=function(e,t){if(!e._batchDirty)return!1;const n=e._batchedIndices,i=n.length;let r=!1;const s={};for(let e=0;e<i;++e){const t=n[e].color.toRgba();if((0,a.A)(s[t])){r=!0;break}s[t]=!0}return r?r&&!e.forceRebatch&&e._framesSinceLastRebatch<120?void++e._framesSinceLastRebatch:(n.sort(V),t.webgl2?function(e,t){const n=e._indexOffsets,i=e._indexCounts,r=e._batchIdLookUp;let s=t.pop();const a=[s],c=e._va.indexBuffer,l=e._vaSwap.indexBuffer;let u=k(c,l,0,n,i,s.batchIds,r);for(s.offset=0,s.count=u;t.length>0;){const e=t.pop();if(o.A.equals(e.color,s.color))u=k(c,l,u,n,i,e.batchIds,r),s.batchIds=s.batchIds.concat(e.batchIds),s.count=u-s.offset;else{const t=u;u=k(c,l,u,n,i,e.batchIds,r),e.offset=t,e.count=u-t,a.push(e),s=e}}const d=e._va;e._va=e._vaSwap,e._vaSwap=d,e._batchedIndices=a}(e,n):function(e,t){const n=e._indices,i=e._indexOffsets,r=e._indexCounts,s=e._batchIdLookUp,a=new n.constructor(n.length);let c=t.pop();const l=[c];let u=U(n,a,0,i,r,c.batchIds,s);for(c.offset=0,c.count=u;t.length>0;){const e=t.pop();if(o.A.equals(e.color,c.color))u=U(n,a,u,i,r,e.batchIds,s),c.batchIds=c.batchIds.concat(e.batchIds),c.count=u-c.offset;else{const t=u;u=U(n,a,u,i,r,e.batchIds,s),e.offset=t,e.count=u-t,l.push(e),c=e}}e._va.indexBuffer.copyFromArrayView(a),e._indices=a,e._batchedIndices=l}(e,n),e._framesSinceLastRebatch=0,e._batchDirty=!1,e._pickCommandsDirty=!0,e._wireframeDirty=!0,!0):(e._batchDirty=!1,!1)}(e,t),i=e._commands,r=e._batchedIndices,s=r.length,c=2*s;if((0,a.A)(i)&&!n&&i.length===c)return;i.length=c;const l=e._va,d=e._sp,h=e._modelMatrix??u.A.IDENTITY,A=e._uniformMap,m=e._boundingVolume;for(let t=0;t<s;++t){const n=r[t].offset,o=r[t].count;let s=i[2*t];(0,a.A)(s)||(s=i[2*t]=new p.A({owner:e})),s.vertexArray=l,s.modelMatrix=h,s.offset=n,s.count=o,s.renderState=e._rsStencilDepthPass,s.shaderProgram=d,s.uniformMap=A,s.boundingVolume=m,s.cull=!1,s.pass=f.A.TERRAIN_CLASSIFICATION;const c=p.A.shallowClone(s,s.derivedCommands.tileset);c.renderState=e._rsStencilDepthPass3DTiles,c.pass=f.A.CESIUM_3D_TILE_CLASSIFICATION,s.derivedCommands.tileset=c;let u=i[2*t+1];(0,a.A)(u)||(u=i[2*t+1]=new p.A({owner:e})),u.vertexArray=l,u.modelMatrix=h,u.offset=n,u.count=o,u.renderState=e._rsColorPass,u.shaderProgram=d,u.uniformMap=A,u.boundingVolume=m,u.cull=!1,u.pass=f.A.TERRAIN_CLASSIFICATION;const g=p.A.shallowClone(u,u.derivedCommands.tileset);g.pass=f.A.CESIUM_3D_TILE_CLASSIFICATION,u.derivedCommands.tileset=g}e._commandsDirty=!0}(this,t),function(e,t){if(e.classificationType===x.A.TERRAIN||!t.invertClassification||(0,a.A)(e._commandsIgnoreShow)&&!e._commandsDirty)return;const n=e._commands,i=e._commandsIgnoreShow,o=e._spStencil,r=n.length,s=i.length=r/2;let c=0;for(let e=0;e<s;++e){const t=i[e]=p.A.shallowClone(n[c],i[e]);t.shaderProgram=o,t.pass=f.A.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,c+=2}e._commandsDirty=!1}(this,e),function(e){let t,n,i=e.debugWireframe===e._debugWireframe;if(i=i&&!(e.debugWireframe&&e._wireframeDirty),i)return;(0,a.A)(e._rsWireframe)||(e._rsWireframe=m.A.fromCache({})),e.debugWireframe?(t=e._rsWireframe,n=d.A.LINES):(t=e._rsColorPass,n=d.A.TRIANGLES);const o=e._commands,r=o.length;for(let e=0;e<r;e+=2){const i=o[e+1];i.renderState=t,i.primitiveType=n}e._debugWireframe=e.debugWireframe,e._wireframeDirty=!1}(this),this._debugWireframe?function(e,t){const n=e.commandList,i=t.length;for(let e=0;e<i;e+=2){const i=t[e+1];i.pass=f.A.OPAQUE,n.push(i)}}(e,this._commands):W(this,e,this._commands,this._commandsIgnoreShow)),i.pick&&(function(e){if(!e._pickCommandsDirty)return;const t=e._indexOffsets.length,n=e._pickCommands;n.length=2*t;const i=e._va,o=e._spStencil,r=e._spPick,s=e._modelMatrix??u.A.IDENTITY,c=e._uniformMap;for(let l=0;l<t;++l){const t=e._indexOffsets[l],u=e._indexCounts[l],d=(0,a.A)(e._boundingVolumes)?e._boundingVolumes[l]:e.boundingVolume;let h=n[2*l];(0,a.A)(h)||(h=n[2*l]=new p.A({owner:e,pickOnly:!0})),h.vertexArray=i,h.modelMatrix=s,h.offset=t,h.count=u,h.renderState=e._rsStencilDepthPass,h.shaderProgram=o,h.uniformMap=c,h.boundingVolume=d,h.pass=f.A.TERRAIN_CLASSIFICATION;const A=p.A.shallowClone(h,h.derivedCommands.tileset);A.renderState=e._rsStencilDepthPass3DTiles,A.pass=f.A.CESIUM_3D_TILE_CLASSIFICATION,h.derivedCommands.tileset=A;let m=n[2*l+1];(0,a.A)(m)||(m=n[2*l+1]=new p.A({owner:e,pickOnly:!0})),m.vertexArray=i,m.modelMatrix=s,m.offset=t,m.count=u,m.renderState=e._rsPickPass,m.shaderProgram=r,m.uniformMap=c,m.boundingVolume=d,m.pass=f.A.TERRAIN_CLASSIFICATION;const g=p.A.shallowClone(m,m.derivedCommands.tileset);g.pass=f.A.CESIUM_3D_TILE_CLASSIFICATION,m.derivedCommands.tileset=g}e._pickCommandsDirty=!1}(this),W(this,e,this._pickCommands))},O.prototype.isDestroyed=function(){return!1},O.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaSwap=this._vaSwap&&this._vaSwap.destroy(),(0,c.A)(this)};const Y=O},595826:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(369031),o=n(491446),r=n(605971);const s={POSITION:"POSITION",NORMAL:"NORMAL",TANGENT:"TANGENT",TEXCOORD:"TEXCOORD",COLOR:"COLOR",JOINTS:"JOINTS",WEIGHTS:"WEIGHTS",FEATURE_ID:"_FEATURE_ID",SCALE:"KHR_gaussian_splatting:SCALE",ROTATION:"KHR_gaussian_splatting:ROTATION",hasSetIndex:function(e){switch(i.A.typeOf.string("semantic",e),e){case s.POSITION:case s.NORMAL:case s.TANGENT:return!1;case s.TEXCOORD:case s.COLOR:case s.JOINTS:case s.WEIGHTS:case s.FEATURE_ID:case s.SCALE:case s.ROTATION:return!0;default:throw new r.A("semantic is not a valid value.")}},fromGltfSemantic:function(e){i.A.typeOf.string("gltfSemantic",e);let t=e;const n=/^(\w+)_\d+$/.exec(e);switch(null!==n&&(t=n[1]),t){case"POSITION":return s.POSITION;case"NORMAL":return s.NORMAL;case"TANGENT":return s.TANGENT;case"TEXCOORD":return s.TEXCOORD;case"COLOR":return s.COLOR;case"JOINTS":return s.JOINTS;case"WEIGHTS":return s.WEIGHTS;case"_FEATURE_ID":return s.FEATURE_ID;case"KHR_gaussian_splatting:SCALE":case"_SCALE":return s.SCALE;case"KHR_gaussian_splatting:ROTATION":case"_ROTATION":return s.ROTATION}},fromPntsSemantic:function(e){switch(i.A.typeOf.string("pntsSemantic",e),e){case"POSITION":case"POSITION_QUANTIZED":return s.POSITION;case"RGBA":case"RGB":case"RGB565":return s.COLOR;case"NORMAL":case"NORMAL_OCT16P":return s.NORMAL;case"BATCH_ID":return s.FEATURE_ID;default:throw new r.A("pntsSemantic is not a valid value.")}},getGlslType:function(e){switch(i.A.typeOf.string("semantic",e),e){case s.POSITION:case s.NORMAL:case s.TANGENT:return"vec3";case s.TEXCOORD:return"vec2";case s.COLOR:return"vec4";case s.JOINTS:return"ivec4";case s.WEIGHTS:return"vec4";case s.FEATURE_ID:return"int";case s.SCALE:return"vec3";case s.ROTATION:return"vec4";case s.OPACITY:return"float";default:throw new r.A("semantic is not a valid value.")}},getVariableName:function(e,t){i.A.typeOf.string("semantic",e);let n=function(e){switch(e){case s.POSITION:return"positionMC";case s.NORMAL:return"normalMC";case s.TANGENT:return"tangentMC";case s.TEXCOORD:return"texCoord";case s.COLOR:return"color";case s.JOINTS:return"joints";case s.WEIGHTS:return"weights";case s.FEATURE_ID:return"featureId";case s.SCALE:return"scale";case s.ROTATION:return"rotation";default:throw new r.A("semantic is not a valid value.")}}(e);return(0,o.A)(t)&&(n+=`_${t}`),n}},a=Object.freeze(s)},762270:(e,t,n)=>{"use strict";n.d(t,{A:()=>g});var i=n(915325),o=n(491446),r=n(605971),s=n(182348),a=n(744603),c=n(414305),l=n(463823),u=n(99520),d=n(66458);const h=[3034,3035,3042,3043,3044],A=[4471,4559];function p(e){if(e=e??i.A.EMPTY_OBJECT,!(0,o.A)(e.url))throw new r.A("options.url is required.");if(!(0,o.A)(e.layers))throw new r.A("options.layers is required.");if((0,o.A)(e.times)&&!(0,o.A)(e.clock))throw new r.A("options.times was specified, so options.clock is required.");this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._getFeatureInfoUrl=e.getFeatureInfoUrl??e.url;const t=a.A.createIfNeeded(e.url),n=a.A.createIfNeeded(this._getFeatureInfoUrl);t.setQueryParameters(p.DefaultParameters,!0),n.setQueryParameters(p.GetFeatureInfoDefaultParameters,!0),(0,o.A)(e.parameters)&&t.setQueryParameters(m(e.parameters)),(0,o.A)(e.getFeatureInfoParameters)&&n.setQueryParameters(m(e.getFeatureInfoParameters));const l=this;this._reload=void 0,(0,o.A)(e.times)&&(this._timeDynamicImagery=new u.A({clock:e.clock,times:e.times,requestImageFunction:function(e,t,n,i,o){return f(l,e,t,n,i,o)},reloadFunction:function(){(0,o.A)(l._reload)&&l._reload()}}));const g={};if(g.layers=e.layers,g.bbox="{westProjected},{southProjected},{eastProjected},{northProjected}",g.width="{width}",g.height="{height}",parseFloat(t.queryParameters.version)>=1.3){g.crs=e.crs??(e.tilingScheme&&e.tilingScheme.projection instanceof c.A?"EPSG:3857":"CRS:84");const t=g.crs.split(":");if("EPSG"===t[0]&&2===t.length){const e=Number(t[1]);(e>=4e3&&e<5e3&&!A.includes(e)||h.includes(e))&&(g.bbox="{southProjected},{westProjected},{northProjected},{eastProjected}")}}else g.srs=e.srs??(e.tilingScheme&&e.tilingScheme.projection instanceof c.A?"EPSG:3857":"EPSG:4326");t.setQueryParameters(g,!0),n.setQueryParameters(g,!0);const _={query_layers:e.layers,info_format:"{format}"};parseFloat(n.queryParameters.version)>=1.3?(_.i="{i}",_.j="{j}"):(_.x="{i}",_.y="{j}"),n.setQueryParameters(_,!0),this._resource=t,this._pickFeaturesResource=n,this._layers=e.layers,this._tileProvider=new d.A({url:t,pickFeaturesUrl:n,tilingScheme:e.tilingScheme??new s.A({ellipsoid:e.ellipsoid}),rectangle:e.rectangle,tileWidth:e.tileWidth,tileHeight:e.tileHeight,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,subdomains:e.subdomains,tileDiscardPolicy:e.tileDiscardPolicy,credit:e.credit,getFeatureInfoFormats:e.getFeatureInfoFormats??p.DefaultGetFeatureInfoFormats,enablePickFeatures:e.enablePickFeatures})}function f(e,t,n,i,r,s){const a=(0,o.A)(s)?s.data:void 0,c=e._tileProvider;return(0,o.A)(a)&&c._resource.setQueryParameters(a),c.requestImage(t,n,i,r)}function m(e){const t={};for(const n in e)e.hasOwnProperty(n)&&(t[n.toLowerCase()]=e[n]);return t}Object.defineProperties(p.prototype,{url:{get:function(){return this._resource._url}},proxy:{get:function(){return this._resource.proxy}},layers:{get:function(){return this._layers}},tileWidth:{get:function(){return this._tileProvider.tileWidth}},tileHeight:{get:function(){return this._tileProvider.tileHeight}},maximumLevel:{get:function(){return this._tileProvider.maximumLevel}},minimumLevel:{get:function(){return this._tileProvider.minimumLevel}},tilingScheme:{get:function(){return this._tileProvider.tilingScheme}},rectangle:{get:function(){return this._tileProvider.rectangle}},tileDiscardPolicy:{get:function(){return this._tileProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._tileProvider.errorEvent}},credit:{get:function(){return this._tileProvider.credit}},hasAlphaChannel:{get:function(){return this._tileProvider.hasAlphaChannel}},enablePickFeatures:{get:function(){return this._tileProvider.enablePickFeatures},set:function(e){this._tileProvider.enablePickFeatures=e}},clock:{get:function(){return this._timeDynamicImagery.clock},set:function(e){this._timeDynamicImagery.clock=e}},times:{get:function(){return this._timeDynamicImagery.times},set:function(e){this._timeDynamicImagery.times=e}},getFeatureInfoUrl:{get:function(){return this._getFeatureInfoUrl}}}),p.prototype.getTileCredits=function(e,t,n){return this._tileProvider.getTileCredits(e,t,n)},p.prototype.requestImage=function(e,t,n,i){let r;const s=this._timeDynamicImagery;let a;return(0,o.A)(s)&&(a=s.currentInterval,r=s.getFromCache(e,t,n,i)),(0,o.A)(r)||(r=f(this,e,t,n,i,a)),(0,o.A)(r)&&(0,o.A)(s)&&s.checkApproachingInterval(e,t,n,i),r},p.prototype.pickFeatures=function(e,t,n,i,r){const s=this._timeDynamicImagery;return function(e,t,n,i,r,s,a){const c=(0,o.A)(a)?a.data:void 0,l=e._tileProvider;return(0,o.A)(c)&&l._pickFeaturesResource.setQueryParameters(c),l.pickFeatures(t,n,i,r,s)}(this,e,t,n,i,r,(0,o.A)(s)?s.currentInterval:void 0)},p.DefaultParameters=Object.freeze({service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"}),p.GetFeatureInfoDefaultParameters=Object.freeze({service:"WMS",version:"1.1.1",request:"GetFeatureInfo"}),p.DefaultGetFeatureInfoFormats=Object.freeze([Object.freeze(new l.A("json","application/json")),Object.freeze(new l.A("xml","text/xml")),Object.freeze(new l.A("text","text/html"))]);const g=p},32706:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var i=n(430346),o=n(607502),r=n(915325),s=n(491446),a=n(605971),c=n(955943),l=n(744603),u=n(41076),d=n(553909),h=n(99520);const A=Object.freeze({service:"WMTS",version:"1.0.0",request:"GetTile"});function p(e){if(e=e??r.A.EMPTY_OBJECT,!(0,s.A)(e.url))throw new a.A("options.url is required.");if(!(0,s.A)(e.layer))throw new a.A("options.layer is required.");if(!(0,s.A)(e.style))throw new a.A("options.style is required.");if(!(0,s.A)(e.tileMatrixSetID))throw new a.A("options.tileMatrixSetID is required.");if((0,s.A)(e.times)&&!(0,s.A)(e.clock))throw new a.A("options.times was specified, so options.clock is required.");this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0;const t=l.A.createIfNeeded(e.url),n=e.style,i=e.tileMatrixSetID,d=t.url,p=d.match(/{/g);if(!(0,s.A)(p)||1===p.length&&/{s}/.test(d))t.setQueryParameters(A),this._useKvp=!0;else{const e={style:n,Style:n,TileMatrixSet:i};t.setTemplateValues(e),this._useKvp=!1}this._resource=t,this._layer=e.layer,this._style=n,this._tileMatrixSetID=i,this._tileMatrixLabels=e.tileMatrixLabels,this._format=e.format??"image/jpeg",this._tileDiscardPolicy=e.tileDiscardPolicy,this._tilingScheme=(0,s.A)(e.tilingScheme)?e.tilingScheme:new u.A({ellipsoid:e.ellipsoid}),this._tileWidth=e.tileWidth??256,this._tileHeight=e.tileHeight??256,this._minimumLevel=e.minimumLevel??0,this._maximumLevel=e.maximumLevel,this._rectangle=e.rectangle??this._tilingScheme.rectangle,this._dimensions=e.dimensions;const m=this;this._reload=void 0,(0,s.A)(e.times)&&(this._timeDynamicImagery=new h.A({clock:e.clock,times:e.times,requestImageFunction:function(e,t,n,i,o){return f(m,e,t,n,i,o)},reloadFunction:function(){(0,s.A)(m._reload)&&m._reload()}})),this._errorEvent=new c.A;const g=e.credit;this._credit="string"==typeof g?new o.A(g):g,this._subdomains=e.subdomains,Array.isArray(this._subdomains)?this._subdomains=this._subdomains.slice():(0,s.A)(this._subdomains)&&this._subdomains.length>0?this._subdomains=this._subdomains.split(""):this._subdomains=["a","b","c"]}function f(e,t,n,o,r,a){const c=e._tileMatrixLabels,l=(0,s.A)(c)?c[o]:o.toString(),u=e._subdomains,h=e._dimensions,A=(0,s.A)(a)?a.data:void 0;let p,f;if(e._useKvp){let a={};a.tilematrix=l,a.layer=e._layer,a.style=e._style,a.tilerow=n,a.tilecol=t,a.tilematrixset=e._tileMatrixSetID,a.format=e._format,(0,s.A)(h)&&(a=(0,i.A)(a,h)),(0,s.A)(A)&&(a=(0,i.A)(a,A)),f={s:u[(t+n+o)%u.length]},p=e._resource.getDerivedResource({queryParameters:a,request:r}),p.setTemplateValues(f)}else f={TileMatrix:l,TileRow:n.toString(),TileCol:t.toString(),s:u[(t+n+o)%u.length]},p=e._resource.getDerivedResource({request:r}),p.setTemplateValues(f),(0,s.A)(h)&&p.setTemplateValues(h),(0,s.A)(A)&&p.setTemplateValues(A);return d.A.loadImage(e,p)}Object.defineProperties(p.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},format:{get:function(){return this._format}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}},clock:{get:function(){return this._timeDynamicImagery.clock},set:function(e){this._timeDynamicImagery.clock=e}},times:{get:function(){return this._timeDynamicImagery.times},set:function(e){this._timeDynamicImagery.times=e}},dimensions:{get:function(){return this._dimensions},set:function(e){this._dimensions!==e&&(this._dimensions=e,(0,s.A)(this._reload)&&this._reload())}}}),p.prototype.getTileCredits=function(e,t,n){},p.prototype.requestImage=function(e,t,n,i){let o;const r=this._timeDynamicImagery;let a;return(0,s.A)(r)&&(a=r.currentInterval,o=r.getFromCache(e,t,n,i)),(0,s.A)(o)||(o=f(this,e,t,n,i,a)),(0,s.A)(o)&&(0,s.A)(r)&&r.checkApproachingInterval(e,t,n,i),o},p.prototype.pickFeatures=function(e,t,n,i,o){};const m=p},883734:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=function(e,t,n,i,o){return function(){const r=document.createElement("canvas"),s=o+2*i;r.height=r.width=s;const a=r.getContext("2d");return a.clearRect(0,0,s,s),0!==i&&(a.beginPath(),a.arc(s/2,s/2,s/2,0,2*Math.PI,!0),a.closePath(),a.fillStyle=n,a.fill(),e<1&&(a.save(),a.globalCompositeOperation="destination-out",a.beginPath(),a.arc(s/2,s/2,o/2,0,2*Math.PI,!0),a.closePath(),a.fillStyle="black",a.fill(),a.restore())),a.beginPath(),a.arc(s/2,s/2,o/2,0,2*Math.PI,!0),a.closePath(),a.fillStyle=t,a.fill(),r}}},655028:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(915325),o=n(670549),r=n(231097);const s=function(e){const t=(e=e??i.A.EMPTY_OBJECT).style??r.A.AERIAL;return o.A.fromAssetId(t)}},635649:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(35204),o=n(915325),r=n(491446),s=n(800859),a=n(983884);function c(e,t){const n=(0,s.A)(t,"3DTILES_metadata")?t.extensions["3DTILES_metadata"]:t.metadata;if(!(0,r.A)(n))return;if(!(0,r.A)(e.schema))return void c._oneTimeWarning("findContentMetadata-missing-root-schema","Could not find a metadata schema for content metadata. For tilesets that contain external tilesets, make sure the schema is added to the root tileset.json.");const a=e.schema.classes??o.A.EMPTY_OBJECT;if((0,r.A)(n.class)){const e=a[n.class];return new i.A({content:n,class:e})}}c._oneTimeWarning=a.A;const l=c},217543:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(491446),o=n(800859);const r=function(e,t){const n=e.metadataExtension;if(!(0,i.A)(n))return;const r=n.groups,s=(0,o.A)(t,"3DTILES_metadata")?t.extensions["3DTILES_metadata"].group:t.group;if("number"==typeof s)return r[s];const a=n.groupIds.findIndex(function(e){return e===s});return a>=0?r[a]:void 0}},961624:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(915325),o=n(491446),r=n(800859),s=n(335859),a=n(983884);function c(e,t){const n=(0,r.A)(t,"3DTILES_metadata")?t.extensions["3DTILES_metadata"]:t.metadata;if(!(0,o.A)(n))return;if(!(0,o.A)(e.schema))return void c._oneTimeWarning("findTileMetadata-missing-root-schema","Could not find a metadata schema for tile metadata. For tilesets that contain external tilesets, make sure the schema is added to the root tileset.json.");const a=e.schema.classes??i.A.EMPTY_OBJECT;if((0,o.A)(n.class)){const e=a[n.class];return new s.A({tile:n,class:e})}}c._oneTimeWarning=a.A;const l=c},351554:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var i=n(434067),o=n(267980),r=n(626809),s=n(571804),a=n(463298),c=n(331185),l=n(584164);const u={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},d={SCALAR:void 0,VEC2:i.A,VEC3:o.A,VEC4:r.A,MAT2:a.A,MAT3:c.A,MAT4:l.A},h=function(e){const t=e.componentType;let n;n="string"==typeof t?s.A.fromName(t):t;const i=u[e.type],o=d[e.type];return{componentsPerAttribute:i,classType:o,createArrayBufferView:function(e,t,o){return s.A.createArrayBufferView(n,e,t,i*o)}}}},63267:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(702247),o=n(491446),r=n(915325),s=n(352581);const a=function(e){const t=(e.extensions??r.A.EMPTY_OBJECT).EXT_mesh_primitive_restart,n=e.primitives;if(!(0,o.A)(t))return n;const a=[];(0,i.A)(a,n);for(const e of t.primitiveGroups){const t=e.primitives[0];if(!(0,o.A)(t)||!n[t])return n;const i={...n[t],indices:e.indices};switch(i.mode){case s.A.TRIANGLE_FAN:case s.A.TRIANGLE_STRIP:case s.A.LINE_STRIP:case s.A.LINE_LOOP:break;default:return n}for(const t of e.primitives){const e=a[t];if(!(0,o.A)(e?.indices)||e.mode!==i.mode)return n;a[t]=void 0}a[t]=i}return a.filter(o.A)}},800859:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(491446);const o=function(e,t){return(0,i.A)(e)&&(0,i.A)(e.extensions)&&(0,i.A)(e.extensions[t])}},115959:(e,t,n)=>{"use strict";n.d(t,{A:()=>w});var i=n(369031),o=n(571804),r=n(491446),s=n(786101),a=n(605971),c=n(123245),l=n(744671),u=n(590732),d=n(828847),h=n(287659),A=n(351554),p=n(784749),f=n(32335),m=n(4024),g=n(874403),_=n(995537),y=n(471147),v=n(983884);function T(e){i.A.typeOf.number("options.count",e.count),i.A.typeOf.object("options.batchTable",e.batchTable);const t=e.count,n=e.batchTable,s=e.binaryBody,v=e.parseAsPropertyAttributes??!1,w=e.customAttributeOutput;if(v&&!(0,r.A)(w))throw new a.A("customAttributeOutput is required when parsing batch table as property attributes");const x=function(e){const t=e.HIERARCHY,n=e.extras,i=e.extensions;let o,s;(0,r.A)(t)?(T._deprecationWarning("batchTableHierarchyExtension","The batch table HIERARCHY property has been moved to an extension. Use extensions.3DTILES_batch_table_hierarchy instead."),o=t):(0,r.A)(i)&&(o=i["3DTILES_batch_table_hierarchy"]);const a={};for(const t in e){if(!e.hasOwnProperty(t)||"HIERARCHY"===t||"extensions"===t||"extras"===t)continue;const n=e[t];Array.isArray(n)?(s=(0,r.A)(s)?s:{},s[t]=n):a[t]=n}return{binaryProperties:a,jsonProperties:s,hierarchy:o,extras:n,extensions:i}}(n);let C,E;(0,r.A)(x.jsonProperties)&&(C=new p.A({count:t,properties:x.jsonProperties})),(0,r.A)(x.hierarchy)&&(E=new l.A({extension:x.hierarchy,binaryBody:s}));const S=f.A.BATCH_TABLE_CLASS_NAME,I=x.binaryProperties;let P,D,O;if(v){const e=function(e,t,n,i,s){const a={},l={};let u=0;for(const t in n){if(!n.hasOwnProperty(t))continue;const d=n[t];if(!(0,r.A)(i)&&!(0,r.A)(d.typedArray))throw new c.A(`Property ${t} requires a batch table binary.`);let h=y.A.sanitizeGlslIdentifier(t);(""===h||a.hasOwnProperty(h))&&(h=`property_${u}`,u++);const p=b(d);p.name=t,a[h]=p;let f=h.toUpperCase();f.startsWith("_")||(f=`_${f}`);let m=d.typedArray;(0,r.A)(m)||(m=(0,A.A)(d).createArrayBufferView(i.buffer,i.byteOffset+d.byteOffset,e));const g=new _.A.Attribute;g.name=f,g.count=e,g.type=d.type;const v=o.A.fromTypedArray(m);v!==o.A.INT&&v!==o.A.UNSIGNED_INT&&v!==o.A.DOUBLE||(T._oneTimeWarning("Cast pnts property to floats",`Point cloud property "${f}" will be cast to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.`),m=new Float32Array(m)),g.componentDatatype=o.A.fromTypedArray(m),g.typedArray=m,s.push(g),l[h]={attribute:f}}const d={classes:{}};d.classes[t]={properties:a};const h=m.A.fromJson(d);return{class:t,propertyAttributeJson:{properties:l},transcodedSchema:h,transcodedClass:h.classes[t]}}(t,S,I,s,w);O=e.transcodedSchema,D=[new d.A({propertyAttribute:e.propertyAttributeJson,class:e.transcodedClass})]}else{const e=function(e,t,n,i){const o={},s={},a={};let l=0;for(const t in n){if(!n.hasOwnProperty(t))continue;if(!(0,r.A)(i))throw new c.A(`Property ${t} requires a batch table binary.`);const u=n[t],d=(0,A.A)(u);s[t]={bufferView:l},o[t]=b(u),a[l]=d.createArrayBufferView(i.buffer,i.byteOffset+u.byteOffset,e),l++}const u={classes:{}};u.classes[t]={properties:o};const d=m.A.fromJson(u);return{featureTableJson:{class:t,count:e,properties:s},bufferViewsTypedArrays:a,transcodedSchema:d,transcodedClass:d.classes[t]}}(t,S,I,s);O=e.transcodedSchema;const n=e.featureTableJson;P=new g.A({count:n.count,properties:n.properties,class:e.transcodedClass,bufferViews:e.bufferViewsTypedArrays}),D=[]}const R=[];if((0,r.A)(P)||(0,r.A)(C)||(0,r.A)(E)){const e=new h.A({id:0,name:"Batch Table",count:t,metadataTable:P,jsonMetadataTable:C,batchTableHierarchy:E});R.push(e)}const M={schema:O,propertyTables:R,propertyAttributes:D,extensions:x.extensions,extras:x.extras};return new u.A(M)}function b(e){const t=function(e){switch(e){case"BYTE":return"INT8";case"UNSIGNED_BYTE":return"UINT8";case"SHORT":return"INT16";case"UNSIGNED_SHORT":return"UINT16";case"INT":return"INT32";case"UNSIGNED_INT":return"UINT32";case"FLOAT":return"FLOAT32";case"DOUBLE":return"FLOAT64"}}(e.componentType);return{type:e.type,componentType:t}}T._deprecationWarning=s.A,T._oneTimeWarning=v.A;const w=T},4471:(e,t,n)=>{"use strict";n.d(t,{A:()=>A});var i=n(369031),o=n(430346),r=n(915325),s=n(491446),a=n(287659),c=n(105792),l=n(590732),u=n(874403);function d(e){const t={class:e.class,properties:{}},n=e.properties;for(const e in n)if(n.hasOwnProperty(e)){const i=n[e],r={channels:h(i.channels),extras:i.extras,extensions:i.extensions};t.properties[e]=(0,o.A)(i.texture,r,!0)}return t}function h(e){const t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]="rgba".indexOf(e[i]);return n}const A=function(e){const t=(e=e??r.A.EMPTY_OBJECT).extension,n=e.schema;let o;i.A.typeOf.object("options.extension",t),i.A.typeOf.object("options.schema",n);const h=[];let A;if((0,s.A)(t.featureTables))for(A=Object.keys(t.featureTables).sort(),o=0;o<A.length;o++){const i=A[o],r=t.featureTables[i],s=n.classes[r.class],c=new u.A({count:r.count,properties:r.properties,class:s,bufferViews:e.bufferViews});h.push(new a.A({id:i,count:r.count,metadataTable:c,extras:r.extras,extensions:r.extensions}))}const p=[];if((0,s.A)(t.featureTextures))for(A=Object.keys(t.featureTextures).sort(),o=0;o<A.length;o++){const i=A[o],r=t.featureTextures[i];p.push(new c.A({id:i,propertyTexture:d(r),class:n.classes[r.class],textures:e.textures}))}return new l.A({schema:n,propertyTables:h,propertyTextures:p,statistics:t.statistics,extras:t.extras,extensions:t.extensions})}},613161:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(369031),o=n(915325),r=n(491446),s=n(287659),a=n(105792),c=n(828847),l=n(590732),u=n(874403);const d=function(e){const t=(e=e??o.A.EMPTY_OBJECT).extension,n=e.schema;i.A.typeOf.object("options.extension",t),i.A.typeOf.object("options.schema",n);const d=[];if((0,r.A)(t.propertyTables))for(let i=0;i<t.propertyTables.length;i++){const o=t.propertyTables[i],r=n.classes[o.class],a=new u.A({count:o.count,properties:o.properties,class:r,bufferViews:e.bufferViews});d.push(new s.A({id:i,name:o.name,count:o.count,metadataTable:a,extras:o.extras,extensions:o.extensions}))}const h=[];if((0,r.A)(t.propertyTextures))for(let i=0;i<t.propertyTextures.length;i++){const o=t.propertyTextures[i];h.push(new a.A({id:i,name:o.name,propertyTexture:o,class:n.classes[o.class],textures:e.textures}))}const A=[];if((0,r.A)(t.propertyAttributes))for(let e=0;e<t.propertyAttributes.length;e++){const i=t.propertyAttributes[e];A.push(new c.A({id:e,name:i.name,class:n.classes[i.class],propertyAttribute:i}))}return new l.A({schema:n,propertyTables:d,propertyTextures:h,propertyAttributes:A,statistics:t.statistics,extras:t.extras,extensions:t.extensions})}},192518:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(491446),o=n(604752),r=n(452684),s=n(123245),a=n(223702);const c=function(e){const t=new Uint8Array(e);let n=(0,r.A)(t);if("glTF"===n&&(n="glb"),a.A.isBinaryFormat(n))return{contentType:n,binaryPayload:t};const c=function(e){let t;try{t=(0,o.A)(e)}catch(e){throw new s.A("Invalid tile content.")}return t}(t);if((0,i.A)(c.root))return{contentType:a.A.EXTERNAL_TILESET,jsonPayload:c};if((0,i.A)(c.asset))return{contentType:a.A.GLTF,jsonPayload:c};if((0,i.A)(c.tileAvailability))return{contentType:a.A.IMPLICIT_SUBTREE_JSON,jsonPayload:c};if((0,i.A)(c.type))return{contentType:a.A.GEOJSON,jsonPayload:c};if((0,i.A)(c.voxelTable))return{contentType:a.A.VOXEL_JSON,jsonPayload:c};throw new s.A("Invalid tile content.")}},301005:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="in vec3 v_positionEC;\nin vec3 v_normalEC;\nin vec3 v_tangentEC;\nin vec3 v_bitangentEC;\nin vec2 v_st;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n    mat3 tangentToEyeMatrix = czm_tangentToEyeSpaceMatrix(v_normalEC, v_tangentEC, v_bitangentEC);\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.tangentToEyeMatrix = tangentToEyeMatrix;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    materialInput.st = v_st;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n#endif\n}\n"},980509:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec3 normal;\nin vec3 tangent;\nin vec3 bitangent;\nin vec2 st;\nin float batchId;\n\nout vec3 v_positionEC;\nout vec3 v_normalEC;\nout vec3 v_tangentEC;\nout vec3 v_bitangentEC;\nout vec2 v_st;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    v_tangentEC = czm_normal * tangent;                       // tangent in eye coordinates\n    v_bitangentEC = czm_normal * bitangent;                   // bitangent in eye coordinates\n    v_st = st;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"},291192:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="in vec3 v_positionEC;\nin vec3 v_normalEC;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n#endif\n}\n"},149800:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec3 normal;\nin float batchId;\n\nout vec3 v_positionEC;\nout vec3 v_normalEC;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"},64137:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="in vec3 v_positionEC;\nin vec3 v_normalEC;\nin vec2 v_st;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    materialInput.st = v_st;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n#endif\n}\n"},373785:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec3 normal;\nin vec2 st;\nin float batchId;\n\nout vec3 v_positionEC;\nout vec3 v_normalEC;\nout vec2 v_st;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    v_st = st;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"},468649:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="uniform vec3 u_radiiAndDynamicAtmosphereColor;\n\nuniform float u_atmosphereLightIntensity;\nuniform float u_atmosphereRayleighScaleHeight;\nuniform float u_atmosphereMieScaleHeight;\nuniform float u_atmosphereMieAnisotropy;\nuniform vec3 u_atmosphereRayleighCoefficient;\nuniform vec3 u_atmosphereMieCoefficient;\n\nconst float ATMOSPHERE_THICKNESS = 111e3; // The thickness of the atmosphere in meters.\nconst int PRIMARY_STEPS_MAX = 16; // Maximum number of times the ray from the camera to the world position (primary ray) is sampled.\nconst int LIGHT_STEPS_MAX = 4; // Maximum number of times the light is sampled from the light source's intersection with the atmosphere to a sample position on the primary ray.\n\n/**\n * This function computes the colors contributed by Rayliegh and Mie scattering on a given ray, as well as\n * the transmittance value for the ray.\n *\n * @param {czm_ray} primaryRay The ray from the camera to the position.\n * @param {float} primaryRayLength The length of the primary ray.\n * @param {vec3} lightDirection The direction of the light to calculate the scattering from.\n * @param {vec3} rayleighColor The variable the Rayleigh scattering will be written to.\n * @param {vec3} mieColor The variable the Mie scattering will be written to.\n * @param {float} opacity The variable the transmittance will be written to.\n * @glslFunction\n */\nvoid computeScattering(\n    czm_ray primaryRay,\n    float primaryRayLength,\n    vec3 lightDirection,\n    float atmosphereInnerRadius,\n    out vec3 rayleighColor,\n    out vec3 mieColor,\n    out float opacity\n) {\n\n    // Initialize the default scattering amounts to 0.\n    rayleighColor = vec3(0.0);\n    mieColor = vec3(0.0);\n    opacity = 0.0;\n\n    float atmosphereOuterRadius = atmosphereInnerRadius + ATMOSPHERE_THICKNESS;\n\n    vec3 origin = vec3(0.0);\n\n    // Calculate intersection from the camera to the outer ring of the atmosphere.\n    czm_raySegment primaryRayAtmosphereIntersect = czm_raySphereIntersectionInterval(primaryRay, origin, atmosphereOuterRadius);\n\n    // Return empty colors if no intersection with the atmosphere geometry.\n    if (primaryRayAtmosphereIntersect == czm_emptyRaySegment) {\n        return;\n    }\n\n    // To deal with smaller values of PRIMARY_STEPS (e.g. 4)\n    // we implement a split strategy: sky or horizon.\n    // For performance reasons, instead of a if/else branch\n    // a soft choice is implemented through a weight 0.0 <= w_stop_gt_lprl <= 1.0\n    float x = 1e-7 * primaryRayAtmosphereIntersect.stop / length(primaryRayLength);\n    // Value close to 0.0: close to the horizon\n    // Value close to 1.0: above in the sky\n    float w_stop_gt_lprl = 0.5 * (1.0 + czm_approximateTanh(x));\n\n    // The ray should start from the first intersection with the outer atmopshere, or from the camera position, if it is inside the atmosphere.\n    float start_0 = primaryRayAtmosphereIntersect.start;\n    primaryRayAtmosphereIntersect.start = max(primaryRayAtmosphereIntersect.start, 0.0);\n    // The ray should end at the exit from the atmosphere or at the distance to the vertex, whichever is smaller.\n    primaryRayAtmosphereIntersect.stop = min(primaryRayAtmosphereIntersect.stop, length(primaryRayLength));\n\n    // For the number of ray steps, distinguish inside or outside atmosphere (outer space)\n    // (1) from outer space we have to use more ray steps to get a realistic rendering\n    // (2) within atmosphere we need fewer steps for faster rendering\n    float x_o_a = start_0 - ATMOSPHERE_THICKNESS; // ATMOSPHERE_THICKNESS used as an ad-hoc constant, no precise meaning here, only the order of magnitude matters\n    float w_inside_atmosphere = 1.0 - 0.5 * (1.0 + czm_approximateTanh(x_o_a));\n    int PRIMARY_STEPS = PRIMARY_STEPS_MAX - int(w_inside_atmosphere * 12.0); // Number of times the ray from the camera to the world position (primary ray) is sampled.\n    int LIGHT_STEPS = LIGHT_STEPS_MAX - int(w_inside_atmosphere * 2.0); // Number of times the light is sampled from the light source's intersection with the atmosphere to a sample position on the primary ray.\n\n    // Setup for sampling positions along the ray - starting from the intersection with the outer ring of the atmosphere.\n    float rayPositionLength = primaryRayAtmosphereIntersect.start;\n    // (1) Outside the atmosphere: constant rayStepLength\n    // (2) Inside atmosphere: variable rayStepLength to compensate the rough rendering of the smaller number of ray steps\n    float totalRayLength = primaryRayAtmosphereIntersect.stop - rayPositionLength;\n    float rayStepLengthIncrease = w_inside_atmosphere * ((1.0 - w_stop_gt_lprl) * totalRayLength / (float(PRIMARY_STEPS * (PRIMARY_STEPS + 1)) / 2.0));\n    float rayStepLength = max(1.0 - w_inside_atmosphere, w_stop_gt_lprl) * totalRayLength / max(7.0 * w_inside_atmosphere, float(PRIMARY_STEPS));\n\n    vec3 rayleighAccumulation = vec3(0.0);\n    vec3 mieAccumulation = vec3(0.0);\n    vec2 opticalDepth = vec2(0.0);\n    vec2 heightScale = vec2(u_atmosphereRayleighScaleHeight, u_atmosphereMieScaleHeight);\n\n    // Sample positions on the primary ray.\n    for (int i = 0; i < PRIMARY_STEPS_MAX; ++i) {\n\n        // The loop should be: for (int i = 0; i < PRIMARY_STEPS; ++i) {...} but WebGL1 cannot\n        // loop with non-constant condition, so it has to break early instead\n        if (i >= PRIMARY_STEPS) {\n            break;\n        }\n\n        // Calculate sample position along viewpoint ray.\n        vec3 samplePosition = primaryRay.origin + primaryRay.direction * (rayPositionLength + rayStepLength);\n\n        // Calculate height of sample position above ellipsoid.\n        float sampleHeight = length(samplePosition) - atmosphereInnerRadius;\n\n        // Calculate and accumulate density of particles at the sample position.\n        vec2 sampleDensity = exp(-sampleHeight / heightScale) * rayStepLength;\n        opticalDepth += sampleDensity;\n\n        // Generate ray from the sample position segment to the light source, up to the outer ring of the atmosphere.\n        czm_ray lightRay = czm_ray(samplePosition, lightDirection);\n        czm_raySegment lightRayAtmosphereIntersect = czm_raySphereIntersectionInterval(lightRay, origin, atmosphereOuterRadius);\n\n        float lightStepLength = lightRayAtmosphereIntersect.stop / float(LIGHT_STEPS);\n        float lightPositionLength = 0.0;\n\n        vec2 lightOpticalDepth = vec2(0.0);\n\n        // Sample positions along the light ray, to accumulate incidence of light on the latest sample segment.\n        for (int j = 0; j < LIGHT_STEPS_MAX; ++j) {\n\n            // The loop should be: for (int j = 0; i < LIGHT_STEPS; ++j) {...} but WebGL1 cannot\n            // loop with non-constant condition, so it has to break early instead\n            if (j >= LIGHT_STEPS) {\n                break;\n            }\n\n            // Calculate sample position along light ray.\n            vec3 lightPosition = samplePosition + lightDirection * (lightPositionLength + lightStepLength * 0.5);\n\n            // Calculate height of the light sample position above ellipsoid.\n            float lightHeight = length(lightPosition) - atmosphereInnerRadius;\n\n            // Calculate density of photons at the light sample position.\n            lightOpticalDepth += exp(-lightHeight / heightScale) * lightStepLength;\n\n            // Increment distance on light ray.\n            lightPositionLength += lightStepLength;\n        }\n\n        // Compute attenuation via the primary ray and the light ray.\n        vec3 attenuation = exp(-((u_atmosphereMieCoefficient * (opticalDepth.y + lightOpticalDepth.y)) + (u_atmosphereRayleighCoefficient * (opticalDepth.x + lightOpticalDepth.x))));\n\n        // Accumulate the scattering.\n        rayleighAccumulation += sampleDensity.x * attenuation;\n        mieAccumulation += sampleDensity.y * attenuation;\n\n        // Increment distance on primary ray.\n        rayPositionLength += (rayStepLength += rayStepLengthIncrease);\n    }\n\n    // Compute the scattering amount.\n    rayleighColor = u_atmosphereRayleighCoefficient * rayleighAccumulation;\n    mieColor = u_atmosphereMieCoefficient * mieAccumulation;\n\n    // Compute the transmittance i.e. how much light is passing through the atmosphere.\n    opacity = length(exp(-((u_atmosphereMieCoefficient * opticalDepth.y) + (u_atmosphereRayleighCoefficient * opticalDepth.x))));\n}\n\nvec4 computeAtmosphereColor(\n    vec3 positionWC,\n    vec3 lightDirection,\n    vec3 rayleighColor,\n    vec3 mieColor,\n    float opacity\n) {\n    // Setup the primary ray: from the camera position to the vertex position.\n    vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;\n    vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);\n\n    float cosAngle = dot(cameraToPositionWCDirection, lightDirection);\n    float cosAngleSq = cosAngle * cosAngle;\n\n    float G = u_atmosphereMieAnisotropy;\n    float GSq = G * G;\n\n    // The Rayleigh phase function.\n    float rayleighPhase = 3.0 / (50.2654824574) * (1.0 + cosAngleSq);\n    // The Mie phase function.\n    float miePhase = 3.0 / (25.1327412287) * ((1.0 - GSq) * (cosAngleSq + 1.0)) / (pow(1.0 + GSq - 2.0 * cosAngle * G, 1.5) * (2.0 + GSq));\n\n    // The final color is generated by combining the effects of the Rayleigh and Mie scattering.\n    vec3 rayleigh = rayleighPhase * rayleighColor;\n    vec3 mie = miePhase * mieColor;\n\n    vec3 color = (rayleigh + mie) * u_atmosphereLightIntensity;\n\n    return vec4(color, opacity);\n}\n"},635582:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="uniform samplerCube u_radianceMap;\n\nin vec2 v_textureCoordinates;\n\n\nconst float twoSqrtPi = 2.0 * sqrt(czm_pi);\n\n// Coutesy of https://www.ppsloan.org/publications/StupidSH36.pdf\nfloat computeShBasis(int index, vec3 s) {\n    if (index == 0) { // l = 0, m = 0\n        return 1.0 / twoSqrtPi;\n    }\n    \n    if (index == 1) { // l = 1, m = -1\n        return -sqrt(3.0) * s.y / twoSqrtPi;\n    }\n\n    if (index == 2) { // l = 1, m = 0\n        return sqrt(3.0) * s.z / twoSqrtPi;\n    }\n\n    if (index == 3) { // l = 1, m = 1\n        return -sqrt(3.0) * s.x / twoSqrtPi;\n    }\n\n    if (index == 4) { // l = 2, m = -2\n        return sqrt(15.0) * s.y * s.x / twoSqrtPi;\n    }\n\n    if (index == 5) { // l = 2, m = -1\n        return -sqrt(15.0) * s.y * s.z / twoSqrtPi;\n    }\n\n    if (index == 6) { // l = 2, m = 0\n        return sqrt(5.0) * (3.0 * s.z * s.z - 1.0) / 2.0 / twoSqrtPi;\n    }\n\n    if (index == 7) { // l = 2, m = 1\n        return -sqrt(15.0) * s.x * s.z / twoSqrtPi;\n    }\n\n    if (index == 8) { // l = 2, m = 2\n        return sqrt(15.0) * (s.x * s.x - s.y * s.y) / 2.0 / twoSqrtPi;\n    }\n\n    return 0.0;\n}\n\nfloat vdcRadicalInverse(int i)\n{\n    float r;\n    float base = 2.0;\n    float value = 0.0;\n    float invBase = 1.0 / base;\n    float invBi = invBase;\n    for (int x = 0; x < 100; x++)\n    {\n        if (i <= 0)\n        {\n            break;\n        }\n        r = mod(float(i), base);\n        value += r * invBi;\n        invBi *= invBase;\n        i = int(float(i) * invBase);\n    }\n    return value;\n}\n\nvec2 hammersley2D(int i, int N)\n{\n    return vec2(float(i) / float(N), vdcRadicalInverse(i));\n}\n\n// Sample count is relatively low for the sake of performance, but should still be enough to capture directionality needed for third-order harmonics\nconst int samples = 256; \nconst float solidAngle = 1.0 / float(samples);\n\nvoid main() {\n    // Get the current coefficient based on the uv\n   vec2 uv = v_textureCoordinates.xy * 3.0;\n   int coefficientIndex = int(floor(uv.y) * 3.0 + floor(uv.x));\n\n    for (int i = 0; i < samples; ++i) {\n        vec2 xi = hammersley2D(i, samples);\n        float phi = czm_twoPi * xi.x;\n        float cosTheta = 1.0 - 2.0 * sqrt(1.0 - xi.y * xi.y);\n        float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n        vec3 direction = normalize(vec3(sinTheta * cos(phi), cosTheta, sinTheta * sin(phi)));\n\n        // Generate the spherical harmonics basis from the direction\n        float Ylm = computeShBasis(coefficientIndex, direction);\n\n        vec3 lookupDirection = -direction.xyz;\n        lookupDirection.z = -lookupDirection.z;\n\n        vec4 color = czm_textureCube(u_radianceMap, lookupDirection, 0.0);\n\n        // Use the relevant function for this coefficient\n        out_FragColor += Ylm * color * solidAngle * sinTheta;\n    }\n    \n}\n"},198709:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="precision highp float;\n\nin vec2 v_textureCoordinates;\n\nuniform vec3 u_faceDirection; // Current cubemap face\nuniform vec3 u_positionWC;\nuniform mat4 u_enuToFixedFrame;\nuniform vec4 u_brightnessSaturationGammaIntensity;\nuniform vec4 u_groundColor; // alpha component represent albedo\n\nvec4 getCubeMapDirection(vec2 uv, vec3 faceDir) {\n    vec2 scaledUV = uv * 2.0 - 1.0;\n\n    if (faceDir.x != 0.0) {\n        return vec4(faceDir.x,  scaledUV.x * faceDir.x, -scaledUV.y, 0.0);\n    } else if (faceDir.y != 0.0) {\n        return vec4(scaledUV.x, -scaledUV.y * faceDir.y, faceDir.y, 0.0);\n    } else {\n        return vec4(scaledUV.x * faceDir.z, -faceDir.z, -scaledUV.y, 0.0); \n    }\n}\n\nvoid main() {    \n    float height = length(u_positionWC);\n    float atmosphereInnerRadius = u_radiiAndDynamicAtmosphereColor.y;\n    float ellipsoidHeight = max(height - atmosphereInnerRadius, 0.0);\n\n    // Scale the position to ensure the sky color is present, even when underground.\n    vec3 positionWC = u_positionWC / height * (ellipsoidHeight + atmosphereInnerRadius);\n\n    float atmosphereOuterRadius = u_radiiAndDynamicAtmosphereColor.x;\n    float atmosphereHeight = atmosphereOuterRadius - atmosphereInnerRadius;\n\n    vec3 direction = (u_enuToFixedFrame * getCubeMapDirection(v_textureCoordinates, u_faceDirection)).xyz;\n    vec3 normalizedDirection = normalize(direction);\n\n    czm_ray ray = czm_ray(positionWC, normalizedDirection);\n    czm_raySegment intersection = czm_raySphereIntersectionInterval(ray, vec3(0.0), atmosphereInnerRadius);\n    if (!czm_isEmpty(intersection)) {\n        intersection = czm_rayEllipsoidIntersectionInterval(ray, vec3(0.0), czm_ellipsoidInverseRadii);\n    }\n\n    bool onEllipsoid = intersection.start >= 0.0;\n    float rayLength = czm_branchFreeTernary(onEllipsoid, intersection.start, atmosphereOuterRadius);\n\n    // Compute sky color for each position on a sphere at radius centered around the provided position's origin\n    vec3 skyPositionWC = positionWC + normalizedDirection * rayLength;\n\n    float lightEnum = u_radiiAndDynamicAtmosphereColor.z;\n    vec3 lightDirectionWC = normalize(czm_getDynamicAtmosphereLightDirection(skyPositionWC, lightEnum));\n    vec3 mieColor;\n    vec3 rayleighColor;\n    float opacity;\n    czm_computeScattering(\n        ray,\n        rayLength,\n        lightDirectionWC,\n        atmosphereInnerRadius, \n        rayleighColor,\n        mieColor,\n        opacity\n    );\n\n    vec4 atmopshereColor = czm_computeAtmosphereColor(ray, lightDirectionWC, rayleighColor, mieColor, opacity);\n\n#ifdef ATMOSPHERE_COLOR_CORRECT\n    const bool ignoreBlackPixels = true;\n    atmopshereColor.rgb = czm_applyHSBShift(atmopshereColor.rgb, czm_atmosphereHsbShift, ignoreBlackPixels);\n#endif\n\n    vec3 lookupDirection = -normalizedDirection;\n     // Flipping the X vector is a cheap way to get the inverse of czm_temeToPseudoFixed, since that's a rotation about Z.\n    lookupDirection.x = -lookupDirection.x;\n    lookupDirection = -normalize(czm_temeToPseudoFixed * lookupDirection);\n    lookupDirection.x = -lookupDirection.x;\n\n    // Values outside the atmopshere are rendered as black, when they should be treated as transparent\n    float skyAlpha = clamp((1.0 - ellipsoidHeight / atmosphereHeight) * atmopshereColor.a, 0.0, 1.0);\n    skyAlpha = czm_branchFreeTernary(length(atmopshereColor.rgb) <= czm_epsilon7, 0.0, skyAlpha); // Treat black as transparent\n\n    // Blend starmap with atmopshere scattering\n    float intensity = u_brightnessSaturationGammaIntensity.w;\n    vec4 sceneSkyBoxColor = czm_textureCube(czm_environmentMap, lookupDirection);\n    vec3 skyBackgroundColor = mix(czm_backgroundColor.rgb, sceneSkyBoxColor.rgb, sceneSkyBoxColor.a);\n    vec4 combinedSkyColor = vec4(mix(skyBackgroundColor, atmopshereColor.rgb * intensity, skyAlpha), 1.0);\n\n    // Compute ground color based on amount of reflected light, then blend it with ground atmosphere based on height\n    vec3 up = normalize(positionWC);\n    float occlusion = max(dot(lightDirectionWC, up), 0.05);\n    vec4 groundColor = vec4(u_groundColor.rgb * u_groundColor.a * (vec3(intensity * occlusion) + atmopshereColor.rgb), 1.0);\n    vec4 blendedGroundColor = mix(groundColor, atmopshereColor, clamp(ellipsoidHeight / atmosphereHeight, 0.0, 1.0));\n\n    vec4 color = czm_branchFreeTernary(onEllipsoid, blendedGroundColor, combinedSkyColor);\n\n    float brightness = u_brightnessSaturationGammaIntensity.x;\n    float saturation = u_brightnessSaturationGammaIntensity.y;\n    float gamma = u_brightnessSaturationGammaIntensity.z;\n\n#ifdef ENVIRONMENT_COLOR_CORRECT\n    color.rgb = mix(vec3(0.0), color.rgb, brightness);\n    color.rgb = czm_saturation(color.rgb, saturation);\n#endif\n    color.rgb = pow(color.rgb, vec3(gamma)); // Normally this would be in the ifdef above, but there is a precision issue with the atmopshere scattering transmittance (alpha). Having this line is a workaround for that issue, even when gamma is 1.0.\n    color.rgb = czm_gammaCorrect(color.rgb);\n\n    out_FragColor = color;\n}\n"},722856:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="precision highp float;\n\nin vec3 v_textureCoordinates;\n\nuniform float u_roughness;\nuniform samplerCube u_radianceTexture;\nuniform vec3 u_faceDirection;\n\nfloat vdcRadicalInverse(int i)\n{\n    float r;\n    float base = 2.0;\n    float value = 0.0;\n    float invBase = 1.0 / base;\n    float invBi = invBase;\n    for (int x = 0; x < 100; x++)\n    {\n        if (i <= 0)\n        {\n            break;\n        }\n        r = mod(float(i), base);\n        value += r * invBi;\n        invBi *= invBase;\n        i = int(float(i) * invBase);\n    }\n    return value;\n}\n\nvec2 hammersley2D(int i, int N)\n{\n    return vec2(float(i) / float(N), vdcRadicalInverse(i));\n}\n\nvec3 importanceSampleGGX(vec2 xi, float alphaRoughness, vec3 N)\n{\n    float alphaRoughnessSquared = alphaRoughness * alphaRoughness;\n    float phi = czm_twoPi * xi.x;\n    float cosTheta = sqrt((1.0 - xi.y) / (1.0 + (alphaRoughnessSquared - 1.0) * xi.y));\n    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n    vec3 H = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);\n    vec3 upVector = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n    vec3 tangentX = normalize(cross(upVector, N));\n    vec3 tangentY = cross(N, tangentX);\n    return tangentX * H.x + tangentY * H.y + N * H.z;\n}\n\n// Sample count is relatively low for the sake of performance, but should still be enough to prevent artifacting in lower roughnesses\nconst int samples = 128;\n\nvoid main() {\n    vec3 normal = u_faceDirection;\n    vec3 V = normalize(v_textureCoordinates);\n    float roughness = u_roughness;\n\n    vec4 color = vec4(0.0);\n    float weight = 0.0;\n    for (int i = 0; i < samples; ++i) {\n            vec2 xi = hammersley2D(i, samples);\n            vec3 H = importanceSampleGGX(xi, roughness, V);\n            vec3 L = 2.0 * dot(V, H) * H - V; // reflected vector\n\n            float NdotL = max(dot(V, L), 0.0);\n            if (NdotL > 0.0) {\n                color += vec4(czm_textureCube(u_radianceTexture, L).rgb, 1.0) * NdotL;\n                weight += NdotL;\n            }\n        }\n    out_FragColor = color / weight;\n}\n"},864248:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="in vec3 position;\nout vec3 v_textureCoordinates;\n\nuniform vec3 u_faceDirection;\n\nvec3 getCubeMapDirection(vec2 uv, vec3 faceDir) {\n    vec2 scaledUV = uv;\n\n    if (faceDir.x != 0.0) {\n        return vec3(faceDir.x, scaledUV.y, scaledUV.x * faceDir.x);\n    } else if (faceDir.y != 0.0) {\n        return vec3(scaledUV.x, -faceDir.y, -scaledUV.y * faceDir.y);\n    } else {\n        return vec3(scaledUV.x * faceDir.z, scaledUV.y, -faceDir.z); \n    }\n}\n\nvoid main() \n{\n    v_textureCoordinates = getCubeMapDirection(position.xy, u_faceDirection);\n    v_textureCoordinates.y = -v_textureCoordinates.y;\n    v_textureCoordinates.z = -v_textureCoordinates.z;\n    gl_Position = vec4(position, 1.0);\n}\n"},50937:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="// robust iterative solution without trig functions\n// https://github.com/0xfaded/ellipse_demo/issues/1\n// https://stackoverflow.com/questions/22959698/distance-from-given-point-to-given-ellipse\n//\n// This version uses only a single iteration for best performance. For fog\n// rendering, the difference is negligible.\nvec2 nearestPointOnEllipseFast(vec2 pos, vec2 radii) {\n    vec2 p = abs(pos);\n    vec2 inverseRadii = 1.0 / radii;\n    vec2 evoluteScale = (radii.x * radii.x - radii.y * radii.y) * vec2(1.0, -1.0) * inverseRadii;\n\n    // We describe the ellipse parametrically: v = radii * vec2(cos(t), sin(t))\n    // but store the cos and sin of t in a vec2 for efficiency.\n    // Initial guess: t = cos(pi/4)\n    vec2 tTrigs = vec2(0.70710678118);\n    vec2 v = radii * tTrigs;\n\n    // Find the evolute of the ellipse (center of curvature) at v.\n    vec2 evolute = evoluteScale * tTrigs * tTrigs * tTrigs;\n    // Find the (approximate) intersection of p - evolute with the ellipsoid.\n    vec2 q = normalize(p - evolute) * length(v - evolute);\n    // Update the estimate of t.\n    tTrigs = (q + evolute) * inverseRadii;\n    tTrigs = normalize(clamp(tTrigs, 0.0, 1.0));\n    v = radii * tTrigs;\n\n    return v * sign(pos);\n}\n\nvec3 computeEllipsoidPositionWC(vec3 positionMC) {\n    // Get the world-space position and project onto a meridian plane of\n    // the ellipsoid\n    vec3 positionWC = (czm_model * vec4(positionMC, 1.0)).xyz;\n\n    vec2 positionEllipse = vec2(length(positionWC.xy), positionWC.z);\n    vec2 nearestPoint = nearestPointOnEllipseFast(positionEllipse, czm_ellipsoidRadii.xz);\n\n    // Reconstruct a 3D point in world space\n    return vec3(nearestPoint.x * normalize(positionWC.xy), nearestPoint.y);\n}\n\nvoid applyFog(inout vec4 color, vec4 groundAtmosphereColor, vec3 lightDirection, float distanceToCamera) {\n\n    vec3 fogColor = groundAtmosphereColor.rgb;\n\n    // If there is dynamic lighting, apply that to the fog.\n    const float NONE = 0.0;\n    if (czm_atmosphereDynamicLighting != NONE) {\n        float darken = clamp(dot(normalize(czm_viewerPositionWC), lightDirection), czm_fogMinimumBrightness, 1.0);\n        fogColor *= darken;\n    }\n\n    // Tonemap if HDR rendering is disabled\n    #ifndef HDR\n        fogColor.rgb = czm_pbrNeutralTonemapping(fogColor.rgb);\n        fogColor.rgb = czm_inverseGamma(fogColor.rgb);\n    #endif\n\n    vec3 withFog = czm_fog(distanceToCamera, color.rgb, fogColor, czm_fogVisualDensityScalar);\n    color = vec4(withFog, color.a);\n}\n\nvoid atmosphereStage(inout vec4 color, in ProcessedAttributes attributes) {\n    vec3 rayleighColor;\n    vec3 mieColor;\n    float opacity;\n\n    vec3 positionWC;\n    vec3 lightDirection;\n\n    // When the camera is in space, compute the position per-fragment for\n    // more accurate ground atmosphere. All other cases will use\n    //\n    // The if condition will be added in https://github.com/CesiumGS/cesium/issues/11717\n    if (false) {\n        positionWC = computeEllipsoidPositionWC(attributes.positionMC);\n        lightDirection = czm_getDynamicAtmosphereLightDirection(positionWC, czm_atmosphereDynamicLighting);\n\n        // The fog color is derived from the ground atmosphere color\n        czm_computeGroundAtmosphereScattering(\n            positionWC,\n            lightDirection,\n            rayleighColor,\n            mieColor,\n            opacity\n        );\n    } else {\n        positionWC = attributes.positionWC;\n        lightDirection = czm_getDynamicAtmosphereLightDirection(positionWC, czm_atmosphereDynamicLighting);\n        rayleighColor = v_atmosphereRayleighColor;\n        mieColor = v_atmosphereMieColor;\n        opacity = v_atmosphereOpacity;\n    }\n\n    //color correct rayleigh and mie colors\n    const bool ignoreBlackPixels = true;\n    rayleighColor = czm_applyHSBShift(rayleighColor, czm_atmosphereHsbShift, ignoreBlackPixels);\n    mieColor = czm_applyHSBShift(mieColor, czm_atmosphereHsbShift, ignoreBlackPixels);\n\n    vec4 groundAtmosphereColor = czm_computeAtmosphereColor(positionWC, lightDirection, rayleighColor, mieColor, opacity);\n\n    if (u_isInFog) {\n        float distanceToCamera = length(attributes.positionEC);\n        applyFog(color, groundAtmosphereColor, lightDirection, distanceToCamera);\n    } else {\n        // Ground atmosphere\n    }\n}\n"},390249:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void atmosphereStage(ProcessedAttributes attributes) {\n    vec3 lightDirection = czm_getDynamicAtmosphereLightDirection(v_positionWC, czm_atmosphereDynamicLighting);\n\n    czm_computeGroundAtmosphereScattering(\n        // This assumes the geometry stage came before this.\n        v_positionWC,\n        lightDirection,\n        v_atmosphereRayleighColor,\n        v_atmosphereMieColor,\n        v_atmosphereOpacity\n    );\n}\n"},759889:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void filterByPassType(vec4 featureColor)\n{\n    bool styleTranslucent = (featureColor.a != 1.0);\n    // Only render translucent features in the translucent pass (if the style or the original command has translucency).\n    if (czm_pass == czm_passTranslucent && !styleTranslucent && !model_commandTranslucent)\n    {   \n        // If the model has a translucent silhouette, it needs to render during the silhouette color command,\n        // (i.e. the command where model_silhouettePass = true), even if the model isn't translucent.\n        #ifdef HAS_SILHOUETTE\n        if(!model_silhouettePass) {\n            discard;\n        }\n        #else\n        discard;\n        #endif\n    }\n    // If the current pass is not the translucent pass and the style is not translucent, don't render the feature.\n    else if (czm_pass != czm_passTranslucent && styleTranslucent)\n    {\n        discard;\n    }\n}\n\nvoid cpuStylingStage(inout czm_modelMaterial material, SelectedFeature feature)\n{\n    vec4 featureColor = feature.color;\n    if (featureColor.a == 0.0)\n    {\n        discard;\n    }\n\n    // If a feature ID vertex attribute is used, the pass type filter is applied in the vertex shader.\n    // So, we only apply in in the fragment shader if the feature ID texture is used.\n    #if defined(HAS_SELECTED_FEATURE_ID_TEXTURE) && !defined(HAS_CLASSIFICATION)\n    filterByPassType(featureColor);\n    #endif\n\n    featureColor = czm_gammaCorrect(featureColor);\n\n    // Classification models compute the diffuse differently.\n    #ifdef HAS_CLASSIFICATION\n    material.diffuse = featureColor.rgb * featureColor.a;\n    #else\n    float highlight = ceil(model_colorBlend);\n    material.diffuse *= mix(featureColor.rgb, vec3(1.0), highlight);\n    #endif\n    \n    material.alpha *= featureColor.a;\n}\n"},726401:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void filterByPassType(inout vec3 positionMC, vec4 featureColor)\n{\n    bool styleTranslucent = (featureColor.a != 1.0);\n    // Only render translucent features in the translucent pass (if the style or the original command has translucency).\n    if (czm_pass == czm_passTranslucent && !styleTranslucent && !model_commandTranslucent)\n    {\n        // If the model has a translucent silhouette, it needs to render during the silhouette color command,\n        // (i.e. the command where model_silhouettePass = true), even if the model isn't translucent.\n        #ifdef HAS_SILHOUETTE\n        positionMC *= float(model_silhouettePass);\n        #else\n        positionMC *= 0.0;\n        #endif\n    }\n    // If the current pass is not the translucent pass and the style is not translucent, don't render the feature.\n    else if (czm_pass != czm_passTranslucent && styleTranslucent)\n    {\n        positionMC *= 0.0;\n    }\n}\n\nvoid cpuStylingStage(inout vec3 positionMC, inout SelectedFeature feature)\n{\n    float show = ceil(feature.color.a);\n    positionMC *= show;\n\n    #if defined(HAS_SELECTED_FEATURE_ID_ATTRIBUTE) && !defined(HAS_CLASSIFICATION)\n    filterByPassType(positionMC, feature.color);\n    #endif\n}\n"},58747:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void customShaderStage(\n    inout czm_modelMaterial material,\n    ProcessedAttributes attributes,\n    FeatureIds featureIds,\n    Metadata metadata,\n    MetadataClass metadataClass,\n    MetadataStatistics metadataStatistics\n) {\n    // FragmentInput and initializeInputStruct() are dynamically generated in JS, \n    // see CustomShaderPipelineStage.js\n    FragmentInput fsInput;\n    initializeInputStruct(fsInput, attributes);\n    fsInput.featureIds = featureIds;\n    fsInput.metadata = metadata;\n    fsInput.metadataClass = metadataClass;\n    fsInput.metadataStatistics = metadataStatistics;\n    fragmentMain(fsInput, material);\n}\n"},181163:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void customShaderStage(\n    inout czm_modelVertexOutput vsOutput, \n    inout ProcessedAttributes attributes, \n    FeatureIds featureIds,\n    Metadata metadata,\n    MetadataClass metadataClass,\n    MetadataStatistics metadataStatistics\n) {\n    // VertexInput and initializeInputStruct() are dynamically generated in JS, \n    // see CustomShaderPipelineStage.js\n    VertexInput vsInput;\n    initializeInputStruct(vsInput, attributes);\n    vsInput.featureIds = featureIds;\n    vsInput.metadata = metadata;\n    vsInput.metadataClass = metadataClass;\n    vsInput.metadataStatistics = metadataStatistics;\n    vertexMain(vsInput, vsOutput);\n    attributes.positionMC = vsOutput.positionMC;\n}\n"},625322:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void featureIdStage(out FeatureIds featureIds, ProcessedAttributes attributes) {\n  initializeFeatureIds(featureIds, attributes);\n  initializeFeatureIdAliases(featureIds);\n}\n"},204410:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void featureIdStage(out FeatureIds featureIds, ProcessedAttributes attributes) \n{\n  initializeFeatureIds(featureIds, attributes);\n  initializeFeatureIdAliases(featureIds);\n  setFeatureIdVaryings();\n}\n"},896077:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void geometryStage(out ProcessedAttributes attributes)\n{\n  attributes.positionMC = v_positionMC;\n  attributes.positionEC = v_positionEC;\n\n  #if defined(COMPUTE_POSITION_WC_CUSTOM_SHADER) || defined(COMPUTE_POSITION_WC_STYLE) || defined(COMPUTE_POSITION_WC_ATMOSPHERE)\n  attributes.positionWC = v_positionWC;\n  #endif\n\n  #ifdef HAS_NORMALS\n  // renormalize after interpolation\n  attributes.normalEC = normalize(v_normalEC);\n  #endif\n\n  #ifdef HAS_TANGENTS\n  attributes.tangentEC = normalize(v_tangentEC);\n  #endif\n\n  #ifdef HAS_BITANGENTS\n  attributes.bitangentEC = normalize(v_bitangentEC);\n  #endif\n\n  // Everything else is dynamically generated in GeometryPipelineStage\n  setDynamicVaryings(attributes);\n}\n"},575581:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="vec4 geometryStage(inout ProcessedAttributes attributes, mat4 modelView, mat3 normal)\n{\n    vec4 computedPosition;\n\n    // Compute positions in different coordinate systems\n    vec3 positionMC = attributes.positionMC;\n    v_positionMC = positionMC;\n    v_positionEC = (modelView * vec4(positionMC, 1.0)).xyz;\n\n    #if defined(USE_2D_POSITIONS) || defined(USE_2D_INSTANCING)\n    vec3 position2D = attributes.position2D;\n    vec3 positionEC = (u_modelView2D * vec4(position2D, 1.0)).xyz;\n    computedPosition = czm_projection * vec4(positionEC, 1.0);\n    #else\n    computedPosition = czm_projection * vec4(v_positionEC, 1.0);\n    #endif\n\n    // Sometimes the custom shader and/or style needs this\n    #if defined(COMPUTE_POSITION_WC_CUSTOM_SHADER) || defined(COMPUTE_POSITION_WC_STYLE) || defined(COMPUTE_POSITION_WC_ATMOSPHERE) || defined(ENABLE_CLIPPING_POLYGONS)\n    // Note that this is a 32-bit position which may result in jitter on small\n    // scales.\n    v_positionWC = (czm_model * vec4(positionMC, 1.0)).xyz;\n    #endif\n\n    #ifdef HAS_NORMALS\n    v_normalEC = normalize(normal * attributes.normalMC);\n    #endif\n\n    #ifdef HAS_TANGENTS\n    v_tangentEC = normalize(normal * attributes.tangentMC);\n    #endif\n\n    #ifdef HAS_BITANGENTS\n    v_bitangentEC = normalize(normal * attributes.bitangentMC);\n    #endif\n\n    // All other varyings need to be dynamically generated in\n    // GeometryPipelineStage\n    setDynamicVaryings(attributes);\n\n    return computedPosition;\n}\n"},490129:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="#ifdef DIFFUSE_IBL\nvec3 sampleDiffuseEnvironment(vec3 cubeDir)\n{\n    #ifdef CUSTOM_SPHERICAL_HARMONICS\n        return czm_sphericalHarmonics(cubeDir, model_sphericalHarmonicCoefficients); \n    #else\n        return czm_sphericalHarmonics(cubeDir, czm_sphericalHarmonicCoefficients); \n    #endif\n}\n#endif\n\n#ifdef SPECULAR_IBL\nvec3 sampleSpecularEnvironment(vec3 cubeDir, float roughness)\n{\n    #ifdef CUSTOM_SPECULAR_IBL\n        float lod = roughness * model_specularEnvironmentMapsMaximumLOD;\n        return czm_textureCube(model_specularEnvironmentMaps, cubeDir, lod).rgb;\n    #else\n        float lod = roughness * czm_specularEnvironmentMapsMaximumLOD;\n        return czm_textureCube(czm_specularEnvironmentMaps, cubeDir, lod).rgb;\n    #endif\n}\nvec3 computeSpecularIBL(vec3 cubeDir, float NdotV, vec3 f0, float roughness)\n{\n    // see https://bruop.github.io/ibl/ at Single Scattering Results\n    // Roughness dependent fresnel, from Fdez-Aguera\n    vec3 f90 = max(vec3(1.0 - roughness), f0);\n    vec3 F = fresnelSchlick2(f0, f90, NdotV);\n\n    vec2 brdfLut = texture(czm_brdfLut, vec2(NdotV, roughness)).rg;\n    vec3 specularSample = sampleSpecularEnvironment(cubeDir, roughness);\n\n    return specularSample * (F * brdfLut.x + brdfLut.y);\n}\n#endif\n\n#if defined(DIFFUSE_IBL) || defined(SPECULAR_IBL)\n/**\n * Compute the light contributions from environment maps and spherical harmonic coefficients.\n * See Fdez-Aguera, https://www.jcgt.org/published/0008/01/03/paper.pdf, for explanation\n * of the single- and multi-scattering terms.\n *\n * @param {vec3} viewDirectionEC Unit vector pointing from the fragment to the eye position.\n * @param {vec3} normalEC The surface normal in eye coordinates.\n * @param {czm_modelMaterial} The material properties.\n * @return {vec3} The computed HDR color.\n */\nvec3 textureIBL(vec3 viewDirectionEC, vec3 normalEC, czm_modelMaterial material) {\n    vec3 f0 = material.specular;\n    float roughness = material.roughness;\n    float specularWeight = 1.0;\n    #ifdef USE_SPECULAR\n        specularWeight = material.specularWeight;\n    #endif\n    float NdotV = clamp(dot(normalEC, viewDirectionEC), 0.0, 1.0);\n\n    // see https://bruop.github.io/ibl/ at Single Scattering Results\n    // Roughness dependent fresnel, from Fdez-Aguera\n    vec3 f90 = max(vec3(1.0 - roughness), f0);\n    vec3 singleScatterFresnel = fresnelSchlick2(f0, f90, NdotV);\n\n    vec2 brdfLut = texture(czm_brdfLut, vec2(NdotV, roughness)).rg;\n    vec3 FssEss = specularWeight * (singleScatterFresnel * brdfLut.x + brdfLut.y);\n\n    #ifdef DIFFUSE_IBL\n        vec3 normalMC = normalize(model_iblReferenceFrameMatrix * normalEC);\n        vec3 irradiance = sampleDiffuseEnvironment(normalMC);\n\n        vec3 averageFresnel = f0 + (1.0 - f0) / 21.0;\n        float Ems = specularWeight * (1.0 - brdfLut.x - brdfLut.y);\n        vec3 FmsEms = FssEss * averageFresnel * Ems / (1.0 - averageFresnel * Ems);\n        vec3 dielectricScattering = (1.0 - FssEss - FmsEms) * material.diffuse;\n        vec3 diffuseContribution = irradiance * (FmsEms + dielectricScattering) * model_iblFactor.x;\n    #else\n        vec3 diffuseContribution = vec3(0.0);\n    #endif\n\n    #ifdef USE_ANISOTROPY\n        // Bend normal to account for anisotropic distortion of specular reflection\n        vec3 anisotropyDirection = material.anisotropicB;\n        vec3 anisotropicTangent = cross(anisotropyDirection, viewDirectionEC);\n        vec3 anisotropicNormal = cross(anisotropicTangent, anisotropyDirection);\n        float bendFactor = 1.0 - material.anisotropyStrength * (1.0 - roughness);\n        float bendFactorPow4 = bendFactor * bendFactor * bendFactor * bendFactor;\n        vec3 bentNormal = normalize(mix(anisotropicNormal, normalEC, bendFactorPow4));\n        vec3 reflectEC = reflect(-viewDirectionEC, bentNormal);\n    #else\n        vec3 reflectEC = reflect(-viewDirectionEC, normalEC);\n    #endif\n\n    #ifdef SPECULAR_IBL\n        vec3 reflectMC = normalize(model_iblReferenceFrameMatrix * reflectEC);\n        vec3 radiance = sampleSpecularEnvironment(reflectMC, roughness);\n        vec3 specularContribution = radiance * FssEss * model_iblFactor.y;\n    #else\n        vec3 specularContribution = vec3(0.0);\n    #endif\n\n    return diffuseContribution + specularContribution;\n}\n#endif\n"},75899:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="mat4 getInstancingTransform()\n{\n    mat4 instancingTransform;\n\n    #ifdef HAS_INSTANCE_MATRICES\n    instancingTransform = mat4(\n        a_instancingTransformRow0.x, a_instancingTransformRow1.x, a_instancingTransformRow2.x, 0.0, // Column 1\n        a_instancingTransformRow0.y, a_instancingTransformRow1.y, a_instancingTransformRow2.y, 0.0, // Column 2\n        a_instancingTransformRow0.z, a_instancingTransformRow1.z, a_instancingTransformRow2.z, 0.0, // Column 3\n        a_instancingTransformRow0.w, a_instancingTransformRow1.w, a_instancingTransformRow2.w, 1.0  // Column 4\n    );\n    #else\n    vec3 translation = vec3(0.0, 0.0, 0.0);\n    vec3 scale = vec3(1.0, 1.0, 1.0);\n    \n        #ifdef HAS_INSTANCE_TRANSLATION\n        translation = a_instanceTranslation;\n        #endif\n        #ifdef HAS_INSTANCE_SCALE\n        scale = a_instanceScale;\n        #endif\n\n    instancingTransform = mat4(\n        scale.x, 0.0, 0.0, 0.0,\n        0.0, scale.y, 0.0, 0.0,\n        0.0, 0.0, scale.z, 0.0,\n        translation.x, translation.y, translation.z, 1.0\n    ); \n    #endif\n\n    return instancingTransform;\n}\n\n#ifdef USE_2D_INSTANCING\nmat4 getInstancingTransform2D()\n{\n    mat4 instancingTransform2D;\n\n    #ifdef HAS_INSTANCE_MATRICES\n    instancingTransform2D = mat4(\n        a_instancingTransform2DRow0.x, a_instancingTransform2DRow1.x, a_instancingTransform2DRow2.x, 0.0, // Column 1\n        a_instancingTransform2DRow0.y, a_instancingTransform2DRow1.y, a_instancingTransform2DRow2.y, 0.0, // Column 2\n        a_instancingTransform2DRow0.z, a_instancingTransform2DRow1.z, a_instancingTransform2DRow2.z, 0.0, // Column 3\n        a_instancingTransform2DRow0.w, a_instancingTransform2DRow1.w, a_instancingTransform2DRow2.w, 1.0  // Column 4\n    );\n    #else\n    vec3 translation2D = vec3(0.0, 0.0, 0.0);\n    vec3 scale = vec3(1.0, 1.0, 1.0);\n    \n        #ifdef HAS_INSTANCE_TRANSLATION\n        translation2D = a_instanceTranslation2D;\n        #endif\n        #ifdef HAS_INSTANCE_SCALE\n        scale = a_instanceScale;\n        #endif\n\n    instancingTransform2D = mat4(\n        scale.x, 0.0, 0.0, 0.0,\n        0.0, scale.y, 0.0, 0.0,\n        0.0, 0.0, scale.z, 0.0,\n        translation2D.x, translation2D.y, translation2D.z, 1.0\n    ); \n    #endif\n\n    return instancingTransform2D;\n}\n#endif\n"},295673:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void instancingStage(inout ProcessedAttributes attributes) \n{\n    vec3 positionMC = attributes.positionMC;\n    \n    mat4 instancingTransform = getInstancingTransform();\n    \n    attributes.positionMC = (instancingTransform * vec4(positionMC, 1.0)).xyz;\n\n    #ifdef HAS_NORMALS\n    vec3 normalMC = attributes.normalMC;\n    attributes.normalMC = (instancingTransform * vec4(normalMC, 0.0)).xyz;\n    #endif\n\n    #ifdef USE_2D_INSTANCING\n    mat4 instancingTransform2D = getInstancingTransform2D();\n    attributes.position2D = (instancingTransform2D * vec4(positionMC, 1.0)).xyz;\n    #endif\n}\n"},370988:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void legacyInstancingStage(\n    inout ProcessedAttributes attributes,\n    out mat4 instanceModelView,\n    out mat3 instanceModelViewInverseTranspose)\n{\n    vec3 positionMC = attributes.positionMC;\n\n    mat4 instancingTransform = getInstancingTransform();\n \n    mat4 instanceModel = instancingTransform * u_instance_nodeTransform;\n    instanceModelView = u_instance_modifiedModelView;\n    instanceModelViewInverseTranspose = mat3(u_instance_modifiedModelView * instanceModel);\n\n    attributes.positionMC = (instanceModel * vec4(positionMC, 1.0)).xyz;\n    \n    #ifdef USE_2D_INSTANCING\n    mat4 instancingTransform2D = getInstancingTransform2D();\n    attributes.position2D = (instancingTransform2D * vec4(positionMC, 1.0)).xyz;\n    #endif\n}\n"},419421:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="#ifdef USE_IBL_LIGHTING\nvec3 computeIBL(vec3 position, vec3 normal, vec3 lightDirection, vec3 lightColorHdr, czm_modelMaterial material)\n{\n    #if defined(DIFFUSE_IBL) || defined(SPECULAR_IBL)\n        // Environment maps were provided, use them for IBL\n        vec3 viewDirection = -normalize(position);\n        vec3 iblColor = textureIBL(viewDirection, normal, material);\n        return iblColor;\n    #endif\n    \n    return vec3(0.0);\n}\n#endif\n\n#ifdef USE_CLEARCOAT\nvec3 addClearcoatReflection(vec3 baseLayerColor, vec3 position, vec3 lightDirection, vec3 lightColorHdr, czm_modelMaterial material)\n{\n    vec3 viewDirection = -normalize(position);\n    vec3 halfwayDirection = normalize(viewDirection + lightDirection);\n    vec3 normal = material.clearcoatNormal;\n    float NdotL = clamp(dot(normal, lightDirection), 0.001, 1.0);\n\n    // clearcoatF0 = vec3(pow((ior - 1.0) / (ior + 1.0), 2.0)), but without KHR_materials_ior, ior is a constant 1.5.\n    vec3 f0 = vec3(0.04);\n    vec3 f90 = vec3(1.0);\n    // Note: clearcoat Fresnel computed with dot(n, v) instead of dot(v, h).\n    // This is to make it energy conserving with a simple layering function.\n    float NdotV = clamp(dot(normal, viewDirection), 0.0, 1.0);\n    vec3 F = fresnelSchlick2(f0, f90, NdotV);\n\n    // compute specular reflection from direct lighting\n    float roughness = material.clearcoatRoughness;\n    float alphaRoughness = roughness * roughness;\n    float directStrength = computeDirectSpecularStrength(normal, lightDirection, viewDirection, halfwayDirection, alphaRoughness);\n    vec3 directReflection = F * directStrength * NdotL;\n    vec3 color = lightColorHdr * directReflection;\n\n    #ifdef SPECULAR_IBL\n        // Find the direction in which to sample the environment map\n        vec3 reflectMC = normalize(model_iblReferenceFrameMatrix * reflect(-viewDirection, normal));\n        vec3 iblColor = computeSpecularIBL(reflectMC, NdotV, f0, roughness);\n        color += iblColor * material.occlusion;\n    #endif\n\n    float clearcoatFactor = material.clearcoatFactor;\n    vec3 clearcoatColor = color * clearcoatFactor;\n\n    // Dim base layer based on transmission loss through clearcoat\n    return baseLayerColor * (1.0 - clearcoatFactor * F) + clearcoatColor;\n}\n#endif\n\n#if defined(LIGHTING_PBR) && defined(HAS_NORMALS)\nvec3 computePbrLighting(in czm_modelMaterial material, in vec3 position)\n{\n    #ifdef USE_CUSTOM_LIGHT_COLOR\n        vec3 lightColorHdr = model_lightColorHdr;\n    #else\n        vec3 lightColorHdr = czm_lightColorHdr;\n    #endif\n\n    vec3 viewDirection = -normalize(position);\n    vec3 normal = material.normalEC;\n    vec3 lightDirection = normalize(czm_lightDirectionEC);\n\n    vec3 directLighting = czm_pbrLighting(viewDirection, normal, lightDirection, material);\n    vec3 directColor = lightColorHdr * directLighting;\n\n    // Accumulate colors from base layer\n    vec3 color = directColor + material.emissive;\n    #ifdef USE_IBL_LIGHTING\n        color += computeIBL(position, normal, lightDirection, lightColorHdr, material);\n    #endif\n\n    #ifdef USE_CLEARCOAT\n        color = addClearcoatReflection(color, position, lightDirection, lightColorHdr, material);\n    #endif\n\n    return color;\n}\n#endif\n\n/**\n * Compute the material color under the current lighting conditions.\n * All other material properties are passed through so further stages\n * have access to them.\n *\n * @param {czm_modelMaterial} material The material properties from {@MaterialStageFS}\n * @param {ProcessedAttributes} attributes\n */\nvoid lightingStage(inout czm_modelMaterial material, ProcessedAttributes attributes)\n{\n    #ifdef LIGHTING_PBR\n        #ifdef HAS_NORMALS\n            vec3 color = computePbrLighting(material, attributes.positionEC);\n        #else\n            vec3 color = material.diffuse * material.occlusion + material.emissive;\n        #endif\n        // In HDR mode, the frame buffer is in linear color space. The\n        // post-processing stages (see PostProcessStageCollection) will handle\n        // tonemapping. However, if HDR is not enabled, we must tonemap else large\n        // values may be clamped to 1.0\n        #ifndef HDR\n            color = czm_pbrNeutralTonemapping(color);\n        #endif\n    #else // unlit\n        vec3 color = material.diffuse;\n    #endif\n\n    #ifdef HAS_POINT_CLOUD_COLOR_STYLE\n        // The colors resulting from point cloud styles are adjusted differently.\n        color = czm_gammaCorrect(color);\n    #elif !defined(HDR)\n        // If HDR is not enabled, the frame buffer stores sRGB colors rather than\n        // linear colors so the linear value must be converted.\n        color = czm_linearToSrgb(color);\n    #endif\n\n    material.diffuse = color;\n}\n"},563402:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="// If the style color is white, it implies the feature has not been styled.\nbool isDefaultStyleColor(vec3 color)\n{\n    return all(greaterThan(color, vec3(1.0 - czm_epsilon3)));\n}\n\nvec3 blend(vec3 sourceColor, vec3 styleColor, float styleColorBlend)\n{\n    vec3 blendColor = mix(sourceColor, styleColor, styleColorBlend);\n    vec3 color = isDefaultStyleColor(styleColor.rgb) ? sourceColor : blendColor;\n    return color;\n}\n\nvec2 computeTextureTransform(vec2 texCoord, mat3 textureTransform)\n{\n    return vec2(textureTransform * vec3(texCoord, 1.0));\n}\n\n#ifdef HAS_NORMAL_TEXTURE\nvec2 getNormalTexCoords()\n{\n    vec2 texCoord = TEXCOORD_NORMAL;\n    #ifdef HAS_NORMAL_TEXTURE_TRANSFORM\n        texCoord = vec2(u_normalTextureTransform * vec3(texCoord, 1.0));\n    #endif\n    return texCoord;\n}\n#endif\n\n#if defined(HAS_NORMAL_TEXTURE) || defined(HAS_CLEARCOAT_NORMAL_TEXTURE)\nvec3 computeTangent(in vec3 position, in vec2 normalTexCoords)\n{\n    vec2 tex_dx = dFdx(normalTexCoords);\n    vec2 tex_dy = dFdy(normalTexCoords);\n    float determinant = tex_dx.x * tex_dy.y - tex_dy.x * tex_dx.y;\n    vec3 tangent = tex_dy.t * dFdx(position) - tex_dx.t * dFdy(position);\n    return tangent / determinant;\n}\n#endif\n\n#ifdef USE_ANISOTROPY\nstruct NormalInfo {\n    vec3 tangent;\n    vec3 bitangent;\n    vec3 normal;\n    vec3 geometryNormal;\n};\n\nNormalInfo getNormalInfo(ProcessedAttributes attributes)\n{\n    vec3 geometryNormal = attributes.normalEC;\n    #ifdef HAS_NORMAL_TEXTURE\n        vec2 normalTexCoords = getNormalTexCoords();\n    #endif\n\n    #ifdef HAS_BITANGENTS\n        vec3 tangent = attributes.tangentEC;\n        vec3 bitangent = attributes.bitangentEC;\n    #else // Assume HAS_NORMAL_TEXTURE\n        vec3 tangent = computeTangent(attributes.positionEC, normalTexCoords);\n        tangent = normalize(tangent - geometryNormal * dot(geometryNormal, tangent));\n        vec3 bitangent = normalize(cross(geometryNormal, tangent));\n    #endif\n\n    #ifdef HAS_NORMAL_TEXTURE\n        mat3 tbn = mat3(tangent, bitangent, geometryNormal);\n        vec3 normalSample = texture(u_normalTexture, normalTexCoords).rgb;\n        normalSample = 2.0 * normalSample - 1.0;\n        #ifdef HAS_NORMAL_TEXTURE_SCALE\n            normalSample.xy *= u_normalTextureScale;\n        #endif\n        vec3 normal = normalize(tbn * normalSample);\n    #else\n        vec3 normal = geometryNormal;\n    #endif\n\n    #ifdef HAS_DOUBLE_SIDED_MATERIAL\n        if (czm_backFacing()) {\n            tangent *= -1.0;\n            bitangent *= -1.0;\n            normal *= -1.0;\n            geometryNormal *= -1.0;\n        }\n    #endif\n\n    NormalInfo normalInfo;\n    normalInfo.tangent = tangent;\n    normalInfo.bitangent = bitangent;\n    normalInfo.normal = normal;\n    normalInfo.geometryNormal = geometryNormal;\n\n    return normalInfo;\n}\n#endif\n\n#if defined(HAS_NORMAL_TEXTURE) && !defined(HAS_WIREFRAME)\nvec3 getNormalFromTexture(ProcessedAttributes attributes, vec3 geometryNormal)\n{\n    vec2 normalTexCoords = getNormalTexCoords();\n\n    // If HAS_BITANGENTS is set, then HAS_TANGENTS is also set\n    #ifdef HAS_BITANGENTS\n        vec3 t = attributes.tangentEC;\n        vec3 b = attributes.bitangentEC;\n    #else\n        vec3 t = computeTangent(attributes.positionEC, normalTexCoords);\n        t = normalize(t - geometryNormal * dot(geometryNormal, t));\n        vec3 b = normalize(cross(geometryNormal, t));\n    #endif\n\n    mat3 tbn = mat3(t, b, geometryNormal);\n    vec3 normalSample = texture(u_normalTexture, normalTexCoords).rgb;\n    normalSample = 2.0 * normalSample - 1.0;\n    #ifdef HAS_NORMAL_TEXTURE_SCALE\n        normalSample.xy *= u_normalTextureScale;\n    #endif\n    return normalize(tbn * normalSample);\n}\n#endif\n\n#ifdef HAS_CLEARCOAT_NORMAL_TEXTURE\nvec3 getClearcoatNormalFromTexture(ProcessedAttributes attributes, vec3 geometryNormal)\n{\n    vec2 normalTexCoords = TEXCOORD_CLEARCOAT_NORMAL;\n    #ifdef HAS_CLEARCOAT_NORMAL_TEXTURE_TRANSFORM\n        normalTexCoords = vec2(u_clearcoatNormalTextureTransform * vec3(normalTexCoords, 1.0));\n    #endif\n\n    // If HAS_BITANGENTS is set, then HAS_TANGENTS is also set\n    #ifdef HAS_BITANGENTS\n        vec3 t = attributes.tangentEC;\n        vec3 b = attributes.bitangentEC;\n    #else\n        vec3 t = computeTangent(attributes.positionEC, normalTexCoords);\n        t = normalize(t - geometryNormal * dot(geometryNormal, t));\n        vec3 b = normalize(cross(geometryNormal, t));\n    #endif\n\n    mat3 tbn = mat3(t, b, geometryNormal);\n    vec3 normalSample = texture(u_clearcoatNormalTexture, normalTexCoords).rgb;\n    normalSample = 2.0 * normalSample - 1.0;\n    #ifdef HAS_CLEARCOAT_NORMAL_TEXTURE_SCALE\n        normalSample.xy *= u_clearcoatNormalTextureScale;\n    #endif\n    return normalize(tbn * normalSample);\n}\n#endif\n\n#ifdef HAS_NORMALS\nvec3 computeNormal(ProcessedAttributes attributes)\n{\n    // Geometry normal. This is already normalized \n    vec3 normal = attributes.normalEC;\n\n    #if defined(HAS_NORMAL_TEXTURE) && !defined(HAS_WIREFRAME)\n        normal = getNormalFromTexture(attributes, normal);\n    #endif\n\n    #ifdef HAS_DOUBLE_SIDED_MATERIAL\n        if (czm_backFacing()) {\n            normal = -normal;\n        }\n    #endif\n\n    return normal;\n}\n#endif\n\n#ifdef HAS_BASE_COLOR_TEXTURE\nvec4 getBaseColorFromTexture()\n{\n    vec2 baseColorTexCoords = TEXCOORD_BASE_COLOR;\n    #ifdef HAS_BASE_COLOR_TEXTURE_TRANSFORM\n        baseColorTexCoords = computeTextureTransform(baseColorTexCoords, u_baseColorTextureTransform);\n    #endif\n\n    vec4 baseColorWithAlpha = czm_srgbToLinear(texture(u_baseColorTexture, baseColorTexCoords));\n\n    #ifdef HAS_BASE_COLOR_FACTOR\n        baseColorWithAlpha *= u_baseColorFactor;\n    #endif\n\n    return baseColorWithAlpha;\n}\n#endif\n\n#ifdef HAS_EMISSIVE_TEXTURE\nvec3 getEmissiveFromTexture()\n{\n    vec2 emissiveTexCoords = TEXCOORD_EMISSIVE;\n    #ifdef HAS_EMISSIVE_TEXTURE_TRANSFORM\n        emissiveTexCoords = computeTextureTransform(emissiveTexCoords, u_emissiveTextureTransform);\n    #endif\n\n    vec3 emissive = czm_srgbToLinear(texture(u_emissiveTexture, emissiveTexCoords).rgb);\n    #ifdef HAS_EMISSIVE_FACTOR\n        emissive *= u_emissiveFactor;\n    #endif\n\n    return emissive;\n}\n#endif\n\n#if defined(LIGHTING_PBR) && defined(USE_SPECULAR_GLOSSINESS)\nvoid setSpecularGlossiness(inout czm_modelMaterial material)\n{\n    #ifdef HAS_SPECULAR_GLOSSINESS_TEXTURE\n        vec2 specularGlossinessTexCoords = TEXCOORD_SPECULAR_GLOSSINESS;\n        #ifdef HAS_SPECULAR_GLOSSINESS_TEXTURE_TRANSFORM\n            specularGlossinessTexCoords = computeTextureTransform(specularGlossinessTexCoords, u_specularGlossinessTextureTransform);\n        #endif\n\n        vec4 specularGlossiness = czm_srgbToLinear(texture(u_specularGlossinessTexture, specularGlossinessTexCoords));\n        vec3 specular = specularGlossiness.rgb;\n        float glossiness = specularGlossiness.a;\n        #ifdef HAS_LEGACY_SPECULAR_FACTOR\n            specular *= u_legacySpecularFactor;\n        #endif\n\n        #ifdef HAS_GLOSSINESS_FACTOR\n            glossiness *= u_glossinessFactor;\n        #endif\n    #else\n        #ifdef HAS_LEGACY_SPECULAR_FACTOR\n            vec3 specular = clamp(u_legacySpecularFactor, vec3(0.0), vec3(1.0));\n        #else\n            vec3 specular = vec3(1.0);\n        #endif\n\n        #ifdef HAS_GLOSSINESS_FACTOR\n            float glossiness = clamp(u_glossinessFactor, 0.0, 1.0);\n        #else\n            float glossiness = 1.0;\n        #endif\n    #endif\n\n    #ifdef HAS_DIFFUSE_TEXTURE\n        vec2 diffuseTexCoords = TEXCOORD_DIFFUSE;\n        #ifdef HAS_DIFFUSE_TEXTURE_TRANSFORM\n            diffuseTexCoords = computeTextureTransform(diffuseTexCoords, u_diffuseTextureTransform);\n        #endif\n\n        vec4 diffuse = czm_srgbToLinear(texture(u_diffuseTexture, diffuseTexCoords));\n        #ifdef HAS_DIFFUSE_FACTOR\n            diffuse *= u_diffuseFactor;\n        #endif\n    #elif defined(HAS_DIFFUSE_FACTOR)\n        vec4 diffuse = clamp(u_diffuseFactor, vec4(0.0), vec4(1.0));\n    #else\n        vec4 diffuse = vec4(1.0);\n    #endif\n\n    material.diffuse = diffuse.rgb * (1.0 - czm_maximumComponent(specular));\n    // the specular glossiness extension's alpha overrides anything set\n    // by the base material.\n    material.alpha = diffuse.a;\n\n    material.specular = specular;\n\n    // glossiness is the opposite of roughness, but easier for artists to use.\n    material.roughness = 1.0 - glossiness;\n}\n#elif defined(LIGHTING_PBR)\nfloat setMetallicRoughness(inout czm_modelMaterial material)\n{\n    #ifdef HAS_METALLIC_ROUGHNESS_TEXTURE\n        vec2 metallicRoughnessTexCoords = TEXCOORD_METALLIC_ROUGHNESS;\n        #ifdef HAS_METALLIC_ROUGHNESS_TEXTURE_TRANSFORM\n            metallicRoughnessTexCoords = computeTextureTransform(metallicRoughnessTexCoords, u_metallicRoughnessTextureTransform);\n        #endif\n\n        vec3 metallicRoughness = texture(u_metallicRoughnessTexture, metallicRoughnessTexCoords).rgb;\n        float metalness = clamp(metallicRoughness.b, 0.0, 1.0);\n        float roughness = clamp(metallicRoughness.g, 0.0, 1.0);\n        #ifdef HAS_METALLIC_FACTOR\n            metalness = clamp(metalness * u_metallicFactor, 0.0, 1.0);\n        #endif\n\n        #ifdef HAS_ROUGHNESS_FACTOR\n            roughness = clamp(roughness * u_roughnessFactor, 0.0, 1.0);\n        #endif\n    #else\n        #ifdef HAS_METALLIC_FACTOR\n            float metalness = clamp(u_metallicFactor, 0.0, 1.0);\n        #else\n            float metalness = 1.0;\n        #endif\n\n        #ifdef HAS_ROUGHNESS_FACTOR\n            float roughness = clamp(u_roughnessFactor, 0.0, 1.0);\n        #else\n            float roughness = 1.0;\n        #endif\n    #endif\n\n    // dielectrics use f0 = 0.04, metals use albedo as f0\n    const vec3 REFLECTANCE_DIELECTRIC = vec3(0.04);\n    vec3 f0 = mix(REFLECTANCE_DIELECTRIC, material.baseColor.rgb, metalness);\n\n    material.specular = f0;\n\n    // diffuse only applies to dielectrics.\n    material.diffuse = mix(material.baseColor.rgb, vec3(0.0), metalness);\n\n    // This is perceptual roughness. The square of this value is used for direct lighting\n    material.roughness = roughness;\n\n    return metalness;\n}\n#ifdef USE_SPECULAR\nvoid setSpecular(inout czm_modelMaterial material, in float metalness)\n{\n    #ifdef HAS_SPECULAR_TEXTURE\n        vec2 specularTexCoords = TEXCOORD_SPECULAR;\n        #ifdef HAS_SPECULAR_TEXTURE_TRANSFORM\n            specularTexCoords = computeTextureTransform(specularTexCoords, u_specularTextureTransform);\n        #endif\n        float specularWeight = texture(u_specularTexture, specularTexCoords).a;\n        #ifdef HAS_SPECULAR_FACTOR\n            specularWeight *= u_specularFactor;\n        #endif\n    #else\n        #ifdef HAS_SPECULAR_FACTOR\n            float specularWeight = u_specularFactor;\n        #else\n            float specularWeight = 1.0;\n        #endif\n    #endif\n\n    #ifdef HAS_SPECULAR_COLOR_TEXTURE\n        vec2 specularColorTexCoords = TEXCOORD_SPECULAR_COLOR;\n        #ifdef HAS_SPECULAR_COLOR_TEXTURE_TRANSFORM\n            specularColorTexCoords = computeTextureTransform(specularColorTexCoords, u_specularColorTextureTransform);\n        #endif\n        vec3 specularColorSample = texture(u_specularColorTexture, specularColorTexCoords).rgb;\n        vec3 specularColorFactor = czm_srgbToLinear(specularColorSample);\n        #ifdef HAS_SPECULAR_COLOR_FACTOR\n            specularColorFactor *= u_specularColorFactor;\n        #endif\n    #else\n        #ifdef HAS_SPECULAR_COLOR_FACTOR\n            vec3 specularColorFactor = u_specularColorFactor;\n        #else\n            vec3 specularColorFactor = vec3(1.0);\n        #endif\n    #endif\n    material.specularWeight = specularWeight;\n    vec3 f0 = material.specular;\n    vec3 dielectricSpecularF0 = min(f0 * specularColorFactor, vec3(1.0));\n    material.specular = mix(dielectricSpecularF0, material.baseColor.rgb, metalness);\n}\n#endif\n#ifdef USE_ANISOTROPY\nvoid setAnisotropy(inout czm_modelMaterial material, in NormalInfo normalInfo)\n{\n    mat2 rotation = mat2(u_anisotropy.xy, -u_anisotropy.y, u_anisotropy.x);\n    float anisotropyStrength = u_anisotropy.z;\n\n    vec2 direction = vec2(1.0, 0.0);\n    #ifdef HAS_ANISOTROPY_TEXTURE\n        vec2 anisotropyTexCoords = TEXCOORD_ANISOTROPY;\n        #ifdef HAS_ANISOTROPY_TEXTURE_TRANSFORM\n            anisotropyTexCoords = computeTextureTransform(anisotropyTexCoords, u_anisotropyTextureTransform);\n        #endif\n        vec3 anisotropySample = texture(u_anisotropyTexture, anisotropyTexCoords).rgb;\n        direction = anisotropySample.rg * 2.0 - vec2(1.0);\n        anisotropyStrength *= anisotropySample.b;\n    #endif\n\n    direction = rotation * direction;\n    mat3 tbn = mat3(normalInfo.tangent, normalInfo.bitangent, normalInfo.normal);\n    vec3 anisotropicT = tbn * normalize(vec3(direction, 0.0));\n    vec3 anisotropicB = cross(normalInfo.geometryNormal, anisotropicT);\n\n    material.anisotropicT = anisotropicT;\n    material.anisotropicB = anisotropicB;\n    material.anisotropyStrength = anisotropyStrength;\n}\n#endif\n#ifdef USE_CLEARCOAT\nvoid setClearcoat(inout czm_modelMaterial material, in ProcessedAttributes attributes)\n{\n    #ifdef HAS_CLEARCOAT_TEXTURE\n        vec2 clearcoatTexCoords = TEXCOORD_CLEARCOAT;\n        #ifdef HAS_CLEARCOAT_TEXTURE_TRANSFORM\n            clearcoatTexCoords = computeTextureTransform(clearcoatTexCoords, u_clearcoatTextureTransform);\n        #endif\n        float clearcoatFactor = texture(u_clearcoatTexture, clearcoatTexCoords).r;\n        #ifdef HAS_CLEARCOAT_FACTOR\n            clearcoatFactor *= u_clearcoatFactor;\n        #endif\n    #else\n        #ifdef HAS_CLEARCOAT_FACTOR\n            float clearcoatFactor = u_clearcoatFactor;\n        #else\n            // PERFORMANCE_IDEA: this case should turn the whole extension off\n            float clearcoatFactor = 0.0;\n        #endif\n    #endif\n\n    #ifdef HAS_CLEARCOAT_ROUGHNESS_TEXTURE\n        vec2 clearcoatRoughnessTexCoords = TEXCOORD_CLEARCOAT_ROUGHNESS;\n        #ifdef HAS_CLEARCOAT_ROUGHNESS_TEXTURE_TRANSFORM\n            clearcoatRoughnessTexCoords = computeTextureTransform(clearcoatRoughnessTexCoords, u_clearcoatRoughnessTextureTransform);\n        #endif\n        float clearcoatRoughness = texture(u_clearcoatRoughnessTexture, clearcoatRoughnessTexCoords).g;\n        #ifdef HAS_CLEARCOAT_ROUGHNESS_FACTOR\n            clearcoatRoughness *= u_clearcoatRoughnessFactor;\n        #endif\n    #else\n        #ifdef HAS_CLEARCOAT_ROUGHNESS_FACTOR\n            float clearcoatRoughness = u_clearcoatRoughnessFactor;\n        #else\n            float clearcoatRoughness = 0.0;\n        #endif\n    #endif\n\n    material.clearcoatFactor = clearcoatFactor;\n    // This is perceptual roughness. The square of this value is used for direct lighting\n    material.clearcoatRoughness = clearcoatRoughness;\n    #ifdef HAS_CLEARCOAT_NORMAL_TEXTURE\n        material.clearcoatNormal = getClearcoatNormalFromTexture(attributes, attributes.normalEC);\n    #else\n        material.clearcoatNormal = attributes.normalEC;\n    #endif\n}\n#endif\n#endif\n\nvoid materialStage(inout czm_modelMaterial material, ProcessedAttributes attributes, SelectedFeature feature)\n{\n    #ifdef USE_ANISOTROPY\n        NormalInfo normalInfo = getNormalInfo(attributes);\n        material.normalEC = normalInfo.normal;\n    #elif defined(HAS_NORMALS)\n        material.normalEC = computeNormal(attributes);\n    #endif\n\n    vec4 baseColorWithAlpha = vec4(1.0);\n    // Regardless of whether we use PBR, set a base color\n    #ifdef HAS_BASE_COLOR_TEXTURE\n        baseColorWithAlpha = getBaseColorFromTexture();\n    #elif defined(HAS_BASE_COLOR_FACTOR)\n        baseColorWithAlpha = u_baseColorFactor;\n    #endif\n\n    #ifdef HAS_IMAGERY\n    baseColorWithAlpha = blendBaseColorWithImagery(baseColorWithAlpha);\n    #endif // HAS_IMAGERY\n\n    #ifdef HAS_POINT_CLOUD_COLOR_STYLE\n        baseColorWithAlpha = v_pointCloudColor;\n    #elif defined(HAS_COLOR_0)\n        vec4 color = attributes.color_0;\n        // .pnts files store colors in the sRGB color space\n        #ifdef HAS_SRGB_COLOR\n            color = czm_srgbToLinear(color);\n        #endif\n        baseColorWithAlpha *= color;\n    #endif\n\n    #ifdef USE_CPU_STYLING\n        baseColorWithAlpha.rgb = blend(baseColorWithAlpha.rgb, feature.color.rgb, model_colorBlend);\n    #endif\n    material.baseColor = baseColorWithAlpha;\n    material.diffuse = baseColorWithAlpha.rgb;\n    material.alpha = baseColorWithAlpha.a;\n\n    #ifdef HAS_OCCLUSION_TEXTURE\n        vec2 occlusionTexCoords = TEXCOORD_OCCLUSION;\n        #ifdef HAS_OCCLUSION_TEXTURE_TRANSFORM\n            occlusionTexCoords = computeTextureTransform(occlusionTexCoords, u_occlusionTextureTransform);\n        #endif\n        material.occlusion = texture(u_occlusionTexture, occlusionTexCoords).r;\n    #endif\n\n    #ifdef HAS_EMISSIVE_TEXTURE\n        material.emissive = getEmissiveFromTexture();\n    #elif defined(HAS_EMISSIVE_FACTOR)\n        material.emissive = u_emissiveFactor;\n    #endif\n\n    #if defined(LIGHTING_PBR) && defined(USE_SPECULAR_GLOSSINESS)\n        setSpecularGlossiness(material);\n    #elif defined(LIGHTING_PBR)\n        float metalness = setMetallicRoughness(material);\n        #ifdef USE_SPECULAR\n            setSpecular(material, metalness);\n        #endif\n        #ifdef USE_ANISOTROPY\n            setAnisotropy(material, normalInfo);\n        #endif\n        #ifdef USE_CLEARCOAT\n            setClearcoat(material, attributes);\n        #endif\n    #endif\n}\n"},143938:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void metadataStage(\n  out Metadata metadata,\n  out MetadataClass metadataClass,\n  out MetadataStatistics metadataStatistics,\n  ProcessedAttributes attributes\n  )\n{\n  initializeMetadata(metadata, metadataClass, metadataStatistics, attributes);\n}\n"},801202:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void metadataStage(\n  out Metadata metadata,\n  out MetadataClass metadataClass,\n  out MetadataStatistics metadataStatistics,\n  ProcessedAttributes attributes\n  )\n{\n  initializeMetadata(metadata, metadataClass, metadataStatistics, attributes);\n  setMetadataVaryings();\n}\n"},403139:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="#ifdef USE_CLIPPING_PLANES_FLOAT_TEXTURE\nvec4 getClippingPlane(\n    highp sampler2D packedClippingPlanes,\n    int clippingPlaneNumber,\n    mat4 transform\n) {\n    int pixY = clippingPlaneNumber / CLIPPING_PLANES_TEXTURE_WIDTH;\n    int pixX = clippingPlaneNumber - (pixY * CLIPPING_PLANES_TEXTURE_WIDTH);\n    float pixelWidth = 1.0 / float(CLIPPING_PLANES_TEXTURE_WIDTH);\n    float pixelHeight = 1.0 / float(CLIPPING_PLANES_TEXTURE_HEIGHT);\n    float u = (float(pixX) + 0.5) * pixelWidth; // sample from center of pixel\n    float v = (float(pixY) + 0.5) * pixelHeight;\n    vec4 plane = texture(packedClippingPlanes, vec2(u, v));\n    return czm_transformPlane(plane, transform);\n}\n#else\n// Handle uint8 clipping texture instead\nvec4 getClippingPlane(\n    highp sampler2D packedClippingPlanes,\n    int clippingPlaneNumber,\n    mat4 transform\n) {\n    int clippingPlaneStartIndex = clippingPlaneNumber * 2; // clipping planes are two pixels each\n    int pixY = clippingPlaneStartIndex / CLIPPING_PLANES_TEXTURE_WIDTH;\n    int pixX = clippingPlaneStartIndex - (pixY * CLIPPING_PLANES_TEXTURE_WIDTH);\n    float pixelWidth = 1.0 / float(CLIPPING_PLANES_TEXTURE_WIDTH);\n    float pixelHeight = 1.0 / float(CLIPPING_PLANES_TEXTURE_HEIGHT);\n    float u = (float(pixX) + 0.5) * pixelWidth; // sample from center of pixel\n    float v = (float(pixY) + 0.5) * pixelHeight;\n    vec4 oct32 = texture(packedClippingPlanes, vec2(u, v)) * 255.0;\n    vec2 oct = vec2(oct32.x * 256.0 + oct32.y, oct32.z * 256.0 + oct32.w);\n    vec4 plane;\n    plane.xyz = czm_octDecode(oct, 65535.0);\n    plane.w = czm_unpackFloat(texture(packedClippingPlanes, vec2(u + pixelWidth, v)));\n    return czm_transformPlane(plane, transform);\n}\n#endif\n\nfloat clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix) {\n    vec4 position = czm_windowToEyeCoordinates(fragCoord);\n    vec3 clipNormal = vec3(0.0);\n    vec3 clipPosition = vec3(0.0);\n    float pixelWidth = czm_metersPerPixel(position);\n    \n    #ifdef UNION_CLIPPING_REGIONS\n    float clipAmount; // For union planes, we want to get the min distance. So we set the initial value to the first plane distance in the loop below.\n    #else\n    float clipAmount = 0.0;\n    bool clipped = true;\n    #endif\n\n    for (int i = 0; i < CLIPPING_PLANES_LENGTH; ++i) {\n        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);\n        clipNormal = clippingPlane.xyz;\n        clipPosition = -clippingPlane.w * clipNormal;\n        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;\n        \n        #ifdef UNION_CLIPPING_REGIONS\n        clipAmount = czm_branchFreeTernary(i == 0, amount, min(amount, clipAmount));\n        if (amount <= 0.0) {\n            discard;\n        }\n        #else\n        clipAmount = max(amount, clipAmount);\n        clipped = clipped && (amount <= 0.0);\n        #endif\n    }\n\n    #ifndef UNION_CLIPPING_REGIONS\n    if (clipped) {\n        discard;\n    }\n    #endif\n    \n    return clipAmount;\n}\n\nvoid modelClippingPlanesStage(inout vec4 color)\n{\n    float clipDistance = clip(gl_FragCoord, model_clippingPlanes, model_clippingPlanesMatrix);\n    vec4 clippingPlanesEdgeColor = vec4(1.0);\n    clippingPlanesEdgeColor.rgb = model_clippingPlanesEdgeStyle.rgb;\n    float clippingPlanesEdgeWidth = model_clippingPlanesEdgeStyle.a;\n    \n    if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) {\n        color = clippingPlanesEdgeColor;\n    }\n}\n"},521791:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void modelClippingPolygonsStage()\n{\n    vec2 clippingPosition = v_clippingPosition;\n    int regionIndex = v_regionIndex;\n    czm_clipPolygons(model_clippingDistance, CLIPPING_POLYGON_REGIONS_LENGTH, clippingPosition, regionIndex);\n}\n"},212143:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void modelClippingPolygonsStage(ProcessedAttributes attributes)\n{\n    vec2 sphericalLatLong = czm_approximateSphericalCoordinates(v_positionWC);\n    sphericalLatLong.y = czm_branchFreeTernary(sphericalLatLong.y < czm_pi, sphericalLatLong.y, sphericalLatLong.y - czm_twoPi);\n\n    vec2 minDistance = vec2(czm_infinity);\n    v_regionIndex = -1;\n    v_clippingPosition = vec2(czm_infinity);\n\n    for (int regionIndex = 0; regionIndex < CLIPPING_POLYGON_REGIONS_LENGTH; regionIndex++) {\n        vec4 extents = czm_unpackClippingExtents(model_clippingExtents, regionIndex);\n        vec2 rectUv = (sphericalLatLong.yx - extents.yx) * extents.wz;\n\n        vec2 clamped = clamp(rectUv, vec2(0.0), vec2(1.0));\n        vec2 distance = abs(rectUv - clamped) * extents.wz;\n        \n        if (minDistance.x > distance.x || minDistance.y > distance.y) {\n            minDistance = distance;\n            v_clippingPosition = rectUv;\n        }\n\n        float threshold = 0.01;\n        if (rectUv.x > threshold && rectUv.y > threshold && rectUv.x < 1.0 - threshold && rectUv.y < 1.0 - threshold) {\n            v_regionIndex = regionIndex;\n        }\n    }\n}\n"},325161:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void modelColorStage(inout czm_modelMaterial material)\n{\n    material.diffuse = mix(material.diffuse, model_color.rgb, model_colorBlend);\n    float highlight = ceil(model_colorBlend);\n    material.diffuse *= mix(model_color.rgb, vec3(1.0), highlight);\n    material.alpha *= model_color.a;\n}\n"},261126:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="\nprecision highp float;\n\nczm_modelMaterial defaultModelMaterial()\n{\n    czm_modelMaterial material;\n    material.diffuse = vec3(0.0);\n    material.specular = vec3(1.0);\n    material.roughness = 1.0;\n    material.occlusion = 1.0;\n    material.normalEC = vec3(0.0, 0.0, 1.0);\n    material.emissive = vec3(0.0);\n    material.alpha = 1.0;\n    return material;\n}\n\nvec4 handleAlpha(vec3 color, float alpha)\n{\n    #ifdef ALPHA_MODE_MASK\n    if (alpha < u_alphaCutoff) {\n        discard;\n    }\n    #endif\n\n    return vec4(color, alpha);\n}\n\nSelectedFeature selectedFeature;\n\nvoid main()\n{\n    #ifdef HAS_POINT_CLOUD_SHOW_STYLE\n        if (v_pointCloudShow == 0.0)\n        {\n            discard;\n        }\n    #endif\n\n    #ifdef HAS_MODEL_SPLITTER\n    modelSplitterStage();\n    #endif\n\n    czm_modelMaterial material = defaultModelMaterial();\n\n    ProcessedAttributes attributes;\n    geometryStage(attributes);\n\n    FeatureIds featureIds;\n    featureIdStage(featureIds, attributes);\n\n    Metadata metadata;\n    MetadataClass metadataClass;\n    MetadataStatistics metadataStatistics;\n    metadataStage(metadata, metadataClass, metadataStatistics, attributes);\n\n    //========================================================================\n    // When not picking metadata START\n    #ifndef METADATA_PICKING_ENABLED\n\n    #ifdef HAS_SELECTED_FEATURE_ID\n    selectedFeatureIdStage(selectedFeature, featureIds);\n    #endif\n\n    #ifndef CUSTOM_SHADER_REPLACE_MATERIAL\n    materialStage(material, attributes, selectedFeature);\n    #endif\n\n    #ifdef HAS_CUSTOM_FRAGMENT_SHADER\n    customShaderStage(material, attributes, featureIds, metadata, metadataClass, metadataStatistics);\n    #endif\n\n    lightingStage(material, attributes);\n\n    #ifdef HAS_SELECTED_FEATURE_ID\n    cpuStylingStage(material, selectedFeature);\n    #endif\n\n    #ifdef HAS_MODEL_COLOR\n    modelColorStage(material);\n    #endif\n\n    #ifdef HAS_PRIMITIVE_OUTLINE\n    primitiveOutlineStage(material);\n    #endif\n\n    vec4 color = handleAlpha(material.diffuse, material.alpha);\n\n    // When not picking metadata END\n    //========================================================================\n    #else\n    //========================================================================\n    // When picking metadata START\n\n    vec4 metadataValues = vec4(0.0, 0.0, 0.0, 0.0);\n    metadataPickingStage(metadata, metadataClass, metadataValues);\n    vec4 color = metadataValues;\n\n    #endif\n    // When picking metadata END\n    //========================================================================\n\n    #ifdef HAS_CLIPPING_PLANES\n    modelClippingPlanesStage(color);\n    #endif\n\n    #ifdef ENABLE_CLIPPING_POLYGONS\n    modelClippingPolygonsStage();\n    #endif\n\n    //========================================================================\n    // When not picking metadata START\n    #ifndef METADATA_PICKING_ENABLED\n\n    #if defined(HAS_SILHOUETTE) && defined(HAS_NORMALS)\n    silhouetteStage(color);\n    #endif\n\n    #ifdef HAS_ATMOSPHERE\n    atmosphereStage(color, attributes);\n    #endif\n\n    #endif\n    // When not picking metadata END\n    //========================================================================\n\n    out_FragColor = color;\n}\n\n"},221334:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void silhouetteStage(inout vec4 color) {\n    if(model_silhouettePass) {\n        color = czm_gammaCorrect(model_silhouetteColor);\n    }\n}"},980678:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void silhouetteStage(in ProcessedAttributes attributes, inout vec4 positionClip) {\n     #ifdef HAS_NORMALS\n     if(model_silhouettePass) {\n          vec3 normal = normalize(czm_normal3D * attributes.normalMC);\n          normal.x *= czm_projection[0][0];\n          normal.y *= czm_projection[1][1];\n          positionClip.xy += normal.xy * positionClip.w * model_silhouetteSize * czm_pixelRatio / czm_viewport.z;\n    }\n    #endif\n}\n"},768601:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void modelSplitterStage()\n{\n    // Don't split when rendering the shadow map, because it is rendered from\n    // the perspective of a totally different camera.\n#ifndef SHADOW_MAP\n    if (model_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard;\n    if (model_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard;\n#endif\n}\n"},501782:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="precision highp float;\n\nczm_modelVertexOutput defaultVertexOutput(vec3 positionMC) {\n    czm_modelVertexOutput vsOutput;\n    vsOutput.positionMC = positionMC;\n    vsOutput.pointSize = 1.0;\n    return vsOutput;\n}\n\nvoid main()\n{\n    // Initialize the attributes struct with all\n    // attributes except quantized ones.\n    ProcessedAttributes attributes;\n    initializeAttributes(attributes);\n\n    #ifdef HAS_IMAGERY\n    initializeImageryAttributes();\n    #endif\n\n    // Dequantize the quantized ones and add them to the\n    // attributes struct.\n    #ifdef USE_DEQUANTIZATION\n    dequantizationStage(attributes);\n    #endif\n\n    #ifdef HAS_MORPH_TARGETS\n    morphTargetsStage(attributes);\n    #endif\n\n    #ifdef HAS_SKINNING\n    skinningStage(attributes);\n    #endif\n\n    #ifdef HAS_PRIMITIVE_OUTLINE\n    primitiveOutlineStage();\n    #endif\n\n    // Compute the bitangent according to the formula in the glTF spec.\n    // Normal and tangents can be affected by morphing and skinning, so\n    // the bitangent should not be computed until their values are finalized.\n    #ifdef HAS_BITANGENTS\n    attributes.bitangentMC = normalize(cross(attributes.normalMC, attributes.tangentMC) * attributes.tangentSignMC);\n    #endif\n\n    FeatureIds featureIds;\n    featureIdStage(featureIds, attributes);\n\n    #ifdef HAS_SELECTED_FEATURE_ID\n    SelectedFeature feature;\n    selectedFeatureIdStage(feature, featureIds);\n    // Handle any show properties that come from the style.\n    cpuStylingStage(attributes.positionMC, feature);\n    #endif\n\n    #if defined(USE_2D_POSITIONS) || defined(USE_2D_INSTANCING)\n    // The scene mode 2D pipeline stage and instancing stage add a different\n    // model view matrix to accurately project the model to 2D. However, the\n    // output positions and normals should be transformed by the 3D matrices\n    // to keep the data the same for the fragment shader.\n    mat4 modelView = czm_modelView3D;\n    mat3 normal = czm_normal3D;\n    #else\n    // These are used for individual model projection because they will\n    // automatically change based on the scene mode.\n    mat4 modelView = czm_modelView;\n    mat3 normal = czm_normal;\n    #endif\n\n    // Update the position for this instance in place\n    #ifdef HAS_INSTANCING\n\n        // The legacy instance stage is used when rendering i3dm models that\n        // encode instances transforms in world space, as opposed to glTF models\n        // that use EXT_mesh_gpu_instancing, where instance transforms are encoded\n        // in object space.\n        #ifdef USE_LEGACY_INSTANCING\n        mat4 instanceModelView;\n        mat3 instanceModelViewInverseTranspose;\n\n        legacyInstancingStage(attributes, instanceModelView, instanceModelViewInverseTranspose);\n\n        modelView = instanceModelView;\n        normal = instanceModelViewInverseTranspose;\n        #else\n        instancingStage(attributes);\n        #endif\n\n        #ifdef USE_PICKING\n        v_pickColor = a_pickColor;\n        #endif\n\n    #endif\n\n    Metadata metadata;\n    MetadataClass metadataClass;\n    MetadataStatistics metadataStatistics;\n    metadataStage(metadata, metadataClass, metadataStatistics, attributes);\n\n    #ifdef HAS_VERTICAL_EXAGGERATION\n    verticalExaggerationStage(attributes);\n    #endif\n\n    #ifdef HAS_CUSTOM_VERTEX_SHADER\n    czm_modelVertexOutput vsOutput = defaultVertexOutput(attributes.positionMC);\n    customShaderStage(vsOutput, attributes, featureIds, metadata, metadataClass, metadataStatistics);\n    #endif\n\n    // Compute the final position in each coordinate system needed.\n    // This returns the value that will be assigned to gl_Position.\n    vec4 positionClip = geometryStage(attributes, modelView, normal);\n\n    // This must go after the geometry stage as it needs v_positionWC\n    #ifdef HAS_ATMOSPHERE\n    atmosphereStage(attributes);\n    #endif\n\n    #ifdef ENABLE_CLIPPING_POLYGONS\n    modelClippingPolygonsStage(attributes);\n    #endif\n\n    #ifdef HAS_SILHOUETTE\n    silhouetteStage(attributes, positionClip);\n    #endif\n\n    #ifdef HAS_POINT_CLOUD_SHOW_STYLE\n    float show = pointCloudShowStylingStage(attributes, metadata);\n    #else\n    float show = 1.0;\n    #endif\n\n    #ifdef HAS_POINT_CLOUD_BACK_FACE_CULLING\n    show *= pointCloudBackFaceCullingStage();\n    #endif\n\n    #ifdef HAS_POINT_CLOUD_COLOR_STYLE\n    v_pointCloudColor = pointCloudColorStylingStage(attributes, metadata);\n    #endif\n\n    #ifdef PRIMITIVE_TYPE_POINTS\n        #ifdef HAS_CUSTOM_VERTEX_SHADER\n        gl_PointSize = vsOutput.pointSize;\n        #elif defined(HAS_POINT_CLOUD_POINT_SIZE_STYLE) || defined(HAS_POINT_CLOUD_ATTENUATION)\n        gl_PointSize = pointCloudPointSizeStylingStage(attributes, metadata);\n        #else\n        gl_PointSize = 1.0;\n        #endif\n        \n        gl_PointSize *= show;\n    #endif\n\n    // Important NOT to compute gl_Position = show * positionClip or we hit:\n    // https://github.com/CesiumGS/cesium/issues/11270\n    //\n    // We will discard points with v_pointCloudShow == 0 in the fragment shader.\n    gl_Position = positionClip;\n\n    #ifdef HAS_POINT_CLOUD_SHOW_STYLE\n    v_pointCloudShow = show;\n    #endif\n}\n"},828077:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void morphTargetsStage(inout ProcessedAttributes attributes) \n{\n    vec3 positionMC = attributes.positionMC;\n    attributes.positionMC = getMorphedPosition(positionMC);\n\n    #ifdef HAS_NORMALS\n    vec3 normalMC = attributes.normalMC;\n    attributes.normalMC = getMorphedNormal(normalMC);\n    #endif\n\n    #ifdef HAS_TANGENTS\n    vec3 tangentMC = attributes.tangentMC;\n    attributes.tangentMC = getMorphedTangent(tangentMC);\n    #endif\n}"},7562:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="float getPointSizeFromAttenuation(vec3 positionEC) {\n  // Variables are packed into a single vector to minimize gl.uniformXXX() calls\n  float pointSize = model_pointCloudParameters.x;\n  float geometricError = model_pointCloudParameters.y;\n  float depthMultiplier = model_pointCloudParameters.z;\n\n  float depth = -positionEC.z;\n  return min((geometricError / depth) * depthMultiplier, pointSize);\n}\n\n#ifdef HAS_POINT_CLOUD_SHOW_STYLE\nfloat pointCloudShowStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {\n  float tiles3d_tileset_time = model_pointCloudParameters.w;\n  return float(getShowFromStyle(attributes, metadata, tiles3d_tileset_time));\n}\n#endif\n\n#ifdef HAS_POINT_CLOUD_COLOR_STYLE\nvec4 pointCloudColorStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {\n  float tiles3d_tileset_time = model_pointCloudParameters.w;\n  return getColorFromStyle(attributes, metadata, tiles3d_tileset_time);\n}\n#endif\n\n#ifdef HAS_POINT_CLOUD_POINT_SIZE_STYLE\nfloat pointCloudPointSizeStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {\n  float tiles3d_tileset_time = model_pointCloudParameters.w;\n  return float(getPointSizeFromStyle(attributes, metadata, tiles3d_tileset_time));\n}\n#elif defined(HAS_POINT_CLOUD_ATTENUATION)\nfloat pointCloudPointSizeStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {\n  return getPointSizeFromAttenuation(v_positionEC);\n}\n#endif\n\n#ifdef HAS_POINT_CLOUD_BACK_FACE_CULLING\nfloat pointCloudBackFaceCullingStage() {\n  #if defined(HAS_NORMALS) && !defined(HAS_DOUBLE_SIDED_MATERIAL)\n  // This needs to be computed in eye coordinates so we can't use attributes.normalMC\n  return step(-v_normalEC.z, 0.0);\n  #else\n  return 1.0;\n  #endif\n}\n#endif\n"},34274:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void primitiveOutlineStage(inout czm_modelMaterial material) {\n    if (!model_showOutline) {\n        return;\n    }\n\n    float outlineX = \n        texture(model_outlineTexture, vec2(v_outlineCoordinates.x, 0.5)).r;\n    float outlineY = \n        texture(model_outlineTexture, vec2(v_outlineCoordinates.y, 0.5)).r;\n    float outlineZ = \n        texture(model_outlineTexture, vec2(v_outlineCoordinates.z, 0.5)).r;\n    float outlineness = max(outlineX, max(outlineY, outlineZ));\n\n    material.diffuse = mix(material.diffuse, model_outlineColor.rgb, model_outlineColor.a * outlineness);\n}\n\n"},494098:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void primitiveOutlineStage() {\n    v_outlineCoordinates = a_outlineCoordinates;\n}\n"},443045:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="vec2 computeSt(float featureId)\n{\n    float stepX = model_textureStep.x;\n    float centerX = model_textureStep.y;\n\n    #ifdef MULTILINE_BATCH_TEXTURE\n    float stepY = model_textureStep.z;\n    float centerY = model_textureStep.w;\n\n    float xId = mod(featureId, model_textureDimensions.x); \n    float yId = floor(featureId / model_textureDimensions.x);\n    \n    return vec2(centerX + (xId * stepX), centerY + (yId * stepY));\n    #else\n    return vec2(centerX + (featureId * stepX), 0.5);\n    #endif\n}\n\nvoid selectedFeatureIdStage(out SelectedFeature feature, FeatureIds featureIds)\n{   \n    int featureId = featureIds.SELECTED_FEATURE_ID;\n\n\n    if (featureId < model_featuresLength)\n    {\n        vec2 featureSt = computeSt(float(featureId));\n\n        feature.id = featureId;\n        feature.st = featureSt;\n        feature.color = texture(model_batchTexture, featureSt);\n    }\n    // Floating point comparisons can be unreliable in GLSL, so we\n    // increment the feature ID to make sure it's always greater\n    // then the model_featuresLength - a condition we check for in the\n    // pick ID, to avoid sampling the pick texture if the feature ID is\n    // greater than the number of features.\n    else\n    {\n        feature.id = model_featuresLength + 1;\n        feature.st = vec2(0.0);\n        feature.color = vec4(1.0);\n    }\n\n    #ifdef HAS_NULL_FEATURE_ID\n    if (featureId == model_nullFeatureId) {\n        feature.id = featureId;\n        feature.st = vec2(0.0);\n        feature.color = vec4(1.0);\n    }\n    #endif\n}\n"},40640:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void skinningStage(inout ProcessedAttributes attributes) \n{\n    mat4 skinningMatrix = getSkinningMatrix();\n    mat3 skinningMatrixMat3 = mat3(skinningMatrix);\n\n    vec4 positionMC = vec4(attributes.positionMC, 1.0);\n    attributes.positionMC = vec3(skinningMatrix * positionMC);\n\n    #ifdef HAS_NORMALS\n    vec3 normalMC = attributes.normalMC;\n    attributes.normalMC = skinningMatrixMat3 * normalMC;\n    #endif\n\n    #ifdef HAS_TANGENTS\n    vec3 tangentMC = attributes.tangentMC;\n    attributes.tangentMC = skinningMatrixMat3 * tangentMC;\n    #endif\n}"},323745:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="void verticalExaggerationStage(\n  inout ProcessedAttributes attributes\n) {\n  // Compute the distance from the camera to the local center of curvature.\n  vec4 vertexPositionENU = czm_modelToEnu * vec4(attributes.positionMC, 1.0);\n  vec2 vertexAzimuth = normalize(vertexPositionENU.xy);\n  // Curvature = 1 / radius of curvature.\n  float azimuthalCurvature = dot(vertexAzimuth * vertexAzimuth, czm_eyeEllipsoidCurvature);\n  float eyeToCenter = 1.0 / azimuthalCurvature + czm_eyeHeight;\n\n  // Compute the approximate ellipsoid normal at the vertex position.\n  // Uses a circular approximation for the Earth curvature along the geodesic.\n  vec3 vertexPositionEC = (czm_modelView * vec4(attributes.positionMC, 1.0)).xyz;\n  vec3 centerToVertex = eyeToCenter * czm_eyeEllipsoidNormalEC + vertexPositionEC;\n  vec3 vertexNormal = normalize(centerToVertex);\n\n  // Estimate the (sine of the) angle between the camera direction and the vertex normal\n  float verticalDistance = dot(vertexPositionEC, czm_eyeEllipsoidNormalEC);\n  float horizontalDistance = length(vertexPositionEC - verticalDistance * czm_eyeEllipsoidNormalEC);\n  float sinTheta = horizontalDistance / (eyeToCenter + verticalDistance);\n  bool isSmallAngle = clamp(sinTheta, 0.0, 0.05) == sinTheta;\n\n  // Approximate the change in height above the ellipsoid, from camera to vertex position.\n  float exactVersine = 1.0 - dot(czm_eyeEllipsoidNormalEC, vertexNormal);\n  float smallAngleVersine = 0.5 * sinTheta * sinTheta;\n  float versine = isSmallAngle ? smallAngleVersine : exactVersine;\n  float dHeight = dot(vertexPositionEC, vertexNormal) - eyeToCenter * versine;\n  float vertexHeight = czm_eyeHeight + dHeight;\n\n  // Transform the approximate vertex normal to model coordinates.\n  vec3 vertexNormalMC = (czm_inverseModelView * vec4(vertexNormal, 0.0)).xyz;\n  vertexNormalMC = normalize(vertexNormalMC);\n\n  // Compute the exaggeration and apply it along the approximate vertex normal.\n  float stretch = u_verticalExaggerationAndRelativeHeight.x;\n  float shift = u_verticalExaggerationAndRelativeHeight.y;\n  float exaggeration = (vertexHeight - shift) * (stretch - 1.0);\n  attributes.positionMC += exaggeration * vertexNormalMC;\n}\n"},291848:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="in vec2 v_textureCoordinates;\n\nuniform int u_polygonsLength;\nuniform int u_extentsLength;\nuniform highp sampler2D u_polygonTexture;\nuniform highp sampler2D u_extentsTexture;\n\nint getPolygonIndex(float dimension, vec2 coord) {\n   vec2 uv = coord.xy * dimension;\n   return int(floor(uv.y) * dimension + floor(uv.x));\n}\n\nvec2 getLookupUv(ivec2 dimensions, int i) {\n    int pixY = i / dimensions.x;\n    int pixX = i - (pixY * dimensions.x);\n    float pixelWidth = 1.0 / float(dimensions.x);\n    float pixelHeight = 1.0 / float(dimensions.y);\n    float u = (float(pixX) + 0.5) * pixelWidth; // sample from center of pixel\n    float v = (float(pixY) + 0.5) * pixelHeight;\n    return vec2(u, v);\n}\n\nvec4 getExtents(int i) {\n    return texture(u_extentsTexture, getLookupUv(textureSize(u_extentsTexture, 0), i));\n}\n\nivec2 getPositionsLengthAndExtentsIndex(int i) {\n    vec2 uv = getLookupUv(textureSize(u_polygonTexture, 0), i);\n    vec4 value = texture(u_polygonTexture, uv);\n    return ivec2(int(value.x), int(value.y));\n}\n\nvec2 getPolygonPosition(int i) {\n    vec2 uv = getLookupUv(textureSize(u_polygonTexture, 0), i);\n    return texture(u_polygonTexture, uv).xy;\n}\n\nvec2 getCoordinates(vec2 textureCoordinates, vec4 extents) {\n    float latitude = mix(extents.x, extents.x + 1.0 / extents.z, textureCoordinates.y);\n    float longitude = mix(extents.y, extents.y + 1.0 / extents.w, textureCoordinates.x);\n    return vec2(latitude, longitude);\n}\n\nvoid main() {\n    int lastPolygonIndex = 0;\n    out_FragColor = vec4(1.0);\n\n    // Get the relevant region of the texture\n    float dimension = float(u_extentsLength);\n    if (u_extentsLength > 2) {\n        dimension = ceil(log2(float(u_extentsLength)));\n    }\n    int regionIndex = getPolygonIndex(dimension, v_textureCoordinates);\n\n    for (int polygonIndex = 0; polygonIndex < u_polygonsLength; polygonIndex++) {\n        ivec2 positionsLengthAndExtents = getPositionsLengthAndExtentsIndex(lastPolygonIndex);\n        int positionsLength = positionsLengthAndExtents.x;\n        int polygonExtentsIndex = positionsLengthAndExtents.y;\n        lastPolygonIndex += 1;\n\n         // Only compute signed distance for the relevant part of the atlas\n         if (polygonExtentsIndex == regionIndex) {\n            float clipAmount = czm_infinity;\n            vec4 extents = getExtents(polygonExtentsIndex);\n            vec2 textureOffset = vec2(mod(float(polygonExtentsIndex), dimension), floor(float(polygonExtentsIndex) / dimension)) / dimension;\n            vec2 p = getCoordinates((v_textureCoordinates - textureOffset) * dimension, extents);\n            float s = 1.0;\n\n            // Check each edge for absolute distance\n            for (int i = 0, j = positionsLength - 1; i < positionsLength; j = i, i++) {\n                vec2 a = getPolygonPosition(lastPolygonIndex + i);\n                vec2 b = getPolygonPosition(lastPolygonIndex + j);\n \n                vec2 ab = b - a;\n                vec2 pa = p - a;\n                float t = dot(pa, ab) / dot(ab, ab);\n                t = clamp(t, 0.0, 1.0);\n\n                vec2 pq = pa - t * ab;\n                float d = length(pq);\n\n                // Inside / outside computation to determine sign\n                bvec3 cond = bvec3(p.y >= a.y, \n                            p.y < b.y, \n                            ab.x * pa.y > ab.y * pa.x);\n                if (all(cond) || all(not(cond))) s = -s;\n                if (abs(d) < abs(clipAmount)) {\n                    clipAmount = d;\n                }\n            }\n\n            // Normalize the range to [0,1]\n            vec4 result = (s * vec4(clipAmount * length(extents.zw))) / 2.0 + 0.5;\n            // In the case where we've iterated through multiple polygons, take the minimum\n            out_FragColor = min(out_FragColor, result);\n         }\n\n        lastPolygonIndex += positionsLength;\n    }\n}"},57723:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec3 position2DHigh;\nin vec3 position2DLow;\nin vec3 prevPosition3DHigh;\nin vec3 prevPosition3DLow;\nin vec3 prevPosition2DHigh;\nin vec3 prevPosition2DLow;\nin vec3 nextPosition3DHigh;\nin vec3 nextPosition3DLow;\nin vec3 nextPosition2DHigh;\nin vec3 nextPosition2DLow;\nin vec4 texCoordExpandAndBatchIndex;\n\nout vec2  v_st;\nout float v_width;\nout vec4 v_pickColor;\nout float v_polylineAngle;\n\nvoid main()\n{\n    float texCoord = texCoordExpandAndBatchIndex.x;\n    float expandDir = texCoordExpandAndBatchIndex.y;\n    bool usePrev = texCoordExpandAndBatchIndex.z < 0.0;\n    float batchTableIndex = texCoordExpandAndBatchIndex.w;\n\n    vec2 widthAndShow = batchTable_getWidthAndShow(batchTableIndex);\n    float width = widthAndShow.x + 0.5;\n    float show = widthAndShow.y;\n\n    if (width < 1.0)\n    {\n        show = 0.0;\n    }\n\n    vec4 pickColor = batchTable_getPickColor(batchTableIndex);\n\n    vec4 p, prev, next;\n    if (czm_morphTime == 1.0)\n    {\n        p = czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz);\n        prev = czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz);\n        next = czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        p = czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);\n        prev = czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy);\n        next = czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy);\n    }\n    else\n    {\n        p = czm_columbusViewMorph(\n                czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy),\n                czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz),\n                czm_morphTime);\n        prev = czm_columbusViewMorph(\n                czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy),\n                czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz),\n                czm_morphTime);\n        next = czm_columbusViewMorph(\n                czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy),\n                czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz),\n                czm_morphTime);\n    }\n\n    #ifdef DISTANCE_DISPLAY_CONDITION\n        vec3 centerHigh = batchTable_getCenterHigh(batchTableIndex);\n        vec4 centerLowAndRadius = batchTable_getCenterLowAndRadius(batchTableIndex);\n        vec3 centerLow = centerLowAndRadius.xyz;\n        float radius = centerLowAndRadius.w;\n        vec2 distanceDisplayCondition = batchTable_getDistanceDisplayCondition(batchTableIndex);\n\n        float lengthSq;\n        if (czm_sceneMode == czm_sceneMode2D)\n        {\n            lengthSq = czm_eyeHeight2D.y;\n        }\n        else\n        {\n            vec4 center = czm_translateRelativeToEye(centerHigh.xyz, centerLow.xyz);\n            lengthSq = max(0.0, dot(center.xyz, center.xyz) - radius * radius);\n        }\n\n        float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x;\n        float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y;\n        if (lengthSq < nearSq || lengthSq > farSq)\n        {\n            show = 0.0;\n        }\n    #endif\n\n    float polylineAngle;\n    vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, polylineAngle);\n    gl_Position = czm_viewportOrthographic * positionWC * show;\n\n    v_st.s = texCoord;\n    v_st.t = czm_writeNonPerspective(clamp(expandDir, 0.0, 1.0), gl_Position.w);\n\n    v_width = width;\n    v_pickColor = pickColor;\n    v_polylineAngle = polylineAngle;\n}\n"},812178:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="uniform sampler2D u_pointCloud_colorGBuffer;\nuniform sampler2D u_pointCloud_depthGBuffer;\nuniform vec2 u_distanceAndEdlStrength;\nin vec2 v_textureCoordinates;\n\nvec2 neighborContribution(float log2Depth, vec2 offset)\n{\n    float dist = u_distanceAndEdlStrength.x;\n    vec2 texCoordOrig = v_textureCoordinates + offset * dist;\n    vec2 texCoord0 = v_textureCoordinates + offset * floor(dist);\n    vec2 texCoord1 = v_textureCoordinates + offset * ceil(dist);\n\n    float depthOrLogDepth0 = czm_unpackDepth(texture(u_pointCloud_depthGBuffer, texCoord0));\n    float depthOrLogDepth1 = czm_unpackDepth(texture(u_pointCloud_depthGBuffer, texCoord1));\n\n    // ignore depth values that are the clear depth\n    if (depthOrLogDepth0 == 0.0 || depthOrLogDepth1 == 0.0) {\n        return vec2(0.0);\n    }\n\n    // interpolate the two adjacent depth values\n    float depthMix = mix(depthOrLogDepth0, depthOrLogDepth1, fract(dist));\n    vec4 eyeCoordinate = czm_windowToEyeCoordinates(texCoordOrig, depthMix);\n    return vec2(max(0.0, log2Depth - log2(-eyeCoordinate.z / eyeCoordinate.w)), 1.0);\n}\n\nvoid main()\n{\n    float depthOrLogDepth = czm_unpackDepth(texture(u_pointCloud_depthGBuffer, v_textureCoordinates));\n\n    vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, depthOrLogDepth);\n    eyeCoordinate /= eyeCoordinate.w;\n\n    float log2Depth = log2(-eyeCoordinate.z);\n\n    if (depthOrLogDepth == 0.0) // 0.0 is the clear value for the gbuffer\n    {\n        discard;\n    }\n\n    vec4 color = texture(u_pointCloud_colorGBuffer, v_textureCoordinates);\n\n    // sample from neighbors left, right, down, up\n    vec2 texelSize = 1.0 / czm_viewport.zw;\n\n    vec2 responseAndCount = vec2(0.0);\n\n    responseAndCount += neighborContribution(log2Depth, vec2(-texelSize.x, 0.0));\n    responseAndCount += neighborContribution(log2Depth, vec2(+texelSize.x, 0.0));\n    responseAndCount += neighborContribution(log2Depth, vec2(0.0, -texelSize.y));\n    responseAndCount += neighborContribution(log2Depth, vec2(0.0, +texelSize.y));\n\n    float response = responseAndCount.x / responseAndCount.y;\n    float strength = u_distanceAndEdlStrength.y;\n    float shade = exp(-response * 300.0 * strength);\n    color.rgb *= shade;\n    out_FragColor = vec4(color);\n\n    // Input and output depth are the same.\n    gl_FragDepth = depthOrLogDepth;\n}\n"},814617:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="//\n// Fragment shader for Gaussian splats.\n// Renders a Gaussian splat within a quad, discarding fragments outside the unit circle.\n// Applies an approximate Gaussian falloff based on distance from the center and outputs\n// a color modulated by the alpha and Gaussian weight.\n//\nvoid main() {\n    if (v_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard;\n    if (v_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard;\n\n    float A = -dot(v_vertPos, v_vertPos);\n    if (A < -4.) {\n        discard;\n    }\n\n    float B = exp(A * 4.) * v_splatColor.a ;\n    out_FragColor = vec4(v_splatColor.rgb * B , B);\n}\n"},988617:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="//\n// Vertex shader for Gaussian splats.\n\n// The splats are rendered as quads in view space. Splat attributes are loaded from a texture with precomputed 3D covariance.\n\n// Passes local quad coordinates and color to the fragment shader for Gaussian evaluation. \n//\n// Discards splats outside the view frustum or with negligible screen size.\n//\n#if defined(HAS_SPHERICAL_HARMONICS)\nconst uint coefficientCount[3] = uint[3](3u,8u,15u);\nconst float SH_C1 = 0.48860251;\nconst float SH_C2[5] = float[5](\n         1.092548430,\n        -1.09254843,\n        0.315391565,\n        -1.09254843,\n        0.546274215\n);\n\nconst float SH_C3[7] = float[7](\n         -0.59004358,\n        2.890611442,\n        -0.45704579,\n        0.373176332,\n        -0.45704579,\n        1.445305721,\n        -0.59004358\n);\n\n//Retrieve SH coefficient. Currently RG32UI format\nuvec2 loadSHCoeff(uint splatID, int index) {\n    ivec2 shTexSize = textureSize(u_sphericalHarmonicsTexture, 0);\n    uint dims = coefficientCount[uint(u_sphericalHarmonicsDegree)-1u];\n    uint splatsPerRow = uint(shTexSize.x) / dims;\n    uint shIndex = (splatID%splatsPerRow) * dims + uint(index);\n    ivec2 shPosCoord = ivec2(shIndex, splatID / splatsPerRow);\n    return texelFetch(u_sphericalHarmonicsTexture, shPosCoord, 0).rg;\n}\n\n//Unpack RG32UI half float coefficients to vec3\nvec3 halfToVec3(uvec2 packed) {\n    return vec3(unpackHalf2x16(packed.x), unpackHalf2x16(packed.y).x);\n}\n\nvec3 loadAndExpandSHCoeff(uint splatID, int index) {\n    uvec2 coeff = loadSHCoeff(splatID, index);\n    return halfToVec3(coeff);\n}\n\nvec3 evaluateSH(uint splatID, vec3 viewDir) {\n    vec3 result = vec3(0.0);\n    int coeffIndex = 0;\n    float x = viewDir.x, y = viewDir.y, z = viewDir.z;\n\n    if (u_sphericalHarmonicsDegree >= 1.) {\n        vec3 sh1 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n        vec3 sh2 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n        vec3 sh3 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n        result += -SH_C1 * y * sh1 + SH_C1 * z * sh2 - SH_C1 * x * sh3;\n\n        if (u_sphericalHarmonicsDegree >= 2.) {\n            float xx = x * x;\n            float yy = y * y;\n            float zz = z * z;\n            float xy = x * y;\n            float yz = y * z;\n            float xz = x * z;\n\n            vec3 sh4 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n            vec3 sh5 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n            vec3 sh6 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n            vec3 sh7 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n            vec3 sh8 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n            result += SH_C2[0] * xy * sh4 +\n                    SH_C2[1] * yz * sh5 +\n                    SH_C2[2] * (2.0f * zz - xx - yy) * sh6 +\n                    SH_C2[3] * xz * sh7 +\n                    SH_C2[4] * (xx - yy) * sh8;\n\n            if (u_sphericalHarmonicsDegree >= 3.) {\n                vec3 sh9 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n                vec3 sh10 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n                vec3 sh11 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n                vec3 sh12 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n                vec3 sh13 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n                vec3 sh14 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n                vec3 sh15 = loadAndExpandSHCoeff(splatID, coeffIndex++);\n                result += SH_C3[0] * y * (3.0f * xx - yy) * sh9 +\n                        SH_C3[1] * xy * z * sh10 +\n                        SH_C3[2] * y * (4.0f * zz - xx - yy) * sh11 +\n                        SH_C3[3] * z * (2.0f * zz - 3.0f * xx - 3.0f * yy) * sh12 +\n                        SH_C3[4] * x * (4.0f * zz - xx - yy) * sh13 +\n                        SH_C3[5] * z * (xx - yy) * sh14 +\n                        SH_C3[6] * x * (xx - 3.0f * yy) * sh15;\n            }\n        }\n    }\n    return result;\n}\n#endif\n\n// Transforms and projects splat covariance into screen space and extracts the major and minor axes of the Gaussian ellipsoid\n// which is used to calculate the vertex position in clip space.\nvec4 calcCovVectors(vec3 viewPos, mat3 Vrk) {\n    vec4 t = vec4(viewPos, 1.0);\n    vec2 focal = vec2(czm_projection[0][0] * czm_viewport.z, czm_projection[1][1] * czm_viewport.w);\n\n    vec2 J1 = focal / t.z;\n    vec2 J2 = -focal * vec2(t.x, t.y) / (t.z * t.z);\n    mat3 J = mat3(\n        J1.x, 0.0, J2.x,\n        0.0, J1.y, J2.y,\n        0.0, 0.0, 0.0\n    );\n\n    mat3 R = mat3(czm_modelView);\n\n    //transform our covariance into view space\n    //ensures orientation is correct\n    mat3 Vrk_view = R * Vrk * transpose(R);\n    mat3 cov = transpose(J) * Vrk_view * J;\n\n    float diagonal1 = cov[0][0] + .3;\n    float offDiagonal = cov[0][1];\n    float diagonal2 = cov[1][1] + .3;\n\n    float mid = 0.5 * (diagonal1 + diagonal2);\n    float radius = length(vec2((diagonal1 - diagonal2) * 0.5, offDiagonal));\n    float lambda1 = mid + radius;\n    float lambda2 = max(mid - radius, 0.1);\n\n    vec2 diagonalVector = normalize(vec2(offDiagonal, lambda1 - diagonal1));\n\n    return vec4(\n        min(sqrt(2.0 * lambda1), 1024.0) * diagonalVector,\n        min(sqrt(2.0 * lambda2), 1024.0) * vec2(diagonalVector.y, -diagonalVector.x)\n    );\n}\n\nhighp vec4 discardVec = vec4(0.0, 0.0, 2.0, 1.0);\n\nvoid main() {\n    uint texIdx = uint(a_splatIndex);\n    ivec2 posCoord = ivec2((texIdx & 0x3ffu) << 1, texIdx >> 10);\n    vec4 splatPosition = vec4( uintBitsToFloat(uvec4(texelFetch(u_splatAttributeTexture, posCoord, 0))) );\n\n    vec4 splatViewPos = czm_modelView * vec4(splatPosition.xyz, 1.0);\n    vec4 clipPosition = czm_projection * splatViewPos;\n\n    float clip = 1.2 * clipPosition.w;\n    if (clipPosition.z < -clip || clipPosition.x < -clip || clipPosition.x > clip ||\n        clipPosition.y < -clip || clipPosition.y > clip) {\n        gl_Position = vec4(0.0, 0.0, 2.0, 1.0);\n        return;\n    }\n\n    ivec2 covCoord = ivec2(((texIdx & 0x3ffu) << 1) | 1u, texIdx >> 10);\n    uvec4 covariance = uvec4(texelFetch(u_splatAttributeTexture, covCoord, 0));\n\n    gl_Position = clipPosition;\n\n    vec2 u1 = unpackHalf2x16(covariance.x) ;\n    vec2 u2 = unpackHalf2x16(covariance.y);\n    vec2 u3 = unpackHalf2x16(covariance.z);\n    mat3 Vrk = mat3(u1.x, u1.y, u2.x, u1.y, u2.y, u3.x, u2.x, u3.x, u3.y);\n\n    vec4 covVectors = calcCovVectors(splatViewPos.xyz, Vrk);\n\n    if (dot(covVectors.xy, covVectors.xy) < 4.0 && dot(covVectors.zw, covVectors.zw) < 4.0) {\n        gl_Position = discardVec;\n        return;\n    }\n\n    vec2 corner = vec2((gl_VertexID << 1) & 2, gl_VertexID & 2) - 1.;\n\n    gl_Position += vec4((corner.x * covVectors.xy + corner.y * covVectors.zw) / czm_viewport.zw * gl_Position.w, 0, 0);\n    gl_Position.z = clamp(gl_Position.z, -abs(gl_Position.w), abs(gl_Position.w));\n\n    v_vertPos = corner ;\n    v_splatColor = vec4(covariance.w & 0xffu, (covariance.w >> 8) & 0xffu, (covariance.w >> 16) & 0xffu, (covariance.w >> 24) & 0xffu) / 255.0;\n#if defined(HAS_SPHERICAL_HARMONICS)\n    vec4 splatWC = czm_inverseView * splatViewPos;\n    vec3 viewDirModel = normalize(u_inverseModelRotation * (splatWC.xyz - u_cameraPositionWC.xyz));\n\n    v_splatColor.rgb += evaluateSH(texIdx, viewDirModel).rgb;\n#endif\n    v_splitDirection = u_splitDirection;\n}"},275058:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="uniform sampler2D u_texture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    out_FragColor = texture(u_texture, v_textureCoordinates);\n}\n"},208898:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="in vec4 position;\nin float webMercatorT;\n\nuniform vec2 u_textureDimensions;\n\nout vec2 v_textureCoordinates;\n\nvoid main()\n{\n    v_textureCoordinates = vec2(position.x, webMercatorT);\n    gl_Position = czm_viewportOrthographic * (position * vec4(u_textureDimensions, 1.0, 1.0));\n}\n"},154920:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="in vec4 v_startPlaneEC;\nin vec4 v_endPlaneEC;\nin vec4 v_rightPlaneEC;\nin float v_halfWidth;\nin vec3 v_volumeUpEC;\n\nuniform vec4 u_highlightColor;\nvoid main()\n{\n    float logDepthOrDepth = czm_branchFreeTernary(czm_sceneMode == czm_sceneMode2D, gl_FragCoord.z, czm_unpackDepth(texture(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw)));\n\n    // Discard for sky\n    if (logDepthOrDepth == 0.0) {\n#ifdef DEBUG_SHOW_VOLUME\n        out_FragColor = vec4(0.0, 0.0, 1.0, 0.5);\n        return;\n#else // DEBUG_SHOW_VOLUME\n        discard;\n#endif // DEBUG_SHOW_VOLUME\n    }\n\n    vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);\n    eyeCoordinate /= eyeCoordinate.w;\n\n    float halfMaxWidth = v_halfWidth * czm_metersPerPixel(eyeCoordinate);\n\n    // Expand halfMaxWidth if direction to camera is almost perpendicular with the volume's up direction\n    halfMaxWidth += halfMaxWidth * (1.0 - dot(-normalize(eyeCoordinate.xyz), v_volumeUpEC));\n\n    // Check distance of the eye coordinate against the right-facing plane\n    float widthwiseDistance = czm_planeDistance(v_rightPlaneEC, eyeCoordinate.xyz);\n\n    // Check eye coordinate against the mitering planes\n    float distanceFromStart = czm_planeDistance(v_startPlaneEC, eyeCoordinate.xyz);\n    float distanceFromEnd = czm_planeDistance(v_endPlaneEC, eyeCoordinate.xyz);\n\n    if (abs(widthwiseDistance) > halfMaxWidth || distanceFromStart < 0.0 || distanceFromEnd < 0.0) {\n#ifdef DEBUG_SHOW_VOLUME\n        out_FragColor = vec4(logDepthOrDepth, 0.0, 0.0, 0.5);\n        return;\n#else // DEBUG_SHOW_VOLUME\n        discard;\n#endif // DEBUG_SHOW_VOLUME\n    }\n    out_FragColor = u_highlightColor;\n\n    czm_writeDepthClamp();\n}\n"},296312:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i='in vec3 startEllipsoidNormal;\nin vec3 endEllipsoidNormal;\nin vec4 startPositionAndHeight;\nin vec4 endPositionAndHeight;\nin vec4 startFaceNormalAndVertexCorner;\nin vec4 endFaceNormalAndHalfWidth;\nin float a_batchId;\n\nuniform mat4 u_modifiedModelView;\nuniform vec2 u_minimumMaximumVectorHeights;\n\nout vec4 v_startPlaneEC;\nout vec4 v_endPlaneEC;\nout vec4 v_rightPlaneEC;\nout float v_halfWidth;\nout vec3 v_volumeUpEC;\n\nvoid main()\n{\n    // vertex corner IDs\n    //          3-----------7\n    //         /|   left   /|\n    //        / | 1       / |\n    //       2-----------6  5  end\n    //       | /         | /\n    // start |/  right   |/\n    //       0-----------4\n    //\n    float isEnd = floor(startFaceNormalAndVertexCorner.w * 0.251); // 0 for front, 1 for end\n    float isTop = floor(startFaceNormalAndVertexCorner.w * mix(0.51, 0.19, isEnd)); // 0 for bottom, 1 for top\n\n    vec3 forward = endPositionAndHeight.xyz - startPositionAndHeight.xyz;\n    vec3 right = normalize(cross(forward, startEllipsoidNormal));\n\n    vec4 position = vec4(startPositionAndHeight.xyz, 1.0);\n    position.xyz += forward * isEnd;\n\n    v_volumeUpEC = czm_normal * normalize(cross(right, forward));\n\n    // Push for volume height\n    float offset;\n    vec3 ellipsoidNormal = mix(startEllipsoidNormal, endEllipsoidNormal, isEnd);\n\n    // offset height to create volume\n    offset = mix(startPositionAndHeight.w, endPositionAndHeight.w, isEnd);\n    offset = mix(u_minimumMaximumVectorHeights.y, u_minimumMaximumVectorHeights.x, isTop) - offset;\n    position.xyz += offset * ellipsoidNormal;\n\n    // move from RTC to EC\n    position = u_modifiedModelView * position;\n    right = czm_normal * right;\n\n    // Push for width in a direction that is in the start or end plane and in a plane with right\n    // N = normalEC ("right-facing" direction for push)\n    // R = right\n    // p = angle between N and R\n    // w = distance to push along R if R == N\n    // d = distance to push along N\n    //\n    //   N   R\n    //  {  p| }      * cos(p) = dot(N, R) = w / d\n    //  d  |  |w    * d = w / dot(N, R)\n    //    { | }\n    //       o---------- polyline segment ----\x3e\n    //\n    vec3 scratchNormal = mix(-startFaceNormalAndVertexCorner.xyz, endFaceNormalAndHalfWidth.xyz, isEnd);\n    scratchNormal = cross(scratchNormal, mix(startEllipsoidNormal, endEllipsoidNormal, isEnd));\n    vec3 miterPushNormal = czm_normal * normalize(scratchNormal);\n\n    offset = 2.0 * endFaceNormalAndHalfWidth.w * max(0.0, czm_metersPerPixel(position)); // offset = widthEC\n    offset = offset / dot(miterPushNormal, right);\n    position.xyz += miterPushNormal * (offset * sign(0.5 - mod(startFaceNormalAndVertexCorner.w, 2.0)));\n\n    gl_Position = czm_depthClamp(czm_projection * position);\n\n    position = u_modifiedModelView * vec4(startPositionAndHeight.xyz, 1.0);\n    vec3 startNormalEC = czm_normal * startFaceNormalAndVertexCorner.xyz;\n    v_startPlaneEC = vec4(startNormalEC, -dot(startNormalEC, position.xyz));\n    v_rightPlaneEC = vec4(right, -dot(right, position.xyz));\n\n    position = u_modifiedModelView * vec4(endPositionAndHeight.xyz, 1.0);\n    vec3 endNormalEC = czm_normal * endFaceNormalAndHalfWidth.xyz;\n    v_endPlaneEC = vec4(endNormalEC, -dot(endNormalEC, position.xyz));\n    v_halfWidth = endFaceNormalAndHalfWidth.w;\n}\n'},747776:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="in vec4 currentPosition;\nin vec4 previousPosition;\nin vec4 nextPosition;\nin vec2 expandAndWidth;\nin float a_batchId;\n\nuniform mat4 u_modifiedModelView;\n\nvoid main()\n{\n    float expandDir = expandAndWidth.x;\n    float width = abs(expandAndWidth.y) + 0.5;\n    bool usePrev = expandAndWidth.y < 0.0;\n\n    vec4 p = u_modifiedModelView * currentPosition;\n    vec4 prev = u_modifiedModelView * previousPosition;\n    vec4 next = u_modifiedModelView * nextPosition;\n\n    float angle;\n    vec4 positionWC = getPolylineWindowCoordinatesEC(p, prev, next, expandDir, width, usePrev, angle);\n    gl_Position = czm_viewportOrthographic * positionWC;\n}\n"},971532:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i="in vec3 position;\nin float a_batchId;\n\nuniform mat4 u_modifiedModelViewProjection;\n\nvoid main()\n{\n    gl_Position = czm_depthClamp(u_modifiedModelViewProjection * vec4(position, 1.0));\n}\n"},410041:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AlphaMode:()=>D$.A,AlphaPipelineStage:()=>B6.A,AnchorPointDirect:()=>L9.A,AnchorPointIndirect:()=>N9.A,Animation:()=>oee.A,AnimationViewModel:()=>ree.A,Appearance:()=>O$.A,ApproximateTerrainHeights:()=>mo.A,ArcGISTiledElevationTerrainProvider:()=>fI,ArcGisBaseMapType:()=>R$.A,ArcGisMapServerImageryProvider:()=>M$.A,ArcGisMapService:()=>L$.A,ArcType:()=>zs.A,ArticulationStageType:()=>mI.A,AssociativeArray:()=>Ft.A,Atmosphere:()=>NB.A,AtmospherePipelineStage:()=>F6.A,AttributeCompression:()=>gI.A,AttributeType:()=>N$.A,AutoExposure:()=>Lz,AutomaticUniforms:()=>i.A,Axis:()=>mK.A,AxisAlignedBoundingBox:()=>_I.A,B3dmLoader:()=>U6.A,B3dmParser:()=>B$.A,BaseLayerPicker:()=>see.A,BaseLayerPickerViewModel:()=>aee.A,BatchTable:()=>F$.A,BatchTableHierarchy:()=>U$.A,BatchTexture:()=>k$.A,BatchTexturePipelineStage:()=>k6.A,Billboard:()=>V$.A,BillboardCollection:()=>z$.A,BillboardGraphics:()=>Bt.A,BillboardLoadState:()=>H$.A,BillboardTexture:()=>G$.A,BillboardVisualizer:()=>An,BingMapsGeocoderService:()=>TI,BingMapsImageryProvider:()=>W$.A,BingMapsStyle:()=>Y$.A,BlendEquation:()=>ok.A,BlendFunction:()=>rk.A,BlendOption:()=>q$.A,BlendingState:()=>$M.A,BoundingRectangle:()=>c.A,BoundingSphere:()=>Sn.A,BoundingSphereState:()=>Gt,BoundingVolumeSemantics:()=>j$.A,BoxEmitter:()=>$$,BoxGeometry:()=>pn.A,BoxGeometryUpdater:()=>di,BoxGraphics:()=>hi.A,BoxOutlineGeometry:()=>fn.A,BrdfLutGenerator:()=>FB,Buffer:()=>o.A,BufferLoader:()=>J$.A,BufferUsage:()=>r.A,CPUStylingPipelineStage:()=>V6.A,CallbackPositionProperty:()=>gi,CallbackProperty:()=>Jn.A,Camera:()=>UB.A,CameraEventAggregator:()=>IG,CameraEventType:()=>_G,CameraFlightPath:()=>Z$.A,Cartesian2:()=>q.A,Cartesian3:()=>j.A,Cartesian4:()=>Q.A,CartesianRectangle:()=>z6.A,Cartographic:()=>X.A,CartographicGeocoderService:()=>wI,CatmullRomSpline:()=>RI,Cesium3DContentGroup:()=>eJ.A,Cesium3DTile:()=>tJ.A,Cesium3DTileBatchTable:()=>DK.A,Cesium3DTileColorBlendMode:()=>nJ.A,Cesium3DTileContent:()=>oJ,Cesium3DTileContentFactory:()=>rJ.A,Cesium3DTileContentState:()=>sJ.A,Cesium3DTileContentType:()=>aJ.A,Cesium3DTileFeature:()=>HU.A,Cesium3DTileFeatureTable:()=>cJ.A,Cesium3DTileOptimizationHint:()=>lJ.A,Cesium3DTileOptimizations:()=>uJ.A,Cesium3DTilePass:()=>kB.A,Cesium3DTilePassState:()=>VB,Cesium3DTilePointFeature:()=>dJ.A,Cesium3DTileRefine:()=>hJ.A,Cesium3DTileStyle:()=>AJ.A,Cesium3DTileStyleEngine:()=>pJ.A,Cesium3DTilesInspector:()=>Qee,Cesium3DTilesInspectorViewModel:()=>qee,Cesium3DTilesVoxelProvider:()=>DJ,Cesium3DTileset:()=>yi.A,Cesium3DTilesetBaseTraversal:()=>OJ.A,Cesium3DTilesetCache:()=>RJ.A,Cesium3DTilesetGraphics:()=>_i.A,Cesium3DTilesetHeatmap:()=>MJ.A,Cesium3DTilesetMetadata:()=>fJ.A,Cesium3DTilesetMostDetailedTraversal:()=>LJ.A,Cesium3DTilesetSkipTraversal:()=>NJ.A,Cesium3DTilesetStatistics:()=>jq.A,Cesium3DTilesetTraversal:()=>BJ.A,Cesium3DTilesetVisualizer:()=>xi,CesiumInspector:()=>vte,CesiumInspectorViewModel:()=>_te,CesiumTerrainProvider:()=>MI.A,CesiumWidget:()=>P$,Check:()=>l.A,CheckerboardMaterialProperty:()=>Oi,CircleEmitter:()=>UJ,CircleGeometry:()=>FI,CircleOutlineGeometry:()=>zI,ClassificationModelDrawCommand:()=>H6.A,ClassificationPipelineStage:()=>G6.A,ClassificationPrimitive:()=>kJ.A,ClassificationType:()=>Un.A,ClearCommand:()=>s.A,ClippingPlane:()=>VJ.A,ClippingPlaneCollection:()=>YM.A,ClippingPolygon:()=>zJ.A,ClippingPolygonCollection:()=>JM.A,Clock:()=>la,ClockRange:()=>Hs,ClockStep:()=>Gs,ClockViewModel:()=>j9.A,CloudCollection:()=>PZ,CloudType:()=>GJ,Color:()=>u.A,ColorBlendMode:()=>ia.A,ColorGeometryInstanceAttribute:()=>mn.A,ColorMaterialProperty:()=>En.A,Command:()=>X9,ComponentDatatype:()=>C.A,Composite3DTileContent:()=>DZ.A,CompositeEntityCollection:()=>Hi,CompositeMaterialProperty:()=>uo,CompositePositionProperty:()=>po,CompositeProperty:()=>ao,CompressedTextureBuffer:()=>HI.A,ComputeCommand:()=>a.A,ComputeEngine:()=>x,ConditionsExpression:()=>OZ.A,ConeEmitter:()=>LZ,ConstantPositionProperty:()=>fo.A,ConstantProperty:()=>Vn.A,ConstantSpline:()=>GI.A,ContentMetadata:()=>NZ.A,Context:()=>rt,ContextLimits:()=>N.A,CoplanarPolygonGeometry:()=>Ld,CoplanarPolygonGeometryLibrary:()=>hd.A,CoplanarPolygonOutlineGeometry:()=>Nd.A,CornerType:()=>_o,CorrelationGroup:()=>B9.A,CorridorGeometry:()=>os,CorridorGeometryLibrary:()=>Sr,CorridorGeometryUpdater:()=>ws,CorridorGraphics:()=>xs.A,CorridorOutlineGeometry:()=>hs,Credit:()=>Ws.A,CreditDisplay:()=>JB,CubeMap:()=>B.A,CubeMapFace:()=>st.A,CubicRealPolynomial:()=>WI.A,CullFace:()=>CB.A,CullingVolume:()=>YI.A,CumulusCloud:()=>ZJ,CustomDataSource:()=>Cs.A,CustomHeightmapTerrainProvider:()=>jI,CustomShader:()=>lj,CustomShaderMode:()=>Qq.A,CustomShaderPipelineStage:()=>W6.A,CustomShaderTranslucencyMode:()=>nj.A,CylinderGeometry:()=>Es.A,CylinderGeometryLibrary:()=>Ss.A,CylinderGeometryUpdater:()=>ks,CylinderGraphics:()=>Vs.A,CylinderOutlineGeometry:()=>Os,CzmlDataSource:()=>kl,DataSource:()=>sa.A,DataSourceClock:()=>ha,DataSourceCollection:()=>Gl,DataSourceDisplay:()=>qm,DebugAppearance:()=>FZ,DebugCameraPrimitive:()=>lF,DebugInspector:()=>_q,DebugModelMatrixPrimitive:()=>kZ,DefaultProxy:()=>QI.A,DepthFunction:()=>ZM.A,DepthPlane:()=>gF,DequantizationPipelineStage:()=>Y6.A,DerivedCommand:()=>RF,DeveloperError:()=>A.A,DeviceOrientationCameraController:()=>FF,DirectionalLight:()=>VZ.A,DiscardEmptyTileImagePolicy:()=>zZ.A,DiscardMissingTileImagePolicy:()=>HZ.A,DistanceDisplayCondition:()=>Ut.A,DistanceDisplayConditionGeometryInstanceAttribute:()=>_n,DoubleEndedPriorityQueue:()=>tP,DoublyLinkedList:()=>nP.A,DracoLoader:()=>OK.A,DrawCommand:()=>m.A,DynamicAtmosphereLightingType:()=>UF.A,DynamicEnvironmentMapManager:()=>GZ.A,DynamicGeometryBatch:()=>Xl,DynamicGeometryUpdater:()=>Nn,EarthOrientationParameters:()=>iP.A,EarthOrientationParametersSample:()=>oP.A,EasingFunction:()=>nC.A,EllipseGeometry:()=>Kl.A,EllipseGeometryLibrary:()=>$l.A,EllipseGeometryUpdater:()=>pu,EllipseGraphics:()=>Aa.A,EllipseOutlineGeometry:()=>su,Ellipsoid:()=>K.A,EllipsoidGeodesic:()=>rP.A,EllipsoidGeometry:()=>Pu,EllipsoidGeometryUpdater:()=>zu,EllipsoidGraphics:()=>pa.A,EllipsoidOutlineGeometry:()=>Du.A,EllipsoidPrimitive:()=>IB,EllipsoidRhumbLine:()=>sP.A,EllipsoidSurfaceAppearance:()=>jZ,EllipsoidTangentPlane:()=>vo.A,EllipsoidTerrainProvider:()=>aP.A,EllipsoidalOccluder:()=>cP.A,Empty3DTileContent:()=>QZ.A,EncodedCartesian3:()=>$.A,Entity:()=>zn.A,EntityCluster:()=>fa.A,EntityCollection:()=>Ri.A,EntityView:()=>hg,Event:()=>Bn.A,EventHelper:()=>Gi.A,Expression:()=>XZ.A,ExpressionNodeType:()=>KZ.A,ExtrapolationType:()=>Ys,FeatureDetection:()=>lP.A,FeatureIdPipelineStage:()=>q6.A,Fog:()=>zF,ForEach:()=>h6.A,FrameRateMonitor:()=>JZ,FrameState:()=>HF,Framebuffer:()=>g.A,FramebufferManager:()=>at.A,Frozen:()=>S.A,FrustumCommands:()=>$U,FrustumGeometry:()=>DP,FrustumOutlineGeometry:()=>BP,Fullscreen:()=>FP.A,FullscreenButton:()=>Xee.A,FullscreenButtonViewModel:()=>Kee.A,GaussianSplat3DTileContent:()=>ZZ.A,GaussianSplatPrimitive:()=>e0.A,GaussianSplatRenderResources:()=>t0.A,GaussianSplatSorter:()=>n0.A,GaussianSplatTextureGenerator:()=>i0.A,GeoJsonDataSource:()=>Ag.A,GeoJsonLoader:()=>j6.A,GeocodeType:()=>UP,Geocoder:()=>$ee.A,GeocoderService:()=>VP,GeocoderViewModel:()=>Jee.A,GeographicProjection:()=>zP.A,GeographicTilingScheme:()=>eI.A,Geometry:()=>I.A,Geometry3DTileContent:()=>o0.A,GeometryAttribute:()=>P.A,GeometryAttributes:()=>Ir.A,GeometryFactory:()=>GP,GeometryInstance:()=>yn.A,GeometryInstanceAttribute:()=>WP.A,GeometryOffsetAttribute:()=>vn.A,GeometryPipeline:()=>Ad.A,GeometryPipelineStage:()=>Q6.A,GeometryType:()=>YP.A,GeometryUpdater:()=>$n,GeometryUpdaterSet:()=>GA,GeometryVisualizer:()=>Hp,GetFeatureInfoFormat:()=>r0.A,Globe:()=>xB,GlobeDepth:()=>tk,GlobeSurfaceShaderSet:()=>KM,GlobeSurfaceTile:()=>dL,GlobeSurfaceTileProvider:()=>NN,GlobeTranslucency:()=>FN,GlobeTranslucencyFramebuffer:()=>ik,GlobeTranslucencyState:()=>CU,GltfBufferViewLoader:()=>s0.A,GltfDracoLoader:()=>a0.A,GltfGpmLoader:()=>F9.A,GltfGpmLocal:()=>U9.A,GltfImageLoader:()=>c0.A,GltfIndexBufferLoader:()=>l0.A,GltfJsonLoader:()=>u0.A,GltfLoader:()=>uj.A,GltfLoaderUtil:()=>d0.A,GltfMeshPrimitiveGpmLoader:()=>k9.A,GltfSpzLoader:()=>h0.A,GltfStructuralMetadataLoader:()=>A0.A,GltfTextureLoader:()=>p0.A,GltfVertexBufferLoader:()=>f0.A,GoogleEarthEnterpriseImageryProvider:()=>_0,GoogleEarthEnterpriseMapsProvider:()=>y0.A,GoogleEarthEnterpriseMetadata:()=>aD,GoogleEarthEnterpriseTerrainData:()=>DD,GoogleEarthEnterpriseTerrainProvider:()=>BD,GoogleEarthEnterpriseTileInformation:()=>$P,GoogleGeocoderService:()=>kD,GoogleMaps:()=>zD,GpxDataSource:()=>gv,GregorianDate:()=>Yi.A,GridImageryProvider:()=>x0,GridMaterialProperty:()=>ba,GroundGeometryUpdater:()=>fs,GroundPolylineGeometry:()=>hm.A,GroundPolylinePrimitive:()=>Wl.A,GroundPrimitive:()=>In.A,GroupMetadata:()=>C0.A,HeadingPitchRange:()=>jm.A,HeadingPitchRoll:()=>bv.A,Heap:()=>HD.A,HeightReference:()=>Vt.Ay,HeightmapEncoding:()=>tI.A,HeightmapTerrainData:()=>nI.A,HeightmapTessellator:()=>GD.A,HermitePolynomialApproximation:()=>$s,HermiteSpline:()=>xI.A,HilbertOrder:()=>WD.A,HomeButton:()=>Tte.A,HomeButtonViewModel:()=>bte.A,HorizontalOrigin:()=>zt.A,I3SBuildingSceneLayerExplorer:()=>Dte,I3SBuildingSceneLayerExplorerViewModel:()=>Pte,I3SDataProvider:()=>T1,I3SDecoder:()=>S0,I3SFeature:()=>P0,I3SField:()=>M0,I3SGeometry:()=>J0,I3SLayer:()=>h1,I3SNode:()=>r1,I3SStatistics:()=>p1,I3SSublayer:()=>m1,I3SSymbology:()=>u1,I3dmLoader:()=>X6.A,I3dmParser:()=>b1.A,ITwinData:()=>w1,ITwinPlatform:()=>qD,Iau2000Orientation:()=>lO,Iau2006XysData:()=>uO.A,Iau2006XysSample:()=>dO.A,IauOrientationAxes:()=>_O,IauOrientationParameters:()=>jD,ImageBasedLighting:()=>x1.A,ImageBasedLightingPipelineStage:()=>K6.A,ImageMaterialProperty:()=>wa.A,Imagery:()=>C1.A,ImageryConfiguration:()=>$6.A,ImageryCoverage:()=>J6.A,ImageryFlags:()=>Z6.A,ImageryInput:()=>e5.A,ImageryLayer:()=>hL.A,ImageryLayerCollection:()=>UN.A,ImageryLayerFeatureInfo:()=>E1.A,ImageryPipelineStage:()=>t5.A,ImageryProvider:()=>S1.A,ImageryState:()=>eL.A,Implicit3DTileContent:()=>I1.A,ImplicitAvailabilityBitstream:()=>P1.A,ImplicitMetadataView:()=>D1.A,ImplicitSubdivisionScheme:()=>O1.A,ImplicitSubtree:()=>gJ.A,ImplicitSubtreeCache:()=>vJ,ImplicitSubtreeMetadata:()=>R1.A,ImplicitTileCoordinates:()=>TJ.A,ImplicitTileset:()=>bJ.A,IndexDatatype:()=>Pr.A,InfoBox:()=>Mte.A,InfoBoxViewModel:()=>Lte.A,InspectorShared:()=>Z9,InstanceAttributeSemantic:()=>M1.A,InstancingPipelineStage:()=>n5.A,InterpolationAlgorithm:()=>vO,InterpolationType:()=>TO.A,Intersect:()=>bO.A,IntersectionTests:()=>wO.A,Intersections2D:()=>cD.A,Interval:()=>xO.A,InvertClassification:()=>LU,Ion:()=>CO.A,IonGeocodeProviderType:()=>EO,IonGeocoderService:()=>RO,IonImageryProvider:()=>L1.A,IonResource:()=>MO.A,IonWorldImageryStyle:()=>N1.A,Iso8601:()=>Tn.A,JobScheduler:()=>UU,JobType:()=>NU.A,JsonMetadataTable:()=>B1.A,JulianDate:()=>te.A,KTX2Transcoder:()=>LO.A,KeyboardEventModifier:()=>NO.A,KeyframeNode:()=>yQ,KmlCamera:()=>_v,KmlDataSource:()=>bE,KmlLookAt:()=>Xx,KmlTour:()=>eC,KmlTourFlyTo:()=>oC,KmlTourWait:()=>sC,Label:()=>F1.A,LabelCollection:()=>U1.A,LabelGraphics:()=>xa.A,LabelStyle:()=>oa.A,LabelVisualizer:()=>pf,LagrangePolynomialApproximation:()=>Js,LeapSecond:()=>BO.A,Light:()=>V1,LightingModel:()=>i5.A,LightingPipelineStage:()=>o5.A,LinearApproximation:()=>Zs,LinearSpline:()=>FO.A,ManagedArray:()=>UO.A,MapMode2D:()=>kU.A,MapProjection:()=>VO,MapboxImageryProvider:()=>z1.A,MapboxStyleImageryProvider:()=>q1,MappedPositions:()=>r5.A,Material:()=>Dn.A,MaterialAppearance:()=>xn.A,MaterialPipelineStage:()=>s5.A,MaterialProperty:()=>Mn,Math:()=>J.A,Matrix2:()=>vh.A,Matrix3:()=>Z.A,Matrix4:()=>O.A,Megatexture:()=>wQ,MeshPrimitiveGpmLocal:()=>V9.A,MetadataClass:()=>j1.A,MetadataClassProperty:()=>GU.A,MetadataComponentType:()=>_F.A,MetadataEntity:()=>Q1.A,MetadataEnum:()=>X1.A,MetadataEnumValue:()=>K1.A,MetadataPicking:()=>YU,MetadataPickingPipelineStage:()=>vF.A,MetadataPipelineStage:()=>a5.A,MetadataSchema:()=>$1.A,MetadataSchemaLoader:()=>J1.A,MetadataSemantic:()=>wJ.A,MetadataTable:()=>Z1.A,MetadataTableProperty:()=>e2.A,MetadataType:()=>yF.A,MipmapHint:()=>ct.A,Model:()=>ff.A,Model3DTileContent:()=>c5.A,ModelAlphaOptions:()=>l5.A,ModelAnimation:()=>u5.A,ModelAnimationChannel:()=>d5.A,ModelAnimationCollection:()=>h5.A,ModelAnimationLoop:()=>mf.A,ModelAnimationState:()=>t2.A,ModelArticulation:()=>A5.A,ModelArticulationStage:()=>p5.A,ModelClippingPlanesPipelineStage:()=>f5.A,ModelClippingPolygonsPipelineStage:()=>m5.A,ModelColorPipelineStage:()=>g5.A,ModelComponents:()=>n2.A,ModelDrawCommand:()=>_5.A,ModelDrawCommands:()=>y5.A,ModelFeature:()=>v5.A,ModelFeatureTable:()=>T5.A,ModelGraphics:()=>Ca.A,ModelImagery:()=>b5.A,ModelImageryMapping:()=>w5.A,ModelLightingOptions:()=>x5.A,ModelMatrixUpdateStage:()=>C5.A,ModelNode:()=>E5.A,ModelPrimitiveImagery:()=>S5.A,ModelReader:()=>I5.A,ModelRenderResources:()=>P5.A,ModelRuntimeNode:()=>D5.A,ModelRuntimePrimitive:()=>O5.A,ModelSceneGraph:()=>R5.A,ModelSilhouettePipelineStage:()=>M5.A,ModelSkin:()=>L5.A,ModelSplitterPipelineStage:()=>N5.A,ModelStatistics:()=>B5.A,ModelType:()=>F5.A,ModelUtility:()=>U5.A,ModelVisualizer:()=>Nf,Moon:()=>LB,MorphTargetsPipelineStage:()=>k5.A,MorphWeightSpline:()=>HO,MortonOrder:()=>GO.A,Multiple3DTileContent:()=>i2.A,MultisampleFramebuffer:()=>lt.A,NavigationHelpButton:()=>Ote.A,NavigationHelpButtonViewModel:()=>Rte.A,NearFarScalar:()=>kt.A,NeverTileDiscardPolicy:()=>o2.A,NodeRenderResources:()=>V5.A,NodeStatisticsPipelineStage:()=>z5.A,NodeTransformationProperty:()=>Ea.A,OIT:()=>fk,Occluder:()=>oR,OffsetGeometryInstanceAttribute:()=>bn.A,OpenCageGeocoderService:()=>sR,OpenStreetMapImageryProvider:()=>r2.A,OrderedGroundPrimitiveCollection:()=>jl,OrientedBoundingBox:()=>lD.A,OrthographicFrustum:()=>ee.A,OrthographicOffCenterFrustum:()=>aR.A,Packable:()=>cR,PackableForInterpolation:()=>lR,Particle:()=>l2,ParticleBurst:()=>d2,ParticleEmitter:()=>A2,ParticleSystem:()=>b2,Pass:()=>ut.A,PassState:()=>F,PathGraphics:()=>Sa.A,PathVisualizer:()=>Xf,PeliasGeocoderService:()=>IO,PerInstanceColorAppearance:()=>Cn.A,PerformanceDisplay:()=>zU,PerformanceWatchdog:()=>Wte,PerformanceWatchdogViewModel:()=>Hte,PerspectiveFrustum:()=>uP.A,PerspectiveOffCenterFrustum:()=>uR.A,PickDepth:()=>XU,PickDepthFramebuffer:()=>gk,PickFramebuffer:()=>vk,PickedMetadataInfo:()=>hX,Picking:()=>lz,PickingPipelineStage:()=>H5.A,PinBuilder:()=>pg.A,PixelDatatype:()=>U.A,PixelFormat:()=>R.A,Plane:()=>dR.A,PlaneGeometry:()=>ju,PlaneGeometryUpdater:()=>dd,PlaneGraphics:()=>wE.A,PlaneOutlineGeometry:()=>$u,PntsLoader:()=>G5.A,PntsParser:()=>MK.A,PointCloud:()=>e$,PointCloudEyeDomeLighting:()=>t$.A,PointCloudShading:()=>n$.A,PointCloudStylingPipelineStage:()=>W5.A,PointGraphics:()=>Ia.A,PointPrimitive:()=>w2.A,PointPrimitiveCollection:()=>x2.A,PointVisualizer:()=>lm,PolygonGeometry:()=>Bd.A,PolygonGeometryLibrary:()=>pd.A,PolygonGeometryUpdater:()=>ih,PolygonGraphics:()=>Pa.A,PolygonHierarchy:()=>ea.A,PolygonOutlineGeometry:()=>Yd,PolygonPipeline:()=>Dr.A,Polyline:()=>C2.A,PolylineArrowMaterialProperty:()=>Ra,PolylineCollection:()=>Bf.A,PolylineColorAppearance:()=>um.A,PolylineDashMaterialProperty:()=>Ma.A,PolylineGeometry:()=>Am.A,PolylineGeometryUpdater:()=>Im,PolylineGlowMaterialProperty:()=>Fa,PolylineGraphics:()=>Ua.A,PolylineMaterialAppearance:()=>dm.A,PolylineOutlineMaterialProperty:()=>Ga,PolylinePipeline:()=>yo.A,PolylineVisualizer:()=>zm,PolylineVolumeGeometry:()=>lh,PolylineVolumeGeometryLibrary:()=>ir,PolylineVolumeGeometryUpdater:()=>yh,PolylineVolumeGraphics:()=>Wa.A,PolylineVolumeOutlineGeometry:()=>ph,PositionProperty:()=>pi.A,PositionPropertyArray:()=>ja,PostProcessStage:()=>Wz,PostProcessStageCollection:()=>dH,PostProcessStageComposite:()=>qz,PostProcessStageLibrary:()=>Kz,PostProcessStageSampleMode:()=>Nz,PostProcessStageTextureCache:()=>iH,PpeMetadata:()=>z9.A,PpeSource:()=>H9,PpeTexture:()=>G9.A,Primitive:()=>Pn.A,PrimitiveCollection:()=>Yl.A,PrimitiveLoadPlan:()=>E2.A,PrimitiveOutlineGenerator:()=>Y5.A,PrimitiveOutlinePipelineStage:()=>q5.A,PrimitivePipeline:()=>S2.A,PrimitiveRenderResources:()=>j5.A,PrimitiveState:()=>I2.A,PrimitiveStatisticsPipelineStage:()=>Q5.A,PrimitiveType:()=>p.A,ProjectionPicker:()=>Nte.A,ProjectionPickerViewModel:()=>Bte.A,Property:()=>Wt.A,PropertyArray:()=>Ka,PropertyAttribute:()=>P2.A,PropertyAttributeProperty:()=>D2.A,PropertyBag:()=>$a.A,PropertyTable:()=>O2.A,PropertyTexture:()=>R2.A,PropertyTextureProperty:()=>M2.A,ProviderViewModel:()=>cee.A,Proxy:()=>AR,QuadraticRealPolynomial:()=>pR.A,QuadtreeOccluders:()=>VN,QuadtreePrimitive:()=>AB,QuadtreeTile:()=>WN,QuadtreeTileLoadState:()=>tL,QuadtreeTileProvider:()=>N2,QuantizedMeshTerrainData:()=>uD.A,QuarticRealPolynomial:()=>fR.A,Quaternion:()=>To.A,QuaternionSpline:()=>mR.A,Queue:()=>gR.A,Ray:()=>_R.A,Rectangle:()=>Or.A,RectangleCollisionChecker:()=>gp,RectangleGeometry:()=>Jh,RectangleGeometryLibrary:()=>Th.A,RectangleGeometryUpdater:()=>lA,RectangleGraphics:()=>Ja.A,RectangleOutlineGeometry:()=>Zh.A,ReferenceFrame:()=>Ai.A,ReferenceProperty:()=>nc,RenderState:()=>_.A,Renderbuffer:()=>dt.A,RenderbufferFormat:()=>ht.A,Request:()=>iI.A,RequestErrorEvent:()=>yR.A,RequestScheduler:()=>vR.A,RequestState:()=>oI.A,RequestType:()=>rI.A,Resource:()=>Lt.A,ResourceCache:()=>CJ.A,ResourceCacheKey:()=>B2.A,ResourceCacheStatistics:()=>F2.A,ResourceLoader:()=>U2.A,ResourceLoaderState:()=>k2.A,Rotation:()=>ic,RuntimeError:()=>M.A,S2Cell:()=>TR.A,SDFSettings:()=>V2.A,SampledPositionProperty:()=>mc,SampledProperty:()=>Ac,Sampler:()=>At.A,ScaledPositionProperty:()=>kf,Scene:()=>fK,SceneFramebuffer:()=>bk,SceneMode:()=>Ce.A,SceneMode2DPipelineStage:()=>X5.A,SceneModePicker:()=>jte.A,SceneModePickerViewModel:()=>Qte.A,SceneTransforms:()=>KU.A,SceneTransitioner:()=>gG,ScreenSpaceCameraController:()=>rq,ScreenSpaceEventHandler:()=>bR.A,ScreenSpaceEventType:()=>wR.A,SelectedFeatureIdPipelineStage:()=>K5.A,SelectionIndicator:()=>Yte.A,SelectionIndicatorViewModel:()=>qte.A,SensorVolumePortionToDisplay:()=>Yc,ShaderBuilder:()=>pt.A,ShaderCache:()=>H,ShaderDestination:()=>ft.A,ShaderFunction:()=>mt.A,ShaderProgram:()=>y.A,ShaderSource:()=>k.A,ShaderStruct:()=>gt.A,ShadowMap:()=>sV,ShadowMapShader:()=>xk,ShadowMode:()=>kn.A,ShadowVolumeAppearance:()=>xp.A,SharedContext:()=>vt,ShowGeometryInstanceAttribute:()=>wn.A,Simon1994PlanetaryPositions:()=>we,SimplePolylineGeometry:()=>PR,SingleTileImageryProvider:()=>z2.A,SkinningPipelineStage:()=>$5.A,SkyAtmosphere:()=>yK,SkyBox:()=>bK,SpatialNode:()=>DQ,Spdcf:()=>W9.A,SpecularEnvironmentCubeMap:()=>sq.A,SphereEmitter:()=>G2,SphereGeometry:()=>MR,SphereOutlineGeometry:()=>LR.A,Spherical:()=>na,Spline:()=>CI.A,SplitDirection:()=>Yt.A,Splitter:()=>LK,StaticGeometryColorBatch:()=>np,StaticGeometryPerMaterialBatch:()=>up,StaticGroundGeometryColorBatch:()=>wp,StaticGroundGeometryPerMaterialBatch:()=>Pp,StaticGroundPolylinePerMaterialBatch:()=>Lm,StaticOutlineGeometryBatch:()=>Fp,StencilConstants:()=>SU.A,StencilFunction:()=>IU.A,StencilOperation:()=>PU.A,SteppedSpline:()=>NR.A,Stereographic:()=>BR.A,StorageType:()=>Y9.A,StripeMaterialProperty:()=>wc,StripeOrientation:()=>gc,StructuralMetadata:()=>W2.A,StyleCommandsNeeded:()=>J5.A,StyleExpression:()=>q2,Sun:()=>IK,SunLight:()=>Ee.A,SunPostProcess:()=>pq,SupportedImageFormats:()=>j2.A,SvgPathBindingHandler:()=>eee.A,TaskProcessor:()=>ZP.A,Terrain:()=>Q2.A,TerrainData:()=>dD.A,TerrainEncoding:()=>hD.A,TerrainFillMesh:()=>JL,TerrainMesh:()=>AD.A,TerrainOffsetProperty:()=>ni,TerrainProvider:()=>sI.A,TerrainQuantization:()=>FR.A,TerrainState:()=>nL,Texture:()=>G.A,Texture3D:()=>Et,TextureAtlas:()=>St.A,TextureCache:()=>Y,TextureMagnificationFilter:()=>Tt.A,TextureManager:()=>tj,TextureMinificationFilter:()=>bt.A,TexturePacker:()=>UR.A,TextureUniform:()=>Z5,TextureWrap:()=>It.A,TileAvailability:()=>aI.A,TileBoundingRegion:()=>ZL.A,TileBoundingS2Cell:()=>X2.A,TileBoundingSphere:()=>K2.A,TileBoundingVolume:()=>J2,TileCoordinatesImageryProvider:()=>e3,TileDiscardPolicy:()=>n3,TileEdge:()=>kR,TileImagery:()=>i3.A,TileMapServiceImageryProvider:()=>o3.A,TileMetadata:()=>r3.A,TileOrientedBoundingBox:()=>s3.A,TileProviderError:()=>cI.A,TileReplacementQueue:()=>jN,TileSelectionResult:()=>pL,TileState:()=>a3,Tileset3DTileContent:()=>c3.A,TilesetMetadata:()=>l3.A,TilesetPipelineStage:()=>e8.A,TilingScheme:()=>zR,TimeConstants:()=>ne.A,TimeDynamicImagery:()=>u3.A,TimeDynamicPointCloud:()=>g$,TimeInterval:()=>ji.A,TimeIntervalCollection:()=>oo,TimeIntervalCollectionPositionProperty:()=>Ec,TimeIntervalCollectionProperty:()=>Pc,TimeStandard:()=>ie.A,Timeline:()=>$te.A,TimelineHighlightRange:()=>Jte.A,TimelineTrack:()=>Zte.A,Tipsify:()=>HR.A,ToggleButtonViewModel:()=>tee.A,Tonemapper:()=>rH,TrackingReferenceFrame:()=>Qm.A,Transforms:()=>xe.A,TranslationRotationScale:()=>GR.A,TranslucentTileClassification:()=>dV,TridiagonalSystemSolver:()=>WR.A,TrustedServers:()=>YR.A,TweenCollection:()=>RG,UniformState:()=>qe,UniformType:()=>Xq,UrlTemplateImageryProvider:()=>H1.A,VERSION:()=>Gde,VRButton:()=>ene.A,VRButtonViewModel:()=>tne.A,VRTheWorldTerrainProvider:()=>ZR,VaryingType:()=>t8,Vector3DTileBatch:()=>d3.A,Vector3DTileClampedPolylines:()=>h3.A,Vector3DTileContent:()=>A3.A,Vector3DTileGeometry:()=>p3.A,Vector3DTilePoints:()=>f3.A,Vector3DTilePolygons:()=>m3.A,Vector3DTilePolylines:()=>g3.A,Vector3DTilePrimitive:()=>_3.A,VelocityOrientationProperty:()=>Hc,VelocityVectorProperty:()=>Bc,VertexArray:()=>je.A,VertexArrayFacade:()=>Pt.A,VertexAttributeSemantic:()=>y3.A,VertexFormat:()=>Rr.A,VerticalExaggeration:()=>eM.A,VerticalExaggerationPipelineStage:()=>n8.A,VerticalOrigin:()=>Ht.A,VideoSynchronizer:()=>nM,View:()=>yV,Viewer:()=>_ne.A,ViewportQuad:()=>T3,Visibility:()=>WO,Visualizer:()=>CE,VoxelBoxShape:()=>Ej,VoxelCell:()=>bq,VoxelContent:()=>hj,VoxelCylinderShape:()=>Xj,VoxelEllipsoidShape:()=>pQ,VoxelInspector:()=>gne,VoxelInspectorViewModel:()=>pne,VoxelMetadataOrder:()=>kq,VoxelPrimitive:()=>uX,VoxelProvider:()=>w3,VoxelRenderResources:()=>Vq,VoxelShape:()=>C3,VoxelShapeType:()=>mQ,VoxelTraversal:()=>VQ,VulkanConstants:()=>iM,WallGeometry:()=>PA,WallGeometryLibrary:()=>gA,WallGeometryUpdater:()=>VA,WallGraphics:()=>Gc.A,WallOutlineGeometry:()=>NA,WebGLConstants:()=>L.A,WebMapServiceImageryProvider:()=>E3.A,WebMapTileServiceImageryProvider:()=>S3.A,WebMercatorProjection:()=>oM.A,WebMercatorTilingScheme:()=>lI.A,WindingOrder:()=>Fd.A,WireframeIndexGenerator:()=>rM.A,WireframePipelineStage:()=>i8.A,_shadersAcesTonemappingStage:()=>uz,_shadersAdditiveBlend:()=>aq,_shadersAdjustTranslucentFS:()=>tS,_shadersAllMaterialAppearanceFS:()=>Z3.A,_shadersAllMaterialAppearanceVS:()=>e4.A,_shadersAmbientOcclusionGenerate:()=>dz,_shadersAmbientOcclusionModulate:()=>hz,_shadersAspectRampMaterial:()=>d4.A,_shadersAtmosphereCommon:()=>nS.A,_shadersAtmosphereStageFS:()=>D4.A,_shadersAtmosphereStageVS:()=>O4.A,_shadersBasicMaterialAppearanceFS:()=>t4.A,_shadersBasicMaterialAppearanceVS:()=>n4.A,_shadersBillboardCollectionFS:()=>iS.A,_shadersBillboardCollectionVS:()=>oS.A,_shadersBlackAndWhite:()=>Az,_shadersBloomComposite:()=>pz,_shadersBrdfLutGeneratorFS:()=>rS,_shadersBrightPass:()=>cq,_shadersBrightness:()=>fz,_shadersBumpMapMaterial:()=>h4.A,_shadersCPUStylingStageFS:()=>R4.A,_shadersCPUStylingStageVS:()=>M4.A,_shadersCheckerboardMaterial:()=>A4.A,_shadersCloudCollectionFS:()=>sS,_shadersCloudCollectionVS:()=>aS,_shadersCloudNoiseFS:()=>cS,_shadersCloudNoiseVS:()=>lS,_shadersCompareAndPackTranslucentDepth:()=>uS,_shadersCompositeOITFS:()=>dS,_shadersCompositeTranslucentClassification:()=>aV,_shadersComputeIrradianceFS:()=>hS.A,_shadersComputeRadianceMapFS:()=>AS.A,_shadersContrastBias:()=>mz,_shadersConvolveSpecularMapFS:()=>pS.A,_shadersConvolveSpecularMapVS:()=>fS.A,_shadersCustomShaderStageFS:()=>L4.A,_shadersCustomShaderStageVS:()=>N4.A,_shadersCzmBuiltins:()=>J3.A,_shadersDepthOfField:()=>gz,_shadersDepthPlaneFS:()=>mS,_shadersDepthPlaneVS:()=>gS,_shadersDepthView:()=>_z,_shadersDepthViewPacked:()=>u6,_shadersDotMaterial:()=>p4.A,_shadersEdgeDetection:()=>yz,_shadersElevationBandMaterial:()=>f4.A,_shadersElevationContourMaterial:()=>m4.A,_shadersElevationRampMaterial:()=>g4.A,_shadersEllipsoidFS:()=>_S,_shadersEllipsoidSurfaceAppearanceFS:()=>WZ,_shadersEllipsoidSurfaceAppearanceVS:()=>YZ,_shadersEllipsoidVS:()=>yS,_shadersFXAA:()=>bz,_shadersFXAA3_11:()=>vS,_shadersFadeMaterial:()=>_4.A,_shadersFeatureIdStageFS:()=>B4.A,_shadersFeatureIdStageVS:()=>F4.A,_shadersFilmicTonemapping:()=>vz,_shadersGaussianBlur1D:()=>wz,_shadersGeometryStageFS:()=>U4.A,_shadersGeometryStageVS:()=>k4.A,_shadersGlobeFS:()=>TS,_shadersGlobeVS:()=>bS,_shadersGridMaterial:()=>y4.A,_shadersGroundAtmosphere:()=>wS,_shadersHSBToRGB:()=>J8.A,_shadersHSLToRGB:()=>Z8.A,_shadersImageBasedLightingStageFS:()=>V4.A,_shadersInstancingStageCommon:()=>z4.A,_shadersInstancingStageVS:()=>H4.A,_shadersIntersectBox:()=>Dq,_shadersIntersectClippingPlanes:()=>Iq,_shadersIntersectCylinder:()=>Oq,_shadersIntersectDepth:()=>Sq,_shadersIntersectEllipsoid:()=>Rq,_shadersIntersectLongitude:()=>Pq,_shadersIntersection:()=>Mq,_shadersIntersectionUtils:()=>Eq,_shadersLegacyInstancingStageVS:()=>G4.A,_shadersLensFlare:()=>xz,_shadersLightingStageFS:()=>W4.A,_shadersMaterialStageFS:()=>Y4.A,_shadersMegatexture:()=>Uq,_shadersMetadataStageFS:()=>q4.A,_shadersMetadataStageVS:()=>j4.A,_shadersModelClippingPlanesStageFS:()=>Q4.A,_shadersModelClippingPolygonsStageFS:()=>X4.A,_shadersModelClippingPolygonsStageVS:()=>K4.A,_shadersModelColorStageFS:()=>$4.A,_shadersModelFS:()=>J4.A,_shadersModelSilhouetteStageFS:()=>Z4.A,_shadersModelSilhouetteStageVS:()=>e6.A,_shadersModelSplitterStageFS:()=>t6.A,_shadersModelVS:()=>n6.A,_shadersModifiedReinhardTonemapping:()=>Cz,_shadersMorphTargetsStageVS:()=>i6.A,_shadersNightVision:()=>Ez,_shadersNormalMapMaterial:()=>v4.A,_shadersOctree:()=>Fq,_shadersPassThrough:()=>EU,_shadersPassThroughDepth:()=>JU,_shadersPbrNeutralTonemapping:()=>Tz,_shadersPerInstanceColorAppearanceFS:()=>i4.A,_shadersPerInstanceColorAppearanceVS:()=>o4.A,_shadersPerInstanceFlatColorAppearanceFS:()=>r4.A,_shadersPerInstanceFlatColorAppearanceVS:()=>s4.A,_shadersPointCloudEyeDomeLighting:()=>d6.A,_shadersPointCloudStylingStageVS:()=>o6.A,_shadersPointPrimitiveCollectionFS:()=>xS.A,_shadersPointPrimitiveCollectionVS:()=>CS.A,_shadersPolygonSignedDistanceFS:()=>ES.A,_shadersPolylineArrowMaterial:()=>T4.A,_shadersPolylineColorAppearanceVS:()=>a4.A,_shadersPolylineCommon:()=>SS.A,_shadersPolylineDashMaterial:()=>b4.A,_shadersPolylineFS:()=>IS.A,_shadersPolylineGlowMaterial:()=>w4.A,_shadersPolylineMaterialAppearanceVS:()=>c4.A,_shadersPolylineOutlineMaterial:()=>x4.A,_shadersPolylineShadowVolumeFS:()=>PS.A,_shadersPolylineShadowVolumeMorphFS:()=>DS.A,_shadersPolylineShadowVolumeMorphVS:()=>OS.A,_shadersPolylineShadowVolumeVS:()=>RS.A,_shadersPolylineVS:()=>MS.A,_shadersPrimitiveGaussianSplatFS:()=>LS.A,_shadersPrimitiveGaussianSplatVS:()=>NS.A,_shadersPrimitiveOutlineStageFS:()=>r6.A,_shadersPrimitiveOutlineStageVS:()=>s6.A,_shadersRGBToHSB:()=>e7.A,_shadersRGBToHSL:()=>t7.A,_shadersRGBToXYZ:()=>n7.A,_shadersReinhardTonemapping:()=>Sz,_shadersReprojectWebMercatorFS:()=>BS.A,_shadersReprojectWebMercatorVS:()=>FS.A,_shadersRimLightingMaterial:()=>C4.A,_shadersSelectedFeatureIdStageCommon:()=>a6.A,_shadersShadowVolumeAppearanceFS:()=>US.A,_shadersShadowVolumeAppearanceVS:()=>kS.A,_shadersShadowVolumeFS:()=>VS.A,_shadersSilhouette:()=>Iz,_shadersSkinningStageVS:()=>c6.A,_shadersSkyAtmosphereCommon:()=>zS,_shadersSkyAtmosphereFS:()=>HS,_shadersSkyAtmosphereVS:()=>GS,_shadersSkyBoxFS:()=>WS,_shadersSkyBoxVS:()=>YS,_shadersSlopeRampMaterial:()=>E4.A,_shadersStripeMaterial:()=>S4.A,_shadersSunFS:()=>qS,_shadersSunTextureFS:()=>jS,_shadersSunVS:()=>QS,_shadersTexturedMaterialAppearanceFS:()=>l4.A,_shadersTexturedMaterialAppearanceVS:()=>u4.A,_shadersVector3DTileClampedPolylinesFS:()=>XS.A,_shadersVector3DTileClampedPolylinesVS:()=>KS.A,_shadersVector3DTilePolylinesVS:()=>$S.A,_shadersVectorTileVS:()=>JS.A,_shadersVerticalExaggerationStageVS:()=>l6.A,_shadersViewportQuadFS:()=>ZS,_shadersViewportQuadVS:()=>f,_shadersVoxelFS:()=>xq,_shadersVoxelUtils:()=>wq,_shadersVoxelVS:()=>Cq,_shadersWater:()=>I4.A,_shadersWaterMaskMaterial:()=>P4.A,_shadersXYZToRGB:()=>i7.A,_shadersacesTonemapping:()=>o7.A,_shadersalphaWeight:()=>r7.A,_shadersantialias:()=>s7.A,_shadersapplyHSBShift:()=>a7.A,_shadersapproximateSphericalCoordinates:()=>c7.A,_shadersapproximateTanh:()=>l7.A,_shadersbackFacing:()=>u7.A,_shadersbranchFreeTernary:()=>d7.A,_shaderscascadeColor:()=>h7.A,_shaderscascadeDistance:()=>A7.A,_shaderscascadeMatrix:()=>p7.A,_shaderscascadeWeights:()=>f7.A,_shadersclipPolygons:()=>m7.A,_shaderscolumbusViewMorph:()=>g7.A,_shaderscomputeAtmosphereColor:()=>_7.A,_shaderscomputeGroundAtmosphereScattering:()=>y7.A,_shaderscomputePosition:()=>v7.A,_shaderscomputeScattering:()=>T7.A,_shadersconvertUvToBox:()=>Lq,_shadersconvertUvToCylinder:()=>Nq,_shadersconvertUvToEllipsoid:()=>Bq,_shaderscosineAndSine:()=>b7.A,_shadersdecompressTextureCoordinates:()=>w7.A,_shadersdegreesPerRadian:()=>r8.A,_shadersdepthClamp:()=>x7.A,_shadersdepthRange:()=>s8.A,_shadersdepthRangeStruct:()=>W8.A,_shaderseastNorthUpToEyeCoordinates:()=>C7.A,_shadersellipsoidContainsPoint:()=>E7.A,_shadersellipsoidTextureCoordinates:()=>S7.A,_shadersepsilon1:()=>a8.A,_shadersepsilon2:()=>c8.A,_shadersepsilon3:()=>l8.A,_shadersepsilon4:()=>u8.A,_shadersepsilon5:()=>d8.A,_shadersepsilon6:()=>h8.A,_shadersepsilon7:()=>A8.A,_shadersequalsEpsilon:()=>I7.A,_shaderseyeOffset:()=>P7.A,_shaderseyeToWindowCoordinates:()=>D7.A,_shadersfastApproximateAtan:()=>O7.A,_shadersfog:()=>R7.A,_shadersgammaCorrect:()=>M7.A,_shadersgeodeticSurfaceNormal:()=>L7.A,_shadersgetDefaultMaterial:()=>N7.A,_shadersgetDynamicAtmosphereLightDirection:()=>B7.A,_shadersgetLambertDiffuse:()=>F7.A,_shadersgetSpecular:()=>U7.A,_shadersgetWaterNoise:()=>k7.A,_shadershue:()=>V7.A,_shadersinfinity:()=>p8.A,_shadersinverseGamma:()=>z7.A,_shadersisEmpty:()=>H7.A,_shadersisFull:()=>G7.A,_shaderslatitudeToWebMercatorFraction:()=>W7.A,_shaderslineDistance:()=>Y7.A,_shaderslinearToSrgb:()=>q7.A,_shadersluminance:()=>j7.A,_shadersmaterial:()=>Y8.A,_shadersmaterialInput:()=>q8.A,_shadersmaximumComponent:()=>Q7.A,_shadersmetersPerPixel:()=>X7.A,_shadersmodelMaterial:()=>j8.A,_shadersmodelToWindowCoordinates:()=>K7.A,_shadersmodelVertexOutput:()=>Q8.A,_shadersmultiplyWithColorBalance:()=>$7.A,_shadersnearFarScalar:()=>J7.A,_shadersoctDecode:()=>Z7.A,_shadersoneOverPi:()=>f8.A,_shadersoneOverTwoPi:()=>m8.A,_shaderspackDepth:()=>e9.A,_shaderspassCesium3DTile:()=>g8.A,_shaderspassCesium3DTileClassification:()=>_8.A,_shaderspassCesium3DTileClassificationIgnoreShow:()=>y8.A,_shaderspassClassification:()=>v8.A,_shaderspassCompute:()=>T8.A,_shaderspassEnvironment:()=>b8.A,_shaderspassGaussianSplats:()=>w8.A,_shaderspassGlobe:()=>x8.A,_shaderspassOpaque:()=>C8.A,_shaderspassOverlay:()=>E8.A,_shaderspassTerrainClassification:()=>S8.A,_shaderspassTranslucent:()=>I8.A,_shaderspassVoxels:()=>P8.A,_shaderspbrLighting:()=>t9.A,_shaderspbrNeutralTonemapping:()=>n9.A,_shadersphong:()=>i9.A,_shaderspi:()=>D8.A,_shaderspiOverFour:()=>O8.A,_shaderspiOverSix:()=>R8.A,_shaderspiOverThree:()=>M8.A,_shaderspiOverTwo:()=>L8.A,_shadersplaneDistance:()=>o9.A,_shaderspointAlongRay:()=>r9.A,_shadersradiansPerDegree:()=>N8.A,_shadersray:()=>X8.A,_shadersrayEllipsoidIntersectionInterval:()=>s9.A,_shadersraySegment:()=>K8.A,_shadersraySphereIntersectionInterval:()=>a9.A,_shadersreadDepth:()=>c9.A,_shadersreadNonPerspective:()=>l9.A,_shadersreverseLogDepth:()=>u9.A,_shadersround:()=>d9.A,_shaderssaturation:()=>h9.A,_shaderssceneMode2D:()=>B8.A,_shaderssceneMode3D:()=>F8.A,_shaderssceneModeColumbusView:()=>U8.A,_shaderssceneModeMorphing:()=>k8.A,_shadersshadowDepthCompare:()=>A9.A,_shadersshadowParameters:()=>$8.A,_shadersshadowVisibility:()=>p9.A,_shaderssignNotZero:()=>f9.A,_shaderssolarRadius:()=>V8.A,_shaderssphericalHarmonics:()=>m9.A,_shaderssrgbToLinear:()=>g9.A,_shaderstangentToEyeSpaceMatrix:()=>_9.A,_shaderstextureCube:()=>y9.A,_shadersthreePiOver2:()=>z8.A,_shaderstransformPlane:()=>v9.A,_shaderstranslateRelativeToEye:()=>T9.A,_shaderstranslucentPhong:()=>b9.A,_shaderstranspose:()=>w9.A,_shaderstwoPi:()=>H8.A,_shadersunpackClippingExtents:()=>x9.A,_shadersunpackDepth:()=>C9.A,_shadersunpackFloat:()=>E9.A,_shadersunpackUint:()=>S9.A,_shadersvalueTransform:()=>I9.A,_shadersvertexLogDepth:()=>P9.A,_shaderswebMercatorMaxLatitude:()=>G8.A,_shaderswindowToEyeCoordinates:()=>D9.A,_shaderswriteDepthClamp:()=>O9.A,_shaderswriteLogDepth:()=>R9.A,_shaderswriteNonPerspective:()=>M9.A,addAllToArray:()=>sM.A,addBuffer:()=>A6.A,addDefaults:()=>p6.A,addExtensionsRequired:()=>f6.A,addExtensionsUsed:()=>m6.A,addPipelineExtras:()=>g6.A,addToArray:()=>_6.A,appendForwardSlash:()=>aM.A,arrayRemoveDuplicates:()=>go.A,barycentricCoordinates:()=>cM.A,binarySearch:()=>Wi.A,buildModuleUrl:()=>yv.A,buildVoxelDrawCommands:()=>qq,clone:()=>_t.A,combine:()=>tC.A,computeFlyToLocationForRectangle:()=>WM,createBillboardPointCallback:()=>Kf.A,createCommand:()=>nee.A,createDefaultImageryProviderViewModels:()=>lee.A,createDefaultTerrainProviderViewModels:()=>uee.A,createElevationBandMaterial:()=>U3,createGooglePhotorealistic3DTileset:()=>V3,createGuid:()=>E.A,createMaterialPropertyDescriptor:()=>EE.A,createOsmBuildingsAsync:()=>z3,createPropertyDescriptor:()=>Ci.A,createRawPropertyDescriptor:()=>ua.A,createTangentSpaceDebugPrimitive:()=>H3,createTaskProcessorWorker:()=>q9,createUniform:()=>Dt.A,createUniformArray:()=>Ot.A,createWorldBathymetryAsync:()=>lM.A,createWorldImageryAsync:()=>G3.A,createWorldTerrainAsync:()=>uM.A,decodeGoogleEarthEnterpriseData:()=>hM,decodeVectorPolylinePositions:()=>AM.A,defaultValue:()=>pM.A,defer:()=>vv.A,defined:()=>d.A,demodernizeShader:()=>Rt.A,deprecationWarning:()=>fM.A,destroyObject:()=>h.A,exportKml:()=>eS,findAccessorMinMax:()=>y6.A,findContentMetadata:()=>W3.A,findGroupMetadata:()=>Y3.A,findTileMetadata:()=>q3.A,forEachTextureInMaterial:()=>v6.A,formatError:()=>mM.A,freezeRenderState:()=>Mt.A,getAbsoluteUri:()=>gM.A,getAccessorByteStride:()=>T6.A,getBaseUri:()=>_M.A,getBinaryAccessor:()=>j3.A,getClipAndStyleCode:()=>RK,getClippingFunction:()=>jM,getComponentReader:()=>b6.A,getElement:()=>Qx.A,getExtensionFromUri:()=>Tv.A,getFilenameFromUri:()=>qs.A,getImageFromTypedArray:()=>yM,getImagePixels:()=>qR.A,getJsonFromTypedArray:()=>vM.A,getMagic:()=>TM.A,getMeshPrimitives:()=>Q3.A,getMetadataClassProperty:()=>dX,getMetadataProperty:()=>AX,getStringFromTypedArray:()=>bM.A,getTimestamp:()=>aa.A,hasExtension:()=>mJ.A,heightReferenceOnEntityPropertyChanged:()=>ii,isBitSet:()=>QP,isBlobUri:()=>wM.A,isCrossOriginUrl:()=>xM.A,isDataUri:()=>CM.A,isLeapYear:()=>qi.A,knockout:()=>Aee.A,knockout_3_5_1:()=>Xte.A,knockout_es5:()=>Kte.A,loadAndExecuteScript:()=>JP.A,loadCubeMap:()=>Nt,loadImageFromTypedArray:()=>EM.A,loadKTX2:()=>D.A,mergeSort:()=>DM,moveTechniqueRenderStates:()=>w6.A,moveTechniquesToExtension:()=>x6.A,numberOfComponentsForType:()=>C6.A,objectToQuery:()=>wv.A,oneTimeWarning:()=>Fn.A,parseBatchTable:()=>X3.A,parseFeatureMetadataLegacy:()=>K3.A,parseGlb:()=>E6.A,parseResponseHeaders:()=>OM.A,parseStructuralMetadata:()=>$3.A,pickModel:()=>o8.A,pointInsideTriangle:()=>MM,preprocess3DTileContent:()=>xJ.A,processVoxelProperties:()=>Yq,queryToObject:()=>xv.A,readAccessorPacked:()=>S6.A,removeExtension:()=>I6.A,removeExtensionsRequired:()=>P6.A,removeExtensionsUsed:()=>D6.A,removePipelineExtras:()=>O6.A,removeUnusedElements:()=>R6.A,resizeImageToNextPowerOfTwo:()=>LM.A,sampleTerrain:()=>NM.A,sampleTerrainMostDetailed:()=>BM.A,scaleToGeodeticSurface:()=>FM.A,srgbToLinear:()=>UM,subdivideArray:()=>kM.A,subscribeAndEvaluate:()=>iee.A,updateAccessorComponentTypes:()=>M6.A,updateVersion:()=>L6.A,usesExtension:()=>N6.A,viewerCesium3DTilesInspectorMixin:()=>yne,viewerCesiumInspectorMixin:()=>vne,viewerDragDropMixin:()=>Vde,viewerPerformanceWatchdogMixin:()=>zde,viewerVoxelInspectorMixin:()=>Hde,webGLConstantToGlslType:()=>VM,wrapFunction:()=>zM,writeTextToCanvas:()=>HM.A});var i=n(481),o=n(641613),r=n(442790),s=n(769493),a=n(718289),c=n(647934),l=n(369031),u=n(41476),d=n(491446),h=n(677354),A=n(605971),p=n(402330);const f="in vec4 position;\nin vec2 textureCoordinates;\n\nout vec2 v_textureCoordinates;\n\nvoid main() \n{\n    gl_Position = position;\n    v_textureCoordinates = textureCoordinates;\n}\n";var m=n(377496),g=n(483128),_=n(40118),y=n(302836);function v(e){this._context=e}let T;const b=new m.A({primitiveType:p.A.TRIANGLES}),w=new s.A({color:new u.A(0,0,0,0)});v.prototype.execute=function(e){if(l.A.defined("computeCommand",e),(0,d.A)(e.preExecute)&&e.preExecute(e),!(0,d.A)(e.fragmentShaderSource)&&!(0,d.A)(e.shaderProgram))throw new A.A("computeCommand.fragmentShaderSource or computeCommand.shaderProgram is required.");l.A.defined("computeCommand.outputTexture",e.outputTexture);const t=e.outputTexture,n=t.width,i=t.height,o=this._context,r=(0,d.A)(e.vertexArray)?e.vertexArray:o.getViewportQuadVertexArray(),s=(0,d.A)(e.shaderProgram)?e.shaderProgram:function(e,t){return y.A.fromCache({context:e,vertexShaderSource:f,fragmentShaderSource:t,attributeLocations:{position:0,textureCoordinates:1}})}(o,e.fragmentShaderSource),a=function(e,t){return new g.A({context:e,colorTextures:[t],destroyAttachments:!1})}(o,t),u=function(e,t){return(0,d.A)(T)&&T.viewport.width===e&&T.viewport.height===t||(T=_.A.fromCache({viewport:new c.A(0,0,e,t)})),T}(n,i),h=e.uniformMap,p=w;p.framebuffer=a,p.renderState=u,p.execute(o);const m=b;m.vertexArray=r,m.renderState=u,m.shaderProgram=s,m.uniformMap=h,m.framebuffer=a,m.execute(o),a.destroy(),e.persists||(s.destroy(),(0,d.A)(e.vertexArray)&&r.destroy()),(0,d.A)(e.postExecute)&&e.postExecute(t)},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){return(0,h.A)(this)};const x=v;var C=n(571804),E=n(673874),S=n(915325),I=n(944479),P=n(305439),D=n(471874),O=n(584164),R=n(276904),M=n(123245),L=n(352581),N=n(430332),B=n(346154);const F=function(e){this.context=e,this.framebuffer=void 0,this.blendingEnabled=void 0,this.scissorTest=void 0,this.viewport=void 0};var U=n(57775),k=n(342875);function V(e){this._context=e,this._shaders={},this._numberOfShaders=0,this._shadersToRelease={}}function z(e,t){const n=t.derivedKeywords,i=n.length;for(let o=0;o<i;++o){const i=n[o]+t.keyword;z(e,e._shaders[i])}delete e._shaders[t.keyword],t.shaderProgram.finalDestroy()}Object.defineProperties(V.prototype,{numberOfShaders:{get:function(){return this._numberOfShaders}}}),V.prototype.replaceShaderProgram=function(e){return(0,d.A)(e.shaderProgram)&&e.shaderProgram.destroy(),this.getShaderProgram(e)},V.prototype.getShaderProgram=function(e){let t=e.vertexShaderSource,n=e.fragmentShaderSource;const i=e.attributeLocations;"string"==typeof t&&(t=new k.A({sources:[t]})),"string"==typeof n&&(n=new k.A({sources:[n]}));const o=`${t.getCacheKey()}:${n.getCacheKey()}:${(0,d.A)(i)?function(e){const t=Object.keys(e).sort();return JSON.stringify(e,t)}(i):""}`;let r;if((0,d.A)(this._shaders[o]))r=this._shaders[o],delete this._shadersToRelease[o];else{const e=this._context,s=t.createCombinedVertexShader(e),a=n.createCombinedFragmentShader(e),c=new y.A({gl:e._gl,logShaderCompilation:e.logShaderCompilation,debugShaders:e.debugShaders,vertexShaderSource:t,vertexShaderText:s,fragmentShaderSource:n,fragmentShaderText:a,attributeLocations:i});r={cache:this,shaderProgram:c,keyword:o,derivedKeywords:[],count:0},c._cachedShader=r,this._shaders[o]=r,++this._numberOfShaders}return++r.count,r.shaderProgram},V.prototype.replaceDerivedShaderProgram=function(e,t,n){const i=e._cachedShader,o=t+i.keyword,r=this._shaders[o];if((0,d.A)(r)){z(this,r);const e=i.derivedKeywords.indexOf(t);e>-1&&i.derivedKeywords.splice(e,1)}return this.createDerivedShaderProgram(e,t,n)},V.prototype.getDerivedShaderProgram=function(e,t){const n=t+e._cachedShader.keyword,i=this._shaders[n];if((0,d.A)(i))return i.shaderProgram},V.prototype.createDerivedShaderProgram=function(e,t,n){const i=e._cachedShader,o=t+i.keyword;let r=n.vertexShaderSource,s=n.fragmentShaderSource;const a=n.attributeLocations;"string"==typeof r&&(r=new k.A({sources:[r]})),"string"==typeof s&&(s=new k.A({sources:[s]}));const c=this._context,l=r.createCombinedVertexShader(c),u=s.createCombinedFragmentShader(c),d=new y.A({gl:c._gl,logShaderCompilation:c.logShaderCompilation,debugShaders:c.debugShaders,vertexShaderSource:r,vertexShaderText:l,fragmentShaderSource:s,fragmentShaderText:u,attributeLocations:a}),h={cache:this,shaderProgram:d,keyword:o,derivedKeywords:[],count:0};return i.derivedKeywords.push(t),d._cachedShader=h,this._shaders[o]=h,d},V.prototype.destroyReleasedShaderPrograms=function(){const e=this._shadersToRelease;for(const t in e)e.hasOwnProperty(t)&&(z(this,e[t]),--this._numberOfShaders);this._shadersToRelease={}},V.prototype.releaseShaderProgram=function(e){if((0,d.A)(e)){const t=e._cachedShader;t&&0===--t.count&&(this._shadersToRelease[t.keyword]=t)}},V.prototype.isDestroyed=function(){return!1},V.prototype.destroy=function(){const e=this._shaders;for(const t in e)e.hasOwnProperty(t)&&e[t].shaderProgram.finalDestroy();return(0,h.A)(this)};const H=V;var G=n(616e3);function W(){this._textures={},this._numberOfTextures=0,this._texturesToRelease={}}Object.defineProperties(W.prototype,{numberOfTextures:{get:function(){return this._numberOfTextures}}}),W.prototype.getTexture=function(e){const t=this._textures[e];if((0,d.A)(t))return delete this._texturesToRelease[e],++t.count,t.texture},W.prototype.addTexture=function(e,t){const n={texture:t,count:1};t.finalDestroy=t.destroy;const i=this;t.destroy=function(){0===--n.count&&(i._texturesToRelease[e]=n)},this._textures[e]=n,++this._numberOfTextures},W.prototype.destroyReleasedTextures=function(){const e=this._texturesToRelease;for(const t in e)if(e.hasOwnProperty(t)){const n=e[t];delete this._textures[t],n.texture.finalDestroy(),--this._numberOfTextures}this._texturesToRelease={}},W.prototype.isDestroyed=function(){return!1},W.prototype.destroy=function(){const e=this._textures;for(const t in e)e.hasOwnProperty(t)&&e[t].texture.finalDestroy();return(0,h.A)(this)};const Y=W;var q=n(434067),j=n(267980),Q=n(626809),X=n(336946),K=n(610750),$=n(816422),J=n(367817),Z=n(331185),ee=n(811203),te=n(591978),ne=n(711337),ie=n(193387);const oe={};function re(e,t){t=te.A.addSeconds(e,32.184,t);const n=te.A.totalDays(t)-2451545;return t=te.A.addSeconds(t,function(e){const t=6.239996+.0172019696544*e;return.001657*Math.sin(t+.01671*Math.sin(t))}(n),t)}const se=new te.A(2451545,0,ie.A.TAI),ae=J.A.RADIANS_PER_DEGREE,ce=J.A.RADIANS_PER_ARCSECOND,le=new Z.A;function ue(e,t,n,i,o,r,s){if(n<0&&(n=-n,o+=J.A.PI),n<0||n>J.A.PI)throw new A.A("The inclination is out of range. Inclination must be greater than or equal to zero and less than or equal to Pi radians.");const a=e*(1-t),c=i-o,l=o,u=function(e,t){if(t<0||t>=1)throw new A.A("eccentricity out of range.");const n=function(e,t){if(t<0||t>=1)throw new A.A("eccentricity out of range.");const n=Math.floor(e/J.A.TWO_PI);let i,o=(e-=n*J.A.TWO_PI)+t*Math.sin(e)/(1-Math.sin(e+t)+Math.sin(e)),r=Number.MAX_VALUE;for(i=0;i<de&&Math.abs(r-o)>he;++i)r=o,o=r-(r-t*Math.sin(r)-e)/(1-t*Math.cos(r));if(i>=de)throw new A.A("Kepler equation did not converge");return r=o+n*J.A.TWO_PI,r}(e,t);return function(e,t){if(t<0||t>=1)throw new A.A("eccentricity out of range.");const n=Math.floor(e/J.A.TWO_PI);e-=n*J.A.TWO_PI;const i=Math.cos(e)-t,o=Math.sin(e)*Math.sqrt(1-t*t);let r=Math.atan2(o,i);return r=J.A.zeroToTwoPi(r),e<0&&(r-=J.A.TWO_PI),r+=n*J.A.TWO_PI,r}(n,t)}(r-i,t),h=function(e){if(e<0)throw new A.A("eccentricity cannot be negative.");return e<=0?"Circular":e<1?"Elliptical":e<=1?"Parabolic":"Hyperbolic"}(t);if("Hyperbolic"===h&&Math.abs(J.A.negativePiToPi(u))>=Math.acos(-1/t))throw new A.A("The true anomaly of the hyperbolic orbit lies outside of the bounds of the hyperbola.");!function(e,t,n,i){if(t<0||t>J.A.PI)throw new A.A("inclination out of range");const o=Math.cos(e),r=Math.sin(e),s=Math.cos(t),a=Math.sin(t),c=Math.cos(n),l=Math.sin(n);(0,d.A)(i)?(i[0]=c*o-l*r*s,i[1]=l*o+c*r*s,i[2]=r*a,i[3]=-c*r-l*o*s,i[4]=-l*r+c*o*s,i[5]=o*a,i[6]=l*a,i[7]=-c*a,i[8]=s):i=new Z.A(c*o-l*r*s,-c*r-l*o*s,l*a,l*o+c*r*s,-l*r+c*o*s,-c*a,r*a,o*a,s)}(c,n,l,le);const p=a*(1+t),f=Math.cos(u),m=Math.sin(u),g=1+t*f;if(g<=J.A.Epsilon10)throw new A.A("elements cannot be converted to cartesian");const _=p/g;return(0,d.A)(s)?(s.x=_*f,s.y=_*m,s.z=0):s=new j.A(_*f,_*m,0),Z.A.multiplyByVector(le,s,s)}const de=50,he=J.A.EPSILON8,Ae=100.46645683*ae,pe=1295977422.83429*ce,fe=1e-7*-79,me=232*1e-7,ge=1e-7*-52,_e=1e-7*-116,ye=new te.A(0,0,ie.A.TAI);function ve(e,t){re(e,ye);const n=(ye.dayNumber-se.dayNumber+(ye.secondsOfDay-se.secondsOfDay)/ne.A.SECONDS_PER_DAY)/ne.A.DAYS_PER_JULIAN_CENTURY,i=n*n,o=i*n,r=o*n;let s=383397.7725+.004*n,a=.055545526-16e-9*n;const c=5.15668983*ae;let l=-8e-5*n+.02966*i-42e-6*o-13e-8*r;const u=83.35324312*ae;let d=14643420.2669*n-38.2702*i-.045047*o+21301e-8*r;const h=125.04455501*ae;let A=-6967919.3631*n+6.3602*i+.007625*o-3586e-8*r;const p=218.31664563*ae;let f=1732559343.4847*n-6.391*i+.006588*o-3169e-8*r;const m=297.85019547*ae+ce*(1602961601.209*n-6.3706*i+.006593*o-3169e-8*r),g=134.96340251*ae+ce*(1717915923.2178*n+31.8792*i+.051635*o-2447e-7*r),_=357.52910918*ae+ce*(129596581.0481*n-.5532*i+136e-6*o-1149e-8*r),y=310.17137918*ae-ce*(6967051.436*n+6.2068*i+.007618*o-3219e-8*r),v=2*m,T=4*m,b=6*m,w=2*g,x=3*g,C=4*g,E=2*(93.27209062*ae+ce*(1739527262.8478*n-12.7512*i-.001037*o+417e-8*r));s+=3400.4*Math.cos(v)-635.6*Math.cos(v-g)-235.6*Math.cos(g)+218.1*Math.cos(v-_)+181*Math.cos(v+g),a+=.014216*Math.cos(v-g)+.008551*Math.cos(v-w)-.001383*Math.cos(g)+.001356*Math.cos(v+g)-.001147*Math.cos(T-x)-914e-6*Math.cos(T-w)+869e-6*Math.cos(v-_-g)-627e-6*Math.cos(v)-394e-6*Math.cos(T-C)+282e-6*Math.cos(v-_-w)-279e-6*Math.cos(m-g)-236e-6*Math.cos(w)+231e-6*Math.cos(T)+229e-6*Math.cos(b-C)-201e-6*Math.cos(w-E),l+=486.26*Math.cos(v-E)-40.13*Math.cos(v)+37.51*Math.cos(E)+25.73*Math.cos(w-E)+19.97*Math.cos(v-_-E),d+=-55609*Math.sin(v-g)-34711*Math.sin(v-w)-9792*Math.sin(g)+9385*Math.sin(T-x)+7505*Math.sin(T-w)+5318*Math.sin(v+g)+3484*Math.sin(T-C)-3417*Math.sin(v-_-g)-2530*Math.sin(b-C)-2376*Math.sin(v)-2075*Math.sin(v-x)-1883*Math.sin(w)-1736*Math.sin(b-5*g)+1626*Math.sin(_)-1370*Math.sin(b-x),A+=-5392*Math.sin(v-E)-540*Math.sin(_)-441*Math.sin(v)+423*Math.sin(E)-288*Math.sin(w-E),f+=-3332.9*Math.sin(v)+1197.4*Math.sin(v-g)-662.5*Math.sin(_)+396.3*Math.sin(g)-218*Math.sin(v-_);const S=2*y,I=3*y;l+=46.997*Math.cos(y)*n-.614*Math.cos(v-E+y)*n+.614*Math.cos(v-E-y)*n-.0297*Math.cos(S)*i-.0335*Math.cos(y)*i+.0012*Math.cos(v-E+S)*i-16e-5*Math.cos(y)*o+4e-5*Math.cos(I)*o+4e-5*Math.cos(S)*o;const P=2.116*Math.sin(y)*n-.111*Math.sin(v-E-y)*n-.0015*Math.sin(y)*i;return d+=P,f+=P,A+=-520.77*Math.sin(y)*n+13.66*Math.sin(v-E+y)*n+1.12*Math.sin(v-y)*n-1.06*Math.sin(E-y)*n+.66*Math.sin(S)*i+.371*Math.sin(y)*i-.035*Math.sin(v-E+S)*i-.015*Math.sin(v-E+y)*i+.0014*Math.sin(y)*o-.0011*Math.sin(I)*o-9e-4*Math.sin(S)*o,s*=1e3,ue(s,a,c+l*ce,u+d*ce,h+A*ce,p+f*ce,t)}const Te=new Z.A(1.0000000000000002,5619723173785822e-31,4690511510146299e-34,-5154129427414611e-31,.9174820620691819,-.39777715593191376,-223970096136568e-30,.39777715593191376,.9174820620691819);let be=new j.A;oe.computeSunPositionInEarthInertialFrame=function(e,t){return(0,d.A)(e)||(e=te.A.now()),(0,d.A)(t)||(t=new j.A),be=function(e,t){re(e,ye);const n=(ye.dayNumber-se.dayNumber+(ye.secondsOfDay-se.secondsOfDay)/ne.A.SECONDS_PER_DAY)/(10*ne.A.DAYS_PER_JULIAN_CENTURY),i=.3595362*n,o=149598022260.7121+957426.3679999999*Math.cos(16002*i)+-2243968.05*Math.sin(16002*i)+-2273887.624*Math.cos(21863*i)+-688150.202*Math.sin(21863*i)+927506.794*Math.cos(32004*i)+1017265.516*Math.sin(32004*i)+-119678.29599999999*Math.cos(10931*i)+807828.498*Math.sin(10931*i)+478713.18399999995*Math.cos(14529*i)+209437.01799999998*Math.sin(14529*i)+-613351.267*Math.cos(16368*i)+359034.888*Math.sin(16368*i)+284235.953*Math.cos(15318*i)+-418874.03599999996*Math.sin(15318*i)+-164557.657*Math.cos(32794*i)+329115.314*Math.sin(32794*i),r=Ae+pe*n+-325e-7*Math.cos(10*i)+-105e-7*Math.sin(10*i)+-322e-7*Math.cos(16002*i)+-137e-7*Math.sin(16002*i)+fe*Math.cos(21863*i)+258e-7*Math.sin(21863*i)+me*Math.cos(10931*i)+35e-7*Math.sin(10931*i)+ge*Math.cos(1473*i)+_e*Math.sin(1473*i)+97e-7*Math.cos(32004*i)+-88e-7*Math.sin(32004*i)+55e-7*Math.cos(4387*i)+-112e-7*Math.sin(4387*i)+-41e-7*Math.cos(73*i)+-8e-6*Math.sin(73*i);return ue(o,.0167086342-.0004203654*n,469.97289*ce*n,102.93734808*ae+11612.3529*ce*n,174.87317577*ae-8679.27034*ce*n,r,t)}(e,be),t=j.A.negate(be,t),function(e,t){t=ve(e,t),j.A.multiplyByScalar(t,-.01215058143522694,t)}(e,be),j.A.subtract(t,be,t),Z.A.multiplyByVector(Te,t,t),t},oe.computeMoonPositionInEarthInertialFrame=function(e,t){return(0,d.A)(e)||(e=te.A.now()),t=ve(e,t),Z.A.multiplyByVector(Te,t,t),t};const we=oe;var xe=n(543622),Ce=n(62467),Ee=n(205672);function Se(){this.globeDepthTexture=void 0,this.gamma=void 0,this._viewport=new c.A,this._viewportCartesian4=new Q.A,this._viewportDirty=!1,this._viewportOrthographicMatrix=O.A.clone(O.A.IDENTITY),this._viewportTransformation=O.A.clone(O.A.IDENTITY),this._model=O.A.clone(O.A.IDENTITY),this._view=O.A.clone(O.A.IDENTITY),this._inverseView=O.A.clone(O.A.IDENTITY),this._projection=O.A.clone(O.A.IDENTITY),this._infiniteProjection=O.A.clone(O.A.IDENTITY),this._entireFrustum=new q.A,this._currentFrustum=new q.A,this._frustumPlanes=new Q.A,this._farDepthFromNearPlusOne=void 0,this._log2FarDepthFromNearPlusOne=void 0,this._oneOverLog2FarDepthFromNearPlusOne=void 0,this._frameState=void 0,this._temeToPseudoFixed=Z.A.clone(O.A.IDENTITY),this._view3DDirty=!0,this._view3D=new O.A,this._inverseView3DDirty=!0,this._inverseView3D=new O.A,this._inverseModelDirty=!0,this._inverseModel=new O.A,this._inverseTransposeModelDirty=!0,this._inverseTransposeModel=new Z.A,this._viewRotation=new Z.A,this._inverseViewRotation=new Z.A,this._viewRotation3D=new Z.A,this._inverseViewRotation3D=new Z.A,this._inverseProjectionDirty=!0,this._inverseProjection=new O.A,this._modelViewDirty=!0,this._modelView=new O.A,this._modelView3DDirty=!0,this._modelView3D=new O.A,this._modelViewRelativeToEyeDirty=!0,this._modelViewRelativeToEye=new O.A,this._inverseModelViewDirty=!0,this._inverseModelView=new O.A,this._inverseModelView3DDirty=!0,this._inverseModelView3D=new O.A,this._viewProjectionDirty=!0,this._viewProjection=new O.A,this._inverseViewProjectionDirty=!0,this._inverseViewProjection=new O.A,this._modelViewProjectionDirty=!0,this._modelViewProjection=new O.A,this._inverseModelViewProjectionDirty=!0,this._inverseModelViewProjection=new O.A,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewProjectionRelativeToEye=new O.A,this._modelViewInfiniteProjectionDirty=!0,this._modelViewInfiniteProjection=new O.A,this._normalDirty=!0,this._normal=new Z.A,this._normal3DDirty=!0,this._normal3D=new Z.A,this._inverseNormalDirty=!0,this._inverseNormal=new Z.A,this._inverseNormal3DDirty=!0,this._inverseNormal3D=new Z.A,this._encodedCameraPositionMCDirty=!0,this._encodedCameraPositionMC=new $.A,this._cameraPosition=new j.A,this._sunPositionWC=new j.A,this._sunPositionColumbusView=new j.A,this._sunDirectionWC=new j.A,this._sunDirectionEC=new j.A,this._moonDirectionEC=new j.A,this._lightDirectionWC=new j.A,this._lightDirectionEC=new j.A,this._lightColor=new j.A,this._lightColorHdr=new j.A,this._pass=void 0,this._mode=void 0,this._mapProjection=void 0,this._ellipsoid=void 0,this._cameraDirection=new j.A,this._cameraRight=new j.A,this._cameraUp=new j.A,this._frustum2DWidth=0,this._eyeHeight=0,this._eyeHeight2D=new q.A,this._eyeEllipsoidNormalEC=new j.A,this._eyeEllipsoidCurvature=new q.A,this._modelToEnu=new O.A,this._enuToModel=new O.A,this._pixelRatio=1,this._orthographicIn3D=!1,this._backgroundColor=new u.A,this._brdfLut=void 0,this._environmentMap=void 0,this._sphericalHarmonicCoefficients=void 0,this._specularEnvironmentMaps=void 0,this._specularEnvironmentMapsMaximumLOD=void 0,this._fogDensity=void 0,this._fogVisualDensityScalar=void 0,this._fogMinimumBrightness=void 0,this._atmosphereHsbShift=void 0,this._atmosphereLightIntensity=void 0,this._atmosphereRayleighCoefficient=new j.A,this._atmosphereRayleighScaleHeight=new j.A,this._atmosphereMieCoefficient=new j.A,this._atmosphereMieScaleHeight=void 0,this._atmosphereMieAnisotropy=void 0,this._atmosphereDynamicLighting=void 0,this._invertClassificationColor=void 0,this._splitPosition=0,this._pixelSizePerMeter=void 0,this._geometricToleranceOverMeter=void 0,this._minimumDisableDepthTestDistance=void 0}Object.defineProperties(Se.prototype,{frameState:{get:function(){return this._frameState}},viewport:{get:function(){return this._viewport},set:function(e){if(!c.A.equals(e,this._viewport)){c.A.clone(e,this._viewport);const t=this._viewport,n=this._viewportCartesian4;n.x=t.x,n.y=t.y,n.z=t.width,n.w=t.height,this._viewportDirty=!0}}},viewportCartesian4:{get:function(){return this._viewportCartesian4}},viewportOrthographic:{get:function(){return Le(this),this._viewportOrthographicMatrix}},viewportTransformation:{get:function(){return Le(this),this._viewportTransformation}},model:{get:function(){return this._model},set:function(e){O.A.clone(e,this._model),this._modelView3DDirty=!0,this._inverseModelView3DDirty=!0,this._inverseModelDirty=!0,this._inverseTransposeModelDirty=!0,this._modelViewDirty=!0,this._inverseModelViewDirty=!0,this._modelViewRelativeToEyeDirty=!0,this._inverseModelViewDirty=!0,this._modelViewProjectionDirty=!0,this._inverseModelViewProjectionDirty=!0,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewInfiniteProjectionDirty=!0,this._normalDirty=!0,this._inverseNormalDirty=!0,this._normal3DDirty=!0,this._inverseNormal3DDirty=!0,this._encodedCameraPositionMCDirty=!0}},inverseModel:{get:function(){return this._inverseModelDirty&&(this._inverseModelDirty=!1,O.A.inverse(this._model,this._inverseModel)),this._inverseModel}},inverseTransposeModel:{get:function(){const e=this._inverseTransposeModel;return this._inverseTransposeModelDirty&&(this._inverseTransposeModelDirty=!1,O.A.getMatrix3(this.inverseModel,e),Z.A.transpose(e,e)),e}},view:{get:function(){return this._view}},view3D:{get:function(){return We(this),this._view3D}},viewRotation:{get:function(){return We(this),this._viewRotation}},viewRotation3D:{get:function(){return We(this),this._viewRotation3D}},inverseView:{get:function(){return this._inverseView}},inverseView3D:{get:function(){return Ye(this),this._inverseView3D}},inverseViewRotation:{get:function(){return this._inverseViewRotation}},inverseViewRotation3D:{get:function(){return Ye(this),this._inverseViewRotation3D}},projection:{get:function(){return this._projection}},inverseProjection:{get:function(){var e;return(e=this)._inverseProjectionDirty&&(e._inverseProjectionDirty=!1,e._mode===Ce.A.SCENE2D||e._mode===Ce.A.MORPHING||e._orthographicIn3D?O.A.clone(O.A.ZERO,e._inverseProjection):O.A.inverse(e._projection,e._inverseProjection)),this._inverseProjection}},infiniteProjection:{get:function(){return this._infiniteProjection}},modelView:{get:function(){var e;return(e=this)._modelViewDirty&&(e._modelViewDirty=!1,O.A.multiplyTransformation(e._view,e._model,e._modelView)),this._modelView}},modelView3D:{get:function(){var e;return(e=this)._modelView3DDirty&&(e._modelView3DDirty=!1,O.A.multiplyTransformation(e.view3D,e._model,e._modelView3D)),this._modelView3D}},modelViewRelativeToEye:{get:function(){return function(e){if(e._modelViewRelativeToEyeDirty){e._modelViewRelativeToEyeDirty=!1;const t=e.modelView,n=e._modelViewRelativeToEye;n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=0,n[13]=0,n[14]=0,n[15]=t[15]}}(this),this._modelViewRelativeToEye}},inverseModelView:{get:function(){var e;return(e=this)._inverseModelViewDirty&&(e._inverseModelViewDirty=!1,O.A.inverse(e.modelView,e._inverseModelView)),this._inverseModelView}},inverseModelView3D:{get:function(){var e;return(e=this)._inverseModelView3DDirty&&(e._inverseModelView3DDirty=!1,O.A.inverse(e.modelView3D,e._inverseModelView3D)),this._inverseModelView3D}},viewProjection:{get:function(){var e;return(e=this)._viewProjectionDirty&&(e._viewProjectionDirty=!1,O.A.multiply(e._projection,e._view,e._viewProjection)),this._viewProjection}},inverseViewProjection:{get:function(){var e;return(e=this)._inverseViewProjectionDirty&&(e._inverseViewProjectionDirty=!1,O.A.inverse(e.viewProjection,e._inverseViewProjection)),this._inverseViewProjection}},modelViewProjection:{get:function(){var e;return(e=this)._modelViewProjectionDirty&&(e._modelViewProjectionDirty=!1,O.A.multiply(e._projection,e.modelView,e._modelViewProjection)),this._modelViewProjection}},inverseModelViewProjection:{get:function(){var e;return(e=this)._inverseModelViewProjectionDirty&&(e._inverseModelViewProjectionDirty=!1,O.A.inverse(e.modelViewProjection,e._inverseModelViewProjection)),this._inverseModelViewProjection}},modelViewProjectionRelativeToEye:{get:function(){var e;return(e=this)._modelViewProjectionRelativeToEyeDirty&&(e._modelViewProjectionRelativeToEyeDirty=!1,O.A.multiply(e._projection,e.modelViewRelativeToEye,e._modelViewProjectionRelativeToEye)),this._modelViewProjectionRelativeToEye}},modelViewInfiniteProjection:{get:function(){var e;return(e=this)._modelViewInfiniteProjectionDirty&&(e._modelViewInfiniteProjectionDirty=!1,O.A.multiply(e._infiniteProjection,e.modelView,e._modelViewInfiniteProjection)),this._modelViewInfiniteProjection}},normal:{get:function(){return function(e){if(e._normalDirty){e._normalDirty=!1;const t=e._normal;O.A.getMatrix3(e.inverseModelView,t),Z.A.transpose(t,t)}}(this),this._normal}},normal3D:{get:function(){return function(e){if(e._normal3DDirty){e._normal3DDirty=!1;const t=e._normal3D;O.A.getMatrix3(e.inverseModelView3D,t),Z.A.transpose(t,t)}}(this),this._normal3D}},inverseNormal:{get:function(){return function(e){if(e._inverseNormalDirty){e._inverseNormalDirty=!1;const t=e._inverseNormal;O.A.getMatrix3(e.modelView,t),Z.A.transpose(t,t)}}(this),this._inverseNormal}},inverseNormal3D:{get:function(){return function(e){if(e._inverseNormal3DDirty){e._inverseNormal3DDirty=!1;const t=e._inverseNormal3D;O.A.getMatrix3(e.modelView3D,t),Z.A.transpose(t,t)}}(this),this._inverseNormal3D}},entireFrustum:{get:function(){return this._entireFrustum}},currentFrustum:{get:function(){return this._currentFrustum}},frustumPlanes:{get:function(){return this._frustumPlanes}},farDepthFromNearPlusOne:{get:function(){return this._farDepthFromNearPlusOne}},log2FarDepthFromNearPlusOne:{get:function(){return this._log2FarDepthFromNearPlusOne}},oneOverLog2FarDepthFromNearPlusOne:{get:function(){return this._oneOverLog2FarDepthFromNearPlusOne}},eyeHeight:{get:function(){return this._eyeHeight}},eyeHeight2D:{get:function(){return this._eyeHeight2D}},eyeEllipsoidNormalEC:{get:function(){return this._eyeEllipsoidNormalEC}},eyeEllipsoidCurvature:{get:function(){return this._eyeEllipsoidCurvature}},modelToEnu:{get:function(){return this._modelToEnu}},enuToModel:{get:function(){return this._enuToModel}},sunPositionWC:{get:function(){return this._sunPositionWC}},sunPositionColumbusView:{get:function(){return this._sunPositionColumbusView}},sunDirectionWC:{get:function(){return this._sunDirectionWC}},sunDirectionEC:{get:function(){return this._sunDirectionEC}},moonDirectionEC:{get:function(){return this._moonDirectionEC}},lightDirectionWC:{get:function(){return this._lightDirectionWC}},lightDirectionEC:{get:function(){return this._lightDirectionEC}},lightColor:{get:function(){return this._lightColor}},lightColorHdr:{get:function(){return this._lightColorHdr}},encodedCameraPositionMCHigh:{get:function(){return Be(this),this._encodedCameraPositionMC.high}},encodedCameraPositionMCLow:{get:function(){return Be(this),this._encodedCameraPositionMC.low}},temeToPseudoFixedMatrix:{get:function(){return this._temeToPseudoFixed}},pixelRatio:{get:function(){return this._pixelRatio}},fogDensity:{get:function(){return this._fogDensity}},fogVisualDensityScalar:{get:function(){return this._fogVisualDensityScalar}},fogMinimumBrightness:{get:function(){return this._fogMinimumBrightness}},atmosphereHsbShift:{get:function(){return this._atmosphereHsbShift}},atmosphereLightIntensity:{get:function(){return this._atmosphereLightIntensity}},atmosphereRayleighCoefficient:{get:function(){return this._atmosphereRayleighCoefficient}},atmosphereRayleighScaleHeight:{get:function(){return this._atmosphereRayleighScaleHeight}},atmosphereMieCoefficient:{get:function(){return this._atmosphereMieCoefficient}},atmosphereMieScaleHeight:{get:function(){return this._atmosphereMieScaleHeight}},atmosphereMieAnisotropy:{get:function(){return this._atmosphereMieAnisotropy}},atmosphereDynamicLighting:{get:function(){return this._atmosphereDynamicLighting}},geometricToleranceOverMeter:{get:function(){return this._geometricToleranceOverMeter}},pass:{get:function(){return this._pass}},backgroundColor:{get:function(){return this._backgroundColor}},brdfLut:{get:function(){return this._brdfLut}},environmentMap:{get:function(){return this._environmentMap}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps}},specularEnvironmentMapsMaximumLOD:{get:function(){return this._specularEnvironmentMapsMaximumLOD}},splitPosition:{get:function(){return this._splitPosition}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance}},invertClassificationColor:{get:function(){return this._invertClassificationColor}},orthographicIn3D:{get:function(){return this._orthographicIn3D}},ellipsoid:{get:function(){return this._ellipsoid??K.A.default}}});const Ie=new j.A,Pe=new O.A,De=new Z.A,Oe=new X.A;Se.prototype.updateCamera=function(e){var t,n;t=this,n=e.viewMatrix,O.A.clone(n,t._view),O.A.getMatrix3(n,t._viewRotation),t._view3DDirty=!0,t._inverseView3DDirty=!0,t._modelViewDirty=!0,t._modelView3DDirty=!0,t._modelViewRelativeToEyeDirty=!0,t._inverseModelViewDirty=!0,t._inverseModelView3DDirty=!0,t._viewProjectionDirty=!0,t._inverseViewProjectionDirty=!0,t._modelViewProjectionDirty=!0,t._modelViewProjectionRelativeToEyeDirty=!0,t._modelViewInfiniteProjectionDirty=!0,t._normalDirty=!0,t._inverseNormalDirty=!0,t._normal3DDirty=!0,t._inverseNormal3DDirty=!0,function(e,t){O.A.clone(t,e._inverseView),O.A.getMatrix3(t,e._inverseViewRotation)}(this,e.inverseViewMatrix),function(e,t){j.A.clone(t.positionWC,e._cameraPosition),j.A.clone(t.directionWC,e._cameraDirection),j.A.clone(t.rightWC,e._cameraRight),j.A.clone(t.upWC,e._cameraUp);const n=e._ellipsoid;let i;const o=t.positionCartographic;if((0,d.A)(o)?(e._eyeHeight=o.height,e._eyeEllipsoidNormalEC=n.geodeticSurfaceNormalCartographic(o,e._eyeEllipsoidNormalEC),i=j.A.fromRadians(o.longitude,o.latitude,0,n,Ie)):(e._eyeHeight=-n.maximumRadius,j.A.magnitude(t.positionWC)>0&&(e._eyeEllipsoidNormalEC=j.A.normalize(t.positionWC,e._eyeEllipsoidNormalEC)),i=n.scaleToGeodeticSurface(t.positionWC,Ie)),e._encodedCameraPositionMCDirty=!0,!(0,d.A)(i))return;e._eyeEllipsoidNormalEC=Z.A.multiplyByVector(e._viewRotation,e._eyeEllipsoidNormalEC,e._eyeEllipsoidNormalEC);const r=xe.A.eastNorthUpToFixedFrame(i,n,Pe);e._enuToModel=O.A.multiplyTransformation(e.inverseModel,r,e._enuToModel),e._modelToEnu=O.A.inverseTransformation(e._enuToModel,e._modelToEnu),J.A.equalsEpsilon(n._radii.x,n._radii.y,J.A.EPSILON15)&&(e._eyeEllipsoidCurvature=n.getLocalCurvature(i,e._eyeEllipsoidCurvature))}(this,e),this._entireFrustum.x=e.frustum.near,this._entireFrustum.y=e.frustum.far,this.updateFrustum(e.frustum),this._orthographicIn3D=this._mode!==Ce.A.SCENE2D&&e.frustum instanceof ee.A},Se.prototype.updateFrustum=function(e){var t,n;t=this,n=e.projectionMatrix,O.A.clone(n,t._projection),t._inverseProjectionDirty=!0,t._viewProjectionDirty=!0,t._inverseViewProjectionDirty=!0,t._modelViewProjectionDirty=!0,t._modelViewProjectionRelativeToEyeDirty=!0,(0,d.A)(e.infiniteProjectionMatrix)&&function(e,t){O.A.clone(t,e._infiniteProjection),e._modelViewInfiniteProjectionDirty=!0}(this,e.infiniteProjectionMatrix),this._currentFrustum.x=e.near,this._currentFrustum.y=e.far,this._farDepthFromNearPlusOne=e.far-e.near+1,this._log2FarDepthFromNearPlusOne=J.A.log2(this._farDepthFromNearPlusOne),this._oneOverLog2FarDepthFromNearPlusOne=1/this._log2FarDepthFromNearPlusOne;const i=e.offCenterFrustum;(0,d.A)(i)&&(e=i),this._frustumPlanes.x=e.top,this._frustumPlanes.y=e.bottom,this._frustumPlanes.z=e.left,this._frustumPlanes.w=e.right},Se.prototype.updatePass=function(e){this._pass=e};const Re=[],Me=new Ee.A;function Le(e){if(e._viewportDirty){const t=e._viewport;O.A.computeOrthographicOffCenter(t.x,t.x+t.width,t.y,t.y+t.height,0,1,e._viewportOrthographicMatrix),O.A.computeViewportTransformation(t,0,1,e._viewportTransformation),e._viewportDirty=!1}}Se.prototype.update=function(e){this._mode=e.mode,this._mapProjection=e.mapProjection,this._ellipsoid=e.mapProjection.ellipsoid,this._pixelRatio=e.pixelRatio;const t=e.camera;this.updateCamera(t),e.mode===Ce.A.SCENE2D?(this._frustum2DWidth=t.frustum.right-t.frustum.left,this._eyeHeight2D.x=.5*this._frustum2DWidth,this._eyeHeight2D.y=this._eyeHeight2D.x*this._eyeHeight2D.x):(this._frustum2DWidth=0,this._eyeHeight2D.x=0,this._eyeHeight2D.y=0),function(e,t){xe.A.computeIcrfToCentralBodyFixedMatrix(t.time,De);let n=we.computeSunPositionInEarthInertialFrame(t.time,e._sunPositionWC);Z.A.multiplyByVector(De,n,n),j.A.normalize(n,e._sunDirectionWC),n=Z.A.multiplyByVector(e.viewRotation3D,n,e._sunDirectionEC),j.A.normalize(n,n),n=we.computeMoonPositionInEarthInertialFrame(t.time,e._moonDirectionEC),Z.A.multiplyByVector(De,n,n),Z.A.multiplyByVector(e.viewRotation3D,n,n),j.A.normalize(n,n);const i=t.mapProjection,o=i.ellipsoid.cartesianToCartographic(e._sunPositionWC,Oe);i.project(o,e._sunPositionColumbusView)}(this,e);const n=e.light??Me;n instanceof Ee.A?(this._lightDirectionWC=j.A.clone(this._sunDirectionWC,this._lightDirectionWC),this._lightDirectionEC=j.A.clone(this._sunDirectionEC,this._lightDirectionEC)):(this._lightDirectionWC=j.A.normalize(j.A.negate(n.direction,this._lightDirectionWC),this._lightDirectionWC),this._lightDirectionEC=Z.A.multiplyByVector(this.viewRotation3D,this._lightDirectionWC,this._lightDirectionEC));const i=n.color;let o=j.A.fromElements(i.red,i.green,i.blue,this._lightColorHdr);o=j.A.multiplyByScalar(o,n.intensity,o);const r=j.A.maximumComponent(o);r>1?j.A.divideByScalar(o,r,this._lightColor):j.A.clone(o,this._lightColor);const s=e.brdfLutGenerator,a=(0,d.A)(s)?s.colorTexture:void 0;this._brdfLut=a,this._environmentMap=e.environmentMap??e.context.defaultCubeMap,this._sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients??Re,this._specularEnvironmentMaps=e.specularEnvironmentMaps,this._specularEnvironmentMapsMaximumLOD=e.specularEnvironmentMapsMaximumLOD,this._fogDensity=e.fog.density,this._fogVisualDensityScalar=e.fog.visualDensityScalar,this._fogMinimumBrightness=e.fog.minimumBrightness;const c=e.atmosphere;(0,d.A)(c)&&(this._atmosphereHsbShift=j.A.fromElements(c.hueShift,c.saturationShift,c.brightnessShift,this._atmosphereHsbShift),this._atmosphereLightIntensity=c.lightIntensity,this._atmosphereRayleighCoefficient=j.A.clone(c.rayleighCoefficient,this._atmosphereRayleighCoefficient),this._atmosphereRayleighScaleHeight=c.rayleighScaleHeight,this._atmosphereMieCoefficient=j.A.clone(c.mieCoefficient,this._atmosphereMieCoefficient),this._atmosphereMieScaleHeight=c.mieScaleHeight,this._atmosphereMieAnisotropy=c.mieAnisotropy,this._atmosphereDynamicLighting=c.dynamicLighting),this._invertClassificationColor=e.invertClassificationColor,this._frameState=e,this._temeToPseudoFixed=xe.A.computeTemeToPseudoFixedMatrix(e.time,this._temeToPseudoFixed),this._splitPosition=e.splitPosition*e.context.drawingBufferWidth;const l=t.frustum.fov,h=this._viewport;let A;A=(0,d.A)(l)?h.height>h.width?2*Math.tan(.5*l)/h.height:2*Math.tan(.5*l)/h.width:1/Math.max(h.width,h.height),this._geometricToleranceOverMeter=A*e.maximumScreenSpaceError,u.A.clone(e.backgroundColor,this._backgroundColor),this._minimumDisableDepthTestDistance=e.minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance*=this._minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance===Number.POSITIVE_INFINITY&&(this._minimumDisableDepthTestDistance=-1)};const Ne=new j.A;function Be(e){e._encodedCameraPositionMCDirty&&(e._encodedCameraPositionMCDirty=!1,O.A.multiplyByPoint(e.inverseModel,e._cameraPosition,Ne),$.A.fromCartesian(Ne,e._encodedCameraPositionMC))}const Fe=new j.A,Ue=new j.A,ke=new j.A,Ve=new j.A,ze=new X.A,He=new j.A,Ge=new O.A;function We(e){e._view3DDirty&&(e._mode===Ce.A.SCENE3D?O.A.clone(e._view,e._view3D):function(e,t,n,i,o,r,s,a){const c=Fe;c.x=e.y,c.y=e.z,c.z=e.x;const l=Ue;l.x=n.y,l.y=n.z,l.z=n.x;const u=ke;u.x=i.y,u.y=i.z,u.z=i.x;const h=Ve;h.x=t.y,h.y=t.z,h.z=t.x,r===Ce.A.SCENE2D&&(c.z=.5*o);const A=s.unproject(c,ze);A.longitude=J.A.clamp(A.longitude,-Math.PI,Math.PI),A.latitude=J.A.clamp(A.latitude,-J.A.PI_OVER_TWO,J.A.PI_OVER_TWO);const p=s.ellipsoid,f=p.cartographicToCartesian(A,He),m=xe.A.eastNorthUpToFixedFrame(f,p,Ge);O.A.multiplyByPointAsVector(m,l,l),O.A.multiplyByPointAsVector(m,u,u),O.A.multiplyByPointAsVector(m,h,h),(0,d.A)(a)||(a=new O.A),a[0]=l.x,a[1]=u.x,a[2]=-h.x,a[3]=0,a[4]=l.y,a[5]=u.y,a[6]=-h.y,a[7]=0,a[8]=l.z,a[9]=u.z,a[10]=-h.z,a[11]=0,a[12]=-j.A.dot(l,f),a[13]=-j.A.dot(u,f),a[14]=j.A.dot(h,f),a[15]=1}(e._cameraPosition,e._cameraDirection,e._cameraRight,e._cameraUp,e._frustum2DWidth,e._mode,e._mapProjection,e._view3D),O.A.getMatrix3(e._view3D,e._viewRotation3D),e._view3DDirty=!1)}function Ye(e){e._inverseView3DDirty&&(O.A.inverseTransformation(e.view3D,e._inverseView3D),O.A.getMatrix3(e._inverseView3D,e._inverseViewRotation3D),e._inverseView3DDirty=!1)}const qe=Se;var je=n(508380);function Qe(e,t){l.A.defined("canvas",e);const{getWebGLStub:n,requestWebgl1:i,webgl:o={},allowTextureFilterAnisotropic:r=!0}=t??{};o.alpha=o.alpha??!1,o.stencil=o.stencil??!0,o.powerPreference=o.powerPreference??"high-performance";const s=(0,d.A)(n)?n(e,o):function(e,t,n){if("undefined"==typeof WebGLRenderingContext)throw new M.A("The browser does not support WebGL.  Visit http://get.webgl.org.");const i="undefined"!=typeof WebGL2RenderingContext;n||i||(n=!0);const o=n?"webgl":"webgl2",r=e.getContext(o,t);if(!(0,d.A)(r))throw new M.A("The browser supports WebGL, but initialization failed.");return r}(e,o,i),a="undefined"!=typeof WebGL2RenderingContext&&s instanceof WebGL2RenderingContext;this._canvas=e,this._originalGLContext=s,this._gl=s,this._webgl2=a,this._id=(0,E.A)(),this.validateFramebuffer=!1,this.validateShaderProgram=!1,this.logShaderCompilation=!1,this._throwOnWebGLError=!1,this._shaderCache=new H(this),this._textureCache=new Y;const c=s;this._stencilBits=c.getParameter(c.STENCIL_BITS),N.A._maximumCombinedTextureImageUnits=c.getParameter(c.MAX_COMBINED_TEXTURE_IMAGE_UNITS),N.A._maximumCubeMapSize=c.getParameter(c.MAX_CUBE_MAP_TEXTURE_SIZE),N.A._maximumFragmentUniformVectors=c.getParameter(c.MAX_FRAGMENT_UNIFORM_VECTORS),N.A._maximumTextureImageUnits=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS),N.A._maximumRenderbufferSize=c.getParameter(c.MAX_RENDERBUFFER_SIZE),N.A._maximumTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE),N.A._maximumVaryingVectors=c.getParameter(c.MAX_VARYING_VECTORS),N.A._maximumVertexAttributes=c.getParameter(c.MAX_VERTEX_ATTRIBS),N.A._maximumVertexTextureImageUnits=c.getParameter(c.MAX_VERTEX_TEXTURE_IMAGE_UNITS),N.A._maximumVertexUniformVectors=c.getParameter(c.MAX_VERTEX_UNIFORM_VECTORS),N.A._maximumSamples=this._webgl2?c.getParameter(c.MAX_SAMPLES):0;const h=c.getParameter(c.ALIASED_LINE_WIDTH_RANGE);N.A._minimumAliasedLineWidth=h[0],N.A._maximumAliasedLineWidth=h[1];const A=c.getParameter(c.ALIASED_POINT_SIZE_RANGE);N.A._minimumAliasedPointSize=A[0],N.A._maximumAliasedPointSize=A[1];const p=c.getParameter(c.MAX_VIEWPORT_DIMS);N.A._maximumViewportWidth=p[0],N.A._maximumViewportHeight=p[1];const f=c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.HIGH_FLOAT);N.A._highpFloatSupported=0!==f.precision;const m=c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.HIGH_INT);N.A._highpIntSupported=0!==m.rangeMax,this._antialias=c.getContextAttributes().antialias,this._standardDerivatives=!!$e(c,["OES_standard_derivatives"]),this._blendMinmax=!!$e(c,["EXT_blend_minmax"]),this._elementIndexUint=!!$e(c,["OES_element_index_uint"]),this._depthTexture=!!$e(c,["WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]),this._fragDepth=!!$e(c,["EXT_frag_depth"]),this._debugShaders=$e(c,["WEBGL_debug_shaders"]),this._textureFloat=!!$e(c,["OES_texture_float"]),this._textureHalfFloat=!!$e(c,["OES_texture_half_float"]),this._textureFloatLinear=!!$e(c,["OES_texture_float_linear"]),this._textureHalfFloatLinear=!!$e(c,["OES_texture_half_float_linear"]),this._supportsTextureLod=!!$e(c,["EXT_shader_texture_lod"]),this._colorBufferFloat=!!$e(c,["EXT_color_buffer_float","WEBGL_color_buffer_float"]),this._floatBlend=!!$e(c,["EXT_float_blend"]),this._colorBufferHalfFloat=!!$e(c,["EXT_color_buffer_half_float"]),this._s3tc=!!$e(c,["WEBGL_compressed_texture_s3tc","MOZ_WEBGL_compressed_texture_s3tc","WEBKIT_WEBGL_compressed_texture_s3tc"]),this._pvrtc=!!$e(c,["WEBGL_compressed_texture_pvrtc","WEBKIT_WEBGL_compressed_texture_pvrtc"]),this._astc=!!$e(c,["WEBGL_compressed_texture_astc"]),this._etc=!!$e(c,["WEBG_compressed_texture_etc"]),this._etc1=!!$e(c,["WEBGL_compressed_texture_etc1"]),this._bc7=!!$e(c,["EXT_texture_compression_bptc"]),D.A.setKTX2SupportedFormats(this._s3tc,this._pvrtc,this._astc,this._etc,this._etc1,this._bc7);const g=r?$e(c,["EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"]):void 0;let y,v,T,b,w,x,C,S,I,P;if(this._textureFilterAnisotropic=g,N.A._maximumTextureFilterAnisotropy=(0,d.A)(g)?c.getParameter(g.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1,a){const e=this;y=function(){return e._gl.createVertexArray()},v=function(t){e._gl.bindVertexArray(t)},T=function(t){e._gl.deleteVertexArray(t)},b=function(e,t,n,i,o){c.drawElementsInstanced(e,t,n,i,o)},w=function(e,t,n,i){c.drawArraysInstanced(e,t,n,i)},x=function(e,t){c.vertexAttribDivisor(e,t)},C=function(e){c.drawBuffers(e)}}else S=$e(c,["OES_vertex_array_object"]),(0,d.A)(S)&&(y=function(){return S.createVertexArrayOES()},v=function(e){S.bindVertexArrayOES(e)},T=function(e){S.deleteVertexArrayOES(e)}),I=$e(c,["ANGLE_instanced_arrays"]),(0,d.A)(I)&&(b=function(e,t,n,i,o){I.drawElementsInstancedANGLE(e,t,n,i,o)},w=function(e,t,n,i){I.drawArraysInstancedANGLE(e,t,n,i)},x=function(e,t){I.vertexAttribDivisorANGLE(e,t)}),P=$e(c,["WEBGL_draw_buffers"]),(0,d.A)(P)&&(C=function(e){P.drawBuffersWEBGL(e)});this.glCreateVertexArray=y,this.glBindVertexArray=v,this.glDeleteVertexArray=T,this.glDrawElementsInstanced=b,this.glDrawArraysInstanced=w,this.glVertexAttribDivisor=x,this.glDrawBuffers=C,this._vertexArrayObject=!!S,this._instancedArrays=!!I,this._drawBuffers=!!P,N.A._maximumDrawBuffers=this.drawBuffers?c.getParameter(L.A.MAX_DRAW_BUFFERS):1,N.A._maximumColorAttachments=this.drawBuffers?c.getParameter(L.A.MAX_COLOR_ATTACHMENTS):1,this._clearColor=new u.A(0,0,0,0),this._clearDepth=1,this._clearStencil=0;const O=new qe,R=new F(this),B=_.A.fromCache();this._defaultPassState=R,this._defaultRenderState=B,this._defaultTexture=void 0,this._defaultEmissiveTexture=void 0,this._defaultNormalTexture=void 0,this._defaultCubeMap=void 0,this._us=O,this._currentRenderState=B,this._currentPassState=R,this._currentFramebuffer=void 0,this._maxFrameTextureUnitIndex=0,this._vertexAttribDivisors=[],this._previousDrawInstanced=!1;for(let e=0;e<N.A._maximumVertexAttributes;e++)this._vertexAttribDivisors.push(0);this._pickObjects={},this._nextPickColor=new Uint32Array(1),this.options={getWebGLStub:n,requestWebgl1:i,webgl:o,allowTextureFilterAnisotropic:r},this.cache={},_.A.apply(c,B,R)}function Xe(e,t,n){const i=e.getError();if(i!==e.NO_ERROR)throw new M.A(function(e,t,n,i){let o=`${function(e,t){let n="WebGL Error:  ";switch(t){case e.INVALID_ENUM:n+="INVALID_ENUM";break;case e.INVALID_VALUE:n+="INVALID_VALUE";break;case e.INVALID_OPERATION:n+="INVALID_OPERATION";break;case e.OUT_OF_MEMORY:n+="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:n+="CONTEXT_LOST_WEBGL lost";break;default:n+=`Unknown (${t})`}return n}(e,i)}: ${t.name}(`;for(let e=0;e<n.length;++e)0!==e&&(o+=", "),o+=n[e];return o+=");",o}(e,t,n,i))}function Ke(e,t,n){return{get:function(){const i=e[t];return n(e,`get: ${t}`,i),e[t]},set:function(i){e[t]=i,n(e,`set: ${t}`,i)}}}function $e(e,t){const n=t.length;for(let i=0;i<n;++i){const n=e.getExtension(t[i]);if(n)return n}}const Je={};function Ze(e,t,n,i){const o=e._currentRenderState,r=e._currentPassState;e._currentRenderState=t,e._currentPassState=n,_.A.partialApply(e._gl,o,t,r,n,i)}let et;function tt(e,t){if(t!==e._currentFramebuffer){e._currentFramebuffer=t;let n=et;if((0,d.A)(t))t._bind(),function(e){if(e.validateFramebuffer){const t=e._gl,n=t.checkFramebufferStatus(t.FRAMEBUFFER);if(n!==t.FRAMEBUFFER_COMPLETE){let e;switch(n){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:e="Framebuffer is not complete.  Incomplete attachment: at least one attachment point with a renderbuffer or texture attached has its attached object no longer in existence or has an attached image with a width or height of zero, or the color attachment point has a non-color-renderable image attached, or the depth attachment point has a non-depth-renderable image attached, or the stencil attachment point has a non-stencil-renderable image attached.  Color-renderable formats include GL_RGBA4, GL_RGB5_A1, and GL_RGB565. GL_DEPTH_COMPONENT16 is the only depth-renderable format. GL_STENCIL_INDEX8 is the only stencil-renderable format.";break;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:e="Framebuffer is not complete.  Incomplete dimensions: not all attached images have the same width and height.";break;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:e="Framebuffer is not complete.  Missing attachment: no images are attached to the framebuffer.";break;case t.FRAMEBUFFER_UNSUPPORTED:e="Framebuffer is not complete.  Unsupported: the combination of internal formats of the attached images violates an implementation-dependent set of restrictions."}throw new A.A(e)}}}(e),n=t._getActiveColorAttachments();else{const t=e._gl;t.bindFramebuffer(t.FRAMEBUFFER,null)}e.drawBuffers&&e.glDrawBuffers(n)}}Object.defineProperties(Qe.prototype,{id:{get:function(){return this._id}},webgl2:{get:function(){return this._webgl2}},canvas:{get:function(){return this._canvas}},shaderCache:{get:function(){return this._shaderCache}},textureCache:{get:function(){return this._textureCache}},uniformState:{get:function(){return this._us}},stencilBits:{get:function(){return this._stencilBits}},stencilBuffer:{get:function(){return this._stencilBits>=8}},antialias:{get:function(){return this._antialias}},msaa:{get:function(){return this._webgl2}},standardDerivatives:{get:function(){return this._standardDerivatives||this._webgl2}},floatBlend:{get:function(){return this._floatBlend}},blendMinmax:{get:function(){return this._blendMinmax||this._webgl2}},elementIndexUint:{get:function(){return this._elementIndexUint||this._webgl2}},depthTexture:{get:function(){return this._depthTexture||this._webgl2}},floatingPointTexture:{get:function(){return this._webgl2||this._textureFloat}},halfFloatingPointTexture:{get:function(){return this._webgl2||this._textureHalfFloat}},textureFloatLinear:{get:function(){return this._textureFloatLinear}},textureHalfFloatLinear:{get:function(){return this._webgl2&&this._textureFloatLinear||!this._webgl2&&this._textureHalfFloatLinear}},supportsTextureLod:{get:function(){return this._webgl2||this._supportsTextureLod}},textureFilterAnisotropic:{get:function(){return!!this._textureFilterAnisotropic}},s3tc:{get:function(){return this._s3tc}},pvrtc:{get:function(){return this._pvrtc}},astc:{get:function(){return this._astc}},etc:{get:function(){return this._etc}},etc1:{get:function(){return this._etc1}},bc7:{get:function(){return this._bc7}},supportsBasis:{get:function(){return this._s3tc||this._pvrtc||this._astc||this._etc||this._etc1||this._bc7}},vertexArrayObject:{get:function(){return this._vertexArrayObject||this._webgl2}},fragmentDepth:{get:function(){return this._fragDepth||this._webgl2}},instancedArrays:{get:function(){return this._instancedArrays||this._webgl2}},colorBufferFloat:{get:function(){return this._colorBufferFloat}},colorBufferHalfFloat:{get:function(){return this._webgl2&&this._colorBufferFloat||!this._webgl2&&this._colorBufferHalfFloat}},drawBuffers:{get:function(){return this._drawBuffers||this._webgl2}},debugShaders:{get:function(){return this._debugShaders}},throwOnWebGLError:{get:function(){return this._throwOnWebGLError},set:function(e){this._throwOnWebGLError=e,this._gl=function(e,t){if(!(0,d.A)(t))return e;function n(n){return function(){const i=n.apply(e,arguments);return t(e,n,arguments),i}}const i={};for(const o in e){const r=e[o];r instanceof Function?i[o]=n(r):Object.defineProperty(i,o,Ke(e,o,t))}return i}(this._originalGLContext,e?Xe:void 0)}},defaultTexture:{get:function(){return void 0===this._defaultTexture&&(this._defaultTexture=new G.A({context:this,source:{width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])},flipY:!1})),this._defaultTexture}},defaultEmissiveTexture:{get:function(){return void 0===this._defaultEmissiveTexture&&(this._defaultEmissiveTexture=new G.A({context:this,pixelFormat:R.A.RGB,source:{width:1,height:1,arrayBufferView:new Uint8Array([0,0,0])},flipY:!1})),this._defaultEmissiveTexture}},defaultNormalTexture:{get:function(){return void 0===this._defaultNormalTexture&&(this._defaultNormalTexture=new G.A({context:this,pixelFormat:R.A.RGB,source:{width:1,height:1,arrayBufferView:new Uint8Array([128,128,255])},flipY:!1})),this._defaultNormalTexture}},defaultCubeMap:{get:function(){if(void 0===this._defaultCubeMap){const e={width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])};this._defaultCubeMap=new B.A({context:this,source:{positiveX:e,negativeX:e,positiveY:e,negativeY:e,positiveZ:e,negativeZ:e},flipY:!1})}return this._defaultCubeMap}},drawingBufferHeight:{get:function(){return this._gl.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._gl.drawingBufferWidth}},defaultFramebuffer:{get:function(){return Je}}}),"undefined"!=typeof WebGLRenderingContext&&(et=[L.A.BACK]);const nt=new s.A;Qe.prototype.clear=function(e,t){e=e??nt,t=t??this._defaultPassState;const n=this._gl;let i=0;const o=e.color,r=e.depth,s=e.stencil;(0,d.A)(o)&&(u.A.equals(this._clearColor,o)||(u.A.clone(o,this._clearColor),n.clearColor(o.red,o.green,o.blue,o.alpha)),i|=n.COLOR_BUFFER_BIT),(0,d.A)(r)&&(r!==this._clearDepth&&(this._clearDepth=r,n.clearDepth(r)),i|=n.DEPTH_BUFFER_BIT),(0,d.A)(s)&&(s!==this._clearStencil&&(this._clearStencil=s,n.clearStencil(s)),i|=n.STENCIL_BUFFER_BIT),Ze(this,e.renderState??this._defaultRenderState,t,!0),tt(this,e.framebuffer??t.framebuffer),n.clear(i)},Qe.prototype.draw=function(e,t,n,i){l.A.defined("drawCommand",e),l.A.defined("drawCommand.shaderProgram",e._shaderProgram),t=t??this._defaultPassState;const o=e._framebuffer??t.framebuffer,r=e._renderState??this._defaultRenderState;n=n??e._shaderProgram,i=i??e._uniformMap,function(e,t,n,i,o){if((0,d.A)(t)&&o.depthTest&&o.depthTest.enabled&&!t.hasDepthAttachment)throw new A.A("The depth test can not be enabled (drawCommand.renderState.depthTest.enabled) because the framebuffer (drawCommand.framebuffer) does not have a depth or depth-stencil renderbuffer.");tt(e,t),Ze(e,o,n,!1),i._bind(),e._maxFrameTextureUnitIndex=Math.max(e._maxFrameTextureUnitIndex,i.maximumTextureUnitIndex)}(this,o,t,n,r),function(e,t,n,i){const o=t._primitiveType,r=t._vertexArray;let s=t._offset,a=t._count;const c=t.instanceCount;if(!p.A.validate(o))throw new A.A("drawCommand.primitiveType is required and must be valid.");if(l.A.defined("drawCommand.vertexArray",r),l.A.typeOf.number.greaterThanOrEquals("drawCommand.offset",s,0),(0,d.A)(a)&&l.A.typeOf.number.greaterThanOrEquals("drawCommand.count",a,0),l.A.typeOf.number.greaterThanOrEquals("drawCommand.instanceCount",c,0),c>0&&!e.instancedArrays)throw new A.A("Instanced arrays extension is not supported");e._us.model=t._modelMatrix??O.A.IDENTITY,n._setUniforms(i,e._us,e.validateShaderProgram),r._bind();const u=r.indexBuffer;(0,d.A)(u)?(s*=u.bytesPerIndex,a=(0,d.A)(a)?Math.min(a,u.numberOfIndices):u.numberOfIndices,0===c?e._gl.drawElements(o,a,u.indexDatatype,s):e.glDrawElementsInstanced(o,a,u.indexDatatype,s,c)):(a=(0,d.A)(a)?Math.min(a,r.numberOfVertices):r.numberOfVertices,0===c?e._gl.drawArrays(o,s,a):e.glDrawArraysInstanced(o,s,a,c)),r._unBind()}(this,e,n,i)},Qe.prototype.beginFrame=function(){},Qe.prototype.endFrame=function(){const e=this._gl;e.useProgram(null),this._currentFramebuffer=void 0,e.bindFramebuffer(e.FRAMEBUFFER,null);const t=et;this.drawBuffers&&this.glDrawBuffers(t);const n=this._maxFrameTextureUnitIndex;this._maxFrameTextureUnitIndex=0;for(let t=0;t<n;++t)e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null)},Qe.prototype.readPixels=function(e){const t=this._gl;e=e??S.A.EMPTY_OBJECT;const n=Math.max(e.x??0,0),i=Math.max(e.y??0,0),o=e.width??this.drawingBufferWidth,r=e.height??this.drawingBufferHeight,s=e.framebuffer;l.A.typeOf.number.greaterThan("readState.width",o,0),l.A.typeOf.number.greaterThan("readState.height",r,0);let a=U.A.UNSIGNED_BYTE;(0,d.A)(s)&&s.numberOfColorAttachments>0&&(a=s.getColorTexture(0).pixelDatatype);const c=R.A.createTypedArray(R.A.RGBA,a,o,r);return tt(this,s),t.readPixels(n,i,o,r,R.A.RGBA,U.A.toWebGLConstant(a,this),c),c};const it={position:0,textureCoordinates:1};function ot(e,t,n){this._pickObjects=e,this.key=t,this.color=n}Qe.prototype.getViewportQuadVertexArray=function(){let e=this.cache.viewportQuad_vertexArray;if(!(0,d.A)(e)){const t=new I.A({attributes:{position:new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:2,values:[-1,-1,1,-1,1,1,-1,1]}),textureCoordinates:new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:2,values:[0,0,1,0,1,1,0,1]})},indices:new Uint16Array([0,1,2,0,2,3]),primitiveType:p.A.TRIANGLES});e=je.A.fromGeometry({context:this,geometry:t,attributeLocations:it,bufferUsage:r.A.STATIC_DRAW,interleave:!0}),this.cache.viewportQuad_vertexArray=e}return e},Qe.prototype.createViewportQuadCommand=function(e,t){return t=t??S.A.EMPTY_OBJECT,new m.A({vertexArray:this.getViewportQuadVertexArray(),primitiveType:p.A.TRIANGLES,renderState:t.renderState,shaderProgram:y.A.fromCache({context:this,vertexShaderSource:f,fragmentShaderSource:e,attributeLocations:it}),uniformMap:t.uniformMap,owner:t.owner,framebuffer:t.framebuffer,pass:t.pass})},Qe.prototype.getObjectByPickColor=function(e){return l.A.defined("pickColor",e),this._pickObjects[e.toRgba()]},Object.defineProperties(ot.prototype,{object:{get:function(){return this._pickObjects[this.key]},set:function(e){this._pickObjects[this.key]=e}}}),ot.prototype.destroy=function(){delete this._pickObjects[this.key]},Qe.prototype.createPickId=function(e){l.A.defined("object",e),++this._nextPickColor[0];const t=this._nextPickColor[0];if(0===t)throw new M.A("Out of unique Pick IDs.");return this._pickObjects[t]=e,new ot(this._pickObjects,t,u.A.fromRgba(t))},Qe.prototype.isDestroyed=function(){return!1},Qe.prototype.destroy=function(){const e=this.cache;for(const t in e)if(e.hasOwnProperty(t)){const n=e[t];(0,d.A)(n.destroy)&&n.destroy()}return this._shaderCache=this._shaderCache.destroy(),this._textureCache=this._textureCache.destroy(),this._defaultTexture=this._defaultTexture&&this._defaultTexture.destroy(),this._defaultEmissiveTexture=this._defaultEmissiveTexture&&this._defaultEmissiveTexture.destroy(),this._defaultNormalTexture=this._defaultNormalTexture&&this._defaultNormalTexture.destroy(),this._defaultCubeMap=this._defaultCubeMap&&this._defaultCubeMap.destroy(),(0,h.A)(this)};const rt=Qe;var st=n(671495),at=n(804701),ct=n(418906),lt=n(915777),ut=n(760866),dt=n(557053),ht=n(100482),At=n(654799),pt=n(469635),ft=n(624512),mt=n(539846),gt=n(693299),_t=n(376758);function yt(e){this._autoDestroy=e?.autoDestroy??!0,this._canvas=document.createElement("canvas"),this._context=new rt(this._canvas,(0,_t.A)(e?.contextOptions)),this._canvases=[]}yt.prototype.createSceneContext=function(e){const t=e.getContext("2d",{alpha:!0});if(!t)throw new A.A("canvas used with SharedContext must provide a 2d context");if(this._canvases.includes(e))throw new A.A("canvas is already associated with a scene");const n=this;n._canvases.push(e);let i=!1;const o=function(){i=!0;const t=n._canvases.indexOf(e);-1!==t&&(n._canvases.splice(t,1),n._autoDestroy&&0===n._canvases.length&&n.destroy())},r=function(){const e=n._context.canvas,t=this.drawingBufferWidth;e.width<t&&(e.width=t);const i=this.drawingBufferHeight;e.height<i&&(e.height=i)},s=function(){const e=this.drawingBufferWidth,i=this.drawingBufferHeight,o=n._context.canvas.height-i;t.drawImage(n._context.canvas,0,o,e,i,0,0,e,i),n._context.endFrame()};return new Proxy(this._context,{get(t,n,a){if("isDestroyed"===n)return function(){return i};if(i)throw new A.A("This object was destroyed, i.e., destroy() was called.");switch(n){case"_canvas":return e;case"destroy":return o;case"drawingBufferWidth":return e.width;case"drawingBufferHeight":return e.height;case"beginFrame":return r;case"endFrame":return s;default:return Reflect.get(t,n,a)}}})},yt.prototype.destroy=function(){this._context.destroy(),(0,h.A)(this)},yt.prototype.isDestroyed=function(){return!1};const vt=yt;var Tt=n(957233),bt=n(78078);function wt(e){e=e??S.A.EMPTY_OBJECT,l.A.defined("options.context",e.context);const{context:t,source:n,pixelFormat:i=R.A.RGBA,pixelDatatype:o=U.A.UNSIGNED_BYTE,flipY:r=!0,skipColorSpaceConversion:s=!1,sampler:a=new At.A}=e;if(!t.webgl2)throw new A.A("WebGL1 does not support texture3D. Please use a WebGL2 context.");let{width:c,height:u,depth:h}=e;(0,d.A)(n)&&((0,d.A)(c)||(c=n.width),(0,d.A)(u)||(u=n.height),(0,d.A)(h)||(h=n.depth));const p=e.preMultiplyAlpha||i===R.A.RGB||i===R.A.LUMINANCE,f=R.A.toInternalFormat(i,o,t),m=R.A.isCompressedFormat(f);if(!(0,d.A)(c)||!(0,d.A)(u)||!(0,d.A)(h))throw new A.A("options requires a source field to create an initialized texture3D or width, height and depth fields to create a blank texture3D.");if(l.A.typeOf.number.greaterThan("width",c,0),c>N.A.maximumTextureSize)throw new A.A(`Width must be less than or equal to the maximum texture3D size (${N.A.maximumTextureSize}).  Check maximumTextureSize.`);if(l.A.typeOf.number.greaterThan("height",u,0),u>N.A.maximumTextureSize)throw new A.A(`Height must be less than or equal to the maximum texture3D size (${N.A.maximumTextureSize}).  Check maximumTextureSize.`);if(l.A.typeOf.number.greaterThan("depth",h,0),h>N.A.maximumTextureSize)throw new A.A(`Depth must be less than or equal to the maximum texture3D size (${N.A.maximumTextureSize}).  Check maximumTextureSize.`);if(!R.A.validate(i))throw new A.A("Invalid options.pixelFormat.");if(!m&&!U.A.validate(o))throw new A.A("Invalid options.pixelDatatype.");if(i===R.A.DEPTH_COMPONENT&&o!==U.A.UNSIGNED_SHORT&&o!==U.A.UNSIGNED_INT)throw new A.A("When options.pixelFormat is DEPTH_COMPONENT, options.pixelDatatype must be UNSIGNED_SHORT or UNSIGNED_INT.");if(i===R.A.DEPTH_STENCIL&&o!==U.A.UNSIGNED_INT_24_8)throw new A.A("When options.pixelFormat is DEPTH_STENCIL, options.pixelDatatype must be UNSIGNED_INT_24_8.");if(o===U.A.FLOAT&&!t.floatingPointTexture)throw new A.A("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.  Check context.floatingPointTexture.");if(o===U.A.HALF_FLOAT&&!t.halfFloatingPointTexture)throw new A.A("When options.pixelDatatype is HALF_FLOAT, this WebGL implementation must support the OES_texture_half_float extension. Check context.halfFloatingPointTexture.");if(R.A.isDepthFormat(i)){if((0,d.A)(n))throw new A.A("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, source cannot be provided.");if(!t.depthTexture)throw new A.A("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, this WebGL implementation must support WEBGL_depth_texture.  Check context.depthTexture.")}if(m)throw new A.A("Texture3D does not currently support compressed formats.");const g=t._gl,_=R.A.texture3DSizeInBytes(i,o,c,u,h);if(this._id=e.id??(0,E.A)(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=g.TEXTURE_3D,this._texture=g.createTexture(),this._internalFormat=f,this._pixelFormat=i,this._pixelDatatype=o,this._width=c,this._height=u,this._depth=h,this._dimensions=new j.A(c,u,h),this._hasMipmap=!1,this._sizeInBytes=_,this._preMultiplyAlpha=p,this._flipY=r,this._initialized=!1,this._sampler=void 0,this._sampler=a,Ct(this,a),g.activeTexture(g.TEXTURE0),g.bindTexture(this._textureTarget,this._texture),(0,d.A)(n)){if(s?g.pixelStorei(g.UNPACK_COLORSPACE_CONVERSION_WEBGL,g.NONE):g.pixelStorei(g.UNPACK_COLORSPACE_CONVERSION_WEBGL,g.BROWSER_DEFAULT_WEBGL),!(0,d.A)(n.arrayBufferView))throw new A.A("For Texture3D, options.source.arrayBufferView must be defined");!function(e,t){const n=e._context,i=n._gl,o=e._textureTarget,r=e._internalFormat,{width:s,height:a,depth:c,pixelFormat:l,pixelDatatype:u,flipY:d}=e,h=R.A.alignmentInBytes(l,u,s);i.pixelStorei(i.UNPACK_ALIGNMENT,h),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1);const{arrayBufferView:A}=t;d&&console.warn("texture3D.flipY is not supported.");let p=1;if(t.mipLevels&&t.mipLevels.length&&(p=t.mipLevels.length+1),i.texStorage3D(o,p,r,s,a,c),i.texSubImage3D(o,0,0,0,0,s,a,c,l,U.A.toWebGLConstant(u,n),A),p>1){let e=s,r=a,d=c;for(let s=0;s<t.mipLevels.length;++s)e=xt(e),r=xt(r),d=xt(d),i.texSubImage3D(o,s+1,0,0,0,e,r,d,l,U.A.toWebGLConstant(u,n),t.mipLevels[s])}}(this,n),this._initialized=!0}else!function(e){const t=e._context;t._gl.texImage3D(e._textureTarget,0,e._internalFormat,e._width,e._height,e._depth,0,e._pixelFormat,U.A.toWebGLConstant(e._pixelDatatype,t),null)}(this);g.bindTexture(this._textureTarget,null)}function xt(e){const t=0|Math.floor(e/2);return Math.max(t,1)}function Ct(e,t){let{minificationFilter:n,magnificationFilter:i}=t;const o=[bt.A.NEAREST_MIPMAP_NEAREST,bt.A.NEAREST_MIPMAP_LINEAR,bt.A.LINEAR_MIPMAP_NEAREST,bt.A.LINEAR_MIPMAP_LINEAR].includes(n),r=e._context,s=e._pixelFormat,a=e._pixelDatatype;(a===U.A.FLOAT&&!r.textureFloatLinear||a===U.A.HALF_FLOAT&&!r.textureHalfFloatLinear)&&(n=o?bt.A.NEAREST_MIPMAP_NEAREST:bt.A.NEAREST,i=Tt.A.NEAREST),R.A.isDepthFormat(s)&&(n=bt.A.NEAREST,i=Tt.A.NEAREST);const c=r._gl,l=e._textureTarget;c.activeTexture(c.TEXTURE0),c.bindTexture(l,e._texture),c.texParameteri(l,c.TEXTURE_MIN_FILTER,n),c.texParameteri(l,c.TEXTURE_MAG_FILTER,i),c.texParameteri(l,c.TEXTURE_WRAP_R,t.wrapR),c.texParameteri(l,c.TEXTURE_WRAP_S,t.wrapS),c.texParameteri(l,c.TEXTURE_WRAP_T,t.wrapT),(0,d.A)(e._textureFilterAnisotropic)&&c.texParameteri(l,e._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.maximumAnisotropy),c.bindTexture(l,null)}wt.create=function(e){return new wt(e)},Object.defineProperties(wt.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){Ct(this,e),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},depth:{get:function(){return this._depth}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(8*this._sizeInBytes/7):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}}),wt.prototype.generateMipmap=function(e){if(e=e??ct.A.DONT_CARE,R.A.isDepthFormat(this._pixelFormat))throw new A.A("Cannot call generateMipmap when the texture3D pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(R.A.isCompressedFormat(this._pixelFormat))throw new A.A("Cannot call generateMipmap with a compressed pixel format.");if(!ct.A.validate(e))throw new A.A("hint is invalid.");this._hasMipmap=!0;const t=this._context._gl,n=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(n,this._texture),t.generateMipmap(n),t.bindTexture(n,null)},wt.prototype.isDestroyed=function(){return!1},wt.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),(0,h.A)(this)};const Et=wt;var St=n(66589),It=n(557448),Pt=n(193470),Dt=n(764011),Ot=n(757146),Rt=n(790868),Mt=n(240863),Lt=n(744603);const Nt=function(e,t,n){if(l.A.defined("context",e),l.A.defined("urls",t),Object.values(B.A.FaceName).some(e=>!(0,d.A)(t[e])))throw new A.A("urls must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");const i={flipY:!0,skipColorSpaceConversion:n,preferImageBitmap:!0},o=[Lt.A.createIfNeeded(t.positiveX).fetchImage(i),Lt.A.createIfNeeded(t.negativeX).fetchImage(i),Lt.A.createIfNeeded(t.positiveY).fetchImage(i),Lt.A.createIfNeeded(t.negativeY).fetchImage(i),Lt.A.createIfNeeded(t.positiveZ).fetchImage(i),Lt.A.createIfNeeded(t.negativeZ).fetchImage(i)];return Promise.all(o).then(function(t){return new B.A({context:e,source:{positiveX:t[0],negativeX:t[1],positiveY:t[2],negativeY:t[3],positiveZ:t[4],negativeZ:t[5]}})})};var Bt=n(470540),Ft=n(288787),Ut=n(853331),kt=n(290176),Vt=n(63316),zt=n(337632),Ht=n(742558);const Gt=Object.freeze({DONE:0,PENDING:1,FAILED:2});var Wt=n(46257),Yt=n(913419);const qt=u.A.WHITE,jt=j.A.ZERO,Qt=Vt.Ay.NONE,Xt=q.A.ZERO,Kt=j.A.ZERO,$t=zt.A.CENTER,Jt=Ht.A.CENTER,Zt=Yt.A.NONE,en=new j.A,tn=new u.A,nn=new j.A,on=new q.A,rn=new kt.A,sn=new kt.A,an=new kt.A,cn=new c.A,ln=new Ut.A;function un(e){this.entity=e,this.billboard=void 0,this.textureValue=void 0}function dn(e,t){if(!(0,d.A)(e))throw new A.A("entityCluster is required.");if(!(0,d.A)(t))throw new A.A("entityCollection is required.");t.collectionChanged.addEventListener(dn.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new Ft.A,this._onCollectionChanged(t,t.values,[],[])}function hn(e,t,n){(0,d.A)(e)&&(e.billboard=void 0,n.removeBillboard(t))}dn.prototype.update=function(e){if(!(0,d.A)(e))throw new A.A("time is required.");const t=this._items.values,n=this._cluster;for(let i=0,o=t.length;i<o;i++){const o=t[i],r=o.entity,s=r._billboard;let a,c,l=o.billboard,u=r.isShowing&&r.isAvailable(e)&&Wt.A.getValueOrDefault(s._show,e,!0);if(u&&(c=Wt.A.getValueOrUndefined(r._position,e,en),a=Wt.A.getValueOrUndefined(s._image,e),u=(0,d.A)(c)&&(0,d.A)(a)),!u){hn(o,r,n);continue}Wt.A.isConstant(r._position)||(n._clusterDirty=!0),(0,d.A)(l)||(l=n.getBillboard(r),l.id=r,o.billboard=l,o.textureValue=void 0),l.show=u,o.textureValue!==a&&(l.image=a,o.textureValue=a),l.position=c,l.color=Wt.A.getValueOrDefault(s._color,e,qt,tn),l.eyeOffset=Wt.A.getValueOrDefault(s._eyeOffset,e,jt,nn),l.heightReference=Wt.A.getValueOrDefault(s._heightReference,e,Qt),l.pixelOffset=Wt.A.getValueOrDefault(s._pixelOffset,e,Xt,on),l.scale=Wt.A.getValueOrDefault(s._scale,e,1),l.rotation=Wt.A.getValueOrDefault(s._rotation,e,0),l.alignedAxis=Wt.A.getValueOrDefault(s._alignedAxis,e,Kt),l.horizontalOrigin=Wt.A.getValueOrDefault(s._horizontalOrigin,e,$t),l.verticalOrigin=Wt.A.getValueOrDefault(s._verticalOrigin,e,Jt),l.width=Wt.A.getValueOrUndefined(s._width,e),l.height=Wt.A.getValueOrUndefined(s._height,e),l.scaleByDistance=Wt.A.getValueOrUndefined(s._scaleByDistance,e,rn),l.translucencyByDistance=Wt.A.getValueOrUndefined(s._translucencyByDistance,e,sn),l.pixelOffsetScaleByDistance=Wt.A.getValueOrUndefined(s._pixelOffsetScaleByDistance,e,an),l.sizeInMeters=Wt.A.getValueOrDefault(s._sizeInMeters,e,!1),l.distanceDisplayCondition=Wt.A.getValueOrUndefined(s._distanceDisplayCondition,e,ln),l.disableDepthTestDistance=Wt.A.getValueOrUndefined(s._disableDepthTestDistance,e),l.splitDirection=Wt.A.getValueOrDefault(s._splitDirection,e,Zt);const h=Wt.A.getValueOrUndefined(s._imageSubRegion,e,cn);(0,d.A)(h)&&l.setImageSubRegion(l.image,h)}return!0},dn.prototype.getBoundingSphere=function(e,t){if(!(0,d.A)(e))throw new A.A("entity is required.");if(!(0,d.A)(t))throw new A.A("result is required.");const n=this._items.get(e.id);if(!(0,d.A)(n)||!(0,d.A)(n.billboard))return Gt.FAILED;const i=n.billboard;if(i.heightReference===Vt.Ay.NONE)t.center=j.A.clone(i.position,t.center);else{if(!(0,d.A)(i._clampedPosition))return Gt.PENDING;t.center=j.A.clone(i._clampedPosition,t.center)}return t.radius=0,Gt.DONE},dn.prototype.isDestroyed=function(){return!1},dn.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(dn.prototype._onCollectionChanged,this);const e=this._entityCollection.values;for(let t=0;t<e.length;t++)this._cluster.removeBillboard(e[t]);return(0,h.A)(this)},dn.prototype._onCollectionChanged=function(e,t,n,i){let o,r;const s=this._items,a=this._cluster;for(o=t.length-1;o>-1;o--)r=t[o],(0,d.A)(r._billboard)&&(0,d.A)(r._position)&&s.set(r.id,new un(r));for(o=i.length-1;o>-1;o--)r=i[o],(0,d.A)(r._billboard)&&(0,d.A)(r._position)?s.contains(r.id)||s.set(r.id,new un(r)):(hn(s.get(r.id),r,a),s.remove(r.id));for(o=n.length-1;o>-1;o--)r=n[o],hn(s.get(r.id),r,a),s.remove(r.id)};const An=dn;var pn=n(554630),fn=n(854894),mn=n(433235);function gn(e,t){if(e=e??0,(t=t??Number.MAX_VALUE)<=e)throw new A.A("far distance must be greater than near distance.");this.value=new Float32Array([e,t])}Object.defineProperties(gn.prototype,{componentDatatype:{get:function(){return C.A.FLOAT}},componentsPerAttribute:{get:function(){return 2}},normalize:{get:function(){return!1}}}),gn.fromDistanceDisplayCondition=function(e){if(!(0,d.A)(e))throw new A.A("distanceDisplayCondition is required.");if(e.far<=e.near)throw new A.A("distanceDisplayCondition.far distance must be greater than distanceDisplayCondition.near distance.");return new gn(e.near,e.far)},gn.toValue=function(e,t){if(!(0,d.A)(e))throw new A.A("distanceDisplayCondition is required.");return(0,d.A)(t)?(t[0]=e.near,t[1]=e.far,t):new Float32Array([e.near,e.far])};const _n=gn;var yn=n(75200),vn=n(794554),Tn=n(32655),bn=n(852575),wn=n(708857),xn=n(551549),Cn=n(612123),En=n(312421),Sn=n(660662),In=n(623e3),Pn=n(842153),Dn=n(608191);function On(){A.A.throwInstantiationError()}Object.defineProperties(On.prototype,{isConstant:{get:A.A.throwInstantiationError},definitionChanged:{get:A.A.throwInstantiationError}}),On.prototype.getType=A.A.throwInstantiationError,On.prototype.getValue=A.A.throwInstantiationError,On.prototype.equals=A.A.throwInstantiationError;const Rn=new te.A;On.getValue=function(e,t,n){let i;return(0,d.A)(e)||(e=te.A.now(Rn)),(0,d.A)(t)&&(i=t.getType(e),(0,d.A)(i))?((0,d.A)(n)&&n.type===i||(n=Dn.A.fromType(i)),t.getValue(e,n.uniforms),n):((0,d.A)(n)&&n.type===Dn.A.ColorType||(n=Dn.A.fromType(Dn.A.ColorType)),u.A.clone(u.A.WHITE,n.uniforms.color),n)};const Mn=On;function Ln(e,t,n){l.A.defined("geometryUpdater",e),l.A.defined("primitives",t),l.A.defined("orderedGroundPrimitives",n),this._primitives=t,this._orderedGroundPrimitives=n,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=e,this._options=e._options,this._entity=e._entity,this._material=void 0}Ln.prototype._isHidden=function(e,t,n){return!e.isShowing||!e.isAvailable(n)||!Wt.A.getValueOrDefault(t.show,n,!0)},Ln.prototype._setOptions=A.A.throwInstantiationError,Ln.prototype.update=function(e){l.A.defined("time",e);const t=this._geometryUpdater,n=t._onTerrain,i=this._primitives,o=this._orderedGroundPrimitives;n?o.remove(this._primitive):(i.removeAndDestroy(this._primitive),i.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;const r=this._entity,s=r[this._geometryUpdater._geometryPropertyName];if(this._setOptions(r,s,e),this._isHidden(r,s,e))return;const a=this._geometryUpdater.shadowsProperty.getValue(e),c=this._options;if(!(0,d.A)(s.fill)||s.fill.getValue(e)){const r=t.fillMaterialProperty,s=r instanceof En.A;let l;const u=t._getIsClosed(c);if(s)l=new Cn.A({closed:u,flat:n&&!t._supportsMaterialsforEntitiesOnTerrain});else{const t=Mn.getValue(e,r,this._material);this._material=t,l=new xn.A({material:t,translucent:t.isTranslucent(),closed:u})}if(n)c.vertexFormat=Cn.A.VERTEX_FORMAT,this._primitive=o.add(new In.A({geometryInstances:this._geometryUpdater.createFillGeometryInstance(e),appearance:l,asynchronous:!1,shadows:a,classificationType:this._geometryUpdater.classificationTypeProperty.getValue(e)}),Wt.A.getValueOrUndefined(this._geometryUpdater.zIndex,e));else{c.vertexFormat=l.vertexFormat;const t=this._geometryUpdater.createFillGeometryInstance(e);s&&(l.translucent=255!==t.attributes.color.value[3]),this._primitive=i.add(new Pn.A({geometryInstances:t,appearance:l,asynchronous:!1,shadows:a}))}}if(!n&&(0,d.A)(s.outline)&&s.outline.getValue(e)){const n=this._geometryUpdater.createOutlineGeometryInstance(e),o=Wt.A.getValueOrDefault(s.outlineWidth,e,1);this._outlinePrimitive=i.add(new Pn.A({geometryInstances:n,appearance:new Cn.A({flat:!0,translucent:255!==n.attributes.color.value[3],renderState:{lineWidth:t._scene.clampLineWidth(o)}}),asynchronous:!1,shadows:a}))}},Ln.prototype.getBoundingSphere=function(e){if(!(0,d.A)(e))throw new A.A("result is required.");const t=this._entity,n=this._primitive,i=this._outlinePrimitive;let o;return(0,d.A)(n)&&n.show&&n.ready&&(o=n.getGeometryInstanceAttributes(t),(0,d.A)(o)&&(0,d.A)(o.boundingSphere))||(0,d.A)(i)&&i.show&&i.ready&&(o=i.getGeometryInstanceAttributes(t),(0,d.A)(o)&&(0,d.A)(o.boundingSphere))?(Sn.A.clone(o.boundingSphere,e),Gt.DONE):(0,d.A)(n)&&!n.ready||(0,d.A)(i)&&!i.ready?Gt.PENDING:Gt.FAILED},Ln.prototype.isDestroyed=function(){return!1},Ln.prototype.destroy=function(){const e=this._primitives,t=this._orderedGroundPrimitives;this._geometryUpdater._onTerrain?t.remove(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),(0,h.A)(this)};const Nn=Ln;var Bn=n(955943),Fn=n(983884),Un=n(71578),kn=n(988609),Vn=n(969077),zn=n(426807);const Hn=new En.A(u.A.WHITE),Gn=new Vn.A(!0),Wn=new Vn.A(!0),Yn=new Vn.A(!1),qn=new Vn.A(u.A.BLACK),jn=new Vn.A(kn.A.DISABLED),Qn=new Vn.A(new Ut.A),Xn=new Vn.A(Un.A.BOTH);function Kn(e){l.A.defined("options.entity",e.entity),l.A.defined("options.scene",e.scene),l.A.defined("options.geometryOptions",e.geometryOptions),l.A.defined("options.geometryPropertyName",e.geometryPropertyName),l.A.defined("options.observedPropertyNames",e.observedPropertyNames);const t=e.entity,n=e.geometryPropertyName;this._entity=t,this._scene=e.scene,this._fillEnabled=!1,this._isClosed=!1,this._onTerrain=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new Bn.A,this._showProperty=void 0,this._materialProperty=void 0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._options=e.geometryOptions,this._geometryPropertyName=n,this._id=`${n}-${t.id}`,this._observedPropertyNames=e.observedPropertyNames,this._supportsMaterialsforEntitiesOnTerrain=zn.A.supportsMaterialsforEntitiesOnTerrain(e.scene)}Object.defineProperties(Kn.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!(0,d.A)(this._entity.availability)&&Wt.A.isConstant(this._showProperty)&&Wt.A.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!(0,d.A)(this._entity.availability)&&Wt.A.isConstant(this._showProperty)&&Wt.A.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),Kn.prototype.isOutlineVisible=function(e){const t=this._entity;return(this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e))??!1},Kn.prototype.isFilled=function(e){const t=this._entity;return(this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e))??!1},Kn.prototype.createFillGeometryInstance=A.A.throwInstantiationError,Kn.prototype.createOutlineGeometryInstance=A.A.throwInstantiationError,Kn.prototype.isDestroyed=function(){return!1},Kn.prototype.destroy=function(){(0,h.A)(this)},Kn.prototype._isHidden=function(e,t){const n=t.show;return(0,d.A)(n)&&n.isConstant&&!n.getValue(Tn.A.MINIMUM_VALUE)},Kn.prototype._isOnTerrain=function(e,t){return!1},Kn.prototype._getIsClosed=function(e){return!0},Kn.prototype._isDynamic=A.A.throwInstantiationError,Kn.prototype._setStaticOptions=A.A.throwInstantiationError,Kn.prototype._onEntityPropertyChanged=function(e,t,n,i){if(-1===this._observedPropertyNames.indexOf(t))return;const o=this._entity[this._geometryPropertyName];if(!(0,d.A)(o))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));const r=o.fill,s=!(0,d.A)(r)||!r.isConstant||r.getValue(Tn.A.MINIMUM_VALUE),a=o.outline;let c=(0,d.A)(a);if(c&&a.isConstant&&(c=a.getValue(Tn.A.MINIMUM_VALUE)),!s&&!c)return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));const l=o.show;if(this._isHidden(e,o))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));this._materialProperty=o.material??Hn,this._fillProperty=r??Wn,this._showProperty=l??Gn,this._showOutlineProperty=o.outline??Yn,this._outlineColorProperty=c?o.outlineColor??qn:void 0,this._shadowsProperty=o.shadows??jn,this._distanceDisplayConditionProperty=o.distanceDisplayCondition??Qn,this._classificationTypeProperty=o.classificationType??Xn,this._fillEnabled=s;const u=this._isOnTerrain(e,o)&&(this._supportsMaterialsforEntitiesOnTerrain||this._materialProperty instanceof En.A);if(c&&u&&((0,Fn.A)(Fn.A.geometryOutlines),c=!1),this._onTerrain=u,this._outlineEnabled=c,this._isDynamic(e,o))this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this));else{this._setStaticOptions(e,o),this._isClosed=this._getIsClosed(this._options);const t=o.outlineWidth;this._outlineWidth=(0,d.A)(t)?t.getValue(Tn.A.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}},Kn.prototype.createDynamicUpdater=function(e,t){if(l.A.defined("primitives",e),l.A.defined("groundPrimitives",t),!this._dynamic)throw new A.A("This instance does not represent dynamic geometry.");return new this.constructor.DynamicGeometryUpdater(this,e,t)};const $n=Kn;var Jn=n(10082);const Zn=new j.A;function ei(e,t,n,i){l.A.defined("scene",e),l.A.defined("positionProperty",t),this._scene=e,this._heightReference=n,this._extrudedHeightReference=i,this._positionProperty=t,this._position=new j.A,this._cartographicPosition=new X.A,this._normal=new j.A,this._definitionChanged=new Bn.A,this._terrainHeight=0,this._removeCallbackFunc=void 0,this._removeEventListener=void 0,this._removeModeListener=void 0;const o=this;if((0,d.A)(e.globe)&&(this._removeEventListener=e.terrainProviderChanged.addEventListener(function(){o._updateClamping()}),this._removeModeListener=e.morphComplete.addEventListener(function(){o._updateClamping()})),t.isConstant){const n=t.getValue(Tn.A.MINIMUM_VALUE,Zn);if(!(0,d.A)(n)||j.A.equals(n,j.A.ZERO)||!(0,d.A)(e.globe))return;this._position=j.A.clone(n,this._position),this._updateClamping(),this._normal=e.ellipsoid.geodeticSurfaceNormal(n,this._normal)}}Object.defineProperties(ei.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}}}),ei.prototype._updateClamping=function(){(0,d.A)(this._removeCallbackFunc)&&this._removeCallbackFunc();const e=this._scene,t=this._position;if(j.A.equals(t,j.A.ZERO))return void(this._terrainHeight=0);const n=e.ellipsoid.cartesianToCartographic(t,this._cartographicPosition),i=e.getHeight(n,this._heightReference);(0,d.A)(i)?this._terrainHeight=i:this._terrainHeight=0,this._removeCallbackFunc=e.updateHeight(n,e=>{this._terrainHeight=e.height,this.definitionChanged.raiseEvent()},this._heightReference)};const ti=new te.A;ei.prototype.getValue=function(e,t){(0,d.A)(e)||(e=te.A.now(ti));const n=Wt.A.getValueOrDefault(this._heightReference,e,Vt.Ay.NONE),i=Wt.A.getValueOrDefault(this._extrudedHeightReference,e,Vt.Ay.NONE);if(n===Vt.Ay.NONE&&!(0,Vt.Lq)(i))return this._position=j.A.clone(j.A.ZERO,this._position),j.A.clone(j.A.ZERO,t);if(this._positionProperty.isConstant)return j.A.multiplyByScalar(this._normal,this._terrainHeight,t);const o=this._scene,r=this._positionProperty.getValue(e,Zn);if(!(0,d.A)(r)||j.A.equals(r,j.A.ZERO)||!(0,d.A)(o.globe))return j.A.clone(j.A.ZERO,t);if(j.A.equalsEpsilon(this._position,r,J.A.EPSILON10))return j.A.multiplyByScalar(this._normal,this._terrainHeight,t);this._position=j.A.clone(r,this._position),this._updateClamping();const s=o.ellipsoid.geodeticSurfaceNormal(r,this._normal);return j.A.multiplyByScalar(s,this._terrainHeight,t)},ei.prototype.isDestroyed=function(){return!1},ei.prototype.destroy=function(){return(0,d.A)(this._removeEventListener)&&this._removeEventListener(),(0,d.A)(this._removeModeListener)&&this._removeModeListener(),(0,d.A)(this._removeCallbackFunc)&&this._removeCallbackFunc(),(0,h.A)(this)};const ni=ei,ii=function(e,t,n,i){if($n.prototype._onEntityPropertyChanged.call(this,e,t,n,i),-1===this._observedPropertyNames.indexOf(t))return;const o=this._entity[this._geometryPropertyName];if(!(0,d.A)(o))return;(0,d.A)(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);const r=o.heightReference;if((0,d.A)(r)){const e=new Jn.A(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new ni(this._scene,e,r)}},oi=j.A.ZERO,ri=new j.A,si=new j.A,ai=new u.A;function ci(e){this.id=e,this.vertexFormat=void 0,this.dimensions=void 0,this.offsetAttribute=void 0}function li(e,t){$n.call(this,{entity:e,scene:t,geometryOptions:new ci(e),geometryPropertyName:"box",observedPropertyNames:["availability","position","orientation","box"]}),this._onEntityPropertyChanged(e,"box",e.box,void 0)}function ui(e,t,n){Nn.call(this,e,t,n)}(0,d.A)(Object.create)&&(li.prototype=Object.create($n.prototype),li.prototype.constructor=li),Object.defineProperties(li.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),li.prototype.createFillGeometryInstance=function(e){if(l.A.defined("time",e),!this._fillEnabled)throw new A.A("This instance does not represent a filled geometry.");const t=this._entity,n=t.isAvailable(e),i=new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),r={show:i,distanceDisplayCondition:_n.fromDistanceDisplayCondition(o),color:void 0,offset:void 0};if(this._materialProperty instanceof En.A){let t;(0,d.A)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,ai)),(0,d.A)(t)||(t=u.A.WHITE),r.color=mn.A.fromColor(t)}return(0,d.A)(this._options.offsetAttribute)&&(r.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,oi,ri))),new yn.A({id:t,geometry:pn.A.fromDimensions(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.box.heightReference,.5*this._options.dimensions.z,this._scene.ellipsoid),attributes:r})},li.prototype.createOutlineGeometryInstance=function(e){if(l.A.defined("time",e),!this._outlineEnabled)throw new A.A("This instance does not represent an outlined geometry.");const t=this._entity,n=t.isAvailable(e),i=Wt.A.getValueOrDefault(this._outlineColorProperty,e,u.A.BLACK,ai),o=this._distanceDisplayConditionProperty.getValue(e),r={show:new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:mn.A.fromColor(i),distanceDisplayCondition:_n.fromDistanceDisplayCondition(o),offset:void 0};return(0,d.A)(this._options.offsetAttribute)&&(r.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,oi,ri))),new yn.A({id:t,geometry:fn.A.fromDimensions(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.box.heightReference,.5*this._options.dimensions.z,this._scene.ellipsoid),attributes:r})},li.prototype._computeCenter=function(e,t){return Wt.A.getValueOrUndefined(this._entity.position,e,t)},li.prototype._isHidden=function(e,t){return!(0,d.A)(t.dimensions)||!(0,d.A)(e.position)||$n.prototype._isHidden.call(this,e,t)},li.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&Wt.A.isConstant(e.orientation)&&t.dimensions.isConstant&&Wt.A.isConstant(t.outlineWidth))},li.prototype._setStaticOptions=function(e,t){const n=Wt.A.getValueOrDefault(t.heightReference,Tn.A.MINIMUM_VALUE,Vt.Ay.NONE),i=this._options;i.vertexFormat=this._materialProperty instanceof En.A?Cn.A.VERTEX_FORMAT:xn.A.MaterialSupport.TEXTURED.vertexFormat,i.dimensions=t.dimensions.getValue(Tn.A.MINIMUM_VALUE,i.dimensions),i.offsetAttribute=n!==Vt.Ay.NONE?vn.A.ALL:void 0},li.prototype._onEntityPropertyChanged=ii,li.DynamicGeometryUpdater=ui,(0,d.A)(Object.create)&&(ui.prototype=Object.create(Nn.prototype),ui.prototype.constructor=ui),ui.prototype._isHidden=function(e,t,n){const i=Wt.A.getValueOrUndefined(e.position,n,si),o=this._options.dimensions;return!(0,d.A)(i)||!(0,d.A)(o)||Nn.prototype._isHidden.call(this,e,t,n)},ui.prototype._setOptions=function(e,t,n){const i=Wt.A.getValueOrDefault(t.heightReference,n,Vt.Ay.NONE),o=this._options;o.dimensions=Wt.A.getValueOrUndefined(t.dimensions,n,o.dimensions),o.offsetAttribute=i!==Vt.Ay.NONE?vn.A.ALL:void 0};const di=li;var hi=n(326230),Ai=n(886033),pi=n(759078);function fi(e,t,n){this._callback=void 0,this._isConstant=void 0,this._referenceFrame=n??Ai.A.FIXED,this._definitionChanged=new Bn.A,this.setCallback(e,t)}Object.defineProperties(fi.prototype,{isConstant:{get:function(){return this._isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});const mi=new te.A;fi.prototype.getValue=function(e,t){return(0,d.A)(e)||(e=te.A.now(mi)),this.getValueInReferenceFrame(e,Ai.A.FIXED,t)},fi.prototype.setCallback=function(e,t){if(!(0,d.A)(e))throw new A.A("callback is required.");if(!(0,d.A)(t))throw new A.A("isConstant is required.");const n=this._callback!==e||this._isConstant!==t;this._callback=e,this._isConstant=t,n&&this._definitionChanged.raiseEvent(this)},fi.prototype.getValueInReferenceFrame=function(e,t,n){if(!(0,d.A)(e))throw new A.A("time is required.");if(!(0,d.A)(t))throw new A.A("referenceFrame is required.");const i=this._callback(e,n);return pi.A.convertToReferenceFrame(e,i,this._referenceFrame,t,n)},fi.prototype.equals=function(e){return this===e||e instanceof fi&&this._callback===e._callback&&this._isConstant===e._isConstant&&this._referenceFrame===e._referenceFrame};const gi=fi;var _i=n(692632),yi=n(855927);const vi=new O.A;function Ti(e,t){if(!(0,d.A)(e))throw new A.A("scene is required.");if(!(0,d.A)(t))throw new A.A("entityCollection is required.");t.collectionChanged.addEventListener(Ti.prototype._onCollectionChanged,this),this._scene=e,this._primitives=e.primitives,this._entityCollection=t,this._tilesetHash={},this._entitiesToVisualize=new Ft.A,this._onCollectionChanged(t,t.values,[],[])}function bi(e,t,n,i){const o=n[t.id];(0,d.A)(o)&&((0,d.A)(o.tilesetPrimitive)&&i.removeAndDestroy(o.tilesetPrimitive),delete n[t.id])}async function wi(e,t,n,i){t[n.id]={url:e.url,loadFail:!1};try{const o=await yi.A.fromUrl(e);if(o.id=n,i.add(o),!(0,d.A)(t[n.id]))return;t[n.id].tilesetPrimitive=o}catch(e){console.error(e),t[n.id].loadFail=!0}}Ti.prototype.update=function(e){if(!(0,d.A)(e))throw new A.A("time is required.");const t=this._entitiesToVisualize.values,n=this._tilesetHash,i=this._primitives;for(let o=0,r=t.length;o<r;o++){const r=t[o],s=r._tileset;let a;const c=n[r.id],l=r.isShowing&&r.isAvailable(e)&&Wt.A.getValueOrDefault(s._show,e,!0);let u;l&&(u=r.computeModelMatrix(e,vi),a=Lt.A.createIfNeeded(Wt.A.getValueOrUndefined(s._uri,e)));const h=(0,d.A)(c)?c.tilesetPrimitive:void 0;l?((0,d.A)(c)&&a.url===c.url||((0,d.A)(h)&&i.removeAndDestroy(h),delete n[r.id],wi(a,n,r,i)),(0,d.A)(h)&&(h.show=!0,(0,d.A)(u)&&(h.modelMatrix=u),h.maximumScreenSpaceError=Wt.A.getValueOrDefault(s.maximumScreenSpaceError,e,h.maximumScreenSpaceError))):(0,d.A)(h)&&(h.show=!1)}return!0},Ti.prototype.isDestroyed=function(){return!1},Ti.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(Ti.prototype._onCollectionChanged,this);const e=this._entitiesToVisualize.values,t=this._tilesetHash,n=this._primitives;for(let i=e.length-1;i>-1;i--)bi(0,e[i],t,n);return(0,h.A)(this)},Ti.prototype.getBoundingSphere=function(e,t){if(!(0,d.A)(e))throw new A.A("entity is required.");if(!(0,d.A)(t))throw new A.A("result is required.");const n=this._tilesetHash[e.id];if(!(0,d.A)(n)||n.loadFail)return Gt.FAILED;const i=n.tilesetPrimitive;return(0,d.A)(i)?i.show?(Sn.A.clone(i.boundingSphere,t),Gt.DONE):Gt.FAILED:Gt.PENDING},Ti.prototype._onCollectionChanged=function(e,t,n,i){let o,r;const s=this._entitiesToVisualize,a=this._tilesetHash,c=this._primitives;for(o=t.length-1;o>-1;o--)r=t[o],(0,d.A)(r._tileset)&&s.set(r.id,r);for(o=i.length-1;o>-1;o--)r=i[o],(0,d.A)(r._tileset)?s.set(r.id,r):(bi(0,r,a,c),s.remove(r.id));for(o=n.length-1;o>-1;o--)r=n[o],bi(0,r,a,c),s.remove(r.id)};const xi=Ti;var Ci=n(819488);const Ei=u.A.WHITE,Si=u.A.BLACK,Ii=new q.A(2,2);function Pi(e){e=e??S.A.EMPTY_OBJECT,this._definitionChanged=new Bn.A,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.repeat=e.repeat}Object.defineProperties(Pi.prototype,{isConstant:{get:function(){return Wt.A.isConstant(this._evenColor)&&Wt.A.isConstant(this._oddColor)&&Wt.A.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},evenColor:(0,Ci.A)("evenColor"),oddColor:(0,Ci.A)("oddColor"),repeat:(0,Ci.A)("repeat")}),Pi.prototype.getType=function(e){return"Checkerboard"};const Di=new te.A;Pi.prototype.getValue=function(e,t){return(0,d.A)(e)||(e=te.A.now(Di)),(0,d.A)(t)||(t={}),t.lightColor=Wt.A.getValueOrClonedDefault(this._evenColor,e,Ei,t.lightColor),t.darkColor=Wt.A.getValueOrClonedDefault(this._oddColor,e,Si,t.darkColor),t.repeat=Wt.A.getValueOrDefault(this._repeat,e,Ii),t},Pi.prototype.equals=function(e){return this===e||e instanceof Pi&&Wt.A.equals(this._evenColor,e._evenColor)&&Wt.A.equals(this._oddColor,e._oddColor)&&Wt.A.equals(this._repeat,e._repeat)};const Oi=Pi;var Ri=n(151075);const Mi={id:void 0},Li=new Array(2);function Ni(e){const t=e.propertyNames,n=t.length;for(let i=0;i<n;i++)e[t[i]]=void 0;e._name=void 0,e._availability=void 0}function Bi(e,t,n,i){Li[0]=n,Li[1]=i.id,t[JSON.stringify(Li)]=i.definitionChanged.addEventListener(ki.prototype._onDefinitionChanged,e)}function Fi(e,t,n,i){Li[0]=n,Li[1]=i.id;const o=JSON.stringify(Li);t[o](),t[o]=void 0}function Ui(e){if(e._shouldRecomposite=!0,0!==e._suspendCount)return;const t=e._collections,n=t.length,i=e._collectionsCopy,o=i.length;let r,s,a,c,l;const u=e._composite,h=new Ri.A(e),A=e._eventHash;let p;for(r=0;r<o;r++)for(l=i[r],l.collectionChanged.removeEventListener(ki.prototype._onCollectionChanged,e),a=l.values,p=l.id,c=a.length-1;c>-1;c--)s=a[c],Fi(0,A,p,s);for(r=n-1;r>=0;r--)for(l=t[r],l.collectionChanged.addEventListener(ki.prototype._onCollectionChanged,e),a=l.values,p=l.id,c=a.length-1;c>-1;c--){s=a[c],Bi(e,A,p,s);let t=h.getById(s.id);(0,d.A)(t)||(t=u.getById(s.id),(0,d.A)(t)?Ni(t):(Mi.id=s.id,t=new zn.A(Mi)),h.add(t)),t.merge(s)}e._collectionsCopy=t.slice(0),u.suspendEvents(),u.removeAll();const f=h.values;for(r=0;r<f.length;r++)u.add(f[r]);u.resumeEvents()}function ki(e,t){this._owner=t,this._composite=new Ri.A(this),this._suspendCount=0,this._collections=(0,d.A)(e)?e.slice():[],this._collectionsCopy=[],this._id=(0,E.A)(),this._eventHash={},Ui(this),this._shouldRecomposite=!1}function Vi(e,t){if(!(0,d.A)(t))throw new A.A("collection is required.");const n=e.indexOf(t);if(-1===n)throw new A.A("collection is not in this composite.");return n}function zi(e,t,n){const i=e._collections;if((t=J.A.clamp(t,0,i.length-1))===(n=J.A.clamp(n,0,i.length-1)))return;const o=i[t];i[t]=i[n],i[n]=o,Ui(e)}Object.defineProperties(ki.prototype,{collectionChanged:{get:function(){return this._composite._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._composite.values}},owner:{get:function(){return this._owner}}}),ki.prototype.addCollection=function(e,t){const n=(0,d.A)(t);if(!(0,d.A)(e))throw new A.A("collection is required.");if(n){if(t<0)throw new A.A("index must be greater than or equal to zero.");if(t>this._collections.length)throw new A.A("index must be less than or equal to the number of collections.")}n?this._collections.splice(t,0,e):(t=this._collections.length,this._collections.push(e)),Ui(this)},ki.prototype.removeCollection=function(e){const t=this._collections.indexOf(e);return-1!==t&&(this._collections.splice(t,1),Ui(this),!0)},ki.prototype.removeAllCollections=function(){this._collections.length=0,Ui(this)},ki.prototype.containsCollection=function(e){return-1!==this._collections.indexOf(e)},ki.prototype.contains=function(e){return this._composite.contains(e)},ki.prototype.indexOfCollection=function(e){return this._collections.indexOf(e)},ki.prototype.getCollection=function(e){if(!(0,d.A)(e))throw new A.A("index is required.","index");return this._collections[e]},ki.prototype.getCollectionsLength=function(){return this._collections.length},ki.prototype.raiseCollection=function(e){const t=Vi(this._collections,e);zi(this,t,t+1)},ki.prototype.lowerCollection=function(e){const t=Vi(this._collections,e);zi(this,t,t-1)},ki.prototype.raiseCollectionToTop=function(e){const t=Vi(this._collections,e);t!==this._collections.length-1&&(this._collections.splice(t,1),this._collections.push(e),Ui(this))},ki.prototype.lowerCollectionToBottom=function(e){const t=Vi(this._collections,e);0!==t&&(this._collections.splice(t,1),this._collections.splice(0,0,e),Ui(this))},ki.prototype.suspendEvents=function(){this._suspendCount++,this._composite.suspendEvents()},ki.prototype.resumeEvents=function(){if(0===this._suspendCount)throw new A.A("resumeEvents can not be called before suspendEvents.");this._suspendCount--,this._shouldRecomposite&&0===this._suspendCount&&(Ui(this),this._shouldRecomposite=!1),this._composite.resumeEvents()},ki.prototype.computeAvailability=function(){return this._composite.computeAvailability()},ki.prototype.getById=function(e){return this._composite.getById(e)},ki.prototype._onCollectionChanged=function(e,t,n){const i=this._collectionsCopy,o=i.length,r=this._composite;let s,a,c,l;r.suspendEvents();const u=n.length,h=this._eventHash,A=e.id;for(s=0;s<u;s++){const e=n[s];Fi(0,h,A,e);const t=e.id;for(a=o-1;a>=0;a--)c=i[a].getById(t),(0,d.A)(c)&&((0,d.A)(l)||(l=r.getById(t),Ni(l)),l.merge(c));(0,d.A)(l)||r.removeById(t),l=void 0}const p=t.length;for(s=0;s<p;s++){const e=t[s];Bi(this,h,A,e);const n=e.id;for(a=o-1;a>=0;a--)c=i[a].getById(n),(0,d.A)(c)&&((0,d.A)(l)||(l=r.getById(n),(0,d.A)(l)?Ni(l):(Mi.id=n,l=new zn.A(Mi),r.add(l))),l.merge(c));l=void 0}r.resumeEvents()},ki.prototype._onDefinitionChanged=function(e,t,n,i){const o=this._collections,r=this._composite,s=o.length,a=e.id,c=r.getById(a);let l=c[t];const u=!(0,d.A)(l);let h=!0;for(let n=s-1;n>=0;n--){const i=o[n].getById(e.id);if((0,d.A)(i)){const e=i[t];if((0,d.A)(e)){if(h){if(h=!1,!(0,d.A)(e.merge)||!(0,d.A)(e.clone)){l=e;break}l=e.clone(l)}l.merge(e)}}}u&&-1===c.propertyNames.indexOf(t)&&c.addProperty(t),c[t]=l};const Hi=ki;var Gi=n(354975),Wi=n(525490),Yi=n(658919),qi=n(734780),ji=n(93467);function Qi(e,t){return te.A.compare(e.start,t.start)}function Xi(e){if(this._intervals=[],this._changedEvent=new Bn.A,(0,d.A)(e)){const t=e.length;for(let n=0;n<t;n++)this.addInterval(e[n])}}Object.defineProperties(Xi.prototype,{changedEvent:{get:function(){return this._changedEvent}},start:{get:function(){const e=this._intervals;return 0===e.length?void 0:e[0].start}},isStartIncluded:{get:function(){const e=this._intervals;return 0!==e.length&&e[0].isStartIncluded}},stop:{get:function(){const e=this._intervals,t=e.length;return 0===t?void 0:e[t-1].stop}},isStopIncluded:{get:function(){const e=this._intervals,t=e.length;return 0!==t&&e[t-1].isStopIncluded}},length:{get:function(){return this._intervals.length}},isEmpty:{get:function(){return 0===this._intervals.length}}}),Xi.prototype.equals=function(e,t){if(this===e)return!0;if(!(e instanceof Xi))return!1;const n=this._intervals,i=e._intervals,o=n.length;if(o!==i.length)return!1;for(let e=0;e<o;e++)if(!ji.A.equals(n[e],i[e],t))return!1;return!0},Xi.prototype.get=function(e){if(!(0,d.A)(e))throw new A.A("index is required.");return this._intervals[e]},Xi.prototype.removeAll=function(){this._intervals.length>0&&(this._intervals.length=0,this._changedEvent.raiseEvent(this))},Xi.prototype.findIntervalContainingDate=function(e){const t=this.indexOf(e);return t>=0?this._intervals[t]:void 0},Xi.prototype.findDataForIntervalContainingDate=function(e){const t=this.indexOf(e);return t>=0?this._intervals[t].data:void 0},Xi.prototype.contains=function(e){return this.indexOf(e)>=0};const Ki=new ji.A;Xi.prototype.indexOf=function(e){if(!(0,d.A)(e))throw new A.A("date is required");const t=this._intervals;Ki.start=e,Ki.stop=e;let n=(0,Wi.A)(t,Ki,Qi);return n>=0?t[n].isStartIncluded?n:n>0&&t[n-1].stop.equals(e)&&t[n-1].isStopIncluded?n-1:~n:(n=~n,n>0&&n-1<t.length&&ji.A.contains(t[n-1],e)?n-1:~n)},Xi.prototype.findInterval=function(e){const t=(e=e??S.A.EMPTY_OBJECT).start,n=e.stop,i=e.isStartIncluded,o=e.isStopIncluded,r=this._intervals;for(let e=0,s=r.length;e<s;e++){const s=r[e];if((!(0,d.A)(t)||s.start.equals(t))&&(!(0,d.A)(n)||s.stop.equals(n))&&(!(0,d.A)(i)||s.isStartIncluded===i)&&(!(0,d.A)(o)||s.isStopIncluded===o))return r[e]}},Xi.prototype.addInterval=function(e,t){if(!(0,d.A)(e))throw new A.A("interval is required");if(e.isEmpty)return;const n=this._intervals;if(0===n.length||te.A.greaterThan(e.start,n[n.length-1].stop))return n.push(e),void this._changedEvent.raiseEvent(this);let i,o=(0,Wi.A)(n,e,Qi);for(o<0?o=~o:o>0&&e.isStartIncluded&&n[o-1].isStartIncluded&&n[o-1].start.equals(e.start)?--o:o<n.length&&!e.isStartIncluded&&n[o].isStartIncluded&&n[o].start.equals(e.start)&&++o,o>0&&(i=te.A.compare(n[o-1].stop,e.start),(i>0||0===i&&(n[o-1].isStopIncluded||e.isStartIncluded))&&(((0,d.A)(t)?t(n[o-1].data,e.data):n[o-1].data===e.data)?(e=te.A.greaterThan(e.stop,n[o-1].stop)?new ji.A({start:n[o-1].start,stop:e.stop,isStartIncluded:n[o-1].isStartIncluded,isStopIncluded:e.isStopIncluded,data:e.data}):new ji.A({start:n[o-1].start,stop:n[o-1].stop,isStartIncluded:n[o-1].isStartIncluded,isStopIncluded:n[o-1].isStopIncluded||e.stop.equals(n[o-1].stop)&&e.isStopIncluded,data:e.data}),n.splice(o-1,1),--o):(i=te.A.compare(n[o-1].stop,e.stop),(i>0||0===i&&n[o-1].isStopIncluded&&!e.isStopIncluded)&&n.splice(o,0,new ji.A({start:e.stop,stop:n[o-1].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:n[o-1].isStopIncluded,data:n[o-1].data})),n[o-1]=new ji.A({start:n[o-1].start,stop:e.start,isStartIncluded:n[o-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:n[o-1].data}))));o<n.length&&(i=te.A.compare(e.stop,n[o].start),i>0||0===i&&(e.isStopIncluded||n[o].isStartIncluded));)if((0,d.A)(t)?t(n[o].data,e.data):n[o].data===e.data)e=new ji.A({start:e.start,stop:te.A.greaterThan(n[o].stop,e.stop)?n[o].stop:e.stop,isStartIncluded:e.isStartIncluded,isStopIncluded:te.A.greaterThan(n[o].stop,e.stop)?n[o].isStopIncluded:e.isStopIncluded,data:e.data}),n.splice(o,1);else{if(n[o]=new ji.A({start:e.stop,stop:n[o].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:n[o].isStopIncluded,data:n[o].data}),!n[o].isEmpty)break;n.splice(o,1)}n.splice(o,0,e),this._changedEvent.raiseEvent(this)},Xi.prototype.removeInterval=function(e){if(!(0,d.A)(e))throw new A.A("interval is required");if(e.isEmpty)return!1;const t=this._intervals;let n=(0,Wi.A)(t,e,Qi);n<0&&(n=~n);let i=!1;for(n>0&&(te.A.greaterThan(t[n-1].stop,e.start)||t[n-1].stop.equals(e.start)&&t[n-1].isStopIncluded&&e.isStartIncluded)&&(i=!0,(te.A.greaterThan(t[n-1].stop,e.stop)||t[n-1].isStopIncluded&&!e.isStopIncluded&&t[n-1].stop.equals(e.stop))&&t.splice(n,0,new ji.A({start:e.stop,stop:t[n-1].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:t[n-1].isStopIncluded,data:t[n-1].data})),t[n-1]=new ji.A({start:t[n-1].start,stop:e.start,isStartIncluded:t[n-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:t[n-1].data})),n<t.length&&!e.isStartIncluded&&t[n].isStartIncluded&&e.start.equals(t[n].start)&&(i=!0,t.splice(n,0,new ji.A({start:t[n].start,stop:t[n].start,isStartIncluded:!0,isStopIncluded:!0,data:t[n].data})),++n);n<t.length&&te.A.greaterThan(e.stop,t[n].stop);)i=!0,t.splice(n,1);return n<t.length&&e.stop.equals(t[n].stop)&&(i=!0,!e.isStopIncluded&&t[n].isStopIncluded?n+1<t.length&&t[n+1].start.equals(e.stop)&&t[n].data===t[n+1].data?(t.splice(n,1),t[n]=new ji.A({start:t[n].start,stop:t[n].stop,isStartIncluded:!0,isStopIncluded:t[n].isStopIncluded,data:t[n].data})):t[n]=new ji.A({start:e.stop,stop:e.stop,isStartIncluded:!0,isStopIncluded:!0,data:t[n].data}):t.splice(n,1)),n<t.length&&(te.A.greaterThan(e.stop,t[n].start)||e.stop.equals(t[n].start)&&e.isStopIncluded&&t[n].isStartIncluded)&&(i=!0,t[n]=new ji.A({start:e.stop,stop:t[n].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:t[n].isStopIncluded,data:t[n].data})),i&&this._changedEvent.raiseEvent(this),i},Xi.prototype.intersect=function(e,t,n){if(!(0,d.A)(e))throw new A.A("other is required.");const i=new Xi;let o=0,r=0;const s=this._intervals,a=e._intervals;for(;o<s.length&&r<a.length;){const e=s[o],c=a[r];if(te.A.lessThan(e.stop,c.start))++o;else if(te.A.lessThan(c.stop,e.start))++r;else{if((0,d.A)(n)||(0,d.A)(t)&&t(e.data,c.data)||!(0,d.A)(t)&&c.data===e.data){const o=ji.A.intersect(e,c,new ji.A,n);o.isEmpty||i.addInterval(o,t)}te.A.lessThan(e.stop,c.stop)||e.stop.equals(c.stop)&&!e.isStopIncluded&&c.isStopIncluded?++o:++r}}return i},Xi.fromJulianDateArray=function(e,t){if(!(0,d.A)(e))throw new A.A("options is required.");if(!(0,d.A)(e.julianDates))throw new A.A("options.iso8601Array is required.");(0,d.A)(t)||(t=new Xi);const n=e.julianDates,i=n.length,o=e.dataCallback,r=e.isStartIncluded??!0,s=e.isStopIncluded??!0,a=e.leadingInterval??!1,c=e.trailingInterval??!1;let l,u=0;a&&(++u,l=new ji.A({start:Tn.A.MINIMUM_VALUE,stop:n[0],isStartIncluded:!0,isStopIncluded:!r}),l.data=(0,d.A)(o)?o(l,t.length):t.length,t.addInterval(l));for(let e=0;e<i-1;++e){let a=n[e];const c=n[e+1];l=new ji.A({start:a,stop:c,isStartIncluded:t.length!==u||r,isStopIncluded:e===i-2&&s}),l.data=(0,d.A)(o)?o(l,t.length):t.length,t.addInterval(l),a=c}return c&&(l=new ji.A({start:n[i-1],stop:Tn.A.MAXIMUM_VALUE,isStartIncluded:!s,isStopIncluded:!0}),l.data=(0,d.A)(o)?o(l,t.length):t.length,t.addInterval(l)),t};const $i=new Yi.A,Ji=[0,31,28,31,30,31,30,31,31,30,31,30,31];function Zi(e,t,n){(0,d.A)(n)||(n=new te.A),te.A.toGregorianDate(e,$i);let i=$i.millisecond+t.millisecond,o=$i.second+t.second,r=$i.minute+t.minute,s=$i.hour+t.hour,a=$i.day+t.day,c=$i.month+t.month,l=$i.year+t.year;for(i>=1e3&&(o+=Math.floor(i/1e3),i%=1e3),o>=60&&(r+=Math.floor(o/60),o%=60),r>=60&&(s+=Math.floor(r/60),r%=60),s>=24&&(a+=Math.floor(s/24),s%=24),Ji[2]=(0,qi.A)(l)?29:28;a>Ji[c]||c>=13;)a>Ji[c]&&(a-=Ji[c],++c),c>=13&&(--c,l+=Math.floor(c/12),c%=12,++c),Ji[2]=(0,qi.A)(l)?29:28;return $i.millisecond=i,$i.second=o,$i.minute=r,$i.hour=s,$i.day=a,$i.month=c,$i.year=l,te.A.fromGregorianDate($i,n)}const eo=new te.A,to=/P(?:([\d.,]+)Y)?(?:([\d.,]+)M)?(?:([\d.,]+)W)?(?:([\d.,]+)D)?(?:T(?:([\d.,]+)H)?(?:([\d.,]+)M)?(?:([\d.,]+)S)?)?/;function no(e,t){if(!(0,d.A)(e)||0===e.length)return!1;if(t.year=0,t.month=0,t.day=0,t.hour=0,t.minute=0,t.second=0,t.millisecond=0,"P"===e[0]){const n=e.match(to);if(!(0,d.A)(n))return!1;if((0,d.A)(n[1])&&(t.year=Number(n[1].replace(",","."))),(0,d.A)(n[2])&&(t.month=Number(n[2].replace(",","."))),(0,d.A)(n[3])&&(t.day=7*Number(n[3].replace(",","."))),(0,d.A)(n[4])&&(t.day+=Number(n[4].replace(",","."))),(0,d.A)(n[5])&&(t.hour=Number(n[5].replace(",","."))),(0,d.A)(n[6])&&(t.minute=Number(n[6].replace(",","."))),(0,d.A)(n[7])){const e=Number(n[7].replace(",","."));t.second=Math.floor(e),t.millisecond=e%1*1e3}}else"Z"!==e[e.length-1]&&(e+="Z"),te.A.toGregorianDate(te.A.fromIso8601(e,eo),t);return t.year||t.month||t.day||t.hour||t.minute||t.second||t.millisecond}const io=new Yi.A;Xi.fromIso8601=function(e,t){if(!(0,d.A)(e))throw new A.A("options is required.");if(!(0,d.A)(e.iso8601))throw new A.A("options.iso8601 is required.");const n=e.iso8601.split("/"),i=te.A.fromIso8601(n[0]),o=te.A.fromIso8601(n[1]),r=[];if(no(n[2],io)){let e=te.A.clone(i);for(r.push(e);te.A.compare(e,o)<0;)e=Zi(e,io),te.A.compare(o,e)<=0&&te.A.clone(o,e),r.push(e)}else r.push(i,o);return Xi.fromJulianDateArray({julianDates:r,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)},Xi.fromIso8601DateArray=function(e,t){if(!(0,d.A)(e))throw new A.A("options is required.");if(!(0,d.A)(e.iso8601Dates))throw new A.A("options.iso8601Dates is required.");return Xi.fromJulianDateArray({julianDates:e.iso8601Dates.map(function(e){return te.A.fromIso8601(e)}),isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)},Xi.fromIso8601DurationArray=function(e,t){if(!(0,d.A)(e))throw new A.A("options is required.");if(!(0,d.A)(e.epoch))throw new A.A("options.epoch is required.");if(!(0,d.A)(e.iso8601Durations))throw new A.A("options.iso8601Durations is required.");const n=e.epoch,i=e.iso8601Durations,o=e.relativeToPrevious??!1,r=[];let s,a;const c=i.length;for(let e=0;e<c;++e)(no(i[e],io)||0===e)&&(s=o&&(0,d.A)(a)?Zi(a,io):Zi(n,io),r.push(s),a=s);return Xi.fromJulianDateArray({julianDates:r,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};const oo=Xi;function ro(){this._eventHelper=new Gi.A,this._definitionChanged=new Bn.A,this._intervals=new oo,this._intervals.changedEvent.addEventListener(ro.prototype._intervalsChanged,this)}Object.defineProperties(ro.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});const so=new te.A;ro.prototype.getValue=function(e,t){(0,d.A)(e)||(e=te.A.now(so));const n=this._intervals.findDataForIntervalContainingDate(e);if((0,d.A)(n))return n.getValue(e,t)},ro.prototype.equals=function(e){return this===e||e instanceof ro&&this._intervals.equals(e._intervals,Wt.A.equals)},ro.prototype._intervalsChanged=function(){!function(e,t,n,i){function o(){n.raiseEvent(e)}const r=[];t.removeAll();const s=i.length;for(let e=0;e<s;e++){const n=i.get(e);(0,d.A)(n.data)&&-1===r.indexOf(n.data)&&t.add(n.data.definitionChanged,o)}}(this,this._eventHelper,this._definitionChanged,this._intervals),this._definitionChanged.raiseEvent(this)};const ao=ro;function co(){this._definitionChanged=new Bn.A,this._composite=new ao,this._composite.definitionChanged.addEventListener(co.prototype._raiseDefinitionChanged,this)}Object.defineProperties(co.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite._intervals}}}),co.prototype.getType=function(e){if(!(0,d.A)(e))throw new A.A("time is required");const t=this._composite._intervals.findDataForIntervalContainingDate(e);if((0,d.A)(t))return t.getType(e)};const lo=new te.A;co.prototype.getValue=function(e,t){(0,d.A)(e)||(e=te.A.now(lo));const n=this._composite._intervals.findDataForIntervalContainingDate(e);if((0,d.A)(n))return n.getValue(e,t)},co.prototype.equals=function(e){return this===e||e instanceof co&&this._composite.equals(e._composite,Wt.A.equals)},co.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};const uo=co;function ho(e){this._referenceFrame=e??Ai.A.FIXED,this._definitionChanged=new Bn.A,this._composite=new ao,this._composite.definitionChanged.addEventListener(ho.prototype._raiseDefinitionChanged,this)}Object.defineProperties(ho.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(e){this._referenceFrame=e}}});const Ao=new te.A;ho.prototype.getValue=function(e,t){return(0,d.A)(e)||(e=te.A.now(Ao)),this.getValueInReferenceFrame(e,Ai.A.FIXED,t)},ho.prototype.getValueInReferenceFrame=function(e,t,n){if(!(0,d.A)(e))throw new A.A("time is required.");if(!(0,d.A)(t))throw new A.A("referenceFrame is required.");const i=this._composite._intervals.findDataForIntervalContainingDate(e);if((0,d.A)(i))return i.getValueInReferenceFrame(e,t,n)},ho.prototype.equals=function(e){return this===e||e instanceof ho&&this._referenceFrame===e._referenceFrame&&this._composite.equals(e._composite,Wt.A.equals)},ho.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};const po=ho;var fo=n(808938),mo=n(564886),go=n(263604);const _o=Object.freeze({ROUNDED:0,MITERED:1,BEVELED:2});var yo=n(870349),vo=n(658091),To=n(99479);const bo=[new j.A,new j.A],wo=new j.A,xo=new j.A,Co=new j.A,Eo=new j.A,So=new j.A,Io=new j.A,Po=new j.A,Do=new j.A,Oo=new j.A,Ro=new j.A,Mo=new j.A,Lo={};let No=new X.A;function Bo(e,t,n,i){const o=e[0],r=e[1],s=j.A.angleBetween(o,r),a=Math.ceil(s/i),c=new Array(a);let l;if(t===n){for(l=0;l<a;l++)c[l]=t;return c.push(n),c}const u=(n-t)/a;for(l=1;l<a;l++){const e=t+l*u;c[l]=e}return c[0]=t,c.push(n),c}const Fo=new j.A,Uo=new j.A,ko=new j.A(-1,0,0);let Vo=new O.A;const zo=new O.A;let Ho=new Z.A;const Go=Z.A.IDENTITY.clone(),Wo=new j.A,Yo=new Q.A,qo=new j.A;function jo(e,t,n,i,o,r,s,a){let c=Wo,l=Yo;Vo=xe.A.eastNorthUpToFixedFrame(e,o,Vo),c=O.A.multiplyByPointAsVector(Vo,ko,c),c=j.A.normalize(c,c);const u=function(e,t,n,i){const o=new vo.A(n,i),r=o.projectPointOntoPlane(j.A.add(n,e,Fo),Fo),s=o.projectPointOntoPlane(j.A.add(n,t,Uo),Uo),a=q.A.angleBetween(r,s);return s.x*r.y-s.y*r.x>=0?-a:a}(c,t,e,o);Ho=Z.A.fromRotationZ(u,Ho),qo.z=r,Vo=O.A.multiplyTransformation(Vo,O.A.fromRotationTranslation(Ho,qo,zo),Vo);const d=Go;d[0]=s;for(let e=0;e<a;e++)for(let e=0;e<n.length;e+=3)l=j.A.fromArray(n,e,l),l=Z.A.multiplyByVector(d,l,l),l=O.A.multiplyByPoint(Vo,l,l),i.push(l.x,l.y,l.z);return i}const Qo=new j.A;function Xo(e,t,n,i,o,r,s){for(let a=0;a<e.length;a+=3)i=jo(j.A.fromArray(e,a,Qo),t,n,i,o,r[a/3],s,1);return i}function Ko(e,t){const n=e.length,i=new Array(3*n);let o=0;const r=t.x+t.width/2,s=t.y+t.height/2;for(let t=0;t<n;t++)i[o++]=e[t].x-r,i[o++]=0,i[o++]=e[t].y-s;return i}const $o=new To.A,Jo=new j.A,Zo=new Z.A;function er(e,t,n,i,o,r,s,a,c,l){const u=j.A.angleBetween(j.A.subtract(t,e,Ro),j.A.subtract(n,e,Mo)),d=i===_o.BEVELED?0:Math.ceil(u/J.A.toRadians(5));let h,A,p;if(h=o?Z.A.fromQuaternion(To.A.fromAxisAngle(j.A.negate(e,Ro),u/(d+1),$o),Zo):Z.A.fromQuaternion(To.A.fromAxisAngle(e,u/(d+1),$o),Zo),t=j.A.clone(t,Jo),d>0){const n=l?2:1;for(let i=0;i<d;i++)t=Z.A.multiplyByVector(h,t,t),A=j.A.subtract(t,e,Ro),A=j.A.normalize(A,A),o||(A=j.A.negate(A,A)),p=r.scaleToGeodeticSurface(t,Mo),s=jo(p,A,a,s,r,c,1,n)}else A=j.A.subtract(t,e,Ro),A=j.A.normalize(A,A),o||(A=j.A.negate(A,A)),p=r.scaleToGeodeticSurface(t,Mo),s=jo(p,A,a,s,r,c,1,1),n=j.A.clone(n,Jo),A=j.A.subtract(n,e,Ro),A=j.A.normalize(A,A),o||(A=j.A.negate(A,A)),p=r.scaleToGeodeticSurface(n,Mo),s=jo(p,A,a,s,r,c,1,1);return s}Lo.removeDuplicatesFromShape=function(e){const t=e.length,n=[];for(let i=t-1,o=0;o<t;i=o++){const t=e[i],r=e[o];q.A.equals(t,r)||n.push(r)}return n},Lo.angleIsGreaterThanPi=function(e,t,n,i){const o=new vo.A(n,i),r=o.projectPointOntoPlane(j.A.add(n,e,Fo),Fo),s=o.projectPointOntoPlane(j.A.add(n,t,Uo),Uo);return s.x*r.y-s.y*r.x>=0};const tr=new j.A,nr=new j.A;Lo.computePositions=function(e,t,n,i,o){const r=i._ellipsoid,s=function(e,t){const n=new Array(e.length);for(let i=0;i<e.length;i++){const o=e[i];No=t.cartesianToCartographic(o,No),n[i]=No.height,e[i]=t.scaleToGeodeticSurface(o,o)}return n}(e,r),a=i._granularity,c=i._cornerType,l=o?function(e,t){const n=e.length,i=new Array(6*n);let o=0;const r=t.x+t.width/2,s=t.y+t.height/2;let a=e[0];i[o++]=a.x-r,i[o++]=0,i[o++]=a.y-s;for(let t=1;t<n;t++){a=e[t];const n=a.x-r,c=a.y-s;i[o++]=n,i[o++]=0,i[o++]=c,i[o++]=n,i[o++]=0,i[o++]=c}return a=e[0],i[o++]=a.x-r,i[o++]=0,i[o++]=a.y-s,i}(t,n):Ko(t,n),u=o?Ko(t,n):void 0,d=n.height/2,h=n.width/2;let A=e.length,p=[],f=o?[]:void 0,m=wo,g=xo,_=Co,y=Eo,v=So,T=Io,b=Po,w=Do,x=Oo,C=e[0],E=e[1];y=r.geodeticSurfaceNormal(C,y),m=j.A.subtract(E,C,m),m=j.A.normalize(m,m),w=j.A.cross(y,m,w),w=j.A.normalize(w,w);let S,I,P=s[0],D=s[1];o&&(f=jo(C,w,u,f,r,P+d,1,1)),x=j.A.clone(C,x),C=E,g=j.A.negate(m,g);for(let t=1;t<A-1;t++){const n=o?2:1;if(E=e[t+1],C.equals(E)){(0,Fn.A)("Positions are too close and are considered equivalent with rounding error.");continue}m=j.A.subtract(E,C,m),m=j.A.normalize(m,m),y=r.geodeticSurfaceNormal(C,y);const i=j.A.multiplyByScalar(y,j.A.dot(m,y),tr);j.A.subtract(m,i,i),j.A.normalize(i,i);const u=j.A.multiplyByScalar(y,j.A.dot(g,y),nr);if(j.A.subtract(g,u,u),j.A.normalize(u,u),J.A.equalsEpsilon(Math.abs(j.A.dot(i,u)),1,J.A.EPSILON7))p=jo(x,w,l,p,r,P+d,1,1),x=C;else{_=j.A.add(m,g,_),_=j.A.normalize(_,_),_=j.A.cross(_,y,_),_=j.A.cross(y,_,_),_=j.A.normalize(_,_);const e=1/Math.max(.25,j.A.magnitude(j.A.cross(_,g,Ro))),t=Lo.angleIsGreaterThanPi(m,g,C,r);t?(v=j.A.add(C,j.A.multiplyByScalar(_,e*h,_),v),T=j.A.add(v,j.A.multiplyByScalar(w,h,T),T),bo[0]=j.A.clone(x,bo[0]),bo[1]=j.A.clone(T,bo[1]),S=Bo(bo,P+d,D+d,a),I=yo.A.generateArc({positions:bo,granularity:a,ellipsoid:r}),p=Xo(I,w,l,p,r,S,1),w=j.A.cross(y,m,w),w=j.A.normalize(w,w),b=j.A.add(v,j.A.multiplyByScalar(w,h,b),b),c===_o.ROUNDED||c===_o.BEVELED?er(v,T,b,c,t,r,p,l,D+d,o):(_=j.A.negate(_,_),p=jo(C,_,l,p,r,D+d,e,n)),x=j.A.clone(b,x)):(v=j.A.add(C,j.A.multiplyByScalar(_,e*h,_),v),T=j.A.add(v,j.A.multiplyByScalar(w,-h,T),T),bo[0]=j.A.clone(x,bo[0]),bo[1]=j.A.clone(T,bo[1]),S=Bo(bo,P+d,D+d,a),I=yo.A.generateArc({positions:bo,granularity:a,ellipsoid:r}),p=Xo(I,w,l,p,r,S,1),w=j.A.cross(y,m,w),w=j.A.normalize(w,w),b=j.A.add(v,j.A.multiplyByScalar(w,-h,b),b),c===_o.ROUNDED||c===_o.BEVELED?er(v,T,b,c,t,r,p,l,D+d,o):p=jo(C,_,l,p,r,D+d,e,n),x=j.A.clone(b,x)),g=j.A.negate(m,g)}P=D,D=s[t+1],C=E}bo[0]=j.A.clone(x,bo[0]),bo[1]=j.A.clone(C,bo[1]),S=Bo(bo,P+d,D+d,a),I=yo.A.generateArc({positions:bo,granularity:a,ellipsoid:r}),p=Xo(I,w,l,p,r,S,1),o&&(f=jo(C,w,u,f,r,D+d,1,1)),A=p.length;const O=o?A+f.length:A,R=new Float64Array(O);return R.set(p),o&&R.set(f,A),R};const ir=Lo,or={},rr=new j.A,sr=new j.A,ar=new j.A,cr=new j.A,lr=[new j.A,new j.A],ur=new j.A,dr=new j.A,hr=new j.A,Ar=new j.A,pr=new j.A,fr=new j.A,mr=new j.A,gr=new j.A,_r=new j.A,yr=new j.A,vr=new To.A,Tr=new Z.A;function br(e,t,n,i,o){const r=j.A.angleBetween(j.A.subtract(t,e,rr),j.A.subtract(n,e,sr)),s=i===_o.BEVELED?1:Math.ceil(r/J.A.toRadians(5))+1,a=3*s,c=new Array(a);let l;c[a-3]=n.x,c[a-2]=n.y,c[a-1]=n.z,l=o?Z.A.fromQuaternion(To.A.fromAxisAngle(j.A.negate(e,rr),r/s,vr),Tr):Z.A.fromQuaternion(To.A.fromAxisAngle(e,r/s,vr),Tr);let u=0;t=j.A.clone(t,rr);for(let e=0;e<s;e++)t=Z.A.multiplyByVector(l,t,t),c[u++]=t.x,c[u++]=t.y,c[u++]=t.z;return c}function wr(e,t,n,i){let o=rr;return i||(t=j.A.negate(t,t)),o=j.A.add(e,t,o),[o.x,o.y,o.z,n.x,n.y,n.z]}function xr(e,t,n,i){const o=new Array(e.length),r=new Array(e.length),s=j.A.multiplyByScalar(t,n,rr),a=j.A.negate(s,sr);let c=0,l=e.length-1;for(let t=0;t<e.length;t+=3){const n=j.A.fromArray(e,t,ar),i=j.A.add(n,a,cr);o[c++]=i.x,o[c++]=i.y,o[c++]=i.z;const u=j.A.add(n,s,cr);r[l--]=u.z,r[l--]=u.y,r[l--]=u.x}return i.push(o,r),i}or.addAttribute=function(e,t,n,i){const o=t.x,r=t.y,s=t.z;(0,d.A)(n)&&(e[n]=o,e[n+1]=r,e[n+2]=s),(0,d.A)(i)&&(e[i]=s,e[i-1]=r,e[i-2]=o)};const Cr=new j.A,Er=new j.A;or.computePositions=function(e){const t=e.granularity,n=e.positions,i=e.ellipsoid,o=e.width/2,r=e.cornerType,s=e.saveAttributes;let a=ur,c=dr,l=hr,u=Ar,d=pr,h=fr,A=mr,p=gr,f=_r,m=yr,g=[];const _=s?[]:void 0,y=s?[]:void 0;let v,T=n[0],b=n[1];c=j.A.normalize(j.A.subtract(b,T,c),c),a=i.geodeticSurfaceNormal(T,a),u=j.A.normalize(j.A.cross(a,c,u),u),s&&(_.push(u.x,u.y,u.z),y.push(a.x,a.y,a.z)),A=j.A.clone(T,A),T=b,l=j.A.negate(c,l);const w=[];let x;const C=n.length;for(x=1;x<C-1;x++){a=i.geodeticSurfaceNormal(T,a),b=n[x+1],c=j.A.normalize(j.A.subtract(b,T,c),c);const e=j.A.multiplyByScalar(a,j.A.dot(c,a),Cr);j.A.subtract(c,e,e),j.A.normalize(e,e);const C=j.A.multiplyByScalar(a,j.A.dot(l,a),Er);if(j.A.subtract(l,C,C),j.A.normalize(C,C),!J.A.equalsEpsilon(Math.abs(j.A.dot(e,C)),1,J.A.EPSILON7)){d=j.A.normalize(j.A.add(c,l,d),d),d=j.A.cross(d,a,d),d=j.A.cross(a,d,d),d=j.A.normalize(d,d);const e=o/Math.max(.25,j.A.magnitude(j.A.cross(d,l,rr))),n=ir.angleIsGreaterThanPi(c,l,T,i);d=j.A.multiplyByScalar(d,e,d),n?(p=j.A.add(T,d,p),m=j.A.add(p,j.A.multiplyByScalar(u,o,m),m),f=j.A.add(p,j.A.multiplyByScalar(u,2*o,f),f),lr[0]=j.A.clone(A,lr[0]),lr[1]=j.A.clone(m,lr[1]),v=yo.A.generateArc({positions:lr,granularity:t,ellipsoid:i}),g=xr(v,u,o,g),s&&(_.push(u.x,u.y,u.z),y.push(a.x,a.y,a.z)),h=j.A.clone(f,h),u=j.A.normalize(j.A.cross(a,c,u),u),f=j.A.add(p,j.A.multiplyByScalar(u,2*o,f),f),A=j.A.add(p,j.A.multiplyByScalar(u,o,A),A),r===_o.ROUNDED||r===_o.BEVELED?w.push({leftPositions:br(p,h,f,r,n)}):w.push({leftPositions:wr(T,j.A.negate(d,d),f,n)})):(f=j.A.add(T,d,f),m=j.A.add(f,j.A.negate(j.A.multiplyByScalar(u,o,m),m),m),p=j.A.add(f,j.A.negate(j.A.multiplyByScalar(u,2*o,p),p),p),lr[0]=j.A.clone(A,lr[0]),lr[1]=j.A.clone(m,lr[1]),v=yo.A.generateArc({positions:lr,granularity:t,ellipsoid:i}),g=xr(v,u,o,g),s&&(_.push(u.x,u.y,u.z),y.push(a.x,a.y,a.z)),h=j.A.clone(p,h),u=j.A.normalize(j.A.cross(a,c,u),u),p=j.A.add(f,j.A.negate(j.A.multiplyByScalar(u,2*o,p),p),p),A=j.A.add(f,j.A.negate(j.A.multiplyByScalar(u,o,A),A),A),r===_o.ROUNDED||r===_o.BEVELED?w.push({rightPositions:br(f,h,p,r,n)}):w.push({rightPositions:wr(T,d,p,n)})),l=j.A.negate(c,l)}T=b}let E;return a=i.geodeticSurfaceNormal(T,a),lr[0]=j.A.clone(A,lr[0]),lr[1]=j.A.clone(T,lr[1]),v=yo.A.generateArc({positions:lr,granularity:t,ellipsoid:i}),g=xr(v,u,o,g),s&&(_.push(u.x,u.y,u.z),y.push(a.x,a.y,a.z)),r===_o.ROUNDED&&(E=function(e){let t=ur,n=dr,i=hr,o=e[1];n=j.A.fromArray(e[1],o.length-3,n),i=j.A.fromArray(e[0],0,i),t=j.A.midpoint(n,i,t);const r=br(t,n,i,_o.ROUNDED,!1),s=e.length-1,a=e[s-1];return o=e[s],n=j.A.fromArray(a,a.length-3,n),i=j.A.fromArray(o,0,i),t=j.A.midpoint(n,i,t),[r,br(t,n,i,_o.ROUNDED,!1)]}(g)),{positions:g,corners:w,lefts:_,normals:y,endPositions:E}};const Sr=or;var Ir=n(46362),Pr=n(874915),Dr=n(576770),Or=n(697422),Rr=n(769534);const Mr=new j.A,Lr=new j.A,Nr=new j.A,Br=new j.A,Fr=new j.A,Ur=new j.A,kr=new j.A,Vr=new j.A;function zr(e,t){for(let n=0;n<e.length;n++)e[n]=t.scaleToGeodeticSurface(e[n],e[n]);return e}function Hr(e,t,n,i,o,r){const s=e.normals,a=e.tangents,c=e.bitangents,l=j.A.normalize(j.A.cross(n,t,kr),kr);r.normal&&Sr.addAttribute(s,t,i,o),r.tangent&&Sr.addAttribute(a,l,i,o),r.bitangent&&Sr.addAttribute(c,n,i,o)}function Gr(e,t,n){const i=e.positions,o=e.corners,r=e.endPositions,s=e.lefts,a=e.normals,c=new Ir.A;let l,u,h,A=0,p=0,f=0;for(u=0;u<i.length;u+=2)h=i[u].length-3,A+=h,f+=2*h,p+=i[u+1].length-3;for(A+=3,p+=3,u=0;u<o.length;u++){l=o[u];const e=o[u].leftPositions;(0,d.A)(e)?(h=e.length,A+=h,f+=h):(h=o[u].rightPositions.length,p+=h,f+=h)}const m=(0,d.A)(r);let g;m&&(g=r[0].length-3,A+=g,p+=g,g/=3,f+=6*g);const _=A+p,y=new Float64Array(_),v={normals:t.normal?new Float32Array(_):void 0,tangents:t.tangent?new Float32Array(_):void 0,bitangents:t.bitangent?new Float32Array(_):void 0};let T,b,w,x,E,S,I=0,D=_-1,O=Mr,R=Lr;const M=g/2,L=Pr.A.createTypedArray(_/3,f);let N=0;if(m){S=Nr,E=Br;const e=r[0];for(O=j.A.fromArray(a,0,O),R=j.A.fromArray(s,0,R),u=0;u<M;u++)S=j.A.fromArray(e,3*(M-1-u),S),E=j.A.fromArray(e,3*(M+u),E),Sr.addAttribute(y,E,I),Sr.addAttribute(y,S,void 0,D),Hr(v,O,R,I,D,t),b=I/3,x=b+1,T=(D-2)/3,w=T-1,L[N++]=T,L[N++]=b,L[N++]=w,L[N++]=w,L[N++]=b,L[N++]=x,I+=3,D-=3}let B,F,U=0,k=0,V=i[U++],z=i[U++];for(y.set(V,I),y.set(z,D-z.length+1),R=j.A.fromArray(s,k,R),h=z.length-3,u=0;u<h;u+=3)B=n.geodeticSurfaceNormal(j.A.fromArray(V,u,kr),kr),F=n.geodeticSurfaceNormal(j.A.fromArray(z,h-u,Vr),Vr),O=j.A.normalize(j.A.add(B,F,O),O),Hr(v,O,R,I,D,t),b=I/3,x=b+1,T=(D-2)/3,w=T-1,L[N++]=T,L[N++]=b,L[N++]=w,L[N++]=w,L[N++]=b,L[N++]=x,I+=3,D-=3;for(B=n.geodeticSurfaceNormal(j.A.fromArray(V,h,kr),kr),F=n.geodeticSurfaceNormal(j.A.fromArray(z,h,Vr),Vr),O=j.A.normalize(j.A.add(B,F,O),O),k+=3,u=0;u<o.length;u++){let e;l=o[u];const r=l.leftPositions,c=l.rightPositions;let A,p,f=Ur,m=Nr,g=Br;if(O=j.A.fromArray(a,k,O),(0,d.A)(r)){for(Hr(v,O,R,void 0,D,t),D-=3,A=x,p=w,e=0;e<r.length/3;e++)f=j.A.fromArray(r,3*e,f),L[N++]=A,L[N++]=p-e-1,L[N++]=p-e,Sr.addAttribute(y,f,void 0,D),m=j.A.fromArray(y,3*(p-e-1),m),g=j.A.fromArray(y,3*A,g),R=j.A.normalize(j.A.subtract(m,g,R),R),Hr(v,O,R,void 0,D,t),D-=3;f=j.A.fromArray(y,3*A,f),m=j.A.subtract(j.A.fromArray(y,3*p,m),f,m),g=j.A.subtract(j.A.fromArray(y,3*(p-e),g),f,g),R=j.A.normalize(j.A.add(m,g,R),R),Hr(v,O,R,I,void 0,t),I+=3}else{for(Hr(v,O,R,I,void 0,t),I+=3,A=w,p=x,e=0;e<c.length/3;e++)f=j.A.fromArray(c,3*e,f),L[N++]=A,L[N++]=p+e,L[N++]=p+e+1,Sr.addAttribute(y,f,I),m=j.A.fromArray(y,3*A,m),g=j.A.fromArray(y,3*(p+e),g),R=j.A.normalize(j.A.subtract(m,g,R),R),Hr(v,O,R,I,void 0,t),I+=3;f=j.A.fromArray(y,3*A,f),m=j.A.subtract(j.A.fromArray(y,3*(p+e),m),f,m),g=j.A.subtract(j.A.fromArray(y,3*p,g),f,g),R=j.A.normalize(j.A.negate(j.A.add(g,m,R),R),R),Hr(v,O,R,void 0,D,t),D-=3}for(V=i[U++],z=i[U++],V.splice(0,3),z.splice(z.length-3,3),y.set(V,I),y.set(z,D-z.length+1),h=z.length-3,k+=3,R=j.A.fromArray(s,k,R),e=0;e<z.length;e+=3)B=n.geodeticSurfaceNormal(j.A.fromArray(V,e,kr),kr),F=n.geodeticSurfaceNormal(j.A.fromArray(z,h-e,Vr),Vr),O=j.A.normalize(j.A.add(B,F,O),O),Hr(v,O,R,I,D,t),x=I/3,b=x-1,w=(D-2)/3,T=w+1,L[N++]=T,L[N++]=b,L[N++]=w,L[N++]=w,L[N++]=b,L[N++]=x,I+=3,D-=3;I-=3,D+=3}if(O=j.A.fromArray(a,a.length-3,O),Hr(v,O,R,I,D,t),m){I+=3,D-=3,S=Nr,E=Br;const e=r[1];for(u=0;u<M;u++)S=j.A.fromArray(e,3*(g-u-1),S),E=j.A.fromArray(e,3*u,E),Sr.addAttribute(y,S,void 0,D),Sr.addAttribute(y,E,I),Hr(v,O,R,I,D,t),x=I/3,b=x-1,w=(D-2)/3,T=w+1,L[N++]=T,L[N++]=b,L[N++]=w,L[N++]=w,L[N++]=b,L[N++]=x,I+=3,D-=3}if(c.position=new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:y}),t.st){const e=new Float32Array(_/3*2);let t,n,i=0;if(m){A/=3,p/=3;const o=Math.PI/(g+1);let r;n=1/(A-g+1),t=1/(p-g+1);const s=g/2;for(u=s+1;u<g+1;u++)r=J.A.PI_OVER_TWO+o*u,e[i++]=t*(1+Math.cos(r)),e[i++]=.5*(1+Math.sin(r));for(u=1;u<p-g+1;u++)e[i++]=u*t,e[i++]=0;for(u=g;u>s;u--)r=J.A.PI_OVER_TWO-u*o,e[i++]=1-t*(1+Math.cos(r)),e[i++]=.5*(1+Math.sin(r));for(u=s;u>0;u--)r=J.A.PI_OVER_TWO-o*u,e[i++]=1-n*(1+Math.cos(r)),e[i++]=.5*(1+Math.sin(r));for(u=A-g;u>0;u--)e[i++]=u*n,e[i++]=1;for(u=1;u<s+1;u++)r=J.A.PI_OVER_TWO+o*u,e[i++]=n*(1+Math.cos(r)),e[i++]=.5*(1+Math.sin(r))}else{for(A/=3,p/=3,n=1/(A-1),t=1/(p-1),u=0;u<p;u++)e[i++]=u*t,e[i++]=0;for(u=A;u>0;u--)e[i++]=(u-1)*n,e[i++]=1}c.st=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:2,values:e})}return t.normal&&(c.normal=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:v.normals})),t.tangent&&(c.tangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:v.tangents})),t.bitangent&&(c.bitangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:v.bitangents})),{attributes:c,indices:L}}function Wr(e,t,n){n[t++]=e[0],n[t++]=e[1],n[t++]=e[2];for(let i=3;i<e.length;i+=3){const o=e[i],r=e[i+1],s=e[i+2];n[t++]=o,n[t++]=r,n[t++]=s,n[t++]=o,n[t++]=r,n[t++]=s}return n[t++]=e[0],n[t++]=e[1],n[t++]=e[2],n}const Yr=new j.A,qr=new j.A,jr=new X.A;function Qr(e,t,n,i,o,r){const s=j.A.subtract(t,e,Yr);j.A.normalize(s,s);const a=n.geodeticSurfaceNormal(e,qr),c=j.A.cross(s,a,Yr);j.A.multiplyByScalar(c,i,c);let l=o.latitude,u=o.longitude,d=r.latitude,h=r.longitude;j.A.add(e,c,qr),n.cartesianToCartographic(qr,jr);let A=jr.latitude,p=jr.longitude;l=Math.min(l,A),u=Math.min(u,p),d=Math.max(d,A),h=Math.max(h,p),j.A.subtract(e,c,qr),n.cartesianToCartographic(qr,jr),A=jr.latitude,p=jr.longitude,l=Math.min(l,A),u=Math.min(u,p),d=Math.max(d,A),h=Math.max(h,p),o.latitude=l,o.longitude=u,r.latitude=d,r.longitude=h}const Xr=new j.A,Kr=new j.A,$r=new X.A,Jr=new X.A;function Zr(e,t,n,i,o){e=zr(e,t);const r=(0,go.A)(e,j.A.equalsEpsilon),s=r.length;if(s<2||n<=0)return new Or.A;const a=.5*n;let c,l;if($r.latitude=Number.POSITIVE_INFINITY,$r.longitude=Number.POSITIVE_INFINITY,Jr.latitude=Number.NEGATIVE_INFINITY,Jr.longitude=Number.NEGATIVE_INFINITY,i===_o.ROUNDED){const e=r[0];j.A.subtract(e,r[1],Xr),j.A.normalize(Xr,Xr),j.A.multiplyByScalar(Xr,a,Xr),j.A.add(e,Xr,Kr),t.cartesianToCartographic(Kr,jr),c=jr.latitude,l=jr.longitude,$r.latitude=Math.min($r.latitude,c),$r.longitude=Math.min($r.longitude,l),Jr.latitude=Math.max(Jr.latitude,c),Jr.longitude=Math.max(Jr.longitude,l)}for(let e=0;e<s-1;++e)Qr(r[e],r[e+1],t,a,$r,Jr);const u=r[s-1];j.A.subtract(u,r[s-2],Xr),j.A.normalize(Xr,Xr),j.A.multiplyByScalar(Xr,a,Xr),j.A.add(u,Xr,Kr),Qr(u,Kr,t,a,$r,Jr),i===_o.ROUNDED&&(t.cartesianToCartographic(Kr,jr),c=jr.latitude,l=jr.longitude,$r.latitude=Math.min($r.latitude,c),$r.longitude=Math.min($r.longitude,l),Jr.latitude=Math.max(Jr.latitude,c),Jr.longitude=Math.max(Jr.longitude,l));const h=(0,d.A)(o)?o:new Or.A;return h.north=Jr.latitude,h.south=$r.latitude,h.east=Jr.longitude,h.west=$r.longitude,h}function es(e){const t=(e=e??S.A.EMPTY_OBJECT).positions,n=e.width;l.A.defined("options.positions",t),l.A.defined("options.width",n);const i=e.height??0,o=e.extrudedHeight??i;this._positions=t,this._ellipsoid=K.A.clone(e.ellipsoid??K.A.default),this._vertexFormat=Rr.A.clone(e.vertexFormat??Rr.A.DEFAULT),this._width=n,this._height=Math.max(i,o),this._extrudedHeight=Math.min(i,o),this._cornerType=e.cornerType??_o.ROUNDED,this._granularity=e.granularity??J.A.RADIANS_PER_DEGREE,this._shadowVolume=e.shadowVolume??!1,this._workerName="createCorridorGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this.packedLength=1+t.length*j.A.packedLength+K.A.packedLength+Rr.A.packedLength+7}es.pack=function(e,t,n){l.A.defined("value",e),l.A.defined("array",t),n=n??0;const i=e._positions,o=i.length;t[n++]=o;for(let e=0;e<o;++e,n+=j.A.packedLength)j.A.pack(i[e],t,n);return K.A.pack(e._ellipsoid,t,n),n+=K.A.packedLength,Rr.A.pack(e._vertexFormat,t,n),n+=Rr.A.packedLength,t[n++]=e._width,t[n++]=e._height,t[n++]=e._extrudedHeight,t[n++]=e._cornerType,t[n++]=e._granularity,t[n++]=e._shadowVolume?1:0,t[n]=e._offsetAttribute??-1,t};const ts=K.A.clone(K.A.UNIT_SPHERE),ns=new Rr.A,is={positions:void 0,ellipsoid:ts,vertexFormat:ns,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,shadowVolume:void 0,offsetAttribute:void 0};es.unpack=function(e,t,n){l.A.defined("array",e),t=t??0;const i=e[t++],o=new Array(i);for(let n=0;n<i;++n,t+=j.A.packedLength)o[n]=j.A.unpack(e,t);const r=K.A.unpack(e,t,ts);t+=K.A.packedLength;const s=Rr.A.unpack(e,t,ns);t+=Rr.A.packedLength;const a=e[t++],c=e[t++],u=e[t++],h=e[t++],A=e[t++],p=1===e[t++],f=e[t];return(0,d.A)(n)?(n._positions=o,n._ellipsoid=K.A.clone(r,n._ellipsoid),n._vertexFormat=Rr.A.clone(s,n._vertexFormat),n._width=a,n._height=c,n._extrudedHeight=u,n._cornerType=h,n._granularity=A,n._shadowVolume=p,n._offsetAttribute=-1===f?void 0:f,n):(is.positions=o,is.width=a,is.height=c,is.extrudedHeight=u,is.cornerType=h,is.granularity=A,is.shadowVolume=p,is.offsetAttribute=-1===f?void 0:f,new es(is))},es.computeRectangle=function(e,t){const n=(e=e??S.A.EMPTY_OBJECT).positions,i=e.width;return l.A.defined("options.positions",n),l.A.defined("options.width",i),Zr(n,e.ellipsoid??K.A.default,i,e.cornerType??_o.ROUNDED,t)},es.createGeometry=function(e){let t=e._positions;const n=e._width,i=e._ellipsoid;t=zr(t,i);const o=(0,go.A)(t,j.A.equalsEpsilon);if(o.length<2||n<=0)return;const r=e._height,s=e._extrudedHeight,a=!J.A.equalsEpsilon(r,s,0,J.A.EPSILON2),c=e._vertexFormat,l={ellipsoid:i,positions:o,width:n,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!0};let u;if(a)l.height=r,l.extrudedHeight=s,l.shadowVolume=e._shadowVolume,l.offsetAttribute=e._offsetAttribute,u=function(e,t){const n=new Rr.A({position:t.position,normal:t.normal||t.bitangent||e.shadowVolume,tangent:t.tangent,bitangent:t.normal||t.bitangent,st:t.st}),i=e.ellipsoid,o=Gr(Sr.computePositions(e),n,i),r=e.height,s=e.extrudedHeight;let a=o.attributes;const c=o.indices;let l=a.position.values,u=l.length;const h=new Float64Array(6*u);let A=new Float64Array(u);A.set(l);let p,f=new Float64Array(4*u);l=Dr.A.scaleToGeodeticHeight(l,r,i),f=Wr(l,0,f),A=Dr.A.scaleToGeodeticHeight(A,s,i),f=Wr(A,2*u,f),h.set(l),h.set(A,u),h.set(f,2*u),a.position.values=h,a=function(e,t){if(!(t.normal||t.tangent||t.bitangent||t.st))return e;const n=e.position.values;let i,o;(t.normal||t.bitangent)&&(i=e.normal.values,o=e.bitangent.values);const r=e.position.values.length/18,s=3*r,a=2*r,c=2*s;let l;if(t.normal||t.bitangent||t.tangent){const r=t.normal?new Float32Array(6*s):void 0,a=t.tangent?new Float32Array(6*s):void 0,u=t.bitangent?new Float32Array(6*s):void 0;let d=Mr,h=Lr,A=Nr,p=Br,f=Fr,m=Ur,g=c;for(l=0;l<s;l+=3){const e=g+c;d=j.A.fromArray(n,l,d),h=j.A.fromArray(n,l+s,h),A=j.A.fromArray(n,(l+3)%s,A),h=j.A.subtract(h,d,h),A=j.A.subtract(A,d,A),p=j.A.normalize(j.A.cross(h,A,p),p),t.normal&&(Sr.addAttribute(r,p,e),Sr.addAttribute(r,p,e+3),Sr.addAttribute(r,p,g),Sr.addAttribute(r,p,g+3)),(t.tangent||t.bitangent)&&(m=j.A.fromArray(i,l,m),t.bitangent&&(Sr.addAttribute(u,m,e),Sr.addAttribute(u,m,e+3),Sr.addAttribute(u,m,g),Sr.addAttribute(u,m,g+3)),t.tangent&&(f=j.A.normalize(j.A.cross(m,p,f),f),Sr.addAttribute(a,f,e),Sr.addAttribute(a,f,e+3),Sr.addAttribute(a,f,g),Sr.addAttribute(a,f,g+3))),g+=6}if(t.normal){for(r.set(i),l=0;l<s;l+=3)r[l+s]=-i[l],r[l+s+1]=-i[l+1],r[l+s+2]=-i[l+2];e.normal.values=r}else e.normal=void 0;if(t.bitangent?(u.set(o),u.set(o,s),e.bitangent.values=u):e.bitangent=void 0,t.tangent){const t=e.tangent.values;a.set(t),a.set(t,s),e.tangent.values=a}}if(t.st){const t=e.st.values,n=new Float32Array(6*a);n.set(t),n.set(t,a);let i=2*a;for(let e=0;e<2;e++){for(n[i++]=t[0],n[i++]=t[1],l=2;l<a;l+=2){const e=t[l],o=t[l+1];n[i++]=e,n[i++]=o,n[i++]=e,n[i++]=o}n[i++]=t[0],n[i++]=t[1]}e.st.values=n}return e}(a,t);const m=u/3;if(e.shadowVolume){const e=a.normal.values;u=e.length;let n=new Float32Array(6*u);for(p=0;p<u;p++)e[p]=-e[p];n.set(e,u),n=Wr(e,4*u,n),a.extrudeDirection=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:n}),t.normal||(a.normal=void 0)}if((0,d.A)(e.offsetAttribute)){let t=new Uint8Array(6*m);if(e.offsetAttribute===vn.A.TOP)t=t.fill(1,0,m).fill(1,2*m,4*m);else{const n=e.offsetAttribute===vn.A.NONE?0:1;t=t.fill(n)}a.applyOffset=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}const g=c.length,_=m+m,y=Pr.A.createTypedArray(h.length/3,2*g+3*_);y.set(c);let v,T,b,w,x=g;for(p=0;p<g;p+=3){const e=c[p],t=c[p+1],n=c[p+2];y[x++]=n+m,y[x++]=t+m,y[x++]=e+m}for(p=0;p<_;p+=2)v=p+_,T=v+_,b=v+1,w=T+1,y[x++]=v,y[x++]=T,y[x++]=b,y[x++]=b,y[x++]=T,y[x++]=w;return{attributes:a,indices:y}}(l,c);else if(u=Gr(Sr.computePositions(l),c,i),u.attributes.position.values=Dr.A.scaleToGeodeticHeight(u.attributes.position.values,r,i),(0,d.A)(e._offsetAttribute)){const t=e._offsetAttribute===vn.A.NONE?0:1,n=u.attributes.position.values.length,i=new Uint8Array(n/3).fill(t);u.attributes.applyOffset=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}const h=u.attributes,A=Sn.A.fromVertices(h.position.values,void 0,3);return c.position||(u.attributes.position.values=void 0),new I.A({attributes:h,indices:u.indices,primitiveType:p.A.TRIANGLES,boundingSphere:A,offsetAttribute:e._offsetAttribute})},es.createShadowVolume=function(e,t,n){const i=e._granularity,o=e._ellipsoid,r=t(i,o),s=n(i,o);return new es({positions:e._positions,width:e._width,cornerType:e._cornerType,ellipsoid:o,granularity:i,extrudedHeight:r,height:s,vertexFormat:Rr.A.POSITION_ONLY,shadowVolume:!0})},Object.defineProperties(es.prototype,{rectangle:{get:function(){return(0,d.A)(this._rectangle)||(this._rectangle=Zr(this._positions,this._ellipsoid,this._width,this._cornerType)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return[0,0,0,1,1,0]}}});const os=es,rs=new j.A,ss=new j.A,as=new j.A;function cs(e,t){const n=[],i=e.positions,o=e.corners,r=e.endPositions,s=new Ir.A;let a,c,l,u=0,h=0,A=0;for(c=0;c<i.length;c+=2)l=i[c].length-3,u+=l,A+=l/3*4,h+=i[c+1].length-3;for(u+=3,h+=3,c=0;c<o.length;c++){a=o[c];const e=o[c].leftPositions;(0,d.A)(e)?(l=e.length,u+=l,A+=l/3*2):(l=o[c].rightPositions.length,h+=l,A+=l/3*2)}const p=(0,d.A)(r);let f;p&&(f=r[0].length-3,u+=f,h+=f,f/=3,A+=4*f);const m=u+h,g=new Float64Array(m);let _,y,v,T,b,w,x=0,E=m-1;const S=f/2,I=Pr.A.createTypedArray(m/3,A+4);let D=0;if(I[D++]=x/3,I[D++]=(E-2)/3,p){n.push(x/3),w=rs,b=ss;const e=r[0];for(c=0;c<S;c++)w=j.A.fromArray(e,3*(S-1-c),w),b=j.A.fromArray(e,3*(S+c),b),Sr.addAttribute(g,b,x),Sr.addAttribute(g,w,void 0,E),y=x/3,T=y+1,_=(E-2)/3,v=_-1,I[D++]=_,I[D++]=v,I[D++]=y,I[D++]=T,x+=3,E-=3}let O=0,R=i[O++],M=i[O++];for(g.set(R,x),g.set(M,E-M.length+1),l=M.length-3,n.push(x/3,(E-2)/3),c=0;c<l;c+=3)y=x/3,T=y+1,_=(E-2)/3,v=_-1,I[D++]=_,I[D++]=v,I[D++]=y,I[D++]=T,x+=3,E-=3;for(c=0;c<o.length;c++){let e;a=o[c];const r=a.leftPositions,s=a.rightPositions;let u,h=as;if((0,d.A)(r)){for(E-=3,u=v,n.push(T),e=0;e<r.length/3;e++)h=j.A.fromArray(r,3*e,h),I[D++]=u-e-1,I[D++]=u-e,Sr.addAttribute(g,h,void 0,E),E-=3;n.push(u-Math.floor(r.length/6)),t===_o.BEVELED&&n.push((E-2)/3+1),x+=3}else{for(x+=3,u=T,n.push(v),e=0;e<s.length/3;e++)h=j.A.fromArray(s,3*e,h),I[D++]=u+e,I[D++]=u+e+1,Sr.addAttribute(g,h,x),x+=3;n.push(u+Math.floor(s.length/6)),t===_o.BEVELED&&n.push(x/3-1),E-=3}for(R=i[O++],M=i[O++],R.splice(0,3),M.splice(M.length-3,3),g.set(R,x),g.set(M,E-M.length+1),l=M.length-3,e=0;e<M.length;e+=3)T=x/3,y=T-1,v=(E-2)/3,_=v+1,I[D++]=_,I[D++]=v,I[D++]=y,I[D++]=T,x+=3,E-=3;x-=3,E+=3,n.push(x/3,(E-2)/3)}if(p){x+=3,E-=3,w=rs,b=ss;const e=r[1];for(c=0;c<S;c++)w=j.A.fromArray(e,3*(f-c-1),w),b=j.A.fromArray(e,3*c,b),Sr.addAttribute(g,w,void 0,E),Sr.addAttribute(g,b,x),T=x/3,y=T-1,v=(E-2)/3,_=v+1,I[D++]=_,I[D++]=v,I[D++]=y,I[D++]=T,x+=3,E-=3;n.push(x/3)}else n.push(x/3,(E-2)/3);return I[D++]=x/3,I[D++]=(E-2)/3,s.position=new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:g}),{attributes:s,indices:I,wallIndices:n}}function ls(e){const t=(e=e??S.A.EMPTY_OBJECT).positions,n=e.width;l.A.typeOf.object("options.positions",t),l.A.typeOf.number("options.width",n);const i=e.height??0,o=e.extrudedHeight??i;this._positions=t,this._ellipsoid=K.A.clone(e.ellipsoid??K.A.default),this._width=n,this._height=Math.max(i,o),this._extrudedHeight=Math.min(i,o),this._cornerType=e.cornerType??_o.ROUNDED,this._granularity=e.granularity??J.A.RADIANS_PER_DEGREE,this._offsetAttribute=e.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+t.length*j.A.packedLength+K.A.packedLength+6}ls.pack=function(e,t,n){l.A.typeOf.object("value",e),l.A.typeOf.object("array",t),n=n??0;const i=e._positions,o=i.length;t[n++]=o;for(let e=0;e<o;++e,n+=j.A.packedLength)j.A.pack(i[e],t,n);return K.A.pack(e._ellipsoid,t,n),n+=K.A.packedLength,t[n++]=e._width,t[n++]=e._height,t[n++]=e._extrudedHeight,t[n++]=e._cornerType,t[n++]=e._granularity,t[n]=e._offsetAttribute??-1,t};const us=K.A.clone(K.A.UNIT_SPHERE),ds={positions:void 0,ellipsoid:us,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};ls.unpack=function(e,t,n){l.A.typeOf.object("array",e),t=t??0;const i=e[t++],o=new Array(i);for(let n=0;n<i;++n,t+=j.A.packedLength)o[n]=j.A.unpack(e,t);const r=K.A.unpack(e,t,us);t+=K.A.packedLength;const s=e[t++],a=e[t++],c=e[t++],u=e[t++],h=e[t++],A=e[t];return(0,d.A)(n)?(n._positions=o,n._ellipsoid=K.A.clone(r,n._ellipsoid),n._width=s,n._height=a,n._extrudedHeight=c,n._cornerType=u,n._granularity=h,n._offsetAttribute=-1===A?void 0:A,n):(ds.positions=o,ds.width=s,ds.height=a,ds.extrudedHeight=c,ds.cornerType=u,ds.granularity=h,ds.offsetAttribute=-1===A?void 0:A,new ls(ds))},ls.createGeometry=function(e){let t=e._positions;const n=e._width,i=e._ellipsoid;t=function(e,t){for(let n=0;n<e.length;n++)e[n]=t.scaleToGeodeticSurface(e[n],e[n]);return e}(t,i);const o=(0,go.A)(t,j.A.equalsEpsilon);if(o.length<2||n<=0)return;const r=e._height,s=e._extrudedHeight,a=!J.A.equalsEpsilon(r,s,0,J.A.EPSILON2),c={ellipsoid:i,positions:o,width:n,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!1};let l;if(a)c.height=r,c.extrudedHeight=s,c.offsetAttribute=e._offsetAttribute,l=function(e){const t=e.ellipsoid,n=cs(Sr.computePositions(e),e.cornerType),i=n.wallIndices,o=e.height,r=e.extrudedHeight,s=n.attributes,a=n.indices;let c=s.position.values,l=c.length,u=new Float64Array(l);u.set(c);const h=new Float64Array(2*l);if(c=Dr.A.scaleToGeodeticHeight(c,o,t),u=Dr.A.scaleToGeodeticHeight(u,r,t),h.set(c),h.set(u,l),s.position.values=h,l/=3,(0,d.A)(e.offsetAttribute)){let t=new Uint8Array(2*l);if(e.offsetAttribute===vn.A.TOP)t=t.fill(1,0,l);else{const n=e.offsetAttribute===vn.A.NONE?0:1;t=t.fill(n)}s.applyOffset=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}let A;const p=a.length,f=Pr.A.createTypedArray(h.length/3,2*(p+i.length));f.set(a);let m,g,_=p;for(A=0;A<p;A+=2){const e=a[A],t=a[A+1];f[_++]=e+l,f[_++]=t+l}for(A=0;A<i.length;A++)m=i[A],g=m+l,f[_++]=m,f[_++]=g;return{attributes:s,indices:f}}(c);else if(l=cs(Sr.computePositions(c),c.cornerType),l.attributes.position.values=Dr.A.scaleToGeodeticHeight(l.attributes.position.values,r,i),(0,d.A)(e._offsetAttribute)){const t=l.attributes.position.values.length,n=e._offsetAttribute===vn.A.NONE?0:1,i=new Uint8Array(t/3).fill(n);l.attributes.applyOffset=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}const u=l.attributes,h=Sn.A.fromVertices(u.position.values,void 0,3);return new I.A({attributes:u,indices:l.indices,primitiveType:p.A.LINES,boundingSphere:h,offsetAttribute:e._offsetAttribute})};const hs=ls,As=new Vn.A(0);function ps(e){$n.call(this,e),this._zIndex=0,this._terrainOffsetProperty=void 0}(0,d.A)(Object.create)&&(ps.prototype=Object.create($n.prototype),ps.prototype.constructor=ps),Object.defineProperties(ps.prototype,{zIndex:{get:function(){return this._zIndex}},terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),ps.prototype._isOnTerrain=function(e,t){return this._fillEnabled&&!(0,d.A)(t.height)&&!(0,d.A)(t.extrudedHeight)&&In.A.isSupported(this._scene)},ps.prototype._getIsClosed=function(e){const t=e.height,n=e.extrudedHeight;return 0===t||(0,d.A)(n)&&n!==t},ps.prototype._computeCenter=A.A.throwInstantiationError,ps.prototype._onEntityPropertyChanged=function(e,t,n,i){if($n.prototype._onEntityPropertyChanged.call(this,e,t,n,i),-1===this._observedPropertyNames.indexOf(t))return;const o=this._entity[this._geometryPropertyName];if(!(0,d.A)(o))return;(0,d.A)(o.zIndex)&&((0,d.A)(o.height)||(0,d.A)(o.extrudedHeight))&&(0,Fn.A)(Fn.A.geometryZIndex),this._zIndex=o.zIndex??As,(0,d.A)(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);const r=o.heightReference,s=o.extrudedHeightReference;if((0,d.A)(r)||(0,d.A)(s)){const e=new Jn.A(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new ni(this._scene,e,r,s)}},ps.prototype.destroy=function(){(0,d.A)(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0),$n.prototype.destroy.call(this)},ps.getGeometryHeight=function(e,t){if(l.A.defined("heightReference",t),(0,d.A)(e))return(0,Vt.w_)(t)?0:e;t!==Vt.Ay.NONE&&(0,Fn.A)(Fn.A.geometryHeightReference)},ps.getGeometryExtrudedHeight=function(e,t){if(l.A.defined("extrudedHeightReference",t),(0,d.A)(e))return(0,Vt.w_)(t)?ps.CLAMP_TO_GROUND:e;t!==Vt.Ay.NONE&&(0,Fn.A)(Fn.A.geometryExtrudedHeightReference)},ps.CLAMP_TO_GROUND="clamp",ps.computeGeometryOffsetAttribute=function(e,t,n,i){(0,d.A)(e)&&(0,d.A)(t)||(t=Vt.Ay.NONE),(0,d.A)(n)&&(0,d.A)(i)||(i=Vt.Ay.NONE);let o=0;return t!==Vt.Ay.NONE&&o++,i===Vt.Ay.RELATIVE_TO_GROUND&&o++,2===o?vn.A.ALL:1===o?vn.A.TOP:void 0};const fs=ps,ms=new u.A,gs=j.A.ZERO,_s=new j.A,ys=new Or.A;function vs(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.cornerType=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.offsetAttribute=void 0}function Ts(e,t){fs.call(this,{entity:e,scene:t,geometryOptions:new vs(e),geometryPropertyName:"corridor",observedPropertyNames:["availability","corridor"]}),this._onEntityPropertyChanged(e,"corridor",e.corridor,void 0)}function bs(e,t,n){Nn.call(this,e,t,n)}(0,d.A)(Object.create)&&(Ts.prototype=Object.create(fs.prototype),Ts.prototype.constructor=Ts),Ts.prototype.createFillGeometryInstance=function(e){if(l.A.defined("time",e),!this._fillEnabled)throw new A.A("This instance does not represent a filled geometry.");const t=this._entity,n=t.isAvailable(e),i={show:new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:_n.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof En.A){let t;(0,d.A)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,ms)),(0,d.A)(t)||(t=u.A.WHITE),i.color=mn.A.fromColor(t)}return(0,d.A)(this._options.offsetAttribute)&&(i.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,gs,_s))),new yn.A({id:t,geometry:new os(this._options),attributes:i})},Ts.prototype.createOutlineGeometryInstance=function(e){if(l.A.defined("time",e),!this._outlineEnabled)throw new A.A("This instance does not represent an outlined geometry.");const t=this._entity,n=t.isAvailable(e),i=Wt.A.getValueOrDefault(this._outlineColorProperty,e,u.A.BLACK,ms),o={show:new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:mn.A.fromColor(i),distanceDisplayCondition:_n.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0};return(0,d.A)(this._options.offsetAttribute)&&(o.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,gs,_s))),new yn.A({id:t,geometry:new hs(this._options),attributes:o})},Ts.prototype._computeCenter=function(e,t){const n=Wt.A.getValueOrUndefined(this._entity.corridor.positions,e);if((0,d.A)(n)&&0!==n.length)return j.A.clone(n[Math.floor(n.length/2)],t)},Ts.prototype._isHidden=function(e,t){return!(0,d.A)(t.positions)||!(0,d.A)(t.width)||$n.prototype._isHidden.call(this,e,t)},Ts.prototype._isDynamic=function(e,t){return!t.positions.isConstant||!Wt.A.isConstant(t.height)||!Wt.A.isConstant(t.extrudedHeight)||!Wt.A.isConstant(t.granularity)||!Wt.A.isConstant(t.width)||!Wt.A.isConstant(t.outlineWidth)||!Wt.A.isConstant(t.cornerType)||!Wt.A.isConstant(t.zIndex)||this._onTerrain&&!Wt.A.isConstant(this._materialProperty)&&!(this._materialProperty instanceof En.A)},Ts.prototype._setStaticOptions=function(e,t){let n=Wt.A.getValueOrUndefined(t.height,Tn.A.MINIMUM_VALUE);const i=Wt.A.getValueOrDefault(t.heightReference,Tn.A.MINIMUM_VALUE,Vt.Ay.NONE);let o=Wt.A.getValueOrUndefined(t.extrudedHeight,Tn.A.MINIMUM_VALUE);const r=Wt.A.getValueOrDefault(t.extrudedHeightReference,Tn.A.MINIMUM_VALUE,Vt.Ay.NONE);(0,d.A)(o)&&!(0,d.A)(n)&&(n=0);const s=this._options;s.vertexFormat=this._materialProperty instanceof En.A?Cn.A.VERTEX_FORMAT:xn.A.MaterialSupport.TEXTURED.vertexFormat,s.positions=t.positions.getValue(Tn.A.MINIMUM_VALUE,s.positions),s.width=t.width.getValue(Tn.A.MINIMUM_VALUE),s.granularity=Wt.A.getValueOrUndefined(t.granularity,Tn.A.MINIMUM_VALUE),s.cornerType=Wt.A.getValueOrUndefined(t.cornerType,Tn.A.MINIMUM_VALUE),s.offsetAttribute=fs.computeGeometryOffsetAttribute(n,i,o,r),s.height=fs.getGeometryHeight(n,i),o=fs.getGeometryExtrudedHeight(o,r),o===fs.CLAMP_TO_GROUND&&(o=mo.A.getMinimumMaximumHeights(os.computeRectangle(s,ys)).minimumTerrainHeight),s.extrudedHeight=o},Ts.DynamicGeometryUpdater=bs,(0,d.A)(Object.create)&&(bs.prototype=Object.create(Nn.prototype),bs.prototype.constructor=bs),bs.prototype._isHidden=function(e,t,n){const i=this._options;return!(0,d.A)(i.positions)||!(0,d.A)(i.width)||Nn.prototype._isHidden.call(this,e,t,n)},bs.prototype._setOptions=function(e,t,n){const i=this._options;let o=Wt.A.getValueOrUndefined(t.height,n);const r=Wt.A.getValueOrDefault(t.heightReference,n,Vt.Ay.NONE);let s=Wt.A.getValueOrUndefined(t.extrudedHeight,n);const a=Wt.A.getValueOrDefault(t.extrudedHeightReference,n,Vt.Ay.NONE);(0,d.A)(s)&&!(0,d.A)(o)&&(o=0),i.positions=Wt.A.getValueOrUndefined(t.positions,n),i.width=Wt.A.getValueOrUndefined(t.width,n),i.granularity=Wt.A.getValueOrUndefined(t.granularity,n),i.cornerType=Wt.A.getValueOrUndefined(t.cornerType,n),i.offsetAttribute=fs.computeGeometryOffsetAttribute(o,r,s,a),i.height=fs.getGeometryHeight(o,r),s=fs.getGeometryExtrudedHeight(s,a),s===fs.CLAMP_TO_GROUND&&(s=mo.A.getMinimumMaximumHeights(os.computeRectangle(i,ys)).minimumTerrainHeight),i.extrudedHeight=s};const ws=Ts;var xs=n(779675),Cs=n(755394),Es=n(317061),Ss=n(302982);const Is=new q.A;function Ps(e){const t=(e=e??S.A.EMPTY_OBJECT).length,n=e.topRadius,i=e.bottomRadius,o=e.slices??128,r=Math.max(e.numberOfVerticalLines??16,0);if(l.A.typeOf.number("options.positions",t),l.A.typeOf.number("options.topRadius",n),l.A.typeOf.number("options.bottomRadius",i),l.A.typeOf.number.greaterThanOrEquals("options.slices",o,3),(0,d.A)(e.offsetAttribute)&&e.offsetAttribute===vn.A.TOP)throw new A.A("GeometryOffsetAttribute.TOP is not a supported options.offsetAttribute for this geometry.");this._length=t,this._topRadius=n,this._bottomRadius=i,this._slices=o,this._numberOfVerticalLines=r,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderOutlineGeometry"}Ps.packedLength=6,Ps.pack=function(e,t,n){return l.A.typeOf.object("value",e),l.A.defined("array",t),n=n??0,t[n++]=e._length,t[n++]=e._topRadius,t[n++]=e._bottomRadius,t[n++]=e._slices,t[n++]=e._numberOfVerticalLines,t[n]=e._offsetAttribute??-1,t};const Ds={length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};Ps.unpack=function(e,t,n){l.A.defined("array",e),t=t??0;const i=e[t++],o=e[t++],r=e[t++],s=e[t++],a=e[t++],c=e[t];return(0,d.A)(n)?(n._length=i,n._topRadius=o,n._bottomRadius=r,n._slices=s,n._numberOfVerticalLines=a,n._offsetAttribute=-1===c?void 0:c,n):(Ds.length=i,Ds.topRadius=o,Ds.bottomRadius=r,Ds.slices=s,Ds.numberOfVerticalLines=a,Ds.offsetAttribute=-1===c?void 0:c,new Ps(Ds))},Ps.createGeometry=function(e){let t=e._length;const n=e._topRadius,i=e._bottomRadius,o=e._slices,r=e._numberOfVerticalLines;if(t<=0||n<0||i<0||0===n&&0===i)return;const s=2*o,a=Ss.A.computePositions(t,n,i,o,!1);let c,l=2*o;if(r>0){const e=Math.min(r,o);c=Math.round(o/e),l+=e}const u=Pr.A.createTypedArray(s,2*l);let h,A=0;for(h=0;h<o-1;h++)u[A++]=h,u[A++]=h+1,u[A++]=h+o,u[A++]=h+1+o;if(u[A++]=o-1,u[A++]=0,u[A++]=o+o-1,u[A++]=o,r>0)for(h=0;h<o;h+=c)u[A++]=h,u[A++]=h+o;const f=new Ir.A;f.position=new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:a}),Is.x=.5*t,Is.y=Math.max(i,n);const m=new Sn.A(j.A.ZERO,q.A.magnitude(Is));if((0,d.A)(e._offsetAttribute)){t=a.length;const n=e._offsetAttribute===vn.A.NONE?0:1,i=new Uint8Array(t/3).fill(n);f.applyOffset=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}return new I.A({attributes:f,indices:u,primitiveType:p.A.LINES,boundingSphere:m,offsetAttribute:e._offsetAttribute})};const Os=Ps,Rs=j.A.ZERO,Ms=new j.A,Ls=new j.A,Ns=new u.A;function Bs(e){this.id=e,this.vertexFormat=void 0,this.length=void 0,this.topRadius=void 0,this.bottomRadius=void 0,this.slices=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function Fs(e,t){$n.call(this,{entity:e,scene:t,geometryOptions:new Bs(e),geometryPropertyName:"cylinder",observedPropertyNames:["availability","position","orientation","cylinder"]}),this._onEntityPropertyChanged(e,"cylinder",e.cylinder,void 0)}function Us(e,t,n){Nn.call(this,e,t,n)}(0,d.A)(Object.create)&&(Fs.prototype=Object.create($n.prototype),Fs.prototype.constructor=Fs),Object.defineProperties(Fs.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),Fs.prototype.createFillGeometryInstance=function(e){if(l.A.defined("time",e),!this._fillEnabled)throw new A.A("This instance does not represent a filled geometry.");const t=this._entity,n=t.isAvailable(e),i=new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),r={show:i,distanceDisplayCondition:_n.fromDistanceDisplayCondition(o),color:void 0,offset:void 0};if(this._materialProperty instanceof En.A){let t;(0,d.A)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,Ns)),(0,d.A)(t)||(t=u.A.WHITE),r.color=mn.A.fromColor(t)}return(0,d.A)(this._options.offsetAttribute)&&(r.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,Rs,Ms))),new yn.A({id:t,geometry:new Es.A(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.cylinder.heightReference,.5*this._options.length,this._scene.ellipsoid),attributes:r})},Fs.prototype.createOutlineGeometryInstance=function(e){if(l.A.defined("time",e),!this._outlineEnabled)throw new A.A("This instance does not represent an outlined geometry.");const t=this._entity,n=t.isAvailable(e),i=Wt.A.getValueOrDefault(this._outlineColorProperty,e,u.A.BLACK,Ns),o=this._distanceDisplayConditionProperty.getValue(e),r={show:new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:mn.A.fromColor(i),distanceDisplayCondition:_n.fromDistanceDisplayCondition(o),offset:void 0};return(0,d.A)(this._options.offsetAttribute)&&(r.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,Rs,Ms))),new yn.A({id:t,geometry:new Os(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.cylinder.heightReference,.5*this._options.length,this._scene.ellipsoid),attributes:r})},Fs.prototype._computeCenter=function(e,t){return Wt.A.getValueOrUndefined(this._entity.position,e,t)},Fs.prototype._isHidden=function(e,t){return!(0,d.A)(e.position)||!(0,d.A)(t.length)||!(0,d.A)(t.topRadius)||!(0,d.A)(t.bottomRadius)||$n.prototype._isHidden.call(this,e,t)},Fs.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&Wt.A.isConstant(e.orientation)&&t.length.isConstant&&t.topRadius.isConstant&&t.bottomRadius.isConstant&&Wt.A.isConstant(t.slices)&&Wt.A.isConstant(t.outlineWidth)&&Wt.A.isConstant(t.numberOfVerticalLines))},Fs.prototype._setStaticOptions=function(e,t){const n=Wt.A.getValueOrDefault(t.heightReference,Tn.A.MINIMUM_VALUE,Vt.Ay.NONE),i=this._options;i.vertexFormat=this._materialProperty instanceof En.A?Cn.A.VERTEX_FORMAT:xn.A.MaterialSupport.TEXTURED.vertexFormat,i.length=t.length.getValue(Tn.A.MINIMUM_VALUE),i.topRadius=t.topRadius.getValue(Tn.A.MINIMUM_VALUE),i.bottomRadius=t.bottomRadius.getValue(Tn.A.MINIMUM_VALUE),i.slices=Wt.A.getValueOrUndefined(t.slices,Tn.A.MINIMUM_VALUE),i.numberOfVerticalLines=Wt.A.getValueOrUndefined(t.numberOfVerticalLines,Tn.A.MINIMUM_VALUE),i.offsetAttribute=n!==Vt.Ay.NONE?vn.A.ALL:void 0},Fs.prototype._onEntityPropertyChanged=ii,Fs.DynamicGeometryUpdater=Us,(0,d.A)(Object.create)&&(Us.prototype=Object.create(Nn.prototype),Us.prototype.constructor=Us),Us.prototype._isHidden=function(e,t,n){const i=this._options,o=Wt.A.getValueOrUndefined(e.position,n,Ls);return!(0,d.A)(o)||!(0,d.A)(i.length)||!(0,d.A)(i.topRadius)||!(0,d.A)(i.bottomRadius)||Nn.prototype._isHidden.call(this,e,t,n)},Us.prototype._setOptions=function(e,t,n){const i=Wt.A.getValueOrDefault(t.heightReference,n,Vt.Ay.NONE),o=this._options;o.length=Wt.A.getValueOrUndefined(t.length,n),o.topRadius=Wt.A.getValueOrUndefined(t.topRadius,n),o.bottomRadius=Wt.A.getValueOrUndefined(t.bottomRadius,n),o.slices=Wt.A.getValueOrUndefined(t.slices,n),o.numberOfVerticalLines=Wt.A.getValueOrUndefined(t.numberOfVerticalLines,n),o.offsetAttribute=i!==Vt.Ay.NONE?vn.A.ALL:void 0};const ks=Fs;var Vs=n(881679),zs=n(215327);const Hs=Object.freeze({UNBOUNDED:0,CLAMPED:1,LOOP_STOP:2}),Gs=Object.freeze({TICK_DEPENDENT:0,SYSTEM_CLOCK_MULTIPLIER:1,SYSTEM_CLOCK:2});var Ws=n(607502);const Ys=Object.freeze({NONE:0,HOLD:1,EXTRAPOLATE:2});var qs=n(3858);const js=J.A.factorial;function Qs(e,t,n,i,o,r){let s,a,c,l=0;if(i>0){for(a=0;a<o;a++){for(s=!1,c=0;c<r.length&&!s;c++)a===r[c]&&(s=!0);s||(r.push(a),l+=Qs(e,t,n,i-1,o,r),r.splice(r.length-1,1))}return l}for(l=1,a=0;a<o;a++){for(s=!1,c=0;c<r.length&&!s;c++)a===r[c]&&(s=!0);s||(l*=e-n[t[a]])}return l}const Xs={type:"Hermite",getRequiredDataPoints:function(e,t){if(t=t??0,!(0,d.A)(e))throw new A.A("degree is required.");if(e<0)throw new A.A("degree must be 0 or greater.");if(t<0)throw new A.A("inputOrder must be 0 or greater.");return Math.max(Math.floor((e+1)/(t+1)),2)},interpolateOrderZero:function(e,t,n,i,o){let r,s,a,c,l,u;(0,d.A)(o)||(o=new Array(i));const h=t.length,A=new Array(i);for(r=0;r<i;r++){o[r]=0;const e=new Array(h);for(A[r]=e,s=0;s<h;s++)e[s]=[]}const p=h,f=new Array(p);for(r=0;r<p;r++)f[r]=r;let m=h-1;for(c=0;c<i;c++){for(s=0;s<p;s++)u=f[s]*i+c,A[c][0].push(n[u]);for(r=1;r<p;r++){let e=!1;for(s=0;s<p-r;s++){const o=t[f[s]],a=t[f[s+r]];let l;a-o<=0?(u=f[s]*i+i*r+c,l=n[u],A[c][r].push(l/js(r))):(l=A[c][r-1][s+1]-A[c][r-1][s],A[c][r].push(l/(a-o))),e=e||0!==l}e||(m=r-1)}}for(a=0,l=0;a<=0;a++)for(r=a;r<=m;r++){const n=Qs(e,f,t,a,r,[]);for(c=0;c<i;c++){const e=A[c][r][0];o[c+a*i]+=e*n}}return o}},Ks=[];Xs.interpolate=function(e,t,n,i,o,r,s){const a=i*(r+1);(0,d.A)(s)||(s=new Array(a));for(let e=0;e<a;e++)s[e]=0;const c=t.length,l=new Array(c*(o+1));let u;for(u=0;u<c;u++)for(let e=0;e<o+1;e++)l[u*(o+1)+e]=u;const h=l.length,A=Ks,p=function(e,t,n,i,o,r){let s,a,c=-1;const l=t.length,u=l*(l+1)/2;for(let d=0;d<o;d++){const h=Math.floor(d*u);for(s=0;s<l;s++)a=t[s]*o*(r+1)+d,e[h+s]=i[a];for(let u=1;u<l;u++){let A=0;const p=Math.floor(u*(1-u)/2)+l*u;let f=!1;for(s=0;s<l-u;s++){const c=n[t[s]],m=n[t[s+u]];let g,_;if(m-c<=0)a=t[s]*o*(r+1)+o*u+d,g=i[a],_=g/J.A.factorial(u),e[h+p+A]=_,A++;else{const t=Math.floor((u-1)*(2-u)/2)+l*(u-1);g=e[h+t+s+1]-e[h+t+s],_=g/(m-c),e[h+p+A]=_,A++}f=f||0!==g}f&&(c=Math.max(c,u))}}return c}(A,l,t,n,i,o),f=[],m=h*(h+1)/2,g=Math.min(p,r);for(let n=0;n<=g;n++)for(u=n;u<=p;u++){f.length=0;const o=Qs(e,l,t,n,u,f),r=Math.floor(u*(1-u)/2)+h*u;for(let e=0;e<i;e++){const t=A[Math.floor(e*m)+r];s[e+n*i]+=t*o}}return s};const $s=Xs,Js={type:"Lagrange",getRequiredDataPoints:function(e){return Math.max(e+1,2)},interpolateOrderZero:function(e,t,n,i,o){let r,s;(0,d.A)(o)||(o=new Array(i));const a=t.length;for(r=0;r<i;r++)o[r]=0;for(r=0;r<a;r++){let c=1;for(s=0;s<a;s++)if(s!==r){const n=t[r]-t[s];c*=(e-t[s])/n}for(s=0;s<i;s++)o[s]+=c*n[r*i+s]}return o}},Zs={type:"Linear",getRequiredDataPoints:function(e){return 2},interpolateOrderZero:function(e,t,n,i,o){if(2!==t.length)throw new A.A("The xTable provided to the linear interpolator must have exactly two elements.");if(i<=0)throw new A.A("There must be at least 1 dependent variable for each independent variable.");let r,s,a;(0,d.A)(o)||(o=new Array(i));const c=t[0],l=t[1];if(c===l)throw new A.A("Divide by zero error: xTable[0] and xTable[1] are equal");for(r=0;r<i;r++)s=n[r],a=n[r+i],o[r]=((a-s)*e+l*s-c*a)/(l-c);return o}};var ea=n(105330);function ta(e,t,n){this.clock=e??0,this.cone=t??0,this.magnitude=n??1}ta.fromCartesian3=function(e,t){l.A.typeOf.object("cartesian3",e);const n=e.x,i=e.y,o=e.z,r=n*n+i*i;return(0,d.A)(t)||(t=new ta),t.clock=Math.atan2(i,n),t.cone=Math.atan2(Math.sqrt(r),o),t.magnitude=Math.sqrt(r+o*o),t},ta.clone=function(e,t){if((0,d.A)(e))return(0,d.A)(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=e.magnitude,t):new ta(e.clock,e.cone,e.magnitude)},ta.normalize=function(e,t){return l.A.typeOf.object("spherical",e),(0,d.A)(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=1,t):new ta(e.clock,e.cone,1)},ta.equals=function(e,t){return e===t||(0,d.A)(e)&&(0,d.A)(t)&&e.clock===t.clock&&e.cone===t.cone&&e.magnitude===t.magnitude},ta.equalsEpsilon=function(e,t,n){return n=n??0,e===t||(0,d.A)(e)&&(0,d.A)(t)&&Math.abs(e.clock-t.clock)<=n&&Math.abs(e.cone-t.cone)<=n&&Math.abs(e.magnitude-t.magnitude)<=n},ta.prototype.equals=function(e){return ta.equals(this,e)},ta.prototype.clone=function(e){return ta.clone(this,e)},ta.prototype.equalsEpsilon=function(e,t){return ta.equalsEpsilon(this,e,t)},ta.prototype.toString=function(){return`(${this.clock}, ${this.cone}, ${this.magnitude})`};const na=ta;var ia=n(428027),oa=n(15817),ra=n(484193),sa=n(367725),aa=n(230259);function ca(e){let t=(e=e??S.A.EMPTY_OBJECT).currentTime,n=e.startTime,i=e.stopTime;if(t=(0,d.A)(t)?te.A.clone(t):(0,d.A)(n)?te.A.clone(n):(0,d.A)(i)?te.A.addDays(i,-1,new te.A):te.A.now(),n=(0,d.A)(n)?te.A.clone(n):te.A.clone(t),i=(0,d.A)(i)?te.A.clone(i):te.A.addDays(n,1,new te.A),te.A.greaterThan(n,i))throw new A.A("startTime must come before stopTime.");this.startTime=n,this.stopTime=i,this.clockRange=e.clockRange??Hs.UNBOUNDED,this.canAnimate=e.canAnimate??!0,this.onTick=new Bn.A,this.onStop=new Bn.A,this._currentTime=void 0,this._multiplier=void 0,this._clockStep=void 0,this._shouldAnimate=void 0,this._lastSystemTime=(0,aa.A)(),this.currentTime=t,this.multiplier=e.multiplier??1,this.shouldAnimate=e.shouldAnimate??!1,this.clockStep=e.clockStep??Gs.SYSTEM_CLOCK_MULTIPLIER}Object.defineProperties(ca.prototype,{currentTime:{get:function(){return this._currentTime},set:function(e){te.A.equals(this._currentTime,e)||(this._clockStep===Gs.SYSTEM_CLOCK&&(this._clockStep=Gs.SYSTEM_CLOCK_MULTIPLIER),this._currentTime=e)}},multiplier:{get:function(){return this._multiplier},set:function(e){this._multiplier!==e&&(this._clockStep===Gs.SYSTEM_CLOCK&&(this._clockStep=Gs.SYSTEM_CLOCK_MULTIPLIER),this._multiplier=e)}},clockStep:{get:function(){return this._clockStep},set:function(e){e===Gs.SYSTEM_CLOCK&&(this._multiplier=1,this._shouldAnimate=!0,this._currentTime=te.A.now()),this._clockStep=e}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(e){this._shouldAnimate!==e&&(this._clockStep===Gs.SYSTEM_CLOCK&&(this._clockStep=Gs.SYSTEM_CLOCK_MULTIPLIER),this._shouldAnimate=e)}}}),ca.prototype.tick=function(){const e=(0,aa.A)();let t=te.A.clone(this._currentTime);if(this.canAnimate&&this._shouldAnimate){const n=this._clockStep;if(n===Gs.SYSTEM_CLOCK)t=te.A.now(t);else{const i=this._multiplier;if(n===Gs.TICK_DEPENDENT)t=te.A.addSeconds(t,i,t);else{const n=e-this._lastSystemTime;t=te.A.addSeconds(t,i*(n/1e3),t)}const o=this.clockRange,r=this.startTime,s=this.stopTime;if(o===Hs.CLAMPED)te.A.lessThan(t,r)?t=te.A.clone(r,t):te.A.greaterThan(t,s)&&(t=te.A.clone(s,t),this.onStop.raiseEvent(this));else if(o===Hs.LOOP_STOP)for(te.A.lessThan(t,r)&&(t=te.A.clone(r,t));te.A.greaterThan(t,s);)t=te.A.addSeconds(r,te.A.secondsDifference(t,s),t),this.onStop.raiseEvent(this)}}return this._currentTime=t,this._lastSystemTime=e,this.onTick.raiseEvent(this),t};const la=ca;var ua=n(91440);function da(){this._definitionChanged=new Bn.A,this._startTime=void 0,this._stopTime=void 0,this._currentTime=void 0,this._clockRange=void 0,this._clockStep=void 0,this._multiplier=void 0}Object.defineProperties(da.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},startTime:(0,ua.A)("startTime"),stopTime:(0,ua.A)("stopTime"),currentTime:(0,ua.A)("currentTime"),clockRange:(0,ua.A)("clockRange"),clockStep:(0,ua.A)("clockStep"),multiplier:(0,ua.A)("multiplier")}),da.prototype.clone=function(e){return(0,d.A)(e)||(e=new da),e.startTime=this.startTime,e.stopTime=this.stopTime,e.currentTime=this.currentTime,e.clockRange=this.clockRange,e.clockStep=this.clockStep,e.multiplier=this.multiplier,e},da.prototype.equals=function(e){return this===e||(0,d.A)(e)&&te.A.equals(this.startTime,e.startTime)&&te.A.equals(this.stopTime,e.stopTime)&&te.A.equals(this.currentTime,e.currentTime)&&this.clockRange===e.clockRange&&this.clockStep===e.clockStep&&this.multiplier===e.multiplier},da.prototype.merge=function(e){if(!(0,d.A)(e))throw new A.A("source is required.");this.startTime=this.startTime??e.startTime,this.stopTime=this.stopTime??e.stopTime,this.currentTime=this.currentTime??e.currentTime,this.clockRange=this.clockRange??e.clockRange,this.clockStep=this.clockStep??e.clockStep,this.multiplier=this.multiplier??e.multiplier},da.prototype.getValue=function(e){return(0,d.A)(e)||(e=new la),e.startTime=this.startTime??e.startTime,e.stopTime=this.stopTime??e.stopTime,e.currentTime=this.currentTime??e.currentTime,e.clockRange=this.clockRange??e.clockRange,e.multiplier=this.multiplier??e.multiplier,e.clockStep=this.clockStep??e.clockStep,e};const ha=da;var Aa=n(132753),pa=n(654986),fa=n(707221);const ma=u.A.WHITE,ga=new q.A(8,8),_a=new q.A(0,0),ya=new q.A(1,1);function va(e){e=e??S.A.EMPTY_OBJECT,this._definitionChanged=new Bn.A,this._color=void 0,this._colorSubscription=void 0,this._cellAlpha=void 0,this._cellAlphaSubscription=void 0,this._lineCount=void 0,this._lineCountSubscription=void 0,this._lineThickness=void 0,this._lineThicknessSubscription=void 0,this._lineOffset=void 0,this._lineOffsetSubscription=void 0,this.color=e.color,this.cellAlpha=e.cellAlpha,this.lineCount=e.lineCount,this.lineThickness=e.lineThickness,this.lineOffset=e.lineOffset}Object.defineProperties(va.prototype,{isConstant:{get:function(){return Wt.A.isConstant(this._color)&&Wt.A.isConstant(this._cellAlpha)&&Wt.A.isConstant(this._lineCount)&&Wt.A.isConstant(this._lineThickness)&&Wt.A.isConstant(this._lineOffset)}},definitionChanged:{get:function(){return this._definitionChanged}},color:(0,Ci.A)("color"),cellAlpha:(0,Ci.A)("cellAlpha"),lineCount:(0,Ci.A)("lineCount"),lineThickness:(0,Ci.A)("lineThickness"),lineOffset:(0,Ci.A)("lineOffset")}),va.prototype.getType=function(e){return"Grid"};const Ta=new te.A;va.prototype.getValue=function(e,t){return(0,d.A)(e)||(e=te.A.now(Ta)),(0,d.A)(t)||(t={}),t.color=Wt.A.getValueOrClonedDefault(this._color,e,ma,t.color),t.cellAlpha=Wt.A.getValueOrDefault(this._cellAlpha,e,.1),t.lineCount=Wt.A.getValueOrClonedDefault(this._lineCount,e,ga,t.lineCount),t.lineThickness=Wt.A.getValueOrClonedDefault(this._lineThickness,e,ya,t.lineThickness),t.lineOffset=Wt.A.getValueOrClonedDefault(this._lineOffset,e,_a,t.lineOffset),t},va.prototype.equals=function(e){return this===e||e instanceof va&&Wt.A.equals(this._color,e._color)&&Wt.A.equals(this._cellAlpha,e._cellAlpha)&&Wt.A.equals(this._lineCount,e._lineCount)&&Wt.A.equals(this._lineThickness,e._lineThickness)&&Wt.A.equals(this._lineOffset,e._lineOffset)};const ba=va;var wa=n(612967),xa=n(280749),Ca=n(327458),Ea=n(874804),Sa=n(423798),Ia=n(71005),Pa=n(193189);function Da(e){this._definitionChanged=new Bn.A,this._color=void 0,this._colorSubscription=void 0,this.color=e}Object.defineProperties(Da.prototype,{isConstant:{get:function(){return Wt.A.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:(0,Ci.A)("color")}),Da.prototype.getType=function(e){return"PolylineArrow"};const Oa=new te.A;Da.prototype.getValue=function(e,t){return(0,d.A)(e)||(e=te.A.now(Oa)),(0,d.A)(t)||(t={}),t.color=Wt.A.getValueOrClonedDefault(this._color,e,u.A.WHITE,t.color),t},Da.prototype.equals=function(e){return this===e||e instanceof Da&&Wt.A.equals(this._color,e._color)};const Ra=Da;var Ma=n(424620);const La=u.A.WHITE;function Na(e){e=e??S.A.EMPTY_OBJECT,this._definitionChanged=new Bn.A,this._color=void 0,this._colorSubscription=void 0,this._glowPower=void 0,this._glowPowerSubscription=void 0,this._taperPower=void 0,this._taperPowerSubscription=void 0,this.color=e.color,this.glowPower=e.glowPower,this.taperPower=e.taperPower}Object.defineProperties(Na.prototype,{isConstant:{get:function(){return Wt.A.isConstant(this._color)&&Wt.A.isConstant(this._glow)}},definitionChanged:{get:function(){return this._definitionChanged}},color:(0,Ci.A)("color"),glowPower:(0,Ci.A)("glowPower"),taperPower:(0,Ci.A)("taperPower")}),Na.prototype.getType=function(e){return"PolylineGlow"};const Ba=new te.A;Na.prototype.getValue=function(e,t){return(0,d.A)(e)||(e=te.A.now(Ba)),(0,d.A)(t)||(t={}),t.color=Wt.A.getValueOrClonedDefault(this._color,e,La,t.color),t.glowPower=Wt.A.getValueOrDefault(this._glowPower,e,.25,t.glowPower),t.taperPower=Wt.A.getValueOrDefault(this._taperPower,e,1,t.taperPower),t},Na.prototype.equals=function(e){return this===e||e instanceof Na&&Wt.A.equals(this._color,e._color)&&Wt.A.equals(this._glowPower,e._glowPower)&&Wt.A.equals(this._taperPower,e._taperPower)};const Fa=Na;var Ua=n(998261);const ka=u.A.WHITE,Va=u.A.BLACK;function za(e){e=e??S.A.EMPTY_OBJECT,this._definitionChanged=new Bn.A,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this.color=e.color,this.outlineColor=e.outlineColor,this.outlineWidth=e.outlineWidth}Object.defineProperties(za.prototype,{isConstant:{get:function(){return Wt.A.isConstant(this._color)&&Wt.A.isConstant(this._outlineColor)&&Wt.A.isConstant(this._outlineWidth)}},definitionChanged:{get:function(){return this._definitionChanged}},color:(0,Ci.A)("color"),outlineColor:(0,Ci.A)("outlineColor"),outlineWidth:(0,Ci.A)("outlineWidth")}),za.prototype.getType=function(e){return"PolylineOutline"};const Ha=new te.A;za.prototype.getValue=function(e,t){return(0,d.A)(e)||(e=te.A.now(Ha)),(0,d.A)(t)||(t={}),t.color=Wt.A.getValueOrClonedDefault(this._color,e,ka,t.color),t.outlineColor=Wt.A.getValueOrClonedDefault(this._outlineColor,e,Va,t.outlineColor),t.outlineWidth=Wt.A.getValueOrDefault(this._outlineWidth,e,1),t},za.prototype.equals=function(e){return this===e||e instanceof za&&Wt.A.equals(this._color,e._color)&&Wt.A.equals(this._outlineColor,e._outlineColor)&&Wt.A.equals(this._outlineWidth,e._outlineWidth)};const Ga=za;var Wa=n(278659);function Ya(e,t){this._value=void 0,this._definitionChanged=new Bn.A,this._eventHelper=new Gi.A,this._referenceFrame=t??Ai.A.FIXED,this.setValue(e)}Object.defineProperties(Ya.prototype,{isConstant:{get:function(){const e=this._value;if(!(0,d.A)(e))return!0;const t=e.length;for(let n=0;n<t;n++)if(!Wt.A.isConstant(e[n]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});const qa=new te.A;Ya.prototype.getValue=function(e,t){return(0,d.A)(e)||(e=te.A.now(qa)),this.getValueInReferenceFrame(e,Ai.A.FIXED,t)},Ya.prototype.getValueInReferenceFrame=function(e,t,n){if(!(0,d.A)(e))throw new A.A("time is required.");if(!(0,d.A)(t))throw new A.A("referenceFrame is required.");const i=this._value;if(!(0,d.A)(i))return;const o=i.length;(0,d.A)(n)||(n=new Array(o));let r=0,s=0;for(;r<o;){const o=i[r].getValueInReferenceFrame(e,t,n[r]);(0,d.A)(o)&&(n[s]=o,s++),r++}return n.length=s,n},Ya.prototype.setValue=function(e){const t=this._eventHelper;if(t.removeAll(),(0,d.A)(e)){this._value=e.slice();const n=e.length;for(let i=0;i<n;i++){const n=e[i];(0,d.A)(n)&&t.add(n.definitionChanged,Ya.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)},Ya.prototype.equals=function(e){return this===e||e instanceof Ya&&this._referenceFrame===e._referenceFrame&&Wt.A.arrayEquals(this._value,e._value)},Ya.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};const ja=Ya;function Qa(e){this._value=void 0,this._definitionChanged=new Bn.A,this._eventHelper=new Gi.A,this.setValue(e)}Object.defineProperties(Qa.prototype,{isConstant:{get:function(){const e=this._value;if(!(0,d.A)(e))return!0;const t=e.length;for(let n=0;n<t;n++)if(!Wt.A.isConstant(e[n]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}});const Xa=new te.A;Qa.prototype.getValue=function(e,t){(0,d.A)(e)||(e=te.A.now(Xa));const n=this._value;if(!(0,d.A)(n))return;const i=n.length;(0,d.A)(t)||(t=new Array(i));let o=0,r=0;for(;o<i;){const n=this._value[o].getValue(e,t[o]);(0,d.A)(n)&&(t[r]=n,r++),o++}return t.length=r,t},Qa.prototype.setValue=function(e){const t=this._eventHelper;if(t.removeAll(),(0,d.A)(e)){this._value=e.slice();const n=e.length;for(let i=0;i<n;i++){const n=e[i];(0,d.A)(n)&&t.add(n.definitionChanged,Qa.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)},Qa.prototype.equals=function(e){return this===e||e instanceof Qa&&Wt.A.arrayEquals(this._value,e._value)},Qa.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};const Ka=Qa;var $a=n(470959),Ja=n(777370);function Za(e){let t=e._targetProperty;if(!(0,d.A)(t)){let n=e._targetEntity;if(!(0,d.A)(n)){if(n=e._targetCollection.getById(e._targetId),!(0,d.A)(n))return void(e._targetEntity=e._targetProperty=void 0);n.definitionChanged.addEventListener(ec.prototype._onTargetEntityDefinitionChanged,e),e._targetEntity=n}const i=e._targetPropertyNames;t=e._targetEntity;for(let e=0,n=i.length;e<n&&(0,d.A)(t);++e)t=t[i[e]];e._targetProperty=t}return t}function ec(e,t,n){if(!(0,d.A)(e))throw new A.A("targetCollection is required.");if(!(0,d.A)(t)||""===t)throw new A.A("targetId is required.");if(!(0,d.A)(n)||0===n.length)throw new A.A("targetPropertyNames is required.");for(let e=0;e<n.length;e++){const t=n[e];if(!(0,d.A)(t)||""===t)throw new A.A("reference contains invalid properties.")}this._targetCollection=e,this._targetId=t,this._targetPropertyNames=n,this._targetProperty=void 0,this._targetEntity=void 0,this._definitionChanged=new Bn.A,e.collectionChanged.addEventListener(ec.prototype._onCollectionChanged,this)}Object.defineProperties(ec.prototype,{isConstant:{get:function(){return Wt.A.isConstant(Za(this))}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){const e=Za(this);return(0,d.A)(e)?e.referenceFrame:void 0}},targetId:{get:function(){return this._targetId}},targetCollection:{get:function(){return this._targetCollection}},targetPropertyNames:{get:function(){return this._targetPropertyNames}},resolvedProperty:{get:function(){return Za(this)}}}),ec.fromString=function(e,t){if(!(0,d.A)(e))throw new A.A("targetCollection is required.");if(!(0,d.A)(t))throw new A.A("referenceString is required.");let n;const i=[];let o=!0,r=!1,s="";for(let e=0;e<t.length;++e){const a=t.charAt(e);r?(s+=a,r=!1):"\\"===a?r=!0:o&&"#"===a?(n=s,o=!1,s=""):o||"."!==a?s+=a:(i.push(s),s="")}return i.push(s),new ec(e,n,i)};const tc=new te.A;ec.prototype.getValue=function(e,t){const n=Za(this);return(0,d.A)(e)||(e=te.A.now(tc)),(0,d.A)(n)?n.getValue(e,t):void 0},ec.prototype.getValueInReferenceFrame=function(e,t,n){const i=Za(this);return(0,d.A)(i)?i.getValueInReferenceFrame(e,t,n):void 0},ec.prototype.getType=function(e){const t=Za(this);return(0,d.A)(t)?t.getType(e):void 0},ec.prototype.equals=function(e){if(this===e)return!0;const t=this._targetPropertyNames,n=e._targetPropertyNames;if(this._targetCollection!==e._targetCollection||this._targetId!==e._targetId||t.length!==n.length)return!1;const i=this._targetPropertyNames.length;for(let e=0;e<i;e++)if(t[e]!==n[e])return!1;return!0},ec.prototype._onTargetEntityDefinitionChanged=function(e,t,n,i){(0,d.A)(this._targetProperty)&&this._targetPropertyNames[0]===t&&(this._targetProperty=void 0,this._definitionChanged.raiseEvent(this))},ec.prototype._onCollectionChanged=function(e,t,n){let i=this._targetEntity;(0,d.A)(i)&&-1!==n.indexOf(i)?(i.definitionChanged.removeEventListener(ec.prototype._onTargetEntityDefinitionChanged,this),this._targetEntity=this._targetProperty=void 0):(0,d.A)(i)||(i=Za(this),(0,d.A)(i)&&this._definitionChanged.raiseEvent(this))};const nc=ec,ic={packedLength:1,pack:function(e,t,n){if(!(0,d.A)(e))throw new A.A("value is required");if(!(0,d.A)(t))throw new A.A("array is required");return t[n=n??0]=e,t},unpack:function(e,t,n){if(!(0,d.A)(e))throw new A.A("array is required");return e[t=t??0]},convertPackedArrayForInterpolation:function(e,t,n,i){if(!(0,d.A)(e))throw new A.A("packedArray is required");let o;(0,d.A)(i)||(i=[]),t=t??0;for(let r=0,s=(n=n??e.length)-t+1;r<s;r++){const n=e[t+r];0===r||Math.abs(o-n)<Math.PI?i[r]=n:i[r]=n-J.A.TWO_PI,o=n}},unpackInterpolationResult:function(e,t,n,i,o){if(!(0,d.A)(e))throw new A.A("array is required");if(!(0,d.A)(t))throw new A.A("sourceArray is required");return(o=e[0])<0?o+J.A.TWO_PI:o}},oc={packedLength:1,pack:function(e,t,n){t[n=n??0]=e},unpack:function(e,t,n){return e[t=t??0]}};function rc(e,t,n){let i;const o=e.length,r=n.length,s=o+r;if(e.length=s,o!==t){let n=o-1;for(i=s-1;i>=t;i--)e[i]=e[n--]}for(i=0;i<r;i++)e[t++]=n[i]}function sc(e,t){return e instanceof te.A?e:"string"==typeof e?te.A.fromIso8601(e):te.A.addSeconds(t,e,new te.A)}const ac=[],cc=[];function lc(e,t,n,i,o){let r,s,a,c,l,u,h=0;for(;h<i.length;){l=sc(i[h],e),a=(0,Wi.A)(t,l,te.A.compare);let A=0,p=0;if(a<0){for(a=~a,c=a*o,s=void 0,u=t[a];h<i.length&&(l=sc(i[h],e),!((0,d.A)(s)&&te.A.compare(s,l)>=0||(0,d.A)(u)&&te.A.compare(l,u)>=0));){for(ac[A++]=l,h+=1,r=0;r<o;r++)cc[p++]=i[h],h+=1;s=l}A>0&&(cc.length=p,rc(n,c,cc),ac.length=A,rc(t,a,ac))}else{for(r=0;r<o;r++)h++,n[a*o+r]=i[h];h++}}}function uc(e,t){l.A.defined("type",e);let n=e;n===Number&&(n=oc);let i,o=n.packedLength,r=n.packedInterpolationLength??o,s=0;if((0,d.A)(t)){const e=t.length;i=new Array(e);for(let n=0;n<e;n++){let e=t[n];e===Number&&(e=oc);const s=e.packedLength;o+=s,r+=e.packedInterpolationLength??s,i[n]=e}s=e}this._type=e,this._innerType=n,this._interpolationDegree=1,this._interpolationAlgorithm=Zs,this._numberOfPoints=0,this._times=[],this._values=[],this._xTable=[],this._yTable=[],this._packedLength=o,this._packedInterpolationLength=r,this._updateTableLength=!0,this._interpolationResult=new Array(r),this._definitionChanged=new Bn.A,this._derivativeTypes=t,this._innerDerivativeTypes=i,this._inputOrder=s,this._forwardExtrapolationType=Ys.NONE,this._forwardExtrapolationDuration=0,this._backwardExtrapolationType=Ys.NONE,this._backwardExtrapolationDuration=0}Object.defineProperties(uc.prototype,{isConstant:{get:function(){return 0===this._values.length}},definitionChanged:{get:function(){return this._definitionChanged}},type:{get:function(){return this._type}},derivativeTypes:{get:function(){return this._derivativeTypes}},interpolationDegree:{get:function(){return this._interpolationDegree}},interpolationAlgorithm:{get:function(){return this._interpolationAlgorithm}},forwardExtrapolationType:{get:function(){return this._forwardExtrapolationType},set:function(e){this._forwardExtrapolationType!==e&&(this._forwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},forwardExtrapolationDuration:{get:function(){return this._forwardExtrapolationDuration},set:function(e){this._forwardExtrapolationDuration!==e&&(this._forwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationType:{get:function(){return this._backwardExtrapolationType},set:function(e){this._backwardExtrapolationType!==e&&(this._backwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationDuration:{get:function(){return this._backwardExtrapolationDuration},set:function(e){this._backwardExtrapolationDuration!==e&&(this._backwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}}});const dc=new te.A;function hc(e,t,n){const i=e._packedLength;e._times.splice(t,n),e._values.splice(t*i,n*i),e._updateTableLength=!0,e._definitionChanged.raiseEvent(e)}uc.prototype.getValue=function(e,t){(0,d.A)(e)||(e=te.A.now(dc));const n=this._times,i=n.length;if(0===i)return;let o;const r=this._innerType,s=this._values;let a=(0,Wi.A)(n,e,te.A.compare);if(a<0){if(a=~a,0===a){const i=n[a];if(o=this._backwardExtrapolationDuration,this._backwardExtrapolationType===Ys.NONE||0!==o&&te.A.secondsDifference(i,e)>o)return;if(this._backwardExtrapolationType===Ys.HOLD)return r.unpack(s,0,t)}if(a>=i){a=i-1;const c=n[a];if(o=this._forwardExtrapolationDuration,this._forwardExtrapolationType===Ys.NONE||0!==o&&te.A.secondsDifference(e,c)>o)return;if(this._forwardExtrapolationType===Ys.HOLD)return a=i-1,r.unpack(s,a*r.packedLength,t)}const c=this._xTable,l=this._yTable,u=this._interpolationAlgorithm,h=this._packedInterpolationLength,A=this._inputOrder;if(this._updateTableLength){this._updateTableLength=!1;const e=Math.min(u.getRequiredDataPoints(this._interpolationDegree,A),i);e!==this._numberOfPoints&&(this._numberOfPoints=e,c.length=e,l.length=e*h)}const p=this._numberOfPoints-1;if(p<1)return;let f=0,m=i-1;if(m-f+1>=p+1){let e=a-(p/2|0)-1;e<f&&(e=f);let t=e+p;t>m&&(t=m,e=t-p,e<f&&(e=f)),f=e,m=t}const g=m-f+1;for(let e=0;e<g;++e)c[e]=te.A.secondsDifference(n[f+e],n[m]);if((0,d.A)(r.convertPackedArrayForInterpolation))r.convertPackedArrayForInterpolation(s,f,m,l);else{let e=0;const t=this._packedLength;let n=f*t;const i=(m+1)*t;for(;n<i;)l[e]=s[n],n++,e++}const _=te.A.secondsDifference(e,n[m]);let y;if(0!==A&&(0,d.A)(u.interpolate)){const e=Math.floor(h/(A+1));y=u.interpolate(_,c,l,e,A,A,this._interpolationResult)}else y=u.interpolateOrderZero(_,c,l,h,this._interpolationResult);return(0,d.A)(r.unpackInterpolationResult)?r.unpackInterpolationResult(y,s,f,m,t):r.unpack(y,0,t)}return r.unpack(s,a*this._packedLength,t)},uc.prototype.setInterpolationOptions=function(e){if(!(0,d.A)(e))return;let t=!1;const n=e.interpolationAlgorithm,i=e.interpolationDegree;(0,d.A)(n)&&this._interpolationAlgorithm!==n&&(this._interpolationAlgorithm=n,t=!0),(0,d.A)(i)&&this._interpolationDegree!==i&&(this._interpolationDegree=i,t=!0),t&&(this._updateTableLength=!0,this._definitionChanged.raiseEvent(this))},uc.prototype.addSample=function(e,t,n){const i=this._innerDerivativeTypes,o=(0,d.A)(i);l.A.defined("time",e),l.A.defined("value",t),o&&l.A.defined("derivatives",n);const r=this._innerType,s=[];if(s.push(e),r.pack(t,s,s.length),o){const e=i.length;for(let t=0;t<e;t++)i[t].pack(n[t],s,s.length)}lc(void 0,this._times,this._values,s,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},uc.prototype.addSamples=function(e,t,n){const i=this._innerDerivativeTypes,o=(0,d.A)(i);if(l.A.defined("times",e),l.A.defined("values",t),e.length!==t.length)throw new A.A("times and values must be the same length.");if(o&&(!(0,d.A)(n)||n.length!==e.length))throw new A.A("times and derivativeValues must be the same length.");const r=this._innerType,s=e.length,a=[];for(let c=0;c<s;c++)if(a.push(e[c]),r.pack(t[c],a,a.length),o){const e=n[c],t=i.length;for(let n=0;n<t;n++)i[n].pack(e[n],a,a.length)}lc(void 0,this._times,this._values,a,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},uc.prototype.getSample=function(e){l.A.typeOf.number("index",e);const t=this._times,n=t.length;if((0,d.A)(n))return e<0&&(e+=n),t[e]},uc.prototype.addSamplesPackedArray=function(e,t){l.A.defined("packedSamples",e),lc(t,this._times,this._values,e,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},uc.prototype.removeSample=function(e){l.A.defined("time",e);const t=(0,Wi.A)(this._times,e,te.A.compare);return!(t<0||(hc(this,t,1),0))},uc.prototype.removeSamples=function(e){l.A.defined("timeInterval",e);const t=this._times;let n=(0,Wi.A)(t,e.start,te.A.compare);n<0?n=~n:e.isStartIncluded||++n;let i=(0,Wi.A)(t,e.stop,te.A.compare);i<0?i=~i:e.isStopIncluded&&++i,hc(this,n,i-n)},uc.prototype.equals=function(e){if(this===e)return!0;if(!(0,d.A)(e))return!1;if(this._type!==e._type||this._interpolationDegree!==e._interpolationDegree||this._interpolationAlgorithm!==e._interpolationAlgorithm)return!1;const t=this._derivativeTypes,n=(0,d.A)(t),i=e._derivativeTypes;if(n!==(0,d.A)(i))return!1;let o,r;if(n){if(r=t.length,r!==i.length)return!1;for(o=0;o<r;o++)if(t[o]!==i[o])return!1}const s=this._times,a=e._times;if(r=s.length,r!==a.length)return!1;for(o=0;o<r;o++)if(!te.A.equals(s[o],a[o]))return!1;const c=this._values,l=e._values;for(r=c.length,o=0;o<r;o++)if(c[o]!==l[o])return!1;return!0},uc._mergeNewSamples=lc;const Ac=uc;function pc(e,t){let n;if((t=t??0)>0){n=new Array(t);for(let e=0;e<t;e++)n[e]=j.A}this._numberOfDerivatives=t,this._property=new Ac(j.A,n),this._definitionChanged=new Bn.A,this._referenceFrame=e??Ai.A.FIXED,this._property._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)}Object.defineProperties(pc.prototype,{isConstant:{get:function(){return this._property.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}},interpolationDegree:{get:function(){return this._property.interpolationDegree}},interpolationAlgorithm:{get:function(){return this._property.interpolationAlgorithm}},numberOfDerivatives:{get:function(){return this._numberOfDerivatives}},forwardExtrapolationType:{get:function(){return this._property.forwardExtrapolationType},set:function(e){this._property.forwardExtrapolationType=e}},forwardExtrapolationDuration:{get:function(){return this._property.forwardExtrapolationDuration},set:function(e){this._property.forwardExtrapolationDuration=e}},backwardExtrapolationType:{get:function(){return this._property.backwardExtrapolationType},set:function(e){this._property.backwardExtrapolationType=e}},backwardExtrapolationDuration:{get:function(){return this._property.backwardExtrapolationDuration},set:function(e){this._property.backwardExtrapolationDuration=e}}});const fc=new te.A;pc.prototype.getValue=function(e,t){return(0,d.A)(e)||(e=te.A.now(fc)),this.getValueInReferenceFrame(e,Ai.A.FIXED,t)},pc.prototype.getValueInReferenceFrame=function(e,t,n){if(l.A.defined("time",e),l.A.defined("referenceFrame",t),n=this._property.getValue(e,n),(0,d.A)(n))return pi.A.convertToReferenceFrame(e,n,this._referenceFrame,t,n)},pc.prototype.setInterpolationOptions=function(e){this._property.setInterpolationOptions(e)},pc.prototype.addSample=function(e,t,n){const i=this._numberOfDerivatives;if(i>0&&(!(0,d.A)(n)||n.length!==i))throw new A.A("derivatives length must be equal to the number of derivatives.");this._property.addSample(e,t,n)},pc.prototype.addSamples=function(e,t,n){this._property.addSamples(e,t,n)},pc.prototype.addSamplesPackedArray=function(e,t){this._property.addSamplesPackedArray(e,t)},pc.prototype.removeSample=function(e){return this._property.removeSample(e)},pc.prototype.removeSamples=function(e){this._property.removeSamples(e)},pc.prototype.equals=function(e){return this===e||e instanceof pc&&Wt.A.equals(this._property,e._property)&&this._referenceFrame===e._referenceFrame};const mc=pc,gc=Object.freeze({HORIZONTAL:0,VERTICAL:1}),_c=gc.HORIZONTAL,yc=u.A.WHITE,vc=u.A.BLACK;function Tc(e){e=e??S.A.EMPTY_OBJECT,this._definitionChanged=new Bn.A,this._orientation=void 0,this._orientationSubscription=void 0,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._offset=void 0,this._offsetSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.orientation=e.orientation,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.offset=e.offset,this.repeat=e.repeat}Object.defineProperties(Tc.prototype,{isConstant:{get:function(){return Wt.A.isConstant(this._orientation)&&Wt.A.isConstant(this._evenColor)&&Wt.A.isConstant(this._oddColor)&&Wt.A.isConstant(this._offset)&&Wt.A.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},orientation:(0,Ci.A)("orientation"),evenColor:(0,Ci.A)("evenColor"),oddColor:(0,Ci.A)("oddColor"),offset:(0,Ci.A)("offset"),repeat:(0,Ci.A)("repeat")}),Tc.prototype.getType=function(e){return"Stripe"};const bc=new te.A;Tc.prototype.getValue=function(e,t){return(0,d.A)(e)||(e=te.A.now(bc)),(0,d.A)(t)||(t={}),t.horizontal=Wt.A.getValueOrDefault(this._orientation,e,_c)===gc.HORIZONTAL,t.evenColor=Wt.A.getValueOrClonedDefault(this._evenColor,e,yc,t.evenColor),t.oddColor=Wt.A.getValueOrClonedDefault(this._oddColor,e,vc,t.oddColor),t.offset=Wt.A.getValueOrDefault(this._offset,e,0),t.repeat=Wt.A.getValueOrDefault(this._repeat,e,1),t},Tc.prototype.equals=function(e){return this===e||e instanceof Tc&&Wt.A.equals(this._orientation,e._orientation)&&Wt.A.equals(this._evenColor,e._evenColor)&&Wt.A.equals(this._oddColor,e._oddColor)&&Wt.A.equals(this._offset,e._offset)&&Wt.A.equals(this._repeat,e._repeat)};const wc=Tc;function xc(e){this._definitionChanged=new Bn.A,this._intervals=new oo,this._intervals.changedEvent.addEventListener(xc.prototype._intervalsChanged,this),this._referenceFrame=e??Ai.A.FIXED}Object.defineProperties(xc.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}},referenceFrame:{get:function(){return this._referenceFrame}}});const Cc=new te.A;xc.prototype.getValue=function(e,t){return(0,d.A)(e)||(e=te.A.now(Cc)),this.getValueInReferenceFrame(e,Ai.A.FIXED,t)},xc.prototype.getValueInReferenceFrame=function(e,t,n){if(!(0,d.A)(e))throw new A.A("time is required.");if(!(0,d.A)(t))throw new A.A("referenceFrame is required.");const i=this._intervals.findDataForIntervalContainingDate(e);if((0,d.A)(i))return pi.A.convertToReferenceFrame(e,i,this._referenceFrame,t,n)},xc.prototype.equals=function(e){return this===e||e instanceof xc&&this._intervals.equals(e._intervals,Wt.A.equals)&&this._referenceFrame===e._referenceFrame},xc.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};const Ec=xc;function Sc(){this._definitionChanged=new Bn.A,this._intervals=new oo,this._intervals.changedEvent.addEventListener(Sc.prototype._intervalsChanged,this)}Object.defineProperties(Sc.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});const Ic=new te.A;Sc.prototype.getValue=function(e,t){(0,d.A)(e)||(e=te.A.now(Ic));const n=this._intervals.findDataForIntervalContainingDate(e);return(0,d.A)(n)&&"function"==typeof n.clone?n.clone(t):n},Sc.prototype.equals=function(e){return this===e||e instanceof Sc&&this._intervals.equals(e._intervals,Wt.A.equals)},Sc.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};const Pc=Sc;function Dc(e,t){this._position=void 0,this._subscription=void 0,this._definitionChanged=new Bn.A,this._normalize=t??!0,this.position=e}Object.defineProperties(Dc.prototype,{isConstant:{get:function(){return Wt.A.isConstant(this._position)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._position},set:function(e){const t=this._position;t!==e&&((0,d.A)(t)&&this._subscription(),this._position=e,(0,d.A)(e)&&(this._subscription=e._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)),this._definitionChanged.raiseEvent(this))}},normalize:{get:function(){return this._normalize},set:function(e){this._normalize!==e&&(this._normalize=e,this._definitionChanged.raiseEvent(this))}}});const Oc=new j.A,Rc=new j.A,Mc=new te.A,Lc=new te.A,Nc=1/60;Dc.prototype.getValue=function(e,t){return this._getValue(e,t)},Dc.prototype._getValue=function(e,t,n){(0,d.A)(e)||(e=te.A.now(Lc)),(0,d.A)(t)||(t=new j.A);const i=this._position;if(Wt.A.isConstant(i))return this._normalize?void 0:j.A.clone(j.A.ZERO,t);let o=i.getValue(e,Oc),r=i.getValue(te.A.addSeconds(e,Nc,Mc),Rc);if(!(0,d.A)(o))return;if(!(0,d.A)(r)&&(r=o,o=i.getValue(te.A.addSeconds(e,-Nc,Mc),Rc),!(0,d.A)(o)))return;if(j.A.equals(o,r))return this._normalize?void 0:j.A.clone(j.A.ZERO,t);(0,d.A)(n)&&o.clone(n);const s=j.A.subtract(r,o,t);return this._normalize?j.A.normalize(s,t):j.A.divideByScalar(s,Nc,t)},Dc.prototype.equals=function(e){return this===e||e instanceof Dc&&Wt.A.equals(this._position,e._position)};const Bc=Dc;function Fc(e,t){this._velocityVectorProperty=new Bc(e,!0),this._subscription=void 0,this._ellipsoid=void 0,this._definitionChanged=new Bn.A,this.ellipsoid=t??K.A.default;const n=this;this._velocityVectorProperty.definitionChanged.addEventListener(function(){n._definitionChanged.raiseEvent(n)})}Object.defineProperties(Fc.prototype,{isConstant:{get:function(){return Wt.A.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(e){this._velocityVectorProperty.position=e}},ellipsoid:{get:function(){return this._ellipsoid},set:function(e){this._ellipsoid!==e&&(this._ellipsoid=e,this._definitionChanged.raiseEvent(this))}}});const Uc=new j.A,kc=new j.A,Vc=new Z.A,zc=new te.A;Fc.prototype.getValue=function(e,t){(0,d.A)(e)||(e=te.A.now(zc));const n=this._velocityVectorProperty._getValue(e,kc,Uc);if((0,d.A)(n))return xe.A.rotationMatrixFromPositionVelocity(Uc,n,this._ellipsoid,Vc),To.A.fromRotationMatrix(Vc,t)},Fc.prototype.equals=function(e){return this===e||e instanceof Fc&&Wt.A.equals(this._velocityVectorProperty,e._velocityVectorProperty)&&(this._ellipsoid===e._ellipsoid||this._ellipsoid.equals(e._ellipsoid))};const Hc=Fc;var Gc=n(685625);const Wc={COMPLETE:0,BELOW_ELLIPSOID_HORIZON:1,ABOVE_ELLIPSOID_HORIZON:2,validate:function(e){return e===Wc.COMPLETE||e===Wc.BELOW_ELLIPSOID_HORIZON||e===Wc.ABOVE_ELLIPSOID_HORIZON},toString:function(e){switch(e){case Wc.COMPLETE:return"COMPLETE";case Wc.BELOW_ELLIPSOID_HORIZON:return"BELOW_ELLIPSOID_HORIZON";case Wc.ABOVE_ELLIPSOID_HORIZON:return"ABOVE_ELLIPSOID_HORIZON";default:throw new A.A("SensorVolumePortionToDisplay value is not valid and cannot be converted to a String.")}}},Yc=Wc;function qc(){}let jc;function Qc(e,t){return"#"===t[0]&&(t=jc+t),nc.fromString(e,t)}function Xc(e,t,n){if((0,d.A)(n.reference))return Qc(t,n.reference);if((0,d.A)(n.velocityReference)){const i=Qc(t,n.velocityReference);switch(e){case j.A:case qc:return new Bc(i,e===qc);case To.A:return new Hc(i)}}throw new M.A(`${JSON.stringify(n)} is not valid CZML.`)}qc.packedLength=j.A.packedLength,qc.unpack=j.A.unpack,qc.pack=j.A.pack;const Kc=new j.A,$c=new na,Jc=new X.A,Zc=new ji.A,el=new To.A;function tl(e,t){const n=e.uri??e;return(0,d.A)(t)?t.getDerivedResource({url:n}):Lt.A.createIfNeeded(n)}function nl(e){const t=e.cartesian;if((0,d.A)(t))return t;const n=e.cartesianVelocity;if((0,d.A)(n))return n;const i=e.unitCartesian;if((0,d.A)(i))return i;const o=e.unitSpherical;if((0,d.A)(o))return function(e){const t=e.length;if($c.magnitude=1,2===t)return $c.clock=e[0],$c.cone=e[1],j.A.fromSpherical($c,Kc),[Kc.x,Kc.y,Kc.z];const n=new Array(t/3*4);for(let i=0,o=0;i<t;i+=3,o+=4)n[o]=e[i],$c.clock=e[i+1],$c.cone=e[i+2],j.A.fromSpherical($c,Kc),n[o+1]=Kc.x,n[o+2]=Kc.y,n[o+3]=Kc.z;return n}(o);const r=e.spherical;if((0,d.A)(r))return function(e){const t=e.length;if(3===t)return $c.clock=e[0],$c.cone=e[1],$c.magnitude=e[2],j.A.fromSpherical($c,Kc),[Kc.x,Kc.y,Kc.z];const n=new Array(t);for(let i=0;i<t;i+=4)n[i]=e[i],$c.clock=e[i+1],$c.cone=e[i+2],$c.magnitude=e[i+3],j.A.fromSpherical($c,Kc),n[i+1]=Kc.x,n[i+2]=Kc.y,n[i+3]=Kc.z;return n}(r);const s=e.cartographicRadians;if((0,d.A)(s))return function(e){const t=e.length;if(3===t)return Jc.longitude=e[0],Jc.latitude=e[1],Jc.height=e[2],K.A.default.cartographicToCartesian(Jc,Kc),[Kc.x,Kc.y,Kc.z];const n=new Array(t);for(let i=0;i<t;i+=4)n[i]=e[i],Jc.longitude=e[i+1],Jc.latitude=e[i+2],Jc.height=e[i+3],K.A.default.cartographicToCartesian(Jc,Kc),n[i+1]=Kc.x,n[i+2]=Kc.y,n[i+3]=Kc.z;return n}(s);const a=e.cartographicDegrees;if((0,d.A)(a))return function(e){const t=e.length;if(3===t)return Jc.longitude=J.A.toRadians(e[0]),Jc.latitude=J.A.toRadians(e[1]),Jc.height=e[2],K.A.default.cartographicToCartesian(Jc,Kc),[Kc.x,Kc.y,Kc.z];const n=new Array(t);for(let i=0;i<t;i+=4)n[i]=e[i],Jc.longitude=J.A.toRadians(e[i+1]),Jc.latitude=J.A.toRadians(e[i+2]),Jc.height=e[i+3],K.A.default.cartographicToCartesian(Jc,Kc),n[i+1]=Kc.x,n[i+2]=Kc.y,n[i+3]=Kc.z;return n}(a);throw new M.A(`${JSON.stringify(e)} is not a valid CZML interval.`)}function il(e,t){j.A.unpack(e,t,Kc),j.A.normalize(Kc,Kc),j.A.pack(Kc,e,t)}function ol(e,t){To.A.unpack(e,t,el),To.A.normalize(el,el),To.A.pack(el,e,t)}function rl(e){return"boolean"==typeof e?Boolean:"number"==typeof e?Number:"string"==typeof e?String:e.hasOwnProperty("array")?Array:e.hasOwnProperty("boolean")?Boolean:e.hasOwnProperty("boundingRectangle")?c.A:e.hasOwnProperty("cartesian2")?q.A:e.hasOwnProperty("cartesian")||e.hasOwnProperty("spherical")||e.hasOwnProperty("cartographicRadians")||e.hasOwnProperty("cartographicDegrees")?j.A:e.hasOwnProperty("unitCartesian")||e.hasOwnProperty("unitSpherical")?qc:e.hasOwnProperty("rgba")||e.hasOwnProperty("rgbaf")?u.A:e.hasOwnProperty("arcType")?zs.A:e.hasOwnProperty("classificationType")?Un.A:e.hasOwnProperty("colorBlendMode")?ia.A:e.hasOwnProperty("cornerType")?_o:e.hasOwnProperty("heightReference")?Vt.Ay:e.hasOwnProperty("horizontalOrigin")?zt.A:e.hasOwnProperty("date")?te.A:e.hasOwnProperty("labelStyle")?oa.A:e.hasOwnProperty("number")?Number:e.hasOwnProperty("nearFarScalar")?kt.A:e.hasOwnProperty("distanceDisplayCondition")?Ut.A:e.hasOwnProperty("object")||e.hasOwnProperty("value")?Object:e.hasOwnProperty("unitQuaternion")?To.A:e.hasOwnProperty("shadowMode")?kn.A:e.hasOwnProperty("string")?String:e.hasOwnProperty("stripeOrientation")?gc:e.hasOwnProperty("wsen")||e.hasOwnProperty("wsenDegrees")?Or.A:e.hasOwnProperty("uri")?ra:e.hasOwnProperty("verticalOrigin")?Ht.A:Object}const sl={HERMITE:$s,LAGRANGE:Js,LINEAR:Zs};function al(e,t){const n=e.interpolationAlgorithm,i=e.interpolationDegree;((0,d.A)(n)||(0,d.A)(i))&&t.setInterpolationOptions({interpolationAlgorithm:sl[n],interpolationDegree:i});const o=e.forwardExtrapolationType;(0,d.A)(o)&&(t.forwardExtrapolationType=Ys[o]);const r=e.forwardExtrapolationDuration;(0,d.A)(r)&&(t.forwardExtrapolationDuration=r);const s=e.backwardExtrapolationType;(0,d.A)(s)&&(t.backwardExtrapolationType=Ys[s]);const a=e.backwardExtrapolationDuration;(0,d.A)(a)&&(t.backwardExtrapolationDuration=a)}const cl={iso8601:void 0};function ll(e){if((0,d.A)(e))return cl.iso8601=e,ji.A.fromIso8601(cl)}function ul(e){const t=Tn.A.MAXIMUM_INTERVAL.clone();return t.data=e,t}function dl(e){const t=new ao;return t.intervals.addInterval(ul(e)),t}function hl(e){const t=new po(e.referenceFrame);return t.intervals.addInterval(ul(e)),t}function Al(e,t,n,i,o,r,s){let a,l,h,A=ll(i.interval);(0,d.A)(o)&&(A=(0,d.A)(A)?ji.A.intersect(A,o,Zc):o);const p=!(0,d.A)(i.reference)&&!(0,d.A)(i.velocityReference),f=(0,d.A)(A)&&!A.equals(Tn.A.MAXIMUM_INTERVAL);if(!0===i.delete)return f?pl(t[n],A):void(t[n]=void 0);let m=!1;if(p){if(l=function(e,t,n){switch(e){case zs.A:return zs.A[t.arcType??t];case Array:return t.array;case Boolean:return t.boolean??t;case c.A:return t.boundingRectangle;case q.A:return t.cartesian2;case j.A:return nl(t);case qc:return function(e){const t=nl(e);if(3===t.length)return il(t,0),t;for(let e=1;e<t.length;e+=4)il(t,e);return t}(t);case u.A:return function(e){let t=e.rgbaf;if((0,d.A)(t))return t;const n=e.rgba;if(!(0,d.A)(n))return;const i=n.length;if(i===u.A.packedLength)return[u.A.byteToFloat(n[0]),u.A.byteToFloat(n[1]),u.A.byteToFloat(n[2]),u.A.byteToFloat(n[3])];t=new Array(i);for(let e=0;e<i;e+=5)t[e]=n[e],t[e+1]=u.A.byteToFloat(n[e+1]),t[e+2]=u.A.byteToFloat(n[e+2]),t[e+3]=u.A.byteToFloat(n[e+3]),t[e+4]=u.A.byteToFloat(n[e+4]);return t}(t);case Un.A:return Un.A[t.classificationType??t];case ia.A:return ia.A[t.colorBlendMode??t];case _o:return _o[t.cornerType??t];case Vt.Ay:return Vt.Ay[t.heightReference??t];case zt.A:return zt.A[t.horizontalOrigin??t];case Image:return tl(t,n);case te.A:return te.A.fromIso8601(t.date??t);case oa.A:return oa.A[t.labelStyle??t];case Number:return t.number??t;case kt.A:return t.nearFarScalar;case Ut.A:return t.distanceDisplayCondition;case Object:return t.object??t.value??t;case To.A:return function(e){const t=e.unitQuaternion;if((0,d.A)(t)){if(4===t.length)return ol(t,0),t;for(let e=1;e<t.length;e+=5)ol(t,e)}return t}(t);case ic:return t.number??t;case Yc:return Yc[t.portionToDisplay??t];case kn.A:return kn.A[t.shadowMode??t.shadows??t];case String:return t.string??t;case gc:return gc[t.stripeOrientation??t];case Or.A:return function(e){let t=e.wsen;if((0,d.A)(t))return t;const n=e.wsenDegrees;if(!(0,d.A)(n))return;const i=n.length;if(i===Or.A.packedLength)return[J.A.toRadians(n[0]),J.A.toRadians(n[1]),J.A.toRadians(n[2]),J.A.toRadians(n[3])];t=new Array(i);for(let e=0;e<i;e+=5)t[e]=n[e],t[e+1]=J.A.toRadians(n[e+1]),t[e+2]=J.A.toRadians(n[e+2]),t[e+3]=J.A.toRadians(n[e+3]),t[e+4]=J.A.toRadians(n[e+4]);return t}(t);case ra:return tl(t,n);case Ht.A:return Ht.A[t.verticalOrigin??t];default:throw new M.A(`Unknown CzmlDataSource interval type: ${e}`)}}(e,i,r),!(0,d.A)(l))return;a=e.packedLength??1,h=l.length??1,m=!(0,d.A)(i.array)&&"string"!=typeof l&&h>a&&e!==Object}const g="function"==typeof e.unpack&&e!==ic;if(!m&&!f)return void(t[n]=p?new Vn.A(g?e.unpack(l,0):l):Xc(e,s,i));let _,y=t[n];const v=i.epoch;if((0,d.A)(v)&&(_=te.A.fromIso8601(v)),m&&!f)return y instanceof Ac||(t[n]=y=new Ac(e)),y.addSamplesPackedArray(l,_),void al(i,y);let T;if(!m&&f)return A=A.clone(),A.data=p?g?e.unpack(l,0):l:Xc(e,s,i),(0,d.A)(y)||(t[n]=y=p?new Pc:new ao),void(p&&y instanceof Pc?y.intervals.addInterval(A):y instanceof ao?(p&&(A.data=new Vn.A(A.data)),y.intervals.addInterval(A)):(t[n]=y=dl(y),p&&(A.data=new Vn.A(A.data)),y.intervals.addInterval(A)));(0,d.A)(y)||(t[n]=y=new ao),y instanceof ao||(t[n]=y=dl(y));const b=y.intervals;T=b.findInterval(A),(0,d.A)(T)&&T.data instanceof Ac||(T=A.clone(),T.data=new Ac(e),b.addInterval(T)),T.data.addSamplesPackedArray(l,_),al(i,T.data)}function pl(e,t){if(e instanceof Ac)e.removeSamples(t);else if(e instanceof Pc)e.intervals.removeInterval(t);else if(e instanceof ao){const n=e.intervals;for(let e=0;e<n.length;++e){const i=ji.A.intersect(n.get(e),t,Zc);i.isEmpty||pl(i.data,t)}return void n.removeInterval(t)}}function fl(e,t,n,i,o,r,s){if((0,d.A)(i))if(Array.isArray(i))for(let a=0,c=i.length;a<c;++a)Al(e,t,n,i[a],o,r,s);else Al(e,t,n,i,o,r,s)}function ml(e,t,n,i,o,r){let s=ll(n.interval);(0,d.A)(i)&&(s=(0,d.A)(s)?ji.A.intersect(s,i,Zc):i);const a=(0,d.A)(n.cartesianVelocity)?1:0,c=j.A.packedLength*(a+1);let l,u;const h=!(0,d.A)(n.reference),A=(0,d.A)(s)&&!s.equals(Tn.A.MAXIMUM_INTERVAL);if(!0===n.delete)return A?gl(e[t],s):void(e[t]=void 0);let p,f=!1;if(h&&((0,d.A)(n.referenceFrame)&&(p=Ai.A[n.referenceFrame]),p=p??Ai.A.FIXED,l=nl(n),u=l.length??1,f=u>c),!f&&!A)return void(e[t]=h?new fo.A(j.A.unpack(l),p):Qc(r,n.reference));let m,g=e[t];const _=n.epoch;if((0,d.A)(_)&&(m=te.A.fromIso8601(_)),f&&!A)return g instanceof mc&&(!(0,d.A)(p)||g.referenceFrame===p)||(e[t]=g=new mc(p,a)),g.addSamplesPackedArray(l,m),void al(n,g);let y;if(!f&&A)return s=s.clone(),s.data=h?j.A.unpack(l):Qc(r,n.reference),(0,d.A)(g)||(g=h?new Ec(p):new po(p),e[t]=g),void(h&&g instanceof Ec&&(0,d.A)(p)&&g.referenceFrame===p?g.intervals.addInterval(s):g instanceof po?(h&&(s.data=new fo.A(s.data,p)),g.intervals.addInterval(s)):(e[t]=g=hl(g),h&&(s.data=new fo.A(s.data,p)),g.intervals.addInterval(s)));(0,d.A)(g)?g instanceof po||(e[t]=g=hl(g)):e[t]=g=new po(p);const v=g.intervals;y=v.findInterval(s),(0,d.A)(y)&&y.data instanceof mc&&(!(0,d.A)(p)||y.data.referenceFrame===p)||(y=s.clone(),y.data=new mc(p,a),v.addInterval(y)),y.data.addSamplesPackedArray(l,m),al(n,y.data)}function gl(e,t){if(e instanceof mc)e.removeSamples(t);else if(e instanceof Ec)e.intervals.removeInterval(t);else if(e instanceof po){const n=e.intervals;for(let e=0;e<n.length;++e){const i=ji.A.intersect(n.get(e),t,Zc);i.isEmpty||gl(i.data,t)}return void n.removeInterval(t)}}function _l(e,t,n,i,o,r){if((0,d.A)(n))if(Array.isArray(n))for(let o=0,s=n.length;o<s;++o)ml(e,t,n[o],i,0,r);else ml(e,t,n,i,0,r)}function yl(e,t,n,i){(0,d.A)(n.references)?bl(e,t,n.references,n.interval,i,Ka,ao):((0,d.A)(n.cartesian2)?n.array=q.A.unpackArray(n.cartesian2):(0,d.A)(n.cartesian)&&(n.array=q.A.unpackArray(n.cartesian)),(0,d.A)(n.array)&&fl(Array,e,t,n,void 0,void 0,i))}function vl(e,t,n,i,o,r){let s=ll(n.interval);(0,d.A)(i)&&(s=(0,d.A)(s)?ji.A.intersect(s,i,Zc):i);let a,c,l,h=e[t];if((0,d.A)(s)){h instanceof uo||(h=new uo,e[t]=h);const n=h.intervals;c=n.findInterval({start:s.start,stop:s.stop}),(0,d.A)(c)?a=c.data:(c=s.clone(),n.addInterval(c))}else a=h;(0,d.A)(n.solidColor)?(a instanceof En.A||(a=new En.A),l=n.solidColor,fl(u.A,a,"color",l.color,void 0,void 0,r)):(0,d.A)(n.grid)?(a instanceof ba||(a=new ba),l=n.grid,fl(u.A,a,"color",l.color,void 0,o,r),fl(Number,a,"cellAlpha",l.cellAlpha,void 0,o,r),fl(q.A,a,"lineCount",l.lineCount,void 0,o,r),fl(q.A,a,"lineThickness",l.lineThickness,void 0,o,r),fl(q.A,a,"lineOffset",l.lineOffset,void 0,o,r)):(0,d.A)(n.image)?(a instanceof wa.A||(a=new wa.A),l=n.image,fl(Image,a,"image",l.image,void 0,o,r),fl(q.A,a,"repeat",l.repeat,void 0,o,r),fl(u.A,a,"color",l.color,void 0,o,r),fl(Boolean,a,"transparent",l.transparent,void 0,o,r)):(0,d.A)(n.stripe)?(a instanceof wc||(a=new wc),l=n.stripe,fl(gc,a,"orientation",l.orientation,void 0,o,r),fl(u.A,a,"evenColor",l.evenColor,void 0,o,r),fl(u.A,a,"oddColor",l.oddColor,void 0,o,r),fl(Number,a,"offset",l.offset,void 0,o,r),fl(Number,a,"repeat",l.repeat,void 0,o,r)):(0,d.A)(n.polylineOutline)?(a instanceof Ga||(a=new Ga),l=n.polylineOutline,fl(u.A,a,"color",l.color,void 0,o,r),fl(u.A,a,"outlineColor",l.outlineColor,void 0,o,r),fl(Number,a,"outlineWidth",l.outlineWidth,void 0,o,r)):(0,d.A)(n.polylineGlow)?(a instanceof Fa||(a=new Fa),l=n.polylineGlow,fl(u.A,a,"color",l.color,void 0,o,r),fl(Number,a,"glowPower",l.glowPower,void 0,o,r),fl(Number,a,"taperPower",l.taperPower,void 0,o,r)):(0,d.A)(n.polylineArrow)?(a instanceof Ra||(a=new Ra),l=n.polylineArrow,fl(u.A,a,"color",l.color,void 0,void 0,r)):(0,d.A)(n.polylineDash)?(a instanceof Ma.A||(a=new Ma.A),l=n.polylineDash,fl(u.A,a,"color",l.color,void 0,void 0,r),fl(u.A,a,"gapColor",l.gapColor,void 0,void 0,r),fl(Number,a,"dashLength",l.dashLength,void 0,o,r),fl(Number,a,"dashPattern",l.dashPattern,void 0,o,r)):(0,d.A)(n.checkerboard)&&(a instanceof Oi||(a=new Oi),l=n.checkerboard,fl(u.A,a,"evenColor",l.evenColor,void 0,o,r),fl(u.A,a,"oddColor",l.oddColor,void 0,o,r),fl(q.A,a,"repeat",l.repeat,void 0,o,r)),(0,d.A)(c)?c.data=a:e[t]=a}function Tl(e,t,n,i,o,r){if((0,d.A)(n))if(Array.isArray(n))for(let s=0,a=n.length;s<a;++s)vl(e,t,n[s],i,o,r);else vl(e,t,n,i,o,r)}function bl(e,t,n,i,o,r,s){const a=n.map(function(e){return Qc(o,e)});if((0,d.A)(i)){i=ll(i);let n=e[t];if(!(n instanceof s)){const i=new s;i.intervals.addInterval(ul(n)),e[t]=n=i}i.data=new r(a),n.intervals.addInterval(i)}else e[t]=new r(a)}function wl(e,t,n,i){const o=n.references;(0,d.A)(o)?bl(e,t,o,n.interval,i,Ka,ao):fl(Array,e,t,n,void 0,void 0,i)}function xl(e,t,n,i){if((0,d.A)(n))if(Array.isArray(n))for(let o=0,r=n.length;o<r;++o)wl(e,t,n[o],i);else wl(e,t,n,i)}function Cl(e,t,n,i){const o=n.references;(0,d.A)(o)?bl(e,t,o,n.interval,i,ja,po):((0,d.A)(n.cartesian)?n.array=j.A.unpackArray(n.cartesian):(0,d.A)(n.cartographicRadians)?n.array=j.A.fromRadiansArrayHeights(n.cartographicRadians,K.A.default):(0,d.A)(n.cartographicDegrees)&&(n.array=j.A.fromDegreesArrayHeights(n.cartographicDegrees,K.A.default)),(0,d.A)(n.array)&&fl(Array,e,t,n,void 0,void 0,i))}function El(e,t,n,i){if((0,d.A)(n))if(Array.isArray(n))for(let o=0,r=n.length;o<r;++o)Cl(e,t,n[o],i);else Cl(e,t,n,i)}function Sl(e){return j.A.unpackArray(e)}function Il(e){return j.A.fromRadiansArrayHeights(e,K.A.default)}function Pl(e){return j.A.fromDegreesArrayHeights(e,K.A.default)}function Dl(e,t,n,i){const o=n.references;if((0,d.A)(o)){const r=o.map(function(e){const t={};return bl(t,"positions",e,n.interval,i,ja,po),t.positions});e[t]=new ja(r)}else(0,d.A)(n.cartesian)?n.array=n.cartesian.map(Sl):(0,d.A)(n.cartographicRadians)?n.array=n.cartographicRadians.map(Il):(0,d.A)(n.cartographicDegrees)&&(n.array=n.cartographicDegrees.map(Pl)),(0,d.A)(n.array)&&fl(Array,e,t,n,void 0,void 0,i)}function Ol(e,t,n,i,o){let r=ll(t.interval);(0,d.A)(n)&&(r=(0,d.A)(r)?ji.A.intersect(r,n,Zc):n);let s=e.nodeTransformations;const a=Object.keys(t);for(let n=0,c=a.length;n<c;++n){const c=a[n];if("interval"===c)continue;const l=t[c];if(!(0,d.A)(l))continue;(0,d.A)(s)||(e.nodeTransformations=s=new $a.A),s.hasProperty(c)||s.addProperty(c);let u=s[c];(0,d.A)(u)||(s[c]=u=new Ea.A),fl(j.A,u,"translation",l.translation,r,i,o),fl(To.A,u,"rotation",l.rotation,r,i,o),fl(j.A,u,"scale",l.scale,r,i,o)}}function Rl(e,t,n,i,o){let r=ll(t.interval);(0,d.A)(n)&&(r=(0,d.A)(r)?ji.A.intersect(r,n,Zc):n);let s=e.articulations;const a=Object.keys(t);for(let n=0,c=a.length;n<c;++n){const c=a[n];if("interval"===c)continue;const l=t[c];(0,d.A)(l)&&((0,d.A)(s)||(e.articulations=s=new $a.A),s.hasProperty(c)||s.addProperty(c),fl(Number,s,c,l,r,i,o))}}function Ml(e){this.polygon=e,this._definitionChanged=new Bn.A}function Ll(e){return e?zs.A.GEODESIC:zs.A.NONE}function Nl(e,t,n,i,o){let r=e.id;if((0,d.A)(r)||(r=(0,E.A)()),jc=r,!(0,d.A)(o._version)&&"document"!==r)throw new M.A("The first CZML packet is required to be the document object.");if(!0===e.delete)t.removeById(r);else if("document"===r)!function(e,t){const n=e.version;if((0,d.A)(n)&&"string"==typeof n){const e=n.split(".");if(2===e.length){if("1"!==e[0])throw new M.A("Cesium only supports CZML version 1.");t._version=n}}if(!(0,d.A)(t._version))throw new M.A("CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.");const i=t._documentPacket;(0,d.A)(e.name)&&(i.name=e.name);const o=e.clock;if((0,d.A)(o)){const e=i.clock;(0,d.A)(e)?(e.interval=o.interval??e.interval,e.currentTime=o.currentTime??e.currentTime,e.range=o.range??e.range,e.step=o.step??e.step,e.multiplier=o.multiplier??e.multiplier):i.clock={interval:o.interval,currentTime:o.currentTime,range:o.range,step:o.step,multiplier:o.multiplier}}}(e,o);else{const o=t.getOrCreateEntity(r),s=e.parent;(0,d.A)(s)&&(o.parent=t.getOrCreateEntity(s));for(let r=n.length-1;r>-1;r--)n[r](o,e,t,i)}jc=void 0}function Bl(e,t,n,i){if(!(0,d.A)(t))throw new A.A("czml is required.");let o=t,r=(n=n??S.A.EMPTY_OBJECT).sourceUri,s=n.credit;if("string"==typeof s&&(s=new Ws.A(s)),e._credit=s,"string"==typeof t||t instanceof Lt.A){o=(t=Lt.A.createIfNeeded(t)).fetchJson(),r=r??t.clone();const n=e._resourceCredits,i=t.credits;if((0,d.A)(i)){const e=i.length;for(let t=0;t<e;t++)n.push(i[t])}}return r=Lt.A.createIfNeeded(r),sa.A.setLoading(e,!0),Promise.resolve(o).then(function(t){return function(e,t,n,i){sa.A.setLoading(e,!0);const o=e._entityCollection;i&&(e._version=void 0,e._documentPacket=new Fl,o.removeAll()),Ul._processCzml(t,o,n,void 0,e);let r=function(e){let t;const n=e._documentPacket.clock;if(!(0,d.A)(n)){if(!(0,d.A)(e._clock)){const n=e._entityCollection.computeAvailability();if(!n.start.equals(Tn.A.MINIMUM_VALUE)){const i=n.start,o=n.stop,r=te.A.secondsDifference(o,i),s=Math.round(r/120);return t=new ha,t.startTime=te.A.clone(i),t.stopTime=te.A.clone(o),t.clockRange=Hs.LOOP_STOP,t.multiplier=s,t.currentTime=te.A.clone(i),t.clockStep=Gs.SYSTEM_CLOCK_MULTIPLIER,e._clock=t,!0}}return!1}(0,d.A)(e._clock)?t=e._clock.clone():(t=new ha,t.startTime=Tn.A.MINIMUM_VALUE.clone(),t.stopTime=Tn.A.MAXIMUM_VALUE.clone(),t.currentTime=Tn.A.MINIMUM_VALUE.clone(),t.clockRange=Hs.LOOP_STOP,t.clockStep=Gs.SYSTEM_CLOCK_MULTIPLIER,t.multiplier=1);const i=ll(n.interval);return(0,d.A)(i)&&(t.startTime=i.start,t.stopTime=i.stop),(0,d.A)(n.currentTime)&&(t.currentTime=te.A.fromIso8601(n.currentTime)),(0,d.A)(n.range)&&(t.clockRange=Hs[n.range]??Hs.LOOP_STOP),(0,d.A)(n.step)&&(t.clockStep=Gs[n.step]??Gs.SYSTEM_CLOCK_MULTIPLIER),(0,d.A)(n.multiplier)&&(t.multiplier=n.multiplier),!t.equals(e._clock)&&(e._clock=t.clone(e._clock),!0)}(e);const s=e._documentPacket;return(0,d.A)(s.name)&&e._name!==s.name?(e._name=s.name,r=!0):!(0,d.A)(e._name)&&(0,d.A)(n)&&(e._name=(0,qs.A)(n.getUrlComponent()),r=!0),sa.A.setLoading(e,!1),r&&e._changed.raiseEvent(e),e}(e,t,r,i)}).catch(function(t){return sa.A.setLoading(e,!1),e._error.raiseEvent(e,t),console.log(t),Promise.reject(t)})}function Fl(){this.name=void 0,this.clock=void 0}function Ul(e){this._name=e,this._changed=new Bn.A,this._error=new Bn.A,this._isLoading=!1,this._loading=new Bn.A,this._clock=void 0,this._documentPacket=new Fl,this._version=void 0,this._entityCollection=new Ri.A(this),this._entityCluster=new fa.A,this._credit=void 0,this._resourceCredits=[]}Object.defineProperties(Ml.prototype,{isConstant:{get:function(){const e=this.polygon._positions,t=this.polygon._holes;return(!(0,d.A)(e)||e.isConstant)&&(!(0,d.A)(t)||t.isConstant)}},definitionChanged:{get:function(){return this._definitionChanged}}}),Ml.prototype.getValue=function(e,t){let n,i;return(0,d.A)(this.polygon._positions)&&(n=this.polygon._positions.getValue(e)),(0,d.A)(this.polygon._holes)&&(i=this.polygon._holes.getValue(e),(0,d.A)(i)&&(i=i.map(function(e){return new ea.A(e)}))),(0,d.A)(t)?(t.positions=n,t.holes=i,t):new ea.A(n,i)},Ml.prototype.equals=function(e){return this===e||e instanceof Ml&&Wt.A.equals(this.polygon._positions,e.polygon._positions)&&Wt.A.equals(this.polygon._holes,e.polygon._holes)},Ul.load=function(e,t){return(new Ul).load(e,t)},Object.defineProperties(Ul.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!(0,d.A)(e))throw new A.A("value must be defined.");this._entityCluster=e}},credit:{get:function(){return this._credit}}}),Ul.updaters=[function(e,t,n,i){const o=t.billboard;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.billboard;(0,d.A)(s)||(e.billboard=s=new Bt.A),fl(Boolean,s,"show",o.show,r,i,n),fl(Image,s,"image",o.image,r,i,n),fl(Number,s,"scale",o.scale,r,i,n),fl(q.A,s,"pixelOffset",o.pixelOffset,r,i,n),fl(j.A,s,"eyeOffset",o.eyeOffset,r,i,n),fl(zt.A,s,"horizontalOrigin",o.horizontalOrigin,r,i,n),fl(Ht.A,s,"verticalOrigin",o.verticalOrigin,r,i,n),fl(Vt.Ay,s,"heightReference",o.heightReference,r,i,n),fl(u.A,s,"color",o.color,r,i,n),fl(ic,s,"rotation",o.rotation,r,i,n),function(e,t,n,i,o){(0,d.A)(t)&&fl(qc,e,"alignedAxis",t,n,i,o)}(s,o.alignedAxis,r,i,n),fl(Boolean,s,"sizeInMeters",o.sizeInMeters,r,i,n),fl(Number,s,"width",o.width,r,i,n),fl(Number,s,"height",o.height,r,i,n),fl(kt.A,s,"scaleByDistance",o.scaleByDistance,r,i,n),fl(kt.A,s,"translucencyByDistance",o.translucencyByDistance,r,i,n),fl(kt.A,s,"pixelOffsetScaleByDistance",o.pixelOffsetScaleByDistance,r,i,n),fl(c.A,s,"imageSubRegion",o.imageSubRegion,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),fl(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,r,i,n)},function(e,t,n,i){const o=t.box;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.box;(0,d.A)(s)||(e.box=s=new hi.A),fl(Boolean,s,"show",o.show,r,i,n),fl(j.A,s,"dimensions",o.dimensions,r,i,n),fl(Vt.Ay,s,"heightReference",o.heightReference,r,i,n),fl(Boolean,s,"fill",o.fill,r,i,n),Tl(s,"material",o.material,r,i,n),fl(Boolean,s,"outline",o.outline,r,i,n),fl(u.A,s,"outlineColor",o.outlineColor,r,i,n),fl(Number,s,"outlineWidth",o.outlineWidth,r,i,n),fl(kn.A,s,"shadows",o.shadows,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)},function(e,t,n,i){const o=t.corridor;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.corridor;(0,d.A)(s)||(e.corridor=s=new xs.A),fl(Boolean,s,"show",o.show,r,i,n),El(s,"positions",o.positions,n),fl(Number,s,"width",o.width,r,i,n),fl(Number,s,"height",o.height,r,i,n),fl(Vt.Ay,s,"heightReference",o.heightReference,r,i,n),fl(Number,s,"extrudedHeight",o.extrudedHeight,r,i,n),fl(Vt.Ay,s,"extrudedHeightReference",o.extrudedHeightReference,r,i,n),fl(_o,s,"cornerType",o.cornerType,r,i,n),fl(Number,s,"granularity",o.granularity,r,i,n),fl(Boolean,s,"fill",o.fill,r,i,n),Tl(s,"material",o.material,r,i,n),fl(Boolean,s,"outline",o.outline,r,i,n),fl(u.A,s,"outlineColor",o.outlineColor,r,i,n),fl(Number,s,"outlineWidth",o.outlineWidth,r,i,n),fl(kn.A,s,"shadows",o.shadows,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),fl(Un.A,s,"classificationType",o.classificationType,r,i,n),fl(Number,s,"zIndex",o.zIndex,r,i,n)},function(e,t,n,i){const o=t.cylinder;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.cylinder;(0,d.A)(s)||(e.cylinder=s=new Vs.A),fl(Boolean,s,"show",o.show,r,i,n),fl(Number,s,"length",o.length,r,i,n),fl(Number,s,"topRadius",o.topRadius,r,i,n),fl(Number,s,"bottomRadius",o.bottomRadius,r,i,n),fl(Vt.Ay,s,"heightReference",o.heightReference,r,i,n),fl(Boolean,s,"fill",o.fill,r,i,n),Tl(s,"material",o.material,r,i,n),fl(Boolean,s,"outline",o.outline,r,i,n),fl(u.A,s,"outlineColor",o.outlineColor,r,i,n),fl(Number,s,"outlineWidth",o.outlineWidth,r,i,n),fl(Number,s,"numberOfVerticalLines",o.numberOfVerticalLines,r,i,n),fl(Number,s,"slices",o.slices,r,i,n),fl(kn.A,s,"shadows",o.shadows,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)},function(e,t,n,i){const o=t.ellipse;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.ellipse;(0,d.A)(s)||(e.ellipse=s=new Aa.A),fl(Boolean,s,"show",o.show,r,i,n),fl(Number,s,"semiMajorAxis",o.semiMajorAxis,r,i,n),fl(Number,s,"semiMinorAxis",o.semiMinorAxis,r,i,n),fl(Number,s,"height",o.height,r,i,n),fl(Vt.Ay,s,"heightReference",o.heightReference,r,i,n),fl(Number,s,"extrudedHeight",o.extrudedHeight,r,i,n),fl(Vt.Ay,s,"extrudedHeightReference",o.extrudedHeightReference,r,i,n),fl(ic,s,"rotation",o.rotation,r,i,n),fl(ic,s,"stRotation",o.stRotation,r,i,n),fl(Number,s,"granularity",o.granularity,r,i,n),fl(Boolean,s,"fill",o.fill,r,i,n),Tl(s,"material",o.material,r,i,n),fl(Boolean,s,"outline",o.outline,r,i,n),fl(u.A,s,"outlineColor",o.outlineColor,r,i,n),fl(Number,s,"outlineWidth",o.outlineWidth,r,i,n),fl(Number,s,"numberOfVerticalLines",o.numberOfVerticalLines,r,i,n),fl(kn.A,s,"shadows",o.shadows,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),fl(Un.A,s,"classificationType",o.classificationType,r,i,n),fl(Number,s,"zIndex",o.zIndex,r,i,n)},function(e,t,n,i){const o=t.ellipsoid;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.ellipsoid;(0,d.A)(s)||(e.ellipsoid=s=new pa.A),fl(Boolean,s,"show",o.show,r,i,n),fl(j.A,s,"radii",o.radii,r,i,n),fl(j.A,s,"innerRadii",o.innerRadii,r,i,n),fl(Number,s,"minimumClock",o.minimumClock,r,i,n),fl(Number,s,"maximumClock",o.maximumClock,r,i,n),fl(Number,s,"minimumCone",o.minimumCone,r,i,n),fl(Number,s,"maximumCone",o.maximumCone,r,i,n),fl(Vt.Ay,s,"heightReference",o.heightReference,r,i,n),fl(Boolean,s,"fill",o.fill,r,i,n),Tl(s,"material",o.material,r,i,n),fl(Boolean,s,"outline",o.outline,r,i,n),fl(u.A,s,"outlineColor",o.outlineColor,r,i,n),fl(Number,s,"outlineWidth",o.outlineWidth,r,i,n),fl(Number,s,"stackPartitions",o.stackPartitions,r,i,n),fl(Number,s,"slicePartitions",o.slicePartitions,r,i,n),fl(Number,s,"subdivisions",o.subdivisions,r,i,n),fl(kn.A,s,"shadows",o.shadows,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)},function(e,t,n,i){const o=t.label;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.label;(0,d.A)(s)||(e.label=s=new xa.A),fl(Boolean,s,"show",o.show,r,i,n),fl(String,s,"text",o.text,r,i,n),fl(String,s,"font",o.font,r,i,n),fl(oa.A,s,"style",o.style,r,i,n),fl(Number,s,"scale",o.scale,r,i,n),fl(Boolean,s,"showBackground",o.showBackground,r,i,n),fl(u.A,s,"backgroundColor",o.backgroundColor,r,i,n),fl(q.A,s,"backgroundPadding",o.backgroundPadding,r,i,n),fl(q.A,s,"pixelOffset",o.pixelOffset,r,i,n),fl(j.A,s,"eyeOffset",o.eyeOffset,r,i,n),fl(zt.A,s,"horizontalOrigin",o.horizontalOrigin,r,i,n),fl(Ht.A,s,"verticalOrigin",o.verticalOrigin,r,i,n),fl(Vt.Ay,s,"heightReference",o.heightReference,r,i,n),fl(u.A,s,"fillColor",o.fillColor,r,i,n),fl(u.A,s,"outlineColor",o.outlineColor,r,i,n),fl(Number,s,"outlineWidth",o.outlineWidth,r,i,n),fl(kt.A,s,"translucencyByDistance",o.translucencyByDistance,r,i,n),fl(kt.A,s,"pixelOffsetScaleByDistance",o.pixelOffsetScaleByDistance,r,i,n),fl(kt.A,s,"scaleByDistance",o.scaleByDistance,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),fl(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,r,i,n)},function(e,t,n,i){const o=t.model;if(!(0,d.A)(o))return;const r=ll(o.interval);let s,a,c=e.model;(0,d.A)(c)||(e.model=c=new Ca.A),fl(Boolean,c,"show",o.show,r,i,n),fl(ra,c,"uri",o.gltf,r,i,n),fl(Number,c,"scale",o.scale,r,i,n),fl(Number,c,"minimumPixelSize",o.minimumPixelSize,r,i,n),fl(Number,c,"maximumScale",o.maximumScale,r,i,n),fl(Boolean,c,"incrementallyLoadTextures",o.incrementallyLoadTextures,r,i,n),fl(Boolean,c,"runAnimations",o.runAnimations,r,i,n),fl(Boolean,c,"clampAnimations",o.clampAnimations,r,i,n),fl(kn.A,c,"shadows",o.shadows,r,i,n),fl(Vt.Ay,c,"heightReference",o.heightReference,r,i,n),fl(u.A,c,"silhouetteColor",o.silhouetteColor,r,i,n),fl(Number,c,"silhouetteSize",o.silhouetteSize,r,i,n),fl(u.A,c,"color",o.color,r,i,n),fl(ia.A,c,"colorBlendMode",o.colorBlendMode,r,i,n),fl(Number,c,"colorBlendAmount",o.colorBlendAmount,r,i,n),fl(Ut.A,c,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n);const l=o.nodeTransformations;if((0,d.A)(l))if(Array.isArray(l))for(s=0,a=l.length;s<a;++s)Ol(c,l[s],r,i,n);else Ol(c,l,r,i,n);const h=o.articulations;if((0,d.A)(h))if(Array.isArray(h))for(s=0,a=h.length;s<a;++s)Rl(c,h[s],r,i,n);else Rl(c,h,r,i,n)},function(e,t,n,i){const o=t.name;(0,d.A)(o)&&(e.name=t.name)},function(e,t,n,i){const o=t.description;(0,d.A)(o)&&fl(String,e,"description",o,void 0,i,n)},function(e,t,n,i){const o=t.path;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.path;(0,d.A)(s)||(e.path=s=new Sa.A),fl(Boolean,s,"show",o.show,r,i,n),fl(Number,s,"leadTime",o.leadTime,r,i,n),fl(Number,s,"trailTime",o.trailTime,r,i,n),fl(Number,s,"width",o.width,r,i,n),fl(Number,s,"resolution",o.resolution,r,i,n),Tl(s,"material",o.material,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)},function(e,t,n,i){const o=t.point;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.point;(0,d.A)(s)||(e.point=s=new Ia.A),fl(Boolean,s,"show",o.show,r,i,n),fl(Number,s,"pixelSize",o.pixelSize,r,i,n),fl(Vt.Ay,s,"heightReference",o.heightReference,r,i,n),fl(u.A,s,"color",o.color,r,i,n),fl(u.A,s,"outlineColor",o.outlineColor,r,i,n),fl(Number,s,"outlineWidth",o.outlineWidth,r,i,n),fl(kt.A,s,"scaleByDistance",o.scaleByDistance,r,i,n),fl(kt.A,s,"translucencyByDistance",o.translucencyByDistance,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),fl(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,r,i,n)},function(e,t,n,i){const o=t.polygon;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.polygon;(0,d.A)(s)||(e.polygon=s=new Pa.A),fl(Boolean,s,"show",o.show,r,i,n),El(s,"_positions",o.positions,n),function(e,t,n,i){if((0,d.A)(n))if(Array.isArray(n))for(let o=0,r=n.length;o<r;++o)Dl(e,t,n[o],i);else Dl(e,t,n,i)}(s,"_holes",o.holes,n),((0,d.A)(s._positions)||(0,d.A)(s._holes))&&(s.hierarchy=new Ml(s)),fl(Number,s,"height",o.height,r,i,n),fl(Vt.Ay,s,"heightReference",o.heightReference,r,i,n),fl(Number,s,"extrudedHeight",o.extrudedHeight,r,i,n),fl(Vt.Ay,s,"extrudedHeightReference",o.extrudedHeightReference,r,i,n),fl(ic,s,"stRotation",o.stRotation,r,i,n),fl(Number,s,"granularity",o.granularity,r,i,n),fl(Boolean,s,"fill",o.fill,r,i,n),Tl(s,"material",o.material,r,i,n),fl(Boolean,s,"outline",o.outline,r,i,n),fl(u.A,s,"outlineColor",o.outlineColor,r,i,n),fl(Number,s,"outlineWidth",o.outlineWidth,r,i,n),fl(Boolean,s,"perPositionHeight",o.perPositionHeight,r,i,n),fl(Boolean,s,"closeTop",o.closeTop,r,i,n),fl(Boolean,s,"closeBottom",o.closeBottom,r,i,n),fl(zs.A,s,"arcType",o.arcType,r,i,n),fl(kn.A,s,"shadows",o.shadows,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),fl(Un.A,s,"classificationType",o.classificationType,r,i,n),fl(Number,s,"zIndex",o.zIndex,r,i,n)},function(e,t,n,i){const o=t.polyline;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.polyline;if((0,d.A)(s)||(e.polyline=s=new Ua.A),fl(Boolean,s,"show",o.show,r,i,n),El(s,"positions",o.positions,n),fl(Number,s,"width",o.width,r,i,n),fl(Number,s,"granularity",o.granularity,r,i,n),Tl(s,"material",o.material,r,i,n),Tl(s,"depthFailMaterial",o.depthFailMaterial,r,i,n),fl(zs.A,s,"arcType",o.arcType,r,i,n),fl(Boolean,s,"clampToGround",o.clampToGround,r,i,n),fl(kn.A,s,"shadows",o.shadows,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),fl(Un.A,s,"classificationType",o.classificationType,r,i,n),fl(Number,s,"zIndex",o.zIndex,r,i,n),(0,d.A)(o.followSurface)&&!(0,d.A)(o.arcType)){const e={};fl(Boolean,e,"followSurface",o.followSurface,r,i,n),s.arcType=(a=e.followSurface,c=Ll,new Jn.A(function(e,t){return c(a.getValue(e,t))},a.isConstant))}var a,c},function(e,t,n,i){const o=t.polylineVolume;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.polylineVolume;(0,d.A)(s)||(e.polylineVolume=s=new Wa.A),El(s,"positions",o.positions,n),function(e,t,n,i){if((0,d.A)(n))if(Array.isArray(n))for(let o=0,r=n.length;o<r;o++)yl(e,t,n[o],i);else yl(e,t,n,i)}(s,"shape",o.shape,n),fl(Boolean,s,"show",o.show,r,i,n),fl(_o,s,"cornerType",o.cornerType,r,i,n),fl(Boolean,s,"fill",o.fill,r,i,n),Tl(s,"material",o.material,r,i,n),fl(Boolean,s,"outline",o.outline,r,i,n),fl(u.A,s,"outlineColor",o.outlineColor,r,i,n),fl(Number,s,"outlineWidth",o.outlineWidth,r,i,n),fl(Number,s,"granularity",o.granularity,r,i,n),fl(kn.A,s,"shadows",o.shadows,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)},function(e,t,n,i){const o=t.properties;if((0,d.A)(o)){(0,d.A)(e.properties)||(e.properties=new $a.A);for(const t in o)if(o.hasOwnProperty(t)){e.properties.hasProperty(t)||e.properties.addProperty(t);const r=o[t];if(Array.isArray(r))for(let o=0,s=r.length;o<s;++o)Al(rl(r[o]),e.properties,t,r[o],void 0,i,n);else Al(rl(r),e.properties,t,r,void 0,i,n)}}},function(e,t,n,i){const o=t.rectangle;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.rectangle;(0,d.A)(s)||(e.rectangle=s=new Ja.A),fl(Boolean,s,"show",o.show,r,i,n),fl(Or.A,s,"coordinates",o.coordinates,r,i,n),fl(Number,s,"height",o.height,r,i,n),fl(Vt.Ay,s,"heightReference",o.heightReference,r,i,n),fl(Number,s,"extrudedHeight",o.extrudedHeight,r,i,n),fl(Vt.Ay,s,"extrudedHeightReference",o.extrudedHeightReference,r,i,n),fl(ic,s,"rotation",o.rotation,r,i,n),fl(ic,s,"stRotation",o.stRotation,r,i,n),fl(Number,s,"granularity",o.granularity,r,i,n),fl(Boolean,s,"fill",o.fill,r,i,n),Tl(s,"material",o.material,r,i,n),fl(Boolean,s,"outline",o.outline,r,i,n),fl(u.A,s,"outlineColor",o.outlineColor,r,i,n),fl(Number,s,"outlineWidth",o.outlineWidth,r,i,n),fl(kn.A,s,"shadows",o.shadows,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),fl(Un.A,s,"classificationType",o.classificationType,r,i,n),fl(Number,s,"zIndex",o.zIndex,r,i,n)},function(e,t,n,i){const o=t.position;(0,d.A)(o)&&_l(e,"position",o,void 0,0,n)},function(e,t,n,i){const o=t.tileset;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.tileset;(0,d.A)(s)||(e.tileset=s=new _i.A),fl(Boolean,s,"show",o.show,r,i,n),fl(ra,s,"uri",o.uri,r,i,n),fl(Number,s,"maximumScreenSpaceError",o.maximumScreenSpaceError,r,i,n)},function(e,t,n,i){const o=t.viewFrom;(0,d.A)(o)&&fl(j.A,e,"viewFrom",o,void 0,i,n)},function(e,t,n,i){const o=t.wall;if(!(0,d.A)(o))return;const r=ll(o.interval);let s=e.wall;(0,d.A)(s)||(e.wall=s=new Gc.A),fl(Boolean,s,"show",o.show,r,i,n),El(s,"positions",o.positions,n),xl(s,"minimumHeights",o.minimumHeights,n),xl(s,"maximumHeights",o.maximumHeights,n),fl(Number,s,"granularity",o.granularity,r,i,n),fl(Boolean,s,"fill",o.fill,r,i,n),Tl(s,"material",o.material,r,i,n),fl(Boolean,s,"outline",o.outline,r,i,n),fl(u.A,s,"outlineColor",o.outlineColor,r,i,n),fl(Number,s,"outlineWidth",o.outlineWidth,r,i,n),fl(kn.A,s,"shadows",o.shadows,r,i,n),fl(Ut.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)},function(e,t,n,i){const o=t.orientation;(0,d.A)(o)&&fl(To.A,e,"orientation",o,void 0,i,n)},function(e,t,n,i){const o=t.availability;if(!(0,d.A)(o))return;let r;if(Array.isArray(o))for(let e=0,t=o.length;e<t;++e)(0,d.A)(r)||(r=new oo),r.addInterval(ll(o[e]));else r=new oo,r.addInterval(ll(o));e.availability=r}],Ul.registerUpdater=function(e){Ul.updaters.includes(e)||Ul.updaters.push(e)},Ul.unregisterUpdater=function(e){if(Ul.updaters.includes(e)){const t=Ul.updaters.indexOf(e);Ul.updaters.splice(t,1)}},Ul.prototype.process=function(e,t){return Bl(this,e,t,!1)},Ul.prototype.load=function(e,t){return Bl(this,e,t,!0)},Ul.prototype.update=function(e){return!0},Ul.processPacketData=fl,Ul.processPositionPacketData=_l,Ul.processMaterialPacketData=Tl,Ul._processCzml=function(e,t,n,i,o){if(i=i??Ul.updaters,Array.isArray(e))for(let r=0,s=e.length;r<s;++r)Nl(e[r],t,i,n,o);else Nl(e,t,i,n,o)};const kl=Ul;function Vl(){this._dataSources=[],this._dataSourceAdded=new Bn.A,this._dataSourceRemoved=new Bn.A,this._dataSourceMoved=new Bn.A}function zl(e,t){if(!(0,d.A)(t))throw new A.A("dataSource is required.");const n=e.indexOf(t);if(-1===n)throw new A.A("dataSource is not in this collection.");return n}function Hl(e,t,n){const i=e._dataSources,o=i.length-1;if((t=J.A.clamp(t,0,o))===(n=J.A.clamp(n,0,o)))return;const r=i[t];i[t]=i[n],i[n]=r,e.dataSourceMoved.raiseEvent(r,n,t)}Object.defineProperties(Vl.prototype,{length:{get:function(){return this._dataSources.length}},dataSourceAdded:{get:function(){return this._dataSourceAdded}},dataSourceRemoved:{get:function(){return this._dataSourceRemoved}},dataSourceMoved:{get:function(){return this._dataSourceMoved}}}),Vl.prototype.add=function(e){if(!(0,d.A)(e))throw new A.A("dataSource is required.");const t=this,n=this._dataSources;return Promise.resolve(e).then(function(e){return n===t._dataSources&&(t._dataSources.push(e),t._dataSourceAdded.raiseEvent(t,e)),e})},Vl.prototype.remove=function(e,t){t=t??!1;const n=this._dataSources.indexOf(e);return-1!==n&&(this._dataSources.splice(n,1),this._dataSourceRemoved.raiseEvent(this,e),t&&"function"==typeof e.destroy&&e.destroy(),!0)},Vl.prototype.removeAll=function(e){e=e??!1;const t=this._dataSources;for(let n=0,i=t.length;n<i;++n){const i=t[n];this._dataSourceRemoved.raiseEvent(this,i),e&&"function"==typeof i.destroy&&i.destroy()}this._dataSources=[]},Vl.prototype.contains=function(e){return-1!==this.indexOf(e)},Vl.prototype.indexOf=function(e){return this._dataSources.indexOf(e)},Vl.prototype.get=function(e){if(!(0,d.A)(e))throw new A.A("index is required.");return this._dataSources[e]},Vl.prototype.getByName=function(e){if(!(0,d.A)(e))throw new A.A("name is required.");return this._dataSources.filter(function(t){return t.name===e})},Vl.prototype.raise=function(e){const t=zl(this._dataSources,e);Hl(this,t,t+1)},Vl.prototype.lower=function(e){const t=zl(this._dataSources,e);Hl(this,t,t-1)},Vl.prototype.raiseToTop=function(e){const t=zl(this._dataSources,e);t!==this._dataSources.length-1&&(this._dataSources.splice(t,1),this._dataSources.push(e),this.dataSourceMoved.raiseEvent(e,this._dataSources.length-1,t))},Vl.prototype.lowerToBottom=function(e){const t=zl(this._dataSources,e);0!==t&&(this._dataSources.splice(t,1),this._dataSources.splice(0,0,e),this.dataSourceMoved.raiseEvent(e,0,t))},Vl.prototype.isDestroyed=function(){return!1},Vl.prototype.destroy=function(){return this.removeAll(!0),(0,h.A)(this)};const Gl=Vl;var Wl=n(433052),Yl=n(493721);function ql(){this._length=0,this._collections={},this._collectionsArray=[],this.show=!0}Object.defineProperties(ql.prototype,{length:{get:function(){return this._length}}}),ql.prototype.add=function(e,t){l.A.defined("primitive",e),(0,d.A)(t)&&l.A.typeOf.number("zIndex",t),t=t??0;let n=this._collections[t];if(!(0,d.A)(n)){n=new Yl.A({destroyPrimitives:!1}),n._zIndex=t,this._collections[t]=n;const e=this._collectionsArray;let i=0;for(;i<e.length&&e[i]._zIndex<t;)i++;e.splice(i,0,n)}return n.add(e),this._length++,e._zIndex=t,e},ql.prototype.set=function(e,t){return l.A.defined("primitive",e),l.A.typeOf.number("zIndex",t),t===e._zIndex||(this.remove(e,!0),this.add(e,t)),e},ql.prototype.remove=function(e,t){if(this.contains(e)){const n=e._zIndex,i=this._collections[n];let o;return o=t?i.remove(e):i.removeAndDestroy(e),o&&this._length--,0===i.length&&(this._collectionsArray.splice(this._collectionsArray.indexOf(i),1),this._collections[n]=void 0,i.destroy()),o}return!1},ql.prototype.removeAll=function(){const e=this._collectionsArray;for(let t=0;t<e.length;t++){const n=e[t];n.destroyPrimitives=!0,n.destroy()}this._collections={},this._collectionsArray=[],this._length=0},ql.prototype.contains=function(e){if(!(0,d.A)(e))return!1;const t=this._collections[e._zIndex];return(0,d.A)(t)&&t.contains(e)},ql.prototype.update=function(e){if(!this.show)return;const t=this._collectionsArray;for(let n=0;n<t.length;n++)t[n].update(e)},ql.prototype.isDestroyed=function(){return!1},ql.prototype.destroy=function(){return this.removeAll(),(0,h.A)(this)};const jl=ql;function Ql(e,t){this._primitives=e,this._orderedGroundPrimitives=t,this._dynamicUpdaters=new Ft.A}Ql.prototype.add=function(e,t){this._dynamicUpdaters.set(t.id,t.createDynamicUpdater(this._primitives,this._orderedGroundPrimitives))},Ql.prototype.remove=function(e){const t=e.id,n=this._dynamicUpdaters.get(t);(0,d.A)(n)&&(this._dynamicUpdaters.remove(t),n.destroy())},Ql.prototype.update=function(e){const t=this._dynamicUpdaters.values;for(let n=0,i=t.length;n<i;n++)t[n].update(e);return!0},Ql.prototype.removeAllPrimitives=function(){const e=this._dynamicUpdaters.values;for(let t=0,n=e.length;t<n;t++)e[t].destroy();this._dynamicUpdaters.removeAll()},Ql.prototype.getBoundingSphere=function(e,t){return e=this._dynamicUpdaters.get(e.id),(0,d.A)(e)&&(0,d.A)(e.getBoundingSphere)?e.getBoundingSphere(t):Gt.FAILED};const Xl=Ql;var Kl=n(602317),$l=n(715726);const Jl=new j.A;let Zl=new j.A;const eu=new Sn.A,tu=new Sn.A;function nu(e){const t=(e=e??S.A.EMPTY_OBJECT).center,n=e.ellipsoid??K.A.default,i=e.semiMajorAxis,o=e.semiMinorAxis,r=e.granularity??J.A.RADIANS_PER_DEGREE;if(!(0,d.A)(t))throw new A.A("center is required.");if(!(0,d.A)(i))throw new A.A("semiMajorAxis is required.");if(!(0,d.A)(o))throw new A.A("semiMinorAxis is required.");if(i<o)throw new A.A("semiMajorAxis must be greater than or equal to the semiMinorAxis.");if(r<=0)throw new A.A("granularity must be greater than zero.");const s=e.height??0,a=e.extrudedHeight??s;this._center=j.A.clone(t),this._semiMajorAxis=i,this._semiMinorAxis=o,this._ellipsoid=K.A.clone(n),this._rotation=e.rotation??0,this._height=Math.max(a,s),this._granularity=r,this._extrudedHeight=Math.min(a,s),this._numberOfVerticalLines=Math.max(e.numberOfVerticalLines??16,0),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipseOutlineGeometry"}nu.packedLength=j.A.packedLength+K.A.packedLength+8,nu.pack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("value is required");if(!(0,d.A)(t))throw new A.A("array is required");return n=n??0,j.A.pack(e._center,t,n),n+=j.A.packedLength,K.A.pack(e._ellipsoid,t,n),n+=K.A.packedLength,t[n++]=e._semiMajorAxis,t[n++]=e._semiMinorAxis,t[n++]=e._rotation,t[n++]=e._height,t[n++]=e._granularity,t[n++]=e._extrudedHeight,t[n++]=e._numberOfVerticalLines,t[n]=e._offsetAttribute??-1,t};const iu=new j.A,ou=new K.A,ru={center:iu,ellipsoid:ou,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};nu.unpack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("array is required");t=t??0;const i=j.A.unpack(e,t,iu);t+=j.A.packedLength;const o=K.A.unpack(e,t,ou);t+=K.A.packedLength;const r=e[t++],s=e[t++],a=e[t++],c=e[t++],l=e[t++],u=e[t++],h=e[t++],p=e[t];return(0,d.A)(n)?(n._center=j.A.clone(i,n._center),n._ellipsoid=K.A.clone(o,n._ellipsoid),n._semiMajorAxis=r,n._semiMinorAxis=s,n._rotation=a,n._height=c,n._granularity=l,n._extrudedHeight=u,n._numberOfVerticalLines=h,n._offsetAttribute=-1===p?void 0:p,n):(ru.height=c,ru.extrudedHeight=u,ru.granularity=l,ru.rotation=a,ru.semiMajorAxis=r,ru.semiMinorAxis=s,ru.numberOfVerticalLines=h,ru.offsetAttribute=-1===p?void 0:p,new nu(ru))},nu.createGeometry=function(e){if(e._semiMajorAxis<=0||e._semiMinorAxis<=0)return;const t=e._height,n=e._extrudedHeight,i=!J.A.equalsEpsilon(t,n,0,J.A.EPSILON2);e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);const o={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:t,granularity:e._granularity,numberOfVerticalLines:e._numberOfVerticalLines};let r;if(i)o.extrudedHeight=n,o.offsetAttribute=e._offsetAttribute,r=function(e){const t=e.center,n=e.ellipsoid,i=e.semiMajorAxis;let o=j.A.multiplyByScalar(n.geodeticSurfaceNormal(t,Jl),e.height,Jl);eu.center=j.A.add(t,o,eu.center),eu.radius=i,o=j.A.multiplyByScalar(n.geodeticSurfaceNormal(t,o),e.extrudedHeight,o),tu.center=j.A.add(t,o,tu.center),tu.radius=i;let r=$l.A.computeEllipsePositions(e,!1,!0).outerPositions;const s=new Ir.A({position:new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:$l.A.raisePositionsToHeight(r,e,!0)})});r=s.position.values;const a=Sn.A.union(eu,tu);let c=r.length/3;if((0,d.A)(e.offsetAttribute)){let t=new Uint8Array(c);if(e.offsetAttribute===vn.A.TOP)t=t.fill(1,0,c/2);else{const n=e.offsetAttribute===vn.A.NONE?0:1;t=t.fill(n)}s.applyOffset=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}let l=e.numberOfVerticalLines??16;l=J.A.clamp(l,0,c/2);const u=Pr.A.createTypedArray(c,2*c+2*l);c/=2;let h,A,p=0;for(h=0;h<c;++h)u[p++]=h,u[p++]=(h+1)%c,u[p++]=h+c,u[p++]=(h+1)%c+c;if(l>0){const e=Math.min(l,c);A=Math.round(c/e);const t=Math.min(A*l,c);for(h=0;h<t;h+=A)u[p++]=h,u[p++]=h+c}return{boundingSphere:a,attributes:s,indices:u}}(o);else if(r=function(e){const t=e.center;Zl=j.A.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(t,Zl),e.height,Zl),Zl=j.A.add(t,Zl,Zl);const n=new Sn.A(Zl,e.semiMajorAxis),i=$l.A.computeEllipsePositions(e,!1,!0).outerPositions,o=new Ir.A({position:new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:$l.A.raisePositionsToHeight(i,e,!1)})}),r=i.length/3,s=Pr.A.createTypedArray(r,2*r);let a=0;for(let e=0;e<r;++e)s[a++]=e,s[a++]=(e+1)%r;return{boundingSphere:n,attributes:o,indices:s}}(o),(0,d.A)(e._offsetAttribute)){const t=r.attributes.position.values.length,n=e._offsetAttribute===vn.A.NONE?0:1,i=new Uint8Array(t/3).fill(n);r.attributes.applyOffset=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}return new I.A({attributes:r.attributes,indices:r.indices,primitiveType:p.A.LINES,boundingSphere:r.boundingSphere,offsetAttribute:e._offsetAttribute})};const su=nu,au=new u.A,cu=j.A.ZERO,lu=new j.A,uu=new Or.A;function du(e){this.id=e,this.vertexFormat=void 0,this.center=void 0,this.semiMajorAxis=void 0,this.semiMinorAxis=void 0,this.rotation=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function hu(e,t){fs.call(this,{entity:e,scene:t,geometryOptions:new du(e),geometryPropertyName:"ellipse",observedPropertyNames:["availability","position","ellipse"]}),this._onEntityPropertyChanged(e,"ellipse",e.ellipse,void 0)}function Au(e,t,n){Nn.call(this,e,t,n)}(0,d.A)(Object.create)&&(hu.prototype=Object.create(fs.prototype),hu.prototype.constructor=hu),hu.prototype.createFillGeometryInstance=function(e){if(l.A.defined("time",e),!this._fillEnabled)throw new A.A("This instance does not represent a filled geometry.");const t=this._entity,n=t.isAvailable(e),i={show:new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:_n.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof En.A){let t;(0,d.A)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,au)),(0,d.A)(t)||(t=u.A.WHITE),i.color=mn.A.fromColor(t)}return(0,d.A)(this._options.offsetAttribute)&&(i.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,cu,lu))),new yn.A({id:t,geometry:new Kl.A(this._options),attributes:i})},hu.prototype.createOutlineGeometryInstance=function(e){if(l.A.defined("time",e),!this._outlineEnabled)throw new A.A("This instance does not represent an outlined geometry.");const t=this._entity,n=t.isAvailable(e),i=Wt.A.getValueOrDefault(this._outlineColorProperty,e,u.A.BLACK,au),o=this._distanceDisplayConditionProperty.getValue(e),r={show:new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:mn.A.fromColor(i),distanceDisplayCondition:_n.fromDistanceDisplayCondition(o),offset:void 0};return(0,d.A)(this._options.offsetAttribute)&&(r.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,cu,lu))),new yn.A({id:t,geometry:new su(this._options),attributes:r})},hu.prototype._computeCenter=function(e,t){return Wt.A.getValueOrUndefined(this._entity.position,e,t)},hu.prototype._isHidden=function(e,t){const n=e.position;return!(0,d.A)(n)||!(0,d.A)(t.semiMajorAxis)||!(0,d.A)(t.semiMinorAxis)||$n.prototype._isHidden.call(this,e,t)},hu.prototype._isDynamic=function(e,t){return!e.position.isConstant||!t.semiMajorAxis.isConstant||!t.semiMinorAxis.isConstant||!Wt.A.isConstant(t.rotation)||!Wt.A.isConstant(t.height)||!Wt.A.isConstant(t.extrudedHeight)||!Wt.A.isConstant(t.granularity)||!Wt.A.isConstant(t.stRotation)||!Wt.A.isConstant(t.outlineWidth)||!Wt.A.isConstant(t.numberOfVerticalLines)||!Wt.A.isConstant(t.zIndex)||this._onTerrain&&!Wt.A.isConstant(this._materialProperty)&&!(this._materialProperty instanceof En.A)},hu.prototype._setStaticOptions=function(e,t){let n=Wt.A.getValueOrUndefined(t.height,Tn.A.MINIMUM_VALUE);const i=Wt.A.getValueOrDefault(t.heightReference,Tn.A.MINIMUM_VALUE,Vt.Ay.NONE);let o=Wt.A.getValueOrUndefined(t.extrudedHeight,Tn.A.MINIMUM_VALUE);const r=Wt.A.getValueOrDefault(t.extrudedHeightReference,Tn.A.MINIMUM_VALUE,Vt.Ay.NONE);(0,d.A)(o)&&!(0,d.A)(n)&&(n=0);const s=this._options;s.vertexFormat=this._materialProperty instanceof En.A?Cn.A.VERTEX_FORMAT:xn.A.MaterialSupport.TEXTURED.vertexFormat,s.center=e.position.getValue(Tn.A.MINIMUM_VALUE,s.center),s.semiMajorAxis=t.semiMajorAxis.getValue(Tn.A.MINIMUM_VALUE,s.semiMajorAxis),s.semiMinorAxis=t.semiMinorAxis.getValue(Tn.A.MINIMUM_VALUE,s.semiMinorAxis),s.rotation=Wt.A.getValueOrUndefined(t.rotation,Tn.A.MINIMUM_VALUE),s.granularity=Wt.A.getValueOrUndefined(t.granularity,Tn.A.MINIMUM_VALUE),s.stRotation=Wt.A.getValueOrUndefined(t.stRotation,Tn.A.MINIMUM_VALUE),s.numberOfVerticalLines=Wt.A.getValueOrUndefined(t.numberOfVerticalLines,Tn.A.MINIMUM_VALUE),s.offsetAttribute=fs.computeGeometryOffsetAttribute(n,i,o,r),s.height=fs.getGeometryHeight(n,i),o=fs.getGeometryExtrudedHeight(o,r),o===fs.CLAMP_TO_GROUND&&(o=mo.A.getMinimumMaximumHeights(Kl.A.computeRectangle(s,uu)).minimumTerrainHeight),s.extrudedHeight=o},hu.DynamicGeometryUpdater=Au,(0,d.A)(Object.create)&&(Au.prototype=Object.create(Nn.prototype),Au.prototype.constructor=Au),Au.prototype._isHidden=function(e,t,n){const i=this._options;return!(0,d.A)(i.center)||!(0,d.A)(i.semiMajorAxis)||!(0,d.A)(i.semiMinorAxis)||Nn.prototype._isHidden.call(this,e,t,n)},Au.prototype._setOptions=function(e,t,n){const i=this._options;let o=Wt.A.getValueOrUndefined(t.height,n);const r=Wt.A.getValueOrDefault(t.heightReference,n,Vt.Ay.NONE);let s=Wt.A.getValueOrUndefined(t.extrudedHeight,n);const a=Wt.A.getValueOrDefault(t.extrudedHeightReference,n,Vt.Ay.NONE);(0,d.A)(s)&&!(0,d.A)(o)&&(o=0),i.center=Wt.A.getValueOrUndefined(e.position,n,i.center),i.semiMajorAxis=Wt.A.getValueOrUndefined(t.semiMajorAxis,n),i.semiMinorAxis=Wt.A.getValueOrUndefined(t.semiMinorAxis,n),i.rotation=Wt.A.getValueOrUndefined(t.rotation,n),i.granularity=Wt.A.getValueOrUndefined(t.granularity,n),i.stRotation=Wt.A.getValueOrUndefined(t.stRotation,n),i.numberOfVerticalLines=Wt.A.getValueOrUndefined(t.numberOfVerticalLines,n),i.offsetAttribute=fs.computeGeometryOffsetAttribute(o,r,s,a),i.height=fs.getGeometryHeight(o,r),s=fs.getGeometryExtrudedHeight(s,a),s===fs.CLAMP_TO_GROUND&&(s=mo.A.getMinimumMaximumHeights(Kl.A.computeRectangle(i,uu)).minimumTerrainHeight),i.extrudedHeight=s};const pu=hu,fu=new j.A,mu=new j.A,gu=new j.A,_u=new j.A,yu=new j.A,vu=new j.A(1,1,1),Tu=Math.cos,bu=Math.sin;function wu(e){const t=(e=e??S.A.EMPTY_OBJECT).radii??vu,n=e.innerRadii??t,i=e.minimumClock??0,o=e.maximumClock??J.A.TWO_PI,r=e.minimumCone??0,s=e.maximumCone??J.A.PI,a=Math.round(e.stackPartitions??64),c=Math.round(e.slicePartitions??64),l=e.vertexFormat??Rr.A.DEFAULT;if(c<3)throw new A.A("options.slicePartitions cannot be less than three.");if(a<3)throw new A.A("options.stackPartitions cannot be less than three.");this._radii=j.A.clone(t),this._innerRadii=j.A.clone(n),this._minimumClock=i,this._maximumClock=o,this._minimumCone=r,this._maximumCone=s,this._stackPartitions=a,this._slicePartitions=c,this._vertexFormat=Rr.A.clone(l),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipsoidGeometry"}wu.packedLength=2*j.A.packedLength+Rr.A.packedLength+7,wu.pack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("value is required");if(!(0,d.A)(t))throw new A.A("array is required");return n=n??0,j.A.pack(e._radii,t,n),n+=j.A.packedLength,j.A.pack(e._innerRadii,t,n),n+=j.A.packedLength,Rr.A.pack(e._vertexFormat,t,n),n+=Rr.A.packedLength,t[n++]=e._minimumClock,t[n++]=e._maximumClock,t[n++]=e._minimumCone,t[n++]=e._maximumCone,t[n++]=e._stackPartitions,t[n++]=e._slicePartitions,t[n]=e._offsetAttribute??-1,t};const xu=new j.A,Cu=new j.A,Eu=new Rr.A,Su={radii:xu,innerRadii:Cu,vertexFormat:Eu,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};let Iu;wu.unpack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("array is required");t=t??0;const i=j.A.unpack(e,t,xu);t+=j.A.packedLength;const o=j.A.unpack(e,t,Cu);t+=j.A.packedLength;const r=Rr.A.unpack(e,t,Eu);t+=Rr.A.packedLength;const s=e[t++],a=e[t++],c=e[t++],l=e[t++],u=e[t++],h=e[t++],p=e[t];return(0,d.A)(n)?(n._radii=j.A.clone(i,n._radii),n._innerRadii=j.A.clone(o,n._innerRadii),n._vertexFormat=Rr.A.clone(r,n._vertexFormat),n._minimumClock=s,n._maximumClock=a,n._minimumCone=c,n._maximumCone=l,n._stackPartitions=u,n._slicePartitions=h,n._offsetAttribute=-1===p?void 0:p,n):(Su.minimumClock=s,Su.maximumClock=a,Su.minimumCone=c,Su.maximumCone=l,Su.stackPartitions=u,Su.slicePartitions=h,Su.offsetAttribute=-1===p?void 0:p,new wu(Su))},wu.createGeometry=function(e){const t=e._radii;if(t.x<=0||t.y<=0||t.z<=0)return;const n=e._innerRadii;if(n.x<=0||n.y<=0||n.z<=0)return;const i=e._minimumClock,o=e._maximumClock,r=e._minimumCone,s=e._maximumCone,a=e._vertexFormat;let c,l,u=e._slicePartitions+1,h=e._stackPartitions+1;u=Math.round(u*Math.abs(o-i)/J.A.TWO_PI),h=Math.round(h*Math.abs(s-r)/J.A.PI),u<2&&(u=2),h<2&&(h=2);let A=0;const f=[r],m=[i];for(c=0;c<h;c++)f.push(r+c*(s-r)/(h-1));for(f.push(s),l=0;l<u;l++)m.push(i+l*(o-i)/(u-1));m.push(o);const g=f.length,_=m.length;let y=0,v=1;const T=n.x!==t.x||n.y!==t.y||n.z!==t.z;let b=!1,w=!1,x=!1;T&&(v=2,r>0&&(b=!0,y+=u-1),s<Math.PI&&(w=!0,y+=u-1),(o-i)%J.A.TWO_PI?(x=!0,y+=2*(h-1)+1):y+=1);const E=_*g*v,S=new Float64Array(3*E),D=new Array(E).fill(!1),O=new Array(E).fill(!1),R=u*h*v,M=6*(R+y+1-(u+h)*v),L=Pr.A.createTypedArray(R,M),N=a.normal?new Float32Array(3*E):void 0,B=a.tangent?new Float32Array(3*E):void 0,F=a.bitangent?new Float32Array(3*E):void 0,U=a.st?new Float32Array(2*E):void 0,k=new Array(g),V=new Array(g);for(c=0;c<g;c++)k[c]=bu(f[c]),V[c]=Tu(f[c]);const z=new Array(_),H=new Array(_);for(l=0;l<_;l++)H[l]=Tu(m[l]),z[l]=bu(m[l]);for(c=0;c<g;c++)for(l=0;l<_;l++)S[A++]=t.x*k[c]*H[l],S[A++]=t.y*k[c]*z[l],S[A++]=t.z*V[c];let G,W,Y,Q,X=E/2;if(T)for(c=0;c<g;c++)for(l=0;l<_;l++)S[A++]=n.x*k[c]*H[l],S[A++]=n.y*k[c]*z[l],S[A++]=n.z*V[c],D[X]=!0,c>0&&c!==g-1&&0!==l&&l!==_-1&&(O[X]=!0),X++;for(A=0,c=1;c<g-2;c++)for(G=c*_,W=(c+1)*_,l=1;l<_-2;l++)L[A++]=W+l,L[A++]=W+l+1,L[A++]=G+l+1,L[A++]=W+l,L[A++]=G+l+1,L[A++]=G+l;if(T){const e=g*_;for(c=1;c<g-2;c++)for(G=e+c*_,W=e+(c+1)*_,l=1;l<_-2;l++)L[A++]=W+l,L[A++]=G+l,L[A++]=G+l+1,L[A++]=W+l,L[A++]=G+l+1,L[A++]=W+l+1}if(T){if(b)for(Q=g*_,c=1;c<_-2;c++)L[A++]=c,L[A++]=c+1,L[A++]=Q+c+1,L[A++]=c,L[A++]=Q+c+1,L[A++]=Q+c;if(w)for(Y=g*_-_,Q=g*_*v-_,c=1;c<_-2;c++)L[A++]=Y+c+1,L[A++]=Y+c,L[A++]=Q+c,L[A++]=Y+c+1,L[A++]=Q+c,L[A++]=Q+c+1}if(x){for(c=1;c<g-2;c++)Q=_*g+_*c,Y=_*c,L[A++]=Q,L[A++]=Y+_,L[A++]=Y,L[A++]=Q,L[A++]=Q+_,L[A++]=Y+_;for(c=1;c<g-2;c++)Q=_*g+_*(c+1)-1,Y=_*(c+1)-1,L[A++]=Y+_,L[A++]=Q,L[A++]=Y,L[A++]=Y+_,L[A++]=Q+_,L[A++]=Q}const $=new Ir.A;a.position&&($.position=new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:S}));let Z=0,ee=0,te=0,ne=0;const ie=E/2;let oe;const re=K.A.fromCartesian3(t),se=K.A.fromCartesian3(n);if(a.st||a.normal||a.tangent||a.bitangent){for(c=0;c<E;c++){oe=D[c]?se:re;const e=j.A.fromArray(S,3*c,fu),t=oe.geodeticSurfaceNormal(e,mu);if(O[c]&&j.A.negate(t,t),a.st){const e=q.A.negate(t,yu);U[Z++]=Math.atan2(e.y,e.x)/J.A.TWO_PI+.5,U[Z++]=Math.asin(t.z)/Math.PI+.5}if(a.normal&&(N[ee++]=t.x,N[ee++]=t.y,N[ee++]=t.z),a.tangent||a.bitangent){const e=gu;let n,i=0;if(D[c]&&(i=ie),n=!b&&c>=i&&c<i+2*_?j.A.UNIT_X:j.A.UNIT_Z,j.A.cross(n,t,e),j.A.normalize(e,e),a.tangent&&(B[te++]=e.x,B[te++]=e.y,B[te++]=e.z),a.bitangent){const n=j.A.cross(t,e,_u);j.A.normalize(n,n),F[ne++]=n.x,F[ne++]=n.y,F[ne++]=n.z}}}a.st&&($.st=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:2,values:U})),a.normal&&($.normal=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:N})),a.tangent&&($.tangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:B})),a.bitangent&&($.bitangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:F}))}if((0,d.A)(e._offsetAttribute)){const t=S.length,n=e._offsetAttribute===vn.A.NONE?0:1,i=new Uint8Array(t/3).fill(n);$.applyOffset=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}return new I.A({attributes:$,indices:L,primitiveType:p.A.TRIANGLES,boundingSphere:Sn.A.fromEllipsoid(re),offsetAttribute:e._offsetAttribute})},wu.getUnitEllipsoid=function(){return(0,d.A)(Iu)||(Iu=wu.createGeometry(new wu({radii:new j.A(1,1,1),vertexFormat:Rr.A.POSITION_ONLY}))),Iu};const Pu=wu;var Du=n(594706);const Ou=new En.A(u.A.WHITE),Ru=j.A.ZERO,Mu=new j.A,Lu=new j.A,Nu=new j.A,Bu=new u.A,Fu=new j.A(1,1,1);function Uu(e){this.id=e,this.vertexFormat=void 0,this.radii=void 0,this.innerRadii=void 0,this.minimumClock=void 0,this.maximumClock=void 0,this.minimumCone=void 0,this.maximumCone=void 0,this.stackPartitions=void 0,this.slicePartitions=void 0,this.subdivisions=void 0,this.offsetAttribute=void 0}function ku(e,t){$n.call(this,{entity:e,scene:t,geometryOptions:new Uu(e),geometryPropertyName:"ellipsoid",observedPropertyNames:["availability","position","orientation","ellipsoid"]}),this._onEntityPropertyChanged(e,"ellipsoid",e.ellipsoid,void 0)}function Vu(e,t,n){Nn.call(this,e,t,n),this._scene=e._scene,this._modelMatrix=new O.A,this._attributes=void 0,this._outlineAttributes=void 0,this._lastSceneMode=void 0,this._lastShow=void 0,this._lastOutlineShow=void 0,this._lastOutlineWidth=void 0,this._lastOutlineColor=void 0,this._lastOffset=new j.A,this._material={}}(0,d.A)(Object.create)&&(ku.prototype=Object.create($n.prototype),ku.prototype.constructor=ku),Object.defineProperties(ku.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),ku.prototype.createFillGeometryInstance=function(e,t,n){l.A.defined("time",e);const i=this._entity,o=i.isAvailable(e);let r;const s=new wn.A(o&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),a=this._distanceDisplayConditionProperty.getValue(e),c={show:s,distanceDisplayCondition:_n.fromDistanceDisplayCondition(a),color:void 0,offset:void 0};if(this._materialProperty instanceof En.A){let t;(0,d.A)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||o)&&(t=this._materialProperty.color.getValue(e,Bu)),(0,d.A)(t)||(t=u.A.WHITE),r=mn.A.fromColor(t),c.color=r}return(0,d.A)(this._options.offsetAttribute)&&(c.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,Ru,Mu))),new yn.A({id:i,geometry:new Pu(this._options),modelMatrix:t?void 0:i.computeModelMatrixForHeightReference(e,i.ellipsoid.heightReference,.5*this._options.radii.z,this._scene.ellipsoid,n),attributes:c})},ku.prototype.createOutlineGeometryInstance=function(e,t,n){l.A.defined("time",e);const i=this._entity,o=i.isAvailable(e),r=Wt.A.getValueOrDefault(this._outlineColorProperty,e,u.A.BLACK,Bu),s=this._distanceDisplayConditionProperty.getValue(e),a={show:new wn.A(o&&i.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:mn.A.fromColor(r),distanceDisplayCondition:_n.fromDistanceDisplayCondition(s),offset:void 0};return(0,d.A)(this._options.offsetAttribute)&&(a.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,Ru,Mu))),new yn.A({id:i,geometry:new Du.A(this._options),modelMatrix:t?void 0:i.computeModelMatrixForHeightReference(e,i.ellipsoid.heightReference,.5*this._options.radii.z,this._scene.ellipsoid,n),attributes:a})},ku.prototype._computeCenter=function(e,t){return Wt.A.getValueOrUndefined(this._entity.position,e,t)},ku.prototype._isHidden=function(e,t){return!(0,d.A)(e.position)||!(0,d.A)(t.radii)||$n.prototype._isHidden.call(this,e,t)},ku.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&Wt.A.isConstant(e.orientation)&&t.radii.isConstant&&Wt.A.isConstant(t.innerRadii)&&Wt.A.isConstant(t.stackPartitions)&&Wt.A.isConstant(t.slicePartitions)&&Wt.A.isConstant(t.outlineWidth)&&Wt.A.isConstant(t.minimumClock)&&Wt.A.isConstant(t.maximumClock)&&Wt.A.isConstant(t.minimumCone)&&Wt.A.isConstant(t.maximumCone)&&Wt.A.isConstant(t.subdivisions))},ku.prototype._setStaticOptions=function(e,t){const n=Wt.A.getValueOrDefault(t.heightReference,Tn.A.MINIMUM_VALUE,Vt.Ay.NONE),i=this._options;i.vertexFormat=this._materialProperty instanceof En.A?Cn.A.VERTEX_FORMAT:xn.A.MaterialSupport.TEXTURED.vertexFormat,i.radii=t.radii.getValue(Tn.A.MINIMUM_VALUE,i.radii),i.innerRadii=Wt.A.getValueOrUndefined(t.innerRadii,i.radii),i.minimumClock=Wt.A.getValueOrUndefined(t.minimumClock,Tn.A.MINIMUM_VALUE),i.maximumClock=Wt.A.getValueOrUndefined(t.maximumClock,Tn.A.MINIMUM_VALUE),i.minimumCone=Wt.A.getValueOrUndefined(t.minimumCone,Tn.A.MINIMUM_VALUE),i.maximumCone=Wt.A.getValueOrUndefined(t.maximumCone,Tn.A.MINIMUM_VALUE),i.stackPartitions=Wt.A.getValueOrUndefined(t.stackPartitions,Tn.A.MINIMUM_VALUE),i.slicePartitions=Wt.A.getValueOrUndefined(t.slicePartitions,Tn.A.MINIMUM_VALUE),i.subdivisions=Wt.A.getValueOrUndefined(t.subdivisions,Tn.A.MINIMUM_VALUE),i.offsetAttribute=n!==Vt.Ay.NONE?vn.A.ALL:void 0},ku.prototype._onEntityPropertyChanged=ii,ku.DynamicGeometryUpdater=Vu,(0,d.A)(Object.create)&&(Vu.prototype=Object.create(Nn.prototype),Vu.prototype.constructor=Vu),Vu.prototype.update=function(e){l.A.defined("time",e);const t=this._entity,n=t.ellipsoid;if(!t.isShowing||!t.isAvailable(e)||!Wt.A.getValueOrDefault(n.show,e,!0))return(0,d.A)(this._primitive)&&(this._primitive.show=!1),void((0,d.A)(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));const i=Wt.A.getValueOrUndefined(n.radii,e,Lu);let o=(0,d.A)(i)?t.computeModelMatrixForHeightReference(e,n.heightReference,.5*i.z,this._scene.ellipsoid,this._modelMatrix):void 0;if(!(0,d.A)(o)||!(0,d.A)(i))return(0,d.A)(this._primitive)&&(this._primitive.show=!1),void((0,d.A)(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));const r=Wt.A.getValueOrDefault(n.fill,e,!0),s=Wt.A.getValueOrDefault(n.outline,e,!1),a=Wt.A.getValueOrClonedDefault(n.outlineColor,e,u.A.BLACK,Bu),c=Mn.getValue(e,n.material??Ou,this._material),h=Wt.A.getValueOrUndefined(n.innerRadii,e,Nu),A=Wt.A.getValueOrUndefined(n.minimumClock,e),p=Wt.A.getValueOrUndefined(n.maximumClock,e),f=Wt.A.getValueOrUndefined(n.minimumCone,e),m=Wt.A.getValueOrUndefined(n.maximumCone,e),g=Wt.A.getValueOrUndefined(n.stackPartitions,e),_=Wt.A.getValueOrUndefined(n.slicePartitions,e),y=Wt.A.getValueOrUndefined(n.subdivisions,e),v=Wt.A.getValueOrDefault(n.outlineWidth,e,1),T=Wt.A.getValueOrDefault(n.heightReference,e,Vt.Ay.NONE),b=T!==Vt.Ay.NONE?vn.A.ALL:void 0,w=this._scene.mode,x=w===Ce.A.SCENE3D&&T===Vt.Ay.NONE,C=this._options,E=this._geometryUpdater.shadowsProperty.getValue(e),S=this._geometryUpdater.distanceDisplayConditionProperty.getValue(e),I=Wt.A.getValueOrDefault(this._geometryUpdater.terrainOffsetProperty,e,Ru,Mu);if(!x||this._lastSceneMode!==w||!(0,d.A)(this._primitive)||C.stackPartitions!==g||C.slicePartitions!==_||(0,d.A)(h)&&!j.A.equals(C.innerRadii!==h)||C.minimumClock!==A||C.maximumClock!==p||C.minimumCone!==f||C.maximumCone!==m||C.subdivisions!==y||this._lastOutlineWidth!==v||C.offsetAttribute!==b){const t=this._primitives;t.removeAndDestroy(this._primitive),t.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0,this._lastSceneMode=w,this._lastOutlineWidth=v,C.stackPartitions=g,C.slicePartitions=_,C.subdivisions=y,C.offsetAttribute=b,C.radii=j.A.clone(x?Fu:i,C.radii),(0,d.A)(h)?C.innerRadii=x?j.A.fromElements(h.x/i.x,h.y/i.y,h.z/i.z,C.innerRadii):j.A.clone(h,C.innerRadii):C.innerRadii=void 0,C.minimumClock=A,C.maximumClock=p,C.minimumCone=f,C.maximumCone=m;const n=new xn.A({material:c,translucent:c.isTranslucent(),closed:!0});C.vertexFormat=n.vertexFormat;const o=this._geometryUpdater.createFillGeometryInstance(e,x,this._modelMatrix);this._primitive=t.add(new Pn.A({geometryInstances:o,appearance:n,asynchronous:!1,shadows:E}));const l=this._geometryUpdater.createOutlineGeometryInstance(e,x,this._modelMatrix);this._outlinePrimitive=t.add(new Pn.A({geometryInstances:l,appearance:new Cn.A({flat:!0,translucent:255!==l.attributes.color.value[3],renderState:{lineWidth:this._geometryUpdater._scene.clampLineWidth(v)}}),asynchronous:!1,shadows:E})),this._lastShow=r,this._lastOutlineShow=s,this._lastOutlineColor=u.A.clone(a,this._lastOutlineColor),this._lastDistanceDisplayCondition=S,this._lastOffset=j.A.clone(I,this._lastOffset)}else if(this._primitive.ready){const e=this._primitive,n=this._outlinePrimitive;e.show=!0,n.show=!0,e.appearance.material=c;let i=this._attributes;(0,d.A)(i)||(i=e.getGeometryInstanceAttributes(t),this._attributes=i),r!==this._lastShow&&(i.show=wn.A.toValue(r,i.show),this._lastShow=r);let o=this._outlineAttributes;(0,d.A)(o)||(o=n.getGeometryInstanceAttributes(t),this._outlineAttributes=o),s!==this._lastOutlineShow&&(o.show=wn.A.toValue(s,o.show),this._lastOutlineShow=s),u.A.equals(a,this._lastOutlineColor)||(o.color=mn.A.toValue(a,o.color),u.A.clone(a,this._lastOutlineColor)),Ut.A.equals(S,this._lastDistanceDisplayCondition)||(i.distanceDisplayCondition=_n.toValue(S,i.distanceDisplayCondition),o.distanceDisplayCondition=_n.toValue(S,o.distanceDisplayCondition),Ut.A.clone(S,this._lastDistanceDisplayCondition)),j.A.equals(I,this._lastOffset)||(i.offset=bn.A.toValue(I,i.offset),o.offset=bn.A.toValue(I,i.offset),j.A.clone(I,this._lastOffset))}x&&(i.x=Math.max(i.x,.001),i.y=Math.max(i.y,.001),i.z=Math.max(i.z,.001),o=O.A.multiplyByScale(o,i,o),this._primitive.modelMatrix=o,this._outlinePrimitive.modelMatrix=o)};const zu=ku;function Hu(e){const t=(e=e??S.A.EMPTY_OBJECT).vertexFormat??Rr.A.DEFAULT;this._vertexFormat=t,this._workerName="createPlaneGeometry"}Hu.packedLength=Rr.A.packedLength,Hu.pack=function(e,t,n){return l.A.typeOf.object("value",e),l.A.defined("array",t),n=n??0,Rr.A.pack(e._vertexFormat,t,n),t};const Gu=new Rr.A,Wu={vertexFormat:Gu};Hu.unpack=function(e,t,n){l.A.defined("array",e),t=t??0;const i=Rr.A.unpack(e,t,Gu);return(0,d.A)(n)?(n._vertexFormat=Rr.A.clone(i,n._vertexFormat),n):new Hu(Wu)};const Yu=new j.A(-.5,-.5,0),qu=new j.A(.5,.5,0);Hu.createGeometry=function(e){const t=e._vertexFormat,n=new Ir.A;let i,o;if(t.position){if(o=new Float64Array(12),o[0]=Yu.x,o[1]=Yu.y,o[2]=0,o[3]=qu.x,o[4]=Yu.y,o[5]=0,o[6]=qu.x,o[7]=qu.y,o[8]=0,o[9]=Yu.x,o[10]=qu.y,o[11]=0,n.position=new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:o}),t.normal){const e=new Float32Array(12);e[0]=0,e[1]=0,e[2]=1,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=1,e[9]=0,e[10]=0,e[11]=1,n.normal=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:e})}if(t.st){const e=new Float32Array(8);e[0]=0,e[1]=0,e[2]=1,e[3]=0,e[4]=1,e[5]=1,e[6]=0,e[7]=1,n.st=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:2,values:e})}if(t.tangent){const e=new Float32Array(12);e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=1,e[7]=0,e[8]=0,e[9]=1,e[10]=0,e[11]=0,n.tangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:e})}if(t.bitangent){const e=new Float32Array(12);e[0]=0,e[1]=1,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=1,e[8]=0,e[9]=0,e[10]=1,e[11]=0,n.bitangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:e})}i=new Uint16Array(6),i[0]=0,i[1]=1,i[2]=2,i[3]=0,i[4]=2,i[5]=3}return new I.A({attributes:n,indices:i,primitiveType:p.A.TRIANGLES,boundingSphere:new Sn.A(j.A.ZERO,Math.sqrt(2))})};const ju=Hu;function Qu(){this._workerName="createPlaneOutlineGeometry"}Qu.packedLength=0,Qu.pack=function(e,t){return l.A.defined("value",e),l.A.defined("array",t),t},Qu.unpack=function(e,t,n){return l.A.defined("array",e),(0,d.A)(n)?n:new Qu};const Xu=new j.A(-.5,-.5,0),Ku=new j.A(.5,.5,0);Qu.createGeometry=function(){const e=new Ir.A,t=new Uint16Array(8),n=new Float64Array(12);return n[0]=Xu.x,n[1]=Xu.y,n[2]=Xu.z,n[3]=Ku.x,n[4]=Xu.y,n[5]=Xu.z,n[6]=Ku.x,n[7]=Ku.y,n[8]=Xu.z,n[9]=Xu.x,n[10]=Ku.y,n[11]=Xu.z,e.position=new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:n}),t[0]=0,t[1]=1,t[2]=1,t[3]=2,t[4]=2,t[5]=3,t[6]=3,t[7]=0,new I.A({attributes:e,indices:t,primitiveType:p.A.LINES,boundingSphere:new Sn.A(j.A.ZERO,Math.sqrt(2))})};const $u=Qu,Ju=new j.A,Zu=new u.A;function ed(e){this.id=e,this.vertexFormat=void 0,this.plane=void 0,this.dimensions=void 0}function td(e,t){$n.call(this,{entity:e,scene:t,geometryOptions:new ed(e),geometryPropertyName:"plane",observedPropertyNames:["availability","position","orientation","plane"]}),this._onEntityPropertyChanged(e,"plane",e.plane,void 0)}function nd(e,t,n){Nn.call(this,e,t,n)}(0,d.A)(Object.create)&&(td.prototype=Object.create($n.prototype),td.prototype.constructor=td),td.prototype.createFillGeometryInstance=function(e){if(l.A.defined("time",e),!this._fillEnabled)throw new A.A("This instance does not represent a filled geometry.");const t=this._entity,n=t.isAvailable(e);let i,o;const r=new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),s=this._distanceDisplayConditionProperty.getValue(e),a=_n.fromDistanceDisplayCondition(s);if(this._materialProperty instanceof En.A){let t;(0,d.A)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,Zu)),(0,d.A)(t)||(t=u.A.WHITE),o=mn.A.fromColor(t),i={show:r,distanceDisplayCondition:a,color:o}}else i={show:r,distanceDisplayCondition:a};const c=t.plane,h=this._options;let p=t.computeModelMatrix(e);const f=Wt.A.getValueOrDefault(c.plane,e,h.plane),m=Wt.A.getValueOrUndefined(c.dimensions,e,h.dimensions);return h.plane=f,h.dimensions=m,p=ud(f,m,p,p),new yn.A({id:t,geometry:new ju(this._options),modelMatrix:p,attributes:i})},td.prototype.createOutlineGeometryInstance=function(e){if(l.A.defined("time",e),!this._outlineEnabled)throw new A.A("This instance does not represent an outlined geometry.");const t=this._entity,n=t.isAvailable(e),i=Wt.A.getValueOrDefault(this._outlineColorProperty,e,u.A.BLACK,Zu),o=this._distanceDisplayConditionProperty.getValue(e),r=t.plane,s=this._options;let a=t.computeModelMatrix(e);const c=Wt.A.getValueOrDefault(r.plane,e,s.plane),d=Wt.A.getValueOrUndefined(r.dimensions,e,s.dimensions);return s.plane=c,s.dimensions=d,a=ud(c,d,a,a),new yn.A({id:t,geometry:new $u,modelMatrix:a,attributes:{show:new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:mn.A.fromColor(i),distanceDisplayCondition:_n.fromDistanceDisplayCondition(o)}})},td.prototype._isHidden=function(e,t){return!(0,d.A)(t.plane)||!(0,d.A)(t.dimensions)||!(0,d.A)(e.position)||$n.prototype._isHidden.call(this,e,t)},td.prototype._getIsClosed=function(e){return!1},td.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&Wt.A.isConstant(e.orientation)&&t.plane.isConstant&&t.dimensions.isConstant&&Wt.A.isConstant(t.outlineWidth))},td.prototype._setStaticOptions=function(e,t){const n=this._materialProperty instanceof En.A,i=this._options;i.vertexFormat=n?Cn.A.VERTEX_FORMAT:xn.A.MaterialSupport.TEXTURED.vertexFormat,i.plane=t.plane.getValue(Tn.A.MINIMUM_VALUE,i.plane),i.dimensions=t.dimensions.getValue(Tn.A.MINIMUM_VALUE,i.dimensions)},td.DynamicGeometryUpdater=nd,(0,d.A)(Object.create)&&(nd.prototype=Object.create(Nn.prototype),nd.prototype.constructor=nd),nd.prototype._isHidden=function(e,t,n){const i=this._options,o=Wt.A.getValueOrUndefined(e.position,n,Ju);return!(0,d.A)(o)||!(0,d.A)(i.plane)||!(0,d.A)(i.dimensions)||Nn.prototype._isHidden.call(this,e,t,n)},nd.prototype._setOptions=function(e,t,n){const i=this._options;i.plane=Wt.A.getValueOrDefault(t.plane,n,i.plane),i.dimensions=Wt.A.getValueOrUndefined(t.dimensions,n,i.dimensions)};const id=new j.A,od=new j.A,rd=new j.A,sd=new j.A,ad=new Z.A,cd=new Z.A,ld=new O.A;function ud(e,t,n,i){const o=e.normal,r=e.distance,s=j.A.multiplyByScalar(o,-r,rd);let a=j.A.clone(j.A.UNIT_Z,od);J.A.equalsEpsilon(Math.abs(j.A.dot(a,o)),1,J.A.EPSILON8)&&(a=j.A.clone(j.A.UNIT_Y,a));const c=j.A.cross(a,o,id);a=j.A.cross(o,c,a),j.A.normalize(c,c),j.A.normalize(a,a);const l=ad;Z.A.setColumn(l,0,c,l),Z.A.setColumn(l,1,a,l),Z.A.setColumn(l,2,o,l);const u=j.A.fromElements(t.x,t.y,1,sd),d=Z.A.multiplyByScale(l,u,cd),h=O.A.fromRotationTranslation(d,s,ld);return O.A.multiplyTransformation(n,h,i)}td.createPrimitiveMatrix=ud;const dd=td;var hd=n(246520),Ad=n(34233),pd=n(71694);const fd=new j.A,md=new c.A,gd=new q.A,_d=new q.A,yd=new j.A,vd=new j.A,Td=new j.A,bd=new j.A,wd=new j.A,xd=new j.A,Cd=new To.A,Ed=new Z.A,Sd=new Z.A,Id=new j.A;function Pd(e,t,n,i,o,r,s,a,c){const l=e.positions;let u=Dr.A.triangulate(e.positions2D,e.holes);u.length<3&&(u=[0,1,2]);const h=Pr.A.createTypedArray(l.length,u.length);h.set(u);let A=Ed;if(0!==i){let e=To.A.fromAxisAngle(s,i,Cd);if(A=Z.A.fromQuaternion(e,A),t.tangent||t.bitangent){e=To.A.fromAxisAngle(s,-i,Cd);const n=Z.A.fromQuaternion(e,Sd);a=j.A.normalize(Z.A.multiplyByVector(n,a,a),a),t.bitangent&&(c=j.A.normalize(j.A.cross(s,a,c),c))}}else A=Z.A.clone(Z.A.IDENTITY,A);const f=_d;t.st&&(f.x=n.x,f.y=n.y);const m=l.length,g=3*m,_=new Float64Array(g),y=t.normal?new Float32Array(g):void 0,v=t.tangent?new Float32Array(g):void 0,T=t.bitangent?new Float32Array(g):void 0,b=t.st?new Float32Array(2*m):void 0;let w=0,x=0,E=0,S=0,D=0;for(let e=0;e<m;e++){const i=l[e];if(_[w++]=i.x,_[w++]=i.y,_[w++]=i.z,t.st)if((0,d.A)(o)&&o.positions.length===m)b[D++]=o.positions[e].x,b[D++]=o.positions[e].y;else{const e=r(Z.A.multiplyByVector(A,i,fd),gd);q.A.subtract(e,f,e);const t=J.A.clamp(e.x/n.width,0,1),o=J.A.clamp(e.y/n.height,0,1);b[D++]=t,b[D++]=o}t.normal&&(y[x++]=s.x,y[x++]=s.y,y[x++]=s.z),t.tangent&&(v[S++]=a.x,v[S++]=a.y,v[S++]=a.z),t.bitangent&&(T[E++]=c.x,T[E++]=c.y,T[E++]=c.z)}const O=new Ir.A;return t.position&&(O.position=new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:_})),t.normal&&(O.normal=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:y})),t.tangent&&(O.tangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:v})),t.bitangent&&(O.bitangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:T})),t.st&&(O.st=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:2,values:b})),new I.A({attributes:O,indices:h,primitiveType:p.A.TRIANGLES})}function Dd(e){const t=(e=e??S.A.EMPTY_OBJECT).polygonHierarchy,n=e.textureCoordinates;l.A.defined("options.polygonHierarchy",t);const i=e.vertexFormat??Rr.A.DEFAULT;this._vertexFormat=Rr.A.clone(i),this._polygonHierarchy=t,this._stRotation=e.stRotation??0,this._ellipsoid=K.A.clone(e.ellipsoid??K.A.default),this._workerName="createCoplanarPolygonGeometry",this._textureCoordinates=n,this.packedLength=pd.A.computeHierarchyPackedLength(t,j.A)+Rr.A.packedLength+K.A.packedLength+((0,d.A)(n)?pd.A.computeHierarchyPackedLength(n,q.A):1)+2}Dd.fromPositions=function(e){return e=e??S.A.EMPTY_OBJECT,l.A.defined("options.positions",e.positions),new Dd({polygonHierarchy:{positions:e.positions},vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid,textureCoordinates:e.textureCoordinates})},Dd.pack=function(e,t,n){return l.A.typeOf.object("value",e),l.A.defined("array",t),n=n??0,n=pd.A.packPolygonHierarchy(e._polygonHierarchy,t,n,j.A),K.A.pack(e._ellipsoid,t,n),n+=K.A.packedLength,Rr.A.pack(e._vertexFormat,t,n),n+=Rr.A.packedLength,t[n++]=e._stRotation,(0,d.A)(e._textureCoordinates)?n=pd.A.packPolygonHierarchy(e._textureCoordinates,t,n,q.A):t[n++]=-1,t[n++]=e.packedLength,t};const Od=K.A.clone(K.A.UNIT_SPHERE),Rd=new Rr.A,Md={polygonHierarchy:{}};Dd.unpack=function(e,t,n){l.A.defined("array",e),t=t??0;const i=pd.A.unpackPolygonHierarchy(e,t,j.A);t=i.startingIndex,delete i.startingIndex;const o=K.A.unpack(e,t,Od);t+=K.A.packedLength;const r=Rr.A.unpack(e,t,Rd);t+=Rr.A.packedLength;const s=e[t++],a=-1===e[t]?void 0:pd.A.unpackPolygonHierarchy(e,t,q.A);(0,d.A)(a)?(t=a.startingIndex,delete a.startingIndex):t++;const c=e[t++];return(0,d.A)(n)||(n=new Dd(Md)),n._polygonHierarchy=i,n._ellipsoid=K.A.clone(o,n._ellipsoid),n._vertexFormat=Rr.A.clone(r,n._vertexFormat),n._stRotation=s,n._textureCoordinates=a,n.packedLength=c,n},Dd.createGeometry=function(e){const t=e._vertexFormat,n=e._polygonHierarchy,i=e._stRotation,o=e._textureCoordinates,r=(0,d.A)(o);let s=n.positions;if(s=(0,go.A)(s,j.A.equalsEpsilon,!0),s.length<3)return;let a=yd,c=vd,l=Td,u=wd;const h=xd;if(!hd.A.computeProjectTo2DArguments(s,bd,u,h))return;if(a=j.A.cross(u,h,a),a=j.A.normalize(a,a),!j.A.equalsEpsilon(bd,j.A.ZERO,J.A.EPSILON6)){const t=e._ellipsoid.geodeticSurfaceNormal(bd,Id);j.A.dot(a,t)<0&&(a=j.A.negate(a,a),u=j.A.negate(u,u))}const A=hd.A.createProjectPointsTo2DFunction(bd,u,h),p=hd.A.createProjectPointTo2DFunction(bd,u,h);t.tangent&&(c=j.A.clone(u,c)),t.bitangent&&(l=j.A.clone(h,l));const f=pd.A.polygonsFromHierarchy(n,r,A,!1),m=f.hierarchy,g=f.polygons,_=r?pd.A.polygonsFromHierarchy(o,!0,function(e){return e},!1).polygons:void 0;if(0===m.length)return;s=m[0].outerRing;const y=Sn.A.fromPoints(s),v=pd.A.computeBoundingRectangle(a,p,s,i,md),T=[];for(let e=0;e<g.length;e++){const n=new yn.A({geometry:Pd(g[e],t,v,i,r?_[e]:void 0,p,a,c,l)});T.push(n)}const b=Ad.A.combineInstances(T)[0];b.attributes.position.values=new Float64Array(b.attributes.position.values),b.indices=Pr.A.createTypedArray(b.attributes.position.values.length/3,b.indices);const w=b.attributes;return t.position||delete w.position,new I.A({attributes:w,indices:b.indices,primitiveType:b.primitiveType,boundingSphere:y})};const Ld=Dd;var Nd=n(173885),Bd=n(151949),Fd=n(666765);const Ud=[],kd=[];function Vd(e,t,n,i,o){const r=vo.A.fromPoints(t,e).projectPointsOntoPlane(t,Ud);let s,a;Dr.A.computeWindingOrder2D(r)===Fd.A.CLOCKWISE&&(r.reverse(),t=t.slice().reverse());let c=t.length,l=0;if(i)for(s=new Float64Array(2*c*3),a=0;a<c;a++){const e=t[a],n=t[(a+1)%c];s[l++]=e.x,s[l++]=e.y,s[l++]=e.z,s[l++]=n.x,s[l++]=n.y,s[l++]=n.z}else{let i=0;if(o===zs.A.GEODESIC)for(a=0;a<c;a++)i+=pd.A.subdivideLineCount(t[a],t[(a+1)%c],n);else if(o===zs.A.RHUMB)for(a=0;a<c;a++)i+=pd.A.subdivideRhumbLineCount(e,t[a],t[(a+1)%c],n);for(s=new Float64Array(3*i),a=0;a<c;a++){let i;o===zs.A.GEODESIC?i=pd.A.subdivideLine(t[a],t[(a+1)%c],n,kd):o===zs.A.RHUMB&&(i=pd.A.subdivideRhumbLine(e,t[a],t[(a+1)%c],n,kd));const r=i.length;for(let e=0;e<r;++e)s[l++]=i[e]}}c=s.length/3;const u=2*c,d=Pr.A.createTypedArray(c,u);for(l=0,a=0;a<c-1;a++)d[l++]=a,d[l++]=a+1;return d[l++]=c-1,d[l++]=0,new yn.A({geometry:new I.A({attributes:new Ir.A({position:new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:s})}),indices:d,primitiveType:p.A.LINES})})}function zd(e,t,n,i,o){const r=vo.A.fromPoints(t,e).projectPointsOntoPlane(t,Ud);let s,a;Dr.A.computeWindingOrder2D(r)===Fd.A.CLOCKWISE&&(r.reverse(),t=t.slice().reverse());let c=t.length;const l=new Array(c);let u=0;if(i)for(s=new Float64Array(2*c*3*2),a=0;a<c;++a){l[a]=u/3;const e=t[a],n=t[(a+1)%c];s[u++]=e.x,s[u++]=e.y,s[u++]=e.z,s[u++]=n.x,s[u++]=n.y,s[u++]=n.z}else{let i=0;if(o===zs.A.GEODESIC)for(a=0;a<c;a++)i+=pd.A.subdivideLineCount(t[a],t[(a+1)%c],n);else if(o===zs.A.RHUMB)for(a=0;a<c;a++)i+=pd.A.subdivideRhumbLineCount(e,t[a],t[(a+1)%c],n);for(s=new Float64Array(3*i*2),a=0;a<c;++a){let i;l[a]=u/3,o===zs.A.GEODESIC?i=pd.A.subdivideLine(t[a],t[(a+1)%c],n,kd):o===zs.A.RHUMB&&(i=pd.A.subdivideRhumbLine(e,t[a],t[(a+1)%c],n,kd));const r=i.length;for(let e=0;e<r;++e)s[u++]=i[e]}}c=s.length/6;const d=l.length,h=2*(2*c+d),A=Pr.A.createTypedArray(c+d,h);for(u=0,a=0;a<c;++a)A[u++]=a,A[u++]=(a+1)%c,A[u++]=a+c,A[u++]=(a+1)%c+c;for(a=0;a<d;a++){const e=l[a];A[u++]=e,A[u++]=e+c}return new yn.A({geometry:new I.A({attributes:new Ir.A({position:new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:s})}),indices:A,primitiveType:p.A.LINES})})}function Hd(e){if(l.A.typeOf.object("options",e),l.A.typeOf.object("options.polygonHierarchy",e.polygonHierarchy),e.perPositionHeight&&(0,d.A)(e.height))throw new A.A("Cannot use both options.perPositionHeight and options.height");if((0,d.A)(e.arcType)&&e.arcType!==zs.A.GEODESIC&&e.arcType!==zs.A.RHUMB)throw new A.A("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");const t=e.polygonHierarchy,n=e.ellipsoid??K.A.default,i=e.granularity??J.A.RADIANS_PER_DEGREE,o=e.perPositionHeight??!1,r=o&&(0,d.A)(e.extrudedHeight),s=e.arcType??zs.A.GEODESIC;let a=e.height??0,c=e.extrudedHeight??a;if(!r){const e=Math.max(a,c);c=Math.min(a,c),a=e}this._ellipsoid=K.A.clone(n),this._granularity=i,this._height=a,this._extrudedHeight=c,this._arcType=s,this._polygonHierarchy=t,this._perPositionHeight=o,this._perPositionHeightExtrude=r,this._offsetAttribute=e.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=pd.A.computeHierarchyPackedLength(t,j.A)+K.A.packedLength+8}Hd.pack=function(e,t,n){return l.A.typeOf.object("value",e),l.A.defined("array",t),n=n??0,n=pd.A.packPolygonHierarchy(e._polygonHierarchy,t,n,j.A),K.A.pack(e._ellipsoid,t,n),n+=K.A.packedLength,t[n++]=e._height,t[n++]=e._extrudedHeight,t[n++]=e._granularity,t[n++]=e._perPositionHeightExtrude?1:0,t[n++]=e._perPositionHeight?1:0,t[n++]=e._arcType,t[n++]=e._offsetAttribute??-1,t[n]=e.packedLength,t};const Gd=K.A.clone(K.A.UNIT_SPHERE),Wd={polygonHierarchy:{}};Hd.unpack=function(e,t,n){l.A.defined("array",e),t=t??0;const i=pd.A.unpackPolygonHierarchy(e,t,j.A);t=i.startingIndex,delete i.startingIndex;const o=K.A.unpack(e,t,Gd);t+=K.A.packedLength;const r=e[t++],s=e[t++],a=e[t++],c=1===e[t++],u=1===e[t++],h=e[t++],A=e[t++],p=e[t];return(0,d.A)(n)||(n=new Hd(Wd)),n._polygonHierarchy=i,n._ellipsoid=K.A.clone(o,n._ellipsoid),n._height=r,n._extrudedHeight=s,n._granularity=a,n._perPositionHeight=u,n._perPositionHeightExtrude=c,n._arcType=h,n._offsetAttribute=-1===A?void 0:A,n.packedLength=p,n},Hd.fromPositions=function(e){return e=e??S.A.EMPTY_OBJECT,l.A.defined("options.positions",e.positions),new Hd({polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,arcType:e.arcType,offsetAttribute:e.offsetAttribute})},Hd.createGeometry=function(e){const t=e._ellipsoid,n=e._granularity,i=e._polygonHierarchy,o=e._perPositionHeight,r=e._arcType,s=pd.A.polygonOutlinesFromHierarchy(i,!o,t);if(0===s.length)return;let a;const c=[],l=J.A.chordLength(n,t.maximumRadius),u=e._height,h=e._extrudedHeight;let A,p;if(e._perPositionHeightExtrude||!J.A.equalsEpsilon(u,h,0,J.A.EPSILON2))for(p=0;p<s.length;p++){if(a=zd(t,s[p],l,o,r),a.geometry=pd.A.scaleToGeodeticHeightExtruded(a.geometry,u,h,t,o),(0,d.A)(e._offsetAttribute)){const t=a.geometry.attributes.position.values.length/3;let n=new Uint8Array(t);e._offsetAttribute===vn.A.TOP?n=n.fill(1,0,t/2):(A=e._offsetAttribute===vn.A.NONE?0:1,n=n.fill(A)),a.geometry.attributes.applyOffset=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}c.push(a)}else for(p=0;p<s.length;p++){if(a=Vd(t,s[p],l,o,r),a.geometry.attributes.position.values=Dr.A.scaleToGeodeticHeight(a.geometry.attributes.position.values,u,t,!o),(0,d.A)(e._offsetAttribute)){const t=a.geometry.attributes.position.values.length;A=e._offsetAttribute===vn.A.NONE?0:1;const n=new Uint8Array(t/3).fill(A);a.geometry.attributes.applyOffset=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}c.push(a)}const f=Ad.A.combineInstances(c)[0],m=Sn.A.fromVertices(f.attributes.position.values);return new I.A({attributes:f.attributes,indices:f.indices,primitiveType:f.primitiveType,boundingSphere:m,offsetAttribute:e._offsetAttribute})};const Yd=Hd,qd="Entity polygons cannot have both height and perPositionHeight.  height will be ignored",jd="heightReference is not supported for entity polygons with perPositionHeight. heightReference will be ignored",Qd=new u.A,Xd=j.A.ZERO,Kd=new j.A,$d=new Or.A,Jd=[],Zd=new q.A;function eh(e){this.id=e,this.vertexFormat=void 0,this.polygonHierarchy=void 0,this.perPositionHeight=void 0,this.closeTop=void 0,this.closeBottom=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.offsetAttribute=void 0,this.arcType=void 0,this.textureCoordinates=void 0}function th(e,t){fs.call(this,{entity:e,scene:t,geometryOptions:new eh(e),geometryPropertyName:"polygon",observedPropertyNames:["availability","polygon"]}),this._onEntityPropertyChanged(e,"polygon",e.polygon,void 0)}function nh(e,t,n){Nn.call(this,e,t,n)}(0,d.A)(Object.create)&&(th.prototype=Object.create(fs.prototype),th.prototype.constructor=th),th.prototype.createFillGeometryInstance=function(e){if(l.A.defined("time",e),!this._fillEnabled)throw new A.A("This instance does not represent a filled geometry.");const t=this._entity,n=t.isAvailable(e),i=this._options,o={show:new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:_n.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof En.A){let t;(0,d.A)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,Qd)),(0,d.A)(t)||(t=u.A.WHITE),o.color=mn.A.fromColor(t)}let r;return(0,d.A)(i.offsetAttribute)&&(o.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,Xd,Kd))),r=i.perPositionHeight&&!(0,d.A)(i.extrudedHeight)?new Ld(i):new Bd.A(i),new yn.A({id:t,geometry:r,attributes:o})},th.prototype.createOutlineGeometryInstance=function(e){if(l.A.defined("time",e),!this._outlineEnabled)throw new A.A("This instance does not represent an outlined geometry.");const t=this._entity,n=t.isAvailable(e),i=this._options,o=Wt.A.getValueOrDefault(this._outlineColorProperty,e,u.A.BLACK,Qd),r=this._distanceDisplayConditionProperty.getValue(e),s={show:new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:mn.A.fromColor(o),distanceDisplayCondition:_n.fromDistanceDisplayCondition(r),offset:void 0};let a;return(0,d.A)(i.offsetAttribute)&&(s.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,Xd,Kd))),a=i.perPositionHeight&&!(0,d.A)(i.extrudedHeight)?new Nd.A(i):new Yd(i),new yn.A({id:t,geometry:a,attributes:s})},th.prototype._computeCenter=function(e,t){const n=Wt.A.getValueOrUndefined(this._entity.polygon.hierarchy,e);if(!(0,d.A)(n))return;const i=n.positions;if(0===i.length)return;const o=this._scene.ellipsoid,r=vo.A.fromPoints(i,o),s=r.projectPointsOntoPlane(i,Jd),a=s.length;let c=0,l=a-1,u=new q.A;for(let e=0;e<a;l=e++){const t=s[e],n=s[l],i=t.x*n.y-n.x*t.y;let o=q.A.add(t,n,Zd);o=q.A.multiplyByScalar(o,i,o),u=q.A.add(u,o,u),c+=i}const h=1/(3*c);return u=q.A.multiplyByScalar(u,h,u),r.projectPointOntoEllipsoid(u,t)},th.prototype._isHidden=function(e,t){return!(0,d.A)(t.hierarchy)||$n.prototype._isHidden.call(this,e,t)},th.prototype._isOnTerrain=function(e,t){const n=fs.prototype._isOnTerrain.call(this,e,t),i=t.perPositionHeight,o=(0,d.A)(i)&&(!i.isConstant||i.getValue(Tn.A.MINIMUM_VALUE));return n&&!o},th.prototype._isDynamic=function(e,t){return!t.hierarchy.isConstant||!Wt.A.isConstant(t.height)||!Wt.A.isConstant(t.extrudedHeight)||!Wt.A.isConstant(t.granularity)||!Wt.A.isConstant(t.stRotation)||!Wt.A.isConstant(t.textureCoordinates)||!Wt.A.isConstant(t.outlineWidth)||!Wt.A.isConstant(t.perPositionHeight)||!Wt.A.isConstant(t.closeTop)||!Wt.A.isConstant(t.closeBottom)||!Wt.A.isConstant(t.zIndex)||!Wt.A.isConstant(t.arcType)||this._onTerrain&&!Wt.A.isConstant(this._materialProperty)&&!(this._materialProperty instanceof En.A)},th.prototype._setStaticOptions=function(e,t){const n=this._materialProperty instanceof En.A,i=this._options;i.vertexFormat=n?Cn.A.VERTEX_FORMAT:xn.A.MaterialSupport.TEXTURED.vertexFormat;const o=t.hierarchy.getValue(Tn.A.MINIMUM_VALUE);let r=Wt.A.getValueOrUndefined(t.height,Tn.A.MINIMUM_VALUE);const s=Wt.A.getValueOrDefault(t.heightReference,Tn.A.MINIMUM_VALUE,Vt.Ay.NONE);let a=Wt.A.getValueOrUndefined(t.extrudedHeight,Tn.A.MINIMUM_VALUE);const c=Wt.A.getValueOrDefault(t.extrudedHeightReference,Tn.A.MINIMUM_VALUE,Vt.Ay.NONE),l=Wt.A.getValueOrDefault(t.perPositionHeight,Tn.A.MINIMUM_VALUE,!1);let u;if(r=fs.getGeometryHeight(r,s),l?((0,d.A)(r)&&(r=void 0,(0,Fn.A)(qd)),s!==Vt.Ay.NONE&&l&&(r=void 0,(0,Fn.A)(jd))):((0,d.A)(a)&&!(0,d.A)(r)&&(r=0),u=fs.computeGeometryOffsetAttribute(r,s,a,c)),i.polygonHierarchy=o,i.granularity=Wt.A.getValueOrUndefined(t.granularity,Tn.A.MINIMUM_VALUE),i.stRotation=Wt.A.getValueOrUndefined(t.stRotation,Tn.A.MINIMUM_VALUE),i.perPositionHeight=l,i.closeTop=Wt.A.getValueOrDefault(t.closeTop,Tn.A.MINIMUM_VALUE,!0),i.closeBottom=Wt.A.getValueOrDefault(t.closeBottom,Tn.A.MINIMUM_VALUE,!0),i.offsetAttribute=u,i.height=r,i.arcType=Wt.A.getValueOrDefault(t.arcType,Tn.A.MINIMUM_VALUE,zs.A.GEODESIC),i.textureCoordinates=Wt.A.getValueOrUndefined(t.textureCoordinates,Tn.A.MINIMUM_VALUE),a=fs.getGeometryExtrudedHeight(a,c),a===fs.CLAMP_TO_GROUND){const e=Bd.A.computeRectangleFromPositions(i.polygonHierarchy.positions,i.ellipsoid,i.arcType,$d);a=mo.A.getMinimumMaximumHeights(e).minimumTerrainHeight}i.extrudedHeight=a},th.prototype._getIsClosed=function(e){const t=e.height,n=e.extrudedHeight,i=(0,d.A)(n)&&n!==t;return!e.perPositionHeight&&(!i&&0===t||i&&e.closeTop&&e.closeBottom)},th.DynamicGeometryUpdater=nh,(0,d.A)(Object.create)&&(nh.prototype=Object.create(Nn.prototype),nh.prototype.constructor=nh),nh.prototype._isHidden=function(e,t,n){return!(0,d.A)(this._options.polygonHierarchy)||Nn.prototype._isHidden.call(this,e,t,n)},nh.prototype._setOptions=function(e,t,n){const i=this._options;i.polygonHierarchy=Wt.A.getValueOrUndefined(t.hierarchy,n);let o=Wt.A.getValueOrUndefined(t.height,n);const r=Wt.A.getValueOrDefault(t.heightReference,n,Vt.Ay.NONE),s=Wt.A.getValueOrDefault(t.extrudedHeightReference,n,Vt.Ay.NONE);let a=Wt.A.getValueOrUndefined(t.extrudedHeight,n);const c=Wt.A.getValueOrUndefined(t.perPositionHeight,n);let l;if(o=fs.getGeometryHeight(o,s),c?((0,d.A)(o)&&(o=void 0,(0,Fn.A)(qd)),r!==Vt.Ay.NONE&&c&&(o=void 0,(0,Fn.A)(jd))):((0,d.A)(a)&&!(0,d.A)(o)&&(o=0),l=fs.computeGeometryOffsetAttribute(o,r,a,s)),i.granularity=Wt.A.getValueOrUndefined(t.granularity,n),i.stRotation=Wt.A.getValueOrUndefined(t.stRotation,n),i.textureCoordinates=Wt.A.getValueOrUndefined(t.textureCoordinates,n),i.perPositionHeight=Wt.A.getValueOrUndefined(t.perPositionHeight,n),i.closeTop=Wt.A.getValueOrDefault(t.closeTop,n,!0),i.closeBottom=Wt.A.getValueOrDefault(t.closeBottom,n,!0),i.offsetAttribute=l,i.height=o,i.arcType=Wt.A.getValueOrDefault(t.arcType,n,zs.A.GEODESIC),a=fs.getGeometryExtrudedHeight(a,s),a===fs.CLAMP_TO_GROUND){const e=Bd.A.computeRectangleFromPositions(i.polygonHierarchy.positions,i.ellipsoid,i.arcType,$d);a=mo.A.getMinimumMaximumHeights(e).minimumTerrainHeight}i.extrudedHeight=a};const ih=th;function oh(e){const t=(e=e??S.A.EMPTY_OBJECT).polylinePositions,n=e.shapePositions;if(!(0,d.A)(t))throw new A.A("options.polylinePositions is required.");if(!(0,d.A)(n))throw new A.A("options.shapePositions is required.");this._positions=t,this._shape=n,this._ellipsoid=K.A.clone(e.ellipsoid??K.A.default),this._cornerType=e.cornerType??_o.ROUNDED,this._vertexFormat=Rr.A.clone(e.vertexFormat??Rr.A.DEFAULT),this._granularity=e.granularity??J.A.RADIANS_PER_DEGREE,this._workerName="createPolylineVolumeGeometry";let i=1+t.length*j.A.packedLength;i+=1+n.length*q.A.packedLength,this.packedLength=i+K.A.packedLength+Rr.A.packedLength+2}oh.pack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("value is required");if(!(0,d.A)(t))throw new A.A("array is required");let i;n=n??0;const o=e._positions;let r=o.length;for(t[n++]=r,i=0;i<r;++i,n+=j.A.packedLength)j.A.pack(o[i],t,n);const s=e._shape;for(r=s.length,t[n++]=r,i=0;i<r;++i,n+=q.A.packedLength)q.A.pack(s[i],t,n);return K.A.pack(e._ellipsoid,t,n),n+=K.A.packedLength,Rr.A.pack(e._vertexFormat,t,n),n+=Rr.A.packedLength,t[n++]=e._cornerType,t[n]=e._granularity,t};const rh=K.A.clone(K.A.UNIT_SPHERE),sh=new Rr.A,ah={polylinePositions:void 0,shapePositions:void 0,ellipsoid:rh,vertexFormat:sh,cornerType:void 0,granularity:void 0};oh.unpack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("array is required");let i;t=t??0;let o=e[t++];const r=new Array(o);for(i=0;i<o;++i,t+=j.A.packedLength)r[i]=j.A.unpack(e,t);o=e[t++];const s=new Array(o);for(i=0;i<o;++i,t+=q.A.packedLength)s[i]=q.A.unpack(e,t);const a=K.A.unpack(e,t,rh);t+=K.A.packedLength;const c=Rr.A.unpack(e,t,sh);t+=Rr.A.packedLength;const l=e[t++],u=e[t];return(0,d.A)(n)?(n._positions=r,n._shape=s,n._ellipsoid=K.A.clone(a,n._ellipsoid),n._vertexFormat=Rr.A.clone(c,n._vertexFormat),n._cornerType=l,n._granularity=u,n):(ah.polylinePositions=r,ah.shapePositions=s,ah.cornerType=l,ah.granularity=u,new oh(ah))};const ch=new c.A;oh.createGeometry=function(e){const t=e._positions,n=(0,go.A)(t,j.A.equalsEpsilon);let i=e._shape;if(i=ir.removeDuplicatesFromShape(i),n.length<2||i.length<3)return;Dr.A.computeWindingOrder2D(i)===Fd.A.CLOCKWISE&&i.reverse();const o=c.A.fromPoints(i,ch);return function(e,t,n,i){const o=new Ir.A;i.position&&(o.position=new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:e}));const r=t.length,s=e.length/3,a=(s-2*r)/(2*r),c=Dr.A.triangulate(t),l=(a-1)*r*6+2*c.length,u=Pr.A.createTypedArray(s,l);let d,h,A,f,m,g;const _=2*r;let y=0;for(d=0;d<a-1;d++){for(h=0;h<r-1;h++)A=2*h+d*r*2,g=A+_,f=A+1,m=f+_,u[y++]=f,u[y++]=A,u[y++]=m,u[y++]=m,u[y++]=A,u[y++]=g;A=2*r-2+d*r*2,f=A+1,m=f+_,g=A+_,u[y++]=f,u[y++]=A,u[y++]=m,u[y++]=m,u[y++]=A,u[y++]=g}if(i.st||i.tangent||i.bitangent){const e=new Float32Array(2*s),i=1/(a-1),c=1/n.height,l=n.height/2;let u,A,p=0;for(d=0;d<a;d++){for(u=d*i,A=c*(t[0].y+l),e[p++]=u,e[p++]=A,h=1;h<r;h++)A=c*(t[h].y+l),e[p++]=u,e[p++]=A,e[p++]=u,e[p++]=A;A=c*(t[0].y+l),e[p++]=u,e[p++]=A}for(h=0;h<r;h++)u=0,A=c*(t[h].y+l),e[p++]=u,e[p++]=A;for(h=0;h<r;h++)u=(a-1)*i,A=c*(t[h].y+l),e[p++]=u,e[p++]=A;o.st=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:2,values:new Float32Array(e)})}const v=s-2*r;for(d=0;d<c.length;d+=3){const e=c[d]+v,t=c[d+1]+v,n=c[d+2]+v;u[y++]=e,u[y++]=t,u[y++]=n,u[y++]=n+r,u[y++]=t+r,u[y++]=e+r}let T=new I.A({attributes:o,indices:u,boundingSphere:Sn.A.fromVertices(e),primitiveType:p.A.TRIANGLES});if(i.normal&&(T=Ad.A.computeNormal(T)),i.tangent||i.bitangent){try{T=Ad.A.computeTangentAndBitangent(T)}catch(e){(0,Fn.A)("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}i.tangent||(T.attributes.tangent=void 0),i.bitangent||(T.attributes.bitangent=void 0),i.st||(T.attributes.st=void 0)}return T}(ir.computePositions(n,i,o,e,!0),i,o,e._vertexFormat)};const lh=oh;function uh(e){const t=(e=e??S.A.EMPTY_OBJECT).polylinePositions,n=e.shapePositions;if(!(0,d.A)(t))throw new A.A("options.polylinePositions is required.");if(!(0,d.A)(n))throw new A.A("options.shapePositions is required.");this._positions=t,this._shape=n,this._ellipsoid=K.A.clone(e.ellipsoid??K.A.default),this._cornerType=e.cornerType??_o.ROUNDED,this._granularity=e.granularity??J.A.RADIANS_PER_DEGREE,this._workerName="createPolylineVolumeOutlineGeometry";let i=1+t.length*j.A.packedLength;i+=1+n.length*q.A.packedLength,this.packedLength=i+K.A.packedLength+2}uh.pack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("value is required");if(!(0,d.A)(t))throw new A.A("array is required");let i;n=n??0;const o=e._positions;let r=o.length;for(t[n++]=r,i=0;i<r;++i,n+=j.A.packedLength)j.A.pack(o[i],t,n);const s=e._shape;for(r=s.length,t[n++]=r,i=0;i<r;++i,n+=q.A.packedLength)q.A.pack(s[i],t,n);return K.A.pack(e._ellipsoid,t,n),n+=K.A.packedLength,t[n++]=e._cornerType,t[n]=e._granularity,t};const dh=K.A.clone(K.A.UNIT_SPHERE),hh={polylinePositions:void 0,shapePositions:void 0,ellipsoid:dh,height:void 0,cornerType:void 0,granularity:void 0};uh.unpack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("array is required");let i;t=t??0;let o=e[t++];const r=new Array(o);for(i=0;i<o;++i,t+=j.A.packedLength)r[i]=j.A.unpack(e,t);o=e[t++];const s=new Array(o);for(i=0;i<o;++i,t+=q.A.packedLength)s[i]=q.A.unpack(e,t);const a=K.A.unpack(e,t,dh);t+=K.A.packedLength;const c=e[t++],l=e[t];return(0,d.A)(n)?(n._positions=r,n._shape=s,n._ellipsoid=K.A.clone(a,n._ellipsoid),n._cornerType=c,n._granularity=l,n):(hh.polylinePositions=r,hh.shapePositions=s,hh.cornerType=c,hh.granularity=l,new uh(hh))};const Ah=new c.A;uh.createGeometry=function(e){const t=e._positions,n=(0,go.A)(t,j.A.equalsEpsilon);let i=e._shape;if(i=ir.removeDuplicatesFromShape(i),n.length<2||i.length<3)return;Dr.A.computeWindingOrder2D(i)===Fd.A.CLOCKWISE&&i.reverse();const o=c.A.fromPoints(i,Ah);return function(e,t){const n=new Ir.A;n.position=new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:e});const i=t.length,o=n.position.values.length/3,r=e.length/3/i,s=Pr.A.createTypedArray(o,2*i*(r+1));let a,c,l=0;a=0;let u=a*i;for(c=0;c<i-1;c++)s[l++]=c+u,s[l++]=c+u+1;for(s[l++]=i-1+u,s[l++]=u,a=r-1,u=a*i,c=0;c<i-1;c++)s[l++]=c+u,s[l++]=c+u+1;for(s[l++]=i-1+u,s[l++]=u,a=0;a<r-1;a++){const e=i*a,t=e+i;for(c=0;c<i;c++)s[l++]=c+e,s[l++]=c+t}return new I.A({attributes:n,indices:Pr.A.createTypedArray(o,s),boundingSphere:Sn.A.fromVertices(e),primitiveType:p.A.LINES})}(ir.computePositions(n,i,o,e,!1),i)};const ph=uh,fh=new u.A;function mh(e){this.id=e,this.vertexFormat=void 0,this.polylinePositions=void 0,this.shapePositions=void 0,this.cornerType=void 0,this.granularity=void 0}function gh(e,t){$n.call(this,{entity:e,scene:t,geometryOptions:new mh(e),geometryPropertyName:"polylineVolume",observedPropertyNames:["availability","polylineVolume"]}),this._onEntityPropertyChanged(e,"polylineVolume",e.polylineVolume,void 0)}function _h(e,t,n){Nn.call(this,e,t,n)}(0,d.A)(Object.create)&&(gh.prototype=Object.create($n.prototype),gh.prototype.constructor=gh),gh.prototype.createFillGeometryInstance=function(e){if(l.A.defined("time",e),!this._fillEnabled)throw new A.A("This instance does not represent a filled geometry.");const t=this._entity,n=t.isAvailable(e);let i,o;const r=new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),s=this._distanceDisplayConditionProperty.getValue(e),a=_n.fromDistanceDisplayCondition(s);if(this._materialProperty instanceof En.A){let t;(0,d.A)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,fh)),(0,d.A)(t)||(t=u.A.WHITE),o=mn.A.fromColor(t),i={show:r,distanceDisplayCondition:a,color:o}}else i={show:r,distanceDisplayCondition:a};return new yn.A({id:t,geometry:new lh(this._options),attributes:i})},gh.prototype.createOutlineGeometryInstance=function(e){if(l.A.defined("time",e),!this._outlineEnabled)throw new A.A("This instance does not represent an outlined geometry.");const t=this._entity,n=t.isAvailable(e),i=Wt.A.getValueOrDefault(this._outlineColorProperty,e,u.A.BLACK,fh),o=this._distanceDisplayConditionProperty.getValue(e);return new yn.A({id:t,geometry:new ph(this._options),attributes:{show:new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:mn.A.fromColor(i),distanceDisplayCondition:_n.fromDistanceDisplayCondition(o)}})},gh.prototype._isHidden=function(e,t){return!(0,d.A)(t.positions)||!(0,d.A)(t.shape)||$n.prototype._isHidden.call(this,e,t)},gh.prototype._isDynamic=function(e,t){return!(t.positions.isConstant&&t.shape.isConstant&&Wt.A.isConstant(t.granularity)&&Wt.A.isConstant(t.outlineWidth)&&Wt.A.isConstant(t.cornerType))},gh.prototype._setStaticOptions=function(e,t){const n=t.granularity,i=t.cornerType,o=this._options,r=this._materialProperty instanceof En.A;o.vertexFormat=r?Cn.A.VERTEX_FORMAT:xn.A.MaterialSupport.TEXTURED.vertexFormat,o.polylinePositions=t.positions.getValue(Tn.A.MINIMUM_VALUE,o.polylinePositions),o.shapePositions=t.shape.getValue(Tn.A.MINIMUM_VALUE,o.shape),o.granularity=(0,d.A)(n)?n.getValue(Tn.A.MINIMUM_VALUE):void 0,o.cornerType=(0,d.A)(i)?i.getValue(Tn.A.MINIMUM_VALUE):void 0},gh.DynamicGeometryUpdater=_h,(0,d.A)(Object.create)&&(_h.prototype=Object.create(Nn.prototype),_h.prototype.constructor=_h),_h.prototype._isHidden=function(e,t,n){const i=this._options;return!(0,d.A)(i.polylinePositions)||!(0,d.A)(i.shapePositions)||Nn.prototype._isHidden.call(this,e,t,n)},_h.prototype._setOptions=function(e,t,n){const i=this._options;i.polylinePositions=Wt.A.getValueOrUndefined(t.positions,n,i.polylinePositions),i.shapePositions=Wt.A.getValueOrUndefined(t.shape,n),i.granularity=Wt.A.getValueOrUndefined(t.granularity,n),i.cornerType=Wt.A.getValueOrUndefined(t.cornerType,n)};const yh=gh;var vh=n(463298),Th=n(512827);const bh=new j.A,wh=new j.A,xh=new j.A,Ch=new j.A,Eh=new Or.A,Sh=new q.A,Ih=new Sn.A,Ph=new Sn.A;function Dh(e,t){const n=new I.A({attributes:new Ir.A,primitiveType:p.A.TRIANGLES});return n.attributes.position=new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:t.positions}),e.normal&&(n.attributes.normal=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:t.normals})),e.tangent&&(n.attributes.tangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:t.tangents})),e.bitangent&&(n.attributes.bitangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:t.bitangents})),n}const Oh=new j.A,Rh=new j.A;function Mh(e,t){const n=e._vertexFormat,i=e._ellipsoid,o=t.height,r=t.width,s=t.northCap,a=t.southCap;let c=0,l=o,u=o,d=0;s&&(c=1,u-=1,d+=1),a&&(l-=1,u-=1,d+=1),d+=r*u;const h=n.position?new Float64Array(3*d):void 0,A=n.st?new Float32Array(2*d):void 0;let p=0,f=0;const m=bh,g=Sh;let _=Number.MAX_VALUE,y=Number.MAX_VALUE,v=-Number.MAX_VALUE,T=-Number.MAX_VALUE;for(let e=c;e<l;++e)for(let o=0;o<r;++o)Th.A.computePosition(t,i,n.st,e,o,m,g),h[p++]=m.x,h[p++]=m.y,h[p++]=m.z,n.st&&(A[f++]=g.x,A[f++]=g.y,_=Math.min(_,g.x),y=Math.min(y,g.y),v=Math.max(v,g.x),T=Math.max(T,g.y));if(s&&(Th.A.computePosition(t,i,n.st,0,0,m,g),h[p++]=m.x,h[p++]=m.y,h[p++]=m.z,n.st&&(A[f++]=g.x,A[f++]=g.y,_=g.x,y=g.y,v=g.x,T=g.y)),a&&(Th.A.computePosition(t,i,n.st,o-1,0,m,g),h[p++]=m.x,h[p++]=m.y,h[p]=m.z,n.st&&(A[f++]=g.x,A[f]=g.y,_=Math.min(_,g.x),y=Math.min(y,g.y),v=Math.max(v,g.x),T=Math.max(T,g.y))),n.st&&(_<0||y<0||v>1||T>1))for(let e=0;e<A.length;e+=2)A[e]=(A[e]-_)/(v-_),A[e+1]=(A[e+1]-y)/(T-y);const b=function(e,t,n,i){const o=e.length,r=t.normal?new Float32Array(o):void 0,s=t.tangent?new Float32Array(o):void 0,a=t.bitangent?new Float32Array(o):void 0;let c=0;const l=Ch,u=xh;let d=wh;if(t.normal||t.tangent||t.bitangent)for(let h=0;h<o;h+=3){const o=j.A.fromArray(e,h,bh),A=c+1,p=c+2;d=n.geodeticSurfaceNormal(o,d),(t.tangent||t.bitangent)&&(j.A.cross(j.A.UNIT_Z,d,u),Z.A.multiplyByVector(i,u,u),j.A.normalize(u,u),t.bitangent&&j.A.normalize(j.A.cross(d,u,l),l)),t.normal&&(r[c]=d.x,r[A]=d.y,r[p]=d.z),t.tangent&&(s[c]=u.x,s[A]=u.y,s[p]=u.z),t.bitangent&&(a[c]=l.x,a[A]=l.y,a[p]=l.z),c+=3}return Dh(t,{positions:e,normals:r,tangents:s,bitangents:a})}(h,n,i,t.tangentRotationMatrix);let w=6*(r-1)*(u-1);s&&(w+=3*(r-1)),a&&(w+=3*(r-1));const x=Pr.A.createTypedArray(d,w);let E,S=0,I=0;for(E=0;E<u-1;++E){for(let e=0;e<r-1;++e){const e=S,t=e+r,n=t+1,i=e+1;x[I++]=e,x[I++]=t,x[I++]=i,x[I++]=i,x[I++]=t,x[I++]=n,++S}++S}if(s||a){let e=d-1;const t=d-1;let n,i;if(s&&a&&(e=d-2),S=0,s)for(E=0;E<r-1;E++)n=S,i=n+1,x[I++]=e,x[I++]=n,x[I++]=i,++S;if(a)for(S=(u-1)*r,E=0;E<r-1;E++)n=S,i=n+1,x[I++]=n,x[I++]=t,x[I++]=i,++S}return b.indices=x,n.st&&(b.attributes.st=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:2,values:A})),b}function Lh(e,t,n,i,o){return e[t++]=i[n],e[t++]=i[n+1],e[t++]=i[n+2],e[t++]=o[n],e[t++]=o[n+1],e[t]=o[n+2],e}function Nh(e,t,n,i){return e[t++]=i[n],e[t++]=i[n+1],e[t++]=i[n],e[t]=i[n+1],e}const Bh=new Rr.A;const Fh=[new j.A,new j.A,new j.A,new j.A],Uh=new X.A,kh=new X.A;function Vh(e,t,n,i,o){if(0===n)return Or.A.clone(e,o);const r=Th.A.computeOptions(e,t,n,0,Eh,Uh),s=r.height,a=r.width,c=Fh;return Th.A.computePosition(r,i,!1,0,0,c[0]),Th.A.computePosition(r,i,!1,0,a-1,c[1]),Th.A.computePosition(r,i,!1,s-1,0,c[2]),Th.A.computePosition(r,i,!1,s-1,a-1,c[3]),Or.A.fromCartesianArray(c,i,o)}function zh(e){const t=(e=e??S.A.EMPTY_OBJECT).rectangle;if(l.A.typeOf.object("rectangle",t),Or.A._validate(t),t.north<t.south)throw new A.A("options.rectangle.north must be greater than or equal to options.rectangle.south");const n=e.height??0,i=e.extrudedHeight??n;this._rectangle=Or.A.clone(t),this._granularity=e.granularity??J.A.RADIANS_PER_DEGREE,this._ellipsoid=K.A.clone(e.ellipsoid??K.A.default),this._surfaceHeight=Math.max(n,i),this._rotation=e.rotation??0,this._stRotation=e.stRotation??0,this._vertexFormat=Rr.A.clone(e.vertexFormat??Rr.A.DEFAULT),this._extrudedHeight=Math.min(n,i),this._shadowVolume=e.shadowVolume??!1,this._workerName="createRectangleGeometry",this._offsetAttribute=e.offsetAttribute,this._rotatedRectangle=void 0,this._textureCoordinateRotationPoints=void 0}zh.packedLength=Or.A.packedLength+K.A.packedLength+Rr.A.packedLength+7,zh.pack=function(e,t,n){return l.A.typeOf.object("value",e),l.A.defined("array",t),n=n??0,Or.A.pack(e._rectangle,t,n),n+=Or.A.packedLength,K.A.pack(e._ellipsoid,t,n),n+=K.A.packedLength,Rr.A.pack(e._vertexFormat,t,n),n+=Rr.A.packedLength,t[n++]=e._granularity,t[n++]=e._surfaceHeight,t[n++]=e._rotation,t[n++]=e._stRotation,t[n++]=e._extrudedHeight,t[n++]=e._shadowVolume?1:0,t[n]=e._offsetAttribute??-1,t};const Hh=new Or.A,Gh=K.A.clone(K.A.UNIT_SPHERE),Wh={rectangle:Hh,ellipsoid:Gh,vertexFormat:Bh,granularity:void 0,height:void 0,rotation:void 0,stRotation:void 0,extrudedHeight:void 0,shadowVolume:void 0,offsetAttribute:void 0};zh.unpack=function(e,t,n){l.A.defined("array",e),t=t??0;const i=Or.A.unpack(e,t,Hh);t+=Or.A.packedLength;const o=K.A.unpack(e,t,Gh);t+=K.A.packedLength;const r=Rr.A.unpack(e,t,Bh);t+=Rr.A.packedLength;const s=e[t++],a=e[t++],c=e[t++],u=e[t++],h=e[t++],A=1===e[t++],p=e[t];return(0,d.A)(n)?(n._rectangle=Or.A.clone(i,n._rectangle),n._ellipsoid=K.A.clone(o,n._ellipsoid),n._vertexFormat=Rr.A.clone(r,n._vertexFormat),n._granularity=s,n._surfaceHeight=a,n._rotation=c,n._stRotation=u,n._extrudedHeight=h,n._shadowVolume=A,n._offsetAttribute=-1===p?void 0:p,n):(Wh.granularity=s,Wh.height=a,Wh.rotation=c,Wh.stRotation=u,Wh.extrudedHeight=h,Wh.shadowVolume=A,Wh.offsetAttribute=-1===p?void 0:p,new zh(Wh))},zh.computeRectangle=function(e,t){const n=(e=e??S.A.EMPTY_OBJECT).rectangle;if(l.A.typeOf.object("rectangle",n),Or.A._validate(n),n.north<n.south)throw new A.A("options.rectangle.north must be greater than or equal to options.rectangle.south");const i=e.granularity??J.A.RADIANS_PER_DEGREE,o=e.ellipsoid??K.A.default;return Vh(n,i,e.rotation??0,o,t)};const Yh=new Z.A,qh=new To.A,jh=new X.A;zh.createGeometry=function(e){if(J.A.equalsEpsilon(e._rectangle.north,e._rectangle.south,J.A.EPSILON10)||J.A.equalsEpsilon(e._rectangle.east,e._rectangle.west,J.A.EPSILON10))return;let t=e._rectangle;const n=e._ellipsoid,i=e._rotation,o=e._stRotation,r=e._vertexFormat,s=Th.A.computeOptions(t,e._granularity,i,o,Eh,Uh,kh),a=Yh;if(0!==o||0!==i){const e=Or.A.center(t,jh),i=n.geodeticSurfaceNormalCartographic(e,Oh);To.A.fromAxisAngle(i,-o,qh),Z.A.fromQuaternion(qh,a)}else Z.A.clone(Z.A.IDENTITY,a);const c=e._surfaceHeight,l=e._extrudedHeight,u=!J.A.equalsEpsilon(c,l,0,J.A.EPSILON2);let h,A;if(s.lonScalar=1/e._rectangle.width,s.latScalar=1/e._rectangle.height,s.tangentRotationMatrix=a,t=e._rectangle,u){h=function(e,t){const n=e._shadowVolume,i=e._offsetAttribute,o=e._vertexFormat,r=e._extrudedHeight,s=e._surfaceHeight,a=e._ellipsoid,c=t.height,l=t.width;let u;if(n){const t=Rr.A.clone(o,Bh);t.normal=!0,e._vertexFormat=t}const h=Mh(e,t);n&&(e._vertexFormat=o);let A=Dr.A.scaleToGeodeticHeight(h.attributes.position.values,s,a,!1);A=new Float64Array(A);let p=A.length;const f=2*p,m=new Float64Array(f);m.set(A);const g=Dr.A.scaleToGeodeticHeight(h.attributes.position.values,r,a);m.set(g,p),h.attributes.position.values=m;const _=o.normal?new Float32Array(f):void 0,y=o.tangent?new Float32Array(f):void 0,v=o.bitangent?new Float32Array(f):void 0,T=o.st?new Float32Array(f/3*2):void 0;let b,w,x;if(o.normal){for(w=h.attributes.normal.values,_.set(w),u=0;u<p;u++)w[u]=-w[u];_.set(w,p),h.attributes.normal.values=_}if(n){w=h.attributes.normal.values,o.normal||(h.attributes.normal=void 0);const e=new Float32Array(f);for(u=0;u<p;u++)w[u]=-w[u];e.set(w,p),h.attributes.extrudeDirection=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:e})}const E=(0,d.A)(i);if(E){const e=p/3*2;let t=new Uint8Array(e);i===vn.A.TOP?t=t.fill(1,0,e/2):(x=i===vn.A.NONE?0:1,t=t.fill(x)),h.attributes.applyOffset=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}if(o.tangent){const e=h.attributes.tangent.values;for(y.set(e),u=0;u<p;u++)e[u]=-e[u];y.set(e,p),h.attributes.tangent.values=y}if(o.bitangent){const e=h.attributes.bitangent.values;v.set(e),v.set(e,p),h.attributes.bitangent.values=v}o.st&&(b=h.attributes.st.values,T.set(b),T.set(b,p/3*2),h.attributes.st.values=T);const S=h.indices,I=S.length,D=p/3,O=Pr.A.createTypedArray(f/3,2*I);for(O.set(S),u=0;u<I;u+=3)O[u+I]=S[u+2]+D,O[u+1+I]=S[u+1]+D,O[u+2+I]=S[u]+D;h.indices=O;const R=t.northCap,M=t.southCap;let L=c,N=2,B=0,F=4,U=4;R&&(N-=1,L-=1,B+=1,F-=2,U-=1),M&&(N-=1,L-=1,B+=1,F-=2,U-=1),B+=N*l+2*L-F;const k=2*(B+U);let V=new Float64Array(3*k);const z=n?new Float32Array(3*k):void 0;let H=E?new Uint8Array(k):void 0,G=o.st?new Float32Array(2*k):void 0;const W=i===vn.A.TOP;E&&!W&&(x=i===vn.A.ALL?1:0,H=H.fill(x));let Y=0,q=0,Q=0,X=0;const K=l*L;let $;for(u=0;u<K;u+=l)$=3*u,V=Lh(V,Y,$,A,g),Y+=6,o.st&&(G=Nh(G,q,2*u,b),q+=4),n&&(Q+=3,z[Q++]=w[$],z[Q++]=w[$+1],z[Q++]=w[$+2]),W&&(H[X++]=1,X+=1);if(M){const e=R?K+1:K;for($=3*e,u=0;u<2;u++)V=Lh(V,Y,$,A,g),Y+=6,o.st&&(G=Nh(G,q,2*e,b),q+=4),n&&(Q+=3,z[Q++]=w[$],z[Q++]=w[$+1],z[Q++]=w[$+2]),W&&(H[X++]=1,X+=1)}else for(u=K-l;u<K;u++)$=3*u,V=Lh(V,Y,$,A,g),Y+=6,o.st&&(G=Nh(G,q,2*u,b),q+=4),n&&(Q+=3,z[Q++]=w[$],z[Q++]=w[$+1],z[Q++]=w[$+2]),W&&(H[X++]=1,X+=1);for(u=K-1;u>0;u-=l)$=3*u,V=Lh(V,Y,$,A,g),Y+=6,o.st&&(G=Nh(G,q,2*u,b),q+=4),n&&(Q+=3,z[Q++]=w[$],z[Q++]=w[$+1],z[Q++]=w[$+2]),W&&(H[X++]=1,X+=1);if(R){const e=K;for($=3*e,u=0;u<2;u++)V=Lh(V,Y,$,A,g),Y+=6,o.st&&(G=Nh(G,q,2*e,b),q+=4),n&&(Q+=3,z[Q++]=w[$],z[Q++]=w[$+1],z[Q++]=w[$+2]),W&&(H[X++]=1,X+=1)}else for(u=l-1;u>=0;u--)$=3*u,V=Lh(V,Y,$,A,g),Y+=6,o.st&&(G=Nh(G,q,2*u,b),q+=4),n&&(Q+=3,z[Q++]=w[$],z[Q++]=w[$+1],z[Q++]=w[$+2]),W&&(H[X++]=1,X+=1);let Z=function(e,t,n){const i=e.length,o=t.normal?new Float32Array(i):void 0,r=t.tangent?new Float32Array(i):void 0,s=t.bitangent?new Float32Array(i):void 0;let a=0,c=0,l=0,u=!0,d=Ch,h=xh,A=wh;if(t.normal||t.tangent||t.bitangent)for(let p=0;p<i;p+=6){const f=j.A.fromArray(e,p,bh),m=j.A.fromArray(e,(p+6)%i,Oh);if(u){const t=j.A.fromArray(e,(p+3)%i,Rh);j.A.subtract(m,f,m),j.A.subtract(t,f,t),A=j.A.normalize(j.A.cross(t,m,A),A),u=!1}j.A.equalsEpsilon(m,f,J.A.EPSILON10)&&(u=!0),(t.tangent||t.bitangent)&&(d=n.geodeticSurfaceNormal(f,d),t.tangent&&(h=j.A.normalize(j.A.cross(d,A,h),h))),t.normal&&(o[a++]=A.x,o[a++]=A.y,o[a++]=A.z,o[a++]=A.x,o[a++]=A.y,o[a++]=A.z),t.tangent&&(r[c++]=h.x,r[c++]=h.y,r[c++]=h.z,r[c++]=h.x,r[c++]=h.y,r[c++]=h.z),t.bitangent&&(s[l++]=d.x,s[l++]=d.y,s[l++]=d.z,s[l++]=d.x,s[l++]=d.y,s[l++]=d.z)}return Dh(t,{positions:e,normals:o,tangents:r,bitangents:s})}(V,o,a);o.st&&(Z.attributes.st=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:2,values:G})),n&&(Z.attributes.extrudeDirection=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:z})),E&&(Z.attributes.applyOffset=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:H}));const ee=Pr.A.createTypedArray(k,6*B);let te,ne,ie,oe;p=V.length/3;let re=0;for(u=0;u<p-1;u+=2){te=u,oe=(te+2)%p;const e=j.A.fromArray(V,3*te,Oh),t=j.A.fromArray(V,3*oe,Rh);j.A.equalsEpsilon(e,t,J.A.EPSILON10)||(ne=(te+1)%p,ie=(ne+2)%p,ee[re++]=te,ee[re++]=ne,ee[re++]=oe,ee[re++]=oe,ee[re++]=ne,ee[re++]=ie)}return Z.indices=ee,Z=Ad.A.combineInstances([new yn.A({geometry:h}),new yn.A({geometry:Z})]),Z[0]}(e,s);const i=Sn.A.fromRectangle3D(t,n,c,Ph),o=Sn.A.fromRectangle3D(t,n,l,Ih);A=Sn.A.union(i,o)}else{if(h=Mh(e,s),h.attributes.position.values=Dr.A.scaleToGeodeticHeight(h.attributes.position.values,c,n,!1),(0,d.A)(e._offsetAttribute)){const t=h.attributes.position.values.length,n=e._offsetAttribute===vn.A.NONE?0:1,i=new Uint8Array(t/3).fill(n);h.attributes.applyOffset=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}A=Sn.A.fromRectangle3D(t,n,c)}return r.position||delete h.attributes.position,new I.A({attributes:h.attributes,indices:h.indices,primitiveType:h.primitiveType,boundingSphere:A,offsetAttribute:e._offsetAttribute})},zh.createShadowVolume=function(e,t,n){const i=e._granularity,o=e._ellipsoid,r=t(i,o),s=n(i,o);return new zh({rectangle:e._rectangle,rotation:e._rotation,ellipsoid:o,stRotation:e._stRotation,granularity:i,extrudedHeight:s,height:r,vertexFormat:Rr.A.POSITION_ONLY,shadowVolume:!0})};const Qh=new Or.A,Xh=[new q.A,new q.A,new q.A],Kh=new vh.A,$h=new X.A;Object.defineProperties(zh.prototype,{rectangle:{get:function(){return(0,d.A)(this._rotatedRectangle)||(this._rotatedRectangle=Vh(this._rectangle,this._granularity,this._rotation,this._ellipsoid)),this._rotatedRectangle}},textureCoordinateRotationPoints:{get:function(){return(0,d.A)(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=function(e){if(0===e._stRotation)return[0,0,0,1,1,0];const t=Or.A.clone(e._rectangle,Qh),n=e._granularity,i=e._ellipsoid,o=Vh(t,n,e._rotation-e._stRotation,i,Qh),r=Xh;r[0].x=o.west,r[0].y=o.south,r[1].x=o.west,r[1].y=o.north,r[2].x=o.east,r[2].y=o.south;const s=e.rectangle,a=vh.A.fromRotation(e._stRotation,Kh),c=Or.A.center(s,$h);for(let e=0;e<3;++e){const t=r[e];t.x-=c.longitude,t.y-=c.latitude,vh.A.multiplyByVector(a,t,t),t.x+=c.longitude,t.y+=c.latitude,t.x=(t.x-s.west)/s.width,t.y=(t.y-s.south)/s.height}const l=r[0],u=r[1],d=r[2],h=new Array(6);return q.A.pack(l,h),q.A.pack(u,h,2),q.A.pack(d,h,4),h}(this)),this._textureCoordinateRotationPoints}}});const Jh=zh;var Zh=n(406882);const eA=new u.A,tA=j.A.ZERO,nA=new j.A,iA=new Or.A,oA=new Or.A,rA=new X.A;function sA(e){this.id=e,this.vertexFormat=void 0,this.rectangle=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.rotation=void 0,this.offsetAttribute=void 0}function aA(e,t){fs.call(this,{entity:e,scene:t,geometryOptions:new sA(e),geometryPropertyName:"rectangle",observedPropertyNames:["availability","rectangle"]}),this._onEntityPropertyChanged(e,"rectangle",e.rectangle,void 0)}function cA(e,t,n){Nn.call(this,e,t,n)}(0,d.A)(Object.create)&&(aA.prototype=Object.create(fs.prototype),aA.prototype.constructor=aA),aA.prototype.createFillGeometryInstance=function(e){if(l.A.defined("time",e),!this._fillEnabled)throw new A.A("This instance does not represent a filled geometry.");const t=this._entity,n=t.isAvailable(e),i={show:new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:_n.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof En.A){let t;(0,d.A)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,eA)),(0,d.A)(t)||(t=u.A.WHITE),i.color=mn.A.fromColor(t)}return(0,d.A)(this._options.offsetAttribute)&&(i.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,tA,nA))),new yn.A({id:t,geometry:new Jh(this._options),attributes:i})},aA.prototype.createOutlineGeometryInstance=function(e){if(l.A.defined("time",e),!this._outlineEnabled)throw new A.A("This instance does not represent an outlined geometry.");const t=this._entity,n=t.isAvailable(e),i=Wt.A.getValueOrDefault(this._outlineColorProperty,e,u.A.BLACK,eA),o=this._distanceDisplayConditionProperty.getValue(e),r={show:new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:mn.A.fromColor(i),distanceDisplayCondition:_n.fromDistanceDisplayCondition(o),offset:void 0};return(0,d.A)(this._options.offsetAttribute)&&(r.offset=bn.A.fromCartesian3(Wt.A.getValueOrDefault(this._terrainOffsetProperty,e,tA,nA))),new yn.A({id:t,geometry:new Zh.A(this._options),attributes:r})},aA.prototype._computeCenter=function(e,t){const n=Wt.A.getValueOrUndefined(this._entity.rectangle.coordinates,e,oA);if(!(0,d.A)(n))return;const i=Or.A.center(n,rA);return X.A.toCartesian(i,K.A.default,t)},aA.prototype._isHidden=function(e,t){return!(0,d.A)(t.coordinates)||$n.prototype._isHidden.call(this,e,t)},aA.prototype._isDynamic=function(e,t){return!t.coordinates.isConstant||!Wt.A.isConstant(t.height)||!Wt.A.isConstant(t.extrudedHeight)||!Wt.A.isConstant(t.granularity)||!Wt.A.isConstant(t.stRotation)||!Wt.A.isConstant(t.rotation)||!Wt.A.isConstant(t.outlineWidth)||!Wt.A.isConstant(t.zIndex)||this._onTerrain&&!Wt.A.isConstant(this._materialProperty)&&!(this._materialProperty instanceof En.A)},aA.prototype._setStaticOptions=function(e,t){const n=this._materialProperty instanceof En.A;let i=Wt.A.getValueOrUndefined(t.height,Tn.A.MINIMUM_VALUE);const o=Wt.A.getValueOrDefault(t.heightReference,Tn.A.MINIMUM_VALUE,Vt.Ay.NONE);let r=Wt.A.getValueOrUndefined(t.extrudedHeight,Tn.A.MINIMUM_VALUE);const s=Wt.A.getValueOrDefault(t.extrudedHeightReference,Tn.A.MINIMUM_VALUE,Vt.Ay.NONE);(0,d.A)(r)&&!(0,d.A)(i)&&(i=0);const a=this._options;a.vertexFormat=n?Cn.A.VERTEX_FORMAT:xn.A.MaterialSupport.TEXTURED.vertexFormat,a.rectangle=t.coordinates.getValue(Tn.A.MINIMUM_VALUE,a.rectangle),a.granularity=Wt.A.getValueOrUndefined(t.granularity,Tn.A.MINIMUM_VALUE),a.stRotation=Wt.A.getValueOrUndefined(t.stRotation,Tn.A.MINIMUM_VALUE),a.rotation=Wt.A.getValueOrUndefined(t.rotation,Tn.A.MINIMUM_VALUE),a.offsetAttribute=fs.computeGeometryOffsetAttribute(i,o,r,s),a.height=fs.getGeometryHeight(i,o),r=fs.getGeometryExtrudedHeight(r,s),r===fs.CLAMP_TO_GROUND&&(r=mo.A.getMinimumMaximumHeights(Jh.computeRectangle(a,iA)).minimumTerrainHeight),a.extrudedHeight=r},aA.DynamicGeometryUpdater=cA,(0,d.A)(Object.create)&&(cA.prototype=Object.create(Nn.prototype),cA.prototype.constructor=cA),cA.prototype._isHidden=function(e,t,n){return!(0,d.A)(this._options.rectangle)||Nn.prototype._isHidden.call(this,e,t,n)},cA.prototype._setOptions=function(e,t,n){const i=this._options;let o=Wt.A.getValueOrUndefined(t.height,n);const r=Wt.A.getValueOrDefault(t.heightReference,n,Vt.Ay.NONE);let s=Wt.A.getValueOrUndefined(t.extrudedHeight,n);const a=Wt.A.getValueOrDefault(t.extrudedHeightReference,n,Vt.Ay.NONE);(0,d.A)(s)&&!(0,d.A)(o)&&(o=0),i.rectangle=Wt.A.getValueOrUndefined(t.coordinates,n,i.rectangle),i.granularity=Wt.A.getValueOrUndefined(t.granularity,n),i.stRotation=Wt.A.getValueOrUndefined(t.stRotation,n),i.rotation=Wt.A.getValueOrUndefined(t.rotation,n),i.offsetAttribute=fs.computeGeometryOffsetAttribute(o,r,s,a),i.height=fs.getGeometryHeight(o,r),s=fs.getGeometryExtrudedHeight(s,a),s===fs.CLAMP_TO_GROUND&&(s=mo.A.getMinimumMaximumHeights(Jh.computeRectangle(i,iA)).minimumTerrainHeight),i.extrudedHeight=s};const lA=aA,uA={};function dA(e,t){return J.A.equalsEpsilon(e.latitude,t.latitude,J.A.EPSILON10)&&J.A.equalsEpsilon(e.longitude,t.longitude,J.A.EPSILON10)}const hA=new X.A,AA=new X.A,pA=new Array(2),fA=new Array(2),mA={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};uA.computePositions=function(e,t,n,i,o,r){const s=function(e,t,n,i){const o=(t=(0,go.A)(t,j.A.equalsEpsilon)).length;if(o<2)return;const r=(0,d.A)(i),s=(0,d.A)(n),a=new Array(o),c=new Array(o),l=new Array(o),u=t[0];a[0]=u;const h=e.cartesianToCartographic(u,hA);s&&(h.height=n[0]),c[0]=h.height,l[0]=r?i[0]:0;let A=c[0]===l[0],p=1;for(let u=1;u<o;++u){const o=t[u],d=e.cartesianToCartographic(o,AA);s&&(d.height=n[u]),A=A&&0===d.height,dA(h,d)?h.height<d.height&&(c[p-1]=d.height):(a[p]=o,c[p]=d.height,l[p]=r?i[u]:0,A=A&&c[p]===l[p],X.A.clone(d,h),++p)}return A||p<2?void 0:(a.length=p,c.length=p,l.length=p,{positions:a,topHeights:c,bottomHeights:l})}(e,t,n,i);if(!(0,d.A)(s))return;t=s.positions,n=s.topHeights,i=s.bottomHeights;const a=t.length,c=a-2;let l,u;const h=J.A.chordLength(o,e.maximumRadius),A=mA;if(A.minDistance=h,A.ellipsoid=e,r){let e,o=0;for(e=0;e<a-1;e++)o+=yo.A.numberOfPoints(t[e],t[e+1],h)+1;l=new Float64Array(3*o),u=new Float64Array(3*o);const r=pA,s=fA;A.positions=r,A.height=s;let c=0;for(e=0;e<a-1;e++){r[0]=t[e],r[1]=t[e+1],s[0]=n[e],s[1]=n[e+1];const o=yo.A.generateArc(A);l.set(o,c),s[0]=i[e],s[1]=i[e+1],u.set(yo.A.generateArc(A),c),c+=o.length}}else A.positions=t,A.height=n,l=new Float64Array(yo.A.generateArc(A)),A.height=i,u=new Float64Array(yo.A.generateArc(A));return{bottomPositions:u,topPositions:l,numCorners:c}};const gA=uA,_A=new j.A,yA=new j.A,vA=new j.A,TA=new j.A,bA=new j.A,wA=new j.A,xA=new j.A;function CA(e){const t=(e=e??S.A.EMPTY_OBJECT).positions,n=e.maximumHeights,i=e.minimumHeights;if(!(0,d.A)(t))throw new A.A("options.positions is required.");if((0,d.A)(n)&&n.length!==t.length)throw new A.A("options.positions and options.maximumHeights must have the same length.");if((0,d.A)(i)&&i.length!==t.length)throw new A.A("options.positions and options.minimumHeights must have the same length.");const o=e.vertexFormat??Rr.A.DEFAULT,r=e.granularity??J.A.RADIANS_PER_DEGREE,s=e.ellipsoid??K.A.default;this._positions=t,this._minimumHeights=i,this._maximumHeights=n,this._vertexFormat=Rr.A.clone(o),this._granularity=r,this._ellipsoid=K.A.clone(s),this._workerName="createWallGeometry";let a=1+t.length*j.A.packedLength+2;(0,d.A)(i)&&(a+=i.length),(0,d.A)(n)&&(a+=n.length),this.packedLength=a+K.A.packedLength+Rr.A.packedLength+1}CA.pack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("value is required");if(!(0,d.A)(t))throw new A.A("array is required");let i;n=n??0;const o=e._positions;let r=o.length;for(t[n++]=r,i=0;i<r;++i,n+=j.A.packedLength)j.A.pack(o[i],t,n);const s=e._minimumHeights;if(r=(0,d.A)(s)?s.length:0,t[n++]=r,(0,d.A)(s))for(i=0;i<r;++i)t[n++]=s[i];const a=e._maximumHeights;if(r=(0,d.A)(a)?a.length:0,t[n++]=r,(0,d.A)(a))for(i=0;i<r;++i)t[n++]=a[i];return K.A.pack(e._ellipsoid,t,n),n+=K.A.packedLength,Rr.A.pack(e._vertexFormat,t,n),t[n+=Rr.A.packedLength]=e._granularity,t};const EA=K.A.clone(K.A.UNIT_SPHERE),SA=new Rr.A,IA={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:EA,vertexFormat:SA,granularity:void 0};CA.unpack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("array is required");let i;t=t??0;let o=e[t++];const r=new Array(o);for(i=0;i<o;++i,t+=j.A.packedLength)r[i]=j.A.unpack(e,t);let s,a;if(o=e[t++],o>0)for(s=new Array(o),i=0;i<o;++i)s[i]=e[t++];if(o=e[t++],o>0)for(a=new Array(o),i=0;i<o;++i)a[i]=e[t++];const c=K.A.unpack(e,t,EA);t+=K.A.packedLength;const l=Rr.A.unpack(e,t,SA),u=e[t+=Rr.A.packedLength];return(0,d.A)(n)?(n._positions=r,n._minimumHeights=s,n._maximumHeights=a,n._ellipsoid=K.A.clone(c,n._ellipsoid),n._vertexFormat=Rr.A.clone(l,n._vertexFormat),n._granularity=u,n):(IA.positions=r,IA.minimumHeights=s,IA.maximumHeights=a,IA.granularity=u,new CA(IA))},CA.fromConstantHeights=function(e){const t=(e=e??S.A.EMPTY_OBJECT).positions;if(!(0,d.A)(t))throw new A.A("options.positions is required.");let n,i;const o=e.minimumHeight,r=e.maximumHeight,s=(0,d.A)(o),a=(0,d.A)(r);if(s||a){const e=t.length;n=s?new Array(e):void 0,i=a?new Array(e):void 0;for(let t=0;t<e;++t)s&&(n[t]=o),a&&(i[t]=r)}return new CA({positions:t,maximumHeights:i,minimumHeights:n,ellipsoid:e.ellipsoid,vertexFormat:e.vertexFormat})},CA.createGeometry=function(e){const t=e._positions,n=e._minimumHeights,i=e._maximumHeights,o=e._vertexFormat,r=e._granularity,s=e._ellipsoid,a=gA.computePositions(s,t,i,n,r,!0);if(!(0,d.A)(a))return;const c=a.bottomPositions,l=a.topPositions,u=a.numCorners;let h=l.length,A=2*h;const f=o.position?new Float64Array(A):void 0,m=o.normal?new Float32Array(A):void 0,g=o.tangent?new Float32Array(A):void 0,_=o.bitangent?new Float32Array(A):void 0,y=o.st?new Float32Array(A/3*2):void 0;let v,T=0,b=0,w=0,x=0,E=0,S=xA,D=wA,O=bA,R=!0;h/=3;let M=0;const L=1/(h-u-1);for(v=0;v<h;++v){const e=3*v,t=j.A.fromArray(l,e,_A),n=j.A.fromArray(c,e,yA);if(o.position&&(f[T++]=n.x,f[T++]=n.y,f[T++]=n.z,f[T++]=t.x,f[T++]=t.y,f[T++]=t.z),o.st&&(y[E++]=M,y[E++]=0,y[E++]=M,y[E++]=1),o.normal||o.tangent||o.bitangent){let n=j.A.clone(j.A.ZERO,TA);const i=j.A.subtract(t,s.geodeticSurfaceNormal(t,yA),yA);if(v+1<h&&(n=j.A.fromArray(l,e+3,TA)),R){const e=j.A.subtract(n,t,vA),o=j.A.subtract(i,t,_A);S=j.A.normalize(j.A.cross(o,e,S),S),R=!1}j.A.equalsEpsilon(t,n,J.A.EPSILON10)?R=!0:(M+=L,o.tangent&&(D=j.A.normalize(j.A.subtract(n,t,D),D)),o.bitangent&&(O=j.A.normalize(j.A.cross(S,D,O),O))),o.normal&&(m[b++]=S.x,m[b++]=S.y,m[b++]=S.z,m[b++]=S.x,m[b++]=S.y,m[b++]=S.z),o.tangent&&(g[x++]=D.x,g[x++]=D.y,g[x++]=D.z,g[x++]=D.x,g[x++]=D.y,g[x++]=D.z),o.bitangent&&(_[w++]=O.x,_[w++]=O.y,_[w++]=O.z,_[w++]=O.x,_[w++]=O.y,_[w++]=O.z)}}const N=new Ir.A;o.position&&(N.position=new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:f})),o.normal&&(N.normal=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:m})),o.tangent&&(N.tangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:g})),o.bitangent&&(N.bitangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:_})),o.st&&(N.st=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:2,values:y}));const B=A/3;A-=6*(u+1);const F=Pr.A.createTypedArray(B,A);let U=0;for(v=0;v<B-2;v+=2){const e=v,t=v+2,n=j.A.fromArray(f,3*e,_A),i=j.A.fromArray(f,3*t,yA);if(j.A.equalsEpsilon(n,i,J.A.EPSILON10))continue;const o=v+1,r=v+3;F[U++]=o,F[U++]=e,F[U++]=r,F[U++]=r,F[U++]=e,F[U++]=t}return new I.A({attributes:N,indices:F,primitiveType:p.A.TRIANGLES,boundingSphere:new Sn.A.fromVertices(f)})};const PA=CA,DA=new j.A,OA=new j.A;function RA(e){const t=(e=e??S.A.EMPTY_OBJECT).positions,n=e.maximumHeights,i=e.minimumHeights;if(!(0,d.A)(t))throw new A.A("options.positions is required.");if((0,d.A)(n)&&n.length!==t.length)throw new A.A("options.positions and options.maximumHeights must have the same length.");if((0,d.A)(i)&&i.length!==t.length)throw new A.A("options.positions and options.minimumHeights must have the same length.");const o=e.granularity??J.A.RADIANS_PER_DEGREE,r=e.ellipsoid??K.A.default;this._positions=t,this._minimumHeights=i,this._maximumHeights=n,this._granularity=o,this._ellipsoid=K.A.clone(r),this._workerName="createWallOutlineGeometry";let s=1+t.length*j.A.packedLength+2;(0,d.A)(i)&&(s+=i.length),(0,d.A)(n)&&(s+=n.length),this.packedLength=s+K.A.packedLength+1}RA.pack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("value is required");if(!(0,d.A)(t))throw new A.A("array is required");let i;n=n??0;const o=e._positions;let r=o.length;for(t[n++]=r,i=0;i<r;++i,n+=j.A.packedLength)j.A.pack(o[i],t,n);const s=e._minimumHeights;if(r=(0,d.A)(s)?s.length:0,t[n++]=r,(0,d.A)(s))for(i=0;i<r;++i)t[n++]=s[i];const a=e._maximumHeights;if(r=(0,d.A)(a)?a.length:0,t[n++]=r,(0,d.A)(a))for(i=0;i<r;++i)t[n++]=a[i];return K.A.pack(e._ellipsoid,t,n),t[n+=K.A.packedLength]=e._granularity,t};const MA=K.A.clone(K.A.UNIT_SPHERE),LA={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:MA,granularity:void 0};RA.unpack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("array is required");let i;t=t??0;let o=e[t++];const r=new Array(o);for(i=0;i<o;++i,t+=j.A.packedLength)r[i]=j.A.unpack(e,t);let s,a;if(o=e[t++],o>0)for(s=new Array(o),i=0;i<o;++i)s[i]=e[t++];if(o=e[t++],o>0)for(a=new Array(o),i=0;i<o;++i)a[i]=e[t++];const c=K.A.unpack(e,t,MA),l=e[t+=K.A.packedLength];return(0,d.A)(n)?(n._positions=r,n._minimumHeights=s,n._maximumHeights=a,n._ellipsoid=K.A.clone(c,n._ellipsoid),n._granularity=l,n):(LA.positions=r,LA.minimumHeights=s,LA.maximumHeights=a,LA.granularity=l,new RA(LA))},RA.fromConstantHeights=function(e){const t=(e=e??S.A.EMPTY_OBJECT).positions;if(!(0,d.A)(t))throw new A.A("options.positions is required.");let n,i;const o=e.minimumHeight,r=e.maximumHeight,s=(0,d.A)(o),a=(0,d.A)(r);if(s||a){const e=t.length;n=s?new Array(e):void 0,i=a?new Array(e):void 0;for(let t=0;t<e;++t)s&&(n[t]=o),a&&(i[t]=r)}return new RA({positions:t,maximumHeights:i,minimumHeights:n,ellipsoid:e.ellipsoid})},RA.createGeometry=function(e){const t=e._positions,n=e._minimumHeights,i=e._maximumHeights,o=e._granularity,r=e._ellipsoid,s=gA.computePositions(r,t,i,n,o,!1);if(!(0,d.A)(s))return;const a=s.bottomPositions,c=s.topPositions;let l=c.length,u=2*l;const h=new Float64Array(u);let A,f=0;for(l/=3,A=0;A<l;++A){const e=3*A,t=j.A.fromArray(c,e,DA),n=j.A.fromArray(a,e,OA);h[f++]=n.x,h[f++]=n.y,h[f++]=n.z,h[f++]=t.x,h[f++]=t.y,h[f++]=t.z}const m=new Ir.A({position:new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:h})}),g=u/3;u=2*g-4+g;const _=Pr.A.createTypedArray(g,u);let y=0;for(A=0;A<g-2;A+=2){const e=A,t=A+2,n=j.A.fromArray(h,3*e,DA),i=j.A.fromArray(h,3*t,OA);if(j.A.equalsEpsilon(n,i,J.A.EPSILON10))continue;const o=A+1,r=A+3;_[y++]=o,_[y++]=e,_[y++]=o,_[y++]=r,_[y++]=e,_[y++]=t}return _[y++]=g-2,_[y++]=g-1,new I.A({attributes:m,indices:_,primitiveType:p.A.LINES,boundingSphere:new Sn.A.fromVertices(h)})};const NA=RA,BA=new u.A;function FA(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.minimumHeights=void 0,this.maximumHeights=void 0,this.granularity=void 0}function UA(e,t){$n.call(this,{entity:e,scene:t,geometryOptions:new FA(e),geometryPropertyName:"wall",observedPropertyNames:["availability","wall"]}),this._onEntityPropertyChanged(e,"wall",e.wall,void 0)}function kA(e,t,n){Nn.call(this,e,t,n)}(0,d.A)(Object.create)&&(UA.prototype=Object.create($n.prototype),UA.prototype.constructor=UA),UA.prototype.createFillGeometryInstance=function(e){if(l.A.defined("time",e),!this._fillEnabled)throw new A.A("This instance does not represent a filled geometry.");const t=this._entity,n=t.isAvailable(e);let i,o;const r=new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),s=this._distanceDisplayConditionProperty.getValue(e),a=_n.fromDistanceDisplayCondition(s);if(this._materialProperty instanceof En.A){let t;(0,d.A)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,BA)),(0,d.A)(t)||(t=u.A.WHITE),o=mn.A.fromColor(t),i={show:r,distanceDisplayCondition:a,color:o}}else i={show:r,distanceDisplayCondition:a};return new yn.A({id:t,geometry:new PA(this._options),attributes:i})},UA.prototype.createOutlineGeometryInstance=function(e){if(l.A.defined("time",e),!this._outlineEnabled)throw new A.A("This instance does not represent an outlined geometry.");const t=this._entity,n=t.isAvailable(e),i=Wt.A.getValueOrDefault(this._outlineColorProperty,e,u.A.BLACK,BA),o=this._distanceDisplayConditionProperty.getValue(e);return new yn.A({id:t,geometry:new NA(this._options),attributes:{show:new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:mn.A.fromColor(i),distanceDisplayCondition:_n.fromDistanceDisplayCondition(o)}})},UA.prototype._isHidden=function(e,t){return!(0,d.A)(t.positions)||$n.prototype._isHidden.call(this,e,t)},UA.prototype._getIsClosed=function(e){return!1},UA.prototype._isDynamic=function(e,t){return!(t.positions.isConstant&&Wt.A.isConstant(t.minimumHeights)&&Wt.A.isConstant(t.maximumHeights)&&Wt.A.isConstant(t.outlineWidth)&&Wt.A.isConstant(t.granularity))},UA.prototype._setStaticOptions=function(e,t){const n=t.minimumHeights,i=t.maximumHeights,o=t.granularity,r=this._materialProperty instanceof En.A,s=this._options;s.vertexFormat=r?Cn.A.VERTEX_FORMAT:xn.A.MaterialSupport.TEXTURED.vertexFormat,s.positions=t.positions.getValue(Tn.A.MINIMUM_VALUE,s.positions),s.minimumHeights=(0,d.A)(n)?n.getValue(Tn.A.MINIMUM_VALUE,s.minimumHeights):void 0,s.maximumHeights=(0,d.A)(i)?i.getValue(Tn.A.MINIMUM_VALUE,s.maximumHeights):void 0,s.granularity=(0,d.A)(o)?o.getValue(Tn.A.MINIMUM_VALUE):void 0},UA.DynamicGeometryUpdater=kA,(0,d.A)(Object.create)&&(kA.prototype=Object.create(Nn.prototype),kA.prototype.constructor=kA),kA.prototype._isHidden=function(e,t,n){return!(0,d.A)(this._options.positions)||Nn.prototype._isHidden.call(this,e,t,n)},kA.prototype._setOptions=function(e,t,n){const i=this._options;i.positions=Wt.A.getValueOrUndefined(t.positions,n,i.positions),i.minimumHeights=Wt.A.getValueOrUndefined(t.minimumHeights,n,i.minimumHeights),i.maximumHeights=Wt.A.getValueOrUndefined(t.maximumHeights,n,i.maximumHeights),i.granularity=Wt.A.getValueOrUndefined(t.granularity,n)};const VA=UA,zA=[di,ks,ws,pu,zu,dd,ih,yh,lA,VA];function HA(e,t){this.entity=e,this.scene=t;const n=new Array(zA.length),i=new Bn.A,o=new Gi.A;for(let r=0;r<n.length;r++){const s=new zA[r](e,t);o.add(s.geometryChanged,e=>{i.raiseEvent(e)}),n[r]=s}this.updaters=n,this.geometryChanged=i,this.eventHelper=o,this._removeEntitySubscription=e.definitionChanged.addEventListener(HA.prototype._onEntityPropertyChanged,this)}HA.prototype._onEntityPropertyChanged=function(e,t,n,i){const o=this.updaters;for(let r=0;r<o.length;r++)o[r]._onEntityPropertyChanged(e,t,n,i)},HA.prototype.forEach=function(e){const t=this.updaters;for(let n=0;n<t.length;n++)e(t[n])},HA.prototype.destroy=function(){this.eventHelper.removeAll();const e=this.updaters;for(let t=0;t<e.length;t++)e[t].destroy();this._removeEntitySubscription(),(0,h.A)(this)},HA.registerUpdater=function(e){zA.includes(e)||zA.push(e)},HA.unregisterUpdater=function(e){if(zA.includes(e)){const t=zA.indexOf(e);zA.splice(t,1)}};const GA=HA,WA=new u.A,YA=new Ut.A,qA=new Ut.A,jA=j.A.ZERO,QA=new j.A;function XA(e,t,n,i,o,r,s){let a;this.translucent=t,this.appearanceType=n,this.depthFailAppearanceType=i,this.depthFailMaterialProperty=o,this.depthFailMaterial=void 0,this.closed=r,this.shadows=s,this.primitives=e,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new Ft.A,this.updaters=new Ft.A,this.updatersWithAttributes=new Ft.A,this.attributes=new Ft.A,this.subscriptions=new Ft.A,this.showsUpdated=new Ft.A,this.itemsToRemove=[],this.invalidated=!1,(0,d.A)(o)&&(a=o.definitionChanged.addEventListener(XA.prototype.onMaterialChanged,this)),this.removeMaterialSubscription=a}function KA(e,t,n,i,o){this._solidItems=[],this._translucentItems=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=n,this._closed=i,this._shadows=o}function $A(e,t){for(let n=e.length-1;n>=0;n--){const i=e[n];if(i.remove(t))return 0===i.updaters.length&&(e.splice(n,1),i.destroy()),!0}return!1}function JA(e,t,n){let i=!1;const o=t.length;for(let r=0;r<o;++r){const o=t[r],s=o.itemsToRemove,a=s.length;if(a>0)for(r=0;r<a;r++){const t=s[r];o.remove(t),e.add(n,t),i=!0}}return i}function ZA(e,t,n,i){let o,r=t.length;for(o=r-1;o>=0;o--){const i=t[o];if(i.invalidated){t.splice(o,1);const r=i.updaters.values,s=r.length;for(let t=0;t<s;t++)e.add(n,r[t]);i.destroy()}}for(r=t.length,o=0;o<r;++o)i=t[o].update(n)&&i;return i}function ep(e,t,n){const i=e.length;for(let o=0;o<i;o++){const i=e[o];if(i.contains(t))return i.getBoundingSphere(t,n)}return Gt.FAILED}function tp(e){const t=e.length;for(let n=0;n<t;n++)e[n].destroy();e.length=0}XA.prototype.onMaterialChanged=function(){this.invalidated=!0},XA.prototype.isMaterial=function(e){const t=this.depthFailMaterialProperty,n=e.depthFailMaterialProperty;return n===t||!!(0,d.A)(t)&&t.equals(n)},XA.prototype.add=function(e,t){const n=e.id;if(this.createPrimitive=!0,this.geometry.set(n,t),this.updaters.set(n,e),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&Wt.A.isConstant(e.distanceDisplayConditionProperty)&&Wt.A.isConstant(e.terrainOffsetProperty)){const t=this;this.subscriptions.set(n,e.entity.definitionChanged.addEventListener(function(n,i,o,r){"isShowing"===i&&t.showsUpdated.set(e.id,e)}))}else this.updatersWithAttributes.set(n,e)},XA.prototype.remove=function(e){const t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);const e=this.subscriptions.get(t);return(0,d.A)(e)&&(e(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1},XA.prototype.update=function(e){let t=!0,n=0,i=this.primitive;const o=this.primitives;let r;if(this.createPrimitive){const n=this.geometry.values;if(n.length>0){let r;(0,d.A)(i)&&((0,d.A)(this.oldPrimitive)?o.remove(i):this.oldPrimitive=i),(0,d.A)(this.depthFailAppearanceType)&&((0,d.A)(this.depthFailMaterialProperty)&&(this.depthFailMaterial=Mn.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial)),r=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.translucent,closed:this.closed})),i=new Pn.A({show:!1,asynchronous:!0,geometryInstances:n.slice(),appearance:new this.appearanceType({translucent:this.translucent,closed:this.closed}),depthFailAppearance:r,shadows:this.shadows}),o.add(i),t=!1}else{(0,d.A)(i)&&(o.remove(i),i=void 0);const e=this.oldPrimitive;(0,d.A)(e)&&(o.remove(e),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=i,this.createPrimitive=!1,this.waitingOnCreate=!0}else if((0,d.A)(i)&&i.ready){i.show=!0,(0,d.A)(this.oldPrimitive)&&(o.remove(this.oldPrimitive),this.oldPrimitive=void 0),!(0,d.A)(this.depthFailAppearanceType)||this.depthFailMaterialProperty instanceof En.A||(this.depthFailMaterial=Mn.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);const t=this.updatersWithAttributes.values,s=t.length,a=this.waitingOnCreate;for(r=0;r<s;r++){const o=t[r],s=this.geometry.get(o.id);let c=this.attributes.get(s.id.id);if((0,d.A)(c)||(c=i.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,c)),!o.fillMaterialProperty.isConstant||a){const t=o.fillMaterialProperty.color,i=Wt.A.getValueOrDefault(t,e,u.A.WHITE,WA);u.A.equals(c._lastColor,i)||(c._lastColor=u.A.clone(i,c._lastColor),c.color=mn.A.toValue(i,c.color),(this.translucent&&255===c.color[3]||!this.translucent&&255!==c.color[3])&&(this.itemsToRemove[n++]=o))}if((0,d.A)(this.depthFailAppearanceType)&&o.depthFailMaterialProperty instanceof En.A&&(!o.depthFailMaterialProperty.isConstant||a)){const t=o.depthFailMaterialProperty.color,n=Wt.A.getValueOrDefault(t,e,u.A.WHITE,WA);u.A.equals(c._lastDepthFailColor,n)||(c._lastDepthFailColor=u.A.clone(n,c._lastDepthFailColor),c.depthFailColor=mn.A.toValue(n,c.depthFailColor))}const l=o.entity.isShowing&&(o.hasConstantFill||o.isFilled(e));l!==(1===c.show[0])&&(c.show=wn.A.toValue(l,c.show));const h=o.distanceDisplayConditionProperty;if(!Wt.A.isConstant(h)){const t=Wt.A.getValueOrDefault(h,e,qA,YA);Ut.A.equals(t,c._lastDistanceDisplayCondition)||(c._lastDistanceDisplayCondition=Ut.A.clone(t,c._lastDistanceDisplayCondition),c.distanceDisplayCondition=_n.toValue(t,c.distanceDisplayCondition))}const A=o.terrainOffsetProperty;if(!Wt.A.isConstant(A)){const t=Wt.A.getValueOrDefault(A,e,jA,QA);j.A.equals(t,c._lastOffset)||(c._lastOffset=j.A.clone(t,c._lastOffset),c.offset=bn.A.toValue(t,c.offset))}}this.updateShows(i),this.waitingOnCreate=!1}else(0,d.A)(i)&&!i.ready&&(t=!1);return this.itemsToRemove.length=n,t},XA.prototype.updateShows=function(e){const t=this.showsUpdated.values,n=t.length;for(let i=0;i<n;i++){const n=t[i],o=this.geometry.get(n.id);let r=this.attributes.get(o.id.id);(0,d.A)(r)||(r=e.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,r));const s=n.entity.isShowing;s!==(1===r.show[0])&&(r.show=wn.A.toValue(s,r.show),o.attributes.show.value[0]=r.show[0])}this.showsUpdated.removeAll()},XA.prototype.contains=function(e){return this.updaters.contains(e.id)},XA.prototype.getBoundingSphere=function(e,t){const n=this.primitive;if(!n.ready)return Gt.PENDING;const i=n.getGeometryInstanceAttributes(e.entity);return!(0,d.A)(i)||!(0,d.A)(i.boundingSphere)||(0,d.A)(i.show)&&0===i.show[0]?Gt.FAILED:(i.boundingSphere.clone(t),Gt.DONE)},XA.prototype.destroy=function(){const e=this.primitive,t=this.primitives;(0,d.A)(e)&&t.remove(e);const n=this.oldPrimitive;(0,d.A)(n)&&t.remove(n),(0,d.A)(this.removeMaterialSubscription)&&this.removeMaterialSubscription()},KA.prototype.add=function(e,t){let n,i;const o=t.createFillGeometryInstance(e);255===o.attributes.color.value[3]?(n=this._solidItems,i=!1):(n=this._translucentItems,i=!0);const r=n.length;for(let e=0;e<r;e++){const i=n[e];if(i.isMaterial(t))return void i.add(t,o)}const s=new XA(this._primitives,i,this._appearanceType,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);s.add(t,o),n.push(s)},KA.prototype.remove=function(e){$A(this._solidItems,e)||$A(this._translucentItems,e)},KA.prototype.update=function(e){let t=ZA(this,this._solidItems,e,!0);t=ZA(this,this._translucentItems,e,t)&&t;const n=JA(this,this._solidItems,e),i=JA(this,this._translucentItems,e);return(n||i)&&(t=ZA(this,this._solidItems,e,t)&&t,t=ZA(this,this._translucentItems,e,t)&&t),t},KA.prototype.getBoundingSphere=function(e,t){const n=ep(this._solidItems,e,t);return n===Gt.FAILED?ep(this._translucentItems,e,t):n},KA.prototype.removeAllPrimitives=function(){tp(this._solidItems),tp(this._translucentItems)};const np=KA,ip=new Ut.A,op=new Ut.A,rp=j.A.ZERO,sp=new j.A;function ap(e,t,n,i,o,r,s){this.primitives=e,this.appearanceType=t,this.materialProperty=n,this.depthFailAppearanceType=i,this.depthFailMaterialProperty=o,this.closed=r,this.shadows=s,this.updaters=new Ft.A,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new Ft.A,this.material=void 0,this.depthFailMaterial=void 0,this.updatersWithAttributes=new Ft.A,this.attributes=new Ft.A,this.invalidated=!1,this.removeMaterialSubscription=n.definitionChanged.addEventListener(ap.prototype.onMaterialChanged,this),this.subscriptions=new Ft.A,this.showsUpdated=new Ft.A}ap.prototype.onMaterialChanged=function(){this.invalidated=!0},ap.prototype.isMaterial=function(e){const t=this.materialProperty,n=e.fillMaterialProperty,i=this.depthFailMaterialProperty,o=e.depthFailMaterialProperty;if(n===t&&o===i)return!0;let r=(0,d.A)(t)&&t.equals(n);return r=(!(0,d.A)(i)&&!(0,d.A)(o)||(0,d.A)(i)&&i.equals(o))&&r,r},ap.prototype.add=function(e,t){const n=t.id;if(this.updaters.set(n,t),this.geometry.set(n,t.createFillGeometryInstance(e)),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&Wt.A.isConstant(t.distanceDisplayConditionProperty)&&Wt.A.isConstant(t.terrainOffsetProperty)){const e=this;this.subscriptions.set(n,t.entity.definitionChanged.addEventListener(function(n,i,o,r){"isShowing"===i&&e.showsUpdated.set(t.id,t)}))}else this.updatersWithAttributes.set(n,t);this.createPrimitive=!0},ap.prototype.remove=function(e){const t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);const e=this.subscriptions.get(t);return(0,d.A)(e)&&(e(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1};const cp=new u.A;function lp(e,t,n,i,o){this._items=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=n,this._closed=i,this._shadows=o}ap.prototype.update=function(e){let t=!0,n=this.primitive;const i=this.primitives,o=this.geometry.values;let r;if(this.createPrimitive){if(o.length>0){let r;(0,d.A)(n)&&((0,d.A)(this.oldPrimitive)?i.remove(n):this.oldPrimitive=n),this.material=Mn.getValue(e,this.materialProperty,this.material),(0,d.A)(this.depthFailMaterialProperty)&&(this.depthFailMaterial=Mn.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),r=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.depthFailMaterial.isTranslucent(),closed:this.closed})),n=new Pn.A({show:!1,asynchronous:!0,geometryInstances:o.slice(),appearance:new this.appearanceType({material:this.material,translucent:this.material.isTranslucent(),closed:this.closed}),depthFailAppearance:r,shadows:this.shadows}),i.add(n),t=!1}else{(0,d.A)(n)&&(i.remove(n),n=void 0);const e=this.oldPrimitive;(0,d.A)(e)&&(i.remove(e),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1}else if((0,d.A)(n)&&n.ready){n.show=!0,(0,d.A)(this.oldPrimitive)&&(i.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=Mn.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material,!(0,d.A)(this.depthFailAppearanceType)||this.depthFailMaterialProperty instanceof En.A||(this.depthFailMaterial=Mn.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);const t=this.updatersWithAttributes.values,o=t.length;for(r=0;r<o;r++){const i=t[r],o=i.entity,s=this.geometry.get(i.id);let a=this.attributes.get(s.id.id);if((0,d.A)(a)||(a=n.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,a)),(0,d.A)(this.depthFailAppearanceType)&&this.depthFailMaterialProperty instanceof En.A&&!i.depthFailMaterialProperty.isConstant){const t=i.depthFailMaterialProperty.color,n=Wt.A.getValueOrDefault(t,e,u.A.WHITE,cp);u.A.equals(a._lastDepthFailColor,n)||(a._lastDepthFailColor=u.A.clone(n,a._lastDepthFailColor),a.depthFailColor=mn.A.toValue(n,a.depthFailColor))}const c=o.isShowing&&(i.hasConstantFill||i.isFilled(e));c!==(1===a.show[0])&&(a.show=wn.A.toValue(c,a.show));const l=i.distanceDisplayConditionProperty;if(!Wt.A.isConstant(l)){const t=Wt.A.getValueOrDefault(l,e,op,ip);Ut.A.equals(t,a._lastDistanceDisplayCondition)||(a._lastDistanceDisplayCondition=Ut.A.clone(t,a._lastDistanceDisplayCondition),a.distanceDisplayCondition=_n.toValue(t,a.distanceDisplayCondition))}const h=i.terrainOffsetProperty;if(!Wt.A.isConstant(h)){const t=Wt.A.getValueOrDefault(h,e,rp,sp);j.A.equals(t,a._lastOffset)||(a._lastOffset=j.A.clone(t,a._lastOffset),a.offset=bn.A.toValue(t,a.offset))}}this.updateShows(n)}else(0,d.A)(n)&&!n.ready&&(t=!1);return t},ap.prototype.updateShows=function(e){const t=this.showsUpdated.values,n=t.length;for(let i=0;i<n;i++){const n=t[i],o=n.entity,r=this.geometry.get(n.id);let s=this.attributes.get(r.id.id);(0,d.A)(s)||(s=e.getGeometryInstanceAttributes(r.id),this.attributes.set(r.id.id,s));const a=o.isShowing;a!==(1===s.show[0])&&(s.show=wn.A.toValue(a,s.show),r.attributes.show.value[0]=s.show[0])}this.showsUpdated.removeAll()},ap.prototype.contains=function(e){return this.updaters.contains(e.id)},ap.prototype.getBoundingSphere=function(e,t){const n=this.primitive;if(!n.ready)return Gt.PENDING;const i=n.getGeometryInstanceAttributes(e.entity);return!(0,d.A)(i)||!(0,d.A)(i.boundingSphere)||(0,d.A)(i.show)&&0===i.show[0]?Gt.FAILED:(i.boundingSphere.clone(t),Gt.DONE)},ap.prototype.destroy=function(){const e=this.primitive,t=this.primitives;(0,d.A)(e)&&t.remove(e);const n=this.oldPrimitive;(0,d.A)(n)&&t.remove(n),this.removeMaterialSubscription()},lp.prototype.add=function(e,t){const n=this._items,i=n.length;for(let o=0;o<i;o++){const i=n[o];if(i.isMaterial(t))return void i.add(e,t)}const o=new ap(this._primitives,this._appearanceType,t.fillMaterialProperty,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);o.add(e,t),n.push(o)},lp.prototype.remove=function(e){const t=this._items;for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.remove(e)){0===i.updaters.length&&(t.splice(n,1),i.destroy());break}}},lp.prototype.update=function(e){let t;const n=this._items;for(t=n.length-1;t>=0;t--){const i=n[t];if(i.invalidated){n.splice(t,1);const o=i.updaters.values,r=o.length;for(let t=0;t<r;t++)this.add(e,o[t]);i.destroy()}}let i=!0;for(t=0;t<n.length;t++)i=n[t].update(e)&&i;return i},lp.prototype.getBoundingSphere=function(e,t){const n=this._items,i=n.length;for(let o=0;o<i;o++){const i=n[o];if(i.contains(e))return i.getBoundingSphere(e,t)}return Gt.FAILED},lp.prototype.removeAllPrimitives=function(){const e=this._items,t=e.length;for(let n=0;n<t;n++)e[n].destroy();this._items.length=0};const up=lp;var dp=n(546621);function hp(){this._tree=new dp.A}function Ap(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.id=""}function pp(e,t){return e.id===t.id}Ap.fromRectangleAndId=function(e,t,n){return n.minX=t.west,n.minY=t.south,n.maxX=t.east,n.maxY=t.north,n.id=e,n},hp.prototype.insert=function(e,t){l.A.typeOf.string("id",e),l.A.typeOf.object("rectangle",t);const n=Ap.fromRectangleAndId(e,t,new Ap);this._tree.insert(n)};const fp=new Ap;hp.prototype.remove=function(e,t){l.A.typeOf.string("id",e),l.A.typeOf.object("rectangle",t);const n=Ap.fromRectangleAndId(e,t,fp);this._tree.remove(n,pp)};const mp=new Ap;hp.prototype.collides=function(e){l.A.typeOf.object("rectangle",e);const t=Ap.fromRectangleAndId("",e,mp);return this._tree.collides(t)};const gp=hp,_p=new u.A,yp=new Ut.A,vp=new Ut.A;function Tp(e,t,n,i){this.primitives=e,this.zIndex=i,this.classificationType=t,this.color=n,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new Ft.A,this.updaters=new Ft.A,this.updatersWithAttributes=new Ft.A,this.attributes=new Ft.A,this.subscriptions=new Ft.A,this.showsUpdated=new Ft.A,this.itemsToRemove=[],this.isDirty=!1,this.rectangleCollisionCheck=new gp}function bp(e,t){this._batches=[],this._primitives=e,this._classificationType=t}Tp.prototype.overlapping=function(e){return this.rectangleCollisionCheck.collides(e)},Tp.prototype.add=function(e,t){const n=e.id;if(this.createPrimitive=!0,this.geometry.set(n,t),this.updaters.set(n,e),this.rectangleCollisionCheck.insert(n,t.geometry.rectangle),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&Wt.A.isConstant(e.distanceDisplayConditionProperty)){const t=this;this.subscriptions.set(n,e.entity.definitionChanged.addEventListener(function(n,i,o,r){"isShowing"===i&&t.showsUpdated.set(e.id,e)}))}else this.updatersWithAttributes.set(n,e)},Tp.prototype.remove=function(e){const t=e.id,n=this.geometry.get(t);if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.rectangleCollisionCheck.remove(t,n.geometry.rectangle),this.updatersWithAttributes.remove(t);const e=this.subscriptions.get(t);return(0,d.A)(e)&&(e(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1},Tp.prototype.update=function(e){let t=!0,n=this.primitive;const i=this.primitives;let o;if(this.createPrimitive){const e=this.geometry.values;if(e.length>0)(0,d.A)(n)&&((0,d.A)(this.oldPrimitive)?i.remove(n):this.oldPrimitive=n),n=new In.A({show:!1,asynchronous:!0,geometryInstances:e.slice(),classificationType:this.classificationType}),i.add(n,this.zIndex),t=!1;else{(0,d.A)(n)&&(i.remove(n),n=void 0);const e=this.oldPrimitive;(0,d.A)(e)&&(i.remove(e),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1,this.waitingOnCreate=!0}else if((0,d.A)(n)&&n.ready){n.show=!0,(0,d.A)(this.oldPrimitive)&&(i.remove(this.oldPrimitive),this.oldPrimitive=void 0);const t=this.updatersWithAttributes.values,r=t.length,s=this.waitingOnCreate;for(o=0;o<r;o++){const i=t[o],r=this.geometry.get(i.id);let a=this.attributes.get(r.id.id);if((0,d.A)(a)||(a=n.getGeometryInstanceAttributes(r.id),this.attributes.set(r.id.id,a)),!i.fillMaterialProperty.isConstant||s){const t=i.fillMaterialProperty.color,n=Wt.A.getValueOrDefault(t,e,u.A.WHITE,_p);u.A.equals(a._lastColor,n)||(a._lastColor=u.A.clone(n,a._lastColor),a.color=mn.A.toValue(n,a.color))}const c=i.entity.isShowing&&(i.hasConstantFill||i.isFilled(e));c!==(1===a.show[0])&&(a.show=wn.A.toValue(c,a.show));const l=i.distanceDisplayConditionProperty;if(!Wt.A.isConstant(l)){const t=Wt.A.getValueOrDefault(l,e,vp,yp);Ut.A.equals(t,a._lastDistanceDisplayCondition)||(a._lastDistanceDisplayCondition=Ut.A.clone(t,a._lastDistanceDisplayCondition),a.distanceDisplayCondition=_n.toValue(t,a.distanceDisplayCondition))}}this.updateShows(n),this.waitingOnCreate=!1}else(0,d.A)(n)&&!n.ready&&(t=!1);return this.itemsToRemove.length=0,t},Tp.prototype.updateShows=function(e){const t=this.showsUpdated.values,n=t.length;for(let i=0;i<n;i++){const n=t[i],o=this.geometry.get(n.id);let r=this.attributes.get(o.id.id);(0,d.A)(r)||(r=e.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,r));const s=n.entity.isShowing;s!==(1===r.show[0])&&(r.show=wn.A.toValue(s,r.show),o.attributes.show.value[0]=r.show[0])}this.showsUpdated.removeAll()},Tp.prototype.contains=function(e){return this.updaters.contains(e.id)},Tp.prototype.getBoundingSphere=function(e,t){const n=this.primitive;if(!n.ready)return Gt.PENDING;const i=n.getBoundingSphere(e.entity);return(0,d.A)(i)?(i.clone(t),Gt.DONE):Gt.FAILED},Tp.prototype.removeAllPrimitives=function(){const e=this.primitives,t=this.primitive;(0,d.A)(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());const n=this.oldPrimitive;(0,d.A)(n)&&(e.remove(n),this.oldPrimitive=void 0)},bp.prototype.add=function(e,t){const n=t.createFillGeometryInstance(e),i=this._batches,o=Wt.A.getValueOrDefault(t.zIndex,0);let r;const s=i.length;for(let e=0;e<s;++e){const t=i[e];if(t.zIndex===o&&!t.overlapping(n.geometry.rectangle)){r=t;break}}return(0,d.A)(r)||(r=new Tp(this._primitives,this._classificationType,n.attributes.color.value,o),i.push(r)),r.add(t,n),r},bp.prototype.remove=function(e){const t=this._batches,n=t.length;for(let i=0;i<n;++i)if(t[i].remove(e))return},bp.prototype.update=function(e){let t,n,i=!0;const o=this._batches,r=o.length;for(t=0;t<r;++t)i=o[t].update(e)&&i;for(t=0;t<r;++t){const i=o[t],r=i.itemsToRemove,s=r.length;for(let t=0;t<s;t++){n=r[t],i.remove(n);const o=this.add(e,n);i.isDirty=!0,o.isDirty=!0}}for(t=r-1;t>=0;--t){const n=o[t];n.isDirty&&(i=o[t].update(e)&&i,n.isDirty=!1),0===n.geometry.length&&o.splice(t,1)}return i},bp.prototype.getBoundingSphere=function(e,t){const n=this._batches,i=n.length;for(let o=0;o<i;++o){const i=n[o];if(i.contains(e))return i.getBoundingSphere(e,t)}return Gt.FAILED},bp.prototype.removeAllPrimitives=function(){const e=this._batches,t=e.length;for(let n=0;n<t;++n)e[n].removeAllPrimitives()};const wp=bp;var xp=n(395250);const Cp=new Ut.A,Ep=new Ut.A;function Sp(e,t,n,i,o,r){this.primitives=e,this.classificationType=t,this.appearanceType=n,this.materialProperty=i,this.updaters=new Ft.A,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new Ft.A,this.material=void 0,this.updatersWithAttributes=new Ft.A,this.attributes=new Ft.A,this.subscriptions=new Ft.A,this.showsUpdated=new Ft.A,this.usingSphericalTextureCoordinates=o,this.zIndex=r,this.rectangleCollisionCheck=new gp}function Ip(e,t,n){this._items=[],this._primitives=e,this._classificationType=t,this._appearanceType=n}Sp.prototype.overlapping=function(e){return this.rectangleCollisionCheck.collides(e)},Sp.prototype.isMaterial=function(e){const t=this.materialProperty,n=e.fillMaterialProperty;return n===t||n instanceof En.A&&t instanceof En.A||(0,d.A)(t)&&t.equals(n)},Sp.prototype.add=function(e,t,n){const i=t.id;if(this.updaters.set(i,t),this.geometry.set(i,n),this.rectangleCollisionCheck.insert(i,n.geometry.rectangle),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&Wt.A.isConstant(t.distanceDisplayConditionProperty)){const e=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener(function(n,i,o,r){"isShowing"===i&&e.showsUpdated.set(t.id,t)}))}else this.updatersWithAttributes.set(i,t);this.createPrimitive=!0},Sp.prototype.remove=function(e){const t=e.id,n=this.geometry.get(t);if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.rectangleCollisionCheck.remove(t,n.geometry.rectangle),this.updatersWithAttributes.remove(t);const e=this.subscriptions.get(t);return(0,d.A)(e)&&(e(),this.subscriptions.remove(t)),!0}return!1},Sp.prototype.update=function(e){let t=!0,n=this.primitive;const i=this.primitives,o=this.geometry.values;let r;if(this.createPrimitive){if(o.length>0)(0,d.A)(n)&&((0,d.A)(this.oldPrimitive)?i.remove(n):this.oldPrimitive=n),this.material=Mn.getValue(e,this.materialProperty,this.material),n=new In.A({show:!1,asynchronous:!0,geometryInstances:o.slice(),appearance:new this.appearanceType({material:this.material}),classificationType:this.classificationType}),i.add(n,this.zIndex),t=!1;else{(0,d.A)(n)&&(i.remove(n),n=void 0);const e=this.oldPrimitive;(0,d.A)(e)&&(i.remove(e),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1}else if((0,d.A)(n)&&n.ready){n.show=!0,(0,d.A)(this.oldPrimitive)&&(i.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=Mn.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material;const t=this.updatersWithAttributes.values,o=t.length;for(r=0;r<o;r++){const i=t[r],o=i.entity,s=this.geometry.get(i.id);let a=this.attributes.get(s.id.id);(0,d.A)(a)||(a=n.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,a));const c=o.isShowing&&(i.hasConstantFill||i.isFilled(e));c!==(1===a.show[0])&&(a.show=wn.A.toValue(c,a.show));const l=i.distanceDisplayConditionProperty;if(!Wt.A.isConstant(l)){const t=Wt.A.getValueOrDefault(l,e,Ep,Cp);Ut.A.equals(t,a._lastDistanceDisplayCondition)||(a._lastDistanceDisplayCondition=Ut.A.clone(t,a._lastDistanceDisplayCondition),a.distanceDisplayCondition=_n.toValue(t,a.distanceDisplayCondition))}}this.updateShows(n)}else(0,d.A)(n)&&!n.ready&&(t=!1);return t},Sp.prototype.updateShows=function(e){const t=this.showsUpdated.values,n=t.length;for(let i=0;i<n;i++){const n=t[i],o=n.entity,r=this.geometry.get(n.id);let s=this.attributes.get(r.id.id);(0,d.A)(s)||(s=e.getGeometryInstanceAttributes(r.id),this.attributes.set(r.id.id,s));const a=o.isShowing;a!==(1===s.show[0])&&(s.show=wn.A.toValue(a,s.show),r.attributes.show.value[0]=s.show[0])}this.showsUpdated.removeAll()},Sp.prototype.contains=function(e){return this.updaters.contains(e.id)},Sp.prototype.getBoundingSphere=function(e,t){const n=this.primitive;if(!n.ready)return Gt.PENDING;const i=n.getGeometryInstanceAttributes(e.entity);return!(0,d.A)(i)||!(0,d.A)(i.boundingSphere)||(0,d.A)(i.show)&&0===i.show[0]?Gt.FAILED:(i.boundingSphere.clone(t),Gt.DONE)},Sp.prototype.destroy=function(){const e=this.primitive,t=this.primitives;(0,d.A)(e)&&t.remove(e);const n=this.oldPrimitive;(0,d.A)(n)&&t.remove(n)},Ip.prototype.add=function(e,t){const n=this._items,i=n.length,o=t.createFillGeometryInstance(e),r=xp.A.shouldUseSphericalCoordinates(o.geometry.rectangle),s=Wt.A.getValueOrDefault(t.zIndex,0);for(let a=0;a<i;++a){const i=n[a];if(i.isMaterial(t)&&i.usingSphericalTextureCoordinates===r&&i.zIndex===s&&!i.overlapping(o.geometry.rectangle))return void i.add(e,t,o)}const a=new Sp(this._primitives,this._classificationType,this._appearanceType,t.fillMaterialProperty,r,s);a.add(e,t,o),n.push(a)},Ip.prototype.remove=function(e){const t=this._items;for(let n=t.length-1;n>=0&&!t[n].remove(e);n--);},Ip.prototype.update=function(e){let t;const n=this._items;for(t=n.length-1;t>=0;t--){const e=n[t];0===e.updaters.length&&(n.splice(t,1),e.destroy())}let i=!0;for(t=0;t<n.length;t++)i=n[t].update(e)&&i;return i},Ip.prototype.getBoundingSphere=function(e,t){const n=this._items,i=n.length;for(let o=0;o<i;o++){const i=n[o];if(i.contains(e))return i.getBoundingSphere(e,t)}return Gt.FAILED},Ip.prototype.removeAllPrimitives=function(){const e=this._items,t=e.length;for(let n=0;n<t;n++)e[n].destroy();this._items.length=0};const Pp=Ip,Dp=new u.A,Op=new Ut.A,Rp=new Ut.A,Mp=j.A.ZERO,Lp=new j.A;function Np(e,t,n,i){this.translucent=t,this.width=n,this.shadows=i,this.primitives=e,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new Ft.A,this.updaters=new Ft.A,this.updatersWithAttributes=new Ft.A,this.attributes=new Ft.A,this.itemsToRemove=[],this.subscriptions=new Ft.A,this.showsUpdated=new Ft.A}function Bp(e,t,n){this._primitives=e,this._scene=t,this._shadows=n,this._solidBatches=new Ft.A,this._translucentBatches=new Ft.A}Np.prototype.add=function(e,t){const n=e.id;if(this.createPrimitive=!0,this.geometry.set(n,t),this.updaters.set(n,e),e.hasConstantOutline&&e.outlineColorProperty.isConstant&&Wt.A.isConstant(e.distanceDisplayConditionProperty)&&Wt.A.isConstant(e.terrainOffsetProperty)){const t=this;this.subscriptions.set(n,e.entity.definitionChanged.addEventListener(function(n,i,o,r){"isShowing"===i&&t.showsUpdated.set(e.id,e)}))}else this.updatersWithAttributes.set(n,e)},Np.prototype.remove=function(e){const t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);const e=this.subscriptions.get(t);return(0,d.A)(e)&&(e(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1},Np.prototype.update=function(e){let t=!0,n=0,i=this.primitive;const o=this.primitives;let r;if(this.createPrimitive){const e=this.geometry.values;if(e.length>0)(0,d.A)(i)&&((0,d.A)(this.oldPrimitive)?o.remove(i):this.oldPrimitive=i),i=new Pn.A({show:!1,asynchronous:!0,geometryInstances:e.slice(),appearance:new Cn.A({flat:!0,translucent:this.translucent,renderState:{lineWidth:this.width}}),shadows:this.shadows}),o.add(i),t=!1;else{(0,d.A)(i)&&(o.remove(i),i=void 0);const e=this.oldPrimitive;(0,d.A)(e)&&(o.remove(e),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=i,this.createPrimitive=!1,this.waitingOnCreate=!0}else if((0,d.A)(i)&&i.ready){i.show=!0,(0,d.A)(this.oldPrimitive)&&(o.remove(this.oldPrimitive),this.oldPrimitive=void 0);const t=this.updatersWithAttributes.values,s=t.length,a=this.waitingOnCreate;for(r=0;r<s;r++){const o=t[r],s=this.geometry.get(o.id);let c=this.attributes.get(s.id.id);if((0,d.A)(c)||(c=i.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,c)),!o.outlineColorProperty.isConstant||a){const t=o.outlineColorProperty,i=Wt.A.getValueOrDefault(t,e,u.A.WHITE,Dp);u.A.equals(c._lastColor,i)||(c._lastColor=u.A.clone(i,c._lastColor),c.color=mn.A.toValue(i,c.color),(this.translucent&&255===c.color[3]||!this.translucent&&255!==c.color[3])&&(this.itemsToRemove[n++]=o))}const l=o.entity.isShowing&&(o.hasConstantOutline||o.isOutlineVisible(e));l!==(1===c.show[0])&&(c.show=wn.A.toValue(l,c.show));const h=o.distanceDisplayConditionProperty;if(!Wt.A.isConstant(h)){const t=Wt.A.getValueOrDefault(h,e,Rp,Op);Ut.A.equals(t,c._lastDistanceDisplayCondition)||(c._lastDistanceDisplayCondition=Ut.A.clone(t,c._lastDistanceDisplayCondition),c.distanceDisplayCondition=_n.toValue(t,c.distanceDisplayCondition))}const A=o.terrainOffsetProperty;if(!Wt.A.isConstant(A)){const t=Wt.A.getValueOrDefault(A,e,Mp,Lp);j.A.equals(t,c._lastOffset)||(c._lastOffset=j.A.clone(t,c._lastOffset),c.offset=bn.A.toValue(t,c.offset))}}this.updateShows(i),this.waitingOnCreate=!1}else(0,d.A)(i)&&!i.ready&&(t=!1);return this.itemsToRemove.length=n,t},Np.prototype.updateShows=function(e){const t=this.showsUpdated.values,n=t.length;for(let i=0;i<n;i++){const n=t[i],o=this.geometry.get(n.id);let r=this.attributes.get(o.id.id);(0,d.A)(r)||(r=e.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,r));const s=n.entity.isShowing;s!==(1===r.show[0])&&(r.show=wn.A.toValue(s,r.show),o.attributes.show.value[0]=r.show[0])}this.showsUpdated.removeAll()},Np.prototype.contains=function(e){return this.updaters.contains(e.id)},Np.prototype.getBoundingSphere=function(e,t){const n=this.primitive;if(!n.ready)return Gt.PENDING;const i=n.getGeometryInstanceAttributes(e.entity);return!(0,d.A)(i)||!(0,d.A)(i.boundingSphere)||(0,d.A)(i.show)&&0===i.show[0]?Gt.FAILED:(i.boundingSphere.clone(t),Gt.DONE)},Np.prototype.removeAllPrimitives=function(){const e=this.primitives,t=this.primitive;(0,d.A)(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());const n=this.oldPrimitive;(0,d.A)(n)&&(e.remove(n),this.oldPrimitive=void 0)},Bp.prototype.add=function(e,t){const n=t.createOutlineGeometryInstance(e),i=this._scene.clampLineWidth(t.outlineWidth);let o,r;255===n.attributes.color.value[3]?(o=this._solidBatches,r=o.get(i),(0,d.A)(r)||(r=new Np(this._primitives,!1,i,this._shadows),o.set(i,r)),r.add(t,n)):(o=this._translucentBatches,r=o.get(i),(0,d.A)(r)||(r=new Np(this._primitives,!0,i,this._shadows),o.set(i,r)),r.add(t,n))},Bp.prototype.remove=function(e){let t;const n=this._solidBatches.values,i=n.length;for(t=0;t<i;t++)if(n[t].remove(e))return;const o=this._translucentBatches.values,r=o.length;for(t=0;t<r;t++)if(o[t].remove(e))return},Bp.prototype.update=function(e){let t,n,i,o;const r=this._solidBatches.values,s=r.length,a=this._translucentBatches.values,c=a.length;let l,u=!0,d=!1;do{for(d=!1,n=0;n<s;n++){o=r[n],u=o.update(e),l=o.itemsToRemove;const s=l.length;if(s>0)for(d=!0,t=0;t<s;t++)i=l[t],o.remove(i),this.add(e,i)}for(n=0;n<c;n++){o=a[n],u=o.update(e),l=o.itemsToRemove;const r=l.length;if(r>0)for(d=!0,t=0;t<r;t++)i=l[t],o.remove(i),this.add(e,i)}}while(d);return u},Bp.prototype.getBoundingSphere=function(e,t){let n;const i=this._solidBatches.values,o=i.length;for(n=0;n<o;n++){const o=i[n];if(o.contains(e))return o.getBoundingSphere(e,t)}const r=this._translucentBatches.values,s=r.length;for(n=0;n<s;n++){const i=r[n];if(i.contains(e))return i.getBoundingSphere(e,t)}return Gt.FAILED},Bp.prototype.removeAllPrimitives=function(){let e;const t=this._solidBatches.values,n=t.length;for(e=0;e<n;e++)t[e].removeAllPrimitives();const i=this._translucentBatches.values,o=i.length;for(e=0;e<o;e++)i[e].removeAllPrimitives()};const Fp=Bp,Up=[];function kp(e,t,n,i){l.A.defined("scene",e),l.A.defined("entityCollection",t),n=n??e.primitives,i=i??e.groundPrimitives,this._scene=e,this._primitives=n,this._groundPrimitives=i,this._entityCollection=void 0,this._addedObjects=new Ft.A,this._removedObjects=new Ft.A,this._changedObjects=new Ft.A;const o=kn.A.NUMBER_OF_SHADOW_MODES;this._outlineBatches=new Array(2*o),this._closedColorBatches=new Array(2*o),this._closedMaterialBatches=new Array(2*o),this._openColorBatches=new Array(2*o),this._openMaterialBatches=new Array(2*o);const r=zn.A.supportsMaterialsforEntitiesOnTerrain(e);let s;for(this._supportsMaterialsforEntitiesOnTerrain=r,s=0;s<o;++s)this._outlineBatches[s]=new Fp(n,e,s,!1),this._outlineBatches[o+s]=new Fp(n,e,s,!0),this._closedColorBatches[s]=new np(n,Cn.A,void 0,!0,s,!0),this._closedColorBatches[o+s]=new np(n,Cn.A,void 0,!0,s,!1),this._closedMaterialBatches[s]=new up(n,xn.A,void 0,!0,s,!0),this._closedMaterialBatches[o+s]=new up(n,xn.A,void 0,!0,s,!1),this._openColorBatches[s]=new np(n,Cn.A,void 0,!1,s,!0),this._openColorBatches[o+s]=new np(n,Cn.A,void 0,!1,s,!1),this._openMaterialBatches[s]=new up(n,xn.A,void 0,!1,s,!0),this._openMaterialBatches[o+s]=new up(n,xn.A,void 0,!1,s,!1);const a=Un.A.NUMBER_OF_CLASSIFICATION_TYPES,c=new Array(a),u=[];if(r)for(s=0;s<a;++s)u.push(new Pp(i,s,xn.A)),c[s]=new wp(i,s);else for(s=0;s<a;++s)c[s]=new wp(i,s);this._groundColorBatches=c,this._groundMaterialBatches=u,this._dynamicBatch=new Xl(n,i),this._batches=this._outlineBatches.concat(this._closedColorBatches,this._closedMaterialBatches,this._openColorBatches,this._openMaterialBatches,this._groundColorBatches,this._groundMaterialBatches,this._dynamicBatch),this._subscriptions=new Ft.A,this._updaterSets=new Ft.A,this._entityCollection=t,t.collectionChanged.addEventListener(kp.prototype._onCollectionChanged,this),this._onCollectionChanged(t,t.values,Up)}kp.registerUpdater=function(e){GA.registerUpdater(e)},kp.unregisterUpdater=function(e){GA.unregisterUpdater(e)},kp.prototype.update=function(e){l.A.defined("time",e);const t=this._addedObjects,n=t.values,i=this._removedObjects,o=i.values,r=this._changedObjects,s=r.values;let a,c,u,d;const h=this;for(a=s.length-1;a>-1;a--)c=s[a],u=c.id,d=this._updaterSets.get(u),d.entity===c?d.forEach(function(t){h._removeUpdater(t),h._insertUpdaterIntoBatch(e,t)}):(o.push(c),n.push(c));for(a=o.length-1;a>-1;a--)c=o[a],u=c.id,d=this._updaterSets.get(u),d.forEach(this._removeUpdater.bind(this)),d.destroy(),this._updaterSets.remove(u),this._subscriptions.get(u)(),this._subscriptions.remove(u);for(a=n.length-1;a>-1;a--)c=n[a],u=c.id,d=new GA(c,this._scene),this._updaterSets.set(u,d),d.forEach(function(t){h._insertUpdaterIntoBatch(e,t)}),this._subscriptions.set(u,d.geometryChanged.addEventListener(kp._onGeometryChanged,this));t.removeAll(),i.removeAll(),r.removeAll();let A=!0;const p=this._batches,f=p.length;for(a=0;a<f;a++)A=p[a].update(e)&&A;return A};const Vp=[],zp=new Sn.A;kp.prototype.getBoundingSphere=function(e,t){l.A.defined("entity",e),l.A.defined("result",t);const n=Vp,i=zp;let o=0,r=Gt.DONE;const s=this._batches,a=s.length,c=e.id,u=this._updaterSets.get(c).updaters;for(let e=0;e<u.length;e++){const t=u[e];for(let e=0;e<a;e++){if(r=s[e].getBoundingSphere(t,i),r===Gt.PENDING)return Gt.PENDING;r===Gt.DONE&&(n[o]=Sn.A.clone(i,n[o]),o++)}}return 0===o?Gt.FAILED:(n.length=o,Sn.A.fromBoundingSpheres(n,t),Gt.DONE)},kp.prototype.isDestroyed=function(){return!1},kp.prototype.destroy=function(){let e;this._entityCollection.collectionChanged.removeEventListener(kp.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();const t=this._batches;let n=t.length;for(e=0;e<n;e++)t[e].removeAllPrimitives();const i=this._subscriptions.values;for(n=i.length,e=0;e<n;e++)i[e]();this._subscriptions.removeAll();const o=this._updaterSets.values;for(n=o.length,e=0;e<n;e++)o[e].destroy();return this._updaterSets.removeAll(),(0,h.A)(this)},kp.prototype._removeUpdater=function(e){const t=this._batches,n=t.length;for(let i=0;i<n;i++)t[i].remove(e)},kp.prototype._insertUpdaterIntoBatch=function(e,t){if(t.isDynamic)return void this._dynamicBatch.add(e,t);let n;(t.outlineEnabled||t.fillEnabled)&&(n=t.shadowsProperty.getValue(e));const i=kn.A.NUMBER_OF_SHADOW_MODES;if(t.outlineEnabled&&((0,d.A)(t.terrainOffsetProperty)?this._outlineBatches[i+n].add(e,t):this._outlineBatches[n].add(e,t)),t.fillEnabled)if(t.onTerrain){const n=t.classificationTypeProperty.getValue(e);t.fillMaterialProperty instanceof En.A?this._groundColorBatches[n].add(e,t):this._groundMaterialBatches[n].add(e,t)}else t.isClosed?t.fillMaterialProperty instanceof En.A?(0,d.A)(t.terrainOffsetProperty)?this._closedColorBatches[i+n].add(e,t):this._closedColorBatches[n].add(e,t):(0,d.A)(t.terrainOffsetProperty)?this._closedMaterialBatches[i+n].add(e,t):this._closedMaterialBatches[n].add(e,t):t.fillMaterialProperty instanceof En.A?(0,d.A)(t.terrainOffsetProperty)?this._openColorBatches[i+n].add(e,t):this._openColorBatches[n].add(e,t):(0,d.A)(t.terrainOffsetProperty)?this._openMaterialBatches[i+n].add(e,t):this._openMaterialBatches[n].add(e,t)},kp._onGeometryChanged=function(e){const t=this._removedObjects,n=this._changedObjects,i=e.entity,o=i.id;(0,d.A)(t.get(o))||(0,d.A)(n.get(o))||n.set(o,i)},kp.prototype._onCollectionChanged=function(e,t,n){const i=this._addedObjects,o=this._removedObjects,r=this._changedObjects;let s,a,c;for(s=n.length-1;s>-1;s--)c=n[s],a=c.id,i.remove(a)||(o.set(a,c),r.remove(a));for(s=t.length-1;s>-1;s--)c=t[s],a=c.id,o.remove(a)?r.set(a,c):i.set(a,c)};const Hp=kp,Gp=oa.A.FILL,Wp=u.A.WHITE,Yp=u.A.BLACK,qp=new u.A(.165,.165,.165,.8),jp=new q.A(7,5),Qp=q.A.ZERO,Xp=j.A.ZERO,Kp=Vt.Ay.NONE,$p=zt.A.CENTER,Jp=Ht.A.CENTER,Zp=new j.A,ef=new u.A,tf=new u.A,nf=new u.A,of=new q.A,rf=new j.A,sf=new q.A,af=new kt.A,cf=new kt.A,lf=new kt.A,uf=new Ut.A;function df(e){this.entity=e,this.label=void 0,this.index=void 0}function hf(e,t){if(!(0,d.A)(e))throw new A.A("entityCluster is required.");if(!(0,d.A)(t))throw new A.A("entityCollection is required.");t.collectionChanged.addEventListener(hf.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new Ft.A,this._onCollectionChanged(t,t.values,[],[])}function Af(e,t,n){(0,d.A)(e)&&(e.label=void 0,n.removeLabel(t))}hf.prototype.update=function(e){if(!(0,d.A)(e))throw new A.A("time is required.");const t=this._items.values,n=this._cluster;for(let i=0,o=t.length;i<o;i++){const o=t[i],r=o.entity,s=r._label;let a,c,l=o.label,u=r.isShowing&&r.isAvailable(e)&&Wt.A.getValueOrDefault(s._show,e,!0);if(u&&(c=Wt.A.getValueOrUndefined(r._position,e,Zp),a=Wt.A.getValueOrUndefined(s._text,e),u=(0,d.A)(c)&&(0,d.A)(a)),!u){Af(o,r,n);continue}Wt.A.isConstant(r._position)||(n._clusterDirty=!0);let h=!1;const A=Wt.A.getValueOrDefault(s._heightReference,e,Kp);(0,d.A)(l)||(l=n.getLabel(r),l.id=r,o.label=l,h=j.A.equals(l.position,c)&&l.heightReference===A),l.show=!0,l.position=c,l.text=a,l.scale=Wt.A.getValueOrDefault(s._scale,e,1),l.font=Wt.A.getValueOrDefault(s._font,e,"30px sans-serif"),l.style=Wt.A.getValueOrDefault(s._style,e,Gp),l.fillColor=Wt.A.getValueOrDefault(s._fillColor,e,Wp,ef),l.outlineColor=Wt.A.getValueOrDefault(s._outlineColor,e,Yp,tf),l.outlineWidth=Wt.A.getValueOrDefault(s._outlineWidth,e,1),l.showBackground=Wt.A.getValueOrDefault(s._showBackground,e,!1),l.backgroundColor=Wt.A.getValueOrDefault(s._backgroundColor,e,qp,nf),l.backgroundPadding=Wt.A.getValueOrDefault(s._backgroundPadding,e,jp,of),l.pixelOffset=Wt.A.getValueOrDefault(s._pixelOffset,e,Qp,sf),l.eyeOffset=Wt.A.getValueOrDefault(s._eyeOffset,e,Xp,rf),l.heightReference=A,l.horizontalOrigin=Wt.A.getValueOrDefault(s._horizontalOrigin,e,$p),l.verticalOrigin=Wt.A.getValueOrDefault(s._verticalOrigin,e,Jp),l.translucencyByDistance=Wt.A.getValueOrUndefined(s._translucencyByDistance,e,af),l.pixelOffsetScaleByDistance=Wt.A.getValueOrUndefined(s._pixelOffsetScaleByDistance,e,cf),l.scaleByDistance=Wt.A.getValueOrUndefined(s._scaleByDistance,e,lf),l.distanceDisplayCondition=Wt.A.getValueOrUndefined(s._distanceDisplayCondition,e,uf),l.disableDepthTestDistance=Wt.A.getValueOrUndefined(s._disableDepthTestDistance,e),h&&l._updateClamping()}return!0},hf.prototype.getBoundingSphere=function(e,t){if(!(0,d.A)(e))throw new A.A("entity is required.");if(!(0,d.A)(t))throw new A.A("result is required.");const n=this._items.get(e.id);if(!(0,d.A)(n)||!(0,d.A)(n.label))return Gt.FAILED;const i=n.label;return t.center=j.A.clone(i._clampedPosition??i.position,t.center),t.radius=0,Gt.DONE},hf.prototype.isDestroyed=function(){return!1},hf.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(hf.prototype._onCollectionChanged,this);const e=this._entityCollection.values;for(let t=0;t<e.length;t++)this._cluster.removeLabel(e[t]);return(0,h.A)(this)},hf.prototype._onCollectionChanged=function(e,t,n,i){let o,r;const s=this._items,a=this._cluster;for(o=t.length-1;o>-1;o--)r=t[o],(0,d.A)(r._label)&&(0,d.A)(r._position)&&s.set(r.id,new df(r));for(o=i.length-1;o>-1;o--)r=i[o],(0,d.A)(r._label)&&(0,d.A)(r._position)?s.contains(r.id)||s.set(r.id,new df(r)):(Af(s.get(r.id),r,a),s.remove(r.id));for(o=n.length-1;o>-1;o--)r=n[o],Af(s.get(r.id),r,a),s.remove(r.id)};const pf=hf;var ff=n(623379),mf=n(598361);const gf=kn.A.ENABLED,_f=Vt.Ay.NONE,yf=u.A.RED,vf=u.A.WHITE,Tf=ia.A.HIGHLIGHT,bf=new q.A(1,1),wf={maximumPositionEpsilon:Number.POSITIVE_INFINITY},xf=new O.A,Cf=new O.A,Ef=new u.A,Sf=new Array(4),If=new j.A;function Pf(e,t){l.A.typeOf.object("scene",e),l.A.typeOf.object("entityCollection",t),t.collectionChanged.addEventListener(Pf.prototype._onCollectionChanged,this),this._scene=e,this._primitives=e.primitives,this._entityCollection=t,this._modelHash={},this._entitiesToVisualize=new Ft.A,this._onCollectionChanged(t,t.values,[],[])}async function Df(e,t,n,i,o){const r=e._primitives,s=e._modelHash;try{const a=await ff.A.fromGltfAsync({url:n,incrementallyLoadTextures:i,scene:e._scene,environmentMapOptions:o});if(e.isDestroyed()||!(0,d.A)(s[t.id]))return;a.id=t,r.add(a),s[t.id].modelPrimitive=a,a.errorEvent.addEventListener(e=>{(0,d.A)(s[t.id])&&(console.log(e),"TextureError"!==e.name&&a.incrementallyLoadTextures&&(s[t.id].loadFailed=!0))})}catch(n){if(e.isDestroyed()||!(0,d.A)(s[t.id]))return;console.log(n),s[t.id].loadFailed=!0}}Pf.prototype.update=function(e){if(!(0,d.A)(e))throw new A.A("time is required.");const t=this._entitiesToVisualize.values,n=this._modelHash,i=this._primitives;for(let o=0,r=t.length;o<r;o++){const r=t[o],s=r._model;let a,c,l=n[r.id],h=r.isShowing&&r.isAvailable(e)&&Wt.A.getValueOrDefault(s._show,e,!0);if(h&&(c=r.computeModelMatrix(e,xf),a=Lt.A.createIfNeeded(Wt.A.getValueOrUndefined(s._uri,e)),h=(0,d.A)(c)&&(0,d.A)(a)),!h){(0,d.A)(l)&&l.modelPrimitive&&(l.modelPrimitive.show=!1);continue}(0,d.A)(l)&&a.url===l.url||((0,d.A)(l?.modelPrimitive)&&(i.removeAndDestroy(l.modelPrimitive),delete n[r.id]),l={modelPrimitive:void 0,url:a.url,animationsRunning:!1,nodeTransformationsScratch:{},articulationsScratch:{},loadFailed:!1,modelUpdated:!1,environmentMapOptionsScratch:{...wf}},n[r.id]=l,Df(this,r,a,Wt.A.getValueOrDefault(s._incrementallyLoadTextures,e,!0),Wt.A.getValueOrDefault(s._environmentMapOptions,e,wf,l.environmentMapOptionsScratch)));const A=l.modelPrimitive;if(!(0,d.A)(A))continue;A.show=!0,A.scale=Wt.A.getValueOrDefault(s._scale,e,1),A.enableVerticalExaggeration=Wt.A.getValueOrDefault(s._enableVerticalExaggeration,e,!0),A.minimumPixelSize=Wt.A.getValueOrDefault(s._minimumPixelSize,e,0),A.maximumScale=Wt.A.getValueOrUndefined(s._maximumScale,e),A.modelMatrix=O.A.clone(c,A.modelMatrix),A.shadows=Wt.A.getValueOrDefault(s._shadows,e,gf),A.heightReference=Wt.A.getValueOrDefault(s._heightReference,e,_f),A.distanceDisplayCondition=Wt.A.getValueOrUndefined(s._distanceDisplayCondition,e),A.silhouetteColor=Wt.A.getValueOrDefault(s._silhouetteColor,e,yf,Ef),A.silhouetteSize=Wt.A.getValueOrDefault(s._silhouetteSize,e,0),A.color=Wt.A.getValueOrDefault(s._color,e,vf,Ef),A.colorBlendMode=Wt.A.getValueOrDefault(s._colorBlendMode,e,Tf),A.colorBlendAmount=Wt.A.getValueOrDefault(s._colorBlendAmount,e,.5),A.clippingPlanes=Wt.A.getValueOrUndefined(s._clippingPlanes,e),A.clampAnimations=Wt.A.getValueOrDefault(s._clampAnimations,e,!0),A.imageBasedLighting.imageBasedLightingFactor=Wt.A.getValueOrDefault(s._imageBasedLightingFactor,e,bf);let p=Wt.A.getValueOrUndefined(s._lightColor,e);if((0,d.A)(p)&&(u.A.pack(p,Sf,0),p=j.A.unpack(Sf,0,If)),A.lightColor=p,A.customShader=Wt.A.getValueOrUndefined(s._customShader,e),n[r.id].modelUpdated=!0,A.ready){const t=Wt.A.getValueOrDefault(s._runAnimations,e,!0);l.animationsRunning!==t&&(t?A.activeAnimations.addAll({loop:mf.A.REPEAT}):A.activeAnimations.removeAll(),l.animationsRunning=t);const n=Wt.A.getValueOrUndefined(s._nodeTransformations,e,l.nodeTransformationsScratch);if((0,d.A)(n)){const e=Object.keys(n);for(let t=0,i=e.length;t<i;++t){const i=e[t],o=n[i];if(!(0,d.A)(o))continue;const r=A.getNode(i);if(!(0,d.A)(r))continue;const s=O.A.fromTranslationRotationScale(o,Cf);r.matrix=O.A.multiply(r.originalMatrix,s,s)}}let i=!1;const o=Wt.A.getValueOrUndefined(s._articulations,e,l.articulationsScratch);if((0,d.A)(o)){const e=Object.keys(o);for(let t=0,n=e.length;t<n;++t){const n=e[t],r=o[n];(0,d.A)(r)&&(i=!0,A.setArticulationStage(n,r))}}i&&A.applyArticulations()}}return!0},Pf.prototype.isDestroyed=function(){return!1},Pf.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(Pf.prototype._onCollectionChanged,this);const e=this._entitiesToVisualize.values,t=this._modelHash,n=this._primitives;for(let i=e.length-1;i>-1;i--)Mf(0,e[i],t,n);return(0,h.A)(this)};const Of=new j.A,Rf=new X.A;function Mf(e,t,n,i){const o=n[t.id];(0,d.A)(o)&&(i.removeAndDestroy(o.modelPrimitive),delete n[t.id])}function Lf(e,t){const n=t[e.id];(0,d.A)(n)&&(n.nodeTransformationsScratch={},n.articulationsScratch={})}Pf.prototype.getBoundingSphere=function(e,t){if(!(0,d.A)(e))throw new A.A("entity is required.");if(!(0,d.A)(t))throw new A.A("result is required.");const n=this._modelHash[e.id];if(!(0,d.A)(n))return Gt.FAILED;if(n.loadFailed)return Gt.FAILED;const i=n.modelPrimitive;if(!(0,d.A)(i)||!i.show)return Gt.PENDING;if(!i.ready||!n.modelUpdated)return Gt.PENDING;const o=this._scene,r=o.ellipsoid??K.A.default;if(i.heightReference!==Vt.Ay.NONE){const e=i.modelMatrix;Of.x=e[12],Of.y=e[13],Of.z=e[14];const n=r.cartesianToCartographic(Of,Rf),s=o.getHeight(n,i.heightReference);return(0,d.A)(s)&&((0,Vt.w_)(i.heightReference)?n.height=s:n.height+=s),Sn.A.clone(i.boundingSphere,t),t.center=r.cartographicToCartesian(n),Gt.DONE}return Sn.A.clone(i.boundingSphere,t),Gt.DONE},Pf.prototype._onCollectionChanged=function(e,t,n,i){let o,r;const s=this._entitiesToVisualize,a=this._modelHash,c=this._primitives;for(o=t.length-1;o>-1;o--)r=t[o],(0,d.A)(r._model)&&(0,d.A)(r._position)&&s.set(r.id,r);for(o=i.length-1;o>-1;o--)r=i[o],(0,d.A)(r._model)&&(0,d.A)(r._position)?(Lf(r,a),s.set(r.id,r)):(Mf(0,r,a,c),s.remove(r.id));for(o=n.length-1;o>-1;o--)r=n[o],Mf(0,r,a,c),s.remove(r.id)};const Nf=Pf;var Bf=n(891674);function Ff(e){this._definitionChanged=new Bn.A,this._value=void 0,this._removeSubscription=void 0,this.setValue(e)}Object.defineProperties(Ff.prototype,{isConstant:{get:function(){return Wt.A.isConstant(this._value)}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return(0,d.A)(this._value)?this._value.referenceFrame:Ai.A.FIXED}}});const Uf=new te.A;Ff.prototype.getValue=function(e,t){return(0,d.A)(e)||(e=te.A.now(Uf)),this.getValueInReferenceFrame(e,Ai.A.FIXED,t)},Ff.prototype.setValue=function(e){this._value!==e&&(this._value=e,(0,d.A)(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0),(0,d.A)(e)&&(this._removeSubscription=e.definitionChanged.addEventListener(this._raiseDefinitionChanged,this)),this._definitionChanged.raiseEvent(this))},Ff.prototype.getValueInReferenceFrame=function(e,t,n){if(!(0,d.A)(e))throw new A.A("time is required.");if(!(0,d.A)(t))throw new A.A("referenceFrame is required.");if((0,d.A)(this._value))return n=this._value.getValueInReferenceFrame(e,t,n),(0,d.A)(n)?K.A.default.scaleToGeodeticSurface(n,n):void 0},Ff.prototype.equals=function(e){return this===e||e instanceof Ff&&this._value===e._value},Ff.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};const kf=Ff,Vf=new ji.A,zf=new ji.A,Hf=new ji.A;function Gf(e){this.entity=e,this.polyline=void 0,this.index=void 0,this.updater=void 0}function Wf(e,t,n,i,o,r,s,a){for(;e instanceof nc;)e=e.resolvedProperty;return s=e instanceof mc?function(e,t,n,i,o,r,s,a,c){let l,u=a;l=e.getValueInReferenceFrame(t,r,c[u]),(0,d.A)(l)&&(c[u++]=l);let h=!(0,d.A)(o)||te.A.lessThanOrEquals(o,t)||te.A.greaterThanOrEquals(o,n),A=0;const p=i.length;let f=i[A];const m=n;let g,_,y,v=!1;for(;A<p;){if(!h&&te.A.greaterThanOrEquals(f,o)&&(l=e.getValueInReferenceFrame(o,r,c[u]),(0,d.A)(l)&&(c[u++]=l),h=!0),te.A.greaterThan(f,t)&&te.A.lessThan(f,m)&&!f.equals(o)&&(l=e.getValueInReferenceFrame(f,r,c[u]),(0,d.A)(l)&&(c[u++]=l)),A<p-1){if(s>0&&!v){const e=i[A+1],t=te.A.secondsDifference(e,f);v=t>s,v&&(g=Math.ceil(t/s),_=0,y=t/Math.max(g,2),g=Math.max(g-1,1))}if(v&&_<g){f=te.A.addSeconds(f,y,new te.A),_++;continue}}v=!1,A++,f=i[A]}return l=e.getValueInReferenceFrame(n,r,c[u]),(0,d.A)(l)&&(c[u++]=l),u}(e,t,n,e._property._times,i,o,r,s,a):e instanceof gi?function(e,t,n,i,o,r,s,a){let c,l=0,u=s,h=t,A=!(0,d.A)(i)||te.A.lessThanOrEquals(i,t)||te.A.greaterThanOrEquals(i,n);for(;te.A.lessThan(h,n);)!A&&te.A.greaterThanOrEquals(h,i)&&(A=!0,c=e.getValueInReferenceFrame(i,o,a[u]),(0,d.A)(c)&&(a[u]=c,u++)),c=e.getValueInReferenceFrame(h,o,a[u]),(0,d.A)(c)&&(a[u]=c,u++),l++,h=te.A.addSeconds(t,r*l,new te.A);return c=e.getValueInReferenceFrame(n,o,a[u]),(0,d.A)(c)&&(a[u]=c,u++),u}(e,t,n,i,o,r,s,a):e instanceof po?function(e,t,n,i,o,r,s,a){zf.start=t,zf.stop=n;let c=s;const l=e.intervals;for(let e=0;e<l.length;e++){const s=l.get(e);if(!ji.A.intersect(s,zf,Vf).isEmpty){const e=s.start,l=s.stop;let u=t;te.A.greaterThan(e,u)&&(u=e);let d=n;te.A.lessThan(l,d)&&(d=l),c=Wf(s.data,u,d,i,o,r,c,a)}}return c}(e,t,n,i,o,r,s,a):e instanceof Ec?function(e,t,n,i,o,r,s,a){Hf.start=t,Hf.stop=n;let c=s;const l=e.intervals;for(let t=0;t<l.length;t++){const n=l.get(t);if(!ji.A.intersect(n,Hf,Vf).isEmpty){let t=n.start;n.isStartIncluded||(t=n.isStopIncluded?n.stop:te.A.addSeconds(n.start,te.A.secondsDifference(n.stop,n.start)/2,new te.A));const i=e.getValueInReferenceFrame(t,o,a[c]);(0,d.A)(i)&&(a[c]=i,c++)}}return c}(e,t,n,0,o,0,s,a):e instanceof fo.A||e instanceof kf&&Wt.A.isConstant(e)?function(e,t,n,i,o,r,s,a){const c=e.getValueInReferenceFrame(t,o,a[s]);return(0,d.A)(c)&&(a[s++]=c),s}(e,t,0,0,o,0,s,a):function(e,t,n,i,o,r,s,a){let c,l=0,u=s,h=t;const A=Math.max(r,60);let p=!(0,d.A)(i)||te.A.lessThanOrEquals(i,t)||te.A.greaterThanOrEquals(i,n);for(;te.A.lessThan(h,n);)!p&&te.A.greaterThanOrEquals(h,i)&&(p=!0,c=e.getValueInReferenceFrame(i,o,a[u]),(0,d.A)(c)&&(a[u]=c,u++)),c=e.getValueInReferenceFrame(h,o,a[u]),(0,d.A)(c)&&(a[u]=c,u++),l++,h=te.A.addSeconds(t,A*l,new te.A);return c=e.getValueInReferenceFrame(n,o,a[u]),(0,d.A)(c)&&(a[u]=c,u++),u}(e,t,n,i,o,r,s,a),s}function Yf(e,t,n,i,o,r,s){(0,d.A)(s)||(s=[]);const a=Wf(e,t,n,i,o,r,0,s);return s.length=a,s}const qf=new Z.A;function jf(e,t){this._unusedIndexes=[],this._polylineCollection=new Bf.A,this._scene=e,this._referenceFrame=t,e.primitives.add(this._polylineCollection)}function Qf(e,t){if(!(0,d.A)(e))throw new A.A("scene is required.");if(!(0,d.A)(t))throw new A.A("entityCollection is required.");t.collectionChanged.addEventListener(Qf.prototype._onCollectionChanged,this),this._scene=e,this._updaters={},this._entityCollection=t,this._items=new Ft.A,this._onCollectionChanged(t,t.values,[],[])}jf.prototype.update=function(e){if(this._referenceFrame===Ai.A.INERTIAL){const t=xe.A.computeIcrfToCentralBodyFixedMatrix(e,qf);O.A.fromRotationTranslation(t,j.A.ZERO,this._polylineCollection.modelMatrix)}},jf.prototype.updateObject=function(e,t){const n=t.entity,i=n._path,o=n._position;let r,s;const a=i._show;let c=t.polyline,l=n.isShowing&&n.isAvailable(e)&&(!(0,d.A)(a)||a.getValue(e));if(l){const t=Wt.A.getValueOrUndefined(i._leadTime,e),o=Wt.A.getValueOrUndefined(i._trailTime,e),a=n._availability,c=(0,d.A)(a),u=(0,d.A)(t),h=(0,d.A)(o);if(l=c||u&&h,l){if(h&&(r=te.A.addSeconds(e,-o,new te.A)),u&&(s=te.A.addSeconds(e,t,new te.A)),c){const e=a.start,t=a.stop;h&&!te.A.greaterThan(e,r)||(r=e),u&&!te.A.lessThan(t,s)||(s=t)}l=te.A.lessThan(r,s)}}if(!l)return void((0,d.A)(c)&&(this._unusedIndexes.push(t.index),t.polyline=void 0,c.show=!1,t.index=void 0));if(!(0,d.A)(c)){const e=this._unusedIndexes;if(e.length>0){const n=e.pop();c=this._polylineCollection.get(n),t.index=n}else t.index=this._polylineCollection.length,c=this._polylineCollection.add();c.id=n,t.polyline=c}const u=Wt.A.getValueOrDefault(i._resolution,e,60);c.show=!0,c.positions=Yf(o,r,s,e,this._referenceFrame,u,c.positions.slice()),c.material=Mn.getValue(e,i._material,c.material),c.width=Wt.A.getValueOrDefault(i._width,e,1),c.distanceDisplayCondition=Wt.A.getValueOrUndefined(i._distanceDisplayCondition,e,c.distanceDisplayCondition)},jf.prototype.removeObject=function(e){const t=e.polyline;(0,d.A)(t)&&(this._unusedIndexes.push(e.index),e.polyline=void 0,t.show=!1,t.id=void 0,e.index=void 0)},jf.prototype.destroy=function(){return this._scene.primitives.remove(this._polylineCollection),(0,h.A)(this)},Qf.prototype.update=function(e){if(!(0,d.A)(e))throw new A.A("time is required.");const t=this._updaters;for(const n in t)t.hasOwnProperty(n)&&t[n].update(e);const n=this._items.values;if(0===n.length&&(0,d.A)(this._updaters)&&Object.keys(this._updaters).length>0){for(const e in t)t.hasOwnProperty(e)&&t[e].destroy();this._updaters={}}for(let t=0,i=n.length;t<i;t++){const i=n[t],o=i.entity._position,r=i.updater;let s=Ai.A.FIXED;this._scene.mode===Ce.A.SCENE3D&&(s=o.referenceFrame);let a=this._updaters[s];r===a&&(0,d.A)(a)?a.updateObject(e,i):((0,d.A)(r)&&r.removeObject(i),(0,d.A)(a)||(a=new jf(this._scene,s),a.update(e),this._updaters[s]=a),i.updater=a,(0,d.A)(a)&&a.updateObject(e,i))}return!0},Qf.prototype.isDestroyed=function(){return!1},Qf.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(Qf.prototype._onCollectionChanged,this);const e=this._updaters;for(const t in e)e.hasOwnProperty(t)&&e[t].destroy();return(0,h.A)(this)},Qf.prototype._onCollectionChanged=function(e,t,n,i){let o,r,s;const a=this._items;for(o=t.length-1;o>-1;o--)r=t[o],(0,d.A)(r._path)&&(0,d.A)(r._position)&&a.set(r.id,new Gf(r));for(o=i.length-1;o>-1;o--)r=i[o],(0,d.A)(r._path)&&(0,d.A)(r._position)?a.contains(r.id)||a.set(r.id,new Gf(r)):(s=a.get(r.id),(0,d.A)(s)&&((0,d.A)(s.updater)&&s.updater.removeObject(s),a.remove(r.id)));for(o=n.length-1;o>-1;o--)r=n[o],s=a.get(r.id),(0,d.A)(s)&&((0,d.A)(s.updater)&&s.updater.removeObject(s),a.remove(r.id))},Qf._subSample=Yf;const Xf=Qf;var Kf=n(883734);const $f=u.A.WHITE,Jf=u.A.BLACK,Zf=Yt.A.NONE,em=new u.A,tm=new j.A,nm=new u.A,im=new kt.A,om=new kt.A,rm=new Ut.A;function sm(e){this.entity=e,this.pointPrimitive=void 0,this.billboard=void 0,this.color=void 0,this.outlineColor=void 0,this.pixelSize=void 0,this.outlineWidth=void 0}function am(e,t){if(!(0,d.A)(e))throw new A.A("entityCluster is required.");if(!(0,d.A)(t))throw new A.A("entityCollection is required.");t.collectionChanged.addEventListener(am.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new Ft.A,this._onCollectionChanged(t,t.values,[],[])}function cm(e,t,n){if((0,d.A)(e)){const i=e.pointPrimitive;if((0,d.A)(i))return e.pointPrimitive=void 0,void n.removePoint(t);const o=e.billboard;(0,d.A)(o)&&(e.billboard=void 0,n.removeBillboard(t))}}am.prototype.update=function(e){if(!(0,d.A)(e))throw new A.A("time is required.");const t=this._items.values,n=this._cluster;for(let i=0,o=t.length;i<o;i++){const o=t[i],r=o.entity,s=r._point;let a=o.pointPrimitive,c=o.billboard;const l=Wt.A.getValueOrDefault(s._heightReference,e,Vt.Ay.NONE);let h,A=r.isShowing&&r.isAvailable(e)&&Wt.A.getValueOrDefault(s._show,e,!0);if(A&&(h=Wt.A.getValueOrUndefined(r._position,e,tm),A=(0,d.A)(h)),!A){cm(o,r,n);continue}Wt.A.isConstant(r._position)||(n._clusterDirty=!0);let p=!1,f=!1;if(l===Vt.Ay.NONE||(0,d.A)(c)?l!==Vt.Ay.NONE||(0,d.A)(a)||((0,d.A)(c)&&(cm(o,r,n),c=void 0),a=n.getPoint(r),a.id=r,o.pointPrimitive=a):((0,d.A)(a)&&(cm(o,r,n),a=void 0),c=n.getBillboard(r),c.id=r,c.image=void 0,o.billboard=c,p=!0,f=j.A.equals(c.position,h)&&c.heightReference===l),(0,d.A)(a))a.show=!0,a.position=h,a.scaleByDistance=Wt.A.getValueOrUndefined(s._scaleByDistance,e,im),a.translucencyByDistance=Wt.A.getValueOrUndefined(s._translucencyByDistance,e,om),a.color=Wt.A.getValueOrDefault(s._color,e,$f,em),a.outlineColor=Wt.A.getValueOrDefault(s._outlineColor,e,Jf,nm),a.outlineWidth=Wt.A.getValueOrDefault(s._outlineWidth,e,0),a.pixelSize=Wt.A.getValueOrDefault(s._pixelSize,e,1),a.distanceDisplayCondition=Wt.A.getValueOrUndefined(s._distanceDisplayCondition,e,rm),a.disableDepthTestDistance=Wt.A.getValueOrDefault(s._disableDepthTestDistance,e,0),a.splitDirection=Wt.A.getValueOrDefault(s._splitDirection,e,Zf);else if((0,d.A)(c)){c.show=!0,c.position=h,c.scaleByDistance=Wt.A.getValueOrUndefined(s._scaleByDistance,e,im),c.translucencyByDistance=Wt.A.getValueOrUndefined(s._translucencyByDistance,e,om),c.distanceDisplayCondition=Wt.A.getValueOrUndefined(s._distanceDisplayCondition,e,rm),c.disableDepthTestDistance=Wt.A.getValueOrDefault(s._disableDepthTestDistance,e,0),c.splitDirection=Wt.A.getValueOrDefault(s._splitDirection,e,Zf),c.heightReference=l;const t=Wt.A.getValueOrDefault(s._color,e,$f,em),n=Wt.A.getValueOrDefault(s._outlineColor,e,Jf,nm),i=Math.round(Wt.A.getValueOrDefault(s._outlineWidth,e,0));let r=Math.max(1,Math.round(Wt.A.getValueOrDefault(s._pixelSize,e,1)));if(i>0?(c.scale=1,p=p||i!==o.outlineWidth||r!==o.pixelSize||!u.A.equals(t,o.color)||!u.A.equals(n,o.outlineColor)):(c.scale=r/50,r=50,p=p||i!==o.outlineWidth||!u.A.equals(t,o.color)||!u.A.equals(n,o.outlineColor)),p){o.color=u.A.clone(t,o.color),o.outlineColor=u.A.clone(n,o.outlineColor),o.pixelSize=r,o.outlineWidth=i;const e=t.alpha,s=t.toCssColorString(),a=n.toCssColorString(),l=JSON.stringify([s,r,a,i]);c.setImage(l,(0,Kf.A)(e,s,a,i,r))}f&&c._updateClamping()}}return!0},am.prototype.getBoundingSphere=function(e,t){if(!(0,d.A)(e))throw new A.A("entity is required.");if(!(0,d.A)(t))throw new A.A("result is required.");const n=this._items.get(e.id);if(!(0,d.A)(n)||!(0,d.A)(n.pointPrimitive)&&!(0,d.A)(n.billboard))return Gt.FAILED;if((0,d.A)(n.pointPrimitive))t.center=j.A.clone(n.pointPrimitive.position,t.center);else{const e=n.billboard;if(!(0,d.A)(e._clampedPosition))return Gt.PENDING;t.center=j.A.clone(e._clampedPosition,t.center)}return t.radius=0,Gt.DONE},am.prototype.isDestroyed=function(){return!1},am.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(am.prototype._onCollectionChanged,this);const e=this._entityCollection.values;for(let t=0;t<e.length;t++)this._cluster.removePoint(e[t]);return(0,h.A)(this)},am.prototype._onCollectionChanged=function(e,t,n,i){let o,r;const s=this._items,a=this._cluster;for(o=t.length-1;o>-1;o--)r=t[o],(0,d.A)(r._point)&&(0,d.A)(r._position)&&s.set(r.id,new sm(r));for(o=i.length-1;o>-1;o--)r=i[o],(0,d.A)(r._point)&&(0,d.A)(r._position)?s.contains(r.id)||s.set(r.id,new sm(r)):(cm(s.get(r.id),r,a),s.remove(r.id));for(o=n.length-1;o>-1;o--)r=n[o],cm(s.get(r.id),r,a),s.remove(r.id)};const lm=am;var um=n(234957),dm=n(920757),hm=n(974904),Am=n(977363);const pm=new Vn.A(0),fm={},mm=new u.A,gm=new En.A(u.A.WHITE),_m=new Vn.A(!0),ym=new Vn.A(kn.A.DISABLED),vm=new Vn.A(new Ut.A),Tm=new Vn.A(Un.A.BOTH);function bm(){this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.arcType=void 0,this.granularity=void 0}function wm(){this.positions=void 0,this.width=void 0,this.arcType=void 0,this.granularity=void 0}function xm(e,t){if(!(0,d.A)(e))throw new A.A("entity is required");if(!(0,d.A)(t))throw new A.A("scene is required");this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(xm.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._geometryChanged=new Bn.A,this._showProperty=void 0,this._materialProperty=void 0,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._depthFailMaterialProperty=void 0,this._geometryOptions=new bm,this._groundGeometryOptions=new wm,this._id=`polyline-${e.id}`,this._clampToGround=!1,this._supportsPolylinesOnTerrain=zn.A.supportsPolylinesOnTerrain(t),this._zIndex=0,this._onEntityPropertyChanged(e,"polyline",e.polyline,void 0)}Object.defineProperties(xm.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!(0,d.A)(this._entity.availability)&&Wt.A.isConstant(this._showProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},depthFailMaterialProperty:{get:function(){return this._depthFailMaterialProperty}},outlineEnabled:{value:!1},hasConstantOutline:{value:!0},outlineColorProperty:{value:void 0},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!1},geometryChanged:{get:function(){return this._geometryChanged}},arcType:{get:function(){return this._arcType}},clampToGround:{get:function(){return this._clampToGround&&this._supportsPolylinesOnTerrain}},zIndex:{get:function(){return this._zIndex}}}),xm.prototype.isOutlineVisible=function(e){return!1},xm.prototype.isFilled=function(e){const t=this._entity;return(this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e))??!1},xm.prototype.createFillGeometryInstance=function(e){if(!(0,d.A)(e))throw new A.A("time is required.");if(!this._fillEnabled)throw new A.A("This instance does not represent a filled geometry.");const t=this._entity,n=t.isAvailable(e),i=new wn.A(n&&t.isShowing&&this._showProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),r={show:i,distanceDisplayCondition:_n.fromDistanceDisplayCondition(o)};let s;return this._materialProperty instanceof En.A&&((0,d.A)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(s=this._materialProperty.color.getValue(e,mm)),(0,d.A)(s)||(s=u.A.WHITE),r.color=mn.A.fromColor(s)),this.clampToGround?new yn.A({id:t,geometry:new hm.A(this._groundGeometryOptions),attributes:r}):((0,d.A)(this._depthFailMaterialProperty)&&this._depthFailMaterialProperty instanceof En.A&&((0,d.A)(this._depthFailMaterialProperty.color)&&(this._depthFailMaterialProperty.color.isConstant||n)&&(s=this._depthFailMaterialProperty.color.getValue(e,mm)),(0,d.A)(s)||(s=u.A.WHITE),r.depthFailColor=mn.A.fromColor(s)),new yn.A({id:t,geometry:new Am.A(this._geometryOptions),attributes:r}))},xm.prototype.createOutlineGeometryInstance=function(e){throw new A.A("This instance does not represent an outlined geometry.")},xm.prototype.isDestroyed=function(){return!1},xm.prototype.destroy=function(){this._entitySubscription(),(0,h.A)(this)},xm.prototype._onEntityPropertyChanged=function(e,t,n,i){if("availability"!==t&&"polyline"!==t)return;const o=this._entity.polyline;if(!(0,d.A)(o))return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));const r=o.positions,s=o.show;if((0,d.A)(s)&&s.isConstant&&!s.getValue(Tn.A.MINIMUM_VALUE)||!(0,d.A)(r))return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));const a=o.zIndex,c=o.material??gm,l=c instanceof En.A;this._materialProperty=c,this._depthFailMaterialProperty=o.depthFailMaterial,this._showProperty=s??_m,this._shadowsProperty=o.shadows??ym,this._distanceDisplayConditionProperty=o.distanceDisplayCondition??vm,this._classificationTypeProperty=o.classificationType??Tm,this._fillEnabled=!0,this._zIndex=a??pm;const u=o.width,h=o.arcType,A=o.clampToGround,p=o.granularity;if(r.isConstant&&Wt.A.isConstant(u)&&Wt.A.isConstant(h)&&Wt.A.isConstant(p)&&Wt.A.isConstant(A)&&Wt.A.isConstant(a)){const e=this._geometryOptions,t=r.getValue(Tn.A.MINIMUM_VALUE,e.positions);if(!(0,d.A)(t)||t.length<2)return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));let n;n=l&&(!(0,d.A)(this._depthFailMaterialProperty)||this._depthFailMaterialProperty instanceof En.A)?um.A.VERTEX_FORMAT:dm.A.VERTEX_FORMAT,e.vertexFormat=n,e.positions=t,e.width=(0,d.A)(u)?u.getValue(Tn.A.MINIMUM_VALUE):void 0,e.arcType=(0,d.A)(h)?h.getValue(Tn.A.MINIMUM_VALUE):void 0,e.granularity=(0,d.A)(p)?p.getValue(Tn.A.MINIMUM_VALUE):void 0;const i=this._groundGeometryOptions;i.positions=t,i.width=e.width,i.arcType=e.arcType,i.granularity=e.granularity,this._clampToGround=!!(0,d.A)(A)&&A.getValue(Tn.A.MINIMUM_VALUE),!this._clampToGround&&(0,d.A)(a)&&(0,Fn.A)("Entity polylines must have clampToGround: true when using zIndex.  zIndex will be ignored."),this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))},xm.prototype.createDynamicUpdater=function(e,t){if(l.A.defined("primitives",e),l.A.defined("groundPrimitives",t),!this._dynamic)throw new A.A("This instance does not represent dynamic geometry.");return new Em(e,t,this)};const Cm={positions:void 0,granularity:void 0,height:void 0,ellipsoid:void 0};function Em(e,t,n){this._line=void 0,this._primitives=e,this._groundPrimitives=t,this._groundPolylinePrimitive=void 0,this._material=void 0,this._geometryUpdater=n,this._positions=[]}function Sm(e){if((0,d.A)(e._line))return e._line;const t=e._primitives,n=e._geometryUpdater._scene.id+t._guid;let i=fm[n];!(0,d.A)(i)||i.isDestroyed()?(i=new Bf.A,fm[n]=i,t.add(i)):t.contains(i)||t.add(i);const o=i.add();return o.id=e._geometryUpdater._entity,e._line=o,o}Em.prototype.update=function(e){const t=this._geometryUpdater,n=t._entity,i=n.polyline,o=i.positions;let r=Wt.A.getValueOrUndefined(o,e,this._positions);t._clampToGround=Wt.A.getValueOrDefault(i._clampToGround,e,!1),t._groundGeometryOptions.positions=r,t._groundGeometryOptions.width=Wt.A.getValueOrDefault(i._width,e,1),t._groundGeometryOptions.arcType=Wt.A.getValueOrDefault(i._arcType,e,zs.A.GEODESIC),t._groundGeometryOptions.granularity=Wt.A.getValueOrDefault(i._granularity,e,9999);const s=this._groundPrimitives;if((0,d.A)(this._groundPolylinePrimitive)&&(s.remove(this._groundPolylinePrimitive),this._groundPolylinePrimitive=void 0),t.clampToGround){if(!n.isShowing||!n.isAvailable(e)||!Wt.A.getValueOrDefault(i._show,e,!0))return;if(!(0,d.A)(r)||r.length<2)return;const o=t.fillMaterialProperty;let a;if(o instanceof En.A)a=new um.A;else{const t=Mn.getValue(e,o,this._material);a=new dm.A({material:t,translucent:t.isTranslucent()}),this._material=t}return this._groundPolylinePrimitive=s.add(new Wl.A({geometryInstances:t.createFillGeometryInstance(e),appearance:a,classificationType:t.classificationTypeProperty.getValue(e),asynchronous:!1}),Wt.A.getValueOrUndefined(t.zIndex,e)),void((0,d.A)(this._line)&&(this._line.show=!1))}const a=Sm(this);if(!n.isShowing||!n.isAvailable(e)||!Wt.A.getValueOrDefault(i._show,e,!0))return void(a.show=!1);if(!(0,d.A)(r)||r.length<2)return void(a.show=!1);let c=zs.A.GEODESIC;c=Wt.A.getValueOrDefault(i._arcType,e,c);const l=t._scene.globe,u=t._scene.ellipsoid;c!==zs.A.NONE&&(0,d.A)(l)&&(Cm.ellipsoid=u,Cm.positions=r,Cm.granularity=Wt.A.getValueOrUndefined(i._granularity,e),Cm.height=yo.A.extractHeights(r,u),r=c===zs.A.GEODESIC?yo.A.generateCartesianArc(Cm):yo.A.generateCartesianRhumbArc(Cm)),a.show=!0,a.positions=r.slice(),a.material=Mn.getValue(e,t.fillMaterialProperty,a.material),a.width=Wt.A.getValueOrDefault(i._width,e,1),a.distanceDisplayCondition=Wt.A.getValueOrUndefined(i._distanceDisplayCondition,e,a.distanceDisplayCondition)},Em.prototype.getBoundingSphere=function(e){if(l.A.defined("result",e),this._geometryUpdater.clampToGround){const t=this._groundPolylinePrimitive;if((0,d.A)(t)&&t.show&&t.ready){const n=t.getGeometryInstanceAttributes(this._geometryUpdater._entity);if((0,d.A)(n)&&(0,d.A)(n.boundingSphere))return Sn.A.clone(n.boundingSphere,e),Gt.DONE}return(0,d.A)(t)&&!t.ready?Gt.PENDING:Gt.DONE}{const t=Sm(this);if(t.show&&t.positions.length>0)return Sn.A.fromPoints(t.positions,e),Gt.DONE}return Gt.FAILED},Em.prototype.isDestroyed=function(){return!1},Em.prototype.destroy=function(){const e=this._geometryUpdater._scene.id+this._primitives._guid,t=fm[e];(0,d.A)(t)&&(t.remove(this._line),0===t.length&&(this._primitives.removeAndDestroy(t),delete fm[e])),(0,d.A)(this._groundPolylinePrimitive)&&this._groundPrimitives.remove(this._groundPolylinePrimitive),(0,h.A)(this)};const Im=xm,Pm=new u.A,Dm=new Ut.A,Om=new Ut.A;function Rm(e,t,n,i,o){let r;r=n instanceof En.A?um.A:dm.A,this.orderedGroundPrimitives=e,this.classificationType=t,this.appearanceType=r,this.materialProperty=n,this.updaters=new Ft.A,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new Ft.A,this.material=void 0,this.updatersWithAttributes=new Ft.A,this.attributes=new Ft.A,this.invalidated=!1,this.removeMaterialSubscription=n.definitionChanged.addEventListener(Rm.prototype.onMaterialChanged,this),this.subscriptions=new Ft.A,this.showsUpdated=new Ft.A,this.zIndex=i,this._asynchronous=o}function Mm(e,t,n){this._items=[],this._orderedGroundPrimitives=e,this._classificationType=t,this._asynchronous=n??!0}Rm.prototype.onMaterialChanged=function(){this.invalidated=!0},Rm.prototype.isMaterial=function(e){const t=this.materialProperty,n=e.fillMaterialProperty;return n===t||n instanceof En.A&&t instanceof En.A||(0,d.A)(t)&&t.equals(n)},Rm.prototype.add=function(e,t,n){const i=t.id;if(this.updaters.set(i,t),this.geometry.set(i,n),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&Wt.A.isConstant(t.distanceDisplayConditionProperty)){const e=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener(function(n,i,o,r){"isShowing"===i&&e.showsUpdated.set(t.id,t)}))}else this.updatersWithAttributes.set(i,t);this.createPrimitive=!0},Rm.prototype.remove=function(e){const t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);const e=this.subscriptions.get(t);return(0,d.A)(e)&&(e(),this.subscriptions.remove(t)),!0}return!1},Rm.prototype.update=function(e){let t=!0,n=this.primitive;const i=this.orderedGroundPrimitives,o=this.geometry.values;let r;if(this.createPrimitive){if(o.length>0)(0,d.A)(n)&&((0,d.A)(this.oldPrimitive)?i.remove(n):this.oldPrimitive=n),n=new Wl.A({show:!1,asynchronous:this._asynchronous,geometryInstances:o.slice(),appearance:new this.appearanceType,classificationType:this.classificationType}),this.appearanceType===dm.A&&(this.material=Mn.getValue(e,this.materialProperty,this.material),n.appearance.material=this.material),i.add(n,this.zIndex),t=!1;else{(0,d.A)(n)&&(i.remove(n),n=void 0);const e=this.oldPrimitive;(0,d.A)(e)&&(i.remove(e),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1}else if((0,d.A)(n)&&n.ready){n.show=!0,(0,d.A)(this.oldPrimitive)&&(i.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.appearanceType===dm.A&&(this.material=Mn.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material);const t=this.updatersWithAttributes.values,o=t.length;for(r=0;r<o;r++){const i=t[r],o=i.entity,s=this.geometry.get(i.id);let a=this.attributes.get(s.id.id);if((0,d.A)(a)||(a=n.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,a)),!i.fillMaterialProperty.isConstant){const t=i.fillMaterialProperty.color,n=Wt.A.getValueOrDefault(t,e,u.A.WHITE,Pm);u.A.equals(a._lastColor,n)||(a._lastColor=u.A.clone(n,a._lastColor),a.color=mn.A.toValue(n,a.color))}const c=o.isShowing&&(i.hasConstantFill||i.isFilled(e));c!==(1===a.show[0])&&(a.show=wn.A.toValue(c,a.show));const l=i.distanceDisplayConditionProperty;if(!Wt.A.isConstant(l)){const t=Wt.A.getValueOrDefault(l,e,Om,Dm);Ut.A.equals(t,a._lastDistanceDisplayCondition)||(a._lastDistanceDisplayCondition=Ut.A.clone(t,a._lastDistanceDisplayCondition),a.distanceDisplayCondition=_n.toValue(t,a.distanceDisplayCondition))}}this.updateShows(n)}else(0,d.A)(n)&&!n.ready&&(t=!1);return t},Rm.prototype.updateShows=function(e){const t=this.showsUpdated.values,n=t.length;for(let i=0;i<n;i++){const n=t[i],o=n.entity,r=this.geometry.get(n.id);let s=this.attributes.get(r.id.id);(0,d.A)(s)||(s=e.getGeometryInstanceAttributes(r.id),this.attributes.set(r.id.id,s));const a=o.isShowing;a!==(1===s.show[0])&&(s.show=wn.A.toValue(a,s.show),r.attributes.show.value[0]=s.show[0])}this.showsUpdated.removeAll()},Rm.prototype.contains=function(e){return this.updaters.contains(e.id)},Rm.prototype.getBoundingSphere=function(e,t){const n=this.primitive;if(!n.ready)return Gt.PENDING;const i=n.getGeometryInstanceAttributes(e.entity);return!(0,d.A)(i)||!(0,d.A)(i.boundingSphere)||(0,d.A)(i.show)&&0===i.show[0]?Gt.FAILED:(i.boundingSphere.clone(t),Gt.DONE)},Rm.prototype.destroy=function(){const e=this.primitive,t=this.orderedGroundPrimitives;(0,d.A)(e)&&t.remove(e);const n=this.oldPrimitive;(0,d.A)(n)&&t.remove(n),this.removeMaterialSubscription()},Mm.prototype.add=function(e,t){const n=this._items,i=n.length,o=t.createFillGeometryInstance(e),r=Wt.A.getValueOrDefault(t.zIndex,0);for(let s=0;s<i;++s){const i=n[s];if(i.isMaterial(t)&&i.zIndex===r)return void i.add(e,t,o)}const s=new Rm(this._orderedGroundPrimitives,this._classificationType,t.fillMaterialProperty,r,this._asynchronous);s.add(e,t,o),n.push(s)},Mm.prototype.remove=function(e){const t=this._items;for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.remove(e)){0===i.updaters.length&&(t.splice(n,1),i.destroy());break}}},Mm.prototype.update=function(e){let t;const n=this._items;for(t=n.length-1;t>=0;t--){const i=n[t];if(i.invalidated){n.splice(t,1);const o=i.updaters.values,r=o.length;for(let t=0;t<r;t++)this.add(e,o[t]);i.destroy()}}let i=!0;for(t=0;t<n.length;t++)i=n[t].update(e)&&i;return i},Mm.prototype.getBoundingSphere=function(e,t){const n=this._items,i=n.length;for(let o=0;o<i;o++){const i=n[o];if(i.contains(e))return i.getBoundingSphere(e,t)}return Gt.FAILED},Mm.prototype.removeAllPrimitives=function(){const e=this._items,t=e.length;for(let n=0;n<t;n++)e[n].destroy();this._items.length=0};const Lm=Mm,Nm=[];function Bm(e,t){const n=e._batches,i=n.length;for(let e=0;e<i;e++)n[e].remove(t)}function Fm(e,t,n){if(n.isDynamic)return void e._dynamicBatch.add(t,n);if(n.clampToGround&&n.fillEnabled){const i=n.classificationTypeProperty.getValue(t);return void e._groundBatches[i].add(t,n)}let i;n.fillEnabled&&(i=n.shadowsProperty.getValue(t));let o,r=0;(0,d.A)(n.depthFailMaterialProperty)&&(r=n.depthFailMaterialProperty instanceof En.A?1:2),(0,d.A)(i)&&(o=i+r*kn.A.NUMBER_OF_SHADOW_MODES),n.fillEnabled&&(n.fillMaterialProperty instanceof En.A?e._colorBatches[o].add(t,n):e._materialBatches[o].add(t,n))}function Um(e,t,n,i){let o;l.A.defined("scene",e),l.A.defined("entityCollection",t),i=i??e.groundPrimitives,n=n??e.primitives,this._scene=e,this._primitives=n,this._entityCollection=void 0,this._addedObjects=new Ft.A,this._removedObjects=new Ft.A,this._changedObjects=new Ft.A;const r=kn.A.NUMBER_OF_SHADOW_MODES;for(this._colorBatches=new Array(3*r),this._materialBatches=new Array(3*r),o=0;o<r;++o)this._colorBatches[o]=new np(n,um.A,void 0,!1,o),this._materialBatches[o]=new up(n,dm.A,void 0,!1,o),this._colorBatches[o+r]=new np(n,um.A,um.A,!1,o),this._materialBatches[o+r]=new up(n,dm.A,um.A,!1,o),this._colorBatches[o+2*r]=new np(n,um.A,dm.A,!1,o),this._materialBatches[o+2*r]=new up(n,dm.A,dm.A,!1,o);this._dynamicBatch=new Xl(n,i);const s=Un.A.NUMBER_OF_CLASSIFICATION_TYPES;for(this._groundBatches=new Array(s),o=0;o<s;++o)this._groundBatches[o]=new Lm(i,o);this._batches=this._colorBatches.concat(this._materialBatches,this._dynamicBatch,this._groundBatches),this._subscriptions=new Ft.A,this._updaters=new Ft.A,this._entityCollection=t,t.collectionChanged.addEventListener(Um.prototype._onCollectionChanged,this),this._onCollectionChanged(t,t.values,Nm)}Um.prototype.update=function(e){l.A.defined("time",e);const t=this._addedObjects,n=t.values,i=this._removedObjects,o=i.values,r=this._changedObjects,s=r.values;let a,c,u,d;for(a=s.length-1;a>-1;a--)c=s[a],u=c.id,d=this._updaters.get(u),d.entity===c?(Bm(this,d),Fm(this,e,d)):(o.push(c),n.push(c));for(a=o.length-1;a>-1;a--)c=o[a],u=c.id,d=this._updaters.get(u),Bm(this,d),d.destroy(),this._updaters.remove(u),this._subscriptions.get(u)(),this._subscriptions.remove(u);for(a=n.length-1;a>-1;a--)c=n[a],u=c.id,d=new Im(c,this._scene),this._updaters.set(u,d),Fm(this,e,d),this._subscriptions.set(u,d.geometryChanged.addEventListener(Um._onGeometryChanged,this));t.removeAll(),i.removeAll(),r.removeAll();let h=!0;const A=this._batches,p=A.length;for(a=0;a<p;a++)h=A[a].update(e)&&h;return h};const km=[],Vm=new Sn.A;Um.prototype.getBoundingSphere=function(e,t){l.A.defined("entity",e),l.A.defined("result",t);const n=km,i=Vm;let o=0,r=Gt.DONE;const s=this._batches,a=s.length,c=this._updaters.get(e.id);for(let e=0;e<a;e++){if(r=s[e].getBoundingSphere(c,i),r===Gt.PENDING)return Gt.PENDING;r===Gt.DONE&&(n[o]=Sn.A.clone(i,n[o]),o++)}return 0===o?Gt.FAILED:(n.length=o,Sn.A.fromBoundingSpheres(n,t),Gt.DONE)},Um.prototype.isDestroyed=function(){return!1},Um.prototype.destroy=function(){let e;this._entityCollection.collectionChanged.removeEventListener(Um.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();const t=this._batches;let n=t.length;for(e=0;e<n;e++)t[e].removeAllPrimitives();const i=this._subscriptions.values;for(n=i.length,e=0;e<n;e++)i[e]();return this._subscriptions.removeAll(),(0,h.A)(this)},Um._onGeometryChanged=function(e){const t=this._removedObjects,n=this._changedObjects,i=e.entity,o=i.id;(0,d.A)(t.get(o))||(0,d.A)(n.get(o))||n.set(o,i)},Um.prototype._onCollectionChanged=function(e,t,n){const i=this._addedObjects,o=this._removedObjects,r=this._changedObjects;let s,a,c;for(s=n.length-1;s>-1;s--)c=n[s],a=c.id,i.remove(a)||(o.set(a,c),r.remove(a));for(s=t.length-1;s>-1;s--)c=t[s],a=c.id,o.remove(a)?r.set(a,c):i.set(a,c)};const zm=Um;function Hm(e){l.A.typeOf.object("options",e),l.A.typeOf.object("options.scene",e.scene),l.A.typeOf.object("options.dataSourceCollection",e.dataSourceCollection),In.A.initializeTerrainHeights(),Wl.A.initializeTerrainHeights();const t=e.scene,n=e.dataSourceCollection;this._eventHelper=new Gi.A,this._eventHelper.add(n.dataSourceAdded,this._onDataSourceAdded,this),this._eventHelper.add(n.dataSourceRemoved,this._onDataSourceRemoved,this),this._eventHelper.add(n.dataSourceMoved,this._onDataSourceMoved,this),this._eventHelper.add(t.postRender,this._postRender,this),this._dataSourceCollection=n,this._scene=t,this._visualizersCallback=e.visualizersCallback??Hm.defaultVisualizersCallback;let i=!1;const o=new Yl.A,r=new Yl.A;n.length>0&&(t.primitives.add(o),t.groundPrimitives.add(r),i=!0),this._primitives=o,this._groundPrimitives=r;for(let e=0,t=n.length;e<t;e++)this._onDataSourceAdded(n,n.get(e));const s=new Cs.A;let a,c;if(this._onDataSourceAdded(void 0,s),this._defaultDataSource=s,!i){const e=this,i=function(){t.primitives.add(o),t.groundPrimitives.add(r),a(),c(),e._removeDefaultDataSourceListener=void 0,e._removeDataSourceCollectionListener=void 0};a=s.entities.collectionChanged.addEventListener(i),c=n.dataSourceAdded.addEventListener(i)}this._removeDefaultDataSourceListener=a,this._removeDataSourceCollectionListener=c,this._ready=!1}const Gm=[];Hm.registerVisualizer=function(e){Gm.includes(e)||Gm.push(e)},Hm.unregisterVisualizer=function(e){if(Gm.includes(e)){const t=Gm.indexOf(e);Gm.splice(t,1)}},Hm.defaultVisualizersCallback=function(e,t,n){const i=n.entities;return[new An(t,i),new Hp(e,i,n._primitives,n._groundPrimitives),new pf(t,i),new Nf(e,i),new xi(e,i),new lm(t,i),new Xf(e,i),new zm(e,i,n._primitives,n._groundPrimitives),...Gm.map(t=>new t(e,i))]},Object.defineProperties(Hm.prototype,{scene:{get:function(){return this._scene}},dataSources:{get:function(){return this._dataSourceCollection}},defaultDataSource:{get:function(){return this._defaultDataSource}},ready:{get:function(){return this._ready}}}),Hm.prototype.isDestroyed=function(){return!1},Hm.prototype.destroy=function(){this._eventHelper.removeAll();const e=this._dataSourceCollection;for(let t=0,n=e.length;t<n;++t)this._onDataSourceRemoved(this._dataSourceCollection,e.get(t));return this._onDataSourceRemoved(void 0,this._defaultDataSource),(0,d.A)(this._removeDefaultDataSourceListener)?(this._removeDefaultDataSourceListener(),this._removeDataSourceCollectionListener()):(this._scene.primitives.remove(this._primitives),this._scene.groundPrimitives.remove(this._groundPrimitives)),(0,h.A)(this)},Hm.prototype.update=function(e){if(l.A.defined("time",e),!mo.A.initialized)return this._ready=!1,!1;let t,n,i,o,r=!0;const s=this._dataSourceCollection,a=s.length;for(t=0;t<a;t++){const a=s.get(t);for((0,d.A)(a.update)&&(r=a.update(e)&&r),i=a._visualizers,o=i.length,n=0;n<o;n++)r=i[n].update(e)&&r}for(i=this._defaultDataSource._visualizers,o=i.length,n=0;n<o;n++)r=i[n].update(e)&&r;return!this._ready&&r&&this._scene.requestRender(),this._ready=this._ready||r,r},Hm.prototype._postRender=function(){const e=this._scene.frameState,t=this._dataSourceCollection,n=t.length;for(let i=0;i<n;i++){const n=t.get(i),o=n.credit;(0,d.A)(o)&&e.creditDisplay.addCreditToNextFrame(o);const r=n._resourceCredits;if((0,d.A)(r)){const t=r.length;for(let n=0;n<t;n++)e.creditDisplay.addCreditToNextFrame(r[n])}}};const Wm=[],Ym=new Sn.A;Hm.prototype.getBoundingSphere=function(e,t,n){if(l.A.defined("entity",e),l.A.typeOf.bool("allowPartial",t),l.A.defined("result",n),!this._ready)return Gt.PENDING;let i,o,r=this._defaultDataSource;if(!r.entities.contains(e)){r=void 0;const t=this._dataSourceCollection;for(o=t.length,i=0;i<o;i++){const n=t.get(i);if(n.entities.contains(e)){r=n;break}}}if(!(0,d.A)(r))return Gt.FAILED;const s=Wm,a=Ym;let c=0,u=Gt.DONE;const h=r._visualizers,A=h.length;for(i=0;i<A;i++){const n=h[i];if((0,d.A)(n.getBoundingSphere)){if(u=h[i].getBoundingSphere(e,a),!t&&u===Gt.PENDING)return Gt.PENDING;u===Gt.DONE&&(s[c]=Sn.A.clone(a,s[c]),c++)}}return 0===c?Gt.FAILED:(s.length=c,Sn.A.fromBoundingSpheres(s,n),Gt.DONE)},Hm.prototype._onDataSourceAdded=function(e,t){const n=this._scene,i=this._primitives,o=this._groundPrimitives,r=i.add(new Yl.A),s=o.add(new jl);t._primitives=r,t._groundPrimitives=s;const a=t.clustering;a._initialize(n),r.add(a),t._visualizers=this._visualizersCallback(n,a,t)},Hm.prototype._onDataSourceRemoved=function(e,t){const n=this._primitives,i=this._groundPrimitives,o=t._primitives,r=t._groundPrimitives,s=t.clustering;o.remove(s);const a=t._visualizers,c=a.length;for(let e=0;e<c;e++)a[e].destroy();n.remove(o),i.remove(r),t._visualizers=void 0},Hm.prototype._onDataSourceMoved=function(e,t,n){const i=this._primitives,o=this._groundPrimitives,r=e._primitives,s=e._groundPrimitives;t===n+1?(i.raise(r),o.raise(s)):t===n-1?(i.lower(r),o.lower(s)):0===t?(i.lowerToBottom(r),o.lowerToBottom(s),i.raise(r),o.raise(s)):(i.raiseToTop(r),o.raiseToTop(s))};const qm=Hm;var jm=n(805746),Qm=n(73772);const Xm=new Z.A,Km=new Z.A,$m=new Z.A,Jm=new O.A,Zm=new j.A,eg=new j.A,tg=new j.A,ng=new j.A,ig=new j.A,og=new j.A,rg=new To.A,sg=new j.A,ag=new Z.A,cg=new te.A;function lg(e,t,n){l.A.defined("entity",e),l.A.defined("scene",t),this.entity=e,this.scene=t,this.ellipsoid=n??K.A.default,this.boundingSphere=void 0,this._lastEntity=void 0,this._mode=void 0,this._lastCartesian=new j.A,this._defaultOffset3D=void 0,this._velocityProperty=new Bc(e.position,!0),this._offset3D=new j.A}Object.defineProperties(lg,{defaultOffset3D:{get:function(){return this._defaultOffset3D},set:function(e){this._defaultOffset3D=j.A.clone(e,new j.A)}}}),lg.defaultOffset3D=new j.A(-14e3,3500,3500);const ug=new jm.A,dg=new j.A;lg.prototype.update=function(e,t){l.A.defined("time",e);const n=this.scene,i=this.ellipsoid,o=n.mode;if(o===Ce.A.MORPHING)return;const r=this.entity,s=r.trackingReferenceFrame,a=r.position;if(!(0,d.A)(a))return;const c=this._velocityProperty,u=r.orientation,h=r!==this._lastEntity,A=o!==this._mode,p=n.camera;let f=h||A,m=!0;if(h){const n=r.viewFrom,o=(0,d.A)(n);if(!o&&(0,d.A)(t)){ug.pitch=-J.A.PI_OVER_FOUR,ug.range=0;const n=a.getValue(e,dg);if((0,d.A)(n)){const e=2-1/Math.max(1,j.A.magnitude(n)/i.maximumRadius);ug.pitch*=e}p.viewBoundingSphere(t,ug),this.boundingSphere=t,f=!1,m=!1}else o&&(0,d.A)(n.getValue(e,this._offset3D))||j.A.clone(lg._defaultOffset3D,this._offset3D)}else A||this._mode===Ce.A.SCENE2D||j.A.clone(p.position,this._offset3D);this._lastEntity=r,this._mode=o,function(e,t,n,i,o,r,s,a,c,l){const u=e.scene.mode;let h=o.getValue(c,e._lastCartesian);if((0,d.A)(h)){let n,A,p,f,m,g,_=!1,y=!1;if(u===Ce.A.SCENE3D){te.A.addSeconds(c,.001,cg);let e=o.getValue(cg,Zm);if((0,d.A)(e)||(te.A.addSeconds(c,-.001,cg),e=o.getValue(cg,Zm),y=!0),(0,d.A)(e)){let t,i=xe.A.computeFixedToIcrfMatrix(c,Xm),o=xe.A.computeFixedToIcrfMatrix(cg,Km);(0,d.A)(i)&&(0,d.A)(o)?t=Z.A.transpose(i,$m):(t=xe.A.computeTemeToPseudoFixedMatrix(c,$m),i=Z.A.transpose(t,Xm),o=xe.A.computeTemeToPseudoFixedMatrix(cg,Km),Z.A.transpose(o,o));const r=Z.A.multiplyByVector(i,h,ig),s=Z.A.multiplyByVector(o,e,og);j.A.subtract(r,s,ng);const a=1e3*j.A.magnitude(ng),u=J.A.GRAVITATIONALPARAMETER,f=-u/(a*a-2*u/j.A.magnitude(r));f<0||f>1.25*l.maximumRadius?(n=eg,j.A.normalize(h,n),j.A.negate(n,n),p=j.A.clone(j.A.UNIT_Z,tg),A=j.A.cross(p,n,Zm),j.A.magnitude(A)>J.A.EPSILON7&&(j.A.normalize(n,n),j.A.normalize(A,A),p=j.A.cross(n,A,tg),j.A.normalize(p,p),_=!0)):j.A.equalsEpsilon(h,e,J.A.EPSILON7)||(p=eg,j.A.normalize(r,p),j.A.normalize(s,s),A=j.A.cross(p,s,tg),y&&(A=j.A.multiplyByScalar(A,-1,A)),j.A.equalsEpsilon(A,j.A.ZERO,J.A.EPSILON7)||(n=j.A.cross(A,p,Zm),Z.A.multiplyByVector(t,n,n),Z.A.multiplyByVector(t,A,A),Z.A.multiplyByVector(t,p,p),j.A.normalize(n,n),j.A.normalize(A,A),j.A.normalize(p,p),_=!0))}}(0,d.A)(e.boundingSphere)&&(h=e.boundingSphere.center),i&&(f=j.A.clone(t.position,ng),m=j.A.clone(t.direction,ig),g=j.A.clone(t.up,og));const v=Jm;let T;(0,d.A)(s)&&(T=s.getValue(c,rg));const b=r.getValue(c,sg);if(a===Qm.A.INERTIAL&&(0,d.A)(T))O.A.fromTranslationQuaternionRotationScale(h,T,j.A.ONE,v);else if(a===Qm.A.VELOCITY&&(0,d.A)(b)){const e=xe.A.rotationMatrixFromPositionVelocity(h,b,l,ag);O.A.fromRotationTranslation(e,h,v)}else a!==Qm.A.ENU&&_?(v[0]=n.x,v[1]=n.y,v[2]=n.z,v[3]=0,v[4]=A.x,v[5]=A.y,v[6]=A.z,v[7]=0,v[8]=p.x,v[9]=p.y,v[10]=p.z,v[11]=0,v[12]=h.x,v[13]=h.y,v[14]=h.z,v[15]=0):xe.A.eastNorthUpToFixedFrame(h,l,v);t._setTransform(v),i&&(j.A.clone(f,t.position),j.A.clone(m,t.direction),j.A.clone(g,t.up),j.A.cross(m,g,t.right))}if(n){const n=u===Ce.A.SCENE2D||j.A.equals(e._offset3D,j.A.ZERO)?void 0:e._offset3D;t.lookAtTransform(t.transform,n)}}(this,p,f,m,a,c,u,s,e,i)};const hg=lg;var Ag=n(590108),pg=n(335385),fg=function(e,t){return fg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},fg(e,t)};function mg(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}fg(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var gg=function(){return gg=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},gg.apply(this,arguments)};Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var _g=Object.prototype.hasOwnProperty;function yg(e){return"boolean"==typeof e}function vg(e,t){for(var n=e.length-1;n>=0;n--)!0===t(e[n])&&e.splice(n,1)}function Tg(e){throw new Error("Unhandled case for value: '".concat(e,"'"))}var bg=/\s+/,wg=function(){function e(e){void 0===e&&(e={}),this.tagName="",this.attrs={},this.innerHTML="",this.tagName=e.tagName||"",this.attrs=e.attrs||{},this.innerHTML=e.innerHtml||e.innerHTML||""}return e.prototype.setTagName=function(e){return this.tagName=e,this},e.prototype.getTagName=function(){return this.tagName},e.prototype.setAttr=function(e,t){return this.getAttrs()[e]=t,this},e.prototype.getAttr=function(e){return this.getAttrs()[e]},e.prototype.setAttrs=function(e){return Object.assign(this.getAttrs(),e),this},e.prototype.getAttrs=function(){return this.attrs},e.prototype.setClass=function(e){return this.setAttr("class",e)},e.prototype.addClass=function(e){for(var t,n=this.getClass(),i=n?n.split(bg):[],o=e.split(bg);t=o.shift();)-1===i.indexOf(t)&&i.push(t);return this.getAttrs().class=i.join(" "),this},e.prototype.removeClass=function(e){for(var t,n=this.getClass(),i=n?n.split(bg):[],o=e.split(bg);i.length&&(t=o.shift());){var r=i.indexOf(t);-1!==r&&i.splice(r,1)}return this.getAttrs().class=i.join(" "),this},e.prototype.getClass=function(){return this.getAttrs().class||""},e.prototype.hasClass=function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},e.prototype.setInnerHTML=function(e){return this.innerHTML=e,this},e.prototype.setInnerHtml=function(e){return this.setInnerHTML(e)},e.prototype.getInnerHTML=function(){return this.innerHTML||""},e.prototype.getInnerHtml=function(){return this.getInnerHTML()},e.prototype.toAnchorString=function(){var e=this.getTagName(),t=this.buildAttrsStr();return["<",e,t=t?" "+t:"",">",this.getInnerHtml(),"</",e,">"].join("")},e.prototype.buildAttrsStr=function(){var e=this.getAttrs(),t=[];for(var n in e)_g.call(e,n)&&t.push(n+'="'+e[n]+'"');return t.join(" ")},e}();function xg(e){var t="";return e.scheme&&e.host&&(t+=e.scheme+"://"),e.host&&(t+=e.host),e.path&&(t+="/"+e.path),e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t}function Cg(e,t,n){var i=t/2,o=Math.ceil(i),r=-1*Math.floor(i),s="";return r<0&&(s=e.substr(r)),e.substr(0,o)+n+s}var Eg=function(){function e(e){void 0===e&&(e={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=e.newWindow||!1,this.truncate=e.truncate||{},this.className=e.className||""}return e.prototype.build=function(e){return new wg({tagName:"a",attrs:this.createAttrs(e),innerHtml:this.processAnchorText(e.getAnchorText())})},e.prototype.createAttrs=function(e){var t={href:e.getAnchorHref()},n=this.createCssClass(e);return n&&(t.class=n),this.newWindow&&(t.target="_blank",t.rel="noopener noreferrer"),this.truncate.length&&this.truncate.length<e.getAnchorText().length&&(t.title=e.getAnchorHref()),t},e.prototype.createCssClass=function(e){var t=this.className;if(t){for(var n=[t],i=e.getCssClassSuffixes(),o=0,r=i.length;o<r;o++)n.push(t+"-"+i[o]);return n.join(" ")}return""},e.prototype.processAnchorText=function(e){return this.doTruncate(e)},e.prototype.doTruncate=function(e){var t=this.truncate;if(!t.length)return e;var n=t.length,i=t.location;return"smart"===i?function(e,t,n){var i,o;if(null==n?(n="&hellip;",o=3,i=8):(o=n.length,i=n.length),e.length<=t)return e;var r=t-o,s=function(e){var t={},n=e,i=n.match(/^([a-z]+):\/\//i);return i&&(t.scheme=i[1],n=n.slice(i[0].length)),(i=n.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(t.host=i[1],n=n.slice(i[0].length)),(i=n.match(/^\/(.*?)(?=(\?|#|$))/i))&&(t.path=i[1],n=n.slice(i[0].length)),(i=n.match(/^\?(.*?)(?=(#|$))/i))&&(t.query=i[1],n=n.slice(i[0].length)),(i=n.match(/^#(.*?)$/i))&&(t.fragment=i[1]),t}(e);if(s.query){var a=s.query.match(/^(.*?)(?=(\?|#))(.*?)$/i);a&&(s.query=s.query.substr(0,a[1].length),e=xg(s))}if(e.length<=t)return e;if(s.host&&(s.host=s.host.replace(/^www\./,""),e=xg(s)),e.length<=t)return e;var c="";if(s.host&&(c+=s.host),c.length>=r)return s.host.length===t?(s.host.substr(0,t-o)+n).substr(0,r+i):Cg(c,r,n).substr(0,r+i);var l="";if(s.path&&(l+="/"+s.path),s.query&&(l+="?"+s.query),l){if((c+l).length>=r)return(c+l).length==t?(c+l).substr(0,t):(c+Cg(l,r-c.length,n)).substr(0,r+i);c+=l}if(s.fragment){var u="#"+s.fragment;if((c+u).length>=r)return(c+u).length==t?(c+u).substr(0,t):(c+Cg(u,r-c.length,n)).substr(0,r+i);c+=u}if(s.scheme&&s.host){var d=s.scheme+"://";if((c+d).length<r)return(d+c).substr(0,t)}if(c.length<=t)return c;var h="";return r>0&&(h=c.substr(-1*Math.floor(r/2))),(c.substr(0,Math.ceil(r/2))+n+h).substr(0,r+i)}(e,n):"middle"===i?function(e,t,n){if(e.length<=t)return e;var i,o;null==n?(n="&hellip;",i=8,o=3):(i=n.length,o=n.length);var r=t-o,s="";return r>0&&(s=e.substr(-1*Math.floor(r/2))),(e.substr(0,Math.ceil(r/2))+n+s).substr(0,r+i)}(e,n):function(e,t){return function(e,t,n){var i;return e.length>t&&(null==n?(n="&hellip;",i=3):i=n.length,e=e.substring(0,t-i)+n),e}(e,t,void 0)}(e,n)},e}(),Sg=function(){function e(e){this._=null,this.matchedText="",this.offset=0,this.tagBuilder=e.tagBuilder,this.matchedText=e.matchedText,this.offset=e.offset}return e.prototype.getMatchedText=function(){return this.matchedText},e.prototype.setOffset=function(e){this.offset=e},e.prototype.getOffset=function(){return this.offset},e.prototype.getCssClassSuffixes=function(){return[this.type]},e.prototype.buildTag=function(){return this.tagBuilder.build(this)},e}();function Ig(e){return e>=65&&e<=90||e>=97&&e<=122}function Pg(e){return e>=48&&e<=57}function Dg(e){return 34==e||39==e}function Og(e){return e<8232?e<160?e>=9&&e<=13||32==e:e<5760?160==e:5760==e||e>=8192&&e<=8202:e<8287?e>=8232&&e<=8233||8239==e:e<12288?8287==e:12288==e||65279==e}function Rg(e){return e<4800?e<2949?e<2451?e<1425?e<768?e<192?e<169?e<65?e>=48&&e<=57:e>=65&&e<=90||e>=97&&e<=122:e<181?e>=169&&e<=170||174==e:181==e||186==e:e<710?e<216?e>=192&&e<=214:e>=216&&e<=246||e>=248&&e<=705:e<748?e>=710&&e<=721||e>=736&&e<=740:748==e||750==e:e<910?e<895?e<886?e>=768&&e<=884:e>=886&&e<=887||e>=890&&e<=893:e<904?895==e||902==e:e>=904&&e<=906||908==e:e<1155?e<931?e>=910&&e<=929:e>=931&&e<=1013||e>=1015&&e<=1153:e<1369?e>=1155&&e<=1327||e>=1329&&e<=1366:1369==e||e>=1377&&e<=1415:e<1808?e<1552?e<1476?e<1471?e>=1425&&e<=1469:1471==e||e>=1473&&e<=1474:e<1488?e>=1476&&e<=1477||1479==e:e>=1488&&e<=1514||e>=1520&&e<=1522:e<1749?e<1568?e>=1552&&e<=1562:e>=1568&&e<=1641||e>=1646&&e<=1747:e<1770?e>=1749&&e<=1756||e>=1759&&e<=1768:e>=1770&&e<=1788||1791==e:e<2230?e<2042?e<1869?e>=1808&&e<=1866:e>=1869&&e<=1969||e>=1984&&e<=2037:e<2112?2042==e||e>=2048&&e<=2093:e>=2112&&e<=2139||e>=2208&&e<=2228:e<2406?e<2260?e>=2230&&e<=2237:e>=2260&&e<=2273||e>=2275&&e<=2403:e<2437?e>=2406&&e<=2415||e>=2417&&e<=2435:e>=2437&&e<=2444||e>=2447&&e<=2448:e<2693?e<2579?e<2519?e<2486?e<2474?e>=2451&&e<=2472:e>=2474&&e<=2480||2482==e:e<2503?e>=2486&&e<=2489||e>=2492&&e<=2500:e>=2503&&e<=2504||e>=2507&&e<=2510:e<2534?e<2524?2519==e:e>=2524&&e<=2525||e>=2527&&e<=2531:e<2565?e>=2534&&e<=2545||e>=2561&&e<=2563:e>=2565&&e<=2570||e>=2575&&e<=2576:e<2631?e<2613?e<2602?e>=2579&&e<=2600:e>=2602&&e<=2608||e>=2610&&e<=2611:e<2620?e>=2613&&e<=2614||e>=2616&&e<=2617:2620==e||e>=2622&&e<=2626:e<2649?e<2635?e>=2631&&e<=2632:e>=2635&&e<=2637||2641==e:e<2662?e>=2649&&e<=2652||2654==e:e>=2662&&e<=2677||e>=2689&&e<=2691:e<2821?e<2759?e<2730?e<2703?e>=2693&&e<=2701:e>=2703&&e<=2705||e>=2707&&e<=2728:e<2741?e>=2730&&e<=2736||e>=2738&&e<=2739:e>=2741&&e<=2745||e>=2748&&e<=2757:e<2784?e<2763?e>=2759&&e<=2761:e>=2763&&e<=2765||2768==e:e<2809?e>=2784&&e<=2787||e>=2790&&e<=2799:2809==e||e>=2817&&e<=2819:e<2887?e<2858?e<2831?e>=2821&&e<=2828:e>=2831&&e<=2832||e>=2835&&e<=2856:e<2869?e>=2858&&e<=2864||e>=2866&&e<=2867:e>=2869&&e<=2873||e>=2876&&e<=2884:e<2911?e<2902?e>=2887&&e<=2888||e>=2891&&e<=2893:e>=2902&&e<=2903||e>=2908&&e<=2909:e<2929?e>=2911&&e<=2915||e>=2918&&e<=2927:2929==e||e>=2946&&e<=2947:e<3517?e<3205?e<3046?e<2984?e<2969?e<2958?e>=2949&&e<=2954:e>=2958&&e<=2960||e>=2962&&e<=2965:e<2974?e>=2969&&e<=2970||2972==e:e>=2974&&e<=2975||e>=2979&&e<=2980:e<3014?e<2990?e>=2984&&e<=2986:e>=2990&&e<=3001||e>=3006&&e<=3010:e<3024?e>=3014&&e<=3016||e>=3018&&e<=3021:3024==e||3031==e:e<3142?e<3086?e<3072?e>=3046&&e<=3055:e>=3072&&e<=3075||e>=3077&&e<=3084:e<3114?e>=3086&&e<=3088||e>=3090&&e<=3112:e>=3114&&e<=3129||e>=3133&&e<=3140:e<3160?e<3146?e>=3142&&e<=3144:e>=3146&&e<=3149||e>=3157&&e<=3158:e<3174?e>=3160&&e<=3162||e>=3168&&e<=3171:e>=3174&&e<=3183||e>=3200&&e<=3203:e<3333?e<3274?e<3242?e<3214?e>=3205&&e<=3212:e>=3214&&e<=3216||e>=3218&&e<=3240:e<3260?e>=3242&&e<=3251||e>=3253&&e<=3257:e>=3260&&e<=3268||e>=3270&&e<=3272:e<3296?e<3285?e>=3274&&e<=3277:e>=3285&&e<=3286||3294==e:e<3313?e>=3296&&e<=3299||e>=3302&&e<=3311:e>=3313&&e<=3314||e>=3329&&e<=3331:e<3423?e<3389?e<3342?e>=3333&&e<=3340:e>=3342&&e<=3344||e>=3346&&e<=3386:e<3402?e>=3389&&e<=3396||e>=3398&&e<=3400:e>=3402&&e<=3406||e>=3412&&e<=3415:e<3458?e<3430?e>=3423&&e<=3427:e>=3430&&e<=3439||e>=3450&&e<=3455:e<3482?e>=3458&&e<=3459||e>=3461&&e<=3478:e>=3482&&e<=3505||e>=3507&&e<=3515:e<3804?e<3722?e<3570?e<3535?e<3520?3517==e:e>=3520&&e<=3526||3530==e:e<3544?e>=3535&&e<=3540||3542==e:e>=3544&&e<=3551||e>=3558&&e<=3567:e<3664?e<3585?e>=3570&&e<=3571:e>=3585&&e<=3642||e>=3648&&e<=3662:e<3716?e>=3664&&e<=3673||e>=3713&&e<=3714:3716==e||e>=3719&&e<=3720:e<3754?e<3737?e<3725?3722==e:3725==e||e>=3732&&e<=3735:e<3749?e>=3737&&e<=3743||e>=3745&&e<=3747:3749==e||3751==e:e<3776?e<3757?e>=3754&&e<=3755:e>=3757&&e<=3769||e>=3771&&e<=3773:e<3784?e>=3776&&e<=3780||3782==e:e>=3784&&e<=3789||e>=3792&&e<=3801:e<4176?e<3902?e<3872?e<3840?e>=3804&&e<=3807:3840==e||e>=3864&&e<=3865:e<3895?e>=3872&&e<=3881||3893==e:3895==e||3897==e:e<3974?e<3913?e>=3902&&e<=3911:e>=3913&&e<=3948||e>=3953&&e<=3972:e<4038?e>=3974&&e<=3991||e>=3993&&e<=4028:4038==e||e>=4096&&e<=4169:e<4688?e<4301?e<4256?e>=4176&&e<=4253:e>=4256&&e<=4293||4295==e:e<4348?4301==e||e>=4304&&e<=4346:e>=4348&&e<=4680||e>=4682&&e<=4685:e<4746?e<4698?e>=4688&&e<=4694||4696==e:e>=4698&&e<=4701||e>=4704&&e<=4744:e<4786?e>=4746&&e<=4749||e>=4752&&e<=4784:e>=4786&&e<=4789||e>=4792&&e<=4798:e<11035?e<7416?e<6176?e<5873?e<4992?e<4824?e<4802?4800==e:e>=4802&&e<=4805||e>=4808&&e<=4822:e<4888?e>=4824&&e<=4880||e>=4882&&e<=4885:e>=4888&&e<=4954||e>=4957&&e<=4959:e<5121?e<5024?e>=4992&&e<=5007:e>=5024&&e<=5109||e>=5112&&e<=5117:e<5761?e>=5121&&e<=5740||e>=5743&&e<=5759:e>=5761&&e<=5786||e>=5792&&e<=5866:e<6002?e<5920?e<5888?e>=5873&&e<=5880:e>=5888&&e<=5900||e>=5902&&e<=5908:e<5984?e>=5920&&e<=5940||e>=5952&&e<=5971:e>=5984&&e<=5996||e>=5998&&e<=6e3:e<6108?e<6016?e>=6002&&e<=6003:e>=6016&&e<=6099||6103==e:e<6155?e>=6108&&e<=6109||e>=6112&&e<=6121:e>=6155&&e<=6157||e>=6160&&e<=6169:e<6783?e<6512?e<6400?e<6272?e>=6176&&e<=6263:e>=6272&&e<=6314||e>=6320&&e<=6389:e<6448?e>=6400&&e<=6430||e>=6432&&e<=6443:e>=6448&&e<=6459||e>=6470&&e<=6509:e<6608?e<6528?e>=6512&&e<=6516:e>=6528&&e<=6571||e>=6576&&e<=6601:e<6688?e>=6608&&e<=6617||e>=6656&&e<=6683:e>=6688&&e<=6750||e>=6752&&e<=6780:e<7040?e<6832?e<6800?e>=6783&&e<=6793:e>=6800&&e<=6809||6823==e:e<6992?e>=6832&&e<=6846||e>=6912&&e<=6987:e>=6992&&e<=7001||e>=7019&&e<=7027:e<7245?e<7168?e>=7040&&e<=7155:e>=7168&&e<=7223||e>=7232&&e<=7241:e<7376?e>=7245&&e<=7293||e>=7296&&e<=7304:e>=7376&&e<=7378||e>=7380&&e<=7414:e<8450?e<8130?e<8025?e<7960?e<7424?e>=7416&&e<=7417:e>=7424&&e<=7669||e>=7675&&e<=7957:e<8008?e>=7960&&e<=7965||e>=7968&&e<=8005:e>=8008&&e<=8013||e>=8016&&e<=8023:e<8031?e<8027?8025==e:8027==e||8029==e:e<8118?e>=8031&&e<=8061||e>=8064&&e<=8116:e>=8118&&e<=8124||8126==e:e<8205?e<8150?e<8134?e>=8130&&e<=8132:e>=8134&&e<=8140||e>=8144&&e<=8147:e<8178?e>=8150&&e<=8155||e>=8160&&e<=8172:e>=8178&&e<=8180||e>=8182&&e<=8188:e<8305?e<8252?8205==e:8252==e||8265==e:e<8336?8305==e||8319==e:e>=8336&&e<=8348||e>=8400&&e<=8432:e<8579?e<8486?e<8469?e<8455?8450==e:8455==e||e>=8458&&e<=8467:e<8482?8469==e||e>=8473&&e<=8477:8482==e||8484==e:e<8495?e<8488?8486==e:8488==e||e>=8490&&e<=8493:e<8517?e>=8495&&e<=8505||e>=8508&&e<=8511:e>=8517&&e<=8521||8526==e:e<9410?e<9e3?e<8592?e>=8579&&e<=8580:e>=8592&&e<=8703||e>=8986&&e<=8987:e<9193?9e3==e||9167==e:e>=9193&&e<=9203||e>=9208&&e<=9210:e<9723?e<9654?9410==e||e>=9642&&e<=9643:9654==e||9664==e:e<10548?e>=9723&&e<=9726||e>=9728&&e<=10175:e>=10548&&e<=10549||e>=11013&&e<=11015:e<43259?e<12445?e<11688?e<11520?e<11264?e<11088?e>=11035&&e<=11036:11088==e||11093==e:e<11360?e>=11264&&e<=11310||e>=11312&&e<=11358:e>=11360&&e<=11492||e>=11499&&e<=11507:e<11568?e<11559?e>=11520&&e<=11557:11559==e||11565==e:e<11647?e>=11568&&e<=11623||11631==e:e>=11647&&e<=11670||e>=11680&&e<=11686:e<11744?e<11712?e<11696?e>=11688&&e<=11694:e>=11696&&e<=11702||e>=11704&&e<=11710:e<11728?e>=11712&&e<=11718||e>=11720&&e<=11726:e>=11728&&e<=11734||e>=11736&&e<=11742:e<12330?e<11823?e>=11744&&e<=11775:11823==e||e>=12293&&e<=12294:e<12353?e>=12330&&e<=12341||e>=12347&&e<=12349:e>=12353&&e<=12438||e>=12441&&e<=12442:e<42512?e<12951?e<12549?e<12449?e>=12445&&e<=12447:e>=12449&&e<=12538||e>=12540&&e<=12543:e<12704?e>=12549&&e<=12589||e>=12593&&e<=12686:e>=12704&&e<=12730||e>=12784&&e<=12799:e<19968?e<12953?12951==e:12953==e||e>=13312&&e<=19893:e<42192?e>=19968&&e<=40917||e>=40960&&e<=42124:e>=42192&&e<=42237||e>=42240&&e<=42508:e<42891?e<42623?e<42560?e>=42512&&e<=42539:e>=42560&&e<=42610||e>=42612&&e<=42621:e<42775?e>=42623&&e<=42725||e>=42736&&e<=42737:e>=42775&&e<=42783||e>=42786&&e<=42888:e<43072?e<42928?e>=42891&&e<=42926:e>=42928&&e<=42935||e>=42999&&e<=43047:e<43216?e>=43072&&e<=43123||e>=43136&&e<=43205:e>=43216&&e<=43225||e>=43232&&e<=43255:e<55243?e<43744?e<43488?e<43312?e<43261?43259==e:43261==e||e>=43264&&e<=43309:e<43392?e>=43312&&e<=43347||e>=43360&&e<=43388:e>=43392&&e<=43456||e>=43471&&e<=43481:e<43600?e<43520?e>=43488&&e<=43518:e>=43520&&e<=43574||e>=43584&&e<=43597:e<43642?e>=43600&&e<=43609||e>=43616&&e<=43638:e>=43642&&e<=43714||e>=43739&&e<=43741:e<43824?e<43785?e<43762?e>=43744&&e<=43759:e>=43762&&e<=43766||e>=43777&&e<=43782:e<43808?e>=43785&&e<=43790||e>=43793&&e<=43798:e>=43808&&e<=43814||e>=43816&&e<=43822:e<44012?e<43868?e>=43824&&e<=43866:e>=43868&&e<=43877||e>=43888&&e<=44010:e<44032?e>=44012&&e<=44013||e>=44016&&e<=44025:e>=44032&&e<=55203||e>=55216&&e<=55238:e<64848?e<64298?e<64112?e<55296?e>=55243&&e<=55291:e>=55296&&e<=57343||e>=63744&&e<=64109:e<64275?e>=64112&&e<=64217||e>=64256&&e<=64262:e>=64275&&e<=64279||e>=64285&&e<=64296:e<64320?e<64312?e>=64298&&e<=64310:e>=64312&&e<=64316||64318==e:e<64326?e>=64320&&e<=64321||e>=64323&&e<=64324:e>=64326&&e<=64433||e>=64467&&e<=64829:e<65296?e<65024?e<64914?e>=64848&&e<=64911:e>=64914&&e<=64967||e>=65008&&e<=65019:e<65136?e>=65024&&e<=65039||e>=65056&&e<=65071:e>=65136&&e<=65140||e>=65142&&e<=65276:e<65474?e<65345?e>=65296&&e<=65305||e>=65313&&e<=65338:e>=65345&&e<=65370||e>=65382&&e<=65470:e<65490?e>=65474&&e<=65479||e>=65482&&e<=65487:e>=65490&&e<=65495||e>=65498&&e<=65500}function Mg(e){return e<58?e<44?33==e:44==e||46==e:e<63?e>=58&&e<=59:63==e||94==e}function Lg(e){return e<91?40==e:91==e||123==e}function Ng(e){return e<93?41==e:93==e||125==e}var Bg=/^(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|travelersinsurance|vermögensberatung|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|vermögensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbc0a9azcg|xn--nqv7fs00ema|americanfamily|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|சிங்கப்பூர்|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|tatamotors|technology|university|vlaanderen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|pramerica|richardli|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|موريتانيا|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|builders|business|capetown|catering|catholic|cipriani|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|السعودية|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|banamex|bauhaus|bestbuy|booking|brother|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|yamaxun|youtube|zuerich|католик|البحرين|الجزائر|العليان|پاکستان|كاثوليك|இந்தியா|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kindle|kosher|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|nagoya|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|walter|webcam|xihuan|yachts|yandex|zappos|москва|онлайн|ابوظبي|ارامكو|الاردن|المغرب|امارات|فلسطين|مليسيا|भारतम्|இலங்கை|ファッション|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|loans|locus|lotte|lotto|mango|media|miami|money|movie|music|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|ישראל|ایران|بازار|بھارت|سودان|سورية|همراه|भारोत|संगठन|বাংলা|భారత్|ഭാരതം|嘉里大酒店|aarp|able|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|dvag|erni|fage|fail|fans|farm|fast|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kids|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|read|reit|rent|rest|rich|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|дети|сайт|بارت|بيتك|ڀارت|تونس|شبكة|عراق|عمان|موقع|भारत|ভারত|ভাৰত|ਭਾਰਤ|ભારત|ଭାରତ|ಭಾರತ|ලංකා|アマゾン|グーグル|クラウド|ポイント|组织机构|電訊盈科|香格里拉|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|ceo|cfa|cfd|com|cpa|crs|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|scb|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|бел|ком|қаз|мкд|мон|орг|рус|срб|укр|հայ|קום|عرب|قطر|كوم|مصر|कॉम|नेट|คอม|ไทย|ລາວ|ストア|セール|みんな|中文网|亚马逊|天主教|我爱你|新加坡|淡马锡|飞利浦|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|ελ|ευ|бг|ею|рф|გე|닷넷|닷컴|삼성|한국|コム|世界|中信|中国|中國|企业|佛山|信息|健康|八卦|公司|公益|台湾|台灣|商城|商店|商标|嘉里|在线|大拿|娱乐|家電|广东|微博|慈善|手机|招聘|政务|政府|新闻|时尚|書籍|机构|游戏|澳門|点看|移动|网址|网店|网站|网络|联通|谷歌|购物|通販|集团|食品|餐厅|香港)$/,Fg=/https?:\/\//i,Ug=new RegExp("^"+Fg.source,"i"),kg=/^(javascript|vbscript):/i,Vg=/^[A-Za-z][-.+A-Za-z0-9]*:(\/\/)?([^:/]*)/,zg=/^(?:\/\/)?([^/#?:]+)/,Hg=Ig;function Gg(e){return Ig(e)||Pg(e)||43===e||45===e||46===e}var Wg=Rg;function Yg(e){return 95===e||Wg(e)}function qg(e){return Rg(e)||((t=e)<91?t<47?t>=35&&t<=43||45==t:t<61?47==t:61==t||64==t:t<95?91==t||93==t:t<123?95==t:t>=123&&t<=126||10003==t)||Mg(e);var t}function jg(e){return 47===e||63===e||35===e}function Qg(e){return Bg.test(e.toLowerCase())}var Xg=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,Kg=/[:/?#]/,$g=/^(https?:\/\/)?(?:www\.)?/i,Jg=/^\/\//,Zg=function(e){function t(t){var n=e.call(this,t)||this;return n.type="url",n.url="",n.urlMatchType="scheme",n.protocolRelativeMatch=!1,n.stripPrefix={scheme:!0,www:!0},n.stripTrailingSlash=!0,n.decodePercentEncoding=!0,n.protocolPrepended=!1,n.urlMatchType=t.urlMatchType,n.url=t.url,n.protocolRelativeMatch=t.protocolRelativeMatch,n.stripPrefix=t.stripPrefix,n.stripTrailingSlash=t.stripTrailingSlash,n.decodePercentEncoding=t.decodePercentEncoding,n}return mg(t,e),t.prototype.getType=function(){return"url"},t.prototype.getUrlMatchType=function(){return this.urlMatchType},t.prototype.getUrl=function(){var e=this.url;return this.protocolRelativeMatch||"scheme"===this.urlMatchType||this.protocolPrepended||(e=this.url="http://"+e,this.protocolPrepended=!0),e},t.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},t.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=e.replace(Jg,"")),this.stripPrefix.scheme&&(e=function(e){return e.replace(Ug,"")}(e)),this.stripPrefix.www&&(e=function(e){return e.includes("www.")?e.replace($g,"$1"):e}(e)),this.stripTrailingSlash&&(e=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e}(e)),this.decodePercentEncoding&&(e=function(e){var t=e.replace(/%(?:22|26|27|3C|3E)/gi,function(e){return"%22"===e?"&quot;":"%26"===e?"&amp;":"%27"===e?"&#39;":"%3C"===e||"%3c"===e?"&lt;":"&gt;"});if(t.includes("%"))try{return decodeURIComponent(t)}catch(e){}return t}(e)),e},t}(Sg),e_=/^mailto:/i,t_=Rg;function n_(e){return t_(e)||((t=e)<47?t<42?33==t||t>=35&&t<=39:t>=42&&t<=43||45==t:t<63?47==t||61==t:t<94?63==t:t>=94&&t<=96||t>=123&&t<=126);var t}var i_=function(e){function t(t){var n=e.call(this,t)||this;return n.type="email",n.email="",n.email=t.email,n}return mg(t,e),t.prototype.getType=function(){return"email"},t.prototype.getEmail=function(){return this.email},t.prototype.getAnchorHref=function(){return"mailto:"+this.email},t.prototype.getAnchorText=function(){return this.email},t}(Sg);function o_(e){return 95===e||Rg(e)}var r_=["twitter","facebook","instagram","tiktok","youtube"],s_=function(e){function t(t){var n=e.call(this,t)||this;return n.type="hashtag",n.serviceName="twitter",n.hashtag="",n.serviceName=t.serviceName,n.hashtag=t.hashtag,n}return mg(t,e),t.prototype.getType=function(){return"hashtag"},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getHashtag=function(){return this.hashtag},t.prototype.getAnchorHref=function(){var e=this.serviceName,t=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+t;case"facebook":return"https://www.facebook.com/hashtag/"+t;case"instagram":return"https://instagram.com/explore/tags/"+t;case"tiktok":return"https://www.tiktok.com/tag/"+t;case"youtube":return"https://youtube.com/hashtag/"+t;default:Tg(e)}},t.prototype.getAnchorText=function(){return"#"+this.hashtag},t.prototype.getCssClassSuffixes=function(){var t=e.prototype.getCssClassSuffixes.call(this),n=this.getServiceName();return n&&t.push(n),t},t}(Sg),a_={twitter:/^@\w{1,15}$/,instagram:/^@[_\w]{1,30}$/,soundcloud:/^@[-a-z0-9_]{3,25}$/,tiktok:/^@[.\w]{1,23}[\w]$/,youtube:/^@[-.·\w]{3,30}$/};function c_(e){return 45===e||46===e||95===e||Ig(e)||Pg(e)}var l_=["twitter","instagram","soundcloud","tiktok","youtube"],u_=function(e){function t(t){var n=e.call(this,t)||this;return n.type="mention",n.serviceName="twitter",n.mention="",n.mention=t.mention,n.serviceName=t.serviceName,n}return mg(t,e),t.prototype.getType=function(){return"mention"},t.prototype.getMention=function(){return this.mention},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;case"youtube":return"https://youtube.com/@"+this.mention;default:Tg(this.serviceName)}},t.prototype.getAnchorText=function(){return"@"+this.mention},t.prototype.getCssClassSuffixes=function(){var t=e.prototype.getCssClassSuffixes.call(this),n=this.getServiceName();return n&&t.push(n),t},t}(Sg),d_=/[-. ()]/,h_=new RegExp("^".concat(/(?:(?:(?:(\+)?\d{1,3}[-. ]?)?\(?\d{3}\)?[-. ]?\d{3}[-. ]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-. ]?(?:\d[-. ]?){6,12}\d+))([,;]+[0-9]+#?)*/.source,"|").concat(/(0([1-9]-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source,"$"));function A_(e){return 45===e||46===e||32===e}function p_(e){return 44===e||59===e}var f_=function(e){function t(t){var n=e.call(this,t)||this;return n.type="phone",n.number="",n.plusSign=!1,n.number=t.number,n.plusSign=t.plusSign,n}return mg(t,e),t.prototype.getType=function(){return"phone"},t.prototype.getPhoneNumber=function(){return this.number},t.prototype.getNumber=function(){return this.getPhoneNumber()},t.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},t.prototype.getAnchorText=function(){return this.matchedText},t}(Sg),m_=function(){function e(e,t){this.charIdx=0,this.matches=[],this._stateMachines=[],this.schemeUrlMachinesCount=0,this.text=e,this.tagBuilder=t.tagBuilder,this.stripPrefix=t.stripPrefix,this.stripTrailingSlash=t.stripTrailingSlash,this.decodePercentEncoding=t.decodePercentEncoding,this.hashtagServiceName=t.hashtagServiceName,this.mentionServiceName=t.mentionServiceName}return Object.defineProperty(e.prototype,"stateMachines",{get:function(){return this._stateMachines},enumerable:!1,configurable:!0}),e.prototype.addMachine=function(e){this._stateMachines.push(e),hy(e)&&this.schemeUrlMachinesCount++},e.prototype.removeMachine=function(e){this._stateMachines=this._stateMachines.filter(function(t){return t!==e}),hy(e)&&this.schemeUrlMachinesCount--},e.prototype.hasSchemeUrlMachine=function(){return this.schemeUrlMachinesCount>0},e}();function g_(e,t,n){var i=e.charIdx;if(35===n)e.addMachine({type:2,startIdx:i,state:28,acceptStateReached:!1});else if(64===n)e.addMachine({type:3,startIdx:i,state:30,acceptStateReached:!1});else if(47===n)e.addMachine(uy(i,11));else if(43===n)e.addMachine(dy(i,37));else if(40===n)e.addMachine(dy(i,32));else{if(Pg(n)&&(e.addMachine(dy(i,38)),e.addMachine(function(e){return{type:0,startIdx:e,state:13,acceptStateReached:!1,matchType:2,octetsEncountered:1}}(i))),t_(n)){var o="m"===t.toLowerCase()?15:22;e.addMachine(function(e,t){return{type:1,startIdx:e,state:t,acceptStateReached:!1}}(i,o))}Hg(n)&&e.addMachine(ly(i,0)),Rg(n)&&e.addMachine(uy(i,5))}}function __(e,t,n){58===n?t.state=2:45===n?t.state=1:Gg(n)||e.removeMachine(t)}function y_(e,t,n){var i=e.charIdx;45===n||(47===n?(e.removeMachine(t),e.addMachine(uy(i,11))):Gg(n)?t.state=0:e.removeMachine(t))}function v_(e,t,n){var i=e.charIdx;47===n?t.state=3:46===n?e.removeMachine(t):Wg(n)?(t.state=5,Hg(n)&&e.addMachine(ly(i,0))):e.removeMachine(t)}function T_(e,t,n){47===n?t.state=4:qg(n)?(t.state=10,t.acceptStateReached=!0):sy(e,t)}function b_(e,t,n,i){47===i?(t.state=10,t.acceptStateReached=!0):Wg(i)?(t.state=5,t.acceptStateReached=!0):e.removeMachine(t)}function w_(e,t,n){47===n?t.state=12:e.removeMachine(t)}function x_(e,t,n){Wg(n)?t.state=5:e.removeMachine(t)}function C_(e,t,n){46===n?t.state=7:45===n?t.state=6:58===n?t.state=8:jg(n)?t.state=10:Yg(n)||sy(e,t)}function E_(e,t,n,i){45===i||(46===i?sy(e,t):Wg(i)?t.state=5:sy(e,t))}function S_(e,t,n,i){46===i?sy(e,t):Wg(i)?(t.state=5,t.acceptStateReached=!0):sy(e,t)}function I_(e,t,n){46===n?t.state=14:58===n?t.state=8:Pg(n)||(jg(n)?t.state=10:Rg(n)?e.removeMachine(t):sy(e,t))}function P_(e,t,n){Pg(n)?(t.octetsEncountered++,4===t.octetsEncountered&&(t.acceptStateReached=!0),t.state=13):sy(e,t)}function D_(e,t,n){Pg(n)?t.state=9:sy(e,t)}function O_(e,t,n){Pg(n)||(jg(n)?t.state=10:sy(e,t))}function R_(e,t,n){qg(n)||sy(e,t)}function M_(e,t,n,i){"a"===n.toLowerCase()?t.state=16:V_(e,t,i)}function L_(e,t,n,i){"i"===n.toLowerCase()?t.state=17:V_(e,t,i)}function N_(e,t,n,i){"l"===n.toLowerCase()?t.state=18:V_(e,t,i)}function B_(e,t,n,i){"t"===n.toLowerCase()?t.state=19:V_(e,t,i)}function F_(e,t,n,i){"o"===n.toLowerCase()?t.state=20:V_(e,t,i)}function U_(e,t,n){58===n?t.state=21:V_(e,t,n)}function k_(e,t,n){n_(n)?t.state=22:e.removeMachine(t)}function V_(e,t,n){46===n?t.state=23:64===n?t.state=24:n_(n)?t.state=22:e.removeMachine(t)}function z_(e,t,n){46===n||64===n?e.removeMachine(t):n_(n)?t.state=22:e.removeMachine(t)}function H_(e,t,n){Wg(n)?t.state=25:e.removeMachine(t)}function G_(e,t,n){46===n?t.state=27:45===n?t.state=26:Yg(n)||sy(e,t)}function W_(e,t,n){45===n||46===n?sy(e,t):Yg(n)?t.state=25:sy(e,t)}function Y_(e,t,n){46===n||45===n?sy(e,t):Wg(n)?(t.state=25,t.acceptStateReached=!0):sy(e,t)}function q_(e,t,n){o_(n)?(t.state=29,t.acceptStateReached=!0):e.removeMachine(t)}function j_(e,t,n){o_(n)||sy(e,t)}function Q_(e,t,n){c_(n)?(t.state=31,t.acceptStateReached=!0):e.removeMachine(t)}function X_(e,t,n){c_(n)||(Rg(n)?e.removeMachine(t):sy(e,t))}function K_(e,t,n,i){Pg(i)?t.state=38:(e.removeMachine(t),g_(e,n,i))}function $_(e,t,n,i){Pg(i)?t.state=33:e.removeMachine(t),g_(e,n,i)}function J_(e,t,n){Pg(n)?t.state=34:e.removeMachine(t)}function Z_(e,t,n){Pg(n)?t.state=35:e.removeMachine(t)}function ey(e,t,n){41===n?t.state=36:e.removeMachine(t)}function ty(e,t,n,i){Pg(i)?t.state=38:A_(i)?t.state=39:e.removeMachine(t)}function ny(e,t,n,i){var o=e.charIdx;t.acceptStateReached=!0,p_(i)?t.state=40:35===i?t.state=41:Pg(i)||(40===i?t.state=32:A_(i)?t.state=39:(sy(e,t),Hg(i)&&e.addMachine(ly(o,0))))}function iy(e,t,n,i){Pg(i)?t.state=38:40===i?t.state=32:(sy(e,t),g_(e,n,i))}function oy(e,t,n){p_(n)||(35===n?t.state=41:Pg(n)?t.state=38:sy(e,t))}function ry(e,t,n){p_(n)?t.state=40:Pg(n)?e.removeMachine(t):sy(e,t)}function sy(e,t){var n=e.matches,i=e.text,o=e.charIdx,r=e.tagBuilder,s=e.stripPrefix,a=e.stripTrailingSlash,c=e.decodePercentEncoding,l=e.hashtagServiceName,u=e.mentionServiceName;if(e.removeMachine(t),t.acceptStateReached){var d,h,A=t.startIdx,p=i.slice(t.startIdx,o);switch(p=function(e){for(var t={"(":0,"{":0,"[":0},n=0;n<e.length;n++){var i=e.charAt(n);Lg(r=e.charCodeAt(n))?t[i]++:Ng(r)&&t[cy[i]]--}for(var o=e.length-1;o>=0;){var r;if(i=e.charAt(o),Ng(r=e.charCodeAt(o))){var s=cy[i];if(!(t[s]<0))break;t[s]++,o--}else{if(!Mg(r))break;o--}}return e.slice(0,o+1)}(p),t.type){case 0:if(64===i.charCodeAt(t.startIdx-1))return;switch(t.matchType){case 0:var f=Fg.exec(p);if(f&&(A+=f.index,p=p.slice(f.index)),!function(e){if(kg.test(e))return!1;var t=e.match(Vg);if(!t)return!1;var n=!!t[1],i=t[2];return!!n||!(-1===i.indexOf(".")||!/[A-Za-z]/.test(i))}(p))return;break;case 1:if(!function(e){var t=e.match(zg);if(!t)return!1;var n=t[0].split(".");return!(n.length<2||!Qg(n[n.length-1]))}(p))return;break;case 2:if(!function(e){var t=e.split(Kg,1)[0];return Xg.test(t)}(p))return;break;default:Tg(t)}n.push(new Zg({tagBuilder:r,matchedText:p,offset:A,urlMatchType:ay(t.matchType),url:p,protocolRelativeMatch:"//"===p.slice(0,2),stripPrefix:s,stripTrailingSlash:a,decodePercentEncoding:c}));break;case 1:Qg(p.split(".").pop())&&n.push(new i_({tagBuilder:r,matchedText:p,offset:A,email:p.replace(e_,"")}));break;case 2:p.length<=140&&n.push(new s_({tagBuilder:r,matchedText:p,offset:A,serviceName:l,hashtag:p.slice(1)}));break;case 3:h=p,a_[u].test(h)&&n.push(new u_({tagBuilder:r,matchedText:p,offset:A,serviceName:u,mention:p.slice(1)}));break;case 4:if(("+"===(d=p=p.replace(/ +$/g,"")).charAt(0)||d_.test(d))&&h_.test(d)){var m=p.replace(/[^0-9,;#]/g,"");n.push(new f_({tagBuilder:r,matchedText:p,offset:A,number:m,plusSign:"+"===p.charAt(0)}))}break;default:Tg(t)}}}function ay(e){switch(e){case 0:return"scheme";case 1:return"tld";case 2:return"ipV4";default:Tg(e)}}var cy={")":"(","}":"{","]":"["};function ly(e,t){return{type:0,startIdx:e,state:t,acceptStateReached:!1,matchType:0}}function uy(e,t){return{type:0,startIdx:e,state:t,acceptStateReached:!1,matchType:1}}function dy(e,t){return{type:4,startIdx:e,state:t,acceptStateReached:!1}}function hy(e){return 0===e.type&&0===e.matchType}var Ay=function(e){void 0===e&&(e={}),this.idx=void 0!==e.idx?e.idx:-1,this.type=e.type||"tag",this.name=e.name||"",this.isOpening=!!e.isOpening,this.isClosing=!!e.isClosing},py=new Ay,fy=function(e,t){this.charIdx=0,this.state=0,this.currentDataIdx=0,this.currentTag=py,this.html=e,this.callbacks=t};function my(e,t){"<"===t&&Uy(e)}function gy(e,t,n){"!"===t?e.state=13:"/"===t?(e.state=2,e.currentTag=new Ay(gg(gg({},e.currentTag),{isClosing:!0}))):"<"===t?Uy(e):Ig(n)?(e.state=3,e.currentTag=new Ay(gg(gg({},e.currentTag),{isOpening:!0}))):(e.state=0,e.currentTag=py)}function _y(e,t,n){Og(n)?(e.currentTag=new Ay(gg(gg({},e.currentTag),{name:Vy(e)})),e.state=4):"<"===t?Uy(e):"/"===t?(e.currentTag=new Ay(gg(gg({},e.currentTag),{name:Vy(e)})),e.state=12):">"===t?(e.currentTag=new Ay(gg(gg({},e.currentTag),{name:Vy(e)})),ky(e)):Ig(n)||Pg(n)||":"===t||Fy(e)}function yy(e,t,n){">"===t?Fy(e):Ig(n)?e.state=3:Fy(e)}function vy(e,t,n){var i;Og(n)||("/"===t?e.state=12:">"===t?ky(e):"<"===t?Uy(e):"="===t||Dg(n)||(i=n)>=0&&i<=31||127==i?Fy(e):e.state=5)}function Ty(e,t,n){Og(n)?e.state=6:"/"===t?e.state=12:"="===t?e.state=7:">"===t?ky(e):"<"===t?Uy(e):Dg(n)&&Fy(e)}function by(e,t,n){Og(n)||("/"===t?e.state=12:"="===t?e.state=7:">"===t?ky(e):"<"===t?Uy(e):Dg(n)?Fy(e):e.state=5)}function wy(e,t,n){Og(n)||('"'===t?e.state=8:"'"===t?e.state=9:/[>=`]/.test(t)?Fy(e):"<"===t?Uy(e):e.state=10)}function xy(e,t){'"'===t&&(e.state=11)}function Cy(e,t){"'"===t&&(e.state=11)}function Ey(e,t,n){Og(n)?e.state=4:">"===t?ky(e):"<"===t&&Uy(e)}function Sy(e,t,n){Og(n)?e.state=4:"/"===t?e.state=12:">"===t?ky(e):"<"===t?Uy(e):(e.state=4,function(e){e.charIdx--}(e))}function Iy(e,t){">"===t?(e.currentTag=new Ay(gg(gg({},e.currentTag),{isClosing:!0})),ky(e)):Fy(e)}function Py(e){var t=e.html,n=e.charIdx;"--"===t.slice(n,n+2)?(e.charIdx++,e.currentTag=new Ay(gg(gg({},e.currentTag),{type:"comment"})),e.state=14):"DOCTYPE"===t.slice(n,n+7).toUpperCase()?(e.charIdx+=6,e.currentTag=new Ay(gg(gg({},e.currentTag),{type:"doctype"})),e.state=20):Fy(e)}function Dy(e,t){"-"===t?e.state=15:">"===t?Fy(e):e.state=16}function Oy(e,t){"-"===t?e.state=18:">"===t?Fy(e):e.state=16}function Ry(e,t){"-"===t&&(e.state=17)}function My(e,t){e.state="-"===t?18:16}function Ly(e,t){">"===t?ky(e):"!"===t?e.state=19:"-"===t||(e.state=16)}function Ny(e,t){"-"===t?e.state=17:">"===t?ky(e):e.state=16}function By(e,t){">"===t?ky(e):"<"===t&&Uy(e)}function Fy(e){e.state=0,e.currentTag=py}function Uy(e){e.state=1,e.currentTag=new Ay({idx:e.charIdx})}function ky(e){var t=e.html.slice(e.currentDataIdx,e.currentTag.idx);t&&e.callbacks.onText(t,e.currentDataIdx);var n=e.currentTag;"comment"===n.type?e.callbacks.onComment(n.idx):"doctype"===n.type?e.callbacks.onDoctype(n.idx):(n.isOpening&&e.callbacks.onOpenTag(n.name,n.idx),n.isClosing&&e.callbacks.onCloseTag(n.name,n.idx)),Fy(e),e.currentDataIdx=e.charIdx+1}function Vy(e){var t=e.currentTag.idx+(e.currentTag.isClosing?2:1);return e.html.slice(t,e.charIdx).toLowerCase()}function zy(e,t){return e.getOffset()-t.getOffset()}const Hy=function(){function e(t){var n,i;void 0===t&&(t={}),this.version=e.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.tagBuilder=null,this.urls=(null==(i=t.urls)&&(i=!0),yg(i)?{schemeMatches:i,tldMatches:i,ipV4Matches:i}:{schemeMatches:!yg(i.schemeMatches)||i.schemeMatches,tldMatches:!yg(i.tldMatches)||i.tldMatches,ipV4Matches:!yg(i.ipV4Matches)||i.ipV4Matches}),this.email=yg(t.email)?t.email:this.email,this.phone=yg(t.phone)?t.phone:this.phone,this.hashtag=t.hashtag||this.hashtag,this.mention=t.mention||this.mention,this.newWindow=yg(t.newWindow)?t.newWindow:this.newWindow,this.stripPrefix=(null==(n=t.stripPrefix)&&(n=!0),yg(n)?{scheme:n,www:n}:{scheme:!yg(n.scheme)||n.scheme,www:!yg(n.www)||n.www}),this.stripTrailingSlash=yg(t.stripTrailingSlash)?t.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding=yg(t.decodePercentEncoding)?t.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=t.sanitizeHtml||!1;var o=this.mention;if(!1!==o&&-1===l_.indexOf(o))throw new Error("invalid `mention` cfg '".concat(o,"' - see docs"));var r,s=this.hashtag;if(!1!==s&&-1===r_.indexOf(s))throw new Error("invalid `hashtag` cfg '".concat(s,"' - see docs"));this.truncate="number"==typeof(r=t.truncate)?{length:r,location:"end"}:gg({length:Number.POSITIVE_INFINITY,location:"end"},r),this.className=t.className||this.className,this.replaceFn=t.replaceFn||this.replaceFn,this.context=t.context||this}return e.link=function(t,n){return new e(n).link(t)},e.parse=function(t,n){return new e(n).parse(t)},e.prototype.parse=function(e){var t=this,n=["a","style","script"],i=0,o=[];return function(e,t){for(var n=new fy(e,t),i=e.length;n.charIdx<i;){var o=e.charAt(n.charIdx),r=e.charCodeAt(n.charIdx);switch(n.state){case 0:my(n,o);break;case 1:gy(n,o,r);break;case 2:yy(n,o,r);break;case 3:_y(n,o,r);break;case 4:vy(n,o,r);break;case 5:Ty(n,o,r);break;case 6:by(n,o,r);break;case 7:wy(n,o,r);break;case 8:xy(n,o);break;case 9:Cy(n,o);break;case 10:Ey(n,o,r);break;case 11:Sy(n,o,r);break;case 12:Iy(n,o);break;case 13:Py(n);break;case 14:Dy(n,o);break;case 15:Oy(n,o);break;case 16:Ry(n,o);break;case 17:My(n,o);break;case 18:Ly(n,o);break;case 19:Ny(n,o);break;case 20:By(n,o);break;default:Tg(n.state)}n.charIdx++}n.currentDataIdx<n.charIdx&&function(e){var t=e.html.slice(e.currentDataIdx,e.charIdx);e.callbacks.onText(t,e.currentDataIdx),e.currentDataIdx=e.charIdx+1}(n)}(e,{onOpenTag:function(e){n.indexOf(e)>=0&&i++},onText:function(e,n){if(0===i){var r=e.split(/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),s=n;r.forEach(function(e,n){if(n%2==0){var i=t.parseText(e,s);o.push.apply(o,function(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}([],function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}(i),!1))}s+=e.length})}},onCloseTag:function(e){n.indexOf(e)>=0&&(i=Math.max(i-1,0))},onComment:function(){},onDoctype:function(){}}),o=this.compactMatches(o),o=this.removeUnwantedMatches(o)},e.prototype.compactMatches=function(e){e.sort(zy);for(var t=0;t<e.length-1;){var n=e[t],i=n.getOffset(),o=n.getMatchedText().length;if(t+1<e.length&&e[t+1].getOffset()===i){var r=e[t+1].getMatchedText().length>o?t:t+1;e.splice(r,1)}else t++}return e},e.prototype.removeUnwantedMatches=function(e){return this.hashtag||vg(e,function(e){return"hashtag"===e.getType()}),this.email||vg(e,function(e){return"email"===e.getType()}),this.phone||vg(e,function(e){return"phone"===e.getType()}),this.mention||vg(e,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||vg(e,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.tldMatches||vg(e,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),this.urls.ipV4Matches||vg(e,function(e){return"url"===e.getType()&&"ipV4"===e.getUrlMatchType()}),e},e.prototype.parseText=function(e,t){t=t||0;for(var n=function(e,t){for(var n=new m_(e,t);n.charIdx<n.text.length;n.charIdx++){var i=e.charAt(n.charIdx),o=e.charCodeAt(n.charIdx);if(0===n.stateMachines.length)g_(n,i,o);else{for(var r=n.stateMachines.length-1;r>=0;r--){var s=n.stateMachines[r];switch(s.state){case 11:w_(n,s,o);break;case 12:x_(n,s,o);break;case 0:__(n,s,o);break;case 1:y_(n,s,o);break;case 2:v_(n,s,o);break;case 3:T_(n,s,o);break;case 4:b_(n,s,0,o);break;case 5:C_(n,s,o);break;case 6:E_(n,s,0,o);break;case 7:S_(n,s,0,o);break;case 13:I_(n,s,o);break;case 14:P_(n,s,o);break;case 8:D_(n,s,o);break;case 9:O_(n,s,o);break;case 10:R_(n,s,o);break;case 15:M_(n,s,i,o);break;case 16:L_(n,s,i,o);break;case 17:N_(n,s,i,o);break;case 18:B_(n,s,i,o);break;case 19:F_(n,s,i,o);break;case 20:U_(n,s,o);break;case 21:k_(n,s,o);break;case 22:V_(n,s,o);break;case 23:z_(n,s,o);break;case 24:H_(n,s,o);break;case 25:G_(n,s,o);break;case 26:W_(n,s,o);break;case 27:Y_(n,s,o);break;case 28:q_(n,s,o);break;case 29:j_(n,s,o);break;case 30:Q_(n,s,o);break;case 31:X_(n,s,o);break;case 32:$_(n,s,i,o);break;case 33:J_(n,s,o);break;case 34:Z_(n,s,o);break;case 35:ey(n,s,o);break;case 36:ty(n,s,0,o);break;case 37:K_(n,s,i,o);break;case 38:ny(n,s,0,o);break;case 39:iy(n,s,i,o);break;case 40:oy(n,s,o);break;case 41:ry(n,s,o);break;default:Tg(s.state)}}if(!n.hasSchemeUrlMachine()&&n.charIdx>0&&Hg(o)){var a=n.text.charCodeAt(n.charIdx-1);Hg(a)||n.addMachine(ly(n.charIdx,0))}}}for(var c=n.stateMachines.length-1;c>=0;c--)n.stateMachines.forEach(function(e){return sy(n,e)});return n.matches}(e,{tagBuilder:this.getTagBuilder(),stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding,hashtagServiceName:this.hashtag,mentionServiceName:this.mention||"twitter"}),i=0,o=n.length;i<o;i++)n[i].setOffset(t+n[i].getOffset());return n},e.prototype.link=function(e){if(!e)return"";this.sanitizeHtml&&(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var t=this.parse(e),n=new Array(2*t.length+1),i=0,o=0,r=t.length;o<r;o++){var s=t[o];n.push(e.substring(i,s.getOffset())),n.push(this.createMatchReturnVal(s)),i=s.getOffset()+s.getMatchedText().length}return n.push(e.substring(i)),n.join("")},e.prototype.createMatchReturnVal=function(e){var t;return this.replaceFn&&(t=this.replaceFn.call(this.context,e)),"string"==typeof t?t:!1===t?e.getMatchedText():t instanceof wg?t.toAnchorString():e.buildTag().toAnchorString()},e.prototype.getTagBuilder=function(){var e=this.tagBuilder;return e||(e=this.tagBuilder=new Eg({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),e},e.version="4.1.5",e}();let Gy;"undefined"!=typeof DOMParser&&(Gy=new DOMParser);const Wy=new Hy({stripPrefix:!1,email:!1,replaceFn:function(e,t){return"scheme"===t.urlMatchType||"www"===t.urlMatchType}}),Yy=2414016,qy=16093e3,jy={gpx:[null,void 0,"http://www.topografix.com/GPX/1/1"]};function Qy(e,t){let n=$y(e,"id");return n=(0,d.A)(n)?n:(0,E.A)(),t.getOrCreateEntity(n)}function Xy(e){const t=Ky(e,"lon"),n=Ky(e,"lat"),i=ev(e,"ele",jy.gpx);return j.A.fromDegrees(t,n,i)}function Ky(e,t){if(!(0,d.A)(e))return;const n=e.getAttribute(t);if(null!==n){const e=parseFloat(n);return isNaN(e)?void 0:e}}function $y(e,t){if(!(0,d.A)(e))return;const n=e.getAttribute(t);return null!==n?n:void 0}function Jy(e,t,n){if(!(0,d.A)(e))return;const i=e.childNodes,o=i.length;for(let e=0;e<o;e++){const o=i[e];if(o.localName===t&&-1!==n.indexOf(o.namespaceURI))return o}}function Zy(e,t,n){if(!(0,d.A)(e))return;const i=[],o=e.getElementsByTagName(t),r=o.length;for(let e=0;e<r;e++){const r=o[e];r.localName===t&&-1!==n.indexOf(r.namespaceURI)&&i.push(r)}return i}function ev(e,t,n){const i=Jy(e,t,n);if((0,d.A)(i)){const e=parseFloat(i.textContent);return isNaN(e)?void 0:e}}function tv(e,t,n){const i=Jy(e,t,n);if((0,d.A)(i))return i.textContent.trim()}function nv(e){const t=new Bt.A;return t.width=32,t.height=32,t.scaleByDistance=new kt.A(Yy,1,qy,.1),t.pixelOffsetScaleByDistance=new kt.A(Yy,1,qy,.1),t.verticalOrigin=new Vn.A(Ht.A.BOTTOM),t.image=e,t}function iv(e){const t=new Ua.A;return t.width=4,t.material=new Ga,t.material.color=(0,d.A)(e)?e:u.A.RED,t.material.outlineWidth=2,t.material.outlineColor=u.A.BLACK,t}const ov={time:{text:"Time",tag:"time"},comment:{text:"Comment",tag:"cmt"},description:{text:"Description",tag:"desc"},source:{text:"Source",tag:"src"},number:{text:"GPS track/route number",tag:"number"},type:{text:"Type",tag:"type"}};let rv;function sv(e,t){let n,i="";const o=Object.keys(ov),r=o.length;for(n=0;n<r;n++){const t=o[n],r=ov[t];r.value=tv(e,r.tag,jy.gpx)??"",(0,d.A)(r.value)&&""!==r.value&&(i=`${i}<p>${r.text}: ${r.value}</p>`)}if(!(0,d.A)(i)||""===i)return;i=Wy.link(i),rv.innerHTML=i;const s=rv.querySelectorAll("a");for(n=0;n<s.length;n++)s[n].setAttribute("target","_blank");const a=u.A.WHITE,c=u.A.BLACK;let l='<div class="cesium-infoBox-description-lighter" style="';return l+="overflow:auto;",l+="word-wrap:break-word;",l+=`background-color:${a.toCssColorString()};`,l+=`color:${c.toCssColorString()};`,l+='">',l+=`${rv.innerHTML}</div>`,rv.innerHTML="",l}function av(e,t,n,i){const o=Xy(t),r=Qy(t,n);r.position=o;const s=(0,d.A)(i.waypointImage)?i.waypointImage:e._pinBuilder.fromMakiIconId("marker",u.A.RED,32);r.billboard=nv(s);const a=tv(t,"name",jy.gpx);r.name=a,r.label=function(){const e=new xa.A;return e.translucencyByDistance=new kt.A(3e6,1,5e6,0),e.pixelOffset=new q.A(17,0),e.horizontalOrigin=zt.A.LEFT,e.font="16px sans-serif",e.style=oa.A.FILL_AND_OUTLINE,e}(),r.label.text=a,r.description=sv(t),i.clampToGround&&(r.billboard.heightReference=Vt.Ay.CLAMP_TO_GROUND,r.label.heightReference=Vt.Ay.CLAMP_TO_GROUND)}function cv(e){const t={positions:[],times:[]},n=Zy(e,"trkpt",jy.gpx);let i;for(let e=0;e<n.length;e++){const o=Xy(n[e]);t.positions.push(o),i=tv(n[e],"time",jy.gpx),(0,d.A)(i)&&t.times.push(te.A.fromIso8601(i))}return t}function lv(e){const t=Jy(e,"author",jy.gpx);if((0,d.A)(t)){const e={name:tv(t,"name",jy.gpx),email:uv(t),link:dv(t)};if((0,d.A)(e.name)||(0,d.A)(e.email)||(0,d.A)(e.link))return e}}function uv(e){const t=Jy(e,"email",jy.gpx);if((0,d.A)(t))return`${tv(t,"id",jy.gpx)}@${tv(t,"domain",jy.gpx)}`}function dv(e){const t=Jy(e,"link",jy.gpx);if((0,d.A)(t)){const e={href:$y(t,"href"),text:tv(t,"text",jy.gpx),mimeType:tv(t,"type",jy.gpx)};if((0,d.A)(e.href)||(0,d.A)(e.text)||(0,d.A)(e.mimeType))return e}}function hv(e){const t=Jy(e,"copyright",jy.gpx);if((0,d.A)(t)){const e={author:$y(t,"author"),year:tv(t,"year",jy.gpx),license:tv(t,"license",jy.gpx)};if((0,d.A)(e.author)||(0,d.A)(e.year)||(0,d.A)(e.license))return e}}function Av(e){const t=Jy(e,"bounds",jy.gpx);if((0,d.A)(t)){const e={minLat:ev(t,"minlat",jy.gpx),maxLat:ev(t,"maxlat",jy.gpx),minLon:ev(t,"minlon",jy.gpx),maxLon:ev(t,"maxlon",jy.gpx)};if((0,d.A)(e.minLat)||(0,d.A)(e.maxLat)||(0,d.A)(e.minLon)||(0,d.A)(e.maxLon))return e}}"undefined"!=typeof document&&(rv=document.createElement("div"));const pv={wpt:av,rte:function(e,t,n,i){const o=Qy(t,n);o.description=sv(t);const r=Zy(t,"rtept",jy.gpx),s=new Array(r.length);for(let t=0;t<r.length;t++)av(e,r[t],n,i),s[t]=Xy(r[t]);o.polyline=iv(i.routeColor),i.clampToGround&&(o.polyline.clampToGround=!0),o.polyline.positions=s},trk:function(e,t,n,i){const o=Qy(t,n);o.description=sv(t);const r=Zy(t,"trkseg",jy.gpx);let s,a=[],c=[],l=!0;const h=new mc;for(let e=0;e<r.length;e++)s=cv(r[e]),a=a.concat(s.positions),s.times.length>0?(c=c.concat(s.times),h.addSamples(c,a),l=l&&!0):l=!1;if(l){const t=(0,d.A)(i.waypointImage)?i.waypointImage:e._pinBuilder.fromMakiIconId("marker",u.A.RED,32);o.billboard=nv(t),o.position=h,i.clampToGround&&(o.billboard.heightReference=Vt.Ay.CLAMP_TO_GROUND),o.availability=new oo,o.availability.addInterval(new ji.A({start:c[0],stop:c[c.length-1]}))}o.polyline=iv(i.trackColor),o.polyline.positions=a,i.clampToGround&&(o.polyline.clampToGround=!0)}};function fv(e,t,n){const i=e._entityCollection;i.removeAll();const o=t.documentElement,r=$y(o,"version"),s=$y(o,"creator");let a;const c=function(e){const t=Jy(e,"metadata",jy.gpx);if((0,d.A)(t)){const e={name:tv(t,"name",jy.gpx),desc:tv(t,"desc",jy.gpx),author:lv(t),copyright:hv(t),link:dv(t),time:tv(t,"time",jy.gpx),keywords:tv(t,"keywords",jy.gpx),bounds:Av(t)};if((0,d.A)(e.name)||(0,d.A)(e.desc)||(0,d.A)(e.author)||(0,d.A)(e.copyright)||(0,d.A)(e.link)||(0,d.A)(e.time)||(0,d.A)(e.keywords)||(0,d.A)(e.bounds))return e}}(o);let l;(0,d.A)(c)&&(a=c.name),"gpx"===o.localName?function(e,t,n,i){const o=Object.keys(pv),r=o.length;for(let s=0;s<r;s++){const r=o[s],a=pv[r],c=t.childNodes,l=c.length;for(let t=0;t<l;t++){const o=c[t];o.localName===r&&-1!==jy.gpx.indexOf(o.namespaceURI)&&a(e,o,n,i)}}}(e,o,i,n):console.log(`GPX - Unsupported node: ${o.localName}`);const u=i.computeAvailability();let h=u.start,A=u.stop;const p=te.A.equals(h,Tn.A.MINIMUM_VALUE),f=te.A.equals(A,Tn.A.MAXIMUM_VALUE);if(!p||!f){let e;p&&(e=new Date,e.setHours(0,0,0,0),h=te.A.fromDate(e)),f&&(e=new Date,e.setHours(24,0,0,0),A=te.A.fromDate(e)),l=new ha,l.startTime=h,l.stopTime=A,l.currentTime=te.A.clone(h),l.clockRange=Hs.LOOP_STOP,l.clockStep=Gs.SYSTEM_CLOCK_MULTIPLIER,l.multiplier=Math.round(Math.min(Math.max(te.A.secondsDifference(A,h)/60,1),31556900))}let m=!1;return e._name!==a&&(e._name=a,m=!0),e._creator!==s&&(e._creator=s,m=!0),g=e._metadata,_=c,!(!(0,d.A)(g)&&!(0,d.A)(_)||(0,d.A)(g)&&(0,d.A)(_)&&g.name===_.name&&g.dec===_.desc&&g.src===_.src&&g.author===_.author&&g.copyright===_.copyright&&g.link===_.link&&g.time===_.time&&g.bounds===_.bounds)&&(e._metadata=c,m=!0),e._version!==r&&(e._version=r,m=!0),l!==e._clock&&(m=!0,e._clock=l),m&&e._changed.raiseEvent(e),sa.A.setLoading(e,!1),e;var g,_}function mv(){this._changed=new Bn.A,this._error=new Bn.A,this._loading=new Bn.A,this._clock=void 0,this._entityCollection=new Ri.A(this),this._entityCluster=new fa.A,this._name=void 0,this._version=void 0,this._creator=void 0,this._metadata=void 0,this._isLoading=!1,this._pinBuilder=new pg.A}mv.load=function(e,t){return(new mv).load(e,t)},Object.defineProperties(mv.prototype,{name:{get:function(){return this._name}},version:{get:function(){return this._version}},creator:{get:function(){return this._creator}},metadata:{get:function(){return this._metadata}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!(0,d.A)(e))throw new A.A("value must be defined.");this._entityCluster=e}}}),mv.prototype.update=function(e){return!0},mv.prototype.load=function(e,t){if(!(0,d.A)(e))throw new A.A("data is required.");t=t??S.A.EMPTY_OBJECT,sa.A.setLoading(this,!0);const n=this._name,i=this;return function(e,t,n,i){i=i??S.A.EMPTY_OBJECT;let o=n;if("string"==typeof n||n instanceof Lt.A){o=(n=Lt.A.createIfNeeded(n)).fetchBlob();const t=e._resourceCredits,i=n.credits;if((0,d.A)(i)){const e=i.length;for(let n=0;n<e;n++)t.push(i[n])}}return Promise.resolve(o).then(function(t){return t instanceof Blob?(n=t,new Promise((e,t)=>{const i=new FileReader;i.addEventListener("load",function(){e(i.result)}),i.addEventListener("error",function(){t(i.error)}),i.readAsText(n)})).then(function(t){let n,o;try{n=Gy.parseFromString(t,"application/xml")}catch(e){o=e.toString()}if((0,d.A)(o)||n.body||"parsererror"===n.documentElement.tagName){let e=(0,d.A)(o)?o:n.documentElement.firstChild.nodeValue;throw e||(e=n.body.innerText),new M.A(e)}return fv(e,n,i)}):fv(e,t,i);var n}).catch(function(t){return e._error.raiseEvent(e,t),console.log(t),Promise.reject(t)})}(this,this._entityCollection,e,t).then(function(){let e;const t=i._entityCollection.computeAvailability();let o=t.start,r=t.stop;const s=te.A.equals(o,Tn.A.MINIMUM_VALUE),a=te.A.equals(r,Tn.A.MAXIMUM_VALUE);if(!s||!a){let t;s&&(t=new Date,t.setHours(0,0,0,0),o=te.A.fromDate(t)),a&&(t=new Date,t.setHours(24,0,0,0),r=te.A.fromDate(t)),e=new ha,e.startTime=o,e.stopTime=r,e.currentTime=te.A.clone(o),e.clockRange=Hs.LOOP_STOP,e.clockStep=Gs.SYSTEM_CLOCK_MULTIPLIER,e.multiplier=Math.round(Math.min(Math.max(te.A.secondsDifference(r,o)/60,1),31556900))}let c=!1;return e!==i._clock&&(i._clock=e,c=!0),n!==i._name&&(c=!0),c&&i._changed.raiseEvent(i),sa.A.setLoading(i,!1),i}).catch(function(e){return sa.A.setLoading(i,!1),i._error.raiseEvent(i,e),console.log(e),Promise.reject(e)})};const gv=mv,_v=function(e,t){this.position=e,this.headingPitchRoll=t};var yv=n(303578),vv=n(345563),Tv=n(510986),bv=n(953612),wv=n(548249),xv=n(612933);const Cv=-2;function Ev(e){return Sv(e.map(([e,t])=>new Array(e).fill(t,0,e)))}function Sv(e){return e.reduce((e,t)=>e.concat(Array.isArray(t)?Sv(t):t),[])}const Iv=[0,1,2,3].concat(...Ev([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function Pv(){const e=this;function t(e,t){let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}e.build_tree=function(n){const i=e.dyn_tree,o=e.stat_desc.static_tree,r=e.stat_desc.elems;let s,a,c,l=-1;for(n.heap_len=0,n.heap_max=573,s=0;s<r;s++)0!==i[2*s]?(n.heap[++n.heap_len]=l=s,n.depth[s]=0):i[2*s+1]=0;for(;n.heap_len<2;)c=n.heap[++n.heap_len]=l<2?++l:0,i[2*c]=1,n.depth[c]=0,n.opt_len--,o&&(n.static_len-=o[2*c+1]);for(e.max_code=l,s=Math.floor(n.heap_len/2);s>=1;s--)n.pqdownheap(i,s);c=r;do{s=n.heap[1],n.heap[1]=n.heap[n.heap_len--],n.pqdownheap(i,1),a=n.heap[1],n.heap[--n.heap_max]=s,n.heap[--n.heap_max]=a,i[2*c]=i[2*s]+i[2*a],n.depth[c]=Math.max(n.depth[s],n.depth[a])+1,i[2*s+1]=i[2*a+1]=c,n.heap[1]=c++,n.pqdownheap(i,1)}while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],function(t){const n=e.dyn_tree,i=e.stat_desc.static_tree,o=e.stat_desc.extra_bits,r=e.stat_desc.extra_base,s=e.stat_desc.max_length;let a,c,l,u,d,h,A=0;for(u=0;u<=15;u++)t.bl_count[u]=0;for(n[2*t.heap[t.heap_max]+1]=0,a=t.heap_max+1;a<573;a++)c=t.heap[a],u=n[2*n[2*c+1]+1]+1,u>s&&(u=s,A++),n[2*c+1]=u,c>e.max_code||(t.bl_count[u]++,d=0,c>=r&&(d=o[c-r]),h=n[2*c],t.opt_len+=h*(u+d),i&&(t.static_len+=h*(i[2*c+1]+d)));if(0!==A){do{for(u=s-1;0===t.bl_count[u];)u--;t.bl_count[u]--,t.bl_count[u+1]+=2,t.bl_count[s]--,A-=2}while(A>0);for(u=s;0!==u;u--)for(c=t.bl_count[u];0!==c;)l=t.heap[--a],l>e.max_code||(n[2*l+1]!=u&&(t.opt_len+=(u-n[2*l+1])*n[2*l],n[2*l+1]=u),c--)}}(n),function(e,n,i){const o=[];let r,s,a,c=0;for(r=1;r<=15;r++)o[r]=c=c+i[r-1]<<1;for(s=0;s<=n;s++)a=e[2*s+1],0!==a&&(e[2*s]=t(o[a]++,a))}(i,e.max_code,n.bl_count)}}function Dv(e,t,n,i,o){const r=this;r.static_tree=e,r.extra_bits=t,r.extra_base=n,r.elems=i,r.max_length=o}Pv._length_code=[0,1,2,3,4,5,6,7].concat(...Ev([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]])),Pv.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],Pv.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],Pv.d_code=function(e){return e<256?Iv[e]:Iv[256+(e>>>7)]},Pv.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Pv.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Pv.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Pv.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];const Ov=Ev([[144,8],[112,9],[24,7],[8,8]]);Dv.static_ltree=Sv([12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511,0,64,32,96,16,80,48,112,8,72,40,104,24,88,56,120,4,68,36,100,20,84,52,116,3,131,67,195,35,163,99,227].map((e,t)=>[e,Ov[t]]));const Rv=Ev([[30,5]]);function Mv(e,t,n,i,o){const r=this;r.good_length=e,r.max_lazy=t,r.nice_length=n,r.max_chain=i,r.func=o}Dv.static_dtree=Sv([0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23].map((e,t)=>[e,Rv[t]])),Dv.static_l_desc=new Dv(Dv.static_ltree,Pv.extra_lbits,257,286,15),Dv.static_d_desc=new Dv(Dv.static_dtree,Pv.extra_dbits,0,30,15),Dv.static_bl_desc=new Dv(null,Pv.extra_blbits,0,19,7);const Lv=[new Mv(0,0,0,0,0),new Mv(4,4,8,4,1),new Mv(4,5,16,8,1),new Mv(4,6,32,32,1),new Mv(4,4,16,16,2),new Mv(8,16,32,32,2),new Mv(8,16,128,128,2),new Mv(8,32,128,256,2),new Mv(32,128,258,1024,2),new Mv(32,258,258,4096,2)],Nv=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],Bv=113,Fv=666,Uv=262;function kv(e,t,n,i){const o=e[2*t],r=e[2*n];return o<r||o==r&&i[t]<=i[n]}function Vv(){const e=this;let t,n,i,o,r,s,a,c,l,u,d,h,A,p,f,m,g,_,y,v,T,b,w,x,C,E,S,I,P,D,O,R,M;const L=new Pv,N=new Pv,B=new Pv;let F,U,k,V,z,H;function G(){let t;for(t=0;t<286;t++)O[2*t]=0;for(t=0;t<30;t++)R[2*t]=0;for(t=0;t<19;t++)M[2*t]=0;O[512]=1,e.opt_len=e.static_len=0,U=k=0}function W(e,t){let n,i=-1,o=e[1],r=0,s=7,a=4;0===o&&(s=138,a=3),e[2*(t+1)+1]=65535;for(let c=0;c<=t;c++)n=o,o=e[2*(c+1)+1],++r<s&&n==o||(r<a?M[2*n]+=r:0!==n?(n!=i&&M[2*n]++,M[32]++):r<=10?M[34]++:M[36]++,r=0,i=n,0===o?(s=138,a=3):n==o?(s=6,a=3):(s=7,a=4))}function Y(t){e.pending_buf[e.pending++]=t}function q(e){Y(255&e),Y(e>>>8&255)}function j(e,t){let n;const i=t;H>16-i?(n=e,z|=n<<H&65535,q(z),z=n>>>16-H,H+=i-16):(z|=e<<H&65535,H+=i)}function Q(e,t){const n=2*e;j(65535&t[n],65535&t[n+1])}function X(e,t){let n,i,o=-1,r=e[1],s=0,a=7,c=4;for(0===r&&(a=138,c=3),n=0;n<=t;n++)if(i=r,r=e[2*(n+1)+1],!(++s<a&&i==r)){if(s<c)do{Q(i,M)}while(0!==--s);else 0!==i?(i!=o&&(Q(i,M),s--),Q(16,M),j(s-3,2)):s<=10?(Q(17,M),j(s-3,3)):(Q(18,M),j(s-11,7));s=0,o=i,0===r?(a=138,c=3):i==r?(a=6,c=3):(a=7,c=4)}}function K(){16==H?(q(z),z=0,H=0):H>=8&&(Y(255&z),z>>>=8,H-=8)}function $(t,n){let i,o,r;if(e.dist_buf[U]=t,e.lc_buf[U]=255&n,U++,0===t?O[2*n]++:(k++,t--,O[2*(Pv._length_code[n]+256+1)]++,R[2*Pv.d_code(t)]++),!(8191&U)&&S>2){for(i=8*U,o=T-g,r=0;r<30;r++)i+=R[2*r]*(5+Pv.extra_dbits[r]);if(i>>>=3,k<Math.floor(U/2)&&i<Math.floor(o/2))return!0}return U==F-1}function J(t,n){let i,o,r,s,a=0;if(0!==U)do{i=e.dist_buf[a],o=e.lc_buf[a],a++,0===i?Q(o,t):(r=Pv._length_code[o],Q(r+256+1,t),s=Pv.extra_lbits[r],0!==s&&(o-=Pv.base_length[r],j(o,s)),i--,r=Pv.d_code(i),Q(r,n),s=Pv.extra_dbits[r],0!==s&&(i-=Pv.base_dist[r],j(i,s)))}while(a<U);Q(256,t),V=t[513]}function Z(){H>8?q(z):H>0&&Y(255&z),z=0,H=0}function ee(t,n,i){j(0+(i?1:0),3),function(t,n){Z(),V=8,q(n),q(~n),e.pending_buf.set(c.subarray(t,t+n),e.pending),e.pending+=n}(t,n)}function te(n){(function(t,n,i){let o,r,s=0;S>0?(L.build_tree(e),N.build_tree(e),s=function(){let t;for(W(O,L.max_code),W(R,N.max_code),B.build_tree(e),t=18;t>=3&&0===M[2*Pv.bl_order[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(),o=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,r<=o&&(o=r)):o=r=n+5,n+4<=o&&-1!=t?ee(t,n,i):r==o?(j(2+(i?1:0),3),J(Dv.static_ltree,Dv.static_dtree)):(j(4+(i?1:0),3),function(e,t,n){let i;for(j(e-257,5),j(t-1,5),j(n-4,4),i=0;i<n;i++)j(M[2*Pv.bl_order[i]+1],3);X(O,e-1),X(R,t-1)}(L.max_code+1,N.max_code+1,s+1),J(O,R)),G(),i&&Z()})(g>=0?g:-1,T-g,n),g=T,t.flush_pending()}function ne(){let e,n,i,o;do{if(o=l-w-T,0===o&&0===T&&0===w)o=r;else if(-1==o)o--;else if(T>=r+r-Uv){c.set(c.subarray(r,r+r),0),b-=r,T-=r,g-=r,e=A,i=e;do{n=65535&d[--i],d[i]=n>=r?n-r:0}while(0!==--e);e=r,i=e;do{n=65535&u[--i],u[i]=n>=r?n-r:0}while(0!==--e);o+=r}if(0===t.avail_in)return;e=t.read_buf(c,T+w,o),w+=e,w>=3&&(h=255&c[T],h=(h<<m^255&c[T+1])&f)}while(w<Uv&&0!==t.avail_in)}function ie(e){let t,n,i=C,o=T,s=x;const l=T>r-Uv?T-(r-Uv):0;let d=D;const h=a,A=T+258;let p=c[o+s-1],f=c[o+s];x>=P&&(i>>=2),d>w&&(d=w);do{if(t=e,c[t+s]==f&&c[t+s-1]==p&&c[t]==c[o]&&c[++t]==c[o+1]){o+=2,t++;do{}while(c[++o]==c[++t]&&c[++o]==c[++t]&&c[++o]==c[++t]&&c[++o]==c[++t]&&c[++o]==c[++t]&&c[++o]==c[++t]&&c[++o]==c[++t]&&c[++o]==c[++t]&&o<A);if(n=258-(A-o),o=A-258,n>s){if(b=e,s=n,n>=d)break;p=c[o+s-1],f=c[o+s]}}}while((e=65535&u[e&h])>l&&0!==--i);return s<=w?s:w}e.depth=[],e.bl_count=[],e.heap=[],O=[],R=[],M=[],e.pqdownheap=function(t,n){const i=e.heap,o=i[n];let r=n<<1;for(;r<=e.heap_len&&(r<e.heap_len&&kv(t,i[r+1],i[r],e.depth)&&r++,!kv(t,o,i[r],e.depth));)i[n]=i[r],n=r,r<<=1;i[n]=o},e.deflateInit=function(t,y,b,U,k,W){return U||(U=8),k||(k=8),W||(W=0),t.msg=null,-1==y&&(y=6),k<1||k>9||8!=U||b<9||b>15||y<0||y>9||W<0||W>2?Cv:(t.dstate=e,s=b,r=1<<s,a=r-1,p=k+7,A=1<<p,f=A-1,m=Math.floor((p+3-1)/3),c=new Uint8Array(2*r),u=[],d=[],F=1<<k+6,e.pending_buf=new Uint8Array(4*F),i=4*F,e.dist_buf=new Uint16Array(F),e.lc_buf=new Uint8Array(F),S=y,I=W,function(t){return t.total_in=t.total_out=0,t.msg=null,e.pending=0,e.pending_out=0,n=Bv,o=0,L.dyn_tree=O,L.stat_desc=Dv.static_l_desc,N.dyn_tree=R,N.stat_desc=Dv.static_d_desc,B.dyn_tree=M,B.stat_desc=Dv.static_bl_desc,z=0,H=0,V=8,G(),function(){l=2*r,d[A-1]=0;for(let e=0;e<A-1;e++)d[e]=0;E=Lv[S].max_lazy,P=Lv[S].good_length,D=Lv[S].nice_length,C=Lv[S].max_chain,T=0,g=0,w=0,_=x=2,v=0,h=0}(),0}(t))},e.deflateEnd=function(){return 42!=n&&n!=Bv&&n!=Fv?Cv:(e.lc_buf=null,e.dist_buf=null,e.pending_buf=null,d=null,u=null,c=null,e.dstate=null,n==Bv?-3:0)},e.deflateParams=function(e,t,n){let i=0;return-1==t&&(t=6),t<0||t>9||n<0||n>2?Cv:(Lv[S].func!=Lv[t].func&&0!==e.total_in&&(i=e.deflate(1)),S!=t&&(S=t,E=Lv[S].max_lazy,P=Lv[S].good_length,D=Lv[S].nice_length,C=Lv[S].max_chain),I=n,i)},e.deflateSetDictionary=function(e,t,i){let o,s=i,l=0;if(!t||42!=n)return Cv;if(s<3)return 0;for(s>r-Uv&&(s=r-Uv,l=i-s),c.set(t.subarray(l,l+s),0),T=s,g=s,h=255&c[0],h=(h<<m^255&c[1])&f,o=0;o<=s-3;o++)h=(h<<m^255&c[o+2])&f,u[o&a]=d[h],d[h]=o;return 0},e.deflate=function(l,p){let C,P,D,O,R;if(p>4||p<0)return Cv;if(!l.next_out||!l.next_in&&0!==l.avail_in||n==Fv&&4!=p)return l.msg=Nv[4],Cv;if(0===l.avail_out)return l.msg=Nv[7],-5;var M;if(t=l,O=o,o=p,42==n&&(P=8+(s-8<<4)<<8,D=(S-1&255)>>1,D>3&&(D=3),P|=D<<6,0!==T&&(P|=32),P+=31-P%31,n=Bv,Y((M=P)>>8&255),Y(255&M)),0!==e.pending){if(t.flush_pending(),0===t.avail_out)return o=-1,0}else if(0===t.avail_in&&p<=O&&4!=p)return t.msg=Nv[7],-5;if(n==Fv&&0!==t.avail_in)return l.msg=Nv[7],-5;if(0!==t.avail_in||0!==w||0!=p&&n!=Fv){switch(R=-1,Lv[S].func){case 0:R=function(e){let n,o=65535;for(o>i-5&&(o=i-5);;){if(w<=1){if(ne(),0===w&&0==e)return 0;if(0===w)break}if(T+=w,w=0,n=g+o,(0===T||T>=n)&&(w=T-n,T=n,te(!1),0===t.avail_out))return 0;if(T-g>=r-Uv&&(te(!1),0===t.avail_out))return 0}return te(4==e),0===t.avail_out?4==e?2:0:4==e?3:1}(p);break;case 1:R=function(e){let n,i=0;for(;;){if(w<Uv){if(ne(),w<Uv&&0==e)return 0;if(0===w)break}if(w>=3&&(h=(h<<m^255&c[T+2])&f,i=65535&d[h],u[T&a]=d[h],d[h]=T),0!==i&&(T-i&65535)<=r-Uv&&2!=I&&(_=ie(i)),_>=3)if(n=$(T-b,_-3),w-=_,_<=E&&w>=3){_--;do{T++,h=(h<<m^255&c[T+2])&f,i=65535&d[h],u[T&a]=d[h],d[h]=T}while(0!==--_);T++}else T+=_,_=0,h=255&c[T],h=(h<<m^255&c[T+1])&f;else n=$(0,255&c[T]),w--,T++;if(n&&(te(!1),0===t.avail_out))return 0}return te(4==e),0===t.avail_out?4==e?2:0:4==e?3:1}(p);break;case 2:R=function(e){let n,i,o=0;for(;;){if(w<Uv){if(ne(),w<Uv&&0==e)return 0;if(0===w)break}if(w>=3&&(h=(h<<m^255&c[T+2])&f,o=65535&d[h],u[T&a]=d[h],d[h]=T),x=_,y=b,_=2,0!==o&&x<E&&(T-o&65535)<=r-Uv&&(2!=I&&(_=ie(o)),_<=5&&(1==I||3==_&&T-b>4096)&&(_=2)),x>=3&&_<=x){i=T+w-3,n=$(T-1-y,x-3),w-=x-1,x-=2;do{++T<=i&&(h=(h<<m^255&c[T+2])&f,o=65535&d[h],u[T&a]=d[h],d[h]=T)}while(0!==--x);if(v=0,_=2,T++,n&&(te(!1),0===t.avail_out))return 0}else if(0!==v){if(n=$(0,255&c[T-1]),n&&te(!1),T++,w--,0===t.avail_out)return 0}else v=1,T++,w--}return 0!==v&&(n=$(0,255&c[T-1]),v=0),te(4==e),0===t.avail_out?4==e?2:0:4==e?3:1}(p)}if(2!=R&&3!=R||(n=Fv),0==R||2==R)return 0===t.avail_out&&(o=-1),0;if(1==R){if(1==p)j(2,3),Q(256,Dv.static_ltree),K(),1+V+10-H<9&&(j(2,3),Q(256,Dv.static_ltree),K()),V=7;else if(ee(0,0,!1),3==p)for(C=0;C<A;C++)d[C]=0;if(t.flush_pending(),0===t.avail_out)return o=-1,0}}return 4!=p?0:1}}function zv(){const e=this;e.next_in_index=0,e.next_out_index=0,e.avail_in=0,e.total_in=0,e.avail_out=0,e.total_out=0}zv.prototype={deflateInit(e,t){const n=this;return n.dstate=new Vv,t||(t=15),n.dstate.deflateInit(n,e,t)},deflate(e){const t=this;return t.dstate?t.dstate.deflate(t,e):Cv},deflateEnd(){const e=this;if(!e.dstate)return Cv;const t=e.dstate.deflateEnd();return e.dstate=null,t},deflateParams(e,t){const n=this;return n.dstate?n.dstate.deflateParams(n,e,t):Cv},deflateSetDictionary(e,t){const n=this;return n.dstate?n.dstate.deflateSetDictionary(n,e,t):Cv},read_buf(e,t,n){const i=this;let o=i.avail_in;return o>n&&(o=n),0===o?0:(i.avail_in-=o,e.set(i.next_in.subarray(i.next_in_index,i.next_in_index+o),t),i.next_in_index+=o,i.total_in+=o,o)},flush_pending(){const e=this;let t=e.dstate.pending;t>e.avail_out&&(t=e.avail_out),0!==t&&(e.next_out.set(e.dstate.pending_buf.subarray(e.dstate.pending_out,e.dstate.pending_out+t),e.next_out_index),e.next_out_index+=t,e.dstate.pending_out+=t,e.total_out+=t,e.avail_out-=t,e.dstate.pending-=t,0===e.dstate.pending&&(e.dstate.pending_out=0))}};const Hv=-2,Gv=-3,Wv=-5,Yv=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],qv=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],jv=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],Qv=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Xv=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],Kv=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],$v=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];function Jv(){let e,t,n,i,o,r;function s(e,t,s,a,c,l,u,d,h,A,p){let f,m,g,_,y,v,T,b,w,x,C,E,S,I,P;x=0,y=s;do{n[e[t+x]]++,x++,y--}while(0!==y);if(n[0]==s)return u[0]=-1,d[0]=0,0;for(b=d[0],v=1;v<=15&&0===n[v];v++);for(T=v,b<v&&(b=v),y=15;0!==y&&0===n[y];y--);for(g=y,b>y&&(b=y),d[0]=b,I=1<<v;v<y;v++,I<<=1)if((I-=n[v])<0)return Gv;if((I-=n[y])<0)return Gv;for(n[y]+=I,r[1]=v=0,x=1,S=2;0!==--y;)r[S]=v+=n[x],S++,x++;y=0,x=0;do{0!==(v=e[t+x])&&(p[r[v]++]=y),x++}while(++y<s);for(s=r[g],r[0]=y=0,x=0,_=-1,E=-b,o[0]=0,C=0,P=0;T<=g;T++)for(f=n[T];0!==f--;){for(;T>E+b;){if(_++,E+=b,P=g-E,P=P>b?b:P,(m=1<<(v=T-E))>f+1&&(m-=f+1,S=T,v<P))for(;++v<P&&!((m<<=1)<=n[++S]);)m-=n[S];if(P=1<<v,A[0]+P>1440)return Gv;o[_]=C=A[0],A[0]+=P,0!==_?(r[_]=y,i[0]=v,i[1]=b,v=y>>>E-b,i[2]=C-o[_-1]-v,h.set(i,3*(o[_-1]+v))):u[0]=C}for(i[1]=T-E,x>=s?i[0]=192:p[x]<a?(i[0]=p[x]<256?0:96,i[2]=p[x++]):(i[0]=l[p[x]-a]+16+64,i[2]=c[p[x++]-a]),m=1<<T-E,v=y>>>E;v<P;v+=m)h.set(i,3*(C+v));for(v=1<<T-1;0!==(y&v);v>>>=1)y^=v;for(y^=v,w=(1<<E)-1;(y&w)!=r[_];)_--,E-=b,w=(1<<E)-1}return 0!==I&&1!=g?Wv:0}function a(s){let a;for(e||(e=[],t=[],n=new Int32Array(16),i=[],o=new Int32Array(15),r=new Int32Array(16)),t.length<s&&(t=[]),a=0;a<s;a++)t[a]=0;for(a=0;a<16;a++)n[a]=0;for(a=0;a<3;a++)i[a]=0;o.set(n.subarray(0,15),0),r.set(n.subarray(0,16),0)}this.inflate_trees_bits=function(n,i,o,r,c){let l;return a(19),e[0]=0,l=s(n,0,19,19,null,null,o,i,r,e,t),l==Gv?c.msg="oversubscribed dynamic bit lengths tree":l!=Wv&&0!==i[0]||(c.msg="incomplete dynamic bit lengths tree",l=Gv),l},this.inflate_trees_dynamic=function(n,i,o,r,c,l,u,d,h){let A;return a(288),e[0]=0,A=s(o,0,n,257,Qv,Xv,l,r,d,e,t),0!=A||0===r[0]?(A==Gv?h.msg="oversubscribed literal/length tree":-4!=A&&(h.msg="incomplete literal/length tree",A=Gv),A):(a(288),A=s(o,n,i,0,Kv,$v,u,c,d,e,t),0!=A||0===c[0]&&n>257?(A==Gv?h.msg="oversubscribed distance tree":A==Wv?(h.msg="incomplete distance tree",A=Gv):-4!=A&&(h.msg="empty distance tree with lengths",A=Gv),A):0)}}function Zv(){const e=this;let t,n,i,o,r=0,s=0,a=0,c=0,l=0,u=0,d=0,h=0,A=0,p=0;function f(e,t,n,i,o,r,s,a){let c,l,u,d,h,A,p,f,m,g,_,y,v,T,b,w;p=a.next_in_index,f=a.avail_in,h=s.bitb,A=s.bitk,m=s.write,g=m<s.read?s.read-m-1:s.end-m,_=Yv[e],y=Yv[t];do{for(;A<20;)f--,h|=(255&a.read_byte(p++))<<A,A+=8;if(c=h&_,l=n,u=i,w=3*(u+c),0!==(d=l[w]))for(;;){if(h>>=l[w+1],A-=l[w+1],16&d){for(d&=15,v=l[w+2]+(h&Yv[d]),h>>=d,A-=d;A<15;)f--,h|=(255&a.read_byte(p++))<<A,A+=8;for(c=h&y,l=o,u=r,w=3*(u+c),d=l[w];;){if(h>>=l[w+1],A-=l[w+1],16&d){for(d&=15;A<d;)f--,h|=(255&a.read_byte(p++))<<A,A+=8;if(T=l[w+2]+(h&Yv[d]),h>>=d,A-=d,g-=v,m>=T)b=m-T,m-b>0&&2>m-b?(s.win[m++]=s.win[b++],s.win[m++]=s.win[b++],v-=2):(s.win.set(s.win.subarray(b,b+2),m),m+=2,b+=2,v-=2);else{b=m-T;do{b+=s.end}while(b<0);if(d=s.end-b,v>d){if(v-=d,m-b>0&&d>m-b)do{s.win[m++]=s.win[b++]}while(0!==--d);else s.win.set(s.win.subarray(b,b+d),m),m+=d,b+=d,d=0;b=0}}if(m-b>0&&v>m-b)do{s.win[m++]=s.win[b++]}while(0!==--v);else s.win.set(s.win.subarray(b,b+v),m),m+=v,b+=v,v=0;break}if(64&d)return a.msg="invalid distance code",v=a.avail_in-f,v=A>>3<v?A>>3:v,f+=v,p-=v,A-=v<<3,s.bitb=h,s.bitk=A,a.avail_in=f,a.total_in+=p-a.next_in_index,a.next_in_index=p,s.write=m,Gv;c+=l[w+2],c+=h&Yv[d],w=3*(u+c),d=l[w]}break}if(64&d)return 32&d?(v=a.avail_in-f,v=A>>3<v?A>>3:v,f+=v,p-=v,A-=v<<3,s.bitb=h,s.bitk=A,a.avail_in=f,a.total_in+=p-a.next_in_index,a.next_in_index=p,s.write=m,1):(a.msg="invalid literal/length code",v=a.avail_in-f,v=A>>3<v?A>>3:v,f+=v,p-=v,A-=v<<3,s.bitb=h,s.bitk=A,a.avail_in=f,a.total_in+=p-a.next_in_index,a.next_in_index=p,s.write=m,Gv);if(c+=l[w+2],c+=h&Yv[d],w=3*(u+c),0===(d=l[w])){h>>=l[w+1],A-=l[w+1],s.win[m++]=l[w+2],g--;break}}else h>>=l[w+1],A-=l[w+1],s.win[m++]=l[w+2],g--}while(g>=258&&f>=10);return v=a.avail_in-f,v=A>>3<v?A>>3:v,f+=v,p-=v,A-=v<<3,s.bitb=h,s.bitk=A,a.avail_in=f,a.total_in+=p-a.next_in_index,a.next_in_index=p,s.write=m,0}e.init=function(e,r,s,a,c,l){t=0,d=e,h=r,i=s,A=a,o=c,p=l,n=null},e.proc=function(e,m,g){let _,y,v,T,b,w,x,C=0,E=0,S=0;for(S=m.next_in_index,T=m.avail_in,C=e.bitb,E=e.bitk,b=e.write,w=b<e.read?e.read-b-1:e.end-b;;)switch(t){case 0:if(w>=258&&T>=10&&(e.bitb=C,e.bitk=E,m.avail_in=T,m.total_in+=S-m.next_in_index,m.next_in_index=S,e.write=b,g=f(d,h,i,A,o,p,e,m),S=m.next_in_index,T=m.avail_in,C=e.bitb,E=e.bitk,b=e.write,w=b<e.read?e.read-b-1:e.end-b,0!=g)){t=1==g?7:9;break}a=d,n=i,s=A,t=1;case 1:for(_=a;E<_;){if(0===T)return e.bitb=C,e.bitk=E,m.avail_in=T,m.total_in+=S-m.next_in_index,m.next_in_index=S,e.write=b,e.inflate_flush(m,g);g=0,T--,C|=(255&m.read_byte(S++))<<E,E+=8}if(y=3*(s+(C&Yv[_])),C>>>=n[y+1],E-=n[y+1],v=n[y],0===v){c=n[y+2],t=6;break}if(16&v){l=15&v,r=n[y+2],t=2;break}if(!(64&v)){a=v,s=y/3+n[y+2];break}if(32&v){t=7;break}return t=9,m.msg="invalid literal/length code",g=Gv,e.bitb=C,e.bitk=E,m.avail_in=T,m.total_in+=S-m.next_in_index,m.next_in_index=S,e.write=b,e.inflate_flush(m,g);case 2:for(_=l;E<_;){if(0===T)return e.bitb=C,e.bitk=E,m.avail_in=T,m.total_in+=S-m.next_in_index,m.next_in_index=S,e.write=b,e.inflate_flush(m,g);g=0,T--,C|=(255&m.read_byte(S++))<<E,E+=8}r+=C&Yv[_],C>>=_,E-=_,a=h,n=o,s=p,t=3;case 3:for(_=a;E<_;){if(0===T)return e.bitb=C,e.bitk=E,m.avail_in=T,m.total_in+=S-m.next_in_index,m.next_in_index=S,e.write=b,e.inflate_flush(m,g);g=0,T--,C|=(255&m.read_byte(S++))<<E,E+=8}if(y=3*(s+(C&Yv[_])),C>>=n[y+1],E-=n[y+1],v=n[y],16&v){l=15&v,u=n[y+2],t=4;break}if(!(64&v)){a=v,s=y/3+n[y+2];break}return t=9,m.msg="invalid distance code",g=Gv,e.bitb=C,e.bitk=E,m.avail_in=T,m.total_in+=S-m.next_in_index,m.next_in_index=S,e.write=b,e.inflate_flush(m,g);case 4:for(_=l;E<_;){if(0===T)return e.bitb=C,e.bitk=E,m.avail_in=T,m.total_in+=S-m.next_in_index,m.next_in_index=S,e.write=b,e.inflate_flush(m,g);g=0,T--,C|=(255&m.read_byte(S++))<<E,E+=8}u+=C&Yv[_],C>>=_,E-=_,t=5;case 5:for(x=b-u;x<0;)x+=e.end;for(;0!==r;){if(0===w&&(b==e.end&&0!==e.read&&(b=0,w=b<e.read?e.read-b-1:e.end-b),0===w&&(e.write=b,g=e.inflate_flush(m,g),b=e.write,w=b<e.read?e.read-b-1:e.end-b,b==e.end&&0!==e.read&&(b=0,w=b<e.read?e.read-b-1:e.end-b),0===w)))return e.bitb=C,e.bitk=E,m.avail_in=T,m.total_in+=S-m.next_in_index,m.next_in_index=S,e.write=b,e.inflate_flush(m,g);e.win[b++]=e.win[x++],w--,x==e.end&&(x=0),r--}t=0;break;case 6:if(0===w&&(b==e.end&&0!==e.read&&(b=0,w=b<e.read?e.read-b-1:e.end-b),0===w&&(e.write=b,g=e.inflate_flush(m,g),b=e.write,w=b<e.read?e.read-b-1:e.end-b,b==e.end&&0!==e.read&&(b=0,w=b<e.read?e.read-b-1:e.end-b),0===w)))return e.bitb=C,e.bitk=E,m.avail_in=T,m.total_in+=S-m.next_in_index,m.next_in_index=S,e.write=b,e.inflate_flush(m,g);g=0,e.win[b++]=c,w--,t=0;break;case 7:if(E>7&&(E-=8,T++,S--),e.write=b,g=e.inflate_flush(m,g),b=e.write,w=b<e.read?e.read-b-1:e.end-b,e.read!=e.write)return e.bitb=C,e.bitk=E,m.avail_in=T,m.total_in+=S-m.next_in_index,m.next_in_index=S,e.write=b,e.inflate_flush(m,g);t=8;case 8:return g=1,e.bitb=C,e.bitk=E,m.avail_in=T,m.total_in+=S-m.next_in_index,m.next_in_index=S,e.write=b,e.inflate_flush(m,g);case 9:return g=Gv,e.bitb=C,e.bitk=E,m.avail_in=T,m.total_in+=S-m.next_in_index,m.next_in_index=S,e.write=b,e.inflate_flush(m,g);default:return g=Hv,e.bitb=C,e.bitk=E,m.avail_in=T,m.total_in+=S-m.next_in_index,m.next_in_index=S,e.write=b,e.inflate_flush(m,g)}},e.free=function(){}}Jv.inflate_trees_fixed=function(e,t,n,i){return e[0]=9,t[0]=5,n[0]=qv,i[0]=jv,0};const eT=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function tT(e,t){const n=this;let i,o=0,r=0,s=0,a=0;const c=[0],l=[0],u=new Zv;let d=0,h=new Int32Array(4320);const A=new Jv;n.bitk=0,n.bitb=0,n.win=new Uint8Array(t),n.end=t,n.read=0,n.write=0,n.reset=function(e,t){t&&(t[0]=0),6==o&&u.free(e),o=0,n.bitk=0,n.bitb=0,n.read=n.write=0},n.reset(e,null),n.inflate_flush=function(e,t){let i,o,r;return o=e.next_out_index,r=n.read,i=(r<=n.write?n.write:n.end)-r,i>e.avail_out&&(i=e.avail_out),0!==i&&t==Wv&&(t=0),e.avail_out-=i,e.total_out+=i,e.next_out.set(n.win.subarray(r,r+i),o),o+=i,r+=i,r==n.end&&(r=0,n.write==n.end&&(n.write=0),i=n.write-r,i>e.avail_out&&(i=e.avail_out),0!==i&&t==Wv&&(t=0),e.avail_out-=i,e.total_out+=i,e.next_out.set(n.win.subarray(r,r+i),o),o+=i,r+=i),e.next_out_index=o,n.read=r,t},n.proc=function(e,t){let p,f,m,g,_,y,v,T;for(g=e.next_in_index,_=e.avail_in,f=n.bitb,m=n.bitk,y=n.write,v=y<n.read?n.read-y-1:n.end-y;;){let b,w,x,C,E,S,I,P;switch(o){case 0:for(;m<3;){if(0===_)return n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);t=0,_--,f|=(255&e.read_byte(g++))<<m,m+=8}switch(p=7&f,d=1&p,p>>>1){case 0:f>>>=3,m-=3,p=7&m,f>>>=p,m-=p,o=1;break;case 1:b=[],w=[],x=[[]],C=[[]],Jv.inflate_trees_fixed(b,w,x,C),u.init(b[0],w[0],x[0],0,C[0],0),f>>>=3,m-=3,o=6;break;case 2:f>>>=3,m-=3,o=3;break;case 3:return f>>>=3,m-=3,o=9,e.msg="invalid block type",t=Gv,n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t)}break;case 1:for(;m<32;){if(0===_)return n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);t=0,_--,f|=(255&e.read_byte(g++))<<m,m+=8}if((~f>>>16&65535)!=(65535&f))return o=9,e.msg="invalid stored block lengths",t=Gv,n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);r=65535&f,f=m=0,o=0!==r?2:0!==d?7:0;break;case 2:if(0===_)return n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);if(0===v&&(y==n.end&&0!==n.read&&(y=0,v=y<n.read?n.read-y-1:n.end-y),0===v&&(n.write=y,t=n.inflate_flush(e,t),y=n.write,v=y<n.read?n.read-y-1:n.end-y,y==n.end&&0!==n.read&&(y=0,v=y<n.read?n.read-y-1:n.end-y),0===v)))return n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);if(t=0,p=r,p>_&&(p=_),p>v&&(p=v),n.win.set(e.read_buf(g,p),y),g+=p,_-=p,y+=p,v-=p,0!==(r-=p))break;o=0!==d?7:0;break;case 3:for(;m<14;){if(0===_)return n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);t=0,_--,f|=(255&e.read_byte(g++))<<m,m+=8}if(s=p=16383&f,(31&p)>29||(p>>5&31)>29)return o=9,e.msg="too many length or distance symbols",t=Gv,n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);if(p=258+(31&p)+(p>>5&31),!i||i.length<p)i=[];else for(T=0;T<p;T++)i[T]=0;f>>>=14,m-=14,a=0,o=4;case 4:for(;a<4+(s>>>10);){for(;m<3;){if(0===_)return n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);t=0,_--,f|=(255&e.read_byte(g++))<<m,m+=8}i[eT[a++]]=7&f,f>>>=3,m-=3}for(;a<19;)i[eT[a++]]=0;if(c[0]=7,p=A.inflate_trees_bits(i,c,l,h,e),0!=p)return(t=p)==Gv&&(i=null,o=9),n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);a=0,o=5;case 5:for(;p=s,!(a>=258+(31&p)+(p>>5&31));){let r,u;for(p=c[0];m<p;){if(0===_)return n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);t=0,_--,f|=(255&e.read_byte(g++))<<m,m+=8}if(p=h[3*(l[0]+(f&Yv[p]))+1],u=h[3*(l[0]+(f&Yv[p]))+2],u<16)f>>>=p,m-=p,i[a++]=u;else{for(T=18==u?7:u-14,r=18==u?11:3;m<p+T;){if(0===_)return n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);t=0,_--,f|=(255&e.read_byte(g++))<<m,m+=8}if(f>>>=p,m-=p,r+=f&Yv[T],f>>>=T,m-=T,T=a,p=s,T+r>258+(31&p)+(p>>5&31)||16==u&&T<1)return i=null,o=9,e.msg="invalid bit length repeat",t=Gv,n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);u=16==u?i[T-1]:0;do{i[T++]=u}while(0!==--r);a=T}}if(l[0]=-1,E=[],S=[],I=[],P=[],E[0]=9,S[0]=6,p=s,p=A.inflate_trees_dynamic(257+(31&p),1+(p>>5&31),i,E,S,I,P,h,e),0!=p)return p==Gv&&(i=null,o=9),t=p,n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);u.init(E[0],S[0],h,I[0],h,P[0]),o=6;case 6:if(n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,1!=(t=u.proc(n,e,t)))return n.inflate_flush(e,t);if(t=0,u.free(e),g=e.next_in_index,_=e.avail_in,f=n.bitb,m=n.bitk,y=n.write,v=y<n.read?n.read-y-1:n.end-y,0===d){o=0;break}o=7;case 7:if(n.write=y,t=n.inflate_flush(e,t),y=n.write,v=y<n.read?n.read-y-1:n.end-y,n.read!=n.write)return n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);o=8;case 8:return t=1,n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);case 9:return t=Gv,n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t);default:return t=Hv,n.bitb=f,n.bitk=m,e.avail_in=_,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=y,n.inflate_flush(e,t)}}},n.free=function(e){n.reset(e,null),n.win=null,h=null},n.set_dictionary=function(e,t,i){n.win.set(e.subarray(t,t+i),0),n.read=n.write=i},n.sync_point=function(){return 1==o?1:0}}const nT=13,iT=[0,0,255,255];function oT(){const e=this;function t(e){return e&&e.istate?(e.total_in=e.total_out=0,e.msg=null,e.istate.mode=7,e.istate.blocks.reset(e,null),0):Hv}e.mode=0,e.method=0,e.was=[0],e.need=0,e.marker=0,e.wbits=0,e.inflateEnd=function(t){return e.blocks&&e.blocks.free(t),e.blocks=null,0},e.inflateInit=function(n,i){return n.msg=null,e.blocks=null,i<8||i>15?(e.inflateEnd(n),Hv):(e.wbits=i,n.istate.blocks=new tT(n,1<<i),t(n),0)},e.inflate=function(e,t){let n,i;if(!e||!e.istate||!e.next_in)return Hv;const o=e.istate;for(t=4==t?Wv:0,n=Wv;;)switch(o.mode){case 0:if(0===e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,8!=(15&(o.method=e.read_byte(e.next_in_index++)))){o.mode=nT,e.msg="unknown compression method",o.marker=5;break}if(8+(o.method>>4)>o.wbits){o.mode=nT,e.msg="invalid win size",o.marker=5;break}o.mode=1;case 1:if(0===e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,i=255&e.read_byte(e.next_in_index++),((o.method<<8)+i)%31!=0){o.mode=nT,e.msg="incorrect header check",o.marker=5;break}if(!(32&i)){o.mode=7;break}o.mode=2;case 2:if(0===e.avail_in)return n;n=t,e.avail_in--,e.total_in++,o.need=(255&e.read_byte(e.next_in_index++))<<24&4278190080,o.mode=3;case 3:if(0===e.avail_in)return n;n=t,e.avail_in--,e.total_in++,o.need+=(255&e.read_byte(e.next_in_index++))<<16&16711680,o.mode=4;case 4:if(0===e.avail_in)return n;n=t,e.avail_in--,e.total_in++,o.need+=(255&e.read_byte(e.next_in_index++))<<8&65280,o.mode=5;case 5:return 0===e.avail_in?n:(n=t,e.avail_in--,e.total_in++,o.need+=255&e.read_byte(e.next_in_index++),o.mode=6,2);case 6:return o.mode=nT,e.msg="need dictionary",o.marker=0,Hv;case 7:if(n=o.blocks.proc(e,n),n==Gv){o.mode=nT,o.marker=0;break}if(0==n&&(n=t),1!=n)return n;n=t,o.blocks.reset(e,o.was),o.mode=12;case 12:return e.avail_in=0,1;case nT:return Gv;default:return Hv}},e.inflateSetDictionary=function(e,t,n){let i=0,o=n;if(!e||!e.istate||6!=e.istate.mode)return Hv;const r=e.istate;return o>=1<<r.wbits&&(o=(1<<r.wbits)-1,i=n-o),r.blocks.set_dictionary(t,i,o),r.mode=7,0},e.inflateSync=function(e){let n,i,o,r,s;if(!e||!e.istate)return Hv;const a=e.istate;if(a.mode!=nT&&(a.mode=nT,a.marker=0),0===(n=e.avail_in))return Wv;for(i=e.next_in_index,o=a.marker;0!==n&&o<4;)e.read_byte(i)==iT[o]?o++:o=0!==e.read_byte(i)?0:4-o,i++,n--;return e.total_in+=i-e.next_in_index,e.next_in_index=i,e.avail_in=n,a.marker=o,4!=o?Gv:(r=e.total_in,s=e.total_out,t(e),e.total_in=r,e.total_out=s,a.mode=7,0)},e.inflateSyncPoint=function(e){return e&&e.istate&&e.istate.blocks?e.istate.blocks.sync_point():Hv}}function rT(){}rT.prototype={inflateInit(e){const t=this;return t.istate=new oT,e||(e=15),t.istate.inflateInit(t,e)},inflate(e){const t=this;return t.istate?t.istate.inflate(t,e):Hv},inflateEnd(){const e=this;if(!e.istate)return Hv;const t=e.istate.inflateEnd(e);return e.istate=null,t},inflateSync(){const e=this;return e.istate?e.istate.inflateSync(e):Hv},inflateSetDictionary(e,t){const n=this;return n.istate?n.istate.inflateSetDictionary(n,e,t):Hv},read_byte(e){return this.next_in[e]},read_buf(e,t){return this.next_in.subarray(e,e+t)}};const sT=4294967295,aT=65535,cT=67324752,lT=134695760,uT=lT,dT=33639248,hT=101010256,AT=101075792,pT=117853008,fT=22,mT=21589,gT=2048,_T="/",yT=30,vT=new Date(2107,11,31),TT=new Date(1980,0,1),bT=void 0,wT="undefined",xT="function";class CT{constructor(e){return class extends TransformStream{constructor(t,n){const i=new e(n);super({transform(e,t){t.enqueue(i.append(e))},flush(e){const t=i.flush();t&&e.enqueue(t)}})}}}}let ET=2;try{typeof navigator!=wT&&navigator.hardwareConcurrency&&(ET=navigator.hardwareConcurrency)}catch(e){}const ST={chunkSize:524288,maxWorkers:ET,terminateWorkerTimeout:5e3,useWebWorkers:!0,useCompressionStream:!0,workerScripts:bT,CompressionStreamNative:typeof CompressionStream!=wT&&CompressionStream,DecompressionStreamNative:typeof DecompressionStream!=wT&&DecompressionStream},IT=Object.assign({},ST);function PT(){return IT}function DT(e){return Math.max(e.chunkSize,64)}function OT(e){const{baseURL:t,chunkSize:n,maxWorkers:i,terminateWorkerTimeout:o,useCompressionStream:r,useWebWorkers:s,Deflate:a,Inflate:c,CompressionStream:l,DecompressionStream:u,workerScripts:d}=e;if(RT("baseURL",t),RT("chunkSize",n),RT("maxWorkers",i),RT("terminateWorkerTimeout",o),RT("useCompressionStream",r),RT("useWebWorkers",s),a&&(IT.CompressionStream=new CT(a)),c&&(IT.DecompressionStream=new CT(c)),RT("CompressionStream",l),RT("DecompressionStream",u),d!==bT){const{deflate:e,inflate:t}=d;if((e||t)&&(IT.workerScripts||(IT.workerScripts={})),e){if(!Array.isArray(e))throw new Error("workerScripts.deflate must be an array");IT.workerScripts.deflate=e}if(t){if(!Array.isArray(t))throw new Error("workerScripts.inflate must be an array");IT.workerScripts.inflate=t}}}function RT(e,t){t!==bT&&(IT[e]=t)}const MT=[];for(let e=0;e<256;e++){let t=e;for(let e=0;e<8;e++)1&t?t=t>>>1^3988292384:t>>>=1;MT[e]=t}class LT{constructor(e){this.crc=e||-1}append(e){let t=0|this.crc;for(let n=0,i=0|e.length;n<i;n++)t=t>>>8^MT[255&(t^e[n])];this.crc=t}get(){return~this.crc}}class NT extends TransformStream{constructor(){let e;const t=new LT;super({transform(e,n){t.append(e),n.enqueue(e)},flush(){const n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,t.get()),e.value=n}}),e=this}}function BT(e){if(typeof TextEncoder==wT){e=unescape(encodeURIComponent(e));const t=new Uint8Array(e.length);for(let n=0;n<t.length;n++)t[n]=e.charCodeAt(n);return t}return(new TextEncoder).encode(e)}const FT={concat(e,t){if(0===e.length||0===t.length)return e.concat(t);const n=e[e.length-1],i=FT.getPartial(n);return 32===i?e.concat(t):FT._shiftRight(t,i,0|n,e.slice(0,e.length-1))},bitLength(e){const t=e.length;if(0===t)return 0;const n=e[t-1];return 32*(t-1)+FT.getPartial(n)},clamp(e,t){if(32*e.length<t)return e;const n=(e=e.slice(0,Math.ceil(t/32))).length;return t&=31,n>0&&t&&(e[n-1]=FT.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:(e,t,n)=>32===e?t:(n?0|t:t<<32-e)+1099511627776*e,getPartial:e=>Math.round(e/1099511627776)||32,_shiftRight(e,t,n,i){for(void 0===i&&(i=[]);t>=32;t-=32)i.push(n),n=0;if(0===t)return i.concat(e);for(let o=0;o<e.length;o++)i.push(n|e[o]>>>t),n=e[o]<<32-t;const o=e.length?e[e.length-1]:0,r=FT.getPartial(o);return i.push(FT.partial(t+r&31,t+r>32?n:i.pop(),1)),i}},UT={bytes:{fromBits(e){const t=FT.bitLength(e)/8,n=new Uint8Array(t);let i;for(let o=0;o<t;o++)3&o||(i=e[o/4]),n[o]=i>>>24,i<<=8;return n},toBits(e){const t=[];let n,i=0;for(n=0;n<e.length;n++)i=i<<8|e[n],3&~n||(t.push(i),i=0);return 3&n&&t.push(FT.partial(8*(3&n),i)),t}}},kT=class{constructor(e){const t=this;t.blockSize=512,t._init=[1732584193,4023233417,2562383102,271733878,3285377520],t._key=[1518500249,1859775393,2400959708,3395469782],e?(t._h=e._h.slice(0),t._buffer=e._buffer.slice(0),t._length=e._length):t.reset()}reset(){const e=this;return e._h=e._init.slice(0),e._buffer=[],e._length=0,e}update(e){const t=this;"string"==typeof e&&(e=UT.utf8String.toBits(e));const n=t._buffer=FT.concat(t._buffer,e),i=t._length,o=t._length=i+FT.bitLength(e);if(o>9007199254740991)throw new Error("Cannot hash more than 2^53 - 1 bits");const r=new Uint32Array(n);let s=0;for(let e=t.blockSize+i-(t.blockSize+i&t.blockSize-1);e<=o;e+=t.blockSize)t._block(r.subarray(16*s,16*(s+1))),s+=1;return n.splice(0,16*s),t}finalize(){const e=this;let t=e._buffer;const n=e._h;t=FT.concat(t,[FT.partial(1,1)]);for(let e=t.length+2;15&e;e++)t.push(0);for(t.push(Math.floor(e._length/4294967296)),t.push(0|e._length);t.length;)e._block(t.splice(0,16));return e.reset(),n}_f(e,t,n,i){return e<=19?t&n|~t&i:e<=39?t^n^i:e<=59?t&n|t&i|n&i:e<=79?t^n^i:void 0}_S(e,t){return t<<e|t>>>32-e}_block(e){const t=this,n=t._h,i=Array(80);for(let t=0;t<16;t++)i[t]=e[t];let o=n[0],r=n[1],s=n[2],a=n[3],c=n[4];for(let e=0;e<=79;e++){e>=16&&(i[e]=t._S(1,i[e-3]^i[e-8]^i[e-14]^i[e-16]));const n=t._S(5,o)+t._f(e,r,s,a)+c+i[e]+t._key[Math.floor(e/20)]|0;c=a,a=s,s=t._S(30,r),r=o,o=n}n[0]=n[0]+o|0,n[1]=n[1]+r|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+c|0}},VT=class{constructor(e){const t=this;t._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],t._tables[0][0][0]||t._precompute();const n=t._tables[0][4],i=t._tables[1],o=e.length;let r,s,a,c=1;if(4!==o&&6!==o&&8!==o)throw new Error("invalid aes key size");for(t._key=[s=e.slice(0),a=[]],r=o;r<4*o+28;r++){let e=s[r-1];(r%o===0||8===o&&r%o===4)&&(e=n[e>>>24]<<24^n[e>>16&255]<<16^n[e>>8&255]<<8^n[255&e],r%o===0&&(e=e<<8^e>>>24^c<<24,c=c<<1^283*(c>>7))),s[r]=s[r-o]^e}for(let e=0;r;e++,r--){const t=s[3&e?r:r-4];a[e]=r<=4||e<4?t:i[0][n[t>>>24]]^i[1][n[t>>16&255]]^i[2][n[t>>8&255]]^i[3][n[255&t]]}}encrypt(e){return this._crypt(e,0)}decrypt(e){return this._crypt(e,1)}_precompute(){const e=this._tables[0],t=this._tables[1],n=e[4],i=t[4],o=[],r=[];let s,a,c,l;for(let e=0;e<256;e++)r[(o[e]=e<<1^283*(e>>7))^e]=e;for(let u=s=0;!n[u];u^=a||1,s=r[s]||1){let r=s^s<<1^s<<2^s<<3^s<<4;r=r>>8^255&r^99,n[u]=r,i[r]=u,l=o[c=o[a=o[u]]];let d=16843009*l^65537*c^257*a^16843008*u,h=257*o[r]^16843008*r;for(let n=0;n<4;n++)e[n][u]=h=h<<24^h>>>8,t[n][r]=d=d<<24^d>>>8}for(let n=0;n<5;n++)e[n]=e[n].slice(0),t[n]=t[n].slice(0)}_crypt(e,t){if(4!==e.length)throw new Error("invalid aes block size");const n=this._key[t],i=n.length/4-2,o=[0,0,0,0],r=this._tables[t],s=r[0],a=r[1],c=r[2],l=r[3],u=r[4];let d,h,A,p=e[0]^n[0],f=e[t?3:1]^n[1],m=e[2]^n[2],g=e[t?1:3]^n[3],_=4;for(let e=0;e<i;e++)d=s[p>>>24]^a[f>>16&255]^c[m>>8&255]^l[255&g]^n[_],h=s[f>>>24]^a[m>>16&255]^c[g>>8&255]^l[255&p]^n[_+1],A=s[m>>>24]^a[g>>16&255]^c[p>>8&255]^l[255&f]^n[_+2],g=s[g>>>24]^a[p>>16&255]^c[f>>8&255]^l[255&m]^n[_+3],_+=4,p=d,f=h,m=A;for(let e=0;e<4;e++)o[t?3&-e:e]=u[p>>>24]<<24^u[f>>16&255]<<16^u[m>>8&255]<<8^u[255&g]^n[_++],d=p,p=f,f=m,m=g,g=d;return o}},zT={getRandomValues(e){const t=new Uint32Array(e.buffer),n=e=>{let t=987654321;const n=4294967295;return function(){return t=36969*(65535&t)+(t>>16)&n,(((t<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n)/4294967296+.5)*(Math.random()>.5?1:-1)}};for(let i,o=0;o<e.length;o+=4){const e=n(4294967296*(i||Math.random()));i=987654071*e(),t[o/4]=4294967296*e()|0}return e}},HT=class{constructor(e,t){this._prf=e,this._initIv=t,this._iv=t}reset(){this._iv=this._initIv}update(e){return this.calculate(this._prf,e,this._iv)}incWord(e){if(255&~(e>>24))e+=1<<24;else{let t=e>>16&255,n=e>>8&255,i=255&e;255===t?(t=0,255===n?(n=0,255===i?i=0:++i):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=i}return e}incCounter(e){0===(e[0]=this.incWord(e[0]))&&(e[1]=this.incWord(e[1]))}calculate(e,t,n){let i;if(!(i=t.length))return[];const o=FT.bitLength(t);for(let o=0;o<i;o+=4){this.incCounter(n);const i=e.encrypt(n);t[o]^=i[0],t[o+1]^=i[1],t[o+2]^=i[2],t[o+3]^=i[3]}return FT.clamp(t,o)}},GT={importKey:e=>new GT.hmacSha1(UT.bytes.toBits(e)),pbkdf2(e,t,n,i){if(n=n||1e4,i<0||n<0)throw new Error("invalid params to pbkdf2");const o=1+(i>>5)<<2;let r,s,a,c,l;const u=new ArrayBuffer(o),d=new DataView(u);let h=0;const A=FT;for(t=UT.bytes.toBits(t),l=1;h<(o||1);l++){for(r=s=e.encrypt(A.concat(t,[l])),a=1;a<n;a++)for(s=e.encrypt(s),c=0;c<s.length;c++)r[c]^=s[c];for(a=0;h<(o||1)&&a<r.length;a++)d.setInt32(h,r[a]),h+=4}return u.slice(0,i/8)},hmacSha1:class{constructor(e){const t=this,n=t._hash=kT,i=[[],[]];t._baseHash=[new n,new n];const o=t._baseHash[0].blockSize/32;e.length>o&&(e=(new n).update(e).finalize());for(let t=0;t<o;t++)i[0][t]=909522486^e[t],i[1][t]=1549556828^e[t];t._baseHash[0].update(i[0]),t._baseHash[1].update(i[1]),t._resultHash=new n(t._baseHash[0])}reset(){const e=this;e._resultHash=new e._hash(e._baseHash[0]),e._updated=!1}update(e){this._updated=!0,this._resultHash.update(e)}digest(){const e=this,t=e._resultHash.finalize(),n=new e._hash(e._baseHash[1]).update(t).finalize();return e.reset(),n}encrypt(e){if(this._updated)throw new Error("encrypt on already updated hmac called!");return this.update(e),this.digest(e)}}},WT=typeof crypto!=wT&&typeof crypto.getRandomValues==xT,YT="Invalid password",qT="Invalid signature",jT="zipjs-abort-check-password";function QT(e){return WT?crypto.getRandomValues(e):zT.getRandomValues(e)}const XT=16,KT={name:"PBKDF2"},$T=Object.assign({hash:{name:"HMAC"}},KT),JT=Object.assign({iterations:1e3,hash:{name:"SHA-1"}},KT),ZT=["deriveBits"],eb=[8,12,16],tb=[16,24,32],nb=10,ib=[0,0,0,0],ob=typeof crypto!=wT,rb=ob&&crypto.subtle,sb=ob&&typeof rb!=wT,ab=UT.bytes,cb=VT,lb=HT,ub=GT.hmacSha1;let db=ob&&sb&&typeof rb.importKey==xT,hb=ob&&sb&&typeof rb.deriveBits==xT;class Ab extends TransformStream{constructor({password:e,rawPassword:t,signed:n,encryptionStrength:i,checkPasswordOnly:o}){super({start(){Object.assign(this,{ready:new Promise(e=>this.resolveReady=e),password:gb(e,t),signed:n,strength:i-1,pending:new Uint8Array})},async transform(e,t){const n=this,{password:i,strength:r,resolveReady:s,ready:a}=n;i?(await async function(e,t,n,i){const o=await mb(e,t,n,yb(i,0,eb[t])),r=yb(i,eb[t]);if(o[0]!=r[0]||o[1]!=r[1])throw new Error(YT)}(n,r,i,yb(e,0,eb[r]+2)),e=yb(e,eb[r]+2),o?t.error(new Error(jT)):s()):await a;const c=new Uint8Array(e.length-nb-(e.length-nb)%XT);t.enqueue(fb(n,e,c,0,nb,!0))},async flush(e){const{signed:t,ctr:n,hmac:i,pending:o,ready:r}=this;if(i&&n){await r;const s=yb(o,0,o.length-nb),a=yb(o,o.length-nb);let c=new Uint8Array;if(s.length){const e=Tb(ab,s);i.update(e);const t=n.update(e);c=vb(ab,t)}if(t){const e=yb(vb(ab,i.digest()),0,nb);for(let t=0;t<nb;t++)if(e[t]!=a[t])throw new Error(qT)}e.enqueue(c)}}})}}class pb extends TransformStream{constructor({password:e,rawPassword:t,encryptionStrength:n}){let i;super({start(){Object.assign(this,{ready:new Promise(e=>this.resolveReady=e),password:gb(e,t),strength:n-1,pending:new Uint8Array})},async transform(e,t){const n=this,{password:i,strength:o,resolveReady:r,ready:s}=n;let a=new Uint8Array;i?(a=await async function(e,t,n){const i=QT(new Uint8Array(eb[t]));return _b(i,await mb(e,t,n,i))}(n,o,i),r()):await s;const c=new Uint8Array(a.length+e.length-e.length%XT);c.set(a,0),t.enqueue(fb(n,e,c,a.length,0))},async flush(e){const{ctr:t,hmac:n,pending:o,ready:r}=this;if(n&&t){await r;let s=new Uint8Array;if(o.length){const e=t.update(Tb(ab,o));n.update(e),s=vb(ab,e)}i.signature=vb(ab,n.digest()).slice(0,nb),e.enqueue(_b(s,i.signature))}}}),i=this}}function fb(e,t,n,i,o,r){const{ctr:s,hmac:a,pending:c}=e,l=t.length-o;let u;for(c.length&&(t=_b(c,t),n=function(e,t){if(t&&t>e.length){const n=e;(e=new Uint8Array(t)).set(n,0)}return e}(n,l-l%XT)),u=0;u<=l-XT;u+=XT){const e=Tb(ab,yb(t,u,u+XT));r&&a.update(e);const o=s.update(e);r||a.update(o),n.set(vb(ab,o),u+i)}return e.pending=yb(t,u),n}async function mb(e,t,n,i){e.password=null;const o=await async function(e,t,n,i,o){if(!db)return GT.importKey(t);try{return await rb.importKey("raw",t,n,!1,o)}catch(e){return db=!1,GT.importKey(t)}}(0,n,$T,0,ZT),r=await async function(e,t,n){if(!hb)return GT.pbkdf2(t,e.salt,JT.iterations,n);try{return await rb.deriveBits(e,t,n)}catch(i){return hb=!1,GT.pbkdf2(t,e.salt,JT.iterations,n)}}(Object.assign({salt:i},JT),o,8*(2*tb[t]+2)),s=new Uint8Array(r),a=Tb(ab,yb(s,0,tb[t])),c=Tb(ab,yb(s,tb[t],2*tb[t])),l=yb(s,2*tb[t]);return Object.assign(e,{keys:{key:a,authentication:c,passwordVerification:l},ctr:new lb(new cb(a),Array.from(ib)),hmac:new ub(c)}),l}function gb(e,t){return t===bT?BT(e):t}function _b(e,t){let n=e;return e.length+t.length&&(n=new Uint8Array(e.length+t.length),n.set(e,0),n.set(t,e.length)),n}function yb(e,t,n){return e.subarray(t,n)}function vb(e,t){return e.fromBits(t)}function Tb(e,t){return e.toBits(t)}class bb extends TransformStream{constructor({password:e,passwordVerification:t,checkPasswordOnly:n}){super({start(){Object.assign(this,{password:e,passwordVerification:t}),Eb(this,e)},transform(e,t){const i=this;if(i.password){const t=xb(i,e.subarray(0,12));if(i.password=null,t.at(-1)!=i.passwordVerification)throw new Error(YT);e=e.subarray(12)}n?t.error(new Error(jT)):t.enqueue(xb(i,e))}})}}class wb extends TransformStream{constructor({password:e,passwordVerification:t}){super({start(){Object.assign(this,{password:e,passwordVerification:t}),Eb(this,e)},transform(e,t){const n=this;let i,o;if(n.password){n.password=null;const t=QT(new Uint8Array(12));t[11]=n.passwordVerification,i=new Uint8Array(e.length+t.length),i.set(Cb(n,t),0),o=12}else i=new Uint8Array(e.length),o=0;i.set(Cb(n,e),o),t.enqueue(i)}})}}function xb(e,t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=Ib(e)^t[i],Sb(e,n[i]);return n}function Cb(e,t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=Ib(e)^t[i],Sb(e,t[i]);return n}function Eb(e,t){const n=[305419896,591751049,878082192];Object.assign(e,{keys:n,crcKey0:new LT(n[0]),crcKey2:new LT(n[2])});for(let n=0;n<t.length;n++)Sb(e,t.charCodeAt(n))}function Sb(e,t){let[n,i,o]=e.keys;e.crcKey0.append([t]),n=~e.crcKey0.get(),i=Db(Math.imul(Db(i+Pb(n)),134775813)+1),e.crcKey2.append([i>>>24]),o=~e.crcKey2.get(),e.keys=[n,i,o]}function Ib(e){const t=2|e.keys[2];return Pb(Math.imul(t,1^t)>>>8)}function Pb(e){return 255&e}function Db(e){return 4294967295&e}const Ob="Invalid uncompressed size",Rb="deflate-raw";class Mb extends TransformStream{constructor(e,{chunkSize:t,CompressionStream:n,CompressionStreamNative:i}){super({});const{compressed:o,encrypted:r,useCompressionStream:s,zipCrypto:a,signed:c,level:l}=e,u=this;let d,h,A=super.readable;r&&!a||!c||(d=new NT,A=Fb(A,d)),o&&(A=Bb(A,s,{level:l,chunkSize:t},i,n)),r&&(a?A=Fb(A,new wb(e)):(h=new pb(e),A=Fb(A,h))),Nb(u,A,()=>{let e;r&&!a&&(e=h.signature),r&&!a||!c||(e=new DataView(d.value.buffer).getUint32(0)),u.signature=e})}}class Lb extends TransformStream{constructor(e,{chunkSize:t,DecompressionStream:n,DecompressionStreamNative:i}){super({});const{zipCrypto:o,encrypted:r,signed:s,signature:a,compressed:c,useCompressionStream:l}=e;let u,d,h=super.readable;r&&(o?h=Fb(h,new bb(e)):(d=new Ab(e),h=Fb(h,d))),c&&(h=Bb(h,l,{chunkSize:t},i,n)),r&&!o||!s||(u=new NT,h=Fb(h,u)),Nb(this,h,()=>{if((!r||o)&&s){const e=new DataView(u.value.buffer);if(a!=e.getUint32(0,!1))throw new Error(qT)}})}}function Nb(e,t,n){t=Fb(t,new TransformStream({flush:n})),Object.defineProperty(e,"readable",{get:()=>t})}function Bb(e,t,n,i,o){try{e=Fb(e,new(t&&i?i:o)(Rb,n))}catch(i){if(!t)throw i;e=Fb(e,new o(Rb,n))}return e}function Fb(e,t){return e.pipeThrough(t)}const Ub="data",kb="close",Vb="deflate",zb="inflate";class Hb extends TransformStream{constructor(e,t){super({});const n=this,{codecType:i}=e;let o;i.startsWith(Vb)?o=Mb:i.startsWith(zb)&&(o=Lb),n.outputSize=0;let r=0;const s=new o(e,t),a=super.readable,c=new TransformStream({transform(e,t){e&&e.length&&(r+=e.length,t.enqueue(e))},flush(){Object.assign(n,{inputSize:r})}}),l=new TransformStream({transform(t,i){if(t&&t.length&&(i.enqueue(t),n.outputSize+=t.length,e.outputSize&&n.outputSize>e.outputSize))throw new Error(Ob)},flush(){const{signature:e}=s;Object.assign(n,{signature:e,inputSize:r})}});Object.defineProperty(n,"readable",{get:()=>a.pipeThrough(c).pipeThrough(s).pipeThrough(l)})}}class Gb extends TransformStream{constructor(e){let t;super({transform:function n(i,o){if(t){const e=new Uint8Array(t.length+i.length);e.set(t),e.set(i,t.length),i=e,t=null}i.length>e?(o.enqueue(i.slice(0,e)),n(i.slice(e),o)):t=i},flush(e){t&&t.length&&e.enqueue(t)}})}}let Wb=typeof Worker!=wT;class Yb{constructor(e,{readable:t,writable:n},{options:i,config:o,streamOptions:r,useWebWorkers:s,transferStreams:a,scripts:c},l){const{signal:u}=r;return Object.assign(e,{busy:!0,readable:t.pipeThrough(new Gb(o.chunkSize)).pipeThrough(new qb(r),{signal:u}),writable:n,options:Object.assign({},i),scripts:c,transferStreams:a,terminate:()=>new Promise(t=>{const{worker:n,busy:i}=e;n?(i?e.resolveTerminated=t:(n.terminate(),t()),e.interface=null):t()}),onTaskFinished(){const{resolveTerminated:t}=e;t&&(e.resolveTerminated=null,e.terminated=!0,e.worker.terminate(),t()),e.busy=!1,l(e)}}),(s&&Wb?Xb:Qb)(e,o)}}class qb extends TransformStream{constructor({onstart:e,onprogress:t,size:n,onend:i}){let o=0;super({async start(){e&&await jb(e,n)},async transform(e,i){o+=e.length,t&&await jb(t,o,n),i.enqueue(e)},async flush(){i&&await jb(i,o)}})}}async function jb(e,...t){try{await e(...t)}catch(e){}}function Qb(e,t){return{run:()=>async function({options:e,readable:t,writable:n,onTaskFinished:i},o){let r;try{r=new Hb(e,o),await t.pipeThrough(r).pipeTo(n,{preventClose:!0,preventAbort:!0});const{signature:i,inputSize:s,outputSize:a}=r;return{signature:i,inputSize:s,outputSize:a}}catch(e){throw r&&(e.outputSize=r.outputSize),e}finally{i()}}(e,t)}}function Xb(e,t){const{baseURL:n,chunkSize:i}=t;if(!e.interface){let o;try{o=function(e,t,n){const i={type:"module"};let o,r;typeof e==xT&&(e=e());try{o=new URL(e,t)}catch(t){o=e}if(Kb)try{r=new Worker(o)}catch(e){Kb=!1,r=new Worker(o,i)}else r=new Worker(o,i);return r.addEventListener("message",e=>async function({data:e},t){const{type:n,value:i,messageId:o,result:r,error:s}=e,{reader:a,writer:c,resolveResult:l,rejectResult:u,onTaskFinished:d}=t;try{if(s){const{message:e,stack:t,code:n,name:i,outputSize:o}=s,r=new Error(e);Object.assign(r,{stack:t,code:n,name:i,outputSize:o}),h(r)}else{if("pull"==n){const{value:e,done:n}=await a.read();Jb({type:Ub,value:e,done:n,messageId:o},t)}n==Ub&&(await c.ready,await c.write(new Uint8Array(i)),Jb({type:"ack",messageId:o},t)),n==kb&&h(null,r)}}catch(s){Jb({type:kb,messageId:o},t),h(s)}function h(e,t){e?u(e):l(t),c&&c.releaseLock(),d()}}(e,n)),r}(e.scripts[0],n,e)}catch(n){return Wb=!1,Qb(e,t)}Object.assign(e,{worker:o,interface:{run:()=>async function(e,t){let n,i;const o=new Promise((e,t)=>{n=e,i=t});Object.assign(e,{reader:null,writer:null,resolveResult:n,rejectResult:i,result:o});const{readable:r,options:s,scripts:a}=e,{writable:c,closed:l}=function(e){let t;const n=new Promise(e=>t=e);return{writable:new WritableStream({async write(t){const n=e.getWriter();await n.ready,await n.write(t),n.releaseLock()},close(){t()},abort:t=>e.getWriter().abort(t)}),closed:n}}(e.writable),u=Jb({type:"start",scripts:a.slice(1),options:s,config:t,readable:r,writable:c},e);u||Object.assign(e,{reader:r.getReader(),writer:c.getWriter()});const d=await o;return u||await c.getWriter().close(),await l,d}(e,{chunkSize:i})}})}return e.interface}let Kb=!0,$b=!0;function Jb(e,{worker:t,writer:n,onTaskFinished:i,transferStreams:o}){try{const{value:n,readable:i,writable:r}=e,s=[];if(n&&(n.byteLength<n.buffer.byteLength?e.value=n.buffer.slice(0,n.byteLength):e.value=n.buffer,s.push(e.value)),o&&$b?(i&&s.push(i),r&&s.push(r)):e.readable=e.writable=null,s.length)try{return t.postMessage(e,s),!0}catch(n){$b=!1,e.readable=e.writable=null,t.postMessage(e)}else t.postMessage(e)}catch(e){throw n&&n.releaseLock(),i(),e}}let Zb=[];const ew=[];let tw=0;async function nw(e,t){const{options:n,config:i}=t,{transferStreams:o,useWebWorkers:r,useCompressionStream:s,codecType:a,compressed:c,signed:l,encrypted:u}=n,{workerScripts:d,maxWorkers:h}=i;t.transferStreams=o||o===bT;const A=!(c||l||u||t.transferStreams);return t.useWebWorkers=!A&&(r||r===bT&&i.useWebWorkers),t.scripts=t.useWebWorkers&&d?d[a]:[],n.useCompressionStream=s||s===bT&&i.useCompressionStream,(await async function(){const n=Zb.find(e=>!e.busy);if(n)return iw(n),new Yb(n,e,t,p);if(Zb.length<h){const n={indexWorker:tw};return tw++,Zb.push(n),new Yb(n,e,t,p)}return new Promise(n=>ew.push({resolve:n,stream:e,workerOptions:t}))}()).run();function p(e){if(ew.length){const[{resolve:t,stream:n,workerOptions:i}]=ew.splice(0,1);t(new Yb(e,n,i,p))}else e.worker?(iw(e),function(e,t){const{config:n}=t,{terminateWorkerTimeout:i}=n;Number.isFinite(i)&&i>=0&&(e.terminated?e.terminated=!1:e.terminateTimeout=setTimeout(async()=>{Zb=Zb.filter(t=>t!=e);try{await e.terminate()}catch(e){}},i))}(e,t)):Zb=Zb.filter(t=>t!=e)}}function iw(e){const{terminateTimeout:t}=e;t&&(clearTimeout(t),e.terminateTimeout=null)}const ow=65536,rw="writable";class sw{constructor(){this.size=0}init(){this.initialized=!0}}class aw extends sw{get readable(){const e=this,{chunkSize:t=ow}=e,n=new ReadableStream({start(){this.chunkOffset=0},async pull(i){const{offset:o=0,size:r,diskNumberStart:s}=n,{chunkOffset:a}=this,c=r===bT?t:Math.min(t,r-a),l=await yw(e,o+a,c,s);i.enqueue(l),a+t>r||r===bT&&!l.length&&c?i.close():this.chunkOffset+=t}});return n}}class cw extends sw{constructor(){super();const e=this,t=new WritableStream({write(t){if(!e.initialized)throw new Error("Writer not initialized");return e.writeUint8Array(t)}});Object.defineProperty(e,rw,{get:()=>t})}writeUint8Array(){}}class lw extends cw{constructor(e){super(),Object.assign(this,{data:"data:"+(e||"")+";base64,",pending:[]})}writeUint8Array(e){const t=this;let n=0,i=t.pending;const o=t.pending.length;for(t.pending="",n=0;n<3*Math.floor((o+e.length)/3)-o;n++)i+=String.fromCharCode(e[n]);for(;n<e.length;n++)t.pending+=String.fromCharCode(e[n]);i.length&&(i.length>2?t.data+=btoa(i):t.pending+=i)}getData(){return this.data+btoa(this.pending)}}class uw extends aw{constructor(e){super(),Object.assign(this,{blob:e,size:e.size})}async readUint8Array(e,t){const n=this,i=e+t,o=e||i<n.size?n.blob.slice(e,i):n.blob;let r=await o.arrayBuffer();return r.byteLength>t&&(r=r.slice(e,i)),new Uint8Array(r)}}class dw extends sw{constructor(e){super();const t=new TransformStream,n=[];e&&n.push(["Content-Type",e]),Object.defineProperty(this,rw,{get:()=>t.writable}),this.blob=new Response(t.readable,{headers:n}).blob()}getData(){return this.blob}}class hw extends uw{constructor(e){super(new Blob([e],{type:"text/plain"}))}}class Aw extends dw{constructor(e){super(e),Object.assign(this,{encoding:e,utf8:!e||"utf-8"==e.toLowerCase()})}async getData(){const{encoding:e,utf8:t}=this,n=await super.getData();if(n.text&&t)return n.text();{const t=new FileReader;return new Promise((i,o)=>{Object.assign(t,{onload:({target:e})=>i(e.result),onerror:()=>o(t.error)}),t.readAsText(n,e)})}}}class pw extends aw{constructor(e){super(),this.readers=e}async init(){const e=this,{readers:t}=e;e.lastDiskNumber=0,e.lastDiskOffset=0,await Promise.all(t.map(async(n,i)=>{await n.init(),i!=t.length-1&&(e.lastDiskOffset+=n.size),e.size+=n.size})),super.init()}async readUint8Array(e,t,n=0){const i=this,{readers:o}=this;let r,s=n;-1==s&&(s=o.length-1);let a=e;for(;o[s]&&a>=o[s].size;)a-=o[s].size,s++;const c=o[s];if(c){const o=c.size;if(a+t<=o)r=await yw(c,a,t);else{const s=o-a;r=new Uint8Array(t);const l=await yw(c,a,s);r.set(l,0);const u=await i.readUint8Array(e+s,t-s,n);r.set(u,s),l.length+u.length<t&&(r=r.subarray(0,l.length+u.length))}}else r=new Uint8Array;return i.lastDiskNumber=Math.max(s,i.lastDiskNumber),r}}class fw extends sw{constructor(e,t=4294967295){super();const n=this;let i,o,r;Object.assign(n,{diskNumber:0,diskOffset:0,size:0,maxSize:t,availableSize:t});const s=new WritableStream({async write(t){const{availableSize:s}=n;if(r)t.length>=s?(await a(t.subarray(0,s)),await c(),n.diskOffset+=i.size,n.diskNumber++,r=null,await this.write(t.subarray(s))):await a(t);else{const{value:s,done:a}=await e.next();if(a&&!s)throw new Error("Writer iterator completed too soon");i=s,i.size=0,i.maxSize&&(n.maxSize=i.maxSize),n.availableSize=n.maxSize,await _w(i),o=s.writable,r=o.getWriter(),await this.write(t)}},async close(){await r.ready,await c()}});async function a(e){const t=e.length;t&&(await r.ready,await r.write(e),i.size+=t,n.size+=t,n.availableSize-=t)}async function c(){await r.close()}Object.defineProperty(n,rw,{get:()=>s})}}class mw{constructor(e){return Array.isArray(e)&&(e=new pw(e)),e instanceof ReadableStream&&(e={readable:e}),e}}class gw{constructor(e){return e.writable===bT&&typeof e.next==xT&&(e=new fw(e)),e instanceof WritableStream&&(e={writable:e}),e.size===bT&&(e.size=0),e instanceof fw||Object.assign(e,{diskNumber:0,diskOffset:0,availableSize:1/0,maxSize:1/0}),e}}async function _w(e,t){if(!e.init||e.initialized)return Promise.resolve();await e.init(t)}function yw(e,t,n,i){return e.readUint8Array(t,n,i)}const vw="\0☺☻♥♦♣♠•◘○◙♂♀♪♫☼►◄↕‼¶§▬↨↑↓→←∟↔▲▼ !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~⌂ÇüéâäàåçêëèïîìÄÅÉæÆôöòûùÿÖÜ¢£¥₧ƒáíóúñÑªº¿⌐¬½¼¡«»░▒▓│┤╡╢╖╕╣║╗╝╜╛┐└┴┬├─┼╞╟╚╔╩╦╠═╬╧╨╤╥╙╘╒╓╫╪┘┌█▄▌▐▀αßΓπΣσµτΦΘΩδ∞φε∩≡±≥≤⌠⌡÷≈°∙·√ⁿ²■ ".split(""),Tw=256==vw.length;function bw(e,t){return t&&"cp437"==t.trim().toLowerCase()?function(e){if(Tw){let t="";for(let n=0;n<e.length;n++)t+=vw[e[n]];return t}return(new TextDecoder).decode(e)}(e):new TextDecoder(t).decode(e)}const ww="filename",xw="rawFilename",Cw="comment",Ew="rawComment",Sw="uncompressedSize",Iw="compressedSize",Pw="offset",Dw="diskNumberStart",Ow="lastModDate",Rw="rawLastModDate",Mw="lastAccessDate",Lw="creationDate",Nw="internalFileAttribute",Bw="internalFileAttributes",Fw="externalFileAttribute",Uw="externalFileAttributes",kw="msDosCompatible",Vw="zip64",zw="encrypted",Hw="version",Gw="versionMadeBy",Ww="zipCrypto",Yw="directory",qw="executable",jw="compressionMethod",Qw="signature",Xw="extraField",Kw=[ww,xw,Iw,Sw,Ow,Rw,Cw,Ew,Mw,Lw,Pw,Dw,Dw,Nw,Bw,Fw,Uw,kw,Vw,zw,Hw,Gw,Ww,Yw,qw,jw,Qw,Xw,"bitFlag","filenameUTF8","commentUTF8","rawExtraField","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","extraFieldNTFS","extraFieldExtendedTimestamp"];class $w{constructor(e){Kw.forEach(t=>this[t]=e[t])}}const Jw="password",Zw="rawPassword",ex="passThrough",tx="signal",nx="useWebWorkers",ix="useCompressionStream",ox="preventClose",rx="supportZip64SplitFile",sx="offset",ax="usdz",cx="File format is not recognized",lx="Compression method not supported",ux="Split zip file",dx="utf-8",hx="cp437",Ax=[[Sw,sT],[Iw,sT],[Pw,sT],[Dw,aT]],px={[aT]:{getValue:Cx,bytes:4},[sT]:{getValue:Ex,bytes:8}};class fx{constructor(e,t={}){Object.assign(this,{reader:new mw(e),options:t,config:PT(),readRanges:[]})}async*getEntriesGenerator(e={}){const t=this;let{reader:n}=t;const{config:i}=t;if(await _w(n),n.size!==bT&&n.readUint8Array||(n=new uw(await new Response(n.readable).blob()),await _w(n)),n.size<fT)throw new Error(cx);n.chunkSize=DT(i);const o=await async function(e,t,n){const i=new Uint8Array(4);var o,r;o=Sx(i),r=t,o.setUint32(0,r,!0);return await s(22)||await s(Math.min(1048582,n));async function s(t){const o=n-t,r=await yw(e,o,t);for(let e=r.length-22;e>=0;e--)if(r[e]==i[0]&&r[e+1]==i[1]&&r[e+2]==i[2]&&r[e+3]==i[3])return{offset:o+e,buffer:r.slice(e,e+22).buffer}}}(n,hT,n.size);if(!o)throw Cx(Sx(await yw(n,0,4)))==lT?new Error(ux):new Error("End of central directory not found");const r=Sx(o);let s=Cx(r,12),a=Cx(r,16);const c=o.offset,l=xx(r,20),u=c+fT+l;let d=xx(r,4);const h=n.lastDiskNumber||0;let A=xx(r,6),p=xx(r,8),f=0,m=0;if(a==sT||s==sT||p==aT||A==aT){const e=Sx(await yw(n,o.offset-20,20));if(Cx(e,0)==pT){a=Ex(e,8);let t=await yw(n,a,56,-1),i=Sx(t);const r=o.offset-20-56;if(Cx(i,0)!=AT&&a!=r){const e=a;a=r,a>e&&(f=a-e),t=await yw(n,a,56,-1),i=Sx(t)}if(Cx(i,0)!=AT)throw new Error("End of Zip64 central directory locator not found");d==aT&&(d=Cx(i,16)),A==aT&&(A=Cx(i,20)),p==aT&&(p=Ex(i,32)),s==sT&&(s=Ex(i,40)),a-=s}}if(a>=n.size&&(f=n.size-a-s-fT,a=n.size-s-fT),h!=d)throw new Error(ux);if(a<0)throw new Error(cx);let g=0,_=await yw(n,a,s,A),y=Sx(_);if(s){const e=o.offset-s;if(Cx(y,g)!=dT&&a!=e){const t=a;a=e,a>t&&(f+=a-t),_=await yw(n,a,s,A),y=Sx(_)}}const v=o.offset-a-(n.lastDiskOffset||0);if(s!=v&&v>=0&&(s=v,_=await yw(n,a,s,A),y=Sx(_)),a<0||a>=n.size)throw new Error(cx);const T=vx(t,e,"filenameEncoding"),b=vx(t,e,"commentEncoding");for(let o=0;o<p;o++){const r=new mx(n,i,t.options);if(Cx(y,g)!=dT)throw new Error("Central directory header not found");gx(r,y,g+6);const s=Boolean(r.bitFlag.languageEncodingFlag),a=g+46,c=a+r.filenameLength,l=c+r.extraFieldLength,u=xx(y,g+4),d=!(u>>8),h=u>>8==3,A=_.subarray(a,c),v=xx(y,g+32),w=l+v,x=_.subarray(l,w),C=s,E=s,S=Cx(y,g+38),I=d&&!(16&~wx(y,g+38))||h&&16384==(S>>16&61440)||A.length&&A.at(-1)==_T.charCodeAt(0),P=h&&!!(S>>16&73),D=Cx(y,g+42)+f;Object.assign(r,{versionMadeBy:u,msDosCompatible:d,compressedSize:0,uncompressedSize:0,commentLength:v,directory:I,offset:D,diskNumberStart:xx(y,g+34),internalFileAttributes:xx(y,g+36),externalFileAttributes:S,rawFilename:A,filenameUTF8:C,commentUTF8:E,rawExtraField:_.subarray(c,l),executable:P}),r.internalFileAttribute=r.internalFileAttributes,r.externalFileAttribute=r.externalFileAttributes;const O=vx(t,e,"decodeText")||bw,R=C?dx:T||hx,M=E?dx:b||hx;let L=O(A,R);L===bT&&(L=bw(A,R));let N=O(x,M);N===bT&&(N=bw(x,M)),Object.assign(r,{rawComment:x,filename:L,comment:N,directory:I||L.endsWith(_T)}),m=Math.max(D,m),_x(r,r,y,g+6),r.zipCrypto=r.encrypted&&!r.extraFieldAES;const B=new $w(r);B.getData=(e,n)=>r.getData(e,B,t.readRanges,n),B.arrayBuffer=async e=>{const n=new TransformStream,[i]=await Promise.all([new Response(n.readable).arrayBuffer(),r.getData(n,B,t.readRanges,e)]);return i},g=w;const{onprogress:F}=e;if(F)try{await F(o+1,p,new $w(r))}catch(e){}yield B}const w=vx(t,e,"extractPrependedData"),x=vx(t,e,"extractAppendedData");return w&&(t.prependedData=m>0?await yw(n,0,m):new Uint8Array),t.comment=l?await yw(n,c+fT,l):new Uint8Array,x&&(t.appendedData=u<n.size?await yw(n,u,n.size-u):new Uint8Array),!0}async getEntries(e={}){const t=[];for await(const n of this.getEntriesGenerator(e))t.push(n);return t}async close(){}}class mx{constructor(e,t,n){Object.assign(this,{reader:e,config:t,options:n})}async getData(e,t,n,i={}){const o=this,{reader:r,offset:s,diskNumberStart:a,extraFieldAES:c,extraFieldZip64:l,compressionMethod:u,config:d,bitFlag:h,signature:A,rawLastModDate:p,uncompressedSize:f,compressedSize:m}=o,{dataDescriptor:g}=h,_=t.localDirectory={},y=Sx(await yw(r,s,yT,a));let v=vx(o,i,Jw),T=vx(o,i,Zw);const b=vx(o,i,ex);if(v=v&&v.length&&v,T=T&&T.length&&T,c&&99!=c.originalCompressionMethod)throw new Error(lx);if(0!=u&&8!=u&&!b)throw new Error(lx);if(Cx(y,0)!=cT)throw new Error("Local file header not found");gx(_,y,4);const{extraFieldLength:w,filenameLength:x,lastAccessDate:C,creationDate:E}=_;_.rawExtraField=w?await yw(r,s+yT+x,w,a):new Uint8Array,_x(o,_,y,4,!0),Object.assign(t,{lastAccessDate:C,creationDate:E});const S=o.encrypted&&_.encrypted&&!b,I=S&&!c;if(b||(t.zipCrypto=I),S){if(!I&&c.strength===bT)throw new Error("Encryption method not supported");if(!v&&!T)throw new Error("File contains encrypted entry")}const P=s+yT+x+w,D=m,O=r.readable;Object.assign(O,{diskNumberStart:a,offset:P,size:D});const R=vx(o,i,tx),M=vx(o,i,"checkPasswordOnly");let L=vx(o,i,"checkOverlappingEntry");const N=vx(o,i,"checkOverlappingEntryOnly");N&&(L=!0);const{onstart:B,onprogress:F,onend:U}=i,k={options:{codecType:zb,password:v,rawPassword:T,zipCrypto:I,encryptionStrength:c&&c.strength,signed:vx(o,i,"checkSignature")&&!b,passwordVerification:I&&(g?p>>>8&255:A>>>24&255),outputSize:f,signature:A,compressed:0!=u&&!b,encrypted:o.encrypted&&!b,useWebWorkers:vx(o,i,nx),useCompressionStream:vx(o,i,ix),transferStreams:vx(o,i,"transferStreams"),checkPasswordOnly:M},config:d,streamOptions:{signal:R,size:D,onstart:B,onprogress:F,onend:U}};let V;L&&await async function({reader:e,fileEntry:t,offset:n,diskNumberStart:i,signature:o,compressedSize:r,uncompressedSize:s,dataOffset:a,dataDescriptor:c,extraFieldZip64:l,readRanges:u}){let d=0;if(i)for(let t=0;t<i;t++)d+=e.readers[t].size;let h=0;if(c&&(h=l?20:12),h){const n=await yw(e,a+r,h+4,i);if(Cx(Sx(n),0)==uT){const e=Cx(Sx(n),4);let i,a;l?(i=Ex(Sx(n),8),a=Ex(Sx(n),16)):(i=Cx(Sx(n),8),a=Cx(Sx(n),12)),(t.encrypted&&!t.zipCrypto||e==o)&&i==r&&a==s&&(h+=4)}}const A={start:d+n,end:d+a+r+h,fileEntry:t};for(const e of u)if(e.fileEntry!=t&&A.start>=e.start&&A.start<e.end){const t=new Error("Overlapping entry found");throw t.overlappingEntry=e.fileEntry,t}u.push(A)}({reader:r,fileEntry:t,offset:s,diskNumberStart:a,signature:A,compressedSize:m,uncompressedSize:f,dataOffset:P,dataDescriptor:g||_.bitFlag.dataDescriptor,extraFieldZip64:l||_.extraFieldZip64,readRanges:n});try{if(!N){M&&(e=new WritableStream),e=new gw(e),await _w(e,b?m:f),({writable:V}=e);const{outputSize:t}=await nw({readable:O,writable:V},k);if(e.size+=t,t!=(b?m:f))throw new Error(Ob)}}catch(t){if(t.outputSize!==bT&&(e.size+=t.outputSize),!M||t.message!=jT)throw t}finally{vx(o,i,ox)||!V||V.locked||await V.getWriter().close()}return M||N?bT:e.getData?e.getData():V}}function gx(e,t,n){const i=e.rawBitFlag=xx(t,n+2),o=!(1&~i),r=Cx(t,n+6);Object.assign(e,{encrypted:o,version:xx(t,n),bitFlag:{level:(6&i)>>1,dataDescriptor:!(8&~i),languageEncodingFlag:(i&gT)==gT},rawLastModDate:r,lastModDate:Tx(r),filenameLength:xx(t,n+22),extraFieldLength:xx(t,n+24)})}function _x(e,t,n,i,o){const{rawExtraField:r}=t,s=t.extraField=new Map,a=Sx(new Uint8Array(r));let c=0;try{for(;c<r.length;){const e=xx(a,c),t=xx(a,c+2);s.set(e,{type:e,data:r.slice(c+4,c+4+t)}),c+=4+t}}catch(e){}const l=xx(n,i+4);Object.assign(t,{signature:Cx(n,i+10),compressedSize:Cx(n,i+14),uncompressedSize:Cx(n,i+18)});const u=s.get(1);u&&(function(e,t){t.zip64=!0;const n=Sx(e.data),i=Ax.filter(([e,n])=>t[e]==n);for(let o=0,r=0;o<i.length;o++){const[s,a]=i[o];if(t[s]==a){const i=px[a];t[s]=e[s]=i.getValue(n,r),r+=i.bytes}else if(e[s])throw new Error("Zip64 extra field not found")}}(u,t),t.extraFieldZip64=u);const d=s.get(28789);d&&(yx(d,ww,xw,t,e),t.extraFieldUnicodePath=d);const h=s.get(25461);h&&(yx(h,Cw,Ew,t,e),t.extraFieldUnicodeComment=h);const A=s.get(39169);A?(function(e,t,n){const i=Sx(e.data),o=wx(i,4);Object.assign(e,{vendorVersion:wx(i,0),vendorId:wx(i,2),strength:o,originalCompressionMethod:n,compressionMethod:xx(i,5)}),t.compressionMethod=e.compressionMethod}(A,t,l),t.extraFieldAES=A):t.compressionMethod=l;const p=s.get(10);p&&(function(e,t){const n=Sx(e.data);let i,o=4;try{for(;o<e.data.length&&!i;){const t=xx(n,o),r=xx(n,o+2);1==t&&(i=e.data.slice(o+4,o+4+r)),o+=4+r}}catch(e){}try{if(i&&24==i.length){const n=Sx(i),o=n.getBigUint64(0,!0),r=n.getBigUint64(8,!0),s=n.getBigUint64(16,!0);Object.assign(e,{rawLastModDate:o,rawLastAccessDate:r,rawCreationDate:s});const a=bx(o),c={lastModDate:a,lastAccessDate:bx(r),creationDate:bx(s)};Object.assign(e,c),Object.assign(t,c)}}catch(e){}}(p,t),t.extraFieldNTFS=p);const f=s.get(mT);f&&(function(e,t,n){const i=Sx(e.data),o=wx(i,0),r=[],s=[];n?(1&~o||(r.push(Ow),s.push(Rw)),2&~o||(r.push(Mw),s.push("rawLastAccessDate")),4&~o||(r.push(Lw),s.push("rawCreationDate"))):e.data.length>=5&&(r.push(Ow),s.push(Rw));let a=1;r.forEach((n,o)=>{if(e.data.length>=a+4){const r=Cx(i,a);t[n]=e[n]=new Date(1e3*r);const c=s[o];e[c]=r}a+=4})}(f,t,o),t.extraFieldExtendedTimestamp=f);const m=s.get(6534);m&&(t.extraFieldUSDZ=m)}function yx(e,t,n,i,o){const r=Sx(e.data),s=new LT;s.append(o[n]);const a=Sx(new Uint8Array(4));a.setUint32(0,s.get(),!0);const c=Cx(r,1);Object.assign(e,{version:wx(r,0),[t]:bw(e.data.subarray(5)),valid:!o.bitFlag.languageEncodingFlag&&c==Cx(a,0)}),e.valid&&(i[t]=e[t],i[t+"UTF8"]=!0)}function vx(e,t,n){return t[n]===bT?e.options[n]:t[n]}function Tx(e){const t=(4294901760&e)>>16,n=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&n)>>11,(2016&n)>>5,2*(31&n),0)}catch(e){}}function bx(e){return new Date(Number(e/BigInt(1e4)-BigInt(116444736e5)))}function wx(e,t){return e.getUint8(t)}function xx(e,t){return e.getUint16(t,!0)}function Cx(e,t){return e.getUint32(t,!0)}function Ex(e,t){return Number(e.getBigUint64(t,!0))}function Sx(e){return new DataView(e.buffer)}const Ix="Version exceeds 65535",Px="Zip64 is not supported (make sure 'keepOrder' is set to 'true')",Dx=new Uint8Array([7,0,2,0,65,69,3,0,0]);let Ox=0;const Rx=[];class Mx{constructor(e,t={}){const n=(e=new gw(e)).availableSize!==bT&&e.availableSize>0&&e.availableSize!==1/0&&e.maxSize!==bT&&e.maxSize>0&&e.maxSize!==1/0;Object.assign(this,{writer:e,addSplitZipSignature:n,options:t,config:PT(),files:new Map,filenames:new Set,offset:t[sx]===bT?e.size||e.writable.size||0:t[sx],pendingEntriesSize:0,pendingAddFileCalls:new Set,bufferedWrites:0})}async prependZip(e){if(this.filenames.size)throw new Error("Zip file not empty");e=new mw(e);const t=new fx(e.readable),n=await t.getEntries();await t.close(),await e.readable.pipeTo(this.writer.writable,{preventClose:!0,preventAbort:!0}),this.writer.size=this.offset=e.size,this.filenames=new Set(n.map(e=>e.filename)),this.files=new Map(n.map(e=>{const{version:t,compressionMethod:n,lastModDate:i,lastAccessDate:o,creationDate:r,rawFilename:s,bitFlag:a,encrypted:c,uncompressedSize:l,compressedSize:u,diskOffset:d,diskNumber:h,zip64:A}=e;let{rawExtraFieldZip64:p,rawExtraFieldAES:f,rawExtraFieldExtendedTimestamp:m,rawExtraFieldNTFS:g,rawExtraField:_}=e;const{level:y,languageEncodingFlag:v,dataDescriptor:T}=a;p=p||new Uint8Array,f=f||new Uint8Array,m=m||new Uint8Array,g=g||new Uint8Array,_=_||new Uint8Array;const b=Yx(p,f,m,g,_),w=A&&l>sT,x=A&&u>sT,{headerArray:C,headerView:E}=qx({version:t,bitFlag:jx(y,v,T,c,n),compressionMethod:n,uncompressedSize:l,compressedSize:u,lastModDate:i,rawFilename:s,zip64CompressedSize:x,zip64UncompressedSize:w,extraFieldLength:b});return Object.assign(e,{zip64UncompressedSize:w,zip64CompressedSize:x,zip64Offset:A&&this.offset-d>sT,zip64DiskNumberStart:A&&h>aT,rawExtraFieldZip64:p,rawExtraFieldAES:f,rawExtraFieldExtendedTimestamp:m,rawExtraFieldNTFS:g,rawExtraField:_,extendedTimestamp:m.length>0||g.length>0,extraFieldExtendedTimestampFlag:1+(o?2:0)+(r?4:0),headerArray:C,headerView:E}),[e.filename,e]}))}async add(e="",t,n={}){const i=this,{pendingAddFileCalls:o,config:r}=i;let s;Ox<r.maxWorkers?Ox++:await new Promise(e=>Rx.push(e));try{if(e=e.trim(),i.filenames.has(e))throw new Error("File already exists");return i.filenames.add(e),s=async function(e,t,n,i){t=t.trim();const o=Fx(e,i,kw),r=Fx(e,i,Gw,o?20:768),s=Fx(e,i,qw);if(r>aT)throw new Error(Ix);let a=Fx(e,i,Uw,0);0===a&&(a=Fx(e,i,Fw,0)),!i[Yw]&&t.endsWith(_T)&&(i[Yw]=!0);Fx(e,i,Yw)?(t.endsWith(_T)||(t+=_T),0===a&&(a=16,o||(a|=16877<<16))):o||0!==a||(a=s?493<<16:27525120);const c=Fx(e,i,"encodeText",BT);let l=c(t);if(l===bT&&(l=BT(t)),Yx(l)>aT)throw new Error("File entry name exceeds 64KB");const u=i[Cw]||"";let d=c(u);if(d===bT&&(d=BT(u)),Yx(d)>aT)throw new Error("File entry comment exceeds 64KB");const h=Fx(e,i,Hw,20);if(h>aT)throw new Error(Ix);const A=Fx(e,i,Ow,new Date),p=Fx(e,i,Mw),f=Fx(e,i,Lw);let m=Fx(e,i,Bw,0);0===m&&(m=Fx(e,i,Nw,0));const g=Fx(e,i,ex);let _,y;g||(_=Fx(e,i,Jw),y=Fx(e,i,Zw));const v=Fx(e,i,"encryptionStrength",3),T=Fx(e,i,Ww),b=Fx(e,i,"extendedTimestamp",!0),w=Fx(e,i,"keepOrder",!0),x=Fx(e,i,"level"),C=Fx(e,i,nx),E=Fx(e,i,"bufferedWrite"),S=Fx(e,i,"dataDescriptorSignature",!1),I=Fx(e,i,tx),P=Fx(e,i,"useUnicodeFileNames",!0),D=Fx(e,i,ix),O=Fx(e,i,jw);let R=Fx(e,i,"dataDescriptor");E&&R===bT&&(R=!1),(R===bT||T)&&(R=!0);let M=Fx(e,i,Vw);if(!(T||_===bT&&y===bT||v>=1&&v<=3))throw new Error("The strength must equal 1, 2, or 3");let L=new Uint8Array;const N=i[Xw];if(N){let e=0,t=0;N.forEach(t=>e+=4+Yx(t)),L=new Uint8Array(e),N.forEach((e,n)=>{if(n>aT)throw new Error("Extra field type exceeds 65535");if(Yx(e)>aT)throw new Error("Extra field data exceeds 64KB");Gx(L,new Uint16Array([n]),t),Gx(L,new Uint16Array([Yx(e)]),t+2),Gx(L,e,t+4),t+=4+Yx(e)})}let B=0,F=0,U=0;if(g&&(U=i[Sw],U===bT))throw new Error("Undefined uncompressed size");const k=!0===M;n&&(n=new mw(n),await _w(n),g?(i.uncompressedSize=U,B=Ux(U)):n.size===bT?(R=!0,(M||M===bT)&&(M=!0,U=B=4294967296)):(i.uncompressedSize=U=n.size,B=Ux(U)));const{diskOffset:V,diskNumber:z,maxSize:H}=e.writer,G=k||U>sT,W=k||B>sT,Y=k||e.offset+e.pendingEntriesSize-V>sT,q=Fx(e,i,rx,!0)&&k||z+Math.ceil(e.pendingEntriesSize/H)>aT;if(Y||G||W||q){if(!1===M||!w)throw new Error(Px);M=!0}M=M||!1;const j=Fx(e,i,zw),Q=function(e){const{rawFilename:t,lastModDate:n,lastAccessDate:i,creationDate:o,level:r,zip64:s,zipCrypto:a,useUnicodeFileNames:c,dataDescriptor:l,directory:u,rawExtraField:d,encryptionStrength:h,extendedTimestamp:A,passThrough:p,encrypted:f,zip64UncompressedSize:m,zip64CompressedSize:g,zip64Offset:_,zip64DiskNumberStart:y,uncompressedSize:v,offset:T,diskNumberStart:b}=e;let{version:w,compressionMethod:x}=e;const C=!u&&(r>0||r===bT&&0!==x);let E;const S=p||!C,I=s&&(e.bufferedWrite||!m&&!g||S);if(s){let e=4;m&&(e+=8),g&&(e+=8),_&&(e+=8),y&&(e+=4),E=new Uint8Array(e);const t=Wx(E);if(Vx(t,0,1),Vx(t,2,Yx(E)-4),I){const e=Wx(E);let t=4;m&&(Hx(e,t,BigInt(v)),t+=8),g&&S&&(Hx(e,t,BigInt(v)),t+=8),_&&(Hx(e,t,BigInt(T)),t+=8),y&&(zx(e,t,b),t+=4)}}else E=new Uint8Array;let P,D,O,R;if(f&&!a){P=new Uint8Array(Yx(Dx)+2);const e=Wx(P);Vx(e,0,39169),Gx(P,Dx,2),kx(e,8,h)}else P=new Uint8Array;if(A){O=new Uint8Array(9+(i?4:0)+(o?4:0));const e=Wx(O);Vx(e,0,mT),Vx(e,2,Yx(O)-4),R=1+(i?2:0)+(o?4:0),kx(e,4,R);let t=5;zx(e,t,Math.floor(n.getTime()/1e3)),t+=4,i&&(zx(e,t,Math.floor(i.getTime()/1e3)),t+=4),o&&zx(e,t,Math.floor(o.getTime()/1e3));try{D=new Uint8Array(36);const e=Wx(D),t=Bx(n);Vx(e,0,10),Vx(e,2,32),Vx(e,8,1),Vx(e,10,24),Hx(e,12,t),Hx(e,20,Bx(i)||t),Hx(e,28,Bx(o)||t)}catch(e){D=new Uint8Array}}else D=O=new Uint8Array;x===bT&&(x=C?8:0),s&&(w=w>45?w:45),f&&!a&&(w=w>51?w:51,P[9]=x,x=99);const M=I?Yx(E):0,L=M+Yx(P,O,D,d),{headerArray:N,headerView:B,rawLastModDate:F}=qx({version:w,bitFlag:jx(r,c,l,f,x),compressionMethod:x,uncompressedSize:v,lastModDate:n<TT?TT:n>vT?vT:n,rawFilename:t,zip64CompressedSize:g,zip64UncompressedSize:m,extraFieldLength:L});let U=yT;const k=new Uint8Array(U+Yx(t)+L),V=Wx(k);return zx(V,0,cT),Gx(k,N,4),Gx(k,t,U),U+=Yx(t),I&&Gx(k,E,U),U+=M,Gx(k,P,U),U+=Yx(P),Gx(k,O,U),U+=Yx(O),Gx(k,D,U),U+=Yx(D),Gx(k,d,U),l&&(zx(V,18,0),zx(V,22,0)),{localHeaderArray:k,localHeaderView:V,headerArray:N,headerView:B,lastModDate:n,rawLastModDate:F,encrypted:f,compressed:C,version:w,compressionMethod:x,extraFieldExtendedTimestampFlag:R,rawExtraFieldZip64:E,localExtraFieldZip64Length:M,rawExtraFieldExtendedTimestamp:O,rawExtraFieldNTFS:D,rawExtraFieldAES:P,extraFieldLength:L}}(i=Object.assign({},i,{rawFilename:l,rawComment:d,version:h,versionMadeBy:r,lastModDate:A,lastAccessDate:p,creationDate:f,rawExtraField:L,zip64:M,zip64UncompressedSize:G,zip64CompressedSize:W,zip64Offset:Y,zip64DiskNumberStart:q,password:_,rawPassword:y,level:D||e.config.CompressionStream!==bT||e.config.CompressionStreamNative!==bT?x:0,useWebWorkers:C,encryptionStrength:v,extendedTimestamp:b,zipCrypto:T,bufferedWrite:E,keepOrder:w,useUnicodeFileNames:P,dataDescriptor:R,dataDescriptorSignature:S,signal:I,msDosCompatible:o,internalFileAttribute:m,internalFileAttributes:m,externalFileAttribute:a,externalFileAttributes:a,useCompressionStream:D,passThrough:g,encrypted:Boolean(_&&Yx(_)||y&&Yx(y))||g&&j,signature:i[Qw],compressionMethod:O,uncompressedSize:U,offset:e.offset-V,diskNumberStart:z})),X=function({zip64:e,dataDescriptor:t,dataDescriptorSignature:n}){let i,o=new Uint8Array,r=0,s=e?20:12;return n&&(s+=4),t&&(o=new Uint8Array(s),i=Wx(o),n&&(r=4,zx(i,0,uT))),{dataDescriptorArray:o,dataDescriptorView:i,dataDescriptorOffset:r}}(i),K=Yx(Q.localHeaderArray,X.dataDescriptorArray);let $;F=K+B,e.options[ax]&&(F+=F+64),e.pendingEntriesSize+=F;try{$=await async function(e,t,n,i,o){const{files:r,writer:s}=e,{keepOrder:a,dataDescriptor:c,signal:l}=o,{headerInfo:u}=i,d=e.options[ax],h=Array.from(r.values()).pop();let A,p,f,m,g,_,y,v={};r.set(t,v);try{let p;a&&(p=h&&h.lock,v.lock=new Promise(e=>f=e)),!(o.bufferedWrite||e.writerLocked||e.bufferedWrites&&a)&&c||d?(_=s,await T()):(_=new TransformStream,_.size=0,A=!0,e.bufferedWrites++,await _w(s)),await _w(_);const{writable:w,diskOffset:x}=s;if(e.addSplitZipSignature){delete e.addSplitZipSignature;const t=new Uint8Array(4);zx(Wx(t),0,lT),await Nx(s,t),e.offset+=4}d&&function(e,t){const{headerInfo:n}=e;let{localHeaderArray:i,extraFieldLength:o}=n,r=Wx(i),s=64-(t+Yx(i))%64;s<4&&(s+=64);const a=new Uint8Array(s),c=Wx(a);Vx(c,0,6534),Vx(c,2,s-2);const l=i;n.localHeaderArray=i=new Uint8Array(Yx(l)+s),Gx(i,l),Gx(i,a,Yx(l)),r=Wx(i),Vx(r,28,o+s),e.metadataSize+=s}(i,e.offset-x);const{localHeaderView:C,localHeaderArray:E}=u;A||(await p,await b(w));const{diskNumber:S}=s;g=!0,v.diskNumberStart=S,A?y=new Response(_.readable).blob():await Nx(_,E),v=await async function(e,t,{diskNumberStart:n,lock:i},o,r,s){const{headerInfo:a,dataDescriptorInfo:c,metadataSize:l}=o,{headerArray:u,headerView:d,lastModDate:h,rawLastModDate:A,encrypted:p,compressed:f,version:m,compressionMethod:g,rawExtraFieldZip64:_,localExtraFieldZip64Length:y,rawExtraFieldExtendedTimestamp:v,extraFieldExtendedTimestampFlag:T,rawExtraFieldNTFS:b,rawExtraFieldAES:w}=a,{dataDescriptorArray:x}=c,{rawFilename:C,lastAccessDate:E,creationDate:S,password:I,rawPassword:P,level:D,zip64:O,zip64UncompressedSize:R,zip64CompressedSize:M,zip64Offset:L,zip64DiskNumberStart:N,zipCrypto:B,dataDescriptor:F,directory:U,executable:k,versionMadeBy:V,rawComment:z,rawExtraField:H,useWebWorkers:G,onstart:W,onprogress:Y,onend:q,signal:j,encryptionStrength:Q,extendedTimestamp:X,msDosCompatible:K,internalFileAttributes:$,externalFileAttributes:J,useCompressionStream:Z,passThrough:ee}=s,te={lock:i,versionMadeBy:V,zip64:O,directory:Boolean(U),executable:Boolean(k),filenameUTF8:!0,rawFilename:C,commentUTF8:!0,rawComment:z,rawExtraFieldZip64:_,localExtraFieldZip64Length:y,rawExtraFieldExtendedTimestamp:v,rawExtraFieldNTFS:b,rawExtraFieldAES:w,rawExtraField:H,extendedTimestamp:X,msDosCompatible:K,internalFileAttributes:$,externalFileAttributes:J,diskNumberStart:n};let{signature:ne,uncompressedSize:ie}=s,oe=0;ee||(ie=0);const{writable:re}=t;if(e){e.chunkSize=DT(r);const n=e.readable,i=e.size,o={options:{codecType:Vb,level:D,rawPassword:P,password:I,encryptionStrength:Q,zipCrypto:p&&B,passwordVerification:p&&B&&A>>8&255,signed:!ee,compressed:f&&!ee,encrypted:p&&!ee,useWebWorkers:G,useCompressionStream:Z,transferStreams:!1},config:r,streamOptions:{signal:j,size:i,onstart:W,onprogress:Y,onend:q}};try{const e=await nw({readable:n,writable:re},o);oe=e.outputSize,t.size+=oe,ee||(ie=e.inputSize,ne=e.signature)}catch(e){throw e.outputSize!==bT&&(t.size+=e.outputSize),e}}return function({signature:e,compressedSize:t,uncompressedSize:n,headerInfo:i,dataDescriptorInfo:o},{zip64:r,zipCrypto:s,dataDescriptor:a}){const{headerView:c,encrypted:l}=i,{dataDescriptorView:u,dataDescriptorOffset:d}=o;l&&!s||e===bT||(zx(c,10,e),a&&zx(u,d,e)),r?a&&(Hx(u,d+4,BigInt(t)),Hx(u,d+12,BigInt(n))):(zx(c,14,t),zx(c,18,n),a&&(zx(u,d+4,t),zx(u,d+8,n)))}({signature:ne,compressedSize:oe,uncompressedSize:ie,headerInfo:a,dataDescriptorInfo:c},s),F&&await Nx(t,x),Object.assign(te,{uncompressedSize:ie,compressedSize:oe,lastModDate:h,rawLastModDate:A,creationDate:S,lastAccessDate:E,encrypted:p,zipCrypto:B,size:l+oe,compressionMethod:g,version:m,headerArray:u,headerView:d,signature:ne,extraFieldExtendedTimestampFlag:T,zip64UncompressedSize:R,zip64CompressedSize:M,zip64Offset:L,zip64DiskNumberStart:N}),te}(n,_,v,i,e.config,o);const{zip64:I}=v;if(g=!1,r.set(t,v),v.filename=t,A){const[t]=await Promise.all([y,_.writable.getWriter().close(),p]);await T(),m=!0,v.diskNumberStart=s.diskNumber,v.offset=e.offset-s.diskOffset,I&&Lx(v),function({rawFilename:e,encrypted:t,zip64:n,localExtraFieldZip64Length:i,signature:o,compressedSize:r,uncompressedSize:s,offset:a,diskNumberStart:c,zip64UncompressedSize:l,zip64CompressedSize:u,zip64Offset:d,zip64DiskNumberStart:h},A,{dataDescriptor:p}){if(p||(t||zx(A,14,o),n||(zx(A,18,r),zx(A,22,s))),n&&i){let t=yT+Yx(e)+4;l&&(Hx(A,t,BigInt(s)),t+=8),u&&(Hx(A,t,BigInt(r)),t+=8),d&&(Hx(A,t,BigInt(a)),t+=8),h&&zx(A,t,c)}}(v,C,o),await b(w),await Nx(s,E),await t.stream().pipeTo(w,{preventClose:!0,preventAbort:!0,signal:l}),s.size+=_.size,m=!1}else v.offset=e.offset-x,I&&Lx(v);if(v.offset>sT&&!I)throw new Error(Px);return e.offset+=v.size,v}catch(n){if(A&&m||!A&&g){if(e.hasCorruptedEntries=!0,n)try{n.corruptedEntry=!0}catch(e){}A?e.offset+=_.size:e.offset=_.size}throw r.delete(t),n}finally{A&&e.bufferedWrites--,f&&f(),p&&p()}async function T(){e.writerLocked=!0;const{lockWriter:t}=e;e.lockWriter=new Promise(t=>p=()=>{e.writerLocked=!1,t()}),await t}async function b(e){Yx(u.localHeaderArray)>s.availableSize&&(s.availableSize=0,await Nx(e,new Uint8Array))}}(e,t,n,{headerInfo:Q,dataDescriptorInfo:X,metadataSize:K},i)}finally{e.pendingEntriesSize-=F}return Object.assign($,{name:t,comment:u,extraField:N}),new $w($)}(i,e,t,n),o.add(s),await s}catch(t){throw i.filenames.delete(e),t}finally{o.delete(s);const e=Rx.shift();e?e():Ox--}}remove(e){const{filenames:t,files:n}=this;if("string"==typeof e&&(e=n.get(e)),e&&e.filename!==bT){const{filename:i}=e;if(t.has(i)&&n.has(i))return t.delete(i),n.delete(i),!0}return!1}async close(e=new Uint8Array,t={}){const{pendingAddFileCalls:n,writer:i}=this,{writable:o}=i;for(;n.size;)await Promise.allSettled(Array.from(n));return await async function(e,t,n){const{files:i,writer:o}=e,{diskOffset:r}=o;let{diskNumber:s}=o,a=0,c=0,l=e.offset-r,u=i.size;for(const[,e]of i){const{rawFilename:t,rawExtraFieldZip64:n,rawExtraFieldAES:i,rawComment:o,rawExtraFieldNTFS:r,rawExtraField:s,extendedTimestamp:a,extraFieldExtendedTimestampFlag:l,lastModDate:u}=e;let d;if(a){d=new Uint8Array(9);const e=Wx(d);Vx(e,0,mT),Vx(e,2,5),kx(e,4,l),zx(e,5,Math.floor(u.getTime()/1e3))}else d=new Uint8Array;e.rawExtraFieldExtendedTimestamp=d,c+=46+Yx(t,o,n,i,r,d,s)}const d=new Uint8Array(c),h=Wx(d);await _w(o);let A=0;for(const[e,t]of Array.from(i.values()).entries()){const{offset:r,rawFilename:s,rawExtraFieldZip64:c,rawExtraFieldAES:l,rawExtraFieldExtendedTimestamp:u,rawExtraFieldNTFS:p,rawExtraField:f,rawComment:m,versionMadeBy:g,headerArray:_,headerView:y,zip64:v,zip64UncompressedSize:T,zip64CompressedSize:b,zip64DiskNumberStart:w,zip64Offset:x,internalFileAttributes:C,externalFileAttributes:E,diskNumberStart:S,uncompressedSize:I,compressedSize:P}=t,D=Yx(c,l,u,p,f);zx(h,a,dT),Vx(h,a+4,g),T||zx(y,18,I),b||zx(y,14,P),Gx(d,_,a+6);let O=a+yT;if(Vx(h,O,D),O+=2,Vx(h,O,Yx(m)),O+=2,Vx(h,O,v&&w?aT:S),O+=2,Vx(h,O,C),O+=2,E&&zx(h,O,E),O+=4,zx(h,O,v&&x?sT:r),O+=4,Gx(d,s,O),O+=Yx(s),Gx(d,c,O),O+=Yx(c),Gx(d,l,O),O+=Yx(l),Gx(d,u,O),O+=Yx(u),Gx(d,p,O),O+=Yx(p),Gx(d,f,O),O+=Yx(f),Gx(d,m,O),a-A>o.availableSize&&(o.availableSize=0,await Nx(o,d.slice(A,a)),A=a),a=O,n.onprogress)try{await n.onprogress(e+1,i.size,new $w(t))}catch(e){}}await Nx(o,A?d.slice(A):d);let p=o.diskNumber;const{availableSize:f}=o;f<fT&&p++;let m=Fx(e,n,Vw);if(l>sT||c>sT||u>aT||p>aT){if(!1===m)throw new Error(Px);m=!0}const g=new Uint8Array(m?98:fT),_=Wx(g);a=0,m&&(zx(_,0,AT),Hx(_,4,BigInt(44)),Vx(_,12,45),Vx(_,14,45),zx(_,16,p),zx(_,20,s),Hx(_,24,BigInt(u)),Hx(_,32,BigInt(u)),Hx(_,40,BigInt(c)),Hx(_,48,BigInt(l)),zx(_,56,pT),Hx(_,64,BigInt(l)+BigInt(c)),zx(_,72,p+1),Fx(e,n,rx,!0)&&(p=aT,s=aT),u=aT,l=sT,c=sT,a+=76),zx(_,a,hT),Vx(_,a+4,p),Vx(_,a+6,s),Vx(_,a+8,u),Vx(_,a+10,u),zx(_,a+12,c),zx(_,a+16,l);const y=Yx(t);if(y){if(!(y<=aT))throw new Error("Zip file comment exceeds 64KB");Vx(_,a+20,y)}await Nx(o,g),y&&await Nx(o,t)}(this,e,t),Fx(this,t,ox)||await o.getWriter().close(),i.getData?i.getData():o}}function Lx({compressedSize:e,uncompressedSize:t,offset:n,diskNumberStart:i,zip64UncompressedSize:o,zip64CompressedSize:r,zip64Offset:s,zip64DiskNumberStart:a,rawExtraFieldZip64:c}){const l=Wx(c);let u=4;o&&(Hx(l,u,BigInt(t)),u+=8),r&&(Hx(l,u,BigInt(e)),u+=8),s&&(Hx(l,u,BigInt(n)),u+=8),a&&zx(l,u,i)}async function Nx(e,t){const{writable:n}=e,i=n.getWriter();try{await i.ready,e.size+=Yx(t),await i.write(t)}finally{i.releaseLock()}}function Bx(e){if(e)return(BigInt(e.getTime())+BigInt(116444736e5))*BigInt(1e4)}function Fx(e,t,n,i){const o=t[n]===bT?e.options[n]:t[n];return o===bT?i:o}function Ux(e){return e+5*(Math.floor(e/16383)+1)}function kx(e,t,n){e.setUint8(t,n)}function Vx(e,t,n){e.setUint16(t,n,!0)}function zx(e,t,n){e.setUint32(t,n,!0)}function Hx(e,t,n){e.setBigUint64(t,n,!0)}function Gx(e,t,n){e.set(t,n)}function Wx(e){return new DataView(e.buffer)}function Yx(...e){let t=0;return e.forEach(e=>e&&(t+=e.length)),t}function qx({version:e,bitFlag:t,compressionMethod:n,uncompressedSize:i,compressedSize:o,lastModDate:r,rawFilename:s,zip64CompressedSize:a,zip64UncompressedSize:c,extraFieldLength:l}){const u=new Uint8Array(26),d=Wx(u);Vx(d,0,e),Vx(d,2,t),Vx(d,4,n);const h=new Uint32Array(1),A=Wx(h);Vx(A,0,(r.getHours()<<6|r.getMinutes())<<5|r.getSeconds()/2),Vx(A,2,(r.getFullYear()-1980<<4|r.getMonth()+1)<<5|r.getDate());const p=h[0];return zx(d,6,p),(a||o!==bT)&&zx(d,14,a?sT:o),(c||i!==bT)&&zx(d,18,c?sT:i),Vx(d,22,Yx(s)),Vx(d,24,l),{headerArray:u,headerView:d,rawLastModDate:p}}function jx(e,t,n,i,o){let r=0;return t&&(r|=gT),n&&(r|=8),8!=o&&9!=o||(e>=0&&e<=3&&(r|=6),e>3&&e<=5&&(r|=4),9==e&&(r|=2)),i&&(r|=1),r}OT({Deflate:function(e){const t=new zv,n=(i=e&&e.chunkSize?e.chunkSize:65536)+5*(Math.floor(i/16383)+1);var i;const o=new Uint8Array(n);let r=e?e.level:-1;void 0===r&&(r=-1),t.deflateInit(r),t.next_out=o,this.append=function(e,i){let r,s,a=0,c=0,l=0;const u=[];if(e.length){t.next_in_index=0,t.next_in=e,t.avail_in=e.length;do{if(t.next_out_index=0,t.avail_out=n,r=t.deflate(0),0!=r)throw new Error("deflating: "+t.msg);t.next_out_index&&(t.next_out_index==n?u.push(new Uint8Array(o)):u.push(o.subarray(0,t.next_out_index))),l+=t.next_out_index,i&&t.next_in_index>0&&t.next_in_index!=a&&(i(t.next_in_index),a=t.next_in_index)}while(t.avail_in>0||0===t.avail_out);return u.length>1?(s=new Uint8Array(l),u.forEach(function(e){s.set(e,c),c+=e.length})):s=u[0]?new Uint8Array(u[0]):new Uint8Array,s}},this.flush=function(){let e,i,r=0,s=0;const a=[];do{if(t.next_out_index=0,t.avail_out=n,e=t.deflate(4),1!=e&&0!=e)throw new Error("deflating: "+t.msg);n-t.avail_out>0&&a.push(o.slice(0,t.next_out_index)),s+=t.next_out_index}while(t.avail_in>0||0===t.avail_out);return t.deflateEnd(),i=new Uint8Array(s),a.forEach(function(e){i.set(e,r),r+=e.length}),i}},Inflate:function(e){const t=new rT,n=e&&e.chunkSize?Math.floor(2*e.chunkSize):131072,i=new Uint8Array(n);let o=!1;t.inflateInit(),t.next_out=i,this.append=function(e,r){const s=[];let a,c,l=0,u=0,d=0;if(0!==e.length){t.next_in_index=0,t.next_in=e,t.avail_in=e.length;do{if(t.next_out_index=0,t.avail_out=n,0!==t.avail_in||o||(t.next_in_index=0,o=!0),a=t.inflate(0),o&&a===Wv){if(0!==t.avail_in)throw new Error("inflating: bad input")}else if(0!==a&&1!==a)throw new Error("inflating: "+t.msg);if((o||1===a)&&t.avail_in===e.length)throw new Error("inflating: bad input");t.next_out_index&&(t.next_out_index===n?s.push(new Uint8Array(i)):s.push(i.subarray(0,t.next_out_index))),d+=t.next_out_index,r&&t.next_in_index>0&&t.next_in_index!=l&&(r(t.next_in_index),l=t.next_in_index)}while(t.avail_in>0||0===t.avail_out);return s.length>1?(c=new Uint8Array(d),s.forEach(function(e){c.set(e,u),u+=e.length})):c=s[0]?new Uint8Array(s[0]):new Uint8Array,c}},this.flush=function(){t.inflateEnd()}}});var Qx=n(116112);const Xx=function(e,t){this.position=e,this.headingPitchRange=t};function Kx(e,t){this.id=t,this.name=e,this.playlistIndex=0,this.playlist=[],this.tourStart=new Bn.A,this.tourEnd=new Bn.A,this.entryStart=new Bn.A,this.entryEnd=new Bn.A,this._activeEntries=[]}function $x(e){for(let t=e.pop();void 0!==t;t=e.pop())t.stop()}function Jx(e,t,n){const i=this.playlist[this.playlistIndex];if(i){const o=Zx.bind(this,e,t,n);if(this._activeEntries.push(i),this.entryStart.raiseEvent(i),i.blocking)i.play(o,e.scene.camera,t);else{const r=this;i.play(function(){r.entryEnd.raiseEvent(i);const e=r._activeEntries.indexOf(i);e>=0&&r._activeEntries.splice(e,1)}),o(e,t,n)}}else(0,d.A)(n)&&n(!1)}function Zx(e,t,n,i){const o=this.playlist[this.playlistIndex];if(this.entryEnd.raiseEvent(o,i),i)n(i);else{const i=this._activeEntries.indexOf(o);i>=0&&this._activeEntries.splice(i,1),this.playlistIndex++,Jx.call(this,e,t,n)}}Kx.prototype.addPlaylistEntry=function(e){this.playlist.push(e)},Kx.prototype.play=function(e,t){this.tourStart.raiseEvent();const n=this;Jx.call(this,e,t,function(e){n.playlistIndex=0,e||$x(n._activeEntries),n.tourEnd.raiseEvent(e)})},Kx.prototype.stop=function(){$x(this._activeEntries)};const eC=Kx;var tC=n(430346),nC=n(924290);function iC(e,t,n){this.type="KmlTourFlyTo",this.blocking=!0,this.activeCamera=null,this.activeCallback=null,this.duration=e,this.view=n,this.flyToMode=t}iC.prototype.play=function(e,t,n){if(this.activeCamera=t,(0,d.A)(e)&&null!==e){const t=this;this.activeCallback=function(n){delete t.activeCallback,delete t.activeCamera,e(!(0,d.A)(n)&&n)}}const i=this.getCameraOptions(n);if(this.view.headingPitchRoll)t.flyTo(i);else if(this.view.headingPitchRange){const e=new Sn.A(this.view.position);t.flyToBoundingSphere(e,i)}},iC.prototype.stop=function(){(0,d.A)(this.activeCamera)&&this.activeCamera.cancelFlight(),(0,d.A)(this.activeCallback)&&this.activeCallback(!0)},iC.prototype.getCameraOptions=function(e){let t={duration:this.duration};return(0,d.A)(this.activeCallback)&&(t.complete=this.activeCallback),"smooth"===this.flyToMode&&(t.easingFunction=nC.A.LINEAR_NONE),this.view.headingPitchRoll?(t.destination=this.view.position,t.orientation=this.view.headingPitchRoll):this.view.headingPitchRange&&(t.offset=this.view.headingPitchRange),(0,d.A)(e)&&(t=(0,tC.A)(t,e)),t};const oC=iC;function rC(e){this.type="KmlTourWait",this.blocking=!0,this.duration=e,this.timeout=null}rC.prototype.play=function(e){const t=this;this.activeCallback=e,this.timeout=setTimeout(function(){delete t.activeCallback,e(!1)},1e3*this.duration)},rC.prototype.stop=function(){clearTimeout(this.timeout),(0,d.A)(this.activeCallback)&&this.activeCallback(!0)};const sC=rC,aC={avi:"video/x-msvideo",bmp:"image/bmp",bz2:"application/x-bzip2",chm:"application/vnd.ms-htmlhelp",css:"text/css",csv:"text/csv",doc:"application/msword",dvi:"application/x-dvi",eps:"application/postscript",flv:"video/x-flv",gif:"image/gif",gz:"application/x-gzip",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",jnlp:"application/x-java-jnlp-file",jpeg:"image/jpeg",jpg:"image/jpeg",m3u:"audio/x-mpegurl",m4v:"video/mp4",mathml:"application/mathml+xml",mid:"audio/midi",midi:"audio/midi",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mp4v:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogg:"application/ogg",pdf:"application/pdf",png:"image/png",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",ps:"application/postscript",qt:"video/quicktime",rdf:"application/rdf+xml",rss:"application/rss+xml",rtf:"application/rtf",svg:"image/svg+xml",swf:"application/x-shockwave-flash",text:"text/plain",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/x-wav",wma:"audio/x-ms-wma",wmv:"video/x-ms-wmv",xml:"application/xml",zip:"application/zip",detectFromFilename:function(e){let t=e.toLowerCase();return t=(0,Tv.A)(t),aC[t]}};let cC;"undefined"!=typeof DOMParser&&(cC=new DOMParser);const lC=new Hy({stripPrefix:!1,email:!1,replaceFn:function(e){return"scheme"===e.urlMatchType||"www"===e.urlMatchType}}),uC=32,dC=2414016,hC=16093e3,AC=[null,void 0,"http://www.opengis.net/kml/2.2","http://earth.google.com/kml/2.2","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.0"],pC=["http://www.google.com/kml/ext/2.2"],fC={kml:AC,gx:pC,atom:["http://www.w3.org/2005/Atom"],kmlgx:AC.concat(pC)},mC={Document:iE,Folder:function(e,t,n,i){const o=nE(e,t,n),r=(0,_t.A)(n);r.parentEntity=o.entity,iE(0,t,r,i)},Placemark:function(e,t,n,i){const o=nE(e,t,n),r=o.entity,s=o.styleEntity;let a=!1;const c=t.childNodes;for(let t=0,i=c.length;t<i&&!a;t++){const i=c.item(t),o=eE[i.localName];(0,d.A)(o)&&(o(e,n.entityCollection,i,r,s,r.id),a=!0)}a||(r.merge(s),KC(e,r,s))},NetworkLink:function(e,t,n,i){const o=nE(e,t,n).entity,r=n.sourceResource,s=n.uriResolver;let a=PC(t,"Link",fC.kml);if((0,d.A)(a)||(a=PC(t,"Url",fC.kml)),(0,d.A)(a)){let t,c,l=MC(a,"href",fC.kml);if((0,d.A)(l)){let u=l;if(l=NC(l,r,n.uriResolver),/^data:/.test(l.getUrlComponent()))/\.kmz/i.test(r.getUrlComponent())||(u=r.getDerivedResource({url:u}));else{if(u=l.clone(),t=MC(a,"viewRefreshMode",fC.kml),"onRegion"===t)return void(0,Fn.A)("kml-refrehMode-onRegion","KML - Unsupported viewRefreshMode: onRegion");c=MC(a,"viewBoundScale",fC.kml)??1;const n="onStop"===t?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",i=MC(a,"viewFormat",fC.kml)??n,o=MC(a,"httpQuery",fC.kml);(0,d.A)(i)&&l.setQueryParameters((0,xv.A)(uE(i))),(0,d.A)(o)&&l.setQueryParameters((0,xv.A)(uE(o)));const r=e._ellipsoid;fE(l,e.camera,e.canvas,c,e._lastCameraView.bbox,r)}const h={sourceUri:u,uriResolver:s,context:o.id,screenOverlayContainer:n.screenOverlayContainer},A=new Ri.A,p=gE(e,A,l,h).then(function(n){const i=e._entityCollection,r=A.values;i.suspendEvents();for(let e=0;e<r.length;e++){const t=r[e];(0,d.A)(t.parent)||(t.parent=o,yE(t)),i.add(t)}i.resumeEvents();const s=MC(a,"refreshMode",fC.kml);let u=RC(a,"refreshInterval",fC.kml)??0;if("onInterval"===s&&u>0||"onExpire"===s||"onStop"===t){const t=PC(n,"NetworkLinkControl",fC.kml),i=(0,d.A)(t),r=te.A.now(),h={id:(0,E.A)(),href:l,cookie:{},lastUpdated:r,updating:!1,entity:o,viewBoundScale:c,needsUpdate:!1,cameraUpdateTime:r};let A=0;if(i&&(h.cookie=(0,xv.A)(MC(t,"cookie",fC.kml)??""),A=RC(t,"minRefreshPeriod",fC.kml)??0),"onInterval"===s)i&&(u=Math.max(A,u)),h.refreshMode=lE.INTERVAL,h.time=u;else if("onExpire"===s){let e;if(i&&(e=MC(t,"expires",fC.kml)),(0,d.A)(e))try{const t=te.A.fromIso8601(e),n=te.A.secondsDifference(t,r);n>0&&n<A&&te.A.addSeconds(r,A,t),h.refreshMode=lE.EXPIRE,h.time=t}catch(e){(0,Fn.A)("kml-refreshMode-onInterval-onExpire","KML - NetworkLinkControl expires is not a valid date")}else(0,Fn.A)("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element")}else(0,d.A)(e.camera)?(h.refreshMode=lE.STOP,h.time=RC(a,"viewRefreshTime",fC.kml)??0):(0,Fn.A)("kml-refrehMode-onStop-noCamera","A NetworkLink with viewRefreshMode=onStop requires the `camera` property to be defined.");(0,d.A)(h.refreshMode)&&e._networkLinks.set(h.id,h)}}).catch(function(t){(0,Fn.A)(`An error occured during loading ${l.url}`),e._error.raiseEvent(e,t)});i.addPromise(p)}}},GroundOverlay:function(e,t,n,i){const o=nE(e,t,n).entity;let r,s=!1;const a=e._ellipsoid,c=EC(PC(t,"LatLonQuad",fC.gx),a),l=RC(t,"drawOrder",fC.kml);if((0,d.A)(c))r=VC(),r.hierarchy=new ea.A(c),r.zIndex=l,o.polygon=r,s=!0;else{r=new Ja.A,r.zIndex=l,o.rectangle=r;const e=PC(t,"LatLonBox",fC.kml);if((0,d.A)(e)){let t=RC(e,"west",fC.kml),n=RC(e,"south",fC.kml),i=RC(e,"east",fC.kml),o=RC(e,"north",fC.kml);(0,d.A)(t)&&(t=J.A.negativePiToPi(J.A.toRadians(t))),(0,d.A)(n)&&(n=J.A.clampToLatitudeRange(J.A.toRadians(n))),(0,d.A)(i)&&(i=J.A.negativePiToPi(J.A.toRadians(i))),(0,d.A)(o)&&(o=J.A.clampToLatitudeRange(J.A.toRadians(o))),r.coordinates=new Or.A(t,n,i,o);const s=RC(e,"rotation",fC.kml);if((0,d.A)(s)){const e=J.A.toRadians(s);r.rotation=e,r.stRotation=e}}}const u=PC(t,"Icon",fC.kml),h=HC(u,e,n.sourceResource,n.uriResolver,!0);if((0,d.A)(h)){s&&(0,Fn.A)("kml-gx:LatLonQuad","KML - gx:LatLonQuad Icon does not support texture projection.");const e=RC(u,"x",fC.gx),n=RC(u,"y",fC.gx),i=RC(u,"w",fC.gx),o=RC(u,"h",fC.gx);((0,d.A)(e)||(0,d.A)(n)||(0,d.A)(i)||(0,d.A)(o))&&(0,Fn.A)("kml-groundOverlay-xywh","KML - gx:x, gx:y, gx:w, gx:h aren't supported for GroundOverlays"),r.material=h,r.material.color=UC(t,"color",fC.kml),r.material.transparent=!0}else r.material=UC(t,"color",fC.kml);let A=MC(t,"altitudeMode",fC.kml);(0,d.A)(A)?"absolute"===A?(r.height=RC(t,"altitude",fC.kml),r.zIndex=void 0):"clampToGround"!==A&&(0,Fn.A)("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${A}`):(A=MC(t,"altitudeMode",fC.gx),"relativeToSeaFloor"===A?((0,Fn.A)("kml-altitudeMode-relativeToSeaFloor","KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute."),r.height=RC(t,"altitude",fC.kml),r.zIndex=void 0):"clampToSeaFloor"===A?(0,Fn.A)("kml-altitudeMode-clampToSeaFloor","KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround."):(0,d.A)(A)&&(0,Fn.A)("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${A}`))},PhotoOverlay:cE,ScreenOverlay:function(e,t,n,i){const o=n.screenOverlayContainer;if(!(0,d.A)(o))return;const r=n.sourceResource,s=n.uriResolver,a=HC(PC(t,"Icon",fC.kml),e,r,s,!1);if(!(0,d.A)(a))return;const c=document.createElement("img");e._screenOverlays.push(c),c.src=a.url,c.onload=function(){const e=["position: absolute"],n=PC(t,"screenXY",fC.kml),i=PC(t,"overlayXY",fC.kml),o=PC(t,"size",fC.kml);let r,s,a,l,u,h;(0,d.A)(o)&&(r=SC(o,"x"),s=SC(o,"y"),a=IC(o,"xunits"),l=IC(o,"yunits"),(0,d.A)(r)&&-1!==r&&0!==r&&("fraction"===a?u=`width: ${Math.floor(100*r)}%`:"pixels"===a&&(u=`width: ${r}px`),e.push(u)),(0,d.A)(s)&&-1!==s&&0!==s&&("fraction"===l?h=`height: ${Math.floor(100*s)}%`:"pixels"===l&&(h=`height: ${s}px`),e.push(h))),c.style=e.join(";");let A=0,p=c.height;(0,d.A)(i)&&(r=SC(i,"x"),s=SC(i,"y"),a=IC(i,"xunits"),l=IC(i,"yunits"),(0,d.A)(r)&&("fraction"===a?A=r*c.width:("pixels"===a||"insetPixels"===a)&&(A=r)),(0,d.A)(s)&&("fraction"===l?p=s*c.height:("pixels"===l||"insetPixels"===l)&&(p=s))),(0,d.A)(n)&&(r=SC(n,"x"),s=SC(n,"y"),a=IC(n,"xunits"),l=IC(n,"yunits"),(0,d.A)(r)&&("fraction"===a?u=`left: calc(${Math.floor(100*r)}% - ${A}px)`:"pixels"===a?u=`left: ${r-A}px`:"insetPixels"===a&&(u=`right: ${r-A}px`),e.push(u)),(0,d.A)(s)&&("fraction"===l?h=`bottom: calc(${Math.floor(100*s)}% - ${p}px)`:"pixels"===l?h=`bottom: ${s-p}px`:"insetPixels"===l&&(h=`top: ${s-p}px`),e.push(h))),c.style=e.join(";")},o.appendChild(c)},Tour:function(e,t,n,i){const o=MC(t,"name",fC.kml),r=IC(t,"id"),s=new eC(o,r),a=PC(t,"Playlist",fC.gx);if(a){const t=e._ellipsoid,n=a.childNodes;for(let e=0;e<n.length;e++){const i=n[e];if(i.localName){const e=oE[i.localName];e?e(s,i,t):console.log(`Unknown KML Tour playlist entry type ${i.localName}`)}}}e._kmlTours.push(s)}};function gC(e){this._dataSource=e,this._deferred=(0,vv.A)(),this._stack=[],this._promises=[],this._timeoutSet=!1,this._used=!1,this._started=0,this._timeThreshold=1e3}function _C(e){const t={xsi:"http://www.w3.org/2001/XMLSchema-instance"};let n,i,o,r;for(const s in t)t.hasOwnProperty(s)&&(o=RegExp(`[< ]${s}:`),r=`xmlns:${s}=`,o.test(e)&&-1===e.indexOf(r)&&((0,d.A)(n)||(n=e.substr(0,e.indexOf("<kml")+4),i=e.substr(n.length)),n+=` ${r}"${t[s]}"`));return(0,d.A)(n)&&(e=n+i),e}function yC(e){let t=e.indexOf("xmlns:");const n=e.indexOf(">",t);let i,o,r;for(;-1!==t&&t<n;)i=e.slice(t,e.indexOf('"',t)),o=t,t=e.indexOf(i,t+1),-1!==t?(r=e.indexOf('"',e.indexOf('"',t)+1),t=(e=e.slice(0,t-1)+e.slice(r+1,e.length)).indexOf("xmlns:",o-1)):t=e.indexOf("xmlns:",o+1);return e}function vC(e,t){const n=aC.detectFromFilename(e.filename)??"application/octet-stream";return Promise.resolve(e.getData(new lw(n))).then(function(n){t[e.filename]=n})}function TC(e,t,n,i){const o=i.keys,r=new ra("."),s=e.querySelectorAll(t);for(let e=0;e<s.length;e++){const a=s[e],c=a.getAttribute(n);if((0,d.A)(c)){const e=new ra(c).absoluteTo(r).toString(),s=o.indexOf(e);if(-1!==s){const e=o[s];a.setAttribute(n,i[e]),"a"===t&&null===a.getAttribute("download")&&a.setAttribute("download",e)}}}}function bC(e,t,n,i){const o=e.querySelectorAll(t);for(let e=0;e<o.length;e++){const t=o[e],r=NC(t.getAttribute(n),i);(0,d.A)(r)&&t.setAttribute(n,r.url)}}function wC(e,t,n){let i=IC(e,"id");i=(0,d.A)(i)&&0!==i.length?i:(0,E.A)(),(0,d.A)(n)&&(i=n+i);let o=t.getById(i);return(0,d.A)(o)&&(i=(0,E.A)(),(0,d.A)(n)&&(i=n+i)),o=t.add(new zn.A({id:i})),(0,d.A)(o.kml)||(o.addProperty("kml"),o.kml=new TE),o}function xC(e,t){return"absolute"===e||"relativeToGround"===e||"relativeToSeaFloor"===t}function CC(e,t){if(!(0,d.A)(e))return j.A.fromDegrees(0,0,0,t);const n=e.match(/[^\s,\n]+/g);if(!(0,d.A)(n))return j.A.fromDegrees(0,0,0,t);let i=parseFloat(n[0]),o=parseFloat(n[1]),r=parseFloat(n[2]);return i=isNaN(i)?0:i,o=isNaN(o)?0:o,r=isNaN(r)?0:r,j.A.fromDegrees(i,o,r,t)}function EC(e,t){if(!(0,d.A)(e))return;const n=e.textContent.match(/[^\s\n]+/g);if(!(0,d.A)(n))return;const i=n.length,o=new Array(i);let r=0;for(let e=0;e<i;e++)o[r++]=CC(n[e],t);return o}function SC(e,t){if(!(0,d.A)(e))return;const n=e.getAttribute(t);if(null!==n){const e=parseFloat(n);return isNaN(e)?void 0:e}}function IC(e,t){if(!(0,d.A)(e))return;const n=e.getAttribute(t);return null!==n?n:void 0}function PC(e,t,n){if(!(0,d.A)(e))return;const i=e.childNodes,o=i.length;for(let e=0;e<o;e++){const o=i[e];if(o.localName===t&&-1!==n.indexOf(o.namespaceURI))return o}}function DC(e,t,n){if(!(0,d.A)(e))return;const i=[],o=e.getElementsByTagNameNS("*",t),r=o.length;for(let e=0;e<r;e++){const r=o[e];r.localName===t&&-1!==n.indexOf(r.namespaceURI)&&i.push(r)}return i}function OC(e,t,n){if(!(0,d.A)(e))return[];const i=[],o=e.childNodes,r=o.length;for(let e=0;e<r;e++){const r=o[e];r.localName===t&&-1!==n.indexOf(r.namespaceURI)&&i.push(r)}return i}function RC(e,t,n){const i=PC(e,t,n);if((0,d.A)(i)){const e=parseFloat(i.textContent);return isNaN(e)?void 0:e}}function MC(e,t,n){const i=PC(e,t,n);if((0,d.A)(i))return i.textContent.trim()}function LC(e,t,n){const i=PC(e,t,n);if((0,d.A)(i)){const e=i.textContent.trim();return"1"===e||/^true$/i.test(e)}}function NC(e,t,n){if(!(0,d.A)(e))return;let i;if((0,d.A)(n)){let o=n[e=e.replace(/\\/g,"/")];if((0,d.A)(o))i=new Lt.A({url:o});else{const r=new ra(t.getUrlComponent());o=n[new ra(e).absoluteTo(r)],(0,d.A)(o)&&(i=new Lt.A({url:o}))}}return(0,d.A)(i)||(i=t.getDerivedResource({url:e})),i}Object.defineProperties(gC.prototype,{dataSource:{get:function(){return this._dataSource}}}),gC.prototype.addNodes=function(e,t){this._stack.push({nodes:e,index:0,processingData:t}),this._used=!0},gC.prototype.addPromise=function(e){this._promises.push(e)},gC.prototype.wait=function(){const e=this._deferred;return this._used||e.resolve(),Promise.all([e.promise,Promise.all(this._promises)])},gC.prototype.process=function(){const e=1===this._stack.length;return e&&(this._started=_E._getTimestamp()),this._process(e)},gC.prototype._giveUpTime=function(){if(this._timeoutSet)return;this._timeoutSet=!0,this._timeThreshold=50;const e=this;setTimeout(function(){e._timeoutSet=!1,e._started=_E._getTimestamp(),e._process(!0)},0)},gC.prototype._nextNode=function(){const e=this._stack,t=e[e.length-1],n=t.index,i=t.nodes;if(n!==i.length)return++t.index,i[n]},gC.prototype._pop=function(){const e=this._stack;return e.pop(),0!==e.length||(this._deferred.resolve(),!1)},gC.prototype._process=function(e){const t=this.dataSource,n=this._stack[this._stack.length-1].processingData;let i=this._nextNode();for(;(0,d.A)(i);){const e=mC[i.localName];if((0,d.A)(e)&&(-1!==fC.kml.indexOf(i.namespaceURI)||-1!==fC.gx.indexOf(i.namespaceURI))&&(e(t,i,n,this),this._timeoutSet||_E._getTimestamp()>this._started+this._timeThreshold))return void this._giveUpTime();i=this._nextNode()}this._pop()&&e&&this._process(!0)};const BC={maximumRed:void 0,red:void 0,maximumGreen:void 0,green:void 0,maximumBlue:void 0,blue:void 0};function FC(e,t){if(!(0,d.A)(e)||/^\s*$/gm.test(e))return;"#"===e[0]&&(e=e.substring(1));const n=parseInt(e.substring(0,2),16)/255,i=parseInt(e.substring(2,4),16)/255,o=parseInt(e.substring(4,6),16)/255,r=parseInt(e.substring(6,8),16)/255;return t?(r>0?(BC.maximumRed=r,BC.red=void 0):(BC.maximumRed=void 0,BC.red=0),o>0?(BC.maximumGreen=o,BC.green=void 0):(BC.maximumGreen=void 0,BC.green=0),i>0?(BC.maximumBlue=i,BC.blue=void 0):(BC.maximumBlue=void 0,BC.blue=0),BC.alpha=n,u.A.fromRandom(BC)):new u.A(r,o,i,n)}function UC(e,t,n){const i=MC(e,t,n);if((0,d.A)(i))return FC(i,"random"===MC(e,"colorMode",n))}function kC(){const e=new Bt.A;return e.width=uC,e.height=uC,e.scaleByDistance=new kt.A(dC,1,hC,.1),e.pixelOffsetScaleByDistance=new kt.A(dC,1,hC,.1),e}function VC(){const e=new Pa.A;return e.outline=!0,e.outlineColor=u.A.WHITE,e}function zC(){const e=new xa.A;return e.translucencyByDistance=new kt.A(3e6,1,5e6,0),e.pixelOffset=new q.A(17,0),e.horizontalOrigin=zt.A.LEFT,e.font="16px sans-serif",e.style=oa.A.FILL_AND_OUTLINE,e}function HC(e,t,n,i,o){let r=MC(e,"href",fC.kml);if(!(0,d.A)(r)||0===r.length)return;if(0===r.indexOf("root://icons/palette-")){const t=r.charAt(21);let n=RC(e,"x",fC.gx)??0,i=RC(e,"y",fC.gx)??0;n=Math.min(n/32,7),i=7-Math.min(i/32,7),r=`https://maps.google.com/mapfiles/kml/pal${t}/icon${8*i+n}.png`}const s=NC(r,n,i);if(o){const n=MC(e,"refreshMode",fC.kml),i=MC(e,"viewRefreshMode",fC.kml);"onInterval"===n||"onExpire"===n?(0,Fn.A)(`kml-refreshMode-${n}`,`KML - Unsupported Icon refreshMode: ${n}`):"onStop"!==i&&"onRegion"!==i||(0,Fn.A)(`kml-refreshMode-${i}`,`KML - Unsupported Icon viewRefreshMode: ${i}`);const o=MC(e,"viewBoundScale",fC.kml)??1,r="onStop"===i?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",a=MC(e,"viewFormat",fC.kml)??r,c=MC(e,"httpQuery",fC.kml);(0,d.A)(a)&&s.setQueryParameters((0,xv.A)(uE(a))),(0,d.A)(c)&&s.setQueryParameters((0,xv.A)(uE(c)));const l=t._ellipsoid;return fE(s,t.camera,t.canvas,o,t._lastCameraView.bbox,l),s}return s}function GC(e,t,n,i,o){let r=RC(t,"scale",fC.kml);const s=RC(t,"heading",fC.kml),a=UC(t,"color",fC.kml),l=PC(t,"Icon",fC.kml);let u=HC(l,e,i,o,!1);(0,d.A)(l)&&!(0,d.A)(u)&&(u=!1);const h=RC(l,"x",fC.gx),A=RC(l,"y",fC.gx),p=RC(l,"w",fC.gx),f=RC(l,"h",fC.gx),m=PC(t,"hotSpot",fC.kml),g=SC(m,"x"),_=SC(m,"y"),y=IC(m,"xunits"),v=IC(m,"yunits");let T,b,w=n.billboard;(0,d.A)(w)||(w=kC(),n.billboard=w),w.image=u,w.scale=r,w.color=a,((0,d.A)(h)||(0,d.A)(A)||(0,d.A)(p)||(0,d.A)(f))&&(w.imageSubRegion=new c.A(h,A,p,f)),(0,d.A)(s)&&0!==s&&(w.rotation=J.A.toRadians(-s),w.alignedAxis=j.A.UNIT_Z),r=r??1,(0,d.A)(g)&&("pixels"===y?T=-g*r:"insetPixels"===y?T=(g-uC)*r:"fraction"===y&&(T=-g*uC*r),T+=16*r),(0,d.A)(_)&&("pixels"===v?b=_*r:"insetPixels"===v?b=(-_+uC)*r:"fraction"===v&&(b=_*uC*r),b-=16*r),((0,d.A)(T)||(0,d.A)(b))&&(w.pixelOffset=new q.A(T,b))}function WC(e,t,n,i,o){for(let r=0,s=t.childNodes.length;r<s;r++){const s=t.childNodes.item(r);if("IconStyle"===s.localName)GC(e,s,n,i,o);else if("LabelStyle"===s.localName){let e=n.label;(0,d.A)(e)||(e=zC(),n.label=e),e.scale=RC(s,"scale",fC.kml)??e.scale,e.fillColor=UC(s,"color",fC.kml)??e.fillColor,e.text=n.name}else if("LineStyle"===s.localName){let e=n.polyline;(0,d.A)(e)||(e=new Ua.A,n.polyline=e),e.width=RC(s,"width",fC.kml),e.material=UC(s,"color",fC.kml),(0,d.A)(UC(s,"outerColor",fC.gx))&&(0,Fn.A)("kml-gx:outerColor","KML - gx:outerColor is not supported in a LineStyle"),(0,d.A)(RC(s,"outerWidth",fC.gx))&&(0,Fn.A)("kml-gx:outerWidth","KML - gx:outerWidth is not supported in a LineStyle"),(0,d.A)(RC(s,"physicalWidth",fC.gx))&&(0,Fn.A)("kml-gx:physicalWidth","KML - gx:physicalWidth is not supported in a LineStyle"),(0,d.A)(LC(s,"labelVisibility",fC.gx))&&(0,Fn.A)("kml-gx:labelVisibility","KML - gx:labelVisibility is not supported in a LineStyle")}else if("PolyStyle"===s.localName){let e=n.polygon;(0,d.A)(e)||(e=VC(),n.polygon=e),e.material=UC(s,"color",fC.kml)??e.material,e.fill=LC(s,"fill",fC.kml)??e.fill,e.outline=LC(s,"outline",fC.kml)??e.outline}else if("BalloonStyle"===s.localName){const e=FC(MC(s,"bgColor",fC.kml))??u.A.WHITE,t=FC(MC(s,"textColor",fC.kml))??u.A.BLACK,i=MC(s,"text",fC.kml);n.addProperty("balloonStyle"),n.balloonStyle={bgColor:e,textColor:t,text:i}}else if("ListStyle"===s.localName){const e=MC(s,"listItemType",fC.kml);"radioFolder"!==e&&"checkOffOnly"!==e||(0,Fn.A)(`kml-listStyle-${e}`,`KML - Unsupported ListStyle with listItemType: ${e}`)}}}function YC(e,t,n){return t.fetchXML().then(function(i){return qC(e,i,n,t,!0)})}function qC(e,t,n,i,o,r){let s,a,c,l;const u=DC(t,"Style",fC.kml);if((0,d.A)(u)){const t=u.length;for(s=0;s<t;s++)l=u[s],a=IC(l,"id"),(0,d.A)(a)&&(a=`#${a}`,o&&(0,d.A)(i)&&(a=i.getUrlComponent()+a),(0,d.A)(n.getById(a))||(c=new zn.A({id:a}),n.add(c),WC(e,l,c,i,r)))}const h=DC(t,"StyleMap",fC.kml);if((0,d.A)(h)){const t=h.length;for(s=0;s<t;s++){const t=h[s];if(a=IC(t,"id"),(0,d.A)(a)){const s=OC(t,"Pair",fC.kml);for(let t=0;t<s.length;t++){const u=s[t],h=MC(u,"key",fC.kml);if("normal"===h){if(a=`#${a}`,o&&(0,d.A)(i)&&(a=i.getUrlComponent()+a),!(0,d.A)(n.getById(a))){c=n.getOrCreateEntity(a);let t=MC(u,"styleUrl",fC.kml);if((0,d.A)(t)){"#"!==t[0]&&(t=`#${t}`),o&&(0,d.A)(i)&&(t=i.getUrlComponent()+t);const e=n.getById(t);(0,d.A)(e)&&c.merge(e)}else l=PC(u,"Style",fC.kml),WC(e,l,c,i,r)}}else(0,Fn.A)(`kml-styleMap-${h}`,`KML - Unsupported StyleMap key: ${h}`)}}}}const A=[],p=t.getElementsByTagName("styleUrl"),f=p.length;for(s=0;s<f;s++){const t=p[s].textContent;if("#"!==t[0]){const o=t.split("#");if(2===o.length){const t=o[0],r=i.getDerivedResource({url:t});A.push(YC(e,r,n))}}}return A}function jC(e,t,n){const i=new nc(e,t.id,["position"]),o=new kf(t.position);t.polyline=(0,d.A)(n.polyline)?n.polyline.clone():new Ua.A,t.polyline.positions=new ja([i,o])}function QC(e,t){return!(0,d.A)(e)&&!(0,d.A)(t)||"clampToGround"===e?Vt.Ay.CLAMP_TO_GROUND:"relativeToGround"===e?Vt.Ay.RELATIVE_TO_GROUND:"absolute"===e?Vt.Ay.NONE:"clampToSeaFloor"===t?((0,Fn.A)("kml-gx:altitudeMode-clampToSeaFloor","KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround."),Vt.Ay.CLAMP_TO_GROUND):"relativeToSeaFloor"===t?((0,Fn.A)("kml-gx:altitudeMode-relativeToSeaFloor","KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround."),Vt.Ay.RELATIVE_TO_GROUND):((0,d.A)(e)?(0,Fn.A)("kml-altitudeMode-unknown",`KML - Unknown <kml:altitudeMode>:${e}, using <kml:altitudeMode>:CLAMP_TO_GROUND.`):(0,Fn.A)("kml-gx:altitudeMode-unknown",`KML - Unknown <gx:altitudeMode>:${t}, using <kml:altitudeMode>:CLAMP_TO_GROUND.`),Vt.Ay.CLAMP_TO_GROUND)}function XC(e,t,n){return"relativeToSeaFloor"===n||"absolute"===t||"relativeToGround"===t?e:(((0,d.A)(t)&&"clampToGround"!==t||(0,d.A)(n)&&"clampToSeaFloor"!==n)&&(0,Fn.A)("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${t??n}`),new kf(e))}function KC(e,t,n,i){let o=t.label;(0,d.A)(o)||(o=(0,d.A)(n.label)?n.label.clone():zC(),t.label=o),o.text=t.name;let r=t.billboard;(0,d.A)(r)||(r=(0,d.A)(n.billboard)?n.billboard.clone():kC(),t.billboard=r),(0,d.A)(r.image)?r.image.getValue()||(r.image=void 0):r.image=e._pinBuilder.fromColor(u.A.YELLOW,64);let s=1;(0,d.A)(r.scale)&&(s=r.scale.getValue(),0!==s?o.pixelOffset=new q.A(16*s+1,0):(o.pixelOffset=void 0,o.horizontalOrigin=void 0)),(0,d.A)(i)&&e._clampToGround&&(r.heightReference=i,o.heightReference=i)}function $C(e,t){let n=e.path;(0,d.A)(n)||(n=new Sa.A,n.leadTime=0,e.path=n);const i=t.polyline;(0,d.A)(i)&&(n.material=i.material,n.width=i.width)}function JC(e,t,n,i,o){const r=PC(n,"coordinates",fC.kml),s=MC(n,"altitudeMode",fC.kml),a=MC(n,"altitudeMode",fC.gx),c=LC(n,"extrude",fC.kml),l=LC(n,"tessellate",fC.kml),h=xC(s,a),A=RC(n,"drawOrder",fC.gx),p=e._ellipsoid,f=EC(r,p);let m=o.polyline;if(h&&c){const e=new Gc.A;i.wall=e,e.positions=f;const t=o.polygon;(0,d.A)(t)&&(e.fill=t.fill,e.material=t.material),e.outline=!0,(0,d.A)(m)?(e.outlineColor=(0,d.A)(m.material)?m.material.color:u.A.WHITE,e.outlineWidth=m.width):(0,d.A)(t)&&(e.outlineColor=(0,d.A)(t.material)?t.material.color:u.A.WHITE)}else if(e._clampToGround&&!h&&l){const e=new Ua.A;e.clampToGround=!0,i.polyline=e,e.positions=f,(0,d.A)(m)?(e.material=(0,d.A)(m.material)?m.material.color.getValue(Tn.A.MINIMUM_VALUE):u.A.WHITE,e.width=m.width??1):(e.material=u.A.WHITE,e.width=1),e.zIndex=A}else(0,d.A)(A)&&(0,Fn.A)("kml-gx:drawOrder","KML - gx:drawOrder is not supported in LineStrings when clampToGround is false"),e._clampToGround&&!l&&(0,Fn.A)("kml-line-tesselate","Ignoring clampToGround for KML lines without the tessellate flag."),m=(0,d.A)(m)?m.clone():new Ua.A,i.polyline=m,m.positions=function(e,t,n,i){if(!(0,d.A)(e))return;if("relativeToSeaFloor"===n||"absolute"===t||"relativeToGround"===t)return e;((0,d.A)(t)&&"clampToGround"!==t||(0,d.A)(n)&&"clampToSeaFloor"!==n)&&(0,Fn.A)("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${t??n}`);const o=e.length;for(let t=0;t<o;t++){const n=e[t];i.scaleToGeodeticSurface(n,n)}return e}(f,s,a,p),l&&!h||(m.arcType=zs.A.NONE);return!0}function ZC(e,t,n,i,o,r,s,a,c){const l=e[0],u=e[e.length-1],d=new mc;d.addSamples(e,t),n.intervals.addInterval(new ji.A({start:l,stop:u,isStartIncluded:c,isStopIncluded:c,data:XC(d,s,a)})),i.addInterval(new ji.A({start:l,stop:u,isStartIncluded:c,isStopIncluded:c})),o.intervals.addInterval(new ji.A({start:l,stop:u,isStartIncluded:c,isStopIncluded:c,data:r}))}const eE={Point:function(e,t,n,i,o){const r=MC(n,"coordinates",fC.kml),s=MC(n,"altitudeMode",fC.kml),a=MC(n,"altitudeMode",fC.gx),c=LC(n,"extrude",fC.kml),l=CC(r,e._ellipsoid);return i.position=l,KC(e,i,o,QC(s,a)),c&&xC(s,a)&&jC(t,i,o),!0},LineString:JC,LinearRing:JC,Polygon:function(e,t,n,i,o){const r=PC(n,"outerBoundaryIs",fC.kml);let s=PC(r,"LinearRing",fC.kml),a=PC(s,"coordinates",fC.kml);const c=e._ellipsoid;let l=EC(a,c);const h=LC(n,"extrude",fC.kml),A=xC(MC(n,"altitudeMode",fC.kml),MC(n,"altitudeMode",fC.gx)),p=(0,d.A)(o.polygon)?o.polygon.clone():VC(),f=o.polyline;if((0,d.A)(f)&&(p.outlineColor=(0,d.A)(f.material)?f.material.color:u.A.WHITE,p.outlineWidth=f.width),i.polygon=p,A?(p.perPositionHeight=!0,p.extrudedHeight=h?0:void 0):e._clampToGround||(p.height=0),(0,d.A)(l)){const e=new ea.A(l),t=OC(n,"innerBoundaryIs",fC.kml);for(let n=0;n<t.length;n++){s=OC(t[n],"LinearRing",fC.kml);for(let t=0;t<s.length;t++)a=PC(s[t],"coordinates",fC.kml),l=EC(a,c),(0,d.A)(l)&&e.holes.push(new ea.A(l))}p.hierarchy=e}return!0},Track:function(e,t,n,i,o){const r=MC(n,"altitudeMode",fC.kml),s=MC(n,"altitudeMode",fC.gx),a=OC(n,"coord",fC.gx),c=OC(n,"angles",fC.gx),l=OC(n,"when",fC.kml),u=LC(n,"extrude",fC.kml),d=xC(r,s),h=e._ellipsoid;c.length>0&&(0,Fn.A)("kml-gx:angles","KML - gx:angles are not supported in gx:Tracks");const A=Math.min(a.length,l.length),p=[],f=[];for(let e=0;e<A;e++){const t=CC(a[e].textContent,h);p.push(t),f.push(te.A.fromIso8601(l[e].textContent))}const m=new mc;return m.addSamples(f,p),i.position=m,KC(e,i,o,QC(r,s)),$C(i,o),i.availability=new oo,l.length>0&&i.availability.addInterval(new ji.A({start:f[0],stop:f[f.length-1]})),d&&u&&jC(t,i,o),!0},MultiTrack:function(e,t,n,i,o){const r=LC(n,"interpolate",fC.gx),s=OC(n,"Track",fC.gx);let a,c,l,u=!1;const h=new Pc,A=new oo,p=new po,f=e._ellipsoid;for(let e=0,t=s.length;e<t;e++){const t=s[e],n=OC(t,"when",fC.kml),i=OC(t,"coord",fC.gx),o=MC(t,"altitudeMode",fC.kml),m=MC(t,"altitudeMode",fC.gx),g=xC(o,m),_=LC(t,"extrude",fC.kml),y=Math.min(i.length,n.length),v=[];a=[];for(let e=0;e<y;e++){const t=CC(i[e].textContent,f);v.push(t),a.push(te.A.fromIso8601(n[e].textContent))}r&&((0,d.A)(c)&&ZC([c,a[0]],[l,v[0]],p,A,h,!1,"absolute",void 0,!1),c=a[y-1],l=v[v.length-1]),ZC(a,v,p,A,h,g&&_,o,m,!0),u=u||g&&_}return i.availability=A,i.position=p,KC(e,i,o),$C(i,o),u&&(jC(t,i,o),i.polyline.show=h),!0},MultiGeometry:function(e,t,n,i,o,r){const s=n.childNodes;let a=!1;for(let n=0,c=s.length;n<c;n++){const c=s.item(n),l=eE[c.localName];if((0,d.A)(l)){const n=wC(c,t,r);n.parent=i,n.name=i.name,n.availability=i.availability,n.description=i.description,n.kml=i.kml,l(e,t,c,n,o)&&(a=!0)}}return a},Model:function(e,t,n,i,o){return(0,Fn.A)("kml-unsupportedGeometry",`KML - Unsupported geometry: ${n.localName}`),!1}};let tE;function nE(e,t,n){const i=n.entityCollection,o=n.parentEntity,r=n.sourceResource,s=n.uriResolver,a=wC(t,i,n.context),c=a.kml,l=function(e,t,n,i,o){const r=new zn.A;let s,a=-1;const c=t.childNodes,l=c.length;for(let e=0;e<l;e++){const t=c[e];"Style"!==t.localName&&"StyleMap"!==t.localName||(a=e)}if(-1!==a){const t=c[a];if("Style"===t.localName)WC(e,t,r,i,o);else{const a=OC(t,"Pair",fC.kml);for(let t=0;t<a.length;t++){const c=a[t],l=MC(c,"key",fC.kml);if("normal"===l){const t=MC(c,"styleUrl",fC.kml);(0,d.A)(t)?(s=n.getById(t),(0,d.A)(s)||(s=n.getById(`#${t}`)),(0,d.A)(s)&&r.merge(s)):WC(e,PC(c,"Style",fC.kml),r,i,o)}else(0,Fn.A)(`kml-styleMap-${l}`,`KML - Unsupported StyleMap key: ${l}`)}}}const u=MC(t,"styleUrl",fC.kml);if((0,d.A)(u)){let e=u;if("#"!==u[0]&&-1!==u.indexOf("#")){const t=u.split("#"),n=t[0];e=`${i.getDerivedResource({url:n}).getUrlComponent()}#${t[1]}`}s=n.getById(e),(0,d.A)(s)||(s=n.getById(`#${e}`)),(0,d.A)(s)&&r.merge(s)}return r}(e,t,n.styleCollection,r,s),h=MC(t,"name",fC.kml);a.name=h,a.parent=o;let A=function(e){const t=PC(e,"TimeSpan",fC.kmlgx);if(!(0,d.A)(t))return;let n;const i=PC(t,"begin",fC.kmlgx);let o=(0,d.A)(i)?te.A.fromIso8601(i.textContent):void 0;const r=PC(t,"end",fC.kmlgx);let s=(0,d.A)(r)?te.A.fromIso8601(r.textContent):void 0;if((0,d.A)(o)&&(0,d.A)(s)){if(te.A.lessThan(s,o)){const e=o;o=s,s=e}n=new oo,n.addInterval(new ji.A({start:o,stop:s}))}else(0,d.A)(o)?(n=new oo,n.addInterval(new ji.A({start:o,stop:Tn.A.MAXIMUM_VALUE}))):(0,d.A)(s)&&(n=new oo,n.addInterval(new ji.A({start:Tn.A.MINIMUM_VALUE,stop:s})));return n}(t);(0,d.A)(A)||(A=function(e){const t=PC(e,"TimeStamp",fC.kmlgx),n=MC(t,"when",fC.kmlgx);if(!(0,d.A)(t)||!(0,d.A)(n)||0===n.length)return;const i=te.A.fromIso8601(n),o=new oo;return o.addInterval(new ji.A({start:i,stop:Tn.A.MAXIMUM_VALUE})),o}(t)),a.availability=A,yE(a);const p=LC(t,"visibility",fC.kml);a.show=function e(t){return!t||t.show&&e(t.parent)}(o)&&(p??!0);const f=PC(t,"author",fC.atom),m=c.author;m.name=MC(f,"name",fC.atom),m.uri=MC(f,"uri",fC.atom),m.email=MC(f,"email",fC.atom);const g=PC(t,"link",fC.atom),_=c.link;_.href=IC(g,"href"),_.hreflang=IC(g,"hreflang"),_.rel=IC(g,"rel"),_.type=IC(g,"type"),_.title=IC(g,"title"),_.length=IC(g,"length"),c.address=MC(t,"address",fC.kml),c.phoneNumber=MC(t,"phoneNumber",fC.kml),c.snippet=MC(t,"Snippet",fC.kml),function(e,t){const n=PC(e,"ExtendedData",fC.kml);if(!(0,d.A)(n))return;(0,d.A)(PC(n,"SchemaData",fC.kml))&&(0,Fn.A)("kml-schemaData","KML - SchemaData is unsupported"),(0,d.A)(IC(n,"xmlns:prefix"))&&(0,Fn.A)("kml-extendedData","KML - ExtendedData with xmlns:prefix is unsupported");const i={},o=OC(n,"Data",fC.kml);if((0,d.A)(o)){const e=o.length;for(let t=0;t<e;t++){const e=o[t],n=IC(e,"name");(0,d.A)(n)&&(i[n]={displayName:MC(e,"displayName",fC.kml),value:MC(e,"value",fC.kml)})}}t.kml.extendedData=i}(t,a),function(e,t,n,i,o){let r,s,a;const c=t.kml,l=c.extendedData,h=MC(e,"description",fC.kml),A=t.balloonStyle??n.balloonStyle;let p,f=u.A.WHITE,m=u.A.BLACK,g=h;if((0,d.A)(A)&&(f=A.bgColor??u.A.WHITE,m=A.textColor??u.A.BLACK,g=A.text??h),(0,d.A)(g)){if(g=g.replace("$[name]",t.name??""),g=g.replace("$[description]",h??""),g=g.replace("$[address]",c.address??""),g=g.replace("$[Snippet]",c.snippet??""),g=g.replace("$[id]",t.id),g=g.replace("$[geDirections]",""),(0,d.A)(l)){const e=g.match(/\$\[.+?\]/g);if(null!==e)for(r=0;r<e.length;r++){const t=e[r];let n=t.substr(2,t.length-3);const i=/\/displayName$/.test(n);n=n.replace(/\/displayName$/,""),p=l[n],(0,d.A)(p)&&(p=i?p.displayName:p.value),(0,d.A)(p)&&(g=g.replace(t,p??""))}}}else if((0,d.A)(l)&&(a=Object.keys(l),a.length>0)){for(g='<table class="cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter"><tbody>',r=0;r<a.length;r++)s=a[r],p=l[s],g+=`<tr><th>${p.displayName??s}</th><td>${p.value??""}</td></tr>`;g+="</tbody></table>"}if(!(0,d.A)(g))return;g=lC.link(g),tE.innerHTML=g;const _=tE.querySelectorAll("a");for(r=0;r<_.length;r++)_[r].setAttribute("target","_blank");(0,d.A)(i)&&i.keys.length>1&&(TC(tE,"a","href",i),TC(tE,"link","href",i),TC(tE,"area","href",i),TC(tE,"img","src",i),TC(tE,"iframe","src",i),TC(tE,"video","src",i),TC(tE,"audio","src",i),TC(tE,"source","src",i),TC(tE,"track","src",i),TC(tE,"input","src",i),TC(tE,"embed","src",i),TC(tE,"script","src",i),TC(tE,"video","poster",i)),bC(tE,"a","href",o),bC(tE,"link","href",o),bC(tE,"area","href",o),bC(tE,"img","src",o),bC(tE,"iframe","src",o),bC(tE,"video","src",o),bC(tE,"audio","src",o),bC(tE,"source","src",o),bC(tE,"track","src",o),bC(tE,"input","src",o),bC(tE,"embed","src",o),bC(tE,"script","src",o),bC(tE,"video","poster",o);let y='<div class="cesium-infoBox-description-lighter" style="';y+="overflow:auto;",y+="word-wrap:break-word;",y+=`background-color:${f.toCssColorString()};`,y+=`color:${m.toCssColorString()};`,y+='">',y+=`${tE.innerHTML}</div>`,tE.innerHTML="",t.description=y}(t,a,l,s,r);const y=e._ellipsoid;return aE(t,a,y),sE(t,a,y),(0,d.A)(PC(t,"Region",fC.kml))&&(0,Fn.A)("kml-region","KML - Placemark Regions are unsupported"),{entity:a,styleEntity:l}}function iE(e,t,n,i){i.addNodes(t.childNodes,n),i.process()}"undefined"!=typeof document&&(tE=document.createElement("div"));const oE={FlyTo:function(e,t,n){const i=RC(t,"duration",fC.gx),o=MC(t,"flyToMode",fC.gx),r={kml:{}};aE(t,r,n),sE(t,r,n);const s=r.kml.lookAt||r.kml.camera,a=new oC(i,o,s);e.addPlaylistEntry(a)},Wait:function(e,t){const n=RC(t,"duration",fC.gx);e.addPlaylistEntry(new sC(n))},SoundCue:rE,AnimatedUpdate:rE,TourControl:rE};function rE(e,t){(0,Fn.A)(`KML Tour unsupported node ${t.localName}`)}function sE(e,t,n){const i=PC(e,"Camera",fC.kml);if((0,d.A)(i)){const e=RC(i,"longitude",fC.kml)??0,o=RC(i,"latitude",fC.kml)??0,r=RC(i,"altitude",fC.kml)??0,s=RC(i,"heading",fC.kml)??0,a=RC(i,"tilt",fC.kml)??0,c=RC(i,"roll",fC.kml)??0,l=j.A.fromDegrees(e,o,r,n),u=bv.A.fromDegrees(s,a-90,c);t.kml.camera=new _v(l,u)}}function aE(e,t,n){const i=PC(e,"LookAt",fC.kml);if((0,d.A)(i)){const e=RC(i,"longitude",fC.kml)??0,o=RC(i,"latitude",fC.kml)??0,r=RC(i,"altitude",fC.kml)??0;let s=RC(i,"heading",fC.kml),a=RC(i,"tilt",fC.kml);const c=RC(i,"range",fC.kml)??0;a=J.A.toRadians(a??0),s=J.A.toRadians(s??0);const l=new jm.A(s,a-J.A.PI_OVER_TWO,c),u=j.A.fromDegrees(e,o,r,n);t.kml.lookAt=new Xx(u,l)}}function cE(e,t,n,i){e._unsupportedNode.raiseEvent(e,n.parentEntity,t,n.entityCollection,n.styleCollection,n.sourceResource,n.uriResolver),(0,Fn.A)(`kml-unsupportedFeature-${t.nodeName}`,`KML - Unsupported feature: ${t.nodeName}`)}const lE={INTERVAL:0,EXPIRE:1,STOP:2};function uE(e){if(!(0,d.A)(e)||0===e.length)return"";const t=e[0];return"&"!==t&&"?"!==t||(e=e.substring(1)),e}const dE=new Or.A,hE=new X.A,AE=new q.A,pE=new j.A;function fE(e,t,n,i,o,r){function s(e){return e<-J.A.PI_OVER_TWO?-J.A.PI_OVER_TWO:e>J.A.PI_OVER_TWO?J.A.PI_OVER_TWO:e}function a(e){return e>J.A.PI?e-J.A.TWO_PI:e<-J.A.PI?e+J.A.TWO_PI:e}let c=(0,wv.A)(e.queryParameters);if(c=c.replace(/%5B/g,"[").replace(/%5D/g,"]"),(0,d.A)(t)&&t._mode!==Ce.A.MORPHING){let e,l;if(o=o??dE,(0,d.A)(n)&&(AE.x=.5*n.clientWidth,AE.y=.5*n.clientHeight,e=t.pickEllipsoid(AE,r,pE)),(0,d.A)(e)?l=r.cartesianToCartographic(e,hE):(l=Or.A.center(o,hE),e=r.cartographicToCartesian(l)),(0,d.A)(i)&&!J.A.equalsEpsilon(i,1,J.A.EPSILON9)){const e=o.width*i*.5,t=o.height*i*.5;o=new Or.A(a(l.longitude-e),s(l.latitude-t),a(l.longitude+e),s(l.latitude+t))}c=c.replace("[bboxWest]",J.A.toDegrees(o.west).toString()),c=c.replace("[bboxSouth]",J.A.toDegrees(o.south).toString()),c=c.replace("[bboxEast]",J.A.toDegrees(o.east).toString()),c=c.replace("[bboxNorth]",J.A.toDegrees(o.north).toString());const u=J.A.toDegrees(l.longitude).toString(),h=J.A.toDegrees(l.latitude).toString();c=c.replace("[lookatLon]",u),c=c.replace("[lookatLat]",h),c=c.replace("[lookatTilt]",J.A.toDegrees(t.pitch).toString()),c=c.replace("[lookatHeading]",J.A.toDegrees(t.heading).toString()),c=c.replace("[lookatRange]",j.A.distance(t.positionWC,e)),c=c.replace("[lookatTerrainLon]",u),c=c.replace("[lookatTerrainLat]",h),c=c.replace("[lookatTerrainAlt]",l.height.toString()),r.cartesianToCartographic(t.positionWC,hE),c=c.replace("[cameraLon]",J.A.toDegrees(hE.longitude).toString()),c=c.replace("[cameraLat]",J.A.toDegrees(hE.latitude).toString()),c=c.replace("[cameraAlt]",J.A.toDegrees(hE.height).toString());const A=t.frustum,p=A.aspectRatio;let f="",m="";if((0,d.A)(p)){const e=J.A.toDegrees(A.fov);p>1?(f=e,m=e/p):(m=e,f=e*p)}c=c.replace("[horizFov]",f.toString()),c=c.replace("[vertFov]",m.toString())}else c=c.replace("[bboxWest]","-180"),c=c.replace("[bboxSouth]","-90"),c=c.replace("[bboxEast]","180"),c=c.replace("[bboxNorth]","90"),c=c.replace("[lookatLon]",""),c=c.replace("[lookatLat]",""),c=c.replace("[lookatRange]",""),c=c.replace("[lookatTilt]",""),c=c.replace("[lookatHeading]",""),c=c.replace("[lookatTerrainLon]",""),c=c.replace("[lookatTerrainLat]",""),c=c.replace("[lookatTerrainAlt]",""),c=c.replace("[cameraLon]",""),c=c.replace("[cameraLat]",""),c=c.replace("[cameraAlt]",""),c=c.replace("[horizFov]",""),c=c.replace("[vertFov]","");(0,d.A)(n)?(c=c.replace("[horizPixels]",n.clientWidth),c=c.replace("[vertPixels]",n.clientHeight)):(c=c.replace("[horizPixels]",""),c=c.replace("[vertPixels]","")),c=c.replace("[terrainEnabled]","1"),c=c.replace("[clientVersion]","1"),c=c.replace("[kmlVersion]","2.2"),c=c.replace("[clientName]","Cesium"),c=c.replace("[language]","English"),e.setQueryParameters((0,xv.A)(c))}function mE(e,t,n,i,o,r,s){t.removeAll();const a=n.documentElement;let c=MC("Document"===a.localName?a:PC(a,"Document",fC.kml),"name",fC.kml);(0,d.A)(c)||(c=(0,qs.A)(i.getUrlComponent())),(0,d.A)(e._name)||(e._name=c);const l=new _E._DeferredLoading(e),u=new Ri.A(e);return Promise.all(qC(e,n,u,i,!1,o)).then(function(){let a=n.documentElement;if("kml"===a.localName){const e=a.childNodes;for(let t=0;t<e.length;t++){const n=e[t];if((0,d.A)(mC[n.localName])){a=n;break}}}const c={parentEntity:void 0,entityCollection:t,styleCollection:u,sourceResource:i,uriResolver:o,context:s,screenOverlayContainer:r};return t.suspendEvents(),function(e,t,n,i){const o=mC[t.localName];(0,d.A)(o)?o(e,t,n,i):cE(e,t,n)}(e,a,c,l),t.resumeEvents(),l.wait().then(function(){return n.documentElement})})}function gE(e,t,n,i){let o=(i=i??S.A.EMPTY_OBJECT).sourceUri;const r=i.uriResolver,s=i.context;let a=i.screenOverlayContainer,c=n;if("string"==typeof n||n instanceof Lt.A){c=(n=Lt.A.createIfNeeded(n)).fetchBlob(),o=o??n.clone();const t=e._resourceCredits,i=n.credits;if((0,d.A)(i)){const e=i.length;for(let n=0;n<e;n++)t.push(i[n])}}else o=o??Lt.A.DEFAULT.clone();return o=Lt.A.createIfNeeded(o),(0,d.A)(a)&&(a=(0,Qx.A)(a)),Promise.resolve(c).then(function(n){return n instanceof Blob?function(e){const t=e.slice(0,Math.min(4,e.size)),n=(0,vv.A)(),i=new FileReader;return i.addEventListener("load",function(){n.resolve(1347093252===new DataView(i.result).getUint32(0,!1))}),i.addEventListener("error",function(){n.reject(i.error)}),i.readAsArrayBuffer(t),n.promise}(n).then(function(i){return i?function(e,t,n,i,o){const r=(0,yv.A)("ThirdParty/Workers/z-worker-pako.js");OT({workerScripts:{deflate:[r,"./pako_deflate.min.js"],inflate:[r,"./pako_inflate.min.js"]}});const s=new fx(new uw(n));return Promise.resolve(s.getEntries()).then(function(n){const r=[],a={};let c;for(let e=0;e<n.length;e++){const t=n[e];t.directory||(/\.kml$/i.test(t.filename)?(0,d.A)(c)&&/\//i.test(t.filename)?r.push(vC(t,a)):((0,d.A)(c)&&r.push(vC(c,a)),c=t):r.push(vC(t,a)))}return(0,d.A)(c)&&r.push(function(e,t){return Promise.resolve(e.getData(new Aw)).then(function(e){e=yC(e=_C(e)),t.kml=cC.parseFromString(e,"application/xml")})}(c,a)),Promise.all(r).then(function(){if(s.close(),!(0,d.A)(a.kml))throw new M.A("KMZ file does not contain a KML document.");return a.keys=Object.keys(a),mE(e,t,a.kml,i,a,o)})})}(e,t,n,o,a):function(e){const t=(0,vv.A)(),n=new FileReader;return n.addEventListener("load",function(){t.resolve(n.result)}),n.addEventListener("error",function(){t.reject(n.error)}),n.readAsText(e),t.promise}(n).then(function(n){let i,c;n=yC(n=_C(n));try{i=cC.parseFromString(n,"application/xml")}catch(e){c=e.toString()}if((0,d.A)(c)||i.body||"parsererror"===i.documentElement.tagName){let e=(0,d.A)(c)?c:i.documentElement.firstChild.nodeValue;throw e||(e=i.body.innerText),new M.A(e)}return mE(e,t,i,o,r,a,s)})}):mE(e,t,n,o,r,a,s)}).catch(function(t){return e._error.raiseEvent(e,t),console.log(t),Promise.reject(t)})}function _E(e){const t=(e=e??S.A.EMPTY_OBJECT).camera,n=e.canvas;this._changed=new Bn.A,this._error=new Bn.A,this._loading=new Bn.A,this._refresh=new Bn.A,this._unsupportedNode=new Bn.A,this._clock=void 0,this._entityCollection=new Ri.A(this),this._name=void 0,this._isLoading=!1,this._pinBuilder=new pg.A,this._networkLinks=new Ft.A,this._entityCluster=new fa.A,this.canvas=n,this.camera=t,this._lastCameraView={position:(0,d.A)(t)?j.A.clone(t.positionWC):void 0,direction:(0,d.A)(t)?j.A.clone(t.directionWC):void 0,up:(0,d.A)(t)?j.A.clone(t.upWC):void 0,bbox:(0,d.A)(t)?t.computeViewRectangle():Or.A.clone(Or.A.MAX_VALUE)},this._ellipsoid=e.ellipsoid??K.A.default;let i=e.credit;"string"==typeof i&&(i=new Ws.A(i)),this._credit=i,this._resourceCredits=[],this._kmlTours=[],this._screenOverlays=[]}function yE(e){const t=e.parent;if((0,d.A)(t)){const n=t.availability;if((0,d.A)(n)){const t=e.availability;(0,d.A)(t)?t.intersect(n):e.availability=n}}}_E.load=function(e,t){return new _E(t=t??S.A.EMPTY_OBJECT).load(e,t)},Object.defineProperties(_E.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},refreshEvent:{get:function(){return this._refresh}},unsupportedNodeEvent:{get:function(){return this._unsupportedNode}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!(0,d.A)(e))throw new A.A("value must be defined.");this._entityCluster=e}},credit:{get:function(){return this._credit}},kmlTours:{get:function(){return this._kmlTours}}}),_E.prototype.load=function(e,t){if(!(0,d.A)(e))throw new A.A("data is required.");t=t??S.A.EMPTY_OBJECT,sa.A.setLoading(this,!0);const n=this._name;this._name=void 0,this._clampToGround=t.clampToGround??!1;const i=this;return gE(this,this._entityCollection,e,t).then(function(){let e;const t=i._entityCollection.computeAvailability();let o=t.start,r=t.stop;const s=te.A.equals(o,Tn.A.MINIMUM_VALUE),a=te.A.equals(r,Tn.A.MAXIMUM_VALUE);if(!s||!a){let t;s&&(t=new Date,t.setHours(0,0,0,0),o=te.A.fromDate(t)),a&&(t=new Date,t.setHours(24,0,0,0),r=te.A.fromDate(t)),e=new ha,e.startTime=o,e.stopTime=r,e.currentTime=te.A.clone(o),e.clockRange=Hs.LOOP_STOP,e.clockStep=Gs.SYSTEM_CLOCK_MULTIPLIER,e.multiplier=Math.round(Math.min(Math.max(te.A.secondsDifference(r,o)/60,1),31556900))}let c=!1;return e!==i._clock&&(i._clock=e,c=!0),n!==i._name&&(c=!0),c&&i._changed.raiseEvent(i),sa.A.setLoading(i,!1),i}).catch(function(e){return sa.A.setLoading(i,!1),i._error.raiseEvent(i,e),console.log(e),Promise.reject(e)})},_E.prototype.destroy=function(){for(;this._screenOverlays.length>0;)this._screenOverlays.pop().remove()};const vE=new Ft.A;function TE(){this.author={name:void 0,uri:void 0,email:void 0},this.link={href:void 0,hreflang:void 0,rel:void 0,type:void 0,title:void 0,length:void 0},this.address=void 0,this.phoneNumber=void 0,this.snippet=void 0,this.extendedData=void 0}_E.prototype.update=function(e){const t=this._networkLinks;if(0===t.length)return!0;const n=te.A.now(),i=this;function o(e){const t=e._children,n=t.length;for(let e=0;e<n;++e){const n=t[e];vE.set(n.id,n),o(n)}}vE.removeAll();let r=!1;const s=this._lastCameraView,a=this.camera;!(0,d.A)(a)||a.positionWC.equalsEpsilon(s.position,J.A.EPSILON7)&&a.directionWC.equalsEpsilon(s.direction,J.A.EPSILON7)&&a.upWC.equalsEpsilon(s.up,J.A.EPSILON7)||(s.position=j.A.clone(a.positionWC),s.direction=j.A.clone(a.directionWC),s.up=j.A.clone(a.upWC),s.bbox=a.computeViewRectangle(),r=!0);const c=new Ft.A;let l=!1;return t.values.forEach(function(e){const t=e.entity;if(!vE.contains(t.id)){if(!e.updating){let a=!1;if(e.refreshMode===lE.INTERVAL?te.A.secondsDifference(n,e.lastUpdated)>e.time&&(a=!0):e.refreshMode===lE.EXPIRE?te.A.greaterThan(n,e.time)&&(a=!0):e.refreshMode===lE.STOP&&(r&&(e.needsUpdate=!0,e.cameraUpdateTime=n),e.needsUpdate&&te.A.secondsDifference(n,e.cameraUpdateTime)>=e.time&&(a=!0)),a){o(t),e.updating=!0;const n=new Ri.A,r=e.href.clone();r.setQueryParameters(e.cookie);const a=i._ellipsoid??K.A.default;fE(r,i.camera,i.canvas,e.viewBoundScale,s.bbox,a),gE(i,n,r,{context:t.id}).then(function(e,t,n,i,o){return function(r){if(!i.contains(t.id))return;let s=!1;const a=PC(r,"NetworkLinkControl",fC.kml);let c=0;if((0,d.A)(a)){if((0,d.A)(PC(a,"Update",fC.kml)))return(0,Fn.A)("kml-networkLinkControl-update","KML - NetworkLinkControl updates aren't supported."),t.updating=!1,void i.remove(t.id);t.cookie=(0,xv.A)(MC(a,"cookie",fC.kml)??""),c=RC(a,"minRefreshPeriod",fC.kml)??0}const l=te.A.now(),u=t.refreshMode;if(u===lE.INTERVAL)(0,d.A)(a)&&(t.time=Math.max(c,t.time));else if(u===lE.EXPIRE){let e;if((0,d.A)(a)&&(e=MC(a,"expires",fC.kml)),(0,d.A)(e))try{const n=te.A.fromIso8601(e),i=te.A.secondsDifference(n,l);i>0&&i<c&&te.A.addSeconds(l,c,n),t.time=n}catch(e){(0,Fn.A)("kml-networkLinkControl-expires","KML - NetworkLinkControl expires is not a valid date"),s=!0}else(0,Fn.A)("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element"),s=!0}const h=t.entity,A=e._entityCollection,p=n.values;function f(e){A.remove(e);const t=e._children,n=t.length;for(let e=0;e<n;++e)f(t[e])}A.suspendEvents();const m=A.values.slice();let g;for(g=0;g<m.length;++g){const e=m[g];e.parent===h&&(e.parent=void 0,f(e))}for(A.resumeEvents(),A.suspendEvents(),g=0;g<p.length;g++){const e=p[g];(0,d.A)(e.parent)||(e.parent=h,yE(e)),A.add(e)}A.resumeEvents(),s?i.remove(t.id):t.lastUpdated=l;const _=A.computeAvailability(),y=_.start,v=_.stop,T=te.A.equals(y,Tn.A.MINIMUM_VALUE),b=te.A.equals(v,Tn.A.MAXIMUM_VALUE);if(!T||!b){const t=e._clock;t.startTime===y&&t.stopTime===v||(t.startTime=y,t.stopTime=v,e._changed.raiseEvent(e))}t.updating=!1,t.needsUpdate=!1,e._refresh.raiseEvent(e,o.getUrlComponent(!0))}}(i,e,n,c,r)).catch(function(t){const n=`NetworkLink ${e.href} refresh failed: ${t}`;console.log(n),i._error.raiseEvent(i,n)}),l=!0}}c.set(e.id,e)}}),l&&(this._networkLinks=c,this._changed.raiseEvent(this)),!0},_E._DeferredLoading=gC,_E._getTimestamp=aa.A;const bE=_E;var wE=n(810186);function xE(){A.A.throwInstantiationError()}xE.prototype.update=A.A.throwInstantiationError,xE.prototype.getBoundingSphere=A.A.throwInstantiationError,xE.prototype.isDestroyed=A.A.throwInstantiationError,xE.prototype.destroy=A.A.throwInstantiationError;const CE=xE;var EE=n(802733);const SE="http://www.google.com/kml/ext/2.2";function IE(e){this._files={},this._promises=[],this._count=0,this._modelCallback=e}const PE=/^data:image\/([^,;]+)/;function DE(e,t){return function(n){e._files[t]=n}}function OE(e){this._time=e}function RE(){this._ids={},this._styles={},this._count=0}function ME(){this._ids={}}function LE(e){const t=(e=e??S.A.EMPTY_OBJECT).entities,n=e.kmz??!1;if(!(0,d.A)(t))throw new A.A("entities is required.");const i=LE._createState(e),o=t.values.filter(function(e){return!(0,d.A)(e.parent)}),r=i.kmlDoc,s=r.documentElement;s.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:gx",SE);const a=r.createElement("Document");s.appendChild(a),BE(i,a,o),i.styleCache.save(a);const c=i.externalFileHandler;return c.promise.then(function(){const e=(new XMLSerializer).serializeToString(i.kmlDoc);return n?function(e,t){const n=(0,yv.A)("ThirdParty/Workers/z-worker-pako.js");OT({workerScripts:{deflate:[n,"./pako_deflate.min.js"],inflate:[n,"./pako_inflate.min.js"]}});const i=new dw,o=new Mx(i);return o.add("doc.kml",new hw(e)).then(function(){const e=Object.keys(t);return NE(o,e,t,0)}).then(function(){return o.close()}).then(function(e){return{kmz:e}})}(e,c.files):{kml:e,externalFiles:c.files}})}function NE(e,t,n,i){if(t.length===i)return;const o=t[i];return e.add(o,new uw(n[o])).then(function(){return NE(e,t,n,i+1)})}function BE(e,t,n){const i=e.kmlDoc,o=e.styleCache,r=e.valueGetter,s=e.idManager,a=n.length;let c,l,u;for(let h=0;h<a;++h){const a=n[h];let A;c=[],l=[],u=[],VE(e,a,l,u),WE(e,a.polyline,l,u),qE(e,a.rectangle,l,u,c),qE(e,a.polygon,l,u,c),QE(e,a,a.model,l,u);const p=a.availability;(0,d.A)(p)&&(A=i.createElement("TimeSpan"),te.A.equals(p.start,Tn.A.MINIMUM_VALUE)||A.appendChild(JE(i,"begin",te.A.toIso8601(p.start))),te.A.equals(p.stop,Tn.A.MAXIMUM_VALUE)||A.appendChild(JE(i,"end",te.A.toIso8601(p.stop))));for(let e=0;e<c.length;++e){const n=c[e];n.setAttribute("id",s.get(a.id)),n.appendChild(JE(i,"name",a.name)),n.appendChild(JE(i,"visibility",a.show)),n.appendChild(JE(i,"description",a.description)),(0,d.A)(A)&&n.appendChild(A),t.appendChild(n)}const f=l.length;if(f>0){const e=i.createElement("Placemark");e.setAttribute("id",s.get(a.id));let n=a.name;const c=a.label;if((0,d.A)(c)){const e=i.createElement("LabelStyle"),t=r.get(c.text);n=(0,d.A)(t)&&t.length>0?t:n;const o=r.getColor(c.fillColor);(0,d.A)(o)&&(e.appendChild(JE(i,"color",o)),e.appendChild(JE(i,"colorMode","normal")));const s=r.get(c.scale);(0,d.A)(s)&&e.appendChild(JE(i,"scale",s)),u.push(e)}e.appendChild(JE(i,"name",n)),e.appendChild(JE(i,"visibility",a.show)),e.appendChild(JE(i,"description",a.description)),(0,d.A)(A)&&e.appendChild(A),t.appendChild(e);const h=u.length;if(h>0){const t=i.createElement("Style");for(let e=0;e<h;++e)t.appendChild(u[e]);e.appendChild(JE(i,"styleUrl",o.get(t)))}if(1===l.length)e.appendChild(l[0]);else if(l.length>1){const t=i.createElement("MultiGeometry");for(let e=0;e<f;++e)t.appendChild(l[e]);e.appendChild(t)}}const m=a._children;if(m.length>0){const n=i.createElement("Folder");n.setAttribute("id",s.get(a.id)),n.appendChild(JE(i,"name",a.name)),n.appendChild(JE(i,"visibility",a.show)),n.appendChild(JE(i,"description",a.description)),t.appendChild(n),BE(e,n,m)}}}IE.prototype.texture=function(e){const t=this;let n;if("string"==typeof e||e instanceof Lt.A){if(!(e=Lt.A.createIfNeeded(e)).isDataUri)return e.url;const i=e.url.match(PE);n="texture_"+ ++this._count,(0,d.A)(i)&&(n+=`.${i[1]}`);const o=e.fetchBlob().then(function(e){t._files[n]=e});return this._promises.push(o),n}if(e instanceof HTMLCanvasElement){n=`texture_${++this._count}.png`;const i=new Promise(i=>{e.toBlob(function(e){t._files[n]=e,i()})});return this._promises.push(i),n}return""},IE.prototype.model=function(e,t){const n=this._modelCallback;if(!(0,d.A)(n))throw new M.A("Encountered a model entity while exporting to KML, but no model callback was supplied.");const i={},o=n(e,t,i);for(const e in i)if(i.hasOwnProperty(e)){const t=Promise.resolve(i[e]);this._promises.push(t),t.then(DE(this,e))}return o},Object.defineProperties(IE.prototype,{promise:{get:function(){return Promise.all(this._promises)}},files:{get:function(){return this._files}}}),OE.prototype.get=function(e,t,n){let i;return(0,d.A)(e)&&(i=(0,d.A)(e.getValue)?e.getValue(this._time,n):e),i??t},OE.prototype.getColor=function(e,t){const n=this.get(e,t);if((0,d.A)(n))return ZE(n)},OE.prototype.getMaterialType=function(e){if((0,d.A)(e))return e.getType(this._time)},RE.prototype.get=function(e){const t=this._ids,n=e.innerHTML;if((0,d.A)(t[n]))return t[n];let i="style-"+ ++this._count;return e.setAttribute("id",i),i=`#${i}`,t[n]=i,this._styles[n]=e,i},RE.prototype.save=function(e){const t=this._styles,n=e.childNodes[0];for(const i in t)t.hasOwnProperty(i)&&e.insertBefore(t[i],n)},ME.prototype.get=function(e){if(!(0,d.A)(e))return this.get((0,E.A)());const t=this._ids;return(0,d.A)(t[e])?`${e.toString()}-${++t[e]}`:(t[e]=0,e)},LE._createState=function(e){const t=e.entities,n=new RE,i=t.computeAvailability(),o=(0,d.A)(e.time)?e.time:i.start;let r=e.defaultAvailability??i;const s=e.sampleDuration??60;r.start===Tn.A.MINIMUM_VALUE?r.stop===Tn.A.MAXIMUM_VALUE?r=new ji.A:te.A.addSeconds(r.stop,-10*s,r.start):r.stop===Tn.A.MAXIMUM_VALUE&&te.A.addSeconds(r.start,10*s,r.stop);const a=new IE(e.modelCallback);return{kmlDoc:document.implementation.createDocument("http://www.opengis.net/kml/2.2","kml"),ellipsoid:e.ellipsoid??K.A.default,idManager:new ME,styleCache:n,externalFileHandler:a,time:o,valueGetter:new OE(o),sampleDuration:s,defaultAvailability:new oo([r])}};const FE=new j.A,UE=new X.A,kE=new te.A;function VE(e,t,n,i){const o=e.kmlDoc,r=e.ellipsoid,s=e.valueGetter,a=t.billboard??t.point;if(!(0,d.A)(a)&&!(0,d.A)(t.path))return;const c=t.position;if(!c.isConstant)return void zE(e,t,a,n,i);s.get(c,void 0,FE);const l=JE(o,"coordinates",$E(FE,r)),u=o.createElement("Point"),h=o.createElement("altitudeMode");h.appendChild(KE(e,a.heightReference)),u.appendChild(h),u.appendChild(l),n.push(u);const A=a instanceof Bt.A?GE(e,a):HE(e,a);i.push(A)}function zE(e,t,n,i,o){const r=e.kmlDoc,s=e.ellipsoid,a=e.valueGetter;let c;const l=t.position;let u=!0;l instanceof po?(c=l.intervals,u=!1):c=t.availability??e.defaultAvailability;const h=n instanceof Ca.A;let A,p,f;const m=[];for(A=0;A<c.length;++A){const t=c.get(A);let i=u?l:t.data;const o=r.createElement("altitudeMode");i instanceof kf?(i=i._value,o.appendChild(KE(e,Vt.Ay.CLAMP_TO_GROUND))):(0,d.A)(n)?o.appendChild(KE(e,n.heightReference)):o.appendChild(KE(e,Vt.Ay.NONE));const g=[],_=[];if(i.isConstant){a.get(i,void 0,FE);const e=JE(r,"coordinates",$E(FE,s));g.push(te.A.toIso8601(t.start)),_.push(e),g.push(te.A.toIso8601(t.stop)),_.push(e)}else if(i instanceof mc)for(f=i._property._times,p=0;p<f.length;++p)g.push(te.A.toIso8601(f[p])),i.getValueInReferenceFrame(f[p],Ai.A.FIXED,FE),_.push($E(FE,s));else if(i instanceof Ac){f=i._times;const e=i._values;for(p=0;p<f.length;++p)g.push(te.A.toIso8601(f[p])),j.A.fromArray(e,3*p,FE),_.push($E(FE,s))}else{const n=e.sampleDuration;t.start.clone(kE),t.isStartIncluded||te.A.addSeconds(kE,n,kE);const o=t.stop;for(;te.A.lessThan(kE,o);)i.getValue(kE,FE),g.push(te.A.toIso8601(kE)),_.push($E(FE,s)),te.A.addSeconds(kE,n,kE);t.isStopIncluded&&te.A.equals(kE,o)&&(i.getValue(kE,FE),g.push(te.A.toIso8601(kE)),_.push($E(FE,s)))}const y=r.createElementNS(SE,"Track");y.appendChild(o);for(let e=0;e<g.length;++e){const t=JE(r,"when",g[e]),n=JE(r,"coord",_[e],SE);y.appendChild(t),y.appendChild(n)}h&&y.appendChild(jE(e,n)),m.push(y)}if(1===m.length)i.push(m[0]);else if(m.length>1){const e=r.createElementNS(SE,"MultiTrack");for(A=0;A<m.length;++A)e.appendChild(m[A]);i.push(e)}if((0,d.A)(n)&&!h){const t=n instanceof Bt.A?GE(e,n):HE(e,n);o.push(t)}const g=t.path;if((0,d.A)(g)){const t=a.get(g.width),n=g.material;if((0,d.A)(n)||(0,d.A)(t)){const i=r.createElement("LineStyle");(0,d.A)(t)&&i.appendChild(JE(r,"width",t)),XE(e,n,i),o.push(i)}}}function HE(e,t){const n=e.kmlDoc,i=e.valueGetter,o=n.createElement("IconStyle"),r=i.getColor(t.color);(0,d.A)(r)&&(o.appendChild(JE(n,"color",r)),o.appendChild(JE(n,"colorMode","normal")));const s=i.get(t.pixelSize);return(0,d.A)(s)&&o.appendChild(JE(n,"scale",s/32)),o}function GE(e,t){const n=e.kmlDoc,i=e.valueGetter,o=e.externalFileHandler,r=n.createElement("IconStyle");let s=i.get(t.image);if((0,d.A)(s)){s=o.texture(s);const e=n.createElement("Icon");e.appendChild(JE(n,"href",s));const a=i.get(t.imageSubRegion);(0,d.A)(a)&&(e.appendChild(JE(n,"x",a.x,SE)),e.appendChild(JE(n,"y",a.y,SE)),e.appendChild(JE(n,"w",a.width,SE)),e.appendChild(JE(n,"h",a.height,SE))),r.appendChild(e)}const a=i.getColor(t.color);(0,d.A)(a)&&(r.appendChild(JE(n,"color",a)),r.appendChild(JE(n,"colorMode","normal")));let c=i.get(t.scale);(0,d.A)(c)&&r.appendChild(JE(n,"scale",c));const l=i.get(t.pixelOffset);if((0,d.A)(l)){c=c??1,q.A.divideByScalar(l,c,l);const e=i.get(t.width,32),o=i.get(t.height,32),s=i.get(t.horizontalOrigin,zt.A.CENTER);s===zt.A.CENTER?l.x-=.5*e:s===zt.A.RIGHT&&(l.x-=e);const a=i.get(t.verticalOrigin,Ht.A.CENTER);a===Ht.A.TOP?l.y+=o:a===Ht.A.CENTER&&(l.y+=.5*o);const u=n.createElement("hotSpot");u.setAttribute("x",-l.x),u.setAttribute("y",l.y),u.setAttribute("xunits","pixels"),u.setAttribute("yunits","pixels"),r.appendChild(u)}let u=i.get(t.rotation);const h=i.get(t.alignedAxis);return(0,d.A)(u)&&j.A.equals(j.A.UNIT_Z,h)&&(u=J.A.toDegrees(-u),0===u&&(u=360),r.appendChild(JE(n,"heading",u))),r}function WE(e,t,n,i){const o=e.kmlDoc,r=e.ellipsoid,s=e.valueGetter;if(!(0,d.A)(t))return;const a=o.createElement("LineString"),c=o.createElement("altitudeMode"),l=s.get(t.clampToGround,!1);let u;l?(a.appendChild(JE(o,"tessellate",!0)),u=o.createTextNode("clampToGround")):u=o.createTextNode("absolute"),c.appendChild(u),a.appendChild(c);const h=t.positions,A=JE(o,"coordinates",$E(s.get(h),r));a.appendChild(A);const p=s.get(t.zIndex);l&&(0,d.A)(p)&&a.appendChild(JE(o,"drawOrder",p,SE)),n.push(a);const f=o.createElement("LineStyle"),m=s.get(t.width);(0,d.A)(m)&&f.appendChild(JE(o,"width",m)),XE(e,t.material,f),i.push(f)}function YE(e,t,n,i){const o=e.kmlDoc,r=e.ellipsoid,s=[],a=t.length;for(let e=0;e<a;++e)X.A.fromCartesian(t[e],r,UE),s.push(`${J.A.toDegrees(UE.longitude)},${J.A.toDegrees(UE.latitude)},${i?UE.height:n}`);const c=JE(o,"coordinates",s.join(" ")),l=o.createElement("LinearRing");return l.appendChild(c),l}function qE(e,t,n,i,o){const r=e.kmlDoc,s=e.valueGetter;if(!(0,d.A)(t))return;const a=t instanceof Ja.A;if(a&&"Image"===s.getMaterialType(t.material))return void function(e,t,n){const i=e.kmlDoc,o=e.valueGetter,r=e.externalFileHandler,s=i.createElement("GroundOverlay"),a=i.createElement("altitudeMode");a.appendChild(KE(e,t.heightReference)),s.appendChild(a);const c=o.get(t.height);(0,d.A)(c)&&s.appendChild(JE(i,"altitude",c));const l=o.get(t.coordinates),u=i.createElement("LatLonBox");u.appendChild(JE(i,"north",J.A.toDegrees(l.north))),u.appendChild(JE(i,"south",J.A.toDegrees(l.south))),u.appendChild(JE(i,"east",J.A.toDegrees(l.east))),u.appendChild(JE(i,"west",J.A.toDegrees(l.west))),s.appendChild(u);const h=o.get(t.material),A=r.texture(h.image),p=i.createElement("Icon");p.appendChild(JE(i,"href",A)),s.appendChild(p);const f=h.color;(0,d.A)(f)&&s.appendChild(JE(i,"color",ZE(h.color))),n.push(s)}(e,t,o);const c=r.createElement("Polygon"),l=s.get(t.extrudedHeight,0);l>0&&c.appendChild(JE(r,"extrude",!0));const h=a?function(e,t,n){const i=e.kmlDoc,o=e.valueGetter;let r=o.get(t.height,0);n>0&&(r=n);const s=t.coordinates,a=o.get(s),c=[],l=[Or.A.northeast,Or.A.southeast,Or.A.southwest,Or.A.northwest];for(let e=0;e<4;++e)l[e](a,UE),c.push(`${J.A.toDegrees(UE.longitude)},${J.A.toDegrees(UE.latitude)},${r}`);const u=JE(i,"coordinates",c.join(" ")),d=i.createElement("outerBoundaryIs"),h=i.createElement("LinearRing");return h.appendChild(u),d.appendChild(h),[d]}(e,t,l):function(e,t,n){const i=e.kmlDoc,o=e.valueGetter;let r=o.get(t.height,0);const s=o.get(t.perPositionHeight,!1);!s&&n>0&&(r=n);const a=[],c=t.hierarchy,l=o.get(c),u=Array.isArray(l)?l:l.positions,h=i.createElement("outerBoundaryIs");h.appendChild(YE(e,u,r,s)),a.push(h);const A=l.holes;if((0,d.A)(A)){const t=A.length;for(let n=0;n<t;++n){const t=i.createElement("innerBoundaryIs");t.appendChild(YE(e,A[n].positions,r,s)),a.push(t)}}return a}(e,t,l),A=h.length;for(let e=0;e<A;++e)c.appendChild(h[e]);const p=r.createElement("altitudeMode");p.appendChild(KE(e,t.heightReference)),c.appendChild(p),n.push(c);const f=r.createElement("PolyStyle"),m=s.get(t.fill,!1);m&&f.appendChild(JE(r,"fill",m)),XE(e,t.material,f);const g=s.get(t.outline,!1);if(g){f.appendChild(JE(r,"outline",g));const e=r.createElement("LineStyle"),n=s.get(t.outlineWidth,1);e.appendChild(JE(r,"width",n));const o=s.getColor(t.outlineColor,u.A.BLACK);e.appendChild(JE(r,"color",o)),e.appendChild(JE(r,"colorMode","normal")),i.push(e)}i.push(f)}function jE(e,t){const n=e.kmlDoc,i=e.valueGetter,o=e.externalFileHandler,r=n.createElement("Model"),s=i.get(t.scale);if((0,d.A)(s)){const e=n.createElement("scale");e.appendChild(JE(n,"x",s)),e.appendChild(JE(n,"y",s)),e.appendChild(JE(n,"z",s)),r.appendChild(e)}const a=n.createElement("Link"),c=o.model(t,e.time);return a.appendChild(JE(n,"href",c)),r.appendChild(a),r}function QE(e,t,n,i,o){const r=e.kmlDoc,s=e.ellipsoid,a=e.valueGetter;if(!(0,d.A)(n))return;const c=t.position;if(!c.isConstant)return void zE(e,t,n,i,o);const l=jE(e,n),u=r.createElement("altitudeMode");u.appendChild(KE(e,n.heightReference)),l.appendChild(u),a.get(c,void 0,FE),X.A.fromCartesian(FE,s,UE);const h=r.createElement("Location");h.appendChild(JE(r,"longitude",J.A.toDegrees(UE.longitude))),h.appendChild(JE(r,"latitude",J.A.toDegrees(UE.latitude))),h.appendChild(JE(r,"altitude",UE.height)),l.appendChild(h),i.push(l)}function XE(e,t,n){const i=e.kmlDoc,o=e.valueGetter;if(!(0,d.A)(t))return;const r=o.get(t);if(!(0,d.A)(r))return;let s,a,c;switch(o.getMaterialType(t)){case"Image":s=ZE(u.A.WHITE);break;case"Color":case"Grid":case"PolylineGlow":case"PolylineArrow":case"PolylineDash":s=ZE(r.color);break;case"PolylineOutline":s=ZE(r.color),a=ZE(r.outlineColor),c=r.outlineWidth,n.appendChild(JE(i,"outerColor",a,SE)),n.appendChild(JE(i,"outerWidth",c,SE));break;case"Stripe":s=ZE(r.oddColor)}(0,d.A)(s)&&(n.appendChild(JE(i,"color",s)),n.appendChild(JE(i,"colorMode","normal")))}function KE(e,t){const n=e.kmlDoc;let i;switch(e.valueGetter.get(t,Vt.Ay.NONE)){case Vt.Ay.NONE:i=n.createTextNode("absolute");break;case Vt.Ay.CLAMP_TO_GROUND:i=n.createTextNode("clampToGround");break;case Vt.Ay.RELATIVE_TO_GROUND:i=n.createTextNode("relativeToGround")}return i}function $E(e,t){Array.isArray(e)||(e=[e]);const n=e.length,i=[];for(let o=0;o<n;++o)X.A.fromCartesian(e[o],t,UE),i.push(`${J.A.toDegrees(UE.longitude)},${J.A.toDegrees(UE.latitude)},${UE.height}`);return i.join(" ")}function JE(e,t,n,i){"boolean"==typeof(n=n??"")&&(n=n?"1":"0");const o=(0,d.A)(i)?e.createElementNS(i,t):e.createElement(t),r="string"===n&&-1!==n.indexOf("<")?e.createCDATASection(n):e.createTextNode(n);return o.appendChild(r),o}function ZE(e){let t="";const n=e.toBytes();for(let e=3;e>=0;--e)t+=n[e]<16?`0${n[e].toString(16)}`:n[e].toString(16);return t}const eS=LE,tS="#ifdef MRT\nlayout (location = 0) out vec4 out_FragData_0;\nlayout (location = 1) out vec4 out_FragData_1;\n#else\nlayout (location = 0) out vec4 out_FragColor;\n#endif\n\nuniform vec4 u_bgColor;\nuniform sampler2D u_depthTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    if (texture(u_depthTexture, v_textureCoordinates).r < 1.0)\n    {\n#ifdef MRT\n        out_FragData_0 = u_bgColor;\n        out_FragData_1 = vec4(u_bgColor.a);\n#else\n        out_FragColor = u_bgColor;\n#endif\n        return;\n    }\n    \n    discard;\n}\n";var nS=n(468649),iS=n(952738),oS=n(412562);const rS="in vec2 v_textureCoordinates;\nconst float M_PI = 3.141592653589793;\n\nfloat vdcRadicalInverse(int i)\n{\n    float r;\n    float base = 2.0;\n    float value = 0.0;\n    float invBase = 1.0 / base;\n    float invBi = invBase;\n    for (int x = 0; x < 100; x++)\n    {\n        if (i <= 0)\n        {\n            break;\n        }\n        r = mod(float(i), base);\n        value += r * invBi;\n        invBi *= invBase;\n        i = int(float(i) * invBase);\n    }\n    return value;\n}\n\nvec2 hammersley2D(int i, int N)\n{\n    return vec2(float(i) / float(N), vdcRadicalInverse(i));\n}\n\nvec3 importanceSampleGGX(vec2 xi, float alphaRoughness, vec3 N)\n{\n    float alphaRoughnessSquared = alphaRoughness * alphaRoughness;\n    float phi = 2.0 * M_PI * xi.x;\n    float cosTheta = sqrt((1.0 - xi.y) / (1.0 + (alphaRoughnessSquared - 1.0) * xi.y));\n    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n    vec3 H = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);\n    vec3 upVector = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n    vec3 tangentX = normalize(cross(upVector, N));\n    vec3 tangentY = cross(N, tangentX);\n    return tangentX * H.x + tangentY * H.y + N * H.z;\n}\n\n/**\n * Estimate the geometric self-shadowing of the microfacets in a surface,\n * using the Smith Joint GGX visibility function.\n * Note: Vis = G / (4 * NdotL * NdotV)\n * see Eric Heitz. 2014. Understanding the Masking-Shadowing Function in Microfacet-Based BRDFs. Journal of Computer Graphics Techniques, 3\n * see Real-Time Rendering. Page 331 to 336.\n * see https://google.github.io/filament/Filament.md.html#materialsystem/specularbrdf/geometricshadowing(specularg)\n *\n * @param {float} alphaRoughness The roughness of the material, expressed as the square of perceptual roughness.\n * @param {float} NdotL The cosine of the angle between the surface normal and the direction to the light source.\n * @param {float} NdotV The cosine of the angle between the surface normal and the direction to the camera.\n */\nfloat smithVisibilityGGX(float alphaRoughness, float NdotL, float NdotV)\n{\n    float alphaRoughnessSq = alphaRoughness * alphaRoughness;\n\n    float GGXV = NdotL * sqrt(NdotV * NdotV * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);\n    float GGXL = NdotV * sqrt(NdotL * NdotL * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);\n\n    float GGX = GGXV + GGXL; // 2.0 if NdotL = NdotV = 1.0\n    if (GGX > 0.0)\n    {\n        return 0.5 / GGX; // 1/4 if NdotL = NdotV = 1.0\n    }\n    return 0.0;\n}\n\nvec2 integrateBrdf(float roughness, float NdotV)\n{\n    vec3 V = vec3(sqrt(1.0 - NdotV * NdotV), 0.0, NdotV);\n    float A = 0.0;\n    float B = 0.0;\n    const int NumSamples = 1024;\n    float alphaRoughness = roughness * roughness;\n    for (int i = 0; i < NumSamples; i++)\n    {\n        vec2 xi = hammersley2D(i, NumSamples);\n        vec3 H = importanceSampleGGX(xi, alphaRoughness, vec3(0.0, 0.0, 1.0));\n        vec3 L = 2.0 * dot(V, H) * H - V;\n        float NdotL = clamp(L.z, 0.0, 1.0);\n        float NdotH = clamp(H.z, 0.0, 1.0);\n        float VdotH = clamp(dot(V, H), 0.0, 1.0);\n        if (NdotL > 0.0)\n        {\n            float G = smithVisibilityGGX(alphaRoughness, NdotL, NdotV);\n            float G_Vis = 4.0 * G * VdotH * NdotL / NdotH;\n            float Fc = pow(1.0 - VdotH, 5.0);\n            A += (1.0 - Fc) * G_Vis;\n            B += Fc * G_Vis;\n        }\n    }\n    return vec2(A, B) / float(NumSamples);\n}\n\nvoid main()\n{\n    out_FragColor = vec4(integrateBrdf(v_textureCoordinates.y, v_textureCoordinates.x), 0.0, 1.0);\n}\n",sS="uniform sampler2D u_noiseTexture;\nuniform vec3 u_noiseTextureDimensions;\nuniform float u_noiseDetail;\nin vec2 v_offset;\nin vec3 v_maximumSize;\nin vec4 v_color;\nin float v_slice;\nin float v_brightness;\n\nfloat wrap(float value, float rangeLength) {\n    if(value < 0.0) {\n        float absValue = abs(value);\n        float modValue = mod(absValue, rangeLength);\n        return mod(rangeLength - modValue, rangeLength);\n    }\n    return mod(value, rangeLength);\n}\n\nvec3 wrapVec(vec3 value, float rangeLength) {\n    return vec3(wrap(value.x, rangeLength),\n                wrap(value.y, rangeLength),\n                wrap(value.z, rangeLength));\n}\n\nvec2 voxelToUV(vec3 voxelIndex) {\n    float textureSliceWidth = u_noiseTextureDimensions.x;\n    float noiseTextureRows = u_noiseTextureDimensions.y;\n    float inverseNoiseTextureRows = u_noiseTextureDimensions.z;\n\n    float textureSliceWidthSquared = textureSliceWidth * textureSliceWidth;\n    vec2 inverseNoiseTextureDimensions = vec2(noiseTextureRows / textureSliceWidthSquared,\n                                            inverseNoiseTextureRows / textureSliceWidth);\n    vec3 wrappedIndex = wrapVec(voxelIndex, textureSliceWidth);\n    float column = mod(wrappedIndex.z, textureSliceWidth * inverseNoiseTextureRows);\n    float row = floor(wrappedIndex.z / textureSliceWidth * noiseTextureRows);\n\n    float xPixelCoord = wrappedIndex.x + column * textureSliceWidth;\n    float yPixelCoord = wrappedIndex.y + row * textureSliceWidth;\n    return vec2(xPixelCoord, yPixelCoord) * inverseNoiseTextureDimensions;\n}\n\n// Interpolate a voxel with its neighbor (along the positive X-axis)\nvec4 lerpSamplesX(vec3 voxelIndex, float x) {\n    vec2 uv0 = voxelToUV(voxelIndex);\n    vec2 uv1 = voxelToUV(voxelIndex + vec3(1.0, 0.0, 0.0));\n    vec4 sample0 = texture(u_noiseTexture, uv0);\n    vec4 sample1 = texture(u_noiseTexture, uv1);\n    return mix(sample0, sample1, x);\n}\n\nvec4 sampleNoiseTexture(vec3 position) {\n    float textureSliceWidth = u_noiseTextureDimensions.x;\n    vec3 recenteredPos = position + vec3(textureSliceWidth / 2.0);\n    vec3 lerpValue = fract(recenteredPos);\n    vec3 voxelIndex = floor(recenteredPos);\n\n    vec4 xLerp00 = lerpSamplesX(voxelIndex, lerpValue.x);\n    vec4 xLerp01 = lerpSamplesX(voxelIndex + vec3(0.0, 0.0, 1.0), lerpValue.x);\n    vec4 xLerp10 = lerpSamplesX(voxelIndex + vec3(0.0, 1.0, 0.0), lerpValue.x);\n    vec4 xLerp11 = lerpSamplesX(voxelIndex + vec3(0.0, 1.0, 1.0), lerpValue.x);\n\n    vec4 yLerp0 = mix(xLerp00, xLerp10, lerpValue.y);\n    vec4 yLerp1 = mix(xLerp01, xLerp11, lerpValue.y);\n    return mix(yLerp0, yLerp1, lerpValue.z);\n}\n\n// Intersection with a unit sphere with radius 0.5 at center (0, 0, 0).\nbool intersectSphere(vec3 origin, vec3 dir, float slice,\n                     out vec3 point, out vec3 normal) {\n    float A = dot(dir, dir);\n    float B = dot(origin, dir);\n    float C = dot(origin, origin) - 0.25;\n    float discriminant = (B * B) - (A * C);\n    if(discriminant < 0.0) {\n        return false;\n    }\n    float root = sqrt(discriminant);\n    float t = (-B - root) / A;\n    if(t < 0.0) {\n        t = (-B + root) / A;\n    }\n    point = origin + t * dir;\n\n    if(slice >= 0.0) {\n        point.z = (slice / 2.0) - 0.5;\n        if(length(point) > 0.5) {\n            return false;\n        }\n    }\n\n    normal = normalize(point);\n    point -= czm_epsilon2 * normal;\n    return true;\n}\n\n// Transforms the ray origin and direction into unit sphere space,\n// then transforms the result back into the ellipsoid's space.\nbool intersectEllipsoid(vec3 origin, vec3 dir, vec3 center, vec3 scale, float slice,\n                        out vec3 point, out vec3 normal) {\n    if(scale.x <= 0.01 || scale.y < 0.01 || scale.z < 0.01) {\n        return false;\n    }\n\n    vec3 o = (origin - center) / scale;\n    vec3 d = dir / scale;\n    vec3 p, n;\n    bool intersected = intersectSphere(o, d, slice, p, n);\n    if(intersected) {\n        point = (p * scale) + center;\n        normal = n;\n    }\n    return intersected;\n}\n\n// Assume that if phase shift is being called for octave i,\n// the frequency is of i - 1. This saves us from doing extra\n// division / multiplication operations.\nvec2 phaseShift2D(vec2 p, vec2 freq) {\n    return (czm_pi / 2.0) * sin(freq.yx * p.yx);\n}\n\nvec2 phaseShift3D(vec3 p, vec2 freq) {\n    return phaseShift2D(p.xy, freq) + czm_pi * vec2(sin(freq.x * p.z));\n}\n\n// The cloud texture function derived from Gardner's 1985 paper,\n// \"Visual Simulation of Clouds.\"\n// https://www.cs.drexel.edu/~david/Classes/Papers/p297-gardner.pdf\nconst float T0    = 0.6;  // contrast of the texture pattern\nconst float k     = 0.1;  // computed to produce a maximum value of 1\nconst float C0    = 0.8;  // coefficient\nconst float FX0   = 0.6;  // frequency X\nconst float FY0   = 0.6;  // frequency Y\nconst int octaves = 5;\n\nfloat T(vec3 point) {\n    vec2 sum = vec2(0.0);\n    float Ci = C0;\n    vec2 FXY = vec2(FX0, FY0);\n    vec2 PXY = vec2(0.0);\n    for(int i = 1; i <= octaves; i++) {\n        PXY = phaseShift3D(point, FXY);\n        Ci *= 0.707;\n        FXY *= 2.0;\n        vec2 sinTerm = sin(FXY * point.xy + PXY);\n        sum += Ci * sinTerm + vec2(T0);\n    }\n    return k * sum.x * sum.y;\n}\n\nconst float a = 0.5;  // fraction of surface reflection due to ambient or scattered light,\nconst float t = 0.4;  // fraction of texture shading\nconst float s = 0.25; // fraction of specular reflection\n\nfloat I(float Id, float Is, float It) {\n    return (1.0 - a) * ((1.0 - t) * ((1.0 - s) * Id + s * Is) + t * It) + a;\n}\n\nconst vec3 lightDir = normalize(vec3(0.2, -1.0, 0.7));\n\nvec4 drawCloud(vec3 rayOrigin, vec3 rayDir, vec3 cloudCenter, vec3 cloudScale, float cloudSlice,\n               float brightness) {\n    vec3 cloudPoint, cloudNormal;\n    if(!intersectEllipsoid(rayOrigin, rayDir, cloudCenter, cloudScale, cloudSlice,\n                            cloudPoint, cloudNormal)) {\n        return vec4(0.0);\n    }\n\n    float Id = clamp(dot(cloudNormal, -lightDir), 0.0, 1.0);  // diffuse reflection\n    float Is = max(pow(dot(-lightDir, -rayDir), 2.0), 0.0);   // specular reflection\n    float It = T(cloudPoint);                                 // texture function\n    float intensity = I(Id, Is, It);\n    vec3 color = vec3(intensity * clamp(brightness, 0.1, 1.0));\n\n    vec4 noise = sampleNoiseTexture(u_noiseDetail * cloudPoint);\n    float W = noise.x;\n    float W2 = noise.y;\n    float W3 = noise.z;\n\n    // The dot product between the cloud's normal and the ray's direction is greatest\n    // in the center of the ellipsoid's surface. It decreases towards the edge.\n    // Thus, it is used to blur the areas leading to the edges of the ellipsoid,\n    // so that no harsh lines appear.\n\n    // The first (and biggest) layer of worley noise is then subtracted from this.\n    // The final result is scaled up so that the base cloud is not too translucent.\n    float ndDot = clamp(dot(cloudNormal, -rayDir), 0.0, 1.0);\n    float TR = pow(ndDot, 3.0) - W; // translucency\n    TR *= 1.3;\n\n    // Subtracting the second and third layers of worley noise is more complicated.\n    // If these layers of noise were simply subtracted from the current translucency,\n    // the shape derived from the first layer of noise would be completely deleted.\n    // The erosion of this noise should thus be constricted to the edges of the cloud.\n    // However, because the edges of the ellipsoid were already blurred away, mapping\n    // the noise to (1.0 - ndDot) will have no impact on most of the cloud's appearance.\n    // The value of (0.5 - ndDot) provides the best compromise.\n    float minusDot = 0.5 - ndDot;\n\n    // Even with the previous calculation, subtracting the second layer of wnoise\n    // erode too much of the cloud. The addition of it, however, will detailed\n    // volume to the cloud. As long as the noise is only added and not subtracted,\n    // the results are aesthetically pleasing.\n\n    // The minusDot product is mapped in a way that it is larger at the edges of\n    // the ellipsoid, so a subtraction and min operation are used instead of\n    // an addition and max one.\n    TR -= min(minusDot * W2, 0.0);\n\n    // The third level of worley noise is subtracted from the result, with some\n    // modifications. First, a scalar is added to minusDot so that the noise\n    // starts affecting the shape farther away from the center of the ellipsoid's\n    // surface. Then, it is scaled down so its impact is not too intense.\n    TR -= 0.8 * (minusDot + 0.25) * W3;\n\n    // The texture function's shading does not correlate with the shape of the cloud\n    // produced by the layers of noise, so an extra shading scalar is calculated.\n    // The darkest areas of the cloud are assigned to be where the noise erodes\n    // the cloud the most. This is then interpolated based on the translucency\n    // and the diffuse shading term of that point in the cloud.\n    float shading = mix(1.0 - 0.8 * W * W, 1.0, Id * TR);\n\n    // To avoid values that are too dark, this scalar is increased by a small amount\n    // and clamped so it never goes to zero.\n    shading = clamp(shading + 0.2, 0.3, 1.0);\n\n    // Finally, the contrast of the cloud's color is increased.\n    vec3 finalColor = mix(vec3(0.5), shading * color, 1.15);\n    return vec4(finalColor, clamp(TR, 0.0, 1.0)) * v_color;\n}\n\nvoid main() {\n#ifdef DEBUG_BILLBOARDS\n    out_FragColor = vec4(0.0, 0.5, 0.5, 1.0);\n#endif\n    // To avoid calculations with high values,\n    // we raycast from an arbitrarily smaller space.\n    vec2 coordinate = v_maximumSize.xy * v_offset;\n\n    vec3 ellipsoidScale = 0.82 * v_maximumSize;\n    vec3 ellipsoidCenter = vec3(0.0);\n\n    float zOffset = max(ellipsoidScale.z - 10.0, 0.0);\n    vec3 eye = vec3(0, 0, -10.0 - zOffset);\n    vec3 rayDir = normalize(vec3(coordinate, 1.0) - eye);\n    vec3 rayOrigin = eye;\n#ifdef DEBUG_ELLIPSOIDS\n    vec3 point, normal;\n    if(intersectEllipsoid(rayOrigin, rayDir, ellipsoidCenter, ellipsoidScale, v_slice,\n                          point, normal)) {\n        out_FragColor = v_brightness * v_color;\n    }\n#else\n#ifndef DEBUG_BILLBOARDS\n    vec4 cloud = drawCloud(rayOrigin, rayDir,\n                           ellipsoidCenter, ellipsoidScale, v_slice, v_brightness);\n    if(cloud.w < 0.01) {\n        discard;\n    }\n    out_FragColor = cloud;\n#endif\n#endif\n}\n",aS="#ifdef INSTANCED\nin vec2 direction;\n#endif\nin vec4 positionHighAndScaleX;\nin vec4 positionLowAndScaleY;\nin vec4 packedAttribute0;\nin vec4 packedAttribute1;\nin vec4 color;\n\nout vec2 v_offset;\nout vec3 v_maximumSize;\nout vec4 v_color;\nout float v_slice;\nout float v_brightness;\n\nvoid main() {\n    // Unpack attributes.\n    vec3 positionHigh = positionHighAndScaleX.xyz;\n    vec3 positionLow = positionLowAndScaleY.xyz;\n    vec2 scale = vec2(positionHighAndScaleX.w, positionLowAndScaleY.w);\n\n    float show = packedAttribute0.x;\n    float brightness = packedAttribute0.y;\n    vec2 coordinates = packedAttribute0.wz;\n    vec3 maximumSize = packedAttribute1.xyz;\n    float slice = packedAttribute1.w;\n\n#ifdef INSTANCED\n    vec2 dir = direction;\n#else\n    vec2 dir = coordinates;\n#endif\n\n    vec2 offset = dir - vec2(0.5, 0.5);\n    vec2 scaledOffset = scale * offset;\n    vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\n    vec4 positionEC = czm_modelViewRelativeToEye * p;\n    positionEC.xy += scaledOffset;\n    \n    positionEC.xyz *= show;\n    gl_Position = czm_projection * positionEC;\n\n    v_offset = offset;\n    v_maximumSize = maximumSize;\n    v_color = color;\n    v_slice = slice;\n    v_brightness = brightness;\n}\n",cS="uniform vec3 u_noiseTextureDimensions;\nuniform float u_noiseDetail;\nuniform vec3 u_noiseOffset;\nin vec2 v_position;\n\nfloat wrap(float value, float rangeLength) {\n    if(value < 0.0) {\n        float absValue = abs(value);\n        float modValue = mod(absValue, rangeLength);\n        return mod(rangeLength - modValue, rangeLength);\n    }\n    return mod(value, rangeLength);\n}\n\nvec3 wrapVec(vec3 value, float rangeLength) {\n    return vec3(wrap(value.x, rangeLength),\n                wrap(value.y, rangeLength),\n                wrap(value.z, rangeLength));\n}\n\nvec3 random3(vec3 p) {\n    float dot1 = dot(p, vec3(127.1, 311.7, 932.8));\n    float dot2 = dot(p, vec3(269.5, 183.3, 421.4));\n    return fract(vec3(sin(dot1 - dot2), cos(dot1 * dot2), dot1 * dot2));\n}\n\n// Frequency corresponds to cell size.\n// The higher the frequency, the smaller the cell size.\nvec3 getWorleyCellPoint(vec3 centerCell, vec3 offset, float freq) {\n    float textureSliceWidth = u_noiseTextureDimensions.x;\n    vec3 cell = centerCell + offset;\n    cell = wrapVec(cell, textureSliceWidth / u_noiseDetail);\n    cell += floor(u_noiseOffset / u_noiseDetail);\n    vec3 p = offset + random3(cell);\n    return p;\n}\n\nfloat worleyNoise(vec3 p, float freq) {\n    vec3 centerCell = floor(p * freq);\n    vec3 pointInCell = fract(p * freq);\n    float shortestDistance = 1000.0;\n\n    for(float z = -1.0; z <= 1.0; z++) {\n        for(float y = -1.0; y <= 1.0; y++) {\n            for(float x = -1.0; x <= 1.0; x++) {\n                vec3 offset = vec3(x, y, z);\n                vec3 point = getWorleyCellPoint(centerCell, offset, freq);\n\n                float distance = length(pointInCell - point);\n                if(distance < shortestDistance) {\n                    shortestDistance = distance;\n                }\n            }\n        }\n    }\n\n    return shortestDistance;\n}\n\nconst float MAX_FBM_ITERATIONS = 10.0;\n\nfloat worleyFBMNoise(vec3 p, float octaves, float scale) {\n    float noise = 0.0;\n    float freq = 1.0;\n    float persistence = 0.625;\n    for(float i = 0.0; i < MAX_FBM_ITERATIONS; i++) {\n        if(i >= octaves) {\n            break;\n        }\n\n        noise += worleyNoise(p * scale, freq * scale) * persistence;\n        persistence *= 0.5;\n        freq *= 2.0;\n    }\n    return noise;\n}\n\nvoid main() {\n    float textureSliceWidth = u_noiseTextureDimensions.x;\n    float inverseNoiseTextureRows = u_noiseTextureDimensions.z;\n    float x = mod(v_position.x, textureSliceWidth);\n    float y = mod(v_position.y, textureSliceWidth);\n    float sliceRow = floor(v_position.y / textureSliceWidth);\n    float z = floor(v_position.x / textureSliceWidth) + sliceRow * inverseNoiseTextureRows * textureSliceWidth;\n\n    vec3 position = vec3(x, y, z);\n    position /= u_noiseDetail;\n    float worley0 = clamp(worleyFBMNoise(position, 3.0, 1.0), 0.0, 1.0);\n    float worley1 = clamp(worleyFBMNoise(position, 3.0, 2.0), 0.0, 1.0);\n    float worley2 = clamp(worleyFBMNoise(position, 3.0, 3.0), 0.0, 1.0);\n    out_FragColor = vec4(worley0, worley1, worley2, 1.0);\n}\n",lS="uniform vec3 u_noiseTextureDimensions;\nin vec2 position;\n\nout vec2 v_position;\n\nvoid main()\n{\n    gl_Position = vec4(position, 0.1, 1.0);\n\n    float textureSliceWidth = u_noiseTextureDimensions.x;\n    float noiseTextureRows = u_noiseTextureDimensions.y;\n    float inverseNoiseTextureRows = u_noiseTextureDimensions.z;\n    vec2 transformedPos = (position * 0.5) + vec2(0.5);\n    transformedPos *= textureSliceWidth;\n    transformedPos.x *= textureSliceWidth * inverseNoiseTextureRows;\n    transformedPos.y *= noiseTextureRows;\n    v_position = transformedPos;\n}\n",uS="uniform sampler2D u_opaqueDepthTexture;\nuniform sampler2D u_translucentDepthTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    float opaqueDepth = texture(u_opaqueDepthTexture, v_textureCoordinates).r;\n    float translucentDepth = texture(u_translucentDepthTexture, v_textureCoordinates).r;\n    translucentDepth = czm_branchFreeTernary(translucentDepth > opaqueDepth, 1.0, translucentDepth);\n    out_FragColor = czm_packDepth(translucentDepth);\n}\n",dS="/**\n * Compositing for Weighted Blended Order-Independent Transparency. See:\n * - http://jcgt.org/published/0002/02/09/\n * - http://casual-effects.blogspot.com/2014/03/weighted-blended-order-independent.html\n */\n\nuniform sampler2D u_opaque;\nuniform sampler2D u_accumulation;\nuniform sampler2D u_revealage;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    vec4 opaque = texture(u_opaque, v_textureCoordinates);\n    vec4 accum = texture(u_accumulation, v_textureCoordinates);\n    float r = texture(u_revealage, v_textureCoordinates).r;\n\n#ifdef MRT\n    vec4 transparent = vec4(accum.rgb / clamp(r, 1e-4, 5e4), accum.a);\n#else\n    vec4 transparent = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);\n#endif\n\n    out_FragColor = (1.0 - transparent.a) * transparent + transparent.a * opaque;\n\n    if (opaque != czm_backgroundColor)\n    {\n        out_FragColor.a = 1.0;\n    }\n}\n";var hS=n(635582),AS=n(198709),pS=n(722856),fS=n(864248);const mS="in vec4 positionEC;\n\nvoid main()\n{\n    vec3 position;\n    vec3 direction;\n    if (czm_orthographicIn3D == 1.0)\n    {\n        vec2 uv = (gl_FragCoord.xy -  czm_viewport.xy) / czm_viewport.zw;\n        vec2 minPlane = vec2(czm_frustumPlanes.z, czm_frustumPlanes.y); // left, bottom\n        vec2 maxPlane = vec2(czm_frustumPlanes.w, czm_frustumPlanes.x); // right, top\n        position = vec3(mix(minPlane, maxPlane, uv), 0.0);\n        direction = vec3(0.0, 0.0, -1.0);\n    } \n    else \n    {\n        position = vec3(0.0);\n        direction = normalize(positionEC.xyz);\n    }\n\n    czm_ray ray = czm_ray(position, direction);\n\n    vec3 ellipsoid_center = czm_view[3].xyz;\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid_center, czm_ellipsoidInverseRadii);\n    if (!czm_isEmpty(intersection))\n    {\n        out_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n    }\n    else\n    {\n        discard;\n    }\n\n    czm_writeLogDepth();\n}\n",gS="in vec4 position;\n\nout vec4 positionEC;\n\nvoid main()\n{\n    positionEC = czm_modelView * position;\n    gl_Position = czm_projection * positionEC;\n\n    czm_vertexLogDepth();\n}\n",_S="uniform vec3 u_radii;\nuniform vec3 u_oneOverEllipsoidRadiiSquared;\n\nin vec3 v_positionEC;\n\nvec4 computeEllipsoidColor(czm_ray ray, float intersection, float side)\n{\n    vec3 positionEC = czm_pointAlongRay(ray, intersection);\n    vec3 positionMC = (czm_inverseModelView * vec4(positionEC, 1.0)).xyz;\n    vec3 geodeticNormal = normalize(czm_geodeticSurfaceNormal(positionMC, vec3(0.0), u_oneOverEllipsoidRadiiSquared));\n    vec3 sphericalNormal = normalize(positionMC / u_radii);\n    vec3 normalMC = geodeticNormal * side;              // normalized surface normal (always facing the viewer) in model coordinates\n    vec3 normalEC = normalize(czm_normal * normalMC);   // normalized surface normal in eye coordinates\n\n    vec2 st = czm_ellipsoidTextureCoordinates(sphericalNormal);\n    vec3 positionToEyeEC = -positionEC;\n\n    czm_materialInput materialInput;\n    materialInput.s = st.s;\n    materialInput.st = st;\n    materialInput.str = (positionMC + u_radii) / u_radii;\n    materialInput.normalEC = normalEC;\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);\n    materialInput.positionToEyeEC = positionToEyeEC;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef ONLY_SUN_LIGHTING\n    return czm_private_phong(normalize(positionToEyeEC), material, czm_sunDirectionEC);\n#else\n    return czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n#endif\n}\n\nvoid main()\n{\n    // PERFORMANCE_TODO: When dynamic branching is available, compute ratio of maximum and minimum radii\n    // in the vertex shader. Only when it is larger than some constant, march along the ray.\n    // Otherwise perform one intersection test which will be the common case.\n\n    // Test if the ray intersects a sphere with the ellipsoid's maximum radius.\n    // For very oblate ellipsoids, using the ellipsoid's radii for an intersection test\n    // may cause false negatives. This will discard fragments before marching the ray forward.\n    float maxRadius = max(u_radii.x, max(u_radii.y, u_radii.z)) * 1.5;\n    vec3 direction = normalize(v_positionEC);\n    vec3 ellipsoidCenter = czm_modelView[3].xyz;\n\n    float t1 = -1.0;\n    float t2 = -1.0;\n\n    float b = -2.0 * dot(direction, ellipsoidCenter);\n    float c = dot(ellipsoidCenter, ellipsoidCenter) - maxRadius * maxRadius;\n\n    float discriminant = b * b - 4.0 * c;\n    if (discriminant >= 0.0) {\n        t1 = (-b - sqrt(discriminant)) * 0.5;\n        t2 = (-b + sqrt(discriminant)) * 0.5;\n    }\n\n    if (t1 < 0.0 && t2 < 0.0) {\n        discard;\n    }\n\n    float t = min(t1, t2);\n    if (t < 0.0) {\n        t = 0.0;\n    }\n\n    // March ray forward to intersection with larger sphere and find\n    czm_ray ray = czm_ray(t * direction, direction);\n\n    vec3 ellipsoid_inverseRadii = vec3(1.0 / u_radii.x, 1.0 / u_radii.y, 1.0 / u_radii.z);\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoidCenter, ellipsoid_inverseRadii);\n\n    if (czm_isEmpty(intersection))\n    {\n        discard;\n    }\n\n    // If the viewer is outside, compute outsideFaceColor, with normals facing outward.\n    vec4 outsideFaceColor = (intersection.start != 0.0) ? computeEllipsoidColor(ray, intersection.start, 1.0) : vec4(0.0);\n\n    // If the viewer either is inside or can see inside, compute insideFaceColor, with normals facing inward.\n    vec4 insideFaceColor = (outsideFaceColor.a < 1.0) ? computeEllipsoidColor(ray, intersection.stop, -1.0) : vec4(0.0);\n\n    out_FragColor = mix(insideFaceColor, outsideFaceColor, outsideFaceColor.a);\n    out_FragColor.a = 1.0 - (1.0 - insideFaceColor.a) * (1.0 - outsideFaceColor.a);\n\n#if (defined(WRITE_DEPTH) && (__VERSION__ == 300 || defined(GL_EXT_frag_depth)))\n    t = (intersection.start != 0.0) ? intersection.start : intersection.stop;\n    vec3 positionEC = czm_pointAlongRay(ray, t);\n    vec4 positionCC = czm_projection * vec4(positionEC, 1.0);\n#ifdef LOG_DEPTH\n    czm_writeLogDepth(1.0 + positionCC.w);\n#else\n    float z = positionCC.z / positionCC.w;\n\n    float n = czm_depthRange.near;\n    float f = czm_depthRange.far;\n\n    gl_FragDepth = (z * (f - n) + f + n) * 0.5;\n#endif\n#endif\n}\n",yS="in vec3 position;\n\nuniform vec3 u_radii;\n\nout vec3 v_positionEC;\n\nvoid main()\n{\n    // In the vertex data, the cube goes from (-1.0, -1.0, -1.0) to (1.0, 1.0, 1.0) in model coordinates.\n    // Scale to consider the radii.  We could also do this once on the CPU when using the BoxGeometry,\n    // but doing it here allows us to change the radii without rewriting the vertex data, and\n    // allows all ellipsoids to reuse the same vertex data.\n    vec4 p = vec4(u_radii * position, 1.0);\n    \n    vec4 pEC = czm_modelView * p;\n    v_positionEC = pEC.xyz;     // position in eye coordinates\n    gl_Position = czm_projection * pEC;\n    // With multi-frustum, when the ellipsoid primitive is positioned on the intersection of two frustums\n    // and close to terrain, the terrain (writes depth) in the closest frustum can overwrite part of the\n    // ellipsoid (does not write depth) that was rendered in the farther frustum.\n    //\n    // Here, we clamp the depth in the vertex shader to avoid being overwritten; however, this creates\n    // artifacts since some fragments can be alpha blended twice.  This is solved by only rendering\n    // the ellipsoid in the closest frustum to the viewer.\n    gl_Position.z = clamp(gl_Position.z, czm_depthRange.near, czm_depthRange.far);\n\n    czm_vertexLogDepth();\n}\n",vS="/**\n * @license\n * Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *  * Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *  * Neither the name of NVIDIA CORPORATION nor the names of its\n *    contributors may be used to endorse or promote products derived\n *    from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n// NVIDIA GameWorks Graphics Samples GitHub link: https://github.com/NVIDIAGameWorks/GraphicsSamples\n// Original source (archived): https://archive.org/details/nvidiagame-works-graphics-samples-master\n// Original FXAA 3.11 shader link: https://github.com/NVIDIAGameWorks/GraphicsSamples/blob/master/samples/es3-kepler/FXAA/FXAA3_11.h\n// Shader link in fork: https://github.com/lyntel/GraphicsSamples/blob/3d30817ebeeade64fe6a4fc3aa1fe4265c29b6fd/samples/es3-kepler/FXAA/FXAA3_11.h\n\n// Steps used to integrate into Cesium:\n// * The following defines are set:\n//       #define FXAA_PC 1\n//       #define FXAA_WEBGL_1 1\n//       #define FXAA_GREEN_AS_LUMA 1\n//       #define FXAA_EARLY_EXIT 1\n//       #define FXAA_GLSL_120 1\n// * All other preprocessor directives besides the FXAA_QUALITY__P* directives were removed.\n// * Double underscores are invalid for preprocessor directives so replace them with a single underscore. Replace\n//   /FXAA_QUALITY__P(.*)/g with /FXAA_QUALITY__P$1/.\n// * There are no implicit conversions from ivec* to vec* so replace:\n//       #define FxaaInt2 ivec2\n//           with\n//       #define FxaaInt2 vec2\n// * The texture2DLod function is only available in vertex shaders so replace:\n//       #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)\n//       #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)\n//           with\n//       #define FxaaTexTop(t, p) texture(t, p)\n//       #define FxaaTexOff(t, p, o, r) texture(t, p + (o * r))\n// * FXAA_QUALITY_PRESET is prepended in the javascript code. We may want to expose that setting in the future.\n// * The following parameters to FxaaPixelShader are unused and can be removed:\n//       fxaaConsolePosPos\n//       fxaaConsoleRcpFrameOpt\n//       fxaaConsoleRcpFrameOpt2\n//       fxaaConsole360RcpFrameOpt2\n//       fxaaConsoleEdgeSharpness\n//       fxaaConsoleEdgeThreshold\n//       fxaaConsoleEdgeThresholdMi\n//       fxaaConsole360ConstDir\n\n//\n// Choose the quality preset.\n// This needs to be compiled into the shader as it effects code.\n// Best option to include multiple presets is to\n// in each shader define the preset, then include this file.\n//\n// OPTIONS\n// -----------------------------------------------------------------------\n// 10 to 15 - default medium dither (10=fastest, 15=highest quality)\n// 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)\n// 39       - no dither, very expensive\n//\n// NOTES\n// -----------------------------------------------------------------------\n// 12 = slightly faster then FXAA 3.9 and higher edge quality (default)\n// 13 = about same speed as FXAA 3.9 and better than 12\n// 23 = closest to FXAA 3.9 visually and performance wise\n//  _ = the lowest digit is directly related to performance\n// _  = the highest digit is directly related to style\n//\n//#define FXAA_QUALITY_PRESET 12\n\n\n#if (FXAA_QUALITY_PRESET == 10)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 3.0\n    #define FXAA_QUALITY_P2 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 11)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 3.0\n    #define FXAA_QUALITY_P3 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 12)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 4.0\n    #define FXAA_QUALITY_P4 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 13)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 4.0\n    #define FXAA_QUALITY_P5 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 14)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 4.0\n    #define FXAA_QUALITY_P6 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 15)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 20)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 2.0\n    #define FXAA_QUALITY_P2 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 21)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 22)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 23)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 24)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 3.0\n    #define FXAA_QUALITY_P6 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 25)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 26)\n    #define FXAA_QUALITY_PS 9\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 4.0\n    #define FXAA_QUALITY_P8 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 27)\n    #define FXAA_QUALITY_PS 10\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 4.0\n    #define FXAA_QUALITY_P9 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 28)\n    #define FXAA_QUALITY_PS 11\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 4.0\n    #define FXAA_QUALITY_P10 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 29)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 39)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.0\n    #define FXAA_QUALITY_P2 1.0\n    #define FXAA_QUALITY_P3 1.0\n    #define FXAA_QUALITY_P4 1.0\n    #define FXAA_QUALITY_P5 1.5\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n\n#define FxaaBool bool\n#define FxaaFloat float\n#define FxaaFloat2 vec2\n#define FxaaFloat3 vec3\n#define FxaaFloat4 vec4\n#define FxaaHalf float\n#define FxaaHalf2 vec2\n#define FxaaHalf3 vec3\n#define FxaaHalf4 vec4\n#define FxaaInt2 vec2\n#define FxaaTex sampler2D\n\n#define FxaaSat(x) clamp(x, 0.0, 1.0)\n#define FxaaTexTop(t, p) texture(t, p)\n#define FxaaTexOff(t, p, o, r) texture(t, p + (o * r))\n\nFxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }\n\nFxaaFloat4 FxaaPixelShader(\n    //\n    // Use noperspective interpolation here (turn off perspective interpolation).\n    // {xy} = center of pixel\n    FxaaFloat2 pos,\n    //\n    // Input color texture.\n    // {rgb_} = color in linear or perceptual color space\n    // if (FXAA_GREEN_AS_LUMA == 0)\n    //     {___a} = luma in perceptual color space (not linear)\n    FxaaTex tex,\n    //\n    // Only used on FXAA Quality.\n    // This must be from a constant/uniform.\n    // {x_} = 1.0/screenWidthInPixels\n    // {_y} = 1.0/screenHeightInPixels\n    FxaaFloat2 fxaaQualityRcpFrame,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_SUBPIX define.\n    // It is here now to allow easier tuning.\n    // Choose the amount of sub-pixel aliasing removal.\n    // This can effect sharpness.\n    //   1.00 - upper limit (softer)\n    //   0.75 - default amount of filtering\n    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)\n    //   0.25 - almost off\n    //   0.00 - completely off\n    FxaaFloat fxaaQualitySubpix,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.\n    // It is here now to allow easier tuning.\n    // The minimum amount of local contrast required to apply algorithm.\n    //   0.333 - too little (faster)\n    //   0.250 - low quality\n    //   0.166 - default\n    //   0.125 - high quality\n    //   0.063 - overkill (slower)\n    FxaaFloat fxaaQualityEdgeThreshold,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.\n    // It is here now to allow easier tuning.\n    // Trims the algorithm from processing darks.\n    //   0.0833 - upper limit (default, the start of visible unfiltered edges)\n    //   0.0625 - high quality (faster)\n    //   0.0312 - visible limit (slower)\n    // Special notes when using FXAA_GREEN_AS_LUMA,\n    //   Likely want to set this to zero.\n    //   As colors that are mostly not-green\n    //   will appear very dark in the green channel!\n    //   Tune by looking at mostly non-green content,\n    //   then start at zero and increase until aliasing is a problem.\n    FxaaFloat fxaaQualityEdgeThresholdMin\n) {\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posM;\n    posM.x = pos.x;\n    posM.y = pos.y;\n    FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n    #define lumaM rgbyM.y\n    FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\n/*--------------------------------------------------------------------------*/\n    FxaaFloat maxSM = max(lumaS, lumaM);\n    FxaaFloat minSM = min(lumaS, lumaM);\n    FxaaFloat maxESM = max(lumaE, maxSM);\n    FxaaFloat minESM = min(lumaE, minSM);\n    FxaaFloat maxWN = max(lumaN, lumaW);\n    FxaaFloat minWN = min(lumaN, lumaW);\n    FxaaFloat rangeMax = max(maxWN, maxESM);\n    FxaaFloat rangeMin = min(minWN, minESM);\n    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n    FxaaFloat range = rangeMax - rangeMin;\n    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n    FxaaBool earlyExit = range < rangeMaxClamped;\n/*--------------------------------------------------------------------------*/\n    if(earlyExit)\n        return rgbyM;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNS = lumaN + lumaS;\n    FxaaFloat lumaWE = lumaW + lumaE;\n    FxaaFloat subpixRcpRange = 1.0/range;\n    FxaaFloat subpixNSWE = lumaNS + lumaWE;\n    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNESE = lumaNE + lumaSE;\n    FxaaFloat lumaNWNE = lumaNW + lumaNE;\n    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNWSW = lumaNW + lumaSW;\n    FxaaFloat lumaSWSE = lumaSW + lumaSE;\n    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\n    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\n    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;\n    FxaaBool horzSpan = edgeHorz >= edgeVert;\n    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n/*--------------------------------------------------------------------------*/\n    if(!horzSpan) lumaN = lumaW;\n    if(!horzSpan) lumaS = lumaE;\n    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat gradientN = lumaN - lumaM;\n    FxaaFloat gradientS = lumaS - lumaM;\n    FxaaFloat lumaNN = lumaN + lumaM;\n    FxaaFloat lumaSS = lumaS + lumaM;\n    FxaaBool pairN = abs(gradientN) >= abs(gradientS);\n    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));\n    if(pairN) lengthSign = -lengthSign;\n    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posB;\n    posB.x = posM.x;\n    posB.y = posM.y;\n    FxaaFloat2 offNP;\n    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n    if(!horzSpan) posB.x += lengthSign * 0.5;\n    if( horzSpan) posB.y += lengthSign * 0.5;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posN;\n    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\n    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat2 posP;\n    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\n    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;\n    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));\n    FxaaFloat subpixE = subpixC * subpixC;\n    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));\n/*--------------------------------------------------------------------------*/\n    if(!pairN) lumaNN = lumaSS;\n    FxaaFloat gradientScaled = gradient * 1.0/4.0;\n    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;\n    FxaaFloat subpixF = subpixD * subpixE;\n    FxaaBool lumaMLTZero = lumaMM < 0.0;\n/*--------------------------------------------------------------------------*/\n    lumaEndN -= lumaNN * 0.5;\n    lumaEndP -= lumaNN * 0.5;\n    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;\n    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;\n    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\n    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\n    FxaaBool doneNP = (!doneN) || (!doneP);\n    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\n    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\n/*--------------------------------------------------------------------------*/\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\n/*--------------------------------------------------------------------------*/\n        #if (FXAA_QUALITY_PS > 3)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\n/*--------------------------------------------------------------------------*/\n            #if (FXAA_QUALITY_PS > 4)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\n/*--------------------------------------------------------------------------*/\n                #if (FXAA_QUALITY_PS > 5)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\n/*--------------------------------------------------------------------------*/\n                    #if (FXAA_QUALITY_PS > 6)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\n/*--------------------------------------------------------------------------*/\n                        #if (FXAA_QUALITY_PS > 7)\n                        if(doneNP) {\n                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                            doneN = abs(lumaEndN) >= gradientScaled;\n                            doneP = abs(lumaEndP) >= gradientScaled;\n                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\n                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\n                            doneNP = (!doneN) || (!doneP);\n                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\n                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\n/*--------------------------------------------------------------------------*/\n    #if (FXAA_QUALITY_PS > 8)\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\n/*--------------------------------------------------------------------------*/\n        #if (FXAA_QUALITY_PS > 9)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\n/*--------------------------------------------------------------------------*/\n            #if (FXAA_QUALITY_PS > 10)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\n/*--------------------------------------------------------------------------*/\n                #if (FXAA_QUALITY_PS > 11)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\n/*--------------------------------------------------------------------------*/\n                    #if (FXAA_QUALITY_PS > 12)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\n/*--------------------------------------------------------------------------*/\n                    }\n                    #endif\n/*--------------------------------------------------------------------------*/\n                }\n                #endif\n/*--------------------------------------------------------------------------*/\n            }\n            #endif\n/*--------------------------------------------------------------------------*/\n        }\n        #endif\n/*--------------------------------------------------------------------------*/\n    }\n    #endif\n/*--------------------------------------------------------------------------*/\n                        }\n                        #endif\n/*--------------------------------------------------------------------------*/\n                    }\n                    #endif\n/*--------------------------------------------------------------------------*/\n                }\n                #endif\n/*--------------------------------------------------------------------------*/\n            }\n            #endif\n/*--------------------------------------------------------------------------*/\n        }\n        #endif\n/*--------------------------------------------------------------------------*/\n    }\n/*--------------------------------------------------------------------------*/\n    FxaaFloat dstN = posM.x - posN.x;\n    FxaaFloat dstP = posP.x - posM.x;\n    if(!horzSpan) dstN = posM.y - posN.y;\n    if(!horzSpan) dstP = posP.y - posM.y;\n/*--------------------------------------------------------------------------*/\n    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n    FxaaFloat spanLength = (dstP + dstN);\n    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n    FxaaFloat spanLengthRcp = 1.0/spanLength;\n/*--------------------------------------------------------------------------*/\n    FxaaBool directionN = dstN < dstP;\n    FxaaFloat dst = min(dstN, dstP);\n    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\n    FxaaFloat subpixG = subpixF * subpixF;\n    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n    return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);\n}\n",TS='uniform vec4 u_initialColor;\n\n#if TEXTURE_UNITS > 0\nuniform sampler2D u_dayTextures[TEXTURE_UNITS];\nuniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];\nuniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];\n\n#ifdef APPLY_ALPHA\nuniform float u_dayTextureAlpha[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_DAY_NIGHT_ALPHA\nuniform float u_dayTextureNightAlpha[TEXTURE_UNITS];\nuniform float u_dayTextureDayAlpha[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SPLIT\nuniform float u_dayTextureSplit[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_BRIGHTNESS\nuniform float u_dayTextureBrightness[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_CONTRAST\nuniform float u_dayTextureContrast[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_HUE\nuniform float u_dayTextureHue[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SATURATION\nuniform float u_dayTextureSaturation[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_GAMMA\nuniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_IMAGERY_CUTOUT\nuniform vec4 u_dayTextureCutoutRectangles[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_COLOR_TO_ALPHA\nuniform vec4 u_colorsToAlpha[TEXTURE_UNITS];\n#endif\n\nuniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];\n#endif\n\n#if defined(HAS_WATER_MASK) && (defined(SHOW_REFLECTIVE_OCEAN) || defined(APPLY_MATERIAL))\nuniform sampler2D u_waterMask;\nuniform vec4 u_waterMaskTranslationAndScale;\nuniform float u_zoomedOutOceanSpecularIntensity;\n#endif\n\n#ifdef SHOW_OCEAN_WAVES\nuniform sampler2D u_oceanNormalMap;\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\nuniform vec2 u_lightingFadeDistance;\n#endif\n\n#ifdef TILE_LIMIT_RECTANGLE\nuniform vec4 u_cartographicLimitRectangle;\n#endif\n\n#ifdef GROUND_ATMOSPHERE\nuniform vec2 u_nightFadeDistance;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\nuniform highp sampler2D u_clippingPlanes;\nuniform mat4 u_clippingPlanesMatrix;\nuniform vec4 u_clippingPlanesEdgeStyle;\n#endif\n\n#ifdef ENABLE_CLIPPING_POLYGONS\nuniform highp sampler2D u_clippingDistance;\nin vec2 v_clippingPosition;\nflat in int v_regionIndex;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG) && defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\nuniform float u_minimumBrightness;\n#endif\n\n// Based on colorCorrect\n// The colorCorrect flag can only be true when tileProvider.hue/saturation/brightnessShift \n// are nonzero AND when (applyFog || showGroundAtmosphere) in the tile provider\n// - The tileProvider.hue/saturation/brightnessShift are just passed through\n//   from the Globe hue/saturation/brightness, like atmosphereBrightnessShift\n// - The applyFog depends on enableFog, and some tile distance from the viewer\n// - The showGroundAtmosphere is a flag that is passed through from the Globe,\n//   and is true by default when the ellipsoid is WGS84\n#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift; // Hue, saturation, brightness\n#endif\n\n// Based on highlightFillTile\n// This is set for terrain tiles when they are "fill" tiles, and\n// the terrainProvider.fillHighlightColor was set to a value with\n// nonzero alpha\n#ifdef HIGHLIGHT_FILL_TILE\nuniform vec4 u_fillHighlightColor;\n#endif\n\n// Based on translucent\n// This is set depending on the GlobeTranslucencyState\n#ifdef TRANSLUCENT\nuniform vec4 u_frontFaceAlphaByDistance;\nuniform vec4 u_backFaceAlphaByDistance;\nuniform vec4 u_translucencyRectangle;\n#endif\n\n// Based on showUndergroundColor\n// This is set when GlobeSurfaceTileProvider.isUndergroundVisible \n// returns true, AND the tileProvider.undergroundColor had a value with \n// nonzero alpha, and the tileProvider.undergroundColorAlphaByDistance\n// was in the right range\n#ifdef UNDERGROUND_COLOR\nuniform vec4 u_undergroundColor;\nuniform vec4 u_undergroundColorAlphaByDistance;\n#endif\n\n// Based on enableLighting && hasVertexNormals\n// The enableLighting flag is passed in directly from the Globe.\n// The hasVertexNormals flag is from the tileProvider\n#ifdef ENABLE_VERTEX_LIGHTING\nuniform float u_lambertDiffuseMultiplier;\nuniform float u_vertexShadowDarkness;\n#endif\n\nin vec3 v_positionMC;\nin vec3 v_positionEC;\nin vec3 v_textureCoordinates;\nin vec3 v_normalMC;\nin vec3 v_normalEC;\n\n#ifdef APPLY_MATERIAL\nin float v_height;\nin float v_slope;\nin float v_aspect;\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\nin float v_distance;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG)\nin vec3 v_atmosphereRayleighColor;\nin vec3 v_atmosphereMieColor;\nin float v_atmosphereOpacity;\n#endif\n\n#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\nfloat interpolateByDistance(vec4 nearFarScalar, float distance)\n{\n    float startDistance = nearFarScalar.x;\n    float startValue = nearFarScalar.y;\n    float endDistance = nearFarScalar.z;\n    float endValue = nearFarScalar.w;\n    float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);\n    return mix(startValue, endValue, t);\n}\n#endif\n\n#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT) || defined(APPLY_MATERIAL)\nvec4 alphaBlend(vec4 sourceColor, vec4 destinationColor)\n{\n    return sourceColor * vec4(sourceColor.aaa, 1.0) + destinationColor * (1.0 - sourceColor.a);\n}\n#endif\n\n#ifdef TRANSLUCENT\nbool inTranslucencyRectangle()\n{\n    return\n        v_textureCoordinates.x > u_translucencyRectangle.x &&\n        v_textureCoordinates.x < u_translucencyRectangle.z &&\n        v_textureCoordinates.y > u_translucencyRectangle.y &&\n        v_textureCoordinates.y < u_translucencyRectangle.w;\n}\n#endif\n\nvec4 sampleAndBlend(\n    vec4 previousColor,\n    sampler2D textureToSample,\n    vec2 tileTextureCoordinates,\n    vec4 textureCoordinateRectangle,\n    vec4 textureCoordinateTranslationAndScale,\n    float textureAlpha,\n    float textureNightAlpha,\n    float textureDayAlpha,\n    float textureBrightness,\n    float textureContrast,\n    float textureHue,\n    float textureSaturation,\n    float textureOneOverGamma,\n    float split,\n    vec4 colorToAlpha,\n    float nightBlend)\n{\n    // This crazy step stuff sets the alpha to 0.0 if this following condition is true:\n    //    tileTextureCoordinates.s < textureCoordinateRectangle.s ||\n    //    tileTextureCoordinates.s > textureCoordinateRectangle.p ||\n    //    tileTextureCoordinates.t < textureCoordinateRectangle.t ||\n    //    tileTextureCoordinates.t > textureCoordinateRectangle.q\n    // In other words, the alpha is zero if the fragment is outside the rectangle\n    // covered by this texture.  Would an actual \'if\' yield better performance?\n    vec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n    alphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)\n    textureAlpha *= mix(textureDayAlpha, textureNightAlpha, nightBlend);\n#endif\n\n    vec2 translation = textureCoordinateTranslationAndScale.xy;\n    vec2 scale = textureCoordinateTranslationAndScale.zw;\n    vec2 textureCoordinates = tileTextureCoordinates * scale + translation;\n    vec4 value = texture(textureToSample, textureCoordinates);\n    vec3 color = value.rgb;\n    float alpha = value.a;\n\n#ifdef APPLY_COLOR_TO_ALPHA\n    vec3 colorDiff = abs(color.rgb - colorToAlpha.rgb);\n    colorDiff.r = czm_maximumComponent(colorDiff);\n    alpha = czm_branchFreeTernary(colorDiff.r < colorToAlpha.a, 0.0, alpha);\n#endif\n\n#if !defined(APPLY_GAMMA)\n    vec4 tempColor = czm_gammaCorrect(vec4(color, alpha));\n    color = tempColor.rgb;\n    alpha = tempColor.a;\n#else\n    color = pow(color, vec3(textureOneOverGamma));\n#endif\n\n#ifdef APPLY_SPLIT\n    float splitPosition = czm_splitPosition;\n    // Split to the left\n    if (split < 0.0 && gl_FragCoord.x > splitPosition) {\n       alpha = 0.0;\n    }\n    // Split to the right\n    else if (split > 0.0 && gl_FragCoord.x < splitPosition) {\n       alpha = 0.0;\n    }\n#endif\n\n#ifdef APPLY_BRIGHTNESS\n    color = mix(vec3(0.0), color, textureBrightness);\n#endif\n\n#ifdef APPLY_CONTRAST\n    color = mix(vec3(0.5), color, textureContrast);\n#endif\n\n#ifdef APPLY_HUE\n    color = czm_hue(color, textureHue);\n#endif\n\n#ifdef APPLY_SATURATION\n    color = czm_saturation(color, textureSaturation);\n#endif\n\n    float sourceAlpha = alpha * textureAlpha;\n    float outAlpha = mix(previousColor.a, 1.0, sourceAlpha);\n    outAlpha += sign(outAlpha) - 1.0;\n\n    vec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;\n\n    // When rendering imagery for a tile in multiple passes,\n    // some GPU/WebGL implementation combinations will not blend fragments in\n    // additional passes correctly if their computation includes an unmasked\n    // divide-by-zero operation,\n    // even if it\'s not in the output or if the output has alpha zero.\n    //\n    // For example, without sanitization for outAlpha,\n    // this renders without artifacts:\n    //   if (outAlpha == 0.0) { outColor = vec3(0.0); }\n    //\n    // but using czm_branchFreeTernary will cause portions of the tile that are\n    // alpha-zero in the additional pass to render as black instead of blending\n    // with the previous pass:\n    //   outColor = czm_branchFreeTernary(outAlpha == 0.0, vec3(0.0), outColor);\n    //\n    // So instead, sanitize against divide-by-zero,\n    // store this state on the sign of outAlpha, and correct on return.\n\n    return vec4(outColor, max(outAlpha, 0.0));\n}\n\nvec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend);\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue, float fade);\n\nconst float fExposure = 2.0;\n\nvec3 computeEllipsoidPosition()\n{\n    float mpp = czm_metersPerPixel(vec4(0.0, 0.0, -czm_currentFrustum.x, 1.0), 1.0);\n    vec2 xy = gl_FragCoord.xy / czm_viewport.zw * 2.0 - vec2(1.0);\n    xy *= czm_viewport.zw * mpp * 0.5;\n\n    vec3 direction;\n    if (czm_orthographicIn3D == 1.0)\n    {\n        direction = vec3(0.0, 0.0, -1.0);\n    }\n    else\n    {\n        direction = normalize(vec3(xy, -czm_currentFrustum.x));\n    }\n\n    czm_ray ray = czm_ray(vec3(0.0), direction);\n\n    vec3 ellipsoid_center = czm_view[3].xyz;\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid_center, czm_ellipsoidInverseRadii);\n\n    vec3 ellipsoidPosition = czm_pointAlongRay(ray, intersection.start);\n    return (czm_inverseView * vec4(ellipsoidPosition, 1.0)).xyz;\n}\n\nvoid main()\n{\n#ifdef TILE_LIMIT_RECTANGLE\n    if (v_textureCoordinates.x < u_cartographicLimitRectangle.x || u_cartographicLimitRectangle.z < v_textureCoordinates.x ||\n        v_textureCoordinates.y < u_cartographicLimitRectangle.y || u_cartographicLimitRectangle.w < v_textureCoordinates.y)\n        {\n            discard;\n        }\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    float clipDistance = clip(gl_FragCoord, u_clippingPlanes, u_clippingPlanesMatrix);\n#endif\n\n#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(HDR)\n    vec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));   // normalized surface normal in model coordinates\n    vec3 normalEC = czm_normal3D * normalMC;                                         // normalized surface normal in eye coordinates\n#endif\n\n#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)\n    float nightBlend = 1.0 - clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0, 0.0, 1.0);\n#else\n    float nightBlend = 0.0;\n#endif\n\n    // The clamp below works around an apparent bug in Chrome Canary v23.0.1241.0\n    // where the fragment shader sees textures coordinates < 0.0 and > 1.0 for the\n    // fragments on the edges of tiles even though the vertex shader is outputting\n    // coordinates strictly in the 0-1 range.\n    vec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0), nightBlend);\n\n#ifdef SHOW_TILE_BOUNDARIES\n    if (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||\n        v_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))\n    {\n        color = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\n    float cameraDist;\n    if (czm_sceneMode == czm_sceneMode2D)\n    {\n        cameraDist = max(czm_frustumPlanes.x - czm_frustumPlanes.y, czm_frustumPlanes.w - czm_frustumPlanes.z) * 0.5;\n    }\n    else if (czm_sceneMode == czm_sceneModeColumbusView)\n    {\n        cameraDist = -czm_view[3].z;\n    }\n    else\n    {\n        cameraDist = length(czm_view[3]);\n    }\n    float fadeOutDist = u_lightingFadeDistance.x;\n    float fadeInDist = u_lightingFadeDistance.y;\n    if (czm_sceneMode != czm_sceneMode3D) {\n        vec3 radii = czm_ellipsoidRadii;\n        float maxRadii = max(radii.x, max(radii.y, radii.z));\n        fadeOutDist -= maxRadii;\n        fadeInDist -= maxRadii;\n    }\n    float fade = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\n#else\n    float fade = 0.0;\n#endif\n\n#if defined(HAS_WATER_MASK) && (defined(SHOW_REFLECTIVE_OCEAN) || defined(APPLY_MATERIAL))\n    vec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;\n    vec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;\n    vec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;\n    waterMaskTextureCoordinates.y = 1.0 - waterMaskTextureCoordinates.y;\n\n    float mask = texture(u_waterMask, waterMaskTextureCoordinates).r;\n\n    #ifdef SHOW_REFLECTIVE_OCEAN\n    if (mask > 0.0)\n    {\n        mat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);\n\n        vec2 ellipsoidTextureCoordinates = czm_ellipsoidTextureCoordinates(normalMC);\n        vec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidTextureCoordinates(normalMC.zyx);\n\n        vec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));\n\n        color = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask, fade);\n    }\n    #endif\n#endif\n\n#ifdef APPLY_MATERIAL\n    czm_materialInput materialInput;\n    materialInput.st = v_textureCoordinates.st;\n    materialInput.normalEC = normalize(v_normalEC);\n    materialInput.positionToEyeEC = -v_positionEC;\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalize(v_normalEC));\n    materialInput.slope = v_slope;\n    materialInput.height = v_height;\n    materialInput.aspect = v_aspect;\n    #ifdef HAS_WATER_MASK\n        materialInput.waterMask = mask;\n    #endif\n\n    czm_material material = czm_getMaterial(materialInput);\n    vec4 materialColor = vec4(material.diffuse, material.alpha);\n    color = alphaBlend(materialColor, color);\n#endif\n\n#ifdef ENABLE_VERTEX_LIGHTING\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalize(v_normalEC)) * u_lambertDiffuseMultiplier + u_vertexShadowDarkness, 0.0, 1.0);\n    vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);\n#elif defined(ENABLE_DAYNIGHT_SHADING)\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);\n    diffuseIntensity = mix(1.0, diffuseIntensity, fade);\n    vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);\n#else\n    vec4 finalColor = color;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    vec4 clippingPlanesEdgeColor = vec4(1.0);\n    clippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb;\n    float clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a;\n\n    if (clipDistance < clippingPlanesEdgeWidth)\n    {\n        finalColor = clippingPlanesEdgeColor;\n    }\n#endif\n\n#ifdef ENABLE_CLIPPING_POLYGONS\n    vec2 clippingPosition = v_clippingPosition;\n    int regionIndex = v_regionIndex;\n    clipPolygons(u_clippingDistance, CLIPPING_POLYGON_REGIONS_LENGTH, clippingPosition, regionIndex);\n#endif\n\n#ifdef HIGHLIGHT_FILL_TILE\n    finalColor = vec4(mix(finalColor.rgb, u_fillHighlightColor.rgb, u_fillHighlightColor.a), finalColor.a);\n#endif\n\n#if defined(DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN)\n    vec3 atmosphereLightDirection = czm_sunDirectionWC;\n#else\n    vec3 atmosphereLightDirection = czm_lightDirectionWC;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG)\n    if (!czm_backFacing())\n    {\n        bool dynamicLighting = false;\n        #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))\n            dynamicLighting = true;\n        #endif\n\n        vec3 rayleighColor;\n        vec3 mieColor;\n        float opacity;\n\n        vec3 positionWC;\n        vec3 lightDirection;\n\n        // When the camera is far away (camera distance > nightFadeOutDistance), the scattering is computed in the fragment shader.\n        // Otherwise, the scattering is computed in the vertex shader.\n        #ifdef PER_FRAGMENT_GROUND_ATMOSPHERE\n            positionWC = computeEllipsoidPosition();\n            lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));\n            computeAtmosphereScattering(\n                positionWC,\n                lightDirection,\n                rayleighColor,\n                mieColor,\n                opacity\n            );\n        #else\n            positionWC = v_positionMC;\n            lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));\n            rayleighColor = v_atmosphereRayleighColor;\n            mieColor = v_atmosphereMieColor;\n            opacity = v_atmosphereOpacity;\n        #endif\n\n        #ifdef COLOR_CORRECT\n            const bool ignoreBlackPixels = true;\n            rayleighColor = czm_applyHSBShift(rayleighColor, u_hsbShift, ignoreBlackPixels);\n            mieColor = czm_applyHSBShift(mieColor, u_hsbShift, ignoreBlackPixels);\n        #endif\n\n        vec4 groundAtmosphereColor = computeAtmosphereColor(positionWC, lightDirection, rayleighColor, mieColor, opacity);\n\n        // Fog is applied to tiles selected for fog, close to the Earth.\n        #ifdef FOG\n            vec3 fogColor = groundAtmosphereColor.rgb;\n\n            // If there is lighting, apply that to the fog.\n            #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\n                float darken = clamp(dot(normalize(czm_viewerPositionWC), atmosphereLightDirection), u_minimumBrightness, 1.0);\n                fogColor *= darken;\n            #endif\n\n            #ifndef HDR\n                fogColor.rgb = czm_pbrNeutralTonemapping(fogColor.rgb);\n                fogColor.rgb = czm_inverseGamma(fogColor.rgb);\n            #endif\n\n            finalColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor.rgb, czm_fogVisualDensityScalar), finalColor.a);\n\n        #else\n            // Apply ground atmosphere. This happens when the camera is far away from the earth.\n\n            // The transmittance is based on optical depth i.e. the length of segment of the ray inside the atmosphere.\n            // This value is larger near the "circumference", as it is further away from the camera. We use it to\n            // brighten up that area of the ground atmosphere.\n            const float transmittanceModifier = 0.5;\n            float transmittance = transmittanceModifier + clamp(1.0 - groundAtmosphereColor.a, 0.0, 1.0);\n\n            vec3 finalAtmosphereColor = finalColor.rgb + groundAtmosphereColor.rgb * transmittance;\n\n            #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\n                float fadeInDist = u_nightFadeDistance.x;\n                float fadeOutDist = u_nightFadeDistance.y;\n\n                float sunlitAtmosphereIntensity = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.05, 1.0);\n                float darken = clamp(dot(normalize(positionWC), atmosphereLightDirection), 0.0, 1.0);\n                vec3 darkenendGroundAtmosphereColor = mix(groundAtmosphereColor.rgb, finalAtmosphereColor.rgb, darken);\n\n                finalAtmosphereColor = mix(darkenendGroundAtmosphereColor, finalAtmosphereColor, sunlitAtmosphereIntensity);\n            #endif\n\n            #ifndef HDR\n                finalAtmosphereColor.rgb = vec3(1.0) - exp(-fExposure * finalAtmosphereColor.rgb);\n            #else\n                finalAtmosphereColor.rgb = czm_saturation(finalAtmosphereColor.rgb, 1.6);\n            #endif\n\n            finalColor.rgb = mix(finalColor.rgb, finalAtmosphereColor.rgb, fade);\n        #endif\n    }\n#endif\n\n#ifdef UNDERGROUND_COLOR\n    if (czm_backFacing())\n    {\n        float distanceFromEllipsoid = max(czm_eyeHeight, 0.0);\n        float distance = max(v_distance - distanceFromEllipsoid, 0.0);\n        float blendAmount = interpolateByDistance(u_undergroundColorAlphaByDistance, distance);\n        vec4 undergroundColor = vec4(u_undergroundColor.rgb, u_undergroundColor.a * blendAmount);\n        finalColor = alphaBlend(undergroundColor, finalColor);\n    }\n#endif\n\n#ifdef TRANSLUCENT\n    if (inTranslucencyRectangle())\n    {\n      vec4 alphaByDistance = gl_FrontFacing ? u_frontFaceAlphaByDistance : u_backFaceAlphaByDistance;\n      finalColor.a *= interpolateByDistance(alphaByDistance, v_distance);\n    }\n#endif\n\n    out_FragColor =  finalColor;\n}\n\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n\nfloat waveFade(float edge0, float edge1, float x)\n{\n    float y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n    return pow(1.0 - y, 5.0);\n}\n\nfloat linearFade(float edge0, float edge1, float x)\n{\n    return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n}\n\n// Based on water rendering by Jonas Wagner:\n// http://29a.ch/2012/7/19/webgl-terrain-rendering-water-fog\n\n// low altitude wave settings\nconst float oceanFrequencyLowAltitude = 825000.0;\nconst float oceanAnimationSpeedLowAltitude = 0.004;\nconst float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;\nconst float oceanSpecularIntensity = 0.5;\n\n// high altitude wave settings\nconst float oceanFrequencyHighAltitude = 125000.0;\nconst float oceanAnimationSpeedHighAltitude = 0.008;\nconst float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;\n\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue, float fade)\n{\n    vec3 positionToEyeEC = -positionEyeCoordinates;\n    float positionToEyeECLength = length(positionToEyeEC);\n\n    // The double normalize below works around a bug in Firefox on Android devices.\n    vec3 normalizedPositionToEyeEC = normalize(normalize(positionToEyeEC));\n\n    // Fade out the waves as the camera moves far from the surface.\n    float waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);\n\n#ifdef SHOW_OCEAN_WAVES\n    // high altitude waves\n    float time = czm_frameNumber * oceanAnimationSpeedHighAltitude;\n    vec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);\n    vec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);\n\n    // low altitude waves\n    time = czm_frameNumber * oceanAnimationSpeedLowAltitude;\n    noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);\n    vec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);\n\n    // blend the 2 wave layers based on distance to surface\n    float highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);\n    float lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);\n    vec3 normalTangentSpace =\n        (highAltitudeFade * normalTangentSpaceHighAltitude) +\n        (lowAltitudeFade * normalTangentSpaceLowAltitude);\n    normalTangentSpace = normalize(normalTangentSpace);\n\n    // fade out the normal perturbation as we move farther from the water surface\n    normalTangentSpace.xy *= waveIntensity;\n    normalTangentSpace = normalize(normalTangentSpace);\n#else\n    vec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);\n#endif\n\n    vec3 normalEC = enuToEye * normalTangentSpace;\n\n    const vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);\n\n    // Use diffuse light to highlight the waves\n    float diffuseIntensity = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * maskValue;\n    vec3 diffuseHighlight = waveHighlightColor * diffuseIntensity * (1.0 - fade);\n\n#ifdef SHOW_OCEAN_WAVES\n    // Where diffuse light is low or non-existent, use wave highlights based solely on\n    // the wave bumpiness and no particular light direction.\n    float tsPerturbationRatio = normalTangentSpace.z;\n    vec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);\n#else\n    vec3 nonDiffuseHighlight = vec3(0.0);\n#endif\n\n    // Add specular highlights in 3D, and in all modes when zoomed in.\n    float specularIntensity = czm_getSpecular(czm_lightDirectionEC, normalizedPositionToEyeEC, normalEC, 10.0);\n    float surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);\n    float specular = specularIntensity * surfaceReflectance;\n\n#ifdef HDR\n    specular *= 1.4;\n\n    float e = 0.2;\n    float d = 3.3;\n    float c = 1.7;\n\n    vec3 color = imageryColor.rgb + (c * (vec3(e) + imageryColor.rgb * d) * (diffuseHighlight + nonDiffuseHighlight + specular));\n#else\n    vec3 color = imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular;\n#endif\n\n    return vec4(color, imageryColor.a);\n}\n\n#endif // #ifdef SHOW_REFLECTIVE_OCEAN\n',bS="#ifdef QUANTIZATION_BITS12\nin vec4 compressed0;\nin float compressed1;\n#else\nin vec4 position3DAndHeight;\nin vec4 textureCoordAndEncodedNormals;\n#endif\n\n#ifdef GEODETIC_SURFACE_NORMALS\nin vec3 geodeticSurfaceNormal;\n#endif\n\n#ifdef EXAGGERATION\nuniform vec2 u_verticalExaggerationAndRelativeHeight;\n#endif\n\nuniform vec3 u_center3D;\nuniform mat4 u_modifiedModelView;\nuniform mat4 u_modifiedModelViewProjection;\nuniform vec4 u_tileRectangle;\n\n// Uniforms for 2D Mercator projection\nuniform vec2 u_southAndNorthLatitude;\nuniform vec2 u_southMercatorYAndOneOverHeight;\n\nout vec3 v_positionMC;\nout vec3 v_positionEC;\n\nout vec3 v_textureCoordinates;\nout vec3 v_normalMC;\nout vec3 v_normalEC;\n\n#ifdef APPLY_MATERIAL\nout float v_slope;\nout float v_aspect;\nout float v_height;\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\nout float v_distance;\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\nout vec3 v_atmosphereRayleighColor;\nout vec3 v_atmosphereMieColor;\nout float v_atmosphereOpacity;\n#endif\n\n#ifdef ENABLE_CLIPPING_POLYGONS\nuniform highp sampler2D u_clippingExtents;\nout vec2 v_clippingPosition;\nflat out int v_regionIndex;\n#endif\n\n// These functions are generated at runtime.\nvec4 getPosition(vec3 position, float height, vec2 textureCoordinates);\nfloat get2DYPositionFraction(vec2 textureCoordinates);\n\nvec4 getPosition3DMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return u_modifiedModelViewProjection * vec4(position, 1.0);\n}\n\nfloat get2DMercatorYPositionFraction(vec2 textureCoordinates)\n{\n    // The width of a tile at level 11, in radians and assuming a single root tile, is\n    //   2.0 * czm_pi / pow(2.0, 11.0)\n    // We want to just linearly interpolate the 2D position from the texture coordinates\n    // when we're at this level or higher.  The constant below is the expression\n    // above evaluated and then rounded up at the 4th significant digit.\n    const float maxTileWidth = 0.003068;\n    float positionFraction = textureCoordinates.y;\n    float southLatitude = u_southAndNorthLatitude.x;\n    float northLatitude = u_southAndNorthLatitude.y;\n    if (northLatitude - southLatitude > maxTileWidth)\n    {\n        float southMercatorY = u_southMercatorYAndOneOverHeight.x;\n        float oneOverMercatorHeight = u_southMercatorYAndOneOverHeight.y;\n\n        float currentLatitude = mix(southLatitude, northLatitude, textureCoordinates.y);\n        currentLatitude = clamp(currentLatitude, -czm_webMercatorMaxLatitude, czm_webMercatorMaxLatitude);\n        positionFraction = czm_latitudeToWebMercatorFraction(currentLatitude, southMercatorY, oneOverMercatorHeight);\n    }\n    return positionFraction;\n}\n\nfloat get2DGeographicYPositionFraction(vec2 textureCoordinates)\n{\n    return textureCoordinates.y;\n}\n\nvec4 getPositionPlanarEarth(vec3 position, float height, vec2 textureCoordinates)\n{\n    float yPositionFraction = get2DYPositionFraction(textureCoordinates);\n    vec4 rtcPosition2D = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\n    return u_modifiedModelViewProjection * rtcPosition2D;\n}\n\nvec4 getPosition2DMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return getPositionPlanarEarth(position, 0.0, textureCoordinates);\n}\n\nvec4 getPositionColumbusViewMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return getPositionPlanarEarth(position, height, textureCoordinates);\n}\n\nvec4 getPositionMorphingMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    // We do not do RTC while morphing, so there is potential for jitter.\n    // This is unlikely to be noticeable, though.\n    vec3 position3DWC = position + u_center3D;\n    float yPositionFraction = get2DYPositionFraction(textureCoordinates);\n    vec4 position2DWC = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\n    vec4 morphPosition = czm_columbusViewMorph(position2DWC, vec4(position3DWC, 1.0), czm_morphTime);\n    vec4 morphPositionEC = czm_modelView * morphPosition;\n    return czm_projection * morphPositionEC;\n}\n\n#ifdef QUANTIZATION_BITS12\nuniform vec2 u_minMaxHeight;\nuniform mat4 u_scaleAndBias;\n#endif\n\nvoid main()\n{\n#ifdef QUANTIZATION_BITS12\n    vec2 xy = czm_decompressTextureCoordinates(compressed0.x);\n    vec2 zh = czm_decompressTextureCoordinates(compressed0.y);\n    vec3 position = vec3(xy, zh.x);\n    float height = zh.y;\n    vec2 textureCoordinates = czm_decompressTextureCoordinates(compressed0.z);\n\n    height = height * (u_minMaxHeight.y - u_minMaxHeight.x) + u_minMaxHeight.x;\n    position = (u_scaleAndBias * vec4(position, 1.0)).xyz;\n\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y) || defined(APPLY_MATERIAL)\n    float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\n    float encodedNormal = compressed1;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\n    float encodedNormal = 0.0;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = compressed0.w;\n#else\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = 0.0;\n#endif\n\n#else\n    // A single float per element\n    vec3 position = position3DAndHeight.xyz;\n    float height = position3DAndHeight.w;\n    vec2 textureCoordinates = textureCoordAndEncodedNormals.xy;\n\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = textureCoordAndEncodedNormals.z;\n    float encodedNormal = textureCoordAndEncodedNormals.w;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = textureCoordAndEncodedNormals.z;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = textureCoordAndEncodedNormals.z;\n    float encodedNormal = 0.0;\n#else\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = 0.0;\n#endif\n\n#endif\n\n    vec3 position3DWC = position + u_center3D;\n\n#ifdef GEODETIC_SURFACE_NORMALS\n    vec3 ellipsoidNormal = geodeticSurfaceNormal;\n#else\n    vec3 ellipsoidNormal = normalize(position3DWC);\n#endif\n\n#if defined(EXAGGERATION) && defined(GEODETIC_SURFACE_NORMALS)\n    float exaggeration = u_verticalExaggerationAndRelativeHeight.x;\n    float relativeHeight = u_verticalExaggerationAndRelativeHeight.y;\n    float newHeight = (height - relativeHeight) * exaggeration + relativeHeight;\n\n    // stop from going through center of earth\n    float minRadius = min(min(czm_ellipsoidRadii.x, czm_ellipsoidRadii.y), czm_ellipsoidRadii.z);\n    newHeight = max(newHeight, -minRadius);\n\n    vec3 offset = ellipsoidNormal * (newHeight - height);\n    position += offset;\n    position3DWC += offset;\n    height = newHeight;\n#endif\n\n    gl_Position = getPosition(position, height, textureCoordinates);\n\n    v_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\n    v_positionMC = position3DWC;  // position in model coordinates\n\n    v_textureCoordinates = vec3(textureCoordinates, webMercatorT);\n\n#if defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)\n    vec3 normalMC = czm_octDecode(encodedNormal);\n\n#if defined(EXAGGERATION) && defined(GEODETIC_SURFACE_NORMALS)\n    vec3 projection = dot(normalMC, ellipsoidNormal) * ellipsoidNormal;\n    vec3 rejection = normalMC - projection;\n    normalMC = normalize(projection + rejection * exaggeration);\n#endif\n\n    v_normalMC = normalMC;\n    v_normalEC = czm_normal3D * v_normalMC;\n#endif\n\n#ifdef ENABLE_CLIPPING_POLYGONS\n    vec2 sphericalLatLong = czm_approximateSphericalCoordinates(position3DWC);\n    sphericalLatLong.y = czm_branchFreeTernary(sphericalLatLong.y < czm_pi, sphericalLatLong.y, sphericalLatLong.y - czm_twoPi);\n    \n    vec2 minDistance = vec2(czm_infinity);\n    v_clippingPosition = vec2(czm_infinity);\n    v_regionIndex = -1;\n\n    for (int regionIndex = 0; regionIndex < CLIPPING_POLYGON_REGIONS_LENGTH; regionIndex++) {\n        vec4 extents = unpackClippingExtents(u_clippingExtents, regionIndex);\n        vec2 rectUv = (sphericalLatLong.yx - extents.yx) * extents.wz;\n\n        vec2 clamped = clamp(rectUv, vec2(0.0), vec2(1.0));\n        vec2 distance = abs(rectUv - clamped) * extents.wz;\n\n        float threshold = 0.01;\n        if (minDistance.x > distance.x || minDistance.y > distance.y) {\n            minDistance = distance;\n            v_clippingPosition = rectUv;\n            if (rectUv.x > threshold && rectUv.y > threshold && rectUv.x < 1.0 - threshold && rectUv.y < 1.0 - threshold) {\n                v_regionIndex = regionIndex;\n            }\n        }\n    }\n#endif\n\n#if defined(FOG) || (defined(GROUND_ATMOSPHERE) && !defined(PER_FRAGMENT_GROUND_ATMOSPHERE))\n\n    bool dynamicLighting = false;\n\n    #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))\n        dynamicLighting = true;\n    #endif\n\n#if defined(DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN)\n    vec3 atmosphereLightDirection = czm_sunDirectionWC;\n#else\n    vec3 atmosphereLightDirection = czm_lightDirectionWC;\n#endif\n\n    vec3 lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(position3DWC));\n\n    computeAtmosphereScattering(\n        position3DWC,\n        lightDirection,\n        v_atmosphereRayleighColor,\n        v_atmosphereMieColor,\n        v_atmosphereOpacity\n    );\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\n    v_distance = length((czm_modelView3D * vec4(position3DWC, 1.0)).xyz);\n#endif\n\n#ifdef APPLY_MATERIAL\n    float northPoleZ = czm_ellipsoidRadii.z;\n    vec3 northPolePositionMC = vec3(0.0, 0.0, northPoleZ);\n    vec3 vectorEastMC = normalize(cross(northPolePositionMC - v_positionMC, ellipsoidNormal));\n    float dotProd = abs(dot(ellipsoidNormal, v_normalMC));\n    v_slope = acos(dotProd);\n    vec3 normalRejected = ellipsoidNormal * dotProd;\n    vec3 normalProjected = v_normalMC - normalRejected;\n    vec3 aspectVector = normalize(normalProjected);\n    v_aspect = acos(dot(aspectVector, vectorEastMC));\n    float determ = dot(cross(vectorEastMC, aspectVector), ellipsoidNormal);\n    v_aspect = czm_branchFreeTernary(determ < 0.0, 2.0 * czm_pi - v_aspect, v_aspect);\n    v_height = height;\n#endif\n}\n",wS="void computeAtmosphereScattering(vec3 positionWC, vec3 lightDirection, out vec3 rayleighColor, out vec3 mieColor, out float opacity) {\n\n    vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;\n    vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);\n    czm_ray primaryRay = czm_ray(czm_viewerPositionWC, cameraToPositionWCDirection);\n    \n    float atmosphereInnerRadius = length(positionWC);\n\n    computeScattering(\n        primaryRay,\n        length(cameraToPositionWC),\n        lightDirection,\n        atmosphereInnerRadius,\n        rayleighColor,\n        mieColor,\n        opacity\n    );\n}\n";var xS=n(208276),CS=n(510148),ES=n(291848),SS=n(78149),IS=n(682091),PS=n(749513),DS=n(632577),OS=n(700241),RS=n(575513),MS=n(57723),LS=n(814617),NS=n(988617),BS=n(275058),FS=n(208898),US=n(710807),kS=n(753543),VS=n(488961);const zS="float interpolateByDistance(vec4 nearFarScalar, float distance)\n{\n    float startDistance = nearFarScalar.x;\n    float startValue = nearFarScalar.y;\n    float endDistance = nearFarScalar.z;\n    float endValue = nearFarScalar.w;\n    float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);\n    return mix(startValue, endValue, t);\n}\n\nvoid computeAtmosphereScattering(vec3 positionWC, vec3 lightDirection, out vec3 rayleighColor, out vec3 mieColor, out float opacity, out float underTranslucentGlobe)\n{\n    float ellipsoidRadiiDifference = czm_ellipsoidRadii.x - czm_ellipsoidRadii.z;\n\n    // Adjustment to the atmosphere radius applied based on the camera height.\n    float distanceAdjustMin = czm_ellipsoidRadii.x / 4.0;\n    float distanceAdjustMax = czm_ellipsoidRadii.x;\n    float distanceAdjustModifier = ellipsoidRadiiDifference / 2.0;\n    float distanceAdjust = distanceAdjustModifier * clamp((czm_eyeHeight - distanceAdjustMin) / (distanceAdjustMax - distanceAdjustMin), 0.0, 1.0);\n\n    // Since atmosphere scattering assumes the atmosphere is a spherical shell, we compute an inner radius of the atmosphere best fit\n    // for the position on the ellipsoid.\n    float radiusAdjust = (ellipsoidRadiiDifference / 4.0) + distanceAdjust;\n    float atmosphereInnerRadius = (length(czm_viewerPositionWC) - czm_eyeHeight) - radiusAdjust;\n\n    // Setup the primary ray: from the camera position to the vertex position.\n    vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;\n    vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);\n    czm_ray primaryRay = czm_ray(czm_viewerPositionWC, cameraToPositionWCDirection);\n\n    underTranslucentGlobe = 0.0;\n\n    // Brighten the sky atmosphere under the Earth's atmosphere when translucency is enabled.\n    #if defined(GLOBE_TRANSLUCENT)\n\n        // Check for intersection with the inner radius of the atmopshere.\n        czm_raySegment primaryRayEarthIntersect = czm_raySphereIntersectionInterval(primaryRay, vec3(0.0), atmosphereInnerRadius + radiusAdjust);\n        if (primaryRayEarthIntersect.start > 0.0 && primaryRayEarthIntersect.stop > 0.0) {\n\n            // Compute position on globe.\n            vec3 direction = normalize(positionWC);\n            czm_ray ellipsoidRay = czm_ray(positionWC, -direction);\n            czm_raySegment ellipsoidIntersection = czm_rayEllipsoidIntersectionInterval(ellipsoidRay, vec3(0.0), czm_ellipsoidInverseRadii);\n            vec3 onEarth = positionWC - (direction * ellipsoidIntersection.start);\n\n            // Control the color using the camera angle.\n            float angle = dot(normalize(czm_viewerPositionWC), normalize(onEarth));\n\n            // Control the opacity using the distance from Earth.\n            opacity = interpolateByDistance(vec4(0.0, 1.0, czm_ellipsoidRadii.x, 0.0), length(czm_viewerPositionWC - onEarth));\n            vec3 horizonColor = vec3(0.1, 0.2, 0.3);\n            vec3 nearColor = vec3(0.0);\n\n            rayleighColor = mix(nearColor, horizonColor, exp(-angle) * opacity);\n\n            // Set the traslucent flag to avoid alpha adjustment in computeFinalColor funciton.\n            underTranslucentGlobe = 1.0;\n            return;\n        }\n    #endif\n\n    computeScattering(\n        primaryRay,\n        length(cameraToPositionWC),\n        lightDirection,\n        atmosphereInnerRadius,\n        rayleighColor,\n        mieColor,\n        opacity\n    );\n\n    // Alter the opacity based on how close the viewer is to the ground.\n    // (0.0 = At edge of atmosphere, 1.0 = On ground)\n    float cameraHeight = czm_eyeHeight + atmosphereInnerRadius;\n    float atmosphereOuterRadius = atmosphereInnerRadius + ATMOSPHERE_THICKNESS;\n    opacity = clamp((atmosphereOuterRadius - cameraHeight) / (atmosphereOuterRadius - atmosphereInnerRadius), 0.0, 1.0);\n\n    // Alter alpha based on time of day (0.0 = night , 1.0 = day)\n    float nightAlpha = (u_radiiAndDynamicAtmosphereColor.z != 0.0) ? clamp(dot(normalize(positionWC), lightDirection), 0.0, 1.0) : 1.0;\n    opacity *= pow(nightAlpha, 0.5);\n}\n",HS="in vec3 v_outerPositionWC;\n\nuniform vec3 u_hsbShift;\n\n#ifndef PER_FRAGMENT_ATMOSPHERE\nin vec3 v_mieColor;\nin vec3 v_rayleighColor;\nin float v_opacity;\nin float v_translucent;\n#endif\n\nvoid main (void)\n{\n    float lightEnum = u_radiiAndDynamicAtmosphereColor.z;\n    vec3 lightDirection = czm_getDynamicAtmosphereLightDirection(v_outerPositionWC, lightEnum);\n\n    vec3 mieColor;\n    vec3 rayleighColor;\n    float opacity;\n    float translucent;\n\n    #ifdef PER_FRAGMENT_ATMOSPHERE\n        computeAtmosphereScattering(\n            v_outerPositionWC,\n            lightDirection,\n            rayleighColor,\n            mieColor,\n            opacity,\n            translucent\n        );\n    #else\n        mieColor = v_mieColor;\n        rayleighColor = v_rayleighColor;\n        opacity = v_opacity;\n        translucent = v_translucent;\n    #endif\n\n    vec4 color = computeAtmosphereColor(v_outerPositionWC, lightDirection, rayleighColor, mieColor, opacity);\n\n    #ifndef HDR\n        color.rgb = czm_pbrNeutralTonemapping(color.rgb);\n        color.rgb = czm_inverseGamma(color.rgb);\n    #endif\n\n    #ifdef COLOR_CORRECT\n        const bool ignoreBlackPixels = true;\n        color.rgb = czm_applyHSBShift(color.rgb, u_hsbShift, ignoreBlackPixels);\n    #endif\n\n    // For the parts of the sky atmosphere that are not behind a translucent globe,\n    // we mix in the default opacity so that the sky atmosphere still appears at distance.\n    // This is needed because the opacity in the sky atmosphere is initially adjusted based\n    // on the camera height.\n    if (translucent == 0.0) {\n        color.a = mix(color.b, 1.0, color.a) * smoothstep(0.0, 1.0, czm_morphTime);\n    }\n\n    out_FragColor = color;\n}\n",GS="in vec4 position;\n\nout vec3 v_outerPositionWC;\n\n#ifndef PER_FRAGMENT_ATMOSPHERE\nout vec3 v_mieColor;\nout vec3 v_rayleighColor;\nout float v_opacity;\nout float v_translucent;\n#endif\n\nvoid main(void)\n{\n    vec4 positionWC = czm_model * position;\n    float lightEnum = u_radiiAndDynamicAtmosphereColor.z;\n    vec3 lightDirection = czm_getDynamicAtmosphereLightDirection(positionWC.xyz, lightEnum);\n\n    #ifndef PER_FRAGMENT_ATMOSPHERE\n        computeAtmosphereScattering(\n            positionWC.xyz,\n            lightDirection,\n            v_rayleighColor,\n            v_mieColor,\n            v_opacity,\n            v_translucent\n        );\n    #endif\n\n    v_outerPositionWC = positionWC.xyz;\n    vec4 positionEC = czm_modelView * position;\n    gl_Position = czm_projection * positionEC;\n}\n",WS="uniform samplerCube u_cubeMap;\n\nin vec3 v_texCoord;\n\nvoid main()\n{\n    vec4 color = czm_textureCube(u_cubeMap, normalize(v_texCoord));\n    out_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);\n}\n",YS="in vec3 position;\nout vec3 v_texCoord;\n\nvoid main()\n{\n    vec3 p = czm_viewRotation * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n    gl_Position = czm_projection * vec4(p, 1.0);\n    v_texCoord = position.xyz;\n}\n",qS="uniform sampler2D u_texture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    vec4 color = texture(u_texture, v_textureCoordinates);\n    out_FragColor = czm_gammaCorrect(color);\n}\n",jS="uniform float u_radiusTS;\n\nin vec2 v_textureCoordinates;\n\nvec2 rotate(vec2 p, vec2 direction)\n{\n    return vec2(p.x * direction.x - p.y * direction.y, p.x * direction.y + p.y * direction.x);\n}\n\nvec4 addBurst(vec2 position, vec2 direction, float lengthScalar)\n{\n    vec2 rotatedPosition = rotate(position, direction) * vec2(25.0, 0.75);\n    float radius = length(rotatedPosition) * lengthScalar;\n    float burst = 1.0 - smoothstep(0.0, 0.55, radius);\n    return vec4(burst);\n}\n\nvoid main()\n{\n    float lengthScalar = 2.0 / sqrt(2.0);\n    vec2 position = v_textureCoordinates - vec2(0.5);\n    float radius = length(position) * lengthScalar;\n    float surface = step(radius, u_radiusTS);\n    vec4 color = vec4(vec2(1.0), surface + 0.2, surface);\n\n    float glow = 1.0 - smoothstep(0.0, 0.55, radius);\n    color.ba += mix(vec2(0.0), vec2(1.0), glow) * 0.75;\n\n    vec4 burst = vec4(0.0);\n\n    // The following loop has been manually unrolled for speed, to\n    // avoid sin() and cos().\n    //\n    //for (float i = 0.4; i < 3.2; i += 1.047) {\n    //    vec2 direction = vec2(sin(i), cos(i));\n    //    burst += 0.4 * addBurst(position, direction, lengthScalar);\n    //\n    //    direction = vec2(sin(i - 0.08), cos(i - 0.08));\n    //    burst += 0.3 * addBurst(position, direction, lengthScalar);\n    //}\n\n    burst += 0.4 * addBurst(position, vec2(0.38942,  0.92106), lengthScalar);  // angle == 0.4\n    burst += 0.4 * addBurst(position, vec2(0.99235,  0.12348), lengthScalar);  // angle == 0.4 + 1.047\n    burst += 0.4 * addBurst(position, vec2(0.60327, -0.79754), lengthScalar);  // angle == 0.4 + 1.047 * 2.0\n\n    burst += 0.3 * addBurst(position, vec2(0.31457,  0.94924), lengthScalar);  // angle == 0.4 - 0.08\n    burst += 0.3 * addBurst(position, vec2(0.97931,  0.20239), lengthScalar);  // angle == 0.4 + 1.047 - 0.08\n    burst += 0.3 * addBurst(position, vec2(0.66507, -0.74678), lengthScalar);  // angle == 0.4 + 1.047 * 2.0 - 0.08\n\n    // End of manual loop unrolling.\n\n    color += clamp(burst, vec4(0.0), vec4(1.0)) * 0.15;\n\n    out_FragColor = clamp(color, vec4(0.0), vec4(1.0));\n}\n",QS="in vec2 direction;\n\nuniform float u_size;\n\nout vec2 v_textureCoordinates;\n\nvoid main() \n{\n    vec4 position;\n    if (czm_morphTime == 1.0)\n    {\n        position = vec4(czm_sunPositionWC, 1.0);\n    }\n    else\n    {\n        position = vec4(czm_sunPositionColumbusView.zxy, 1.0);\n    }\n    \n    vec4 positionEC = czm_view * position;\n    vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\n    \n    vec2 halfSize = vec2(u_size * 0.5);\n    halfSize *= ((direction * 2.0) - 1.0);\n    \n    gl_Position = czm_viewportOrthographic * vec4(positionWC.xy + halfSize, -positionWC.z, 1.0);\n    \n    v_textureCoordinates = direction;\n}\n";var XS=n(154920),KS=n(296312),$S=n(747776),JS=n(971532);const ZS="\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    czm_materialInput materialInput;\n    \n    materialInput.s = v_textureCoordinates.s;\n    materialInput.st = v_textureCoordinates;\n    materialInput.str = vec3(v_textureCoordinates, 0.0);\n    materialInput.normalEC = vec3(0.0, 0.0, -1.0);\n    \n    czm_material material = czm_getMaterial(materialInput);\n\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n}\n";var eI=n(182348),tI=n(655365),nI=n(165755),iI=n(209202),oI=n(83181),rI=n(307898),sI=n(98055),aI=n(862892),cI=n(705302),lI=n(41076);function uI(e){this.ellipsoid=e.ellipsoid??K.A.default,this.credit=void 0,this.tilingScheme=void 0,this.height=void 0,this.width=void 0,this.encoding=void 0,this.lodCount=void 0,this.hasAvailability=!1,this.tilesAvailable=void 0,this.tilesAvailabilityLoaded=void 0,this.levelZeroMaximumGeometricError=void 0,this.terrainDataStructure=void 0}function dI(e){e=e??S.A.EMPTY_OBJECT,this._resource=void 0,this._credit=void 0,this._tilingScheme=void 0,this._levelZeroMaximumGeometricError=void 0,this._maxLevel=void 0,this._terrainDataStructure=void 0,this._width=void 0,this._height=void 0,this._encoding=void 0,this._lodCount=void 0,this._hasAvailability=!1,this._tilesAvailable=void 0,this._tilesAvailabilityLoaded=void 0,this._availableCache={},this._errorEvent=new Bn.A}function hI(e,t,n,i){if(!e._hasAvailability)return;const o=e._tilesAvailabilityLoaded,r=e._tilesAvailable;return!(t>e._lodCount)&&(!!r.isTileAvailable(t,n,i)||!o.isTileAvailable(t,n,i)&&void 0)}function AI(e,t,n,i){const o=t-1,r=n-1,s=i[e.y*t+e.x],a=[],c={startX:e.x,startY:e.y,endX:0,endY:0},l=new q.A(e.x+1,e.y+1);let u=!1,d=!1;for(;!u||!d;){let n=l.x;const h=d?l.y+1:l.y;if(!u){for(let n=e.y;n<h;++n)if(i[n*t+l.x]!==s){u=!0;break}u?(a.push(new q.A(l.x,e.y)),--l.x,--n,c.endX=l.x):l.x===o?(c.endX=l.x,u=!0):++l.x}if(!d){const o=l.y*t;for(let t=e.x;t<=n;++t)if(i[o+t]!==s){d=!0;break}d?(a.push(new q.A(e.x,l.y)),--l.y,c.endY=l.y):l.y===r?(c.endY=l.y,d=!0):++l.y}}return{endingIndices:a,range:c,value:s}}function pI(e,t,n,i){if(!e._hasAvailability)return{};const o=128*Math.floor(n/128),r=128*Math.floor(i/128),s=Math.min(1<<t,128),a=`tilemap/${t}/${r}/${o}/${s}/${s}`,c=e._availableCache;if((0,d.A)(c[a]))return c[a];const l=new iI.A({throttle:!1,throttleByServer:!0,type:rI.A.TERRAIN});let u=e._resource.getDerivedResource({url:a,request:l}).fetchJson();return(0,d.A)(u)?(u=u.then(function(a){const c=function(e,t,n,i,o){const r=[];if(o.every(function(e){return e===o[0]}))return 1===o[0]&&r.push({startX:e,startY:t,endX:e+n-1,endY:t+i-1}),r;let s=[new q.A(0,0)];for(;s.length>0;){const a=AI(s.pop(),n,i,o);if(1===a.value){const n=a.range;n.startX+=e,n.endX+=e,n.startY+=t,n.endY+=t,r.push(n)}const c=a.endingIndices;c.length>0&&(s=s.concat(c))}return r}(o,r,s,s,a.data);e._tilesAvailabilityLoaded.addAvailableTileRange(t,o,r,o+s,r+s);const l=e._tilesAvailable;for(let e=0;e<c.length;++e){const n=c[e];l.addAvailableTileRange(t,n.startX,n.startY,n.endX,n.endY)}return hI(e,t,n,i)}),c[a]={promise:u,request:l},u=u.finally(function(e){return delete c[a],e}),{promise:u,request:l}):{}}uI.prototype.build=function(e){e._credit=this.credit,e._tilingScheme=this.tilingScheme,e._height=this.height,e._width=this.width,e._encoding=this.encoding,e._lodCount=this.lodCount,e._hasAvailability=this.hasAvailability,e._tilesAvailable=this.tilesAvailable,e._tilesAvailabilityLoaded=this.tilesAvailabilityLoaded,e._levelZeroMaximumGeometricError=this.levelZeroMaximumGeometricError,e._terrainDataStructure=this.terrainDataStructure},Object.defineProperties(dI.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){return this._tilesAvailable}}}),dI.fromUrl=async function(e,t){l.A.defined("url",e),t=t??S.A.EMPTY_OBJECT,e=await Promise.resolve(e);let n=Lt.A.createIfNeeded(e);n.appendForwardSlash(),(0,d.A)(t.token)&&(n=n.getDerivedResource({queryParameters:{token:t.token}}));const i=n.getDerivedResource({queryParameters:{f:"pjson"}}),o=new uI(t);await async function(e,t,n){try{!function(e,t){const n=t.copyrightText;(0,d.A)(n)&&(e.credit=new Ws.A(n));const i=t.spatialReference,o=i.latestWkid??i.wkid,r=t.extent,s={ellipsoid:e.ellipsoid};if(4326===o)s.rectangle=Or.A.fromDegrees(r.xmin,r.ymin,r.xmax,r.ymax),e.tilingScheme=new eI.A(s);else{if(3857!==o)throw new M.A("Invalid spatial reference");{const n=Math.PI*e.ellipsoid.maximumRadius;t.extent.xmax>n&&(t.extent.xmax=n),t.extent.ymax>n&&(t.extent.ymax=n),t.extent.xmin<-n&&(t.extent.xmin=-n),t.extent.ymin<-n&&(t.extent.ymin=-n),s.rectangleSouthwestInMeters=new q.A(r.xmin,r.ymin),s.rectangleNortheastInMeters=new q.A(r.xmax,r.ymax),e.tilingScheme=new lI.A(s)}}const a=t.tileInfo;if(!(0,d.A)(a))throw new M.A("tileInfo is required");e.width=a.rows+1,e.height=a.cols+1,e.encoding="LERC"===a.format?tI.A.LERC:tI.A.NONE,e.lodCount=a.lods.length-1,(e.hasAvailability=-1!==t.capabilities.indexOf("Tilemap"))&&(e.tilesAvailable=new aI.A(e.tilingScheme,e.lodCount),e.tilesAvailable.addAvailableTileRange(0,0,0,e.tilingScheme.getNumberOfXTilesAtLevel(0),e.tilingScheme.getNumberOfYTilesAtLevel(0)),e.tilesAvailabilityLoaded=new aI.A(e.tilingScheme,e.lodCount)),e.levelZeroMaximumGeometricError=sI.A.getEstimatedLevelZeroGeometricErrorForAHeightmap(e.tilingScheme.ellipsoid,e.width,e.tilingScheme.getNumberOfXTilesAtLevel(0)),t.bandCount>1&&console.log("ArcGISTiledElevationTerrainProvider: Terrain data has more than 1 band. Using the first one."),(0,d.A)(t.minValues)&&(0,d.A)(t.maxValues)?e.terrainDataStructure={elementMultiplier:1,lowestEncodedHeight:t.minValues[0],highestEncodedHeight:t.maxValues[0]}:e.terrainDataStructure={elementMultiplier:1}}(e,await t.fetchJson())}catch(e){const i=`An error occurred while accessing ${t}.`;throw cI.A.reportError(void 0,n,(0,d.A)(n)?n._errorEvent:void 0,i),e}}(o,i);const r=new dI(t);return o.build(r),r._resource=n,r},dI.prototype.requestTileGeometry=function(e,t,n,i){const o=this._resource.getDerivedResource({url:`tile/${n}/${t}/${e}`,request:i}),r=this._hasAvailability;let s,a=Promise.resolve(!0);if(r&&!(0,d.A)(hI(this,n+1,2*e,2*t))){const i=pI(this,n+1,2*e,2*t);a=i.promise,s=i.request}const c=o.fetchArrayBuffer();if(!(0,d.A)(c)||!(0,d.A)(a))return;const l=this,u=this._tilesAvailable;return Promise.all([c,a]).then(function(i){return new nI.A({buffer:i[0],width:l._width,height:l._height,childTileMask:r?u.computeChildMaskForTile(n,e,t):15,structure:l._terrainDataStructure,encoding:l._encoding})}).catch(async function(e){if((0,d.A)(s)&&s.state===oI.A.CANCELLED){i.cancel();try{await(i.deferred?.promise)}catch{}return i.state=oI.A.CANCELLED,Promise.reject(e)}return Promise.reject(e)})},dI.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},dI.prototype.getTileDataAvailable=function(e,t,n){if(!this._hasAvailability)return;const i=hI(this,n,e,t);if((0,d.A)(i))return i;pI(this,n,e,t)},dI.prototype.loadTileDataAvailability=function(e,t,n){};const fI=dI;var mI=n(794282),gI=n(961645),_I=n(807135);const yI="https://dev.virtualearth.net/REST/v1/Locations";function vI(e){const t=(e=e??S.A.EMPTY_OBJECT).key;if(!(0,d.A)(t))throw new A.A("options.key is required.");this._key=t;const n={key:t};(0,d.A)(e.culture)&&(n.culture=e.culture),this._resource=new Lt.A({url:yI,queryParameters:n}),this._credit=new Ws.A('<img src="http://dev.virtualearth.net/Branding/logo_powered_by.png"/>',!1)}Object.defineProperties(vI.prototype,{url:{get:function(){return yI}},key:{get:function(){return this._key}},credit:{get:function(){return this._credit}}}),vI.prototype.geocode=async function(e){return l.A.typeOf.string("query",e),this._resource.getDerivedResource({queryParameters:{query:e}}).fetchJsonp("jsonp").then(function(e){return 0===e.resourceSets.length?[]:e.resourceSets[0].resources.map(function(e){const t=e.bbox,n=t[0],i=t[1],o=t[2],r=t[3];return{displayName:e.name,destination:Or.A.fromDegrees(i,n,r,o)}})})};const TI=vI;function bI(){}Object.defineProperties(bI.prototype,{credit:{get:function(){}}}),bI.prototype.geocode=function(e){l.A.typeOf.string("query",e);const t=e.match(/[^\s,\n]+/g);if(2===t.length||3===t.length){let n=+t[0],i=+t[1];const o=3===t.length?+t[2]:300;if(isNaN(n)&&isNaN(i)){const e=/^(\d+.?\d*)([nsew])/i;for(let o=0;o<t.length;++o){const r=t[o].match(e);e.test(t[o])&&3===r.length&&(/^[ns]/i.test(r[2])?i=/^[n]/i.test(r[2])?+r[1]:-r[1]:/^[ew]/i.test(r[2])&&(n=/^[e]/i.test(r[2])?+r[1]:-r[1]))}}if(!isNaN(n)&&!isNaN(i)&&!isNaN(o)){const t={displayName:e,destination:j.A.fromDegrees(n,i,o)};return Promise.resolve([t])}}return Promise.resolve([])};const wI=bI;var xI=n(961136),CI=n(437266);const EI=new Q.A,SI=new j.A,II=new j.A,PI=new j.A,DI=new j.A;function OI(e){const t=(e=e??S.A.EMPTY_OBJECT).points,n=e.times;let i=e.firstTangent,o=e.lastTangent;if(l.A.defined("points",t),l.A.defined("times",n),l.A.typeOf.number.greaterThanOrEquals("points.length",t.length,2),l.A.typeOf.number.equals("times.length","points.length",n.length,t.length),t.length>2&&((0,d.A)(i)||(i=PI,j.A.multiplyByScalar(t[1],2,i),j.A.subtract(i,t[2],i),j.A.subtract(i,t[0],i),j.A.multiplyByScalar(i,.5,i)),!(0,d.A)(o))){const e=t.length-1;o=DI,j.A.multiplyByScalar(t[e-1],2,o),j.A.subtract(t[e],o,o),j.A.add(o,t[e-2],o),j.A.multiplyByScalar(o,.5,o)}this._times=n,this._points=t,this._firstTangent=j.A.clone(i),this._lastTangent=j.A.clone(o),this._evaluateFunction=function(e){const t=e.points,n=e.times;if(t.length<3){const e=n[0],i=1/(n[1]-e),o=t[0],r=t[1];return function(t,n){(0,d.A)(n)||(n=new j.A);const s=(t-e)*i;return j.A.lerp(o,r,s,n)}}return function(i,o){(0,d.A)(o)||(o=new j.A);const r=e._lastTimeIndex=e.findTimeInterval(i,e._lastTimeIndex),s=(i-n[r])/(n[r+1]-n[r]),a=EI;let c,l,u,h,A;return a.z=s,a.y=s*s,a.x=a.y*s,a.w=1,0===r?(c=t[0],l=t[1],u=e.firstTangent,h=j.A.subtract(t[2],c,SI),j.A.multiplyByScalar(h,.5,h),A=O.A.multiplyByVector(xI.A.hermiteCoefficientMatrix,a,a)):r===t.length-2?(c=t[r],l=t[r+1],h=e.lastTangent,u=j.A.subtract(l,t[r-1],SI),j.A.multiplyByScalar(u,.5,u),A=O.A.multiplyByVector(xI.A.hermiteCoefficientMatrix,a,a)):(c=t[r-1],l=t[r],u=t[r+1],h=t[r+2],A=O.A.multiplyByVector(OI.catmullRomCoefficientMatrix,a,a)),o=j.A.multiplyByScalar(c,A.x,o),j.A.multiplyByScalar(l,A.y,II),j.A.add(o,II,o),j.A.multiplyByScalar(u,A.z,II),j.A.add(o,II,o),j.A.multiplyByScalar(h,A.w,II),j.A.add(o,II,o)}}(this),this._lastTimeIndex=0}Object.defineProperties(OI.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},firstTangent:{get:function(){return this._firstTangent}},lastTangent:{get:function(){return this._lastTangent}}}),OI.catmullRomCoefficientMatrix=new O.A(-.5,1,-.5,0,1.5,-2.5,0,1,-1.5,2,.5,0,.5,-.5,0,0),OI.prototype.findTimeInterval=CI.A.prototype.findTimeInterval,OI.prototype.wrapTime=CI.A.prototype.wrapTime,OI.prototype.clampTime=CI.A.prototype.clampTime,OI.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};const RI=OI;var MI=n(564453);function LI(e){const t=(e=e??S.A.EMPTY_OBJECT).radius;l.A.typeOf.number("radius",t);const n={center:e.center,semiMajorAxis:t,semiMinorAxis:t,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,vertexFormat:e.vertexFormat,stRotation:e.stRotation,shadowVolume:e.shadowVolume};this._ellipseGeometry=new Kl.A(n),this._workerName="createCircleGeometry"}LI.packedLength=Kl.A.packedLength,LI.pack=function(e,t,n){return l.A.typeOf.object("value",e),Kl.A.pack(e._ellipseGeometry,t,n)};const NI=new Kl.A({center:new j.A,semiMajorAxis:1,semiMinorAxis:1}),BI={center:new j.A,radius:void 0,ellipsoid:K.A.clone(K.A.default),height:void 0,extrudedHeight:void 0,granularity:void 0,vertexFormat:new Rr.A,stRotation:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0,shadowVolume:void 0};LI.unpack=function(e,t,n){const i=Kl.A.unpack(e,t,NI);return BI.center=j.A.clone(i._center,BI.center),BI.ellipsoid=K.A.clone(i._ellipsoid,BI.ellipsoid),BI.ellipsoid=K.A.clone(i._ellipsoid,NI._ellipsoid),BI.height=i._height,BI.extrudedHeight=i._extrudedHeight,BI.granularity=i._granularity,BI.vertexFormat=Rr.A.clone(i._vertexFormat,BI.vertexFormat),BI.stRotation=i._stRotation,BI.shadowVolume=i._shadowVolume,(0,d.A)(n)?(BI.semiMajorAxis=i._semiMajorAxis,BI.semiMinorAxis=i._semiMinorAxis,n._ellipseGeometry=new Kl.A(BI),n):(BI.radius=i._semiMajorAxis,new LI(BI))},LI.createGeometry=function(e){return Kl.A.createGeometry(e._ellipseGeometry)},LI.createShadowVolume=function(e,t,n){const i=e._ellipseGeometry._granularity,o=e._ellipseGeometry._ellipsoid,r=t(i,o),s=n(i,o);return new LI({center:e._ellipseGeometry._center,radius:e._ellipseGeometry._semiMajorAxis,ellipsoid:o,stRotation:e._ellipseGeometry._stRotation,granularity:i,extrudedHeight:r,height:s,vertexFormat:Rr.A.POSITION_ONLY,shadowVolume:!0})},Object.defineProperties(LI.prototype,{rectangle:{get:function(){return this._ellipseGeometry.rectangle}},textureCoordinateRotationPoints:{get:function(){return this._ellipseGeometry.textureCoordinateRotationPoints}}});const FI=LI;function UI(e){const t=(e=e??S.A.EMPTY_OBJECT).radius;l.A.typeOf.number("radius",t);const n={center:e.center,semiMajorAxis:t,semiMinorAxis:t,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,numberOfVerticalLines:e.numberOfVerticalLines};this._ellipseGeometry=new su(n),this._workerName="createCircleOutlineGeometry"}UI.packedLength=su.packedLength,UI.pack=function(e,t,n){return l.A.typeOf.object("value",e),su.pack(e._ellipseGeometry,t,n)};const kI=new su({center:new j.A,semiMajorAxis:1,semiMinorAxis:1}),VI={center:new j.A,radius:void 0,ellipsoid:K.A.clone(K.A.UNIT_SPHERE),height:void 0,extrudedHeight:void 0,granularity:void 0,numberOfVerticalLines:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0};UI.unpack=function(e,t,n){const i=su.unpack(e,t,kI);return VI.center=j.A.clone(i._center,VI.center),VI.ellipsoid=K.A.clone(i._ellipsoid,VI.ellipsoid),VI.height=i._height,VI.extrudedHeight=i._extrudedHeight,VI.granularity=i._granularity,VI.numberOfVerticalLines=i._numberOfVerticalLines,(0,d.A)(n)?(VI.semiMajorAxis=i._semiMajorAxis,VI.semiMinorAxis=i._semiMinorAxis,n._ellipseGeometry=new su(VI),n):(VI.radius=i._semiMajorAxis,new UI(VI))},UI.createGeometry=function(e){return su.createGeometry(e._ellipseGeometry)};const zI=UI;var HI=n(56233),GI=n(931806),WI=n(703983),YI=n(400793);function qI(e){e=e??S.A.EMPTY_OBJECT,l.A.defined("options.callback",e.callback),l.A.defined("options.width",e.width),l.A.defined("options.height",e.height),this._callback=e.callback,this._tilingScheme=e.tilingScheme,(0,d.A)(this._tilingScheme)||(this._tilingScheme=new eI.A({ellipsoid:e.ellipsoid??K.A.default})),this._width=e.width,this._height=e.height;const t=Math.max(this._width,this._height);this._levelZeroMaximumGeometricError=sI.A.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,t,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._errorEvent=new Bn.A;let n=e.credit;"string"==typeof n&&(n=new Ws.A(n)),this._credit=n}Object.defineProperties(qI.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}}),qI.prototype.requestTileGeometry=function(e,t,n,i){const o=this._callback(e,t,n);if(!(0,d.A)(o))return;const r=this._width,s=this._height;return Promise.resolve(o).then(function(e){let t=e;return Array.isArray(t)&&(t=new Float64Array(t)),new nI.A({buffer:t,width:r,height:s})})},qI.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},qI.prototype.getTileDataAvailable=function(e,t,n){},qI.prototype.loadTileDataAvailability=function(e,t,n){};const jI=qI;var QI=n(707568);function XI(e){l.A.typeOf.object("options",e),l.A.defined("options.comparator",e.comparator),(0,d.A)(e.maximumLength)&&l.A.typeOf.number.greaterThanOrEquals("options.maximumLength",e.maximumLength,0),this._comparator=e.comparator,this._maximumLength=e.maximumLength,this._array=(0,d.A)(e.maximumLength)?new Array(e.maximumLength):[],this._length=0}function KI(e,t,n){const i=e._array,o=i[t];i[t]=i[n],i[n]=o}function $I(e,t,n){return e._comparator(e._array[t],e._array[n])<0}function JI(e,t,n){return e._comparator(e._array[t],e._array[n])>0}function ZI(e,t){if(0===t)return;const n=Math.floor(J.A.log2(t+1))%2==0,i=Math.floor((t-1)/2),o=$I(e,t,i);for(o!==n&&(KI(e,t,i),t=i);t>=3;){const n=Math.floor((t-3)/4);if($I(e,t,n)!==o)break;KI(e,t,n),t=n}}function eP(e,t){const n=e._length,i=Math.floor(J.A.log2(t+1))%2==0;let o;for(;(o=2*t+1)<n;){let r=o;const s=o+1;if(s<n){$I(e,s,r)===i&&(r=s);const t=2*o+1,a=Math.max(Math.min(n-t,4),0);for(let n=0;n<a;n++){const o=t+n;$I(e,o,r)===i&&(r=o)}}if($I(e,r,t)===i&&(KI(e,r,t),r!==o&&r!==s)){const t=Math.floor((r-1)/2);JI(e,r,t)===i&&KI(e,r,t)}t=r}}Object.defineProperties(XI.prototype,{length:{get:function(){return this._length}},maximumLength:{get:function(){return this._maximumLength},set:function(e){if((0,d.A)(e)){for(l.A.typeOf.number.greaterThanOrEquals("maximumLength",e,0);this._length>e;)this.removeMinimum();this._array.length=e}this._maximumLength=e}},internalArray:{get:function(){return this._array}},comparator:{get:function(){return this._comparator}}}),XI.prototype.clone=function(){const e=this._maximumLength,t=this._comparator,n=this._array,i=this._length,o=new XI({comparator:t,maximumLength:e});o._length=i;for(let e=0;e<i;e++)o._array[e]=n[e];return o},XI.prototype.reset=function(){this._length=0;const e=this._maximumLength;if((0,d.A)(e))for(let t=0;t<e;t++)this._array[t]=void 0;else this._array.length=0},XI.prototype.resort=function(){const e=this._length;for(let t=0;t<e;t++)ZI(this,t)},XI.prototype.insert=function(e){let t;const n=this._maximumLength;if((0,d.A)(n)){if(0===n)return;if(this._length===n){const n=this._array[0];if(this._comparator(e,n)<=0)return e;t=this.removeMinimum()}}const i=this._length;return this._array[i]=e,this._length++,ZI(this,i),t},XI.prototype.removeMinimum=function(){const e=this._length;if(0===e)return;this._length--;const t=this._array[0];return e>=2&&(this._array[0]=this._array[e-1],eP(this,0)),this._array[e-1]=void 0,t},XI.prototype.removeMaximum=function(){const e=this._length;if(0===e)return;let t;if(this._length--,e<=2)t=this._array[e-1];else{const n=JI(this,1,2)?1:2;t=this._array[n],this._array[n]=this._array[e-1],e>=4&&eP(this,n)}return this._array[e-1]=void 0,t},XI.prototype.getMinimum=function(){if(0!==this._length)return this._array[0]},XI.prototype.getMaximum=function(){const e=this._length;if(0!==e)return e<=2?this._array[e-1]:this._array[JI(this,1,2)?1:2]};const tP=XI;var nP=n(606707),iP=n(652785),oP=n(723635),rP=n(602289),sP=n(551824),aP=n(149192),cP=n(199528),lP=n(520098),uP=n(666775);function dP(e){l.A.typeOf.object("options",e),l.A.typeOf.object("options.frustum",e.frustum),l.A.typeOf.object("options.origin",e.origin),l.A.typeOf.object("options.orientation",e.orientation);const t=e.frustum,n=e.orientation,i=e.origin,o=e.vertexFormat??Rr.A.DEFAULT,r=e._drawNearPlane??!0;let s,a;t instanceof uP.A?(s=0,a=uP.A.packedLength):t instanceof ee.A&&(s=1,a=ee.A.packedLength),this._frustumType=s,this._frustum=t.clone(),this._origin=j.A.clone(i),this._orientation=To.A.clone(n),this._drawNearPlane=r,this._vertexFormat=o,this._workerName="createFrustumGeometry",this.packedLength=2+a+j.A.packedLength+To.A.packedLength+Rr.A.packedLength}dP.pack=function(e,t,n){l.A.typeOf.object("value",e),l.A.defined("array",t),n=n??0;const i=e._frustumType,o=e._frustum;return t[n++]=i,0===i?(uP.A.pack(o,t,n),n+=uP.A.packedLength):(ee.A.pack(o,t,n),n+=ee.A.packedLength),j.A.pack(e._origin,t,n),n+=j.A.packedLength,To.A.pack(e._orientation,t,n),n+=To.A.packedLength,Rr.A.pack(e._vertexFormat,t,n),t[n+=Rr.A.packedLength]=e._drawNearPlane?1:0,t};const hP=new uP.A,AP=new ee.A,pP=new To.A,fP=new j.A,mP=new Rr.A;function gP(e,t,n,i,o,r,s,a){const c=e/3*2;for(let o=0;o<4;++o)(0,d.A)(t)&&(t[e]=r.x,t[e+1]=r.y,t[e+2]=r.z),(0,d.A)(n)&&(n[e]=s.x,n[e+1]=s.y,n[e+2]=s.z),(0,d.A)(i)&&(i[e]=a.x,i[e+1]=a.y,i[e+2]=a.z),e+=3;o[c]=0,o[c+1]=0,o[c+2]=1,o[c+3]=0,o[c+4]=1,o[c+5]=1,o[c+6]=0,o[c+7]=1}dP.unpack=function(e,t,n){l.A.defined("array",e),t=t??0;const i=e[t++];let o;0===i?(o=uP.A.unpack(e,t,hP),t+=uP.A.packedLength):(o=ee.A.unpack(e,t,AP),t+=ee.A.packedLength);const r=j.A.unpack(e,t,fP);t+=j.A.packedLength;const s=To.A.unpack(e,t,pP);t+=To.A.packedLength;const a=Rr.A.unpack(e,t,mP),c=1===e[t+=Rr.A.packedLength];if(!(0,d.A)(n))return new dP({frustum:o,origin:r,orientation:s,vertexFormat:a,_drawNearPlane:c});const u=i===n._frustumType?n._frustum:void 0;return n._frustum=o.clone(u),n._frustumType=i,n._origin=j.A.clone(r,n._origin),n._orientation=To.A.clone(s,n._orientation),n._vertexFormat=Rr.A.clone(a,n._vertexFormat),n._drawNearPlane=c,n};const _P=new Z.A,yP=new O.A,vP=new O.A,TP=new j.A,bP=new j.A,wP=new j.A,xP=new j.A,CP=new j.A,EP=new j.A,SP=new Array(3),IP=new Array(4);IP[0]=new Q.A(-1,-1,1,1),IP[1]=new Q.A(1,-1,1,1),IP[2]=new Q.A(1,1,1,1),IP[3]=new Q.A(-1,1,1,1);const PP=new Array(4);for(let e=0;e<4;++e)PP[e]=new Q.A;dP._computeNearFarPlanes=function(e,t,n,i,o,r,s,a){const c=Z.A.fromQuaternion(t,_P);let l=r??TP,u=s??bP,h=a??wP;l=Z.A.getColumn(c,0,l),u=Z.A.getColumn(c,1,u),h=Z.A.getColumn(c,2,h),j.A.normalize(l,l),j.A.normalize(u,u),j.A.normalize(h,h),j.A.negate(l,l);const A=O.A.computeView(e,h,u,l,yP);let p,f;const m=i.projectionMatrix;if(0===n){const e=O.A.multiply(m,A,vP);f=O.A.inverse(e,vP)}else p=O.A.inverseTransformation(A,vP);(0,d.A)(f)?(SP[0]=i.near,SP[1]=i.far):(SP[0]=0,SP[1]=i.near,SP[2]=i.far);for(let t=0;t<2;++t)for(let n=0;n<4;++n){let r=Q.A.clone(IP[n],PP[n]);if((0,d.A)(f)){r=O.A.multiplyByVector(f,r,r);const n=1/r.w;j.A.multiplyByScalar(r,n,r),j.A.subtract(r,e,r),j.A.normalize(r,r);const i=j.A.dot(h,r);j.A.multiplyByScalar(r,SP[t]/i,r),j.A.add(r,e,r)}else{const e=i.offCenterFrustum;(0,d.A)(e)&&(i=e);const n=SP[t],o=SP[t+1];r.x=.5*(r.x*(i.right-i.left)+i.left+i.right),r.y=.5*(r.y*(i.top-i.bottom)+i.bottom+i.top),r.z=.5*(r.z*(n-o)-n-o),r.w=1,O.A.multiplyByVector(p,r,r)}o[12*t+3*n]=r.x,o[12*t+3*n+1]=r.y,o[12*t+3*n+2]=r.z}},dP.createGeometry=function(e){const t=e._frustumType,n=e._frustum,i=e._origin,o=e._orientation,r=e._drawNearPlane,s=e._vertexFormat,a=r?6:5;let c=new Float64Array(72);dP._computeNearFarPlanes(i,o,t,n,c);let l=24;c[l]=c[12],c[l+1]=c[13],c[l+2]=c[14],c[l+3]=c[0],c[l+4]=c[1],c[l+5]=c[2],c[l+6]=c[9],c[l+7]=c[10],c[l+8]=c[11],c[l+9]=c[21],c[l+10]=c[22],c[l+11]=c[23],l+=12,c[l]=c[15],c[l+1]=c[16],c[l+2]=c[17],c[l+3]=c[3],c[l+4]=c[4],c[l+5]=c[5],c[l+6]=c[0],c[l+7]=c[1],c[l+8]=c[2],c[l+9]=c[12],c[l+10]=c[13],c[l+11]=c[14],l+=12,c[l]=c[3],c[l+1]=c[4],c[l+2]=c[5],c[l+3]=c[15],c[l+4]=c[16],c[l+5]=c[17],c[l+6]=c[18],c[l+7]=c[19],c[l+8]=c[20],c[l+9]=c[6],c[l+10]=c[7],c[l+11]=c[8],l+=12,c[l]=c[6],c[l+1]=c[7],c[l+2]=c[8],c[l+3]=c[18],c[l+4]=c[19],c[l+5]=c[20],c[l+6]=c[21],c[l+7]=c[22],c[l+8]=c[23],c[l+9]=c[9],c[l+10]=c[10],c[l+11]=c[11],r||(c=c.subarray(12));const u=new Ir.A({position:new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:c})});if((0,d.A)(s.normal)||(0,d.A)(s.tangent)||(0,d.A)(s.bitangent)||(0,d.A)(s.st)){const e=(0,d.A)(s.normal)?new Float32Array(12*a):void 0,t=(0,d.A)(s.tangent)?new Float32Array(12*a):void 0,n=(0,d.A)(s.bitangent)?new Float32Array(12*a):void 0,i=(0,d.A)(s.st)?new Float32Array(8*a):void 0,o=TP,c=bP,h=wP,A=j.A.negate(o,xP),p=j.A.negate(c,CP),f=j.A.negate(h,EP);l=0,r&&(gP(l,e,t,n,i,f,o,c),l+=12),gP(l,e,t,n,i,h,A,c),l+=12,gP(l,e,t,n,i,A,f,c),l+=12,gP(l,e,t,n,i,p,f,A),l+=12,gP(l,e,t,n,i,o,h,c),l+=12,gP(l,e,t,n,i,c,h,A),(0,d.A)(e)&&(u.normal=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:e})),(0,d.A)(t)&&(u.tangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:t})),(0,d.A)(n)&&(u.bitangent=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:n})),(0,d.A)(i)&&(u.st=new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:2,values:i}))}const h=new Uint16Array(6*a);for(let e=0;e<a;++e){const t=6*e,n=4*e;h[t]=n,h[t+1]=n+1,h[t+2]=n+2,h[t+3]=n,h[t+4]=n+2,h[t+5]=n+3}return new I.A({attributes:u,indices:h,primitiveType:p.A.TRIANGLES,boundingSphere:Sn.A.fromVertices(c)})};const DP=dP;function OP(e){l.A.typeOf.object("options",e),l.A.typeOf.object("options.frustum",e.frustum),l.A.typeOf.object("options.origin",e.origin),l.A.typeOf.object("options.orientation",e.orientation);const t=e.frustum,n=e.orientation,i=e.origin,o=e._drawNearPlane??!0;let r,s;t instanceof uP.A?(r=0,s=uP.A.packedLength):t instanceof ee.A&&(r=1,s=ee.A.packedLength),this._frustumType=r,this._frustum=t.clone(),this._origin=j.A.clone(i),this._orientation=To.A.clone(n),this._drawNearPlane=o,this._workerName="createFrustumOutlineGeometry",this.packedLength=2+s+j.A.packedLength+To.A.packedLength}OP.pack=function(e,t,n){l.A.typeOf.object("value",e),l.A.defined("array",t),n=n??0;const i=e._frustumType,o=e._frustum;return t[n++]=i,0===i?(uP.A.pack(o,t,n),n+=uP.A.packedLength):(ee.A.pack(o,t,n),n+=ee.A.packedLength),j.A.pack(e._origin,t,n),n+=j.A.packedLength,To.A.pack(e._orientation,t,n),t[n+=To.A.packedLength]=e._drawNearPlane?1:0,t};const RP=new uP.A,MP=new ee.A,LP=new To.A,NP=new j.A;OP.unpack=function(e,t,n){l.A.defined("array",e),t=t??0;const i=e[t++];let o;0===i?(o=uP.A.unpack(e,t,RP),t+=uP.A.packedLength):(o=ee.A.unpack(e,t,MP),t+=ee.A.packedLength);const r=j.A.unpack(e,t,NP);t+=j.A.packedLength;const s=To.A.unpack(e,t,LP),a=1===e[t+=To.A.packedLength];if(!(0,d.A)(n))return new OP({frustum:o,origin:r,orientation:s,_drawNearPlane:a});const c=i===n._frustumType?n._frustum:void 0;return n._frustum=o.clone(c),n._frustumType=i,n._origin=j.A.clone(r,n._origin),n._orientation=To.A.clone(s,n._orientation),n._drawNearPlane=a,n},OP.createGeometry=function(e){const t=e._frustumType,n=e._frustum,i=e._origin,o=e._orientation,r=e._drawNearPlane,s=new Float64Array(24);DP._computeNearFarPlanes(i,o,t,n,s);const a=new Ir.A({position:new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:s})});let c,l;const u=r?2:1,d=new Uint16Array(8*(u+1));let h=r?0:1;for(;h<2;++h)c=r?8*h:0,l=4*h,d[c]=l,d[c+1]=l+1,d[c+2]=l+1,d[c+3]=l+2,d[c+4]=l+2,d[c+5]=l+3,d[c+6]=l+3,d[c+7]=l;for(h=0;h<2;++h)c=8*(u+h),l=4*h,d[c]=l,d[c+1]=l+4,d[c+2]=l+1,d[c+3]=l+5,d[c+4]=l+2,d[c+5]=l+6,d[c+6]=l+3,d[c+7]=l+7;return new I.A({attributes:a,indices:d,primitiveType:p.A.LINES,boundingSphere:Sn.A.fromVertices(s)})};const BP=OP;var FP=n(263842);const UP=Object.freeze({SEARCH:0,AUTOCOMPLETE:1});function kP(){A.A.throwInstantiationError()}Object.defineProperties(kP.prototype,{credit:{get:A.A.throwInstantiationError}}),kP.getCreditsFromResult=function(e){if((0,d.A)(e.attributions))return e.attributions.map(Ws.A.getIonCredit)},kP.prototype.geocode=A.A.throwInstantiationError;const VP=kP;var zP=n(653577);function HP(){A.A.throwInstantiationError()}HP.createGeometry=function(e){A.A.throwInstantiationError()};const GP=HP;var WP=n(494938),YP=n(597751),qP=n(957171),jP=n.t(qP,2);const QP=function(e,t){return 0!==(e&t)},XP=[1,2,4,8];function KP(e,t,n,i,o,r){this._bits=e,this.cnodeVersion=t,this.imageryVersion=n,this.terrainVersion=i,this.imageryProvider=o,this.terrainProvider=r,this.ancestorHasTerrain=!1,this.terrainState=void 0}KP.clone=function(e,t){return(0,d.A)(t)?(t._bits=e._bits,t.cnodeVersion=e.cnodeVersion,t.imageryVersion=e.imageryVersion,t.terrainVersion=e.terrainVersion,t.imageryProvider=e.imageryProvider,t.terrainProvider=e.terrainProvider):t=new KP(e._bits,e.cnodeVersion,e.imageryVersion,e.terrainVersion,e.imageryProvider,e.terrainProvider),t.ancestorHasTerrain=e.ancestorHasTerrain,t.terrainState=e.terrainState,t},KP.prototype.setParent=function(e){this.ancestorHasTerrain=e.ancestorHasTerrain||this.hasTerrain()},KP.prototype.hasSubtree=function(){return QP(this._bits,16)},KP.prototype.hasImagery=function(){return QP(this._bits,64)},KP.prototype.hasTerrain=function(){return QP(this._bits,128)},KP.prototype.hasChildren=function(){return QP(this._bits,15)},KP.prototype.hasChild=function(e){return QP(this._bits,XP[e])},KP.prototype.getChildBitmask=function(){return 15&this._bits};const $P=KP;var JP=n(222448),ZP=n(971724);const eD=function(e){const t=new ArrayBuffer(1016),n=new Uint8Array(t);for(let t=0;t<1016;++t)n[t]=e.charCodeAt(t);return t}('Eô½\vyâjE",ÍqøIFgQ\0B%Æèa,f)\bÆ4Üjb%y\nwmiÖðk¡½NuàA[ß@V\fÙ»r|3SîOlÔq°{ÀEVZ­wUe\v3*¬l5Å0sø3>mF8J´Ýð.ÝuÚDt"úa"\f3"So¯9D\v9Ù9L¹¿«\\P_"uxéqh;ÁÄð<VqH\'UfYNeu£aF}a?A\0×´4MÎF°Õ¸\'{Ü+»Mg0ÈÑö\\Pú[/Fn5/\'C.ë\n\f^¥se4ål.jC\'c#U©?q{gC}:¯ÍâTUýKÆâ/(íË\\Æ-f§;/*"N°k.Ý\r}}GºC²²+>Mª>}æÎIÆæx\fa1-¤O¥~q ì\r1èN\v\0nPh}=\b\r¦n£h$[kó#ó¶s³\r\v@ÀØQ]ú".jßI\0¹ wUÆïj¿{GLîÜÜF©­S+S4ÿYä8è1N¹XFkË-#p\x005"Ï1²&/çÃu-6,rt°#G·ÓÑ&7râ\0DÏÚ3-Þ`i#i*|ÍKQ\rT9w.)ê¦P¢joP\\>TûïP[\vEm(w7ÛJfJo åpâ¹q~\fmI-zþrÇòY0»]såÉ êxì ðB|G`°½&·q¶ÇÑ3=Ó«îcÈ+S D\\qÆÌD2O<ÊÀ)=RÓaX©}e´ÜÏ\rô=ñ\b©BÚ#\tØ¿^PIøMÀËGLO÷{+ØÅ1;µoÜl\rÑÛ?âéÚ_ÔâFaZÞUÏ¤\0¾ýÎgñJiæ HØ]~®q N®ÀV©<rçvì)IÖ]-ãÛ6©;fjÕ¶=P^R¹KÇsWxÉô.YoÐKW>\'\'Ç`Û;íSD>?mw¢\në?R¨ÆU^1I7ôÅ&-©¿\'TÚÃj å*x°Öprªh½÷_H±~ÀXL?fù>áeÀp§Ï8i¯ðVldI\'­xtOÂÞV9\0Úw\vË-û5Oõ\bQ`Á\nZGM&30xÚÀFGâ[y`In7gS\n>éìF9²ñ4\rÆSuná\fYÙÞ){II¥wy¾IV.6ç\v:»Ob{ÒM1/½8{¨O!áìFpv})"x\nÝ\\ÚÞQÏðüYRe|3ßóHÚ»*uÛ`²Ôüíì5¨ÿ(1-ÈÜF|["');function tD(e){this.imageryPresent=!0,this.protoImagery=void 0,this.terrainPresent=!0,this.negativeAltitudeExponentBias=32,this.negativeAltitudeThreshold=J.A.EPSILON12,this.providers={},this.key=void 0,this._resource=void 0,this._quadPacketVersion=1,this._tileInfo={},this._subtreePromises={}}Object.defineProperties(tD.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},resource:{get:function(){return this._resource}}}),tD.fromUrl=async function(e){l.A.defined("resourceOrUrl",e);let t=e;"string"==typeof t||t instanceof Lt.A||(l.A.typeOf.string("resourceOrUrl.url",e.url),t=e.url);const n=Lt.A.createIfNeeded(t);n.appendForwardSlash();const i=new tD;i._resource=n;try{await function(e){const t=e._resource.getDerivedResource({url:"dbRoot.v5",queryParameters:{output:"proto"}});if(!(0,d.A)(sD)){const e=(0,yv.A)("ThirdParty/google-earth-dbroot-parser.js"),t=window.cesiumGoogleEarthDbRootParser;sD=(0,JP.A)(e).then(function(){rD=window.cesiumGoogleEarthDbRootParser(jP),(0,d.A)(t)?window.cesiumGoogleEarthDbRootParser=t:delete window.cesiumGoogleEarthDbRootParser})}return sD.then(function(){return t.fetchArrayBuffer()}).then(function(t){const n=rD.EncryptedDbRootProto.decode(new Uint8Array(t));let i=n.encryptionData,o=i.byteOffset,r=o+i.byteLength;const s=e.key=i.buffer.slice(o,r);i=n.dbrootData,o=i.byteOffset,r=o+i.byteLength;const a=i.buffer.slice(o,r);return nD.scheduleTask({buffer:a,type:"DbRoot",key:s},[a])}).then(function(t){const n=rD.DbRootProto.decode(new Uint8Array(t.buffer));if(e.imageryPresent=n.imageryPresent??e.imageryPresent,e.protoImagery=n.protoImagery,e.terrainPresent=n.terrainPresent??e.terrainPresent,(0,d.A)(n.endSnippet)&&(0,d.A)(n.endSnippet.model)){const t=n.endSnippet.model;e.negativeAltitudeExponentBias=t.negativeAltitudeExponentBias??e.negativeAltitudeExponentBias,e.negativeAltitudeThreshold=t.compressedNegativeAltitudeThreshold??e.negativeAltitudeThreshold}(0,d.A)(n.databaseVersion)&&(e._quadPacketVersion=n.databaseVersion.quadtreeVersion??e._quadPacketVersion);const i=e.providers,o=n.providerInfo??[],r=o.length;for(let e=0;e<r;++e){const t=o[e],n=t.copyrightString;(0,d.A)(n)&&(i[t.providerId]=new Ws.A(n.value))}}).catch(function(){console.log(`Failed to retrieve ${t.url}. Using defaults.`),e.key=eD})}(i),await i.getQuadTreePacket("",i._quadPacketVersion)}catch(e){const t=`An error occurred while accessing ${oD(i,"",1).url}: ${e}`;throw new M.A(t)}return i},tD.tileXYToQuadKey=function(e,t,n){let i="";for(let o=n;o>=0;--o){const n=1<<o;let r=0;QP(t,n)?QP(e,n)&&(r|=1):(r|=2,QP(e,n)||(r|=1)),i+=r}return i},tD.quadKeyToTileXY=function(e){let t=0,n=0;const i=e.length-1;for(let o=i;o>=0;--o){const r=1<<o,s=+e[i-o];QP(s,2)?QP(s,1)||(t|=r):(n|=r,QP(s,1)&&(t|=r))}return{x:t,y:n,level:i}},tD.prototype.isValid=function(e){let t=this.getTileInformationFromQuadKey(e);if((0,d.A)(t))return null!==t;let n,i=!0,o=e;for(;o.length>1;){if(n=o.substring(o.length-1),o=o.substring(0,o.length-1),t=this.getTileInformationFromQuadKey(o),(0,d.A)(t)){t.hasSubtree()||t.hasChild(parseInt(n))||(i=!1);break}if(null===t){i=!1;break}}return i};const nD=new ZP.A("decodeGoogleEarthEnterprisePacket");function iD(e,t,n){const i=e._tileInfo;let o,r=t,s=i[r];if((0,d.A)(s)&&(!s.hasSubtree()||s.hasChildren()))return s;for(;void 0===s&&r.length>1;)r=r.substring(0,r.length-1),s=i[r];const a=e._subtreePromises;let c=a[r];return(0,d.A)(c)?c.then(function(){return o=new iI.A({throttle:n.throttle,throttleByServer:n.throttleByServer,type:n.type,priorityFunction:n.priorityFunction}),iD(e,t,o)}):(0,d.A)(s)&&s.hasSubtree()?(c=e.getQuadTreePacket(r,s.cnodeVersion,n),(0,d.A)(c)?(a[r]=c,c.then(function(){return o=new iI.A({throttle:n.throttle,throttleByServer:n.throttleByServer,type:n.type,priorityFunction:n.priorityFunction}),iD(e,t,o)}).finally(function(){delete a[r]})):void 0):Promise.reject(new M.A(`Couldn't load metadata for tile ${t}`))}function oD(e,t,n,i){return e._resource.getDerivedResource({url:`flatfile?q2-0${t}-q.${n.toString()}`,request:i})}let rD,sD;tD.prototype.getQuadTreePacket=function(e,t,n){const i=oD(this,e=e??"",t=t??1,n).fetchArrayBuffer();if(!(0,d.A)(i))return;const o=this._tileInfo,r=this.key;return i.then(function(t){return nD.scheduleTask({buffer:t,quadKey:e,type:"Metadata",key:r},[t]).then(function(t){let n,i=-1;if(""!==e){i=e.length+1;const r=t[e];n=o[e],n._bits|=r._bits,delete t[e]}const r=Object.keys(t);r.sort(function(e,t){return e.length-t.length});const s=r.length;for(let e=0;e<s;++e){const s=r[e];if(null!==t[s]){const e=$P.clone(t[s]),r=s.length;if(r===i)e.setParent(n);else if(r>1){const t=o[s.substring(0,s.length-1)];e.setParent(t)}o[s]=e}else o[s]=null}})})},tD.prototype.populateSubtree=function(e,t,n,i){return iD(this,tD.tileXYToQuadKey(e,t,n),i)},tD.prototype.getTileInformation=function(e,t,n){const i=tD.tileXYToQuadKey(e,t,n);return this._tileInfo[i]},tD.prototype.getTileInformationFromQuadKey=function(e){return this._tileInfo[e]};const aD=tD;var cD=n(587451),lD=n(832698),uD=n(589670),dD=n(42794),hD=n(371267),AD=n(255335);function pD(e){e=e??S.A.EMPTY_OBJECT,l.A.typeOf.object("options.buffer",e.buffer),l.A.typeOf.number("options.negativeAltitudeExponentBias",e.negativeAltitudeExponentBias),l.A.typeOf.number("options.negativeElevationThreshold",e.negativeElevationThreshold),this._buffer=e.buffer,this._credits=e.credits,this._negativeAltitudeExponentBias=e.negativeAltitudeExponentBias,this._negativeElevationThreshold=e.negativeElevationThreshold;const t=e.childTileMask??15;let n=3&t;n|=4&t?8:0,n|=8&t?4:0,this._childTileMask=n,this._createdByUpsampling=e.createdByUpsampling??!1,this._skirtHeight=void 0,this._bufferType=this._buffer.constructor,this._mesh=void 0,this._minimumHeight=void 0,this._maximumHeight=void 0}Object.defineProperties(pD.prototype,{credits:{get:function(){return this._credits}},waterMask:{get:function(){}}});const fD="createVerticesFromGoogleEarthEnterpriseBuffer",mD=new ZP.A(fD),gD=new ZP.A(fD,dD.A.maximumAsynchronousTasks),_D=new Or.A,yD=new Or.A;pD.prototype.createMesh=function(e){e=e??S.A.EMPTY_OBJECT,l.A.typeOf.object("options.tilingScheme",e.tilingScheme),l.A.typeOf.number("options.x",e.x),l.A.typeOf.number("options.y",e.y),l.A.typeOf.number("options.level",e.level);const t=e.tilingScheme,n=e.x,i=e.y,o=e.level,r=e.exaggeration??1,s=e.exaggerationRelativeHeight??0,a=e.throttle??!0,c=t.ellipsoid;t.tileXYToNativeRectangle(n,i,o,_D),t.tileXYToRectangle(n,i,o,yD);const u=c.cartographicToCartesian(Or.A.center(yD)),h=40075.16/(1<<o);this._skirtHeight=Math.min(8*h,1e3);const A=(a?gD:mD).scheduleTask({buffer:this._buffer,nativeRectangle:_D,rectangle:yD,relativeToCenter:u,ellipsoid:c,skirtHeight:this._skirtHeight,exaggeration:r,exaggerationRelativeHeight:s,includeWebMercatorT:!0,negativeAltitudeExponentBias:this._negativeAltitudeExponentBias,negativeElevationThreshold:this._negativeElevationThreshold});if(!(0,d.A)(A))return;const p=this;return A.then(function(e){return p._mesh=new AD.A(u,new Float32Array(e.vertices),new Uint16Array(e.indices),e.indexCountWithoutSkirts,e.vertexCountWithoutSkirts,e.minimumHeight,e.maximumHeight,Sn.A.clone(e.boundingSphere3D),j.A.clone(e.occludeePointInScaledSpace),e.numberOfAttributes,lD.A.clone(e.orientedBoundingBox),hD.A.clone(e.encoding),e.westIndicesSouthToNorth,e.southIndicesEastToWest,e.eastIndicesNorthToSouth,e.northIndicesWestToEast),p._minimumHeight=e.minimumHeight,p._maximumHeight=e.maximumHeight,p._buffer=void 0,p._mesh})},pD.prototype.interpolateHeight=function(e,t,n){const i=J.A.clamp((t-e.west)/e.width,0,1),o=J.A.clamp((n-e.south)/e.height,0,1);return(0,d.A)(this._mesh)?function(e,t,n){const i=e._mesh,o=i.vertices,r=i.encoding,s=i.indices;for(let e=0,i=s.length;e<i;e+=3){const i=s[e],a=s[e+1],c=s[e+2],l=r.decodeTextureCoordinates(o,i,TD),u=r.decodeTextureCoordinates(o,a,bD),d=r.decodeTextureCoordinates(o,c,wD),h=cD.A.computeBarycentricCoordinates(t,n,l.x,l.y,u.x,u.y,d.x,d.y,xD);if(h.x>=-1e-15&&h.y>=-1e-15&&h.z>=-1e-15){const e=r.decodeHeight(o,i),t=r.decodeHeight(o,a),n=r.decodeHeight(o,c);return h.x*e+h.y*t+h.z*n}}}(this,i,o):function(e,t,n,i){const o=e._buffer;let r=0,s=0,a=0;n>.5?(t>.5?(r=2,s=.5):r=3,a=.5):t>.5&&(r=1,s=.5);const c=new DataView(o);let l=0;for(let e=0;e<r;++e)l+=c.getUint32(l,!0),l+=ED;l+=ED,l+=2*PD;const u=J.A.toRadians(180*c.getFloat64(l,!0));l+=PD;const d=J.A.toRadians(180*c.getFloat64(l,!0));l+=PD;const h=i.width/u/2,A=i.height/d/2,p=c.getInt32(l,!0);l+=SD;const f=3*c.getInt32(l,!0);l+=SD,l+=SD;const m=new Array(p),g=new Array(p),_=new Array(p);let y;for(y=0;y<p;++y)m[y]=s+c.getUint8(l++)*h,g[y]=a+c.getUint8(l++)*A,_[y]=6371010*c.getFloat32(l,!0),l+=ID;const v=new Array(f);for(y=0;y<f;++y)v[y]=c.getUint16(l,!0),l+=CD;for(y=0;y<f;y+=3){const e=v[y],i=v[y+1],o=v[y+2],r=m[e],s=m[i],a=m[o],c=g[e],l=g[i],u=g[o],d=cD.A.computeBarycentricCoordinates(t,n,r,c,s,l,a,u,xD);if(d.x>=-1e-15&&d.y>=-1e-15&&d.z>=-1e-15)return d.x*_[e]+d.y*_[i]+d.z*_[o]}}(this,i,o,e)};const vD=new ZP.A("upsampleQuantizedTerrainMesh",dD.A.maximumAsynchronousTasks);pD.prototype.upsample=function(e,t,n,i,o,r,s){if(l.A.typeOf.object("tilingScheme",e),l.A.typeOf.number("thisX",t),l.A.typeOf.number("thisY",n),l.A.typeOf.number("thisLevel",i),l.A.typeOf.number("descendantX",o),l.A.typeOf.number("descendantY",r),l.A.typeOf.number("descendantLevel",s),s-i>1)throw new A.A("Upsampling through more than one level at a time is not currently supported.");const a=this._mesh;if(!(0,d.A)(this._mesh))return;const c=2*t!==o,u=2*n===r,h=e.ellipsoid,p=e.tileXYToRectangle(o,r,s),f=vD.scheduleTask({vertices:a.vertices,indices:a.indices,indexCountWithoutSkirts:a.indexCountWithoutSkirts,vertexCountWithoutSkirts:a.vertexCountWithoutSkirts,encoding:a.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:c,isNorthChild:u,childRectangle:p,ellipsoid:h});if(!(0,d.A)(f))return;const m=this;return f.then(function(e){const t=new Uint16Array(e.vertices),n=Pr.A.createTypedArray(t.length/3,e.indices),i=m._skirtHeight;return new uD.A({quantizedVertices:t,indices:n,minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight,boundingSphere:Sn.A.clone(e.boundingSphere),orientedBoundingBox:lD.A.clone(e.orientedBoundingBox),horizonOcclusionPoint:j.A.clone(e.horizonOcclusionPoint),westIndices:e.westIndices,southIndices:e.southIndices,eastIndices:e.eastIndices,northIndices:e.northIndices,westSkirtHeight:i,southSkirtHeight:i,eastSkirtHeight:i,northSkirtHeight:i,childTileMask:0,createdByUpsampling:!0,credits:m._credits})})},pD.prototype.isChildAvailable=function(e,t,n,i){l.A.typeOf.number("thisX",e),l.A.typeOf.number("thisY",t),l.A.typeOf.number("childX",n),l.A.typeOf.number("childY",i);let o=2;return n!==2*e&&++o,i!==2*t&&(o-=2),!!(this._childTileMask&1<<o)},pD.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};const TD=new q.A,bD=new q.A,wD=new q.A,xD=new j.A,CD=Uint16Array.BYTES_PER_ELEMENT,ED=Uint32Array.BYTES_PER_ELEMENT,SD=Int32Array.BYTES_PER_ELEMENT,ID=Float32Array.BYTES_PER_ELEMENT,PD=Float64Array.BYTES_PER_ELEMENT,DD=pD,OD=new te.A;function RD(){this._terrainCache={},this._lastTidy=te.A.now()}function MD(e){e=e??S.A.EMPTY_OBJECT,this._tilingScheme=new eI.A({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new Or.A(-J.A.PI,-J.A.PI,J.A.PI,J.A.PI),ellipsoid:e.ellipsoid});let t=e.credit;"string"==typeof t&&(t=new Ws.A(t)),this._credit=t,this._levelZeroMaximumGeometricError=40075.16,this._terrainCache=new RD,this._terrainPromises={},this._terrainRequests={},this._errorEvent=new Bn.A}RD.prototype.add=function(e,t){this._terrainCache[e]={buffer:t,timestamp:te.A.now()}},RD.prototype.get=function(e){const t=this._terrainCache[e];if((0,d.A)(t))return delete this._terrainCache[e],t.buffer},RD.prototype.tidy=function(){if(te.A.now(OD),te.A.secondsDifference(OD,this._lastTidy)>10){const e=this._terrainCache,t=Object.keys(e),n=t.length;for(let i=0;i<n;++i){const n=t[i],o=e[n];te.A.secondsDifference(OD,o.timestamp)>10&&delete e[n]}te.A.clone(OD,this._lastTidy)}},Object.defineProperties(MD.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._metadata.proxy}},tilingScheme:{get:function(){return this._tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}}),MD.fromMetadata=function(e,t){if(l.A.defined("metadata",e),!e.terrainPresent)throw new M.A(`The server ${e.url} doesn't have terrain`);const n=new MD(t);return n._metadata=e,n};const LD=new ZP.A("decodeGoogleEarthEnterprisePacket");function ND(e,t,n){let i=t.getChildBitmask();if(3===t.terrainState){i=0;for(let t=0;t<4;++t){const o=n.getTileInformationFromQuadKey(e+t.toString());(0,d.A)(o)&&o.hasTerrain()&&(i|=1<<t)}}return i}MD.prototype.requestTileGeometry=function(e,t,n,i){const o=aD.tileXYToQuadKey(e,t,n),r=this._terrainCache,s=this._metadata,a=s.getTileInformationFromQuadKey(o);if(!(0,d.A)(a))return Promise.reject(new M.A("Terrain tile doesn't exist"));let c=a.terrainState;(0,d.A)(c)||(c=a.terrainState=0);const l=r.get(o);if((0,d.A)(l)){const e=s.providers[a.terrainProvider];return Promise.resolve(new DD({buffer:l,childTileMask:ND(o,a,s),credits:(0,d.A)(e)?[e]:void 0,negativeAltitudeExponentBias:s.negativeAltitudeExponentBias,negativeElevationThreshold:s.negativeAltitudeThreshold}))}if(r.tidy(),!a.ancestorHasTerrain)return Promise.resolve(new nI.A({buffer:new Uint8Array(256),width:16,height:16}));if(1===c)return Promise.reject(new M.A("Terrain tile doesn't exist"));let u,h=o,A=-1;switch(c){case 2:A=a.terrainVersion;break;case 3:h=h.substring(0,h.length-1),u=s.getTileInformationFromQuadKey(h),A=u.terrainVersion;break;case 0:a.hasTerrain()?A=a.terrainVersion:(h=h.substring(0,h.length-1),u=s.getTileInformationFromQuadKey(h),(0,d.A)(u)&&u.hasTerrain()&&(A=u.terrainVersion))}if(A<0)return Promise.reject(new M.A("Terrain tile doesn't exist"));const p=this._terrainPromises,f=this._terrainRequests;let m,g;if((0,d.A)(p[h]))m=p[h],g=f[h];else{g=i;const e=function(e,t,n,i){return n=(0,d.A)(n)&&n>0?n:1,e._metadata.resource.getDerivedResource({url:`flatfile?f1c-0${t}-t.${n.toString()}`,request:i})}(this,h,A,g).fetchArrayBuffer();if(!(0,d.A)(e))return;m=e.then(function(e){return(0,d.A)(e)?LD.scheduleTask({buffer:e,type:"Terrain",key:s.key},[e]).then(function(e){const t=s.getTileInformationFromQuadKey(h);t.terrainState=2,r.add(h,e[0]);const n=t.terrainProvider,i=e.length-1;for(let t=0;t<i;++t){const i=h+t.toString(),o=s.getTileInformationFromQuadKey(i);(0,d.A)(o)&&(r.add(i,e[t+1]),o.terrainState=3,0===o.terrainProvider&&(o.terrainProvider=n))}}):Promise.reject(new M.A("Failed to load terrain."))}),p[h]=m,f[h]=g,m=m.finally(function(){delete p[h],delete f[h]})}return m.then(function(){const e=r.get(o);if((0,d.A)(e)){const t=s.providers[a.terrainProvider];return new DD({buffer:e,childTileMask:ND(o,a,s),credits:(0,d.A)(t)?[t]:void 0,negativeAltitudeExponentBias:s.negativeAltitudeExponentBias,negativeElevationThreshold:s.negativeAltitudeThreshold})}return Promise.reject(new M.A("Failed to load terrain."))}).catch(function(e){return g.state===oI.A.CANCELLED?(i.state=g.state,Promise.reject(e)):(a.terrainState=1,Promise.reject(e))})},MD.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},MD.prototype.getTileDataAvailable=function(e,t,n){const i=this._metadata;let o=aD.tileXYToQuadKey(e,t,n);const r=i.getTileInformation(e,t,n);if(null===r)return!1;if((0,d.A)(r)){if(!r.ancestorHasTerrain)return!0;const e=r.terrainState;if(1===e)return!1;if(!((0,d.A)(e)&&0!==e||(r.terrainState=0,r.hasTerrain()))){o=o.substring(0,o.length-1);const e=i.getTileInformationFromQuadKey(o);if(!(0,d.A)(e)||!e.hasTerrain())return!1}return!0}if(i.isValid(o)){const o=new iI.A({throttle:!1,throttleByServer:!0,type:rI.A.TERRAIN});i.populateSubtree(e,t,n,o)}return!1},MD.prototype.loadTileDataAvailability=function(e,t,n){};const BD=MD,FD='<img alt="Google" src="https://assets.ion.cesium.com/google-credit.png" style="vertical-align:-5px">';function UD(e){const t=(e=e??S.A.EMPTY_OBJECT).key;if(!(0,d.A)(t))throw new A.A("options.key is required.");this._resource=new Lt.A({url:"https://maps.googleapis.com/maps/api/geocode/json",queryParameters:{key:t}}),this._credit=new Ws.A(FD,!0)}Object.defineProperties(UD.prototype,{credit:{get:function(){return this._credit}}}),UD.prototype.geocode=async function(e){l.A.typeOf.string("query",e);const t=this._resource.getDerivedResource({queryParameters:{address:e}}),n=await t.fetchJson();if("ZERO_RESULTS"===n.status)return[];if("OK"!==n.status)throw new M.A(`GoogleGeocoderService got a bad response ${n.status}: ${n.error_message}`);return n.results.map(e=>{const t=e.geometry.viewport.southwest,n=e.geometry.viewport.northeast;return{displayName:e.formatted_address,destination:Or.A.fromDegrees(t.lng,t.lat,n.lng,n.lat),attribution:{html:FD,collapsible:!1}}})};const kD=UD,VD={defaultApiKey:void 0};VD.mapTilesApiEndpoint=new Lt.A({url:"https://tile.googleapis.com/v1/"}),VD.getDefaultCredit=function(){return new Ws.A('<img src="https://assets.ion.cesium.com/google-credit.png" style="vertical-align: -5px" alt="Google">',!0)};const zD=VD;var HD=n(129961),GD=n(103882),WD=n(416721);const YD={};YD.ExportStatus=Object.freeze({NotStarted:"NotStarted",InProgress:"InProgress",Complete:"Complete",Invalid:"Invalid"}),YD.ExportType=Object.freeze({IMODEL:"IMODEL",CESIUM:"CESIUM","3DTILES":"3DTILES"}),YD.RealityDataType=Object.freeze({Cesium3DTiles:"Cesium3DTiles",PNTS:"PNTS",RealityMesh3DTiles:"RealityMesh3DTiles",Terrain3DTiles:"Terrain3DTiles",KML:"KML",GeoJSON:"GeoJSON",Unstructured:"Unstructured"}),YD.defaultAccessToken=void 0,YD.defaultShareKey=void 0,YD._getAuthorizationHeader=function(){if(!(0,d.A)(YD.defaultAccessToken)&&!(0,d.A)(YD.defaultShareKey))throw new A.A("Must set ITwinPlatform.defaultAccessToken or ITwinPlatform.defaultShareKey first");return(0,d.A)(YD.defaultShareKey)?`Basic ${YD.defaultShareKey}`:`Bearer ${YD.defaultAccessToken}`},YD.apiEndpoint=new Lt.A({url:"https://api.bentley.com"}),YD.getExports=async function(e,t){if(l.A.typeOf.string("iModelId",e),(0,d.A)(t)&&l.A.typeOf.string("changesetId",t),!(0,d.A)(YD.defaultAccessToken)&&!(0,d.A)(YD.defaultShareKey))throw new A.A("Must set ITwinPlatform.defaultAccessToken or ITwinPlatform.defaultShareKey first");const n=new Lt.A({url:`${YD.apiEndpoint}mesh-export`,headers:{Authorization:YD._getAuthorizationHeader(),Accept:"application/vnd.bentley.itwin-platform.v1+json",Prefer:"return=representation"},queryParameters:{iModelId:e,exportType:YD.ExportType["3DTILES"],$top:"5",client:"CesiumJS"}});"undefined"!=typeof CESIUM_VERSION&&n.appendQueryParameters({clientVersion:CESIUM_VERSION}),(0,d.A)(t)&&""!==t&&n.appendQueryParameters({changesetId:t});try{return await n.fetchJson()}catch(e){const t=JSON.parse(e.response);if(401===e.statusCode){const e=t.error.details?.[0].code??"";throw new M.A(`Unauthorized, bad token, wrong scopes or headers bad. ${e}`)}if(403===e.statusCode)throw console.error(t.error.code,t.error.message),new M.A("Not allowed, forbidden");if(422===e.statusCode)throw new M.A(`Unprocessable Entity:${t.error.code} ${t.error.message}`);if(429===e.statusCode)throw new M.A("Too many requests");throw new M.A(`Unknown request failure ${e.statusCode}`)}},YD.getRealityDataMetadata=async function(e,t){if(l.A.typeOf.string("iTwinId",e),l.A.typeOf.string("realityDataId",t),!(0,d.A)(YD.defaultAccessToken)&&!(0,d.A)(YD.defaultShareKey))throw new A.A("Must set ITwinPlatform.defaultAccessToken or ITwinPlatform.defaultShareKey first");const n=new Lt.A({url:`${YD.apiEndpoint}reality-management/reality-data/${t}`,headers:{Authorization:YD._getAuthorizationHeader(),Accept:"application/vnd.bentley.itwin-platform.v1+json"},queryParameters:{iTwinId:e}});try{return(await n.fetchJson()).realityData}catch(n){const i=JSON.parse(n.response);if(401===n.statusCode){const e=i.error.details?.[0].code??"";throw new M.A(`Unauthorized, bad token, wrong scopes or headers bad. ${e}`)}if(403===n.statusCode)throw console.error(i.error.code,i.error.message),new M.A("Not allowed, forbidden");if(404===n.statusCode)throw new M.A(`Reality data not found: ${e}, ${t}`);if(422===n.statusCode)throw new M.A(`Unprocessable Entity:${i.error.code} ${i.error.message}`);if(429===n.statusCode)throw new M.A("Too many requests");throw new M.A(`Unknown request failure ${n.statusCode}`)}},YD.getRealityDataURL=async function(e,t,n){if(l.A.typeOf.string("iTwinId",e),l.A.typeOf.string("realityDataId",t),l.A.typeOf.string("rootDocument",n),!(0,d.A)(YD.defaultAccessToken)&&!(0,d.A)(YD.defaultShareKey))throw new A.A("Must set ITwinPlatform.defaultAccessToken or ITwinPlatform.defaultShareKey first");const i=new Lt.A({url:`${YD.apiEndpoint}reality-management/reality-data/${t}/readaccess`,headers:{Authorization:YD._getAuthorizationHeader(),Accept:"application/vnd.bentley.itwin-platform.v1+json"},queryParameters:{iTwinId:e}});try{const e=(await i.fetchJson())._links.containerUrl.href,t=new URL(e);return t.pathname=`${t.pathname}/${n}`,t.toString()}catch(n){const i=JSON.parse(n.response);if(401===n.statusCode){const e=i.error.details?.[0].code??"";throw new M.A(`Unauthorized, bad token, wrong scopes or headers bad. ${e}`)}if(403===n.statusCode)throw console.error(i.error.code,i.error.message),new M.A("Not allowed, forbidden");if(404===n.statusCode)throw new M.A(`Reality data not found: ${e}, ${t}`);if(422===n.statusCode)throw new M.A(`Unprocessable Entity:${i.error.code} ${i.error.message}`);if(429===n.statusCode)throw new M.A("Too many requests");throw new M.A(`Unknown request failure ${n.statusCode}`)}};const qD=YD,jD=function(e,t,n,i){this.rightAscension=e,this.declination=t,this.rotation=n,this.rotationRate=i},QD={},XD=-.0529921,KD=-.1059842,$D=13.0120009,JD=13.3407154,ZD=.9856003,eO=26.4057084,tO=13.064993,nO=.3287146,iO=1.7484877,oO=-.1589763,rO=.0036096,sO=.1643573,aO=12.9590088;let cO=new te.A;QD.ComputeMoon=function(e,t){(0,d.A)(e)||(e=te.A.now()),cO=te.A.addSeconds(e,32.184,cO);const n=te.A.totalDays(cO)-2451545,i=n/ne.A.DAYS_PER_JULIAN_CENTURY,o=(125.045+XD*n)*J.A.RADIANS_PER_DEGREE,r=(250.089+KD*n)*J.A.RADIANS_PER_DEGREE,s=(260.008+$D*n)*J.A.RADIANS_PER_DEGREE,a=(176.625+JD*n)*J.A.RADIANS_PER_DEGREE,c=(357.529+ZD*n)*J.A.RADIANS_PER_DEGREE,l=(311.589+eO*n)*J.A.RADIANS_PER_DEGREE,u=(134.963+tO*n)*J.A.RADIANS_PER_DEGREE,h=(276.617+nO*n)*J.A.RADIANS_PER_DEGREE,A=(34.226+iO*n)*J.A.RADIANS_PER_DEGREE,p=(15.134+oO*n)*J.A.RADIANS_PER_DEGREE,f=(119.743+rO*n)*J.A.RADIANS_PER_DEGREE,m=(239.961+sO*n)*J.A.RADIANS_PER_DEGREE,g=(25.053+aO*n)*J.A.RADIANS_PER_DEGREE,_=Math.sin(o),y=Math.sin(r),v=Math.sin(s),T=Math.sin(a),b=Math.sin(c),w=Math.sin(l),x=Math.sin(u),C=Math.sin(h),E=Math.sin(A),S=Math.sin(p),I=Math.sin(f),P=Math.sin(m),D=Math.sin(g),O=Math.cos(o),R=Math.cos(r),M=Math.cos(s),L=Math.cos(a),N=Math.cos(c),B=Math.cos(l),F=Math.cos(u),U=Math.cos(h),k=Math.cos(A),V=Math.cos(p),z=Math.cos(f),H=Math.cos(m),G=Math.cos(g),W=(269.9949+.0031*i-3.8787*_-.1204*y+.07*v-.0172*T+.0072*w-.0052*S+.0043*D)*J.A.RADIANS_PER_DEGREE,Y=(66.5392+.013*i+1.5419*O+.0239*R-.0278*M+.0068*L-.0029*B+9e-4*F+8e-4*V-9e-4*G)*J.A.RADIANS_PER_DEGREE,q=(38.3213+13.17635815*n-14e-13*n*n+3.561*_+.1208*y-.0642*v+.0158*T+.0252*b-.0066*w-.0047*x-.0046*C+.0028*E+.0052*S+.004*I+.0019*P-.0044*D)*J.A.RADIANS_PER_DEGREE,j=(13.17635815-2*n*14e-13+3.561*O*XD+.1208*R*KD-.0642*M*$D+.0158*L*JD+.0252*N*ZD-.0066*B*eO-.0047*F*tO-.0046*U*nO+.0028*k*iO+.0052*V*oO+.004*z*rO+.0019*H*sO-.0044*G*aO)/86400*J.A.RADIANS_PER_DEGREE;return(0,d.A)(t)||(t=new jD),t.rightAscension=W,t.declination=Y,t.rotation=q,t.rotationRate=j,t};const lO=QD;var uO=n(548840),dO=n(150066);function hO(e){(0,d.A)(e)&&"function"==typeof e||(e=lO.ComputeMoon),this._computeFunction=e}const AO=new j.A,pO=new j.A,fO=new j.A,mO=new Z.A,gO=new To.A;hO.prototype.evaluate=function(e,t){(0,d.A)(e)||(e=te.A.now());const n=this._computeFunction(e),i=function(e,t,n){const i=AO;i.x=Math.cos(e+J.A.PI_OVER_TWO),i.y=Math.sin(e+J.A.PI_OVER_TWO),i.z=0;const o=Math.cos(t),r=fO;r.x=o*Math.cos(e),r.y=o*Math.sin(e),r.z=Math.sin(t);const s=j.A.cross(r,i,pO);return(0,d.A)(n)||(n=new Z.A),n[0]=i.x,n[1]=s.x,n[2]=r.x,n[3]=i.y,n[4]=s.y,n[5]=r.y,n[6]=i.z,n[7]=s.z,n[8]=r.z,n}(n.rightAscension,n.declination,t),o=J.A.zeroToTwoPi(n.rotation),r=To.A.fromAxisAngle(j.A.UNIT_Z,o,gO),s=Z.A.fromQuaternion(To.A.conjugate(r,r),mO);return Z.A.multiply(s,i,i)};const _O=hO,yO={type:void 0};yO.getRequiredDataPoints=A.A.throwInstantiationError,yO.interpolateOrderZero=A.A.throwInstantiationError,yO.interpolate=A.A.throwInstantiationError;const vO=yO;var TO=n(92457),bO=n(647326),wO=n(150429),xO=n(33914),CO=n(386009);const EO=Object.freeze({GOOGLE:"GOOGLE",BING:"BING",DEFAULT:"DEFAULT"});function SO(e){l.A.defined("url",e),this._url=Lt.A.createIfNeeded(e),this._url.appendForwardSlash()}Object.defineProperties(SO.prototype,{url:{get:function(){return this._url}},credit:{get:function(){}}}),SO.prototype.geocode=async function(e,t){return l.A.typeOf.string("query",e),this._url.getDerivedResource({url:t===UP.AUTOCOMPLETE?"autocomplete":"search",queryParameters:{text:e}}).fetchJson().then(function(e){return e.features.map(function(t){let n;const i=t.bbox;if((0,d.A)(i))n=Or.A.fromDegrees(i[0],i[1],i[2],i[3]);else{const e=t.geometry.coordinates[0],i=t.geometry.coordinates[1];n=j.A.fromDegrees(e,i)}return{displayName:t.properties.label,destination:n,attributions:e.attributions}})})};const IO=SO;function PO(e){if(!Object.values(EO).some(t=>t===e))throw new A.A(`Invalid geocodeProviderType: "${e}"`)}const DO=Object.freeze({[EO.GOOGLE]:"google",[EO.BING]:"bing",[EO.DEFAULT]:void 0});function OO(e){e=e??S.A.EMPTY_OBJECT,l.A.typeOf.object("options.scene",e.scene);const t=e.geocodeProviderType??EO.DEFAULT;PO(t);const n=e.accessToken??CO.A.defaultAccessToken,i=Lt.A.createIfNeeded(e.server??CO.A.defaultServer);i.appendForwardSlash();const o=CO.A.getDefaultTokenCredit(n);(0,d.A)(o)&&e.scene.frameState.creditDisplay.addStaticCredit(Ws.A.clone(o));const r=i.getDerivedResource({url:"v1/geocode"});(0,d.A)(n)&&r.appendQueryParameters({access_token:n}),this._accessToken=n,this._server=i,this._pelias=new IO(r),this.geocodeProviderType=t}Object.defineProperties(OO.prototype,{credit:{get:function(){}},geocodeProviderType:{get:function(){return e=this._pelias.url.queryParameters.geocoder,Object.entries(DO).find(t=>t[1]===e)[0];var e},set:function(e){PO(e);const t={...this._pelias.url.queryParameters,geocoder:(n=e,DO[n])};var n;(0,d.A)(t.geocoder)||delete t.geocoder,this._pelias.url.setQueryParameters(t)}}}),OO.prototype.geocode=async function(e,t){return this._pelias.geocode(e,t)};const RO=OO;var MO=n(954865),LO=n(708025),NO=n(267465),BO=n(223049),FO=n(153127),UO=n(981757);function kO(){A.A.throwInstantiationError()}Object.defineProperties(kO.prototype,{ellipsoid:{get:A.A.throwInstantiationError}}),kO.prototype.project=A.A.throwInstantiationError,kO.prototype.unproject=A.A.throwInstantiationError;const VO=kO;function zO(e){const t=(e=e??S.A.EMPTY_OBJECT).weights,n=e.times;if(l.A.defined("weights",t),l.A.defined("times",n),l.A.typeOf.number.greaterThanOrEquals("weights.length",t.length,3),t.length%n.length!==0)throw new A.A("times.length must be a factor of weights.length.");this._times=n,this._weights=t,this._count=t.length/n.length,this._lastTimeIndex=0}Object.defineProperties(zO.prototype,{times:{get:function(){return this._times}},weights:{get:function(){return this._weights}}}),zO.prototype.findTimeInterval=CI.A.prototype.findTimeInterval,zO.prototype.wrapTime=CI.A.prototype.wrapTime,zO.prototype.clampTime=CI.A.prototype.clampTime,zO.prototype.evaluate=function(e,t){const n=this.weights,i=this.times,o=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),r=(e-i[o])/(i[o+1]-i[o]);(0,d.A)(t)||(t=new Array(this._count));for(let e=0;e<this._count;e++){const i=o*this._count+e;t[e]=n[i]*(1-r)+n[i+this._count]*r}return t};const HO=zO;var GO=n(245226);const WO=Object.freeze({NONE:-1,PARTIAL:0,FULL:1});function YO(e,t){if(!(0,d.A)(e))throw new A.A("occluderBoundingSphere is required.");if(!(0,d.A)(t))throw new A.A("camera position is required.");this._occluderPosition=j.A.clone(e.center),this._occluderRadius=e.radius,this._horizonDistance=0,this._horizonPlaneNormal=void 0,this._horizonPlanePosition=void 0,this._cameraPosition=void 0,this.cameraPosition=t}const qO=new j.A;Object.defineProperties(YO.prototype,{position:{get:function(){return this._occluderPosition}},radius:{get:function(){return this._occluderRadius}},cameraPosition:{set:function(e){if(!(0,d.A)(e))throw new A.A("cameraPosition is required.");e=j.A.clone(e,this._cameraPosition);const t=j.A.subtract(this._occluderPosition,e,qO);let n=j.A.magnitudeSquared(t);const i=this._occluderRadius*this._occluderRadius;let o,r,s;if(n>i){o=Math.sqrt(n-i),n=1/Math.sqrt(n),r=j.A.multiplyByScalar(t,n,qO);const a=o*o*n;s=j.A.add(e,j.A.multiplyByScalar(r,a,qO),qO)}else o=Number.MAX_VALUE;this._horizonDistance=o,this._horizonPlaneNormal=r,this._horizonPlanePosition=s,this._cameraPosition=e}}}),YO.fromBoundingSphere=function(e,t,n){if(!(0,d.A)(e))throw new A.A("occluderBoundingSphere is required.");if(!(0,d.A)(t))throw new A.A("camera position is required.");return(0,d.A)(n)?(j.A.clone(e.center,n._occluderPosition),n._occluderRadius=e.radius,n.cameraPosition=t,n):new YO(e,t)};const jO=new j.A;YO.prototype.isPointVisible=function(e){if(this._horizonDistance!==Number.MAX_VALUE){let t=j.A.subtract(e,this._occluderPosition,jO),n=this._occluderRadius;if(n=j.A.magnitudeSquared(t)-n*n,n>0)return n=Math.sqrt(n)+this._horizonDistance,t=j.A.subtract(e,this._cameraPosition,t),n*n>j.A.magnitudeSquared(t)}return!1};const QO=new j.A;YO.prototype.isBoundingSphereVisible=function(e){const t=j.A.clone(e.center,QO),n=e.radius;if(this._horizonDistance!==Number.MAX_VALUE){let e=j.A.subtract(t,this._occluderPosition,jO),i=this._occluderRadius-n;if(i=j.A.magnitudeSquared(e)-i*i,n<this._occluderRadius)return i>0&&(i=Math.sqrt(i)+this._horizonDistance,e=j.A.subtract(t,this._cameraPosition,e),i*i+n*n>j.A.magnitudeSquared(e));if(i>0){e=j.A.subtract(t,this._cameraPosition,e);const o=j.A.magnitudeSquared(e),r=this._occluderRadius*this._occluderRadius,s=n*n;return(this._horizonDistance*this._horizonDistance+r)*s>o*r||(i=Math.sqrt(i)+this._horizonDistance,i*i+s>o)}return!0}return!1};const XO=new j.A;YO.prototype.computeVisibility=function(e){if(!(0,d.A)(e))throw new A.A("occludeeBS is required.");const t=j.A.clone(e.center),n=e.radius;if(n>this._occluderRadius)return WO.FULL;if(this._horizonDistance!==Number.MAX_VALUE){let e=j.A.subtract(t,this._occluderPosition,XO),i=this._occluderRadius-n;const o=j.A.magnitudeSquared(e);if(i=o-i*i,i>0){i=Math.sqrt(i)+this._horizonDistance,e=j.A.subtract(t,this._cameraPosition,e);const r=j.A.magnitudeSquared(e);return i*i+n*n<r?WO.NONE:(i=this._occluderRadius+n,i=o-i*i,i>0?(i=Math.sqrt(i)+this._horizonDistance,r<i*i+n*n?WO.FULL:WO.PARTIAL):(e=j.A.subtract(t,this._horizonPlanePosition,e),j.A.dot(e,this._horizonPlaneNormal)>-n?WO.PARTIAL:WO.FULL))}}return WO.NONE};const KO=new j.A;YO.computeOccludeePoint=function(e,t,n){if(!(0,d.A)(e))throw new A.A("occluderBoundingSphere is required.");if(!(0,d.A)(n))throw new A.A("positions is required.");if(0===n.length)throw new A.A("positions must contain at least one element");const i=j.A.clone(t),o=j.A.clone(e.center),r=e.radius,s=n.length;if(j.A.equals(o,t))throw new A.A("occludeePosition must be different than occluderBoundingSphere.center");const a=j.A.normalize(j.A.subtract(i,o,KO),KO),c=-j.A.dot(a,o),l=YO._anyRotationVector(o,a,c);let u,h=YO._horizonToPlaneNormalDotProduct(e,a,c,l,n[0]);if(!h)return;for(let t=1;t<s;++t){if(u=YO._horizonToPlaneNormalDotProduct(e,a,c,l,n[t]),!u)return;u<h&&(h=u)}if(h<.0017453283658983088)return;const p=r/h;return j.A.add(o,j.A.multiplyByScalar(a,p,KO),KO)};const $O=[];YO.computeOccludeePointFromRectangle=function(e,t){if(!(0,d.A)(e))throw new A.A("rectangle is required.");t=t??K.A.default;const n=Or.A.subsample(e,t,0,$O),i=Sn.A.fromPoints(n),o=j.A.ZERO;if(!j.A.equals(o,i.center))return YO.computeOccludeePoint(new Sn.A(o,t.minimumRadius),i.center,n)};const JO=new j.A;YO._anyRotationVector=function(e,t,n){const i=j.A.abs(t,JO);let o=i.x>i.y?0:1;(0===o&&i.z>i.x||1===o&&i.z>i.y)&&(o=2);const r=new j.A;let s;0===o?(i.x=e.x,i.y=e.y+1,i.z=e.z+1,s=j.A.UNIT_X):1===o?(i.x=e.x+1,i.y=e.y,i.z=e.z+1,s=j.A.UNIT_Y):(i.x=e.x+1,i.y=e.y+1,i.z=e.z,s=j.A.UNIT_Z);const a=(j.A.dot(t,i)+n)/-j.A.dot(t,s);return j.A.normalize(j.A.subtract(j.A.add(i,j.A.multiplyByScalar(s,a,r),i),e,i),i)};const ZO=new j.A;YO._rotationVector=function(e,t,n,i,o){let r=j.A.subtract(i,e,ZO);if(r=j.A.normalize(r,r),j.A.dot(t,r)<.9999999847691291){const e=j.A.cross(t,r,r);if(j.A.magnitude(e)>J.A.EPSILON13)return j.A.normalize(e,new j.A)}return o};const eR=new j.A,tR=new j.A,nR=new j.A,iR=new j.A;YO._horizonToPlaneNormalDotProduct=function(e,t,n,i,o){const r=j.A.clone(o,eR),s=j.A.clone(e.center,tR),a=e.radius;let c=j.A.subtract(s,r,nR);const l=j.A.magnitudeSquared(c),u=a*a;if(l<u)return!1;const d=l-u,h=Math.sqrt(d),A=h*(1/Math.sqrt(l))*h;c=j.A.normalize(c,c);const p=j.A.add(r,j.A.multiplyByScalar(c,A,iR),iR),f=Math.sqrt(d-A*A);let m=this._rotationVector(s,t,n,r,i),g=j.A.fromElements(m.x*m.x*c.x+(m.x*m.y-m.z)*c.y+(m.x*m.z+m.y)*c.z,(m.x*m.y+m.z)*c.x+m.y*m.y*c.y+(m.y*m.z-m.x)*c.z,(m.x*m.z-m.y)*c.x+(m.y*m.z+m.x)*c.y+m.z*m.z*c.z,eR);g=j.A.normalize(g,g);const _=j.A.multiplyByScalar(g,f,eR);m=j.A.normalize(j.A.subtract(j.A.add(p,_,nR),s,nR),nR);const y=j.A.dot(t,m);m=j.A.normalize(j.A.subtract(j.A.subtract(p,_,m),s,m),m);const v=j.A.dot(t,m);return y<v?y:v};const oR=YO;function rR(e,t,n){l.A.defined("url",e),l.A.defined("apiKey",t),(0,d.A)(n)&&l.A.typeOf.object("params",n),(e=Lt.A.createIfNeeded(e)).appendForwardSlash(),e.setQueryParameters({key:t}),this._url=e,this._params=n??{},this._credit=new Ws.A('Geodata copyright <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',!1)}Object.defineProperties(rR.prototype,{url:{get:function(){return this._url}},params:{get:function(){return this._params}},credit:{get:function(){return this._credit}}}),rR.prototype.geocode=async function(e){return l.A.typeOf.string("query",e),this._url.getDerivedResource({url:"json",queryParameters:(0,tC.A)(this._params,{q:e})}).fetchJson().then(function(e){return e.results.map(function(e){let t;const n=e.bounds;if((0,d.A)(n))t=Or.A.fromDegrees(n.southwest.lng,n.southwest.lat,n.northeast.lng,n.northeast.lat);else{const n=e.geometry.lat,i=e.geometry.lng;t=j.A.fromDegrees(n,i)}return{displayName:e.formatted,destination:t}})})};const sR=rR;var aR=n(65891);const cR={packedLength:void 0,pack:A.A.throwInstantiationError,unpack:A.A.throwInstantiationError},lR={packedInterpolationLength:void 0,convertPackedArrayForInterpolation:A.A.throwInstantiationError,unpackInterpolationResult:A.A.throwInstantiationError};var uR=n(65783),dR=n(257941);function hR(){A.A.throwInstantiationError()}hR.prototype.getURL=A.A.throwInstantiationError;const AR=hR;var pR=n(118135),fR=n(173866),mR=n(259690),gR=n(67988),_R=n(766067),yR=n(373388),vR=n(866569),TR=n(252538),bR=n(86881),wR=n(149785);function xR(e,t,n,i,o,r,s){const a=yo.A.numberOfPoints(e,t,o);let c;const l=n.red,d=n.green,h=n.blue,A=n.alpha,p=i.red,f=i.green,m=i.blue,g=i.alpha;if(u.A.equals(n,i)){for(c=0;c<a;c++)r[s++]=u.A.floatToByte(l),r[s++]=u.A.floatToByte(d),r[s++]=u.A.floatToByte(h),r[s++]=u.A.floatToByte(A);return s}const _=(p-l)/a,y=(f-d)/a,v=(m-h)/a,T=(g-A)/a;let b=s;for(c=0;c<a;c++)r[b++]=u.A.floatToByte(l+c*_),r[b++]=u.A.floatToByte(d+c*y),r[b++]=u.A.floatToByte(h+c*v),r[b++]=u.A.floatToByte(A+c*T);return b}function CR(e){const t=(e=e??S.A.EMPTY_OBJECT).positions,n=e.colors,i=e.colorsPerVertex??!1;if(!(0,d.A)(t)||t.length<2)throw new A.A("At least two positions are required.");if((0,d.A)(n)&&(i&&n.length<t.length||!i&&n.length<t.length-1))throw new A.A("colors has an invalid length.");this._positions=t,this._colors=n,this._colorsPerVertex=i,this._arcType=e.arcType??zs.A.GEODESIC,this._granularity=e.granularity??J.A.RADIANS_PER_DEGREE,this._ellipsoid=e.ellipsoid??K.A.default,this._workerName="createSimplePolylineGeometry";let o=1+t.length*j.A.packedLength;o+=(0,d.A)(n)?1+n.length*u.A.packedLength:1,this.packedLength=o+K.A.packedLength+3}CR.pack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("value is required");if(!(0,d.A)(t))throw new A.A("array is required");let i;n=n??0;const o=e._positions;let r=o.length;for(t[n++]=r,i=0;i<r;++i,n+=j.A.packedLength)j.A.pack(o[i],t,n);const s=e._colors;for(r=(0,d.A)(s)?s.length:0,t[n++]=r,i=0;i<r;++i,n+=u.A.packedLength)u.A.pack(s[i],t,n);return K.A.pack(e._ellipsoid,t,n),n+=K.A.packedLength,t[n++]=e._colorsPerVertex?1:0,t[n++]=e._arcType,t[n]=e._granularity,t},CR.unpack=function(e,t,n){if(!(0,d.A)(e))throw new A.A("array is required");let i;t=t??0;let o=e[t++];const r=new Array(o);for(i=0;i<o;++i,t+=j.A.packedLength)r[i]=j.A.unpack(e,t);o=e[t++];const s=o>0?new Array(o):void 0;for(i=0;i<o;++i,t+=u.A.packedLength)s[i]=u.A.unpack(e,t);const a=K.A.unpack(e,t);t+=K.A.packedLength;const c=1===e[t++],l=e[t++],h=e[t];return(0,d.A)(n)?(n._positions=r,n._colors=s,n._ellipsoid=a,n._colorsPerVertex=c,n._arcType=l,n._granularity=h,n):new CR({positions:r,colors:s,ellipsoid:a,colorsPerVertex:c,arcType:l,granularity:h})};const ER=new Array(2),SR=new Array(2),IR={positions:ER,height:SR,ellipsoid:void 0,minDistance:void 0,granularity:void 0};CR.createGeometry=function(e){const t=e._positions,n=e._colors,i=e._colorsPerVertex,o=e._arcType,r=e._granularity,s=e._ellipsoid,a=J.A.chordLength(r,s.maximumRadius),c=(0,d.A)(n)&&!i;let l;const h=t.length;let A,f,m,g,_=0;if(o===zs.A.GEODESIC||o===zs.A.RHUMB){let e,i,p;o===zs.A.GEODESIC?(e=J.A.chordLength(r,s.maximumRadius),i=yo.A.numberOfPoints,p=yo.A.generateArc):(e=r,i=yo.A.numberOfPointsRhumbLine,p=yo.A.generateRhumbArc);const f=yo.A.extractHeights(t,s),y=IR;if(o===zs.A.GEODESIC?y.minDistance=a:y.granularity=r,y.ellipsoid=s,c){let o=0;for(l=0;l<h-1;l++)o+=i(t[l],t[l+1],e)+1;A=new Float64Array(3*o),m=new Uint8Array(4*o),y.positions=ER,y.height=SR;let r=0;for(l=0;l<h-1;++l){ER[0]=t[l],ER[1]=t[l+1],SR[0]=f[l],SR[1]=f[l+1];const e=p(y);if((0,d.A)(n)){const t=e.length/3;g=n[l];for(let e=0;e<t;++e)m[r++]=u.A.floatToByte(g.red),m[r++]=u.A.floatToByte(g.green),m[r++]=u.A.floatToByte(g.blue),m[r++]=u.A.floatToByte(g.alpha)}A.set(e,_),_+=e.length}}else if(y.positions=t,y.height=f,A=new Float64Array(p(y)),(0,d.A)(n)){for(m=new Uint8Array(A.length/3*4),l=0;l<h-1;++l)_=xR(t[l],t[l+1],n[l],n[l+1],a,m,_);const e=n[h-1];m[_++]=u.A.floatToByte(e.red),m[_++]=u.A.floatToByte(e.green),m[_++]=u.A.floatToByte(e.blue),m[_++]=u.A.floatToByte(e.alpha)}}else{f=c?2*h-2:h,A=new Float64Array(3*f),m=(0,d.A)(n)?new Uint8Array(4*f):void 0;let e=0,i=0;for(l=0;l<h;++l){const o=t[l];if(c&&l>0&&(j.A.pack(o,A,e),e+=3,g=n[l-1],m[i++]=u.A.floatToByte(g.red),m[i++]=u.A.floatToByte(g.green),m[i++]=u.A.floatToByte(g.blue),m[i++]=u.A.floatToByte(g.alpha)),c&&l===h-1)break;j.A.pack(o,A,e),e+=3,(0,d.A)(n)&&(g=n[l],m[i++]=u.A.floatToByte(g.red),m[i++]=u.A.floatToByte(g.green),m[i++]=u.A.floatToByte(g.blue),m[i++]=u.A.floatToByte(g.alpha))}}const y=new Ir.A;y.position=new P.A({componentDatatype:C.A.DOUBLE,componentsPerAttribute:3,values:A}),(0,d.A)(n)&&(y.color=new P.A({componentDatatype:C.A.UNSIGNED_BYTE,componentsPerAttribute:4,values:m,normalize:!0})),f=A.length/3;const v=2*(f-1),T=Pr.A.createTypedArray(f,v);let b=0;for(l=0;l<f-1;++l)T[b++]=l,T[b++]=l+1;return new I.A({attributes:y,indices:T,primitiveType:p.A.LINES,boundingSphere:Sn.A.fromPoints(t)})};const PR=CR;function DR(e){const t=e.radius??1,n={radii:new j.A(t,t,t),stackPartitions:e.stackPartitions,slicePartitions:e.slicePartitions,vertexFormat:e.vertexFormat};this._ellipsoidGeometry=new Pu(n),this._workerName="createSphereGeometry"}DR.packedLength=Pu.packedLength,DR.pack=function(e,t,n){return l.A.typeOf.object("value",e),Pu.pack(e._ellipsoidGeometry,t,n)};const OR=new Pu,RR={radius:void 0,radii:new j.A,vertexFormat:new Rr.A,stackPartitions:void 0,slicePartitions:void 0};DR.unpack=function(e,t,n){const i=Pu.unpack(e,t,OR);return RR.vertexFormat=Rr.A.clone(i._vertexFormat,RR.vertexFormat),RR.stackPartitions=i._stackPartitions,RR.slicePartitions=i._slicePartitions,(0,d.A)(n)?(j.A.clone(i._radii,RR.radii),n._ellipsoidGeometry=new Pu(RR),n):(RR.radius=i._radii.x,new DR(RR))},DR.createGeometry=function(e){return Pu.createGeometry(e._ellipsoidGeometry)};const MR=DR;var LR=n(6874),NR=n(587841),BR=n(465159),FR=n(66415),UR=n(878626);const kR={WEST:0,NORTH:1,EAST:2,SOUTH:3,NORTHWEST:4,NORTHEAST:5,SOUTHWEST:6,SOUTHEAST:7};function VR(e){throw new A.A("This type should not be instantiated directly.  Instead, use WebMercatorTilingScheme or GeographicTilingScheme.")}Object.defineProperties(VR.prototype,{ellipsoid:{get:A.A.throwInstantiationError},rectangle:{get:A.A.throwInstantiationError},projection:{get:A.A.throwInstantiationError}}),VR.prototype.getNumberOfXTilesAtLevel=A.A.throwInstantiationError,VR.prototype.getNumberOfYTilesAtLevel=A.A.throwInstantiationError,VR.prototype.rectangleToNativeRectangle=A.A.throwInstantiationError,VR.prototype.tileXYToNativeRectangle=A.A.throwInstantiationError,VR.prototype.tileXYToRectangle=A.A.throwInstantiationError,VR.prototype.positionToTileXY=A.A.throwInstantiationError;const zR=VR;var HR=n(343899),GR=n(884842),WR=n(710551),YR=n(78170),qR=n(85935);function jR(e,t){this.rectangle=e,this.maxLevel=t}function QR(e){this.ellipsoid=e.ellipsoid??K.A.default,this.tilingScheme=void 0,this.heightmapWidth=void 0,this.heightmapHeight=void 0,this.levelZeroMaximumGeometricError=void 0,this.rectangles=[]}function XR(e){e=e??S.A.EMPTY_OBJECT,this._errorEvent=new Bn.A,this._terrainDataStructure={heightScale:.001,heightOffset:-1e3,elementsPerHeight:3,stride:4,elementMultiplier:256,isBigEndian:!0,lowestEncodedHeight:0,highestEncodedHeight:16777215};let t=e.credit;"string"==typeof t&&(t=new Ws.A(t)),this._credit=t,this._tilingScheme=void 0,this._rectangles=[]}QR.prototype.build=function(e){e._tilingScheme=this.tilingScheme,e._heightmapWidth=this.heightmapWidth,e._heightmapHeight=this.heightmapHeight,e._levelZeroMaximumGeometricError=this.levelZeroMaximumGeometricError,e._rectangles=this.rectangles},Object.defineProperties(XR.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}}),XR.fromUrl=async function(e,t){l.A.defined("url",e);const n=new QR(t=t??S.A.EMPTY_OBJECT),i=Lt.A.createIfNeeded(e);await async function(e,t,n){try{!function(e,t){const n=t.getElementsByTagName("SRS")[0].textContent;if("EPSG:4326"!==n)throw new M.A(`SRS ${n} is not supported`);e.tilingScheme=new eI.A({ellipsoid:e.ellipsoid});const i=t.getElementsByTagName("TileFormat")[0];e.heightmapWidth=parseInt(i.getAttribute("width"),10),e.heightmapHeight=parseInt(i.getAttribute("height"),10),e.levelZeroMaximumGeometricError=sI.A.getEstimatedLevelZeroGeometricErrorForAHeightmap(e.ellipsoid,Math.min(e.heightmapWidth,e.heightmapHeight),e.tilingScheme.getNumberOfXTilesAtLevel(0));const o=t.getElementsByTagName("DataExtent");for(let t=0;t<o.length;++t){const n=o[t],i=J.A.toRadians(parseFloat(n.getAttribute("minx"))),r=J.A.toRadians(parseFloat(n.getAttribute("miny"))),s=J.A.toRadians(parseFloat(n.getAttribute("maxx"))),a=J.A.toRadians(parseFloat(n.getAttribute("maxy"))),c=parseInt(n.getAttribute("maxlevel"),10);e.rectangles.push(new jR(new Or.A(i,r,s,a),c))}}(e,await t.fetchXML())}catch(e){!function(e,t,n){let i=`An error occurred while accessing ${e.url}`;throw(0,d.A)(t)&&(0,d.A)(t.message)&&(i=`${i}: ${t.message}`),cI.A.reportError(void 0,n,(0,d.A)(n)?n._errorEvent:void 0,i),new M.A(i)}(t,e,n)}}(n,i);const o=new XR(t);return n.build(o),o._resource=i,o},XR.prototype.requestTileGeometry=function(e,t,n,i){const o=this._tilingScheme.getNumberOfYTilesAtLevel(n),r=this._resource.getDerivedResource({url:`${n}/${e}/${o-t-1}.tif`,queryParameters:{cesium:!0},request:i}).fetchImage({preferImageBitmap:!0});if(!(0,d.A)(r))return;const s=this;return Promise.resolve(r).then(function(i){return new nI.A({buffer:(0,qR.A)(i),width:s._heightmapWidth,height:s._heightmapHeight,childTileMask:$R(s,e,t,n),structure:s._terrainDataStructure})})},XR.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};const KR=new Or.A;function $R(e,t,n,i){const o=e._tilingScheme,r=e._rectangles,s=o.tileXYToRectangle(t,n,i);let a=0;for(let e=0;e<r.length&&15!==a;++e){const c=r[e];if(c.maxLevel<=i)continue;const l=c.rectangle,u=Or.A.intersection(l,s,KR);(0,d.A)(u)&&(JR(o,l,2*t,2*n,i+1)&&(a|=4),JR(o,l,2*t+1,2*n,i+1)&&(a|=8),JR(o,l,2*t,2*n+1,i+1)&&(a|=1),JR(o,l,2*t+1,2*n+1,i+1)&&(a|=2))}return a}function JR(e,t,n,i,o){const r=e.tileXYToRectangle(n,i,o);return(0,d.A)(Or.A.intersection(r,t,KR))}XR.prototype.getTileDataAvailable=function(e,t,n){},XR.prototype.loadTileDataAvailability=function(e,t,n){};const ZR=XR;var eM=n(717339);function tM(e){e=e??S.A.EMPTY_OBJECT,this._clock=void 0,this._element=void 0,this._clockSubscription=void 0,this._seekFunction=void 0,this._lastPlaybackRate=void 0,this.clock=e.clock,this.element=e.element,this.epoch=e.epoch??Tn.A.MINIMUM_VALUE,this.tolerance=e.tolerance??1,this._seeking=!1,this._seekFunction=void 0,this._firstTickAfterSeek=!1}Object.defineProperties(tM.prototype,{clock:{get:function(){return this._clock},set:function(e){const t=this._clock;t!==e&&((0,d.A)(t)&&(this._clockSubscription(),this._clockSubscription=void 0),(0,d.A)(e)&&(this._clockSubscription=e.onTick.addEventListener(tM.prototype._onTick,this)),this._clock=e)}},element:{get:function(){return this._element},set:function(e){const t=this._element;var n;t!==e&&((0,d.A)(t)&&t.removeEventListener("seeked",this._seekFunction,!1),(0,d.A)(e)&&(this._seeking=!1,this._seekFunction=(n=this,function(){n._seeking=!1,n._firstTickAfterSeek=!0}),e.addEventListener("seeked",this._seekFunction,!1)),this._element=e,this._seeking=!1,this._firstTickAfterSeek=!1)}}}),tM.prototype.destroy=function(){return this.element=void 0,this.clock=void 0,(0,h.A)(this)},tM.prototype.isDestroyed=function(){return!1},tM.prototype._trySetPlaybackRate=function(e){if(this._lastPlaybackRate===e.multiplier)return;const t=this._element;try{t.playbackRate=e.multiplier}catch(e){t.playbackRate=0}this._lastPlaybackRate=e.multiplier},tM.prototype._onTick=function(e){const t=this._element;if(!(0,d.A)(t)||t.readyState<2)return;const n=t.paused,i=e.shouldAnimate;if(i===n&&(i?t.play():t.pause()),this._seeking||this._firstTickAfterSeek)return void(this._firstTickAfterSeek=!1);this._trySetPlaybackRate(e);const o=e.currentTime,r=this.epoch??Tn.A.MINIMUM_VALUE;let s=te.A.secondsDifference(o,r);const a=t.duration;let c;const l=t.currentTime;t.loop?(s%=a,s<0&&(s=a-s),c=s):c=s>a?a:s<0?0:s;const u=i?this.tolerance??1:.001;Math.abs(c-l)>u&&(this._seeking=!0,t.currentTime=c)};const nM=tM,iM=Object.freeze({VK_FORMAT_UNDEFINED:0,VK_FORMAT_R4G4_UNORM_PACK8:1,VK_FORMAT_R4G4B4A4_UNORM_PACK16:2,VK_FORMAT_B4G4R4A4_UNORM_PACK16:3,VK_FORMAT_R5G6B5_UNORM_PACK16:4,VK_FORMAT_B5G6R5_UNORM_PACK16:5,VK_FORMAT_R5G5B5A1_UNORM_PACK16:6,VK_FORMAT_B5G5R5A1_UNORM_PACK16:7,VK_FORMAT_A1R5G5B5_UNORM_PACK16:8,VK_FORMAT_R8_UNORM:9,VK_FORMAT_R8_SNORM:10,VK_FORMAT_R8_USCALED:11,VK_FORMAT_R8_SSCALED:12,VK_FORMAT_R8_UINT:13,VK_FORMAT_R8_SINT:14,VK_FORMAT_R8_SRGB:15,VK_FORMAT_R8G8_UNORM:16,VK_FORMAT_R8G8_SNORM:17,VK_FORMAT_R8G8_USCALED:18,VK_FORMAT_R8G8_SSCALED:19,VK_FORMAT_R8G8_UINT:20,VK_FORMAT_R8G8_SINT:21,VK_FORMAT_R8G8_SRGB:22,VK_FORMAT_R8G8B8_UNORM:23,VK_FORMAT_R8G8B8_SNORM:24,VK_FORMAT_R8G8B8_USCALED:25,VK_FORMAT_R8G8B8_SSCALED:26,VK_FORMAT_R8G8B8_UINT:27,VK_FORMAT_R8G8B8_SINT:28,VK_FORMAT_R8G8B8_SRGB:29,VK_FORMAT_B8G8R8_UNORM:30,VK_FORMAT_B8G8R8_SNORM:31,VK_FORMAT_B8G8R8_USCALED:32,VK_FORMAT_B8G8R8_SSCALED:33,VK_FORMAT_B8G8R8_UINT:34,VK_FORMAT_B8G8R8_SINT:35,VK_FORMAT_B8G8R8_SRGB:36,VK_FORMAT_R8G8B8A8_UNORM:37,VK_FORMAT_R8G8B8A8_SNORM:38,VK_FORMAT_R8G8B8A8_USCALED:39,VK_FORMAT_R8G8B8A8_SSCALED:40,VK_FORMAT_R8G8B8A8_UINT:41,VK_FORMAT_R8G8B8A8_SINT:42,VK_FORMAT_R8G8B8A8_SRGB:43,VK_FORMAT_B8G8R8A8_UNORM:44,VK_FORMAT_B8G8R8A8_SNORM:45,VK_FORMAT_B8G8R8A8_USCALED:46,VK_FORMAT_B8G8R8A8_SSCALED:47,VK_FORMAT_B8G8R8A8_UINT:48,VK_FORMAT_B8G8R8A8_SINT:49,VK_FORMAT_B8G8R8A8_SRGB:50,VK_FORMAT_A8B8G8R8_UNORM_PACK32:51,VK_FORMAT_A8B8G8R8_SNORM_PACK32:52,VK_FORMAT_A8B8G8R8_USCALED_PACK32:53,VK_FORMAT_A8B8G8R8_SSCALED_PACK32:54,VK_FORMAT_A8B8G8R8_UINT_PACK32:55,VK_FORMAT_A8B8G8R8_SINT_PACK32:56,VK_FORMAT_A8B8G8R8_SRGB_PACK32:57,VK_FORMAT_A2R10G10B10_UNORM_PACK32:58,VK_FORMAT_A2R10G10B10_SNORM_PACK32:59,VK_FORMAT_A2R10G10B10_USCALED_PACK32:60,VK_FORMAT_A2R10G10B10_SSCALED_PACK32:61,VK_FORMAT_A2R10G10B10_UINT_PACK32:62,VK_FORMAT_A2R10G10B10_SINT_PACK32:63,VK_FORMAT_A2B10G10R10_UNORM_PACK32:64,VK_FORMAT_A2B10G10R10_SNORM_PACK32:65,VK_FORMAT_A2B10G10R10_USCALED_PACK32:66,VK_FORMAT_A2B10G10R10_SSCALED_PACK32:67,VK_FORMAT_A2B10G10R10_UINT_PACK32:68,VK_FORMAT_A2B10G10R10_SINT_PACK32:69,VK_FORMAT_R16_UNORM:70,VK_FORMAT_R16_SNORM:71,VK_FORMAT_R16_USCALED:72,VK_FORMAT_R16_SSCALED:73,VK_FORMAT_R16_UINT:74,VK_FORMAT_R16_SINT:75,VK_FORMAT_R16_SFLOAT:76,VK_FORMAT_R16G16_UNORM:77,VK_FORMAT_R16G16_SNORM:78,VK_FORMAT_R16G16_USCALED:79,VK_FORMAT_R16G16_SSCALED:80,VK_FORMAT_R16G16_UINT:81,VK_FORMAT_R16G16_SINT:82,VK_FORMAT_R16G16_SFLOAT:83,VK_FORMAT_R16G16B16_UNORM:84,VK_FORMAT_R16G16B16_SNORM:85,VK_FORMAT_R16G16B16_USCALED:86,VK_FORMAT_R16G16B16_SSCALED:87,VK_FORMAT_R16G16B16_UINT:88,VK_FORMAT_R16G16B16_SINT:89,VK_FORMAT_R16G16B16_SFLOAT:90,VK_FORMAT_R16G16B16A16_UNORM:91,VK_FORMAT_R16G16B16A16_SNORM:92,VK_FORMAT_R16G16B16A16_USCALED:93,VK_FORMAT_R16G16B16A16_SSCALED:94,VK_FORMAT_R16G16B16A16_UINT:95,VK_FORMAT_R16G16B16A16_SINT:96,VK_FORMAT_R16G16B16A16_SFLOAT:97,VK_FORMAT_R32_UINT:98,VK_FORMAT_R32_SINT:99,VK_FORMAT_R32_SFLOAT:100,VK_FORMAT_R32G32_UINT:101,VK_FORMAT_R32G32_SINT:102,VK_FORMAT_R32G32_SFLOAT:103,VK_FORMAT_R32G32B32_UINT:104,VK_FORMAT_R32G32B32_SINT:105,VK_FORMAT_R32G32B32_SFLOAT:106,VK_FORMAT_R32G32B32A32_UINT:107,VK_FORMAT_R32G32B32A32_SINT:108,VK_FORMAT_R32G32B32A32_SFLOAT:109,VK_FORMAT_R64_UINT:110,VK_FORMAT_R64_SINT:111,VK_FORMAT_R64_SFLOAT:112,VK_FORMAT_R64G64_UINT:113,VK_FORMAT_R64G64_SINT:114,VK_FORMAT_R64G64_SFLOAT:115,VK_FORMAT_R64G64B64_UINT:116,VK_FORMAT_R64G64B64_SINT:117,VK_FORMAT_R64G64B64_SFLOAT:118,VK_FORMAT_R64G64B64A64_UINT:119,VK_FORMAT_R64G64B64A64_SINT:120,VK_FORMAT_R64G64B64A64_SFLOAT:121,VK_FORMAT_B10G11R11_UFLOAT_PACK32:122,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:123,VK_FORMAT_D16_UNORM:124,VK_FORMAT_X8_D24_UNORM_PACK32:125,VK_FORMAT_D32_SFLOAT:126,VK_FORMAT_S8_UINT:127,VK_FORMAT_D16_UNORM_S8_UINT:128,VK_FORMAT_D24_UNORM_S8_UINT:129,VK_FORMAT_D32_SFLOAT_S8_UINT:130,VK_FORMAT_BC1_RGB_UNORM_BLOCK:131,VK_FORMAT_BC1_RGB_SRGB_BLOCK:132,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:133,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:134,VK_FORMAT_BC2_UNORM_BLOCK:135,VK_FORMAT_BC2_SRGB_BLOCK:136,VK_FORMAT_BC3_UNORM_BLOCK:137,VK_FORMAT_BC3_SRGB_BLOCK:138,VK_FORMAT_BC4_UNORM_BLOCK:139,VK_FORMAT_BC4_SNORM_BLOCK:140,VK_FORMAT_BC5_UNORM_BLOCK:141,VK_FORMAT_BC5_SNORM_BLOCK:142,VK_FORMAT_BC6H_UFLOAT_BLOCK:143,VK_FORMAT_BC6H_SFLOAT_BLOCK:144,VK_FORMAT_BC7_UNORM_BLOCK:145,VK_FORMAT_BC7_SRGB_BLOCK:146,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:147,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:148,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:149,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:150,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:151,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:152,VK_FORMAT_EAC_R11_UNORM_BLOCK:153,VK_FORMAT_EAC_R11_SNORM_BLOCK:154,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:155,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:156,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:157,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:158,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:159,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:160,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:161,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:162,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:163,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:164,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:165,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:166,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:167,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:168,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:169,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:170,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:171,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:172,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:173,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:174,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:175,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:176,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:177,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:178,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:179,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:180,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:181,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:182,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:183,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:184,VK_FORMAT_G8B8G8R8_422_UNORM:1000156e3,VK_FORMAT_B8G8R8G8_422_UNORM:1000156001,VK_FORMAT_G8_B8_R8_3PLANE_420_UNORM:1000156002,VK_FORMAT_G8_B8R8_2PLANE_420_UNORM:1000156003,VK_FORMAT_G8_B8_R8_3PLANE_422_UNORM:1000156004,VK_FORMAT_G8_B8R8_2PLANE_422_UNORM:1000156005,VK_FORMAT_G8_B8_R8_3PLANE_444_UNORM:1000156006,VK_FORMAT_R10X6_UNORM_PACK16:1000156007,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:1000156008,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:1000156009,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:1000156010,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:1000156011,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_420_UNORM_3PACK16:1000156012,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_420_UNORM_3PACK16:1000156013,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_422_UNORM_3PACK16:1000156014,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_422_UNORM_3PACK16:1000156015,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_444_UNORM_3PACK16:1000156016,VK_FORMAT_R12X4_UNORM_PACK16:1000156017,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:1000156018,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:1000156019,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:1000156020,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:1000156021,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_420_UNORM_3PACK16:1000156022,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_420_UNORM_3PACK16:1000156023,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_422_UNORM_3PACK16:1000156024,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_422_UNORM_3PACK16:1000156025,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_444_UNORM_3PACK16:1000156026,VK_FORMAT_G16B16G16R16_422_UNORM:1000156027,VK_FORMAT_B16G16R16G16_422_UNORM:1000156028,VK_FORMAT_G16_B16_R16_3PLANE_420_UNORM:1000156029,VK_FORMAT_G16_B16R16_2PLANE_420_UNORM:1000156030,VK_FORMAT_G16_B16_R16_3PLANE_422_UNORM:1000156031,VK_FORMAT_G16_B16R16_2PLANE_422_UNORM:1000156032,VK_FORMAT_G16_B16_R16_3PLANE_444_UNORM:1000156033,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:1000054e3,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:1000054001,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:1000054002,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:1000054003,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:1000054004,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:1000054005,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:1000054006,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:1000054007,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:1000066e3,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:1000066001,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:1000066002,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:1000066003,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:1000066004,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:1000066005,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:1000066006,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:1000066007,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:1000066008,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:1000066009,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:1000066010,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:1000066011,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:1000066012,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:1000066013,VK_FORMAT_G8B8G8R8_422_UNORM_KHR:1000156e3,VK_FORMAT_B8G8R8G8_422_UNORM_KHR:1000156001,VK_FORMAT_G8_B8_R8_3PLANE_420_UNORM_KHR:1000156002,VK_FORMAT_G8_B8R8_2PLANE_420_UNORM_KHR:1000156003,VK_FORMAT_G8_B8_R8_3PLANE_422_UNORM_KHR:1000156004,VK_FORMAT_G8_B8R8_2PLANE_422_UNORM_KHR:1000156005,VK_FORMAT_G8_B8_R8_3PLANE_444_UNORM_KHR:1000156006,VK_FORMAT_R10X6_UNORM_PACK16_KHR:1000156007,VK_FORMAT_R10X6G10X6_UNORM_2PACK16_KHR:1000156008,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16_KHR:1000156009,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16_KHR:1000156010,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16_KHR:1000156011,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_420_UNORM_3PACK16_KHR:1000156012,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_420_UNORM_3PACK16_KHR:1000156013,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_422_UNORM_3PACK16_KHR:1000156014,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_422_UNORM_3PACK16_KHR:1000156015,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_444_UNORM_3PACK16_KHR:1000156016,VK_FORMAT_R12X4_UNORM_PACK16_KHR:1000156017,VK_FORMAT_R12X4G12X4_UNORM_2PACK16_KHR:1000156018,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16_KHR:1000156019,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16_KHR:1000156020,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16_KHR:1000156021,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_420_UNORM_3PACK16_KHR:1000156022,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_420_UNORM_3PACK16_KHR:1000156023,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_422_UNORM_3PACK16_KHR:1000156024,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_422_UNORM_3PACK16_KHR:1000156025,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_444_UNORM_3PACK16_KHR:1000156026,VK_FORMAT_G16B16G16R16_422_UNORM_KHR:1000156027,VK_FORMAT_B16G16R16G16_422_UNORM_KHR:1000156028,VK_FORMAT_G16_B16_R16_3PLANE_420_UNORM_KHR:1000156029,VK_FORMAT_G16_B16R16_2PLANE_420_UNORM_KHR:1000156030,VK_FORMAT_G16_B16_R16_3PLANE_422_UNORM_KHR:1000156031,VK_FORMAT_G16_B16R16_2PLANE_422_UNORM_KHR:1000156032,VK_FORMAT_G16_B16_R16_3PLANE_444_UNORM_KHR:1000156033});var oM=n(414305),rM=n(635692),sM=n(702247),aM=n(785933),cM=n(744436),lM=n(394290),uM=n(75584);function dM(e,t){if(dM.passThroughDataForTesting)return t;l.A.typeOf.object("key",e),l.A.typeOf.object("data",t);const n=e.byteLength;if(0===n||n%4!=0)throw new M.A("The length of key must be greater than 0 and a multiple of 4.");const i=new DataView(t),o=i.getUint32(0,!0);if(1953029805===o||2917034100===o)return t;const r=new DataView(e);let s=0;const a=t.byteLength,c=a-a%8,u=n;let d,h=8;for(;s<c;)for(h=(h+8)%24,d=h;s<c&&d<u;)i.setUint32(s,i.getUint32(s,!0)^r.getUint32(d,!0),!0),i.setUint32(s+4,i.getUint32(s+4,!0)^r.getUint32(d+4,!0),!0),s+=8,d+=24;if(s<a)for(d>=u&&(h=(h+8)%24,d=h);s<a;)i.setUint8(s,i.getUint8(s)^r.getUint8(d)),s++,d++}dM.passThroughDataForTesting=!1;const hM=dM;var AM=n(223460),pM=n(419061),fM=n(786101),mM=n(522216),gM=n(712066),_M=n(592594);const yM=function(e,t,n){const i=new Uint8ClampedArray(e.buffer),o=new ImageData(i,t,n),r=document.createElement("canvas");return r.width=t,r.height=n,r.getContext("2d").putImageData(o,0,0),r};var vM=n(604752),TM=n(452684),bM=n(241839),wM=n(881096),xM=n(89104),CM=n(647885),EM=n(404547);const SM=[],IM=[];function PM(e,t,n,i,o){if(i>=o)return;const r=Math.floor(.5*(i+o));PM(e,t,n,i,r),PM(e,t,n,r+1,o),function(e,t,n,i,o,r){const s=o-i+1,a=r-o,c=SM,l=IM;let u,d;for(u=0;u<s;++u)c[u]=e[i+u];for(d=0;d<a;++d)l[d]=e[o+d+1];u=0,d=0;for(let o=i;o<=r;++o){const i=c[u],r=l[d];u<s&&(d>=a||t(i,r,n)<=0)?(e[o]=i,++u):d<a&&(e[o]=r,++d)}}(e,t,n,i,r,o)}const DM=function(e,t,n){if(!(0,d.A)(e))throw new A.A("array is required.");if(!(0,d.A)(t))throw new A.A("comparator is required.");const i=e.length,o=Math.ceil(.5*i);SM.length=o,IM.length=o,PM(e,t,n,0,i-1),SM.length=0,IM.length=0};var OM=n(359897);const RM=new j.A,MM=function(e,t,n,i){const o=(0,cM.A)(e,t,n,i,RM);return!!(0,d.A)(o)&&o.x>0&&o.y>0&&o.z>0};var LM=n(271868),NM=n(252544),BM=n(448871),FM=n(761203);const UM=function(e){return l.A.defined("value",e),e<=.04045?.07739938080495357*e:Math.pow(.9478672985781991*(e+.055),2.4)};var kM=n(841387);const VM=function(e){switch(e){case L.A.FLOAT:return"float";case L.A.FLOAT_VEC2:return"vec2";case L.A.FLOAT_VEC3:return"vec3";case L.A.FLOAT_VEC4:return"vec4";case L.A.FLOAT_MAT2:return"mat2";case L.A.FLOAT_MAT3:return"mat3";case L.A.FLOAT_MAT4:return"mat4";case L.A.SAMPLER_2D:return"sampler2D";case L.A.BOOL:return"bool"}},zM=function(e,t,n){if("function"!=typeof t)throw new A.A("oldFunction is required to be a function.");if("function"!=typeof n)throw new A.A("oldFunction is required to be a function.");return function(){n.apply(e,arguments),t.apply(e,arguments)}};var HM=n(517638);async function GM(e,t){const n=t.terrainProvider,i=t.mapProjection,o=i.ellipsoid;let r;const s=t.camera.getRectangleCameraCoordinates(e);if(r=t.mode===Ce.A.SCENE3D?o.cartesianToCartographic(s):i.unproject(s),!(0,d.A)(n))return r;const a=n.availability;if(!(0,d.A)(a)||t.mode===Ce.A.SCENE2D)return r;const c=[Or.A.center(e),Or.A.southeast(e),Or.A.southwest(e),Or.A.northeast(e),Or.A.northwest(e)],l=await GM._sampleTerrainMostDetailed(n,c);let u=!1;const h=l.reduce(function(e,t){return(0,d.A)(t.height)?(u=!0,Math.max(t.height,e)):e},-Number.MAX_VALUE),A=r;return u&&(A.height+=h),A}GM._sampleTerrainMostDetailed=BM.A;const WM=GM;var YM=n(711284);const qM=new q.A,jM=function(e,t){l.A.typeOf.object("clippingPlaneCollection",e),l.A.typeOf.object("context",t);const n=e.unionClippingRegions,i=e.length,o=YM.A.useFloatTexture(t),r=YM.A.getTextureResolution(e,t,qM),s=r.x,a=r.y;let c=o?function(e,t){const n=1/t;let i=`${1/e}`;-1===i.indexOf(".")&&(i+=".0");let o=`${n}`;-1===o.indexOf(".")&&(o+=".0");return`vec4 getClippingPlane(highp sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)\n{\n    int pixY = clippingPlaneNumber / ${e};\n    int pixX = clippingPlaneNumber - (pixY * ${e});\n    float u = (float(pixX) + 0.5) * ${i};\n    float v = (float(pixY) + 0.5) * ${o};\n    vec4 plane = texture(packedClippingPlanes, vec2(u, v));\n    return czm_transformPlane(plane, transform);\n}\n`}(s,a):function(e,t){const n=1/t;let i=`${1/e}`;-1===i.indexOf(".")&&(i+=".0");let o=`${n}`;-1===o.indexOf(".")&&(o+=".0");return`vec4 getClippingPlane(highp sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)\n{\n    int clippingPlaneStartIndex = clippingPlaneNumber * 2;\n    int pixY = clippingPlaneStartIndex / ${e};\n    int pixX = clippingPlaneStartIndex - (pixY * ${e});\n    float u = (float(pixX) + 0.5) * ${i};\n    float v = (float(pixY) + 0.5) * ${o};\n    vec4 oct32 = texture(packedClippingPlanes, vec2(u, v)) * 255.0;\n    vec2 oct = vec2(oct32.x * 256.0 + oct32.y, oct32.z * 256.0 + oct32.w);\n    vec4 plane;\n    plane.xyz = czm_octDecode(oct, 65535.0);\n    plane.w = czm_unpackFloat(texture(packedClippingPlanes, vec2(u + ${i}, v)));\n    return czm_transformPlane(plane, transform);\n}\n`}(s,a);return c+="\n",c+=n?function(e){return`float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)\n{\n    vec4 position = czm_windowToEyeCoordinates(fragCoord);\n    vec3 clipNormal = vec3(0.0);\n    vec3 clipPosition = vec3(0.0);\n    float clipAmount;\n    float pixelWidth = czm_metersPerPixel(position);\n    bool breakAndDiscard = false;\n    for (int i = 0; i < ${e}; ++i)\n    {\n        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);\n        clipNormal = clippingPlane.xyz;\n        clipPosition = -clippingPlane.w * clipNormal;\n        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;\n        clipAmount = czm_branchFreeTernary(i == 0, amount, min(amount, clipAmount));\n        if (amount <= 0.0)\n        {\n           breakAndDiscard = true;\n           break;\n        }\n    }\n    if (breakAndDiscard) {\n        discard;\n    }\n    return clipAmount;\n}\n`}(i):function(e){return`float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)\n{\n    bool clipped = true;\n    vec4 position = czm_windowToEyeCoordinates(fragCoord);\n    vec3 clipNormal = vec3(0.0);\n    vec3 clipPosition = vec3(0.0);\n    float clipAmount = 0.0;\n    float pixelWidth = czm_metersPerPixel(position);\n    for (int i = 0; i < ${e}; ++i)\n    {\n        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);\n        clipNormal = clippingPlane.xyz;\n        clipPosition = -clippingPlane.w * clipNormal;\n        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;\n        clipAmount = max(amount, clipAmount);\n        clipped = clipped && (amount <= 0.0);\n    }\n    if (clipped)\n    {\n        discard;\n    }\n    return clipAmount;\n}\n`}(i),c};function QM(e,t,n,i,o,r){this.numberOfDayTextures=e,this.flags=t,this.material=n,this.shaderProgram=i,this.clippingShaderState=o,this.clippingPolygonShaderState=r}function XM(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this.material=void 0}XM.prototype.getShaderProgram=function(e){const t=e.frameState,n=e.surfaceTile,i=e.numberOfDayTextures,o=e.applyBrightness,r=e.applyContrast,s=e.applyHue,a=e.applySaturation,c=e.applyGamma,l=e.applyAlpha,u=e.applyDayNightAlpha,h=e.applySplit,A=e.hasWaterMask,p=e.showReflectiveOcean,f=e.showOceanWaves,m=e.enableLighting,g=e.dynamicAtmosphereLighting,_=e.dynamicAtmosphereLightingFromSun,v=e.showGroundAtmosphere,T=e.perFragmentGroundAtmosphere,b=e.hasVertexNormals,w=e.useWebMercatorProjection,x=e.enableFog,C=e.enableClippingPlanes,E=e.clippingPlanes,S=e.enableClippingPolygons,I=e.clippingPolygons,P=e.clippedByBoundaries,D=e.hasImageryLayerCutout,O=e.colorCorrect,R=e.highlightFillTile,M=e.colorToAlpha,L=e.hasGeodeticSurfaceNormals,N=e.hasExaggeration,B=e.showUndergroundColor,F=e.translucent;let U=0,k="";const V=n.renderedMesh.encoding;V.quantization===FR.A.BITS12&&(U=1,k="QUANTIZATION_BITS12");let z=0,H="";P&&(z=1,H="TILE_LIMIT_RECTANGLE");let G=0,W="";D&&(G=1,W="APPLY_IMAGERY_CUTOUT");const Y=t.mode,q=Y|o<<2|r<<3|s<<4|a<<5|c<<6|l<<7|A<<8|p<<9|f<<10|m<<11|g<<12|_<<13|v<<14|T<<15|b<<16|w<<17|x<<18|U<<19|h<<20|C<<21|S<<22|z<<23|G<<24|O<<25|R<<26|M<<27|L<<28|N<<29|B<<30|F<<31|u<<32;let j=0;(0,d.A)(E)&&E.length>0&&(j=C?E.clippingPlanesState:0);let Q=0;(0,d.A)(I)&&I.length>0&&(Q=S?I.clippingPolygonsState:0);let X=n.surfaceShader;if((0,d.A)(X)&&X.numberOfDayTextures===i&&X.flags===q&&X.material===this.material&&X.clippingShaderState===j&&X.clippingPolygonShaderState===Q)return X.shaderProgram;let K=this._shadersByTexturesFlags[i];if((0,d.A)(K)||(K=this._shadersByTexturesFlags[i]=[]),X=K[q],!(0,d.A)(X)||X.material!==this.material||X.clippingShaderState!==j||X.clippingPolygonShaderState!==Q){const e=this.baseVertexShaderSource.clone(),n=this.baseFragmentShaderSource.clone();0!==j&&n.sources.unshift(jM(E,t.context)),0!==Q&&(n.sources.unshift(t.context.webgl2?"void clipPolygons(highp sampler2D clippingDistance, int regionsLength, vec2 clippingPosition, int regionIndex) {\n    czm_clipPolygons(clippingDistance, regionsLength, clippingPosition, regionIndex);\n  }":"void clipPolygons(highp sampler2D clippingDistance, int regionsLength, vec2 clippingPosition, int regionIndex) {\n    }"),e.sources.unshift(t.context.webgl2?"vec4 unpackClippingExtents(highp sampler2D extentsTexture, int index) {\n    return czm_unpackClippingExtents(extentsTexture, index);\n  }":"vec4 unpackClippingExtents(highp sampler2D extentsTexture, int index) {\n      return vec4();\n    }")),e.defines.push(k),n.defines.push(`TEXTURE_UNITS ${i}`,H,W),o&&n.defines.push("APPLY_BRIGHTNESS"),r&&n.defines.push("APPLY_CONTRAST"),s&&n.defines.push("APPLY_HUE"),a&&n.defines.push("APPLY_SATURATION"),c&&n.defines.push("APPLY_GAMMA"),l&&n.defines.push("APPLY_ALPHA"),u&&n.defines.push("APPLY_DAY_NIGHT_ALPHA"),A&&n.defines.push("HAS_WATER_MASK"),p&&(n.defines.push("SHOW_REFLECTIVE_OCEAN"),e.defines.push("SHOW_REFLECTIVE_OCEAN")),f&&n.defines.push("SHOW_OCEAN_WAVES"),M&&n.defines.push("APPLY_COLOR_TO_ALPHA"),B&&(e.defines.push("UNDERGROUND_COLOR"),n.defines.push("UNDERGROUND_COLOR")),F&&(e.defines.push("TRANSLUCENT"),n.defines.push("TRANSLUCENT")),m&&(b?(e.defines.push("ENABLE_VERTEX_LIGHTING"),n.defines.push("ENABLE_VERTEX_LIGHTING")):(e.defines.push("ENABLE_DAYNIGHT_SHADING"),n.defines.push("ENABLE_DAYNIGHT_SHADING"))),g&&(e.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),n.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),_&&(e.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN"),n.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN"))),v&&(e.defines.push("GROUND_ATMOSPHERE"),n.defines.push("GROUND_ATMOSPHERE"),T&&(e.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE"),n.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE"))),e.defines.push("INCLUDE_WEB_MERCATOR_Y"),n.defines.push("INCLUDE_WEB_MERCATOR_Y"),x&&(e.defines.push("FOG"),n.defines.push("FOG")),h&&n.defines.push("APPLY_SPLIT"),C&&n.defines.push("ENABLE_CLIPPING_PLANES"),S&&(n.defines.push("ENABLE_CLIPPING_POLYGONS"),e.defines.push("ENABLE_CLIPPING_POLYGONS"),I.inverse&&n.defines.push("CLIPPING_INVERSE"),n.defines.push(`CLIPPING_POLYGON_REGIONS_LENGTH ${I.extentsCount}`),e.defines.push(`CLIPPING_POLYGON_REGIONS_LENGTH ${I.extentsCount}`)),O&&n.defines.push("COLOR_CORRECT"),R&&n.defines.push("HIGHLIGHT_FILL_TILE"),L&&e.defines.push("GEODETIC_SURFACE_NORMALS"),N&&e.defines.push("EXAGGERATION");let d="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend)\n    {\n        vec4 color = initialColor;\n";D&&(d+="        vec4 cutoutAndColorResult;\n        bool texelUnclipped;\n");for(let e=0;e<i;++e)d+=D?`        cutoutAndColorResult = u_dayTextureCutoutRectangles[${e}];\n        texelUnclipped = v_textureCoordinates.x < cutoutAndColorResult.x || cutoutAndColorResult.z < v_textureCoordinates.x || v_textureCoordinates.y < cutoutAndColorResult.y || cutoutAndColorResult.w < v_textureCoordinates.y;\n        cutoutAndColorResult = sampleAndBlend(\n`:"        color = sampleAndBlend(\n",d+=`            color,\n            u_dayTextures[${e}],\n            u_dayTextureUseWebMercatorT[${e}] ? textureCoordinates.xz : textureCoordinates.xy,\n            u_dayTextureTexCoordsRectangle[${e}],\n            u_dayTextureTranslationAndScale[${e}],\n            ${l?`u_dayTextureAlpha[${e}]`:"1.0"},\n            ${u?`u_dayTextureNightAlpha[${e}]`:"1.0"},\n            ${u?`u_dayTextureDayAlpha[${e}]`:"1.0"},\n            ${o?`u_dayTextureBrightness[${e}]`:"0.0"},\n            ${r?`u_dayTextureContrast[${e}]`:"0.0"},\n            ${s?`u_dayTextureHue[${e}]`:"0.0"},\n            ${a?`u_dayTextureSaturation[${e}]`:"0.0"},\n            ${c?`u_dayTextureOneOverGamma[${e}]`:"0.0"},\n            ${h?`u_dayTextureSplit[${e}]`:"0.0"},\n            ${M?`u_colorsToAlpha[${e}]`:"vec4(0.0)"},\n            nightBlend);\n`,D&&(d+="        color = czm_branchFreeTernary(texelUnclipped, cutoutAndColorResult, color);\n");d+="        return color;\n    }",n.sources.push(d),e.sources.push(function(e){let t;switch(e){case Ce.A.SCENE3D:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }";break;case Ce.A.SCENE2D:case Ce.A.COLUMBUS_VIEW:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }";break;case Ce.A.MORPHING:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }"}return t}(Y)),e.sources.push(function(e){return e?"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }":"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }"}(w));const P=y.A.fromCache({context:t.context,vertexShaderSource:e,fragmentShaderSource:n,attributeLocations:V.getAttributeLocations()});X=K[q]=new QM(i,q,this.material,P,j,Q)}return n.surfaceShader=X,X.shaderProgram},XM.prototype.destroy=function(){let e,t;const n=this._shadersByTexturesFlags;for(const i in n)if(n.hasOwnProperty(i)){const o=n[i];if(!(0,d.A)(o))continue;for(e in o)o.hasOwnProperty(e)&&(t=o[e],(0,d.A)(t)&&t.shaderProgram.destroy())}return(0,h.A)(this)};const KM=XM;var $M=n(200646),JM=n(348460),ZM=n(523721),eL=n(921243);const tL=Object.freeze({START:0,LOADING:1,DONE:2,FAILED:3}),nL=Object.freeze({FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6});function iL(){this.imagery=[],this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new Q.A(0,0,1,1),this.terrainData=void 0,this.vertexArray=void 0,this.tileBoundingRegion=void 0,this.occludeePointInScaledSpace=new j.A,this.boundingVolumeSourceTile=void 0,this.boundingVolumeIsFromMesh=!1,this.terrainState=nL.UNLOADED,this.mesh=void 0,this.fill=void 0,this.pickBoundingSphere=new Sn.A,this.surfaceShader=void 0,this.isClipped=!0,this.clippedByBoundaries=!1}Object.defineProperties(iL.prototype,{eligibleForUnloading:{get:function(){const e=this.terrainState;let t=!(e===nL.RECEIVING||e===nL.TRANSFORMING);const n=this.imagery;for(let e=0,i=n.length;t&&e<i;++e){const i=n[e];t=!(0,d.A)(i.loadingImagery)||i.loadingImagery.state!==eL.A.TRANSITIONING}return t}},renderedMesh:{get:function(){return(0,d.A)(this.vertexArray)?this.mesh:(0,d.A)(this.fill)?this.fill.mesh:void 0}}});const oL=new X.A;function rL(e,t,n,i,o,r){let s=e.getExaggeratedPosition(i,o,r);if((0,d.A)(t)&&t!==Ce.A.SCENE3D){const e=n.ellipsoid.cartesianToCartographic(s,oL);s=n.project(e,r),s=j.A.fromElements(s.z,s.x,s.y,r)}return s}const sL=new j.A,aL=new j.A,cL=new j.A;function lL(e,t,n,i){const o=e.renderedMesh,r=o.vertices,s=o.encoding,a=r.length/s.stride;let c=hD.A.clone(s);c.hasGeodeticSurfaceNormals=t,c=hD.A.clone(c);const l=c.stride,u=new Float32Array(a*l);t?s.addGeodeticSurfaceNormals(r,u,n):s.removeGeodeticSurfaceNormals(r,u),o.vertices=u,o.stride=l,o!==e.mesh?(iL._freeVertexArray(e.fill.vertexArray),e.fill.vertexArray=iL._createVertexArrayForMesh(i.context,o)):(iL._freeVertexArray(e.vertexArray),e.vertexArray=iL._createVertexArrayForMesh(i.context,o)),iL._freeVertexArray(e.wireframeVertexArray),e.wireframeVertexArray=void 0}iL.prototype.pick=function(e,t,n,i,o){const r=this.renderedMesh;if(!(0,d.A)(r))return;const s=r.vertices,a=r.indices,c=r.encoding,l=a.length;let u=Number.MAX_VALUE;for(let o=0;o<l;o+=3){const r=a[o],l=a[o+1],h=a[o+2],A=rL(c,t,n,s,r,sL),p=rL(c,t,n,s,l,aL),f=rL(c,t,n,s,h,cL),m=wO.A.rayTriangleParametric(e,A,p,f,i);(0,d.A)(m)&&m<u&&m>=0&&(u=m)}return u!==Number.MAX_VALUE?_R.A.getPoint(e,u,o):void 0},iL.prototype.freeResources=function(){(0,d.A)(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0),this.terrainData=void 0,this.terrainState=nL.UNLOADED,this.mesh=void 0,this.fill=this.fill&&this.fill.destroy();const e=this.imagery;for(let t=0,n=e.length;t<n;++t)e[t].freeResources();this.imagery.length=0,this.freeVertexArray()},iL.prototype.freeVertexArray=function(){iL._freeVertexArray(this.vertexArray),this.vertexArray=void 0,iL._freeVertexArray(this.wireframeVertexArray),this.wireframeVertexArray=void 0},iL.initialize=function(e,t,n){let i=e.data;(0,d.A)(i)||(i=e.data=new iL),e.state===tL.START&&(function(e,t,n){let i=t.getTileDataAvailable(e.x,e.y,e.level);if(!(0,d.A)(i)&&(0,d.A)(e.parent)){const t=e.parent,n=t.data;(0,d.A)(n)&&(0,d.A)(n.terrainData)&&(i=n.terrainData.isChildAvailable(t.x,t.y,e.x,e.y))}!1===i&&(e.data.terrainState=nL.FAILED);for(let i=0,o=n.length;i<o;++i){const o=n.get(i);o.show&&o._createTileImagerySkeletons(e,t)}}(e,t,n),e.state=tL.LOADING)},iL.processStateMachine=function(e,t,n,i,o,r,s){iL.initialize(e,n,i);const a=e.data;if(e.state===tL.LOADING&&function(e,t,n,i,o,r){const s=e.data,a=e.parent;if(s.terrainState===nL.FAILED&&void 0!==a&&(void 0!==a.data&&void 0!==a.data.terrainData&&!1!==a.data.terrainData.canUpsample||iL.processStateMachine(a,t,n,i,o,r,!0)),s.terrainState===nL.FAILED&&function(e,t,n,i,o,r,s){const a=t.parent;if(!a)return void(t.state=tL.FAILED);const c=a.data.terrainData,l=a.x,u=a.y,h=a.level;if(!(0,d.A)(c))return;const A=c.upsample(i.tilingScheme,l,u,h,o,r,s);(0,d.A)(A)&&(e.terrainState=nL.RECEIVING,Promise.resolve(A).then(function(t){(0,d.A)(t)&&(e.terrainData=t,e.terrainState=nL.RECEIVED)}).catch(function(){e.terrainState=nL.FAILED}))}(s,e,0,n,e.x,e.y,e.level),s.terrainState===nL.UNLOADED&&function(e,t,n,i,o){function r(){const s=new iI.A({throttle:!1,throttleByServer:!0,type:rI.A.TERRAIN});e.request=s;const a=t.requestTileGeometry(n,i,o,s);(0,d.A)(a)?(e.terrainState=nL.RECEIVING,Promise.resolve(a).then(function(t){!function(t){if(!(0,d.A)(t))return e.terrainState=nL.UNLOADED,void(e.request=void 0);e.terrainData=t,e.terrainState=nL.RECEIVED,e.request=void 0}(t)}).catch(function(s){!function(s){if(e.request.state===oI.A.CANCELLED)return e.terrainData=void 0,e.terrainState=nL.UNLOADED,void(e.request=void 0);e.terrainState=nL.FAILED,e.request=void 0;const a=`Failed to obtain terrain tile X: ${n} Y: ${i} Level: ${o}. Error message: "${s}"`;t._requestError=cI.A.reportError(t._requestError,t,t.errorEvent,a,n,i,o),t._requestError.retry&&r()}(s)})):(e.terrainState=nL.UNLOADED,e.request=void 0)}r()}(s,n,e.x,e.y,e.level),s.terrainState===nL.RECEIVED&&function(e,t,n,i,o,r){const s=n.tilingScheme,a=uL;a.tilingScheme=s,a.x=i,a.y=o,a.level=r,a.exaggeration=t.verticalExaggeration,a.exaggerationRelativeHeight=t.verticalExaggerationRelativeHeight,a.throttle=!0;const c=e.terrainData.createMesh(a);(0,d.A)(c)&&(e.terrainState=nL.TRANSFORMING,Promise.resolve(c).then(function(t){e.mesh=t,e.terrainState=nL.TRANSFORMED}).catch(function(){e.terrainState=nL.FAILED}))}(s,t,n,e.x,e.y,e.level),s.terrainState===nL.TRANSFORMED&&(function(e,t,n,i,o,r,s){e.vertexArray=iL._createVertexArrayForMesh(t,e.mesh),e.terrainState=nL.READY,e.fill=e.fill&&e.fill.destroy(s)}(s,t.context,0,e.x,e.y,e.level,r),s.updateExaggeration(e,t,o)),s.terrainState>=nL.RECEIVED&&void 0===s.waterMaskTexture&&n.hasWaterMask)if(void 0!==s.terrainData.waterMask)!function(e,t){const n=t.terrainData.waterMask,i=function(e){let t=e.cache.tile_waterMaskData;if(!(0,d.A)(t)){const n=G.A.create({context:e,pixelFormat:R.A.LUMINANCE,pixelDatatype:U.A.UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});n.referenceCount=1,t={allWaterTexture:n,sampler:new At.A({wrapS:It.A.CLAMP_TO_EDGE,wrapT:It.A.CLAMP_TO_EDGE,minificationFilter:bt.A.LINEAR,magnificationFilter:Tt.A.LINEAR}),destroy:function(){this.allWaterTexture.destroy()}},e.cache.tile_waterMaskData=t}return t}(e);let o;const r=n.length;if(1===r){if(0===n[0])return;o=i.allWaterTexture}else{const t=Math.sqrt(r);o=G.A.create({context:e,pixelFormat:R.A.LUMINANCE,pixelDatatype:U.A.UNSIGNED_BYTE,source:{width:t,height:t,arrayBufferView:n},sampler:i.sampler,flipY:!1}),o.referenceCount=0}++o.referenceCount,t.waterMaskTexture=o,Q.A.fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}(t.context,s);else{const t=s._findAncestorTileWithTerrainData(e);(0,d.A)(t)&&(0,d.A)(t.data.waterMaskTexture)&&(s.waterMaskTexture=t.data.waterMaskTexture,++s.waterMaskTexture.referenceCount,s._computeWaterMaskTranslationAndScale(e,t,s.waterMaskTranslationAndScale))}}(e,t,n,i,o,r),s)return;const c=e.renderable;e.renderable=(0,d.A)(a.vertexArray);const l=a.terrainState===nL.READY;e.upsampledFromParent=(0,d.A)(a.terrainData)&&a.terrainData.wasCreatedByUpsampling();const u=a.processImagery(e,n,t);if(l&&u){const t=e._loadedCallbacks,n={};for(const i in t)t.hasOwnProperty(i)&&(t[i](e)||(n[i]=t[i]));e._loadedCallbacks=n,e.state=tL.DONE}c&&(e.renderable=!0)},iL.prototype.processImagery=function(e,t,n,i){const o=e.data;let r=e.upsampledFromParent,s=!1,a=!0;const c=o.imagery;let l,u;for(l=0,u=c.length;l<u;++l){const o=c[l];if(!(0,d.A)(o.loadingImagery)){r=!1;continue}if(o.loadingImagery.state===eL.A.PLACEHOLDER){const n=o.loadingImagery.imageryLayer;if(n.ready){o.freeResources(),c.splice(l,1),n._createTileImagerySkeletons(e,t,l),--l,u=c.length;continue}r=!1}const h=o.processStateMachine(e,n,i);a=a&&h,s=s||h||(0,d.A)(o.readyImagery),r=r&&(0,d.A)(o.loadingImagery)&&(o.loadingImagery.state===eL.A.FAILED||o.loadingImagery.state===eL.A.INVALID)}return e.upsampledFromParent=r,e.renderable=e.renderable&&(s||a),a},iL.prototype.addGeodeticSurfaceNormals=function(e,t){lL(this,!0,e,t)},iL.prototype.removeGeodeticSurfaceNormals=function(e){lL(this,!1,void 0,e)},iL.prototype.updateExaggeration=function(e,t,n){const i=this,o=i.renderedMesh;if(void 0===o)return;const r=t.verticalExaggeration,s=t.verticalExaggerationRelativeHeight,a=1!==r,c=o.encoding,l=c.exaggeration!==r,u=c.exaggerationRelativeHeight!==s;if(l||u){if(l)if(a&&!c.hasGeodeticSurfaceNormals){const n=e.tilingScheme.ellipsoid;i.addGeodeticSurfaceNormals(n,t)}else!a&&c.hasGeodeticSurfaceNormals&&i.removeGeodeticSurfaceNormals(t);if(c.exaggeration=r,c.exaggerationRelativeHeight=s,void 0!==n){n._tileToUpdateHeights.push(e);const t=e.customData,i=t.length;for(let e=0;e<i;e++)t[e].level=-1}}};const uL={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0,throttle:!0};iL._createVertexArrayForMesh=function(e,t){const n=t.vertices,i=o.A.createVertexBuffer({context:e,typedArray:n,usage:r.A.STATIC_DRAW}),s=t.encoding.getAttributes(i),a=t.indices.indexBuffers||{};let c=a[e.id];if(!(0,d.A)(c)||c.isDestroyed()){const n=t.indices;c=o.A.createIndexBuffer({context:e,typedArray:n,usage:r.A.STATIC_DRAW,indexDatatype:Pr.A.fromSizeInBytes(n.BYTES_PER_ELEMENT)}),c.vertexArrayDestroyable=!1,c.referenceCount=1,a[e.id]=c,t.indices.indexBuffers=a}else++c.referenceCount;return new je.A({context:e,attributes:s,indexBuffer:c})},iL._freeVertexArray=function(e){if((0,d.A)(e)){const t=e.indexBuffer;e.isDestroyed()||e.destroy(),(0,d.A)(t)&&!t.isDestroyed()&&(0,d.A)(t.referenceCount)&&(--t.referenceCount,0===t.referenceCount&&t.destroy())}},iL.prototype._findAncestorTileWithTerrainData=function(e){let t=e.parent;for(;(0,d.A)(t)&&(!(0,d.A)(t.data)||!(0,d.A)(t.data.terrainData)||t.data.terrainData.wasCreatedByUpsampling());)t=t.parent;return t},iL.prototype._computeWaterMaskTranslationAndScale=function(e,t,n){const i=t.rectangle,o=e.rectangle,r=o.width,s=o.height,a=r/i.width,c=s/i.height;return n.x=a*(o.west-i.west)/r,n.y=c*(o.south-i.south)/s,n.z=a,n.w=c,n};const dL=iL;var hL=n(451227);const AL={NONE:0,CULLED:1,RENDERED:2,REFINED:3,RENDERED_AND_KICKED:6,REFINED_AND_KICKED:7,CULLED_BUT_NEEDED:9,wasKicked:function(e){return e>=AL.RENDERED_AND_KICKED},originalResult:function(e){return 3&e},kick:function(e){return 4|e}},pL=AL;function fL(e){this.tile=e,this.frameLastUpdated=void 0,this.westMeshes=[],this.westTiles=[],this.southMeshes=[],this.southTiles=[],this.eastMeshes=[],this.eastTiles=[],this.northMeshes=[],this.northTiles=[],this.southwestMesh=void 0,this.southwestTile=void 0,this.southeastMesh=void 0,this.southeastTile=void 0,this.northwestMesh=void 0,this.northwestTile=void 0,this.northeastMesh=void 0,this.northeastTile=void 0,this.changedThisFrame=!0,this.visitedFrame=void 0,this.enqueuedFrame=void 0,this.mesh=void 0,this.vertexArray=void 0,this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new Q.A}fL.prototype.update=function(e,t,n){this.changedThisFrame&&(NL(e,t,this.tile,n),this.changedThisFrame=!1)},fL.prototype.destroy=function(e){this._destroyVertexArray(e),(0,d.A)(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0)},fL.prototype._destroyVertexArray=function(e){(0,d.A)(this.vertexArray)&&((0,d.A)(e)?e.push(this.vertexArray):dL._freeVertexArray(this.vertexArray),this.vertexArray=void 0)};const mL=new gR.A;function gL(e,t,n,i,o,r,s,a,c){if(void 0===i)return;let l=i;for(;l&&(l._lastSelectionResultFrame!==o||pL.wasKicked(l._lastSelectionResult)||pL.originalResult(l._lastSelectionResult)===pL.CULLED);){if(s)return;const e=l.parent;if(r>=kR.NORTHWEST&&void 0!==e)switch(r){case kR.NORTHWEST:l=l===e.northwestChild?e:void 0;break;case kR.NORTHEAST:l=l===e.northeastChild?e:void 0;break;case kR.SOUTHWEST:l=l===e.southwestChild?e:void 0;break;case kR.SOUTHEAST:l=l===e.southeastChild?e:void 0}else l=e}if(void 0!==l)if(l._lastSelectionResult!==pL.RENDERED){if(pL.originalResult(i._lastSelectionResult)!==pL.CULLED)switch(r){case kR.WEST:gL(e,t,n,i.northwestChild,o,r,!0,a,c),gL(e,t,n,i.southwestChild,o,r,!0,a,c);break;case kR.EAST:gL(e,t,n,i.southeastChild,o,r,!0,a,c),gL(e,t,n,i.northeastChild,o,r,!0,a,c);break;case kR.SOUTH:gL(e,t,n,i.southwestChild,o,r,!0,a,c),gL(e,t,n,i.southeastChild,o,r,!0,a,c);break;case kR.NORTH:gL(e,t,n,i.northeastChild,o,r,!0,a,c),gL(e,t,n,i.northwestChild,o,r,!0,a,c);break;case kR.NORTHWEST:gL(e,t,n,i.northwestChild,o,r,!0,a,c);break;case kR.NORTHEAST:gL(e,t,n,i.northeastChild,o,r,!0,a,c);break;case kR.SOUTHWEST:gL(e,t,n,i.southwestChild,o,r,!0,a,c);break;case kR.SOUTHEAST:gL(e,t,n,i.southeastChild,o,r,!0,a,c);break;default:throw new A.A("Invalid edge")}}else{if((0,d.A)(l.data.vertexArray))return;!function(e,t,n,i,o,r,s,a){const c=i.data;if(void 0===c.fill)c.fill=new fL(i);else if(c.fill.visitedFrame===r)return;c.fill.enqueuedFrame!==r&&(c.fill.enqueuedFrame=r,c.fill.changedThisFrame=!1,s.enqueue(i)),function(e,t,n,i,o,r){const s=i.data.fill;let a;const c=n.data.fill;let l,u,h,A,p,f;switch((0,d.A)(c)?(c.visitedFrame=t.frameNumber,c.changedThisFrame&&(NL(e,t,n,r),c.changedThisFrame=!1),a=n.data.fill.mesh):a=n.data.mesh,o){case kR.WEST:l=s.westMeshes,u=s.westTiles;break;case kR.SOUTH:l=s.southMeshes,u=s.southTiles;break;case kR.EAST:l=s.eastMeshes,u=s.eastTiles;break;case kR.NORTH:l=s.northMeshes,u=s.northTiles;break;case kR.NORTHWEST:return s.changedThisFrame=s.changedThisFrame||s.northwestMesh!==a,s.northwestMesh=a,void(s.northwestTile=n);case kR.NORTHEAST:return s.changedThisFrame=s.changedThisFrame||s.northeastMesh!==a,s.northeastMesh=a,void(s.northeastTile=n);case kR.SOUTHWEST:return s.changedThisFrame=s.changedThisFrame||s.southwestMesh!==a,s.southwestMesh=a,void(s.southwestTile=n);case kR.SOUTHEAST:return s.changedThisFrame=s.changedThisFrame||s.southeastMesh!==a,s.southeastMesh=a,void(s.southeastTile=n)}if(n.level<=i.level)return s.changedThisFrame=s.changedThisFrame||l[0]!==a||1!==l.length,l[0]=a,u[0]=n,l.length=1,void(u.length=1);const m=n.rectangle;let g;const _=i.rectangle;switch(o){case kR.WEST:for(g=(_.north-_.south)*J.A.EPSILON5,h=0;h<u.length&&(p=u[h],f=p.rectangle,!J.A.greaterThan(m.north,f.south,g));++h);for(A=h;A<u.length&&(p=u[A],f=p.rectangle,!J.A.greaterThanOrEquals(m.south,f.north,g));++A);break;case kR.SOUTH:for(g=(_.east-_.west)*J.A.EPSILON5,h=0;h<u.length&&(p=u[h],f=p.rectangle,!J.A.lessThan(m.west,f.east,g));++h);for(A=h;A<u.length&&(p=u[A],f=p.rectangle,!J.A.lessThanOrEquals(m.east,f.west,g));++A);break;case kR.EAST:for(g=(_.north-_.south)*J.A.EPSILON5,h=0;h<u.length&&(p=u[h],f=p.rectangle,!J.A.lessThan(m.south,f.north,g));++h);for(A=h;A<u.length&&(p=u[A],f=p.rectangle,!J.A.lessThanOrEquals(m.north,f.south,g));++A);break;case kR.NORTH:for(g=(_.east-_.west)*J.A.EPSILON5,h=0;h<u.length&&(p=u[h],f=p.rectangle,!J.A.greaterThan(m.east,f.west,g));++h);for(A=h;A<u.length&&(p=u[A],f=p.rectangle,!J.A.greaterThanOrEquals(m.west,f.east,g));++A);}A-h===1?(s.changedThisFrame=s.changedThisFrame||l[h]!==a,l[h]=a,u[h]=n):(s.changedThisFrame=!0,l.splice(h,A-h,a),u.splice(h,A-h,n))}(e,t,n,i,o,a)}(e,t,n,l,r,o,a,c)}}fL.updateFillTiles=function(e,t,n,i){const o=e._quadtree,r=o._levelZeroTiles,s=o._lastSelectionFrameNumber,a=mL;a.clear();for(let e=0;e<t.length;++e){const n=t[e];(0,d.A)(n.data.vertexArray)&&a.enqueue(t[e])}let c=a.dequeue();for(;void 0!==c;){const t=c.findTileToWest(r),o=c.findTileToSouth(r),l=c.findTileToEast(r),u=c.findTileToNorth(r);gL(e,n,c,t,s,kR.EAST,!1,a,i),gL(e,n,c,o,s,kR.NORTH,!1,a,i),gL(e,n,c,l,s,kR.WEST,!1,a,i),gL(e,n,c,u,s,kR.SOUTH,!1,a,i);const d=t.findTileToNorth(r),h=t.findTileToSouth(r),A=l.findTileToNorth(r),p=l.findTileToSouth(r);gL(e,n,c,d,s,kR.SOUTHEAST,!1,a,i),gL(e,n,c,A,s,kR.SOUTHWEST,!1,a,i),gL(e,n,c,h,s,kR.NORTHEAST,!1,a,i),gL(e,n,c,p,s,kR.NORTHWEST,!1,a,i),c=a.dequeue()}};const _L=new X.A,yL=new X.A,vL=new j.A,TL=new j.A,bL=new q.A,wL=new q.A,xL=new q.A;function CL(){this.height=0,this.encodedNormal=new q.A}function EL(e,t,n,i,o,r,s,a,c){if((0,d.A)(o))return o;let l;if((0,d.A)(r)&&(0,d.A)(s))l=.5*(r.height+s.height);else if((0,d.A)(r))l=r.height;else if((0,d.A)(s))l=s.height;else if((0,d.A)(a))l=a.height;else{const t=e.tile.data.tileBoundingRegion;let n=0,i=0;(0,d.A)(t)&&(n=t.minimumHeight,i=t.maximumHeight),l=.5*(n+i)}return GL(0,t,0,0,l,c),c}const SL={minimumHeight:0,maximumHeight:0},IL=new j.A,PL=new CL,DL=new CL,OL=new CL,RL=new CL,ML="undefined"!=typeof Uint8Array?new Uint8Array(81):void 0,LL={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0};function NL(e,t,n,i){dL.initialize(n,e.terrainProvider,e._imageryLayers);const o=n.data,r=o.fill,s=n.rectangle,a=t.verticalExaggeration,c=t.verticalExaggerationRelativeHeight,l=1!==a,u=n.tilingScheme.ellipsoid;let h=WL(r,u,0,1,r.northwestTile,r.northwestMesh,r.northTiles,r.northMeshes,r.westTiles,r.westMeshes,OL),A=WL(r,u,0,0,r.southwestTile,r.southwestMesh,r.westTiles,r.westMeshes,r.southTiles,r.southMeshes,PL),p=WL(r,u,1,0,r.southeastTile,r.southeastMesh,r.southTiles,r.southMeshes,r.eastTiles,r.eastMeshes,DL),f=WL(r,u,1,1,r.northeastTile,r.northeastMesh,r.eastTiles,r.eastMeshes,r.northTiles,r.northMeshes,RL);h=EL(r,u,0,0,h,A,f,p,OL),A=EL(r,u,0,0,A,h,p,f,PL),p=EL(r,u,0,0,p,A,f,h,DL),f=EL(r,u,0,0,f,p,h,A,RL);const m=A.height,g=p.height,_=h.height,y=f.height;let v=Math.min(m,g,_,y),T=Math.max(m,g,_,y);const b=.5*(v+T);let w,x;const C=e.getLevelMaximumGeometricError(n.level),E=u.maximumRadius-C;let S=4*Math.acos(E/u.maximumRadius);if(S*=1.5,s.width>S&&T-v<=C){const e=new nI.A({width:9,height:9,buffer:ML,structure:{heightOffset:T}}),t=LL;t.tilingScheme=n.tilingScheme,t.x=n.x,t.y=n.y,t.level=n.level,t.exaggeration=a,t.exaggerationRelativeHeight=c,r.mesh=e._createMeshSync(t)}else{const t=l,i=Or.A.center(s,yL);i.height=b;const o=u.cartographicToCartesian(i,IL),d=new hD.A(o,void 0,void 0,void 0,void 0,!0,!0,t,a,c);let m,g=5;for(m=r.westMeshes,w=0,x=m.length;w<x;++w)g+=m[w].eastIndicesNorthToSouth.length;for(m=r.southMeshes,w=0,x=m.length;w<x;++w)g+=m[w].northIndicesWestToEast.length;for(m=r.eastMeshes,w=0,x=m.length;w<x;++w)g+=m[w].westIndicesSouthToNorth.length;for(m=r.northMeshes,w=0,x=m.length;w<x;++w)g+=m[w].southIndicesEastToWest.length;const _=SL;_.minimumHeight=v,_.maximumHeight=T;const y=d.stride;let C=new Float32Array(g*y),E=0;const S=E;E=BL(u,s,d,C,E,0,1,h.height,h.encodedNormal,1,_),E=qL(r,u,d,C,E,r.westTiles,r.westMeshes,kR.EAST,_);const I=E;E=BL(u,s,d,C,E,0,0,A.height,A.encodedNormal,0,_),E=qL(r,u,d,C,E,r.southTiles,r.southMeshes,kR.NORTH,_);const P=E;E=BL(u,s,d,C,E,1,0,p.height,p.encodedNormal,0,_),E=qL(r,u,d,C,E,r.eastTiles,r.eastMeshes,kR.WEST,_);const D=E;E=BL(u,s,d,C,E,1,1,f.height,f.encodedNormal,1,_),E=qL(r,u,d,C,E,r.northTiles,r.northMeshes,kR.SOUTH,_),v=_.minimumHeight,T=_.maximumHeight;const O=lD.A.fromRectangle(s,v,T,n.tilingScheme.ellipsoid),R=oM.A.geodeticLatitudeToMercatorAngle(s.south),M=1/(oM.A.geodeticLatitudeToMercatorAngle(s.north)-R),L=(oM.A.geodeticLatitudeToMercatorAngle(i.latitude)-R)*M,N=u.geodeticSurfaceNormalCartographic(_L,TL),B=gI.A.octEncode(N,bL),F=E;d.encode(C,E*y,O.center,q.A.fromElements(.5,.5,xL),b,B,L,N),++E;const U=E,k=3*(U-1),V=k*(U<256?1:2);let z;if((C.length-U*y)*Float32Array.BYTES_PER_ELEMENT>=V){const e=U*y*Float32Array.BYTES_PER_ELEMENT;z=U<256?new Uint8Array(C.buffer,e,k):new Uint16Array(C.buffer,e,k)}else z=U<256?new Uint8Array(k):new Uint16Array(k);C=new Float32Array(C.buffer,0,U*y);let H=0;for(w=0;w<U-2;++w)z[H++]=F,z[H++]=w,z[H++]=w+1;z[H++]=F,z[H++]=w,z[H++]=0;const G=[];for(w=I;w>=S;--w)G.push(w);const W=[];for(w=P;w>=I;--w)W.push(w);const Y=[];for(w=D;w>=P;--w)Y.push(w);const Q=[];for(Q.push(0),w=F-1;w>=D;--w)Q.push(w);r.mesh=new AD.A(d.center,C,z,k,U,v,T,Sn.A.fromOrientedBoundingBox(O),function(e,t,n,i,o){const r=e.quadtree._occluders.ellipsoid,s=r.ellipsoid,a=$L;return j.A.fromRadians(n.west,n.south,o,s,a[0]),j.A.fromRadians(n.east,n.south,o,s,a[1]),j.A.fromRadians(n.west,n.north,o,s,a[2]),j.A.fromRadians(n.east,n.north,o,s,a[3]),r.computeHorizonCullingPointPossiblyUnderEllipsoid(t,a,i,void 0)}(e,O.center,s,v,T),d.stride,O,d,G,W,Y,Q)}const I=t.context;r._destroyVertexArray(i),r.vertexArray=dL._createVertexArrayForMesh(I,r.mesh),o.processImagery(n,e.terrainProvider,t,!0);const P=r.waterMaskTexture;if(r.waterMaskTexture=void 0,e.terrainProvider.hasWaterMask){const e=o._findAncestorTileWithTerrainData(n);(0,d.A)(e)&&(0,d.A)(e.data.waterMaskTexture)&&(r.waterMaskTexture=e.data.waterMaskTexture,++r.waterMaskTexture.referenceCount,o._computeWaterMaskTranslationAndScale(n,e,r.waterMaskTranslationAndScale))}(0,d.A)(P)&&(--P.referenceCount,0===P.referenceCount&&P.destroy())}function BL(e,t,n,i,o,r,s,a,c,l,u){const d=_L;d.longitude=J.A.lerp(t.west,t.east,r),d.latitude=J.A.lerp(t.south,t.north,s),d.height=a;const h=e.cartographicToCartesian(d,vL);let A;n.hasGeodeticSurfaceNormals&&(A=e.geodeticSurfaceNormal(h,TL));const p=wL;return p.x=r,p.y=s,n.encode(i,o*n.stride,h,p,a,c,l,A),u.minimumHeight=Math.min(u.minimumHeight,a),u.maximumHeight=Math.max(u.maximumHeight,a),o+1}const FL=new Or.A;function UL(e,t,n,i){let o=e.rectangle;const r=t.rectangle;0===t.x&&1===n.x&&e.x===e.tilingScheme.getNumberOfXTilesAtLevel(e.level)-1?(o=Or.A.clone(e.rectangle,FL),o.west-=J.A.TWO_PI,o.east-=J.A.TWO_PI):0===e.x&&0===n.x&&t.x===t.tilingScheme.getNumberOfXTilesAtLevel(t.level)-1&&(o=Or.A.clone(e.rectangle,FL),o.west+=J.A.TWO_PI,o.east+=J.A.TWO_PI);const s=o.east-o.west,a=(r.west-o.west)/s,c=(r.east-o.west)/s,l=o.north-o.south,u=(r.south-o.south)/l,d=(r.north-o.south)/l;let h=(n.x-a)/(c-a),A=(n.y-u)/(d-u);return Math.abs(h)<Math.EPSILON5?h=0:Math.abs(h-1)<Math.EPSILON5&&(h=1),Math.abs(A)<Math.EPSILON5?A=0:Math.abs(A-1)<Math.EPSILON5&&(A=1),i.x=h,i.y=A,i}const kL=new q.A;function VL(e,t,n,i,o){const r=e.encoding,s=e.vertices;if(o.height=r.decodeHeight(s,t),r.hasVertexNormals)r.getOctEncodedNormal(s,t,o.encodedNormal);else{const e=o.encodedNormal;e.x=0,e.y=0}}const zL=new q.A,HL=new j.A;function GL(e,t,n,i,o,r){r.height=o;const s=t.geodeticSurfaceNormalCartographic(_L,vL);gI.A.octEncode(s,r.encodedNormal)}function WL(e,t,n,i,o,r,s,a,c,l,u){if(KL(e,t,a,s,!1,n,i,u)||KL(e,t,l,c,!0,n,i,u))return u;let h,A;return XL(o,r)?(h=0===n?0===i?r.eastIndicesNorthToSouth[0]:r.southIndicesEastToWest[0]:0===i?r.northIndicesWestToEast[0]:r.westIndicesSouthToNorth[0],VL(r,h,0,0,u),u):(A=0===n?0===i?YL(e.westMeshes,e.westTiles,kR.EAST,e.southMeshes,e.southTiles,kR.NORTH,n,i):YL(e.northMeshes,e.northTiles,kR.SOUTH,e.westMeshes,e.westTiles,kR.EAST,n,i):0===i?YL(e.southMeshes,e.southTiles,kR.NORTH,e.eastMeshes,e.eastTiles,kR.WEST,n,i):YL(e.eastMeshes,e.eastTiles,kR.WEST,e.northMeshes,e.northTiles,kR.SOUTH,n,i),(0,d.A)(A)?(GL(0,t,0,0,A,u),u):void 0)}function YL(e,t,n,i,o,r,s,a){const c=QL(e,t,!1,n),l=QL(i,o,!0,r);return(0,d.A)(c)&&(0,d.A)(l)?.5*(c+l):(0,d.A)(c)?c:l}function qL(e,t,n,i,o,r,s,a,c){for(let l=0;l<r.length;++l)o=jL(e,t,n,i,o,r[l],s[l],a,c);return o}function jL(e,t,n,i,o,r,s,a,c){let l=r.rectangle;a===kR.EAST&&0===e.tile.x?(l=Or.A.clone(r.rectangle,FL),l.west-=J.A.TWO_PI,l.east-=J.A.TWO_PI):a===kR.WEST&&0===r.x&&(l=Or.A.clone(r.rectangle,FL),l.west+=J.A.TWO_PI,l.east+=J.A.TWO_PI);const u=e.tile.rectangle;let d,h,A,p;switch(o>0&&(n.decodeTextureCoordinates(i,o-1,xL),d=xL.x,h=xL.y),a){case kR.WEST:A=s.westIndicesSouthToNorth,p=!1;break;case kR.NORTH:A=s.northIndicesWestToEast,p=!0;break;case kR.EAST:A=s.eastIndicesNorthToSouth,p=!1;break;case kR.SOUTH:A=s.southIndicesEastToWest,p=!0}const f=r,m=e.tile,g=s.encoding,_=s.vertices,y=n.stride;let v,T;g.hasWebMercatorT&&(v=oM.A.geodeticLatitudeToMercatorAngle(u.south),T=1/(oM.A.geodeticLatitudeToMercatorAngle(u.north)-v));for(let e=0;e<A.length;++e){const r=A[e],s=g.decodeTextureCoordinates(_,r,xL);UL(f,m,s,s);const a=s.x,l=s.y,b=p?a:l;if(b<0||b>1)continue;if(Math.abs(a-d)<J.A.EPSILON5&&Math.abs(l-h)<J.A.EPSILON5)continue;const w=Math.abs(a)<J.A.EPSILON5||Math.abs(a-1)<J.A.EPSILON5,x=Math.abs(l)<J.A.EPSILON5||Math.abs(l-1)<J.A.EPSILON5;if(w&&x)continue;const C=g.decodePosition(_,r,vL),E=g.decodeHeight(_,r);let S;g.hasVertexNormals?S=g.getOctEncodedNormal(_,r,bL):(S=bL,S.x=0,S.y=0);let I,P=l;if(g.hasWebMercatorT){const e=J.A.lerp(u.south,u.north,l);P=(oM.A.geodeticLatitudeToMercatorAngle(e)-v)*T}n.hasGeodeticSurfaceNormals&&(I=t.geodeticSurfaceNormal(C,TL)),n.encode(i,o*y,C,s,E,S,P,I),c.minimumHeight=Math.min(c.minimumHeight,E),c.maximumHeight=Math.max(c.maximumHeight,E),++o}return o}function QL(e,t,n,i,o,r){let s,a,c;n?(s=0,a=e.length,c=1):(s=e.length-1,a=-1,c=-1);for(let o=s;o!==a;o+=c){const r=e[o];if(!XL(t[o],r))continue;let s;switch(i){case kR.WEST:s=r.westIndicesSouthToNorth;break;case kR.SOUTH:s=r.southIndicesEastToWest;break;case kR.EAST:s=r.eastIndicesNorthToSouth;break;case kR.NORTH:s=r.northIndicesWestToEast}const a=s[n?0:s.length-1];if((0,d.A)(a))return r.encoding.decodeHeight(r.vertices,a)}}function XL(e,t){return(0,d.A)(t)&&(!(0,d.A)(e.data.fill)||!e.data.fill.changedThisFrame)}function KL(e,t,n,i,o,r,s,a){let c,l,u,d,h;const A=i[o?0:n.length-1],p=n[o?0:n.length-1];if(XL(A,p)&&(0===r?0===s?(c=o?p.northIndicesWestToEast:p.eastIndicesNorthToSouth,l=o,u=o):(c=o?p.eastIndicesNorthToSouth:p.southIndicesEastToWest,l=!o,u=!1):0===s?(c=o?p.westIndicesSouthToNorth:p.northIndicesWestToEast,l=!o,u=!0):(c=o?p.southIndicesEastToWest:p.westIndicesSouthToNorth,l=o,u=!o),c.length>0)){d=o?0:c.length-1,h=c[d],p.encoding.decodeTextureCoordinates(p.vertices,h,xL);const n=UL(A,e.tile,xL,xL);if(n.x===r&&n.y===s)return VL(p,h,0,0,a),!0;if(d=(0,Wi.A)(c,l?r:s,function(t,n){p.encoding.decodeTextureCoordinates(p.vertices,t,xL);const i=UL(A,e.tile,xL,xL);return u?l?i.x-r:i.y-s:l?r-i.x:s-i.y}),!(d<0))return VL(p,c[d],0,0,a),!0;if(d=~d,d>0&&d<c.length)return function(e,t,n,i,o,r,s,a,c,l){const u=i.encoding,d=i.vertices,h=UL(t,n,u.decodeTextureCoordinates(d,o,xL),xL),A=UL(t,n,u.decodeTextureCoordinates(d,r,wL),wL);let p;p=c?(s-h.x)/(A.x-h.x):(a-h.y)/(A.y-h.y);const f=u.decodeHeight(d,o),m=u.decodeHeight(d,r),g=n.rectangle;let _;if(_L.longitude=J.A.lerp(g.west,g.east,s),_L.latitude=J.A.lerp(g.south,g.north,a),l.height=_L.height=J.A.lerp(f,m,p),u.hasVertexNormals){const e=u.getOctEncodedNormal(d,o,kL),t=u.getOctEncodedNormal(d,r,zL),n=gI.A.octDecode(e.x,e.y,vL),i=gI.A.octDecode(t.x,t.y,HL);_=j.A.lerp(n,i,p,vL),j.A.normalize(_,_),gI.A.octEncode(_,l.encodedNormal)}else _=e.geodeticSurfaceNormalCartographic(_L,vL),gI.A.octEncode(_,l.encodedNormal)}(t,A,e.tile,p,c[d-1],c[d],r,s,l,a),!0}return!1}const $L=[new j.A,new j.A,new j.A,new j.A],JL=fL;var ZL=n(413690);function eN(e){if(!(0,d.A)(e))throw new A.A("options is required.");if(!(0,d.A)(e.terrainProvider))throw new A.A("options.terrainProvider is required.");if(!(0,d.A)(e.imageryLayers))throw new A.A("options.imageryLayers is required.");if(!(0,d.A)(e.surfaceShaderSet))throw new A.A("options.surfaceShaderSet is required.");this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.hasWaterMask=!1,this.showWaterEffect=!1,this.oceanNormalMap=void 0,this.zoomedOutOceanSpecularIntensity=.5,this.enableLighting=!1,this.dynamicAtmosphereLighting=!1,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!1,this.shadows=kn.A.RECEIVE_ONLY,this.vertexShadowDarkness=.3,this.fillHighlightColor=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this.showSkirts=!0,this.backFaceCulling=!0,this.undergroundColor=void 0,this.undergroundColorAlphaByDistance=void 0,this.lambertDiffuseMultiplier=0,this.materialUniformMap=void 0,this._materialUniformMap=void 0,this._quadtree=void 0,this._terrainProvider=e.terrainProvider,this._imageryLayers=e.imageryLayers,this._surfaceShaderSet=e.surfaceShaderSet,this._renderState=void 0,this._blendRenderState=void 0,this._disableCullingRenderState=void 0,this._disableCullingBlendRenderState=void 0,this._errorEvent=new Bn.A,this._removeLayerAddedListener=this._imageryLayers.layerAdded.addEventListener(eN.prototype._onLayerAdded,this),this._removeLayerRemovedListener=this._imageryLayers.layerRemoved.addEventListener(eN.prototype._onLayerRemoved,this),this._removeLayerMovedListener=this._imageryLayers.layerMoved.addEventListener(eN.prototype._onLayerMoved,this),this._removeLayerShownListener=this._imageryLayers.layerShownOrHidden.addEventListener(eN.prototype._onLayerShownOrHidden,this),this._imageryLayersUpdatedEvent=new Bn.A,this._layerOrderChanged=!1,this._tilesToRenderByTextureCount=[],this._drawCommands=[],this._uniformMaps=[],this._usedDrawCommands=0,this._vertexArraysToDestroy=[],this._debug={wireframe:!1,boundingSphereTile:void 0},this._baseColor=void 0,this._firstPassInitialColor=void 0,this.baseColor=new u.A(0,0,.5,1),this._clippingPlanes=void 0,this._clippingPolygons=void 0,this.cartographicLimitRectangle=Or.A.clone(Or.A.MAX_VALUE),this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1,this._oldVerticalExaggeration=void 0,this._oldVerticalExaggerationRelativeHeight=void 0}function tN(e,t){let n=e.loadingImagery;(0,d.A)(n)||(n=e.readyImagery);let i=t.loadingImagery;return(0,d.A)(i)||(i=t.readyImagery),n.imageryLayer._layerIndex-i.imageryLayer._layerIndex}function nN(e,t){const n=t.globeTranslucencyState;if(n.translucent){const i=e.renderState.blending.enabled;n.pushDerivedCommands(e,i,t)}else t.commandList.push(e)}Object.defineProperties(eN.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){if(!(0,d.A)(e))throw new A.A("value is required.");this._baseColor=e,this._firstPassInitialColor=Q.A.fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){if(!(0,d.A)(e))throw new A.A("value is required.");this._quadtree=e}},tilingScheme:{get:function(){if((0,d.A)(this._terrainProvider))return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},imageryLayersUpdatedEvent:{get:function(){return this._imageryLayersUpdatedEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){this._terrainProvider!==e&&(this._terrainProvider=e,(0,d.A)(this._quadtree)&&this._quadtree.invalidateAllTiles())}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){YM.A.setOwner(e,this,"_clippingPlanes")}},clippingPolygons:{get:function(){return this._clippingPolygons},set:function(e){JM.A.setOwner(e,this,"_clippingPolygons")}}}),eN.prototype.update=function(e){this._imageryLayers._update()},eN.prototype.initialize=function(e){this._imageryLayers.queueReprojectionCommands(e),this._layerOrderChanged&&(this._layerOrderChanged=!1,this._quadtree.forEachLoadedTile(function(e){e.data.imagery.sort(tN)})),function(e,t){const n=t.creditDisplay,i=e._terrainProvider;(0,d.A)(i)&&(0,d.A)(i.credit)&&n.addCreditToNextFrame(i.credit);const o=e._imageryLayers;for(let e=0,t=o.length;e<t;++e){const t=o.get(e);t.ready&&t.show&&(0,d.A)(t.imageryProvider.credit)&&n.addCreditToNextFrame(t.imageryProvider.credit)}}(this,e);const t=this._vertexArraysToDestroy,n=t.length;for(let e=0;e<n;++e)dL._freeVertexArray(t[e]);t.length=0},eN.prototype.beginUpdate=function(e){const t=this._tilesToRenderByTextureCount;for(let e=0,n=t.length;e<n;++e){const n=t[e];(0,d.A)(n)&&(n.length=0)}const n=this._clippingPlanes;(0,d.A)(n)&&n.enabled&&n.update(e);const i=this._clippingPolygons;(0,d.A)(i)&&i.enabled&&(i.update(e),i.queueCommands(e)),this._usedDrawCommands=0,this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1},eN.prototype.endUpdate=function(e){if(!(0,d.A)(this._renderState)){this._renderState=_.A.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:ZM.A.LESS}}),this._blendRenderState=_.A.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:ZM.A.LESS_OR_EQUAL},blending:$M.A.ALPHA_BLEND});let e=(0,_t.A)(this._renderState,!0);e.cull.enabled=!1,this._disableCullingRenderState=_.A.fromCache(e),e=(0,_t.A)(this._blendRenderState,!0),e.cull.enabled=!1,this._disableCullingBlendRenderState=_.A.fromCache(e)}this._hasFillTilesThisFrame&&this._hasLoadedTilesThisFrame&&JL.updateFillTiles(this,this._quadtree._tilesToRender,e,this._vertexArraysToDestroy);const t=this.quadtree,n=e.verticalExaggeration,i=e.verticalExaggerationRelativeHeight,o=this._oldVerticalExaggeration!==n||this._oldVerticalExaggerationRelativeHeight!==i;this._oldVerticalExaggeration=n,this._oldVerticalExaggerationRelativeHeight=i,o&&t.forEachLoadedTile(function(n){n.data.updateExaggeration(n,e,t)});const r=this._tilesToRenderByTextureCount;for(let t=0,n=r.length;t<n;++t){const n=r[t];if((0,d.A)(n))for(let t=0,i=n.length;t<i;++t){const i=n[t],o=i.data.tileBoundingRegion;LN(this,i,e),e.minimumTerrainHeight=Math.min(e.minimumTerrainHeight,o.minimumHeight)}}},eN.prototype.updateForPick=function(e){const t=this._drawCommands;for(let n=0,i=this._usedDrawCommands;n<i;++n)nN(t[n],e)},eN.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()},eN.prototype.getLevelMaximumGeometricError=function(e){return(0,d.A)(this._terrainProvider)?this._terrainProvider.getLevelMaximumGeometricError(e):0},eN.prototype.loadTile=function(e,t){let n,i=t.data,o=!0;(0,d.A)(i)&&(o=i.boundingVolumeSourceTile!==t||t._lastSelectionResult===pL.CULLED_BUT_NEEDED,n=i.terrainState),dL.processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,o),i=t.data,o&&n!==t.data.terrainState&&this.computeTileVisibility(t,e,this.quadtree.occluders)!==WO.NONE&&i.boundingVolumeSourceTile===t&&(o=!1,dL.processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,o))};const iN=new Sn.A,oN=new Or.A,rN=new Or.A,sN=new X.A;function aN(e,t){if(t.west<t.east)return t;const n=Or.A.clone(t,rN);return Or.A.center(e,sN).longitude>0?n.east=J.A.PI:n.west=-J.A.PI,n}function cN(e,t){if(t.cameraUnderground)return!0;if(t.globeTranslucencyState.translucent)return!0;if(e.backFaceCulling)return!1;const n=e._clippingPlanes;if((0,d.A)(n)&&n.enabled)return!0;const i=e._clippingPolygons;return!(!(0,d.A)(i)||!i.enabled)||!Or.A.equals(e.cartographicLimitRectangle,Or.A.MAX_VALUE)}eN.prototype.computeTileVisibility=function(e,t,n){const i=this.computeDistanceToTile(e,t);e._distance=i;const o=cN(this,t);if(t.fog.enabled&&!o&&J.A.fog(i,t.fog.density)>=1)return WO.NONE;const r=e.data,s=r.tileBoundingRegion;if(void 0===r.boundingVolumeSourceTile)return WO.PARTIAL;const a=t.cullingVolume;let c=s.boundingVolume;(0,d.A)(c)||(c=s.boundingSphere),r.clippedByBoundaries=!1;const l=aN(e.rectangle,this.cartographicLimitRectangle),u=Or.A.simpleIntersection(l,e.rectangle,oN);if(!(0,d.A)(u))return WO.NONE;if(Or.A.equals(u,e.rectangle)||(r.clippedByBoundaries=!0),t.mode!==Ce.A.SCENE3D&&(c=iN,Sn.A.fromRectangleWithHeights2D(e.rectangle,t.mapProjection,s.minimumHeight,s.maximumHeight,c),j.A.fromElements(c.center.z,c.center.x,c.center.y,c.center),t.mode===Ce.A.MORPHING&&(0,d.A)(r.renderedMesh)&&(c=Sn.A.union(s.boundingSphere,c,c))),!(0,d.A)(c))return WO.PARTIAL;const h=this._clippingPlanes;if((0,d.A)(h)&&h.enabled){const t=h.computeIntersectionWithBoundingVolume(c);if(e.isClipped=t!==bO.A.INSIDE,t===bO.A.OUTSIDE)return WO.NONE}const A=this._clippingPolygons;if((0,d.A)(A)&&A.enabled){const t=A.computeIntersectionWithBoundingVolume(s);e.isClipped=t!==bO.A.OUTSIDE}let p;const f=a.computeVisibility(c);if(f===bO.A.OUTSIDE?p=WO.NONE:f===bO.A.INTERSECTING?p=WO.PARTIAL:f===bO.A.INSIDE&&(p=WO.FULL),p===WO.NONE)return p;const m=t.mode===Ce.A.SCENE3D&&t.camera.frustum instanceof ee.A;if(t.mode===Ce.A.SCENE3D&&!m&&(0,d.A)(n)&&!o){const e=r.occludeePointInScaledSpace;return(0,d.A)(e)?n.ellipsoid.isScaledSpacePointVisiblePossiblyUnderEllipsoid(e,s.minimumHeight)?p:WO.NONE:p}return p},eN.prototype.canRefine=function(e){return!!(0,d.A)(e.data.terrainData)||void 0!==this.terrainProvider.getTileDataAvailable(2*e.x,2*e.y,e.level+1)};const lN=[],uN=[];eN.prototype.canRenderWithoutLosingDetail=function(e,t){const n=e.data,i=lN;i.length=this._imageryLayers.length;let o,r,s,a=!1,c=!1;for((0,d.A)(n)&&(a=n.terrainState===nL.READY,c=!0,o=n.imagery),r=0,s=i.length;r<s;++r)i[r]=c;if((0,d.A)(o))for(r=0,s=o.length;r<s;++r){const e=o[r],t=e.loadingImagery,n=!(0,d.A)(t)||t.state===eL.A.FAILED||t.state===eL.A.INVALID,s=(e.loadingImagery||e.readyImagery).imageryLayer._layerIndex;i[s]=n&&i[s]}const l=this.quadtree._lastSelectionFrameNumber,u=uN;for(u.length=0,u.push(e.southwestChild,e.southeastChild,e.northwestChild,e.northeastChild);u.length>0;){const e=u.pop(),t=e._lastSelectionResultFrame===l?e._lastSelectionResult:pL.NONE;if(t===pL.RENDERED){const t=e.data;if(!(0,d.A)(t))continue;if(!a&&e.data.terrainState===nL.READY)return!1;const n=e.data.imagery;for(r=0,s=n.length;r<s;++r){const e=n[r],t=e.loadingImagery,o=!(0,d.A)(t)||t.state===eL.A.FAILED||t.state===eL.A.INVALID,s=(e.loadingImagery||e.readyImagery).imageryLayer._layerIndex;if(o&&!i[s])return!1}}else t===pL.REFINED&&u.push(e.southwestChild,e.southeastChild,e.northwestChild,e.northeastChild)}return!0};const dN=new j.A;eN.prototype.computeTileLoadPriority=function(e,t){const n=e.data;if(void 0===n)return 0;const i=n.tileBoundingRegion.boundingVolume;if(void 0===i)return 0;const o=t.camera.positionWC,r=t.camera.directionWC,s=j.A.subtract(i.center,o,dN),a=j.A.magnitude(s);return a<J.A.EPSILON5?0:(j.A.divideByScalar(s,a,s),(1-j.A.dot(s,r))*e._distance)};const hN=new O.A,AN=new O.A,pN=new Q.A,fN=new Q.A,mN=new Q.A,gN=new j.A,_N=new j.A,yN=new j.A,vN=new j.A;eN.prototype.showTileThisFrame=function(e,t){let n=0;const i=e.data.imagery;for(let e=0,t=i.length;e<t;++e){const t=i[e];(0,d.A)(t.readyImagery)&&0!==t.readyImagery.imageryLayer.alpha&&++n}let o=this._tilesToRenderByTextureCount[n];(0,d.A)(o)||(o=[],this._tilesToRenderByTextureCount[n]=o),o.push(e);const r=e.data;(0,d.A)(r.vertexArray)?this._hasLoadedTilesThisFrame=!0:this._hasFillTilesThisFrame=!0;const s=this._debug;++s.tilesRendered,s.texturesRendered+=n};const TN=[new j.A,new j.A,new j.A,new j.A];function bN(e,t,n,i,o,r){const s=e.quadtree._occluders.ellipsoid,a=s.ellipsoid,c=TN;return j.A.fromRadians(n.west,n.south,o,a,c[0]),j.A.fromRadians(n.east,n.south,o,a,c[1]),j.A.fromRadians(n.west,n.north,o,a,c[2]),j.A.fromRadians(n.east,n.north,o,a,c[3]),s.computeHorizonCullingPointPossiblyUnderEllipsoid(t,c,i,r)}eN.prototype.computeDistanceToTile=function(e,t){!function(e,t,n){let i=e.data;void 0===i&&(i=e.data=new dL);const o=e.tilingScheme.ellipsoid;void 0===i.tileBoundingRegion&&(i.tileBoundingRegion=new ZL.A({computeBoundingVolumes:!1,rectangle:e.rectangle,ellipsoid:o,minimumHeight:0,maximumHeight:0}));const r=i.tileBoundingRegion,s=r.minimumHeight,a=r.maximumHeight;let c=!1,l=e;const u=i.mesh,h=i.terrainData;if(void 0!==u&&void 0!==u.minimumHeight&&void 0!==u.maximumHeight)r.minimumHeight=u.minimumHeight,r.maximumHeight=u.maximumHeight,c=!0;else if(void 0!==h&&void 0!==h._minimumHeight&&void 0!==h._maximumHeight)r.minimumHeight=h._minimumHeight,r.maximumHeight=h._maximumHeight;else{r.minimumHeight=Number.NaN,r.maximumHeight=Number.NaN;let t=e.parent;for(;void 0!==t;){const e=t.data;if(void 0!==e){const t=e.mesh,n=e.terrainData;if(void 0!==t&&void 0!==t.minimumHeight&&void 0!==t.maximumHeight){r.minimumHeight=t.minimumHeight,r.maximumHeight=t.maximumHeight;break}if(void 0!==n&&void 0!==n._minimumHeight&&void 0!==n._maximumHeight){r.minimumHeight=n._minimumHeight,r.maximumHeight=n._maximumHeight;break}}t=t.parent}l=t}if(void 0!==l){const h=n.verticalExaggeration,A=n.verticalExaggerationRelativeHeight;if(1!==h&&(c=!1,r.minimumHeight=eM.A.getHeight(r.minimumHeight,h,A),r.maximumHeight=eM.A.getHeight(r.maximumHeight,h,A)),c)i.boundingVolumeIsFromMesh||(r._orientedBoundingBox=lD.A.clone(u.orientedBoundingBox,r._orientedBoundingBox),r._boundingSphere=Sn.A.clone(u.boundingSphere3D,r._boundingSphere),i.occludeePointInScaledSpace=j.A.clone(u.occludeePointInScaledSpace,i.occludeePointInScaledSpace),(0,d.A)(i.occludeePointInScaledSpace)||(i.occludeePointInScaledSpace=bN(t,r._orientedBoundingBox.center,e.rectangle,r.minimumHeight,r.maximumHeight,i.occludeePointInScaledSpace)));else{const n=void 0===r._orientedBoundingBox||void 0===r._boundingSphere;(r.minimumHeight!==s||r.maximumHeight!==a||n)&&(r.computeBoundingVolumes(o),i.occludeePointInScaledSpace=bN(t,r._orientedBoundingBox.center,e.rectangle,r.minimumHeight,r.maximumHeight,i.occludeePointInScaledSpace))}i.boundingVolumeSourceTile=l,i.boundingVolumeIsFromMesh=c}else i.boundingVolumeSourceTile=void 0,i.boundingVolumeIsFromMesh=!1}(e,this,t);const n=e.data;if(void 0===n.boundingVolumeSourceTile)return 9999999999;const i=n.tileBoundingRegion,o=i.minimumHeight,r=i.maximumHeight;if(n.boundingVolumeSourceTile!==e){const e=t.camera.positionCartographic.height;Math.abs(e-o)>Math.abs(e-r)?(i.minimumHeight=o,i.maximumHeight=o):(i.minimumHeight=r,i.maximumHeight=r)}const s=i.distanceToCamera(t);return i.minimumHeight=o,i.maximumHeight=r,s},eN.prototype.isDestroyed=function(){return!1},eN.prototype.destroy=function(){return this._tileProvider=this._tileProvider&&this._tileProvider.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),this._clippingPolygons=this._clippingPolygons&&this._clippingPolygons.destroy(),this._removeLayerAddedListener=this._removeLayerAddedListener&&this._removeLayerAddedListener(),this._removeLayerRemovedListener=this._removeLayerRemovedListener&&this._removeLayerRemovedListener(),this._removeLayerMovedListener=this._removeLayerMovedListener&&this._removeLayerMovedListener(),this._removeLayerShownListener=this._removeLayerShownListener&&this._removeLayerShownListener(),(0,h.A)(this)},eN.prototype._onLayerAdded=function(e,t){if(!this.isDestroyed()&&e.show){const t=this._terrainProvider,n=this,i=this._imageryLayersUpdatedEvent,o=function(){e._imageryCache={},n._quadtree.forEachLoadedTile(function(n){if((0,d.A)(n._loadedCallbacks[e._layerIndex]))return;let i;const o=n.data.imagery,r=o.length;let s=-1,a=0;for(i=0;i<r;++i){const t=o[i];if((t.readyImagery??t.loadingImagery).imageryLayer===e)-1===s&&(s=i),++a;else if(-1!==s)break}if(-1===s)return;const c=s+a;e._createTileImagerySkeletons(n,t,c)&&(n._loadedCallbacks[e._layerIndex]=function(e,t,n){return function(i){let o,r,s=-1;const a=i.data.imagery,c=a.length;let l;for(l=0;l<c;++l)if(o=a[l],r=o.readyImagery??o.loadingImagery,r.imageryLayer===t){s=l;break}if(-1!==s){const c=s+e;if(o=a[c],r=(0,d.A)(o)?o.readyImagery??o.loadingImagery:void 0,!(0,d.A)(r)||r.imageryLayer!==t)return!t._createTileImagerySkeletons(i,n,c);for(l=s;l<c;++l)a[l].freeResources();a.splice(s,e)}return!0}}(a,e,t),n.state=tL.LOADING)})};e.ready&&(e.imageryProvider._reload=o),this._quadtree.forEachLoadedTile(function(i){e._createTileImagerySkeletons(i,t)&&(i.state=tL.LOADING,0===i.level||i._lastSelectionResultFrame===n.quadtree._lastSelectionFrameNumber&&i._lastSelectionResult===pL.RENDERED||(i.renderable=!1))}),this._layerOrderChanged=!0,i.raiseEvent()}},eN.prototype._onLayerRemoved=function(e,t){this._quadtree.forEachLoadedTile(function(t){const n=t.data.imagery;let i=-1,o=0;for(let t=0,r=n.length;t<r;++t){const r=n[t];let s=r.loadingImagery;if((0,d.A)(s)||(s=r.readyImagery),s.imageryLayer===e)-1===i&&(i=t),r.freeResources(),++o;else if(-1!==i)break}-1!==i&&n.splice(i,o)}),(0,d.A)(e.imageryProvider)&&(e.imageryProvider._reload=void 0),this._imageryLayersUpdatedEvent.raiseEvent()},eN.prototype._onLayerMoved=function(e,t,n){this._layerOrderChanged=!0,this._imageryLayersUpdatedEvent.raiseEvent()},eN.prototype._onLayerShownOrHidden=function(e,t,n){n?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)};const wN=new O.A,xN=new O.A;function CN(e,t){const n={u_initialColor:function(){return this.properties.initialColor},u_fillHighlightColor:function(){return this.properties.fillHighlightColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_atmosphereLightIntensity:function(){return this.properties.atmosphereLightIntensity},u_atmosphereRayleighCoefficient:function(){return this.properties.atmosphereRayleighCoefficient},u_atmosphereMieCoefficient:function(){return this.properties.atmosphereMieCoefficient},u_atmosphereRayleighScaleHeight:function(){return this.properties.atmosphereRayleighScaleHeight},u_atmosphereMieScaleHeight:function(){return this.properties.atmosphereMieScaleHeight},u_atmosphereMieAnisotropy:function(){return this.properties.atmosphereMieAnisotropy},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_nightFadeDistance:function(){return this.properties.nightFadeDistance},u_center3D:function(){return this.properties.center3D},u_verticalExaggerationAndRelativeHeight:function(){return this.properties.verticalExaggerationAndRelativeHeight},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){const t=e.context.uniformState.view,n=O.A.multiplyByPoint(t,this.properties.rtc,_N);return O.A.setTranslation(t,n,hN),hN},u_modifiedModelViewProjection:function(){const t=e.context.uniformState.view,n=e.context.uniformState.projection,i=O.A.multiplyByPoint(t,this.properties.rtc,_N);return O.A.setTranslation(t,i,AN),O.A.multiply(n,AN,AN),AN},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureNightAlpha:function(){return this.properties.dayTextureNightAlpha},u_dayTextureDayAlpha:function(){return this.properties.dayTextureDayAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},u_dayTextureCutoutRectangles:function(){return this.properties.dayTextureCutoutRectangles},u_clippingPlanes:function(){const n=t._clippingPlanes;return(0,d.A)(n)&&(0,d.A)(n.texture)?n.texture:e.context.defaultTexture},u_cartographicLimitRectangle:function(){return this.properties.localizedCartographicLimitRectangle},u_clippingPlanesMatrix:function(){const n=t._clippingPlanes,i=(0,d.A)(n)?O.A.multiply(e.context.uniformState.view,n.modelMatrix,wN):O.A.IDENTITY;return O.A.inverseTranspose(i,xN)},u_clippingPlanesEdgeStyle:function(){const e=this.properties.clippingPlanesEdgeColor;return e.alpha=this.properties.clippingPlanesEdgeWidth,e},u_clippingDistance:function(){const n=t._clippingPolygons.clippingTexture;return(0,d.A)(n)?n:e.context.defaultTexture},u_clippingExtents:function(){const n=t._clippingPolygons.extentsTexture;return(0,d.A)(n)?n:e.context.defaultTexture},u_minimumBrightness:function(){return e.fog.minimumBrightness},u_hsbShift:function(){return this.properties.hsbShift},u_colorsToAlpha:function(){return this.properties.colorsToAlpha},u_frontFaceAlphaByDistance:function(){return this.properties.frontFaceAlphaByDistance},u_backFaceAlphaByDistance:function(){return this.properties.backFaceAlphaByDistance},u_translucencyRectangle:function(){return this.properties.localizedTranslucencyRectangle},u_undergroundColor:function(){return this.properties.undergroundColor},u_undergroundColorAlphaByDistance:function(){return this.properties.undergroundColorAlphaByDistance},u_lambertDiffuseMultiplier:function(){return this.properties.lambertDiffuseMultiplier},u_vertexShadowDarkness:function(){return this.properties.vertexShadowDarkness},properties:{initialColor:new Q.A(0,0,.5,1),fillHighlightColor:new u.A(0,0,0,0),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:void 0,lightingFadeDistance:new q.A(65e5,9e6),nightFadeDistance:new q.A(1e7,4e7),atmosphereLightIntensity:10,atmosphereRayleighCoefficient:new j.A(55e-7,13e-6,284e-7),atmosphereMieCoefficient:new j.A(21e-6,21e-6,21e-6),atmosphereRayleighScaleHeight:1e4,atmosphereMieScaleHeight:3200,atmosphereMieAnisotropy:.9,hsbShift:new j.A,center3D:void 0,rtc:new j.A,modifiedModelView:new O.A,tileRectangle:new Q.A,verticalExaggerationAndRelativeHeight:new q.A(1,0),dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureNightAlpha:[],dayTextureDayAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayTextureCutoutRectangles:[],dayIntensity:0,colorsToAlpha:[],southAndNorthLatitude:new q.A,southMercatorYAndOneOverHeight:new q.A,waterMask:void 0,waterMaskTranslationAndScale:new Q.A,minMaxHeight:new q.A,scaleAndBias:new O.A,clippingPlanesEdgeColor:u.A.clone(u.A.WHITE),clippingPlanesEdgeWidth:0,localizedCartographicLimitRectangle:new Q.A,frontFaceAlphaByDistance:new Q.A,backFaceAlphaByDistance:new Q.A,localizedTranslucencyRectangle:new Q.A,undergroundColor:u.A.clone(u.A.TRANSPARENT),undergroundColorAlphaByDistance:new Q.A,lambertDiffuseMultiplier:0,vertexShadowDarkness:0}};return(0,d.A)(t.materialUniformMap)?(0,tC.A)(n,t.materialUniformMap):n}function EN(e,t,n){const i=n.data;let s,a;if((0,d.A)(i.vertexArray)?(s=i.mesh,a=i.vertexArray):(0,d.A)(i.fill)&&(0,d.A)(i.fill.vertexArray)&&(s=i.fill.mesh,a=i.fill.vertexArray),(0,d.A)(s)&&(0,d.A)(a)){if((0,d.A)(i.wireframeVertexArray)){if(i.wireframeVertexArray.mesh===s)return;i.wireframeVertexArray.destroy(),i.wireframeVertexArray=void 0}i.wireframeVertexArray=function(e,t,n){const i={indices:n.indices,primitiveType:p.A.TRIANGLES};Ad.A.toWireframe(i);const s=i.indices,a=o.A.createIndexBuffer({context:e,typedArray:s,usage:r.A.STATIC_DRAW,indexDatatype:Pr.A.fromSizeInBytes(s.BYTES_PER_ELEMENT)});return new je.A({context:e,attributes:t._attributes,indexBuffer:a})}(e,a,s),i.wireframeVertexArray.mesh=s}}let SN,IN,PN;!function(){const e=new yn.A({geometry:fn.A.fromDimensions({dimensions:new j.A(2,2,2)})}),t=new yn.A({geometry:new LR.A({radius:1})});let n,i,o=new O.A;function r(e){return new Pn.A({geometryInstances:e,appearance:new Cn.A({translucent:!1,flat:!0}),asynchronous:!1})}SN=function(t,s){return t===n||(PN(),n=t,o=O.A.fromRotationTranslation(t.halfAxes,t.center,o),e.modelMatrix=o,e.attributes.color=mn.A.fromColor(s),i=r(e)),i},IN=function(e,s){return e===n||(PN(),n=e,o=O.A.fromTranslation(e.center,o),o=O.A.multiplyByUniformScale(o,e.radius,o),t.modelMatrix=o,t.attributes.color=mn.A.fromColor(s),i=r(t)),i},PN=function(){(0,d.A)(i)&&(i.destroy(),i=void 0,n=void 0)}}();const DN=new Q.A(0,0,0,0),ON={frameState:void 0,surfaceTile:void 0,numberOfDayTextures:void 0,applyBrightness:void 0,applyContrast:void 0,applyHue:void 0,applySaturation:void 0,applyGamma:void 0,applyAlpha:void 0,applyDayNightAlpha:void 0,applySplit:void 0,showReflectiveOcean:void 0,showOceanWaves:void 0,enableLighting:void 0,dynamicAtmosphereLighting:void 0,dynamicAtmosphereLightingFromSun:void 0,showGroundAtmosphere:void 0,perFragmentGroundAtmosphere:void 0,hasVertexNormals:void 0,useWebMercatorProjection:void 0,enableFog:void 0,enableClippingPlanes:void 0,clippingPlanes:void 0,enableClippingPolygons:void 0,clippingPolygons:void 0,clippedByBoundaries:void 0,hasImageryLayerCutout:void 0,colorCorrect:void 0,colorToAlpha:void 0,hasGeodeticSurfaceNormals:void 0,hasExaggeration:void 0},RN=u.A.TRANSPARENT,MN=new kt.A;function LN(e,t,n){const i=t.data;(0,d.A)(i.vertexArray)||(void 0===i.fill&&(i.fill=new JL(t)),i.fill.update(e,n));const o=n.creditDisplay,r=i.terrainData;if((0,d.A)(r)&&(0,d.A)(r.credits)){const e=r.credits;for(let t=0,n=e.length;t<n;++t)o.addCreditToNextFrame(e[t])}let s=N.A.maximumTextureImageUnits,a=i.waterMaskTexture,c=i.waterMaskTranslationAndScale;!(0,d.A)(a)&&(0,d.A)(i.fill)&&(a=i.fill.waterMaskTexture,c=i.fill.waterMaskTranslationAndScale);const l=n.cameraUnderground,h=n.globeTranslucencyState,f=h.translucent,g=h.frontFaceAlphaByDistance,_=h.backFaceAlphaByDistance,y=h.rectangle,v=e.undergroundColor??RN,T=e.undergroundColorAlphaByDistance??MN,b=cN(e,n)&&n.mode===Ce.A.SCENE3D&&v.alpha>0&&(T.nearValue>0||T.farValue>0),w=e.lambertDiffuseMultiplier,x=e.vertexShadowDarkness,C=e.hasWaterMask&&(0,d.A)(a),E=C&&e.showWaterEffect,S=e.oceanNormalMap,I=E&&(0,d.A)(S),P=e.terrainProvider,D=(0,d.A)(P)&&e.terrainProvider.hasVertexNormals,R=n.fog.enabled&&n.fog.renderable&&!l,M=e.showGroundAtmosphere&&n.mode===Ce.A.SCENE3D,L=kn.A.castShadows(e.shadows)&&!f,B=kn.A.receiveShadows(e.shadows)&&!f,F=e.hueShift,U=e.saturationShift,k=e.brightnessShift;let V=!(J.A.equalsEpsilon(F,0,J.A.EPSILON7)&&J.A.equalsEpsilon(U,0,J.A.EPSILON7)&&J.A.equalsEpsilon(k,0,J.A.EPSILON7)),z=!1;M&&(z=j.A.magnitude(n.camera.positionWC)>e.nightFadeOutDistance),C&&--s,I&&--s,(0,d.A)(n.shadowState)&&n.shadowState.shadowsEnabled&&--s,(0,d.A)(e.clippingPlanes)&&e.clippingPlanes.enabled&&--s,(0,d.A)(e.clippingPolygons)&&e.clippingPolygons.enabled&&(--s,--s),s-=h.numberOfTextureUniforms;const H=i.renderedMesh;let G=H.center;const W=H.encoding,Y=i.tileBoundingRegion,q=n.verticalExaggeration,X=n.verticalExaggerationRelativeHeight,K=1!==q,$=W.hasGeodeticSurfaceNormals,Z=pN;let ee=0,te=0,ne=0,ie=0,oe=!1;if(n.mode!==Ce.A.SCENE3D){const e=n.mapProjection,i=e.project(Or.A.southwest(t.rectangle),yN),o=e.project(Or.A.northeast(t.rectangle),vN);if(Z.x=i.x,Z.y=i.y,Z.z=o.x,Z.w=o.y,n.mode!==Ce.A.MORPHING&&(G=gN,G.x=0,G.y=.5*(Z.z+Z.x),G.z=.5*(Z.w+Z.y),Z.x-=G.y,Z.y-=G.z,Z.z-=G.y,Z.w-=G.z),n.mode===Ce.A.SCENE2D&&W.quantization===FR.A.BITS12){const e=1/(Math.pow(2,12)-1)*.5,t=(Z.z-Z.x)*e,n=(Z.w-Z.y)*e;Z.x-=t,Z.y-=n,Z.z+=t,Z.w+=n}e instanceof oM.A&&(ee=t.rectangle.south,te=t.rectangle.north,ne=oM.A.geodeticLatitudeToMercatorAngle(ee),ie=1/(oM.A.geodeticLatitudeToMercatorAngle(te)-ne),oe=!0)}const re=ON;re.frameState=n,re.surfaceTile=i,re.hasWaterMask=C,re.showReflectiveOcean=E,re.showOceanWaves=I,re.enableLighting=e.enableLighting,re.dynamicAtmosphereLighting=e.dynamicAtmosphereLighting,re.dynamicAtmosphereLightingFromSun=e.dynamicAtmosphereLightingFromSun,re.showGroundAtmosphere=M,re.atmosphereLightIntensity=e.atmosphereLightIntensity,re.atmosphereRayleighCoefficient=e.atmosphereRayleighCoefficient,re.atmosphereMieCoefficient=e.atmosphereMieCoefficient,re.atmosphereRayleighScaleHeight=e.atmosphereRayleighScaleHeight,re.atmosphereMieScaleHeight=e.atmosphereMieScaleHeight,re.atmosphereMieAnisotropy=e.atmosphereMieAnisotropy,re.perFragmentGroundAtmosphere=z,re.hasVertexNormals=D,re.useWebMercatorProjection=oe,re.clippedByBoundaries=i.clippedByBoundaries,re.hasGeodeticSurfaceNormals=$,re.hasExaggeration=K;const se=i.imagery;let ae=0;const ce=se.length,le=e.showSkirts&&!l&&!f,ue=e.backFaceCulling&&!l&&!f,de=ue?e._renderState:e._disableCullingRenderState,he=ue?e._blendRenderState:e._disableCullingBlendRenderState;let Ae=de,pe=e._firstPassInitialColor;const fe=n.context;if((0,d.A)(e._debug.boundingSphereTile)||PN(),e._materialUniformMap!==e.materialUniformMap){e._materialUniformMap=e.materialUniformMap;const t=e._drawCommands.length;for(let i=0;i<t;++i)e._uniformMaps[i]=CN(n,e)}do{let r,C,E=0;if(e._drawCommands.length<=e._usedDrawCommands?(r=new m.A,r.owner=t,r.cull=!1,r.boundingVolume=new Sn.A,r.orientedBoundingBox=void 0,C=CN(n,e),e._drawCommands.push(r),e._uniformMaps.push(C)):(r=e._drawCommands[e._usedDrawCommands],C=e._uniformMaps[e._usedDrawCommands]),r.owner=t,++e._usedDrawCommands,t===e._debug.boundingSphereTile){const e=Y.boundingVolume,t=Y.boundingSphere;(0,d.A)(e)?SN(e,u.A.RED).update(n):(0,d.A)(t)&&IN(t,u.A.RED).update(n)}const I=C.properties;Q.A.clone(pe,I.initialColor),I.oceanNormalMap=S,I.lightingFadeDistance.x=e.lightingFadeOutDistance,I.lightingFadeDistance.y=e.lightingFadeInDistance,I.nightFadeDistance.x=e.nightFadeOutDistance,I.nightFadeDistance.y=e.nightFadeInDistance,I.atmosphereLightIntensity=e.atmosphereLightIntensity,I.atmosphereRayleighCoefficient=e.atmosphereRayleighCoefficient,I.atmosphereMieCoefficient=e.atmosphereMieCoefficient,I.atmosphereRayleighScaleHeight=e.atmosphereRayleighScaleHeight,I.atmosphereMieScaleHeight=e.atmosphereMieScaleHeight,I.atmosphereMieAnisotropy=e.atmosphereMieAnisotropy,I.zoomedOutOceanSpecularIntensity=e.zoomedOutOceanSpecularIntensity;const P=l?_:g,D=l?g:_;(0,d.A)(P)&&(Q.A.fromElements(P.near,P.nearValue,P.far,P.farValue,I.frontFaceAlphaByDistance),Q.A.fromElements(D.near,D.nearValue,D.far,D.farValue,I.backFaceAlphaByDistance)),Q.A.fromElements(T.near,T.nearValue,T.far,T.farValue,I.undergroundColorAlphaByDistance),u.A.clone(v,I.undergroundColor),I.lambertDiffuseMultiplier=w,I.vertexShadowDarkness=x;const N=!(0,d.A)(i.vertexArray)&&(0,d.A)(e.fillHighlightColor)&&e.fillHighlightColor.alpha>0;N&&u.A.clone(e.fillHighlightColor,I.fillHighlightColor),I.verticalExaggerationAndRelativeHeight.x=q,I.verticalExaggerationAndRelativeHeight.y=X,I.center3D=H.center,j.A.clone(G,I.rtc),Q.A.clone(Z,I.tileRectangle),I.southAndNorthLatitude.x=ee,I.southAndNorthLatitude.y=te,I.southMercatorYAndOneOverHeight.x=ne,I.southMercatorYAndOneOverHeight.y=ie;const z=fN,K=aN(t.rectangle,e.cartographicLimitRectangle),$=mN,oe=aN(t.rectangle,y);j.A.fromElements(F,U,k,I.hsbShift);const ue=t.rectangle,de=1/ue.width,me=1/ue.height;z.x=(K.west-ue.west)*de,z.y=(K.south-ue.south)*me,z.z=(K.east-ue.west)*de,z.w=(K.north-ue.south)*me,Q.A.clone(z,I.localizedCartographicLimitRectangle),$.x=(oe.west-ue.west)*de,$.y=(oe.south-ue.south)*me,$.z=(oe.east-ue.west)*de,$.w=(oe.north-ue.south)*me,Q.A.clone($,I.localizedTranslucencyRectangle);const ge=R&&J.A.fog(t._distance,n.fog.density)>J.A.EPSILON3;V=V&&(ge||M);let _e=!1,ye=!1,ve=!1,Te=!1,be=!1,we=!1,xe=!1,Ee=!1,Se=!1,Ie=!1;for(;E<s&&ae<ce;){const e=se[ae],n=e.readyImagery;if(++ae,!(0,d.A)(n)||0===n.imageryLayer.alpha)continue;const i=e.useWebMercatorT?n.textureWebMercator:n.texture;if(!(0,d.A)(i))throw new A.A("readyImagery is not actually ready!");const r=n.imageryLayer;(0,d.A)(e.textureTranslationAndScale)||(e.textureTranslationAndScale=r._calculateTextureTranslationAndScale(t,e)),I.dayTextures[E]=i,I.dayTextureTranslationAndScale[E]=e.textureTranslationAndScale,I.dayTextureTexCoordsRectangle[E]=e.textureCoordinateRectangle,I.dayTextureUseWebMercatorT[E]=e.useWebMercatorT,I.dayTextureAlpha[E]=r.alpha,we=we||1!==I.dayTextureAlpha[E],I.dayTextureNightAlpha[E]=r.nightAlpha,xe=xe||1!==I.dayTextureNightAlpha[E],I.dayTextureDayAlpha[E]=r.dayAlpha,xe=xe||1!==I.dayTextureDayAlpha[E],I.dayTextureBrightness[E]=r.brightness,_e=_e||I.dayTextureBrightness[E]!==hL.A.DEFAULT_BRIGHTNESS,I.dayTextureContrast[E]=r.contrast,ye=ye||I.dayTextureContrast[E]!==hL.A.DEFAULT_CONTRAST,I.dayTextureHue[E]=r.hue,ve=ve||I.dayTextureHue[E]!==hL.A.DEFAULT_HUE,I.dayTextureSaturation[E]=r.saturation,Te=Te||I.dayTextureSaturation[E]!==hL.A.DEFAULT_SATURATION,I.dayTextureOneOverGamma[E]=1/r.gamma,be=be||I.dayTextureOneOverGamma[E]!==1/hL.A.DEFAULT_GAMMA,I.dayTextureSplit[E]=r.splitDirection,Ee=Ee||0!==I.dayTextureSplit[E];let s=I.dayTextureCutoutRectangles[E];if((0,d.A)(s)||(s=I.dayTextureCutoutRectangles[E]=new Q.A),Q.A.clone(Q.A.ZERO,s),(0,d.A)(r.cutoutRectangle)){const e=aN(ue,r.cutoutRectangle),t=Or.A.simpleIntersection(e,ue,oN);Se=(0,d.A)(t)||Se,s.x=(e.west-ue.west)*de,s.y=(e.south-ue.south)*me,s.z=(e.east-ue.west)*de,s.w=(e.north-ue.south)*me}let a=I.colorsToAlpha[E];(0,d.A)(a)||(a=I.colorsToAlpha[E]=new Q.A);const c=(0,d.A)(r.colorToAlpha)&&r.colorToAlphaThreshold>0;if(Ie=Ie||c,c){const e=r.colorToAlpha;a.x=e.red,a.y=e.green,a.z=e.blue,a.w=r.colorToAlphaThreshold}else a.w=-1;if((0,d.A)(n.credits)){const e=n.credits;for(let t=0,n=e.length;t<n;++t)o.addCreditToNextFrame(e[t])}++E}I.dayTextures.length=E,I.waterMask=a,Q.A.clone(c,I.waterMaskTranslationAndScale),I.minMaxHeight.x=W.minimumHeight,I.minMaxHeight.y=W.maximumHeight,O.A.clone(W.matrix,I.scaleAndBias);const Pe=e._clippingPlanes,De=(0,d.A)(Pe)&&Pe.enabled&&t.isClipped;De&&(I.clippingPlanesEdgeColor=u.A.clone(Pe.edgeColor,I.clippingPlanesEdgeColor),I.clippingPlanesEdgeWidth=Pe.edgeWidth);const Oe=e._clippingPolygons,Re=(0,d.A)(Oe)&&Oe.enabled&&t.isClipped;re.numberOfDayTextures=E,re.applyBrightness=_e,re.applyContrast=ye,re.applyHue=ve,re.applySaturation=Te,re.applyGamma=be,re.applyAlpha=we,re.applyDayNightAlpha=xe,re.applySplit=Ee,re.enableFog=ge,re.enableClippingPlanes=De,re.clippingPlanes=Pe,re.enableClippingPolygons=Re,re.clippingPolygons=Oe,re.hasImageryLayerCutout=Se,re.colorCorrect=V,re.highlightFillTile=N,re.colorToAlpha=Ie,re.showUndergroundColor=b,re.translucent=f;let Me=i.renderedMesh.indices.length;le||(Me=i.renderedMesh.indexCountWithoutSkirts),r.shaderProgram=e._surfaceShaderSet.getShaderProgram(re),r.castShadows=L,r.receiveShadows=B,r.renderState=Ae,r.primitiveType=p.A.TRIANGLES,r.vertexArray=i.vertexArray||i.fill.vertexArray,r.count=Me,r.uniformMap=C,r.pass=ut.A.GLOBE,e._debug.wireframe&&(EN(fe,0,t),(0,d.A)(i.wireframeVertexArray)&&(r.vertexArray=i.wireframeVertexArray,r.primitiveType=p.A.LINES,r.count=2*Me));let Le=r.boundingVolume;const Ne=r.orientedBoundingBox;n.mode!==Ce.A.SCENE3D?(Sn.A.fromRectangleWithHeights2D(t.rectangle,n.mapProjection,Y.minimumHeight,Y.maximumHeight,Le),j.A.fromElements(Le.center.z,Le.center.x,Le.center.y,Le.center),n.mode===Ce.A.MORPHING&&(Le=Sn.A.union(Y.boundingSphere,Le,Le))):(r.boundingVolume=Sn.A.clone(Y.boundingSphere,Le),r.orientedBoundingBox=lD.A.clone(Y.boundingVolume,Ne)),r.dirty=!0,f&&h.updateDerivedCommands(r,n),nN(r,n),Ae=he,pe=DN}while(ae<ce)}const NN=eN;function BN(){this._enabled=!1,this._frontFaceAlpha=1,this._frontFaceAlphaByDistance=void 0,this._backFaceAlpha=1,this._backFaceAlphaByDistance=void 0,this._rectangle=Or.A.clone(Or.A.MAX_VALUE)}Object.defineProperties(BN.prototype,{enabled:{get:function(){return this._enabled},set:function(e){l.A.typeOf.bool("enabled",e),this._enabled=e}},frontFaceAlpha:{get:function(){return this._frontFaceAlpha},set:function(e){l.A.typeOf.number.greaterThanOrEquals("frontFaceAlpha",e,0),l.A.typeOf.number.lessThanOrEquals("frontFaceAlpha",e,1),this._frontFaceAlpha=e}},frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance},set:function(e){if((0,d.A)(e)&&e.far<e.near)throw new A.A("far distance must be greater than near distance.");this._frontFaceAlphaByDistance=kt.A.clone(e,this._frontFaceAlphaByDistance)}},backFaceAlpha:{get:function(){return this._backFaceAlpha},set:function(e){l.A.typeOf.number.greaterThanOrEquals("backFaceAlpha",e,0),l.A.typeOf.number.lessThanOrEquals("backFaceAlpha",e,1),this._backFaceAlpha=e}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance},set:function(e){if((0,d.A)(e)&&e.far<e.near)throw new A.A("far distance must be greater than near distance.");this._backFaceAlphaByDistance=kt.A.clone(e,this._backFaceAlphaByDistance)}},rectangle:{get:function(){return this._rectangle},set:function(e){(0,d.A)(e)||(e=Or.A.clone(Or.A.MAX_VALUE)),Or.A.clone(e,this._rectangle)}}});const FN=BN;var UN=n(869327);function kN(e){this._ellipsoid=new cP.A(e.ellipsoid,j.A.ZERO)}Object.defineProperties(kN.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});const VN=kN;class zN{constructor(e){this.maxSize=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}clear(){this.cache.clear()}}function HN(e){if(!(0,d.A)(e))throw new A.A("options is required.");if(!(0,d.A)(e.x))throw new A.A("options.x is required.");if(!(0,d.A)(e.y))throw new A.A("options.y is required.");if(e.x<0||e.y<0)throw new A.A("options.x and options.y must be greater than or equal to zero.");if(!(0,d.A)(e.level))throw new A.A("options.level is required and must be greater than or equal to zero.");if(!(0,d.A)(e.tilingScheme))throw new A.A("options.tilingScheme is required.");this._tilingScheme=e.tilingScheme,this._x=e.x,this._y=e.y,this._level=e.level,this._parent=e.parent,this._rectangle=this._tilingScheme.tileXYToRectangle(this._x,this._y,this._level),this._southwestChild=void 0,this._southeastChild=void 0,this._northwestChild=void 0,this._northeastChild=void 0,this.replacementPrevious=void 0,this.replacementNext=void 0,this._distance=0,this._loadPriority=0,this._customData=[],this._frameUpdated=void 0,this._lastSelectionResult=pL.NONE,this._lastSelectionResultFrame=void 0,this._loadedCallbacks={},this._positionCache=new zN(1e3),this.state=tL.START,this.renderable=!1,this.upsampledFromParent=!1,this.data=void 0}function GN(e){(0,d.A)(e)&&e.freeResources()}HN.createLevelZeroTiles=function(e){if(!(0,d.A)(e))throw new A.A("tilingScheme is required.");const t=e.getNumberOfXTilesAtLevel(0),n=e.getNumberOfYTilesAtLevel(0),i=new Array(t*n);let o=0;for(let r=0;r<n;++r)for(let n=0;n<t;++n)i[o++]=new HN({tilingScheme:e,x:n,y:r,level:0});return i},HN.prototype._getCacheKey=function(e,t){return function(e,t,n,i){const o=n.width/256*i,r=Math.floor(e/o)*o,s=Math.floor(t/o)*o;return`${r.toFixed(10)},${s.toFixed(10)}`}(e.longitude,e.latitude,this._rectangle,t)},HN.prototype.getPositionCacheEntry=function(e,t){return this._positionCache.get(this._getCacheKey(e,t))},HN.prototype.setPositionCacheEntry=function(e,t,n){this._positionCache.set(this._getCacheKey(e,t),n)},HN.prototype.clearPositionCache=function(){this._positionCache.size>0&&this._positionCache.clear()},HN.prototype._updateCustomData=function(e,t,n){let i,o,r,s=this.customData;if((0,d.A)(t)&&(0,d.A)(n)){for(s=s.filter(function(e){return-1===n.indexOf(e)}),this._customData=s,r=this._rectangle,i=0;i<t.length;++i)o=t[i],Or.A.contains(r,o.positionCartographic)&&s.push(o);this._frameUpdated=e}else{const e=this._parent;if((0,d.A)(e)&&this._frameUpdated!==e._frameUpdated){s.length=0,r=this._rectangle;const t=e.customData;for(i=0;i<t.length;++i)o=t[i],Or.A.contains(r,o.positionCartographic)&&s.push(o);this._frameUpdated=e._frameUpdated}}},Object.defineProperties(HN.prototype,{tilingScheme:{get:function(){return this._tilingScheme}},x:{get:function(){return this._x}},y:{get:function(){return this._y}},level:{get:function(){return this._level}},parent:{get:function(){return this._parent}},rectangle:{get:function(){return this._rectangle}},children:{get:function(){return[this.northwestChild,this.northeastChild,this.southwestChild,this.southeastChild]}},southwestChild:{get:function(){return(0,d.A)(this._southwestChild)||(this._southwestChild=new HN({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y+1,level:this.level+1,parent:this})),this._southwestChild}},southeastChild:{get:function(){return(0,d.A)(this._southeastChild)||(this._southeastChild=new HN({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y+1,level:this.level+1,parent:this})),this._southeastChild}},northwestChild:{get:function(){return(0,d.A)(this._northwestChild)||(this._northwestChild=new HN({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y,level:this.level+1,parent:this})),this._northwestChild}},northeastChild:{get:function(){return(0,d.A)(this._northeastChild)||(this._northeastChild=new HN({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y,level:this.level+1,parent:this})),this._northeastChild}},customData:{get:function(){return this._customData}},needsLoading:{get:function(){return this.state<tL.DONE}},eligibleForUnloading:{get:function(){let e=!0;return(0,d.A)(this.data)&&(e=this.data.eligibleForUnloading,(0,d.A)(e)||(e=!0)),e}}}),HN.prototype.findLevelZeroTile=function(e,t,n){const i=this.tilingScheme.getNumberOfXTilesAtLevel(0);if(t<0?t+=i:t>=i&&(t-=i),!(n<0||n>=this.tilingScheme.getNumberOfYTilesAtLevel(0)))return e.filter(function(e){return e.x===t&&e.y===n})[0]},HN.prototype.findTileToWest=function(e){const t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x-1,this.y);if(t.southeastChild===this)return t.southwestChild;if(t.northeastChild===this)return t.northwestChild;const n=t.findTileToWest(e);return void 0!==n?t.southwestChild===this?n.southeastChild:n.northeastChild:void 0},HN.prototype.findTileToEast=function(e){const t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x+1,this.y);if(t.southwestChild===this)return t.southeastChild;if(t.northwestChild===this)return t.northeastChild;const n=t.findTileToEast(e);return void 0!==n?t.southeastChild===this?n.southwestChild:n.northwestChild:void 0},HN.prototype.findTileToSouth=function(e){const t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x,this.y+1);if(t.northwestChild===this)return t.southwestChild;if(t.northeastChild===this)return t.southeastChild;const n=t.findTileToSouth(e);return void 0!==n?t.southwestChild===this?n.northwestChild:n.northeastChild:void 0},HN.prototype.findTileToNorth=function(e){const t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x,this.y-1);if(t.southwestChild===this)return t.northwestChild;if(t.southeastChild===this)return t.northeastChild;const n=t.findTileToNorth(e);return void 0!==n?t.northwestChild===this?n.southwestChild:n.southeastChild:void 0},HN.prototype.freeResources=function(){this.clearPositionCache(),this.state=tL.START,this.renderable=!1,this.upsampledFromParent=!1,(0,d.A)(this.data)&&(0,d.A)(this.data.freeResources)&&this.data.freeResources(),GN(this._southwestChild),this._southwestChild=void 0,GN(this._southeastChild),this._southeastChild=void 0,GN(this._northwestChild),this._northwestChild=void 0,GN(this._northeastChild),this._northeastChild=void 0};const WN=HN;function YN(){this.head=void 0,this.tail=void 0,this.count=0,this._lastBeforeStartOfFrame=void 0}function qN(e,t){const n=t.replacementPrevious,i=t.replacementNext;t===e._lastBeforeStartOfFrame&&(e._lastBeforeStartOfFrame=i),t===e.head?e.head=i:n.replacementNext=i,t===e.tail?e.tail=n:i.replacementPrevious=n,t.replacementPrevious=void 0,t.replacementNext=void 0,--e.count}YN.prototype.markStartOfRenderFrame=function(){this._lastBeforeStartOfFrame=this.head},YN.prototype.trimTiles=function(e){let t=this.tail,n=!0;for(;n&&(0,d.A)(this._lastBeforeStartOfFrame)&&this.count>e&&(0,d.A)(t);){n=t!==this._lastBeforeStartOfFrame;const e=t.replacementPrevious;t.eligibleForUnloading&&(t.freeResources(),qN(this,t)),t=e}},YN.prototype.markTileRendered=function(e){const t=this.head;if(t!==e){if(++this.count,!(0,d.A)(t))return e.replacementPrevious=void 0,e.replacementNext=void 0,this.head=e,void(this.tail=e);((0,d.A)(e.replacementPrevious)||(0,d.A)(e.replacementNext))&&qN(this,e),e.replacementPrevious=void 0,e.replacementNext=t,t.replacementPrevious=e,this.head=e}else e===this._lastBeforeStartOfFrame&&(this._lastBeforeStartOfFrame=e.replacementNext)};const jN=YN;function QN(e){if(!(0,d.A)(e)||!(0,d.A)(e.tileProvider))throw new A.A("options.tileProvider is required.");if((0,d.A)(e.tileProvider.quadtree))throw new A.A("A QuadtreeTileProvider can only be used with a single QuadtreePrimitive");this._tileProvider=e.tileProvider,this._tileProvider.quadtree=this,this._debug={enableDebugOutput:!1,maxDepth:0,maxDepthVisited:0,tilesVisited:0,tilesCulled:0,tilesRendered:0,tilesWaitingForChildren:0,lastMaxDepth:-1,lastMaxDepthVisited:-1,lastTilesVisited:-1,lastTilesCulled:-1,lastTilesRendered:-1,lastTilesWaitingForChildren:-1,suspendLodUpdate:!1};const t=this._tileProvider.tilingScheme.ellipsoid;this._tilesToRender=[],this._tileLoadQueueHigh=[],this._tileLoadQueueMedium=[],this._tileLoadQueueLow=[],this._tileReplacementQueue=new jN,this._levelZeroTiles=void 0,this._loadQueueTimeSlice=5,this._tilesInvalidated=!1,this._addHeightCallbacks=[],this._removeHeightCallbacks=[],this._tileToUpdateHeights=[],this._lastTileIndex=0,this._updateHeightsTimeSlice=2,this._cameraPositionCartographic=void 0,this._cameraReferenceFrameOriginCartographic=void 0,this.maximumScreenSpaceError=e.maximumScreenSpaceError??2,this.tileCacheSize=e.tileCacheSize??100,this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this._occluders=new VN({ellipsoid:t}),this._tileLoadProgressEvent=new Bn.A,this._lastTileLoadQueueLength=0,this._lastSelectionFrameNumber=void 0}function XN(e){const t=e._debug;t.maxDepth=0,t.maxDepthVisited=0,t.tilesVisited=0,t.tilesCulled=0,t.tilesRendered=0,t.tilesWaitingForChildren=0,e._tileLoadQueueHigh.length=0,e._tileLoadQueueMedium.length=0,e._tileLoadQueueLow.length=0}let KN;Object.defineProperties(QN.prototype,{tileProvider:{get:function(){return this._tileProvider}},tileLoadProgressEvent:{get:function(){return this._tileLoadProgressEvent}},occluders:{get:function(){return this._occluders}}}),QN.prototype.invalidateAllTiles=function(){this._tilesInvalidated=!0},QN.prototype.forEachLoadedTile=function(e){let t=this._tileReplacementQueue.head;for(;(0,d.A)(t);)t.state!==tL.START&&e(t),t=t.replacementNext},QN.prototype.forEachRenderedTile=function(e){const t=this._tilesToRender;for(let n=0,i=t.length;n<i;++n)e(t[n])},QN.prototype.updateHeight=function(e,t){const n=this,i={positionOnEllipsoidSurface:void 0,positionCartographic:e,level:-1,callback:t,removeFunc:function(){const e=n._addHeightCallbacks,t=e.length;for(let n=0;n<t;++n)if(e[n]===i){e.splice(n,1);break}n._removeHeightCallbacks.push(i),i.callback&&(i.callback=void 0)}};return n._addHeightCallbacks.push(i),i.removeFunc},QN.prototype.update=function(e){(0,d.A)(this._tileProvider.update)&&this._tileProvider.update(e)},QN.prototype.beginFrame=function(e){e.passes.render&&(this._tilesInvalidated&&(function(e){const t=e._tileReplacementQueue;t.head=void 0,t.tail=void 0,t.count=0,XN(e);const n=e._levelZeroTiles;if((0,d.A)(n))for(let t=0;t<n.length;++t){const i=n[t].customData,o=i.length;for(let t=0;t<o;++t){const n=i[t];n.level=0,e._addHeightCallbacks.push(n)}n[t].freeResources()}e._levelZeroTiles=void 0,e._tileProvider.cancelReprojections()}(this),this._tilesInvalidated=!1),this._tileProvider.initialize(e),XN(this),this._debug.suspendLodUpdate||this._tileReplacementQueue.markStartOfRenderFrame())},QN.prototype.render=function(e){const t=e.passes,n=this._tileProvider;t.render&&(n.beginUpdate(e),function(e,t){const n=e._debug;if(n.suspendLodUpdate)return;let i;e._tilesToRender.length=0;const o=e._tileProvider;if(!(0,d.A)(e._levelZeroTiles)){const t=o.tilingScheme;if(!(0,d.A)(t))return;{const t=o.tilingScheme;e._levelZeroTiles=WN.createLevelZeroTiles(t);const n=e._levelZeroTiles.length;if(eB.length<n)for(eB=new Array(n),i=0;i<n;++i)void 0===eB[i]&&(eB[i]=new nB)}}let r;e._occluders.ellipsoid.cameraPosition=t.camera.positionWC;const s=e._levelZeroTiles,a=s.length>1?e._occluders:void 0;KN=t.camera.positionCartographic,s.sort(JN);const c=e._addHeightCallbacks,l=e._removeHeightCallbacks,u=t.frameNumber;let h;if(c.length>0||l.length>0){for(i=0,h=s.length;i<h;++i)r=s[i],r._updateCustomData(u,c,l);c.length=0,l.length=0}const A=t.camera;e._cameraPositionCartographic=A.positionCartographic;const p=O.A.getTranslation(A.transform,ZN);for(e._cameraReferenceFrameOriginCartographic=e.tileProvider.tilingScheme.ellipsoid.cartesianToCartographic(p,e._cameraReferenceFrameOriginCartographic),i=0,h=s.length;i<h;++i)r=s[i],e._tileReplacementQueue.markTileRendered(r),r.renderable?rB(e,r,o,t,a,!1,eB[i]):(tB(e,e._tileLoadQueueHigh,r,t),++n.tilesWaitingForChildren);e._lastSelectionFrameNumber=u}(this,e),function(e,t){const n=e._tileProvider,i=e._tilesToRender;for(let e=0,o=i.length;e<o;++e){const o=i[e];n.showTileThisFrame(o,t)}}(this,e),n.endUpdate(e)),t.pick&&this._tilesToRender.length>0&&n.updateForPick(e)},QN.prototype.endFrame=function(e){e.passes.render&&e.mode!==Ce.A.MORPHING&&(function(e,t){const n=e._tileLoadQueueHigh,i=e._tileLoadQueueMedium,o=e._tileLoadQueueLow;if(0===n.length&&0===i.length&&0===o.length)return;e._tileReplacementQueue.trimTiles(e.tileCacheSize);const r=(0,aa.A)()+e._loadQueueTimeSlice,s=e._tileProvider;let a=cB(e,t,s,r,n,!1);a=cB(e,t,s,r,i,a),cB(e,t,s,r,o,a)}(this,e),function(e,t){if(!(0,d.A)(e.tileProvider.tilingScheme))return;const n=hB;n.length=0;const i=e._tileToUpdateHeights,o=(0,aa.A)()+e._updateHeightsTimeSlice,r=t.mode,s=t.mapProjection,a=e.tileProvider.tilingScheme.ellipsoid;let c;for(;i.length>0;){const t=i[0];if(!(0,d.A)(t.data)||!(0,d.A)(t.data.mesh)){const o=t._lastSelectionResultFrame===e._lastSelectionFrameNumber?t._lastSelectionResult:pL.NONE;o!==pL.RENDERED&&o!==pL.CULLED_BUT_NEEDED||n.push(t),t.clearPositionCache(),i.shift(),e._lastTileIndex=0;continue}const l=t.customData,u=l.length;let h=!1;for(c=e._lastTileIndex;c<u;++c){const n=l[c],i=t.data.terrainData,u=(0,d.A)(i)&&i.wasCreatedByUpsampling();if(t.level>n.level&&!u){let i;const o=t.getPositionCacheEntry(n.positionCartographic,e.maximumScreenSpaceError);if((0,d.A)(o))i=o;else{if((0,d.A)(n.positionOnEllipsoidSurface)||(n.positionOnEllipsoidSurface=j.A.fromRadians(n.positionCartographic.longitude,n.positionCartographic.latitude,0,a)),r===Ce.A.SCENE3D){const e=a.geodeticSurfaceNormal(n.positionOnEllipsoidSurface,lB.direction),i=a.getSurfaceNormalIntersectionWithZAxis(n.positionOnEllipsoidSurface,11500,lB.origin);if(!(0,d.A)(i)){let i=0;(0,d.A)(t.data.tileBoundingRegion)&&(i=t.data.tileBoundingRegion.minimumHeight);const o=Math.min(i,-11500),r=j.A.multiplyByScalar(e,Math.abs(o)+1,dB);j.A.subtract(n.positionOnEllipsoidSurface,r,lB.origin)}}else X.A.clone(n.positionCartographic,uB),uB.height=-11500,s.project(uB,dB),j.A.fromElements(dB.z,dB.x,dB.y,dB),j.A.clone(dB,lB.origin),j.A.clone(j.A.UNIT_X,lB.direction);i=t.data.pick(lB,r,s,!1,dB),(0,d.A)(i)&&t.setPositionCacheEntry(n.positionCartographic,e.maximumScreenSpaceError,i)}if((0,d.A)(i)){if((0,d.A)(n.callback)){const e=a.cartesianToCartographic(i,uB);n.callback(e)}n.level=t.level}}if((0,aa.A)()>=o){h=!0;break}}if(h){e._lastTileIndex=c;break}e._lastTileIndex=0,i.shift()}for(c=0;c<n.length;c++)i.push(n[c])}(this,e),function(e,t){const n=e._tileLoadQueueHigh.length+e._tileLoadQueueMedium.length+e._tileLoadQueueLow.length;if(n!==e._lastTileLoadQueueLength||e._tilesInvalidated){const i=Bn.A.prototype.raiseEvent.bind(e._tileLoadProgressEvent,n);t.afterRender.push(()=>(i(),!0)),e._lastTileLoadQueueLength=n}const i=e._debug;i.enableDebugOutput&&!i.suspendLodUpdate&&(i.maxDepth=e._tilesToRender.reduce(function(e,t){return Math.max(e,t.level)},-1),i.tilesRendered=e._tilesToRender.length,i.tilesVisited===i.lastTilesVisited&&i.tilesRendered===i.lastTilesRendered&&i.tilesCulled===i.lastTilesCulled&&i.maxDepth===i.lastMaxDepth&&i.tilesWaitingForChildren===i.lastTilesWaitingForChildren&&i.maxDepthVisited===i.lastMaxDepthVisited||(console.log(`Visited ${i.tilesVisited}, Rendered: ${i.tilesRendered}, Culled: ${i.tilesCulled}, Max Depth Rendered: ${i.maxDepth}, Max Depth Visited: ${i.maxDepthVisited}, Waiting for children: ${i.tilesWaitingForChildren}`),i.lastTilesVisited=i.tilesVisited,i.lastTilesRendered=i.tilesRendered,i.lastTilesCulled=i.tilesCulled,i.lastMaxDepth=i.maxDepth,i.lastTilesWaitingForChildren=i.tilesWaitingForChildren,i.lastMaxDepthVisited=i.maxDepthVisited))}(this,e))},QN.prototype.isDestroyed=function(){return!1},QN.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy()};const $N=new X.A;function JN(e,t){let n=Or.A.center(e.rectangle,$N);const i=n.longitude-KN.longitude,o=n.latitude-KN.latitude;n=Or.A.center(t.rectangle,$N);const r=n.longitude-KN.longitude,s=n.latitude-KN.latitude;return i*i+o*o-(r*r+s*s)}const ZN=new j.A;let eB=[];function tB(e,t,n,i){n.needsLoading&&(void 0!==e.tileProvider.computeTileLoadPriority&&(n._loadPriority=e.tileProvider.computeTileLoadPriority(n,i)),t.push(n))}function nB(){this.allAreRenderable=!0,this.anyWereRenderedLastFrame=!1,this.notYetRenderableCount=0}function iB(){this.southwest=new nB,this.southeast=new nB,this.northwest=new nB,this.northeast=new nB}iB.prototype.combine=function(e){const t=this.southwest,n=this.southeast,i=this.northwest,o=this.northeast;e.allAreRenderable=t.allAreRenderable&&n.allAreRenderable&&i.allAreRenderable&&o.allAreRenderable,e.anyWereRenderedLastFrame=t.anyWereRenderedLastFrame||n.anyWereRenderedLastFrame||i.anyWereRenderedLastFrame||o.anyWereRenderedLastFrame,e.notYetRenderableCount=t.notYetRenderableCount+n.notYetRenderableCount+i.notYetRenderableCount+o.notYetRenderableCount};const oB=new Array(31);for(let e=0;e<oB.length;++e)oB[e]=new iB;function rB(e,t,n,i,o,r,s){if(n.computeTileVisibility(t,i,o)!==WO.NONE)return function(e,t,n,i,o){const r=e._debug;++r.tilesVisited,e._tileReplacementQueue.markTileRendered(n),n._updateCustomData(t.frameNumber),n.level>r.maxDepthVisited&&(r.maxDepthVisited=n.level);const s=function(e,t,n){if(t.mode===Ce.A.SCENE2D||t.camera.frustum instanceof ee.A||t.camera.frustum instanceof aR.A)return function(e,t,n){let i=t.camera.frustum;const o=i.offCenterFrustum;(0,d.A)(o)&&(i=o);const r=t.context,s=r.drawingBufferWidth,a=r.drawingBufferHeight;let c=e._tileProvider.getLevelMaximumGeometricError(n.level)/(Math.max(i.top-i.bottom,i.right-i.left)/Math.max(s,a));return t.fog.enabled&&t.mode!==Ce.A.SCENE2D&&(c-=J.A.fog(n._distance,t.fog.density)*t.fog.sse),c/=t.pixelRatio,c}(e,t,n);const i=e._tileProvider.getLevelMaximumGeometricError(n.level),o=n._distance;let r=i*t.context.drawingBufferHeight/(o*t.camera.frustum.sseDenominator);return t.fog.enabled&&(r-=J.A.fog(o,t.fog.density)*t.fog.sse),r/=t.pixelRatio,r}(e,t,n)<e.maximumScreenSpaceError,a=n.southwestChild,c=n.southeastChild,l=n.northwestChild,u=n.northeastChild,h=e._lastSelectionFrameNumber,A=n._lastSelectionResultFrame===h?n._lastSelectionResult:pL.NONE,p=e.tileProvider;if(s||i){const r=pL.originalResult(A)===pL.RENDERED,a=pL.originalResult(A)===pL.CULLED||A===pL.NONE,c=n.state===tL.DONE;let l=r||a||c;if(l||(0,d.A)(p.canRenderWithoutLosingDetail)&&(l=p.canRenderWithoutLosingDetail(n)),l)return s&&tB(e,e._tileLoadQueueMedium,n,t),sB(e,n),o.allAreRenderable=n.renderable,o.anyWereRenderedLastFrame=A===pL.RENDERED,o.notYetRenderableCount=n.renderable?0:1,n._lastSelectionResultFrame=t.frameNumber,n._lastSelectionResult=pL.RENDERED,void(o.anyWereRenderedLastFrame||e._tileToUpdateHeights.push(n));i=!0,s&&tB(e,e._tileLoadQueueHigh,n,t)}if(p.canRefine(n)){if(a.upsampledFromParent&&c.upsampledFromParent&&l.upsampledFromParent&&u.upsampledFromParent)return sB(e,n),tB(e,e._tileLoadQueueMedium,n,t),e._tileReplacementQueue.markTileRendered(a),e._tileReplacementQueue.markTileRendered(c),e._tileReplacementQueue.markTileRendered(l),e._tileReplacementQueue.markTileRendered(u),o.allAreRenderable=n.renderable,o.anyWereRenderedLastFrame=A===pL.RENDERED,o.notYetRenderableCount=n.renderable?0:1,n._lastSelectionResultFrame=t.frameNumber,n._lastSelectionResult=pL.RENDERED,void(o.anyWereRenderedLastFrame||e._tileToUpdateHeights.push(n));n._lastSelectionResultFrame=t.frameNumber,n._lastSelectionResult=pL.REFINED;const s=e._tilesToRender.length,d=e._tileLoadQueueLow.length,h=e._tileLoadQueueMedium.length,p=e._tileLoadQueueHigh.length,f=e._tileToUpdateHeights.length;if(function(e,t,n,i,o,r,s,a){const c=r.camera.positionCartographic,l=e._tileProvider,u=e._occluders,d=oB[t.level],h=d.southwest,A=d.southeast,p=d.northwest,f=d.northeast;c.longitude<t.rectangle.east?c.latitude<t.rectangle.north?(rB(e,t,l,r,u,s,h),rB(e,n,l,r,u,s,A),rB(e,i,l,r,u,s,p),rB(e,o,l,r,u,s,f)):(rB(e,i,l,r,u,s,p),rB(e,t,l,r,u,s,h),rB(e,o,l,r,u,s,f),rB(e,n,l,r,u,s,A)):c.latitude<t.rectangle.north?(rB(e,n,l,r,u,s,A),rB(e,t,l,r,u,s,h),rB(e,o,l,r,u,s,f),rB(e,i,l,r,u,s,p)):(rB(e,o,l,r,u,s,f),rB(e,i,l,r,u,s,p),rB(e,n,l,r,u,s,A),rB(e,t,l,r,u,s,h)),d.combine(a)}(e,a,c,l,u,t,i,o),s!==e._tilesToRender.length){const i=o.allAreRenderable,a=o.anyWereRenderedLastFrame,c=o.notYetRenderableCount;let l=!1;if(!i&&!a){const i=e._tilesToRender;for(let e=s;e<i.length;++e){let t=i[e];for(;void 0!==t&&t._lastSelectionResult!==pL.KICKED&&t!==n;)t._lastSelectionResult=pL.kick(t._lastSelectionResult),t=t.parent}e._tilesToRender.length=s,e._tileToUpdateHeights.length=f,sB(e,n),n._lastSelectionResult=pL.RENDERED;const a=A===pL.RENDERED;!a&&c>e.loadingDescendantLimit&&(e._tileLoadQueueLow.length=d,e._tileLoadQueueMedium.length=h,e._tileLoadQueueHigh.length=p,tB(e,e._tileLoadQueueMedium,n,t),o.notYetRenderableCount=n.renderable?0:1,l=!0),o.allAreRenderable=n.renderable,o.anyWereRenderedLastFrame=a,a||e._tileToUpdateHeights.push(n),++r.tilesWaitingForChildren}e.preloadAncestors&&!l&&tB(e,e._tileLoadQueueLow,n,t)}return}n._lastSelectionResultFrame=t.frameNumber,n._lastSelectionResult=pL.RENDERED,sB(e,n),tB(e,e._tileLoadQueueHigh,n,t),o.allAreRenderable=n.renderable,o.anyWereRenderedLastFrame=A===pL.RENDERED,o.notYetRenderableCount=n.renderable?0:1}(e,i,t,r,s);if(++e._debug.tilesCulled,e._tileReplacementQueue.markTileRendered(t),s.allAreRenderable=!0,s.anyWereRenderedLastFrame=!1,s.notYetRenderableCount=0,function(e,t){const n=t.rectangle;return(0,d.A)(e._cameraPositionCartographic)&&Or.A.contains(n,e._cameraPositionCartographic)||(0,d.A)(e._cameraReferenceFrameOriginCartographic)&&Or.A.contains(n,e._cameraReferenceFrameOriginCartographic)}(e,t)){(0,d.A)(t.data)&&(0,d.A)(t.data.vertexArray)||tB(e,e._tileLoadQueueMedium,t,i);const n=e._lastSelectionFrameNumber,o=t._lastSelectionResultFrame===n?t._lastSelectionResult:pL.NONE;o!==pL.CULLED_BUT_NEEDED&&o!==pL.RENDERED&&e._tileToUpdateHeights.push(t),t._lastSelectionResult=pL.CULLED_BUT_NEEDED}else e.preloadSiblings||0===t.level?(tB(e,e._tileLoadQueueLow,t,i),t._lastSelectionResult=pL.CULLED):t._lastSelectionResult=pL.CULLED;t._lastSelectionResultFrame=i.frameNumber}function sB(e,t){e._tilesToRender.push(t)}function aB(e,t){return e._loadPriority-t._loadPriority}function cB(e,t,n,i,o,r){void 0!==n.computeTileLoadPriority&&o.sort(aB);for(let s=0,a=o.length;s<a&&((0,aa.A)()<i||!r);++s){const i=o[s];e._tileReplacementQueue.markTileRendered(i),n.loadTile(t,i),r=!0}return r}const lB=new _R.A,uB=new X.A,dB=new j.A,hB=[],AB=QN;function pB(e){e=e??K.A.default;const t=new aP.A({ellipsoid:e}),n=new UN.A;this._ellipsoid=e,this._imageryLayerCollection=n,this._surfaceShaderSet=new KM,this._material=void 0,this._surface=new AB({tileProvider:new NN({terrainProvider:t,imageryLayers:n,surfaceShaderSet:this._surfaceShaderSet})}),this._terrainProvider=t,this._terrainProviderChanged=new Bn.A,this._undergroundColor=u.A.clone(u.A.BLACK),this._undergroundColorAlphaByDistance=new kt.A(e.maximumRadius/1e3,0,e.maximumRadius/5,1),this._translucency=new FN,fB(this),this.show=!0,this._oceanNormalMapResourceDirty=!0,this._oceanNormalMapResource=new Lt.A({url:(0,yv.A)("Assets/Textures/waterNormalsSmall.jpg")}),this.maximumScreenSpaceError=2,this.tileCacheSize=100,this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this.fillHighlightColor=void 0,this.enableLighting=!1,this.lambertDiffuseMultiplier=.9,this.dynamicAtmosphereLighting=!0,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=K.A.WGS84.equals(e),this.atmosphereLightIntensity=10,this.atmosphereRayleighCoefficient=new j.A(55e-7,13e-6,284e-7),this.atmosphereMieCoefficient=new j.A(21e-6,21e-6,21e-6),this.atmosphereRayleighScaleHeight=1e4,this.atmosphereMieScaleHeight=3200,this.atmosphereMieAnisotropy=.9,this.lightingFadeOutDistance=J.A.PI_OVER_TWO*e.minimumRadius,this.lightingFadeInDistance=J.A.PI*e.minimumRadius,this.nightFadeOutDistance=J.A.PI_OVER_TWO*e.minimumRadius,this.nightFadeInDistance=5*J.A.PI_OVER_TWO*e.minimumRadius,this.showWaterEffect=!0,this.depthTestAgainstTerrain=!1,this.shadows=kn.A.RECEIVE_ONLY,this.atmosphereHueShift=0,this.atmosphereSaturationShift=0,this.atmosphereBrightnessShift=0,this.showSkirts=!0,this.backFaceCulling=!0,this._oceanNormalMap=void 0,this._zoomedOutOceanSpecularIntensity=void 0,this.vertexShadowDarkness=.3}function fB(e){const t=[],n=(0,d.A)(e._material)&&((0,d.A)(e._material.shaderSource.match(/slope/))||(0,d.A)(e._material.shaderSource.match("normalEC"))),i=[nS.A,wS];!(0,d.A)(e._material)||n&&!e._terrainProvider.requestVertexNormals?e._surface._tileProvider.materialUniformMap=void 0:(i.push(e._material.shaderSource),t.push("APPLY_MATERIAL"),e._surface._tileProvider.materialUniformMap=e._material._uniforms),i.push(TS),e._surfaceShaderSet.baseVertexShaderSource=new k.A({sources:[nS.A,wS,bS],defines:t}),e._surfaceShaderSet.baseFragmentShaderSource=new k.A({sources:i,defines:t}),e._surfaceShaderSet.material=e._material}Object.defineProperties(pB.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},imageryLayersUpdatedEvent:{get:function(){return this._surface.tileProvider.imageryLayersUpdatedEvent}},tilesLoaded:{get:function(){return!(0,d.A)(this._surface)||0===this._surface._tileLoadQueueHigh.length&&0===this._surface._tileLoadQueueMedium.length&&0===this._surface._tileLoadQueueLow.length}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(e){this._surface.tileProvider.baseColor=e}},clippingPlanes:{get:function(){return this._surface.tileProvider.clippingPlanes},set:function(e){this._surface.tileProvider.clippingPlanes=e}},clippingPolygons:{get:function(){return this._surface.tileProvider.clippingPolygons},set:function(e){this._surface.tileProvider.clippingPolygons=e}},cartographicLimitRectangle:{get:function(){return this._surface.tileProvider.cartographicLimitRectangle},set:function(e){(0,d.A)(e)||(e=Or.A.clone(Or.A.MAX_VALUE)),this._surface.tileProvider.cartographicLimitRectangle=e}},oceanNormalMapUrl:{get:function(){return this._oceanNormalMapResource.url},set:function(e){this._oceanNormalMapResource.url=e,this._oceanNormalMapResourceDirty=!0}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){e!==this._terrainProvider&&(this._terrainProvider=e,this._terrainProviderChanged.raiseEvent(e),(0,d.A)(this._material)&&fB(this))}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,fB(this))}},undergroundColor:{get:function(){return this._undergroundColor},set:function(e){this._undergroundColor=u.A.clone(e,this._undergroundColor)}},undergroundColorAlphaByDistance:{get:function(){return this._undergroundColorAlphaByDistance},set:function(e){if((0,d.A)(e)&&e.far<e.near)throw new A.A("far distance must be greater than near distance.");this._undergroundColorAlphaByDistance=kt.A.clone(e,this._undergroundColorAlphaByDistance)}},translucency:{get:function(){return this._translucency}}});const mB=[],gB={start:0,stop:0};pB.prototype.pickWorldCoordinates=function(e,t,n,i){if(!(0,d.A)(e))throw new A.A("ray is required");if(!(0,d.A)(t))throw new A.A("scene is required");n=n??!0;const o=t.mode,r=t.mapProjection,s=mB;s.length=0;const a=this._surface._tilesToRender;let c,l,u=a.length;for(l=0;l<u;++l){c=a[l];const t=c.data;if(!(0,d.A)(t))continue;let n=t.pickBoundingSphere;if(o!==Ce.A.SCENE3D)t.pickBoundingSphere=n=Sn.A.fromRectangleWithHeights2D(c.rectangle,r,t.tileBoundingRegion.minimumHeight,t.tileBoundingRegion.maximumHeight,n),j.A.fromElements(n.center.z,n.center.x,n.center.y,n.center);else{if(!(0,d.A)(t.renderedMesh))continue;Sn.A.clone(t.tileBoundingRegion.boundingSphere,n)}const i=wO.A.raySphere(e,n,gB);(0,d.A)(i)&&s.push(t)}var h;let p;for(s.sort((h=e.origin,function(e,t){return Sn.A.distanceSquaredTo(e.pickBoundingSphere,h)-Sn.A.distanceSquaredTo(t.pickBoundingSphere,h)})),u=s.length,l=0;l<u&&(p=s[l].pick(e,t.mode,t.mapProjection,n,i),!(0,d.A)(p));++l);return p};const _B=new X.A;pB.prototype.pick=function(e,t,n){if(n=this.pickWorldCoordinates(e,t,!0,n),(0,d.A)(n)&&t.mode!==Ce.A.SCENE3D){n=j.A.fromElements(n.y,n.z,n.x,n);const e=t.mapProjection.unproject(n,_B);n=this._ellipsoid.cartographicToCartesian(e,n)}return n};const yB=new j.A,vB=new j.A,TB=new X.A,bB=new _R.A;function wB(e,t){return(0,d.A)(e)&&Or.A.contains(e.rectangle,t)?e:void 0}pB.prototype.getHeight=function(e){if(!(0,d.A)(e))throw new A.A("cartographic is required");const t=this._surface._levelZeroTiles;if(!(0,d.A)(t))return;let n,i;const o=t.length;for(i=0;i<o&&(n=t[i],!Or.A.contains(n.rectangle,e));++i);if(i>=o)return;let r=n;for(;(0,d.A)(n);)n=wB(n._southwestChild,e)||wB(n._southeastChild,e)||wB(n._northwestChild,e)||n._northeastChild,(0,d.A)(n)&&(0,d.A)(n.data)&&(0,d.A)(n.data.renderedMesh)&&(r=n);if(n=r,!(0,d.A)(n)||!(0,d.A)(n.data)||!(0,d.A)(n.data.renderedMesh))return;const s=this._surface._tileProvider.tilingScheme.projection,a=this._surface._tileProvider.tilingScheme.ellipsoid,c=j.A.fromRadians(e.longitude,e.latitude,0,a,yB),l=bB,u=a.geodeticSurfaceNormal(c,l.direction),h=a.getSurfaceNormalIntersectionWithZAxis(c,11500,l.origin);if(!(0,d.A)(h)){let e;(0,d.A)(n.data.tileBoundingRegion)&&(e=n.data.tileBoundingRegion.minimumHeight);const t=Math.min(e??0,-11500),i=j.A.multiplyByScalar(u,Math.abs(t)+1,vB);j.A.subtract(c,i,l.origin)}const p=n.data.pick(l,void 0,s,!1,vB);return(0,d.A)(p)?a.cartesianToCartographic(p,TB).height:void 0},pB.prototype.update=function(e){this.show&&e.passes.render&&this._surface.update(e)},pB.prototype.beginFrame=function(e){const t=this._surface,n=t.tileProvider,i=this.terrainProvider,o=(0,d.A)(i)&&i.hasWaterMask&&i.hasWaterMask;if(o&&this._oceanNormalMapResourceDirty){this._oceanNormalMapResourceDirty=!1;const t=this._oceanNormalMapResource,n=t.url;if((0,d.A)(n)){const i=this;t.fetchImage().then(function(t){n===i._oceanNormalMapResource.url&&(i._oceanNormalMap=i._oceanNormalMap&&i._oceanNormalMap.destroy(),i._oceanNormalMap=new G.A({context:e.context,source:t}))})}else this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}const r=e.passes,s=e.mode;r.render&&(this.showGroundAtmosphere?this._zoomedOutOceanSpecularIntensity=.4:this._zoomedOutOceanSpecularIntensity=.5,t.maximumScreenSpaceError=this.maximumScreenSpaceError,t.tileCacheSize=this.tileCacheSize,t.loadingDescendantLimit=this.loadingDescendantLimit,t.preloadAncestors=this.preloadAncestors,t.preloadSiblings=this.preloadSiblings,n.terrainProvider=this.terrainProvider,n.lightingFadeOutDistance=this.lightingFadeOutDistance,n.lightingFadeInDistance=this.lightingFadeInDistance,n.nightFadeOutDistance=this.nightFadeOutDistance,n.nightFadeInDistance=this.nightFadeInDistance,n.zoomedOutOceanSpecularIntensity=s===Ce.A.SCENE3D?this._zoomedOutOceanSpecularIntensity:0,n.hasWaterMask=o,n.showWaterEffect=this.showWaterEffect,n.oceanNormalMap=this._oceanNormalMap,n.enableLighting=this.enableLighting,n.dynamicAtmosphereLighting=this.dynamicAtmosphereLighting,n.dynamicAtmosphereLightingFromSun=this.dynamicAtmosphereLightingFromSun,n.showGroundAtmosphere=this.showGroundAtmosphere,n.atmosphereLightIntensity=this.atmosphereLightIntensity,n.atmosphereRayleighCoefficient=this.atmosphereRayleighCoefficient,n.atmosphereMieCoefficient=this.atmosphereMieCoefficient,n.atmosphereRayleighScaleHeight=this.atmosphereRayleighScaleHeight,n.atmosphereMieScaleHeight=this.atmosphereMieScaleHeight,n.atmosphereMieAnisotropy=this.atmosphereMieAnisotropy,n.shadows=this.shadows,n.hueShift=this.atmosphereHueShift,n.saturationShift=this.atmosphereSaturationShift,n.brightnessShift=this.atmosphereBrightnessShift,n.fillHighlightColor=this.fillHighlightColor,n.showSkirts=this.showSkirts,n.backFaceCulling=this.backFaceCulling,n.vertexShadowDarkness=this.vertexShadowDarkness,n.undergroundColor=this._undergroundColor,n.undergroundColorAlphaByDistance=this._undergroundColorAlphaByDistance,n.lambertDiffuseMultiplier=this.lambertDiffuseMultiplier,t.beginFrame(e))},pB.prototype.render=function(e){this.show&&((0,d.A)(this._material)&&this._material.update(e.context),this._surface.render(e))},pB.prototype.endFrame=function(e){this.show&&e.passes.render&&this._surface.endFrame(e)},pB.prototype.isDestroyed=function(){return!1},pB.prototype.destroy=function(){return this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy(),this._surface=this._surface&&this._surface.destroy(),this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy(),(0,h.A)(this)};const xB=pB;var CB=n(527083);const EB={position:0};function SB(e){e=e??S.A.EMPTY_OBJECT,this.center=j.A.clone(e.center??j.A.ZERO),this._center=new j.A,this.radii=j.A.clone(e.radii),this._radii=new j.A,this._oneOverEllipsoidRadiiSquared=new j.A,this._boundingSphere=new Sn.A,this.modelMatrix=O.A.clone(e.modelMatrix??O.A.IDENTITY),this._modelMatrix=new O.A,this._computedModelMatrix=new O.A,this.show=e.show??!0,this.material=e.material??Dn.A.fromType(Dn.A.ColorType),this._material=void 0,this._translucent=void 0,this.id=e.id,this._id=void 0,this.debugShowBoundingVolume=e.debugShowBoundingVolume??!1,this.onlySunLighting=e.onlySunLighting??!1,this._onlySunLighting=!1,this._depthTestEnabled=e.depthTestEnabled??!0,this._useLogDepth=!1,this._sp=void 0,this._rs=void 0,this._va=void 0,this._pickSP=void 0,this._pickId=void 0,this._colorCommand=new m.A({owner:e._owner??this}),this._pickCommand=new m.A({owner:e._owner??this,pickOnly:!0});const t=this;this._uniforms={u_radii:function(){return t.radii},u_oneOverEllipsoidRadiiSquared:function(){return t._oneOverEllipsoidRadiiSquared}},this._pickUniforms={czm_pickColor:function(){return t._pickId.color}}}SB.prototype.update=function(e){if(!this.show||e.mode!==Ce.A.SCENE3D||!(0,d.A)(this.center)||!(0,d.A)(this.radii))return;if(!(0,d.A)(this.material))throw new A.A("this.material must be defined.");const t=e.context,n=this.material.isTranslucent(),i=this._translucent!==n;(0,d.A)(this._rs)&&!i||(this._translucent=n,this._rs=_.A.fromCache({cull:{enabled:!0,face:CB.A.FRONT},depthTest:{enabled:this._depthTestEnabled},depthMask:!n&&t.fragmentDepth,blending:n?$M.A.ALPHA_BLEND:void 0})),(0,d.A)(this._va)||(this._va=function(e){let t=e.cache.ellipsoidPrimitive_vertexArray;if((0,d.A)(t))return t;const n=pn.A.createGeometry(pn.A.fromDimensions({dimensions:new j.A(2,2,2),vertexFormat:Rr.A.POSITION_ONLY}));return t=je.A.fromGeometry({context:e,geometry:n,attributeLocations:EB,bufferUsage:r.A.STATIC_DRAW,interleave:!0}),e.cache.ellipsoidPrimitive_vertexArray=t,t}(t));let o=!1;const s=this.radii;if(!j.A.equals(this._radii,s)){j.A.clone(s,this._radii);const e=this._oneOverEllipsoidRadiiSquared;e.x=1/(s.x*s.x),e.y=1/(s.y*s.y),e.z=1/(s.z*s.z),o=!0}O.A.equals(this.modelMatrix,this._modelMatrix)&&j.A.equals(this.center,this._center)||(O.A.clone(this.modelMatrix,this._modelMatrix),j.A.clone(this.center,this._center),O.A.multiplyByTranslation(this.modelMatrix,this.center,this._computedModelMatrix),o=!0),o&&(j.A.clone(j.A.ZERO,this._boundingSphere.center),this._boundingSphere.radius=j.A.maximumComponent(s),Sn.A.transform(this._boundingSphere,this._computedModelMatrix,this._boundingSphere));const a=this._material!==this.material;this._material=this.material,this._material.update(t);const c=this.onlySunLighting!==this._onlySunLighting;this._onlySunLighting=this.onlySunLighting;const l=e.useLogDepth,u=this._useLogDepth!==l;this._useLogDepth=l;const h=this._colorCommand;let p,f;(a||c||i||u)&&(p=new k.A({sources:[yS]}),f=new k.A({sources:[this.material.shaderSource,_S]}),this.onlySunLighting&&f.defines.push("ONLY_SUN_LIGHTING"),!n&&t.fragmentDepth&&f.defines.push("WRITE_DEPTH"),this._useLogDepth&&(p.defines.push("LOG_DEPTH"),f.defines.push("LOG_DEPTH")),this._sp=y.A.replaceCache({context:t,shaderProgram:this._sp,vertexShaderSource:p,fragmentShaderSource:f,attributeLocations:EB}),h.vertexArray=this._va,h.renderState=this._rs,h.shaderProgram=this._sp,h.uniformMap=(0,tC.A)(this._uniforms,this.material._uniforms),h.executeInClosestFrustum=n);const m=e.commandList,g=e.passes;if(g.render&&(h.boundingVolume=this._boundingSphere,h.debugShowBoundingVolume=this.debugShowBoundingVolume,h.modelMatrix=this._computedModelMatrix,h.pass=n?ut.A.TRANSLUCENT:ut.A.OPAQUE,m.push(h)),g.pick){const e=this._pickCommand;(0,d.A)(this._pickId)&&this._id===this.id||(this._id=this.id,this._pickId=this._pickId&&this._pickId.destroy(),this._pickId=t.createPickId({primitive:this,id:this.id})),(a||c||!(0,d.A)(this._pickSP)||u)&&(p=new k.A({sources:[yS]}),f=new k.A({sources:[this.material.shaderSource,_S],pickColorQualifier:"uniform"}),this.onlySunLighting&&f.defines.push("ONLY_SUN_LIGHTING"),!n&&t.fragmentDepth&&f.defines.push("WRITE_DEPTH"),this._useLogDepth&&(p.defines.push("LOG_DEPTH"),f.defines.push("LOG_DEPTH")),this._pickSP=y.A.replaceCache({context:t,shaderProgram:this._pickSP,vertexShaderSource:p,fragmentShaderSource:f,attributeLocations:EB}),e.vertexArray=this._va,e.renderState=this._rs,e.shaderProgram=this._pickSP,e.uniformMap=(0,tC.A)((0,tC.A)(this._uniforms,this._pickUniforms),this.material._uniforms),e.executeInClosestFrustum=n),e.boundingVolume=this._boundingSphere,e.modelMatrix=this._computedModelMatrix,e.pass=n?ut.A.TRANSLUCENT:ut.A.OPAQUE,m.push(e)}},SB.prototype.isDestroyed=function(){return!1},SB.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),(0,h.A)(this)};const IB=SB;function PB(e){let t=(e=e??S.A.EMPTY_OBJECT).textureUrl;(0,d.A)(t)||(t=(0,yv.A)("Assets/Textures/moonSmall.jpg")),this.show=e.show??!0,this.textureUrl=t,this._ellipsoid=e.ellipsoid??K.A.MOON,this.onlySunLighting=e.onlySunLighting??!0,this._ellipsoidPrimitive=new IB({radii:this.ellipsoid.radii,material:Dn.A.fromType(Dn.A.ImageType),depthTestEnabled:!1,_owner:this}),this._ellipsoidPrimitive.material.translucent=!1,this._axes=new _O}Object.defineProperties(PB.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});const DB=new Z.A,OB=new Z.A,RB=new j.A,MB=[];PB.prototype.update=function(e){if(!this.show)return;const t=this._ellipsoidPrimitive;t.material.uniforms.image=this.textureUrl,t.onlySunLighting=this.onlySunLighting;const n=e.time;(0,d.A)(xe.A.computeIcrfToFixedMatrix(n,DB))||xe.A.computeTemeToPseudoFixedMatrix(n,DB);const i=this._axes.evaluate(n,OB);Z.A.transpose(i,i),Z.A.multiply(DB,i,i);const o=we.computeMoonPositionInEarthInertialFrame(n,RB);Z.A.multiplyByVector(DB,o,o),O.A.fromRotationTranslation(i,o,t.modelMatrix);const r=e.commandList;return e.commandList=MB,MB.length=0,t.update(e),e.commandList=r,1===MB.length?MB[0]:void 0},PB.prototype.isDestroyed=function(){return!1},PB.prototype.destroy=function(){return this._ellipsoidPrimitive=this._ellipsoidPrimitive&&this._ellipsoidPrimitive.destroy(),(0,h.A)(this)};const LB=PB;var NB=n(153662);function BB(){this._colorTexture=void 0,this._drawCommand=void 0}Object.defineProperties(BB.prototype,{colorTexture:{get:function(){return this._colorTexture}}}),BB.prototype.update=function(e){if(!(0,d.A)(this._colorTexture)){const t=e.context,n=new G.A({context:t,width:256,height:256,pixelFormat:R.A.RGBA,pixelDatatype:U.A.UNSIGNED_BYTE,sampler:At.A.NEAREST});this._colorTexture=n;const i=new g.A({context:t,colorTextures:[n],destroyAttachments:!1});!function(e,t,n){const i=t.createViewportQuadCommand(rS,{framebuffer:n,renderState:_.A.fromCache({viewport:new c.A(0,0,256,256)})});e._drawCommand=i}(this,t,i),this._drawCommand.execute(t),i.destroy(),this._drawCommand.shaderProgram=this._drawCommand.shaderProgram&&this._drawCommand.shaderProgram.destroy()}},BB.prototype.isDestroyed=function(){return!1},BB.prototype.destroy=function(){return this._colorTexture=this._colorTexture&&this._colorTexture.destroy(),(0,h.A)(this)};const FB=BB;var UB=n(635577),kB=n(581010);const VB=function(e){l.A.typeOf.object("options",e),l.A.typeOf.number("options.pass",e.pass),this.pass=e.pass,this.commandList=e.commandList,this.camera=e.camera,this.cullingVolume=e.cullingVolume,this.ready=!1},zB="#ffffff",HB="#48b";function GB(e,t){this.credit=e,this.count=t??1}const WB="cesium-credit-delimiter";function YB(e){const t=document.createElement("span");return t.textContent=e,t.className=WB,t}function qB(e,t){if((0,d.A)(t)){const n=document.createElement(t);n._creditId=e._creditId,n.appendChild(e),e=n}return e}function jB(e,t,n,i){const o=e.childNodes;let r=-1;t.sort(function(e,t){return t.count-e.count});for(let s=0;s<t.length;++s){const a=t[s].credit;if((0,d.A)(a)){if(r=s,(0,d.A)(n)&&(r*=2,s>0)){const t=r-1;if(o.length<=t)e.appendChild(YB(n));else{const i=o[t];i.className!==WB&&e.replaceChild(YB(n),i)}}const t=a.element;if(o.length<=r)e.appendChild(qB(t,i));else{const n=o[r];n._creditId!==a._id&&e.replaceChild(qB(t,i),n)}}}for(++r;r<o.length;)e.removeChild(o[r])}function QB(e,t,n){l.A.defined("container",e);const i=this;n=n??document.body;const o=document.createElement("div");o.className="cesium-credit-lightbox-overlay",n.appendChild(o);const r=document.createElement("div");function s(e){r.contains(e.target)||i.hideLightbox()}r.className="cesium-credit-lightbox",o.appendChild(r),o.addEventListener("click",s,!1);const a=document.createElement("div");a.className="cesium-credit-lightbox-title",a.textContent="Data provided by:",r.appendChild(a);const c=document.createElement("a");c.onclick=this.hideLightbox.bind(this),c.innerHTML="&times;",c.className="cesium-credit-lightbox-close",r.appendChild(c);const u=document.createElement("ul");r.appendChild(u);const d=document.createElement("div");d.className="cesium-credit-logoContainer",d.style.display="inline",e.appendChild(d);const h=document.createElement("div");h.className="cesium-credit-textContainer",h.style.display="inline",e.appendChild(h);const A=document.createElement("a");A.className="cesium-credit-expand-link",A.onclick=this.showLightbox.bind(this),A.textContent="Data attribution",e.appendChild(A),function(e){const t=`\n.cesium-credit-lightbox-overlay {\n  display: none;\n  z-index: 1;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(80, 80, 80, 0.8);\n}\n\n.cesium-credit-lightbox {\n  background-color: #303336;\n  color: ${zB};\n  position: relative;\n  min-height: 100px;\n  margin: auto;\n}\n.cesium-credit-lightbox > ul > li a,\n.cesium-credit-lightbox > ul > li a:visited,\n.cesium-credit-wrapper a,\n.cesium-credit-wrapper a:visited {\n  color: ${zB};\n}\n.cesium-credit-lightbox > ul > li a:hover {\n  color: ${HB};\n}\n.cesium-credit-lightbox.cesium-credit-lightbox-expanded {\n  border: 1px solid #444;\n  border-radius: 5px;\n  max-width: 370px;\n}\n.cesium-credit-lightbox.cesium-credit-lightbox-mobile {\n  height: 100%;\n  width: 100%;\n}\n.cesium-credit-lightbox-title {\n  padding: 20px 20px 0 20px;\n}\n.cesium-credit-lightbox-close {\n  font-size: 18pt;\n  cursor: pointer;\n  position: absolute;\n  top: 0;\n  right: 6px;\n  color: ${zB};\n}\n.cesium-credit-lightbox-close:hover {\n  color: ${HB};\n}\n.cesium-credit-lightbox > ul {\n  margin: 0;\n  padding: 12px 20px 12px 40px;\n  font-size: 13px;\n}\n.cesium-credit-lightbox > ul > li {\n  padding-bottom: 6px;\n}\n.cesium-credit-lightbox > ul > li * {\n  padding: 0;\n  margin: 0;\n}\n\n.cesium-credit-expand-link {\n  padding-left: 5px;\n  cursor: pointer;\n  text-decoration: underline;\n  color: ${zB};\n}\n.cesium-credit-expand-link:hover {\n  color: ${HB};\n}\n\n.cesium-credit-text {\n  color: ${zB};\n}\n\n.cesium-credit-delimiter {\n  padding: 0 5px;\n}\n\n.cesium-credit-textContainer *,\n.cesium-credit-logoContainer * {\n  display: inline;\n}\n\n.cesium-credit-textContainer a:hover {\n  color: ${HB}\n}\n\n.cesium-credit-textContainer .cesium-credit-wrapper:first-of-type {\n  padding-left: 5px;\n}\n`,n=function(e){if(e.shadowRoot)return e.shadowRoot;if(e.getRootNode){const t=e.getRootNode();if(t instanceof ShadowRoot)return t}}(e)??document.head,i=document.createElement("style");i.innerHTML=t,n.appendChild(i)}(e);const p=Ws.A.clone(QB.cesiumCredit);this._delimiter=t??"•",this._screenContainer=h,this._cesiumCreditContainer=d,this._lastViewportHeight=void 0,this._lastViewportWidth=void 0,this._lightboxCredits=r,this._creditList=u,this._lightbox=o,this._hideLightbox=s,this._expandLink=A,this._expanded=!1,this._staticCredits=[],this._cesiumCredit=p,this._previousCesiumCredit=void 0,this._currentCesiumCredit=p,this._creditDisplayElementPool=[],this._creditDisplayElementIndex=0,this._currentFrameCredits={screenCredits:new Ft.A,lightboxCredits:new Ft.A},this._defaultCredit=void 0,this.viewport=n,this.container=e}function XB(e,t,n,i){i=i??1;let o=t.get(n.id);if((0,d.A)(o))o.count<Number.MAX_VALUE&&(o.count+=i);else{const r=e._creditDisplayElementPool,s=e._creditDisplayElementPoolIndex;s<r.length?(o=r[s],o.credit=n,o.count=i):(o=new GB(n,i),r.push(o)),++e._creditDisplayElementPoolIndex,t.set(n.id,o)}}let KB;function $B(){if(!(0,d.A)(KB)){let e=(0,yv.A)("Assets/Images/ion-credit.png");0!==e.indexOf("http://")&&0!==e.indexOf("https://")&&0!==e.indexOf("data:")&&(e=new ra(e).path()),KB=new Ws.A(`<a href="https://cesium.com/" target="_blank"><img src="${e}" style="vertical-align: -7px" title="Cesium ion"/></a>`,!0)}return QB._cesiumCreditInitialized||(QB._cesiumCredit=KB,QB._cesiumCreditInitialized=!0),KB}QB.prototype.addCreditToNextFrame=function(e){if(l.A.defined("credit",e),e.isIon())return(0,d.A)(this._defaultCredit)||(this._defaultCredit=Ws.A.clone($B())),void(this._currentCesiumCredit=this._defaultCredit);let t;t=e.showOnScreen?this._currentFrameCredits.screenCredits:this._currentFrameCredits.lightboxCredits,XB(this,t,e)},QB.prototype.addStaticCredit=function(e){l.A.defined("credit",e);const t=this._staticCredits;(function(e,t){const n=e.length;for(let i=0;i<n;i++){const n=e[i];if(Ws.A.equals(n,t))return!0}return!1})(t,e)||t.push(e)},QB.prototype.removeStaticCredit=function(e){l.A.defined("credit",e);const t=this._staticCredits,n=t.indexOf(e);-1!==n&&t.splice(n,1)},QB.prototype.showLightbox=function(){this._lightbox.style.display="block",this._expanded=!0},QB.prototype.hideLightbox=function(){this._lightbox.style.display="none",this._expanded=!1},QB.prototype.update=function(){this._expanded&&function(e){const t=e._lightboxCredits,n=e.viewport.clientWidth,i=e.viewport.clientHeight;n!==e._lastViewportWidth&&(n<576?(t.className="cesium-credit-lightbox cesium-credit-lightbox-mobile",t.style.marginTop="0"):(t.className="cesium-credit-lightbox cesium-credit-lightbox-expanded",t.style.marginTop=`${Math.floor(.5*(i-t.clientHeight))}px`),e._lastViewportWidth=n),n>=576&&i!==e._lastViewportHeight&&(t.style.marginTop=`${Math.floor(.5*(i-t.clientHeight))}px`,e._lastViewportHeight=i)}(this)},QB.prototype.beginFrame=function(){const e=this._currentFrameCredits;this._creditDisplayElementPoolIndex=0;const t=e.screenCredits,n=e.lightboxCredits;t.removeAll(),n.removeAll();const i=this._staticCredits;for(let e=0;e<i.length;++e){const o=i[e],r=o.showOnScreen?t:n;o.isIon()&&Ws.A.equals(QB.cesiumCredit,this._cesiumCredit)||XB(this,r,o,Number.MAX_VALUE)}Ws.A.equals(QB.cesiumCredit,this._cesiumCredit)||(this._cesiumCredit=Ws.A.clone(QB.cesiumCredit)),this._currentCesiumCredit=this._cesiumCredit},QB.prototype.endFrame=function(){const e=this._currentFrameCredits.screenCredits.values;jB(this._screenContainer,e,this._delimiter,void 0);const t=this._currentFrameCredits.lightboxCredits.values;this._expandLink.style.display=t.length>0?"inline":"none",jB(this._creditList,t,void 0,"li"),function(e){const t=e._previousCesiumCredit,n=e._currentCesiumCredit;Ws.A.equals(n,t)||((0,d.A)(t)&&e._cesiumCreditContainer.removeChild(t.element),(0,d.A)(n)&&e._cesiumCreditContainer.appendChild(n.element),e._previousCesiumCredit=n)}(this)},QB.prototype.destroy=function(){return this._lightbox.removeEventListener("click",this._hideLightbox,!1),this.container.removeChild(this._cesiumCreditContainer),this.container.removeChild(this._screenContainer),this.container.removeChild(this._expandLink),this.viewport.removeChild(this._lightbox),(0,h.A)(this)},QB.prototype.isDestroyed=function(){return!1},QB._cesiumCredit=void 0,QB._cesiumCreditInitialized=!1,Object.defineProperties(QB,{cesiumCredit:{get:function(){return $B(),QB._cesiumCredit},set:function(e){QB._cesiumCredit=e,QB._cesiumCreditInitialized=!0}}}),QB.CreditDisplayElement=GB;const JB=QB;function ZB(e){if(e=e??S.A.EMPTY_OBJECT,!(0,d.A)(e.camera))throw new A.A("options.camera is required.");this._camera=e.camera,this._frustumSplits=e.frustumSplits,this._color=e.color??u.A.CYAN,this._updateOnChange=e.updateOnChange??!0,this.show=e.show??!0,this.id=e.id,this._id=void 0,this._outlinePrimitives=[],this._planesPrimitives=[]}const eF=new j.A,tF=new Z.A,nF=new To.A,iF=new uP.A,oF=new uR.A,rF=new ee.A,sF=new aR.A,aF=new u.A,cF=[1,1e5];ZB.prototype.update=function(e){if(!this.show)return;const t=this._planesPrimitives,n=this._outlinePrimitives;let i,o;if(this._updateOnChange){for(o=t.length,i=0;i<o;++i)n[i]=n[i]&&n[i].destroy(),t[i]=t[i]&&t[i].destroy();t.length=0,n.length=0}if(0===t.length){const e=this._camera,o=e.frustum;let r,s;r=o instanceof uP.A?iF:o instanceof uR.A?oF:o instanceof ee.A?rF:sF,r=o.clone(r);let a=this._frustumSplits;!(0,d.A)(a)||a.length<=1?(a=cF,a[0]=this._camera.frustum.near,a[1]=this._camera.frustum.far,s=1):s=a.length-1;const c=e.positionWC,l=e.directionWC,h=e.upWC;let A=e.rightWC;A=j.A.negate(A,eF);const p=tF;Z.A.setColumn(p,0,A,p),Z.A.setColumn(p,1,h,p),Z.A.setColumn(p,2,l,p);const f=To.A.fromRotationMatrix(p,nF);for(t.length=n.length=s,i=0;i<s;++i)r.near=a[i],r.far=a[i+1],t[i]=new Pn.A({geometryInstances:new yn.A({geometry:new DP({origin:c,orientation:f,frustum:r,_drawNearPlane:0===i}),attributes:{color:mn.A.fromColor(u.A.fromAlpha(this._color,.1,aF))},id:this.id,pickPrimitive:this}),appearance:new Cn.A({translucent:!0,flat:!0}),asynchronous:!1}),n[i]=new Pn.A({geometryInstances:new yn.A({geometry:new BP({origin:c,orientation:f,frustum:r,_drawNearPlane:0===i}),attributes:{color:mn.A.fromColor(this._color)},id:this.id,pickPrimitive:this}),appearance:new Cn.A({translucent:!1,flat:!0}),asynchronous:!1})}for(o=t.length,i=0;i<o;++i)n[i].update(e),t[i].update(e)},ZB.prototype.isDestroyed=function(){return!1},ZB.prototype.destroy=function(){const e=this._planesPrimitives.length;for(let t=0;t<e;++t)this._outlinePrimitives[t]=this._outlinePrimitives[t]&&this._outlinePrimitives[t].destroy(),this._planesPrimitives[t]=this._planesPrimitives[t]&&this._planesPrimitives[t].destroy();return(0,h.A)(this)};const lF=ZB;function uF(e){this._rs=void 0,this._sp=void 0,this._va=void 0,this._command=void 0,this._mode=void 0,this._useLogDepth=!1,this._ellipsoidOffset=e??0}const dF=lP.A.supportsTypedArrays()?new Float32Array(12):[],hF=new j.A,AF=new j.A,pF=new j.A,fF=new j.A,mF=new j.A;uF.prototype.update=function(e){if(this._mode=e.mode,e.mode!==Ce.A.SCENE3D)return;const t=e.context,n=e.mapProjection.ellipsoid.radii,i=new K.A(n.x+this._ellipsoidOffset,n.y+this._ellipsoidOffset,n.z+this._ellipsoidOffset),o=e.useLogDepth;if((0,d.A)(this._command)||(this._rs=_.A.fromCache({cull:{enabled:!0},depthTest:{enabled:!0},colorMask:{red:!1,green:!1,blue:!1,alpha:!1}}),this._command=new m.A({renderState:this._rs,boundingVolume:new Sn.A(j.A.ZERO,i.maximumRadius),pass:ut.A.OPAQUE,owner:this})),!(0,d.A)(this._sp)||this._useLogDepth!==o){this._useLogDepth=o;const e=new k.A({sources:[gS]}),n=new k.A({sources:[mS]});o&&(n.defines.push("LOG_DEPTH"),e.defines.push("LOG_DEPTH")),this._sp=y.A.replaceCache({shaderProgram:this._sp,context:t,vertexShaderSource:e,fragmentShaderSource:n,attributeLocations:{position:0}}),this._command.shaderProgram=this._sp}const s=function(e,t){const n=e.radii,i=t.camera;let o,r,s;if(i.frustum instanceof ee.A)o=j.A.ZERO,r=i.rightWC,s=i.upWC;else{const t=i.positionWC,n=j.A.multiplyComponents(e.oneOverRadii,t,hF),a=j.A.normalize(n,AF),c=j.A.normalize(j.A.cross(j.A.UNIT_Z,n,pF),pF),l=j.A.normalize(j.A.cross(a,c,fF),fF),u=j.A.magnitude(n),d=Math.sqrt(u*u-1);o=j.A.multiplyByScalar(a,1/u,hF);const h=d/u;r=j.A.multiplyByScalar(c,h,AF),s=j.A.multiplyByScalar(l,h,pF)}const a=j.A.add(o,s,mF);j.A.subtract(a,r,a),j.A.multiplyComponents(n,a,a),j.A.pack(a,dF,0);const c=j.A.subtract(o,s,mF);j.A.subtract(c,r,c),j.A.multiplyComponents(n,c,c),j.A.pack(c,dF,3);const l=j.A.add(o,s,mF);j.A.add(l,r,l),j.A.multiplyComponents(n,l,l),j.A.pack(l,dF,6);const u=j.A.subtract(o,s,mF);return j.A.add(u,r,u),j.A.multiplyComponents(n,u,u),j.A.pack(u,dF,9),dF}(i,e);if((0,d.A)(this._va))this._va.getAttribute(0).vertexBuffer.copyFromArrayView(s);else{const e=new I.A({attributes:{position:new P.A({componentDatatype:C.A.FLOAT,componentsPerAttribute:3,values:s})},indices:[0,1,2,2,1,3],primitiveType:p.A.TRIANGLES});this._va=je.A.fromGeometry({context:t,geometry:e,attributeLocations:{position:0},bufferUsage:r.A.DYNAMIC_DRAW}),this._command.vertexArray=this._va}},uF.prototype.execute=function(e,t){this._mode===Ce.A.SCENE3D&&this._command.execute(e,t)},uF.prototype.isDestroyed=function(){return!1},uF.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy(),this._va=this._va&&this._va.destroy()};const gF=uF;var _F=n(568748),yF=n(374607),vF=n(963564);function TF(){}const bF=/\bgl_FragDepth\b/,wF=/\bdiscard\b/;TF.createDepthOnlyDerivedCommand=function(e,t,n,i){(0,d.A)(i)||(i={});const o=i.depthOnlyCommand?.shaderProgram,r=i.depthOnlyCommand?.renderState;return i.depthOnlyCommand=m.A.shallowClone(t,i.depthOnlyCommand),(0,d.A)(o)&&i.shaderProgramId===t.shaderProgram.id?(i.depthOnlyCommand.shaderProgram=o,i.depthOnlyCommand.renderState=r):(i.depthOnlyCommand.shaderProgram=function(e,t){const n=e.shaderCache.getDerivedShaderProgram(t,"depthOnly");if((0,d.A)(n))return n;let i=t.fragmentShaderSource,o=!1;const r=i.sources;for(let e=0;e<r.length;++e)if(bF.test(r[e])||wF.test(r[e])){o=!0;break}const s=i.defines.indexOf("LOG_DEPTH")>=0;if(o||s){if(!o&&s){const e="void main()\n{\n    out_FragColor = vec4(1.0);\n    czm_writeLogDepth();\n}\n";i=new k.A({defines:["LOG_DEPTH"],sources:[e]})}}else{const e="void main()\n{\n    out_FragColor = vec4(1.0);\n}\n";i=new k.A({sources:[e]})}return e.shaderCache.createDerivedShaderProgram(t,"depthOnly",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:i,attributeLocations:t._attributeLocations})}(n,t.shaderProgram),i.depthOnlyCommand.renderState=function(e,t){const n=e._depthOnlyRenderStateCache,i=n[t.id];if((0,d.A)(i))return i;const o=_.A.getState(t);o.depthMask=!0,o.colorMask={red:!1,green:!1,blue:!1,alpha:!1};const r=_.A.fromCache(o);return n[t.id]=r,r}(e,t.renderState),i.shaderProgramId=t.shaderProgram.id),i};const xF=/\s+czm_writeLogDepth\(/,CF=/\s+czm_vertexLogDepth\(/;function EF(e,t){const n=e.picking.pickRenderStateCache,i=n[t.id];if((0,d.A)(i))return i;const o=_.A.getState(t);o.blending.enabled=!1,o.depthMask=!0;const r=_.A.fromCache(o);return n[t.id]=r,r}function SF(e,t,n){const i=e.length;for(let o=0;o<i;o++)e[o].trimStart().split(/\s+/)[0]===t&&(e[o]=`${t} ${n}`)}function IF(e){return e.isArray?e.arrayLength:yF.A.getComponentCount(e.type)}function PF(e,t,n){return`((${e} - float(${t})) / float(${n}))`}function DF(e,t){return`(${e}) / float(${_F.A.getMaximum(t)})`}function OF(e,t,n){let i=`float(value.${n})`;return t.hasValueTransform&&(i=PF(i,t.offset[n],t.scale[n])),e.normalized||(i=DF(i,e.componentType)),i}TF.createLogDepthCommand=function(e,t,n){(0,d.A)(n)||(n={});const i=n.command?.shaderProgram;return n.command=m.A.shallowClone(e,n.command),(0,d.A)(i)&&n.shaderProgramId===e.shaderProgram.id?n.command.shaderProgram=i:(n.command.shaderProgram=function(e,t){if(t.fragmentShaderSource.defines.indexOf("LOG_DEPTH_READ_ONLY")>=0)return t;const n=e.shaderCache.getDerivedShaderProgram(t,"logDepth");if((0,d.A)(n))return n;const i=t._attributeLocations,o=t.vertexShaderSource.clone(),r=t.fragmentShaderSource.clone();o.defines=(0,d.A)(o.defines)?o.defines.slice(0):[],o.defines.push("LOG_DEPTH"),r.defines=(0,d.A)(r.defines)?r.defines.slice(0):[],r.defines.push("LOG_DEPTH");let s=!1,a=o.sources;for(let e=0;e<a.length;++e)if(CF.test(a[e])){s=!0;break}if(!s){for(let e=0;e<a.length;++e)a[e]=k.A.replaceMain(a[e],"czm_log_depth_main");const e="\n\nvoid main()\n{\n    czm_log_depth_main();\n    czm_vertexLogDepth();\n}\n";a.push(e)}a=r.sources,s=!1;for(let e=0;e<a.length;++e)xF.test(a[e])&&(s=!0);-1!==r.defines.indexOf("LOG_DEPTH_WRITE")&&(s=!0);let c="";if(!s){for(let e=0;e<a.length;e++)a[e]=k.A.replaceMain(a[e],"czm_log_depth_main");c="\nvoid main()\n{\n    czm_log_depth_main();\n    czm_writeLogDepth();\n}\n"}return a.push(c),e.shaderCache.createDerivedShaderProgram(t,"logDepth",{vertexShaderSource:o,fragmentShaderSource:r,attributeLocations:i})}(t,e.shaderProgram),n.shaderProgramId=e.shaderProgram.id),n},TF.createPickDerivedCommand=function(e,t,n,i){(0,d.A)(i)||(i={});const o=i.pickCommand?.shaderProgram,r=i.pickCommand?.renderState;return i.pickCommand=m.A.shallowClone(t,i.pickCommand),(0,d.A)(o)&&i.shaderProgramId===t.shaderProgram.id?(i.pickCommand.shaderProgram=o,i.pickCommand.renderState=r):(i.pickCommand.shaderProgram=function(e,t,n){const i=e.shaderCache.getDerivedShaderProgram(t,"pick");if((0,d.A)(i))return i;const o=t._attributeLocations,{sources:r,defines:s}=t.fragmentShaderSource,a=r.some(e=>e.includes("out_FragData"))?"out_FragData_0":"out_FragColor",c=`void main () \n{ \n    czm_non_pick_main(); \n    if (${a}.a == 0.0) { \n        discard; \n    } \n    ${a} = ${n}; \n} `,l=r.length,u=new Array(l+1);for(let e=0;e<l;++e)u[e]=k.A.replaceMain(r[e],"czm_non_pick_main");u[l]=c;const h=new k.A({sources:u,defines:s});return e.shaderCache.createDerivedShaderProgram(t,"pick",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:h,attributeLocations:o})}(n,t.shaderProgram,t.pickId),i.pickCommand.renderState=EF(e,t.renderState),i.shaderProgramId=t.shaderProgram.id),i},TF.createPickMetadataDerivedCommand=function(e,t,n,i){return(0,d.A)(i)||(i={}),i.pickMetadataCommand=m.A.shallowClone(t,i.pickMetadataCommand),i.pickMetadataCommand.shaderProgram=function(e,t,n){const i=n.schemaId,o=n.className,r=n.propertyName,s=`pickMetadata-${i}-${o}-${r}`,a=e.shaderCache.getDerivedShaderProgram(t,s);if((0,d.A)(a))return a;const c=n.metadataProperty,l=n.classProperty,u=function(e){const t=IF(e);return e.normalized?1===t?"float":`vec${t}`:1===t?"int":`ivec${t}`}(l),h=["0.0","0.0","0.0","0.0"],A=IF(l);if(1===A)h[0]=function(e,t){let n="float(value)";return t.hasValueTransform&&(n=PF(n,t.offset,t.scale)),e.normalized||(n=DF(n,e.componentType)),n}(l,c);else{const e=["x","y","z","w"];for(let t=0;t<A;t++)h[t]=OF(l,c,e[t])}const p=t.fragmentShaderSource.defines.slice();p.push(vF.A.METADATA_PICKING_ENABLED),SF(p,vF.A.METADATA_PICKING_VALUE_TYPE,u),SF(p,vF.A.METADATA_PICKING_VALUE_STRING,`metadata.${r}`),SF(p,vF.A.METADATA_PICKING_VALUE_COMPONENT_X,h[0]),SF(p,vF.A.METADATA_PICKING_VALUE_COMPONENT_Y,h[1]),SF(p,vF.A.METADATA_PICKING_VALUE_COMPONENT_Z,h[2]),SF(p,vF.A.METADATA_PICKING_VALUE_COMPONENT_W,h[3]);const f=new k.A({sources:t.fragmentShaderSource.sources,defines:p});return e.shaderCache.createDerivedShaderProgram(t,s,{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:f,attributeLocations:t._attributeLocations})}(n,t.shaderProgram,t.pickedMetadataInfo),i.pickMetadataCommand.renderState=EF(e,t.renderState),i.shaderProgramId=t.shaderProgram.id,i},TF.createHdrCommand=function(e,t,n){(0,d.A)(n)||(n={});const i=n.command?.shaderProgram;return n.command=m.A.shallowClone(e,n.command),(0,d.A)(i)&&n.shaderProgramId===e.shaderProgram.id?n.command.shaderProgram=i:(n.command.shaderProgram=function(e,t){const n=e.shaderCache.getDerivedShaderProgram(t,"HDR");if((0,d.A)(n))return n;const i=t._attributeLocations,o=t.vertexShaderSource.clone(),r=t.fragmentShaderSource.clone();return o.defines=(0,d.A)(o.defines)?o.defines.slice(0):[],o.defines.push("HDR"),r.defines=(0,d.A)(r.defines)?r.defines.slice(0):[],r.defines.push("HDR"),e.shaderCache.createDerivedShaderProgram(t,"HDR",{vertexShaderSource:o,fragmentShaderSource:r,attributeLocations:i})}(t,e.shaderProgram),n.shaderProgramId=e.shaderProgram.id),n};const RF=TF;function MF(e){if(!(0,d.A)(e))throw new A.A("scene is required.");this._scene=e,this._lastAlpha=void 0,this._lastBeta=void 0,this._lastGamma=void 0,this._alpha=void 0,this._beta=void 0,this._gamma=void 0;const t=this;function n(e){const n=e.alpha;if(!(0,d.A)(n))return t._alpha=void 0,t._beta=void 0,void(t._gamma=void 0);t._alpha=J.A.toRadians(n),t._beta=J.A.toRadians(e.beta),t._gamma=J.A.toRadians(e.gamma)}window.addEventListener("deviceorientation",n,!1),this._removeListener=function(){window.removeEventListener("deviceorientation",n,!1)}}const LF=new To.A,NF=new To.A,BF=new Z.A;MF.prototype.update=function(){if(!(0,d.A)(this._alpha))return;(0,d.A)(this._lastAlpha)||(this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma);const e=this._lastAlpha-this._alpha,t=this._lastBeta-this._beta,n=this._lastGamma-this._gamma;!function(e,t,n,i){const o=e.direction,r=e.right,s=e.up,a=To.A.fromAxisAngle(o,n,NF),c=To.A.fromAxisAngle(r,i,LF),l=To.A.multiply(c,a,c),u=To.A.fromAxisAngle(s,t,NF);To.A.multiply(u,l,l);const d=Z.A.fromQuaternion(l,BF);Z.A.multiplyByVector(d,r,r),Z.A.multiplyByVector(d,s,s),Z.A.multiplyByVector(d,o,o)}(this._scene.camera,-e,t,n),this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma},MF.prototype.isDestroyed=function(){return!1},MF.prototype.destroy=function(){return this._removeListener(),(0,h.A)(this)};const FF=MF;var UF=n(226381);function kF(){this.enabled=!0,this.renderable=!0,this.density=6e-4,this.heightScalar=.001,this._heightFalloff=.59,this.maxHeight=8e5,this.visualDensityScalar=.15,this.screenSpaceErrorFactor=2,this.minimumBrightness=.03}Object.defineProperties(kF.prototype,{heightFalloff:{get:function(){return this._heightFalloff},set:function(e){if((0,d.A)(e)&&e<0)throw new A.A("value must be positive.");this._heightFalloff=e}}});const VF=new j.A;kF.prototype.update=function(e){if(!(e.fog.enabled=this.enabled))return;e.fog.renderable=this.renderable;const t=e.camera,n=t.positionCartographic;if(!(0,d.A)(n)||n.height>this.maxHeight||e.mode!==Ce.A.SCENE3D)return e.fog.enabled=!1,void(e.fog.density=0);const i=n.height;let o=this.density*this.heightScalar*Math.pow(Math.max(i/this.maxHeight,J.A.EPSILON4),-Math.max(this._heightFalloff,0));const r=j.A.normalize(t.positionWC,VF);o*=1-Math.abs(j.A.dot(t.directionWC,r)),e.fog.density=o,e.fog.visualDensityScalar=this.visualDensityScalar,e.fog.sse=this.screenSpaceErrorFactor,e.fog.minimumBrightness=this.minimumBrightness};const zF=kF,HF=function(e,t,n){this.context=e,this.commandList=[],this.shadowMaps=[],this.brdfLutGenerator=void 0,this.environmentMap=void 0,this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this.specularEnvironmentMapsMaximumLOD=void 0,this.mode=Ce.A.SCENE3D,this.morphTime=Ce.A.getMorphTime(Ce.A.SCENE3D),this.frameNumber=0,this.newFrame=!1,this.time=void 0,this.jobScheduler=n,this.mapProjection=void 0,this.camera=void 0,this.cameraUnderground=!1,this.globeTranslucencyState=void 0,this.cullingVolume=void 0,this.occluder=void 0,this.maximumScreenSpaceError=void 0,this.pixelRatio=1,this.passes={render:!1,pick:!1,pickVoxel:!1,depth:!1,postProcess:!1,offscreen:!1},this.creditDisplay=t,this.afterRender=[],this.scene3DOnly=!1,this.fog={enabled:!1,renderable:!1,density:void 0,visualDensityScalar:void 0,sse:void 0,minimumBrightness:void 0},this.atmosphere=void 0,this.verticalExaggeration=1,this.verticalExaggerationRelativeHeight=0,this.shadowState={shadowsEnabled:!0,shadowMaps:[],lightShadowMaps:[],nearPlane:1,farPlane:5e3,closestObjectSize:1e3,lastDirtyTime:0,outOfView:!0},this.splitPosition=0,this.frustumSplits=[],this.backgroundColor=void 0,this.light=void 0,this.minimumDisableDepthTestDistance=void 0,this.invertClassification=!1,this.invertClassificationColor=void 0,this.useLogDepth=!1,this.tilesetPassState=void 0,this.minimumTerrainHeight=0,this.pickingMetadata=!1,this.pickedMetadataInfo=void 0},GF=11,WF=["opaqueFrontFaceCommand","opaqueBackFaceCommand","depthOnlyFrontFaceCommand","depthOnlyBackFaceCommand","depthOnlyFrontAndBackFaceCommand","translucentFrontFaceCommand","translucentBackFaceCommand","translucentFrontFaceManualDepthTestCommand","translucentBackFaceManualDepthTestCommand","pickFrontFaceCommand","pickBackFaceCommand"];function YF(){this._frontFaceAlphaByDistance=new kt.A(0,1,0,1),this._backFaceAlphaByDistance=new kt.A(0,1,0,1),this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._requiresManualDepthTest=!1,this._sunVisibleThroughGlobe=!1,this._environmentVisible=!1,this._useDepthPlane=!1,this._numberOfTextureUniforms=0,this._globeTranslucencyFramebuffer=void 0,this._rectangle=Or.A.clone(Or.A.MAX_VALUE),this._derivedCommandKey=0,this._derivedCommandsDirty=!1,this._derivedCommandPacks=void 0,this._derivedCommandTypes=new Array(GF),this._derivedBlendCommandTypes=new Array(GF),this._derivedPickCommandTypes=new Array(GF),this._derivedCommandTypesToUpdate=new Array(GF),this._derivedCommandsLength=0,this._derivedBlendCommandsLength=0,this._derivedPickCommandsLength=0,this._derivedCommandsToUpdateLength=0}function qF(e,t,n,i){return e?(0,d.A)(n)?(kt.A.clone(n,i),i.nearValue*=t,i.farValue*=t,i):(i.nearValue=t,i.farValue=t,i):(i.nearValue=1,i.farValue=1,i)}function jF(e,t,n){return e&&(n.baseColor.alpha<1||t.nearValue<1||t.farValue<1)}function QF(e,t,n,i,o){let r=0;const s=e._frontFaceTranslucent,a=e._backFaceTranslucent;if(!s)return r;const c=t.cameraUnderground,l=e._requiresManualDepthTest,u=i?9:l?7:5,d=i?10:l?8:6;return t.mode===Ce.A.SCENE2D?(o[r++]=2,o[r++]=u,r):(a?(n||(o[r++]=4),c?(o[r++]=u,o[r++]=d):(o[r++]=d,o[r++]=u)):c?(n||(o[r++]=3),o[r++]=0,o[r++]=d):(n||(o[r++]=2),o[r++]=1,o[r++]=u),r)}function XF(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}function KF(e,t){return e.indexOf(t)>-1}function $F(e,t){XF(e.defines,"TRANSLUCENT"),XF(t.defines,"TRANSLUCENT")}function JF(e,t){XF(e.defines,"GROUND_ATMOSPHERE"),XF(t.defines,"GROUND_ATMOSPHERE"),XF(e.defines,"FOG"),XF(t.defines,"FOG"),XF(e.defines,"TRANSLUCENT"),XF(t.defines,"TRANSLUCENT")}function ZF(e,t){KF(t.defines,"TILE_LIMIT_RECTANGLE")||KF(t.defines,"ENABLE_CLIPPING_PLANES")||(t.sources=["void main() \n{ \n    out_FragColor = vec4(1.0); \n} \n"])}function eU(e,t){const n=t.sources,i=n.length;for(let e=0;e<i;++e)n[e]=k.A.replaceMain(n[e],"czm_globe_translucency_main");n.push("\n\nuniform sampler2D u_classificationTexture; \nvoid main() \n{ \n    vec2 st = gl_FragCoord.xy / czm_viewport.zw; \n#ifdef MANUAL_DEPTH_TEST \n    float logDepthOrDepth = czm_unpackDepth(texture(czm_globeDepthTexture, st)); \n    if (logDepthOrDepth != 0.0) \n    { \n        vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth); \n        float depthEC = eyeCoordinate.z / eyeCoordinate.w; \n        if (v_positionEC.z < depthEC) \n        { \n            discard; \n        } \n    } \n#endif \n    czm_globe_translucency_main(); \n    vec4 classificationColor = texture(u_classificationTexture, st); \n    if (classificationColor.a > 0.0) \n    { \n        // Reverse premultiplication process to get the correct composited result of the classification primitives \n        classificationColor.rgb /= classificationColor.a; \n    } \n    out_FragColor = classificationColor * vec4(classificationColor.aaa, 1.0) + out_FragColor * (1.0 - classificationColor.a); \n} \n")}function tU(e,t){eU(0,t),XF(e.defines,"GROUND_ATMOSPHERE"),XF(t.defines,"GROUND_ATMOSPHERE"),XF(e.defines,"FOG"),XF(t.defines,"FOG")}function nU(e,t){eU(0,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function iU(e,t){tU(e,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function oU(e,t){t.sources=["uniform sampler2D u_classificationTexture; \nvoid main() \n{ \n    vec2 st = gl_FragCoord.xy / czm_viewport.zw; \n    vec4 pickColor = texture(u_classificationTexture, st); \n    if (pickColor == vec4(0.0)) \n    { \n        discard; \n    } \n    out_FragColor = pickColor; \n} \n"]}function rU(e,t,n,i,o,r){if(!(0,d.A)(o))return t;if(!i&&(0,d.A)(n))return n;let s=e.shaderCache.getDerivedShaderProgram(t,r);if(!(0,d.A)(s)){const n=t._attributeLocations,i=t.vertexShaderSource.clone(),a=t.fragmentShaderSource.clone();i.defines=(0,d.A)(i.defines)?i.defines.slice(0):[],a.defines=(0,d.A)(a.defines)?a.defines.slice(0):[],o(i,a),s=e.shaderCache.createDerivedShaderProgram(t,r,{vertexShaderSource:i,fragmentShaderSource:a,attributeLocations:n})}return s}function sU(e){e.cull.face=CB.A.BACK,e.cull.enabled=!0}function aU(e){e.cull.face=CB.A.FRONT,e.cull.enabled=!0}function cU(e){e.cull.face=CB.A.BACK,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function lU(e){e.cull.face=CB.A.FRONT,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function uU(e){e.cull.enabled=!1,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function dU(e){e.cull.face=CB.A.BACK,e.cull.enabled=!0,e.depthMask=!1,e.blending=$M.A.ALPHA_BLEND}function hU(e){e.cull.face=CB.A.FRONT,e.cull.enabled=!0,e.depthMask=!1,e.blending=$M.A.ALPHA_BLEND}function AU(e){e.cull.face=CB.A.BACK,e.cull.enabled=!0,e.blending.enabled=!1}function pU(e){e.cull.face=CB.A.FRONT,e.cull.enabled=!0,e.blending.enabled=!1}function fU(e,t,n,i,o){if(!(0,d.A)(i))return e;if(!n&&(0,d.A)(t))return t;let r=o[e.id];if(!(0,d.A)(r)){const t=_.A.getState(e);i(t),r=_.A.fromCache(t),o[e.id]=r}return r}function mU(e){return{u_classificationTexture:function(){return e._globeTranslucencyFramebuffer.classificationTexture}}}function gU(e,t,n,i,o){return(0,d.A)(o)?!i&&(0,d.A)(n)?n:(0,tC.A)(t,o(e),!1):t}function _U(e){this.pass=e.pass,this.pickOnly=e.pickOnly,this.getShaderProgramFunction=e.getShaderProgramFunction,this.getRenderStateFunction=e.getRenderStateFunction,this.getUniformMapFunction=e.getUniformMapFunction,this.renderStateCache={}}Object.defineProperties(YF.prototype,{frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance}},translucent:{get:function(){return this._frontFaceTranslucent}},sunVisibleThroughGlobe:{get:function(){return this._sunVisibleThroughGlobe}},environmentVisible:{get:function(){return this._environmentVisible}},useDepthPlane:{get:function(){return this._useDepthPlane}},numberOfTextureUniforms:{get:function(){return this._numberOfTextureUniforms}},rectangle:{get:function(){return this._rectangle}}}),YF.prototype.update=function(e){const t=e.globe;if(!(0,d.A)(t)||!t.show)return this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._sunVisibleThroughGlobe=!0,this._environmentVisible=!0,void(this._useDepthPlane=!1);this._frontFaceAlphaByDistance=qF(t.translucency.enabled,t.translucency.frontFaceAlpha,t.translucency.frontFaceAlphaByDistance,this._frontFaceAlphaByDistance),this._backFaceAlphaByDistance=qF(t.translucency.enabled,t.translucency.backFaceAlpha,t.translucency.backFaceAlphaByDistance,this._backFaceAlphaByDistance),this._frontFaceTranslucent=jF(t.translucency.enabled,this._frontFaceAlphaByDistance,t),this._backFaceTranslucent=jF(t.translucency.enabled,this._backFaceAlphaByDistance,t),this._requiresManualDepthTest=function(e,t,n){return e._frontFaceTranslucent&&!e._backFaceTranslucent&&!n.depthTestAgainstTerrain&&t.mode!==Ce.A.SCENE2D&&t.context.depthTexture}(this,e,t),this._sunVisibleThroughGlobe=function(e,t){const n=e._frontFaceTranslucent,i=e._backFaceTranslucent;return n&&(t.cameraUnderground||i)}(this,e),this._environmentVisible=function(e,t){return!t.cameraUnderground||e._frontFaceTranslucent}(this,e),this._useDepthPlane=function(e,t){return!t.cameraUnderground&&!e._frontFaceTranslucent}(this,e),this._numberOfTextureUniforms=function(e){let t=0;return e._frontFaceTranslucent&&++t,e._requiresManualDepthTest&&++t,t}(this),this._rectangle=Or.A.clone(t.translucency.rectangle,this._rectangle),function(e,t){let n;e._derivedCommandsLength=QF(e,t,!1,!1,e._derivedCommandTypes),e._derivedBlendCommandsLength=QF(e,t,!0,!1,e._derivedBlendCommandTypes),e._derivedPickCommandsLength=QF(e,t,!1,!0,e._derivedPickCommandTypes);let i=0;for(n=0;n<e._derivedCommandsLength;++n)i|=1<<e._derivedCommandTypes[n];for(n=0;n<e._derivedBlendCommandsLength;++n)i|=1<<e._derivedBlendCommandTypes[n];for(n=0;n<e._derivedPickCommandsLength;++n)i|=1<<e._derivedPickCommandTypes[n];let o=0;for(n=0;n<GF;++n)(i&1<<n)>0&&(e._derivedCommandTypesToUpdate[o++]=n);e._derivedCommandsToUpdateLength=o;const r=i!==e._derivedCommandKey;e._derivedCommandKey=i,e._derivedCommandsDirty=r,!(0,d.A)(e._derivedCommandPacks)&&e._frontFaceTranslucent&&(e._derivedCommandPacks=[new _U({pass:ut.A.GLOBE,pickOnly:!1,getShaderProgramFunction:$F,getRenderStateFunction:sU,getUniformMapFunction:void 0}),new _U({pass:ut.A.GLOBE,pickOnly:!1,getShaderProgramFunction:JF,getRenderStateFunction:aU,getUniformMapFunction:void 0}),new _U({pass:ut.A.GLOBE,pickOnly:!1,getShaderProgramFunction:ZF,getRenderStateFunction:cU,getUniformMapFunction:void 0}),new _U({pass:ut.A.GLOBE,pickOnly:!1,getShaderProgramFunction:ZF,getRenderStateFunction:lU,getUniformMapFunction:void 0}),new _U({pass:ut.A.GLOBE,pickOnly:!1,getShaderProgramFunction:ZF,getRenderStateFunction:uU,getUniformMapFunction:void 0}),new _U({pass:ut.A.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:eU,getRenderStateFunction:dU,getUniformMapFunction:mU}),new _U({pass:ut.A.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:tU,getRenderStateFunction:hU,getUniformMapFunction:mU}),new _U({pass:ut.A.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:nU,getRenderStateFunction:dU,getUniformMapFunction:mU}),new _U({pass:ut.A.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:iU,getRenderStateFunction:hU,getUniformMapFunction:mU}),new _U({pass:ut.A.TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:oU,getRenderStateFunction:AU,getUniformMapFunction:mU}),new _U({pass:ut.A.TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:oU,getRenderStateFunction:pU,getUniformMapFunction:mU})])}(this,e)};const yU=new Array(GF),vU=new Array(GF);function TU(e,t,n,i,o,r){for(let s=0;s<t;++s){const t=e[s],a=t.derivedCommands.type;(!(0,d.A)(r)||r.indexOf(a)>-1)&&n(t,i,o)}}function bU(e,t,n,i,o){for(let r=0;r<t;++r)n(e[r],i,o)}YF.prototype.updateDerivedCommands=function(e,t){const n=this._derivedCommandTypesToUpdate,i=this._derivedCommandsToUpdateLength;if(0!==i){for(let e=0;e<i;++e)vU[e]=this._derivedCommandPacks[n[e]],yU[e]=WF[n[e]];!function(e,t,n,i,o,r,s){let a=t.derivedCommands.globeTranslucency;const c=e._derivedCommandsDirty;if(t.dirty||!(0,d.A)(a)||c){t.dirty=!1,(0,d.A)(a)||(a={},t.derivedCommands.globeTranslucency=a);const c=s.frameNumber,l=a.uniformMapDirtyFrame??0,u=a.shaderProgramDirtyFrame??0,h=a.renderStateDirtyFrame??0,A=a.uniformMap!==t.uniformMap,p=a.shaderProgramId!==t.shaderProgram.id,f=a.renderStateId!==t.renderState.id;A&&(a.uniformMapDirtyFrame=c),p&&(a.shaderProgramDirtyFrame=c),f&&(a.renderStateDirtyFrame=c),a.uniformMap=t.uniformMap,a.shaderProgramId=t.shaderProgram.id,a.renderStateId=t.renderState.id;for(let g=0;g<n;++g){const n=r[g],_=i[g],y=o[g];let v,T,b,w=a[y];(0,d.A)(w)?(v=w.uniformMap,T=w.shaderProgram,b=w.renderState):(v=void 0,T=void 0,b=void 0),w=m.A.shallowClone(t,w),a[y]=w;const x=w.derivedCommands.uniformMapDirtyFrame??0,C=w.derivedCommands.shaderProgramDirtyFrame??0,E=w.derivedCommands.renderStateDirtyFrame??0,S=A||x<l,I=p||C<u,P=f||E<h;S&&(w.derivedCommands.uniformMapDirtyFrame=c),I&&(w.derivedCommands.shaderProgramDirtyFrame=c),P&&(w.derivedCommands.renderStateDirtyFrame=c),w.derivedCommands.type=_,w.pass=n.pass,w.pickOnly=n.pickOnly,w.uniformMap=gU(e,t.uniformMap,v,S,n.getUniformMapFunction),w.shaderProgram=rU(s.context,t.shaderProgram,T,I,n.getShaderProgramFunction,y),w.renderState=fU(t.renderState,b,P,n.getRenderStateFunction,n.renderStateCache)}}}(this,e,i,n,yU,vU,t)}},YF.prototype.pushDerivedCommands=function(e,t,n){const i=n.passes.pick||n.passes.pickVoxel;if(i&&t)return;let o=this._derivedCommandTypes,r=this._derivedCommandsLength;if(i?(o=this._derivedPickCommandTypes,r=this._derivedPickCommandsLength):t&&(o=this._derivedBlendCommandTypes,r=this._derivedBlendCommandsLength),0===r)return void n.commandList.push(e);const s=e.derivedCommands.globeTranslucency;for(let e=0;e<r;++e){const t=WF[o[e]];n.commandList.push(s[t])}};const wU=[0,1],xU=[2,3,4];YF.prototype.executeGlobeCommands=function(e,t,n,i,o){const r=i.context,s=e.commands[ut.A.GLOBE],a=e.indices[ut.A.GLOBE];0!==a&&(this._globeTranslucencyFramebuffer=n,n.clearClassification(r,o),TU(s,a,t,i,o,wU))},YF.prototype.executeGlobeClassificationCommands=function(e,t,n,i,o){const{context:r}=i,{uniformState:s}=r,a=e.commands[ut.A.GLOBE],c=e.indices[ut.A.GLOBE],l=e.commands[ut.A.TERRAIN_CLASSIFICATION],u=e.indices[ut.A.TERRAIN_CLASSIFICATION];if(0===c||0===u)return;const d=this._frontFaceTranslucent,h=this._backFaceTranslucent;if(d&&h||bU(l,u,t,i,o),!d&&!h)return;this._globeTranslucencyFramebuffer=n;const A=s.globeDepthTexture,p=o.framebuffer;if(o.framebuffer=n.classificationFramebuffer,TU(a,c,t,i,o,xU),r.depthTexture){const e=n.packDepth(r,o);s.globeDepthTexture=e}bU(l,u,t,i,o),s.globeDepthTexture=A,o.framebuffer=p};const CU=YF,EU="uniform sampler2D colorTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    out_FragColor = texture(colorTexture, v_textureCoordinates);\n}\n";var SU=n(938987),IU=n(896464),PU=n(138151);function DU(){this._numSamples=1,this.previousFramebuffer=void 0,this._previousFramebuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this._fbo=new at.A({depthStencil:!0,createDepthAttachments:!1}),this._fboClassified=new at.A({depthStencil:!0,createDepthAttachments:!1}),this._rsUnclassified=void 0,this._rsClassified=void 0,this._unclassifiedCommand=void 0,this._classifiedCommand=void 0,this._translucentCommand=void 0,this._clearColorCommand=new s.A({color:new u.A(0,0,0,0),owner:this}),this._clearCommand=new s.A({color:new u.A(0,0,0,0),depth:1,stencil:0});const e=this;this._uniformMap={colorTexture:function(){return e._fbo.getColorTexture()},depthTexture:function(){return e._depthStencilTexture},classifiedTexture:function(){return e._fboClassified.getColorTexture()}}}Object.defineProperties(DU.prototype,{unclassifiedCommand:{get:function(){return this._unclassifiedCommand}}}),DU.isTranslucencySupported=function(e){return e.depthTexture&&e.fragmentDepth};const OU={depthMask:!1,stencilTest:{enabled:!0,frontFunction:IU.A.EQUAL,frontOperation:{fail:PU.A.KEEP,zFail:PU.A.KEEP,zPass:PU.A.KEEP},backFunction:IU.A.NEVER,reference:0,mask:SU.A.CLASSIFICATION_MASK},blending:$M.A.ALPHA_BLEND},RU={depthMask:!1,stencilTest:{enabled:!0,frontFunction:IU.A.NOT_EQUAL,frontOperation:{fail:PU.A.KEEP,zFail:PU.A.KEEP,zPass:PU.A.KEEP},backFunction:IU.A.NEVER,reference:0,mask:SU.A.CLASSIFICATION_MASK},blending:$M.A.ALPHA_BLEND},MU={depthMask:!0,depthTest:{enabled:!0},stencilTest:SU.A.setCesium3DTileBit(),stencilMask:SU.A.CESIUM_3D_TILE_MASK,blending:$M.A.ALPHA_BLEND};DU.prototype.update=function(e,t,n){const i=this._fbo.getColorTexture(),o=this.previousFramebuffer!==this._previousFramebuffer;this._previousFramebuffer=this.previousFramebuffer;const r=this._numSamples!==t,s=e.drawingBufferWidth,a=e.drawingBufferHeight,c=!(0,d.A)(i)||i.width!==s||i.height!==a;if((c||o||r)&&(this._numSamples=t,this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy(),(0,d.A)(this._previousFramebuffer)||(this._depthStencilTexture=new G.A({context:e,width:s,height:a,pixelFormat:R.A.DEPTH_STENCIL,pixelDatatype:U.A.UNSIGNED_INT_24_8}),t>1&&(this._depthStencilRenderbuffer=new dt.A({context:e,width:s,height:a,format:ht.A.DEPTH24_STENCIL8,numSamples:t})))),!(0,d.A)(this._fbo.framebuffer)||c||o||r){let i,o;this._fbo.destroy(),this._fboClassified.destroy(),(0,d.A)(this._previousFramebuffer)?(i=n.getDepthStencilTexture(),o=n.getDepthStencilRenderbuffer()):(i=this._depthStencilTexture,o=this._depthStencilRenderbuffer),this._fbo.setDepthStencilTexture(i),(0,d.A)(o)&&this._fbo.setDepthStencilRenderbuffer(o),this._fbo.update(e,s,a,t),(0,d.A)(this._previousFramebuffer)||(this._fboClassified.setDepthStencilTexture(i),this._fboClassified.update(e,s,a))}if((0,d.A)(this._rsUnclassified)||(this._rsUnclassified=_.A.fromCache(OU),this._rsClassified=_.A.fromCache(RU),this._rsDefault=_.A.fromCache(MU)),!(0,d.A)(this._unclassifiedCommand)||o||r){(0,d.A)(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy());const t=(0,d.A)(this._previousFramebuffer)?"uniform sampler2D colorTexture;\nin vec2 v_textureCoordinates;\nvoid main()\n{\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n    if (color.a == 0.0)\n    {\n        discard;\n    }\n#ifdef UNCLASSIFIED\n    out_FragColor = color * czm_invertClassificationColor;\n#else\n    out_FragColor = color;\n#endif\n}\n":"uniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform sampler2D classifiedTexture;\nin vec2 v_textureCoordinates;\nvoid main()\n{\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n    if (color.a == 0.0)\n    {\n        discard;\n    }\n    bool isClassified = all(equal(texture(classifiedTexture, v_textureCoordinates), vec4(0.0)));\n#ifdef UNCLASSIFIED\n    vec4 highlightColor = czm_invertClassificationColor;\n    if (isClassified)\n    {\n        discard;\n    }\n#else\n    vec4 highlightColor = vec4(1.0);\n    if (!isClassified)\n    {\n        discard;\n    }\n#endif\n    out_FragColor = color * highlightColor;\n    gl_FragDepth = texture(depthTexture, v_textureCoordinates).r;\n}\n",n=new k.A({defines:["UNCLASSIFIED"],sources:[t]}),i=new k.A({sources:[t]});this._unclassifiedCommand=e.createViewportQuadCommand(n,{renderState:(0,d.A)(this._previousFramebuffer)?this._rsUnclassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),this._classifiedCommand=e.createViewportQuadCommand(i,{renderState:(0,d.A)(this._previousFramebuffer)?this._rsClassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),(0,d.A)(this._translucentCommand)&&(this._translucentCommand.shaderProgram=this._translucentCommand.shaderProgram&&this._translucentCommand.shaderProgram.destroy()),(0,d.A)(this._previousFramebuffer)||(this._translucentCommand=e.createViewportQuadCommand(EU,{renderState:this._rsUnclassified,uniformMap:this._uniformMap,owner:this}))}},DU.prototype.prepareTextures=function(e,t){this._fbo._numSamples>1&&this._fbo.prepareTextures(e,t)},DU.prototype.clear=function(e,t){(0,d.A)(this._previousFramebuffer)?this._fbo.clear(e,this._clearColorCommand,t):(this._fbo.clear(e,this._clearCommand,t),this._fboClassified.clear(e,this._clearCommand,t))},DU.prototype.executeClassified=function(e,t){if(!(0,d.A)(this._previousFramebuffer)){const n=t.framebuffer;this.prepareTextures(e,!0),t.framebuffer=this._fboClassified.framebuffer,this._translucentCommand.execute(e,t),t.framebuffer=n}this._classifiedCommand.execute(e,t)},DU.prototype.executeUnclassified=function(e,t){this._unclassifiedCommand.execute(e,t)},DU.prototype.isDestroyed=function(){return!1},DU.prototype.destroy=function(){return this._fbo.destroy(),this._fboClassified.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy(),(0,d.A)(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy()),(0,h.A)(this)};const LU=DU;var NU=n(666203);function BU(e){this._total=e,this.usedThisFrame=0,this.stolenFromMeThisFrame=0,this.starvedThisFrame=!1,this.starvedLastFrame=!1}function FU(e){if((0,d.A)(e)&&e.length!==NU.A.NUMBER_OF_JOB_TYPES)throw new A.A("A budget must be specified for each job type; budgets.length should equal JobType.NUMBER_OF_JOB_TYPES.");const t=new Array(NU.A.NUMBER_OF_JOB_TYPES);t[NU.A.TEXTURE]=new BU((0,d.A)(e)?e[NU.A.TEXTURE]:10),t[NU.A.PROGRAM]=new BU((0,d.A)(e)?e[NU.A.PROGRAM]:10),t[NU.A.BUFFER]=new BU((0,d.A)(e)?e[NU.A.BUFFER]:30);const n=t.length;let i,o=0;for(i=0;i<n;++i)o+=t[i].total;const r=new Array(n);for(i=0;i<n;++i)r[i]=!1;this._totalBudget=o,this._totalUsedThisFrame=0,this._budgets=t,this._executedThisFrame=r}Object.defineProperties(BU.prototype,{total:{get:function(){return this._total}}}),FU.getTimestamp=aa.A,Object.defineProperties(FU.prototype,{totalBudget:{get:function(){return this._totalBudget}}}),FU.prototype.disableThisFrame=function(){this._totalUsedThisFrame=this._totalBudget},FU.prototype.resetBudgets=function(){const e=this._budgets,t=e.length;for(let n=0;n<t;++n){const t=e[n];t.starvedLastFrame=t.starvedThisFrame,t.starvedThisFrame=!1,t.usedThisFrame=0,t.stolenFromMeThisFrame=0}this._totalUsedThisFrame=0},FU.prototype.execute=function(e,t){const n=this._budgets,i=n[t],o=this._executedThisFrame[t];if(this._totalUsedThisFrame>=this._totalBudget&&o)return i.starvedThisFrame=!0,!1;let r;if(i.usedThisFrame+i.stolenFromMeThisFrame>=i.total){const e=n.length;let t;for(t=0;t<e&&(r=n[t],!(r.usedThisFrame+r.stolenFromMeThisFrame<r.total)||r.starvedLastFrame);++t);if(t===e&&o)return!1;o&&(i.starvedThisFrame=!0)}const s=FU.getTimestamp();e.execute();const a=FU.getTimestamp()-s;return this._totalUsedThisFrame+=a,r?r.stolenFromMeThisFrame+=a:i.usedThisFrame+=a,this._executedThisFrame[t]=!0,!0};const UU=FU;var kU=n(77879);function VU(e){e=e??S.A.EMPTY_OBJECT;const t=(0,Qx.A)(e.container);if(!(0,d.A)(t))throw new A.A("container is required");this._container=t;const n=document.createElement("div");n.className="cesium-performanceDisplay";const i=document.createElement("div");i.className="cesium-performanceDisplay-fps",this._fpsText=document.createTextNode(""),i.appendChild(this._fpsText);const o=document.createElement("div");o.className="cesium-performanceDisplay-ms",this._msText=document.createTextNode(""),o.appendChild(this._msText),n.appendChild(o),n.appendChild(i),this._container.appendChild(n),this._lastFpsSampleTime=(0,aa.A)(),this._lastMsSampleTime=(0,aa.A)(),this._fpsFrameCount=0,this._msFrameCount=0,this._throttled=!1;const r=document.createElement("div");r.className="cesium-performanceDisplay-throttled",this._throttledText=document.createTextNode(""),r.appendChild(this._throttledText),n.appendChild(r)}Object.defineProperties(VU.prototype,{throttled:{get:function(){return this._throttled},set:function(e){this._throttled!==e&&(this._throttledText.nodeValue=e?"(throttled)":"",this._throttled=e)}}}),VU.prototype.update=function(e){const t=(0,aa.A)(),n=e??!0;this._fpsFrameCount++;const i=t-this._lastFpsSampleTime;if(i>1e3){let e="N/A";n&&(e=1e3*this._fpsFrameCount/i|0),this._fpsText.nodeValue=`${e} FPS`,this._lastFpsSampleTime=t,this._fpsFrameCount=0}this._msFrameCount++;const o=t-this._lastMsSampleTime;if(o>200){let e="N/A";n&&(e=(o/this._msFrameCount).toFixed(2)),this._msText.nodeValue=`${e} MS`,this._lastMsSampleTime=t,this._msFrameCount=0}},VU.prototype.destroy=function(){return(0,h.A)(this)};const zU=VU;var HU=n(622569),GU=n(343674);const WU={decodeRawMetadataValue:function(e,t,n){switch(e){case _F.A.INT8:return t.getInt8(n);case _F.A.UINT8:return t.getUint8(n);case _F.A.INT16:return t.getInt16(n,!0);case _F.A.UINT16:return t.getUint16(n,!0);case _F.A.INT32:return t.getInt32(n,!0);case _F.A.UINT32:return t.getUint32(n,!0);case _F.A.INT64:return t.getBigInt64(n,!0);case _F.A.UINT64:return t.getBigUint64(n,!0);case _F.A.FLOAT32:return t.getFloat32(n,!0);case _F.A.FLOAT64:return t.getFloat64(n,!0)}throw new M.A(`Invalid component type: ${e}`)},decodeRawMetadataValueComponent:function(e,t,n){const i=e.componentType,o=WU.decodeRawMetadataValue(i,t,n);return e.normalized?_F.A.normalize(o,i):o},decodeRawMetadataValueElement:function(e,t,n){const i=e.componentType,o=_F.A.getSizeInBytes(i),r=e.type,s=yF.A.getComponentCount(r),a=o*s;if(s>1){const i=Array(s);for(let r=0;r<s;r++){const s=n*a+r*o,c=WU.decodeRawMetadataValueComponent(e,t,s);i[r]=c}return i}const c=n*a;return WU.decodeRawMetadataValueComponent(e,t,c)},decodeRawMetadataValues:function(e,t){const n=new DataView(t.buffer,t.byteOffset,t.byteLength);if(e.isArray){const t=e.arrayLength,i=Array(t);for(let o=0;o<t;o++){const t=WU.decodeRawMetadataValueElement(e,n,o);i[o]=t}return i}return WU.decodeRawMetadataValueElement(e,n,0)},convertToObjectType:function(e,t){if(!(0,d.A)(t))return t;if(e===yF.A.SCALAR||e===yF.A.STRING||e===yF.A.BOOLEAN||e===yF.A.ENUM)return t;const n=t.map(e=>Number(e));switch(e){case yF.A.VEC2:return q.A.unpack(n,0,new q.A);case yF.A.VEC3:return j.A.unpack(n,0,new j.A);case yF.A.VEC4:return Q.A.unpack(n,0,new Q.A);case yF.A.MAT2:return vh.A.unpack(n,0,new vh.A);case yF.A.MAT3:return Z.A.unpack(n,0,new Z.A);case yF.A.MAT4:return O.A.unpack(n,0,new O.A)}throw new M.A(`Invalid metadata object type: ${e}`)},convertFromObjectType:function(e,t){if(!(0,d.A)(t))return t;if(e===yF.A.SCALAR||e===yF.A.STRING||e===yF.A.BOOLEAN||e===yF.A.ENUM)return t;switch(e){case yF.A.VEC2:return q.A.pack(t,Array(2));case yF.A.VEC3:return j.A.pack(t,Array(3));case yF.A.VEC4:return Q.A.pack(t,Array(4));case yF.A.MAT2:return vh.A.pack(t,Array(4));case yF.A.MAT3:return Z.A.pack(t,Array(9));case yF.A.MAT4:return O.A.pack(t,Array(16))}throw new M.A(`Invalid metadata object type: ${e}`)},decodeMetadataValues:function(e,t,n){let i=WU.decodeRawMetadataValues(e,n);if(t.hasValueTransform){const n=WU.convertFromObjectType(e.type,t.offset),o=WU.convertFromObjectType(e.type,t.scale);i=GU.A.valueTransformInPlace(i,n,o,_F.A.applyValueTransform)}if(e.isArray){const t=e.arrayLength,n=Array(t);for(let o=0;o<t;o++){const t=i[o],r=WU.convertToObjectType(e.type,t);n[o]=r}return n}return WU.convertToObjectType(e.type,i)}},YU=Object.freeze(WU);function qU(){this._framebuffer=new at.A,this._textureToCopy=void 0,this._copyDepthCommand=void 0}Object.defineProperties(qU.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}}}),qU.prototype.update=function(e,t){!function(e,t,n){const{width:i,height:o}=n;e._framebuffer.update(t,i,o)}(this,e,t),function(e,t,n){(0,d.A)(e._copyDepthCommand)||(e._copyDepthCommand=t.createViewportQuadCommand("uniform highp sampler2D colorTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n  vec4 globeDepthPacked = texture(czm_globeDepthTexture, v_textureCoordinates);\n  float globeDepth = czm_unpackDepth(globeDepthPacked);\n  float depth = texture(colorTexture, v_textureCoordinates).r;\n  out_FragColor = czm_branchFreeTernary(globeDepth <= 0.0 || globeDepth >= 1.0 || depth < globeDepth && depth > 0.0 && depth < 1.0,\n    czm_packDepth(depth), globeDepthPacked);\n}\n",{renderState:_.A.fromCache(),uniformMap:{colorTexture:function(){return e._textureToCopy}},owner:e})),e._textureToCopy=n,e._copyDepthCommand.framebuffer=e.framebuffer}(this,e,t)};const jU=new Q.A,QU=new Q.A(1,1/255,1/65025,1/16581375);qU.prototype.getDepth=function(e,t,n){if(!(0,d.A)(this.framebuffer))return;const i=e.readPixels({x:t,y:n,width:1,height:1,framebuffer:this.framebuffer}),o=Q.A.unpack(i,0,jU);return Q.A.divideByScalar(o,255,o),Q.A.dot(o,QU)},qU.prototype.executeCopyDepth=function(e,t){this._copyDepthCommand.execute(e,t)},qU.prototype.isDestroyed=function(){return!1},qU.prototype.destroy=function(){return this._framebuffer.destroy(),(0,d.A)(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=(0,d.A)(this._copyDepthCommand.shaderProgram)&&this._copyDepthCommand.shaderProgram.destroy()),(0,h.A)(this)};const XU=qU;var KU=n(78173);const $U=function(e,t){this.near=e??0,this.far=t??0;const n=ut.A.NUMBER_OF_PASSES,i=new Array(n),o=new Array(n);for(let e=0;e<n;++e)i[e]=[],o[e]=0;this.commands=i,this.indices=o},JU="uniform highp sampler2D u_depthTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    out_FragColor = czm_packDepth(texture(u_depthTexture, v_textureCoordinates).r);\n}\n";function ZU(){this._picking=!1,this._numSamples=1,this._tempCopyDepthTexture=void 0,this._pickColorFramebuffer=new at.A({depthStencil:!0,supportsDepthTexture:!0}),this._outputFramebuffer=new at.A({depthStencil:!0,supportsDepthTexture:!0}),this._copyDepthFramebuffer=new at.A,this._tempCopyDepthFramebuffer=new at.A,this._updateDepthFramebuffer=new at.A({createColorAttachments:!1,createDepthAttachments:!1,depthStencil:!0}),this._clearGlobeColorCommand=void 0,this._copyColorCommand=void 0,this._copyDepthCommand=void 0,this._tempCopyDepthCommand=void 0,this._updateDepthCommand=void 0,this._viewport=new c.A,this._rs=void 0,this._rsBlend=void 0,this._rsUpdate=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHdr=void 0,this._clearGlobeDepth=void 0}function ek(e,t,n,i,o){const r=e._viewport;r.width=n,r.height=i;const a=!c.A.equals(r,o.viewport);let l=a!==e._useScissorTest;e._useScissorTest=a,c.A.equals(e._scissorRectangle,o.viewport)||(e._scissorRectangle=c.A.clone(o.viewport,e._scissorRectangle),l=!0),(0,d.A)(e._rs)&&c.A.equals(r,e._rs.viewport)&&!l||(e._rs=_.A.fromCache({viewport:r,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}}),e._rsBlend=_.A.fromCache({viewport:r,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},blending:$M.A.ALPHA_BLEND}),e._rsUpdate=_.A.fromCache({viewport:r,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},stencilTest:{enabled:!0,frontFunction:IU.A.EQUAL,frontOperation:{fail:PU.A.KEEP,zFail:PU.A.KEEP,zPass:PU.A.KEEP},backFunction:IU.A.NEVER,reference:SU.A.CESIUM_3D_TILE_MASK,mask:SU.A.CESIUM_3D_TILE_MASK}})),(0,d.A)(e._copyDepthCommand)||(e._copyDepthCommand=t.createViewportQuadCommand(JU,{uniformMap:{u_depthTexture:function(){return e.colorFramebufferManager.getDepthStencilTexture()}},owner:e})),e._copyDepthCommand.framebuffer=e._copyDepthFramebuffer.framebuffer,e._copyDepthCommand.renderState=e._rs,(0,d.A)(e._copyColorCommand)||(e._copyColorCommand=t.createViewportQuadCommand(EU,{uniformMap:{colorTexture:function(){return e.colorFramebufferManager.getColorTexture()}},owner:e})),e._copyColorCommand.renderState=e._rs,(0,d.A)(e._tempCopyDepthCommand)||(e._tempCopyDepthCommand=t.createViewportQuadCommand(JU,{uniformMap:{u_depthTexture:function(){return e._tempCopyDepthTexture}},owner:e})),e._tempCopyDepthCommand.framebuffer=e._tempCopyDepthFramebuffer.framebuffer,e._tempCopyDepthCommand.renderState=e._rs,(0,d.A)(e._updateDepthCommand)||(e._updateDepthCommand=t.createViewportQuadCommand(EU,{uniformMap:{colorTexture:function(){return e._tempCopyDepthFramebuffer.getColorTexture()}},owner:e})),e._updateDepthCommand.framebuffer=e._updateDepthFramebuffer.framebuffer,e._updateDepthCommand.renderState=e._rsUpdate,(0,d.A)(e._clearGlobeColorCommand)||(e._clearGlobeColorCommand=new s.A({color:new u.A(0,0,0,0),stencil:0,owner:e})),e._clearGlobeColorCommand.framebuffer=e.framebuffer}Object.defineProperties(ZU.prototype,{colorFramebufferManager:{get:function(){return this._picking?this._pickColorFramebuffer:this._outputFramebuffer}},framebuffer:{get:function(){return this.colorFramebufferManager.framebuffer}},depthStencilTexture:{get:function(){return this.colorFramebufferManager.getDepthStencilTexture()}},picking:{get:function(){return this._picking},set:function(e){this._picking=e}}}),ZU.prototype.update=function(e,t,n,i,o,r){const{width:s,height:a}=n,c=o?e.halfFloatingPointTexture?U.A.HALF_FLOAT:U.A.FLOAT:U.A.UNSIGNED_BYTE;this._numSamples=i,this.picking?this._pickColorFramebuffer.update(e,s,a):this._outputFramebuffer.update(e,s,a,i,c),this._copyDepthFramebuffer.update(e,s,a),ek(this,e,s,a,t),e.uniformState.globeDepthTexture=void 0,this._clearGlobeDepth=r},ZU.prototype.prepareColorTextures=function(e,t){!this.picking&&this._numSamples>1&&this._outputFramebuffer.prepareTextures(e,t)},ZU.prototype.executeCopyDepth=function(e,t){(0,d.A)(this._copyDepthCommand)&&(this.prepareColorTextures(e),this._copyDepthCommand.execute(e,t),e.uniformState.globeDepthTexture=this._copyDepthFramebuffer.getColorTexture())},ZU.prototype.executeUpdateDepth=function(e,t,n){const i=(0,d.A)(n)?n:t.framebuffer.depthStencilTexture;if(!this._clearGlobeDepth&&i===this.colorFramebufferManager.getDepthStencilTexture())return void((0,d.A)(this._copyDepthCommand)&&this._copyDepthCommand.execute(e,t));if(!(0,d.A)(this._updateDepthCommand))return;const o=this._updateDepthFramebuffer;if(!(0,d.A)(o.framebuffer)||o.getDepthStencilTexture()!==i||o.getColorTexture()!==this._copyDepthFramebuffer.getColorTexture()){const n=this._copyDepthFramebuffer.getColorTexture(),{width:r,height:s}=n;this._tempCopyDepthFramebuffer.destroy(),this._tempCopyDepthFramebuffer.update(e,r,s),o.setColorTexture(n,0),o.setDepthStencilTexture(i),o.update(e,r,s),ek(this,e,r,s,t)}this._tempCopyDepthTexture=i,this._tempCopyDepthCommand.execute(e,t),this._updateDepthCommand.execute(e,t)},ZU.prototype.executeCopyColor=function(e,t){(0,d.A)(this._copyColorCommand)&&this._copyColorCommand.execute(e,t)},ZU.prototype.clear=function(e,t,n){const i=this._clearGlobeColorCommand;(0,d.A)(i)&&(u.A.clone(n,i.color),this.colorFramebufferManager.clear(e,i,t))},ZU.prototype.isDestroyed=function(){return!1},ZU.prototype.destroy=function(){return this._pickColorFramebuffer.destroy(),this._outputFramebuffer.destroy(),this._copyDepthFramebuffer.destroy(),this._tempCopyDepthFramebuffer.destroy(),this._updateDepthFramebuffer.destroy(),(0,d.A)(this._copyColorCommand)&&(this._copyColorCommand.shaderProgram=this._copyColorCommand.shaderProgram.destroy()),(0,d.A)(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=this._copyDepthCommand.shaderProgram.destroy()),(0,d.A)(this._tempCopyDepthCommand)&&(this._tempCopyDepthCommand.shaderProgram=this._tempCopyDepthCommand.shaderProgram.destroy()),(0,d.A)(this._updateDepthCommand)&&(this._updateDepthCommand.shaderProgram=this._updateDepthCommand.shaderProgram.destroy()),(0,h.A)(this)};const tk=ZU;function nk(){this._framebuffer=new at.A({depthStencil:!0,supportsDepthTexture:!0}),this._packedDepthFramebuffer=new at.A,this._renderState=void 0,this._packedDepthCommand=void 0,this._clearCommand=void 0,this._viewport=new c.A,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHdr=void 0}Object.defineProperties(nk.prototype,{classificationTexture:{get:function(){return this._framebuffer.getColorTexture()}},classificationFramebuffer:{get:function(){return this._framebuffer.framebuffer}},packedDepthFramebuffer:{get:function(){return this._packedDepthFramebuffer.framebuffer}},depthStencilTexture:{get:function(){return this._framebuffer.getDepthStencilTexture()}},depthStencilRenderbuffer:{get:function(){return this._framebuffer.getDepthStencilRenderbuffer()}},packedDepthTexture:{get:function(){return this._packedDepthFramebuffer.getColorTexture()}}}),nk.prototype.updateAndClear=function(e,t,n,i){const o=t.width,r=t.height;!function(e,t,n,i,o){const r=o?t.halfFloatingPointTexture?U.A.HALF_FLOAT:U.A.FLOAT:U.A.UNSIGNED_BYTE;e._framebuffer.update(t,n,i,1,r),e._packedDepthFramebuffer.update(t,n,i)}(this,n,o,r,e),function(e,t,n,i,o){e._viewport.width=n,e._viewport.height=i;const r=!c.A.equals(e._viewport,o.viewport);let a=r!==e._useScissorTest;e._useScissorTest=r,c.A.equals(e._scissorRectangle,o.viewport)||(e._scissorRectangle=c.A.clone(o.viewport,e._scissorRectangle),a=!0),(0,d.A)(e._renderState)&&c.A.equals(e._viewport,e._renderState.viewport)&&!a||(e._renderState=_.A.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}})),(0,d.A)(e._packedDepthCommand)||(e._packedDepthCommand=t.createViewportQuadCommand(JU,{uniformMap:{u_depthTexture:function(){return e.depthStencilTexture}},owner:e})),(0,d.A)(e._clearCommand)||(e._clearCommand=new s.A({color:new u.A(0,0,0,0),depth:1,stencil:0,owner:e})),e._packedDepthCommand.framebuffer=e._packedDepthFramebuffer.framebuffer,e._packedDepthCommand.renderState=e._renderState,e._clearCommand.framebuffer=e.classificationFramebuffer,e._clearCommand.renderState=e._renderState}(this,n,o,r,i),this._useHdr=e},nk.prototype.clearClassification=function(e,t){this._clearCommand.execute(e,t)},nk.prototype.packDepth=function(e,t){return this._packedDepthCommand.execute(e,t),this.packedDepthTexture},nk.prototype.isDestroyed=function(){return!1},nk.prototype.destroy=function(){var e;return(e=this)._framebuffer.destroy(),e._packedDepthFramebuffer.destroy(),(0,h.A)(this)};const ik=nk;var ok=n(620297),rk=n(443383);function sk(e){this._numSamples=1,this._translucentMultipassSupport=!1,this._translucentMRTSupport=!1;const t=e.colorBufferFloat&&e.depthTexture&&e.floatBlend;this._translucentMRTSupport=e.drawBuffers&&t,this._translucentMultipassSupport=!this._translucentMRTSupport&&t,this._opaqueFBO=void 0,this._opaqueTexture=void 0,this._depthStencilTexture=void 0,this._accumulationTexture=void 0,this._translucentFBO=new at.A({colorAttachmentsLength:this._translucentMRTSupport?2:1,createColorAttachments:!1,createDepthAttachments:!1,depth:!0}),this._alphaFBO=new at.A({createColorAttachments:!1,createDepthAttachments:!1,depth:!0}),this._adjustTranslucentFBO=new at.A({colorAttachmentsLength:this._translucentMRTSupport?2:1,createColorAttachments:!1}),this._adjustAlphaFBO=new at.A({createColorAttachments:!1}),this._opaqueClearCommand=new s.A({color:new u.A(0,0,0,0),owner:this}),this._translucentMRTClearCommand=new s.A({color:new u.A(0,0,0,1),owner:this}),this._translucentMultipassClearCommand=new s.A({color:new u.A(0,0,0,0),owner:this}),this._alphaClearCommand=new s.A({color:new u.A(1,1,1,1),owner:this}),this._translucentRenderStateCache={},this._alphaRenderStateCache={},this._compositeCommand=void 0,this._adjustTranslucentCommand=void 0,this._adjustAlphaCommand=void 0,this._viewport=new c.A,this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHDR=!1}function ak(e){e._accumulationTexture=e._accumulationTexture&&!e._accumulationTexture.isDestroyed()&&e._accumulationTexture.destroy(),e._revealageTexture=e._revealageTexture&&!e._revealageTexture.isDestroyed()&&e._revealageTexture.destroy()}function ck(e){e._translucentFBO.destroy(),e._alphaFBO.destroy(),e._adjustTranslucentFBO.destroy(),e._adjustAlphaFBO.destroy()}function lk(e){ak(e),ck(e)}sk.prototype.update=function(e,t,n,i,o){if(!this.isSupported())return;this._opaqueFBO=n,this._opaqueTexture=n.getColorTexture(0),this._depthStencilTexture=n.getDepthStencilTexture();const{width:r,height:s}=this._opaqueTexture,a=this._accumulationTexture,l=!(0,d.A)(a)||a.width!==r||a.height!==s||i!==this._useHDR,u=this._numSamples!==o;if((l||u)&&(this._numSamples=o,function(e,t,n,i){ak(e),e._accumulationTexture=new G.A({context:t,width:n,height:i,pixelFormat:R.A.RGBA,pixelDatatype:U.A.FLOAT}),e._revealageTexture=new G.A({context:t,pixelFormat:R.A.RGBA,pixelDatatype:U.A.FLOAT,width:n,height:i,flipY:!1})}(this,e,r,s)),(!(0,d.A)(this._translucentFBO.framebuffer)||l||u)&&!function(e,t){ck(e);const n=L.A.FRAMEBUFFER_COMPLETE;let i=!0;const{width:o,height:r}=e._accumulationTexture;if(e._translucentMRTSupport&&(e._translucentFBO.setColorTexture(e._accumulationTexture,0),e._translucentFBO.setColorTexture(e._revealageTexture,1),e._translucentFBO.setDepthStencilTexture(e._depthStencilTexture),e._translucentFBO.update(t,o,r),e._adjustTranslucentFBO.setColorTexture(e._accumulationTexture,0),e._adjustTranslucentFBO.setColorTexture(e._revealageTexture,1),e._adjustTranslucentFBO.update(t,o,r),e._translucentFBO.status===n&&e._adjustTranslucentFBO.status===n||(ck(e),e._translucentMRTSupport=!1)),!e._translucentMRTSupport){e._translucentFBO.setColorTexture(e._accumulationTexture),e._translucentFBO.setDepthStencilTexture(e._depthStencilTexture),e._translucentFBO.update(t,o,r),e._alphaFBO.setColorTexture(e._revealageTexture),e._alphaFBO.setDepthStencilTexture(e._depthStencilTexture),e._alphaFBO.update(t,o,r),e._adjustTranslucentFBO.setColorTexture(e._accumulationTexture),e._adjustTranslucentFBO.update(t,o,r),e._adjustAlphaFBO.setColorTexture(e._revealageTexture),e._adjustAlphaFBO.update(t,o,r);const s=e._translucentFBO.status===n,a=e._alphaFBO.status===n,c=e._adjustTranslucentFBO.status===n,l=e._adjustAlphaFBO.status===n;s&&a&&c&&l||(lk(e),e._translucentMultipassSupport=!1,i=!1)}return i}(this,e))return;this._useHDR=i;const h=this;let A,p;(0,d.A)(this._compositeCommand)||(A=new k.A({sources:[dS]}),this._translucentMRTSupport&&A.defines.push("MRT"),p={u_opaque:function(){return h._opaqueTexture},u_accumulation:function(){return h._accumulationTexture},u_revealage:function(){return h._revealageTexture}},this._compositeCommand=e.createViewportQuadCommand(A,{uniformMap:p,owner:this})),(0,d.A)(this._adjustTranslucentCommand)||(this._translucentMRTSupport?(A=new k.A({defines:["MRT"],sources:[tS]}),p={u_bgColor:function(){return h._translucentMRTClearCommand.color},u_depthTexture:function(){return h._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(A,{uniformMap:p,owner:this})):this._translucentMultipassSupport&&(A=new k.A({sources:[tS]}),p={u_bgColor:function(){return h._translucentMultipassClearCommand.color},u_depthTexture:function(){return h._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(A,{uniformMap:p,owner:this}),p={u_bgColor:function(){return h._alphaClearCommand.color},u_depthTexture:function(){return h._depthStencilTexture}},this._adjustAlphaCommand=e.createViewportQuadCommand(A,{uniformMap:p,owner:this}))),this._viewport.width=r,this._viewport.height=s;const f=!c.A.equals(this._viewport,t.viewport);let m=f!==this._useScissorTest;this._useScissorTest=f,c.A.equals(this._scissorRectangle,t.viewport)||(this._scissorRectangle=c.A.clone(t.viewport,this._scissorRectangle),m=!0),(0,d.A)(this._rs)&&c.A.equals(this._viewport,this._rs.viewport)&&!m||(this._rs=_.A.fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})),(0,d.A)(this._compositeCommand)&&(this._compositeCommand.renderState=this._rs),this._adjustTranslucentCommand&&(this._adjustTranslucentCommand.renderState=this._rs),(0,d.A)(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.renderState=this._rs)};const uk={enabled:!0,color:new u.A(0,0,0,0),equationRgb:ok.A.ADD,equationAlpha:ok.A.ADD,functionSourceRgb:rk.A.ONE,functionDestinationRgb:rk.A.ONE,functionSourceAlpha:rk.A.ZERO,functionDestinationAlpha:rk.A.ONE_MINUS_SOURCE_ALPHA},dk={enabled:!0,color:new u.A(0,0,0,0),equationRgb:ok.A.ADD,equationAlpha:ok.A.ADD,functionSourceRgb:rk.A.ONE,functionDestinationRgb:rk.A.ONE,functionSourceAlpha:rk.A.ONE,functionDestinationAlpha:rk.A.ONE},hk={enabled:!0,color:new u.A(0,0,0,0),equationRgb:ok.A.ADD,equationAlpha:ok.A.ADD,functionSourceRgb:rk.A.ZERO,functionDestinationRgb:rk.A.ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:rk.A.ZERO,functionDestinationAlpha:rk.A.ONE_MINUS_SOURCE_ALPHA};function Ak(e,t,n,i){let o=n[i.id];if(!(0,d.A)(o)){const e=_.A.getState(i);e.depthMask=!1,e.blending=t,o=_.A.fromCache(e),n[i.id]=o}return o}function pk(e,t,n,i){const{shaderCache:o}=e,r=o.getDerivedShaderProgram(t,n);if((0,d.A)(r))return r;const s=t._attributeLocations,a=t.fragmentShaderSource.clone();a.sources=a.sources.map(function(e){return k.A.replaceMain(e,"czm_translucent_main").replace(/out_FragColor/g,"czm_out_FragColor").replace(/layout\s*\(location\s*=\s*0\)\s*out\s+vec4\s+out_FragColor;/g,"").replace(/\bdiscard\b/g,"czm_discard = true").replace(/czm_phong/g,"czm_translucentPhong")}),a.sources.splice(0,0,"vec4 czm_out_FragColor;\nbool czm_discard = false;\n");const c=[...i.matchAll(/out_FragData_(\d+)/g)];let l="";for(let e=0;e<c.length;e++){const t=c[e];l=`layout (location = ${t[1]}) out vec4 ${t[0]};\n${l}`}return a.sources.push(l),a.sources.push(`void main()\n{\n    czm_translucent_main();\n    if (czm_discard)\n    {\n        discard;\n    }\n${i}}\n`),o.createDerivedShaderProgram(t,n,{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:a,attributeLocations:s})}sk.prototype.createDerivedCommands=function(e,t,n){if((0,d.A)(n)||(n={}),this._translucentMRTSupport){let o,r;return(0,d.A)(n.translucentCommand)&&(o=n.translucentCommand.shaderProgram,r=n.translucentCommand.renderState),n.translucentCommand=m.A.shallowClone(e,n.translucentCommand),(0,d.A)(o)&&n.shaderProgramId===e.shaderProgram.id?(n.translucentCommand.shaderProgram=o,n.translucentCommand.renderState=r):(n.translucentCommand.shaderProgram=function(e,t){return pk(e,t,"translucentMRT","    vec3 Ci = czm_out_FragColor.rgb * czm_out_FragColor.a;\n    float ai = czm_out_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    out_FragData_0 = vec4(Ci * wzi, ai);\n    out_FragData_1 = vec4(ai * wzi);\n")}(t,e.shaderProgram),n.translucentCommand.renderState=(i=e.renderState,Ak(0,uk,this._translucentRenderStateCache,i)),n.shaderProgramId=e.shaderProgram.id),n}var i;let o,r,s,a;return(0,d.A)(n.translucentCommand)&&(o=n.translucentCommand.shaderProgram,r=n.translucentCommand.renderState,s=n.alphaCommand.shaderProgram,a=n.alphaCommand.renderState),n.translucentCommand=m.A.shallowClone(e,n.translucentCommand),n.alphaCommand=m.A.shallowClone(e,n.alphaCommand),(0,d.A)(o)&&n.shaderProgramId===e.shaderProgram.id?(n.translucentCommand.shaderProgram=o,n.translucentCommand.renderState=r,n.alphaCommand.shaderProgram=s,n.alphaCommand.renderState=a):(n.translucentCommand.shaderProgram=function(e,t){return pk(e,t,"translucentMultipass","    vec3 Ci = czm_out_FragColor.rgb * czm_out_FragColor.a;\n    float ai = czm_out_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    out_FragColor = vec4(Ci, ai) * wzi;\n")}(t,e.shaderProgram),n.translucentCommand.renderState=function(e,t,n){return Ak(0,dk,e._translucentRenderStateCache,n)}(this,0,e.renderState),n.alphaCommand.shaderProgram=function(e,t){return pk(e,t,"alphaMultipass","    float ai = czm_out_FragColor.a;\n    out_FragColor = vec4(ai);\n")}(t,e.shaderProgram),n.alphaCommand.renderState=function(e,t,n){return Ak(0,hk,e._alphaRenderStateCache,n)}(this,0,e.renderState),n.shaderProgramId=e.shaderProgram.id),n},sk.prototype.executeCommands=function(e,t,n,i,o){this._translucentMRTSupport?function(e,t,n,i,o,r){const{context:s,frameState:a}=t,{useLogDepth:c,shadowState:l}=a,u=t._hdr,h=i.framebuffer,A=l.lightShadowsEnabled;i.framebuffer=e._adjustTranslucentFBO.framebuffer,e._adjustTranslucentCommand.execute(s,i);const p=e._opaqueFBO.framebuffer;i.framebuffer=e._translucentFBO.framebuffer;for(let e=0;e<o.length;++e){let r=o[e];r=c?r.derivedCommands.logDepth.command:r,r=u?r.derivedCommands.hdr.command:r,n(A&&r.receiveShadows?r.derivedCommands.oit.shadows.translucentCommand:r.derivedCommands.oit.translucentCommand,t,i,p)}if((0,d.A)(r)){const e=r.unclassifiedCommand;n(A&&e.receiveShadows?e.derivedCommands.oit.shadows.translucentCommand:e.derivedCommands.oit.translucentCommand,t,i,p)}i.framebuffer=h}(this,e,t,n,i,o):function(e,t,n,i,o,r){const{context:s,frameState:a}=t,{useLogDepth:c,shadowState:l}=a,u=t._hdr,h=i.framebuffer,A=l.lightShadowsEnabled;i.framebuffer=e._adjustTranslucentFBO.framebuffer,e._adjustTranslucentCommand.execute(s,i),i.framebuffer=e._adjustAlphaFBO.framebuffer,e._adjustAlphaCommand.execute(s,i);const p=e._opaqueFBO.framebuffer;i.framebuffer=e._translucentFBO.framebuffer;for(let e=0;e<o.length;++e){let r=o[e];r=c?r.derivedCommands.logDepth.command:r,r=u?r.derivedCommands.hdr.command:r,n(A&&r.receiveShadows?r.derivedCommands.oit.shadows.translucentCommand:r.derivedCommands.oit.translucentCommand,t,i,p)}if((0,d.A)(r)){const e=r.unclassifiedCommand;n(A&&e.receiveShadows?e.derivedCommands.oit.shadows.translucentCommand:e.derivedCommands.oit.translucentCommand,t,i,p)}i.framebuffer=e._alphaFBO.framebuffer;for(let e=0;e<o.length;++e){let r=o[e];r=c?r.derivedCommands.logDepth.command:r,r=u?r.derivedCommands.hdr.command:r,n(A&&r.receiveShadows?r.derivedCommands.oit.shadows.alphaCommand:r.derivedCommands.oit.alphaCommand,t,i,p)}if((0,d.A)(r)){const e=r.unclassifiedCommand;n(A&&e.receiveShadows?e.derivedCommands.oit.shadows.alphaCommand:e.derivedCommands.oit.alphaCommand,t,i,p)}i.framebuffer=h}(this,e,t,n,i,o)},sk.prototype.execute=function(e,t){this._compositeCommand.execute(e,t)},sk.prototype.clear=function(e,t,n){const i=t.framebuffer;t.framebuffer=this._opaqueFBO.framebuffer,u.A.clone(n,this._opaqueClearCommand.color),this._opaqueClearCommand.execute(e,t),t.framebuffer=this._translucentFBO.framebuffer,(this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand).execute(e,t),this._translucentMultipassSupport&&(t.framebuffer=this._alphaFBO.framebuffer,this._alphaClearCommand.execute(e,t)),t.framebuffer=i},sk.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport},sk.prototype.isDestroyed=function(){return!1},sk.prototype.destroy=function(){return lk(this),(0,d.A)(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),(0,d.A)(this._adjustTranslucentCommand)&&(this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()),(0,d.A)(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy()),(0,h.A)(this)};const fk=sk;function mk(){this._framebuffer=new at.A({color:!1,depthStencil:!0,supportsDepthTexture:!0}),this._passState=void 0}Object.defineProperties(mk.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}}}),mk.prototype.update=function(e,t,n){const i=n.width,o=n.height;this._framebuffer.isDirty(i,o)&&function(e,t){const n=t.drawingBufferWidth,i=t.drawingBufferHeight;e._framebuffer.update(t,n,i);const o=new F(t);o.blendingEnabled=!1,o.scissorTest={enabled:!0,rectangle:new c.A},o.viewport=new c.A,e._passState=o}(this,e);const r=this.framebuffer,s=this._passState;return s.framebuffer=r,s.viewport.width=i,s.viewport.height=o,s.scissorTest.rectangle.x=t.x,s.scissorTest.rectangle.y=o-t.y,s.scissorTest.rectangle.width=1,s.scissorTest.rectangle.height=1,s},mk.prototype.isDestroyed=function(){return!1},mk.prototype.destroy=function(){return this._framebuffer.destroy(),(0,h.A)(this)};const gk=mk;function _k(e){const t=new F(e);t.blendingEnabled=!1,t.scissorTest={enabled:!0,rectangle:new c.A},t.viewport=new c.A,this._context=e,this._fb=new at.A({depthStencil:!0}),this._passState=t,this._width=0,this._height=0}_k.prototype.begin=function(e,t){const n=this._context,{width:i,height:o}=t;return c.A.clone(e,this._passState.scissorTest.rectangle),this._width=i,this._height=o,this._fb.update(n,i,o),this._passState.framebuffer=this._fb.framebuffer,this._passState.viewport.width=i,this._passState.viewport.height=o,this._passState};const yk=new u.A;_k.prototype.end=function(e){const t=e.width??1,n=e.height??1,i=this._context,o=i.readPixels({x:e.x,y:e.y,width:t,height:n,framebuffer:this._fb.framebuffer}),r=Math.max(t,n),s=r*r,a=Math.floor(.5*t),c=Math.floor(.5*n);let l=0,h=0,A=0,p=-1;for(let e=0;e<s;++e){if(-a<=l&&l<=a&&-c<=h&&h<=c){const e=4*((c-h)*t+l+a);yk.red=u.A.byteToFloat(o[e]),yk.green=u.A.byteToFloat(o[e+1]),yk.blue=u.A.byteToFloat(o[e+2]),yk.alpha=u.A.byteToFloat(o[e+3]);const n=i.getObjectByPickColor(yk);if((0,d.A)(n))return n}if(l===h||l<0&&-l===h||l>0&&l===1-h){const e=A;A=-p,p=e}l+=A,h+=p}},_k.prototype.readCenterPixel=function(e){const t=e.width??1,n=e.height??1,i=this._context.readPixels({x:e.x,y:e.y,width:t,height:n,framebuffer:this._fb.framebuffer}),o=Math.floor(.5*t),r=4*(Math.floor(.5*n)*t+o);return i.slice(r,r+4)},_k.prototype.isDestroyed=function(){return!1},_k.prototype.destroy=function(){return this._fb.destroy(),(0,h.A)(this)};const vk=_k;function Tk(){this._numSamples=1,this._colorFramebuffer=new at.A({depthStencil:!0,supportsDepthTexture:!0}),this._idFramebuffer=new at.A({depthStencil:!0,supportsDepthTexture:!0}),this._idClearColor=new u.A(0,0,0,0),this._clearCommand=new s.A({color:new u.A(0,0,0,0),depth:1,owner:this})}Object.defineProperties(Tk.prototype,{framebuffer:{get:function(){return this._colorFramebuffer.framebuffer}},idFramebuffer:{get:function(){return this._idFramebuffer.framebuffer}},depthStencilTexture:{get:function(){return this._colorFramebuffer.getDepthStencilTexture()}}}),Tk.prototype.update=function(e,t,n,i){const o=t.width,r=t.height,s=n?e.halfFloatingPointTexture?U.A.HALF_FLOAT:U.A.FLOAT:U.A.UNSIGNED_BYTE;this._numSamples=i,this._colorFramebuffer.update(e,o,r,i,s),this._idFramebuffer.update(e,o,r)},Tk.prototype.clear=function(e,t,n){u.A.clone(n,this._clearCommand.color),u.A.clone(this._idClearColor,this._clearCommand.color),this._colorFramebuffer.clear(e,this._clearCommand,t),this._idFramebuffer.clear(e,this._clearCommand,t)},Tk.prototype.getFramebuffer=function(){return this._colorFramebuffer.framebuffer},Tk.prototype.getIdFramebuffer=function(){return this._idFramebuffer.framebuffer},Tk.prototype.prepareColorTextures=function(e){this._numSamples>1&&this._colorFramebuffer.prepareTextures(e)},Tk.prototype.isDestroyed=function(){return!1},Tk.prototype.destroy=function(){var e;return(e=this)._colorFramebuffer.destroy(),e._idFramebuffer.destroy(),(0,h.A)(this)};const bk=Tk;function wk(){}wk.getShadowCastShaderKeyword=function(e,t,n,i){return`castShadow ${e} ${t} ${n} ${i}`},wk.createShadowCastVertexShader=function(e,t,n){const i=e.defines.slice(0),o=e.sources.slice(0);i.push("SHADOW_MAP"),n&&i.push("GENERATE_POSITION");const r=k.A.findPositionVarying(e),s=(0,d.A)(r);if(t&&!s){const e=o.length;for(let t=0;t<e;++t)o[t]=k.A.replaceMain(o[t],"czm_shadow_cast_main");const t="out vec3 v_positionEC; \nvoid main() \n{ \n    czm_shadow_cast_main(); \n    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \n}";o.push(t)}return new k.A({defines:i,sources:o})},wk.createShadowCastFragmentShader=function(e,t,n,i){const o=e.defines.slice(0),r=e.sources.slice(0);o.push("SHADOW_MAP");let s=k.A.findPositionVarying(e);const a=(0,d.A)(s);a||(s="v_positionEC");const c=r.length;for(let e=0;e<c;++e)r[e]=k.A.replaceMain(r[e],"czm_shadow_cast_main");let l="";return t&&(a||(l+="in vec3 v_positionEC; \n"),l+="uniform vec4 shadowMap_lightPositionEC; \n"),l+=i?"void main() \n{ \n":"void main() \n{ \n    czm_shadow_cast_main(); \n    if (out_FragColor.a == 0.0) \n    { \n       discard; \n    } \n",l+=t?`    float distance = length(${s}); \n    if (distance >= shadowMap_lightPositionEC.w) \n    { \n        discard; \n    } \n    distance /= shadowMap_lightPositionEC.w; // radius \n    out_FragColor = czm_packDepth(distance); \n`:n?"    out_FragColor = vec4(1.0); \n":"    out_FragColor = czm_packDepth(gl_FragCoord.z); \n",l+="} \n",r.push(l),new k.A({defines:o,sources:r})},wk.getShadowReceiveShaderKeyword=function(e,t,n,i){return`receiveShadow ${e._usesDepthTexture}${e._polygonOffsetSupported}${e._isPointLight}${e._isSpotLight}${e._numberOfCascades>1}${e.debugCascadeColors}${e.softShadows}${t}${n}${i}`},wk.createShadowReceiveVertexShader=function(e,t,n){const i=e.defines.slice(0),o=e.sources.slice(0);return i.push("SHADOW_MAP"),t&&(n?i.push("GENERATE_POSITION_AND_NORMAL"):i.push("GENERATE_POSITION")),new k.A({defines:i,sources:o})},wk.createShadowReceiveFragmentShader=function(e,t,n,i,o){const r=k.A.findNormalVarying(e),s=!i&&(0,d.A)(r)||i&&o,a=k.A.findPositionVarying(e),c=(0,d.A)(a),l=t._usesDepthTexture,u=t._polygonOffsetSupported,h=t._isPointLight,A=t._isSpotLight,p=t._numberOfCascades>1,f=t.debugCascadeColors,m=t.softShadows,g=h?t._pointBias:i?t._terrainBias:t._primitiveBias,_=e.defines.slice(0),y=e.sources.slice(0),v=y.length;for(let e=0;e<v;++e)y[e]=k.A.replaceMain(y[e],"czm_shadow_receive_main");h?_.push("USE_CUBE_MAP_SHADOW"):l&&_.push("USE_SHADOW_DEPTH_TEXTURE"),m&&!h&&_.push("USE_SOFT_SHADOWS"),p&&n&&i&&(s?_.push("ENABLE_VERTEX_LIGHTING"):_.push("ENABLE_DAYNIGHT_SHADING")),n&&g.normalShading&&s&&(_.push("USE_NORMAL_SHADING"),g.normalShadingSmooth>0&&_.push("USE_NORMAL_SHADING_SMOOTH"));let T,b="";return b+=h?"uniform samplerCube shadowMap_textureCube; \n":"uniform sampler2D shadowMap_texture; \n",T=c?`    return vec4(${a}, 1.0); \n`:"#ifndef LOG_DEPTH \n    return czm_windowToEyeCoordinates(gl_FragCoord); \n#else \n    return vec4(v_logPositionEC, 1.0); \n#endif \n",b+=`uniform mat4 shadowMap_matrix; \nuniform vec3 shadowMap_lightDirectionEC; \nuniform vec4 shadowMap_lightPositionEC; \nuniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \nuniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \n#ifdef LOG_DEPTH \nin vec3 v_logPositionEC; \n#endif \nvec4 getPositionEC() \n{ \n${T}} \nvec3 getNormalEC() \n{ \n${s?`    return normalize(${r}); \n`:"    return vec3(1.0); \n"}} \nvoid applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \n{ \n${g.normalOffset&&s?"    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \n    float normalOffsetScale = 1.0 - nDotL; \n    vec3 offset = normalOffset * normalOffsetScale * normalEC; \n    positionEC.xyz += offset; \n":""}} \n`,b+="void main() \n{ \n    czm_shadow_receive_main(); \n    vec4 positionEC = getPositionEC(); \n    vec3 normalEC = getNormalEC(); \n    float depth = -positionEC.z; \n",b+="    czm_shadowParameters shadowParameters; \n    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \n    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \n    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \n    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \n",i?b+="    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \n":u||(b+="    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \n"),b+=h?"    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n    float distance = length(directionEC); \n    directionEC = normalize(directionEC); \n    float radius = shadowMap_lightPositionEC.w; \n    // Stop early if the fragment is beyond the point light radius \n    if (distance > radius) \n    { \n        return; \n    } \n    vec3 directionWC  = czm_inverseViewRotation * directionEC; \n    shadowParameters.depth = distance / radius; \n    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    shadowParameters.texCoords = directionWC; \n    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \n":A?"    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \n    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Spot light uses a perspective projection, so perform the perspective divide \n    shadowPosition /= shadowPosition.w; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n":p?"    float maxDepth = shadowMap_cascadeSplits[1].w; \n    // Stop early if the eye depth exceeds the last cascade \n    if (depth > maxDepth) \n    { \n        return; \n    } \n    // Get the cascade based on the eye-space depth \n    vec4 weights = czm_cascadeWeights(depth); \n    // Apply normal offset \n    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    // Transform position into the cascade \n    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \n    // Get visibility \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n    // Fade out shadows that are far away \n    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \n    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \n    visibility = mix(visibility, 1.0, fade); \n"+(f?"    // Draw cascade colors for debugging \n    out_FragColor *= czm_cascadeColor(weights); \n":""):"    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n",b+="    out_FragColor.rgb *= visibility; \n} \n",y.push(b),new k.A({defines:_,sources:y})};const xk=wk;function Ck(e){const t=(e=e??S.A.EMPTY_OBJECT).context;if(!(0,d.A)(t))throw new A.A("context is required.");if(!(0,d.A)(e.lightCamera))throw new A.A("lightCamera is required.");if((0,d.A)(e.numberOfCascades)&&1!==e.numberOfCascades&&4!==e.numberOfCascades)throw new A.A("Only one or four cascades are supported.");this._enabled=e.enabled??!0,this._softShadows=e.softShadows??!1,this._normalOffset=e.normalOffset??!0,this.dirty=!0,this.fromLightSource=e.fromLightSource??!0,this.darkness=e.darkness??.3,this._darkness=this.darkness,this.fadingEnabled=e.fadingEnabled??!0,this.maximumDistance=e.maximumDistance??5e3,this._outOfView=!1,this._outOfViewPrevious=!1,this._needsUpdate=!0;let n,i=!0;(lP.A.isInternetExplorer()||lP.A.isEdge()||(lP.A.isChrome()||lP.A.isFirefox())&&lP.A.isWindows()&&!t.depthTexture)&&(i=!1),this._polygonOffsetSupported=i,this._terrainBias={polygonOffset:i,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:i,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new O.A,this._shadowMapTexture=void 0,this._lightDirectionEC=new j.A,this._lightPositionEC=new Q.A,this._distance=0,this._lightCamera=e.lightCamera,this._shadowMapCamera=new kk,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=new Sn.A,this._isPointLight=e.isPointLight??!1,this._pointLightRadius=e.pointLightRadius??100,this._cascadesEnabled=!this._isPointLight&&(e.cascadesEnabled??!0),this._numberOfCascades=this._cascadesEnabled?e.numberOfCascades??4:0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new q.A,this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new aR.A:(0,d.A)(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new Q.A,new Q.A],this._cascadeMatrices=[new O.A,new O.A,new O.A,new O.A],this._cascadeDistances=new Q.A,n=this._isPointLight?6:this._cascadesEnabled?this._numberOfCascades:1,this._passes=new Array(n);for(let e=0;e<n;++e)this._passes[e]=new Ek(t);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=t.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,Ik(this),this._clearCommand=new s.A({depth:1,color:new u.A}),this._clearPassState=new F(t),this._size=e.size??2048,this.size=this._size}function Ek(e){this.camera=new kk,this.passState=new F(e),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function Sk(e,t){return _.A.fromCache({cull:{enabled:!0,face:CB.A.BACK},depthTest:{enabled:!0},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:!0,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function Ik(e){const t=!e._usesDepthTexture;e._primitiveRenderState=Sk(t,e._primitiveBias),e._terrainRenderState=Sk(t,e._terrainBias),e._pointRenderState=Sk(t,e._pointBias)}function Pk(e){const t=e._passes.length;for(let n=0;n<t;++n){const t=e._passes[n],i=t.framebuffer;(0,d.A)(i)&&!i.isDestroyed()&&i.destroy(),t.framebuffer=void 0}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy(),e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function Dk(e,t){e._isPointLight?function(e,t){const n=new dt.A({context:t,width:e._textureSize.x,height:e._textureSize.y,format:ht.A.DEPTH_COMPONENT16}),i=new B.A({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:R.A.RGBA,pixelDatatype:U.A.UNSIGNED_BYTE,sampler:At.A.NEAREST}),o=[i.negativeX,i.negativeY,i.negativeZ,i.positiveX,i.positiveY,i.positiveZ];for(let i=0;i<6;++i){const r=new g.A({context:t,depthRenderbuffer:n,colorTextures:[o[i]],destroyAttachments:!1}),s=e._passes[i];s.framebuffer=r,s.passState.framebuffer=r}e._shadowMapTexture=i,e._depthAttachment=n,e._colorAttachment=i}(e,t):e._usesDepthTexture?function(e,t){const n=new G.A({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:R.A.DEPTH_STENCIL,pixelDatatype:U.A.UNSIGNED_INT_24_8,sampler:At.A.NEAREST}),i=new g.A({context:t,depthStencilTexture:n,destroyAttachments:!1}),o=e._passes.length;for(let t=0;t<o;++t){const n=e._passes[t];n.framebuffer=i,n.passState.framebuffer=i}e._shadowMapTexture=n,e._depthAttachment=n}(e,t):function(e,t){const n=new dt.A({context:t,width:e._textureSize.x,height:e._textureSize.y,format:ht.A.DEPTH_COMPONENT16}),i=new G.A({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:R.A.RGBA,pixelDatatype:U.A.UNSIGNED_BYTE,sampler:At.A.NEAREST}),o=new g.A({context:t,depthRenderbuffer:n,colorTextures:[i],destroyAttachments:!1}),r=e._passes.length;for(let t=0;t<r;++t){const n=e._passes[t];n.framebuffer=o,n.passState.framebuffer=o}e._shadowMapTexture=i,e._depthAttachment=n,e._colorAttachment=i}(e,t)}function Ok(e,t,n){n=n??0,(e._isPointLight||0===n)&&(e._clearCommand.framebuffer=e._passes[n].framebuffer,e._clearCommand.execute(t,e._clearPassState))}Ck.MAXIMUM_DISTANCE=2e4,Ck.prototype.debugCreateRenderStates=function(){Ik(this)},Object.defineProperties(Ck.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e,this._enabled=e}},normalOffset:{get:function(){return this._normalOffset},set:function(e){this.dirty=this._normalOffset!==e,this._normalOffset=e,this._terrainBias.normalOffset=e,this._primitiveBias.normalOffset=e,this._pointBias.normalOffset=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e,this._softShadows=e}},size:{get:function(){return this._size},set:function(e){!function(e,t){e._size=t;const n=e._passes,i=n.length,o=e._textureSize;if(e._isPointLight){t=N.A.maximumCubeMapSize>=t?t:N.A.maximumCubeMapSize,o.x=t,o.y=t;const e=new c.A(0,0,t,t);n[0].passState.viewport=e,n[1].passState.viewport=e,n[2].passState.viewport=e,n[3].passState.viewport=e,n[4].passState.viewport=e,n[5].passState.viewport=e}else 1===i?(t=N.A.maximumTextureSize>=t?t:N.A.maximumTextureSize,o.x=t,o.y=t,n[0].passState.viewport=new c.A(0,0,t,t)):4===i&&(t=N.A.maximumTextureSize>=2*t?t:N.A.maximumTextureSize/2,o.x=2*t,o.y=2*t,n[0].passState.viewport=new c.A(0,0,t,t),n[1].passState.viewport=new c.A(t,0,t,t),n[2].passState.viewport=new c.A(0,t,t,t),n[3].passState.viewport=new c.A(t,t,t,t));e._clearPassState.viewport=new c.A(0,0,o.x,o.y);for(let e=0;e<i;++e){const t=n[e],i=t.passState.viewport,r=i.x/o.x,s=i.y/o.y,a=i.width/o.x,c=i.height/o.y;t.textureOffsets=new O.A(a,0,0,r,0,c,0,s,0,0,1,0,0,0,0,1)}}(this,e)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e,this._debugCascadeColors=e}}});const Rk=new c.A;const Mk=new Array(8);Mk[0]=new Q.A(-1,-1,-1,1),Mk[1]=new Q.A(1,-1,-1,1),Mk[2]=new Q.A(1,1,-1,1),Mk[3]=new Q.A(-1,1,-1,1),Mk[4]=new Q.A(-1,-1,1,1),Mk[5]=new Q.A(1,-1,1,1),Mk[6]=new Q.A(1,1,1,1),Mk[7]=new Q.A(-1,1,1,1);const Lk=new O.A,Nk=new Array(8);for(let e=0;e<8;++e)Nk[e]=new Q.A;const Bk=[u.A.RED,u.A.GREEN,u.A.BLUE,u.A.MAGENTA],Fk=new j.A;function Uk(e,t){!function(e,t){const n=t.context,i=t.context.drawingBufferWidth,o=t.context.drawingBufferHeight,r=.3*Math.min(i,o),s=Rk;s.x=i-r,s.y=0,s.width=r,s.height=r;let a=e._debugShadowViewCommand;(0,d.A)(a)||(a=function(e,t){let n;n=e._isPointLight?"uniform samplerCube shadowMap_textureCube; \nin vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec2 uv = v_textureCoordinates; \n    vec3 dir; \n \n    if (uv.y < 0.5) \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = -1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = -1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else \n        { \n            dir.z = -1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 1.0; \n        } \n    } \n    else \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = 1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = 1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else \n        { \n            dir.z = 1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 3.0; \n        } \n    } \n \n    float shadow = czm_unpackDepth(czm_textureCube(shadowMap_textureCube, dir)); \n    out_FragColor = vec4(vec3(shadow), 1.0); \n} \n":`uniform sampler2D shadowMap_texture; \nin vec2 v_textureCoordinates; \nvoid main() \n{ \n${e._usesDepthTexture?"    float shadow = texture(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture(shadowMap_texture, v_textureCoordinates)); \n"}    out_FragColor = vec4(vec3(shadow), 1.0); \n} \n`;const i=t.createViewportQuadCommand(n,{uniformMap:{shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture}}});return i.pass=ut.A.OVERLAY,i}(e,n),e._debugShadowViewCommand=a),(0,d.A)(a.renderState)&&c.A.equals(a.renderState.viewport,s)||(a.renderState=_.A.fromCache({viewport:c.A.clone(s)})),t.commandList.push(e._debugShadowViewCommand)}(e,t);const n=e.debugFreezeFrame&&!e._debugFreezeFrame;if(e._debugFreezeFrame=e.debugFreezeFrame,e.debugFreezeFrame&&(n&&(e._debugCameraFrustum=e._debugCameraFrustum&&e._debugCameraFrustum.destroy(),e._debugCameraFrustum=new lF({camera:e._sceneCamera,color:u.A.CYAN,updateOnChange:!1})),e._debugCameraFrustum.update(t)),e._cascadesEnabled){if(e.debugFreezeFrame){n&&(e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=new lF({camera:e._shadowMapCamera,color:u.A.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t);for(let i=0;i<e._numberOfCascades;++i)n&&(e._debugCascadeFrustums[i]=e._debugCascadeFrustums[i]&&e._debugCascadeFrustums[i].destroy(),e._debugCascadeFrustums[i]=new lF({camera:e._passes[i].camera,color:Bk[i],updateOnChange:!1})),e._debugCascadeFrustums[i].update(t)}}else if(e._isPointLight){if(!(0,d.A)(e._debugLightFrustum)||e._needsUpdate){const t=e._shadowMapCamera.positionWC,n=To.A.IDENTITY,i=2*e._pointLightRadius,o=j.A.fromElements(i,i,i,Fk),r=O.A.fromTranslationQuaternionRotationScale(t,n,o,Lk);e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=function(e,t){const n=new yn.A({geometry:new fn.A({minimum:new j.A(-.5,-.5,-.5),maximum:new j.A(.5,.5,.5)}),attributes:{color:mn.A.fromColor(t)}}),i=new yn.A({geometry:new LR.A({radius:.5}),attributes:{color:mn.A.fromColor(t)}});return new Pn.A({geometryInstances:[n,i],appearance:new Cn.A({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:e})}(r,u.A.YELLOW)}e._debugLightFrustum.update(t)}else(0,d.A)(e._debugLightFrustum)&&!e._needsUpdate||(e._debugLightFrustum=new lF({camera:e._shadowMapCamera,color:u.A.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t)}function kk(){this.viewMatrix=new O.A,this.inverseViewMatrix=new O.A,this.frustum=void 0,this.positionCartographic=new X.A,this.positionWC=new j.A,this.directionWC=j.A.clone(j.A.UNIT_Z),this.upWC=j.A.clone(j.A.UNIT_Y),this.rightWC=j.A.clone(j.A.UNIT_X),this.viewProjectionMatrix=new O.A}kk.prototype.clone=function(e){O.A.clone(e.viewMatrix,this.viewMatrix),O.A.clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),X.A.clone(e.positionCartographic,this.positionCartographic),j.A.clone(e.positionWC,this.positionWC),j.A.clone(e.directionWC,this.directionWC),j.A.clone(e.upWC,this.upWC),j.A.clone(e.rightWC,this.rightWC)};const Vk=new O.A(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);kk.prototype.getViewProjection=function(){const e=this.viewMatrix,t=this.frustum.projectionMatrix;return O.A.multiply(t,e,this.viewProjectionMatrix),O.A.multiply(Vk,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};const zk=new Array(5),Hk=new uP.A,Gk=new Array(4),Wk=new j.A,Yk=new j.A,qk=new O.A,jk=new j.A,Qk=new j.A,Xk=new j.A,Kk=[new j.A(-1,0,0),new j.A(0,-1,0),new j.A(0,0,-1),new j.A(1,0,0),new j.A(0,1,0),new j.A(0,0,1)],$k=[new j.A(0,-1,0),new j.A(0,0,-1),new j.A(0,-1,0),new j.A(0,-1,0),new j.A(0,0,1),new j.A(0,-1,0)],Jk=[new j.A(0,0,1),new j.A(1,0,0),new j.A(-1,0,0),new j.A(0,0,-1),new j.A(1,0,0),new j.A(1,0,0)],Zk=new j.A,eV=new j.A,tV=new Sn.A,nV=tV.center;Ck.prototype.update=function(e){if(function(e,t){const n=t.camera,i=e._lightCamera,o=e._sceneCamera,r=e._shadowMapCamera;e._cascadesEnabled?j.A.clone(i.directionWC,r.directionWC):e._isPointLight?j.A.clone(i.positionWC,r.positionWC):r.clone(i);const s=e._lightDirectionEC;let a,c;O.A.multiplyByPointAsVector(n.viewMatrix,r.directionWC,s),j.A.normalize(s,s),j.A.negate(s,s),O.A.multiplyByPoint(n.viewMatrix,r.positionWC,e._lightPositionEC),e._lightPositionEC.w=e._pointLightRadius,e._fitNearFar?(a=Math.min(t.shadowState.nearPlane,e.maximumDistance),c=Math.min(t.shadowState.farPlane,e.maximumDistance),c=Math.max(c,a+1)):(a=n.frustum.near,c=e.maximumDistance),e._sceneCamera=UB.A.clone(n,o),n.frustum.clone(e._sceneCamera.frustum),e._sceneCamera.frustum.near=a,e._sceneCamera.frustum.far=c,e._distance=c-a,function(e,t){const n=e._sceneCamera,i=e._shadowMapCamera,o=tV;if(e._cascadesEnabled){if(n.frustum.near>=e.maximumDistance)return e._outOfView=!0,void(e._needsUpdate=!1);const o=t.mapProjection.ellipsoid.geodeticSurfaceNormal(n.positionWC,Zk),r=j.A.negate(i.directionWC,eV),s=j.A.dot(o,r);if(e.fadingEnabled){const t=J.A.clamp(s/.1,0,1);e._darkness=J.A.lerp(1,e.darkness,t)}else e._darkness=e.darkness;if(s<0)return e._outOfView=!0,void(e._needsUpdate=!1);e._needsUpdate=!0,e._outOfView=!1}else if(e._isPointLight)o.center=i.positionWC,o.radius=e._pointLightRadius,e._outOfView=t.cullingVolume.computeVisibility(o)===bO.A.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(o),Sn.A.clone(o,e._boundingSphere);else{const n=i.frustum.far/2,r=j.A.add(i.positionWC,j.A.multiplyByScalar(i.directionWC,n,nV),nV);o.center=r,o.radius=n,e._outOfView=t.cullingVolume.computeVisibility(o)===bO.A.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(o),Sn.A.clone(o,e._boundingSphere)}}(e,t),!e._outOfViewPrevious&&e._outOfView&&(e._needsUpdate=!0),e._outOfViewPrevious=e._outOfView}(this,e),this._needsUpdate)if(t=this,n=e.context,(0,d.A)(t._passes[0].framebuffer)&&t._shadowMapTexture.width===t._textureSize.x||(Pk(t),Dk(t,n),function(e,t){e._usesDepthTexture&&e._passes[0].framebuffer.status!==L.A.FRAMEBUFFER_COMPLETE&&(e._usesDepthTexture=!1,Ik(e),Pk(e),Dk(e,t))}(t,n),Ok(t,n)),this._isPointLight&&function(e,t){const n=new uP.A;n.fov=J.A.PI_OVER_TWO,n.near=1,n.far=e._pointLightRadius,n.aspectRatio=1;for(let i=0;i<6;++i){const o=e._passes[i].camera;o.positionWC=e._shadowMapCamera.positionWC,o.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(o.positionWC,o.positionCartographic),o.directionWC=Kk[i],o.upWC=$k[i],o.rightWC=Jk[i],O.A.computeView(o.positionWC,o.directionWC,o.upWC,o.rightWC,o.viewMatrix),O.A.inverse(o.viewMatrix,o.inverseViewMatrix),o.frustum=n}}(this,e),this._cascadesEnabled&&(function(e,t){const n=e._shadowMapCamera,i=e._sceneCamera,o=O.A.multiply(i.frustum.projectionMatrix,i.viewMatrix,Lk),r=O.A.inverse(o,Lk),s=n.directionWC;let a=i.directionWC;j.A.equalsEpsilon(s,a,J.A.EPSILON10)&&(a=i.upWC);const c=j.A.cross(s,a,jk);a=j.A.cross(c,s,Qk),j.A.normalize(a,a),j.A.normalize(c,c);const l=j.A.fromElements(0,0,0,Xk);let u=O.A.computeView(l,s,a,c,qk);const d=O.A.multiply(u,r,Lk),h=j.A.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Wk),A=j.A.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,Yk);for(let e=0;e<8;++e){const t=Q.A.clone(Mk[e],Nk[e]);O.A.multiplyByVector(d,t,t),j.A.divideByScalar(t,t.w,t),j.A.minimumByComponent(t,h,h),j.A.maximumByComponent(t,A,A)}A.z+=1e3,h.z-=10;const p=Xk;p.x=-.5*(h.x+A.x),p.y=-.5*(h.y+A.y),p.z=-A.z;const f=O.A.fromTranslation(p,Lk);u=O.A.multiply(f,u,u);const m=.5*(A.x-h.x),g=.5*(A.y-h.y),_=A.z-h.z,y=n.frustum;y.left=-m,y.right=m,y.bottom=-g,y.top=g,y.near=.01,y.far=_,O.A.clone(u,n.viewMatrix),O.A.inverse(u,n.inverseViewMatrix),O.A.getTranslation(n.inverseViewMatrix,n.positionWC),t.mapProjection.ellipsoid.cartesianToCartographic(n.positionWC,n.positionCartographic),j.A.clone(s,n.directionWC),j.A.clone(a,n.upWC),j.A.clone(c,n.rightWC)}(this,e),this._numberOfCascades>1&&function(e,t){const n=e._shadowMapCamera,i=e._sceneCamera,o=i.frustum.near,r=i.frustum.far,s=e._numberOfCascades;let a;const c=r-o,l=r/o;let u=.9,d=!1;t.shadowState.closestObjectSize<200&&(d=!0,u=.9);const h=Gk,A=zk;for(A[0]=o,A[s]=r,a=0;a<s;++a){const e=(a+1)/s,t=o*Math.pow(l,e),n=o+c*e,i=J.A.lerp(n,t,u);A[a+1]=i,h[a]=i-A[a]}if(d){for(a=0;a<s;++a)h[a]=Math.min(h[a],e._maximumCascadeDistances[a]);let t=A[0];for(a=0;a<s-1;++a)t+=h[a],A[a+1]=t}Q.A.unpack(A,0,e._cascadeSplits[0]),Q.A.unpack(A,1,e._cascadeSplits[1]),Q.A.unpack(h,0,e._cascadeDistances);const p=n.frustum,f=p.left,m=p.right,g=p.bottom,_=p.top,y=p.near,v=p.far,T=n.positionWC,b=n.directionWC,w=n.upWC,x=i.frustum.clone(Hk),C=n.getViewProjection();for(a=0;a<s;++a){x.near=A[a],x.far=A[a+1];const t=O.A.multiply(x.projectionMatrix,i.viewMatrix,Lk),o=O.A.inverse(t,Lk),r=O.A.multiply(C,o,Lk),s=j.A.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Wk),c=j.A.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,Yk);for(let e=0;e<8;++e){const t=Q.A.clone(Mk[e],Nk[e]);O.A.multiplyByVector(r,t,t),j.A.divideByScalar(t,t.w,t),j.A.minimumByComponent(t,s,s),j.A.maximumByComponent(t,c,c)}s.x=Math.max(s.x,0),s.y=Math.max(s.y,0),s.z=0,c.x=Math.min(c.x,1),c.y=Math.min(c.y,1),c.z=Math.min(c.z,1);const l=e._passes[a],u=l.camera;u.clone(n);const d=u.frustum;d.left=f+s.x*(m-f),d.right=f+c.x*(m-f),d.bottom=g+s.y*(_-g),d.top=g+c.y*(_-g),d.near=y+s.z*(v-y),d.far=y+c.z*(v-y),l.cullingVolume=u.frustum.computeCullingVolume(T,b,w);const h=e._cascadeMatrices[a];O.A.multiply(u.getViewProjection(),i.inverseViewMatrix,h),O.A.multiply(l.textureOffsets,h,h)}}(this,e)),this._isPointLight)this._shadowMapCullingVolume=YI.A.fromBoundingSphere(this._boundingSphere);else{const e=this._shadowMapCamera,t=e.positionWC,n=e.directionWC,i=e.upWC;this._shadowMapCullingVolume=e.frustum.computeCullingVolume(t,n,i),1===this._passes.length&&this._passes[0].camera.clone(e)}var t,n;if(1===this._passes.length){const e=this._sceneCamera.inverseViewMatrix;O.A.multiply(this._shadowMapCamera.getViewProjection(),e,this._shadowMapMatrix)}this.debugShow&&Uk(this,e)},Ck.prototype.updatePass=function(e,t){Ok(this,e,t)};const iV=new q.A;function oV(e,t,n){const i=e._isPointLight?e._pointBias:n?e._terrainBias:e._primitiveBias,o={shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture},shadowMap_matrix:function(){return e._shadowMapMatrix},shadowMap_cascadeSplits:function(){return e._cascadeSplits},shadowMap_cascadeMatrices:function(){return e._cascadeMatrices},shadowMap_lightDirectionEC:function(){return e._lightDirectionEC},shadowMap_lightPositionEC:function(){return e._lightPositionEC},shadowMap_cascadeDistances:function(){return e._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){const t=iV;return t.x=1/e._textureSize.x,t.y=1/e._textureSize.y,Q.A.fromElements(t.x,t.y,i.depthBias,i.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return Q.A.fromElements(i.normalOffsetScale,e._distance,e.maximumDistance,e._darkness,this.combinedUniforms2)},combinedUniforms1:new Q.A,combinedUniforms2:new Q.A};return(0,tC.A)(t,o,!1)}function rV(e,t,n,i,o,r){let s,a,c;if((0,d.A)(r)&&(s=r.shaderProgram,a=r.renderState,c=r.uniformMap),(r=m.A.shallowClone(n,r)).castShadows=!0,r.receiveShadows=!1,!(0,d.A)(s)||o!==n.shaderProgram.id||t){const t=n.shaderProgram,o=n.pass===ut.A.GLOBE,r=n.pass!==ut.A.TRANSLUCENT,l=e._isPointLight,u=e._usesDepthTexture,h=xk.getShadowCastShaderKeyword(l,o,u,r);if(s=i.shaderCache.getDerivedShaderProgram(t,h),!(0,d.A)(s)){const e=t.vertexShaderSource,n=t.fragmentShaderSource,a=xk.createShadowCastVertexShader(e,l,o),c=xk.createShadowCastFragmentShader(n,l,u,r);s=i.shaderCache.createDerivedShaderProgram(t,h,{vertexShaderSource:a,fragmentShaderSource:c,attributeLocations:t._attributeLocations})}a=e._primitiveRenderState,l?a=e._pointRenderState:o&&(a=e._terrainRenderState),n.renderState.cull.enabled||(a=(0,_t.A)(a,!1),a.cull=(0,_t.A)(a.cull,!1),a.cull.enabled=!1,a=_.A.fromCache(a)),c=oV(e,n.uniformMap,o)}return r.shaderProgram=s,r.renderState=a,r.uniformMap=c,r}Ck.createReceiveDerivedCommand=function(e,t,n,i,o){(0,d.A)(o)||(o={});const r=e.length>0,s=t.shaderProgram,a=s.vertexShaderSource,c=s.fragmentShaderSource,l=t.pass===ut.A.GLOBE;let u=!1;if(l&&(u=t.owner.data.renderedMesh.encoding.hasVertexNormals),t.receiveShadows&&r){let r,h;(0,d.A)(o.receiveCommand)&&(r=o.receiveCommand.shaderProgram,h=o.receiveCommand.uniformMap),o.receiveCommand=m.A.shallowClone(t,o.receiveCommand),o.castShadows=!1,o.receiveShadows=!0;const A=o.receiveShaderCastShadows!==t.castShadows,p=o.receiveShaderProgramId!==t.shaderProgram.id;if(!(0,d.A)(r)||p||n||A){const n=xk.getShadowReceiveShaderKeyword(e[0],t.castShadows,l,u);if(r=i.shaderCache.getDerivedShaderProgram(s,n),!(0,d.A)(r)){const o=xk.createShadowReceiveVertexShader(a,l,u),d=xk.createShadowReceiveFragmentShader(c,e[0],t.castShadows,l,u);r=i.shaderCache.createDerivedShaderProgram(s,n,{vertexShaderSource:o,fragmentShaderSource:d,attributeLocations:s._attributeLocations})}h=oV(e[0],t.uniformMap,l)}o.receiveCommand.shaderProgram=r,o.receiveCommand.uniformMap=h,o.receiveShaderProgramId=t.shaderProgram.id,o.receiveShaderCastShadows=t.castShadows}return o},Ck.createCastDerivedCommand=function(e,t,n,i,o){if((0,d.A)(o)||(o={}),t.castShadows){let r=o.castCommands;(0,d.A)(r)||(r=o.castCommands=[]);const s=o.castShaderProgramId,a=e.length;r.length=a;for(let o=0;o<a;++o)r[o]=rV(e[o],n,t,i,s,r[o]);o.castShaderProgramId=t.shaderProgram.id}return o},Ck.prototype.isDestroyed=function(){return!1},Ck.prototype.destroy=function(){Pk(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(let e=0;e<this._numberOfCascades;++e)this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy();return(0,h.A)(this)};const sV=Ck,aV="uniform sampler2D colorTexture;\n\n#ifdef DEBUG_SHOW_DEPTH\nuniform sampler2D u_packedTranslucentDepth;\n#endif\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n#ifdef DEBUG_SHOW_DEPTH\n    if (v_textureCoordinates.x < 0.5)\n    {\n        out_FragColor.rgb = vec3(czm_unpackDepth(texture(u_packedTranslucentDepth, v_textureCoordinates)));\n        out_FragColor.a = 1.0;\n    }\n#else\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n\n#ifdef PICK\n    if (color == vec4(0.0))\n    {\n        discard;\n    }\n#else\n    // Reverse premultiplication process to get the correct composited result of the classification primitives\n    color.rgb /= color.a;\n#endif\n    out_FragColor = color;\n#endif\n}\n";function cV(e){this._drawClassificationFBO=new at.A({createDepthAttachments:!1}),this._accumulationFBO=new at.A({createDepthAttachments:!1}),this._packFBO=new at.A,this._opaqueDepthStencilTexture=void 0,this._textureToComposite=void 0,this._translucentDepthStencilTexture=void 0,this._packDepthCommand=void 0,this._accumulateCommand=void 0,this._compositeCommand=void 0,this._copyCommand=void 0,this._clearColorCommand=new s.A({color:new u.A(0,0,0,0),owner:this}),this._clearDepthStencilCommand=new s.A({depth:1,stencil:0,owner:this}),this._supported=e.depthTexture,this._viewport=new c.A,this._rsDepth=void 0,this._rsAccumulate=void 0,this._rsComp=void 0,this._useScissorTest=void 0,this._scissorRectangle=void 0,this._hasTranslucentDepth=!1,this._frustumsDrawn=0}function lV(e){e._textureToComposite=void 0,e._translucentDepthStencilTexture=e._translucentDepthStencilTexture&&!e._translucentDepthStencilTexture.isDestroyed()&&e._translucentDepthStencilTexture.destroy()}function uV(e){e._drawClassificationFBO.destroy(),e._accumulationFBO.destroy(),e._packFBO.destroy()}Object.defineProperties(cV.prototype,{hasTranslucentDepth:{get:function(){return this._hasTranslucentDepth}}}),cV.prototype.executeTranslucentCommands=function(e,t,n,i,o){const r=e.frameState.useLogDepth,s=e.context,a=n.framebuffer;for(let e=0;e<i.length;++e){let t=i[e];if(t=r?t.derivedCommands.logDepth.command:t,t.depthForTranslucentClassification){this._hasTranslucentDepth=!0;break}}if(this._hasTranslucentDepth){(function(e,t,n,i){if(!e.isSupported())return;e._opaqueDepthStencilTexture=i;const o=e._opaqueDepthStencilTexture.width,r=e._opaqueDepthStencilTexture.height;let s,a;if(e._drawClassificationFBO.isDirty(o,r)&&(function(e,t,n,i){lV(e),e._translucentDepthStencilTexture=new G.A({context:t,width:n,height:i,pixelFormat:R.A.DEPTH_STENCIL,pixelDatatype:U.A.UNSIGNED_INT_24_8,sampler:At.A.NEAREST})}(e,t,o,r),function(e,t,n,i){uV(e),e._drawClassificationFBO.setDepthStencilTexture(e._translucentDepthStencilTexture),e._drawClassificationFBO.update(t,n,i),e._accumulationFBO.setDepthStencilTexture(e._translucentDepthStencilTexture),e._accumulationFBO.update(t,n,i),e._packFBO.update(t,n,i)}(e,t,o,r)),(0,d.A)(e._packDepthCommand)||(s=new k.A({sources:[uS]}),a={u_opaqueDepthTexture:function(){return e._opaqueDepthStencilTexture},u_translucentDepthTexture:function(){return e._translucentDepthStencilTexture}},e._packDepthCommand=t.createViewportQuadCommand(s,{uniformMap:a,owner:e})),!(0,d.A)(e._compositeCommand)){s=new k.A({sources:[aV]}),a={colorTexture:function(){return e._textureToComposite}},e._compositeCommand=t.createViewportQuadCommand(s,{uniformMap:a,owner:e});const n=e._compositeCommand,i=n.shaderProgram,o=t.shaderCache.createDerivedShaderProgram(i,"pick",{vertexShaderSource:i.vertexShaderSource,fragmentShaderSource:new k.A({sources:s.sources,defines:["PICK"]}),attributeLocations:i._attributeLocations}),r=m.A.shallowClone(n);r.shaderProgram=o,n.derivedCommands.pick=r}(0,d.A)(e._copyCommand)||(s=new k.A({sources:[aV]}),a={colorTexture:function(){return e._drawClassificationFBO.getColorTexture()}},e._copyCommand=t.createViewportQuadCommand(s,{uniformMap:a,owner:e})),(0,d.A)(e._accumulateCommand)||(s=new k.A({sources:[aV]}),a={colorTexture:function(){return e._drawClassificationFBO.getColorTexture()}},e._accumulateCommand=t.createViewportQuadCommand(s,{uniformMap:a,owner:e})),e._viewport.width=o,e._viewport.height=r;const l=!c.A.equals(e._viewport,n.viewport);let u=l!==e._useScissorTest;e._useScissorTest=l,c.A.equals(e._scissorRectangle,n.viewport)||(e._scissorRectangle=c.A.clone(n.viewport,e._scissorRectangle),u=!0),(0,d.A)(e._rsDepth)&&c.A.equals(e._viewport,e._rsDepth.viewport)&&!u||(e._rsDepth=_.A.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}})),(0,d.A)(e._packDepthCommand)&&(e._packDepthCommand.renderState=e._rsDepth),(0,d.A)(e._rsAccumulate)&&c.A.equals(e._viewport,e._rsAccumulate.viewport)&&!u||(e._rsAccumulate=_.A.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},stencilTest:{enabled:!0,frontFunction:IU.A.EQUAL,reference:SU.A.CESIUM_3D_TILE_MASK}})),(0,d.A)(e._accumulateCommand)&&(e._accumulateCommand.renderState=e._rsAccumulate),(0,d.A)(e._rsComp)&&c.A.equals(e._viewport,e._rsComp.viewport)&&!u||(e._rsComp=_.A.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},blending:$M.A.ALPHA_BLEND})),(0,d.A)(e._compositeCommand)&&(e._compositeCommand.renderState=e._rsComp,e._compositeCommand.derivedCommands.pick.renderState=e._rsComp)})(this,s,n,o),n.framebuffer=this._drawClassificationFBO.framebuffer,this._clearDepthStencilCommand.execute(s,n);for(let o=0;o<i.length;++o){let s=i[o];(s=r?s.derivedCommands.logDepth.command:s,s.depthForTranslucentClassification)&&t(s.derivedCommands.depth.depthOnlyCommand,e,n)}this._frustumsDrawn+=this._hasTranslucentDepth?1:0,this._hasTranslucentDepth&&(n.framebuffer=this._packFBO.framebuffer,this._packDepthCommand.execute(s,n)),n.framebuffer=a}},cV.prototype.executeClassificationCommands=function(e,t,n,i){if(!this._hasTranslucentDepth)return;const o=e.context,r=o.uniformState,s=n.framebuffer;n.framebuffer=this._accumulationFBO.framebuffer,this._accumulateCommand.execute(o,n),n.framebuffer=this._drawClassificationFBO.framebuffer,this._frustumsDrawn>1&&this._clearColorCommand.execute(o,n),r.updatePass(ut.A.CESIUM_3D_TILE_CLASSIFICATION);const a=r.globeDepthTexture;r.globeDepthTexture=this._packFBO.getColorTexture();const c=i.commands[ut.A.CESIUM_3D_TILE_CLASSIFICATION],l=i.indices[ut.A.CESIUM_3D_TILE_CLASSIFICATION];for(let i=0;i<l;++i)t(c[i],e,n);r.globeDepthTexture=a,n.framebuffer=s,1!==this._frustumsDrawn&&(n.framebuffer=this._accumulationFBO.framebuffer,this._accumulateCommand.execute(o,n),n.framebuffer=s)},cV.prototype.execute=function(e,t){this._hasTranslucentDepth&&(1===this._frustumsDrawn?this._textureToComposite=this._drawClassificationFBO.getColorTexture():this._textureToComposite=this._accumulationFBO.getColorTexture(),(e.frameState.passes.pick?this._compositeCommand.derivedCommands.pick:this._compositeCommand).execute(e.context,t),function(e,t,n){if(!e._hasTranslucentDepth)return;const i=n.framebuffer;n.framebuffer=e._drawClassificationFBO.framebuffer,e._clearColorCommand.execute(t._context,n),n.framebuffer=i,e._frustumsDrawn>1&&(n.framebuffer=e._accumulationFBO.framebuffer,e._clearColorCommand.execute(t._context,n)),e._hasTranslucentDepth=!1,e._frustumsDrawn=0}(this,e,t))},cV.prototype.isSupported=function(){return this._supported},cV.prototype.isDestroyed=function(){return!1},cV.prototype.destroy=function(){return lV(this),uV(this),(0,d.A)(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),(0,d.A)(this._packDepthCommand)&&(this._packDepthCommand.shaderProgram=this._packDepthCommand.shaderProgram&&this._packDepthCommand.shaderProgram.destroy()),(0,h.A)(this)};const dV=cV;function hV(){this.command=void 0,this.near=void 0,this.far=void 0}function AV(e,t,n){const i=e.context;let o,r;i.depthTexture&&(o=new tk),e._useOIT&&i.depthTexture&&(r=new fk(i));const s=new F(i);s.viewport=c.A.clone(n),this.camera=t,this._cameraClone=UB.A.clone(t),this._cameraStartFired=!1,this._cameraMovedTime=void 0,this.viewport=n,this.passState=s,this.pickFramebuffer=new vk(i),this.pickDepthFramebuffer=new gk,this.sceneFramebuffer=new bk,this.globeDepth=o,this.globeTranslucencyFramebuffer=new ik,this.oit=r,this.translucentTileClassification=new dV(i),this.pickDepths=[],this.frustumCommandsList=[],this.debugFrustumStatistics=void 0,this._commandExtents=[]}const pV=new j.A,fV=new j.A;function mV(e,t,n){const{command:i,near:o,far:r}=n;t.debugShowFrustums&&(i.debugOverlappingFrustums=0);const{frustumCommandsList:s}=e;for(let e=0;e<s.length;++e){const n=s[e];if(o>n.far)continue;if(r<n.near)break;const a=i.pass,c=n.indices[a]++;if(n.commands[a][c]=i,t.debugShowFrustums&&(i.debugOverlappingFrustums|=1<<e),i.executeInClosestFrustum)break}if(t.debugShowFrustums){const{debugFrustumStatistics:t}=e,{debugOverlappingFrustums:n}=i,o=t.commandsInFrustums;o[n]=(0,d.A)(o[n])?o[n]+1:1,++t.totalCommands}t.updateDerivedCommands(i)}AV.prototype.checkForCameraUpdates=function(e){const t=this.camera,n=this._cameraClone;return function(e,t,n){const i=Math.max(j.A.maximumComponent(j.A.abs(e.position,pV)),j.A.maximumComponent(j.A.abs(t.position,fV))),o=1/Math.max(1,i);return j.A.multiplyByScalar(e.position,o,pV),j.A.multiplyByScalar(t.position,o,fV),j.A.equalsEpsilon(pV,fV,n)&&j.A.equalsEpsilon(e.direction,t.direction,n)&&j.A.equalsEpsilon(e.up,t.up,n)&&j.A.equalsEpsilon(e.right,t.right,n)&&O.A.equalsEpsilon(e.transform,t.transform,n)&&e.frustum.equalsEpsilon(t.frustum,n)}(t,n,J.A.EPSILON15)?(this._cameraStartFired&&(0,aa.A)()-this._cameraMovedTime>e.cameraEventWaitTime&&(t.moveEnd.raiseEvent(),this._cameraStartFired=!1),!1):(this._cameraStartFired||(t.moveStart.raiseEvent(),this._cameraStartFired=!0),this._cameraMovedTime=(0,aa.A)(),UB.A.clone(t,n),!0)};const gV=new YI.A,_V=new xO.A;AV.prototype.createPotentiallyVisibleSet=function(e){const{frameState:t}=e,{camera:n,commandList:i,shadowState:o}=t,{positionWC:r,directionWC:a,frustum:c}=n,l=e._computeCommandList,u=e._overlayCommandList;e.debugShowFrustums&&(this.debugFrustumStatistics={totalCommands:0,commandsInFrustums:{}});const h=this.frustumCommandsList;for(let e=0;e<h.length;++e)for(let t=0;t<ut.A.NUMBER_OF_PASSES;++t)h[e].indices[t]=0;l.length=0,u.length=0;const A=this._commandExtents,p=A.length;let f=0,m=+Number.MAX_VALUE,g=-Number.MAX_VALUE;const{shadowsEnabled:_}=o;let y=+Number.MAX_VALUE,v=-Number.MAX_VALUE,T=Number.MAX_VALUE;const b=t.mode===Ce.A.SCENE3D?t.occluder:void 0;let{cullingVolume:w}=t;const x=gV.planes;for(let e=0;e<5;++e)x[e]=w.planes[e];w=gV;for(let t=0;t<i.length;++t){const n=i[t],{pass:o,boundingVolume:h}=n;if(o===ut.A.COMPUTE)l.push(n);else if(o===ut.A.OVERLAY)u.push(n);else{let t,i;if((0,d.A)(h)){if(!e.isVisible(w,n,b))continue;const s=h.computePlaneDistances(r,a,_V);if(t=s.start,i=s.stop,m=Math.min(m,t),g=Math.max(g,i),_&&n.receiveShadows&&t<sV.MAXIMUM_DISTANCE&&!(o===ut.A.GLOBE&&t<-100&&i>100)){const e=i-t;o!==ut.A.GLOBE&&t<100&&(T=Math.min(T,e)),y=Math.min(y,t),v=Math.max(v,i)}}else n instanceof s.A?(t=c.near,i=c.far):(t=c.near,i=c.far,m=Math.min(m,t),g=Math.max(g,i));let l=A[f];(0,d.A)(l)||(l=A[f]=new hV),l.command=n,l.near=t,l.far=i,f++}}_&&(y=Math.min(Math.max(y,c.near),c.far),v=Math.max(Math.min(v,c.far),y),o.nearPlane=y,o.farPlane=v,o.closestObjectSize=T),function(e,t,n,i){const{frameState:o}=t,{camera:r,useLogDepth:s}=o,a=s?t.logarithmicDepthFarToNearRatio:t.farToNearRatio,c=t.mode===Ce.A.SCENE2D,l=t.nearToFarDistance2D;let u;i*=1+J.A.EPSILON2,n=Math.min(Math.max(n,r.frustum.near),r.frustum.far),i=Math.max(Math.min(i,r.frustum.far),n),c?(i=Math.min(i,r.position.z+t.nearToFarDistance2D),n=Math.min(n,i),u=Math.ceil(Math.max(1,i-n)/t.nearToFarDistance2D)):u=Math.ceil(Math.log(i/n)/Math.log(a));const{frustumCommandsList:h}=e;h.length=u;for(let e=0;e<u;++e){let t,o;c?(t=Math.min(i-l,n+e*l),o=Math.min(i,t+l)):(t=Math.max(n,Math.pow(a,e)*n),o=Math.min(i,a*t));let r=h[e];(0,d.A)(r)?(r.near=t,r.far=o):r=h[e]=new $U(t,o)}}(this,e,m,g);for(let t=0;t<f;t++)mV(this,e,A[t]);if(f<p)for(let e=f;e<p;e++){const t=A[e];if(!(0,d.A)(t.command))break;t.command=void 0}const C=h.length,{frustumSplits:E}=t;E.length=C+1;for(let e=0;e<C;++e)E[e]=h[e].near,e===C-1&&(E[e+1]=h[e].far)},AV.prototype.destroy=function(){this.pickFramebuffer=this.pickFramebuffer&&this.pickFramebuffer.destroy(),this.pickDepthFramebuffer=this.pickDepthFramebuffer&&this.pickDepthFramebuffer.destroy(),this.sceneFramebuffer=this.sceneFramebuffer&&this.sceneFramebuffer.destroy(),this.globeDepth=this.globeDepth&&this.globeDepth.destroy(),this.oit=this.oit&&this.oit.destroy(),this.translucentTileClassification=this.translucentTileClassification&&this.translucentTileClassification.destroy(),this.globeTranslucencyFramebuffer=this.globeTranslucencyFramebuffer&&this.globeTranslucencyFramebuffer.destroy();const e=this.pickDepths;for(let t=0;t<e.length;++t)e[t].destroy()};const yV=AV,vV=new VB({pass:kB.A.MOST_DETAILED_PRELOAD}),TV=new VB({pass:kB.A.MOST_DETAILED_PICK}),bV=new VB({pass:kB.A.PICK});function wV(e){this._mostDetailedRayPicks=[],this.pickRenderStateCache={},this._pickPositionCache={},this._pickPositionCacheDirty=!1;const t=new c.A(0,0,1,1),n=new UB.A(e);n.frustum=new ee.A({width:.1,aspectRatio:1,near:.1}),this._pickOffscreenView=new yV(e,n,t)}wV.prototype.update=function(){this._pickPositionCacheDirty=!0},wV.prototype.getPickDepth=function(e,t){const n=e.view.pickDepths;let i=n[t];return(0,d.A)(i)||(i=new XU,n[t]=i),i};const xV=new aR.A,CV=new j.A,EV=new j.A,SV=new q.A,IV=new O.A,PV=new uR.A,DV=new q.A;function OV(e,t,n,i,o){const r=e.camera.frustum;return r instanceof ee.A||r instanceof aR.A?function(e,t,n,i,o){const r=e.camera;let s=r.frustum;const a=s.offCenterFrustum;(0,d.A)(a)&&(s=a);let c=2*(t.x-o.x)/o.width-1;c*=.5*(s.right-s.left);let l=2*(o.height-t.y-o.y)/o.height-1;l*=.5*(s.top-s.bottom);const u=O.A.clone(r.transform,IV);r._setTransform(O.A.IDENTITY);const h=j.A.clone(r.position,CV);j.A.multiplyByScalar(r.right,c,EV),j.A.add(EV,h,h),j.A.multiplyByScalar(r.up,l,EV),j.A.add(EV,h,h),r._setTransform(u),e.mode===Ce.A.SCENE2D&&j.A.fromElements(h.z,h.x,h.y,h);const A=s.getPixelDimensions(o.width,o.height,1,1,SV),p=xV;return p.right=.5*A.x,p.left=-p.right,p.top=.5*A.y,p.bottom=-p.top,p.near=s.near,p.far=s.far,p.computeCullingVolume(h,r.directionWC,r.upWC)}(e,t,0,0,o):function(e,t,n,i,o){const r=e.camera,s=r.frustum,a=s.near,c=Math.tan(.5*s.fovy),l=s.aspectRatio*c,u=(2*(t.x-o.x)/o.width-1)*a*l,d=(2*(o.height-t.y-o.y)/o.height-1)*a*c,h=s.getPixelDimensions(o.width,o.height,1,1,DV),A=h.x*n*.5,p=h.y*i*.5,f=PV;return f.top=d+p,f.bottom=d-p,f.right=u+A,f.left=u-A,f.near=a,f.far=s.far,f.computeCullingVolume(r.positionWC,r.directionWC,r.upWC)}(e,t,n,i,o)}const RV=new c.A(0,0,3,3),MV=new q.A,LV=new u.A(0,0,0,0);function NV(e,t,n,i,o){return o.width=n??3,o.height=i??o.width,o.x=t.x-.5*(o.width-1),o.y=e-t.y-.5*(o.height-1),o}wV.prototype.pick=function(e,t,n,i){l.A.defined("windowPosition",t);const{context:o,frameState:r,defaultView:s}=e,{viewport:a,pickFramebuffer:u}=s;e.view=s,a.x=0,a.y=0,a.width=o.drawingBufferWidth,a.height=o.drawingBufferHeight;let d=s.passState;d.viewport=c.A.clone(a,d.viewport);const h=KU.A.transformWindowToDrawingBuffer(e,t,MV),A=NV(o.drawingBufferHeight,h,n,i,RV);e.jobScheduler.disableThisFrame(),e.updateFrameState(),r.cullingVolume=OV(e,h,A.width,A.height,a),r.invertClassification=!1,r.passes.pick=!0,r.tilesetPassState=bV,o.uniformState.update(r),e.updateEnvironment(),d=u.begin(A,a),e.updateAndExecuteCommands(d,LV),e.resolveFramebuffers(d);const p=u.end(A);return o.endFrame(),p},wV.prototype.pickVoxelCoordinate=function(e,t,n,i){l.A.defined("windowPosition",t);const{context:o,frameState:r,defaultView:s}=e,{viewport:a,pickFramebuffer:u}=s;e.view=s,a.x=0,a.y=0,a.width=o.drawingBufferWidth,a.height=o.drawingBufferHeight;let d=s.passState;d.viewport=c.A.clone(a,d.viewport);const h=KU.A.transformWindowToDrawingBuffer(e,t,MV),A=NV(o.drawingBufferHeight,h,n,i,RV);e.jobScheduler.disableThisFrame(),e.updateFrameState(),r.cullingVolume=OV(e,h,A.width,A.height,a),r.invertClassification=!1,r.passes.pickVoxel=!0,r.tilesetPassState=bV,o.uniformState.update(r),e.updateEnvironment(),d=u.begin(A,a),e.updateAndExecuteCommands(d,LV),e.resolveFramebuffers(d);const p=u.readCenterPixel(A);return o.endFrame(),p},wV.prototype.pickMetadata=function(e,t,n){l.A.typeOf.object("windowPosition",t),l.A.typeOf.object("pickedMetadataInfo",n);const{context:i,frameState:o,defaultView:r}=e,{viewport:s,pickFramebuffer:a}=r;e.view=r,s.x=0,s.y=0,s.width=i.drawingBufferWidth,s.height=i.drawingBufferHeight;let u=r.passState;u.viewport=c.A.clone(s,u.viewport);const d=KU.A.transformWindowToDrawingBuffer(e,t,MV),h=NV(i.drawingBufferHeight,d,1,1,RV);e.jobScheduler.disableThisFrame(),e.updateFrameState(),o.cullingVolume=OV(e,d,h.width,h.height,s),o.invertClassification=!1,o.passes.pick=!0,o.tilesetPassState=bV,o.pickingMetadata=!0,o.pickedMetadataInfo=n,i.uniformState.update(o),e.updateEnvironment(),u=a.begin(h,s),e.updateAndExecuteCommands(u,LV);const A=e._environmentState.useOIT;e._environmentState.useOIT=!1,e.resolveFramebuffers(u),e._environmentState.useOIT=A;const p=a.readCenterPixel(h);return i.endFrame(),o.pickingMetadata=!1,YU.decodeMetadataValues(n.classProperty,n.metadataProperty,p)};const BV=new uP.A,FV=new uR.A,UV=new ee.A,kV=new aR.A;wV.prototype.pickPositionWorldCoordinates=function(e,t,n){if(!e.useDepthPicking)return;if(l.A.defined("windowPosition",t),!e.context.depthTexture)throw new A.A("Picking from the depth buffer is not supported. Check pickPositionSupported.");const i=t.toString();if(this._pickPositionCacheDirty)this._pickPositionCache={},this._pickPositionCacheDirty=!1;else if(this._pickPositionCache.hasOwnProperty(i))return j.A.clone(this._pickPositionCache[i],n);const{context:o,frameState:r,camera:s,defaultView:a}=e,{uniformState:u}=o;e.view=a;const h=KU.A.transformWindowToDrawingBuffer(e,t,MV);let p;e.pickTranslucentDepth?function(e,t){const{defaultView:n,context:i,frameState:o,environmentState:r}=e,{viewport:s,pickDepthFramebuffer:a}=n;e.view=n,s.x=0,s.y=0,s.width=i.drawingBufferWidth,s.height=i.drawingBufferHeight;let l=n.passState;l.viewport=c.A.clone(s,l.viewport),e.clearPasses(o.passes),o.passes.pick=!0,o.passes.depth=!0,o.cullingVolume=OV(e,t,1,1,s),o.tilesetPassState=bV,e.updateEnvironment(),r.renderTranslucentDepthForPick=!0,l=a.update(i,t,s),e.updateAndExecuteCommands(l,LV),e.resolveFramebuffers(l),i.endFrame()}(e,h):(e.updateFrameState(),u.update(r),e.updateEnvironment()),h.y=e.drawingBufferHeight-h.y,p=(0,d.A)(s.frustum.fov)?s.frustum.clone(BV):(0,d.A)(s.frustum.infiniteProjectionMatrix)?s.frustum.clone(FV):(0,d.A)(s.frustum.width)?s.frustum.clone(UV):s.frustum.clone(kV);const{frustumCommandsList:f}=a,m=f.length;for(let t=0;t<m;++t){const a=this.getPickDepth(e,t).getDepth(o,h.x,h.y);if((0,d.A)(a)&&a>0&&a<1){const o=f[t];let c;return e.mode===Ce.A.SCENE2D?(c=s.position.z,s.position.z=c-o.near+1,p.far=Math.max(1,o.far-o.near),p.near=1,u.update(r),u.updateFrustum(p)):(p.near=o.near*(0!==t?e.opaqueFrustumNearOffset:1),p.far=o.far,u.updateFrustum(p)),n=KU.A.drawingBufferToWorldCoordinates(e,h,a,n),e.mode===Ce.A.SCENE2D&&(s.position.z=c,u.update(r)),this._pickPositionCache[i]=j.A.clone(n),n}}this._pickPositionCache[i]=void 0};const VV=new X.A;function zV(e,t){let n,i;const o=[],r=[],s=[],a=[];(0,d.A)(e)||(e=Number.MAX_VALUE);let c=t();for(;(0,d.A)(c);){const n=c.object,l=c.position,u=c.exclude;if((0,d.A)(l)&&!(0,d.A)(n)){o.push(c);break}if(!(0,d.A)(n)||!(0,d.A)(n.primitive))break;if(!u&&(o.push(c),0>=--e))break;const h=n.primitive;let A=!1;"function"==typeof h.getGeometryInstanceAttributes&&(0,d.A)(n.id)&&(i=h.getGeometryInstanceAttributes(n.id),(0,d.A)(i)&&(0,d.A)(i.show)&&(A=!0,i.show=wn.A.toValue(!1,i.show),s.push(i))),n instanceof HU.A&&(A=!0,n.show=!1,a.push(n)),A||(h.show=!1,r.push(h)),c=t()}for(n=0;n<r.length;++n)r[n].show=!0;for(n=0;n<s.length;++n)i=s[n],i.show=wn.A.toValue(!0,i.show);for(n=0;n<a.length;++n)a[n].show=!0;return o}wV.prototype.pickPosition=function(e,t,n){if(n=this.pickPositionWorldCoordinates(e,t,n),(0,d.A)(n)&&e.mode!==Ce.A.SCENE3D){j.A.fromElements(n.y,n.z,n.x,n);const t=e.mapProjection,i=t.ellipsoid,o=t.unproject(n,VV);i.cartographicToCartesian(o,n)}return n},wV.prototype.drillPick=function(e,t,n,i,o){const r=this;return zV(n,function(){const n=r.pick(e,t,i,o);if((0,d.A)(n))return{object:n,position:void 0,exclude:!1}}).map(function(e){return e.object})};const HV=new j.A,GV=new j.A;function WV(e,t,n){this.ray=e,this.width=t,this.tilesets=n,this.ready=!1;const i=this;this.promise=new Promise(e=>{i._completePick=()=>{e()}})}function YV(e,t,n,i){const o=t.direction,r=j.A.mostOrthogonalAxis(o,HV),s=j.A.cross(o,r,HV),a=j.A.cross(o,s,GV);return i.position=t.origin,i.direction=o,i.up=a,i.right=s,i.frustum.width=n??.1,i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC)}function qV(e,t,n){const i=t.frameState,{ray:o,width:r,tilesets:s}=n,a=e._pickOffscreenView.camera,c=YV(0,o,r,a),l=vV;l.camera=a,l.cullingVolume=c;let u=!0;const d=s.length;for(let e=0;e<d;++e){const n=s[e];n.show&&t.primitives.contains(n)&&(n.updateForPass(i,l),u=u&&l.ready)}return u&&n._completePick(),u}function jV(e,t,n){for(let i=0;i<e.length;++i){const o=e.get(i);o.show&&((0,d.A)(o.isCesium3DTileset)?(0,d.A)(t)&&-1!==t.indexOf(o)||n.push(o):o instanceof Yl.A&&jV(o,t,n))}}function QV(e,t,n,i,o,r){const s=[];if(jV(t.primitives,i,s),0===s.length)return Promise.resolve(r());const a=new WV(n,o,s);return e._mostDetailedRayPicks.push(a),a.promise.then(function(){return r()})}function XV(e,t){return!(!(0,d.A)(e)||!(0,d.A)(t)||0===t.length)&&(t.indexOf(e)>-1||t.indexOf(e.primitive)>-1||t.indexOf(e.id)>-1)}function KV(e,t,n,i,o,r,s,a){return zV(i,function(){return function(e,t,n,i,o,r,s){const{context:a,frameState:l}=t,u=a.uniformState,h=e._pickOffscreenView;t.view=h,YV(0,n,o,h.camera);const A=c.A.clone(h.viewport,RV),p=h.pickFramebuffer.begin(A,h.viewport);let f;t.jobScheduler.disableThisFrame(),t.updateFrameState(),l.invertClassification=!1,l.passes.pick=!0,l.passes.offscreen=!0,l.tilesetPassState=s?TV:bV,u.update(l),t.updateEnvironment(),t.updateAndExecuteCommands(p,LV),t.resolveFramebuffers(p);const m=h.pickFramebuffer.end(A);if(t.context.depthTexture){const{frustumCommandsList:i}=h,o=i.length;for(let r=0;r<o;++r){const o=e.getPickDepth(t,r).getDepth(a,0,0);if((0,d.A)(o)&&o>0&&o<1){const e=i[r],s=e.near*(0!==r?t.opaqueFrustumNearOffset:1),a=s+o*(e.far-s);f=_R.A.getPoint(n,a);break}}}if(t.view=t.defaultView,a.endFrame(),(0,d.A)(m)||(0,d.A)(f))return{object:m,position:f,exclude:!(0,d.A)(f)&&r||XV(m,i)}}(e,t,n,o,r,s,a)})}function $V(e,t,n,i,o,r,s){const a=KV(e,t,n,1,i,o,r,s);if(a.length>0)return a[0]}function JV(e,t,n,i,o,r,s,a){return KV(e,t,n,i,o,r,s,a)}function ZV(e,t){return new Promise((n,i)=>{t.then(function(t){const i=e.postRender.addEventListener(function(){i(),n(t)});e.requestRender()}).catch(function(e){i(e)})})}wV.prototype.updateMostDetailedRayPicks=function(e){const t=this._mostDetailedRayPicks;for(let n=0;n<t.length;++n)qV(this,e,t[n])&&t.splice(n--,1)},wV.prototype.pickFromRay=function(e,t,n,i){if(l.A.defined("ray",t),e.mode!==Ce.A.SCENE3D)throw new A.A("Ray intersections are only supported in 3D mode.");return $V(this,e,t,n,i,!1,!1)},wV.prototype.drillPickFromRay=function(e,t,n,i,o){if(l.A.defined("ray",t),e.mode!==Ce.A.SCENE3D)throw new A.A("Ray intersections are only supported in 3D mode.");return JV(this,e,t,n,i,o,!1,!1)},wV.prototype.pickFromRayMostDetailed=function(e,t,n,i){if(l.A.defined("ray",t),e.mode!==Ce.A.SCENE3D)throw new A.A("Ray intersections are only supported in 3D mode.");const o=this;return t=_R.A.clone(t),n=(0,d.A)(n)?n.slice():n,ZV(e,QV(o,e,t,n,i,function(){return $V(o,e,t,n,i,!1,!0)}))},wV.prototype.drillPickFromRayMostDetailed=function(e,t,n,i,o){if(l.A.defined("ray",t),e.mode!==Ce.A.SCENE3D)throw new A.A("Ray intersections are only supported in 3D mode.");const r=this;return t=_R.A.clone(t),i=(0,d.A)(i)?i.slice():i,ZV(e,QV(r,e,t,i,o,function(){return JV(r,e,t,n,i,o,!1,!0)}))};const ez=new j.A,tz=new j.A,nz=new _R.A,iz=new X.A;function oz(e,t){const n=e.ellipsoid,i=mo.A._defaultMaxTerrainHeight,o=n.geodeticSurfaceNormalCartographic(t,tz),r=X.A.toCartesian(t,n,ez),s=nz;s.origin=r,s.direction=o;const a=new _R.A;return _R.A.getPoint(s,i,a.origin),j.A.negate(o,a.direction),a}function rz(e,t){const n=e.ellipsoid;return oz(e,X.A.fromCartesian(t,n,iz))}function sz(e,t){const n=e.ellipsoid;return X.A.fromCartesian(t,n,iz).height}function az(e,t,n,i,o){const r=oz(t,n);return QV(e,t,r,i,o,function(){const n=$V(e,t,r,i,o,!0,!0);if((0,d.A)(n))return sz(t,n.position)})}function cz(e,t,n,i,o,r){const s=rz(t,n);return QV(e,t,s,i,o,function(){const n=$V(e,t,s,i,o,!0,!0);if((0,d.A)(n))return j.A.clone(n.position,r)})}wV.prototype.sampleHeight=function(e,t,n,i){if(l.A.defined("position",t),e.mode!==Ce.A.SCENE3D)throw new A.A("sampleHeight is only supported in 3D mode.");if(!e.sampleHeightSupported)throw new A.A("sampleHeight requires depth texture support. Check sampleHeightSupported.");const o=$V(this,e,oz(e,t),n,i,!0,!1);if((0,d.A)(o))return sz(e,o.position)},wV.prototype.clampToHeight=function(e,t,n,i,o){if(l.A.defined("cartesian",t),e.mode!==Ce.A.SCENE3D)throw new A.A("clampToHeight is only supported in 3D mode.");if(!e.clampToHeightSupported)throw new A.A("clampToHeight requires depth texture support. Check clampToHeightSupported.");const r=$V(this,e,rz(e,t),n,i,!0,!1);if((0,d.A)(r))return j.A.clone(r.position,o)},wV.prototype.sampleHeightMostDetailed=function(e,t,n,i){if(l.A.defined("positions",t),e.mode!==Ce.A.SCENE3D)throw new A.A("sampleHeightMostDetailed is only supported in 3D mode.");if(!e.sampleHeightSupported)throw new A.A("sampleHeightMostDetailed requires depth texture support. Check sampleHeightSupported.");n=(0,d.A)(n)?n.slice():n;const o=t.length,r=new Array(o);for(let s=0;s<o;++s)r[s]=az(this,e,t[s],n,i);return ZV(e,Promise.all(r).then(function(e){const n=e.length;for(let i=0;i<n;++i)t[i].height=e[i];return t}))},wV.prototype.clampToHeightMostDetailed=function(e,t,n,i){if(l.A.defined("cartesians",t),e.mode!==Ce.A.SCENE3D)throw new A.A("clampToHeightMostDetailed is only supported in 3D mode.");if(!e.clampToHeightSupported)throw new A.A("clampToHeightMostDetailed requires depth texture support. Check clampToHeightSupported.");n=(0,d.A)(n)?n.slice():n;const o=t.length,r=new Array(o);for(let s=0;s<o;++s)r[s]=cz(this,e,t[s],n,i,t[s]);return ZV(e,Promise.all(r).then(function(e){const n=e.length;for(let i=0;i<n;++i)t[i]=e[i];return t}))},wV.prototype.destroy=function(){this._pickOffscreenView=this._pickOffscreenView&&this._pickOffscreenView.destroy()};const lz=wV,uz="uniform sampler2D colorTexture;\n\nin vec2 v_textureCoordinates;\n\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#else\nuniform float exposure;\n#endif\n\nvoid main()\n{\n    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);\n    vec3 color = fragmentColor.rgb;\n\n#ifdef AUTO_EXPOSURE\n    color /= texture(autoExposure, vec2(0.5)).r;\n#else\n    color *= vec3(exposure);\n#endif\n    color = czm_acesTonemapping(color);\n    color = czm_inverseGamma(color);\n\n    out_FragColor = vec4(color, fragmentColor.a);\n}\n",dz="precision highp float;\n\nuniform sampler2D randomTexture;\nuniform sampler2D depthTexture;\nuniform float intensity;\nuniform float bias;\nuniform float lengthCap;\nuniform int stepCount;\nuniform int directionCount;\n\nvec4 pixelToEye(vec2 screenCoordinate)\n{\n    vec2 uv = screenCoordinate / czm_viewport.zw;\n    float depth = czm_readDepth(depthTexture, uv);\n    vec2 xy = 2.0 * uv - vec2(1.0);\n    vec4 posEC = czm_inverseProjection * vec4(xy, depth, 1.0);\n    posEC = posEC / posEC.w;\n    // Avoid numerical error at far plane\n    if (depth >= 1.0) {\n        posEC.z = czm_currentFrustum.y;\n    }\n    return posEC;\n}\n\n// Reconstruct surface normal in eye coordinates, avoiding edges\nvec3 getNormalXEdge(vec3 positionEC)\n{\n    // Find the 3D surface positions at adjacent screen pixels\n    vec2 centerCoord = gl_FragCoord.xy;\n    vec3 positionLeft = pixelToEye(centerCoord + vec2(-1.0, 0.0)).xyz;\n    vec3 positionRight = pixelToEye(centerCoord + vec2(1.0, 0.0)).xyz;\n    vec3 positionUp = pixelToEye(centerCoord + vec2(0.0, 1.0)).xyz;\n    vec3 positionDown = pixelToEye(centerCoord + vec2(0.0, -1.0)).xyz;\n\n    // Compute potential tangent vectors\n    vec3 dx0 = positionEC - positionLeft;\n    vec3 dx1 = positionRight - positionEC;\n    vec3 dy0 = positionEC - positionDown;\n    vec3 dy1 = positionUp - positionEC;\n\n    // The shorter tangent is more likely to be on the same surface\n    vec3 dx = length(dx0) < length(dx1) ? dx0 : dx1;\n    vec3 dy = length(dy0) < length(dy1) ? dy0 : dy1;\n\n    return normalize(cross(dx, dy));\n}\n\nconst float sqrtTwoPi = sqrt(czm_twoPi);\n\nfloat gaussian(float x, float standardDeviation) {\n    float argument = x / standardDeviation;\n    return exp(-0.5 * argument * argument) / (sqrtTwoPi * standardDeviation);\n}\n\nvoid main(void)\n{\n    vec4 positionEC = pixelToEye(gl_FragCoord.xy);\n\n    // Exit if we are too close to the back of the frustum, where the depth value is invalid.\n    float maxValidDepth = czm_currentFrustum.y - lengthCap;\n    if (-positionEC.z > maxValidDepth)\n    {\n        out_FragColor = vec4(1.0);\n        return;\n    }\n\n    vec3 normalEC = getNormalXEdge(positionEC.xyz);\n    float gaussianVariance = lengthCap * sqrt(-positionEC.z);\n    // Choose a step length such that the marching stops just before 3 * variance.\n    float stepLength = 3.0 * gaussianVariance / (float(stepCount) + 1.0);\n    float metersPerPixel = czm_metersPerPixel(positionEC, 1.0);\n    // Minimum step is 1 pixel to avoid double sampling\n    float pixelsPerStep = max(stepLength / metersPerPixel, 1.0);\n    stepLength = pixelsPerStep * metersPerPixel;\n\n    float angleStepScale = 1.0 / float(directionCount);\n    float angleStep = angleStepScale * czm_twoPi;\n    float cosStep = cos(angleStep);\n    float sinStep = sin(angleStep);\n    mat2 rotateStep = mat2(cosStep, sinStep, -sinStep, cosStep);\n\n    // Initial sampling direction (different for each pixel)\n    const float randomTextureSize = 255.0;\n    vec2 randomTexCoord = fract(gl_FragCoord.xy / randomTextureSize);\n    float randomVal = texture(randomTexture, randomTexCoord).x;\n    vec2 sampleDirection = vec2(cos(angleStep * randomVal), sin(angleStep * randomVal));\n\n    float ao = 0.0;\n    // Loop over sampling directions\n#if __VERSION__ == 300\n    for (int i = 0; i < directionCount; i++)\n    {\n#else\n    for (int i = 0; i < 16; i++)\n    {\n        if (i >= directionCount) {\n            break;\n        }\n#endif\n        sampleDirection = rotateStep * sampleDirection;\n\n        float localAO = 0.0;\n        vec2 radialStep = pixelsPerStep * sampleDirection;\n\n#if __VERSION__ == 300\n        for (int j = 0; j < stepCount; j++)\n        {\n#else\n        for (int j = 0; j < 64; j++)\n        {\n            if (j >= stepCount) {\n                break;\n            }\n#endif\n            // Step along sampling direction, away from output pixel\n            vec2 samplePixel = floor(gl_FragCoord.xy + float(j + 1) * radialStep) + vec2(0.5);\n\n            // Exit if we stepped off the screen\n            if (clamp(samplePixel, vec2(0.0), czm_viewport.zw) != samplePixel) {\n                break;\n            }\n\n            // Compute step vector from output point to sampled point\n            vec4 samplePositionEC = pixelToEye(samplePixel);\n            vec3 stepVector = samplePositionEC.xyz - positionEC.xyz;\n\n            // Estimate the angle from the surface normal.\n            float dotVal = clamp(dot(normalEC, normalize(stepVector)), 0.0, 1.0);\n            dotVal = czm_branchFreeTernary(dotVal > bias, dotVal, 0.0);\n            dotVal = czm_branchFreeTernary(-samplePositionEC.z <= maxValidDepth, dotVal, 0.0);\n\n            // Weight contribution based on the distance from the output point\n            float sampleDistance = length(stepVector);\n            float weight = gaussian(sampleDistance, gaussianVariance);\n            localAO += weight * dotVal;\n        }\n        ao += localAO;\n    }\n\n    ao *= angleStepScale * stepLength;\n    ao = 1.0 - clamp(ao, 0.0, 1.0);\n    ao = pow(ao, intensity);\n    out_FragColor = vec4(vec3(ao), 1.0);\n}\n",hz="uniform sampler2D colorTexture;\nuniform sampler2D ambientOcclusionTexture;\nuniform bool ambientOcclusionOnly;\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n    vec4 ao = texture(ambientOcclusionTexture, v_textureCoordinates);\n    out_FragColor = ambientOcclusionOnly ? ao : ao * color;\n}\n",Az="uniform sampler2D colorTexture;\nuniform float gradations;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 rgb = texture(colorTexture, v_textureCoordinates).rgb;\n#ifdef CZM_SELECTED_FEATURE\n    if (czm_selected()) {\n        out_FragColor = vec4(rgb, 1.0);\n        return;\n    }\n#endif\n    float luminance = czm_luminance(rgb);\n    float darkness = luminance * gradations;\n    darkness = (darkness - fract(darkness)) / gradations;\n    out_FragColor = vec4(vec3(darkness), 1.0);\n}\n",pz="uniform sampler2D colorTexture;\nuniform sampler2D bloomTexture;\nuniform bool glowOnly;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n\n#ifdef CZM_SELECTED_FEATURE\n    if (czm_selected()) {\n        out_FragColor = color;\n        return;\n    }\n#endif\n\n    vec4 bloom = texture(bloomTexture, v_textureCoordinates);\n    out_FragColor = glowOnly ? bloom : bloom + color;\n}\n",fz="uniform sampler2D colorTexture;\nuniform float brightness;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 rgb = texture(colorTexture, v_textureCoordinates).rgb;\n    vec3 target = vec3(0.0);\n    out_FragColor = vec4(mix(target, rgb, brightness), 1.0);\n}\n",mz="uniform sampler2D colorTexture;\nuniform float contrast;\nuniform float brightness;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 sceneColor = texture(colorTexture, v_textureCoordinates).xyz;\n    sceneColor = czm_RGBToHSB(sceneColor);\n    sceneColor.z += brightness;\n    sceneColor = czm_HSBToRGB(sceneColor);\n\n    float factor = (259.0 * (contrast + 255.0)) / (255.0 * (259.0 - contrast));\n    sceneColor = factor * (sceneColor - vec3(0.5)) + vec3(0.5);\n    out_FragColor = vec4(sceneColor, 1.0);\n}\n",gz="uniform sampler2D colorTexture;\nuniform sampler2D blurTexture;\nuniform sampler2D depthTexture;\nuniform float focalDistance;\n\nin vec2 v_textureCoordinates;\n\nvec4 toEye(vec2 uv, float depth)\n{\n   vec2 xy = vec2((uv.x * 2.0 - 1.0), ((1.0 - uv.y) * 2.0 - 1.0));\n   vec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.0);\n   posInCamera = posInCamera / posInCamera.w;\n   return posInCamera;\n}\n\nfloat computeDepthBlur(float depth)\n{\n    float f;\n    if (depth < focalDistance)\n    {\n        f = (focalDistance - depth) / (focalDistance - czm_currentFrustum.x);\n    }\n    else\n    {\n        f = (depth - focalDistance) / (czm_currentFrustum.y - focalDistance);\n        f = pow(f, 0.1);\n    }\n    f *= f;\n    f = clamp(f, 0.0, 1.0);\n    return pow(f, 0.5);\n}\n\nvoid main(void)\n{\n    float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n    vec4 posInCamera = toEye(v_textureCoordinates, depth);\n    float d = computeDepthBlur(-posInCamera.z);\n    out_FragColor = mix(texture(colorTexture, v_textureCoordinates), texture(blurTexture, v_textureCoordinates), d);\n}\n",_z="uniform sampler2D depthTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n    out_FragColor = vec4(vec3(depth), 1.0);\n}\n",yz="uniform sampler2D depthTexture;\nuniform float length;\nuniform vec4 color;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    float directions[3];\n    directions[0] = -1.0;\n    directions[1] = 0.0;\n    directions[2] = 1.0;\n\n    float scalars[3];\n    scalars[0] = 3.0;\n    scalars[1] = 10.0;\n    scalars[2] = 3.0;\n\n    float padx = czm_pixelRatio / czm_viewport.z;\n    float pady = czm_pixelRatio / czm_viewport.w;\n\n#ifdef CZM_SELECTED_FEATURE\n    bool selected = false;\n    for (int i = 0; i < 3; ++i)\n    {\n        float dir = directions[i];\n        selected = selected || czm_selected(vec2(-padx, dir * pady));\n        selected = selected || czm_selected(vec2(padx, dir * pady));\n        selected = selected || czm_selected(vec2(dir * padx, -pady));\n        selected = selected || czm_selected(vec2(dir * padx, pady));\n        if (selected)\n        {\n            break;\n        }\n    }\n    if (!selected)\n    {\n        out_FragColor = vec4(color.rgb, 0.0);\n        return;\n    }\n#endif\n\n    float horizEdge = 0.0;\n    float vertEdge = 0.0;\n\n    for (int i = 0; i < 3; ++i)\n    {\n        float dir = directions[i];\n        float scale = scalars[i];\n\n        horizEdge -= texture(depthTexture, v_textureCoordinates + vec2(-padx, dir * pady)).x * scale;\n        horizEdge += texture(depthTexture, v_textureCoordinates + vec2(padx, dir * pady)).x * scale;\n\n        vertEdge -= texture(depthTexture, v_textureCoordinates + vec2(dir * padx, -pady)).x * scale;\n        vertEdge += texture(depthTexture, v_textureCoordinates + vec2(dir * padx, pady)).x * scale;\n    }\n\n    float len = sqrt(horizEdge * horizEdge + vertEdge * vertEdge);\n    out_FragColor = vec4(color.rgb, len > length ? color.a : 0.0);\n}\n",vz="uniform sampler2D colorTexture;\n\nin vec2 v_textureCoordinates;\n\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#else\nuniform float exposure;\n#endif\n\n// See slides 142 and 143:\n//     http://www.gdcvault.com/play/1012459/Uncharted_2__HDR_Lighting\n\nvoid main()\n{\n    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);\n    vec3 color = fragmentColor.rgb;\n\n#ifdef AUTO_EXPOSURE\n    float exposure = texture(autoExposure, vec2(0.5)).r;\n    color /= exposure;\n#else\n    color *= vec3(exposure);\n#endif\n\n\tconst float A = 0.22; // shoulder strength\n\tconst float B = 0.30; // linear strength\n\tconst float C = 0.10; // linear angle\n\tconst float D = 0.20; // toe strength\n\tconst float E = 0.01; // toe numerator\n\tconst float F = 0.30; // toe denominator\n\n\tconst float white = 11.2; // linear white point value\n\n\tvec3 c = ((color * (A * color + C * B) + D * E) / (color * ( A * color + B) + D * F)) - E / F;\n\tfloat w = ((white * (A * white + C * B) + D * E) / (white * ( A * white + B) + D * F)) - E / F;\n\n\tc = czm_inverseGamma(c / w);\n\tout_FragColor = vec4(c, fragmentColor.a);\n}\n",Tz="uniform sampler2D colorTexture;\n\nin vec2 v_textureCoordinates;\n\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#else\nuniform float exposure;\n#endif\n\nvoid main()\n{\n    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);\n    vec3 color = fragmentColor.rgb;\n\n#ifdef AUTO_EXPOSURE\n    color /= texture(autoExposure, vec2(0.5)).r;\n#else\n    color *= vec3(exposure);\n#endif\n    color = czm_pbrNeutralTonemapping(color);\n    color = czm_inverseGamma(color);\n\n    out_FragColor = vec4(color, fragmentColor.a);\n}\n",bz="in vec2 v_textureCoordinates;\n\nuniform sampler2D colorTexture;\n\nconst float fxaaQualitySubpix = 0.5;\nconst float fxaaQualityEdgeThreshold = 0.125;\nconst float fxaaQualityEdgeThresholdMin = 0.0833;\n\nvoid main()\n{\n    vec2 fxaaQualityRcpFrame = vec2(1.0) / czm_viewport.zw;\n    vec4 color = FxaaPixelShader(\n        v_textureCoordinates,\n        colorTexture,\n        fxaaQualityRcpFrame,\n        fxaaQualitySubpix,\n        fxaaQualityEdgeThreshold,\n        fxaaQualityEdgeThresholdMin);\n    float alpha = texture(colorTexture, v_textureCoordinates).a;\n    out_FragColor = vec4(color.rgb, alpha);\n}\n",wz="#define SAMPLES 8\n\nuniform float delta;\nuniform float sigma;\nuniform float direction; // 0.0 for x direction, 1.0 for y direction\n\nuniform sampler2D colorTexture;\n\n#ifdef USE_STEP_SIZE\nuniform float stepSize;\n#else\nuniform vec2 step;\n#endif\n\nin vec2 v_textureCoordinates;\n\n//  Incremental Computation of the Gaussian:\n//  https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch40.html\n\nvoid main()\n{\n    vec2 st = v_textureCoordinates;\n    vec2 dir = vec2(1.0 - direction, direction);\n\n#ifdef USE_STEP_SIZE\n    vec2 step = vec2(stepSize * (czm_pixelRatio / czm_viewport.zw));\n#else\n    vec2 step = step;\n#endif\n\n    vec3 g;\n    g.x = 1.0 / (sqrt(czm_twoPi) * sigma);\n    g.y = exp((-0.5 * delta * delta) / (sigma * sigma));\n    g.z = g.y * g.y;\n\n    vec4 result = texture(colorTexture, st) * g.x;\n    for (int i = 1; i < SAMPLES; ++i)\n    {\n        g.xy *= g.yz;\n\n        vec2 offset = float(i) * dir * step;\n        result += texture(colorTexture, st - offset) * g.x;\n        result += texture(colorTexture, st + offset) * g.x;\n    }\n\n    out_FragColor = result;\n}\n",xz="uniform sampler2D colorTexture;\nuniform sampler2D dirtTexture;\nuniform sampler2D starTexture;\nuniform vec2 dirtTextureDimensions;\nuniform float distortion;\nuniform float ghostDispersal;\nuniform float haloWidth;\nuniform float dirtAmount;\nuniform float earthRadius;\nuniform float intensity;\n\nin vec2 v_textureCoordinates;\n\n// whether it is in space or not\n// 6500000.0 is empirical value\n#define DISTANCE_TO_SPACE 6500000.0\n\n// return ndc from world coordinate biased earthRadius\nvec4 getNDCFromWC(vec3 WC, float earthRadius)\n{\n    vec4 positionEC = czm_view * vec4(WC, 1.0);\n    positionEC = vec4(positionEC.x + earthRadius, positionEC.y, positionEC.z, 1.0);\n    vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\n    return czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);\n}\n\n// Check if current pixel is included Earth\n// if then mask it gradually\nfloat isInEarth(vec2 texcoord, vec2 sceneSize)\n{\n    vec2 NDC = texcoord * 2.0 - 1.0;\n    vec4 earthPosSC = getNDCFromWC(vec3(0.0), 0.0);\n    vec4 earthPosSCEdge = getNDCFromWC(vec3(0.0), earthRadius * 1.5);\n    NDC.xy -= earthPosSC.xy;\n\n    float X = abs(NDC.x) * sceneSize.x;\n    float Y = abs(NDC.y) * sceneSize.y;\n\n    return clamp(0.0, 1.0, max(sqrt(X * X + Y * Y) / max(abs(earthPosSCEdge.x * sceneSize.x), 1.0) - 0.8 , 0.0));\n}\n\n// For Chromatic effect\nvec4 textureDistorted(sampler2D tex, vec2 texcoord, vec2 direction, vec3 distortion, bool isSpace)\n{\n    vec2 sceneSize = czm_viewport.zw;\n    vec3 color;\n    if(isSpace)\n    {\n        color.r = isInEarth(texcoord + direction * distortion.r, sceneSize) * texture(tex, texcoord + direction * distortion.r).r;\n        color.g = isInEarth(texcoord + direction * distortion.g, sceneSize) * texture(tex, texcoord + direction * distortion.g).g;\n        color.b = isInEarth(texcoord + direction * distortion.b, sceneSize) * texture(tex, texcoord + direction * distortion.b).b;\n    }\n    else\n    {\n        color.r = texture(tex, texcoord + direction * distortion.r).r;\n        color.g = texture(tex, texcoord + direction * distortion.g).g;\n        color.b = texture(tex, texcoord + direction * distortion.b).b;\n    }\n    return vec4(clamp(color, 0.0, 1.0), 0.0);\n}\n\nvoid main(void)\n{\n    vec4 originalColor = texture(colorTexture, v_textureCoordinates);\n    vec3 rgb = originalColor.rgb;\n    bool isSpace = length(czm_viewerPositionWC.xyz) > DISTANCE_TO_SPACE;\n\n    // Sun position\n    vec4 sunPos = czm_morphTime == 1.0 ? vec4(czm_sunPositionWC, 1.0) : vec4(czm_sunPositionColumbusView.zxy, 1.0);\n    vec4 sunPositionEC = czm_view * sunPos;\n    vec4 sunPositionWC = czm_eyeToWindowCoordinates(sunPositionEC);\n    sunPos = czm_viewportOrthographic * vec4(sunPositionWC.xy, -sunPositionWC.z, 1.0);\n\n    // If sun is not in the screen space, use original color.\n    if(!isSpace || !((sunPos.x >= -1.1 && sunPos.x <= 1.1) && (sunPos.y >= -1.1 && sunPos.y <= 1.1)))\n    {\n        // Lens flare is disabled when not in space until #5932 is fixed.\n        //    https://github.com/CesiumGS/cesium/issues/5932\n        out_FragColor = originalColor;\n        return;\n    }\n\n    vec2 texcoord = vec2(1.0) - v_textureCoordinates;\n    vec2 pixelSize = czm_pixelRatio / czm_viewport.zw;\n    vec2 invPixelSize = 1.0 / pixelSize;\n    vec3 distortionVec = pixelSize.x * vec3(-distortion, 0.0, distortion);\n\n    // ghost vector to image centre:\n    vec2 ghostVec = (vec2(0.5) - texcoord) * ghostDispersal;\n    vec3 direction = normalize(vec3(ghostVec, 0.0));\n\n    // sample ghosts:\n    vec4 result = vec4(0.0);\n    vec4 ghost = vec4(0.0);\n    for (int i = 0; i < 4; ++i)\n    {\n        vec2 offset = fract(texcoord + ghostVec * float(i));\n        // Only bright spots from the centre of the source image\n        ghost += textureDistorted(colorTexture, offset, direction.xy, distortionVec, isSpace);\n    }\n    result += ghost;\n\n    // sample halo\n    vec2 haloVec = normalize(ghostVec) * haloWidth;\n    float weightForHalo = length(vec2(0.5) - fract(texcoord + haloVec)) / length(vec2(0.5));\n    weightForHalo = pow(1.0 - weightForHalo, 5.0);\n\n    result += textureDistorted(colorTexture, texcoord + haloVec, direction.xy, distortionVec, isSpace) * weightForHalo * 1.5;\n\n    // dirt on lens\n    vec2 dirtTexCoords = (v_textureCoordinates * invPixelSize) / dirtTextureDimensions;\n    if (dirtTexCoords.x > 1.0)\n    {\n        dirtTexCoords.x = mod(floor(dirtTexCoords.x), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.x) :  fract(dirtTexCoords.x);\n    }\n    if (dirtTexCoords.y > 1.0)\n    {\n        dirtTexCoords.y = mod(floor(dirtTexCoords.y), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.y) :  fract(dirtTexCoords.y);\n    }\n    result += dirtAmount * texture(dirtTexture, dirtTexCoords);\n\n    // Rotating starburst texture's coordinate\n    // dot(czm_view[0].xyz, vec3(0.0, 0.0, 1.0)) + dot(czm_view[1].xyz, vec3(0.0, 1.0, 0.0))\n    float camrot = czm_view[0].z + czm_view[1].y;\n    float cosValue = cos(camrot);\n    float sinValue = sin(camrot);\n    mat3 rotation = mat3(\n        cosValue, -sinValue, 0.0,\n        sinValue, cosValue, 0.0,\n        0.0, 0.0, 1.0\n    );\n\n    vec3 st1 = vec3(v_textureCoordinates * 2.0 - vec2(1.0), 1.0);\n    vec3 st2 = vec3((rotation * st1).xy, 1.0);\n    vec3 st3 = st2 * 0.5 + vec3(0.5);\n    vec2 lensStarTexcoord = st3.xy;\n    float weightForLensFlare = length(vec3(sunPos.xy, 0.0));\n    float oneMinusWeightForLensFlare = max(1.0 - weightForLensFlare, 0.0);\n\n    if (!isSpace)\n    {\n        result *= oneMinusWeightForLensFlare * intensity * 0.2;\n    }\n    else\n    {\n        result *= oneMinusWeightForLensFlare * intensity;\n        result *= texture(starTexture, lensStarTexcoord) * pow(weightForLensFlare, 1.0) * max((1.0 - length(vec3(st1.xy, 0.0))), 0.0) * 2.0;\n    }\n\n    result += texture(colorTexture, v_textureCoordinates);\n\n    out_FragColor = result;\n}\n",Cz="uniform sampler2D colorTexture;\nuniform vec3 white;\n\nin vec2 v_textureCoordinates;\n\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#else\nuniform float exposure;\n#endif\n\n// See equation 4:\n//    http://www.cs.utah.edu/~reinhard/cdrom/tonemap.pdf\n\nvoid main()\n{\n    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);\n    vec3 color = fragmentColor.rgb;\n#ifdef AUTO_EXPOSURE\n    float exposure = texture(autoExposure, vec2(0.5)).r;\n    color /= exposure;\n#else\n    color *= vec3(exposure);\n#endif\n    color = (color * (1.0 + color / white)) / (1.0 + color);\n    color = czm_inverseGamma(color);\n    out_FragColor = vec4(color, fragmentColor.a);\n}\n",Ez="uniform sampler2D colorTexture;\n\nin vec2 v_textureCoordinates;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy ,vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    float noiseValue = rand(v_textureCoordinates + sin(czm_frameNumber)) * 0.1;\n    vec3 rgb = texture(colorTexture, v_textureCoordinates).rgb;\n    vec3 green = vec3(0.0, 1.0, 0.0);\n    out_FragColor = vec4((noiseValue + rgb) * green, 1.0);\n}\n",Sz="uniform sampler2D colorTexture;\n\nin vec2 v_textureCoordinates;\n\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#else\nuniform float exposure;\n#endif\n\n// See equation 3:\n//    http://www.cs.utah.edu/~reinhard/cdrom/tonemap.pdf\n\nvoid main()\n{\n    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);\n    vec3 color = fragmentColor.rgb;\n#ifdef AUTO_EXPOSURE\n    float exposure = texture(autoExposure, vec2(0.5)).r;\n    color /= exposure;\n#else\n    color *= vec3(exposure);\n#endif\n    color = color / (1.0 + color);\n    color = czm_inverseGamma(color);\n    out_FragColor = vec4(color, fragmentColor.a);\n}\n",Iz="uniform sampler2D colorTexture;\nuniform sampler2D silhouetteTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec4 silhouetteColor = texture(silhouetteTexture, v_textureCoordinates);\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n    out_FragColor = mix(color, silhouetteColor, silhouetteColor.a);\n}\n";function Pz(){this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._ready=!1,this._name="czm_autoexposure",this._logDepthChanged=void 0,this._useLogDepth=void 0,this._framebuffers=void 0,this._previousLuminance=new at.A,this._commands=void 0,this._clearCommand=void 0,this._minMaxLuminance=new q.A,this.enabled=!0,this._enabled=!0,this.minimumLuminance=.1,this.maximumLuminance=10}function Dz(e){const t=e._framebuffers;if(!(0,d.A)(t))return;const n=t.length;for(let e=0;e<n;++e)t[e].destroy();e._framebuffers=void 0,e._previousLuminance.destroy(),e._previousLuminance=void 0}function Oz(e){const t=e._commands;if(!(0,d.A)(t))return;const n=t.length;for(let e=0;e<n;++e)t[e].shaderProgram.destroy();e._commands=void 0}function Rz(e,t){let n;if(0===t)n={colorTexture:function(){return e._colorTexture},colorTextureDimensions:function(){return e._colorTexture.dimensions}};else{const i=e._framebuffers[t-1].getColorTexture(0);n={colorTexture:function(){return i},colorTextureDimensions:function(){return i.dimensions}}}return n.minMaxLuminance=function(){return e._minMaxLuminance},n.previousLuminance=function(){return e._previousLuminance.getColorTexture(0)},n}function Mz(e,t){let n="uniform sampler2D colorTexture; \nin vec2 v_textureCoordinates; \nfloat sampleTexture(vec2 offset) { \n";return n+=0===e?"    vec4 color = texture(colorTexture, v_textureCoordinates + offset); \n    return czm_luminance(color.rgb); \n":"    return texture(colorTexture, v_textureCoordinates + offset).r; \n",n+="}\n\n",n+="uniform vec2 colorTextureDimensions; \nuniform vec2 minMaxLuminance; \nuniform sampler2D previousLuminance; \nvoid main() { \n    float color = 0.0; \n    float xStep = 1.0 / colorTextureDimensions.x; \n    float yStep = 1.0 / colorTextureDimensions.y; \n    int count = 0; \n    for (int i = 0; i < 3; ++i) { \n        for (int j = 0; j < 3; ++j) { \n            vec2 offset; \n            offset.x = -xStep + float(i) * xStep; \n            offset.y = -yStep + float(j) * yStep; \n            if (offset.x < 0.0 || offset.x > 1.0 || offset.y < 0.0 || offset.y > 1.0) { \n                continue; \n            } \n            color += sampleTexture(offset); \n            ++count; \n        } \n    } \n    if (count > 0) { \n        color /= float(count); \n    } \n",e===t-1&&(n+="    float previous = texture(previousLuminance, vec2(0.5)).r; \n    color = clamp(color, minMaxLuminance.x, minMaxLuminance.y); \n    color = previous + (color - previous) / (60.0 * 1.5); \n    color = clamp(color, minMaxLuminance.x, minMaxLuminance.y); \n"),n+="    out_FragColor = vec4(color); \n} \n",n}Object.defineProperties(Pz.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},outputTexture:{get:function(){const e=this._framebuffers;if((0,d.A)(e))return e[e.length-1].getColorTexture(0)}}}),Pz.prototype.clear=function(e){const t=this._framebuffers;if(!(0,d.A)(t))return;let n=this._clearCommand;(0,d.A)(n)||(n=this._clearCommand=new s.A({color:new u.A(0,0,0,0),framebuffer:void 0}));const i=t.length;for(let o=0;o<i;++o)t[o].clear(e,n)},Pz.prototype.update=function(e){const t=e.drawingBufferWidth,n=e.drawingBufferHeight;t===this._width&&n===this._height||(this._width=t,this._height=n,function(e,t){Dz(e);let n=e._width,i=e._height;const o=t.halfFloatingPointTexture?U.A.HALF_FLOAT:U.A.FLOAT,r=Math.ceil(Math.log(Math.max(n,i))/Math.log(3)),s=new Array(r);for(let e=0;e<r;++e)n=Math.max(Math.ceil(n/3),1),i=Math.max(Math.ceil(i/3),1),s[e]=new at.A,s[e].update(t,n,i,1,o);const a=s[r-1].getColorTexture(0);e._previousLuminance.update(t,a.width,a.height,1,o),e._framebuffers=s}(this,e),function(e,t){Oz(e);const n=e._framebuffers,i=n.length,o=new Array(i);for(let r=0;r<i;++r)o[r]=t.createViewportQuadCommand(Mz(r,i),{framebuffer:n[r].framebuffer,uniformMap:Rz(e,r)});e._commands=o}(this,e),this._ready||(this._ready=!0)),this._minMaxLuminance.x=this.minimumLuminance,this._minMaxLuminance.y=this.maximumLuminance;const i=this._framebuffers,o=i[i.length-1];i[i.length-1]=this._previousLuminance,this._commands[this._commands.length-1].framebuffer=this._previousLuminance.framebuffer,this._previousLuminance=o},Pz.prototype.execute=function(e,t){this._colorTexture=t;const n=this._commands;if(!(0,d.A)(n))return;const i=n.length;for(let t=0;t<i;++t)n[t].execute(e)},Pz.prototype.isDestroyed=function(){return!1},Pz.prototype.destroy=function(){return Dz(this),Oz(this),(0,h.A)(this)};const Lz=Pz,Nz={NEAREST:0,LINEAR:1};function Bz(e){e=e??S.A.EMPTY_OBJECT;const{name:t=(0,E.A)(),fragmentShader:n,uniforms:i,textureScale:o=1,forcePowerOfTwo:r=!1,sampleMode:s=Nz.NEAREST,pixelFormat:a=R.A.RGBA,pixelDatatype:h=U.A.UNSIGNED_BYTE,clearColor:p=u.A.BLACK,scissorRectangle:f}=e;if(l.A.typeOf.string("options.fragmentShader",n),l.A.typeOf.number.greaterThan("options.textureScale",o,0),l.A.typeOf.number.lessThanOrEquals("options.textureScale",o,1),!R.A.isColorFormat(a))throw new A.A("options.pixelFormat must be a color format.");this._fragmentShader=n,this._uniforms=i,this._textureScale=o,this._forcePowerOfTwo=r,this._sampleMode=s,this._pixelFormat=a,this._pixelDatatype=h,this._clearColor=p,this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._idTexture=void 0,this._actualUniforms={},this._dirtyUniforms=[],this._texturesToRelease=[],this._texturesToCreate=[],this._texturePromise=void 0;const m=new F;m.scissorTest={enabled:!0,rectangle:(0,d.A)(f)?c.A.clone(f):new c.A},this._passState=m,this._ready=!1,this._name=t,this._logDepthChanged=void 0,this._useLogDepth=void 0,this._selectedIdTexture=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0,this._textureCache=void 0,this._index=void 0,this.enabled=!0,this._enabled=!0}Object.defineProperties(Bz.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},fragmentShader:{get:function(){return this._fragmentShader}},uniforms:{get:function(){return this._uniforms}},textureScale:{get:function(){return this._textureScale}},forcePowerOfTwo:{get:function(){return this._forcePowerOfTwo}},sampleMode:{get:function(){return this._sampleMode}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},clearColor:{get:function(){return this._clearColor}},scissorRectangle:{get:function(){return this._passState.scissorTest.rectangle}},outputTexture:{get:function(){if((0,d.A)(this._textureCache)){const e=this._textureCache.getFramebuffer(this._name);if((0,d.A)(e))return e.getColorTexture(0)}}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}});const Fz=/uniform\s+sampler2D\s+depthTexture/g;function Uz(e,t,n){const i=t[n];return("string"==typeof i||i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof HTMLVideoElement||i instanceof ImageData)&&e._dirtyUniforms.push(n),{get:function(){return t[n]},set:function(i){const o=t[n];t[n]=i;const r=e._actualUniforms,s=r[n];(0,d.A)(s)&&s!==o&&s instanceof G.A&&!(0,d.A)(e._textureCache.getStageByName(n))&&(e._texturesToRelease.push(s),delete r[n],delete r[`${n}Dimensions`]),o instanceof G.A&&e._texturesToRelease.push(o),"string"==typeof i||i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof HTMLVideoElement||i instanceof ImageData?e._dirtyUniforms.push(n):r[n]=i}}}function kz(e,t){return function(){const n=e._actualUniforms[t];return"function"==typeof n?n():n}}function Vz(e,t){return function(){const n=e[t]();if((0,d.A)(n))return n.dimensions}}function zz(e,t){return function(n){e._texturesToCreate.push({name:t,source:n})}}function Hz(e,t){return function(){return e._textureCache.getOutputTexture(t)}}function Gz(e){(0,d.A)(e._command)&&(e._command.shaderProgram=e._command.shaderProgram&&e._command.shaderProgram.destroy(),e._command=void 0),e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy();const t=e._textureCache;if(!(0,d.A)(t))return;const n=e._uniforms,i=e._actualUniforms;for(const o in i){if(!i.hasOwnProperty(o))continue;const r=i[o];r instanceof G.A&&((0,d.A)(t.getStageByName(n[o]))||r.destroy(),e._dirtyUniforms.push(o))}}Bz.prototype._isSupported=function(e){return!Fz.test(this._fragmentShader)||e.depthTexture},Bz.prototype.update=function(e,t){if(this.enabled===this._enabled||this.enabled||Gz(this),this._enabled=this.enabled,!this._enabled)return;if(this._logDepthChanged=t!==this._useLogDepth,this._useLogDepth=t,this._selectedDirty=function(e){const t=(0,d.A)(e._selected)?e._selected.length:0,n=(0,d.A)(e._parentSelected)?e._parentSelected:0,i=e._selected!==e._selectedShadow||t!==e._selectedLength||e._parentSelected!==e._parentSelectedShadow||n!==e._parentSelectedLength;if((0,d.A)(e._selected)&&(0,d.A)(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):(0,d.A)(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!i&&(0,d.A)(e._combinedSelected)){if(!(0,d.A)(e._combinedSelectedShadow))return!0;for(let t=0;t<e._combinedSelected.length;++t)if(e._combinedSelected[t]!==e._combinedSelectedShadow[t])return!0}return i}(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=(0,d.A)(this._selected)?this._selected.length:0,this._parentSelectedLength=(0,d.A)(this._parentSelected)?this._parentSelected.length:0,function(e,t){if(!e._selectedDirty)return;e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy(),e._selectedIdTexture=void 0;const n=e._combinedSelected;if(!(0,d.A)(n))return;let i=0;for(let e=0;e<n.length;++e){const t=n[e];(0,d.A)(t.pickIds)?i+=t.pickIds.length:(0,d.A)(t.pickId)&&++i}if(0===n.length||0===i){const n=new Uint8Array([255,255,255,255]);return void(e._selectedIdTexture=new G.A({context:t,pixelFormat:R.A.RGBA,pixelDatatype:U.A.UNSIGNED_BYTE,source:{arrayBufferView:n,width:1,height:1},sampler:At.A.NEAREST}))}let o=0;const r=new Uint8Array(4*i);for(let e=0;e<n.length;++e){const t=n[e];if((0,d.A)(t.pickIds)){const e=t.pickIds,n=e.length;for(let t=0;t<n;++t){const n=e[t].color;r[o]=u.A.floatToByte(n.red),r[o+1]=u.A.floatToByte(n.green),r[o+2]=u.A.floatToByte(n.blue),r[o+3]=u.A.floatToByte(n.alpha),o+=4}}else if((0,d.A)(t.pickId)){const e=t.pickId.color;r[o]=u.A.floatToByte(e.red),r[o+1]=u.A.floatToByte(e.green),r[o+2]=u.A.floatToByte(e.blue),r[o+3]=u.A.floatToByte(e.alpha),o+=4}}e._selectedIdTexture=new G.A({context:t,pixelFormat:R.A.RGBA,pixelDatatype:U.A.UNSIGNED_BYTE,source:{arrayBufferView:r,width:i,height:1},sampler:At.A.NEAREST})}(this,e),function(e){if((0,d.A)(e._uniformMap))return;const t={},n={},i=e._uniforms,o=e._actualUniforms;for(const r in i){if(!i.hasOwnProperty(r))continue;"function"!=typeof i[r]?(t[r]=kz(e,r),n[r]=Uz(e,i,r)):(t[r]=i[r],n[r]=i[r]),o[r]=i[r];const s=t[r]();("string"==typeof s||s instanceof G.A||s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement)&&(t[`${r}Dimensions`]=Vz(t,r))}e._uniforms={},Object.defineProperties(e._uniforms,n),e._uniformMap=(0,tC.A)(t,{colorTexture:function(){return e._colorTexture},colorTextureDimensions:function(){return e._colorTexture.dimensions},depthTexture:function(){return e._depthTexture},depthTextureDimensions:function(){return e._depthTexture.dimensions},czm_idTexture:function(){return e._idTexture},czm_selectedIdTexture:function(){return e._selectedIdTexture},czm_selectedIdTextureStep:function(){return 1/e._selectedIdTexture.width}})}(this),function(e,t){const n=e._texturesToRelease;for(let e=0;e<n.length;++e){let t=n[e];t=t&&t.destroy()}n.length=0;const i=e._texturesToCreate;for(let n=0;n<i.length;++n){const{name:o,source:r}=i[n];e._actualUniforms[o]=new G.A({context:t,source:r})}i.length=0;const o=e._dirtyUniforms;if(0===o.length&&!(0,d.A)(e._texturePromise))return void(e._ready=!0);if(0===o.length||(0,d.A)(e._texturePromise))return;const r=e._uniforms,s=[];for(let t=0;t<o.length;++t){const n=o[t],i=r[n],a=e._textureCache.getStageByName(i);if((0,d.A)(a))e._actualUniforms[n]=Hz(e,i);else if("string"==typeof i){const t=new Lt.A({url:i});s.push(t.fetchImage().then(zz(e,n)))}else e._texturesToCreate.push({name:n,source:i})}o.length=0,s.length>0?(e._ready=!1,e._texturePromise=Promise.all(s).then(function(){e._ready=!0,e._texturePromise=void 0})):e._ready=!0}(this,e),function(e,t){if((0,d.A)(e._command)&&!e._logDepthChanged&&!e._selectedDirty)return;let n=e._fragmentShader;(0,d.A)(e._selectedIdTexture)&&(n=`#define CZM_SELECTED_FEATURE\nuniform sampler2D czm_idTexture;\nuniform sampler2D czm_selectedIdTexture;\nuniform float czm_selectedIdTextureStep;\nin vec2 v_textureCoordinates;\nbool czm_selected(vec2 offset)\n{\n    bool selected = false;\n    vec4 id = texture(czm_idTexture, v_textureCoordinates + offset);\n    for (int i = 0; i < ${e._selectedIdTexture.width}; ++i)\n    {\n        vec4 selectedId = texture(czm_selectedIdTexture, vec2((float(i) + 0.5) * czm_selectedIdTextureStep, 0.5));\n        if (all(equal(id, selectedId)))\n        {\n            return true;\n        }\n    }\n    return false;\n}\nbool czm_selected()\n{\n    return czm_selected(vec2(0.0));\n}\n\n${n.replace(/in\s+vec2\s+v_textureCoordinates;/g,"")}`);const i=new k.A({defines:[e._useLogDepth?"LOG_DEPTH":""],sources:[n]});e._command=t.createViewportQuadCommand(i,{uniformMap:e._uniformMap,owner:e})}(this,e),function(e){let t,n;e._sampleMode===Nz.LINEAR?(t=bt.A.LINEAR,n=Tt.A.LINEAR):(t=bt.A.NEAREST,n=Tt.A.NEAREST);const i=e._sampler;(0,d.A)(i)&&i.minificationFilter===t&&i.magnificationFilter===n||(e._sampler=new At.A({wrapS:It.A.CLAMP_TO_EDGE,wrapT:It.A.CLAMP_TO_EDGE,minificationFilter:t,magnificationFilter:n}))}(this),this._selectedDirty=!1,!this._ready)return;const n=this._textureCache.getFramebuffer(this._name);if(this._command.framebuffer=n,!(0,d.A)(n))return;const i=n.getColorTexture(0);let o;i.width===e.drawingBufferWidth&&i.height===e.drawingBufferHeight||(o=this._renderState,(0,d.A)(o)&&i.width===o.viewport.width&&i.height===o.viewport.height||(this._renderState=_.A.fromCache({viewport:new c.A(0,0,i.width,i.height)}))),this._command.renderState=o},Bz.prototype.execute=function(e,t,n,i){if(!((0,d.A)(this._command)&&(0,d.A)(this._command.framebuffer)&&this._ready&&this._enabled))return;this._colorTexture=t,this._depthTexture=n,this._idTexture=i,At.A.equals(this._colorTexture.sampler,this._sampler)||(this._colorTexture.sampler=this._sampler);const o=this.scissorRectangle.width>0&&this.scissorRectangle.height>0?this._passState:void 0;(0,d.A)(o)&&(o.context=e),this._command.execute(e,o)},Bz.prototype.isDestroyed=function(){return!1},Bz.prototype.destroy=function(){return Gz(this),(0,h.A)(this)};const Wz=Bz;function Yz(e){e=e??S.A.EMPTY_OBJECT,l.A.defined("options.stages",e.stages),l.A.typeOf.number.greaterThan("options.stages.length",e.stages.length,0),this._stages=e.stages,this._inputPreviousStageTexture=e.inputPreviousStageTexture??!0;let t=e.name;(0,d.A)(t)||(t=(0,E.A)()),this._name=t,this._uniforms=e.uniforms,this._textureCache=void 0,this._index=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0}Object.defineProperties(Yz.prototype,{ready:{get:function(){const e=this._stages,t=e.length;for(let n=0;n<t;++n)if(!e[n].ready)return!1;return!0}},name:{get:function(){return this._name}},enabled:{get:function(){return this._stages[0].enabled},set:function(e){const t=this._stages,n=t.length;for(let i=0;i<n;++i)t[i].enabled=e}},uniforms:{get:function(){return this._uniforms}},inputPreviousStageTexture:{get:function(){return this._inputPreviousStageTexture}},length:{get:function(){return this._stages.length}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}}),Yz.prototype._isSupported=function(e){const t=this._stages,n=t.length;for(let i=0;i<n;++i)if(!t[i]._isSupported(e))return!1;return!0},Yz.prototype.get=function(e){return l.A.typeOf.number.greaterThanOrEquals("index",e,0),l.A.typeOf.number.lessThan("index",e,this.length),this._stages[e]},Yz.prototype.update=function(e,t){this._selectedDirty=function(e){let t=(0,d.A)(e._selected)?e._selected.length:0;const n=(0,d.A)(e._parentSelected)?e._parentSelected:0;let i=e._selected!==e._selectedShadow||t!==e._selectedLength;if(i=i||e._parentSelected!==e._parentSelectedShadow||n!==e._parentSelectedLength,(0,d.A)(e._selected)&&(0,d.A)(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):(0,d.A)(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!i&&(0,d.A)(e._combinedSelected)){if(!(0,d.A)(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(let n=0;n<t;++n)if(e._combinedSelected[n]!==e._combinedSelectedShadow[n])return!0}return i}(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=(0,d.A)(this._selected)?this._selected.length:0,this._parentSelectedLength=(0,d.A)(this._parentSelected)?this._parentSelected.length:0;const n=this._stages,i=n.length;for(let o=0;o<i;++o){const i=n[o];this._selectedDirty&&(i.parentSelected=this._combinedSelected),i.update(e,t)}},Yz.prototype.isDestroyed=function(){return!1},Yz.prototype.destroy=function(){const e=this._stages,t=e.length;for(let n=0;n<t;++n)e[n].destroy();return(0,h.A)(this)};const qz=Yz,jz={};function Qz(e){const t=`#define USE_STEP_SIZE\n${wz}`,n=new Wz({name:`${e}_x_direction`,fragmentShader:t,uniforms:{delta:1,sigma:2,stepSize:1,direction:0},sampleMode:Nz.LINEAR}),i=new Wz({name:`${e}_y_direction`,fragmentShader:t,uniforms:{delta:1,sigma:2,stepSize:1,direction:1},sampleMode:Nz.LINEAR}),o={};return Object.defineProperties(o,{delta:{get:function(){return n.uniforms.delta},set:function(e){const t=n.uniforms,o=i.uniforms;t.delta=o.delta=e}},sigma:{get:function(){return n.uniforms.sigma},set:function(e){const t=n.uniforms,o=i.uniforms;t.sigma=o.sigma=e}},stepSize:{get:function(){return n.uniforms.stepSize},set:function(e){const t=n.uniforms,o=i.uniforms;t.stepSize=o.stepSize=e}}}),new qz({name:e,stages:[n,i],uniforms:o})}jz.createBlurStage=function(){return Qz("czm_blur")},jz.createDepthOfFieldStage=function(){const e=Qz("czm_depth_of_field_blur"),t=new Wz({name:"czm_depth_of_field_composite",fragmentShader:gz,uniforms:{focalDistance:5,blurTexture:e.name}}),n={};return Object.defineProperties(n,{focalDistance:{get:function(){return t.uniforms.focalDistance},set:function(e){t.uniforms.focalDistance=e}},delta:{get:function(){return e.uniforms.delta},set:function(t){e.uniforms.delta=t}},sigma:{get:function(){return e.uniforms.sigma},set:function(t){e.uniforms.sigma=t}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(t){e.uniforms.stepSize=t}}}),new qz({name:"czm_depth_of_field",stages:[e,t],inputPreviousStageTexture:!1,uniforms:n})},jz.isDepthOfFieldSupported=function(e){return e.context.depthTexture},jz.createEdgeDetectionStage=function(){const e=(0,E.A)();return new Wz({name:`czm_edge_detection_${e}`,fragmentShader:yz,uniforms:{length:.25,color:u.A.clone(u.A.BLACK)}})},jz.isEdgeDetectionSupported=function(e){return e.context.depthTexture},jz.createSilhouetteStage=function(e){const t=function(e){if(!(0,d.A)(e))return jz.createEdgeDetectionStage();const t=new qz({name:"czm_edge_detection_multiple",stages:e,inputPreviousStageTexture:!1}),n={};let i="",o="";for(let t=0;t<e.length;++t)i+=`uniform sampler2D edgeTexture${t}; \n`,o+=`        vec4 edge${t} = texture(edgeTexture${t}, v_textureCoordinates); \n        if (edge${t}.a > 0.0) \n        { \n            color = edge${t}; \n            break; \n        } \n`,n[`edgeTexture${t}`]=e[t].name;const r=`${i}in vec2 v_textureCoordinates; \nvoid main() { \n    vec4 color = vec4(0.0); \n    for (int i = 0; i < ${e.length}; i++) \n    { \n${o}    } \n    out_FragColor = color; \n} \n`,s=new Wz({name:"czm_edge_detection_combine",fragmentShader:r,uniforms:n});return new qz({name:"czm_edge_detection_composite",stages:[t,s]})}(e),n=new Wz({name:"czm_silhouette_color_edges",fragmentShader:Iz,uniforms:{silhouetteTexture:t.name}});return new qz({name:"czm_silhouette",stages:[t,n],inputPreviousStageTexture:!1,uniforms:t.uniforms})},jz.isSilhouetteSupported=function(e){return e.context.depthTexture},jz.createBloomStage=function(){const e=new Wz({name:"czm_bloom_contrast_bias",fragmentShader:mz,uniforms:{contrast:128,brightness:-.3}}),t=Qz("czm_bloom_blur"),n=new qz({name:"czm_bloom_contrast_bias_blur",stages:[e,t]}),i=new Wz({name:"czm_bloom_generate_composite",fragmentShader:pz,uniforms:{glowOnly:!1,bloomTexture:n.name}}),o={};return Object.defineProperties(o,{glowOnly:{get:function(){return i.uniforms.glowOnly},set:function(e){i.uniforms.glowOnly=e}},contrast:{get:function(){return e.uniforms.contrast},set:function(t){e.uniforms.contrast=t}},brightness:{get:function(){return e.uniforms.brightness},set:function(t){e.uniforms.brightness=t}},delta:{get:function(){return t.uniforms.delta},set:function(e){t.uniforms.delta=e}},sigma:{get:function(){return t.uniforms.sigma},set:function(e){t.uniforms.sigma=e}},stepSize:{get:function(){return t.uniforms.stepSize},set:function(e){t.uniforms.stepSize=e}}}),new qz({name:"czm_bloom",stages:[n,i],inputPreviousStageTexture:!1,uniforms:o})},jz.createAmbientOcclusionStage=function(){const e=new Wz({name:"czm_ambient_occlusion_generate",fragmentShader:dz,uniforms:{intensity:3,bias:.1,lengthCap:.26,directionCount:8,stepCount:32,randomTexture:void 0}}),t=new Wz({name:"czm_ambient_occlusion_composite",fragmentShader:hz,uniforms:{ambientOcclusionOnly:!1,ambientOcclusionTexture:e.name}}),n={};return Object.defineProperties(n,{intensity:{get:function(){return e.uniforms.intensity},set:function(t){e.uniforms.intensity=t}},bias:{get:function(){return e.uniforms.bias},set:function(t){e.uniforms.bias=t}},lengthCap:{get:function(){return e.uniforms.lengthCap},set:function(t){e.uniforms.lengthCap=t}},directionCount:{get:function(){return e.uniforms.directionCount},set:function(t){e.uniforms.directionCount=t}},stepCount:{get:function(){return e.uniforms.stepCount},set:function(t){e.uniforms.stepCount=t}},randomTexture:{get:function(){return e.uniforms.randomTexture},set:function(t){e.uniforms.randomTexture=t}},ambientOcclusionOnly:{get:function(){return t.uniforms.ambientOcclusionOnly},set:function(e){t.uniforms.ambientOcclusionOnly=e}}}),new qz({name:"czm_ambient_occlusion",stages:[e,t],inputPreviousStageTexture:!1,uniforms:n})},jz.isAmbientOcclusionSupported=function(e){return e.context.depthTexture};const Xz=`#define FXAA_QUALITY_PRESET 39 \n${vS}\n${bz}`;jz.createFXAAStage=function(){return new Wz({name:"czm_FXAA",fragmentShader:Xz,sampleMode:Nz.LINEAR})},jz.createAcesTonemappingStage=function(e){let t=e?"#define AUTO_EXPOSURE\n":"";return t+=uz,new Wz({name:"czm_aces",fragmentShader:t,uniforms:{autoExposure:void 0,exposure:1}})},jz.createFilmicTonemappingStage=function(e){let t=e?"#define AUTO_EXPOSURE\n":"";return t+=vz,new Wz({name:"czm_filmic",fragmentShader:t,uniforms:{autoExposure:void 0,exposure:1}})},jz.createPbrNeutralTonemappingStage=function(e){let t=e?"#define AUTO_EXPOSURE\n":"";return t+=Tz,new Wz({name:"czm_pbr_neutral",fragmentShader:t,uniforms:{autoExposure:void 0,exposure:1}})},jz.createReinhardTonemappingStage=function(e){let t=e?"#define AUTO_EXPOSURE\n":"";return t+=Sz,new Wz({name:"czm_reinhard",fragmentShader:t,uniforms:{autoExposure:void 0,exposure:1}})},jz.createModifiedReinhardTonemappingStage=function(e){let t=e?"#define AUTO_EXPOSURE\n":"";return t+=Cz,new Wz({name:"czm_modified_reinhard",fragmentShader:t,uniforms:{white:u.A.WHITE,autoExposure:void 0,exposure:1}})},jz.createAutoExposureStage=function(){return new Lz},jz.createBlackAndWhiteStage=function(){return new Wz({name:"czm_black_and_white",fragmentShader:Az,uniforms:{gradations:5}})},jz.createBrightnessStage=function(){return new Wz({name:"czm_brightness",fragmentShader:fz,uniforms:{brightness:.5}})},jz.createNightVisionStage=function(){return new Wz({name:"czm_night_vision",fragmentShader:Ez})},jz.createDepthViewStage=function(){return new Wz({name:"czm_depth_view",fragmentShader:_z})},jz.createLensFlareStage=function(){return new Wz({name:"czm_lens_flare",fragmentShader:xz,uniforms:{dirtTexture:(0,yv.A)("Assets/Textures/LensFlare/DirtMask.jpg"),starTexture:(0,yv.A)("Assets/Textures/LensFlare/StarBurst.jpg"),intensity:2,distortion:10,ghostDispersal:.4,haloWidth:.4,dirtAmount:.4,earthRadius:K.A.WGS84.maximumRadius}})};const Kz=jz;function $z(e){this._collection=e,this._framebuffers=[],this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0,this._updateDependencies=!1}function Jz(e){for(;(0,d.A)(e.length);)e=e.get(e.length-1);return e.name}function Zz(e,t,n,i,o){if(!i.enabled||!i._isSupported(t))return o;const r=n[i.name]={};(0,d.A)(o)&&(r[Jz(e.getStageByName(o))]=!0);const s=i.uniforms;if((0,d.A)(s)){const t=Object.getOwnPropertyNames(s),n=t.length;for(let i=0;i<n;++i){const n=s[t[i]];if("string"==typeof n){const t=e.getStageByName(n);(0,d.A)(t)&&(r[Jz(t)]=!0)}}}return i.name}function eH(e,t,n,i,o){if((0,d.A)(i.enabled)&&!i.enabled||(0,d.A)(i._isSupported)&&!i._isSupported(t))return o;const r=o,s=!(0,d.A)(i.inputPreviousStageTexture)||i.inputPreviousStageTexture;let a=o;const c=i.length;for(let r=0;r<c;++r){const c=i.get(r);a=(0,d.A)(c.length)?eH(e,t,n,c,o):Zz(e,t,n,c,o),s&&(o=a)}let l,u;if(s)for(l=1;l<c;++l)u=Jz(i.get(l)),(0,d.A)(n[u])||(n[u]={}),n[u][r]=!0;else for(l=1;l<c;++l){u=Jz(i.get(l));const e=n[u];for(let t=0;t<l;++t)e[Jz(i.get(t))]=!0}return a}function tH(e,t,n){const i=e._collection.getStageByName(t),o=i._textureScale,r=i._forcePowerOfTwo,s=i._pixelFormat,a=i._pixelDatatype,c=i._clearColor;let l,h;const A=e._framebuffers,p=A.length;for(l=0;l<p;++l){if(h=A[l],o!==h.textureScale||r!==h.forcePowerOfTwo||s!==h.pixelFormat||a!==h.pixelDatatype||!u.A.equals(c,h.clearColor))continue;const e=h.stages,t=e.length;let i=!1;for(let o=0;o<t;++o)if(n[e[o]]){i=!0;break}if(!i)break}return(0,d.A)(h)&&l<p?(h.stages.push(t),h):(h={textureScale:o,forcePowerOfTwo:r,pixelFormat:s,pixelDatatype:a,clearColor:c,stages:[t],buffer:new at.A({pixelFormat:s,pixelDatatype:a}),clear:void 0},A.push(h),h)}function nH(e){const t=e._framebuffers,n=t.length;for(let e=0;e<n;++e)t[e].buffer.destroy()}$z.prototype.updateDependencies=function(){this._updateDependencies=!0},$z.prototype.update=function(e){const t=this._collection,n=this._updateDependencies,i=(0,d.A)(t.ambientOcclusion)&&t.ambientOcclusion.enabled&&t.ambientOcclusion._isSupported(e),o=(0,d.A)(t.bloom)&&t.bloom.enabled&&t.bloom._isSupported(e),r=(0,d.A)(t._tonemapping)&&t._tonemapping.enabled&&t._tonemapping._isSupported(e),a=(0,d.A)(t.fxaa)&&t.fxaa.enabled&&t.fxaa._isSupported(e),c=!(0,d.A)(t._activeStages)||t._activeStages.length>0||i||o||r||a;if((n||!c&&this._framebuffers.length>0)&&(nH(this),this._framebuffers.length=0,this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0),!n&&!c)return;0===this._framebuffers.length&&function(e,t){const n=function(e,t){const n={};if((0,d.A)(e.ambientOcclusion)){const i=e.ambientOcclusion,o=e.bloom,r=e._tonemapping,s=e.fxaa;let a=eH(e,t,n,i,void 0);a=eH(e,t,n,o,a),a=Zz(e,t,n,r,a),a=eH(e,t,n,e,a),Zz(e,t,n,s,a)}else eH(e,t,n,e,void 0);return n}(e._collection,t);for(const t in n)n.hasOwnProperty(t)&&(e._stageNameToFramebuffer[t]=tH(e,t,n[t]))}(this,e);const l=e.drawingBufferWidth,u=e.drawingBufferHeight,h=this._width!==l||this._height!==u;(n||h)&&(this._width=l,this._height=u,this._updateDependencies=!1,nH(this),function(e,t){const n=e._width,i=e._height,o=e._framebuffers,r=o.length;for(let e=0;e<r;++e){const r=o[e],a=r.textureScale;let c=Math.ceil(n*a),l=Math.ceil(i*a),u=Math.min(c,l);r.forcePowerOfTwo&&(J.A.isPowerOfTwo(u)||(u=J.A.nextPowerOfTwo(u)),c=u,l=u),r.buffer.update(t,c,l),r.clear=new s.A({color:r.clearColor,framebuffer:r.buffer.framebuffer})}}(this,e))},$z.prototype.clear=function(e){const t=this._framebuffers;for(let n=0;n<t.length;++n)t[n].clear.execute(e)},$z.prototype.getStageByName=function(e){return this._collection.getStageByName(e)},$z.prototype.getOutputTexture=function(e){return this._collection.getOutputTexture(e)},$z.prototype.getFramebuffer=function(e){const t=this._stageNameToFramebuffer[e];if((0,d.A)(t))return t.buffer.framebuffer},$z.prototype.isDestroyed=function(){return!1},$z.prototype.destroy=function(){return nH(this),(0,h.A)(this)};const iH=$z,oH={REINHARD:"REINHARD",MODIFIED_REINHARD:"MODIFIED_REINHARD",FILMIC:"FILMIC",ACES:"ACES",PBR_NEUTRAL:"PBR_NEUTRAL"},rH=Object.freeze(oH),sH=[];function aH(){const e=Kz.createFXAAStage(),t=Kz.createAmbientOcclusionStage(),n=Kz.createBloomStage();this._autoExposureEnabled=!1,this._autoExposure=Kz.createAutoExposureStage(),this._exposure=1,this._tonemapping=void 0,this._tonemapper=void 0,this.tonemapper=rH.PBR_NEUTRAL;const i=this._tonemapping;e.enabled=!1,t.enabled=!1,n.enabled=!1,i.enabled=!1;const o=new iH(this),r={},s=sH;for(s.push(e,t,n,i);s.length>0;){const e=s.pop();r[e.name]=e,e._textureCache=o;const t=e.length;if((0,d.A)(t))for(let n=0;n<t;++n)s.push(e.get(n))}this._stages=[],this._activeStages=[],this._previousActiveStages=[],this._randomTexture=void 0;const a=this;t.uniforms.randomTexture=function(){return a._randomTexture},this._ao=t,this._bloom=n,this._fxaa=e,this._aoEnabled=void 0,this._bloomEnabled=void 0,this._tonemappingEnabled=void 0,this._fxaaEnabled=void 0,this._activeStagesChanged=!1,this._stagesRemoved=!1,this._textureCacheDirty=!1,this._stageNames=r,this._textureCache=o}function cH(e){if(!e._stagesRemoved)return;e._stagesRemoved=!1;const t=[],n=e._stages;for(let e=0,i=0;e<n.length;++e){const o=n[e];o&&(o._index=i++,t.push(o))}e._stages=t}function lH(e){for(;(0,d.A)(e.length);)e=e.get(e.length-1);return e.outputTexture}function uH(e,t,n,i,o){if((0,d.A)(e.execute))e.execute(t,n,i,o);else if(e.inputPreviousStageTexture){uH(e.get(0),t,n,i,o);for(let n=1;n<e.length;++n)uH(e.get(n),t,lH(e.get(n-1)),i,o)}else for(let r=0;r<e.length;++r)uH(e.get(r),t,n,i,o)}Object.defineProperties(aH.prototype,{ready:{get:function(){let e=!1;const t=this._stages;for(let n=t.length-1;n>=0;--n){const i=t[n];e=e||i.ready&&i.enabled}const n=this._fxaa,i=this._ao,o=this._bloom,r=this._tonemapping;return e=e||n.ready&&n.enabled,e=e||i.ready&&i.enabled,e=e||o.ready&&o.enabled,e=e||r.ready&&r.enabled,e}},fxaa:{get:function(){return this._fxaa}},ambientOcclusion:{get:function(){return this._ao}},bloom:{get:function(){return this._bloom}},length:{get:function(){return cH(this),this._stages.length}},outputTexture:{get:function(){const e=this._fxaa;if(e.enabled&&e.ready)return this.getOutputTexture(e.name);const t=this._stages;for(let e=t.length-1;e>=0;--e){const n=t[e];if((0,d.A)(n)&&n.ready&&n.enabled)return this.getOutputTexture(n.name)}const n=this._tonemapping;if(n.enabled&&n.ready)return this.getOutputTexture(n.name);const i=this._bloom;if(i.enabled&&i.ready)return this.getOutputTexture(i.name);const o=this._ao;return o.enabled&&o.ready?this.getOutputTexture(o.name):void 0}},hasSelected:{get:function(){const e=this._stages.slice();for(;e.length>0;){const t=e.pop();if(!(0,d.A)(t))continue;if((0,d.A)(t.selected))return!0;const n=t.length;if((0,d.A)(n))for(let i=0;i<n;++i)e.push(t.get(i))}return!1}},tonemapper:{get:function(){return this._tonemapper},set:function(e){if(this._tonemapper===e)return;if((t=e)!==oH.REINHARD&&t!==oH.MODIFIED_REINHARD&&t!==oH.FILMIC&&t!==oH.ACES&&t!==oH.PBR_NEUTRAL)throw new A.A("tonemapper was set to an invalid value.");var t;(0,d.A)(this._tonemapping)&&(delete this._stageNames[this._tonemapping.name],this._tonemapping.destroy());const n=this._autoExposureEnabled;let i;switch(e){case rH.REINHARD:i=Kz.createReinhardTonemappingStage(n);break;case rH.MODIFIED_REINHARD:i=Kz.createModifiedReinhardTonemappingStage(n);break;case rH.FILMIC:i=Kz.createFilmicTonemappingStage(n);break;case rH.PBR_NEUTRAL:i=Kz.createPbrNeutralTonemappingStage(n);break;default:i=Kz.createAcesTonemappingStage(n)}if(n){const e=this._autoExposure;i.uniforms.autoExposure=function(){return e.outputTexture}}else i.uniforms.exposure=this._exposure;this._tonemapper=e,this._tonemapping=i,(0,d.A)(this._stageNames)&&(this._stageNames[i.name]=i,i._textureCache=this._textureCache),this._textureCacheDirty=!0}},exposure:{get:function(){return this._exposure},set:function(e){this._tonemapping.uniforms.exposure=e,this._exposure=e}}}),aH.prototype.add=function(e){l.A.typeOf.object("stage",e);const t=this._stageNames,n=sH;for(n.push(e);n.length>0;){const e=n.pop();if((0,d.A)(t[e.name]))throw new A.A(`${e.name} has already been added to the collection or does not have a unique name.`);t[e.name]=e,e._textureCache=this._textureCache;const i=e.length;if((0,d.A)(i))for(let t=0;t<i;++t)n.push(e.get(t))}const i=this._stages;return e._index=i.length,i.push(e),this._textureCacheDirty=!0,e},aH.prototype.remove=function(e){if(!this.contains(e))return!1;const t=this._stageNames,n=sH;for(n.push(e);n.length>0;){const e=n.pop();delete t[e.name];const i=e.length;if((0,d.A)(i))for(let t=0;t<i;++t)n.push(e.get(t))}return this._stages[e._index]=void 0,this._stagesRemoved=!0,this._textureCacheDirty=!0,e._index=void 0,e._textureCache=void 0,e.destroy(),!0},aH.prototype.contains=function(e){return(0,d.A)(e)&&(0,d.A)(e._index)&&e._textureCache===this._textureCache},aH.prototype.get=function(e){cH(this);const t=this._stages,n=t.length;return l.A.typeOf.number.greaterThanOrEquals("stages length",n,0),l.A.typeOf.number.greaterThanOrEquals("index",e,0),l.A.typeOf.number.lessThan("index",e,n),t[e]},aH.prototype.removeAll=function(){const e=this._stages,t=e.length;for(let n=0;n<t;++n)this.remove(e[n]);e.length=0},aH.prototype.getStageByName=function(e){return this._stageNames[e]},aH.prototype.update=function(e,t,n){cH(this);const i=this._activeStages,o=this._activeStages=this._previousActiveStages;this._previousActiveStages=i;const r=this._stages;o.length=r.length;let s=0;for(let t=0;t<r.length;++t){const n=r[t];n.ready&&n.enabled&&n._isSupported(e)&&(o[s++]=n)}o.length=s;let a=s!==i.length;if(!a)for(let e=0;e<s;++e)if(o[e]!==i[e]){a=!0;break}const c=this._ao,l=this._bloom,u=this._autoExposure,h=this._tonemapping,A=this._fxaa;h.enabled=n;const p=c.enabled&&c._isSupported(e),f=l.enabled&&l._isSupported(e),m=h.enabled&&h._isSupported(e),g=A.enabled&&A._isSupported(e);if((a||this._textureCacheDirty||p!==this._aoEnabled||f!==this._bloomEnabled||m!==this._tonemappingEnabled||g!==this._fxaaEnabled)&&(this._textureCache.updateDependencies(),this._aoEnabled=p,this._bloomEnabled=f,this._tonemappingEnabled=m,this._fxaaEnabled=g,this._textureCacheDirty=!1),(0,d.A)(this._randomTexture)&&!p&&(this._randomTexture.destroy(),this._randomTexture=void 0),!(0,d.A)(this._randomTexture)&&p){const t=196608,n=new Uint8Array(t);for(let e=0;e<t;e+=3)n[e]=Math.floor(255*Math.random());this._randomTexture=new G.A({context:e,pixelFormat:R.A.RGB,pixelDatatype:U.A.UNSIGNED_BYTE,source:{arrayBufferView:n,width:256,height:256},sampler:new At.A({wrapS:It.A.REPEAT,wrapT:It.A.REPEAT,minificationFilter:bt.A.NEAREST,magnificationFilter:Tt.A.NEAREST})})}this._textureCache.update(e),A.update(e,t),c.update(e,t),l.update(e,t),h.update(e,t),this._autoExposureEnabled&&u.update(e,t);for(let n=0;n<r.length;++n)r[n].update(e,t);s=0;for(let t=0;t<r.length;++t){const n=r[t];n.ready&&n.enabled&&n._isSupported(e)&&s++}a=s!==o.length,a&&this.update(e,t,n)},aH.prototype.clear=function(e){this._textureCache.clear(e),this._autoExposureEnabled&&this._autoExposure.clear(e)},aH.prototype.getOutputTexture=function(e){const t=this.getStageByName(e);if((0,d.A)(t))return lH(t)},aH.prototype.execute=function(e,t,n,i){const o=this._activeStages,r=o.length,s=this._fxaa,a=this._ao,c=this._bloom,l=this._autoExposure,u=this._tonemapping,d=a.enabled&&a._isSupported(e),h=c.enabled&&c._isSupported(e),A=this._autoExposureEnabled,p=u.enabled&&u._isSupported(e),f=s.enabled&&s._isSupported(e);if(!(f||d||h||p||0!==r))return;let m=t;d&&a.ready&&(uH(a,e,m,n,i),m=lH(a)),h&&c.ready&&(uH(c,e,m,n,i),m=lH(c)),A&&l.ready&&uH(l,e,m,n,i),p&&u.ready&&(uH(u,e,m,n,i),m=lH(u));let g=m;if(r>0){uH(o[0],e,m,n,i);for(let t=1;t<r;++t)uH(o[t],e,lH(o[t-1]),n,i);g=lH(o[r-1])}f&&s.ready&&uH(s,e,g,n,i)},aH.prototype.copy=function(e,t){if(!(0,d.A)(this._copyColorCommand)){const t=this;this._copyColorCommand=e.createViewportQuadCommand(EU,{uniformMap:{colorTexture:function(){return t.outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},aH.prototype.isDestroyed=function(){return!1},aH.prototype.destroy=function(){return this._fxaa.destroy(),this._ao.destroy(),this._bloom.destroy(),this._autoExposure.destroy(),this._tonemapping.destroy(),this.removeAll(),this._textureCache=this._textureCache&&this._textureCache.destroy(),(0,h.A)(this)};const dH=aH;function hH(e){l.A.typeOf.object("scene",e),this._scene=e,this._currentTweens=[],this._morphHandler=void 0,this._morphCancelled=!1,this._completeMorph=void 0,this._morphToOrthographic=!1}hH.prototype.completeMorph=function(){(0,d.A)(this._completeMorph)&&this._completeMorph()},hH.prototype.morphTo2D=function(e,t){(0,d.A)(this._completeMorph)&&this._completeMorph();const n=this._scene;this._previousMode=n.mode,this._morphToOrthographic=n.camera.frustum instanceof ee.A,this._previousMode!==Ce.A.SCENE2D&&this._previousMode!==Ce.A.MORPHING&&(this._scene.morphStart.raiseEvent(this,this._previousMode,Ce.A.SCENE2D,!0),n._mode=Ce.A.MORPHING,n.camera._setTransform(O.A.IDENTITY),this._previousMode===Ce.A.COLUMBUS_VIEW?function(e,t){t*=.5;const n=e._scene,i=n.camera,o=j.A.clone(i.position,XH),r=j.A.clone(i.direction,KH),s=j.A.clone(i.up,$H),a=j.A.negate(j.A.UNIT_Z,ZH),c=j.A.clone(j.A.UNIT_Y,eG),l=JH;if(t>0)j.A.clone(j.A.ZERO,JH),l.z=5*n.ellipsoid.maximumRadius;else{j.A.clone(o,JH);const e=nG;O.A.multiplyByPoint(UB.A.TRANSFORM_2D,o,e.origin),O.A.multiplyByPointAsVector(UB.A.TRANSFORM_2D,r,e.direction);const t=n.globe;if((0,d.A)(t)){const i=t.pickWorldCoordinates(e,n,!0,iG);(0,d.A)(i)&&(O.A.multiplyByPoint(UB.A.TRANSFORM_2D_INVERSE,i,l),l.z+=j.A.distance(o,l))}}const u=tG;u.right=.5*l.z,u.left=-u.right,u.top=u.right*(n.drawingBufferHeight/n.drawingBufferWidth),u.bottom=-u.top;const h=oG;h.position=l,h.direction=a,h.up=c,h.frustum=u;const A=mG(h);function p(e,t){e.position.z=t}SH(e,A);const f=n.tweens.add({duration:t,easingFunction:nC.A.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){jH(o,l,e.time,i.position),jH(r,a,e.time,i.direction),jH(s,c,e.time,i.up),j.A.cross(i.direction,i.up,i.right),j.A.normalize(i.right,i.right),i._adjustOrthographicFrustum(!0)},complete:function(){QH(e,t,h,p,A)}});e._currentTweens.push(f)}(this,e):function(e,t,n){t*=.5;const i=e._scene,o=i.camera,r=sG;if(t>0)j.A.clone(j.A.ZERO,r.position),r.position.z=5*n.maximumRadius,j.A.negate(j.A.UNIT_Z,r.direction),j.A.clone(j.A.UNIT_Y,r.up);else{n.cartesianToCartographic(o.positionWC,rG),i.mapProjection.project(rG,r.position),j.A.negate(j.A.UNIT_Z,r.direction),j.A.clone(j.A.UNIT_Y,r.up);const e=lG;j.A.clone(r.position2D,e.origin);const t=j.A.clone(o.directionWC,e.direction),s=n.scaleToGeodeticSurface(o.positionWC,dG),a=xe.A.eastNorthUpToFixedFrame(s,n,uG);O.A.inverseTransformation(a,a),O.A.multiplyByPointAsVector(a,t,t),O.A.multiplyByPointAsVector(UB.A.TRANSFORM_2D,t,t);const c=i.globe;if((0,d.A)(c)){const t=c.pickWorldCoordinates(e,i,!0,cG);if((0,d.A)(t)){const e=j.A.distance(r.position2D,t);t.x+=e,j.A.clone(t,r.position2D)}}}function s(e,t){e.position.x=t}O.A.multiplyByPoint(UB.A.TRANSFORM_2D,r.position,r.position2D),O.A.multiplyByPointAsVector(UB.A.TRANSFORM_2D,r.direction,r.direction2D),O.A.multiplyByPointAsVector(UB.A.TRANSFORM_2D,r.up,r.up2D);const a=r.frustum;a.right=.5*r.position.z,a.left=-a.right,a.top=a.right*(i.drawingBufferHeight/i.drawingBufferWidth),a.bottom=-a.top;const c=aG;O.A.multiplyByPoint(UB.A.TRANSFORM_2D_INVERSE,r.position2D,c.position),j.A.clone(r.direction,c.direction),j.A.clone(r.up,c.up),c.frustum=a;const l=mG(c);SH(e,l),AG(e,t,r,function(){QH(e,t,r,s,l)})}(this,e,t),0===e&&(0,d.A)(this._completeMorph)&&this._completeMorph())};const AH=new j.A,pH=new j.A,fH=new j.A,mH=new j.A,gH=new j.A,_H=new j.A,yH=new j.A,vH=new X.A,TH=new O.A,bH=new uP.A,wH=new ee.A,xH={position:void 0,direction:void 0,up:void 0,position2D:void 0,direction2D:void 0,up2D:void 0,frustum:void 0};hH.prototype.morphToColumbusView=function(e,t){(0,d.A)(this._completeMorph)&&this._completeMorph();const n=this._scene;if(this._previousMode=n.mode,this._previousMode===Ce.A.COLUMBUS_VIEW||this._previousMode===Ce.A.MORPHING)return;this._scene.morphStart.raiseEvent(this,this._previousMode,Ce.A.COLUMBUS_VIEW,!0),n.camera._setTransform(O.A.IDENTITY);let i=AH;const o=pH,r=fH;if(e>0)i.x=0,i.y=-1,i.z=1,i=j.A.multiplyByScalar(j.A.normalize(i,i),5*t.maximumRadius,i),j.A.negate(j.A.normalize(i,o),o),j.A.cross(j.A.UNIT_X,o,r);else{const e=n.camera;if(this._previousMode===Ce.A.SCENE2D)j.A.clone(e.position,i),i.z=e.frustum.right-e.frustum.left,j.A.negate(j.A.UNIT_Z,o),j.A.clone(j.A.UNIT_Y,r);else{j.A.clone(e.positionWC,i),j.A.clone(e.directionWC,o),j.A.clone(e.upWC,r);const s=t.scaleToGeodeticSurface(i,yH),a=xe.A.eastNorthUpToFixedFrame(s,t,TH);O.A.inverseTransformation(a,a),n.mapProjection.project(t.cartesianToCartographic(i,vH),i),O.A.multiplyByPointAsVector(a,o,o),O.A.multiplyByPointAsVector(a,r,r)}}let s;this._morphToOrthographic?(s=wH,s.width=n.camera.frustum.right-n.camera.frustum.left,s.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight):(s=bH,s.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight,s.fov=J.A.toRadians(60));const a=xH;a.position=i,a.direction=o,a.up=r,a.frustum=s;const c=function(e){return function(t){const n=t._scene;n._mode=Ce.A.COLUMBUS_VIEW,n.morphTime=Ce.A.getMorphTime(Ce.A.COLUMBUS_VIEW),IH(t);const i=n.camera;(t._previousModeMode!==Ce.A.MORPHING||t._morphCancelled)&&(t._morphCancelled=!1,j.A.clone(e.position,i.position),j.A.clone(e.direction,i.direction),j.A.clone(e.up,i.up),j.A.cross(i.direction,i.up,i.right),j.A.normalize(i.right,i.right));const o=i.frustum;n.frameState.useLogDepth&&(o.near=.1,o.far=1e10);const r=(0,d.A)(t._completeMorph);t._completeMorph=void 0,n.camera.update(n.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,Ce.A.COLUMBUS_VIEW,r)}}(a);SH(this,c),this._previousMode===Ce.A.SCENE2D?function(e,t,n,i){t*=.5;const o=e._scene,r=o.camera,s=j.A.clone(n.position,WH),a=j.A.clone(n.direction,YH),c=j.A.clone(n.up,qH);function l(){r.frustum=n.frustum.clone();const l=j.A.clone(r.position,zH),u=j.A.clone(r.direction,HH),d=j.A.clone(r.up,GH);l.z=s.z;const h=o.tweens.add({duration:t,easingFunction:nC.A.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){jH(l,s,e.time,r.position),jH(u,a,e.time,r.direction),jH(d,c,e.time,r.up),j.A.cross(r.direction,r.up,r.right),j.A.normalize(r.right,r.right)},complete:function(){i(e)}});e._currentTweens.push(h)}o._mode=Ce.A.MORPHING,e._morphToOrthographic?l():hG(e,0,n,l)}(this,e,a,c):(a.position2D=O.A.multiplyByPoint(UB.A.TRANSFORM_2D,i,mH),a.direction2D=O.A.multiplyByPointAsVector(UB.A.TRANSFORM_2D,o,gH),a.up2D=O.A.multiplyByPointAsVector(UB.A.TRANSFORM_2D,r,_H),n._mode=Ce.A.MORPHING,AG(this,e,a,c)),0===e&&(0,d.A)(this._completeMorph)&&this._completeMorph()};const CH={position:new j.A,direction:new j.A,up:new j.A,frustum:void 0},EH=new uP.A;function SH(e,t){if(e._scene.completeMorphOnUserInput){e._morphHandler=new bR.A(e._scene.canvas);const n=function(){e._morphCancelled=!0,e._scene.camera.cancelFlight(),t(e)};e._completeMorph=n,e._morphHandler.setInputAction(n,wR.A.LEFT_DOWN),e._morphHandler.setInputAction(n,wR.A.MIDDLE_DOWN),e._morphHandler.setInputAction(n,wR.A.RIGHT_DOWN),e._morphHandler.setInputAction(n,wR.A.WHEEL)}}function IH(e){const t=e._currentTweens;for(let e=0;e<t.length;++e)t[e].cancelTween();e._currentTweens.length=0,e._morphHandler=e._morphHandler&&e._morphHandler.destroy()}hH.prototype.morphTo3D=function(e,t){(0,d.A)(this._completeMorph)&&this._completeMorph();const n=this._scene;if(this._previousMode=n.mode,this._previousMode!==Ce.A.SCENE3D&&this._previousMode!==Ce.A.MORPHING){if(this._scene.morphStart.raiseEvent(this,this._previousMode,Ce.A.SCENE3D,!0),n._mode=Ce.A.MORPHING,n.camera._setTransform(O.A.IDENTITY),this._previousMode===Ce.A.SCENE2D)!function(e,t,n){t/=3;const i=e._scene,o=i.camera;let r,s;t>0?(r=CH,j.A.fromDegrees(0,0,5*n.maximumRadius,n,r.position),j.A.negate(r.position,r.direction),j.A.normalize(r.direction,r.direction),j.A.clone(j.A.UNIT_Z,r.up)):(o.position.z=o.frustum.right-o.frustum.left,r=RH(e,n)),e._morphToOrthographic?(s=VH,s.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight,s.width=o.frustum.right-o.frustum.left):(s=EH,s.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight,s.fov=J.A.toRadians(60)),r.frustum=s;const a=fG(r);let c;SH(e,a),c=e._morphToOrthographic?function(){kH(e,t,r,a)}:function(){hG(e,t,r,function(){kH(e,t,r,a)})},t>0?(i._mode=Ce.A.SCENE2D,o.flyTo({duration:t,destination:j.A.fromDegrees(0,0,5*n.maximumRadius,n,WH),complete:function(){i._mode=Ce.A.MORPHING,c()}})):c()}(this,e,t);else{let i,o;e>0?(i=CH,j.A.fromDegrees(0,0,5*t.maximumRadius,t,i.position),j.A.negate(i.position,i.direction),j.A.normalize(i.direction,i.direction),j.A.clone(j.A.UNIT_Z,i.up)):i=RH(this,t);const r=n.camera;r.frustum instanceof ee.A?o=r.frustum.clone():(o=EH,o.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight,o.fov=J.A.toRadians(60)),i.frustum=o;const s=fG(i);SH(this,s),kH(this,e,i,s)}0===e&&(0,d.A)(this._completeMorph)&&this._completeMorph()}},hH.prototype.isDestroyed=function(){return!1},hH.prototype.destroy=function(){return IH(this),(0,h.A)(this)};const PH=new X.A,DH=new j.A,OH=new O.A;function RH(e,t){const n=e._scene,i=n.camera,o=CH,r=o.position,s=o.direction,a=o.up,c=n.mapProjection.unproject(i.position,PH);t.cartographicToCartesian(c,r);const l=t.scaleToGeodeticSurface(r,DH),u=xe.A.eastNorthUpToFixedFrame(l,t,OH);return O.A.multiplyByPointAsVector(u,i.direction,s),O.A.multiplyByPointAsVector(u,i.up,a),o}const MH=new j.A,LH=new j.A,NH=new j.A,BH=new j.A,FH=new j.A,UH=new j.A;function kH(e,t,n,i){t*=.5;const o=e._scene,r=o.camera,s=j.A.clone(r.position,MH),a=j.A.clone(r.direction,LH),c=j.A.clone(r.up,NH),l=O.A.multiplyByPoint(UB.A.TRANSFORM_2D_INVERSE,n.position,BH),u=O.A.multiplyByPointAsVector(UB.A.TRANSFORM_2D_INVERSE,n.direction,FH),d=O.A.multiplyByPointAsVector(UB.A.TRANSFORM_2D_INVERSE,n.up,UH),h=o.tweens.add({duration:t,easingFunction:nC.A.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){jH(s,l,e.time,r.position),jH(a,u,e.time,r.direction),jH(c,d,e.time,r.up),j.A.cross(r.direction,r.up,r.right),j.A.normalize(r.right,r.right)},complete:function(){pG(e,o,0,1,t,i)}});e._currentTweens.push(h)}const VH=new ee.A,zH=new j.A,HH=new j.A,GH=new j.A,WH=new j.A,YH=new j.A,qH=new j.A;function jH(e,t,n,i){return j.A.lerp(e,t,n,i)}function QH(e,t,n,i,o){const r=e._scene,s=r.camera;if(s.frustum instanceof ee.A)return;const a=s.frustum.fov,c=.5*J.A.RADIANS_PER_DEGREE,l=n.position.z*Math.tan(.5*a);s.frustum.far=l/Math.tan(.5*c)+1e7;const u=r.tweens.add({duration:t,easingFunction:nC.A.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){s.frustum.fov=J.A.lerp(a,c,e.time);const t=l/Math.tan(.5*s.frustum.fov);i(s,t)},complete:function(){s.frustum=n.frustum.clone(),o(e)}});e._currentTweens.push(u)}const XH=new j.A,KH=new j.A,$H=new j.A,JH=new j.A,ZH=new j.A,eG=new j.A,tG=new aR.A,nG=new _R.A,iG=new j.A,oG={position:void 0,direction:void 0,up:void 0,frustum:void 0},rG=new X.A,sG={position:new j.A,direction:new j.A,up:new j.A,position2D:new j.A,direction2D:new j.A,up2D:new j.A,frustum:new aR.A},aG={position:new j.A,direction:new j.A,up:new j.A,frustum:void 0},cG=new j.A,lG=new _R.A,uG=new O.A,dG=new j.A;function hG(e,t,n,i){const o=e._scene,r=o.camera,s=r.frustum.right-r.frustum.left;r.frustum=n.frustum.clone();const a=r.frustum.fov,c=.5*J.A.RADIANS_PER_DEGREE,l=s*Math.tan(.5*a);r.frustum.far=l/Math.tan(.5*c)+1e7,r.frustum.fov=c;const u=o.tweens.add({duration:t,easingFunction:nC.A.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){r.frustum.fov=J.A.lerp(c,a,e.time),r.position.z=l/Math.tan(.5*r.frustum.fov)},complete:function(){i(e)}});e._currentTweens.push(u)}function AG(e,t,n,i){const o=e._scene,r=o.camera,s=j.A.clone(r.position,zH),a=j.A.clone(r.direction,HH),c=j.A.clone(r.up,GH),l=j.A.clone(n.position2D,WH),u=j.A.clone(n.direction2D,YH),d=j.A.clone(n.up2D,qH),h=o.tweens.add({duration:t,easingFunction:nC.A.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){jH(s,l,e.time,r.position),jH(a,u,e.time,r.direction),jH(c,d,e.time,r.up),j.A.cross(r.direction,r.up,r.right),j.A.normalize(r.right,r.right),r._adjustOrthographicFrustum(!0)},complete:function(){pG(e,o,1,0,t,i)}});e._currentTweens.push(h)}function pG(e,t,n,i,o,r){const s={object:t,property:"morphTime",startValue:n,stopValue:i,duration:o,easingFunction:nC.A.QUARTIC_OUT};(0,d.A)(r)&&(s.complete=function(){r(e)});const a=t.tweens.addProperty(s);e._currentTweens.push(a)}function fG(e){return function(t){const n=t._scene;n._mode=Ce.A.SCENE3D,n.morphTime=Ce.A.getMorphTime(Ce.A.SCENE3D),IH(t);const i=n.camera;(t._previousMode!==Ce.A.MORPHING||t._morphCancelled)&&(t._morphCancelled=!1,j.A.clone(e.position,i.position),j.A.clone(e.direction,i.direction),j.A.clone(e.up,i.up),j.A.cross(i.direction,i.up,i.right),j.A.normalize(i.right,i.right),i.frustum=e.frustum.clone());const o=i.frustum;n.frameState.useLogDepth&&(o.near=.1,o.far=1e10);const r=(0,d.A)(t._completeMorph);t._completeMorph=void 0,n.camera.update(n.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,Ce.A.SCENE3D,r)}}function mG(e){return function(t){const n=t._scene;n._mode=Ce.A.SCENE2D,n.morphTime=Ce.A.getMorphTime(Ce.A.SCENE2D),IH(t);const i=n.camera;j.A.clone(e.position,i.position),i.position.z=2*n.ellipsoid.maximumRadius,j.A.clone(e.direction,i.direction),j.A.clone(e.up,i.up),j.A.cross(i.direction,i.up,i.right),j.A.normalize(i.right,i.right),i.frustum=e.frustum.clone();const o=(0,d.A)(t._completeMorph);t._completeMorph=void 0,n.camera.update(n.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,Ce.A.SCENE2D,o)}}const gG=hH,_G=Object.freeze({LEFT_DRAG:0,RIGHT_DRAG:1,MIDDLE_DRAG:2,WHEEL:3,PINCH:4});function yG(e,t){let n=`${e}`;return(0,d.A)(t)&&(n+=`+${t}`),n}function vG(e,t,n){const i=yG(_G.PINCH,t),o=e._update,r=e._isDown,s=e._eventStartPosition,a=e._pressTime,c=e._releaseTime;o[i]=!0,r[i]=!1,s[i]=new q.A;let l=e._movement[i];(0,d.A)(l)||(l=e._movement[i]={}),l.distance={startPosition:new q.A,endPosition:new q.A},l.angleAndHeight={startPosition:new q.A,endPosition:new q.A},l.prevAngle=0,e._eventHandler.setInputAction(function(t){e._buttonsDown++,r[i]=!0,a[i]=new Date,q.A.lerp(t.position1,t.position2,.5,s[i])},wR.A.PINCH_START,t),e._eventHandler.setInputAction(function(){e._buttonsDown=Math.max(e._buttonsDown-1,0),r[i]=!1,c[i]=new Date},wR.A.PINCH_END,t),e._eventHandler.setInputAction(function(e){if(r[i]){o[i]?(t=e,s=l,q.A.clone(t.distance.startPosition,s.distance.startPosition),q.A.clone(t.distance.endPosition,s.distance.endPosition),q.A.clone(t.angleAndHeight.startPosition,s.angleAndHeight.startPosition),q.A.clone(t.angleAndHeight.endPosition,s.angleAndHeight.endPosition),o[i]=!1,l.prevAngle=l.angleAndHeight.startPosition.x):(q.A.clone(e.distance.endPosition,l.distance.endPosition),q.A.clone(e.angleAndHeight.endPosition,l.angleAndHeight.endPosition));let r=l.angleAndHeight.endPosition.x;const a=l.prevAngle,c=2*Math.PI;for(;r>=a+Math.PI;)r-=c;for(;r<a-Math.PI;)r+=c;l.angleAndHeight.endPosition.x=-r*n.clientWidth/12,l.angleAndHeight.startPosition.x=-a*n.clientWidth/12}var t,s},wR.A.PINCH_MOVE,t)}function TG(e,t){const n=yG(_G.WHEEL,t),i=e._pressTime,o=e._releaseTime,r=e._update;r[n]=!0;let s=e._movement[n];(0,d.A)(s)||(s=e._movement[n]={});let a=e._lastMovement[n];(0,d.A)(a)||(a=e._lastMovement[n]={startPosition:new q.A,endPosition:new q.A,valid:!1}),s.startPosition=new q.A,q.A.clone(q.A.ZERO,s.startPosition),s.endPosition=new q.A,e._eventHandler.setInputAction(function(e){const t=7.5*J.A.toRadians(e);i[n]=o[n]=new Date,s.endPosition.x=0,s.endPosition.y=t,q.A.clone(s.endPosition,a.endPosition),a.valid=!0,r[n]=!1},wR.A.WHEEL,t)}function bG(e,t,n){const i=yG(n,t),o=e._isDown,r=e._eventStartPosition,s=e._pressTime;o[i]=!1,r[i]=new q.A;let a,c,l=e._lastMovement[i];(0,d.A)(l)||(l=e._lastMovement[i]={startPosition:new q.A,endPosition:new q.A,valid:!1}),n===_G.LEFT_DRAG?(a=wR.A.LEFT_DOWN,c=wR.A.LEFT_UP):n===_G.RIGHT_DRAG?(a=wR.A.RIGHT_DOWN,c=wR.A.RIGHT_UP):n===_G.MIDDLE_DRAG&&(a=wR.A.MIDDLE_DOWN,c=wR.A.MIDDLE_UP),e._eventHandler.setInputAction(function(t){e._buttonsDown++,l.valid=!1,o[i]=!0,s[i]=new Date,q.A.clone(t.position,r[i])},a,t),e._eventHandler.setInputAction(function(){wG(yG(n,void 0),e);for(const t of Object.values(NO.A))wG(yG(n,t),e)},c,t)}function wG(e,t){const n=t._releaseTime,i=t._isDown;i[e]&&(t._buttonsDown=Math.max(t._buttonsDown-1,0)),i[e]=!1,n[e]=new Date}function xG(e,t){q.A.clone(e.startPosition,t.startPosition),q.A.clone(e.endPosition,t.endPosition)}function CG(e,t,n){const i=n._isDown;let o=!1;const r=yG(e,t);for(const[t,s]of Object.entries(i))t.startsWith(e)&&s&&t!==r&&(o=!0,wG(t,n));if(!o)return;const s=n._pressTime;let a=n._lastMovement[r];(0,d.A)(a)||(a=n._lastMovement[r]={startPosition:new q.A,endPosition:new q.A,valid:!1}),n._buttonsDown++,a.valid=!1,i[r]=!0,s[r]=new Date}function EG(e,t){const n=e._update,i=e._movement,o=e._lastMovement,r=e._isDown;for(const i in _G)if(_G.hasOwnProperty(i)){const o=_G[i];if((0,d.A)(o)){const i=yG(o,t);n[i]=!0,(0,d.A)(e._lastMovement[i])||(e._lastMovement[i]={startPosition:new q.A,endPosition:new q.A,valid:!1}),(0,d.A)(e._movement[i])||(e._movement[i]={startPosition:new q.A,endPosition:new q.A})}}e._eventHandler.setInputAction(function(s){for(const a in _G)if(_G.hasOwnProperty(a)){const c=_G[a];if((0,d.A)(c)){const a=yG(c,t);CG(c,t,e),r[a]&&(n[a]?(xG(i[a],o[a]),o[a].valid=!0,xG(s,i[a]),n[a]=!1):q.A.clone(s.endPosition,i[a].endPosition))}}q.A.clone(s.endPosition,e._currentMousePosition)},wR.A.MOUSE_MOVE,t)}function SG(e){if(!(0,d.A)(e))throw new A.A("canvas is required.");this._eventHandler=new bR.A(e),this._update={},this._movement={},this._lastMovement={},this._isDown={},this._eventStartPosition={},this._pressTime={},this._releaseTime={},this._buttonsDown=0,this._currentMousePosition=new q.A,TG(this,void 0),vG(this,void 0,e),bG(this,void 0,_G.LEFT_DRAG),bG(this,void 0,_G.RIGHT_DRAG),bG(this,void 0,_G.MIDDLE_DRAG),EG(this,void 0);for(const t in NO.A)if(NO.A.hasOwnProperty(t)){const n=NO.A[t];(0,d.A)(n)&&(TG(this,n),vG(this,n,e),bG(this,n,_G.LEFT_DRAG),bG(this,n,_G.RIGHT_DRAG),bG(this,n,_G.MIDDLE_DRAG),EG(this,n))}}Object.defineProperties(SG.prototype,{currentMousePosition:{get:function(){return this._currentMousePosition}},anyButtonDown:{get:function(){const e=!(this._update[yG(_G.WHEEL)]&&this._update[yG(_G.WHEEL,NO.A.SHIFT)]&&this._update[yG(_G.WHEEL,NO.A.CTRL)]&&this._update[yG(_G.WHEEL,NO.A.ALT)]);return this._buttonsDown>0||e}}}),SG.prototype.isMoving=function(e,t){if(!(0,d.A)(e))throw new A.A("type is required.");const n=yG(e,t);return!this._update[n]},SG.prototype.getMovement=function(e,t){if(!(0,d.A)(e))throw new A.A("type is required.");const n=yG(e,t);return this._movement[n]},SG.prototype.getLastMovement=function(e,t){if(!(0,d.A)(e))throw new A.A("type is required.");const n=yG(e,t),i=this._lastMovement[n];if(i.valid)return i},SG.prototype.isButtonDown=function(e,t){if(!(0,d.A)(e))throw new A.A("type is required.");const n=yG(e,t);return this._isDown[n]},SG.prototype.getStartMousePosition=function(e,t){if(!(0,d.A)(e))throw new A.A("type is required.");if(e===_G.WHEEL)return this._currentMousePosition;const n=yG(e,t);return this._eventStartPosition[n]},SG.prototype.getButtonPressTime=function(e,t){if(!(0,d.A)(e))throw new A.A("type is required.");const n=yG(e,t);return this._pressTime[n]},SG.prototype.getButtonReleaseTime=function(e,t){if(!(0,d.A)(e))throw new A.A("type is required.");const n=yG(e,t);return this._releaseTime[n]},SG.prototype.reset=function(){for(const e in this._update)this._update.hasOwnProperty(e)&&(this._update[e]=!0)},SG.prototype.isDestroyed=function(){return!1},SG.prototype.destroy=function(){return this._eventHandler=this._eventHandler&&this._eventHandler.destroy(),(0,h.A)(this)};const IG=SG;var PG=n(50040);function DG(e,t,n,i,o,r,s,a,c,l){this._tweens=e,this._tweenjs=t,this._startObject=(0,_t.A)(n),this._stopObject=(0,_t.A)(i),this._duration=o,this._delay=r,this._easingFunction=s,this._update=a,this._complete=c,this.cancel=l,this.needsStart=!0}function OG(){this._tweens=[]}Object.defineProperties(DG.prototype,{startObject:{get:function(){return this._startObject}},stopObject:{get:function(){return this._stopObject}},duration:{get:function(){return this._duration}},delay:{get:function(){return this._delay}},easingFunction:{get:function(){return this._easingFunction}},update:{get:function(){return this._update}},complete:{get:function(){return this._complete}},tweenjs:{get:function(){return this._tweenjs}}}),DG.prototype.cancelTween=function(){this._tweens.remove(this)},Object.defineProperties(OG.prototype,{length:{get:function(){return this._tweens.length}}}),OG.prototype.add=function(e){if(e=e??S.A.EMPTY_OBJECT,!(0,d.A)(e.startObject)||!(0,d.A)(e.stopObject))throw new A.A("options.startObject and options.stopObject are required.");if(!(0,d.A)(e.duration)||e.duration<0)throw new A.A("options.duration is required and must be positive.");if(0===e.duration)return(0,d.A)(e.complete)&&e.complete(),new DG(this);const t=e.duration/ne.A.SECONDS_PER_MILLISECOND,n=e.delay??0,i=n/ne.A.SECONDS_PER_MILLISECOND,o=e.easingFunction??nC.A.LINEAR_NONE,r=e.startObject,s=new PG.K(r);s.to((0,_t.A)(e.stopObject),t),s.delay(i),s.easing(o),(0,d.A)(e.update)&&s.onUpdate(function(){e.update(r)}),s.onComplete(e.complete??null),s.repeat(e._repeat??0);const a=new DG(this,s,e.startObject,e.stopObject,e.duration,n,o,e.update,e.complete,e.cancel);return this._tweens.push(a),a},OG.prototype.addProperty=function(e){const t=(e=e??S.A.EMPTY_OBJECT).object,n=e.property,i=e.startValue,o=e.stopValue;if(!(0,d.A)(t)||!(0,d.A)(e.property))throw new A.A("options.object and options.property are required.");if(!(0,d.A)(t[n]))throw new A.A("options.object must have the specified property.");if(!(0,d.A)(i)||!(0,d.A)(o))throw new A.A("options.startValue and options.stopValue are required.");return this.add({startObject:{value:i},stopObject:{value:o},duration:e.duration??3,delay:e.delay,easingFunction:e.easingFunction,update:function(e){t[n]=e.value},complete:e.complete,cancel:e.cancel,_repeat:e._repeat})},OG.prototype.addAlpha=function(e){const t=(e=e??S.A.EMPTY_OBJECT).material;if(!(0,d.A)(t))throw new A.A("options.material is required.");const n=[];for(const e in t.uniforms)t.uniforms.hasOwnProperty(e)&&(0,d.A)(t.uniforms[e])&&(0,d.A)(t.uniforms[e].alpha)&&n.push(e);if(0===n.length)throw new A.A("material has no properties with alpha components.");return this.add({startObject:{alpha:e.startValue??0},stopObject:{alpha:e.stopValue??1},duration:e.duration??3,delay:e.delay,easingFunction:e.easingFunction,update:function(e){const i=n.length;for(let o=0;o<i;++o)t.uniforms[n[o]].alpha=e.alpha},complete:e.complete,cancel:e.cancel})},OG.prototype.addOffsetIncrement=function(e){const t=(e=e??S.A.EMPTY_OBJECT).material;if(!(0,d.A)(t))throw new A.A("material is required.");if(!(0,d.A)(t.uniforms.offset))throw new A.A("material.uniforms must have an offset property.");const n=t.uniforms;return this.addProperty({object:n,property:"offset",startValue:n.offset,stopValue:n.offset+1,duration:e.duration,delay:e.delay,easingFunction:e.easingFunction,update:e.update,cancel:e.cancel,_repeat:1/0})},OG.prototype.remove=function(e){if(!(0,d.A)(e))return!1;const t=this._tweens.indexOf(e);return-1!==t&&(e.tweenjs.stop(),(0,d.A)(e.cancel)&&e.cancel(),this._tweens.splice(t,1),!0)},OG.prototype.removeAll=function(){const e=this._tweens;for(let t=0;t<e.length;++t){const n=e[t];n.tweenjs.stop(),(0,d.A)(n.cancel)&&n.cancel()}e.length=0},OG.prototype.contains=function(e){return(0,d.A)(e)&&-1!==this._tweens.indexOf(e)},OG.prototype.get=function(e){if(!(0,d.A)(e))throw new A.A("index is required.");return this._tweens[e]},OG.prototype.update=function(e){const t=this._tweens;let n=0;for(e=(0,d.A)(e)?e/ne.A.SECONDS_PER_MILLISECOND:(0,aa.A)();n<t.length;){const i=t[n],o=i.tweenjs;i.needsStart?(i.needsStart=!1,o.start(e)):o.update(e)?n++:(o.stop(),t.splice(n,1))}};const RG=OG;function MG(e){if(!(0,d.A)(e))throw new A.A("scene is required.");this.enableInputs=!0,this.enableTranslate=!0,this.enableZoom=!0,this.enableRotate=!0,this.enableTilt=!0,this.enableLook=!0,this.inertiaSpin=.9,this.inertiaTranslate=.9,this.inertiaZoom=.8,this.maximumMovementRatio=.1,this.bounceAnimationTime=3,this.minimumZoomDistance=1,this.maximumZoomDistance=Number.POSITIVE_INFINITY,this.zoomFactor=5,this.translateEventTypes=_G.LEFT_DRAG,this.zoomEventTypes=[_G.RIGHT_DRAG,_G.WHEEL,_G.PINCH],this.rotateEventTypes=_G.LEFT_DRAG,this.tiltEventTypes=[_G.MIDDLE_DRAG,_G.PINCH,{eventType:_G.LEFT_DRAG,modifier:NO.A.CTRL},{eventType:_G.RIGHT_DRAG,modifier:NO.A.CTRL}],this.lookEventTypes={eventType:_G.LEFT_DRAG,modifier:NO.A.SHIFT};const t=e.ellipsoid??K.A.default;this.minimumPickingTerrainHeight=K.A.WGS84.equals(t)?15e4:.025*t.minimumRadius,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight,this.minimumPickingTerrainDistanceWithInertia=K.A.WGS84.equals(t)?4e3:63e-5*t.minimumRadius,this.minimumCollisionTerrainHeight=K.A.WGS84.equals(t)?15e3:.0025*t.minimumRadius,this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight,this.minimumTrackBallHeight=K.A.WGS84.equals(t)?75e5:1.175*t.minimumRadius,this._minimumTrackBallHeight=this.minimumTrackBallHeight,this.enableCollisionDetection=!0,this.maximumTiltAngle=void 0,this._scene=e,this._globe=void 0,this._ellipsoid=t,this._lastGlobeHeight=0,this._aggregator=new IG(e.canvas),this._lastInertiaSpinMovement=void 0,this._lastInertiaZoomMovement=void 0,this._lastInertiaTranslateMovement=void 0,this._lastInertiaTiltMovement=void 0,this._inertiaDisablers={_lastInertiaZoomMovement:["_lastInertiaSpinMovement","_lastInertiaTranslateMovement","_lastInertiaTiltMovement"],_lastInertiaTiltMovement:["_lastInertiaSpinMovement","_lastInertiaTranslateMovement"]},this._tweens=new RG,this._tween=void 0,this._horizontalRotationAxis=void 0,this._tiltCenterMousePosition=new q.A(-1,-1),this._tiltCenter=new j.A,this._rotateMousePosition=new q.A(-1,-1),this._rotateStartPosition=new j.A,this._strafeStartPosition=new j.A,this._strafeMousePosition=new q.A,this._strafeEndMousePosition=new q.A,this._zoomMouseStart=new q.A(-1,-1),this._zoomWorldPosition=new j.A,this._useZoomWorldPosition=!1,this._panLastMousePosition=new q.A,this._panLastWorldPosition=new j.A,this._tiltCVOffMap=!1,this._looking=!1,this._rotating=!1,this._strafing=!1,this._zoomingOnVector=!1,this._zoomingUnderground=!1,this._rotatingZoom=!1,this._adjustedHeightForTerrain=!1,this._cameraUnderground=!1;const n=e.mapProjection;this._maxCoord=n.project(new X.A(Math.PI,J.A.PI_OVER_TWO)),this._rotateFactor=void 0,this._rotateRateRangeAdjustment=void 0,this._maximumRotateRate=1.77,this._minimumRotateRate=2e-4,this._minimumZoomRate=20,this._maximumZoomRate=5906376272e3,this._minimumUndergroundPickDistance=2e3,this._maximumUndergroundPickDistance=1e4}function LG(e,t,n,i,o,r,s){let a=r[s];(0,d.A)(a)||(a=r[s]={startPosition:new q.A,endPosition:new q.A,motion:new q.A,inertiaEnabled:!0});const c=e.getButtonPressTime(t,n),l=e.getButtonReleaseTime(t,n),u=c&&l&&(l.getTime()-c.getTime())/1e3,h=new Date,A=l&&(h.getTime()-l.getTime())/1e3;if(c&&l&&u<.4){const s=function(e,t){if(e<0)return 0;const n=25*(1-t);return Math.exp(-n*e)}(A,i),c=e.getLastMovement(t,n);if(!(0,d.A)(c)||(p=c,q.A.equalsEpsilon(p.startPosition,p.endPosition,J.A.EPSILON14))||!a.inertiaEnabled)return;if(a.motion.x=.5*(c.endPosition.x-c.startPosition.x),a.motion.y=.5*(c.endPosition.y-c.startPosition.y),a.startPosition=q.A.clone(c.startPosition,a.startPosition),a.endPosition=q.A.multiplyByScalar(a.motion,s,a.endPosition),a.endPosition=q.A.add(a.startPosition,a.endPosition,a.endPosition),isNaN(a.endPosition.x)||isNaN(a.endPosition.y)||q.A.distance(a.startPosition,a.endPosition)<.5)return;e.isButtonDown(t,n)||o(r,e.getStartMousePosition(t,n),a)}var p}function NG(e,t){if((0,d.A)(t)){let n=e[t];(0,d.A)(n)&&(n.inertiaEnabled=!0);const i=e._inertiaDisablers[t];if((0,d.A)(i)){const t=i.length;for(let o=0;o<t;++o)n=e[i[o]],(0,d.A)(n)&&(n.inertiaEnabled=!1)}}}const BG=[];function FG(e,t,n,i,o,r){if(!(0,d.A)(n))return;const s=e._aggregator;Array.isArray(n)||(BG[0]=n,n=BG);const a=n.length;for(let c=0;c<a;++c){const a=n[c],l=(0,d.A)(a.eventType)?a.eventType:a,u=a.modifier,h=s.isMoving(l,u)&&s.getMovement(l,u),A=s.getStartMousePosition(l,u);e.enableInputs&&t&&(h?(i(e,A,h),NG(e,r)):o<1&&LG(s,l,u,o,i,e,r))}}const UG=new _R.A,kG=new j.A,VG=new q.A,zG=new j.A,HG=new q.A,GG=new j.A,WG=new j.A,YG=new j.A,qG=new j.A,jG=new j.A,QG=new j.A,XG=new j.A,KG=new j.A,$G=new j.A,JG=new j.A,ZG=new j.A,eW=new j.A,tW=new j.A,nW=new j.A,iW=new j.A,oW=new j.A,rW=new j.A,sW=new j.A,aW={orientation:new bv.A};function cW(e,t,n,i,o,r){let s=1;(0,d.A)(r)&&(s=J.A.clamp(Math.abs(r),.25,1));const a=n.endPosition.y-n.startPosition.y,c=a>0?e.minimumZoomDistance*s:0,l=e.maximumZoomDistance;let u=i*(o-c);u=J.A.clamp(u,e._minimumZoomRate,e._maximumZoomRate);let h=a/e._scene.canvas.clientHeight;h=Math.min(h,e.maximumMovementRatio);let A=u*h;if(e.enableCollisionDetection||0===e.minimumZoomDistance||!(0,d.A)(e._globe)){if(A>0&&Math.abs(o-c)<1)return;if(A<0&&Math.abs(o-l)<1)return;o-A<c?A=o-c-1:o-A>l&&(A=o-l)}const p=e._scene,f=p.camera,m=p.mode,g=aW.orientation;g.heading=f.heading,g.pitch=f.pitch,g.roll=f.roll;const _=n.inertiaEnabled??q.A.equals(t,e._zoomMouseStart);let y,v=e._zoomingOnVector,T=e._rotatingZoom;if(_||(e._zoomMouseStart=q.A.clone(t,e._zoomMouseStart),(0,d.A)(e._globe)&&m===Ce.A.SCENE2D?(y=f.getPickRay(t,UG).origin,y=j.A.fromElements(y.y,y.z,y.x)):(0,d.A)(e._globe)&&(y=vW(e,t,kG)),(0,d.A)(y)?(e._useZoomWorldPosition=!0,e._zoomWorldPosition=j.A.clone(y,e._zoomWorldPosition)):e._useZoomWorldPosition=!1,v=e._zoomingOnVector=!1,T=e._rotatingZoom=!1,e._zoomingUnderground=e._cameraUnderground),!e._useZoomWorldPosition)return void f.zoomIn(A);let b=m===Ce.A.COLUMBUS_VIEW;if(f.positionCartographic.height<2e6&&(T=!0),!_||T){if(m===Ce.A.SCENE2D){const n=e._zoomWorldPosition,i=f.position;if(!j.A.equals(n,i)&&f.positionCartographic.height<2*e._maxCoord.x){const o=f.position.x,r=j.A.subtract(n,i,zG);j.A.normalize(r,r);const s=j.A.distance(n,i)*A/(.5*f.getMagnitude());f.move(r,.5*s),(f.position.x<0&&o>0||f.position.x>0&&o<0)&&(y=f.getPickRay(t,UG).origin,y=j.A.fromElements(y.y,y.z,y.x),e._zoomWorldPosition=j.A.clone(y,e._zoomWorldPosition))}}else if(m===Ce.A.SCENE3D){const t=j.A.normalize(f.position,jG);if(e._cameraUnderground||e._zoomingUnderground||f.positionCartographic.height<3e3&&Math.abs(j.A.dot(f.direction,t))<.6)b=!0;else{const n=p.canvas,i=HG;i.x=n.clientWidth/2,i.y=n.clientHeight/2;const o=vW(e,i,GG);if((0,d.A)(o))if(f.positionCartographic.height<1e6){if(!(j.A.dot(f.direction,t)>=-.5)){const n=XG;j.A.clone(f.position,n);const i=e._zoomWorldPosition;let o=QG;if(o=j.A.normalize(i,o),j.A.dot(o,t)<0)return;const r=iW,s=JG;j.A.clone(f.direction,s),j.A.add(n,j.A.multiplyByScalar(s,1e3,oW),r);const a=ZG,c=eW;j.A.subtract(i,n,a),j.A.normalize(a,c);const l=j.A.dot(t,c);if(l>=0)return void(e._zoomMouseStart.x=-1);const u=Math.acos(-l),d=j.A.magnitude(n),h=j.A.magnitude(i),p=d-A,m=j.A.magnitude(a),g=Math.asin(J.A.clamp(m/h*Math.sin(u),-1,1))-Math.asin(J.A.clamp(p/h*Math.sin(u),-1,1))+u,_=KG;j.A.normalize(n,_);let y=$G;y=j.A.cross(c,_,y),y=j.A.normalize(y,y),j.A.normalize(j.A.cross(_,y,oW),s),j.A.multiplyByScalar(j.A.normalize(r,oW),j.A.magnitude(r)-A,r),j.A.normalize(n,n),j.A.multiplyByScalar(n,p,n);const v=tW;j.A.multiplyByScalar(j.A.add(j.A.multiplyByScalar(_,Math.cos(g)-1,rW),j.A.multiplyByScalar(s,Math.sin(g),sW),oW),p,v),j.A.add(n,v,n),j.A.normalize(r,_),j.A.normalize(j.A.cross(_,y,oW),s);const T=nW;return j.A.multiplyByScalar(j.A.add(j.A.multiplyByScalar(_,Math.cos(g)-1,rW),j.A.multiplyByScalar(s,Math.sin(g),sW),oW),j.A.magnitude(r),T),j.A.add(r,T,r),j.A.clone(n,f.position),j.A.normalize(j.A.subtract(r,n,oW),f.direction),j.A.clone(f.direction,f.direction),j.A.cross(f.direction,f.up,f.right),j.A.cross(f.right,f.direction,f.up),void f.setView(aW)}b=!0}else{const t=j.A.normalize(o,WG),n=j.A.normalize(e._zoomWorldPosition,YG),i=j.A.dot(n,t);if(i>0&&i<1){const e=J.A.acosClamped(i),o=j.A.cross(n,t,qG),r=A/(Math.abs(e)>J.A.toRadians(20)?.75*f.positionCartographic.height:f.positionCartographic.height-A);f.rotate(o,e*r)}}else b=!0}}e._rotatingZoom=!b}if(!_&&b||v){let n;const i=KU.A.worldToWindowCoordinates(p,e._zoomWorldPosition,VG);n=m!==Ce.A.COLUMBUS_VIEW&&q.A.equals(t,e._zoomMouseStart)&&(0,d.A)(i)?f.getPickRay(i,UG):f.getPickRay(t,UG);const o=n.direction;m!==Ce.A.COLUMBUS_VIEW&&m!==Ce.A.SCENE2D||j.A.fromElements(o.y,o.z,o.x,o),f.move(o,A),e._zoomingOnVector=!0}else f.zoomIn(A);e._cameraUnderground||f.setView(aW)}const lW=new _R.A,uW=new _R.A,dW=new j.A;function hW(e,t,n){const i=e._scene.camera;let o=i.getPickRay(n.startPosition,lW).origin,r=i.getPickRay(n.endPosition,uW).origin;o=j.A.fromElements(o.y,o.z,o.x,o),r=j.A.fromElements(r.y,r.z,r.x,r);const s=j.A.subtract(o,r,dW),a=j.A.magnitude(s);a>0&&(j.A.normalize(s,s),i.move(s,a))}function AW(e,t,n){(0,d.A)(n.distance)&&(n=n.distance);const i=e._scene.camera;cW(e,t,n,e.zoomFactor,i.getMagnitude())}const pW=new q.A,fW=new q.A;function mW(e,t,n){if((0,d.A)(n.angleAndHeight))return void function(e,t,n){let i=e._rotateFactor*e._rotateRateRangeAdjustment;i>e._maximumRotateRate&&(i=e._maximumRotateRate),i<e._minimumRotateRate&&(i=e._minimumRotateRate);const o=e._scene,r=o.camera,s=o.canvas;let a=(n.endPosition.x-n.startPosition.x)/s.clientWidth;a=Math.min(a,e.maximumMovementRatio);const c=i*a*Math.PI*4;r.twistRight(c)}(e,0,n.angleAndHeight);const i=e._scene,o=i.camera,r=i.canvas,s=r.clientWidth,a=r.clientHeight;let c=pW;c.x=2/s*n.startPosition.x-1,c.y=2/a*(a-n.startPosition.y)-1,c=q.A.normalize(c,c);let l=fW;l.x=2/s*n.endPosition.x-1,l.y=2/a*(a-n.endPosition.y)-1,l=q.A.normalize(l,l);let u=J.A.acosClamped(c.x);c.y<0&&(u=J.A.TWO_PI-u);let h=J.A.acosClamped(l.x);l.y<0&&(h=J.A.TWO_PI-h);const A=h-u;o.twistRight(A)}const gW=new _R.A,_W=new j.A,yW=new j.A;function vW(e,t,n){const i=e._scene,o=e._globe,r=i.camera;let s;if(i.pickPositionSupported&&(s=i.pickPositionWorldCoordinates(t,_W)),!(0,d.A)(o))return j.A.clone(s,n);const a=!e._cameraUnderground,c=r.getPickRay(t,gW),l=o.pickWorldCoordinates(c,i,a,yW);return((0,d.A)(s)?j.A.distance(s,r.positionWC):Number.POSITIVE_INFINITY)<((0,d.A)(l)?j.A.distance(l,r.positionWC):Number.POSITIVE_INFINITY)?j.A.clone(s,n):j.A.clone(l,n)}const TW=new X.A;function bW(e){const t=e._ellipsoid,n=e._scene,i=n.camera;let o=0;if(n.mode===Ce.A.SCENE3D){const e=t.cartesianToCartographic(i.position,TW);(0,d.A)(e)&&(o=e.height)}else o=i.position.z;const r=e._scene.globeHeight??0;return Math.abs(r-o)}const wW=new j.A;function xW(e,t){const n=t.origin,i=t.direction,o=bW(e),r=j.A.normalize(n,wW);let s=Math.abs(j.A.dot(r,i));return s=2*Math.max(s,.5),o*s}function CW(e,t,n,i){let o=j.A.distance(t.origin,n);const r=bW(e);return o>J.A.clamp(5*r,e._minimumUndergroundPickDistance,e._maximumUndergroundPickDistance)&&(o=Math.min(o,r/5),o=Math.max(o,100)),_R.A.getPoint(t,o,i)}function EW(e,t,n,i){let o;return(0,d.A)(n)?(o=j.A.distance(t.origin,n),o>e._maximumUndergroundPickDistance&&(o=bW(e))):o=bW(e),_R.A.getPoint(t,o,i)}const SW=new q.A;function IW(e,t){const n=t.endPosition,i=q.A.subtract(t.endPosition,t.startPosition,SW),o=e._strafeEndMousePosition;q.A.add(o,i,o),t.endPosition=o,cY(e,t,e._strafeStartPosition),t.endPosition=n}const PW=new _R.A,DW=new _R.A,OW=new j.A,RW=new j.A,MW=new j.A,LW=new j.A,NW=new dR.A(j.A.UNIT_X,0),BW=new q.A,FW=new q.A;function UW(e,t,n){if(j.A.equals(t,e._translateMousePosition)||(e._looking=!1),j.A.equals(t,e._strafeMousePosition)||(e._strafing=!1),e._looking)return void ZY(e,0,n);if(e._strafing)return void IW(e,n);const i=e._scene.camera,o=e._cameraUnderground,r=q.A.clone(n.startPosition,BW),s=q.A.clone(n.endPosition,FW);let a=i.getPickRay(r,PW);const c=j.A.clone(j.A.ZERO,LW),l=j.A.UNIT_X;let u;if(i.position.z<e._minimumPickingTerrainHeight&&(u=vW(e,r,OW),(0,d.A)(u)&&(c.x=u.x)),o||c.x>i.position.z&&(0,d.A)(u)){let i=u;return o&&(i=EW(e,a,u,OW)),q.A.clone(t,e._strafeMousePosition),q.A.clone(t,e._strafeEndMousePosition),j.A.clone(i,e._strafeStartPosition),e._strafing=!0,void cY(e,n,e._strafeStartPosition)}const h=dR.A.fromPointNormal(c,l,NW);a=i.getPickRay(r,PW);const A=wO.A.rayPlane(a,h,OW),p=i.getPickRay(s,DW),f=wO.A.rayPlane(p,h,RW);if(!(0,d.A)(A)||!(0,d.A)(f))return e._looking=!0,ZY(e,0,n),void q.A.clone(t,e._translateMousePosition);const m=j.A.subtract(A,f,MW),g=m.x;m.x=m.y,m.y=m.z,m.z=g;const _=j.A.magnitude(m);_>J.A.EPSILON6&&(j.A.normalize(m,m),i.move(m,_))}const kW=new q.A,VW=new _R.A,zW=new j.A,HW=new j.A,GW=new O.A,WW=new O.A,YW=new j.A,qW=new dR.A(j.A.UNIT_X,0),jW=new j.A,QW=new X.A,XW=new O.A,KW=new To.A,$W=new Z.A,JW=new j.A;function ZW(e,t,n){if((0,d.A)(n.angleAndHeight)&&(n=n.angleAndHeight),q.A.equals(t,e._tiltCenterMousePosition)||(e._tiltCVOffMap=!1,e._looking=!1),e._looking)return void ZY(e,0,n);const i=e._scene.camera;e._tiltCVOffMap||!e.onMap()||Math.abs(i.position.z)>e._minimumPickingTerrainHeight?(e._tiltCVOffMap=!0,function(e,t,n){const i=e._scene,o=i.camera,r=i.canvas,s=kW;s.x=r.clientWidth/2,s.y=r.clientHeight/2;const a=o.getPickRay(s,VW),c=j.A.UNIT_X,l=a.origin,u=a.direction;let h;const A=j.A.dot(c,u);if(Math.abs(A)>J.A.EPSILON6&&(h=-j.A.dot(c,l)/A),!(0,d.A)(h)||h<=0)return e._looking=!0,ZY(e,0,n),void q.A.clone(t,e._tiltCenterMousePosition);const p=j.A.multiplyByScalar(u,h,zW);j.A.add(l,p,p);const f=i.mapProjection,m=f.ellipsoid;j.A.fromElements(p.y,p.z,p.x,p);const g=f.unproject(p,QW);m.cartographicToCartesian(g,p);const _=xe.A.eastNorthUpToFixedFrame(p,m,GW),y=e._globe,v=e._ellipsoid;e._globe=void 0,e._ellipsoid=K.A.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;const T=O.A.clone(o.transform,XW);o._setTransform(_),gY(e,0,n,j.A.UNIT_Z),o._setTransform(T),e._globe=y,e._ellipsoid=v;const b=v.maximumRadius;e._rotateFactor=1/b,e._rotateRateRangeAdjustment=b}(e,t,n)):function(e,t,n){const i=e._scene,o=i.camera,r=e._cameraUnderground;let s,a;const c=j.A.UNIT_X;if(q.A.equals(t,e._tiltCenterMousePosition))s=j.A.clone(e._tiltCenter,zW);else{if(o.position.z<e._minimumPickingTerrainHeight&&(s=vW(e,t,zW)),!(0,d.A)(s)){a=o.getPickRay(t,VW);const i=a.origin,r=a.direction;let l;const u=j.A.dot(c,r);if(Math.abs(u)>J.A.EPSILON6&&(l=-j.A.dot(c,i)/u),!(0,d.A)(l)||l<=0)return e._looking=!0,ZY(e,0,n),void q.A.clone(t,e._tiltCenterMousePosition);s=j.A.multiplyByScalar(r,l,zW),j.A.add(i,s,s)}r&&((0,d.A)(a)||(a=o.getPickRay(t,VW)),CW(e,a,s,s)),q.A.clone(t,e._tiltCenterMousePosition),j.A.clone(s,e._tiltCenter)}const l=i.canvas,u=kW;u.x=l.clientWidth/2,u.y=e._tiltCenterMousePosition.y,a=o.getPickRay(u,VW);const h=j.A.clone(j.A.ZERO,YW);h.x=s.x;const A=dR.A.fromPointNormal(h,c,qW),p=wO.A.rayPlane(a,A,HW),f=o._projection,m=f.ellipsoid;j.A.fromElements(s.y,s.z,s.x,s);let g=f.unproject(s,QW);m.cartographicToCartesian(g,s);const _=xe.A.eastNorthUpToFixedFrame(s,m,GW);let y;(0,d.A)(p)?(j.A.fromElements(p.y,p.z,p.x,p),g=f.unproject(p,QW),m.cartographicToCartesian(g,p),y=xe.A.eastNorthUpToFixedFrame(p,m,WW)):y=_;const v=e._globe,T=e._ellipsoid;e._globe=void 0,e._ellipsoid=K.A.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;let b=j.A.UNIT_Z;const w=O.A.clone(o.transform,XW);o._setTransform(_);const x=j.A.cross(j.A.UNIT_Z,j.A.normalize(o.position,jW),jW),C=j.A.dot(o.right,x);if(gY(e,0,n,b,!1,!0),o._setTransform(y),C<0){const t=n.startPosition.y-n.endPosition.y;(r&&t<0||!r&&t>0)&&(b=void 0);const i=o.constrainedAxis;o.constrainedAxis=void 0,gY(e,0,n,b,!0,!1),o.constrainedAxis=i}else gY(e,0,n,b,!0,!1);if((0,d.A)(o.constrainedAxis)){const e=j.A.cross(o.direction,o.constrainedAxis,JW);j.A.equalsEpsilon(e,j.A.ZERO,J.A.EPSILON6)||(j.A.dot(e,o.right)<0&&j.A.negate(e,e),j.A.cross(e,o.direction,o.up),j.A.cross(o.direction,o.up,o.right),j.A.normalize(o.up,o.up),j.A.normalize(o.right,o.right))}o._setTransform(w),e._globe=v,e._ellipsoid=T;const E=T.maximumRadius;e._rotateFactor=1/E,e._rotateRateRangeAdjustment=E;const S=j.A.clone(o.positionWC,jW);if(e.enableCollisionDetection&&nq(e,!0),!j.A.equals(o.positionWC,S)){o._setTransform(y),o.worldToCameraCoordinatesPoint(S,S);const e=j.A.magnitudeSquared(S);j.A.magnitudeSquared(o.position)>e&&(j.A.normalize(o.position,o.position),j.A.multiplyByScalar(o.position,Math.sqrt(e),o.position));const t=j.A.angleBetween(S,o.position),n=j.A.cross(S,o.position,S);j.A.normalize(n,n);const i=To.A.fromAxisAngle(n,t,KW),r=Z.A.fromQuaternion(i,$W);Z.A.multiplyByVector(r,o.direction,o.direction),Z.A.multiplyByVector(r,o.up,o.up),j.A.cross(o.direction,o.up,o.right),j.A.cross(o.right,o.direction,o.up),o._setTransform(w)}}(e,t,n)}const eY=new q.A,tY=new _R.A,nY=new j.A;function iY(e,t,n){(0,d.A)(n.distance)&&(n=n.distance);const i=e._scene,o=i.camera,r=i.canvas,s=e._cameraUnderground;let a;s?a=t:(a=eY,a.x=r.clientWidth/2,a.y=r.clientHeight/2);const c=o.getPickRay(a,tY),l=c.origin,u=c.direction;let h,A;if(o.position.z<e._minimumPickingTerrainHeight&&(h=vW(e,a,nY)),(0,d.A)(h)&&(A=j.A.distance(l,h)),s){const t=xW(e,c);A=(0,d.A)(A)?Math.min(A,t):t}if(!(0,d.A)(A)){const e=j.A.UNIT_X;A=-j.A.dot(e,l)/j.A.dot(e,u)}cW(e,t,n,e.zoomFactor,A)}const oY=new _R.A,rY=new dR.A(j.A.UNIT_X,0),sY=new j.A,aY=new j.A;function cY(e,t,n){const i=e._scene,o=i.camera,r=o.getPickRay(t.endPosition,oY);let s=j.A.clone(o.direction,aY);i.mode===Ce.A.COLUMBUS_VIEW&&j.A.fromElements(s.z,s.x,s.y,s);const a=dR.A.fromPointNormal(n,s,rY),c=wO.A.rayPlane(r,a,sY);(0,d.A)(c)&&(s=j.A.subtract(n,c,s),i.mode===Ce.A.COLUMBUS_VIEW&&j.A.fromElements(s.y,s.z,s.x,s),j.A.add(o.position,s,o.position))}const lY=new j.A,uY=new X.A,dY=new j.A,hY=new K.A,AY=new j.A,pY=new j.A,fY=new j.A;function mY(e,t,n){const i=e._scene.camera,o=e._cameraUnderground;let r,s,a=e._ellipsoid;if(!O.A.equals(i.transform,O.A.IDENTITY))return void gY(e,0,n);const c=a.geodeticSurfaceNormal(i.position,AY);if(q.A.equals(t,e._rotateMousePosition)){if(e._looking)ZY(e,0,n,c);else if(e._rotating)gY(e,0,n);else if(e._strafing)IW(e,n);else{if(j.A.magnitude(i.position)<j.A.magnitude(e._rotateStartPosition))return;r=j.A.magnitude(e._rotateStartPosition),s=dY,s.x=s.y=s.z=r,a=K.A.fromCartesian3(s,hY),PY(e,0,n,a)}return}e._looking=!1,e._rotating=!1,e._strafing=!1;const l=a.cartesianToCartographic(i.positionWC,uY).height,u=e._globe;if((0,d.A)(u)&&l<e._minimumPickingTerrainHeight){const l=vW(e,n.startPosition,fY);if((0,d.A)(l)){let c=!1;const u=i.getPickRay(n.startPosition,gW);if(o)c=!0,EW(e,u,l,l);else{const e=a.geodeticSurfaceNormal(l,pY);c=!!(Math.abs(j.A.dot(u.direction,e))<.05)||j.A.magnitude(i.position)<j.A.magnitude(l)}c?(q.A.clone(t,e._strafeEndMousePosition),j.A.clone(l,e._strafeStartPosition),e._strafing=!0,cY(e,n,e._strafeStartPosition)):(r=j.A.magnitude(l),s=dY,s.x=s.y=s.z=r,a=K.A.fromCartesian3(s,hY),PY(e,0,n,a),j.A.clone(l,e._rotateStartPosition))}else e._looking=!0,ZY(e,0,n,c)}else(0,d.A)(i.pickEllipsoid(n.startPosition,e._ellipsoid,lY))?(PY(e,0,n,e._ellipsoid),j.A.clone(lY,e._rotateStartPosition)):l>e._minimumTrackBallHeight?(e._rotating=!0,gY(e,0,n)):(e._looking=!0,ZY(e,0,n,c));q.A.clone(t,e._rotateMousePosition)}function gY(e,t,n,i,o,r){o=o??!1,r=r??!1;const s=e._scene,a=s.camera,c=s.canvas,l=a.constrainedAxis;(0,d.A)(i)&&(a.constrainedAxis=i);const u=j.A.magnitude(a.position);let h=e._rotateFactor*(u-e._rotateRateRangeAdjustment);h>e._maximumRotateRate&&(h=e._maximumRotateRate),h<e._minimumRotateRate&&(h=e._minimumRotateRate);let A=(n.startPosition.x-n.endPosition.x)/c.clientWidth,p=(n.startPosition.y-n.endPosition.y)/c.clientHeight;A=Math.min(A,e.maximumMovementRatio),p=Math.min(p,e.maximumMovementRatio);const f=h*A*Math.PI*2;let m=h*p*Math.PI;if((0,d.A)(i)&&(0,d.A)(e.maximumTiltAngle)){const t=e.maximumTiltAngle,n=j.A.dot(a.direction,i),o=Math.PI-Math.acos(n)+m;o>t&&(m-=o-t)}o||a.rotateRight(f),r||a.rotateUp(m),a.constrainedAxis=l}const _Y=Q.A.clone(Q.A.UNIT_W),yY=Q.A.clone(Q.A.UNIT_W),vY=new j.A,TY=new j.A,bY=new j.A,wY=new j.A,xY=new q.A,CY=new q.A,EY=new q.A,SY=new q.A,IY=new _R.A;function PY(e,t,n,i){const o=e._scene,r=o.camera,s=q.A.clone(n.startPosition,xY),a=q.A.clone(n.endPosition,CY),c=i.cartesianToCartographic(r.positionWC,uY).height;let l,u;if(!n.inertiaEnabled&&c<e._minimumPickingTerrainHeight&&(l=j.A.clone(e._panLastWorldPosition,_Y),(0,d.A)(e._globe)||q.A.equalsEpsilon(s,e._panLastMousePosition)||(l=vW(e,s,_Y)),!(0,d.A)(e._globe)&&(0,d.A)(l))){const t=j.A.subtract(l,r.positionWC,TY),n=j.A.multiplyByScalar(r.directionWC,j.A.dot(r.directionWC,t),TY),i=j.A.magnitude(n),c=r.frustum.getPixelDimensions(o.drawingBufferWidth,o.drawingBufferHeight,i,o.pixelRatio,SY),h=q.A.subtract(a,s,EY),A=j.A.multiplyByScalar(r.rightWC,h.x*c.x,TY),p=j.A.normalize(r.positionWC,jG),f=r.getPickRay(a,IY).direction,m=j.A.subtract(f,j.A.projectVector(f,r.rightWC,bY),bY),g=j.A.angleBetween(m,r.directionWC);let _=1;(0,d.A)(r.frustum.fov)&&(_=Math.max(Math.tan(g),.1));let y=Math.abs(j.A.dot(r.directionWC,p));const v=-h.y*c.y*2/Math.sqrt(_)*(1-y),T=j.A.multiplyByScalar(f,v,bY);y=Math.abs(j.A.dot(r.upWC,p));const b=j.A.multiplyByScalar(r.upWC,-h.y*(1-y)*c.y,wY);u=j.A.add(l,A,yY),u=j.A.add(u,T,u),u=j.A.add(u,b,u),j.A.clone(u,e._panLastWorldPosition),q.A.clone(a,e._panLastMousePosition)}if((0,d.A)(l)&&(0,d.A)(u)||(l=r.pickEllipsoid(s,i,_Y),u=r.pickEllipsoid(a,i,yY)),!(0,d.A)(l)||!(0,d.A)(u))return e._rotating=!0,void gY(e,0,n);if(l=r.worldToCameraCoordinates(l,l),u=r.worldToCameraCoordinates(u,u),(0,d.A)(r.constrainedAxis)){const e=r.constrainedAxis,t=j.A.mostOrthogonalAxis(e,vY);j.A.cross(t,e,t),j.A.normalize(t,t);const n=j.A.cross(e,t,TY),i=j.A.magnitude(l),o=j.A.dot(e,l),s=Math.acos(o/i),a=j.A.multiplyByScalar(e,o,bY);j.A.subtract(l,a,a),j.A.normalize(a,a);const c=j.A.magnitude(u),d=j.A.dot(e,u),h=Math.acos(d/c),A=j.A.multiplyByScalar(e,d,wY);j.A.subtract(u,A,A),j.A.normalize(A,A);let p=Math.acos(j.A.dot(a,t));j.A.dot(a,n)<0&&(p=J.A.TWO_PI-p);let f=Math.acos(j.A.dot(A,t));j.A.dot(A,n)<0&&(f=J.A.TWO_PI-f);const m=p-f;let g;g=j.A.equalsEpsilon(e,r.position,J.A.EPSILON2)?r.right:j.A.cross(e,r.position,vY);const _=j.A.cross(e,g,vY),y=j.A.dot(_,j.A.subtract(l,e,TY)),v=j.A.dot(_,j.A.subtract(u,e,TY));let T;T=y>0&&v>0?h-s:y>0&&v<=0?j.A.dot(r.position,e)>0?-s-h:s+h:s-h,r.rotateRight(m),r.rotateUp(T)}else{j.A.normalize(l,l),j.A.normalize(u,u);const e=j.A.dot(l,u),t=j.A.cross(l,u,vY);if(e<1&&!j.A.equalsEpsilon(t,j.A.ZERO,J.A.EPSILON14)){const n=Math.acos(e);r.rotate(t,n)}}}const DY=new j.A,OY=new X.A;let RY=0;function MY(e,t,n){(0,d.A)(n.distance)&&(n=n.distance);const i=n.inertiaEnabled,o=e._ellipsoid,r=e._scene,s=r.camera,a=r.canvas,c=e._cameraUnderground;let l;c?l=t:(l=eY,l.x=a.clientWidth/2,l.y=a.clientHeight/2);const u=s.getPickRay(l,tY);let h;const A=o.cartesianToCartographic(s.position,OY).height,p=Math.abs(RY)<e.minimumPickingTerrainDistanceWithInertia;let f;if((i?p:A<e._minimumPickingTerrainHeight)&&(h=vW(e,l,nY)),(0,d.A)(h)&&(f=j.A.distance(u.origin,h),RY=f),c){const t=xW(e,u);f=(0,d.A)(f)?Math.min(f,t):t}(0,d.A)(f)||(f=A);const m=j.A.normalize(s.position,DY);cW(e,t,n,e.zoomFactor,f,j.A.dot(m,s.direction))}const LY=new q.A,NY=new _R.A,BY=new j.A,FY=new j.A,UY=new O.A,kY=new O.A,VY=new O.A,zY=new To.A,HY=new Z.A,GY=new X.A,WY=new j.A;function YY(e,t,n){const i=e._scene.camera;if(!O.A.equals(i.transform,O.A.IDENTITY))return;if((0,d.A)(n.angleAndHeight)&&(n=n.angleAndHeight),q.A.equals(t,e._tiltCenterMousePosition)||(e._tiltOnEllipsoid=!1,e._looking=!1),e._looking){const t=e._ellipsoid.geodeticSurfaceNormal(i.position,WY);return void ZY(e,0,n,t)}const o=e._ellipsoid.cartesianToCartographic(i.position,GY);e._tiltOnEllipsoid||o.height>e._minimumCollisionTerrainHeight?(e._tiltOnEllipsoid=!0,function(e,t,n){const i=e._ellipsoid,o=e._scene,r=o.camera,s=.25*e.minimumZoomDistance,a=i.cartesianToCartographic(r.positionWC,qY).height;if(a-s-1<J.A.EPSILON3&&n.endPosition.y-n.startPosition.y<0)return;const c=o.canvas,l=LY;l.x=c.clientWidth/2,l.y=c.clientHeight/2;const u=r.getPickRay(l,NY);let h;const A=wO.A.rayEllipsoid(u,i);if((0,d.A)(A))h=_R.A.getPoint(u,A.start,BY);else{if(!(a>e._minimumTrackBallHeight)){e._looking=!0;const i=e._ellipsoid.geodeticSurfaceNormal(r.position,WY);return ZY(e,0,n,i),void q.A.clone(t,e._tiltCenterMousePosition)}{const e=wO.A.grazingAltitudeLocation(u,i);if(!(0,d.A)(e))return;const t=i.cartesianToCartographic(e,GY);t.height=0,h=i.cartographicToCartesian(t,BY)}}const p=xe.A.eastNorthUpToFixedFrame(h,i,UY),f=e._globe,m=e._ellipsoid;e._globe=void 0,e._ellipsoid=K.A.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;const g=O.A.clone(r.transform,VY);r._setTransform(p),gY(e,0,n,j.A.UNIT_Z),r._setTransform(g),e._globe=f,e._ellipsoid=m;const _=m.maximumRadius;e._rotateFactor=1/_,e._rotateRateRangeAdjustment=_}(e,t,n)):function(e,t,n){const i=e._ellipsoid,o=e._scene,r=o.camera,s=e._cameraUnderground;let a,c,l;if(q.A.equals(t,e._tiltCenterMousePosition))a=j.A.clone(e._tiltCenter,BY);else{if(a=vW(e,t,BY),!(0,d.A)(a)){if(c=r.getPickRay(t,NY),l=wO.A.rayEllipsoid(c,i),!(0,d.A)(l)){if(i.cartesianToCartographic(r.position,GY).height<=e._minimumTrackBallHeight){e._looking=!0;const i=e._ellipsoid.geodeticSurfaceNormal(r.position,WY);ZY(e,0,n,i),q.A.clone(t,e._tiltCenterMousePosition)}return}a=_R.A.getPoint(c,l.start,BY)}s&&((0,d.A)(c)||(c=r.getPickRay(t,NY)),CW(e,c,a,a)),q.A.clone(t,e._tiltCenterMousePosition),j.A.clone(a,e._tiltCenter)}const u=o.canvas,h=LY;h.x=u.clientWidth/2,h.y=e._tiltCenterMousePosition.y,c=r.getPickRay(h,NY);const A=j.A.magnitude(a),p=j.A.fromElements(A,A,A,dY),f=K.A.fromCartesian3(p,hY);if(l=wO.A.rayEllipsoid(c,f),!(0,d.A)(l))return;const m=j.A.magnitude(c.origin)>A?l.start:l.stop,g=_R.A.getPoint(c,m,FY),_=xe.A.eastNorthUpToFixedFrame(a,i,UY),y=xe.A.eastNorthUpToFixedFrame(g,f,kY),v=e._globe,T=e._ellipsoid;e._globe=void 0,e._ellipsoid=K.A.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;let b=j.A.UNIT_Z;const w=O.A.clone(r.transform,VY);r._setTransform(y);const x=j.A.cross(g,r.positionWC,JW);if(j.A.dot(r.rightWC,x)<0){const t=n.startPosition.y-n.endPosition.y;(s&&t<0||!s&&t>0)&&(b=void 0);const i=r.constrainedAxis;r.constrainedAxis=void 0,gY(e,0,n,b,!0,!1),r.constrainedAxis=i}else gY(e,0,n,b,!0,!1);if(r._setTransform(_),gY(e,0,n,b,!1,!0),(0,d.A)(r.constrainedAxis)){const e=j.A.cross(r.direction,r.constrainedAxis,JW);j.A.equalsEpsilon(e,j.A.ZERO,J.A.EPSILON6)||(j.A.dot(e,r.right)<0&&j.A.negate(e,e),j.A.cross(e,r.direction,r.up),j.A.cross(r.direction,r.up,r.right),j.A.normalize(r.up,r.up),j.A.normalize(r.right,r.right))}r._setTransform(w),e._globe=v,e._ellipsoid=T;const C=T.maximumRadius;e._rotateFactor=1/C,e._rotateRateRangeAdjustment=C;const E=j.A.clone(r.positionWC,JW);if(e.enableCollisionDetection&&nq(e,!0),!j.A.equals(r.positionWC,E)){r._setTransform(y),r.worldToCameraCoordinatesPoint(E,E);const e=j.A.magnitudeSquared(E);j.A.magnitudeSquared(r.position)>e&&(j.A.normalize(r.position,r.position),j.A.multiplyByScalar(r.position,Math.sqrt(e),r.position));const t=j.A.angleBetween(E,r.position),n=j.A.cross(E,r.position,E);j.A.normalize(n,n);const i=To.A.fromAxisAngle(n,t,zY),o=Z.A.fromQuaternion(i,HY);Z.A.multiplyByVector(o,r.direction,r.direction),Z.A.multiplyByVector(o,r.up,r.up),j.A.cross(r.direction,r.up,r.right),j.A.cross(r.right,r.direction,r.up),r._setTransform(w)}}(e,t,n)}const qY=new X.A,jY=new q.A,QY=new q.A,XY=new _R.A,KY=new _R.A,$Y=new j.A,JY=new j.A;function ZY(e,t,n,i){const o=e._scene.camera,r=jY;r.x=n.startPosition.x,r.y=0;const s=QY;s.x=n.endPosition.x,s.y=0;let a,c,l=o.getPickRay(r,XY),u=o.getPickRay(s,KY),h=0;o.frustum instanceof ee.A?(a=l.origin,c=u.origin,j.A.add(o.direction,a,a),j.A.add(o.direction,c,c),j.A.subtract(a,o.position,a),j.A.subtract(c,o.position,c),j.A.normalize(a,a),j.A.normalize(c,c)):(a=l.direction,c=u.direction);let A=j.A.dot(a,c);A<1&&(h=Math.acos(A)),h=n.startPosition.x>n.endPosition.x?-h:h;const p=e._horizontalRotationAxis;if((0,d.A)(i)?o.look(i,-h):(0,d.A)(p)?o.look(p,-h):o.lookLeft(h),r.x=0,r.y=n.startPosition.y,s.x=0,s.y=n.endPosition.y,l=o.getPickRay(r,XY),u=o.getPickRay(s,KY),h=0,o.frustum instanceof ee.A?(a=l.origin,c=u.origin,j.A.add(o.direction,a,a),j.A.add(o.direction,c,c),j.A.subtract(a,o.position,a),j.A.subtract(c,o.position,c),j.A.normalize(a,a),j.A.normalize(c,c)):(a=l.direction,c=u.direction),A=j.A.dot(a,c),A<1&&(h=Math.acos(A)),h=n.startPosition.y>n.endPosition.y?-h:h,i=i??p,(0,d.A)(i)){const e=o.direction,t=j.A.negate(i,$Y),n=j.A.equalsEpsilon(e,i,J.A.EPSILON2),r=j.A.equalsEpsilon(e,t,J.A.EPSILON2);if(n||r)(n&&h<0||r&&h>0)&&o.look(o.right,-h);else{A=j.A.dot(e,i);let n=J.A.acosClamped(A);h>0&&h>n&&(h=n-J.A.EPSILON4),A=j.A.dot(e,t),n=J.A.acosClamped(A),h<0&&-h>n&&(h=-n+J.A.EPSILON4);const r=j.A.cross(i,e,JY);o.look(r,h)}}else o.lookUp(h)}const eq=new O.A,tq=new X.A;function nq(e,t){e._adjustedHeightForTerrain=!0;const n=e._scene,i=n.mode;if(i===Ce.A.SCENE2D||i===Ce.A.MORPHING)return;const o=n.camera,r=n.ellipsoid??K.A.WGS84,s=n.mapProjection;let a,c;O.A.equals(o.transform,O.A.IDENTITY)||(a=O.A.clone(o.transform,eq),c=j.A.magnitude(o.position),o._setTransform(O.A.IDENTITY));const l=tq;i===Ce.A.SCENE3D?r.cartesianToCartographic(o.position,l):s.unproject(o.position,l);let u=!1;if(l.height<e._minimumCollisionTerrainHeight){const n=e._scene.globeHeight;if((0,d.A)(n)){const a=n+e.minimumZoomDistance,c=n-e._lastGlobeHeight,d=c/e._lastGlobeHeight;l.height<a&&(t||Math.abs(d)<=.1)&&(l.height=a,i===Ce.A.SCENE3D?r.cartographicToCartesian(l,o.position):s.project(l,o.position),u=!0),t||Math.abs(d)<=.1?e._lastGlobeHeight=n:e._lastGlobeHeight+=.1*c}}(0,d.A)(a)&&(o._setTransform(a),u&&(j.A.normalize(o.position,o.position),j.A.negate(o.position,o.direction),j.A.multiplyByScalar(o.position,Math.max(c,e.minimumZoomDistance),o.position),j.A.normalize(o.direction,o.direction),j.A.cross(o.direction,o.up,o.right),j.A.cross(o.right,o.direction,o.up)))}MG.prototype.onMap=function(){const e=this._scene,t=e.mode,n=e.camera;return t!==Ce.A.COLUMBUS_VIEW||Math.abs(n.position.x)-this._maxCoord.x<0&&Math.abs(n.position.y)-this._maxCoord.y<0};const iq=new j.A,oq=new j.A;MG.prototype.update=function(){const e=this._scene,{camera:t,globe:n,mode:i}=e;O.A.equals(t.transform,O.A.IDENTITY)?(this._globe=n,this._ellipsoid=e.ellipsoid??K.A.default):(this._globe=void 0,this._ellipsoid=K.A.UNIT_SPHERE);const{verticalExaggeration:o,verticalExaggerationRelativeHeight:r}=e;this._minimumCollisionTerrainHeight=eM.A.getHeight(this.minimumCollisionTerrainHeight,o,r),this._minimumPickingTerrainHeight=eM.A.getHeight(this.minimumPickingTerrainHeight,o,r),this._minimumTrackBallHeight=eM.A.getHeight(this.minimumTrackBallHeight,o,r),this._cameraUnderground=e.cameraUnderground&&(0,d.A)(this._globe);const s=this._ellipsoid.maximumRadius;this._rotateFactor=1/s,this._rotateRateRangeAdjustment=s,this._adjustedHeightForTerrain=!1;const a=j.A.clone(t.positionWC,iq),c=j.A.clone(t.directionWC,oq);var l;i===Ce.A.SCENE2D?function(e){const t=e._scene.mapMode2D===kU.A.ROTATE;O.A.equals(O.A.IDENTITY,e._scene.camera.transform)?(FG(e,e.enableTranslate,e.translateEventTypes,hW,e.inertiaTranslate,"_lastInertiaTranslateMovement"),FG(e,e.enableZoom,e.zoomEventTypes,AW,e.inertiaZoom,"_lastInertiaZoomMovement"),t&&FG(e,e.enableRotate,e.tiltEventTypes,mW,e.inertiaSpin,"_lastInertiaTiltMovement")):(FG(e,e.enableZoom,e.zoomEventTypes,AW,e.inertiaZoom,"_lastInertiaZoomMovement"),t&&FG(e,e.enableRotate,e.translateEventTypes,mW,e.inertiaSpin,"_lastInertiaSpinMovement"))}(this):i===Ce.A.COLUMBUS_VIEW?(this._horizontalRotationAxis=j.A.UNIT_Z,function(e){const t=e._scene.camera;if(O.A.equals(O.A.IDENTITY,t.transform)){const n=e._tweens;if(e._aggregator.anyButtonDown&&n.removeAll(),FG(e,e.enableTilt,e.tiltEventTypes,ZW,e.inertiaSpin,"_lastInertiaTiltMovement"),FG(e,e.enableTranslate,e.translateEventTypes,UW,e.inertiaTranslate,"_lastInertiaTranslateMovement"),FG(e,e.enableZoom,e.zoomEventTypes,iY,e.inertiaZoom,"_lastInertiaZoomMovement"),FG(e,e.enableLook,e.lookEventTypes,ZY),!e._aggregator.anyButtonDown&&!n.contains(e._tween)){const i=t.createCorrectPositionTween(e.bounceAnimationTime);(0,d.A)(i)&&(e._tween=n.add(i))}n.update()}else FG(e,e.enableRotate,e.rotateEventTypes,gY,e.inertiaSpin,"_lastInertiaSpinMovement"),FG(e,e.enableZoom,e.zoomEventTypes,MY,e.inertiaZoom,"_lastInertiaZoomMovement")}(this)):i===Ce.A.SCENE3D&&(this._horizontalRotationAxis=void 0,FG(l=this,l.enableRotate,l.rotateEventTypes,mY,l.inertiaSpin,"_lastInertiaSpinMovement"),FG(l,l.enableZoom,l.zoomEventTypes,MY,l.inertiaZoom,"_lastInertiaZoomMovement"),FG(l,l.enableTilt,l.tiltEventTypes,YY,l.inertiaSpin,"_lastInertiaTiltMovement"),FG(l,l.enableLook,l.lookEventTypes,ZY)),this.enableCollisionDetection&&!this._adjustedHeightForTerrain&&nq(this,!j.A.equals(a,t.positionWC)||!j.A.equals(c,t.directionWC)),this._aggregator.reset()},MG.prototype.isDestroyed=function(){return!1},MG.prototype.destroy=function(){return this._tweens.removeAll(),this._aggregator=this._aggregator&&this._aggregator.destroy(),(0,h.A)(this)};const rq=MG;var sq=n(126797);const aq="uniform sampler2D colorTexture;\nuniform sampler2D colorTexture2;\n\nuniform vec2 center;\nuniform float radius;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    vec4 color0 = texture(colorTexture, v_textureCoordinates);\n    vec4 color1 = texture(colorTexture2, v_textureCoordinates);\n\n    float x = length(gl_FragCoord.xy - center) / radius;\n    float t = smoothstep(0.5, 0.8, x);\n    out_FragColor = mix(color0 + color1, color1, t);\n}\n",cq='uniform sampler2D colorTexture;\n\nuniform float avgLuminance;\nuniform float threshold;\nuniform float offset;\n\nin vec2 v_textureCoordinates;\n\nfloat key(float avg)\n{\n    float guess = 1.5 - (1.5 / (avg * 0.1 + 1.0));\n    return max(0.0, guess) + 0.1;\n}\n\n// See section 9. "The bright-pass filter" of Realtime HDR Rendering\n// http://www.cg.tuwien.ac.at/research/publications/2007/Luksch_2007_RHR/Luksch_2007_RHR-RealtimeHDR%20.pdf\n\nvoid main()\n{\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n    vec3 xyz = czm_RGBToXYZ(color.rgb);\n    float luminance = xyz.r;\n\n    float scaledLum = key(avgLuminance) * luminance / avgLuminance;\n    float brightLum = max(scaledLum - threshold, 0.0);\n    float brightness = brightLum / (offset + brightLum);\n\n    xyz.r = brightness;\n    out_FragColor = vec4(czm_XYZToRGB(xyz), 1.0);\n}\n';function lq(){this._sceneFramebuffer=new bk;const e=.125,t=new Array(6);t[0]=new Wz({fragmentShader:EU,textureScale:e,forcePowerOfTwo:!0,sampleMode:Nz.LINEAR});const n=t[1]=new Wz({fragmentShader:cq,uniforms:{avgLuminance:.5,threshold:.25,offset:.1},textureScale:e,forcePowerOfTwo:!0}),i=this;this._delta=1,this._sigma=2,this._blurStep=new q.A,t[2]=new Wz({fragmentShader:wz,uniforms:{step:function(){return i._blurStep.x=i._blurStep.y=1/n.outputTexture.width,i._blurStep},delta:function(){return i._delta},sigma:function(){return i._sigma},direction:0},textureScale:e,forcePowerOfTwo:!0}),t[3]=new Wz({fragmentShader:wz,uniforms:{step:function(){return i._blurStep.x=i._blurStep.y=1/n.outputTexture.width,i._blurStep},delta:function(){return i._delta},sigma:function(){return i._sigma},direction:1},textureScale:e,forcePowerOfTwo:!0}),t[4]=new Wz({fragmentShader:EU,sampleMode:Nz.LINEAR}),this._uCenter=new q.A,this._uRadius=void 0,t[5]=new Wz({fragmentShader:aq,uniforms:{center:function(){return i._uCenter},radius:function(){return i._uRadius},colorTexture2:function(){return i._sceneFramebuffer.framebuffer.getColorTexture(0)}}}),this._stages=new qz({stages:t});const o=new iH(this),r=t.length;for(let e=0;e<r;++e)t[e]._textureCache=o;this._textureCache=o,this.length=t.length}lq.prototype.get=function(e){return this._stages.get(e)},lq.prototype.getStageByName=function(e){const t=this._stages.length;for(let n=0;n<t;++n){const t=this._stages.get(n);if(t.name===e)return t}};const uq=new Q.A,dq=new q.A,hq=new q.A,Aq=new O.A;lq.prototype.clear=function(e,t,n){this._sceneFramebuffer.clear(e,t,n),this._textureCache.clear(e)},lq.prototype.update=function(e){const t=e.context,n=e.viewport,i=this._sceneFramebuffer;i.update(t,n);const o=i.framebuffer;return this._textureCache.update(t),this._stages.update(t,!1),function(e,t,n){const i=t.uniformState,o=i.sunPositionWC,r=i.view,s=i.viewProjection,a=i.projection;let l=O.A.computeViewportTransformation(n,0,1,Aq);const u=O.A.multiplyByPoint(r,o,uq);let d=xe.A.pointToGLWindowCoordinates(s,l,o,dq);u.x+=J.A.SOLAR_RADIUS;const h=xe.A.pointToGLWindowCoordinates(a,l,u,u),A=30*q.A.magnitude(q.A.subtract(h,d,h))*2,p=hq;p.x=A,p.y=A,e._uCenter=q.A.clone(d,e._uCenter),e._uRadius=.15*Math.max(p.x,p.y);const f=t.drawingBufferWidth,m=t.drawingBufferHeight,g=e._stages,_=g.get(0),y=_.outputTexture.width,v=_.outputTexture.height,T=new c.A;T.width=y,T.height=v,l=O.A.computeViewportTransformation(T,0,1,Aq),d=xe.A.pointToGLWindowCoordinates(s,l,o,dq),p.x*=y/f,p.y*=v/m;const b=_.scissorRectangle;b.x=Math.max(d.x-.5*p.x,0),b.y=Math.max(d.y-.5*p.y,0),b.width=Math.min(p.x,f),b.height=Math.min(p.y,m);for(let e=1;e<4;++e)c.A.clone(b,g.get(e).scissorRectangle)}(this,t,n),o},lq.prototype.execute=function(e){const t=this._sceneFramebuffer.framebuffer.getColorTexture(0),n=this._stages,i=n.length;n.get(0).execute(e,t);for(let t=1;t<i;++t)n.get(t).execute(e,n.get(t-1).outputTexture)},lq.prototype.copy=function(e,t){if(!(0,d.A)(this._copyColorCommand)){const t=this;this._copyColorCommand=e.createViewportQuadCommand(EU,{uniformMap:{colorTexture:function(){return t._stages.get(t._stages.length-1).outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},lq.prototype.isDestroyed=function(){return!1},lq.prototype.destroy=function(){return this._textureCache.destroy(),this._stages.destroy(),(0,h.A)(this)};const pq=lq;function fq(){this._cachedShowFrustumsShaders={}}const mq=new u.A,gq=new m.A;fq.prototype.executeDebugShowFrustumsCommand=function(e,t,n){const i=t.shaderProgram.id;let o=this._cachedShowFrustumsShaders[i];(0,d.A)(o)||(o=function(e,t){const n=e.context,i=t,o=i.fragmentShaderSource.clone(),r=[];o.sources=o.sources.map(function(e){e=k.A.replaceMain(e,"czm_Debug_main");const t=/out_FragData_(\d+)/g;let n;for(;null!==(n=t.exec(e));)-1===r.indexOf(n[1])&&r.push(n[1]);return e});const s=r.length;let a,c="";if(c+="uniform vec3 debugShowCommandsColor;\n",c+="uniform vec3 debugShowFrustumsColor;\n",c+="void main() \n{ \n    czm_Debug_main(); \n",s>0)for(a=0;a<s;++a)c+=`    out_FragData_${r[a]}.rgb *= debugShowCommandsColor;\n`,c+=`    out_FragData_${r[a]}.rgb *= debugShowFrustumsColor;\n`;else c+="    out_FragColor.rgb *= debugShowCommandsColor;\n",c+="    out_FragColor.rgb *= debugShowFrustumsColor;\n";c+="}",o.sources.push(c);const l=function(e){const t={},n=e.vertexAttributes;for(const e in n)n.hasOwnProperty(e)&&(t[e]=n[e].index);return t}(i);return y.A.fromCache({context:n,vertexShaderSource:i.vertexShaderSource,fragmentShaderSource:o,attributeLocations:l})}(e,t.shaderProgram),this._cachedShowFrustumsShaders[i]=o);const r=m.A.shallowClone(t,gq);r.shaderProgram=o,r.uniformMap=function(e,t){let n;return n=(0,d.A)(t.uniformMap)?t.uniformMap:{},(0,d.A)(n.debugShowCommandsColor)||(0,d.A)(n.debugShowFrustumsColor)||(n.debugShowCommandsColor=function(){return e.debugShowCommands?((0,d.A)(t._debugColor)||(t._debugColor=u.A.fromRandom()),t._debugColor):u.A.WHITE},n.debugShowFrustumsColor=function(){return e.debugShowFrustums?(mq.red=1&t.debugOverlappingFrustums?1:0,mq.green=2&t.debugOverlappingFrustums?1:0,mq.blue=4&t.debugOverlappingFrustums?1:0,mq.alpha=1,mq):u.A.WHITE}),n}(e,t),r.execute(e.context,n)};const _q=fq;function yq(e,t,n){this._primitive=e,this._tileIndex=t,this._sampleIndex=n,this._metadata={},this._orientedBoundingBox=new lD.A}yq.fromKeyframeNode=function(e,t,n,i){l.A.typeOf.object("primitive",e),l.A.typeOf.number("tileIndex",t),l.A.typeOf.number("sampleIndex",n),l.A.typeOf.object("keyframeNode",i);const o=new yq(e,t,n),{spatialNode:r,content:s}=i;return o._metadata=function(e,t,n){if(!(0,d.A)(t)||!(0,d.A)(t.metadata))return;const{names:i,types:o}=e.provider,{metadata:r}=t,s={};for(let e=0;e<i.length;e++){const t=i[e],a=yF.A.getComponentCount(o[e]),c=r[e].slice(n*a,(n+1)*a);s[t]=c}return s}(e,s,n),o._orientedBoundingBox=function(e,t,n,i){const o=t.dimensions,r=o.x*o.y,s=Math.floor(n/r),a=n-s*r,c=Math.floor(a/o.x),l=a-c*o.x,u=j.A.fromElements(l,c,s,vq),d=j.A.divideComponents(j.A.subtract(u,e._paddingBefore,vq),e.dimensions,Tq);return e._shape.computeOrientedBoundingBoxForSample(t,e.dimensions,d,i)}(e,r,n,o._orientedBoundingBox),o};const vq=new j.A,Tq=new j.A;Object.defineProperties(yq.prototype,{metadata:{get:function(){return this._metadata}},primitive:{get:function(){return this._primitive}},sampleIndex:{get:function(){return this._sampleIndex}},tileIndex:{get:function(){return this._tileIndex}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox.clone()}}}),yq.prototype.hasProperty=function(e){return(0,d.A)(this._metadata[e])},yq.prototype.getNames=function(){return Object.keys(this._metadata)},yq.prototype.getProperty=function(e){return this._metadata[e]};const bq=yq,wq="struct Ray {\n    vec3 pos;\n    vec3 dir;\n    vec3 rawDir;\n};\n\n#if defined(JITTER)\n/**\n * Generate a pseudo-random value for a given 2D screen coordinate.\n * Similar to https://www.shadertoy.com/view/4djSRW with a modified hashscale.\n */\nfloat hash(vec2 p)\n{\n    vec3 p3 = fract(vec3(p.xyx) * 50.0);\n    p3 += dot(p3, p3.yzx + 19.19);\n    return fract((p3.x + p3.y) * p3.z);\n}\n#endif\n\nfloat minComponent(in vec3 v) {\n    return min(min(v.x, v.y), v.z);\n}\n\nfloat maxComponent(in vec3 v) {\n    return max(max(v.x, v.y), v.z);\n}\n\nstruct PointJacobianT {\n    vec3 point;\n    mat3 jacobianT;\n};\n",xq="// See Intersection.glsl for the definition of intersectScene\n// See IntersectionUtils.glsl for the definition of nextIntersection\n// See convertUvToBox.glsl, convertUvToCylinder.glsl, or convertUvToEllipsoid.glsl\n// for the definition of convertUvToShapeUvSpace. The appropriate function is \n// selected based on the VoxelPrimitive shape type, and added to the shader in\n// Scene/VoxelRenderResources.js.\n// See Octree.glsl for the definitions of TraversalData, SampleData,\n// traverseOctreeFromBeginning, and traverseOctreeFromExisting\n// See Megatexture.glsl for the definition of accumulatePropertiesFromMegatexture\n\n#define STEP_COUNT_MAX 1000 // Harcoded value because GLSL doesn't like variable length loops\n#if defined(PICKING_VOXEL)\n    #define ALPHA_ACCUM_MAX 0.1\n#else\n    #define ALPHA_ACCUM_MAX 0.98 // Must be > 0.0 and <= 1.0\n#endif\n\nuniform mat4 u_transformPositionUvToView;\nuniform mat3 u_transformDirectionViewToLocal;\nuniform vec3 u_cameraPositionUv;\nuniform vec3 u_cameraDirectionUv;\nuniform float u_stepSize;\n\n#if defined(PICKING)\n    uniform vec4 u_pickColor;\n#endif\n\nvec3 getSampleSize(in int level) {\n    vec3 sampleCount = exp2(float(level)) * vec3(u_dimensions);\n    vec3 sampleSizeUv = 1.0 / sampleCount;\n    return scaleShapeUvToShapeSpace(sampleSizeUv);\n}\n\n#define MINIMUM_STEP_SCALAR (0.02)\n#define SHIFT_FRACTION (0.001)\n\n/**\n * Given a coordinate within a tile, and sample spacings along a ray through\n * the coordinate, find the distance to the points where the ray entered and\n * exited the voxel cell, along with the surface normals at those points.\n * The surface normals are returned in shape space coordinates.\n */\nRayShapeIntersection getVoxelIntersection(in vec3 tileUv, in vec3 sampleSizeAlongRay) {\n    vec3 voxelCoord = tileUv * vec3(u_dimensions);\n    vec3 directions = sign(sampleSizeAlongRay);\n    vec3 positiveDirections = max(directions, 0.0);\n    vec3 entryCoord = mix(ceil(voxelCoord), floor(voxelCoord), positiveDirections);\n    vec3 exitCoord = entryCoord + directions;\n\n    vec3 distanceFromEntry = -abs((entryCoord - voxelCoord) * sampleSizeAlongRay);\n    float lastEntry = maxComponent(distanceFromEntry);\n    bvec3 isLastEntry = equal(distanceFromEntry, vec3(lastEntry));\n    vec3 entryNormal = -1.0 * vec3(isLastEntry) * directions;\n    vec4 entry = vec4(entryNormal, lastEntry);\n\n    vec3 distanceToExit = abs((exitCoord - voxelCoord) * sampleSizeAlongRay);\n    float firstExit = minComponent(distanceToExit);\n    bvec3 isFirstExit = equal(distanceToExit, vec3(firstExit));\n    vec3 exitNormal = vec3(isFirstExit) * directions;\n    vec4 exit = vec4(exitNormal, firstExit);\n\n    return RayShapeIntersection(entry, exit);\n}\n\nvec4 getStepSize(in SampleData sampleData, in Ray viewRay, in RayShapeIntersection shapeIntersection, in mat3 jacobianT, in float currentT) {\n    // The Jacobian is computed in a space where the shape spans [-1, 1].\n    // But the ray is marched in a space where the shape fills [0, 1].\n    // So we need to scale the Jacobian by 2.\n    vec3 gradient = 2.0 * viewRay.rawDir * jacobianT;\n    vec3 sampleSizeAlongRay = getSampleSize(sampleData.tileCoords.w) / gradient;\n\n    RayShapeIntersection voxelIntersection = getVoxelIntersection(sampleData.tileUv, sampleSizeAlongRay);\n\n    // Transform normal from shape space to Cartesian space\n    vec3 voxelNormal = normalize(jacobianT * voxelIntersection.entry.xyz);\n    // Compare with the shape intersection, to choose the appropriate normal\n    vec4 voxelEntry = vec4(voxelNormal, currentT + voxelIntersection.entry.w);\n    vec4 entry = intersectionMax(shapeIntersection.entry, voxelEntry);\n\n    float fixedStep = minComponent(abs(sampleSizeAlongRay)) * u_stepSize;\n    float shift = fixedStep * SHIFT_FRACTION;\n    float dt = voxelIntersection.exit.w + shift;\n    if ((currentT + dt) > shapeIntersection.exit.w) {\n        // Stop at end of shape\n        dt = shapeIntersection.exit.w - currentT + shift;\n    }\n    float stepSize = clamp(dt, fixedStep * MINIMUM_STEP_SCALAR, fixedStep + shift);\n\n    return vec4(entry.xyz, stepSize);\n}\n\nvec2 packIntToVec2(int value) {\n    float shifted = float(value) / 255.0;\n    float lowBits = fract(shifted);\n    float highBits = floor(shifted) / 255.0;\n    return vec2(highBits, lowBits);\n}\n\nvec2 packFloatToVec2(float value) {\n    float lowBits = fract(value);\n    float highBits = floor(value) / 255.0;\n    return vec2(highBits, lowBits);\n}\n\nint getSampleIndex(in SampleData sampleData) {\n    // tileUv = 1.0 is a valid coordinate but sampleIndex = u_inputDimensions is not.\n    // (tileUv = 1.0 corresponds to the far edge of the last sample, at index = u_inputDimensions - 1).\n    // Clamp to [0, voxelDimensions - 0.5) to avoid numerical error before flooring\n    vec3 maxCoordinate = vec3(u_inputDimensions) - vec3(0.5);\n    vec3 inputCoordinate = clamp(sampleData.inputCoordinate, vec3(0.0), maxCoordinate);\n    ivec3 sampleIndex = ivec3(floor(inputCoordinate));\n    // Convert to a 1D index for lookup in a 1D data array\n    return sampleIndex.x + u_inputDimensions.x * (sampleIndex.y + u_inputDimensions.y * sampleIndex.z);\n}\n\n/**\n * Compute the view ray at the current fragment, in the local UV coordinates of the shape.\n */\nRay getViewRayUv() {\n    vec4 eyeCoordinates = czm_windowToEyeCoordinates(gl_FragCoord);\n    vec3 viewDirUv;\n    vec3 viewPosUv;\n    if (czm_orthographicIn3D == 1.0) {\n        eyeCoordinates.z = 0.0;\n        viewPosUv = (u_transformPositionViewToUv * eyeCoordinates).xyz;\n        viewDirUv = normalize(u_cameraDirectionUv);\n    } else {\n        viewPosUv = u_cameraPositionUv;\n        viewDirUv = normalize(u_transformDirectionViewToLocal * eyeCoordinates.xyz);\n    }\n    #if defined(SHAPE_ELLIPSOID)\n        // viewDirUv has been scaled to a space where the ellipsoid is a sphere.\n        // Undo this scaling to get the raw direction.\n        vec3 rawDir = viewDirUv * u_ellipsoidRadiiUv;\n        return Ray(viewPosUv, viewDirUv, rawDir);\n    #else\n        return Ray(viewPosUv, viewDirUv, viewDirUv);\n    #endif\n}\n\nvoid main()\n{\n    Ray viewRayUv = getViewRayUv();\n\n    Intersections ix;\n    vec2 screenCoord = (gl_FragCoord.xy - czm_viewport.xy) / czm_viewport.zw; // [0,1]\n    RayShapeIntersection shapeIntersection = intersectScene(screenCoord, viewRayUv, ix);\n    // Exit early if the scene was completely missed.\n    if (shapeIntersection.entry.w == NO_HIT) {\n        discard;\n    }\n\n    float currentT = shapeIntersection.entry.w;\n    float endT = shapeIntersection.exit.w;\n    vec3 positionUv = viewRayUv.pos + currentT * viewRayUv.dir;\n    PointJacobianT pointJacobian = convertUvToShapeUvSpaceDerivative(positionUv);\n\n    // Traverse the tree from the start position\n    TraversalData traversalData;\n    SampleData sampleDatas[SAMPLE_COUNT];\n    traverseOctreeFromBeginning(pointJacobian.point, traversalData, sampleDatas);\n    vec4 step = getStepSize(sampleDatas[0], viewRayUv, shapeIntersection, pointJacobian.jacobianT, currentT);\n\n    #if defined(JITTER)\n        float noise = hash(screenCoord); // [0,1]\n        currentT += noise * step.w;\n        positionUv += noise * step.w * viewRayUv.dir;\n    #endif\n\n    FragmentInput fragmentInput;\n    #if defined(STATISTICS)\n        setStatistics(fragmentInput.metadataStatistics);\n    #endif\n\n    czm_modelMaterial materialOutput;\n    vec4 colorAccum = vec4(0.0);\n\n    for (int stepCount = 0; stepCount < STEP_COUNT_MAX; ++stepCount) {\n        // Read properties from the megatexture based on the traversal state\n        Properties properties = accumulatePropertiesFromMegatexture(sampleDatas);\n\n        // Prepare the custom shader inputs\n        copyPropertiesToMetadata(properties, fragmentInput.metadata);\n\n        fragmentInput.attributes.positionEC = vec3(u_transformPositionUvToView * vec4(positionUv, 1.0));\n        fragmentInput.attributes.normalEC = normalize(czm_normal * step.xyz);\n\n        fragmentInput.voxel.viewDirUv = viewRayUv.dir;\n\n        fragmentInput.voxel.travelDistance = step.w;\n        fragmentInput.voxel.stepCount = stepCount;\n        fragmentInput.voxel.tileIndex = sampleDatas[0].megatextureIndex;\n        fragmentInput.voxel.sampleIndex = getSampleIndex(sampleDatas[0]);\n        fragmentInput.voxel.distanceToDepthBuffer = ix.distanceToDepthBuffer - currentT;\n\n        // Run the custom shader\n        fragmentMain(fragmentInput, materialOutput);\n\n        // Sanitize the custom shader output\n        vec4 color = vec4(materialOutput.diffuse, materialOutput.alpha);\n        color.rgb = max(color.rgb, vec3(0.0));\n        color.a = clamp(color.a, 0.0, 1.0);\n\n        // Pre-multiplied alpha blend\n        colorAccum += (1.0 - colorAccum.a) * vec4(color.rgb * color.a, color.a);\n\n        // Stop traversing if the alpha has been fully saturated\n        if (colorAccum.a > ALPHA_ACCUM_MAX) {\n            colorAccum.a = ALPHA_ACCUM_MAX;\n            break;\n        }\n\n        if (step.w == 0.0) {\n            // Shape is infinitely thin. The ray may have hit the edge of a\n            // foreground voxel. Step ahead slightly to check for more voxels\n            step.w == 0.00001;\n        }\n\n        // Keep raymarching\n        currentT += step.w;\n        // Check if there's more intersections.\n        if (currentT > endT) {\n            #if (INTERSECTION_COUNT == 1)\n                break;\n            #else\n                shapeIntersection = nextIntersection(ix);\n                if (shapeIntersection.entry.w == NO_HIT) {\n                    break;\n                } else {\n                    // Found another intersection. Resume raymarching there\n                    currentT = shapeIntersection.entry.w;\n                    endT = shapeIntersection.exit.w;\n                }\n            #endif\n        }\n        positionUv = viewRayUv.pos + currentT * viewRayUv.dir;\n\n        // Traverse the tree from the current ray position.\n        // This is similar to traverseOctreeFromBeginning but is faster when the ray is in the same tile as the previous step.\n        pointJacobian = convertUvToShapeUvSpaceDerivative(positionUv);\n        traverseOctreeFromExisting(pointJacobian.point, traversalData, sampleDatas);\n        step = getStepSize(sampleDatas[0], viewRayUv, shapeIntersection, pointJacobian.jacobianT, currentT);\n    }\n\n    // Convert the alpha from [0,ALPHA_ACCUM_MAX] to [0,1]\n    colorAccum.a /= ALPHA_ACCUM_MAX;\n\n    #if defined(PICKING)\n        // If alpha is 0.0 there is nothing to pick\n        if (colorAccum.a == 0.0) {\n            discard;\n        }\n        out_FragColor = u_pickColor;\n    #elif defined(PICKING_VOXEL)\n        // If alpha is 0.0 there is nothing to pick\n        if (colorAccum.a == 0.0) {\n            discard;\n        }\n        vec2 megatextureId = packIntToVec2(sampleDatas[0].megatextureIndex);\n        vec2 sampleIndex = packIntToVec2(getSampleIndex(sampleDatas[0]));\n        out_FragColor = vec4(megatextureId, sampleIndex);\n    #else\n        out_FragColor = colorAccum;\n    #endif\n}\n",Cq="in vec2 position;\n\nuniform vec4 u_ndcSpaceAxisAlignedBoundingBox;\n\nvoid main() {\n    vec2 aabbMin = u_ndcSpaceAxisAlignedBoundingBox.xy;\n    vec2 aabbMax = u_ndcSpaceAxisAlignedBoundingBox.zw;\n    vec2 translation = 0.5 * (aabbMax + aabbMin);\n    vec2 scale = 0.5 * (aabbMax - aabbMin);\n    gl_Position = vec4(position * scale + translation, 0.0, 1.0);\n}\n",Eq="/* Intersection defines\n#define INTERSECTION_COUNT ###\n*/\n\n#define NO_HIT (-czm_infinity)\n#define INF_HIT (czm_infinity * 0.5)\n\nstruct RayShapeIntersection {\n    vec4 entry;\n    vec4 exit;\n};\n\nvec4 intersectionMin(in vec4 intersect0, in vec4 intersect1)\n{\n    if (intersect0.w == NO_HIT) {\n        return intersect1;\n    } else if (intersect1.w == NO_HIT) {\n        return intersect0;\n    }\n    return (intersect0.w <= intersect1.w) ? intersect0 : intersect1;\n}\n\nvec4 intersectionMax(in vec4 intersect0, in vec4 intersect1)\n{\n    return (intersect0.w >= intersect1.w) ? intersect0 : intersect1;\n}\n\nRayShapeIntersection intersectIntersections(in Ray ray, in RayShapeIntersection intersect0, in RayShapeIntersection intersect1)\n{\n    bool missed = (intersect0.entry.w == NO_HIT) ||\n        (intersect1.entry.w == NO_HIT) ||\n        (intersect0.exit.w < intersect1.entry.w) ||\n        (intersect0.entry.w > intersect1.exit.w);\n    if (missed) {\n        vec4 miss = vec4(normalize(ray.dir), NO_HIT);\n        return RayShapeIntersection(miss, miss);\n    }\n\n    vec4 entry = intersectionMax(intersect0.entry, intersect1.entry);\n    vec4 exit = intersectionMin(intersect0.exit, intersect1.exit);\n\n    return RayShapeIntersection(entry, exit);\n}\n\nstruct Intersections {\n    // Don't access these member variables directly - call the functions instead.\n\n    // Store an array of ray-surface intersections. Each intersection is composed of:\n    //  .xyz for the surface normal at the intersection point\n    //  .w for the T value\n    // The scale of the normal encodes the shape intersection type:\n    //  length(intersection.xyz) = 1: positive shape entry\n    //  length(intersection.xyz) = 2: positive shape exit\n    //  length(intersection.xyz) = 3: negative shape entry\n    //  length(intersection.xyz) = 4: negative shape exit\n    // INTERSECTION_COUNT is the number of ray-*shape* (volume) intersections,\n    // so we need twice as many to track ray-*surface* intersections\n    vec4 intersections[INTERSECTION_COUNT * 2];\n    float distanceToDepthBuffer;\n\n    #if (INTERSECTION_COUNT > 1)\n        // Maintain state for future nextIntersection calls\n        int index;\n        int surroundCount;\n        bool surroundIsPositive;\n    #endif\n};\n\nRayShapeIntersection getFirstIntersection(in Intersections ix) \n{\n    return RayShapeIntersection(ix.intersections[0], ix.intersections[1]);\n}\n\nvec4 encodeIntersectionType(vec4 intersection, int index, bool entry)\n{\n    float scale = float(index > 0) * 2.0 + float(!entry) + 1.0;\n    return vec4(intersection.xyz * scale, intersection.w);\n}\n\n// Use defines instead of real functions because WebGL1 cannot access array with non-constant index.\n#define setIntersection(/*inout Intersections*/ ix, /*int*/ index, /*float*/ t, /*bool*/ positive, /*bool*/ enter) (ix).intersections[(index)] = vec4(0.0, float(!positive) * 2.0 + float(!enter) + 1.0, 0.0, (t))\n#define setIntersectionPair(/*inout Intersections*/ ix, /*int*/ index, /*vec2*/ entryExit) (ix).intersections[(index) * 2 + 0] = vec4(0.0, float((index) > 0) * 2.0 + 1.0, 0.0, (entryExit).x); (ix).intersections[(index) * 2 + 1] = vec4(0.0, float((index) > 0) * 2.0 + 2.0, 0.0, (entryExit).y)\n#define setSurfaceIntersection(/*inout Intersections*/ ix, /*int*/ index, /*vec4*/ intersection, /*bool*/ positive, /*bool*/ enter) (ix).intersections[(index)] = encodeIntersectionType((intersection), int(!positive), (enter))\n#define setShapeIntersection(/*inout Intersections*/ ix, /*int*/ index, /*RayShapeIntersection*/ intersection) (ix).intersections[(index) * 2 + 0] = encodeIntersectionType((intersection).entry, (index), true); (ix).intersections[(index) * 2 + 1] = encodeIntersectionType((intersection).exit, (index), false)\n\n#if (INTERSECTION_COUNT > 1)\nvoid initializeIntersections(inout Intersections ix) {\n    // Sort the intersections from min T to max T with bubble sort.\n    // Note: If this sorting function changes, some of the intersection test may\n    // need to be updated. Search for \"bubble sort\" to find those areas.\n    const int sortPasses = INTERSECTION_COUNT * 2 - 1;\n    for (int n = sortPasses; n > 0; --n) {\n        for (int i = 0; i < sortPasses; ++i) {\n            // The loop should be: for (i = 0; i < n; ++i) {...} but WebGL1 cannot\n            // loop with non-constant condition, so it has to break early instead\n            if (i >= n) { break; }\n\n            vec4 intersect0 = ix.intersections[i + 0];\n            vec4 intersect1 = ix.intersections[i + 1];\n\n            bool inOrder = intersect0.w <= intersect1.w;\n\n            ix.intersections[i + 0] = inOrder ? intersect0 : intersect1;\n            ix.intersections[i + 1] = inOrder ? intersect1 : intersect0;\n        }\n    }\n\n    // Prepare initial state for nextIntersection\n    ix.index = 0;\n    ix.surroundCount = 0;\n    ix.surroundIsPositive = false;\n}\n#endif\n\n#if (INTERSECTION_COUNT > 1)\nRayShapeIntersection nextIntersection(inout Intersections ix) {\n    vec4 surfaceIntersection = vec4(0.0, 0.0, 0.0, NO_HIT);\n    RayShapeIntersection shapeIntersection = RayShapeIntersection(surfaceIntersection, surfaceIntersection);\n\n    const int passCount = INTERSECTION_COUNT * 2;\n\n    if (ix.index == passCount) {\n        return shapeIntersection;\n    }\n\n    for (int i = 0; i < passCount; ++i) {\n        // The loop should be: for (i = ix.index; i < passCount; ++i) {...} but WebGL1 cannot\n        // loop with non-constant condition, so it has to continue instead.\n        if (i < ix.index) {\n            continue;\n        }\n\n        ix.index = i + 1;\n\n        surfaceIntersection = ix.intersections[i];\n        int intersectionType = int(length(surfaceIntersection.xyz) - 0.5);\n        bool currShapeIsPositive = intersectionType < 2;\n        bool enter = intMod(intersectionType, 2) == 0;\n\n        ix.surroundCount += enter ? +1 : -1;\n        ix.surroundIsPositive = currShapeIsPositive ? enter : ix.surroundIsPositive;\n\n        // entering positive or exiting negative\n        if (ix.surroundCount == 1 && ix.surroundIsPositive && enter == currShapeIsPositive) {\n            shapeIntersection.entry = surfaceIntersection;\n        }\n\n        // exiting positive or entering negative after being inside positive\n        bool exitPositive = !enter && currShapeIsPositive && ix.surroundCount == 0;\n        bool enterNegativeFromPositive = enter && !currShapeIsPositive && ix.surroundCount == 2 && ix.surroundIsPositive;\n        if (exitPositive || enterNegativeFromPositive) {\n            shapeIntersection.exit = surfaceIntersection;\n\n            // entry and exit have been found, so the loop can stop\n            if (exitPositive) {\n                // After exiting positive shape there is nothing left to intersect, so jump to the end index.\n                ix.index = passCount;\n            }\n            break;\n        }\n    }\n\n    return shapeIntersection;\n}\n#endif\n\n// NOTE: initializeIntersections, nextIntersection aren't even declared unless INTERSECTION_COUNT > 1\n",Sq="// See IntersectionUtils.glsl for the definitions of Ray, Intersections,\n// setIntersectionPair, INF_HIT, NO_HIT\n\n/* intersectDepth defines (set in Scene/VoxelRenderResources.js)\n#define DEPTH_INTERSECTION_INDEX ###\n*/\n\nuniform mat4 u_transformPositionViewToUv;\n\nvoid intersectDepth(in vec2 screenCoord, in Ray ray, inout Intersections ix) {\n    float logDepthOrDepth = czm_unpackDepth(texture(czm_globeDepthTexture, screenCoord));\n    float entry;\n    float exit;\n    if (logDepthOrDepth != 0.0) {\n        // Calculate how far the ray must travel before it hits the depth buffer.\n        vec4 eyeCoordinateDepth = czm_screenToEyeCoordinates(screenCoord, logDepthOrDepth);\n        eyeCoordinateDepth /= eyeCoordinateDepth.w;\n        vec3 depthPositionUv = vec3(u_transformPositionViewToUv * eyeCoordinateDepth);\n        entry = dot(depthPositionUv - ray.pos, ray.dir);\n        exit = +INF_HIT;\n    } else {\n        // There's no depth at this location.\n        entry = NO_HIT;\n        exit = NO_HIT;\n    }\n    ix.distanceToDepthBuffer = entry;\n#if defined(DEPTH_TEST)\n    setIntersectionPair(ix, DEPTH_INTERSECTION_INDEX, vec2(entry, exit));\n#endif\n}\n",Iq="// See IntersectionUtils.glsl for the definitions of Ray, Intersections, INF_HIT,\n// NO_HIT, setShapeIntersection\n\n/* Clipping plane defines (set in Scene/VoxelRenderResources.js)\n#define CLIPPING_PLANES_UNION\n#define CLIPPING_PLANES_COUNT\n#define CLIPPING_PLANES_INTERSECTION_INDEX\n*/\n\nuniform sampler2D u_clippingPlanesTexture;\nuniform mat4 u_clippingPlanesMatrix;\n\n// Plane is in Hessian Normal Form\nvec4 intersectPlane(in Ray ray, in vec4 plane) {\n    vec3 n = plane.xyz; // normal\n    float w = plane.w; // -dot(pointOnPlane, normal)\n\n    float a = dot(ray.pos, n);\n    float b = dot(ray.dir, n);\n    float t = -(w + a) / b;\n\n    return vec4(n, t);\n}\n\nvoid intersectClippingPlanes(in Ray ray, inout Intersections ix) {\n    vec4 backSide = vec4(-ray.dir, -INF_HIT);\n    vec4 farSide = vec4(ray.dir, +INF_HIT);\n    RayShapeIntersection clippingVolume;\n\n    #if (CLIPPING_PLANES_COUNT == 1)\n        // Union and intersection are the same when there's one clipping plane, and the code\n        // is more simplified.\n        vec4 planeUv = getClippingPlane(u_clippingPlanesTexture, 0, u_clippingPlanesMatrix);\n        vec4 intersection = intersectPlane(ray, planeUv);\n        bool reflects = dot(ray.dir, intersection.xyz) < 0.0;\n        clippingVolume.entry = reflects ? backSide : intersection;\n        clippingVolume.exit = reflects ? intersection : farSide;\n        setShapeIntersection(ix, CLIPPING_PLANES_INTERSECTION_INDEX, clippingVolume);\n    #elif defined(CLIPPING_PLANES_UNION)\n        vec4 firstTransmission = vec4(ray.dir, +INF_HIT);\n        vec4 lastReflection = vec4(-ray.dir, -INF_HIT);\n        for (int i = 0; i < CLIPPING_PLANES_COUNT; i++) {\n            vec4 planeUv = getClippingPlane(u_clippingPlanesTexture, i, u_clippingPlanesMatrix);\n            vec4 intersection = intersectPlane(ray, planeUv);\n            if (dot(ray.dir, planeUv.xyz) > 0.0) {\n                firstTransmission = intersection.w <= firstTransmission.w ? intersection : firstTransmission;\n            } else {\n                lastReflection = intersection.w >= lastReflection.w ? intersection : lastReflection;\n            }\n        }\n        clippingVolume.entry = backSide;\n        clippingVolume.exit = lastReflection;\n        setShapeIntersection(ix, CLIPPING_PLANES_INTERSECTION_INDEX + 0, clippingVolume);\n        clippingVolume.entry = firstTransmission;\n        clippingVolume.exit = farSide;\n        setShapeIntersection(ix, CLIPPING_PLANES_INTERSECTION_INDEX + 1, clippingVolume);\n    #else // intersection\n        vec4 lastTransmission = vec4(ray.dir, -INF_HIT);\n        vec4 firstReflection = vec4(-ray.dir, +INF_HIT);\n        for (int i = 0; i < CLIPPING_PLANES_COUNT; i++) {\n            vec4 planeUv = getClippingPlane(u_clippingPlanesTexture, i, u_clippingPlanesMatrix);\n            vec4 intersection = intersectPlane(ray, planeUv);\n            if (dot(ray.dir, planeUv.xyz) > 0.0) {\n                lastTransmission = intersection.w > lastTransmission.w ? intersection : lastTransmission;\n            } else {\n                firstReflection = intersection.w < firstReflection.w ? intersection: firstReflection;\n            }\n        }\n        if (lastTransmission.w < firstReflection.w) {\n            clippingVolume.entry = lastTransmission;\n            clippingVolume.exit = firstReflection;\n        } else {\n            clippingVolume.entry = vec4(-ray.dir, NO_HIT);\n            clippingVolume.exit = vec4(ray.dir, NO_HIT);\n        }\n        setShapeIntersection(ix, CLIPPING_PLANES_INTERSECTION_INDEX, clippingVolume);\n    #endif\n}\n",Pq='// See IntersectionUtils.glsl for the definitions of Ray, NO_HIT, INF_HIT,\n// RayShapeIntersection\n\nvec4 intersectLongitude(in Ray ray, in float angle, in bool positiveNormal) {\n    float normalSign = positiveNormal ? 1.0 : -1.0;\n    vec2 planeNormal = vec2(-sin(angle), cos(angle)) * normalSign;\n\n    vec2 position = ray.pos.xy;\n    vec2 direction = ray.dir.xy;\n    float approachRate = dot(direction, planeNormal);\n    float distance = -dot(position, planeNormal);\n\n    float t = (approachRate == 0.0)\n        ? NO_HIT\n        : distance / approachRate;\n\n    return vec4(planeNormal, 0.0, t);\n}\n\nRayShapeIntersection intersectHalfSpace(in Ray ray, in float angle, in bool positiveNormal)\n{\n    vec4 intersection = intersectLongitude(ray, angle, positiveNormal);\n    vec4 farSide = vec4(normalize(ray.dir), INF_HIT);\n\n    bool hitFront = (intersection.w > 0.0) == (dot(ray.pos.xy, intersection.xy) > 0.0);\n    if (!hitFront) {\n        return RayShapeIntersection(intersection, farSide);\n    } else {\n        return RayShapeIntersection(-1.0 * farSide, intersection);\n    }\n}\n\nvoid intersectFlippedWedge(in Ray ray, in vec2 minMaxAngle, out RayShapeIntersection intersections[2])\n{\n    intersections[0] = intersectHalfSpace(ray, minMaxAngle.x, false);\n    intersections[1] = intersectHalfSpace(ray, minMaxAngle.y, true);\n}\n\nbool hitPositiveHalfPlane(in Ray ray, in vec4 intersection, in bool positiveNormal) {\n    float normalSign = positiveNormal ? 1.0 : -1.0;\n    vec2 planeDirection = vec2(intersection.y, -intersection.x) * normalSign;\n    vec2 hit = ray.pos.xy + intersection.w * ray.dir.xy;\n    return dot(hit, planeDirection) > 0.0;\n}\n\nvoid intersectHalfPlane(in Ray ray, in float angle, out RayShapeIntersection intersections[2]) {\n    vec4 intersection = intersectLongitude(ray, angle, true);\n    vec4 farSide = vec4(normalize(ray.dir), INF_HIT);\n\n    if (hitPositiveHalfPlane(ray, intersection, true)) {\n        intersections[0].entry = -1.0 * farSide;\n        intersections[0].exit = vec4(-1.0 * intersection.xy, 0.0, intersection.w);\n        intersections[1].entry = intersection;\n        intersections[1].exit = farSide;\n    } else {\n        vec4 miss = vec4(normalize(ray.dir), NO_HIT);\n        intersections[0].entry = -1.0 * farSide;\n        intersections[0].exit = farSide;\n        intersections[1].entry = miss;\n        intersections[1].exit = miss;\n    }\n}\n\nRayShapeIntersection intersectRegularWedge(in Ray ray, in vec2 minMaxAngle)\n{\n    // Note: works for maxAngle > minAngle + pi, where the "regular wedge"\n    // is actually a negative volume.\n    // Compute intersections with the two planes.\n    // Normals will point toward the "outside" (negative space)\n    vec4 intersect1 = intersectLongitude(ray, minMaxAngle.x, false);\n    vec4 intersect2 = intersectLongitude(ray, minMaxAngle.y, true);\n\n    // Choose intersection with smallest T as the "first", the other as "last"\n    // Note: first or last could be in the "shadow" wedge, beyond the tip\n    bool inOrder = intersect1.w <= intersect2.w;\n    vec4 first = inOrder ? intersect1 : intersect2;\n    vec4 last = inOrder ? intersect2 : intersect1;\n\n    bool firstIsAhead = first.w >= 0.0;\n    bool startedInsideFirst = dot(ray.pos.xy, first.xy) < 0.0;\n    bool exitFromInside = firstIsAhead == startedInsideFirst;\n    bool lastIsAhead = last.w > 0.0;\n    bool startedOutsideLast = dot(ray.pos.xy, last.xy) >= 0.0;\n    bool enterFromOutside = lastIsAhead == startedOutsideLast;\n\n    vec4 farSide = vec4(normalize(ray.dir), INF_HIT);\n    vec4 miss = vec4(normalize(ray.dir), NO_HIT);\n\n    if (exitFromInside && enterFromOutside) {\n        // Ray crosses both faces of negative wedge, exiting then entering the positive shape\n        return RayShapeIntersection(first, last);\n    } else if (!exitFromInside && enterFromOutside) {\n        // Ray starts inside wedge. last is in shadow wedge, and first is actually the entry\n        return RayShapeIntersection(-1.0 * farSide, first);\n    } else if (exitFromInside && !enterFromOutside) {\n        // First intersection was in the shadow wedge, so last is actually the exit\n        return RayShapeIntersection(last, farSide);\n    } else { // !exitFromInside && !enterFromOutside\n        // Both intersections were in the shadow wedge\n        return RayShapeIntersection(miss, miss);\n    }\n}\n',Dq="// See IntersectionUtils.glsl for the definitions of Ray, RayShapeIntersection,\n// NO_HIT, Intersections\n\n/* Box defines (set in Scene/VoxelBoxShape.js)\n#define BOX_INTERSECTION_INDEX ### // always 0\n*/\n\nuniform vec3 u_renderMinBounds;\nuniform vec3 u_renderMaxBounds;\n\nRayShapeIntersection intersectBox(in Ray ray, in vec3 minBound, in vec3 maxBound)\n{\n    // Consider the box as the intersection of the space between 3 pairs of parallel planes\n    // Compute the distance along the ray to each plane\n    vec3 t0 = (minBound - ray.pos) / ray.dir;\n    vec3 t1 = (maxBound - ray.pos) / ray.dir;\n\n    // Identify candidate entries/exits based on distance from ray.pos\n    vec3 entries = min(t0, t1);\n    vec3 exits = max(t0, t1);\n\n    vec3 directions = sign(ray.dir);\n\n    // The actual intersection points are the furthest entry and the closest exit\n    float lastEntry = maxComponent(entries);\n    bvec3 isLastEntry = equal(entries, vec3(lastEntry));\n    vec3 entryNormal = -1.0 * vec3(isLastEntry) * directions;\n    vec4 entry = vec4(entryNormal, lastEntry);\n\n    float firstExit = minComponent(exits);\n    bvec3 isFirstExit = equal(exits, vec3(firstExit));\n    vec3 exitNormal = vec3(isLastEntry) * directions;\n    vec4 exit = vec4(exitNormal, firstExit);\n\n    if (entry.w > exit.w) {\n        entry.w = NO_HIT;\n        exit.w = NO_HIT;\n    }\n\n    return RayShapeIntersection(entry, exit);\n}\n\nvoid intersectShape(in Ray ray, inout Intersections ix)\n{\n    RayShapeIntersection intersection = intersectBox(ray, u_renderMinBounds, u_renderMaxBounds);\n    setShapeIntersection(ix, BOX_INTERSECTION_INDEX, intersection);\n}\n",Oq="// See IntersectionUtils.glsl for the definitions of Ray, NO_HIT, Intersections,\n// RayShapeIntersection, setSurfaceIntersection, setShapeIntersection,\n// intersectIntersections\n// See IntersectLongitude.glsl for the definitions of intersectHalfPlane,\n// intersectFlippedWedge, intersectRegularWedge\n\n/* Cylinder defines (set in Scene/VoxelCylinderShape.js)\n#define CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MIN\n#define CYLINDER_HAS_RENDER_BOUNDS_RADIUS_FLAT\n#define CYLINDER_HAS_RENDER_BOUNDS_ANGLE\n#define CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_UNDER_HALF\n#define CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_OVER_HALF\n#define CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_ZERO\n\n#define CYLINDER_INTERSECTION_INDEX_RADIUS_MAX\n#define CYLINDER_INTERSECTION_INDEX_RADIUS_MIN\n#define CYLINDER_INTERSECTION_INDEX_ANGLE\n*/\n\n// Cylinder uniforms\nuniform vec2 u_cylinderRenderRadiusMinMax;\nuniform vec2 u_cylinderRenderHeightMinMax;\n#if defined(CYLINDER_HAS_RENDER_BOUNDS_ANGLE)\n    uniform vec2 u_cylinderRenderAngleMinMax;\n#endif\n\n/**\n * Find the intersection of a ray with the volume defined by two planes of constant z\n */\nRayShapeIntersection intersectHeightBounds(in Ray ray, in vec2 minMaxHeight, in bool convex)\n{\n    float zPosition = ray.pos.z;\n    float zDirection = ray.dir.z;\n\n    float tmin = (minMaxHeight.x - zPosition) / zDirection;\n    float tmax = (minMaxHeight.y - zPosition) / zDirection;\n\n    // Normals point outside the volume\n    float signFlip = convex ? 1.0 : -1.0;\n    vec4 intersectMin = vec4(0.0, 0.0, -1.0 * signFlip, tmin);\n    vec4 intersectMax = vec4(0.0, 0.0, 1.0 * signFlip, tmax);\n\n    bool topEntry = zDirection < 0.0;\n    vec4 entry = topEntry ? intersectMax : intersectMin;\n    vec4 exit = topEntry ? intersectMin : intersectMax;\n\n    return RayShapeIntersection(entry, exit);\n}\n\n/**\n * Find the intersection of a ray with a right cylindrical surface of a given radius\n * about the z-axis.\n */\nRayShapeIntersection intersectCylinder(in Ray ray, in float radius, in bool convex)\n{\n    vec2 position = ray.pos.xy;\n    vec2 direction = ray.dir.xy;\n\n    float a = dot(direction, direction);\n    float b = dot(position, direction);\n    float c = dot(position, position) - radius * radius;\n    float determinant = b * b - a * c;\n\n    if (determinant < 0.0) {\n        vec4 miss = vec4(normalize(ray.dir), NO_HIT);\n        return RayShapeIntersection(miss, miss);\n    }\n\n    determinant = sqrt(determinant);\n    float t1 = (-b - determinant) / a;\n    float t2 = (-b + determinant) / a;\n    float signFlip = convex ? 1.0 : -1.0;\n    vec4 intersect1 = vec4(normalize(position + t1 * direction) * signFlip, 0.0, t1);\n    vec4 intersect2 = vec4(normalize(position + t2 * direction) * signFlip, 0.0, t2);\n\n    return RayShapeIntersection(intersect1, intersect2);\n}\n\n/**\n * Find the intersection of a ray with a right cylindrical solid of given\n * radius and height bounds. NOTE: The shape is assumed to be convex.\n */\nRayShapeIntersection intersectBoundedCylinder(in Ray ray, in float radius, in vec2 minMaxHeight)\n{\n    RayShapeIntersection cylinderIntersection = intersectCylinder(ray, radius, true);\n    RayShapeIntersection heightBoundsIntersection = intersectHeightBounds(ray, minMaxHeight, true);\n    return intersectIntersections(ray, cylinderIntersection, heightBoundsIntersection);\n}\n\nvoid intersectShape(Ray ray, inout Intersections ix)\n{\n    // Position is converted from [0,1] to [-1,+1] because shape intersections assume unit space is [-1,+1].\n    // Direction is scaled as well to be in sync with position.\n    ray.pos = ray.pos * 2.0 - 1.0;\n    ray.dir *= 2.0;\n\n    RayShapeIntersection outerIntersect = intersectBoundedCylinder(ray, u_cylinderRenderRadiusMinMax.y, u_cylinderRenderHeightMinMax);\n\n    setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_RADIUS_MAX, outerIntersect);\n\n    if (outerIntersect.entry.w == NO_HIT) {\n        return;\n    }\n\n    #if defined(CYLINDER_HAS_RENDER_BOUNDS_RADIUS_FLAT)\n        // When the cylinder is perfectly thin it's necessary to sandwich the\n        // inner cylinder intersection inside the outer cylinder intersection.\n\n        // Without this special case,\n        // [outerMin, outerMax, innerMin, innerMax] will bubble sort to\n        // [outerMin, innerMin, outerMax, innerMax] which will cause the back\n        // side of the cylinder to be invisible because it will think the ray\n        // is still inside the inner (negative) cylinder after exiting the\n        // outer (positive) cylinder.\n\n        // With this special case,\n        // [outerMin, innerMin, innerMax, outerMax] will bubble sort to\n        // [outerMin, innerMin, innerMax, outerMax] which will work correctly.\n\n        // Note: If initializeIntersections() changes its sorting function\n        // from bubble sort to something else, this code may need to change.\n        RayShapeIntersection innerIntersect = intersectCylinder(ray, 1.0, false);\n        setSurfaceIntersection(ix, 0, outerIntersect.entry, true, true);  // positive, enter\n        setSurfaceIntersection(ix, 1, innerIntersect.entry, false, true); // negative, enter\n        setSurfaceIntersection(ix, 2, innerIntersect.exit, false, false); // negative, exit\n        setSurfaceIntersection(ix, 3, outerIntersect.exit, true, false);  // positive, exit\n    #elif defined(CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MIN)\n        RayShapeIntersection innerIntersect = intersectCylinder(ray, u_cylinderRenderRadiusMinMax.x, false);\n        setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_RADIUS_MIN, innerIntersect);\n    #endif\n\n    #if defined(CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_UNDER_HALF)\n        RayShapeIntersection wedgeIntersect = intersectRegularWedge(ray, u_cylinderRenderAngleMinMax);\n        setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_ANGLE, wedgeIntersect);\n    #elif defined(CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_OVER_HALF)\n        RayShapeIntersection wedgeIntersects[2];\n        intersectFlippedWedge(ray, u_cylinderRenderAngleMinMax, wedgeIntersects);\n        setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_ANGLE + 0, wedgeIntersects[0]);\n        setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_ANGLE + 1, wedgeIntersects[1]);\n    #elif defined(CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_ZERO)\n        RayShapeIntersection wedgeIntersects[2];\n        intersectHalfPlane(ray, u_cylinderRenderAngleMinMax.x, wedgeIntersects);\n        setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_ANGLE + 0, wedgeIntersects[0]);\n        setShapeIntersection(ix, CYLINDER_INTERSECTION_INDEX_ANGLE + 1, wedgeIntersects[1]);\n    #endif\n}\n",Rq="// See IntersectionUtils.glsl for the definitions of Ray, NO_HIT, INF_HIT, Intersections,\n// RayShapeIntersection, setSurfaceIntersection, setShapeIntersection\n// See IntersectLongitude.glsl for the definitions of intersectHalfPlane,\n// intersectFlippedWedge, intersectRegularWedge\n\n/* Ellipsoid defines (set in Scene/VoxelEllipsoidShape.js)\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_UNDER_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_OVER_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_EQUAL_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_OVER_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_EQUAL_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_OVER_HALF\n#define ELLIPSOID_INTERSECTION_INDEX_LONGITUDE\n#define ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX\n#define ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN\n#define ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MAX\n#define ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MIN\n*/\n\n#if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE)\n    uniform vec2 u_ellipsoidRenderLongitudeMinMax;\n#endif\nuniform float u_eccentricitySquared;\nuniform vec2 u_ellipsoidRenderLatitudeSinMinMax;\nuniform vec2 u_clipMinMaxHeight;\n\nRayShapeIntersection intersectZPlane(in Ray ray, in float z) {\n    float t = -ray.pos.z / ray.dir.z;\n\n    bool startsOutside = sign(ray.pos.z) == sign(z);\n    bool entry = (t >= 0.0) != startsOutside;\n\n    vec4 intersect = vec4(0.0, 0.0, z, t);\n    vec4 farSide = vec4(normalize(ray.dir), INF_HIT);\n\n    if (entry) {\n        return RayShapeIntersection(intersect, farSide);\n    } else {\n        return RayShapeIntersection(-1.0 * farSide, intersect);\n    }\n}\n\nRayShapeIntersection intersectHeight(in Ray ray, in float relativeHeight, in bool convex)\n{\n    // Scale the ray by the ellipsoid axes to make it a unit sphere\n    // Note: approximating ellipsoid + height as an ellipsoid\n    vec3 radiiCorrection = u_ellipsoidRadiiUv / (u_ellipsoidRadiiUv + relativeHeight);\n    vec3 position = ray.pos * radiiCorrection;\n    vec3 direction = ray.dir * radiiCorrection;\n\n    float a = dot(direction, direction); // ~ 1.0 (or maybe 4.0 if ray is scaled)\n    float b = dot(direction, position); // roughly inside [-1.0, 1.0] when zoomed in\n    float c = dot(position, position) - 1.0; // ~ 0.0 when zoomed in.\n    float determinant = b * b - a * c; // ~ b * b when zoomed in\n\n    if (determinant < 0.0) {\n        vec4 miss = vec4(normalize(direction), NO_HIT);\n        return RayShapeIntersection(miss, miss);\n    }\n\n    determinant = sqrt(determinant);\n\n    // Compute larger root using standard formula\n    float signB = b < 0.0 ? -1.0 : 1.0;\n    // The other root may suffer from subtractive cancellation in the standard formula.\n    // Compute it from the first root instead.\n    float t1 = (-b - signB * determinant) / a;\n    float t2 = c / (a * t1);\n    float tmin = min(t1, t2);\n    float tmax = max(t1, t2);\n\n    float directionScale = convex ? 1.0 : -1.0;\n    vec3 d1 = directionScale * normalize(position + tmin * direction);\n    vec3 d2 = directionScale * normalize(position + tmax * direction);\n\n    return RayShapeIntersection(vec4(d1, tmin), vec4(d2, tmax));\n}\n\n/**\n * Given a circular cone around the z-axis, with apex at the origin,\n * find the parametric distance(s) along a ray where that ray intersects\n * the cone.\n * The cone opening angle is described by the squared cosine of\n * its half-angle (the angle between the Z-axis and the surface)\n */\nvec2 intersectDoubleEndedCone(in Ray ray, in float cosSqrHalfAngle)\n{\n    vec3 o = ray.pos;\n    vec3 d = ray.dir;\n    float sinSqrHalfAngle = 1.0 - cosSqrHalfAngle;\n\n    float aSin = d.z * d.z * sinSqrHalfAngle;\n    float aCos = -dot(d.xy, d.xy) * cosSqrHalfAngle;\n    float a = aSin + aCos;\n\n    float bSin = d.z * o.z * sinSqrHalfAngle;\n    float bCos = -dot(o.xy, d.xy) * cosSqrHalfAngle;\n    float b = bSin + bCos;\n\n    float cSin = o.z * o.z * sinSqrHalfAngle;\n    float cCos = -dot(o.xy, o.xy) * cosSqrHalfAngle;\n    float c = cSin + cCos;\n    // determinant = b * b - a * c. But bSin * bSin = aSin * cSin.\n    // Avoid subtractive cancellation by expanding to eliminate these terms\n    float determinant = 2.0 * bSin * bCos + bCos * bCos - aSin * cCos - aCos * cSin - aCos * cCos;\n\n    if (determinant < 0.0) {\n        return vec2(NO_HIT);\n    } else if (a == 0.0) {\n        // Ray is parallel to cone surface\n        return (b == 0.0)\n            ? vec2(NO_HIT) // Ray is on cone surface\n            : vec2(-0.5 * c / b, NO_HIT);\n    }\n\n    determinant = sqrt(determinant);\n\n    // Compute larger root using standard formula\n    float signB = b < 0.0 ? -1.0 : 1.0;\n    float t1 = (-b - signB * determinant) / a;\n    // The other root may suffer from subtractive cancellation in the standard formula.\n    // Compute it from the first root instead.\n    float t2 = c / (a * t1);\n    float tmin = min(t1, t2);\n    float tmax = max(t1, t2);\n    return vec2(tmin, tmax);\n}\n\n/**\n * Given a point on a conical surface, find the surface normal at that point.\n */\nvec3 getConeNormal(in vec3 p, in bool convex) {\n    // Start with radial component pointing toward z-axis\n    vec2 radial = -abs(p.z) * normalize(p.xy);\n    // Z component points toward opening of cone\n    float zSign = (p.z < 0.0) ? -1.0 : 1.0;\n    float z = length(p.xy) * zSign;\n    // Flip normal if shape is convex\n    float flip = (convex) ? -1.0 : 1.0;\n    return normalize(vec3(radial, z) * flip);\n}\n\n/**\n * Compute the shift between the ellipsoid origin and the apex of a cone of latitude\n */\nfloat getLatitudeConeShift(in float sinLatitude) {\n    // Find prime vertical radius of curvature: \n    // the distance along the ellipsoid normal to the intersection with the z-axis\n    float x2 = u_eccentricitySquared * sinLatitude * sinLatitude;\n    float primeVerticalRadius = inversesqrt(1.0 - x2);\n\n    // Compute a shift from the origin to the intersection of the cone with the z-axis\n    return primeVerticalRadius * u_eccentricitySquared * sinLatitude;\n}\n\nvoid intersectFlippedCone(in Ray ray, in float cosHalfAngle, out RayShapeIntersection intersections[2]) {\n    // Undo the scaling from ellipsoid to sphere\n    ray.pos = ray.pos * u_ellipsoidRadiiUv;\n    ray.dir = ray.dir * u_ellipsoidRadiiUv;\n    // Shift the ray to account for the latitude cone not being centered at the Earth center\n    ray.pos.z += getLatitudeConeShift(cosHalfAngle);\n\n    float cosSqrHalfAngle = cosHalfAngle * cosHalfAngle;\n    vec2 intersect = intersectDoubleEndedCone(ray, cosSqrHalfAngle);\n\n    vec4 miss = vec4(normalize(ray.dir), NO_HIT);\n    vec4 farSide = vec4(normalize(ray.dir), INF_HIT);\n\n    // Initialize output with no intersections\n    intersections[0].entry = -1.0 * farSide;\n    intersections[0].exit = farSide;\n    intersections[1].entry = miss;\n    intersections[1].exit = miss;\n\n    if (intersect.x == NO_HIT) {\n        return;\n    }\n\n    // Find the points of intersection\n    float tmin = intersect.x;\n    float tmax = intersect.y;\n    vec3 p0 = ray.pos + tmin * ray.dir;\n    vec3 p1 = ray.pos + tmax * ray.dir;\n\n    vec4 intersect0 = vec4(getConeNormal(p0, true), tmin);\n    vec4 intersect1 = vec4(getConeNormal(p1, true), tmax);\n\n    bool p0InShadowCone = sign(p0.z) != sign(cosHalfAngle);\n    bool p1InShadowCone = sign(p1.z) != sign(cosHalfAngle);\n\n    if (p0InShadowCone && p1InShadowCone) {\n        // no valid intersections\n    } else if (p0InShadowCone) {\n        intersections[0].exit = intersect1;\n    } else if (p1InShadowCone) {\n        intersections[0].entry = intersect0;\n    } else {\n        intersections[0].exit = intersect0;\n        intersections[1].entry = intersect1;\n        intersections[1].exit = farSide;\n    }\n}\n\nRayShapeIntersection intersectRegularCone(in Ray ray, in float cosHalfAngle, in bool convex) {\n    // Undo the scaling from ellipsoid to sphere\n    ray.pos = ray.pos * u_ellipsoidRadiiUv;\n    ray.dir = ray.dir * u_ellipsoidRadiiUv;\n    // Shift the ray to account for the latitude cone not being centered at the Earth center\n    ray.pos.z += getLatitudeConeShift(cosHalfAngle);\n\n    float cosSqrHalfAngle = cosHalfAngle * cosHalfAngle;\n    vec2 intersect = intersectDoubleEndedCone(ray, cosSqrHalfAngle);\n\n    vec4 miss = vec4(normalize(ray.dir), NO_HIT);\n    vec4 farSide = vec4(normalize(ray.dir), INF_HIT);\n\n    if (intersect.x == NO_HIT) {\n        return RayShapeIntersection(miss, miss);\n    }\n\n    // Find the points of intersection\n    float tmin = intersect.x;\n    float tmax = intersect.y;\n    vec3 p0 = ray.pos + tmin * ray.dir;\n    vec3 p1 = ray.pos + tmax * ray.dir;\n\n    vec4 intersect0 = vec4(getConeNormal(p0, convex), tmin);\n    vec4 intersect1 = vec4(getConeNormal(p1, convex), tmax);\n\n    bool p0InShadowCone = sign(p0.z) != sign(cosHalfAngle);\n    bool p1InShadowCone = sign(p1.z) != sign(cosHalfAngle);\n\n    if (p0InShadowCone && p1InShadowCone) {\n        return RayShapeIntersection(miss, miss);\n    } else if (p0InShadowCone) {\n        return RayShapeIntersection(intersect1, farSide);\n    } else if (p1InShadowCone) {\n        return RayShapeIntersection(-1.0 * farSide, intersect0);\n    } else {\n        return RayShapeIntersection(intersect0, intersect1);\n    }\n}\n\nvoid intersectShape(in Ray ray, inout Intersections ix) {\n    // Position is converted from [0,1] to [-1,+1] because shape intersections assume unit space is [-1,+1].\n    // Direction is scaled as well to be in sync with position.\n    ray.pos = ray.pos * 2.0 - 1.0;\n    ray.dir *= 2.0;\n\n    // Outer ellipsoid\n    RayShapeIntersection outerIntersect = intersectHeight(ray, u_clipMinMaxHeight.y, true);\n    setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MAX, outerIntersect);\n\n    // Exit early if the outer ellipsoid was missed.\n    if (outerIntersect.entry.w == NO_HIT) {\n        return;\n    }\n\n    // Inner ellipsoid\n    RayShapeIntersection innerIntersect = intersectHeight(ray, u_clipMinMaxHeight.x, false);\n\n    if (innerIntersect.entry.w == NO_HIT) {\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MIN, innerIntersect);\n    } else {\n        // When the ellipsoid is large and thin it's possible for floating point math\n        // to cause the ray to intersect the inner ellipsoid before the outer ellipsoid. \n        // To prevent this from happening, clamp innerIntersect to outerIntersect and\n        // sandwich the inner ellipsoid intersection inside the outer ellipsoid intersection.\n\n        // Without this special case,\n        // [outerMin, outerMax, innerMin, innerMax] will bubble sort to\n        // [outerMin, innerMin, outerMax, innerMax] which will cause the back\n        // side of the ellipsoid to be invisible because it will think the ray\n        // is still inside the inner (negative) ellipsoid after exiting the\n        // outer (positive) ellipsoid.\n\n        // With this special case,\n        // [outerMin, innerMin, innerMax, outerMax] will bubble sort to\n        // [outerMin, innerMin, innerMax, outerMax] which will work correctly.\n\n        // Note: If initializeIntersections() changes its sorting function\n        // from bubble sort to something else, this code may need to change.\n        innerIntersect.entry.w = max(innerIntersect.entry.w, outerIntersect.entry.w);\n        innerIntersect.exit.w = min(innerIntersect.exit.w, outerIntersect.exit.w);\n        setSurfaceIntersection(ix, 0, outerIntersect.entry, true, true);  // positive, enter\n        setSurfaceIntersection(ix, 1, innerIntersect.entry, false, true); // negative, enter\n        setSurfaceIntersection(ix, 2, innerIntersect.exit, false, false); // negative, exit\n        setSurfaceIntersection(ix, 3, outerIntersect.exit, true, false);  // positive, exit\n    }\n\n    // Bottom cone\n    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF)\n        RayShapeIntersection bottomConeIntersection = intersectRegularCone(ray, u_ellipsoidRenderLatitudeSinMinMax.x, false);\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN, bottomConeIntersection);\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_EQUAL_HALF)\n        RayShapeIntersection bottomConeIntersection = intersectZPlane(ray, -1.0);\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN, bottomConeIntersection);\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_OVER_HALF)\n        RayShapeIntersection bottomConeIntersections[2];\n        intersectFlippedCone(ray, u_ellipsoidRenderLatitudeSinMinMax.x, bottomConeIntersections);\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN + 0, bottomConeIntersections[0]);\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN + 1, bottomConeIntersections[1]);\n    #endif\n\n    // Top cone\n    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF)\n        RayShapeIntersection topConeIntersections[2];\n        intersectFlippedCone(ray, u_ellipsoidRenderLatitudeSinMinMax.y, topConeIntersections);\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX + 0, topConeIntersections[0]);\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX + 1, topConeIntersections[1]);\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_EQUAL_HALF)\n        RayShapeIntersection topConeIntersection = intersectZPlane(ray, 1.0);\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX, topConeIntersection);\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_OVER_HALF)\n        RayShapeIntersection topConeIntersection = intersectRegularCone(ray, u_ellipsoidRenderLatitudeSinMinMax.y, false);\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX, topConeIntersection);\n    #endif\n\n    // Wedge\n    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO)\n        RayShapeIntersection wedgeIntersects[2];\n        intersectHalfPlane(ray, u_ellipsoidRenderLongitudeMinMax.x, wedgeIntersects);\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE + 0, wedgeIntersects[0]);\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE + 1, wedgeIntersects[1]);\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_UNDER_HALF)\n        RayShapeIntersection wedgeIntersect = intersectRegularWedge(ray, u_ellipsoidRenderLongitudeMinMax);\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE, wedgeIntersect);\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_OVER_HALF)\n        RayShapeIntersection wedgeIntersects[2];\n        intersectFlippedWedge(ray, u_ellipsoidRenderLongitudeMinMax, wedgeIntersects);\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE + 0, wedgeIntersects[0]);\n        setShapeIntersection(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE + 1, wedgeIntersects[1]);\n    #endif\n}\n",Mq="// Main intersection function for Voxel scenes.\n// See IntersectBox.glsl, IntersectCylinder.glsl, or IntersectEllipsoid.glsl\n// for the definition of intersectShape. The appropriate function is selected\n// based on the VoxelPrimitive shape type, and added to the shader in\n// Scene/VoxelRenderResources.js.\n// See also IntersectClippingPlane.glsl and IntersectDepth.glsl.\n// See IntersectionUtils.glsl for the definitions of Ray, NO_HIT,\n// getFirstIntersection, initializeIntersections, nextIntersection.\n\n/* Intersection defines (set in Scene/VoxelRenderResources.js)\n#define INTERSECTION_COUNT ###\n*/\n\nRayShapeIntersection intersectScene(in vec2 screenCoord, in Ray ray, out Intersections ix) {\n    // Do a ray-shape intersection to find the exact starting and ending points.\n    intersectShape(ray, ix);\n\n    // Exit early if the positive shape was completely missed or behind the ray.\n    RayShapeIntersection intersection = getFirstIntersection(ix);\n    if (intersection.entry.w == NO_HIT) {\n        // Positive shape was completely missed - so exit early.\n        return intersection;\n    }\n\n    // Clipping planes\n    #if defined(CLIPPING_PLANES)\n        intersectClippingPlanes(ray, ix);\n    #endif\n\n    // Depth\n    intersectDepth(screenCoord, ray, ix);\n\n    // Find the first intersection that's in front of the ray\n    #if (INTERSECTION_COUNT > 1)\n        initializeIntersections(ix);\n        for (int i = 0; i < INTERSECTION_COUNT; ++i) {\n            intersection = nextIntersection(ix);\n            if (intersection.exit.w > 0.0) {\n                // Set start to 0.0 when ray is inside the shape.\n                intersection.entry.w = max(intersection.entry.w, 0.0);\n                break;\n            }\n        }\n    #else\n        // Set start to 0.0 when ray is inside the shape.\n        intersection.entry.w = max(intersection.entry.w, 0.0);\n    #endif\n\n    return intersection;\n}\n",Lq="/* Box defines (set in Scene/VoxelBoxShape.js)\n#define BOX_HAS_SHAPE_BOUNDS\n*/\n\n#if defined(BOX_HAS_SHAPE_BOUNDS)\n    uniform vec3 u_boxUvToShapeUvScale;\n    uniform vec3 u_boxUvToShapeUvTranslate;\n#endif\n\nPointJacobianT convertUvToShapeSpaceDerivative(in vec3 positionUv) {\n    // For BOX, UV space = shape space, so we can use positionUv as-is,\n    // and the Jacobian is the identity matrix, except that a step of 1\n    // only spans half the shape space [-1, 1], so the identity is scaled.\n    return PointJacobianT(positionUv, mat3(0.5));\n}\n\nvec3 convertShapeToShapeUvSpace(in vec3 positionShape) {\n#if defined(BOX_HAS_SHAPE_BOUNDS)\n    return positionShape * u_boxUvToShapeUvScale + u_boxUvToShapeUvTranslate;\n#else\n    return positionShape;\n#endif\n}\n\nPointJacobianT convertUvToShapeUvSpaceDerivative(in vec3 positionUv) {\n    PointJacobianT pointJacobian = convertUvToShapeSpaceDerivative(positionUv);\n    pointJacobian.point = convertShapeToShapeUvSpace(pointJacobian.point);\n    return pointJacobian;\n}\n\nvec3 convertShapeUvToUvSpace(in vec3 shapeUv) {\n#if defined(BOX_HAS_SHAPE_BOUNDS)\n    return (shapeUv - u_boxUvToShapeUvTranslate) / u_boxUvToShapeUvScale;\n#else\n    return shapeUv;\n#endif\n}\n\nvec3 scaleShapeUvToShapeSpace(in vec3 shapeUv) {\n#if defined(BOX_HAS_SHAPE_BOUNDS)\n    return shapeUv / u_boxUvToShapeUvScale;\n#else\n    return shapeUv;\n#endif\n}",Nq="/* Cylinder defines (set in Scene/VoxelCylinderShape.js)\n#define CYLINDER_HAS_SHAPE_BOUNDS_RADIUS\n#define CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED\n*/\n\n#if defined(CYLINDER_HAS_SHAPE_BOUNDS_RADIUS)\n    uniform vec2 u_cylinderUvToShapeUvRadius; // x = scale, y = offset\n#endif\n#if defined(CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT)\n    uniform vec2 u_cylinderUvToShapeUvHeight; // x = scale, y = offset\n#endif\n#if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE)\n    uniform vec2 u_cylinderUvToShapeUvAngle; // x = scale, y = offset\n#endif\n#if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY) || defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY)\n    uniform vec2 u_cylinderShapeUvAngleMinMax;\n#endif\n#if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY) || defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY) || defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED)\n    uniform float u_cylinderShapeUvAngleRangeZeroMid;\n#endif\n\nPointJacobianT convertUvToShapeSpaceDerivative(in vec3 positionUv) {\n    // Convert from Cartesian UV space [0, 1] to Cartesian local space [-1, 1]\n    vec3 position = positionUv * 2.0 - 1.0;\n\n    float radius = length(position.xy); // [0, 1]\n    vec3 radial = normalize(vec3(position.xy, 0.0));\n\n    // Shape space height is defined within [0, 1]\n    float height = positionUv.z; // [0, 1]\n    vec3 z = vec3(0.0, 0.0, 1.0);\n\n    float angle = atan(position.y, position.x);\n    vec3 east = normalize(vec3(-position.y, position.x, 0.0));\n\n    vec3 point = vec3(radius, angle, height);\n    mat3 jacobianT = mat3(radial, east / length(position.xy), z);\n    return PointJacobianT(point, jacobianT);\n}\n\nvec3 convertShapeToShapeUvSpace(in vec3 positionShape) {\n    float radius = positionShape.x;\n    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_RADIUS)\n        radius = radius * u_cylinderUvToShapeUvRadius.x + u_cylinderUvToShapeUvRadius.y;\n    #endif\n\n    float angle = (positionShape.y + czm_pi) / czm_twoPi;\n    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE)\n        #if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED)\n            // Comparing against u_cylinderShapeUvAngleMinMax has precision problems. u_cylinderShapeUvAngleRangeZeroMid is more conservative.\n            angle += float(angle < u_cylinderShapeUvAngleRangeZeroMid);\n        #endif\n\n        // Avoid flickering from reading voxels from both sides of the -pi/+pi discontinuity.\n        #if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY)\n            angle = angle > u_cylinderShapeUvAngleRangeZeroMid ? u_cylinderShapeUvAngleMinMax.x : angle;\n        #elif defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY)\n            angle = angle < u_cylinderShapeUvAngleRangeZeroMid ? u_cylinderShapeUvAngleMinMax.y : angle;\n        #endif\n\n        angle = angle * u_cylinderUvToShapeUvAngle.x + u_cylinderUvToShapeUvAngle.y;\n    #endif\n\n    float height = positionShape.z;\n    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT)\n        height = height * u_cylinderUvToShapeUvHeight.x + u_cylinderUvToShapeUvHeight.y;\n    #endif\n\n    return vec3(radius, angle, height);\n}\n\nPointJacobianT convertUvToShapeUvSpaceDerivative(in vec3 positionUv) {\n    PointJacobianT pointJacobian = convertUvToShapeSpaceDerivative(positionUv);\n    pointJacobian.point = convertShapeToShapeUvSpace(pointJacobian.point);\n    return pointJacobian;\n}\n\nvec3 scaleShapeUvToShapeSpace(in vec3 shapeUv) {\n    float radius = shapeUv.x;\n    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_RADIUS)\n        radius /= u_cylinderUvToShapeUvRadius.x;\n    #endif\n\n    float angle = shapeUv.y * czm_twoPi;\n    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE)\n        angle /= u_cylinderUvToShapeUvAngle.x;\n    #endif\n\n    float height = shapeUv.z;\n    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT)\n        height /= u_cylinderUvToShapeUvHeight.x;\n    #endif\n\n    return vec3(radius, angle, height);\n}\n",Bq="/* Ellipsoid defines (set in Scene/VoxelEllipsoidShape.js)\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY\n#define ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE\n#define ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED\n#define ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE\n*/\n\nuniform vec3 u_ellipsoidRadiiUv; // [0,1]\nuniform vec2 u_evoluteScale; // (radiiUv.x ^ 2 - radiiUv.z ^ 2) * vec2(1.0, -1.0) / radiiUv;\nuniform vec3 u_ellipsoidInverseRadiiSquaredUv;\n#if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY) || defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY) || defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED)\n    uniform vec3 u_ellipsoidShapeUvLongitudeMinMaxMid;\n#endif\n#if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE)\n    uniform vec2 u_ellipsoidUvToShapeUvLongitude; // x = scale, y = offset\n#endif\n#if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE)\n    uniform vec2 u_ellipsoidUvToShapeUvLatitude; // x = scale, y = offset\n#endif\nuniform float u_ellipsoidInverseHeightDifferenceUv;\n\n// robust iterative solution without trig functions\n// https://github.com/0xfaded/ellipse_demo/issues/1\n// https://stackoverflow.com/questions/22959698/distance-from-given-point-to-given-ellipse\n// Extended to return radius of curvature along with the point\nvec3 nearestPointAndRadiusOnEllipse(vec2 pos, vec2 radii) {\n    vec2 p = abs(pos);\n    vec2 inverseRadii = 1.0 / radii;\n\n    // We describe the ellipse parametrically: v = radii * vec2(cos(t), sin(t))\n    // but store the cos and sin of t in a vec2 for efficiency.\n    // Initial guess: t = pi/4\n    vec2 tTrigs = vec2(0.7071067811865476);\n    // Initial guess of point on ellipsoid\n    vec2 v = radii * tTrigs;\n    // Center of curvature of the ellipse at v\n    vec2 evolute = u_evoluteScale * tTrigs * tTrigs * tTrigs;\n\n    const int iterations = 3;\n    for (int i = 0; i < iterations; ++i) {\n        // Find the (approximate) intersection of p - evolute with the ellipsoid.\n        vec2 q = normalize(p - evolute) * length(v - evolute);\n        // Update the estimate of t.\n        tTrigs = (q + evolute) * inverseRadii;\n        tTrigs = normalize(clamp(tTrigs, 0.0, 1.0));\n        v = radii * tTrigs;\n        evolute = u_evoluteScale * tTrigs * tTrigs * tTrigs;\n    }\n\n    return vec3(v * sign(pos), length(v - evolute));\n}\n\nPointJacobianT convertUvToShapeSpaceDerivative(in vec3 positionUv) {\n    // Convert from UV space [0, 1] to local space [-1, 1]\n    vec3 position = positionUv * 2.0 - 1.0;\n    // Undo the scaling from ellipsoid to sphere\n    position = position * u_ellipsoidRadiiUv;\n\n    float longitude = atan(position.y, position.x);\n    vec3 east = normalize(vec3(-position.y, position.x, 0.0));\n\n    // Convert the 3D position to a 2D position relative to the ellipse (radii.x, radii.z)\n    // (assume radii.y == radii.x) and find the nearest point on the ellipse and its normal\n    float distanceFromZAxis = length(position.xy);\n    vec2 posEllipse = vec2(distanceFromZAxis, position.z);\n    vec3 surfacePointAndRadius = nearestPointAndRadiusOnEllipse(posEllipse, u_ellipsoidRadiiUv.xz);\n    vec2 surfacePoint = surfacePointAndRadius.xy;\n\n    vec2 normal2d = normalize(surfacePoint * u_ellipsoidInverseRadiiSquaredUv.xz);\n    float latitude = atan(normal2d.y, normal2d.x);\n    vec3 north = vec3(-normal2d.y * normalize(position.xy), abs(normal2d.x));\n\n    float heightSign = length(posEllipse) < length(surfacePoint) ? -1.0 : 1.0;\n    float height = heightSign * length(posEllipse - surfacePoint);\n    vec3 up = normalize(cross(east, north));\n\n    vec3 point = vec3(longitude, latitude, height);\n    mat3 jacobianT = mat3(east / distanceFromZAxis, north / (surfacePointAndRadius.z + height), up);\n    return PointJacobianT(point, jacobianT);\n}\n\nvec3 convertShapeToShapeUvSpace(in vec3 positionShape) {\n    // Longitude: shift & scale to [0, 1]\n    float longitude = (positionShape.x + czm_pi) / czm_twoPi;\n\n    // Correct the angle when max < min\n    // Technically this should compare against min longitude - but it has precision problems so compare against the middle of empty space.\n    #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED)\n        longitude += float(longitude < u_ellipsoidShapeUvLongitudeMinMaxMid.z);\n    #endif\n\n    // Avoid flickering from reading voxels from both sides of the -pi/+pi discontinuity.\n    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY)\n        longitude = longitude > u_ellipsoidShapeUvLongitudeMinMaxMid.z ? u_ellipsoidShapeUvLongitudeMinMaxMid.x : longitude;\n    #endif\n    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY)\n        longitude = longitude < u_ellipsoidShapeUvLongitudeMinMaxMid.z ? u_ellipsoidShapeUvLongitudeMinMaxMid.y : longitude;\n    #endif\n\n    #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE)\n        longitude = longitude * u_ellipsoidUvToShapeUvLongitude.x + u_ellipsoidUvToShapeUvLongitude.y;\n    #endif\n\n    // Latitude: shift and scale to [0, 1]\n    float latitude = (positionShape.y + czm_piOverTwo) / czm_pi;\n    #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE)\n        latitude = latitude * u_ellipsoidUvToShapeUvLatitude.x + u_ellipsoidUvToShapeUvLatitude.y;\n    #endif\n\n    // Height: scale to the range [0, 1]\n    float height = 1.0 + positionShape.z * u_ellipsoidInverseHeightDifferenceUv;\n\n    return vec3(longitude, latitude, height);\n}\n\nPointJacobianT convertUvToShapeUvSpaceDerivative(in vec3 positionUv) {\n    PointJacobianT pointJacobian = convertUvToShapeSpaceDerivative(positionUv);\n    pointJacobian.point = convertShapeToShapeUvSpace(pointJacobian.point);\n    return pointJacobian;\n}\n\nvec3 scaleShapeUvToShapeSpace(in vec3 shapeUv) {\n    // Convert from [0, 1] to radians [-pi, pi]\n    float longitude = shapeUv.x * czm_twoPi;\n    #if defined (ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE)\n        longitude /= u_ellipsoidUvToShapeUvLongitude.x;\n    #endif\n\n    // Convert from [0, 1] to radians [-pi/2, pi/2]\n    float latitude = shapeUv.y * czm_pi;\n    #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE)\n        latitude /= u_ellipsoidUvToShapeUvLatitude.x;\n    #endif\n    \n    float height = shapeUv.z / u_ellipsoidInverseHeightDifferenceUv;\n\n    return vec3(longitude, latitude, height);\n}\n",Fq="// These octree flags must be in sync with GpuOctreeFlag in VoxelTraversal.js\n#define OCTREE_FLAG_INTERNAL 0\n#define OCTREE_FLAG_LEAF 1\n#define OCTREE_FLAG_PACKED_LEAF_FROM_PARENT 2\n\n#define OCTREE_MAX_LEVELS 32 // Harcoded value because GLSL doesn't like variable length loops\n\nuniform sampler2D u_octreeInternalNodeTexture;\nuniform vec2 u_octreeInternalNodeTexelSizeUv;\nuniform int u_octreeInternalNodeTilesPerRow;\n#if (SAMPLE_COUNT > 1)\nuniform sampler2D u_octreeLeafNodeTexture;\nuniform vec2 u_octreeLeafNodeTexelSizeUv;\nuniform int u_octreeLeafNodeTilesPerRow;\n#endif\nuniform ivec3 u_dimensions; // does not include padding, and is in the z-up orientation\nuniform ivec3 u_inputDimensions; // includes padding, and is in the orientation of the input data\n#if defined(PADDING)\n    uniform ivec3 u_paddingBefore;\n#endif\n\nstruct OctreeNodeData {\n    int data;\n    int flag;\n};\n\nstruct TraversalData {\n    ivec4 octreeCoords;\n    int parentOctreeIndex;\n};\n\nstruct SampleData {\n    int megatextureIndex;\n    ivec4 tileCoords;\n    vec3 tileUv;\n    vec3 inputCoordinate;\n    #if (SAMPLE_COUNT > 1)\n        float weight;\n    #endif\n};\n\n// Integer mod: For WebGL1 only\nint intMod(in int a, in int b) {\n    return a - (b * (a / b));\n}\nint normU8_toInt(in float value) {\n    return int(value * 255.0);\n}\nint normU8x2_toInt(in vec2 value) {\n    return int(value.x * 255.0) + 256 * int(value.y * 255.0);\n}\nfloat normU8x2_toFloat(in vec2 value) {\n    return float(normU8x2_toInt(value)) / 65535.0;\n}\n\nOctreeNodeData getOctreeNodeData(in vec2 octreeUv) {\n    vec4 texData = texture(u_octreeInternalNodeTexture, octreeUv);\n\n    OctreeNodeData data;\n    data.data = normU8x2_toInt(texData.xy);\n    data.flag = normU8x2_toInt(texData.zw);\n    return data;\n}\n\nOctreeNodeData getOctreeChildData(in int parentOctreeIndex, in ivec3 childCoord) {\n    int childIndex = childCoord.z * 4 + childCoord.y * 2 + childCoord.x;\n    int octreeCoordX = intMod(parentOctreeIndex, u_octreeInternalNodeTilesPerRow) * 9 + 1 + childIndex;\n    int octreeCoordY = parentOctreeIndex / u_octreeInternalNodeTilesPerRow;\n    vec2 octreeUv = u_octreeInternalNodeTexelSizeUv * vec2(float(octreeCoordX) + 0.5, float(octreeCoordY) + 0.5);\n    return getOctreeNodeData(octreeUv);\n}\n\nint getOctreeParentIndex(in int octreeIndex) {\n    int octreeCoordX = intMod(octreeIndex, u_octreeInternalNodeTilesPerRow) * 9;\n    int octreeCoordY = octreeIndex / u_octreeInternalNodeTilesPerRow;\n    vec2 octreeUv = u_octreeInternalNodeTexelSizeUv * vec2(float(octreeCoordX) + 0.5, float(octreeCoordY) + 0.5);\n    vec4 parentData = texture(u_octreeInternalNodeTexture, octreeUv);\n    int parentOctreeIndex = normU8x2_toInt(parentData.xy);\n    return parentOctreeIndex;\n}\n\n/**\n* Convert a position in the uv-space of the tileset bounding shape\n* into the uv-space of a tile within the tileset\n*/\nvec3 getTileUv(in vec3 shapePosition, in ivec4 octreeCoords) {\n\t// PERFORMANCE_IDEA: use bit-shifting (only in WebGL2)\n    float dimAtLevel = exp2(float(octreeCoords.w));\n    return shapePosition * dimAtLevel - vec3(octreeCoords.xyz);\n}\n\nvec3 getClampedTileUv(in vec3 shapePosition, in ivec4 octreeCoords) {\n    vec3 tileUv = getTileUv(shapePosition, octreeCoords);\n    return clamp(tileUv, vec3(0.0), vec3(1.0));\n}\n\nvoid addSampleCoordinates(in vec3 shapePosition, inout SampleData sampleData) {\n    vec3 tileUv = getClampedTileUv(shapePosition, sampleData.tileCoords);\n\n    vec3 inputCoordinate = tileUv * vec3(u_dimensions);\n#if defined(PADDING)\n    inputCoordinate += vec3(u_paddingBefore);\n#endif\n#if defined(Y_UP_METADATA_ORDER)\n#if defined(SHAPE_BOX)\n    float inputY = inputCoordinate.y;\n    inputCoordinate.y = float(u_inputDimensions.y) - inputCoordinate.z;\n    inputCoordinate.z = inputY;\n#elif defined(SHAPE_CYLINDER)\n    float angle = inputCoordinate.y;\n    float height = inputCoordinate.z;\n    #if (!defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE))\n    // Account for the different 0-angle convention in glTF vs 3DTiles\n    if (sampleData.tileCoords.w == 0) {\n        float angleCount = float(u_inputDimensions.z);\n        angle = mod(angle + angleCount / 2.0, angleCount);\n    }\n    #endif\n    inputCoordinate.y = height;\n    inputCoordinate.z = angle;\n#endif\n#endif\n\n    sampleData.tileUv = tileUv;\n    sampleData.inputCoordinate = inputCoordinate;\n}\n\nvoid getOctreeLeafSampleData(in OctreeNodeData data, in ivec4 octreeCoords, out SampleData sampleData) {\n    sampleData.megatextureIndex = data.data;\n    sampleData.tileCoords = (data.flag == OCTREE_FLAG_PACKED_LEAF_FROM_PARENT)\n        ? ivec4(octreeCoords.xyz / 2, octreeCoords.w - 1)\n        : octreeCoords;\n}\n\n#if (SAMPLE_COUNT > 1)\nvoid getOctreeLeafSampleDatas(in OctreeNodeData data, in ivec4 octreeCoords, out SampleData sampleDatas[SAMPLE_COUNT]) {\n    int leafIndex = data.data;\n    int leafNodeTexelCount = 2;\n    // Adding 0.5 moves to the center of the texel\n    float leafCoordXStart = float(intMod(leafIndex, u_octreeLeafNodeTilesPerRow) * leafNodeTexelCount) + 0.5;\n    float leafCoordY = float(leafIndex / u_octreeLeafNodeTilesPerRow) + 0.5;\n\n    // Get an interpolation weight and a flag to determine whether to read the parent texture\n    vec2 leafUv0 = u_octreeLeafNodeTexelSizeUv * vec2(leafCoordXStart + 0.0, leafCoordY);\n    vec4 leafData0 = texture(u_octreeLeafNodeTexture, leafUv0);\n    float lerp = normU8x2_toFloat(leafData0.xy);\n    sampleDatas[0].weight = 1.0 - lerp;\n    sampleDatas[1].weight = lerp;\n    // TODO: this looks wrong? Should be comparing to OCTREE_FLAG_PACKED_LEAF_FROM_PARENT\n    sampleDatas[0].tileCoords = (normU8_toInt(leafData0.z) == 1)\n        ? ivec4(octreeCoords.xyz / 2, octreeCoords.w - 1)\n        : octreeCoords;\n    sampleDatas[1].tileCoords = (normU8_toInt(leafData0.w) == 1)\n        ? ivec4(octreeCoords.xyz / 2, octreeCoords.w - 1)\n        : octreeCoords;\n\n    // Get megatexture indices for both samples\n    vec2 leafUv1 = u_octreeLeafNodeTexelSizeUv * vec2(leafCoordXStart + 1.0, leafCoordY);\n    vec4 leafData1 = texture(u_octreeLeafNodeTexture, leafUv1);\n    sampleDatas[0].megatextureIndex = normU8x2_toInt(leafData1.xy);\n    sampleDatas[1].megatextureIndex = normU8x2_toInt(leafData1.zw);\n}\n#endif\n\nOctreeNodeData traverseOctreeDownwards(in vec3 shapePosition, inout TraversalData traversalData) {\n    float sizeAtLevel = exp2(-1.0 * float(traversalData.octreeCoords.w));\n    vec3 start = vec3(traversalData.octreeCoords.xyz) * sizeAtLevel;\n    vec3 end = start + vec3(sizeAtLevel);\n    OctreeNodeData childData;\n\n    for (int i = 0; i < OCTREE_MAX_LEVELS; ++i) {\n        // Find out which octree child contains the position\n        // 0 if before center, 1 if after\n        vec3 center = 0.5 * (start + end);\n        vec3 childCoord = step(center, shapePosition);\n\n        // Get octree coords for the next level down\n        ivec4 octreeCoords = traversalData.octreeCoords;\n        traversalData.octreeCoords = ivec4(octreeCoords.xyz * 2 + ivec3(childCoord), octreeCoords.w + 1);\n\n        childData = getOctreeChildData(traversalData.parentOctreeIndex, ivec3(childCoord));\n\n        if (childData.flag != OCTREE_FLAG_INTERNAL) {\n            // leaf tile - stop traversing\n            break;\n        }\n\n        // interior tile - keep going deeper\n        start = mix(start, center, childCoord);\n        end = mix(center, end, childCoord);\n        traversalData.parentOctreeIndex = childData.data;\n    }\n\n    return childData;\n}\n\n/**\n* Transform a given position to an octree tile coordinate and a position within that tile,\n* and find the corresponding megatexture index and texture coordinates\n*/\nvoid traverseOctreeFromBeginning(in vec3 shapePosition, out TraversalData traversalData, out SampleData sampleDatas[SAMPLE_COUNT]) {\n    traversalData.octreeCoords = ivec4(0);\n    traversalData.parentOctreeIndex = 0;\n\n    OctreeNodeData nodeData = getOctreeNodeData(vec2(0.0));\n    if (nodeData.flag != OCTREE_FLAG_LEAF) {\n        nodeData = traverseOctreeDownwards(shapePosition, traversalData);\n    }\n\n    #if (SAMPLE_COUNT == 1)\n        getOctreeLeafSampleData(nodeData, traversalData.octreeCoords, sampleDatas[0]);\n        addSampleCoordinates(shapePosition, sampleDatas[0]);\n    #else\n        getOctreeLeafSampleDatas(nodeData, traversalData.octreeCoords, sampleDatas);\n        addSampleCoordinates(shapePosition, sampleDatas[0]);\n        addSampleCoordinates(shapePosition, sampleDatas[1]);\n    #endif\n}\n\nbool inRange(in vec3 v, in vec3 minVal, in vec3 maxVal) {\n    return clamp(v, minVal, maxVal) == v;\n}\n\nbool insideTile(in vec3 shapePosition, in ivec4 octreeCoords) {\n    vec3 tileUv = getTileUv(shapePosition, octreeCoords);\n\tbool inside = inRange(tileUv, vec3(0.0), vec3(1.0));\n\t// Assume (!) the position is always inside the root tile.\n\treturn inside || octreeCoords.w == 0;\n}\n\nvoid traverseOctreeFromExisting(in vec3 shapePosition, inout TraversalData traversalData, inout SampleData sampleDatas[SAMPLE_COUNT]) {\n    if (insideTile(shapePosition, traversalData.octreeCoords)) {\n        for (int i = 0; i < SAMPLE_COUNT; i++) {\n            addSampleCoordinates(shapePosition, sampleDatas[i]);\n        }\n        return;\n    }\n\n    // Go up tree until we find a parent tile containing shapePosition\n    for (int i = 0; i < OCTREE_MAX_LEVELS; ++i) {\n        traversalData.octreeCoords.xyz /= 2;\n        traversalData.octreeCoords.w -= 1;\n\n        if (insideTile(shapePosition, traversalData.octreeCoords)) {\n            break;\n        }\n\n        traversalData.parentOctreeIndex = getOctreeParentIndex(traversalData.parentOctreeIndex);\n    }\n\n    // Go down tree\n    OctreeNodeData nodeData = traverseOctreeDownwards(shapePosition, traversalData);\n\n    #if (SAMPLE_COUNT == 1)\n        getOctreeLeafSampleData(nodeData, traversalData.octreeCoords, sampleDatas[0]);\n        addSampleCoordinates(shapePosition, sampleDatas[0]);\n    #else\n        getOctreeLeafSampleDatas(nodeData, traversalData.octreeCoords, sampleDatas);\n        addSampleCoordinates(shapePosition, sampleDatas[0]);\n        addSampleCoordinates(shapePosition, sampleDatas[1]);\n    #endif\n}\n",Uq="// See Octree.glsl for the definitions of SampleData and intMod\n\n/* Megatexture defines (set in Scene/VoxelRenderResources.js)\n#define SAMPLE_COUNT ###\n#define NEAREST_SAMPLING\n#define PADDING\n*/\n\nuniform ivec2 u_megatextureSliceDimensions; // number of slices per tile, in two dimensions\nuniform ivec2 u_megatextureTileDimensions; // number of tiles per megatexture, in two dimensions\nuniform vec2 u_megatextureVoxelSizeUv;\nuniform vec2 u_megatextureSliceSizeUv;\nuniform vec2 u_megatextureTileSizeUv;\n\n// Integer min, max, clamp: For WebGL1 only\nint intMin(int a, int b) {\n    return a <= b ? a : b;\n}\nint intMax(int a, int b) {\n    return a >= b ? a : b;\n}\nint intClamp(int v, int minVal, int maxVal) {\n    return intMin(intMax(v, minVal), maxVal);\n}\n\nvec2 index1DTo2DTexcoord(int index, ivec2 dimensions, vec2 uvScale)\n{\n    int indexX = intMod(index, dimensions.x);\n    int indexY = index / dimensions.x;\n    return vec2(indexX, indexY) * uvScale;\n}\n\n/*\n    How is 3D data stored in a 2D megatexture?\n\n    In this example there is only one loaded tile and it has 2x2x2 voxels (8 voxels total).\n    The data is sliced by Z. The data at Z = 0 is placed in texels (0,0), (0,1), (1,0), (1,1) and\n    the data at Z = 1 is placed in texels (2,0), (2,1), (3,0), (3,1).\n    Note that there could be empty space in the megatexture because it's a power of two.\n\n      0   1   2   3\n    +---+---+---+---+\n    |   |   |   |   | 3\n    +---+---+---+---+\n    |   |   |   |   | 2\n    +-------+-------+\n    |010|110|011|111| 1\n    |--- ---|--- ---|\n    |000|100|001|101| 0\n    +-------+-------+\n\n    When doing linear interpolation the megatexture needs to be sampled twice: once for\n    the Z slice above the voxel coordinate and once for the slice below. The two slices\n    are interpolated with fract(coord.z - 0.5). For example, a Z coordinate of 1.0 is\n    halfway between two Z slices so the interpolation factor is 0.5. Below is a side view\n    of the 3D voxel grid with voxel coordinates on the left side.\n\n    2 +---+\n      |001|\n    1 +-z-+\n      |000|\n    0 +---+\n\n    When doing nearest neighbor the megatexture only needs to be sampled once at the closest Z slice.\n*/\n\nProperties getPropertiesFromMegatexture(in SampleData sampleData) {\n    int tileIndex = sampleData.megatextureIndex;\n\n    vec3 voxelCoord = sampleData.inputCoordinate;\n    #if defined(NEAREST_SAMPLING)\n        // Round to the center of the nearest voxel\n        voxelCoord = floor(voxelCoord) + vec3(0.5);\n    #endif\n\n    // Tile location\n    vec2 tileUvOffset = index1DTo2DTexcoord(tileIndex, u_megatextureTileDimensions, u_megatextureTileSizeUv);\n\n    // Slice location\n    float slice = voxelCoord.z - 0.5;\n    int sliceIndex = int(floor(slice));\n    int sliceIndex0 = intClamp(sliceIndex, 0, u_inputDimensions.z - 1);\n    vec2 sliceUvOffset0 = index1DTo2DTexcoord(sliceIndex0, u_megatextureSliceDimensions, u_megatextureSliceSizeUv);\n\n    // Voxel location\n    vec2 voxelUvOffset = clamp(voxelCoord.xy, vec2(0.5), vec2(u_inputDimensions.xy) - vec2(0.5)) * u_megatextureVoxelSizeUv;\n\n    // Final location in the megatexture\n    vec2 uv0 = tileUvOffset + sliceUvOffset0 + voxelUvOffset;\n\n    #if defined(NEAREST_SAMPLING)\n        return getPropertiesFromMegatextureAtUv(uv0);\n    #else\n        float sliceLerp = fract(slice);\n        int sliceIndex1 = intMin(sliceIndex + 1, u_inputDimensions.z - 1);\n        vec2 sliceUvOffset1 = index1DTo2DTexcoord(sliceIndex1, u_megatextureSliceDimensions, u_megatextureSliceSizeUv);\n        vec2 uv1 = tileUvOffset + sliceUvOffset1 + voxelUvOffset;\n        Properties properties0 = getPropertiesFromMegatextureAtUv(uv0);\n        Properties properties1 = getPropertiesFromMegatextureAtUv(uv1);\n        return mixProperties(properties0, properties1, sliceLerp);\n    #endif\n}\n\n// Convert an array of sample datas to a final weighted properties.\nProperties accumulatePropertiesFromMegatexture(in SampleData sampleDatas[SAMPLE_COUNT]) {\n    #if (SAMPLE_COUNT == 1)\n        return getPropertiesFromMegatexture(sampleDatas[0]);\n    #else\n        // When more than one sample is taken the accumulator needs to start at 0\n        Properties properties = clearProperties();\n        for (int i = 0; i < SAMPLE_COUNT; ++i) {\n            float weight = sampleDatas[i].weight;\n\n            // Avoid reading the megatexture when the weight is 0 as it can be costly.\n            if (weight > 0.0) {\n                Properties tempProperties = getPropertiesFromMegatexture(sampleDatas[i]);\n                tempProperties = scaleProperties(tempProperties, weight);\n                properties = sumProperties(properties, tempProperties);\n            }\n        }\n        return properties;\n    #endif\n}\n",kq=Object.freeze({Z_UP:0,Y_UP:1}),Vq=function(e){const t=new pt.A;this.shaderBuilder=t;const n=e._customShader,i=(0,tC.A)(e._uniformMap,n.uniformMap);e._uniformMap=i;const o=n.uniforms;for(const e in o)if(o.hasOwnProperty(e)){const n=o[e];t.addUniform(n.type,e,ft.A.FRAGMENT)}t.addUniform("sampler2D","u_megatextureTextures[METADATA_COUNT]",ft.A.FRAGMENT),this.uniformMap=i;const r=e._clippingPlanes,s=(0,d.A)(r)&&r.enabled?r.length:0;this.clippingPlanes=r,this.clippingPlanesLength=s,t.addVertexLines([Cq]),e.provider.metadataOrder===kq.Y_UP&&t.addDefine("Y_UP_METADATA_ORDER",void 0,ft.A.FRAGMENT);const a=e._provider.shape;"BOX"===a?t.addDefine("SHAPE_BOX",void 0,ft.A.FRAGMENT):"CYLINDER"===a?t.addDefine("SHAPE_CYLINDER",void 0,ft.A.FRAGMENT):"ELLIPSOID"===a&&t.addDefine("SHAPE_ELLIPSOID",void 0,ft.A.FRAGMENT),t.addFragmentLines([n.fragmentShaderText,"#line 0",Fq,wq,Eq,Uq]),s>0&&(t.addDefine("CLIPPING_PLANES",void 0,ft.A.FRAGMENT),t.addDefine("CLIPPING_PLANES_COUNT",s,ft.A.FRAGMENT),r.unionClippingRegions&&t.addDefine("CLIPPING_PLANES_UNION",void 0,ft.A.FRAGMENT),t.addFragmentLines([Iq])),t.addFragmentLines([Sq]),e._depthTest&&t.addDefine("DEPTH_TEST",void 0,ft.A.FRAGMENT),"BOX"===a?t.addFragmentLines([Lq,Dq,Mq]):"CYLINDER"===a?t.addFragmentLines([Nq,Pq,Oq,Mq]):"ELLIPSOID"===a&&t.addFragmentLines([Bq,Pq,Rq,Mq]),t.addFragmentLines([xq]);const c=e._shape,l=c.shaderDefines;for(const e in l)if(l.hasOwnProperty(e)){let n=l[e];(0,d.A)(n)&&(n=!0===n?void 0:n,t.addDefine(e,n,ft.A.FRAGMENT))}let u=c.shaderMaximumIntersectionsLength;s>0&&(t.addDefine("CLIPPING_PLANES_INTERSECTION_INDEX",u,ft.A.FRAGMENT),1===s?u+=1:r.unionClippingRegions?u+=2:u+=1),e._depthTest&&(t.addDefine("DEPTH_INTERSECTION_INDEX",u,ft.A.FRAGMENT),u+=1),t.addDefine("INTERSECTION_COUNT",u,ft.A.FRAGMENT),j.A.equals(e.paddingBefore,j.A.ZERO)&&j.A.equals(e.paddingAfter,j.A.ZERO)||t.addDefine("PADDING",void 0,ft.A.FRAGMENT),e._useLogDepth&&t.addDefine("LOG_DEPTH_READ_ONLY",void 0,ft.A.FRAGMENT),e._nearestSampling&&t.addDefine("NEAREST_SAMPLING",void 0,ft.A.FRAGMENT);const h=e._traversal;t.addDefine("SAMPLE_COUNT",`${h._sampleCount}`,ft.A.FRAGMENT)};function zq(e){return e===yF.A.SCALAR?"float":e===yF.A.VEC2?"vec2":e===yF.A.VEC3?"vec3":e===yF.A.VEC4?"vec4":void 0}function Hq(e){return e===yF.A.SCALAR?".r":e===yF.A.VEC2?".ra":e===yF.A.VEC3?".rgb":e===yF.A.VEC4?"":void 0}function Gq(e){let t=e.toString();return-1===t.indexOf(".")&&(t=`${e}.0`),t}function Wq(e,t){return e===yF.A.SCALAR?"":`[${t}]`}const Yq=function(e,t){const{shaderBuilder:n}=e,{names:i,types:o,componentTypes:r,minimumValues:s,maximumValues:a}=t._provider,c=o.length,l=(0,d.A)(s)&&(0,d.A)(a);n.addDefine("METADATA_COUNT",c,ft.A.FRAGMENT),l&&n.addDefine("STATISTICS",void 0,ft.A.FRAGMENT);for(let e=0;e<c;e++){const t=i[e],r=zq(o[e]),s=`PropertyStatistics_${t}`,a=`PropertyStatistics_${t}`;n.addStruct(s,a,ft.A.FRAGMENT),n.addStructField(s,r,"min"),n.addStructField(s,r,"max")}const u="MetadataStatistics",h="MetadataStatistics",A="metadataStatistics";n.addStruct(u,h,ft.A.FRAGMENT);for(let e=0;e<c;e++){const t=i[e],o=`PropertyStatistics_${t}`,r=t;n.addStructField(u,o,r)}const p="Metadata",f="Metadata",m="metadata";n.addStruct(p,f,ft.A.FRAGMENT);for(let e=0;e<c;e++){const t=zq(o[e]);n.addStructField(p,t,i[e])}const g="Attributes",_="Attributes";n.addStruct(g,_,ft.A.FRAGMENT),n.addStructField(g,"vec3","positionEC"),n.addStructField(g,"vec3","normalEC");const y="Voxel",v="Voxel";n.addStruct(y,v,ft.A.FRAGMENT),n.addStructField(y,"vec3","viewDirUv"),n.addStructField(y,"float","travelDistance"),n.addStructField(y,"int","stepCount"),n.addStructField(y,"int","tileIndex"),n.addStructField(y,"int","sampleIndex"),n.addStructField(y,"float","distanceToDepthBuffer");const T="FragmentInput";n.addStruct(T,"FragmentInput",ft.A.FRAGMENT),n.addStructField(T,h,A),n.addStructField(T,f,m),n.addStructField(T,_,"attributes"),n.addStructField(T,v,"voxel");const b="Properties",w="Properties",x="properties";n.addStruct(b,w,ft.A.FRAGMENT);for(let e=0;e<c;e++){const t=zq(o[e]);n.addStructField(b,t,i[e])}{const e="clearProperties";n.addFunction(e,`${w} clearProperties()`,ft.A.FRAGMENT),n.addFunctionLines(e,[`${w} ${x};`]);for(let t=0;t<c;t++){const s=zq(o[t],r[t]);n.addFunctionLines(e,[`${x}.${i[t]} = ${s}(0.0);`])}n.addFunctionLines(e,[`return ${x};`])}{const e="sumProperties";n.addFunction(e,`${w} sumProperties(${w} propertiesA, ${w} propertiesB)`,ft.A.FRAGMENT),n.addFunctionLines(e,[`${w} ${x};`]);for(let t=0;t<c;t++){const o=i[t];n.addFunctionLines(e,[`${x}.${o} = propertiesA.${o} + propertiesB.${o};`])}n.addFunctionLines(e,[`return ${x};`])}{const e="scaleProperties";n.addFunction(e,`${w} scaleProperties(${w} ${x}, float scale)`,ft.A.FRAGMENT),n.addFunctionLines(e,[`${w} scaledProperties = ${x};`]);for(let t=0;t<c;t++)n.addFunctionLines(e,[`scaledProperties.${i[t]} *= scale;`]);n.addFunctionLines(e,["return scaledProperties;"])}{const e="mixProperties";n.addFunction(e,`${w} mixProperties(${w} propertiesA, ${w} propertiesB, float mixFactor)`,ft.A.FRAGMENT),n.addFunctionLines(e,[`${w} ${x};`]);for(let t=0;t<c;t++){const o=i[t];n.addFunctionLines(e,[`${x}.${o} = mix(propertiesA.${o}, propertiesB.${o}, mixFactor);`])}n.addFunctionLines(e,[`return ${x};`])}{const e="copyPropertiesToMetadata";n.addFunction(e,`void copyPropertiesToMetadata(in ${w} ${x}, inout ${f} ${m})`,ft.A.FRAGMENT);for(let t=0;t<c;t++){const o=i[t];n.addFunctionLines(e,[`${m}.${o} = ${x}.${o};`])}}if(l){const e="setStatistics";n.addFunction(e,`void setStatistics(inout ${h} ${A})`,ft.A.FRAGMENT);for(let t=0;t<c;t++){const r=i[t],c=o[t],l=yF.A.getComponentCount(c);for(let i=0;i<l;i++){const o=Wq(c,i),l=s[t][i],u=a[t][i];(0,d.A)(l)&&(0,d.A)(u)&&n.addFunctionLines(e,[`${A}.${r}.min${o} = ${Gq(l)};`,`${A}.${r}.max${o} = ${Gq(u)};`])}}}{const e="getPropertiesFromMegatextureAtUv";n.addFunction(e,`${w} getPropertiesFromMegatextureAtUv(vec2 texcoord)`,ft.A.FRAGMENT),n.addFunctionLines(e,[`${w} ${x};`]);for(let t=0;t<c;t++){const s=o[t],a=(r[t],Hq(s));n.addFunctionLines(e,[`properties.${i[t]} = texture(u_megatextureTextures[${t}], texcoord)${a};`])}n.addFunctionLines(e,[`return ${x};`])}},qq=function(e,t){const n=new Vq(e);Yq(n,e);const{shaderBuilder:i,clippingPlanes:o,clippingPlanesLength:r}=n;if(r>0){const e="getClippingPlane",n=jM(o,t),r=0,s=n.indexOf(")")+1,a=n.indexOf("{",s)+1,c=n.indexOf("}",a),l=n.slice(r,s),u=n.slice(a,c);i.addFunction(e,l,ft.A.FRAGMENT),i.addFunctionLines(e,[u])}const s=i.clone();s.addDefine("PICKING",void 0,ft.A.FRAGMENT);const a=i.clone();a.addDefine("PICKING_VOXEL",void 0,ft.A.FRAGMENT);const c=i.buildShaderProgram(t),l=s.buildShaderProgram(t),u=a.buildShaderProgram(t),h=_.A.fromCache({cull:{enabled:!0,face:CB.A.BACK},depthTest:{enabled:!1},depthMask:!1,blending:$M.A.PRE_MULTIPLIED_ALPHA_BLEND}),A=t.getViewportQuadVertexArray(),f=e._depthTest,g=new m.A({vertexArray:A,primitiveType:p.A.TRIANGLES,renderState:h,shaderProgram:c,uniformMap:n.uniformMap,modelMatrix:e._compoundModelMatrix,pass:ut.A.VOXELS,executeInClosestFrustum:!0,owner:this,cull:f,occlude:f}),y=m.A.shallowClone(g,new m.A);y.shaderProgram=l,y.pickOnly=!0;const v=m.A.shallowClone(g,new m.A);if(v.shaderProgram=u,v.pickOnly=!0,(0,d.A)(e._drawCommand)){const t=e._drawCommand;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()}if((0,d.A)(e._drawCommandPick)){const t=e._drawCommandPick;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()}if((0,d.A)(e._drawCommandPickVoxel)){const t=e._drawCommandPickVoxel;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()}e._drawCommand=g,e._drawCommandPick=y,e._drawCommandPickVoxel=v};var jq=n(485760),Qq=n(212525);const Xq=Object.freeze({FLOAT:"float",VEC2:"vec2",VEC3:"vec3",VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",MAT2:"mat2",MAT3:"mat3",MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"});function Kq(){this._defaultTexture=void 0,this._textures={},this._loadedImages=[],this._lastUpdatedFrame=-1}function $q(e,t,n){const{id:i,textureUniform:o,image:r}=t,s=n.webgl2?Jq(o,r,n):function(e,t,n){const{typedArray:i,sampler:o}=e,r=Zq(o),s=o.wrapS===It.A.REPEAT||o.wrapS===It.A.MIRRORED_REPEAT||o.wrapT===It.A.REPEAT||o.wrapT===It.A.MIRRORED_REPEAT,{width:a,height:c}=(0,d.A)(i)?e:t,l=[a,c].every(J.A.isPowerOfTwo);if(!r&&!s||l)return Jq(e,t,n);if(!(0,d.A)(i))return Jq(e,(0,LM.A)(t),n);if(e.pixelDatatype===U.A.UNSIGNED_BYTE){const e=yM(i,a,c);return Jq({sampler:o},(0,LM.A)(e),n)}return r?console.warn("Texture requires resizing for mipmaps but pixelDataType cannot be resized. The texture may be rendered incorrectly."):s&&console.warn("Texture requires resizing for wrapping but pixelDataType cannot be resized. The texture may be rendered incorrectly."),ej(e,n)}(o,r,n),a=e._textures[i];(0,d.A)(a)&&a!==n.defaultTexture&&a.destroy(),e._textures[i]=s}function Jq(e,t,n){const{typedArray:i,sampler:o}=e,r=(0,d.A)(i)?ej(e,n):new G.A({context:n,source:t,sampler:o});return Zq(o)&&r.generateMipmap(),r}function Zq(e){return[bt.A.NEAREST_MIPMAP_NEAREST,bt.A.NEAREST_MIPMAP_LINEAR,bt.A.LINEAR_MIPMAP_NEAREST,bt.A.LINEAR_MIPMAP_LINEAR].includes(e.minificationFilter)}function ej(e,t){const{pixelFormat:n,pixelDatatype:i,width:o,height:r,typedArray:s,sampler:a}=e;return new G.A({context:t,pixelFormat:n,pixelDatatype:i,source:{arrayBufferView:s,width:o,height:r},sampler:a,flipY:!1})}Kq.prototype.getTexture=function(e){return this._textures[e]},Kq.prototype.loadTexture2D=function(e,t){(0,d.A)(t.typedArray)?this._loadedImages.push({id:e,textureUniform:t}):function(e,t,n){n.resource.fetchImage().then(function(i){e._loadedImages.push({id:t,image:i,textureUniform:n})}).catch(function(){const n=e._textures[t];(0,d.A)(n)&&n!==e._defaultTexture&&n.destroy(),e._textures[t]=e._defaultTexture})}(this,e,t)},Kq.prototype.update=function(e){if(e.frameNumber===this._lastUpdatedFrame)return;this._lastUpdatedFrame=e.frameNumber;const t=e.context;this._defaultTexture=t.defaultTexture;const n=this._loadedImages;for(let e=0;e<n.length;e++)$q(this,n[e],t);n.length=0},Kq.prototype.isDestroyed=function(){return!1},Kq.prototype.destroy=function(){const e=this._textures;for(const t in e)if(e.hasOwnProperty(t)){const n=e[t];n!==this._defaultTexture&&n.destroy()}return(0,h.A)(this)};const tj=Kq;var nj=n(747680);function ij(e){e=e??S.A.EMPTY_OBJECT,this.mode=e.mode??Qq.A.MODIFY_MATERIAL,this.lightingModel=e.lightingModel,this.uniforms=e.uniforms??S.A.EMPTY_OBJECT,this.varyings=e.varyings??S.A.EMPTY_OBJECT,this.vertexShaderText=e.vertexShaderText,this.fragmentShaderText=e.fragmentShaderText,this.translucencyMode=e.translucencyMode??nj.A.INHERIT,this._textureManager=new tj,this._defaultTexture=void 0,this.uniformMap=function(e){const t=e.uniforms,n={};for(const i in t)if(t.hasOwnProperty(i)){const o=t[i],r=o.type;if(r===Xq.SAMPLER_CUBE)throw new A.A("CustomShader does not support samplerCube uniforms");r===Xq.SAMPLER_2D?(e._textureManager.loadTexture2D(i,o.value),n[i]=oj(e,i)):n[i]=rj(e,i)}return n}(this),this.usedVariablesVertex={attributeSet:{},featureIdSet:{},metadataSet:{}},this.usedVariablesFragment={attributeSet:{},featureIdSet:{},metadataSet:{},materialSet:{}},function(e){const t=/[vf]sInput\.attributes\.(\w+)/g,n=/[vf]sInput\.featureIds\.(\w+)/g,i=/[vf]sInput\.metadata.(\w+)/g;let o;const r=e.vertexShaderText;(0,d.A)(r)&&(o=e.usedVariablesVertex.attributeSet,sj(r,t,o),o=e.usedVariablesVertex.featureIdSet,sj(r,n,o),o=e.usedVariablesVertex.metadataSet,sj(r,i,o));const s=e.fragmentShaderText;(0,d.A)(s)&&(o=e.usedVariablesFragment.attributeSet,sj(s,t,o),o=e.usedVariablesFragment.featureIdSet,sj(s,n,o),o=e.usedVariablesFragment.metadataSet,sj(s,i,o),sj(s,/material\.(\w+)/g,e.usedVariablesFragment.materialSet))}(this),function(e){const t=e.usedVariablesVertex.attributeSet;cj(t,"position","positionMC","vertex"),cj(t,"normal","normalMC","vertex"),cj(t,"tangent","tangentMC","vertex"),cj(t,"bitangent","bitangentMC","vertex"),cj(t,"positionWC","positionMC","vertex"),cj(t,"positionEC","positionMC","vertex"),cj(t,"normalEC","normalMC","vertex"),cj(t,"tangentEC","tangentMC","vertex"),cj(t,"bitangentEC","bitangentMC","vertex");const n=e.usedVariablesFragment.attributeSet;cj(n,"position","positionEC","fragment"),cj(n,"normal","normalEC","fragment"),cj(n,"tangent","tangentEC","fragment"),cj(n,"bitangent","bitangentEC","fragment"),cj(n,"normalMC","normalEC","fragment"),cj(n,"tangentMC","tangentEC","fragment"),cj(n,"bitangentMC","bitangentEC","fragment")}(this)}function oj(e,t){return function(){return e._textureManager.getTexture(t)??e._defaultTexture}}function rj(e,t){return function(){return e.uniforms[t].value}}function sj(e,t,n){let i;for(;null!==(i=t.exec(e));)n[i[1]]=!0}function aj(e){return/^.*MC$/.test(e)?`${e} (model coordinates)`:/^.*WC$/.test(e)?`${e} (Cartesian world coordinates)`:/^.*EC$/.test(e)?`${e} (eye coordinates)`:e}function cj(e,t,n,i){if(e.hasOwnProperty(t)){const e=`${aj(t)} is not available in the ${i} shader. Did you mean ${aj(n)} instead?`;throw new A.A(e)}}ij.prototype.setUniform=function(e,t){if(l.A.typeOf.string("uniformName",e),l.A.defined("value",t),!(0,d.A)(this.uniforms[e]))throw new A.A(`Uniform ${e} must be declared in the CustomShader constructor.`);const n=this.uniforms[e];n.type===Xq.SAMPLER_2D?this._textureManager.loadTexture2D(e,t):(0,d.A)(t.clone)?n.value=t.clone(n.value):n.value=t},ij.prototype.update=function(e){this._defaultTexture=e.context.defaultTexture,this._textureManager.update(e)},ij.prototype.isDestroyed=function(){return!1},ij.prototype.destroy=function(){this._textureManager=this._textureManager&&this._textureManager.destroy(),(0,h.A)(this)};const lj=ij;var uj=n(982504);function dj(e){if(l.A.typeOf.object("options",e),!(0,d.A)(e.loader)){if(!(0,d.A)(e.metadata))throw new A.A("One of loader and metadata must be defined.");if(!Array.isArray(e.metadata))throw new A.A("metadata must be an array of TypedArrays.")}const{loader:t,metadata:n}=e;this._loader=t,this._metadata=n,this._resourcesLoaded=!1,this._ready=!1}Object.defineProperties(dj.prototype,{ready:{get:function(){return this._ready}},metadata:{get:function(){return this._metadata}}}),dj.fromMetadataArray=function(e){if(l.A.typeOf.object("metadata",e),!Array.isArray(e))throw new A.A("metadata must be an array of TypedArrays.");return new dj({metadata:e})},dj.fromGltf=async function(e){l.A.typeOf.object("resource",e);const t=new uj.A({gltfResource:e,releaseGltfJson:!1,loadAttributesAsTypedArray:!0});try{await t.load()}catch(e){throw t.destroy(),e}return new dj({loader:t})},dj.prototype.update=function(e,t){const n=this._loader;if(!this._ready)if(t.afterRender.push(()=>!0),(0,d.A)(n)){if(this._resourcesLoaded){const{structuralMetadata:t,scene:i}=n.components,{attributes:o}=i.nodes[0].primitives[0];return this._metadata=function(e,t,n){const{className:i,names:o,types:r,componentTypes:s}=n.provider,a=t.propertyAttributes.find(e=>e.class.id===i),{properties:c}=a,l=new Array(o.length);for(let t=0;t<e.length;t++){const n=c[o[t]].attribute,i=e.find(e=>e.name===n);if(!(0,d.A)(i))continue;const a=_F.A.toComponentDatatype(s[t]),u=yF.A.getComponentCount(r[t]),h=i.count*u;l[t]=C.A.createArrayBufferView(a,i.typedArray.buffer,i.typedArray.byteOffset+i.byteOffset,h)}return l}(o,t,e),void(this._ready=!0)}this._resourcesLoaded=n.process(t)}else this._ready=!0},dj.prototype.isDestroyed=function(){return!1},dj.prototype.destroy=function(){return this._loader=this._loader&&this._loader.destroy(),(0,h.A)(this)};const hj=dj;function Aj(){this.orientedBoundingBox=new lD.A,this.boundingSphere=new Sn.A,this.boundTransform=new O.A,this.shapeTransform=new O.A,this._minBounds=Aj.DefaultMinBounds.clone(),this._maxBounds=Aj.DefaultMaxBounds.clone(),this.shaderUniforms={renderMinBounds:new j.A,renderMaxBounds:new j.A,boxUvToShapeUvScale:new j.A,boxUvToShapeUvTranslate:new j.A},this.shaderDefines={BOX_INTERSECTION_INDEX:void 0,BOX_HAS_SHAPE_BOUNDS:void 0},this.shaderMaximumIntersectionsLength=0}const pj=new j.A,fj=new j.A,mj=new Z.A,gj=new j.A,_j=new j.A,yj=new j.A,vj=new j.A,Tj=O.A.fromRotationTranslation(Z.A.fromUniformScale(.5,new Z.A),new j.A(.5,.5,.5),new O.A);Aj.prototype.update=function(e,t,n,i,o){l.A.typeOf.object("modelMatrix",e),l.A.typeOf.object("minBounds",t),l.A.typeOf.object("maxBounds",n),i=i??t.clone(gj),o=o??n.clone(_j),t=j.A.clone(t,this._minBounds),n=j.A.clone(n,this._maxBounds);const r=j.A.clamp(t,i,o,yj),s=j.A.clamp(n,i,o,vj),a=O.A.getScale(e,fj);if(r.x>s.x||r.y>s.y||r.z>s.z||(r.x===s.x)+(r.y===s.y)+(r.z===s.z)>=2||0===a.x||0===a.y||0===a.z)return!1;this.shapeTransform=O.A.clone(e,this.shapeTransform),this.orientedBoundingBox=Cj(r,s,this.shapeTransform,this.orientedBoundingBox),this.boundTransform=O.A.fromRotationTranslation(this.orientedBoundingBox.halfAxes,this.orientedBoundingBox.center,this.boundTransform),this.boundingSphere=Sn.A.fromOrientedBoundingBox(this.orientedBoundingBox,this.boundingSphere);const{shaderUniforms:c,shaderDefines:u}=this;for(const e in u)u.hasOwnProperty(e)&&(u[e]=void 0);let d=0;u.BOX_INTERSECTION_INDEX=d,d+=1,c.renderMinBounds=O.A.multiplyByPoint(Tj,r,c.renderMinBounds),c.renderMaxBounds=O.A.multiplyByPoint(Tj,s,c.renderMaxBounds),u.BOX_HAS_SHAPE_BOUNDS=!0;const h=t,A=n;return c.boxUvToShapeUvScale=j.A.fromElements(2/(h.x===A.x?1:A.x-h.x),2/(h.y===A.y?1:A.y-h.y),2/(h.z===A.z?1:A.z-h.z),c.boxUvToShapeUvScale),c.boxUvToShapeUvTranslate=j.A.fromElements(-c.boxUvToShapeUvScale.x*(.5*h.x+.5),-c.boxUvToShapeUvScale.y*(.5*h.y+.5),-c.boxUvToShapeUvScale.z*(.5*h.z+.5),c.boxUvToShapeUvTranslate),this.shaderMaximumIntersectionsLength=d,!0};const bj=new j.A,wj=new j.A;Aj.prototype.computeOrientedBoundingBoxForTile=function(e,t,n,i,o){l.A.typeOf.number("tileLevel",e),l.A.typeOf.number("tileX",t),l.A.typeOf.number("tileY",n),l.A.typeOf.number("tileZ",i),l.A.typeOf.object("result",o);const r=this._minBounds,s=this._maxBounds,a=1/Math.pow(2,e);return Cj(j.A.fromElements(J.A.lerp(r.x,s.x,a*t),J.A.lerp(r.y,s.y,a*n),J.A.lerp(r.z,s.z,a*i),bj),j.A.fromElements(J.A.lerp(r.x,s.x,a*(t+1)),J.A.lerp(r.y,s.y,a*(n+1)),J.A.lerp(r.z,s.z,a*(i+1)),wj),this.shapeTransform,o)};const xj=new j.A;function Cj(e,t,n,i){const o=Aj.DefaultMinBounds,r=Aj.DefaultMaxBounds;if(j.A.equals(e,o)&&j.A.equals(t,r))i.center=O.A.getTranslation(n,i.center),i.halfAxes=O.A.getMatrix3(n,i.halfAxes);else{let o=O.A.getScale(n,fj);const r=j.A.midpoint(e,t,pj);i.center=O.A.multiplyByPoint(n,r,i.center),o=j.A.fromElements(.5*o.x*(t.x-e.x),.5*o.y*(t.y-e.y),.5*o.z*(t.z-e.z),fj);const s=O.A.getRotation(n,mj);i.halfAxes=Z.A.setScale(s,o,i.halfAxes)}return i}Aj.prototype.computeOrientedBoundingBoxForSample=function(e,t,n,i){l.A.typeOf.object("spatialNode",e),l.A.typeOf.object("tileDimensions",t),l.A.typeOf.object("tileUv",n),l.A.typeOf.object("result",i);const o=1/Math.pow(2,e.level),r=j.A.divideComponents(j.A.ONE,t,xj),s=j.A.multiplyByScalar(r,o,xj),a=j.A.multiplyByScalar(j.A.fromElements(e.x+n.x,e.y+n.y,e.z+n.z,bj),o,bj),c=j.A.add(a,s,wj),u=this._minBounds,d=this._maxBounds;return Cj(j.A.fromElements(J.A.lerp(u.x,d.x,a.x),J.A.lerp(u.y,d.y,a.y),J.A.lerp(u.z,d.z,a.z),bj),j.A.fromElements(J.A.lerp(u.x,d.x,c.x),J.A.lerp(u.y,d.y,c.y),J.A.lerp(u.z,d.z,c.z),wj),this.shapeTransform,i)},Aj.DefaultMinBounds=Object.freeze(new j.A(-1,-1,-1)),Aj.DefaultMaxBounds=Object.freeze(new j.A(1,1,1));const Ej=Aj;function Sj(){this.orientedBoundingBox=new lD.A,this.boundingSphere=new Sn.A,this.boundTransform=new O.A,this.shapeTransform=new O.A,this._minBounds=Sj.DefaultMinBounds.clone(),this._maxBounds=Sj.DefaultMaxBounds.clone(),this.shaderUniforms={cylinderRenderRadiusMinMax:new q.A,cylinderRenderAngleMinMax:new q.A,cylinderRenderHeightMinMax:new q.A,cylinderUvToShapeUvRadius:new q.A,cylinderUvToShapeUvAngle:new q.A,cylinderUvToShapeUvHeight:new q.A,cylinderShapeUvAngleMinMax:new q.A,cylinderShapeUvAngleRangeZeroMid:0},this.shaderDefines={CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MIN:void 0,CYLINDER_HAS_RENDER_BOUNDS_RADIUS_FLAT:void 0,CYLINDER_HAS_RENDER_BOUNDS_ANGLE:void 0,CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_ZERO:void 0,CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_UNDER_HALF:void 0,CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_OVER_HALF:void 0,CYLINDER_HAS_SHAPE_BOUNDS_RADIUS:void 0,CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT:void 0,CYLINDER_HAS_SHAPE_BOUNDS_ANGLE:void 0,CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY:void 0,CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY:void 0,CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED:void 0,CYLINDER_INTERSECTION_INDEX_RADIUS_MAX:void 0,CYLINDER_INTERSECTION_INDEX_RADIUS_MIN:void 0,CYLINDER_INTERSECTION_INDEX_ANGLE:void 0},this.shaderMaximumIntersectionsLength=0}const Ij=new j.A,Pj=new j.A,Dj=new j.A,Oj=new j.A,Rj=new j.A;Sj.prototype.update=function(e,t,n,i,o){l.A.typeOf.object("modelMatrix",e),l.A.typeOf.object("minBounds",t),l.A.typeOf.object("maxBounds",n),i=i??t.clone(Pj),o=o??n.clone(Dj),t=j.A.clone(t,this._minBounds),n=j.A.clone(n,this._maxBounds);const{DefaultMinBounds:r,DefaultMaxBounds:s}=Sj,a=s.y-r.y,c=.5*a,u=J.A.EPSILON10,d=J.A.EPSILON3,h=J.A.EPSILON10;t.x=Math.max(0,t.x),n.x=Math.max(0,n.x),t.y=J.A.negativePiToPi(t.y),n.y=J.A.negativePiToPi(n.y),i.y=J.A.negativePiToPi(i.y),o.y=J.A.negativePiToPi(o.y);const A=j.A.maximumByComponent(t,i,Oj),p=j.A.minimumByComponent(n,o,Rj),f=O.A.getScale(e,Ij);if(0===p.x||A.x>p.x||A.z>p.z||J.A.equalsEpsilon(f.x,0,void 0,u)||J.A.equalsEpsilon(f.y,0,void 0,u)||J.A.equalsEpsilon(f.z,0,void 0,u))return!1;this.shapeTransform=O.A.clone(e,this.shapeTransform),this.orientedBoundingBox=Qj(A,p,this.shapeTransform,this.orientedBoundingBox),this.boundTransform=O.A.fromRotationTranslation(this.orientedBoundingBox.halfAxes,this.orientedBoundingBox.center,this.boundTransform),this.boundingSphere=Sn.A.fromOrientedBoundingBox(this.orientedBoundingBox,this.boundingSphere);const m=t.x===r.x&&n.x===s.x,g=n.y<t.y,_=n.y-t.y+g*a,y=_>c+h&&_<a-h||_<c-h||_>=c-h&&_<=c+h,v=J.A.equalsEpsilon(t.y,r.y,void 0,d),T=J.A.equalsEpsilon(n.y,s.y,void 0,d),b=t.z===r.z&&n.z===s.z,w=A.x===r.x,x=p.y<A.y,C=p.y-A.y+x*a,E=C>=c-h&&C<a-h,S=C>h&&C<c-h,I=C<=h,P=E||S||I,{shaderUniforms:D,shaderDefines:R}=this;for(const e in R)R.hasOwnProperty(e)&&(R[e]=void 0);let M=0;if(R.CYLINDER_INTERSECTION_INDEX_RADIUS_MAX=M,M+=1,w||(R.CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MIN=!0,R.CYLINDER_INTERSECTION_INDEX_RADIUS_MIN=M,M+=1),D.cylinderRenderRadiusMinMax=q.A.fromElements(A.x,p.x,D.cylinderRenderRadiusMinMax),A.x===p.x&&(R.CYLINDER_HAS_RENDER_BOUNDS_RADIUS_FLAT=!0),!m){R.CYLINDER_HAS_SHAPE_BOUNDS_RADIUS=!0;const e=n.x-t.x;let i=0,o=1;0!==e&&(i=1/e,o=-t.x/e),D.cylinderUvToShapeUvRadius=q.A.fromElements(i,o,D.cylinderUvToShapeUvRadius)}if(!b){R.CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT=!0;const e=n.z-t.z;let i=0,o=1;0!==e&&(i=2/e,o=-(t.z+1)/e),D.cylinderUvToShapeUvHeight=q.A.fromElements(i,o,D.cylinderUvToShapeUvHeight)}if(D.cylinderRenderHeightMinMax=q.A.fromElements(A.z,p.z,D.cylinderRenderHeightMinMax),g&&(R.CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED=!0),P&&(R.CYLINDER_HAS_RENDER_BOUNDS_ANGLE=!0,R.CYLINDER_INTERSECTION_INDEX_ANGLE=M,E?(R.CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_UNDER_HALF=!0,M+=1):S?(R.CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_OVER_HALF=!0,M+=2):I&&(R.CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_ZERO=!0,M+=2),D.cylinderRenderAngleMinMax=q.A.fromElements(A.y,p.y,D.cylinderRenderAngleMinMax)),y){R.CYLINDER_HAS_SHAPE_BOUNDS_ANGLE=!0,v&&(R.CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY=!0),T&&(R.CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY=!0);const e=(t.y-r.y)/a,i=(n.y-r.y)/a,o=1-_/a;if(D.cylinderShapeUvAngleMinMax=q.A.fromElements(e,i,D.cylinderShapeUvAngleMinMax),D.cylinderShapeUvAngleRangeZeroMid=(i+.5*o)%1,_<=h)D.cylinderUvToShapeUvAngle=q.A.fromElements(0,1,D.cylinderUvToShapeUvAngle);else{const e=a/_,n=-(t.y-r.y)/_;D.cylinderUvToShapeUvAngle=q.A.fromElements(e,n,D.cylinderUvToShapeUvAngle)}}return this.shaderMaximumIntersectionsLength=M,!0};const Mj=new j.A,Lj=new j.A;Sj.prototype.computeOrientedBoundingBoxForTile=function(e,t,n,i,o){l.A.typeOf.number("tileLevel",e),l.A.typeOf.number("tileX",t),l.A.typeOf.number("tileY",n),l.A.typeOf.number("tileZ",i),l.A.typeOf.object("result",o);const r=this._minBounds,s=this._maxBounds,a=1/Math.pow(2,e);return Qj(j.A.fromElements(J.A.lerp(r.x,s.x,t*a),J.A.lerp(r.y,s.y,n*a),J.A.lerp(r.z,s.z,i*a),Mj),j.A.fromElements(J.A.lerp(r.x,s.x,(t+1)*a),J.A.lerp(r.y,s.y,(n+1)*a),J.A.lerp(r.z,s.z,(i+1)*a),Lj),this.shapeTransform,o)};const Nj=new j.A;Sj.prototype.computeOrientedBoundingBoxForSample=function(e,t,n,i){l.A.typeOf.object("spatialNode",e),l.A.typeOf.object("tileDimensions",t),l.A.typeOf.object("tileUv",n),l.A.typeOf.object("result",i);const o=1/Math.pow(2,e.level),r=j.A.divideComponents(j.A.ONE,t,Nj),s=j.A.multiplyByScalar(r,o,Nj),a=j.A.multiplyByScalar(j.A.fromElements(e.x+n.x,e.y+n.y,e.z+n.z,Mj),o,Mj),c=j.A.add(a,s,Lj),u=this._minBounds,d=this._maxBounds;return Qj(j.A.fromElements(J.A.lerp(u.x,d.x,a.x),J.A.lerp(u.y,d.y,a.y),J.A.lerp(u.z,d.z,a.z),Mj),j.A.fromElements(J.A.lerp(u.x,d.x,c.x),J.A.lerp(u.y,d.y,c.y),J.A.lerp(u.z,d.z,c.z),Lj),this.shapeTransform,i)},Sj.DefaultMinBounds=Object.freeze(new j.A(0,-J.A.PI,-1)),Sj.DefaultMaxBounds=Object.freeze(new j.A(1,+J.A.PI,1));const Bj=new Array(5),Fj=new j.A,Uj=new Z.A,kj=new O.A,Vj=new O.A,zj=new O.A,Hj=new O.A,Gj=new j.A,Wj=new j.A,Yj=new j.A,qj=new Array(8);for(let e=0;e<8;e++)qj[e]=new j.A;function jj(e,t,n){return Math.abs(Q.A.dot(e,t))<n}function Qj(e,t,n,i){const o=e.x,r=t.x,s=e.y,a=t.y<s?t.y+J.A.TWO_PI:t.y,c=e.z,l=t.z,u=a-s,d=s+.5*u,h=Bj;let A=0;h[A++]=s,h[A++]=a,h[A++]=d,u>J.A.PI&&(h[A++]=d-J.A.PI_OVER_TWO,h[A++]=d+J.A.PI_OVER_TWO);let p=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,g=Number.NEGATIVE_INFINITY;for(let e=0;e<A;++e){const t=h[e]-d,n=Math.cos(t),i=Math.sin(t),s=n*o,a=i*o,c=n*r,l=i*r;p=Math.min(p,s,c),f=Math.min(f,a,l),m=Math.max(m,s,c),g=Math.max(g,a,l)}const _=m-p,y=g-f,v=l-c,T=.5*(p+m),b=.5*(f+g),w=.5*(c+l),x=j.A.fromElements(T,b,w,Fj),C=Z.A.fromRotationZ(d,Uj),E=j.A.fromElements(_,y,v,Ij),S=O.A.fromScale(E,zj),I=O.A.fromRotation(C,Vj),P=O.A.fromTranslation(x,kj),D=O.A.multiplyTransformation(I,O.A.multiplyTransformation(P,S,Hj),Hj),R=O.A.multiplyTransformation(n,D,Hj);return function(e){const t=O.A.getColumn(e,0,Gj),n=O.A.getColumn(e,1,Wj),i=O.A.getColumn(e,2,Yj),o=J.A.EPSILON4;return jj(t,n,o)&&jj(n,i,o)}(R)?lD.A.fromTransformation(R,i):function(e,t){const n=qj;j.A.fromElements(-.5,-.5,-.5,n[0]),j.A.fromElements(-.5,-.5,.5,n[1]),j.A.fromElements(-.5,.5,-.5,n[2]),j.A.fromElements(-.5,.5,.5,n[3]),j.A.fromElements(.5,-.5,-.5,n[4]),j.A.fromElements(.5,-.5,.5,n[5]),j.A.fromElements(.5,.5,-.5,n[6]),j.A.fromElements(.5,.5,.5,n[7]);for(let t=0;t<8;++t)O.A.multiplyByPoint(e,n[t],n[t]);return lD.A.fromPoints(n,t)}(R,i)}const Xj=Sj;function Kj(){this.orientedBoundingBox=new lD.A,this.boundingSphere=new Sn.A,this.boundTransform=new O.A,this.shapeTransform=new O.A,this._rectangle=new Or.A,this._minimumHeight=Kj.DefaultMinBounds.z,this._maximumHeight=Kj.DefaultMaxBounds.z,this._ellipsoid=new K.A,this._translation=new j.A,this._rotation=new Z.A,this.shaderUniforms={ellipsoidRadiiUv:new j.A,eccentricitySquared:0,evoluteScale:new q.A,ellipsoidInverseRadiiSquaredUv:new j.A,ellipsoidRenderLongitudeMinMax:new q.A,ellipsoidShapeUvLongitudeMinMaxMid:new j.A,ellipsoidUvToShapeUvLongitude:new q.A,ellipsoidUvToShapeUvLatitude:new q.A,ellipsoidRenderLatitudeSinMinMax:new q.A,ellipsoidInverseHeightDifferenceUv:0,clipMinMaxHeight:new q.A},this.shaderDefines={ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_UNDER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_OVER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY:void 0,ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE:void 0,ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_EQUAL_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_OVER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_EQUAL_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_OVER_HALF:void 0,ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE:void 0,ELLIPSOID_INTERSECTION_INDEX_LONGITUDE:void 0,ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX:void 0,ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN:void 0,ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MAX:void 0,ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MIN:void 0},this.shaderMaximumIntersectionsLength=0}const $j=new j.A,Jj=new j.A,Zj=new j.A,eQ=new j.A,tQ=new j.A,nQ=new j.A,iQ=new j.A,oQ=new j.A,rQ=new Z.A,sQ=new j.A,aQ=new j.A,cQ=new Or.A;Kj.prototype.update=function(e,t,n,i,o){const{DefaultMinBounds:r,DefaultMaxBounds:s}=Kj;i=i??r,o=o??s,l.A.typeOf.object("modelMatrix",e),l.A.typeOf.object("minBounds",t),l.A.typeOf.object("maxBounds",n);const a=J.A.EPSILON10,c=J.A.EPSILON3,u=J.A.EPSILON10,d=J.A.EPSILON10,h=J.A.EPSILON3,A=O.A.getScale(e,oQ),p=j.A.clone(r,$j);p.z=-j.A.minimumComponent(A);const f=j.A.clamp(t,p,s,Jj),m=j.A.clamp(n,p,s,Zj),g=j.A.clamp(i,p,s,eQ),_=j.A.clamp(o,p,s,tQ),y=j.A.maximumByComponent(f,g,nQ),v=j.A.minimumByComponent(m,_,iQ),T=j.A.add(A,j.A.fromElements(m.z,m.z,m.z,sQ),sQ),b=j.A.maximumComponent(T),w=j.A.add(A,j.A.fromElements(v.z,v.z,v.z,aQ),aQ);if(y.y>v.y||y.y===s.y||v.y===r.y||y.z>v.z||J.A.equalsEpsilon(w,j.A.ZERO,void 0,a))return!1;this._rectangle=Or.A.fromRadians(f.x,f.y,m.x,m.y),this._translation=O.A.getTranslation(e,this._translation),this._rotation=O.A.getRotation(e,this._rotation),this._ellipsoid=K.A.fromCartesian3(A,this._ellipsoid),this._minimumHeight=f.z,this._maximumHeight=m.z;const x=Or.A.fromRadians(y.x,y.y,v.x,v.y,cQ);this.orientedBoundingBox=AQ(x,y.z,v.z,this._ellipsoid,this._translation,this._rotation,this.orientedBoundingBox),this.shapeTransform=O.A.fromRotationTranslation(Z.A.setScale(this._rotation,T,rQ),this._translation,this.shapeTransform),this.boundTransform=O.A.fromRotationTranslation(this.orientedBoundingBox.halfAxes,this.orientedBoundingBox.center,this.boundTransform),this.boundingSphere=Sn.A.fromOrientedBoundingBox(this.orientedBoundingBox,this.boundingSphere);const C=s.x-r.x,E=.5*C,S=v.x<y.x,I=v.x-y.x+S*C,P=I<=u,D=I>=E-u&&I<C-u,R=I>u&&I<E-u,M=P||D||R,L=m.x<f.x,N=m.x-f.x+L*C,B=N>E+u&&N<C-u||N>=E-u&&N<=E+u||N<E-u,F=v.y<-h,U=v.y>=-h&&v.y<=+h,k=v.y>+h&&v.y<s.y-d,V=F||U||k,z=y.y>r.y+d&&y.y<-h,H=y.y>=-h&&y.y<=+h,G=y.y>+h,W=z||H||G,Y=V||W,Q=m.y-f.y,X=m.y<-h,$=m.y>=-h&&m.y<=+h,ee=m.y>+h&&m.y<s.y-d,te=X||$||ee,ne=f.y>r.y+d&&f.y<-h,ie=f.y>=-h&&f.y<=+h,oe=f.y>+h,re=te||ne||ie||oe,{shaderUniforms:se,shaderDefines:ae}=this;for(const e in ae)ae.hasOwnProperty(e)&&(ae[e]=void 0);se.ellipsoidRadiiUv=j.A.divideByScalar(T,b,se.ellipsoidRadiiUv);const{x:ce,z:le}=se.ellipsoidRadiiUv,ue=le/ce;se.eccentricitySquared=1-ue*ue,se.evoluteScale=q.A.fromElements((ce*ce-le*le)/ce,(le*le-ce*ce)/le,se.evoluteScale),se.ellipsoidInverseRadiiSquaredUv=j.A.divideComponents(j.A.ONE,j.A.multiplyComponents(se.ellipsoidRadiiUv,se.ellipsoidRadiiUv,se.ellipsoidInverseRadiiSquaredUv),se.ellipsoidInverseRadiiSquaredUv);let de=0;ae.ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MAX=de,de+=1,ae.ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MIN=de,de+=1,se.clipMinMaxHeight=q.A.fromElements((y.z-m.z)/b,(v.z-m.z)/b,se.clipMinMaxHeight);const he=(m.z-f.z)/b;if(se.ellipsoidInverseHeightDifferenceUv=1/he,f.z===m.z&&(se.ellipsoidInverseHeightDifferenceUv=0),M&&(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE=!0,ae.ELLIPSOID_INTERSECTION_INDEX_LONGITUDE=de,D?(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_UNDER_HALF=!0,de+=1):R?(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_OVER_HALF=!0,de+=2):P&&(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO=!0,de+=2),se.ellipsoidRenderLongitudeMinMax=q.A.fromElements(y.x,v.x,se.ellipsoidRenderLongitudeMinMax)),B)if(ae.ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE=!0,m.x<f.x&&(ae.ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED=!0),N<=u)se.ellipsoidUvToShapeUvLongitude=q.A.fromElements(0,1,se.ellipsoidUvToShapeUvLongitude);else{const e=C/N,t=-(f.x-r.x)/N;se.ellipsoidUvToShapeUvLongitude=q.A.fromElements(e,t,se.ellipsoidUvToShapeUvLongitude)}if(M){const e=J.A.equalsEpsilon(y.x,r.x,void 0,c),t=J.A.equalsEpsilon(v.x,s.x,void 0,c);e&&(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY=!0),t&&(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY=!0);const n=(f.x-r.x)/C,i=(m.x-r.x)/C,o=((v.x-r.x)/C+.5*(1-I/C))%1;se.ellipsoidShapeUvLongitudeMinMaxMid=j.A.fromElements(n,i,o,se.ellipsoidShapeUvLongitudeMinMaxMid)}if(Y&&(W&&(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN=!0,ae.ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN=de,z?(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF=!0,de+=1):H?(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_EQUAL_HALF=!0,de+=1):G&&(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_OVER_HALF=!0,de+=2)),V&&(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX=!0,ae.ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX=de,F?(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF=!0,de+=2):U?(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_EQUAL_HALF=!0,de+=1):k&&(ae.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_OVER_HALF=!0,de+=1)),se.ellipsoidRenderLatitudeSinMinMax=q.A.fromElements(Math.sin(y.y),Math.sin(v.y),se.ellipsoidRenderLatitudeSinMinMax)),re)if(ae.ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE=!0,Q<d)se.ellipsoidUvToShapeUvLatitude=q.A.fromElements(0,1,se.ellipsoidUvToShapeUvLatitude);else{const e=(s.y-r.y)/Q,t=(r.y-f.y)/Q;se.ellipsoidUvToShapeUvLatitude=q.A.fromElements(e,t,se.ellipsoidUvToShapeUvLatitude)}return this.shaderMaximumIntersectionsLength=de,!0};const lQ=new Or.A;Kj.prototype.computeOrientedBoundingBoxForTile=function(e,t,n,i,o){l.A.typeOf.number("tileLevel",e),l.A.typeOf.number("tileX",t),l.A.typeOf.number("tileY",n),l.A.typeOf.number("tileZ",i),l.A.typeOf.object("result",o);const r=1/Math.pow(2,e),s=t*r,a=(t+1)*r,c=n*r,u=(n+1)*r,d=i*r,h=(i+1)*r;return AQ(Or.A.subsection(this._rectangle,s,c,a,u,lQ),J.A.lerp(this._minimumHeight,this._maximumHeight,d),J.A.lerp(this._minimumHeight,this._maximumHeight,h),this._ellipsoid,this._translation,this._rotation,o)};const uQ=new j.A,dQ=new j.A,hQ=new j.A;function AQ(e,t,n,i,o,r,s){return(s=lD.A.fromRectangle(e,t,n,i,s)).center=j.A.add(s.center,o,s.center),s.halfAxes=Z.A.multiply(s.halfAxes,r,s.halfAxes),s}Kj.prototype.computeOrientedBoundingBoxForSample=function(e,t,n,i){l.A.typeOf.object("spatialNode",e),l.A.typeOf.object("tileDimensions",t),l.A.typeOf.object("tileUv",n),l.A.typeOf.object("result",i);const o=1/Math.pow(2,e.level),r=j.A.divideComponents(j.A.ONE,t,uQ),s=j.A.multiplyByScalar(r,o,uQ),a=j.A.multiplyByScalar(j.A.fromElements(e.x+n.x,e.y+n.y,e.z+n.z,dQ),o,dQ),c=j.A.add(a,s,hQ);return AQ(Or.A.subsection(this._rectangle,a.x,a.y,c.x,c.y,lQ),J.A.lerp(this._minimumHeight,this._maximumHeight,a.z),J.A.lerp(this._minimumHeight,this._maximumHeight,c.z),this._ellipsoid,this._translation,this._rotation,i)},Kj.DefaultMinBounds=Object.freeze(new j.A(-J.A.PI,-J.A.PI_OVER_TWO,-K.A.WGS84.minimumRadius)),Kj.DefaultMaxBounds=Object.freeze(new j.A(J.A.PI,J.A.PI_OVER_TWO,10*K.A.WGS84.maximumRadius));const pQ=Kj,fQ={BOX:"BOX",ELLIPSOID:"ELLIPSOID",CYLINDER:"CYLINDER",getMinBounds:function(e){switch(e){case fQ.BOX:return Ej.DefaultMinBounds;case fQ.ELLIPSOID:return pQ.DefaultMinBounds;case fQ.CYLINDER:return Xj.DefaultMinBounds;default:throw new A.A(`Invalid shape type ${e}`)}},getMaxBounds:function(e){switch(e){case fQ.BOX:return Ej.DefaultMaxBounds;case fQ.ELLIPSOID:return pQ.DefaultMaxBounds;case fQ.CYLINDER:return Xj.DefaultMaxBounds;default:throw new A.A(`Invalid shape type ${e}`)}},getShapeConstructor:function(e){switch(e){case fQ.BOX:return Ej;case fQ.ELLIPSOID:return pQ;case fQ.CYLINDER:return Xj;default:throw new A.A(`Invalid shape type ${e}`)}}},mQ=Object.freeze(fQ),gQ=Object.freeze({UNLOADED:0,RECEIVING:1,PROCESSING:2,LOADED:3,FAILED:4,UNAVAILABLE:5});function _Q(e,t){this.spatialNode=e,this.keyframe=t,this.state=gQ.UNLOADED,this.content=void 0,this.megatextureIndex=-1,this.priority=-Number.MAX_VALUE,this.highPriorityFrameNumber=-1}_Q.prototype.unload=function(){this.content=this.content&&this.content.destroy(),this.spatialNode=void 0,this.state=gQ.UNLOADED,this.megatextureIndex=-1,this.priority=-Number.MAX_VALUE,this.highPriorityFrameNumber=-1},_Q.priorityComparator=function(e,t){return e.priority-t.priority},_Q.searchComparator=function(e,t){return e.keyframe-t.keyframe},_Q.LoadState=gQ;const yQ=_Q;function vQ(e,t,n,i,o){if(o=Math.min(o??134217728,536870912),i===_F.A.UNSIGNED_SHORT&&(i=_F.A.FLOAT32),i===_F.A.FLOAT32&&!e.floatingPointTexture)throw new M.A("Floating point texture not supported");const r=function(e){return e===_F.A.FLOAT32||e===_F.A.FLOAT64?U.A.FLOAT:e===_F.A.UINT8?U.A.UNSIGNED_BYTE:void 0}(i),s=function(e,t){return 1===e?t?R.A.RED:R.A.LUMINANCE:2===e?t?R.A.RG:R.A.LUMINANCE_ALPHA:3===e?R.A.RGB:4===e?R.A.RGBA:void 0}(n,e.webgl2),a=_F.A.getSizeInBytes(i),c=function(e,t,n){const i=Math.floor(e/(t*n));return Math.min(N.A.maximumTextureSize,J.A.previousPowerOfTwo(Math.floor(Math.sqrt(i))))}(o,n,a),l=Math.ceil(Math.sqrt(t.x)),u=Math.ceil(t.z/l),d=l*t.x,h=u*t.y,A=Math.floor(c/d),p=Math.floor(c/h);if(0===A||0===p)throw new M.A("Tileset is too large to fit into megatexture");this.channelCount=n,this.componentType=i,this.textureMemoryByteLength=a*n*c**2,this.voxelCountPerTile=j.A.clone(t,new j.A),this.maximumTileCount=A*p,this.regionCountPerMegatexture=new q.A(A,p),this.voxelCountPerRegion=new q.A(d,h),this.sliceCountPerRegion=new q.A(l,u),this.voxelSizeUv=new q.A(1/c,1/c),this.sliceSizeUv=new q.A(t.x/c,t.y/c),this.regionSizeUv=new q.A(d/c,h/c),this.texture=new G.A({context:e,pixelFormat:s,pixelDatatype:r,flipY:!1,width:c,height:c,sampler:new At.A({wrapS:It.A.CLAMP_TO_EDGE,wrapT:It.A.CLAMP_TO_EDGE,minificationFilter:bt.A.LINEAR,magnificationFilter:Tt.A.LINEAR})});const f=_F.A.toComponentDatatype(i);this.tileVoxelDataTemp=C.A.createTypedArray(f,d*h*n),this.nodes=new Array(this.maximumTileCount);for(let e=0;e<this.maximumTileCount;e++)this.nodes[e]=new TQ(e);for(let e=0;e<this.maximumTileCount;e++){const t=this.nodes[e];t.previousNode=e>0?this.nodes[e-1]:void 0,t.nextNode=e<this.maximumTileCount-1?this.nodes[e+1]:void 0}this.occupiedList=void 0,this.emptyList=this.nodes[0],this.occupiedCount=0}function TQ(e){this.index=e,this.nextNode=void 0,this.previousNode=void 0}function bQ(e,t,n){return n*(e.y*e.x)+t*e.x}vQ.prototype.add=function(e){if(this.isFull())throw new A.A("Trying to add when there are no empty spots");const t=this.emptyList;this.emptyList=this.emptyList.nextNode,(0,d.A)(this.emptyList)&&(this.emptyList.previousNode=void 0),t.nextNode=this.occupiedList,(0,d.A)(t.nextNode)&&(t.nextNode.previousNode=t),this.occupiedList=t;const n=t.index;return this.writeDataToTexture(n,e),this.occupiedCount++,n},vQ.prototype.remove=function(e){if(e<0||e>=this.maximumTileCount)throw new A.A("Megatexture index out of bounds");const t=this.nodes[e];(0,d.A)(t.previousNode)&&(t.previousNode.nextNode=t.nextNode),(0,d.A)(t.nextNode)&&(t.nextNode.previousNode=t.previousNode),t.nextNode=this.emptyList,(0,d.A)(t.nextNode)&&(t.nextNode.previousNode=t),t.previousNode=void 0,this.emptyList=t,this.occupiedCount--},vQ.prototype.isFull=function(){return void 0===this.emptyList},vQ.getApproximateTextureMemoryByteLength=function(e,t,n,i){i===_F.A.UNSIGNED_SHORT&&(i=_F.A.FLOAT32);const o=_F.A.getSizeInBytes(i),r=e*t.x*t.y*t.z,s=Math.ceil(Math.sqrt(t.x)),a=Math.ceil(t.z/s),c=s*t.x,l=a*t.y;let u=J.A.previousPowerOfTwo(Math.floor(Math.sqrt(r)));for(;!(Math.floor(u/c)*Math.floor(u/l)>=e);)u*=2;return u*u*n*o},vQ.prototype.writeDataToTexture=function(e,t){const n=t.constructor===Uint16Array?new Float32Array(t):t,{tileVoxelDataTemp:i,voxelCountPerTile:o,sliceCountPerRegion:r,voxelCountPerRegion:s,channelCount:a,regionCountPerMegatexture:c}=this;for(let e=0;e<o.z;e++){const t=e%r.x*o.x,c=Math.floor(e/r.x)*o.y;for(let r=0;r<o.y;r++){const l=bQ(o,r,e),u=(c+r)*s.x+t;for(let e=0;e<o.x;e++){const t=l+e,o=u+e;for(let e=0;e<a;e++)i[o*a+e]=n[t*a+e]}}}const l=e%c.x*s.x,u=Math.floor(e/c.x)*s.y,d={source:{arrayBufferView:i,width:s.x,height:s.y},xOffset:l,yOffset:u};this.texture.copyFrom(d)},vQ.prototype.isDestroyed=function(){return!1},vQ.prototype.destroy=function(){return this.texture=this.texture&&this.texture.destroy(),(0,h.A)(this)};const wQ=vQ;function xQ(e,t,n,i,o,r,s){this.children=void 0,this.parent=o,this.level=e,this.x=t,this.y=n,this.z=i,this.dimensions=j.A.clone(s),this.keyframeNodes=[],this.renderableKeyframeNodes=[],this.renderableKeyframeNodeLerp=0,this.renderableKeyframeNodePrevious=void 0,this.renderableKeyframeNodeNext=void 0,this.orientedBoundingBox=new lD.A,this.approximateVoxelSize=0,this.screenSpaceError=0,this.visitedFrameNumber=-1,this.computeBoundingVolumes(r)}const CQ=new j.A;xQ.prototype.computeBoundingVolumes=function(e){this.orientedBoundingBox=e.computeOrientedBoundingBoxForTile(this.level,this.x,this.y,this.z,this.orientedBoundingBox);const t=Z.A.getScale(this.orientedBoundingBox.halfAxes,CQ),n=2*j.A.maximumComponent(t);this.approximateVoxelSize=n/j.A.minimumComponent(this.dimensions)},xQ.prototype.constructChildNodes=function(e){const{level:t,x:n,y:i,z:o}=this,r=2*n,s=2*i,a=2*o,c=s+1,l=r+1,u=a+1,d=t+1,h=[[d,r,s,a],[d,l,s,a],[d,r,c,a],[d,l,c,a],[d,r,s,u],[d,l,s,u],[d,r,c,u],[d,l,c,u]];this.children=h.map(([t,n,i,o])=>new xQ(t,n,i,o,this,e,this.dimensions))},xQ.prototype.visibility=function(e,t){const n=this.orientedBoundingBox;return e.cullingVolume.computeVisibilityWithPlaneMask(n,t)},xQ.prototype.computeScreenSpaceError=function(e,t){const n=this.orientedBoundingBox;let i=Math.sqrt(n.distanceSquaredTo(e));i=Math.max(i,J.A.EPSILON7);const o=t*(this.approximateVoxelSize/i);this.screenSpaceError=o};const EQ={keyframe:0};function SQ(e,t){return EQ.keyframe=e,(0,Wi.A)(t,EQ,yQ.searchComparator)}function IQ(e,t){const n=SQ(e,t);return n<0?J.A.clamp(~n-1,0,t.length-1):n}function PQ(e,t){return e*Math.exp(4*e)+t*(t>=0?1:-200)}xQ.prototype.computeSurroundingRenderableKeyframeNodes=function(e){let t=this;const n=t.level,i=Math.floor(e),o=Math.ceil(e);let r,s,a=+Number.MAX_VALUE,c=+Number.MAX_VALUE;for(;(0,d.A)(t);){const{renderableKeyframeNodes:e}=t;if(e.length>=1){const l=IQ(i,e),u=e[l],d=e[o===i||i<u.keyframe?l:Math.min(l+1,e.length-1)],h=i-u.keyframe,A=PQ(n-t.level,h);A<a&&(a=A,r=u);const p=d.keyframe-o,f=PQ(n-t.level,p);if(f<c&&(c=f,s=d),0===h&&0===p)break}t=t.parent}if(this.renderableKeyframeNodePrevious=r,this.renderableKeyframeNodeNext=s,!(0,d.A)(r)||!(0,d.A)(s))return;const l=r.keyframe,u=s.keyframe;this.renderableKeyframeNodeLerp=l===u?0:J.A.clamp((e-l)/(u-l),0,1)},xQ.prototype.isVisited=function(e){return this.visitedFrameNumber===e},xQ.prototype.createKeyframeNode=function(e){let t=SQ(e,this.keyframeNodes);if(t<0){t=~t;const n=new yQ(this,e);this.keyframeNodes.splice(t,0,n)}},xQ.prototype.destroyKeyframeNode=function(e,t){const n=e.keyframe,i=SQ(n,this.keyframeNodes);if(i<0)throw new A.A("Keyframe node does not exist.");if(this.keyframeNodes.splice(i,1),-1!==e.megatextureIndex){for(let n=0;n<t.length;n++)t[n].remove(e.megatextureIndex);const i=SQ(n,this.renderableKeyframeNodes);if(i<0)throw new A.A("Renderable keyframe node does not exist.");this.renderableKeyframeNodes.splice(i,1)}e.unload()},xQ.prototype.addKeyframeNodeToMegatextures=function(e,t){if(-1!==e.megatextureIndex||e.content.metadata.length!==t.length)throw new A.A("Keyframe node cannot be added to megatexture");const{metadata:n}=e.content;for(let i=0;i<t.length;i++){const o=t[i];e.megatextureIndex=o.add(n[i])}const i=this.renderableKeyframeNodes;let o=SQ(e.keyframe,i);if(o>=0)throw new A.A("Keyframe already renderable");o=~o,i.splice(o,0,e)},xQ.prototype.isRenderable=function(e){const t=this.renderableKeyframeNodePrevious,n=this.renderableKeyframeNodeNext,i=this.level;return(0,d.A)(t)&&(0,d.A)(n)&&(t.spatialNode.level===i||n.spatialNode.level===i)&&this.visitedFrameNumber===e};const DQ=xQ;function OQ(e,t,n,i){const{provider:o,dimensions:r,paddingBefore:s,paddingAfter:a}=e,{types:c,componentTypes:l,metadataOrder:u}=o,h=j.A.add(r,s,new j.A);if(j.A.add(h,a,h),u===kq.Y_UP){const e=h.y;h.y=h.z,h.z=e}!(0,d.A)(i)&&(0,d.A)(o.maximumTileCount)&&(i=function(e,t,n,i){let o=0;const r=n.length;for(let s=0;s<r;s++){const r=n[s],a=i[s],c=yF.A.getComponentCount(r);o+=wQ.getApproximateTextureMemoryByteLength(e,t,c,a)}return o}(o.maximumTileCount,h,c,l)),this._primitive=e,this.textureMemoryByteLength=0,this.megatextures=new Array(c.length);for(let e=0;e<c.length;e++){const n=c[e],o=yF.A.getComponentCount(n),r=l[e];this.megatextures[e]=new wQ(t,h,o,r,i),this.textureMemoryByteLength+=this.megatextures[e].textureMemoryByteLength}const A=this.megatextures[0].maximumTileCount;this._simultaneousRequestCount=0,this._debugPrint=!1,this._calculateStatistics=this._primitive._calculateStatistics??!1,this._frameNumber=0;const p=e._shape;this.rootNode=new DQ(0,0,0,0,void 0,p,r),this._priorityQueue=new tP({maximumLength:A,comparator:yQ.priorityComparator}),this._highPriorityKeyframeNodes=new Array(A),this._highPriorityKeyframeNodeCount=0,this._keyframeNodesInMegatexture=new Array(A),this._keyframeCount=n,this._sampleCount=void 0,this._keyframeLocation=0,this._binaryTreeKeyframeWeighting=new Array(n),this._initialTilesLoaded=!1;const f=this._binaryTreeKeyframeWeighting;f[0]=0,f[n-1]=0,RQ(f,1,n-2,0);const m=Math.floor(227.55555555555554),g=Math.ceil(A/m);this.internalNodeTexture=new G.A({context:t,pixelFormat:R.A.RGBA,pixelDatatype:U.A.UNSIGNED_BYTE,flipY:!1,width:2048,height:g,sampler:new At.A({minificationFilter:bt.A.NEAREST,magnificationFilter:Tt.A.NEAREST})}),this.internalNodeTilesPerRow=m,this.internalNodeTexelSizeUv=new q.A(.00048828125,1/g),this.leafNodeTexture=void 0,this.leafNodeTilesPerRow=void 0,this.leafNodeTexelSizeUv=new q.A}function RQ(e,t,n,i){if(t>n)return;const o=Math.floor((t+n)/2);e[o]=i,RQ(e,t,o-1,i+1),RQ(e,o+1,n,i+1)}function MQ(e,t){if(t.computeBoundingVolumes(e._primitive._shape),(0,d.A)(t.children))for(let n=0;n<8;n++)MQ(e,t.children[n])}function LQ(e,t){if(e._simultaneousRequestCount>=OQ.simultaneousRequestCountMaximum)return;const n=e._primitive.provider,{keyframe:i,spatialNode:o}=t;if((0,d.A)(n.availableLevels)&&o.level>=n.availableLevels)return;const r={tileLevel:o.level,tileX:o.x,tileY:o.y,tileZ:o.z,keyframe:i},s=n.requestData(r);(0,d.A)(s)&&(e._simultaneousRequestCount++,t.state=yQ.LoadState.RECEIVING,s.then(function(n){e._simultaneousRequestCount--,t.content=n,t.state=(0,d.A)(n)?yQ.LoadState.PROCESSING:yQ.LoadState.UNAVAILABLE}).catch(function(n){e._simultaneousRequestCount--,t.state=yQ.LoadState.FAILED,e._primitive.tileFailed.raiseEvent()}))}function NQ(e,t){return e.highPriorityFrameNumber===t.highPriorityFrameNumber?t.priority-e.priority:t.highPriorityFrameNumber-e.highPriorityFrameNumber}function BQ(e,t){const n=t._primitive.provider.types.length;if(!Array.isArray(e)||e.length!==n)return!1;const{megatextures:i}=t;for(let t=0;t<n;t++){const{voxelCountPerTile:n,channelCount:o}=i[t],{x:r,y:s,z:a}=n,c=r*s*a*o;if(e[t].length!==c)return!1}return!0}function FQ(e,t,n,i){const{camera:o,context:r,pixelRatio:s,frameNumber:a}=i,{positionWC:c,frustum:l}=o,u=r.drawingBufferHeight/s/l.sseDenominator;if(e.computeScreenSpaceError(c,u),(t=e.visibility(i,t))===YI.A.MASK_OUTSIDE)return;e.visitedFrameNumber=a;const h=n._primitive,A=h._shape,p=h.screenSpaceError,f=n._priorityQueue,m=n._keyframeCount,g=J.A.clamp(Math.floor(n._keyframeLocation),0,m-2),_=g+1;if(1===m)e.createKeyframeNode(0);else if(e.keyframeNodes.length!==m)for(let t=0;t<m;t++)e.createKeyframeNode(t);const{screenSpaceError:y,keyframeNodes:v}=e,T=(b=y)/(1+b);var b;let w=!1;for(let e=0;e<v.length;e++){const t=v[e];t.priority=10*T+UQ(g,t.keyframe,_,n),t.state!==yQ.LoadState.UNAVAILABLE&&t.state!==yQ.LoadState.FAILED&&t.priority!==-Number.MAX_VALUE&&f.insert(t),t.state===yQ.LoadState.LOADED&&(w=!0)}if(y<p||!w)e.children=void 0;else{(0,d.A)(e.children)||e.constructChildNodes(A);for(let o=0;o<8;o++)FQ(e.children[o],t,n,i)}}function UQ(e,t,n,i){const o=Math.min(Math.abs(t-e),Math.abs(t-n)),r=Math.max(e,i._keyframeCount-n-1,1),s=Math.pow(1-o/r,4),a=Math.exp(-i._binaryTreeKeyframeWeighting[t]);return J.A.lerp(a,s,.15+.85*s)}OQ.prototype.findKeyframeNode=function(e){return this._keyframeNodesInMegatexture.find(function(t){return t.megatextureIndex===e})},OQ.simultaneousRequestCountMaximum=50,OQ.prototype.update=function(e,t,n,i){const o=this._primitive,r=e.context,s=this.megatextures[0].maximumTileCount,a=this._keyframeCount,c=o._levelBlendFactor,l=(c>0?2:1)*(a>1?2:1);this._sampleCount=l;const u=l>=2;if(u&&!(0,d.A)(this.leafNodeTexture)){const e=2,t=1024,n=Math.floor(t/e),i=Math.ceil(s/n);this.leafNodeTexture=new G.A({context:r,pixelFormat:R.A.RGBA,pixelDatatype:U.A.UNSIGNED_BYTE,flipY:!1,width:t,height:i,sampler:new At.A({minificationFilter:bt.A.NEAREST,magnificationFilter:Tt.A.NEAREST})}),this.leafNodeTexelSizeUv=q.A.fromElements(1/t,1/i,this.leafNodeTexelSizeUv),this.leafNodeTilesPerRow=n}else!u&&(0,d.A)(this.leafNodeTexture)&&(this.leafNodeTexture=this.leafNodeTexture.destroy());if(this._keyframeLocation=J.A.clamp(t,0,a-1),n&&MQ(this,this.rootNode),i)return;this._frameNumber=e.frameNumber;const h=(0,aa.A)();!function(e,t){const n=e._frameNumber,i=e._priorityQueue;i.reset(),FQ(e.rootNode,YI.A.MASK_INDETERMINATE,e,t);const o=e._highPriorityKeyframeNodes;let r,s=0;for(;i.length>0;)r=i.removeMaximum(),r.highPriorityFrameNumber=n,o[s]=r,s++;e._highPriorityKeyframeNodeCount=s}(this,e),function(e,t){const n=e.megatextures[0],i=n.occupiedCount,o=e._keyframeNodesInMegatexture;o.length=i,o.sort(NQ);const r=e._highPriorityKeyframeNodes,s=e._highPriorityKeyframeNodeCount;let a=0,c=0;for(let l=0;l<s;l++){const s=r[l];if(s.state!==yQ.LoadState.LOADED&&void 0!==s.spatialNode&&(s.state===yQ.LoadState.UNLOADED&&LQ(e,s),s.state===yQ.LoadState.PROCESSING)){const{content:r}=s;if(r.update(e._primitive,t),!r.ready)continue;if(!BQ(r.metadata,e)){s.content=void 0,s.state=yQ.LoadState.FAILED,e._primitive.tileFailed.raiseEvent();continue}let l=0;if(n.isFull()){l=i-1-a,a++;const t=o[l];e._primitive.tileUnload.raiseEvent(),t.spatialNode.destroyKeyframeNode(t,e.megatextures)}else l=i+c,c++;s.spatialNode.addKeyframeNodeToMegatextures(s,e.megatextures),s.state=yQ.LoadState.LOADED,o[l]=s,e._primitive.tileLoad.raiseEvent()}}}(this,e);const A=(0,aa.A)();!function(e,t,n){const i=e._primitive._screenSpaceError,o=e._keyframeLocation,r=e._frameNumber,s=t>=2;let a=0,c=0;const l=[],u=[];const h=e.rootNode;h.computeSurroundingRenderableKeyframeNodes(o),h.isRenderable(r)&&function t(h,A,p,f,m){let g=!1;if((0,d.A)(h.children))for(let e=0;e<8;e++){const t=h.children[e];t.computeSurroundingRenderableKeyframeNodes(o),t.isRenderable(r)&&(g=!0)}if(g){l[m]=kQ.INTERNAL<<16|A,l[p]=f,a++,m=9*(f=A)+1;for(let e=0;e<8;e++)t(h.children[e],A=a,p=9*A+0,f,m+e)}else{if(e._primitive.tileVisible.raiseEvent(),s){const e=5*c,t=h.renderableKeyframeNodePrevious,o=h.level-t.spatialNode.level,r=t.spatialNode.parent,s=(0,d.A)(r)?r.renderableKeyframeNodePrevious:t,a=function(e,t,n){if(void 0===e.parent)return 0;const i=e.screenSpaceError,o=((t-i)/(e.parent.screenSpaceError-i)+n-1)/n;return J.A.clamp(o,0,1)}(h,i,n),A=o,p=1,f=t.megatextureIndex,g=s.megatextureIndex;u[e+0]=a,u[e+1]=A,u[e+2]=p,u[e+3]=f,u[e+4]=g,l[m]=kQ.LEAF<<16|c}else{const e=h.renderableKeyframeNodePrevious,t=0===h.level-e.spatialNode.level?kQ.LEAF:kQ.PACKED_LEAF_FROM_PARENT;l[m]=t<<16|e.megatextureIndex}c++}}(h,0,0,0,0),function(e,t,n,i){const o=R.A.componentsLength(i.pixelFormat),r=Math.ceil(e.length/9),s=Math.max(1,9*Math.min(r,n)),a=Math.max(1,Math.ceil(r/n)),c=new Uint8Array(s*a*o);for(let t=0;t<e.length;t++){const n=e[t],i=t*o;for(let e=0;e<o;e++)c[i+e]=n>>>8*e&255}const l={source:{arrayBufferView:c,width:s,height:a},xOffset:0,yOffset:0};i.copyFrom(l)}(l,0,e.internalNodeTilesPerRow,e.internalNodeTexture),s&&function(e,t,n,i){const o=R.A.componentsLength(i.pixelFormat),r=Math.ceil(e.length/5),s=Math.max(1,2*Math.min(r,n)),a=Math.max(1,Math.ceil(r/n)),c=new Uint8Array(s*a*o);for(let t=0;t<r;t++){const n=e[5*t+0],i=e[5*t+1],o=e[5*t+2],r=e[5*t+3],s=e[5*t+4],a=J.A.clamp(Math.floor(65536*n),0,65535);c[8*t+0]=a>>>0&255,c[8*t+1]=a>>>8&255,c[8*t+2]=255&i,c[8*t+3]=255&o,c[8*t+4]=r>>>0&255,c[8*t+5]=r>>>8&255,c[8*t+6]=s>>>0&255,c[8*t+7]=s>>>8&255}const l={source:{arrayBufferView:c,width:s,height:a},xOffset:0,yOffset:0};i.copyFrom(l)}(u,0,e.leafNodeTilesPerRow,e.leafNodeTexture)}(this,l,c);const p=(0,aa.A)(),f=o.loadProgress.numberOfListeners>0||o.allTilesLoaded.numberOfListeners>0||o.initialTilesLoaded.numberOfListeners>0;(this._debugPrint||this._calculateStatistics||f)&&function(e,t,n,i,o){const r=e._keyframeCount,s=e.rootNode,a=Object.keys(yQ.LoadState).length,c=new Array(a),l=new Array(a);let u=0;for(let e=0;e<a;e++){const t=new Array(r).fill(0);c[e]=t,l[e]=0}(function e(t){const n=t.keyframeNodes;for(let e=0;e<n.length;e++){const t=n[e],i=t.keyframe,o=t.state;c[o][i]+=1,l[o]+=1,u++}if((0,d.A)(t.children))for(let n=0;n<8;n++)e(t.children[n])})(s),e._primitive.statistics.numberOfTilesWithContentReady=l[yQ.LoadState.LOADED],e._primitive.statistics.visited=u;const h=l[yQ.LoadState.RECEIVING],A=l[yQ.LoadState.PROCESSING],p=h!==e._primitive.statistics.numberOfPendingRequests||A!==e._primitive.statistics.numberOfTilesProcessing;p&&t.afterRender.push(function(){return e._primitive.loadProgress.raiseEvent(h,A),!0}),e._primitive.statistics.numberOfPendingRequests=h,e._primitive.statistics.numberOfTilesProcessing=A;if(p&&(0===h&&0===A)&&(t.afterRender.push(function(){return e._primitive.allTilesLoaded.raiseEvent(),!0}),e._initialTilesLoaded||(e._initialTilesLoaded=!0,t.afterRender.push(function(){return e._primitive.initialTilesLoaded.raiseEvent(),!0}))),!e._debugPrint)return;const f=`KEYFRAMES: ${c[yQ.LoadState.LOADED]}`,m=`UNLOADED: ${l[yQ.LoadState.UNLOADED]} | RECEIVING: ${l[yQ.LoadState.RECEIVING]} | PROCESSING: ${l[yQ.LoadState.PROCESSING]} | LOADED: ${l[yQ.LoadState.LOADED]} | FAILED: ${l[yQ.LoadState.FAILED]} | UNAVAILABLE: ${l[yQ.LoadState.UNAVAILABLE]} | TOTAL: ${u}`,g=`LOAD: ${Math.round(100*n)/100} | OCT: ${Math.round(100*i)/100} | ALL: ${Math.round(100*o)/100}`;console.log(`${f} || ${m} || ${g}`)}(this,e,A-h,p-A,p-h)},OQ.prototype.isRenderable=function(e){return e.isRenderable(this._frameNumber)},OQ.prototype.isDestroyed=function(){return!1},OQ.prototype.destroy=function(){const e=this.megatextures,t=e.length;for(let n=0;n<t;n++)e[n]=e[n]&&e[n].destroy();return this.textureMemoryByteLength=0,this.internalNodeTexture=this.internalNodeTexture&&this.internalNodeTexture.destroy(),this.leafNodeTexture=this.leafNodeTexture&&this.leafNodeTexture.destroy(),(0,h.A)(this)};const kQ={INTERNAL:0,LEAF:1,PACKED_LEAF_FROM_PARENT:2},VQ=OQ;function zQ(e){e=e??S.A.EMPTY_OBJECT,this._ready=!1,this._provider=e.provider??zQ.DefaultProvider,this._traversal=void 0,this._statistics=new jq.A,this._calculateStatistics=e.calculateStatistics??!1,this._shape=void 0,this._shapeVisible=!1,this._dimensions=new j.A,this._inputDimensions=new j.A,this._paddingBefore=new j.A,this._paddingAfter=new j.A,this._minBounds=new j.A,this._minBoundsOld=new j.A,this._maxBounds=new j.A,this._maxBoundsOld=new j.A,this._exaggeratedMinBounds=new j.A,this._exaggeratedMinBoundsOld=new j.A,this._exaggeratedMaxBounds=new j.A,this._exaggeratedMaxBoundsOld=new j.A,this._minClippingBounds=new j.A,this._minClippingBoundsOld=new j.A,this._maxClippingBounds=new j.A,this._maxClippingBoundsOld=new j.A,this._clippingPlanes=void 0,this._clippingPlanesState=0,this._clippingPlanesEnabled=!1,this._modelMatrix=O.A.clone(e.modelMatrix??O.A.IDENTITY),this._exaggeratedModelMatrix=O.A.clone(this._modelMatrix),this._compoundModelMatrix=new O.A,this._compoundModelMatrixOld=new O.A,this._customShader=e.customShader??zQ.DefaultCustomShader,this._customShaderCompilationEvent=new Bn.A,this._shaderDirty=!0,this._drawCommand=void 0,this._drawCommandPick=void 0,this._pickId=void 0,this._clock=e.clock,this._transformPositionWorldToUv=new O.A,this._transformDirectionWorldToUv=new Z.A,this._transformPositionUvToWorld=new O.A,this._transformDirectionWorldToLocal=new Z.A,this._nearestSampling=!1,this._levelBlendFactor=0,this._stepSizeMultiplier=1,this._depthTest=!0,this._useLogDepth=void 0,this._screenSpaceError=4,this._debugPolylines=new Bf.A,this._debugDraw=!1,this._disableRender=!1,this._disableUpdate=!1,this._uniforms={octreeInternalNodeTexture:void 0,octreeInternalNodeTilesPerRow:0,octreeInternalNodeTexelSizeUv:new q.A,octreeLeafNodeTexture:void 0,octreeLeafNodeTilesPerRow:0,octreeLeafNodeTexelSizeUv:new q.A,megatextureTextures:[],megatextureSliceDimensions:new q.A,megatextureTileDimensions:new q.A,megatextureVoxelSizeUv:new q.A,megatextureSliceSizeUv:new q.A,megatextureTileSizeUv:new q.A,dimensions:new j.A,inputDimensions:new j.A,paddingBefore:new j.A,paddingAfter:new j.A,transformPositionViewToUv:new O.A,transformPositionUvToView:new O.A,transformDirectionViewToLocal:new Z.A,cameraPositionUv:new j.A,cameraDirectionUv:new j.A,ndcSpaceAxisAlignedBoundingBox:new Q.A,clippingPlanesTexture:void 0,clippingPlanesMatrix:new O.A,stepSize:0,pickColor:new u.A},this._shapeDefinesOld={},this._uniformMap={};const t=this._uniforms,n=this._uniformMap;for(const e in t)t.hasOwnProperty(e)&&(n[`u_${e}`]=function(){return t[e]});this.tileLoad=new Bn.A,this.tileVisible=new Bn.A,this.tileFailed=new Bn.A,this.tileUnload=new Bn.A,this.loadProgress=new Bn.A,this.allTilesLoaded=new Bn.A,this.initialTilesLoaded=new Bn.A,function(e,t){const{shape:n,minBounds:i=mQ.getMinBounds(n),maxBounds:o=mQ.getMaxBounds(n)}=t;e.minBounds=i,e.maxBounds=o,e.minClippingBounds=i.clone(),e.maxClippingBounds=o.clone(),e._exaggeratedMinBounds=j.A.clone(e._minBounds,e._exaggeratedMinBounds),e._exaggeratedMaxBounds=j.A.clone(e._maxBounds,e._exaggeratedMaxBounds),e._exaggeratedModelMatrix=O.A.clone(e._modelMatrix,e._exaggeratedModelMatrix),ZQ(e,t);const r=mQ.getShapeConstructor(n);e._shape=new r,e._shapeVisible=tX(e,e._shape)}(this,this._provider)}Object.defineProperties(zQ.prototype,{ready:{get:function(){return this._ready}},provider:{get:function(){return this._provider}},boundingSphere:{get:function(){return this._shape.boundingSphere}},orientedBoundingBox:{get:function(){return this._shape.orientedBoundingBox}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){l.A.typeOf.object("modelMatrix",e),this._modelMatrix=O.A.clone(e,this._modelMatrix)}},shape:{get:function(){return this._provider.shape}},dimensions:{get:function(){return this._dimensions}},inputDimensions:{get:function(){return this._inputDimensions}},paddingBefore:{get:function(){return this._paddingBefore}},paddingAfter:{get:function(){return this._paddingAfter}},minimumValues:{get:function(){return this._provider.minimumValues}},maximumValues:{get:function(){return this._provider.maximumValues}},show:{get:function(){return!this._disableRender},set:function(e){l.A.typeOf.bool("show",e),this._disableRender=!e}},disableUpdate:{get:function(){return this._disableUpdate},set:function(e){l.A.typeOf.bool("disableUpdate",e),this._disableUpdate=e}},debugDraw:{get:function(){return this._debugDraw},set:function(e){l.A.typeOf.bool("debugDraw",e),this._debugDraw=e}},depthTest:{get:function(){return this._depthTest},set:function(e){l.A.typeOf.bool("depthTest",e),this._depthTest!==e&&(this._depthTest=e,this._shaderDirty=!0)}},nearestSampling:{get:function(){return this._nearestSampling},set:function(e){l.A.typeOf.bool("nearestSampling",e),this._nearestSampling!==e&&(this._nearestSampling=e,this._shaderDirty=!0)}},levelBlendFactor:{get:function(){return this._levelBlendFactor},set:function(e){l.A.typeOf.number("levelBlendFactor",e),this._levelBlendFactor=J.A.clamp(e,0,1)}},screenSpaceError:{get:function(){return this._screenSpaceError},set:function(e){l.A.typeOf.number("screenSpaceError",e),this._screenSpaceError=e}},stepSize:{get:function(){return this._stepSizeMultiplier},set:function(e){l.A.typeOf.number("stepSize",e),this._stepSizeMultiplier=e}},minBounds:{get:function(){return this._minBounds},set:function(e){l.A.defined("minBounds",e),this._minBounds=j.A.clone(e,this._minBounds)}},maxBounds:{get:function(){return this._maxBounds},set:function(e){l.A.defined("maxBounds",e),this._maxBounds=j.A.clone(e,this._maxBounds)}},minClippingBounds:{get:function(){return this._minClippingBounds},set:function(e){l.A.defined("minClippingBounds",e),this._minClippingBounds=j.A.clone(e,this._minClippingBounds)}},maxClippingBounds:{get:function(){return this._maxClippingBounds},set:function(e){l.A.defined("maxClippingBounds",e),this._maxClippingBounds=j.A.clone(e,this._maxClippingBounds)}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){YM.A.setOwner(e,this,"_clippingPlanes")}},customShader:{get:function(){return this._customShader},set:function(e){if(this._customShader!==e){const t=this._uniformMap,n=this._customShader.uniformMap;for(const e in n)n.hasOwnProperty(e)&&delete t[e];(0,d.A)(e)?this._customShader=e:this._customShader=zQ.DefaultCustomShader,this._shaderDirty=!0}}},customShaderCompilationEvent:{get:function(){return this._customShaderCompilationEvent}},statistics:{get:function(){return this._statistics}}});const HQ=new Q.A,GQ=new Q.A,WQ=new O.A,YQ=new O.A,qQ=new O.A,jQ=O.A.fromRotationTranslation(Z.A.fromUniformScale(.5,new Z.A),new j.A(.5,.5,.5),new O.A),QQ=O.A.fromRotationTranslation(Z.A.fromUniformScale(2,new Z.A),new j.A(-1,-1,-1),new O.A);zQ.prototype.update=function(e){const t=this._provider;this._customShader.update(e);const n=e.context;if(!this._ready)return function(e,t,n){const i=e._uniforms;e._pickId=n.createPickId({primitive:e}),i.pickColor=u.A.clone(e._pickId.color,i.pickColor);const{shaderDefines:o,shaderUniforms:r}=e._shape;e._shapeDefinesOld=(0,_t.A)(o,!0);const s=e._uniformMap;for(const e in r)if(r.hasOwnProperty(e)){const t=`u_${e}`;(0,d.A)(s[t])&&(0,Fn.A)(`VoxelPrimitive: Uniform name "${t}" is already defined`),s[t]=function(){return r[e]}}if(e._dimensions=j.A.clone(t.dimensions,e._dimensions),i.dimensions=j.A.clone(e._dimensions,i.dimensions),e._paddingBefore=j.A.clone(t.paddingBefore??j.A.ZERO,e._paddingBefore),i.paddingBefore=j.A.clone(e._paddingBefore,i.paddingBefore),e._paddingAfter=j.A.clone(t.paddingAfter??j.A.ZERO,e._paddingAfter),i.paddingAfter=j.A.clone(e._paddingAfter,i.paddingAfter),e._inputDimensions=j.A.add(e._dimensions,e._paddingBefore,e._inputDimensions),e._inputDimensions=j.A.add(e._inputDimensions,e._paddingAfter,e._inputDimensions),t.metadataOrder===kq.Y_UP){const t=e._inputDimensions.y;e._inputDimensions.y=e._inputDimensions.z,e._inputDimensions.z=t}i.inputDimensions=j.A.clone(e._inputDimensions,i.inputDimensions);const a=t.keyframeCount??1;e._traversal=new VQ(e,n,a),e.statistics.texturesByteLength=e._traversal.textureMemoryByteLength,function(e,t){t.octreeInternalNodeTexture=e.internalNodeTexture,t.octreeInternalNodeTexelSizeUv=q.A.clone(e.internalNodeTexelSizeUv,t.octreeInternalNodeTexelSizeUv),t.octreeInternalNodeTilesPerRow=e.internalNodeTilesPerRow;const n=e.megatextures,i=n[0],o=n.length;t.megatextureTextures=new Array(o);for(let e=0;e<o;e++)t.megatextureTextures[e]=n[e].texture;t.megatextureSliceDimensions=q.A.clone(i.sliceCountPerRegion,t.megatextureSliceDimensions),t.megatextureTileDimensions=q.A.clone(i.regionCountPerMegatexture,t.megatextureTileDimensions),t.megatextureVoxelSizeUv=q.A.clone(i.voxelSizeUv,t.megatextureVoxelSizeUv),t.megatextureSliceSizeUv=q.A.clone(i.sliceSizeUv,t.megatextureSliceSizeUv),t.megatextureTileSizeUv=q.A.clone(i.regionSizeUv,t.megatextureTileSizeUv)}(e._traversal,i)}(this,t,n),void e.afterRender.push(()=>(this._ready=!0,!0));!function(e,t){if(e._exaggeratedMinBounds=j.A.clone(e._minBounds,e._exaggeratedMinBounds),e._exaggeratedMaxBounds=j.A.clone(e._maxBounds,e._exaggeratedMaxBounds),e.shape===mQ.ELLIPSOID){const n=t.verticalExaggerationRelativeHeight,i=t.verticalExaggeration;e._exaggeratedMinBounds.z=(e._minBounds.z-n)*i+n,e._exaggeratedMaxBounds.z=(e._maxBounds.z-n)*i+n}else{const n=j.A.fromElements(1,1,t.verticalExaggeration,XQ);e._exaggeratedModelMatrix=O.A.multiplyByScale(e._modelMatrix,n,e._exaggeratedModelMatrix),e._exaggeratedModelMatrix=O.A.multiplyByTranslation(e._exaggeratedModelMatrix,function(e,t){const{shapeTransform:n=O.A.IDENTITY,globalTransform:i=O.A.IDENTITY}=e._provider,o=O.A.getTranslation(n,KQ),r=O.A.multiplyByPoint(e._modelMatrix,o,KQ),s=O.A.multiplyByPoint(i,r,KQ),a=K.A.WGS84.cartesianToCartographic(s,$Q);let c=0;(0,d.A)(a)&&(c=a.height);const l=eM.A.getHeight(c,t.verticalExaggeration,t.verticalExaggerationRelativeHeight);return j.A.fromElements(0,0,(l-c)/t.verticalExaggeration,JQ)}(e,t),e._exaggeratedModelMatrix)}}(this,e);const i=ZQ(this,t),o=this._shape;if(i&&(this._shapeVisible=tX(this,o),function(e,t){const n=t.shaderDefines,i=Object.keys(n).some(t=>n[t]!==e._shapeDefinesOld[t]);return i&&(e._shapeDefinesOld=(0,_t.A)(n,!0)),i}(this,o)&&(this._shaderDirty=!0)),!this._shapeVisible)return;const r=function(e,t){if(!(0,d.A)(e)||!(0,d.A)(t))return 0;let n,i=t.currentTime,o=e.indexOf(i);o>=0?n=e.get(o):(o=~o,o===e.length?(o=e.length-1,n=e.get(o),i=n.stop):(n=e.get(o),i=n.start));const r=te.A.secondsDifference(n.stop,n.start);return o+te.A.secondsDifference(i,n.start)/r}(t.timeIntervalCollection,this._clock),s=this._traversal,a=s._sampleCount;if(s.update(e,r,i,this._disableUpdate),a!==s._sampleCount&&(this._shaderDirty=!0),!s.isRenderable(s.rootNode))return;if(this._debugDraw&&function(e,t){const n=e._traversal,i=e._debugPolylines;function o(e,t,n,o){i.add({positions:[e,t],width:o,material:Dn.A.fromType("Color",{color:n})})}function r(e,t,n){const i=e.computeCorners();o(i[0],i[1],t,n),o(i[2],i[3],t,n),o(i[4],i[5],t,n),o(i[6],i[7],t,n),o(i[0],i[2],t,n),o(i[4],i[6],t,n),o(i[1],i[3],t,n),o(i[5],i[7],t,n),o(i[0],i[4],t,n),o(i[2],i[6],t,n),o(i[1],i[5],t,n),o(i[3],i[7],t,n)}i.removeAll(),r(e._shape.orientedBoundingBox,u.A.WHITE,5),function e(t){if(!n.isRenderable(t))return;const i=t.level,o=Math.max(1,5/Math.pow(2,i)),s=[u.A.RED,u.A.LIME,u.A.BLUE][i%3];if(r(t.orientedBoundingBox,s,o),(0,d.A)(t.children))for(let n=0;n<8;n++)e(t.children[n])}(n.rootNode);o(j.A.ZERO,sX,u.A.RED,10),o(j.A.ZERO,aX,u.A.LIME,10),o(j.A.ZERO,cX,u.A.BLUE,10),i.update(t)}(this,e),this._disableRender)return;this._useLogDepth!==e.useLogDepth&&(this._useLogDepth=e.useLogDepth,this._shaderDirty=!0);const c=function(e,t){const n=e.clippingPlanes;if(!(0,d.A)(n))return!1;n.update(t);const{clippingPlanesState:i,enabled:o}=n;if(o){const t=e._uniforms;t.clippingPlanesTexture=n.texture,t.clippingPlanesMatrix=O.A.transpose(O.A.multiplyTransformation(O.A.inverse(n.modelMatrix,t.clippingPlanesMatrix),e._transformPositionUvToWorld,t.clippingPlanesMatrix),t.clippingPlanesMatrix)}return(e._clippingPlanesState!==i||e._clippingPlanesEnabled!==o)&&(e._clippingPlanesState=i,e._clippingPlanesEnabled=o,!0)}(this,e);c&&(this._shaderDirty=!0);const l=s.leafNodeTexture,h=this._uniforms;(0,d.A)(l)&&(h.octreeLeafNodeTexture=s.leafNodeTexture,h.octreeLeafNodeTexelSizeUv=q.A.clone(s.leafNodeTexelSizeUv,h.octreeLeafNodeTexelSizeUv),h.octreeLeafNodeTilesPerRow=s.leafNodeTilesPerRow),this._shaderDirty&&(qq(this,n),this._shaderDirty=!1);const A=n.uniformState.viewProjection,p=function(e,t,n){const i=O.A.fromRotationTranslation(e.halfAxes,e.center,YQ),o=O.A.multiply(t,i,qQ);let r,s=+Number.MAX_VALUE,a=-Number.MAX_VALUE,c=+Number.MAX_VALUE,l=-Number.MAX_VALUE;const u=oX,d=nX.length;for(r=0;r<d;r++)O.A.multiplyByVector(o,nX[r],u[r]);for(r=0;r<d;r++){const e=u[r];if(e.z>=-e.w){const t=e.x/e.w,n=e.y/e.w;s=Math.min(s,t),a=Math.max(a,t),c=Math.min(c,n),l=Math.max(l,n)}else for(let t=0;t<3;t++){const n=u[iX[3*r+t]];if(n.z>=-n.w){const t=e.z+e.w,i=t/(t-(n.z+n.w)),o=Q.A.lerp(e,n,i,HQ),r=o.x/o.w,u=o.y/o.w;s=Math.min(s,r),a=Math.max(a,r),c=Math.min(c,u),l=Math.max(l,u)}}}return s=J.A.clamp(s,-1,1),c=J.A.clamp(c,-1,1),a=J.A.clamp(a,-1,1),l=J.A.clamp(l,-1,1),Q.A.fromElements(s,c,a,l,n)}(o.orientedBoundingBox,A,GQ);if(1===p.x||1===p.y||-1===p.z||-1===p.w)return;h.ndcSpaceAxisAlignedBoundingBox=Q.A.clone(p,h.ndcSpaceAxisAlignedBoundingBox);const f=n.uniformState.inverseView;h.transformPositionViewToUv=O.A.multiplyTransformation(this._transformPositionWorldToUv,f,h.transformPositionViewToUv);const m=n.uniformState.view;h.transformPositionUvToView=O.A.multiplyTransformation(m,this._transformPositionUvToWorld,h.transformPositionUvToView);const g=n.uniformState.inverseViewRotation;h.transformDirectionViewToLocal=Z.A.multiply(this._transformDirectionWorldToLocal,g,h.transformDirectionViewToLocal),h.cameraPositionUv=O.A.multiplyByPoint(this._transformPositionWorldToUv,e.camera.positionWC,h.cameraPositionUv),h.cameraDirectionUv=Z.A.multiplyByVector(this._transformDirectionWorldToUv,e.camera.directionWC,h.cameraDirectionUv),h.cameraDirectionUv=j.A.normalize(h.cameraDirectionUv,h.cameraDirectionUv),h.stepSize=this._stepSizeMultiplier;const _=e.passes.pick?this._drawCommandPick:e.passes.pickVoxel?this._drawCommandPickVoxel:this._drawCommand;_.boundingVolume=o.boundingSphere,e.commandList.push(_)};const XQ=new j.A,KQ=new j.A,$Q=new X.A,JQ=new j.A;function ZQ(e,t){const n=t.shapeTransform??O.A.IDENTITY,i=t.globalTransform??O.A.IDENTITY;return O.A.multiplyTransformation(i,e._exaggeratedModelMatrix,e._compoundModelMatrix),O.A.multiplyTransformation(e._compoundModelMatrix,n,e._compoundModelMatrix),eX(e,"_compoundModelMatrix","_compoundModelMatrixOld")+eX(e,"_minBounds","_minBoundsOld")+eX(e,"_maxBounds","_maxBoundsOld")+eX(e,"_exaggeratedMinBounds","_exaggeratedMinBoundsOld")+eX(e,"_exaggeratedMaxBounds","_exaggeratedMaxBoundsOld")+eX(e,"_minClippingBounds","_minClippingBoundsOld")+eX(e,"_maxClippingBounds","_maxClippingBoundsOld")>0}function eX(e,t,n){const i=e[t],o=e[n],r=!i.equals(o);return r&&i.clone(o),r?1:0}function tX(e,t,n){if(!t.update(e._compoundModelMatrix,e._exaggeratedMinBounds,e._exaggeratedMaxBounds,e.minClippingBounds,e.maxClippingBounds))return!1;const i=t.shapeTransform,o=O.A.inverse(i,WQ);return e._transformPositionWorldToUv=O.A.multiplyTransformation(jQ,o,e._transformPositionWorldToUv),e._transformDirectionWorldToUv=O.A.getMatrix3(e._transformPositionWorldToUv,e._transformDirectionWorldToUv),e._transformPositionUvToWorld=O.A.multiplyTransformation(i,QQ,e._transformPositionUvToWorld),e._transformDirectionWorldToLocal=O.A.getMatrix3(o,e._transformDirectionWorldToLocal),!0}zQ.prototype.isDestroyed=function(){return!1},zQ.prototype.destroy=function(){const e=this._drawCommand;(0,d.A)(e)&&(e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy());const t=this._drawCommandPick;return(0,d.A)(t)&&(t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()),this._pickId=this._pickId&&this._pickId.destroy(),this._traversal=this._traversal&&this._traversal.destroy(),this.statistics.texturesByteLength=0,this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),(0,h.A)(this)};const nX=new Array(new Q.A(-1,-1,-1,1),new Q.A(1,-1,-1,1),new Q.A(-1,1,-1,1),new Q.A(1,1,-1,1),new Q.A(-1,-1,1,1),new Q.A(1,-1,1,1),new Q.A(-1,1,1,1),new Q.A(1,1,1,1)),iX=new Array(1,2,4,0,3,5,0,3,6,1,2,7,0,5,6,1,4,7,2,4,7,3,5,6),oX=new Array(new Q.A,new Q.A,new Q.A,new Q.A,new Q.A,new Q.A,new Q.A,new Q.A),rX=3e7,sX=new j.A(rX,0,0),aX=new j.A(0,rX,0),cX=new j.A(0,0,rX);function lX(){this.ready=!0,this.shape=mQ.BOX,this.dimensions=new j.A(1,1,1),this.names=["data"],this.types=[yF.A.SCALAR],this.componentTypes=[_F.A.FLOAT32],this.maximumTileCount=1}zQ.DefaultCustomShader=new lj({fragmentShaderText:"void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material)\n{\n    material.diffuse = vec3(1.0);\n    material.alpha = 1.0;\n}"}),lX.prototype.requestData=function(e){if(((0,d.A)(e)?e.tileLevel??0:0)>=1)return;const t=new hj({metadata:[new Float32Array(1)]});return Promise.resolve(t)},zQ.DefaultProvider=new lX;const uX=zQ,dX=function(e,t,n,i){if(!(0,d.A)(e))return;if((0,d.A)(t)&&e.id!==t)return;const o=(e.classes||{})[n];if(!(0,d.A)(o))return;const r=(o.properties||{})[i];return(0,d.A)(r)?r:void 0},hX=function(e,t,n,i,o){this.schemaId=e,this.className=t,this.propertyName=n,this.classProperty=i,this.metadataProperty=o},AX=function(e,t,n){if(!(0,d.A)(e))return;const i=e.propertyTextures;for(const e of i)if(e.class.id===t){const t=e.properties[n];if((0,d.A)(t))return t}},pX=function(e){return function(){e.frameState.afterRender.push(function(){e.requestRender()})}};function fX(e){const t=(e=e??S.A.EMPTY_OBJECT).canvas;let n=e.creditContainer,i=e.creditViewport;if(!(0,d.A)(t))throw new A.A("options and options.canvas are required.");const o=e.contextOptions instanceof vt;if(o)this._context=e.contextOptions.createSceneContext(t);else{const n=(0,_t.A)(e.contextOptions);this._context=new rt(t,n)}const r=this._context,a=(0,d.A)(n);a||(n=document.createElement("div"),n.style.position="absolute",n.style.bottom="0",n.style["text-shadow"]="0 0 2px #000000",n.style.color="#ffffff",n.style["font-size"]="10px",n.style["padding-right"]="5px",t.parentNode.appendChild(n)),(0,d.A)(i)||(i=t.parentNode),this._id=(0,E.A)(),this._jobScheduler=new UU,this._frameState=new HF(r,new JB(n,"•",i),this._jobScheduler),this._frameState.scene3DOnly=e.scene3DOnly??!1,this._removeCreditContainer=!a,this._creditContainer=n,this._canvas=t,this._computeEngine=new x(r),this._ellipsoid=e.ellipsoid??K.A.default,this._globe=void 0,this._globeTranslucencyState=new CU,this._primitives=new Yl.A({countReferences:o}),this._groundPrimitives=new Yl.A({countReferences:o}),this._globeHeight=void 0,this._globeHeightDirty=!0,this._cameraUnderground=!1,this._removeUpdateHeightCallback=void 0,this._logDepthBuffer=fX.defaultLogDepthBuffer&&r.fragmentDepth,this._logDepthBufferDirty=!0,this._tweens=new RG,this._shaderFrameCount=0,this._sunPostProcess=void 0,this._computeCommandList=[],this._overlayCommandList=[],this._useOIT=e.orderIndependentTranslucency??!0,this._executeOITFunction=void 0,this._depthPlane=new gF(e.depthPlaneEllipsoidOffset),this._clearColorCommand=new s.A({color:new u.A,stencil:0,owner:this}),this._depthClearCommand=new s.A({depth:1,owner:this}),this._stencilClearCommand=new s.A({stencil:0}),this._classificationStencilClearCommand=new s.A({stencil:0,renderState:_.A.fromCache({stencilMask:SU.A.CLASSIFICATION_MASK})}),this._depthOnlyRenderStateCache={},this._transitioner=new gG(this),this._preUpdate=new Bn.A,this._postUpdate=new Bn.A,this._renderError=new Bn.A,this._preRender=new Bn.A,this._postRender=new Bn.A,this._minimumDisableDepthTestDistance=0,this._debugInspector=new _q,this._msaaSamples=e.msaaSamples??4,this.rethrowRenderErrors=!1,this.completeMorphOnUserInput=!0,this.morphStart=new Bn.A,this.morphComplete=new Bn.A,this.skyBox=void 0,this.skyAtmosphere=void 0,this.sun=void 0,this.sunBloom=!0,this._sunBloom=void 0,this.moon=void 0,this.backgroundColor=u.A.clone(u.A.BLACK),this._mode=Ce.A.SCENE3D,this._mapProjection=(0,d.A)(e.mapProjection)?e.mapProjection:new zP.A(this._ellipsoid),this.morphTime=1,this.farToNearRatio=1e3,this.logarithmicDepthFarToNearRatio=1e9,this.nearToFarDistance2D=175e4,this.verticalExaggeration=1,this.verticalExaggerationRelativeHeight=0,this.debugCommandFilter=void 0,this.debugShowCommands=!1,this.debugShowFrustums=!1,this.debugShowFramesPerSecond=!1,this.debugShowDepthFrustum=1,this.debugShowFrustumPlanes=!1,this._debugShowFrustumPlanes=!1,this._debugFrustumPlanes=void 0,this.useDepthPicking=!0,this.pickTranslucentDepth=!1,this.cameraEventWaitTime=500,this.atmosphere=new NB.A,this.fog=new zF,this.fog.enabled=K.A.WGS84.equals(this._ellipsoid),K.A.WGS84.equals(this._ellipsoid)||(UB.A.DEFAULT_VIEW_RECTANGLE=Or.A.fromDegrees(-45,-45,45,45)),this._shadowMapCamera=new UB.A(this),this.shadowMap=new sV({context:r,lightCamera:this._shadowMapCamera,enabled:e.shadows??!1}),this.invertClassification=!1,this.invertClassificationColor=u.A.clone(u.A.WHITE),this._actualInvertClassificationColor=u.A.clone(this._invertClassificationColor),this._invertClassification=new LU,this.focalLength=void 0,this.eyeSeparation=void 0,this.postProcessStages=new dH,this._brdfLutGenerator=new FB,this._performanceDisplay=void 0,this._debugVolume=void 0,this._screenSpaceCameraController=new rq(this),this._cameraUnderground=!1,this._mapMode2D=e.mapMode2D??kU.A.INFINITE_SCROLL,this._environmentState={skyBoxCommand:void 0,skyAtmosphereCommand:void 0,sunDrawCommand:void 0,sunComputeCommand:void 0,moonCommand:void 0,isSunVisible:!1,isMoonVisible:!1,isReadyForAtmosphere:!1,isSkyAtmosphereVisible:!1,clearGlobeDepth:!1,useDepthPlane:!1,renderTranslucentDepthForPick:!1,originalFramebuffer:void 0,useGlobeDepthFramebuffer:!1,useOIT:!1,useInvertClassification:!1,usePostProcess:!1,usePostProcessSelected:!1,useWebVR:!1},this._useWebVR=!1,this._cameraVR=void 0,this._aspectRatioVR=void 0,this.requestRenderMode=e.requestRenderMode??!1,this._renderRequested=!0,this.maximumRenderTimeChange=e.maximumRenderTimeChange??0,this._lastRenderTime=void 0,this._frameRateMonitor=void 0,this._removeRequestListenerCallback=vR.A.requestCompletedEvent.addEventListener(pX(this)),this._removeTaskProcessorListenerCallback=ZP.A.taskCompletedEvent.addEventListener(pX(this)),this._removeGlobeCallbacks=[],this._removeTerrainProviderReadyListener=void 0;const l=new c.A(0,0,r.drawingBufferWidth,r.drawingBufferHeight),h=new UB.A(this);this._logDepthBuffer&&(h.frustum.near=.1,h.frustum.far=1e10),this.preloadFlightCamera=new UB.A(this),this.preloadFlightCullingVolume=void 0,this._picking=new lz(this),this._defaultView=new yV(this,h,l),this._view=this._defaultView,this._hdr=void 0,this._hdrDirty=void 0,this.highDynamicRange=!1,this.gamma=2.2,this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this._specularEnvironmentCubeMap=void 0,this.light=new Ee.A,wX(this,0,te.A.now()),this.updateFrameState(),this.initializeFrame()}function mX(e,t,n){const i=e._frameState,o=e._context,r=e._view.oit,{lightShadowMaps:s,lightShadowsEnabled:a}=i.shadowState;let c=t.derivedCommands;(0,d.A)(t.pickId)&&(c.picking=RF.createPickDerivedCommand(e,t,o,c.picking)),i.pickingMetadata&&t.pickMetadataAllowed&&(t.pickedMetadataInfo=i.pickedMetadataInfo,(0,d.A)(t.pickedMetadataInfo)&&(c.pickingMetadata=RF.createPickMetadataDerivedCommand(e,t,o,c.pickingMetadata))),t.pickOnly||(c.depth=RF.createDepthOnlyDerivedCommand(e,t,o,c.depth)),c.originalCommand=t,e._hdr&&(c.hdr=RF.createHdrCommand(t,o,c.hdr),c=(t=c.hdr.command).derivedCommands),a&&t.receiveShadows&&(c.shadows=sV.createReceiveDerivedCommand(s,t,n,o,c.shadows)),t.pass===ut.A.TRANSLUCENT&&(0,d.A)(r)&&r.isSupported()&&(a&&t.receiveShadows?(c.oit=(0,d.A)(c.oit)?c.oit:{},c.oit.shadows=r.createDerivedCommands(c.shadows.receiveCommand,o,c.oit.shadows)):c.oit=r.createDerivedCommands(t,o,c.oit))}fX.defaultLogDepthBuffer=!0,Object.defineProperties(fX.prototype,{canvas:{get:function(){return this._canvas}},drawingBufferHeight:{get:function(){return this._context.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._context.drawingBufferWidth}},maximumAliasedLineWidth:{get:function(){return N.A.maximumAliasedLineWidth}},maximumCubeMapSize:{get:function(){return N.A.maximumCubeMapSize}},pickPositionSupported:{get:function(){return this._context.depthTexture}},sampleHeightSupported:{get:function(){return this._context.depthTexture}},clampToHeightSupported:{get:function(){return this._context.depthTexture}},invertClassificationSupported:{get:function(){return this._context.depthTexture}},specularEnvironmentMapsSupported:{get:function(){return sq.A.isSupported(this._context)}},ellipsoid:{get:function(){return this._ellipsoid}},globe:{get:function(){return this._globe},set:function(e){this._globe=this._globe&&this._globe.destroy(),this._globe=e,function(e,t){for(let t=0;t<e._removeGlobeCallbacks.length;++t)e._removeGlobeCallbacks[t]();e._removeGlobeCallbacks.length=0;const n=[];(0,d.A)(t)&&(n.push(t.imageryLayersUpdatedEvent.addEventListener(pX(e))),n.push(t.terrainProviderChanged.addEventListener(pX(e)))),e._removeGlobeCallbacks=n}(this,e)}},primitives:{get:function(){return this._primitives}},groundPrimitives:{get:function(){return this._groundPrimitives}},camera:{get:function(){return this._view.camera},set:function(e){this._view.camera=e}},view:{get:function(){return this._view},set:function(e){this._view=e}},defaultView:{get:function(){return this._defaultView}},picking:{get:function(){return this._picking}},screenSpaceCameraController:{get:function(){return this._screenSpaceCameraController}},mapProjection:{get:function(){return this._mapProjection}},jobScheduler:{get:function(){return this._jobScheduler}},frameState:{get:function(){return this._frameState}},environmentState:{get:function(){return this._environmentState}},tweens:{get:function(){return this._tweens}},imageryLayers:{get:function(){if((0,d.A)(this.globe))return this.globe.imageryLayers}},terrainProvider:{get:function(){if((0,d.A)(this.globe))return this.globe.terrainProvider},set:function(e){this._removeTerrainProviderReadyListener=this._removeTerrainProviderReadyListener&&this._removeTerrainProviderReadyListener(),(0,d.A)(this.globe)&&(this.globe.terrainProvider=e)}},terrainProviderChanged:{get:function(){if((0,d.A)(this.globe))return this.globe.terrainProviderChanged}},preUpdate:{get:function(){return this._preUpdate}},postUpdate:{get:function(){return this._postUpdate}},renderError:{get:function(){return this._renderError}},preRender:{get:function(){return this._preRender}},postRender:{get:function(){return this._postRender}},lastRenderTime:{get:function(){return this._lastRenderTime}},context:{get:function(){return this._context}},debugFrustumStatistics:{get:function(){return this._view.debugFrustumStatistics}},scene3DOnly:{get:function(){return this._frameState.scene3DOnly}},orderIndependentTranslucency:{get:function(){return this._useOIT}},id:{get:function(){return this._id}},mode:{get:function(){return this._mode},set:function(e){if(this.scene3DOnly&&e!==Ce.A.SCENE3D)throw new A.A("Only SceneMode.SCENE3D is valid when scene3DOnly is true.");if(e===Ce.A.SCENE2D)this.morphTo2D(0);else if(e===Ce.A.SCENE3D)this.morphTo3D(0);else{if(e!==Ce.A.COLUMBUS_VIEW)throw new A.A("value must be a valid SceneMode enumeration.");this.morphToColumbusView(0)}this._mode=e}},frustumCommandsList:{get:function(){return this._view.frustumCommandsList}},numberOfFrustums:{get:function(){return this._view.frustumCommandsList.length}},useWebVR:{get:function(){return this._useWebVR},set:function(e){if(this.camera.frustum instanceof ee.A)throw new A.A("VR is unsupported with an orthographic projection.");this._useWebVR=e,this._useWebVR?(this._frameState.creditDisplay.container.style.visibility="hidden",this._cameraVR=new UB.A(this),(0,d.A)(this._deviceOrientationCameraController)||(this._deviceOrientationCameraController=new FF(this)),this._aspectRatioVR=this.camera.frustum.aspectRatio):(this._frameState.creditDisplay.container.style.visibility="visible",this._cameraVR=void 0,this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this.camera.frustum.aspectRatio=this._aspectRatioVR,this.camera.frustum.xOffset=0)}},mapMode2D:{get:function(){return this._mapMode2D}},splitPosition:{get:function(){return this._frameState.splitPosition},set:function(e){this._frameState.splitPosition=e}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance},set:function(e){if(!(0,d.A)(e)||e<0)throw new A.A("minimumDisableDepthTestDistance must be greater than or equal to 0.0.");this._minimumDisableDepthTestDistance=e}},logarithmicDepthBuffer:{get:function(){return this._logDepthBuffer},set:function(e){e=this._context.fragmentDepth&&e,this._logDepthBuffer!==e&&(this._logDepthBuffer=e,this._logDepthBufferDirty=!0)}},gamma:{get:function(){return this._context.uniformState.gamma},set:function(e){this._context.uniformState.gamma=e}},highDynamicRange:{get:function(){return this._hdr},set:function(e){const t=this._context,n=e&&t.depthTexture&&(t.colorBufferFloat||t.colorBufferHalfFloat);this._hdrDirty=n!==this._hdr,this._hdr=n}},highDynamicRangeSupported:{get:function(){const e=this._context;return e.depthTexture&&(e.colorBufferFloat||e.colorBufferHalfFloat)}},cameraUnderground:{get:function(){return this._cameraUnderground}},msaaSamples:{get:function(){return this._msaaSamples},set:function(e){e=Math.min(e,N.A.maximumSamples),this._msaaSamples=e}},msaaSupported:{get:function(){return this._context.msaa}},pixelRatio:{get:function(){return this._frameState.pixelRatio},set:function(e){this._frameState.pixelRatio=e}},opaqueFrustumNearOffset:{get:function(){return.9999}},globeHeight:{get:function(){return this._globeHeight}}}),fX.prototype.getCompressedTextureFormatSupported=function(e){const t=this.context;return("WEBGL_compressed_texture_s3tc"===e||"s3tc"===e)&&t.s3tc||("WEBGL_compressed_texture_pvrtc"===e||"pvrtc"===e)&&t.pvrtc||("WEBGL_compressed_texture_etc"===e||"etc"===e)&&t.etc||("WEBGL_compressed_texture_etc1"===e||"etc1"===e)&&t.etc1||("WEBGL_compressed_texture_astc"===e||"astc"===e)&&t.astc||("EXT_texture_compression_bptc"===e||"bc7"===e)&&t.bc7},fX.prototype.updateDerivedCommands=function(e){const{derivedCommands:t}=e;if(!(0,d.A)(t))return;const n=this._frameState,{shadowState:i,useLogDepth:o}=this._frameState,r=this._context;let s=!1;const a=i.lastDirtyTime;e.lastDirtyTime!==a&&(e.lastDirtyTime=a,e.dirty=!0,s=!0);const c=this._hdr,l=(0,d.A)(t.logDepth),u=(0,d.A)(t.hdr),h=(0,d.A)(t.originalCommand),A=o&&!l,p=c&&!u,f=!(o&&c||h),m=n.pickingMetadata&&function(e,t){const n=e.pickedMetadataInfo,i=t.pickedMetadataInfo;return n?.schemaId!==i?.schemaId||n?.className!==i?.className||n?.propertyName!==i?.propertyName}(e,n);if(e.dirty=e.dirty||A||p||f||m,!e.dirty)return;e.dirty=!1;const{shadowsEnabled:g,shadowMaps:_}=i;g&&e.castShadows&&(t.shadows=sV.createCastDerivedCommand(_,e,s,r,t.shadows)),(l||A)&&(t.logDepth=RF.createLogDepthCommand(e,r,t.logDepth),mX(this,t.logDepth.command,s)),(h||f)&&mX(this,e,s)};const gX=new VB({pass:kB.A.RENDER}),_X=new VB({pass:kB.A.PRELOAD}),yX=new VB({pass:kB.A.PRELOAD_FLIGHT}),vX=new VB({pass:kB.A.REQUEST_RENDER_MODE_DEFER_CHECK}),TX=new Sn.A;let bX;function wX(e,t,n){const i=e._frameState;i.frameNumber=t,i.time=te.A.clone(n,i.time)}fX.prototype.clearPasses=function(e){e.render=!1,e.pick=!1,e.pickVoxel=!1,e.depth=!1,e.postProcess=!1,e.offscreen=!1},fX.prototype.updateFrameState=function(){const e=this.camera,t=this._frameState;t.commandList.length=0,t.shadowMaps.length=0,t.brdfLutGenerator=this._brdfLutGenerator,t.environmentMap=this.skyBox&&this.skyBox._cubeMap,t.mode=this._mode,t.morphTime=this.morphTime,t.mapProjection=this.mapProjection,t.camera=e,t.cullingVolume=e.frustum.computeCullingVolume(e.positionWC,e.directionWC,e.upWC),t.occluder=function(e){if(e._mode===Ce.A.SCENE3D&&e.globe?.show&&!e._cameraUnderground&&!e._globeTranslucencyState.translucent)return TX.radius=e.ellipsoid.minimumRadius+e.frameState.minimumTerrainHeight,bX=oR.fromBoundingSphere(TX,e.camera.positionWC,bX),bX}(this),t.minimumTerrainHeight=0,t.minimumDisableDepthTestDistance=this._minimumDisableDepthTestDistance,t.invertClassification=this.invertClassification,t.useLogDepth=this._logDepthBuffer&&!(this.camera.frustum instanceof ee.A||this.camera.frustum instanceof aR.A),t.light=this.light,t.cameraUnderground=this._cameraUnderground,t.globeTranslucencyState=this._globeTranslucencyState;const{globe:n}=this;(0,d.A)(n)&&n._terrainExaggerationChanged&&(this.verticalExaggeration=n._terrainExaggeration,this.verticalExaggerationRelativeHeight=n._terrainExaggerationRelativeHeight,n._terrainExaggerationChanged=!1),t.verticalExaggeration=this.verticalExaggeration,t.verticalExaggerationRelativeHeight=this.verticalExaggerationRelativeHeight,(0,d.A)(this._specularEnvironmentCubeMap)&&this._specularEnvironmentCubeMap.ready?(t.specularEnvironmentMaps=this._specularEnvironmentCubeMap.texture,t.specularEnvironmentMapsMaximumLOD=this._specularEnvironmentCubeMap.maximumMipmapLevel):(t.specularEnvironmentMaps=void 0,t.specularEnvironmentMapsMaximumLOD=void 0),t.sphericalHarmonicCoefficients=this.sphericalHarmonicCoefficients,this._actualInvertClassificationColor=u.A.clone(this.invertClassificationColor,this._actualInvertClassificationColor),LU.isTranslucencySupported(this._context)||(this._actualInvertClassificationColor.alpha=1),t.invertClassificationColor=this._actualInvertClassificationColor,(0,d.A)(this.globe)?t.maximumScreenSpaceError=this.globe.maximumScreenSpaceError:t.maximumScreenSpaceError=2,this.clearPasses(t.passes),t.tilesetPassState=void 0},fX.prototype.isVisible=function(e,t,n){if(!(0,d.A)(t))return!1;const{boundingVolume:i}=t;return!((0,d.A)(i)&&t.cull&&(e.computeVisibility(i)===bO.A.OUTSIDE||(0,d.A)(n)&&t.occlude&&i.isOccluded(n)))};let xX=new O.A(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);function CX(e,t,n,i){const o=t._frameState,r=t._context;if((0,d.A)(t.debugCommandFilter)&&!t.debugCommandFilter(e))return;if(e instanceof s.A)return void e.execute(r,n);e.debugShowBoundingVolume&&(0,d.A)(e.boundingVolume)&&function(e,t,n,i){const o=t._frameState,r=o.context,s=e.boundingVolume;(0,d.A)(t._debugVolume)&&t._debugVolume.destroy();let a,c,l=j.A.clone(s.center);if(o.mode!==Ce.A.SCENE3D){l=O.A.multiplyByPoint(xX,l,l);const e=o.mapProjection,t=e.unproject(l);l=e.ellipsoid.cartographicToCartesian(t)}const{radius:u}=s;(0,d.A)(u)?(a=Pu.createGeometry(new Pu({radii:new j.A(u,u,u),vertexFormat:Cn.A.FLAT_VERTEX_FORMAT})),c=O.A.fromTranslation(l)):(a=pn.A.createGeometry(pn.A.fromDimensions({dimensions:new j.A(2,2,2),vertexFormat:Cn.A.FLAT_VERTEX_FORMAT})),c=O.A.fromRotationTranslation(s.halfAxes,l,new O.A)),t._debugVolume=new Pn.A({geometryInstances:new yn.A({geometry:Ad.A.toWireframe(a),modelMatrix:c,attributes:{color:new mn.A(1,0,0,1)}}),appearance:new Cn.A({flat:!0,translucent:!1}),asynchronous:!1});const h=o.commandList,A=o.commandList=[];let p;t._debugVolume.update(o),e=A[0],o.useLogDepth&&(e=RF.createLogDepthCommand(e,r).command),(0,d.A)(i)&&(p=n.framebuffer,n.framebuffer=i),e.execute(r,n),(0,d.A)(p)&&(n.framebuffer=p),o.commandList=h}(e,t,n,i),o.useLogDepth&&(0,d.A)(e.derivedCommands.logDepth)&&(e=e.derivedCommands.logDepth.command);const a=o.passes;if(!a.pick&&!a.pickVoxel&&!a.depth&&t._hdr&&(0,d.A)(e.derivedCommands)&&(0,d.A)(e.derivedCommands.hdr)&&(e=e.derivedCommands.hdr.command),a.pick||a.depth)if(a.pick&&!a.depth){if(o.pickingMetadata&&(0,d.A)(e.derivedCommands.pickingMetadata))return void(e=e.derivedCommands.pickingMetadata.pickMetadataCommand).execute(r,n);if(!o.pickingMetadata&&(0,d.A)(e.derivedCommands.picking))return void(e=e.derivedCommands.picking.pickCommand).execute(r,n)}else if((0,d.A)(e.derivedCommands.depth))return void(e=e.derivedCommands.depth.depthOnlyCommand).execute(r,n);t.debugShowCommands||t.debugShowFrustums?t._debugInspector.executeDebugShowFrustumsCommand(t,e,n):o.shadowState.lightShadowsEnabled&&e.receiveShadows&&(0,d.A)(e.derivedCommands.shadows)?e.derivedCommands.shadows.receiveCommand.execute(r,n):e.execute(r,n)}function EX(e,t,n){const{derivedCommands:i}=e;if(!(0,d.A)(i))return;const o=t._frameState,r=t._context;o.useLogDepth&&(0,d.A)(i.logDepth)&&(e=i.logDepth.command);const{picking:s,pickingMetadata:a,depth:c}=e.derivedCommands;(0,d.A)(a)&&(e=i.pickingMetadata.pickMetadataCommand).execute(r,n),(0,d.A)(s)?(e=s.pickCommand).execute(r,n):(0,d.A)(c)&&(e=c.depthOnlyCommand).execute(r,n)}function SX(e,t,n){return t.boundingVolume.distanceSquaredTo(n)-e.boundingVolume.distanceSquaredTo(n)}xX=O.A.inverseTransformation(xX,xX);const IX=new j.A;function PX(e,t){const n=j.A.subtract(e,t,IX),i=Math.max(0,j.A.magnitude(n));return i*i}function DX(e,t,n){const i=e.boundingVolume;return PX(t.boundingVolume.center,n)-PX(i.center,n)}function OX(e,t,n){return e.boundingVolume.distanceSquaredTo(n)-t.boundingVolume.distanceSquaredTo(n)+J.A.EPSILON12}function RX(e,t,n,i,o){DM(i,SX,e.camera.positionWC),(0,d.A)(o)&&t(o.unclassifiedCommand,e,n);for(let o=0;o<i.length;++o)t(i[o],e,n)}function MX(e,t,n,i,o){DM(i,OX,e.camera.positionWC),(0,d.A)(o)&&t(o.unclassifiedCommand,e,n);for(let o=0;o<i.length;++o)t(i[o],e,n)}function LX(e,t,n){e.context.uniformState.updatePass(ut.A.VOXELS);const i=n.commands[ut.A.VOXELS];i.length=n.indices[ut.A.VOXELS],DM(i,SX,e.camera.positionWC);for(let n=0;n<i.length;++n)CX(i[n],e,t)}function NX(e,t,n){e.context.uniformState.updatePass(ut.A.GAUSSIAN_SPLATS);const i=n.commands[ut.A.GAUSSIAN_SPLATS];i.length=n.indices[ut.A.GAUSSIAN_SPLATS],DM(i,DX,e.camera.positionWC);for(let n=0;n<i.length;++n)CX(i[n],e,t)}const BX=new uP.A,FX=new uR.A,UX=new ee.A,kX=new aR.A;function VX(e,t,n){const{frameState:i,context:o}=e,{pick:r,pickVoxel:s}=i.passes;let a;!r&&!s&&e._environmentState.useInvertClassification&&i.invertClassificationColor.alpha<1&&(a=e._invertClassification);const c=function(e){if(e._environmentState.useOIT){if(!(0,d.A)(e._executeOITFunction)){const{view:t,context:n}=e;e._executeOITFunction=function(e,i,o,r,s){t.globeDepth.prepareColorTextures(n),t.oit.executeCommands(e,i,o,r,s)}}return e._executeOITFunction}return e.frameState.passes.render?RX:MX}(e);o.uniformState.updatePass(ut.A.TRANSLUCENT);const l=n.commands[ut.A.TRANSLUCENT];l.length=n.indices[ut.A.TRANSLUCENT],c(e,CX,t,l,a)}function zX(e,t,n){const{translucentTileClassification:i,globeDepth:o}=e._view;if(!(n.indices[ut.A.CESIUM_3D_TILE_CLASSIFICATION]>0&&i.isSupported()))return;const r=n.commands[ut.A.TRANSLUCENT];i.executeTranslucentCommands(e,CX,t,r,o.depthStencilTexture),i.executeClassificationCommands(e,CX,t,n)}function HX(e,t){const{camera:n,context:i,frameState:o}=e,{uniformState:r}=i;r.updateCamera(n);const s=function(e){const{frustum:t}=e;return(0,d.A)(t.fov)?t.clone(BX):(0,d.A)(t.infiniteProjectionMatrix)?t.clone(FX):(0,d.A)(t.width)?t.clone(UX):t.clone(kX)}(n);s.near=n.frustum.near,s.far=n.frustum.far;const a=o.passes,c=a.pick||a.pickVoxel;c||function(e,t){const{context:n,environmentState:i,view:o}=e;if(n.uniformState.updatePass(ut.A.ENVIRONMENT),(0,d.A)(i.skyBoxCommand)&&CX(i.skyBoxCommand,e,t),i.isSkyAtmosphereVisible&&CX(i.skyAtmosphereCommand,e,t),i.isSunVisible&&(i.sunDrawCommand.execute(n,t),e.sunBloom&&!i.useWebVR)){let r;r=i.useGlobeDepthFramebuffer?o.globeDepth.framebuffer:i.usePostProcess?o.sceneFramebuffer.framebuffer:i.originalFramebuffer,e._sunPostProcess.execute(n),e._sunPostProcess.copy(n,r),t.framebuffer=r}i.isMoonVisible&&i.moonCommand.execute(n,t)}(e,t);const{clearGlobeDepth:l,renderTranslucentDepthForPick:u,useDepthPlane:h,useGlobeDepthFramebuffer:A,useInvertClassification:p,usePostProcessSelected:f}=e._environmentState,{globeDepth:m,globeTranslucencyFramebuffer:g,sceneFramebuffer:_,frustumCommandsList:y}=e._view,v=y.length,T=e._globeTranslucencyState,b=e._depthClearCommand,w=e._stencilClearCommand,x=e._classificationStencilClearCommand,C=e._depthPlane,E=n.position.z;function S(n,i){r.updatePass(i);const o=n.commands[i],s=n.indices[i];for(let n=0;n<s;++n)CX(o[n],e,t);return s}function I(n,i){r.updatePass(i);const o=n.commands[i],s=n.indices[i];for(let n=0;n<s;++n)EX(o[n],e,t)}for(let a=0;a<v;++a){const d=v-a-1,P=y[d];let D;if(e.mode===Ce.A.SCENE2D?(n.position.z=E-P.near+1,s.far=Math.max(1,P.far-P.near),s.near=1,r.update(o),r.updateFrustum(s)):(s.near=0!==d?P.near*e.opaqueFrustumNearOffset:P.near,s.far=P.far,r.updateFrustum(s)),b.execute(i,t),i.stencilBuffer&&w.execute(i,t),T.translucent?(r.updatePass(ut.A.GLOBE),T.executeGlobeCommands(P,CX,g,e,t)):S(P,ut.A.GLOBE),A&&m.executeCopyDepth(i,t),u||(T.translucent?(r.updatePass(ut.A.TERRAIN_CLASSIFICATION),T.executeGlobeClassificationCommands(P,CX,g,e,t)):S(P,ut.A.TERRAIN_CLASSIFICATION)),l&&(b.execute(i,t),h&&C.execute(i,t)),!p||c||u)D=S(P,ut.A.CESIUM_3D_TILE),D>0&&(A&&(m.prepareColorTextures(i,l),m.executeUpdateDepth(i,t,m.depthStencilTexture)),u||(D=S(P,ut.A.CESIUM_3D_TILE_CLASSIFICATION)));else{e._invertClassification.clear(i,t);const n=t.framebuffer;t.framebuffer=e._invertClassification._fbo.framebuffer,D=S(P,ut.A.CESIUM_3D_TILE),A&&(e._invertClassification.prepareTextures(i),m.executeUpdateDepth(i,t,e._invertClassification._fbo.getDepthStencilTexture())),D=S(P,ut.A.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW),t.framebuffer=n,e._invertClassification.executeClassified(i,t),1===o.invertClassificationColor.alpha&&e._invertClassification.executeUnclassified(i,t),D>0&&i.stencilBuffer&&x.execute(i,t),D=S(P,ut.A.CESIUM_3D_TILE_CLASSIFICATION)}if(D>0&&i.stencilBuffer&&w.execute(i,t),LX(e,t,P),S(P,ut.A.OPAQUE),NX(e,t,P),0!==d&&e.mode!==Ce.A.SCENE2D&&(s.near=P.near,r.updateFrustum(s)),VX(e,t,P),zX(e,t,P),i.depthTexture&&e.useDepthPicking&&(A||u)){const n=e._picking.getPickDepth(e,d);n.update(i,m.depthStencilTexture),n.executeCopyDepth(i,t)}if(c||!f)continue;const O=t.framebuffer;t.framebuffer=_.getIdFramebuffer(),s.near=0!==d?P.near*e.opaqueFrustumNearOffset:P.near,s.far=P.far,r.updateFrustum(s),T.translucent?(r.updatePass(ut.A.GLOBE),T.executeGlobeCommands(P,EX,g,e,t)):I(P,ut.A.GLOBE),l&&(b.framebuffer=t.framebuffer,b.execute(i,t),b.framebuffer=void 0),l&&h&&C.execute(i,t),I(P,ut.A.CESIUM_3D_TILE),I(P,ut.A.OPAQUE),I(P,ut.A.TRANSLUCENT),t.framebuffer=O}}function GX(e){e.context.uniformState.updatePass(ut.A.COMPUTE);const t=e._environmentState.sunComputeCommand;(0,d.A)(t)&&t.execute(e._computeEngine);const n=e._computeCommandList;for(let t=0;t<n.length;++t)n[t].execute(e._computeEngine)}function WX(e,t,n){const{shadowMapCullingVolume:i,isPointLight:o,passes:r}=n,s=r.length,a=[ut.A.GLOBE,ut.A.CESIUM_3D_TILE,ut.A.OPAQUE,ut.A.TRANSLUCENT];for(let n=0;n<t.length;++n){const c=t[n];if(e.updateDerivedCommands(c),c.castShadows&&!(a.indexOf(c.pass)<0)&&e.isVisible(i,c))if(o)for(let e=0;e<s;++e)r[e].commandList.push(c);else if(1===s)r[0].commandList.push(c);else{let t=!1;for(let n=s-1;n>=0;--n){const i=r[n].cullingVolume;if(e.isVisible(i,c))r[n].commandList.push(c),t=!0;else if(t)break}}}}function YX(e){const{shadowState:t,commandList:n}=e.frameState,{shadowsEnabled:i,shadowMaps:o}=t;if(!i)return;const{context:r}=e,{uniformState:s}=r;for(let t=0;t<o.length;++t){const i=o[t];if(i.outOfView)continue;const{passes:a}=i;for(let e=0;e<a.length;++e)a[e].commandList.length=0;WX(e,n,i);for(let n=0;n<a.length;++n){const o=i.passes[n],{camera:a,commandList:c}=o;s.updateCamera(a),i.updatePass(r,n);for(let n=0;n<c.length;++n){const i=c[n];s.updatePass(i.pass),CX(i.derivedCommands.shadows.castCommands[t],e,o.passState)}}}}const qX=new j.A;fX.prototype.updateAndExecuteCommands=function(e,t){!function(e,t,n){const i=e._context,o=e._frameState,r=e._environmentState,s=e._view,a=o.passes,c=a.pick||a.pickVoxel;(0,d.A)(s.globeDepth)&&(s.globeDepth.picking=c);const l=r.useWebVR;r.originalFramebuffer=t.framebuffer,(0,d.A)(e.sun)&&e.sunBloom!==e._sunBloom?(e.sunBloom&&!l?e._sunPostProcess=new pq:(0,d.A)(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy()),e._sunBloom=e.sunBloom):!(0,d.A)(e.sun)&&(0,d.A)(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy(),e._sunBloom=!1);const h=e._clearColorCommand;u.A.clone(n,h.color),h.execute(i,t);const A=r.useGlobeDepthFramebuffer=(0,d.A)(s.globeDepth);A&&(s.globeDepth.update(i,t,s.viewport,e.msaaSamples,e._hdr,r.clearGlobeDepth),s.globeDepth.clear(i,t,n));const p=s.oit,f=r.useOIT=!c&&(0,d.A)(p)&&p.isSupported();f&&(p.update(i,t,s.globeDepth.colorFramebufferManager,e._hdr,e.msaaSamples),p.clear(i,t,n),r.useOIT=p.isSupported());const m=e.postProcessStages;let g=r.usePostProcess=!c&&(e._hdr||m.length>0||m.ambientOcclusion.enabled||m.fxaa.enabled||m.bloom.enabled);r.usePostProcessSelected=!1,g&&(s.sceneFramebuffer.update(i,s.viewport,e._hdr,e.msaaSamples),s.sceneFramebuffer.clear(i,t,n),m.update(i,o.useLogDepth,e._hdr),m.clear(i),g=r.usePostProcess=m.ready,r.usePostProcessSelected=g&&m.hasSelected),r.isSunVisible&&e.sunBloom&&!l?(t.framebuffer=e._sunPostProcess.update(t),e._sunPostProcess.clear(i,t,n)):A?t.framebuffer=s.globeDepth.framebuffer:g&&(t.framebuffer=s.sceneFramebuffer.framebuffer),(0,d.A)(t.framebuffer)&&h.execute(i,t);if(r.useInvertClassification=!c&&(0,d.A)(t.framebuffer)&&e.invertClassification){let n;if(1===o.invertClassificationColor.alpha&&A&&(n=s.globeDepth.framebuffer),(0,d.A)(n)||i.depthTexture){if(e._invertClassification.previousFramebuffer=n,e._invertClassification.update(i,e.msaaSamples,s.globeDepth.colorFramebufferManager),e._invertClassification.clear(i,t),o.invertClassificationColor.alpha<1&&f){const t=e._invertClassification.unclassifiedCommand,n=t.derivedCommands;n.oit=p.createDerivedCommands(t,i,n.oit)}}else r.useInvertClassification=!1}e._globeTranslucencyState.translucent&&s.globeTranslucencyFramebuffer.updateAndClear(e._hdr,s.viewport,i,t)}(this,e,t),this._environmentState.useWebVR?function(e,t){const n=e._view,i=n.camera,o=e._environmentState.renderTranslucentDepthForPick;iK(e),n.createPotentiallyVisibleSet(e),GX(e),o||YX(e);const r=t.viewport;r.x=0,r.y=0,r.width=.5*r.width;const s=UB.A.clone(i,e._cameraVR);s.frustum=i.frustum;const a=i.frustum.near,c=a*(e.focalLength??5),l=e.eyeSeparation??c/30,u=j.A.multiplyByScalar(s.right,.5*l,qX);i.frustum.aspectRatio=r.width/r.height;const d=.5*l*a/c;j.A.add(s.position,u,i.position),i.frustum.xOffset=d,HX(e,t),r.x=r.width,j.A.subtract(s.position,u,i.position),i.frustum.xOffset=-d,HX(e,t),UB.A.clone(s,i)}(this,e):this._frameState.mode!==Ce.A.SCENE2D||this._mapMode2D===kU.A.ROTATE?tK(!0,this,e):function(e,t){const{frameState:n,camera:i}=e,{uniformState:o}=e.context,r=t.viewport,s=c.A.clone(r,eK);t.viewport=s;const a=jX,l=QX;e.mapProjection.project(a,l);const u=j.A.clone(i.position,XX),d=O.A.clone(i.transform,$X),h=i.frustum.clone();i._setTransform(O.A.IDENTITY);const A=O.A.computeViewportTransformation(s,0,1,KX),p=i.frustum.projectionMatrix,f=i.positionWC.y,m=j.A.fromElements(J.A.sign(f)*l.x-f,0,-i.positionWC.x,JX),g=xe.A.pointToGLWindowCoordinates(p,A,m,ZX);g.x=Math.floor(g.x);const _=s.x,y=s.width;if(0===f||g.x<=_||g.x>=_+y)tK(!0,e,t);else if(Math.abs(_+.5*y-g.x)<1)s.width=g.x-s.x,i.position.x*=J.A.sign(i.position.x),i.frustum.right=0,n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),o.update(n),tK(!0,e,t),s.x=g.x,i.position.x=-i.position.x,i.frustum.right=-i.frustum.left,i.frustum.left=0,n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),o.update(n),tK(!1,e,t);else if(g.x>_+.5*y){s.width=g.x-_;const r=i.frustum.right;i.frustum.right=l.x-f,n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),o.update(n),tK(!0,e,t),s.x=g.x,s.width=_+y-g.x,i.position.x=-i.position.x,i.frustum.left=-i.frustum.right,i.frustum.right=r-2*i.frustum.right,n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),o.update(n),tK(!1,e,t)}else{s.x=g.x,s.width=_+y-g.x;const r=i.frustum.left;i.frustum.left=-l.x-f,n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),o.update(n),tK(!0,e,t),s.x=_,s.width=g.x-_,i.position.x=-i.position.x,i.frustum.right=-i.frustum.left,i.frustum.left=r-2*i.frustum.left,n.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),o.update(n),tK(!1,e,t)}i._setTransform(d),j.A.clone(u,i.position),i.frustum=h.clone(),t.viewport=r}(this,e)};const jX=new X.A(Math.PI,J.A.PI_OVER_TWO),QX=new j.A,XX=new j.A,KX=new O.A,$X=new O.A,JX=new j.A,ZX=new j.A,eK=new c.A;function tK(e,t,n){const i=t._view,{renderTranslucentDepthForPick:o}=t._environmentState;e||(t.frameState.commandList.length=0),iK(t),i.createPotentiallyVisibleSet(t),e&&(GX(t),o||YX(t)),HX(t,n)}const nK=new YI.A;function iK(e){const t=e._frameState;e._groundPrimitives.update(t),e._primitives.update(t),function(e){const t=e._frameState;e.debugShowFrustumPlanes!==e._debugShowFrustumPlanes&&(e.debugShowFrustumPlanes?e._debugFrustumPlanes=new lF({camera:e.camera,updateOnChange:!1,frustumSplits:t.frustumSplits}):e._debugFrustumPlanes=e._debugFrustumPlanes&&e._debugFrustumPlanes.destroy(),e._debugShowFrustumPlanes=e.debugShowFrustumPlanes),(0,d.A)(e._debugFrustumPlanes)&&e._debugFrustumPlanes.update(t)}(e),function(e){const t=e._frameState,{passes:n,shadowState:i,shadowMaps:o}=t,r=o.length,s=r>0&&!n.pick&&!n.pickVoxel&&e.mode===Ce.A.SCENE3D;if(s!==i.shadowsEnabled&&(++i.lastDirtyTime,i.shadowsEnabled=s),i.lightShadowsEnabled=!1,s){for(let e=0;e<r;++e)if(o[e]!==i.shadowMaps[e]){++i.lastDirtyTime;break}i.shadowMaps.length=0,i.lightShadowMaps.length=0;for(let e=0;e<r;++e){const n=o[e];n.update(t),i.shadowMaps.push(n),n.fromLightSource&&(i.lightShadowMaps.push(n),i.lightShadowsEnabled=!0),n.dirty&&(++i.lastDirtyTime,n.dirty=!1)}}}(e),e._globe&&e._globe.render(t)}function oK(e,t,n){let i=Number.NEGATIVE_INFINITY;if(e instanceof Yl.A){const o=e.length;for(let r=0;r<o;++r){const o=oK(e.get(r),t,n);(0,d.A)(o)&&o>i&&(i=o)}}else if(e.isCesium3DTileset&&e.show&&e.enableCollision){const o=e.getHeight(t,n);if((0,d.A)(o)&&o>i)return o}return i}fX.prototype.updateEnvironment=function(){const e=this._frameState,t=this._view,n=this._environmentState,i=e.passes.render,o=e.passes.offscreen,r=this.atmosphere,s=this.skyAtmosphere,a=this.globe,c=this._globeTranslucencyState;if(!i||this._mode!==Ce.A.SCENE2D&&t.camera.frustum instanceof ee.A||!c.environmentVisible)n.skyAtmosphereCommand=void 0,n.skyBoxCommand=void 0,n.sunDrawCommand=void 0,n.sunComputeCommand=void 0,n.moonCommand=void 0;else{if((0,d.A)(s)){if((0,d.A)(a))s.setDynamicLighting(UF.A.fromGlobeFlags(a)),n.isReadyForAtmosphere=n.isReadyForAtmosphere||!a.show||a._surface._tilesToRender.length>0;else{const e=r.dynamicLighting;s.setDynamicLighting(e),n.isReadyForAtmosphere=!0}n.skyAtmosphereCommand=s.update(e,a),(0,d.A)(n.skyAtmosphereCommand)&&this.updateDerivedCommands(n.skyAtmosphereCommand)}else n.skyAtmosphereCommand=void 0;n.skyBoxCommand=(0,d.A)(this.skyBox)?this.skyBox.update(e,this._hdr):void 0;const i=(0,d.A)(this.sun)?this.sun.update(e,t.passState,this._hdr):void 0;n.sunDrawCommand=(0,d.A)(i)?i.drawCommand:void 0,n.sunComputeCommand=(0,d.A)(i)?i.computeCommand:void 0,n.moonCommand=(0,d.A)(this.moon)?this.moon.update(e):void 0}const l=n.clearGlobeDepth=(0,d.A)(a)&&a.show&&(!a.depthTestAgainstTerrain||this.mode===Ce.A.SCENE2D);(n.useDepthPlane=l&&this.mode===Ce.A.SCENE3D&&c.useDepthPlane)&&this._depthPlane.update(e),n.renderTranslucentDepthForPick=!1,n.useWebVR=this._useWebVR&&this.mode!==Ce.A.SCENE2D&&!o;const u=e.mode!==Ce.A.SCENE3D||c.sunVisibleThroughGlobe?void 0:e.occluder;let h=e.cullingVolume;const A=nK.planes;for(let e=0;e<5;++e)A[e]=h.planes[e];h=nK,n.isSkyAtmosphereVisible=(0,d.A)(n.skyAtmosphereCommand)&&n.isReadyForAtmosphere,n.isSunVisible=this.isVisible(h,n.sunDrawCommand,u),n.isMoonVisible=this.isVisible(h,n.moonCommand,u);const p=this.specularEnvironmentMaps;let f=this._specularEnvironmentCubeMap;(0,d.A)(p)&&f?.url!==p?(f=f&&f.destroy(),this._specularEnvironmentCubeMap=new sq.A(p)):!(0,d.A)(p)&&(0,d.A)(f)&&(f.destroy(),this._specularEnvironmentCubeMap=void 0),(0,d.A)(this._specularEnvironmentCubeMap)&&this._specularEnvironmentCubeMap.update(e)},fX.prototype.resolveFramebuffers=function(e){const t=this._context,n=this._environmentState,i=this._view,{globeDepth:o,translucentTileClassification:r}=i;(0,d.A)(o)&&o.prepareColorTextures(t);const{useOIT:s,useGlobeDepthFramebuffer:a,usePostProcess:c,originalFramebuffer:l}=n,u=a?o.colorFramebufferManager:void 0,h=i.sceneFramebuffer._colorFramebuffer,A=i.sceneFramebuffer.idFramebuffer;if(s&&(e.framebuffer=c?h.framebuffer:l,i.oit.execute(t,e)),r.hasTranslucentDepth&&r.isSupported()&&r.execute(this,e),c){i.sceneFramebuffer.prepareColorTextures(t);let e=h;a&&!s&&(e=u);const n=this.postProcessStages,o=e.getColorTexture(0),r=A.getColorTexture(0),c=(u??h).getDepthStencilTexture();n.execute(t,o,c,r),n.copy(t,l)}s||c||!a||(e.framebuffer=l,o.executeCopyColor(t,e))},fX.prototype.getHeight=function(e,t){if(!(0,d.A)(e))return;const n=t===Vt.Ay.CLAMP_TO_TERRAIN||t===Vt.Ay.RELATIVE_TO_TERRAIN,i=t===Vt.Ay.CLAMP_TO_3D_TILE||t===Vt.Ay.RELATIVE_TO_3D_TILE;if(!(0,d.A)(e))return;let o=Number.NEGATIVE_INFINITY;if(!n){const t=oK(this.primitives,e,this);(0,d.A)(t)&&t>o&&(o=t)}const r=this._globe;if(!i&&(0,d.A)(r)&&r.show){const t=r.getHeight(e);t>o&&(o=t)}return o>Number.NEGATIVE_INFINITY?o:void 0};const rK=new X.A;function sK(e){e._jobScheduler.resetBudgets();const t=e._frameState;e.primitives.prePassesUpdate(t),(0,d.A)(e.globe)&&e.globe.update(t),e._picking.update(),t.creditDisplay.update()}function aK(e){e.primitives.postPassesUpdate(e._frameState),vR.A.update()}fX.prototype.updateHeight=function(e,t,n){l.A.typeOf.func("callback",t);const i=this._ellipsoid,o=i=>{let o;X.A.clone(e,rK),(0,d.A)(i)&&(o=i.height),(0,d.A)(o)||(o=this.getHeight(e,n)),(0,d.A)(o)&&(rK.height=o,t(rK))},r=n===Vt.Ay.CLAMP_TO_TERRAIN||n===Vt.Ay.RELATIVE_TO_TERRAIN;let s;n!==Vt.Ay.CLAMP_TO_3D_TILE&&n!==Vt.Ay.RELATIVE_TO_3D_TILE&&(0,d.A)(this.globe)&&(s=this.globe._surface.updateHeight(e,o));let a={};const c=t=>{if(r||t.isDestroyed()||!t.isCesium3DTileset)return;const n=t.updateHeight(e,o,i);a[t.id]=n};if(!r){const e=this.primitives.length;for(let t=0;t<e;++t)c(this.primitives.get(t))}const u=this.primitives.primitiveAdded.addEventListener(c),h=this.primitives.primitiveRemoved.addEventListener(e=>{!e.isDestroyed()&&e.isCesium3DTileset&&((0,d.A)(a[e.id])&&a[e.id](),delete a[e.id])});return()=>{s=s&&s(),Object.values(a).forEach(e=>e()),a={},u(),h()}},fX.prototype.initializeFrame=function(){if(120===this._shaderFrameCount++&&(this._shaderFrameCount=0,this._context.shaderCache.destroyReleasedShaderPrograms(),this._context.textureCache.destroyReleasedTextures()),this._tweens.update(),this._globeHeightDirty){(0,d.A)(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),this._globeHeight=function(e){if(e.mode===Ce.A.MORPHING)return;const t=e.camera.positionCartographic;return e.getHeight(t)}(this),this._globeHeightDirty=!1;const e=this.camera.positionCartographic;this._removeUpdateHeightCallback=this.updateHeight(e,e=>{this.isDestroyed()||(this._globeHeight=e.height)})}this._cameraUnderground=function(e){const t=e.camera,n=e._mode,i=e._screenSpaceCameraController,o=t.positionCartographic;if(!(0,d.A)(o))return!1;if(!i.onMap()&&o.height<0)return!0;if(n===Ce.A.SCENE2D||n===Ce.A.MORPHING)return!1;const r=e._globeHeight;return(0,d.A)(r)&&o.height<r}(this),this._globeTranslucencyState.update(this),this._screenSpaceCameraController.update(),(0,d.A)(this._deviceOrientationCameraController)&&this._deviceOrientationCameraController.update(),this.camera.update(this._mode),this.camera._updateCameraChanged()};const cK=new u.A;function lK(e){const t=e._frameState,n=e.context,{uniformState:i}=n,o=e._defaultView;e._view=o,e.updateFrameState(),t.passes.render=!0,t.passes.postProcess=e.postProcessStages.hasSelected,t.tilesetPassState=gX;let r=e.backgroundColor??u.A.BLACK;e._hdr&&(r=u.A.clone(r,cK),r.red=Math.pow(r.red,e.gamma),r.green=Math.pow(r.green,e.gamma),r.blue=Math.pow(r.blue,e.gamma)),t.backgroundColor=r,t.atmosphere=e.atmosphere,e.fog.update(t),i.update(t);const s=e.shadowMap;(0,d.A)(s)&&s.enabled&&(!(0,d.A)(e.light)||e.light instanceof Ee.A?j.A.negate(i.sunDirectionWC,e._shadowMapCamera.direction):j.A.clone(e.light.direction,e._shadowMapCamera.direction),t.shadowMaps.push(s)),e._computeCommandList.length=0,e._overlayCommandList.length=0;const a=o.viewport;a.x=0,a.y=0,a.width=n.drawingBufferWidth,a.height=n.drawingBufferHeight;const l=o.passState;l.framebuffer=void 0,l.blendingEnabled=void 0,l.scissorTest=void 0,l.viewport=c.A.clone(a,l.viewport),n.beginFrame(),(0,d.A)(e.globe)&&e.globe.beginFrame(t),e.updateEnvironment(),e.updateAndExecuteCommands(l,r),e.resolveFramebuffers(l),l.framebuffer=void 0,function(e,t){e.context.uniformState.updatePass(ut.A.OVERLAY);const n=e.context,i=e._overlayCommandList;for(let e=0;e<i.length;++e)i[e].execute(n,t)}(e,l),(0,d.A)(e.globe)&&(e.globe.endFrame(t),e.globe.tilesLoaded||(e._renderRequested=!0)),n.endFrame()}function uK(e,t){try{t(e)}catch(t){if(e._renderError.raiseEvent(e,t),e.rethrowRenderErrors)throw t}}function dK(e){return e._picking.updateMostDetailedRayPicks(e)}function hK(e){const t=e._frameState;_X.camera=t.camera,_X.cullingVolume=t.cullingVolume,e.primitives.updateForPass(t,_X)}function AK(e){const t=e._frameState;t.camera.canPreloadFlight()&&(yX.camera=e.preloadFlightCamera,yX.cullingVolume=e.preloadFlightCullingVolume,e.primitives.updateForPass(t,yX))}function pK(e){e.primitives.updateForPass(e._frameState,vX)}fX.prototype.render=function(e){this._preUpdate.raiseEvent(this,e);const t=this._frameState;t.newFrame=!1,(0,d.A)(e)||(e=te.A.now());const n=this._view.checkForCameraUpdates(this);n&&(this._globeHeightDirty=!0);let i=!this.requestRenderMode||this._renderRequested||n||this._logDepthBufferDirty||this._hdrDirty||this.mode===Ce.A.MORPHING;if(!i&&(0,d.A)(this.maximumRenderTimeChange)&&(0,d.A)(this._lastRenderTime)){const t=Math.abs(te.A.secondsDifference(this._lastRenderTime,e));i=i||t>this.maximumRenderTimeChange}i&&(this._lastRenderTime=te.A.clone(e,this._lastRenderTime),this._renderRequested=!1,this._logDepthBufferDirty=!1,this._hdrDirty=!1,wX(this,J.A.incrementWrap(t.frameNumber,15e6,1),e),t.newFrame=!0),uK(this,sK),this.primitives.show&&(uK(this,dK),uK(this,hK),uK(this,AK),i||uK(this,pK)),this._postUpdate.raiseEvent(this,e),i&&(this._preRender.raiseEvent(this,e),t.creditDisplay.beginFrame(),uK(this,lK)),function(e,t){if(e.debugShowFramesPerSecond){if(!(0,d.A)(e._performanceDisplay)){const t=document.createElement("div");t.className="cesium-performanceDisplay-defaultContainer",e._canvas.parentNode.appendChild(t);const n=new zU({container:t});e._performanceDisplay=n,e._performanceContainer=t}e._performanceDisplay.throttled=e.requestRenderMode,e._performanceDisplay.update(t)}else(0,d.A)(e._performanceDisplay)&&(e._performanceDisplay=e._performanceDisplay&&e._performanceDisplay.destroy(),e._performanceContainer.parentNode.removeChild(e._performanceContainer))}(this,i),uK(this,aK),function(e){const t=e._frameState.afterRender;for(let n=0;n<t.length;++n)t[n]()&&e.requestRender();t.length=0}(this),i&&(this._postRender.raiseEvent(this,e),t.creditDisplay.endFrame())},fX.prototype.forceRender=function(e){this._renderRequested=!0,this.render(e)},fX.prototype.requestRender=function(){this._renderRequested=!0},fX.prototype.clampLineWidth=function(e){return Math.max(N.A.minimumAliasedLineWidth,Math.min(e,N.A.maximumAliasedLineWidth))},fX.prototype.pick=function(e,t,n){return this._picking.pick(this,e,t,n)},fX.prototype.pickVoxel=function(e,t,n){const i=this.pick(e,t,n);if(!(0,d.A)(i))return;const o=i.primitive;if(!(o instanceof uX))return;const r=this._picking.pickVoxelCoordinate(this,e,t,n),s=255*r[0]+r[1],a=o._traversal.findKeyframeNode(s);if(!(0,d.A)(a))return;const c=255*r[2]+r[3];return bq.fromKeyframeNode(o,s,c,a)},fX.prototype.pickMetadata=function(e,t,n,i){l.A.typeOf.object("windowPosition",e),l.A.typeOf.string("className",n),l.A.typeOf.string("propertyName",i);const o=this.pick(e);if(!(0,d.A)(o))return;const r=o.detail?.model?.structuralMetadata;if(!(0,d.A)(r))return;const s=r.schema,a=dX(s,t,n,i);if(!(0,d.A)(a))return;const c=AX(r,n,i);if(!(0,d.A)(c))return;const u=new hX(t,n,i,a,c);return this._picking.pickMetadata(this,e,u)},fX.prototype.pickMetadataSchema=function(e){l.A.typeOf.object("windowPosition",e);const t=this.pick(e);if(!(0,d.A)(t))return;const n=t.detail?.model?.structuralMetadata?.schema;return n},fX.prototype.pickPositionWorldCoordinates=function(e,t){return this._picking.pickPositionWorldCoordinates(this,e,t)},fX.prototype.pickPosition=function(e,t){return this._picking.pickPosition(this,e,t)},fX.prototype.drillPick=function(e,t,n,i){return this._picking.drillPick(this,e,t,n,i)},fX.prototype.pickFromRay=function(e,t,n){return this._picking.pickFromRay(this,e,t,n)},fX.prototype.drillPickFromRay=function(e,t,n,i){return this._picking.drillPickFromRay(this,e,t,n,i)},fX.prototype.pickFromRayMostDetailed=function(e,t,n){return this._picking.pickFromRayMostDetailed(this,e,t,n)},fX.prototype.drillPickFromRayMostDetailed=function(e,t,n,i){return this._picking.drillPickFromRayMostDetailed(this,e,t,n,i)},fX.prototype.sampleHeight=function(e,t,n){return this._picking.sampleHeight(this,e,t,n)},fX.prototype.clampToHeight=function(e,t,n,i){return this._picking.clampToHeight(this,e,t,n,i)},fX.prototype.sampleHeightMostDetailed=function(e,t,n){return this._picking.sampleHeightMostDetailed(this,e,t,n)},fX.prototype.clampToHeightMostDetailed=function(e,t,n){return this._picking.clampToHeightMostDetailed(this,e,t,n)},fX.prototype.cartesianToCanvasCoordinates=function(e,t){return KU.A.worldToWindowCoordinates(this,e,t)},fX.prototype.completeMorph=function(){this._transitioner.completeMorph()},fX.prototype.morphTo2D=function(e){e=e??2,this._transitioner.morphTo2D(e,this._ellipsoid)},fX.prototype.morphToColumbusView=function(e){e=e??2,this._transitioner.morphToColumbusView(e,this._ellipsoid)},fX.prototype.morphTo3D=function(e){e=e??2,this._transitioner.morphTo3D(e,this._ellipsoid)},fX.prototype.setTerrain=function(e){return l.A.typeOf.object("terrain",e),function(e,t){e._removeTerrainProviderReadyListener=e._removeTerrainProviderReadyListener&&e._removeTerrainProviderReadyListener(),t.ready?(0,d.A)(e.globe)&&(e.globe.terrainProvider=t.provider):(e.globe.terrainProvider=void 0,e._removeTerrainProviderReadyListener=t.readyEvent.addEventListener(t=>{(0,d.A)(e)&&(0,d.A)(e.globe)&&(e.globe.terrainProvider=t),e._removeTerrainProviderReadyListener()}))}(this,e),e},fX.prototype.isDestroyed=function(){return!1},fX.prototype.destroy=function(){this._tweens.removeAll(),this._computeEngine=this._computeEngine&&this._computeEngine.destroy(),this._screenSpaceCameraController=this._screenSpaceCameraController&&this._screenSpaceCameraController.destroy(),this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this._primitives=this._primitives&&this._primitives.destroy(),this._groundPrimitives=this._groundPrimitives&&this._groundPrimitives.destroy(),this._globe=this._globe&&this._globe.destroy(),this._removeTerrainProviderReadyListener=this._removeTerrainProviderReadyListener&&this._removeTerrainProviderReadyListener(),this.skyBox=this.skyBox&&this.skyBox.destroy(),this.skyAtmosphere=this.skyAtmosphere&&this.skyAtmosphere.destroy(),this._debugSphere=this._debugSphere&&this._debugSphere.destroy(),this.sun=this.sun&&this.sun.destroy(),this._sunPostProcess=this._sunPostProcess&&this._sunPostProcess.destroy(),this._depthPlane=this._depthPlane&&this._depthPlane.destroy(),this._transitioner=this._transitioner&&this._transitioner.destroy(),this._debugFrustumPlanes=this._debugFrustumPlanes&&this._debugFrustumPlanes.destroy(),this._brdfLutGenerator=this._brdfLutGenerator&&this._brdfLutGenerator.destroy(),this._picking=this._picking&&this._picking.destroy(),this._defaultView=this._defaultView&&this._defaultView.destroy(),this._view=void 0,this._removeCreditContainer&&this._canvas.parentNode.removeChild(this._creditContainer),this.postProcessStages=this.postProcessStages&&this.postProcessStages.destroy(),this._context=this._context&&this._context.destroy(),this._frameState.creditDisplay=this._frameState.creditDisplay&&this._frameState.creditDisplay.destroy(),(0,d.A)(this._performanceDisplay)&&(this._performanceDisplay=this._performanceDisplay&&this._performanceDisplay.destroy(),this._performanceContainer.parentNode.removeChild(this._performanceContainer)),this._removeRequestListenerCallback(),this._removeTaskProcessorListenerCallback();for(let e=0;e<this._removeGlobeCallbacks.length;++e)this._removeGlobeCallbacks[e]();return this._removeGlobeCallbacks.length=0,(0,d.A)(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),(0,h.A)(this)};const fK=fX;var mK=n(320475);function gK(e){e=e??K.A.WGS84,this.show=!0,this.perFragmentAtmosphere=!1,this._ellipsoid=e;const t=j.A.multiplyByScalar(e.radii,1.025,new j.A);this._scaleMatrix=O.A.fromScale(t),this._modelMatrix=new O.A,this._command=new m.A({owner:this,modelMatrix:this._modelMatrix}),this._spSkyFromSpace=void 0,this._spSkyFromAtmosphere=void 0,this._flags=void 0,this.atmosphereLightIntensity=50,this.atmosphereRayleighCoefficient=new j.A(55e-7,13e-6,284e-7),this.atmosphereMieCoefficient=new j.A(21e-6,21e-6,21e-6),this.atmosphereRayleighScaleHeight=1e4,this.atmosphereMieScaleHeight=3200,this.atmosphereMieAnisotropy=.9,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this._hueSaturationBrightness=new j.A;const n=new j.A;n.x=1.025*e.maximumRadius,n.y=e.maximumRadius,n.z=0,this._radiiAndDynamicAtmosphereColor=n;const i=this;this._command.uniformMap={u_radiiAndDynamicAtmosphereColor:function(){return i._radiiAndDynamicAtmosphereColor},u_hsbShift:function(){return i._hueSaturationBrightness.x=i.hueShift,i._hueSaturationBrightness.y=i.saturationShift,i._hueSaturationBrightness.z=i.brightnessShift,i._hueSaturationBrightness},u_atmosphereLightIntensity:function(){return i.atmosphereLightIntensity},u_atmosphereRayleighCoefficient:function(){return i.atmosphereRayleighCoefficient},u_atmosphereMieCoefficient:function(){return i.atmosphereMieCoefficient},u_atmosphereRayleighScaleHeight:function(){return i.atmosphereRayleighScaleHeight},u_atmosphereMieScaleHeight:function(){return i.atmosphereMieScaleHeight},u_atmosphereMieAnisotropy:function(){return i.atmosphereMieAnisotropy}}}Object.defineProperties(gK.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),gK.prototype.setDynamicLighting=function(e){this._radiiAndDynamicAtmosphereColor.z=e};const _K=new O.A;gK.prototype.update=function(e,t){if(!this.show)return;const n=e.mode;if(n!==Ce.A.SCENE3D&&n!==Ce.A.MORPHING)return;if(!e.passes.render)return;const i=O.A.fromRotationTranslation(e.context.uniformState.inverseViewRotation,j.A.ZERO,_K),o=O.A.multiplyTransformation(i,mK.A.Y_UP_TO_Z_UP,_K),s=O.A.multiply(this._scaleMatrix,o,_K);O.A.clone(s,this._modelMatrix);const a=e.context,c=(l=this,!(J.A.equalsEpsilon(l.hueShift,0,J.A.EPSILON7)&&J.A.equalsEpsilon(l.saturationShift,0,J.A.EPSILON7)&&J.A.equalsEpsilon(l.brightnessShift,0,J.A.EPSILON7)));var l;const u=e.globeTranslucencyState.translucent,h=this.perFragmentAtmosphere||u||!(0,d.A)(t)||!t.show,A=this._command;if(!(0,d.A)(A.vertexArray)){const e=Pu.createGeometry(new Pu({radii:new j.A(1,1,1),slicePartitions:256,stackPartitions:256,vertexFormat:Rr.A.POSITION_ONLY}));A.vertexArray=je.A.fromGeometry({context:a,geometry:e,attributeLocations:Ad.A.createAttributeLocations(e),bufferUsage:r.A.STATIC_DRAW}),A.renderState=_.A.fromCache({cull:{enabled:!0,face:CB.A.FRONT},blending:$M.A.ALPHA_BLEND,depthMask:!1})}const p=c|h<<2|u<<3;if(p!==this._flags){this._flags=p;const e=[];c&&e.push("COLOR_CORRECT"),h&&e.push("PER_FRAGMENT_ATMOSPHERE"),u&&e.push("GLOBE_TRANSLUCENT");const t=new k.A({defines:e,sources:[nS.A,zS,GS]}),n=new k.A({defines:e,sources:[nS.A,zS,HS]});this._spSkyAtmosphere=y.A.fromCache({context:a,vertexShaderSource:t,fragmentShaderSource:n}),A.shaderProgram=this._spSkyAtmosphere}return A},gK.prototype.isDestroyed=function(){return!1},gK.prototype.destroy=function(){const e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),this._spSkyAtmosphere=this._spSkyAtmosphere&&this._spSkyAtmosphere.destroy(),(0,h.A)(this)};const yK=gK;function vK(e){this.sources=e.sources,this._sources=void 0,this.show=e.show??!0,this._command=new m.A({modelMatrix:O.A.clone(O.A.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0,this._hasError=!1,this._error=void 0}function TK(e){return(0,yv.A)(`Assets/Textures/SkyBox/tycho2t3_80_${e}.jpg`)}vK.prototype.update=function(e,t){const n=this,{mode:i,passes:o,context:s}=e;if(!this.show)return;if(i!==Ce.A.SCENE3D&&i!==Ce.A.MORPHING)return;if(!o.render)return;if(this._hasError){const e=this._error;throw this._hasError=!1,this._error=void 0,e}if(this._sources!==this.sources){this._sources=this.sources;const e=this.sources;if(l.A.defined("this.sources",e),Object.values(B.A.FaceName).some(t=>!(0,d.A)(e[t])))throw new A.A("this.sources must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");const t=typeof e.positiveX;if(Object.values(B.A.FaceName).some(n=>typeof e[n]!==t))throw new A.A("this.sources properties must all be the same type.");"string"==typeof e.positiveX?Nt(s,this._sources).then(function(e){n._cubeMap=n._cubeMap&&n._cubeMap.destroy(),n._cubeMap=e}).catch(e=>{this._hasError=!0,this._error=e}):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new B.A({context:s,source:e}))}const a=this._command;if(!(0,d.A)(a.vertexArray)){a.uniformMap={u_cubeMap:function(){return n._cubeMap}};const e=pn.A.createGeometry(pn.A.fromDimensions({dimensions:new j.A(2,2,2),vertexFormat:Rr.A.POSITION_ONLY})),t=this._attributeLocations=Ad.A.createAttributeLocations(e);a.vertexArray=je.A.fromGeometry({context:s,geometry:e,attributeLocations:t,bufferUsage:r.A.STATIC_DRAW}),a.renderState=_.A.fromCache({blending:$M.A.ALPHA_BLEND})}if(!(0,d.A)(a.shaderProgram)||this._useHdr!==t){const e=new k.A({defines:[t?"HDR":""],sources:[WS]});a.shaderProgram=y.A.fromCache({context:s,vertexShaderSource:YS,fragmentShaderSource:e,attributeLocations:this._attributeLocations}),this._useHdr=t}return(0,d.A)(this._cubeMap)?a:void 0},vK.prototype.isDestroyed=function(){return!1},vK.prototype.destroy=function(){const e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),(0,h.A)(this)},vK.createEarthSkyBox=function(){return new vK({sources:{positiveX:TK("px"),negativeX:TK("mx"),positiveY:TK("py"),negativeY:TK("my"),positiveZ:TK("pz"),negativeZ:TK("mz")}})};const bK=vK;function wK(){this.show=!0,this._drawCommand=new m.A({primitiveType:p.A.TRIANGLES,boundingVolume:new Sn.A,owner:this}),this._commands={drawCommand:this._drawCommand,computeCommand:void 0},this._boundingVolume=new Sn.A,this._boundingVolume2D=new Sn.A,this._texture=void 0,this._drawingBufferWidth=void 0,this._drawingBufferHeight=void 0,this._radiusTS=void 0,this._size=void 0,this.glowFactor=1,this._glowFactorDirty=!1,this._useHdr=void 0;const e=this;this._uniformMap={u_texture:function(){return e._texture},u_size:function(){return e._size}}}Object.defineProperties(wK.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(e){e=Math.max(e,0),this._glowFactor=e,this._glowFactorDirty=!0}}});const xK=new q.A,CK=new q.A,EK=new Q.A,SK=new Q.A;wK.prototype.update=function(e,t,n){if(!this.show)return;const i=e.mode;if(i===Ce.A.SCENE2D||i===Ce.A.MORPHING)return;if(!e.passes.render)return;const s=e.context,c=t.viewport.width,l=t.viewport.height;if(!(0,d.A)(this._texture)||c!==this._drawingBufferWidth||l!==this._drawingBufferHeight||this._glowFactorDirty||n!==this._useHdr){this._texture=this._texture&&this._texture.destroy(),this._drawingBufferWidth=c,this._drawingBufferHeight=l,this._glowFactorDirty=!1,this._useHdr=n;let e=Math.max(c,l);e=Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))-2),e=Math.max(1,e);const t=n?s.halfFloatingPointTexture?U.A.HALF_FLOAT:U.A.FLOAT:U.A.UNSIGNED_BYTE;this._texture=new G.A({context:s,width:e,height:e,pixelFormat:R.A.RGBA,pixelDatatype:t}),this._glowLengthTS=5*this._glowFactor,this._radiusTS=1/(1+2*this._glowLengthTS)*.5;const i=this,o={u_radiusTS:function(){return i._radiusTS}};this._commands.computeCommand=new a.A({fragmentShaderSource:jS,outputTexture:this._texture,uniformMap:o,persists:!1,owner:this,postExecute:function(){i._commands.computeCommand=void 0}})}const u=this._drawCommand;if(!(0,d.A)(u.vertexArray)){const e={direction:0},t=new Uint8Array(8);t[0]=0,t[1]=0,t[2]=255,t[3]=0,t[4]=255,t[5]=255,t[6]=0,t[7]=255;const n=o.A.createVertexBuffer({context:s,typedArray:t,usage:r.A.STATIC_DRAW}),i=[{index:e.direction,vertexBuffer:n,componentsPerAttribute:2,normalize:!0,componentDatatype:C.A.UNSIGNED_BYTE}],a=o.A.createIndexBuffer({context:s,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:r.A.STATIC_DRAW,indexDatatype:Pr.A.UNSIGNED_SHORT});u.vertexArray=new je.A({context:s,attributes:i,indexBuffer:a}),u.shaderProgram=y.A.fromCache({context:s,vertexShaderSource:QS,fragmentShaderSource:qS,attributeLocations:e}),u.renderState=_.A.fromCache({blending:$M.A.ALPHA_BLEND}),u.uniformMap=this._uniformMap}const h=s.uniformState.sunPositionWC,A=s.uniformState.sunPositionColumbusView,p=this._boundingVolume,f=this._boundingVolume2D;j.A.clone(h,p.center),f.center.x=A.z,f.center.y=A.x,f.center.z=A.y,p.radius=J.A.SOLAR_RADIUS+J.A.SOLAR_RADIUS*this._glowLengthTS,f.radius=p.radius,i===Ce.A.SCENE3D?Sn.A.clone(p,u.boundingVolume):i===Ce.A.COLUMBUS_VIEW&&Sn.A.clone(f,u.boundingVolume);const m=KU.A.computeActualEllipsoidPosition(e,h,SK),g=j.A.magnitude(j.A.subtract(m,e.camera.position,SK)),v=s.uniformState.projection,T=EK;T.x=0,T.y=0,T.z=-g,T.w=1;const b=O.A.multiplyByVector(v,T,SK),w=KU.A.clipToGLWindowCoordinates(t.viewport,b,xK);T.x=J.A.SOLAR_RADIUS;const x=O.A.multiplyByVector(v,T,SK),E=KU.A.clipToGLWindowCoordinates(t.viewport,x,CK);return this._size=q.A.magnitude(q.A.subtract(E,w,SK)),this._size=2*this._size*(1+2*this._glowLengthTS),this._size=Math.ceil(this._size),this._commands},wK.prototype.isDestroyed=function(){return!1},wK.prototype.destroy=function(){const e=this._drawCommand;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._texture=this._texture&&this._texture.destroy(),(0,h.A)(this)};const IK=wK;var PK=n(393682),DK=n(184483),OK=n(445848);const RK=function(e,t,n){return l.A.typeOf.string("samplerUniformName",e),l.A.typeOf.string("matrixUniformName",t),l.A.typeOf.string("styleUniformName",n),`    float clipDistance = clip(gl_FragCoord, ${e}, ${t}); \n    vec4 clippingPlanesEdgeColor = vec4(1.0); \n    clippingPlanesEdgeColor.rgb = ${n}.rgb; \n    float clippingPlanesEdgeWidth = ${n}.a; \n    if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) \n    { \n        out_FragColor = clippingPlanesEdgeColor;\n    } \n`};var MK=n(679854);const LK={modifyFragmentShader:function(e){return(e=k.A.replaceMain(e,"czm_splitter_main"))+"uniform float czm_splitDirection; \nvoid main() \n{ \n#ifndef SHADOW_MAP\n    if (czm_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard; \n    if (czm_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard; \n#endif\n    czm_splitter_main(); \n} \n"},addUniforms:function(e,t){t.czm_splitDirection=function(){return e.splitDirection}}};function NK(e){l.A.typeOf.object("options",e),l.A.typeOf.object("options.arrayBuffer",e.arrayBuffer),this._parsedContent=void 0,this._drawCommand=void 0,this._isTranslucent=!1,this._styleTranslucent=!1,this._constantColor=u.A.clone(u.A.DARKGRAY),this._highlightColor=u.A.clone(u.A.WHITE),this._pointSize=1,this._rtcCenter=void 0,this._quantizedVolumeScale=void 0,this._quantizedVolumeOffset=void 0,this._styleableShaderAttributes=void 0,this._isQuantized=!1,this._isOctEncoded16P=!1,this._isRGB565=!1,this._hasColors=!1,this._hasNormals=!1,this._hasBatchIds=!1,this._decodingState=2,this._dequantizeInShader=!0,this._isQuantizedDraco=!1,this._isOctEncodedDraco=!1,this._quantizedRange=0,this._octEncodedRange=0,this.backFaceCulling=!1,this._backFaceCulling=!1,this.normalShading=!0,this._normalShading=!0,this._opaqueRenderState=void 0,this._translucentRenderState=void 0,this._mode=void 0,this._ready=!1,this._pointsLength=0,this._geometryByteLength=0,this._vertexShaderLoaded=e.vertexShaderLoaded,this._fragmentShaderLoaded=e.fragmentShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._batchTableLoaded=e.batchTableLoaded,this._pickIdLoaded=e.pickIdLoaded,this._opaquePass=e.opaquePass??ut.A.OPAQUE,this._cull=e.cull??!0,this.style=void 0,this._style=void 0,this.styleDirty=!1,this.modelMatrix=O.A.clone(O.A.IDENTITY),this._modelMatrix=O.A.clone(O.A.IDENTITY),this.time=0,this.shadows=kn.A.ENABLED,this._boundingSphere=void 0,this.clippingPlanes=void 0,this.isClipped=!1,this.clippingPlanesDirty=!1,this.clippingPlanesOriginMatrix=void 0,this.attenuation=!1,this._attenuation=!1,this.geometricError=0,this.geometricErrorScale=1,this.maximumAttenuation=this._pointSize,this.splitDirection=e.splitDirection??Yt.A.NONE,this._splittingEnabled=!1,this._error=void 0,function(e,t){const n=MK.A.parse(t.arrayBuffer,t.byteOffset);if(e._parsedContent=n,e._rtcCenter=n.rtcCenter,e._hasNormals=n.hasNormals,e._hasColors=n.hasColors,e._hasBatchIds=n.hasBatchIds,e._isTranslucent=n.isTranslucent,!n.hasBatchIds&&(0,d.A)(n.batchTableBinary)&&(n.styleableProperties=DK.A.getBinaryProperties(n.pointsLength,n.batchTableJson,n.batchTableBinary)),(0,d.A)(n.draco)){const t=n.draco;e._decodingState=0,t.dequantizeInShader=e._dequantizeInShader}const i=n.positions;(0,d.A)(i)&&(e._isQuantized=i.isQuantized,e._quantizedVolumeScale=i.quantizedVolumeScale,e._quantizedVolumeOffset=i.quantizedVolumeOffset,e._quantizedRange=i.quantizedRange);const o=n.normals;(0,d.A)(o)&&(e._isOctEncoded16P=o.octEncoded);const r=n.colors;(0,d.A)(r)&&((0,d.A)(r.constantColor)&&(e._constantColor=u.A.clone(r.constantColor,e._constantColor),e._hasColors=!1),e._isRGB565=r.isRGB565);const s=n.batchIds;(0,d.A)(n.batchIds)&&(s.name="BATCH_ID",s.semantic="BATCH_ID",s.setIndex=void 0),n.hasBatchIds&&e._batchTableLoaded(n.batchLength,n.batchTableJson,n.batchTableBinary),e._pointsLength=n.pointsLength}(this,e)}Object.defineProperties(NK.prototype,{pointsLength:{get:function(){return this._pointsLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}},color:{get:function(){return u.A.clone(this._highlightColor)},set:function(e){this._highlightColor=u.A.clone(e,this._highlightColor)}},boundingSphere:{get:function(){if((0,d.A)(this._drawCommand))return this._drawCommand.boundingVolume},set:function(e){this._boundingSphere=Sn.A.clone(e,this._boundingSphere)}}});const BK=new j.A,FK=new j.A,UK=new j.A;let kK,VK;function zK(e){if(!(0,d.A)(VK)){kK=new PK(0),VK=new Array(e);for(let t=0;t<e;++t)VK[t]=kK.random()}return VK}function HK(e,t){const n=C.A.fromTypedArray(e);return n===C.A.INT||n===C.A.UNSIGNED_INT||n===C.A.DOUBLE?((0,Fn.A)("Cast pnts property to floats",`Point cloud property "${t}" will be cast to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.`),new Float32Array(e)):e}const GK=new Q.A,WK=new Q.A,YK=new u.A,qK=new O.A,jK=new O.A;function QK(e,t){const n=/czm_3dtiles_property_(\d+)/g;let i=n.exec(e);for(;null!==i;){const o=parseInt(i[1]);-1===t.indexOf(o)&&t.push(o),i=n.exec(e)}}function XK(e,t){e=e.slice(e.indexOf("\n"));const n=/czm_3dtiles_builtin_property_(\w+)/g;let i=n.exec(e);for(;null!==i;){const o=i[1];-1===t.indexOf(o)&&t.push(o),i=n.exec(e)}}function KK(e,t){const n=e.numberOfAttributes;for(let i=0;i<n;++i){const n=e.getAttribute(i);if(n.index===t)return n}}const $K={POSITION:"czm_3dtiles_builtin_property_POSITION",POSITION_ABSOLUTE:"czm_3dtiles_builtin_property_POSITION_ABSOLUTE",COLOR:"czm_3dtiles_builtin_property_COLOR",NORMAL:"czm_3dtiles_builtin_property_NORMAL"};const JK=new Q.A,ZK=new j.A;NK.prototype.update=function(e){const t=e.context;if((0,d.A)(this._error)){const e=this._error;throw this._error=void 0,e}const n=function(e,t){if(2===e._decodingState)return!1;if(0===e._decodingState){const n=e._parsedContent,i=n.draco,o=OK.A.decodePointCloud(i,t);(0,d.A)(o)&&(e._decodingState=1,o.then(function(t){e._decodingState=2;const o=(0,d.A)(t.POSITION)?t.POSITION.array:void 0,r=(0,d.A)(t.RGB)?t.RGB.array:void 0,s=(0,d.A)(t.RGBA)?t.RGBA.array:void 0,a=(0,d.A)(t.NORMAL)?t.NORMAL.array:void 0,c=(0,d.A)(t.BATCH_ID)?t.BATCH_ID.array:void 0,l=(0,d.A)(o)&&(0,d.A)(t.POSITION.data.quantization),u=(0,d.A)(a)&&(0,d.A)(t.NORMAL.data.quantization);if(l){const n=t.POSITION.data.quantization,i=n.range;e._quantizedVolumeScale=j.A.fromElements(i,i,i),e._quantizedVolumeOffset=j.A.unpack(n.minValues),e._quantizedRange=(1<<n.quantizationBits)-1,e._isQuantizedDraco=!0}u&&(e._octEncodedRange=(1<<t.NORMAL.data.quantization.quantizationBits)-1,e._isOctEncodedDraco=!0);let h=n.styleableProperties;const A=i.batchTableProperties;for(const e in A)if(A.hasOwnProperty(e)){const n=t[e];(0,d.A)(h)||(h={}),h[e]={typedArray:n.array,componentCount:n.data.componentsPerAttribute}}(0,d.A)(o)&&(n.positions={typedArray:o});const p=s??r;(0,d.A)(p)&&(n.colors={typedArray:p}),(0,d.A)(a)&&(n.normals={typedArray:a}),(0,d.A)(c)&&(n.batchIds={typedArray:c}),n.styleableProperties=h}).catch(function(t){e._decodingState=3,e._error=t}))}return!0}(this,t);if(n)return;let i=!1,s=!O.A.equals(this._modelMatrix,this.modelMatrix);if(this._mode!==e.mode&&(this._mode=e.mode,s=!0),(0,d.A)(this._drawCommand)||(function(e,t){const n=t.context,i=e._parsedContent,s=e._pointsLength,a=i.positions,c=i.colors,l=i.normals,u=i.batchIds,h=i.styleableProperties,A=(0,d.A)(h),f=e._isQuantized,g=e._isQuantizedDraco,y=e._isOctEncoded16P,v=e._isOctEncodedDraco,T=e._quantizedRange,b=e._octEncodedRange,w=e._isRGB565,x=e._isTranslucent,E=e._hasColors,S=e._hasNormals,I=e._hasBatchIds;let P,D;const R=[],M={};if(e._styleableShaderAttributes=M,A){let t=4;for(const i in h)if(h.hasOwnProperty(i)){const s=h[i],a=HK(s.typedArray,i);P=s.componentCount,D=C.A.fromTypedArray(a);const c=o.A.createVertexBuffer({context:n,typedArray:a,usage:r.A.STATIC_DRAW});e._geometryByteLength+=c.sizeInBytes;const l={index:t,vertexBuffer:c,componentsPerAttribute:P,componentDatatype:D,normalize:!1,offsetInBytes:0,strideInBytes:0};R.push(l),M[i]={location:t,componentCount:P},++t}}const L=o.A.createVertexBuffer({context:n,typedArray:a.typedArray,usage:r.A.STATIC_DRAW});let N,B,F;e._geometryByteLength+=L.sizeInBytes,E&&(N=o.A.createVertexBuffer({context:n,typedArray:c.typedArray,usage:r.A.STATIC_DRAW}),e._geometryByteLength+=N.sizeInBytes),S&&(B=o.A.createVertexBuffer({context:n,typedArray:l.typedArray,usage:r.A.STATIC_DRAW}),e._geometryByteLength+=B.sizeInBytes),I&&(u.typedArray=HK(u.typedArray,"batchIds"),F=o.A.createVertexBuffer({context:n,typedArray:u.typedArray,usage:r.A.STATIC_DRAW}),e._geometryByteLength+=F.sizeInBytes);let U=[];if(D=f?C.A.UNSIGNED_SHORT:g?T<=255?C.A.UNSIGNED_BYTE:C.A.UNSIGNED_SHORT:C.A.FLOAT,U.push({index:0,vertexBuffer:L,componentsPerAttribute:3,componentDatatype:D,normalize:!1,offsetInBytes:0,strideInBytes:0}),e._cull&&(e._boundingSphere=f||g?Sn.A.fromCornerPoints(j.A.ZERO,e._quantizedVolumeScale):function(e){const t=e.length/3,n=Math.min(t,20),i=zK(20),o=Number.MAX_VALUE,r=-Number.MAX_VALUE,s=j.A.fromElements(o,o,o,BK),a=j.A.fromElements(r,r,r,FK);for(let o=0;o<n;++o){const n=Math.floor(i[o]*t),r=j.A.unpack(e,3*n,UK);j.A.minimumByComponent(s,r,s),j.A.maximumByComponent(a,r,a)}const c=Sn.A.fromCornerPoints(s,a);return c.radius+=J.A.EPSILON2,c}(a.typedArray)),E)if(w)U.push({index:1,vertexBuffer:N,componentsPerAttribute:1,componentDatatype:C.A.UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0});else{const e=x?4:3;U.push({index:1,vertexBuffer:N,componentsPerAttribute:e,componentDatatype:C.A.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0})}S&&(y?(P=2,D=C.A.UNSIGNED_BYTE):v?(P=2,D=b<=255?C.A.UNSIGNED_BYTE:C.A.UNSIGNED_SHORT):(P=3,D=C.A.FLOAT),U.push({index:2,vertexBuffer:B,componentsPerAttribute:P,componentDatatype:D,normalize:!1,offsetInBytes:0,strideInBytes:0})),I&&U.push({index:3,vertexBuffer:F,componentsPerAttribute:1,componentDatatype:C.A.fromTypedArray(u.typedArray),normalize:!1,offsetInBytes:0,strideInBytes:0}),A&&(U=U.concat(R));const k=new je.A({context:n,attributes:U}),V={depthTest:{enabled:!0}},z={depthTest:{enabled:!0},depthMask:!1,blending:$M.A.ALPHA_BLEND};e._opaquePass===ut.A.CESIUM_3D_TILE&&(V.stencilTest=SU.A.setCesium3DTileBit(),V.stencilMask=SU.A.CESIUM_3D_TILE_MASK,z.stencilTest=SU.A.setCesium3DTileBit(),z.stencilMask=SU.A.CESIUM_3D_TILE_MASK),e._opaqueRenderState=_.A.fromCache(V),e._translucentRenderState=_.A.fromCache(z),e._drawCommand=new m.A({boundingVolume:new Sn.A,cull:e._cull,modelMatrix:new O.A,primitiveType:p.A.POINTS,vertexArray:k,count:s,shaderProgram:void 0,uniformMap:void 0,renderState:x?e._translucentRenderState:e._opaqueRenderState,pass:x?ut.A.TRANSLUCENT:e._opaquePass,owner:e,castShadows:!1,receiveShadows:!1,pickId:e._pickIdLoaded()})}(this,e),s=!0,i=!0,this._ready=!0,this._parsedContent=void 0),s){O.A.clone(this.modelMatrix,this._modelMatrix);const t=this._drawCommand.modelMatrix;if(O.A.clone(this._modelMatrix,t),(0,d.A)(this._rtcCenter)&&O.A.multiplyByTranslation(t,this._rtcCenter,t),(0,d.A)(this._quantizedVolumeOffset)&&O.A.multiplyByTranslation(t,this._quantizedVolumeOffset,t),e.mode!==Ce.A.SCENE3D){const n=e.mapProjection,i=O.A.getColumn(t,3,JK);Q.A.equals(i,Q.A.UNIT_W)||xe.A.basisTo2D(n,t,t)}const n=this._drawCommand.boundingVolume;if(Sn.A.clone(this._boundingSphere,n),this._cull){const e=n.center;O.A.multiplyByPoint(t,e,e);const i=O.A.getScale(t,ZK);n.radius*=j.A.maximumComponent(i)}}this.clippingPlanesDirty&&(this.clippingPlanesDirty=!1,i=!0),this._attenuation!==this.attenuation&&(this._attenuation=this.attenuation,i=!0),this.backFaceCulling!==this._backFaceCulling&&(this._backFaceCulling=this.backFaceCulling,i=!0),this.normalShading!==this._normalShading&&(this._normalShading=this.normalShading,i=!0),(this._style!==this.style||this.styleDirty)&&(this._style=this.style,this.styleDirty=!1,i=!0);const a=this.splitDirection!==Yt.A.NONE;this._splittingEnabled!==a&&(this._splittingEnabled=a,i=!0),i&&function(e,t,n){let i,o,r;const s=t.context,a=(0,d.A)(n),c=e._isQuantized,l=e._isQuantizedDraco,h=e._isOctEncoded16P,A=e._isOctEncodedDraco,p=e._isRGB565,f=e._isTranslucent,m=e._hasColors,g=e._hasNormals,_=e._hasBatchIds,v=e._backFaceCulling,T=e._normalShading,b=e._drawCommand.vertexArray,w=e.clippingPlanes,x=e._attenuation;let C,E,S,I=f;const P=(0,_t.A)($K),D={},R=e._styleableShaderAttributes;for(o in R)R.hasOwnProperty(o)&&(r=R[o],P[o]=`czm_3dtiles_property_${r.location}`,D[r.location]=r);if(a){const e={translucent:!1},t="(vec3 czm_3dtiles_builtin_property_POSITION, vec3 czm_3dtiles_builtin_property_POSITION_ABSOLUTE, vec4 czm_3dtiles_builtin_property_COLOR, vec3 czm_3dtiles_builtin_property_NORMAL)";C=n.getColorShaderFunction(`getColorFromStyle${t}`,P,e),E=n.getShowShaderFunction(`getShowFromStyle${t}`,P,e),S=n.getPointSizeShaderFunction(`getPointSizeFromStyle${t}`,P,e),(0,d.A)(C)&&e.translucent&&(I=!0)}e._styleTranslucent=I;const L=(0,d.A)(C),N=(0,d.A)(E),B=(0,d.A)(S),F=e.isClipped,U=[],k=[];L&&(QK(C,U),XK(C,k)),N&&(QK(E,U),XK(E,k)),B&&(QK(S,U),XK(S,k));const V=k.indexOf("COLOR")>=0,z=k.indexOf("NORMAL")>=0;if(z&&!g)throw new M.A("Style references the NORMAL semantic but the point cloud does not have normals");for(o in R)if(R.hasOwnProperty(o)){r=R[o];const e=U.indexOf(r.location)>=0;KK(b,r.location).enabled=e}const H=m&&(!L||V);m&&(KK(b,1).enabled=H);const G=g&&(T||v||z);g&&(KK(b,2).enabled=G);const W={a_position:0};H&&(W.a_color=1),G&&(W.a_normal=2),_&&(W.a_batchId=3);let Y="";const q=U.length;for(i=0;i<q;++i){const e=U[i];r=D[e];const t=r.componentCount,n=`czm_3dtiles_property_${e}`;let o;o=1===t?"float":`vec${t}`,Y+=`in ${o} ${n}; \n`,W[n]=r.location}!function(e,t){const n=t.context,i=e._isQuantized,o=e._isQuantizedDraco,r=e._isOctEncodedDraco;let s={u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier:function(){const i=GK;if(i.x=e._attenuation?e.maximumAttenuation:e._pointSize,i.x*=t.pixelRatio,i.y=e.time,e._attenuation){const o=t.camera.frustum;let r;r=t.mode===Ce.A.SCENE2D||o instanceof ee.A?Number.POSITIVE_INFINITY:n.drawingBufferHeight/t.camera.frustum.sseDenominator,i.z=e.geometricError*e.geometricErrorScale,i.w=r}return i},u_highlightColor:function(){return e._highlightColor},u_constantColor:function(){return e._constantColor},u_clippingPlanes:function(){const t=e.clippingPlanes;return e.isClipped?t.texture:n.defaultTexture},u_clippingPlanesEdgeStyle:function(){const t=e.clippingPlanes;if(!(0,d.A)(t))return u.A.TRANSPARENT;const n=u.A.clone(t.edgeColor,YK);return n.alpha=t.edgeWidth,n},u_clippingPlanesMatrix:function(){const t=e.clippingPlanes;if(!(0,d.A)(t))return O.A.IDENTITY;const i=e.clippingPlanesOriginMatrix??e._modelMatrix;O.A.multiply(n.uniformState.view3D,i,qK);const o=O.A.multiply(qK,t.modelMatrix,qK);return O.A.inverseTranspose(o,jK)}};LK.addUniforms(e,s),(i||o||r)&&(s=(0,tC.A)(s,{u_quantizedVolumeScaleAndOctEncodedRange:function(){const t=WK;if((0,d.A)(e._quantizedVolumeScale)){const n=j.A.clone(e._quantizedVolumeScale,t);j.A.divideByScalar(n,e._quantizedRange,t)}return t.w=e._octEncodedRange,t}})),(0,d.A)(e._uniformMapLoaded)&&(s=e._uniformMapLoaded(s)),e._drawCommand.uniformMap=s}(e,t);let Q="in vec3 a_position; \nout vec4 v_color; \nuniform vec4 u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier; \nuniform vec4 u_constantColor; \nuniform vec4 u_highlightColor; \n";Q+="float u_pointSize; \nfloat tiles3d_tileset_time; \n",x&&(Q+="float u_geometricError; \nfloat u_depthMultiplier; \n"),Q+=Y,H&&(Q+=f?"in vec4 a_color; \n":p?"in float a_color; \nconst float SHIFT_RIGHT_11 = 1.0 / 2048.0; \nconst float SHIFT_RIGHT_5 = 1.0 / 32.0; \nconst float SHIFT_LEFT_11 = 2048.0; \nconst float SHIFT_LEFT_5 = 32.0; \nconst float NORMALIZE_6 = 1.0 / 64.0; \nconst float NORMALIZE_5 = 1.0 / 32.0; \n":"in vec3 a_color; \n"),G&&(Q+=h||A?"in vec2 a_normal; \n":"in vec3 a_normal; \n"),_&&(Q+="in float a_batchId; \n"),(c||l||A)&&(Q+="uniform vec4 u_quantizedVolumeScaleAndOctEncodedRange; \n"),L&&(Q+=C),N&&(Q+=E),B&&(Q+=S),Q+="void main() \n{ \n    u_pointSize = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.x; \n    tiles3d_tileset_time = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.y; \n",x&&(Q+="    u_geometricError = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.z; \n    u_depthMultiplier = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.w; \n"),Q+=H?f?"    vec4 color = a_color; \n":p?"    float compressed = a_color; \n    float r = floor(compressed * SHIFT_RIGHT_11); \n    compressed -= r * SHIFT_LEFT_11; \n    float g = floor(compressed * SHIFT_RIGHT_5); \n    compressed -= g * SHIFT_LEFT_5; \n    float b = compressed; \n    vec3 rgb = vec3(r * NORMALIZE_5, g * NORMALIZE_6, b * NORMALIZE_5); \n    vec4 color = vec4(rgb, 1.0); \n":"    vec4 color = vec4(a_color, 1.0); \n":"    vec4 color = u_constantColor; \n",Q+=c||l?"    vec3 position = a_position * u_quantizedVolumeScaleAndOctEncodedRange.xyz; \n":"    vec3 position = a_position; \n",Q+="    vec3 position_absolute = vec3(czm_model * vec4(position, 1.0)); \n",G?(Q+=h?"    vec3 normal = czm_octDecode(a_normal); \n":A?"    vec3 normal = czm_octDecode(a_normal, u_quantizedVolumeScaleAndOctEncodedRange.w).zxy; \n":"    vec3 normal = a_normal; \n",Q+="    vec3 normalEC = czm_normal * normal; \n"):Q+="    vec3 normal = vec3(1.0); \n",L&&(Q+="    color = getColorFromStyle(position, position_absolute, color, normal); \n"),N&&(Q+="    float show = float(getShowFromStyle(position, position_absolute, color, normal)); \n"),Q+=B?"    gl_PointSize = getPointSizeFromStyle(position, position_absolute, color, normal) * czm_pixelRatio; \n":x?"    vec4 positionEC = czm_modelView * vec4(position, 1.0); \n    float depth = -positionEC.z; \n    gl_PointSize = min((u_geometricError / depth) * u_depthMultiplier, u_pointSize); \n":"    gl_PointSize = u_pointSize; \n",Q+="    color = color * u_highlightColor; \n",G&&T&&(Q+="    float diffuseStrength = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC); \n    diffuseStrength = max(diffuseStrength, 0.4); \n    color.xyz *= diffuseStrength * czm_lightColor; \n"),Q+="    v_color = color; \n    gl_Position = czm_modelViewProjection * vec4(position, 1.0); \n",G&&v&&(Q+="    float visible = step(-normalEC.z, 0.0); \n    gl_Position *= visible; \n    gl_PointSize *= visible; \n"),N&&(Q+="    gl_Position.w *= float(show); \n    gl_PointSize *= float(show); \n"),Q+="} \n";let X="in vec4 v_color; \n";F&&(X+="uniform highp sampler2D u_clippingPlanes; \nuniform mat4 u_clippingPlanesMatrix; \nuniform vec4 u_clippingPlanesEdgeStyle; \n",X+="\n",X+=jM(w,s),X+="\n"),X+="void main() \n{ \n    out_FragColor = czm_gammaCorrect(v_color); \n",F&&(X+=RK("u_clippingPlanes","u_clippingPlanesMatrix","u_clippingPlanesEdgeStyle")),X+="} \n",e.splitDirection!==Yt.A.NONE&&(X=LK.modifyFragmentShader(X)),(0,d.A)(e._vertexShaderLoaded)&&(Q=e._vertexShaderLoaded(Q)),(0,d.A)(e._fragmentShaderLoaded)&&(X=e._fragmentShaderLoaded(X));const K=e._drawCommand;(0,d.A)(K.shaderProgram)&&K.shaderProgram.destroy(),K.shaderProgram=y.A.fromCache({context:s,vertexShaderSource:Q,fragmentShaderSource:X,attributeLocations:W});try{K.shaderProgram._bind()}catch(e){throw new M.A("Error generating style shader: this may be caused by a type mismatch, index out-of-bounds, or other syntax error.")}}(this,e,this._style),this._drawCommand.castShadows=kn.A.castShadows(this.shadows),this._drawCommand.receiveShadows=kn.A.receiveShadows(this.shadows);const c=this._highlightColor.alpha<1||this._constantColor.alpha<1||this._styleTranslucent;this._drawCommand.renderState=c?this._translucentRenderState:this._opaqueRenderState,this._drawCommand.pass=c?ut.A.TRANSLUCENT:this._opaquePass;const l=e.commandList,h=e.passes;(h.render||h.pick)&&l.push(this._drawCommand)},NK.prototype.isDestroyed=function(){return!1},NK.prototype.destroy=function(){const e=this._drawCommand;return(0,d.A)(e)&&(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy()),(0,h.A)(this)};const e$=NK;var t$=n(534135),n$=n(929771);function i$(e){e=e??S.A.EMPTY_OBJECT,l.A.typeOf.object("options.clock",e.clock),l.A.typeOf.object("options.intervals",e.intervals),this.show=e.show??!0,this.modelMatrix=O.A.clone(e.modelMatrix??O.A.IDENTITY),this.shadows=e.shadows??kn.A.ENABLED,this.maximumMemoryUsage=e.maximumMemoryUsage??256,this.shading=new n$.A(e.shading),this.style=e.style,this.frameFailed=new Bn.A,this.frameChanged=new Bn.A,this._clock=e.clock,this._intervals=e.intervals,this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._pointCloudEyeDomeLighting=new t$.A,this._loadTimestamp=void 0,this._clippingPlanesState=0,this._styleDirty=!1,this._pickId=void 0,this._totalMemoryUsageInBytes=0,this._frames=[],this._previousInterval=void 0,this._nextInterval=void 0,this._lastRenderedFrame=void 0,this._clockMultiplier=0,this._runningSum=0,this._runningLength=0,this._runningIndex=0,this._runningSamples=new Array(5).fill(0),this._runningAverage=0}function o$(e){return`uniform vec4 czm_pickColor;\n${e}`}function r$(){return"czm_pickColor"}Object.defineProperties(i$.prototype,{clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){YM.A.setOwner(e,this,"_clippingPlanes")}},totalMemoryUsageInBytes:{get:function(){return this._totalMemoryUsageInBytes}},boundingSphere:{get:function(){if((0,d.A)(this._lastRenderedFrame))return this._lastRenderedFrame.pointCloud.boundingSphere}}}),i$.prototype.makeStyleDirty=function(){this._styleDirty=!0},i$.prototype._getAverageLoadTime=function(){return 0===this._runningLength?.05:this._runningAverage};const s$=new te.A;function a$(e){const t=e._clock,n=t.canAnimate&&t.shouldAnimate,i=t.multiplier;return n?i:0}function c$(e,t){return e._intervals.indexOf(t.start)}function l$(e,t){return function(n){const i=(0,d.A)(n.message)?n.message:n.toString();e.frameFailed.numberOfListeners>0?e.frameFailed.raiseEvent({uri:t,message:i}):(console.log(`A frame failed to load: ${t}`),console.log(`Error: ${i}`))}}const u$=new O.A,d$=new n$.A;function h$(e,t,n,i){const o=e.shading??d$,r=t.pointCloud,s=t.transform??O.A.IDENTITY;r.modelMatrix=O.A.multiplyTransformation(e.modelMatrix,s,u$),r.style=e.style,r.time=n.timeSinceLoad,r.shadows=e.shadows,r.clippingPlanes=e._clippingPlanes,r.isClipped=n.isClipped,r.attenuation=o.attenuation,r.backFaceCulling=o.backFaceCulling,r.normalShading=o.normalShading,r.geometricError=function(e,t){const n=e.shading;return(0,d.A)(n)&&(0,d.A)(n.baseResolution)?n.baseResolution:(0,d.A)(t.boundingSphere)?J.A.cbrt(t.boundingSphere.volume()/t.pointsLength):0}(e,r),r.geometricErrorScale=o.geometricErrorScale,r.maximumAttenuation=function(e){const t=e.shading;return(0,d.A)(t)&&(0,d.A)(t.maximumAttenuation)?t.maximumAttenuation:10}(e);try{r.update(i)}catch(n){l$(e,t.uri)(n)}t.touchedFrameNumber=i.frameNumber}function A$(e,t,n,i){const o=function(e,t,n){const i=c$(e,t),o=e._frames;let r=o[i];if(!(0,d.A)(r)){const s=t.data.transform,a=(0,d.A)(s)?O.A.fromArray(s):void 0,c=t.data.uri;r={pointCloud:void 0,transform:a,timestamp:(0,aa.A)(),sequential:!0,ready:!1,touchedFrameNumber:n.frameNumber,uri:c},o[i]=r,Lt.A.fetchArrayBuffer({url:c}).then(function(t){var n;r.pointCloud=new e$({arrayBuffer:t,cull:!0,fragmentShaderLoaded:o$,uniformMapLoaded:(n=e,function(e){return(0,tC.A)(e,{czm_pickColor:function(){return n._pickId.color}})}),pickIdLoaded:r$})}).catch(l$(e,c))}return r}(e,t,i);!function(e,t,n,i){t.touchedFrameNumber<i.frameNumber-1&&(t.sequential=!1);const o=t.pointCloud;if((0,d.A)(o)&&!t.ready){const r=i.commandList,s=r.length;h$(e,t,n,i),o.ready&&(t.ready=!0,e._totalMemoryUsageInBytes+=o.geometryByteLength,r.length=s,t.sequential)&&function(e,t){e._runningSum+=t,e._runningSum-=e._runningSamples[e._runningIndex],e._runningSamples[e._runningIndex]=t,e._runningLength=Math.min(e._runningLength+1,e._runningSamples.length),e._runningIndex=(e._runningIndex+1)%e._runningSamples.length,e._runningAverage=e._runningSum/e._runningLength}(e,((0,aa.A)()-t.timestamp)/1e3)}t.touchedFrameNumber=i.frameNumber}(e,o,n,i)}function p$(e,t){const n=e._frames,i=n.length;for(let o=0;o<i;++o){const i=n[o];if((0,d.A)(i)&&(!(0,d.A)(t)||t(i))){const t=i.pointCloud;i.ready&&(e._totalMemoryUsageInBytes-=t.geometryByteLength),(0,d.A)(t)&&t.destroy(),i===e._lastRenderedFrame&&(e._lastRenderedFrame=void 0),n[o]=void 0}}}function f$(e,t,n,i,o){return!!(0,d.A)(n)&&(!!n.ready||(A$(e,t,i,o),n.ready))}const m$={timeSinceLoad:0,isClipped:!1,clippingPlanesDirty:!1};i$.prototype.update=function(e){if(e.mode===Ce.A.MORPHING)return;if(!this.show)return;(0,d.A)(this._pickId)||(this._pickId=e.context.createPickId({primitive:this})),(0,d.A)(this._loadTimestamp)||(this._loadTimestamp=te.A.clone(e.time));const t=Math.max(1e3*te.A.secondsDifference(e.time,this._loadTimestamp),0),n=this._clippingPlanes;let i=0,o=!1;const r=(0,d.A)(n)&&n.enabled;r&&(n.update(e),i=n.clippingPlanesState),this._clippingPlanesState!==i&&(this._clippingPlanesState=i,o=!0);const s=this._styleDirty;this._styleDirty=!1,(o||s)&&function(e,t,n){const i=e._frames,o=i.length;for(let e=0;e<o;++e){const o=i[e];(0,d.A)(o)&&(0,d.A)(o.pointCloud)&&(o.pointCloud.clippingPlanesDirty=t,o.pointCloud.styleDirty=n)}}(this,o,s),m$.timeSinceLoad=t,m$.isClipped=r;const a=this.shading,c=this._pointCloudEyeDomeLighting,l=e.commandList,u=l.length;let h=this._previousInterval,A=this._nextInterval;const p=function(e){const t=e._intervals,n=e._clock.currentTime,i=t.indexOf(n);return t.get(i)}(this);if(!(0,d.A)(p))return;let f=!1;const m=a$(this),g=0===m;m!==this._clockMultiplier&&(f=!0,this._clockMultiplier=m),(0,d.A)(h)&&!g||(h=p),(!(0,d.A)(A)||f||function(e,t,n){const i=a$(e),o=c$(e,t),r=c$(e,n);return i>=0?o>=r:o<=r}(this,p,A))&&(A=function(e,t){const n=e._intervals,i=e._clock,o=a$(e);if(0===o)return;const r=e._getAverageLoadTime(),s=te.A.addSeconds(i.currentTime,r*o,s$);let a=n.indexOf(s);return a===c$(e,t)&&(o>=0?++a:--a),n.get(a)}(this,p)),h=function(e,t,n,i,o){let r,s,a;const c=e._intervals,l=e._frames,u=c$(e,n),d=c$(e,t);if(u>=d){for(r=u;r>=d;--r)if(s=c.get(r),a=l[r],f$(e,s,a,i,o))return s}else for(r=u;r<=d;++r)if(s=c.get(r),a=l[r],f$(e,s,a,i,o))return s;return t}(this,h,p,m$,e);let _=function(e,t){const n=c$(e,t),i=e._frames[n];if((0,d.A)(i)&&i.ready)return i}(this,h);(0,d.A)(_)||(A$(this,h,m$,e),_=this._lastRenderedFrame),(0,d.A)(_)&&h$(this,_,m$,e),(0,d.A)(A)&&A$(this,A,m$,e);const y=this;(0,d.A)(_)&&!(0,d.A)(this._lastRenderedFrame)&&e.afterRender.push(function(){return!0}),(0,d.A)(_)&&_!==this._lastRenderedFrame&&y.frameChanged.numberOfListeners>0&&e.afterRender.push(function(){return y.frameChanged.raiseEvent(y),!0}),this._previousInterval=h,this._nextInterval=A,this._lastRenderedFrame=_,this._totalMemoryUsageInBytes>1024*this.maximumMemoryUsage*1024&&p$(this,function(e){return function(t){return t.touchedFrameNumber<e.frameNumber}}(e));const v=l.length-u;(0,d.A)(a)&&a.attenuation&&a.eyeDomeLighting&&v>0&&c.update(e,u,a,this.boundingSphere)},i$.prototype.isDestroyed=function(){return!1},i$.prototype.destroy=function(){return p$(this),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),(0,h.A)(this)};const g$=i$;function _$(e,t){if((0,d.A)(t)){const n=t.clock;(0,d.A)(n)&&n.getValue(e)}}function y$(e){let t=e._useBrowserRecommendedResolution?1:window.devicePixelRatio;return t*=e._resolutionScale,(0,d.A)(e._scene)&&(e._scene.pixelRatio=t),t}function v$(e){const t=e._canvas;let n=t.clientWidth,i=t.clientHeight;const o=y$(e);e._canvasClientWidth=n,e._canvasClientHeight=i,n*=o,i*=o,t.width=n,t.height=i,e._canRender=0!==n&&0!==i,e._lastDevicePixelRatio=window.devicePixelRatio}function T$(e){const t=e._canvas,n=t.width,i=t.height;if(0!==n&&0!==i){const t=e._scene.camera.frustum;(0,d.A)(t.aspectRatio)?t.aspectRatio=n/i:(t.top=t.right*(i/n),t.bottom=-t.top)}}function b$(e,t){if(!(0,d.A)(e))throw new A.A("container is required.");e=(0,Qx.A)(e),t=t??S.A.EMPTY_OBJECT;const n=document.createElement("div");n.className="cesium-widget",e.appendChild(n);const i=document.createElement("canvas"),o=lP.A.supportsImageRenderingPixelated();function r(){i!==i.ownerDocument.activeElement&&i.ownerDocument.activeElement.blur()}this._supportsImageRenderingPixelated=o,o&&(i.style.imageRendering=lP.A.imageRenderingValue()),i.oncontextmenu=function(){return!1},i.onselectstart=function(){return!1},(t.blurActiveElementOnCanvasFocus??!0)&&(i.addEventListener("mousedown",r),i.addEventListener("pointerdown",r)),n.appendChild(i);const s=document.createElement("div");s.className="cesium-widget-credits";const a=(0,d.A)(t.creditContainer)?(0,Qx.A)(t.creditContainer):n;a.appendChild(s);const c=(0,d.A)(t.creditViewport)?(0,Qx.A)(t.creditViewport):n,l=t.showRenderLoopErrors??!0,u=t.useBrowserRecommendedResolution??!0;this._element=n,this._container=e,this._canvas=i,this._canvasClientWidth=0,this._canvasClientHeight=0,this._lastDevicePixelRatio=0,this._creditViewport=c,this._creditContainer=a,this._innerCreditContainer=s,this._canRender=!1,this._renderLoopRunning=!1,this._showRenderLoopErrors=l,this._resolutionScale=1,this._useBrowserRecommendedResolution=u,this._forceResize=!1,this._entityView=void 0,this._clockTrackedDataSource=void 0,this._trackedEntity=void 0,this._needTrackedEntityUpdate=!1,this._zoomIsFlight=!1,this._zoomTarget=void 0,this._zoomPromise=void 0,this._zoomOptions=void 0,this._trackedEntityChanged=new Bn.A,this._allowDataSourcesToSuspendAnimation=!0,this._clock=(0,d.A)(t.clock)?t.clock:new la,(0,d.A)(t.shouldAnimate)&&(this._clock.shouldAnimate=t.shouldAnimate),v$(this);try{const e=t.ellipsoid??K.A.default,n=new fK({canvas:i,contextOptions:t.contextOptions,creditContainer:s,creditViewport:c,ellipsoid:e,mapProjection:t.mapProjection,orderIndependentTranslucency:t.orderIndependentTranslucency,scene3DOnly:t.scene3DOnly??!1,shadows:t.shadows,mapMode2D:t.mapMode2D,requestRenderMode:t.requestRenderMode,maximumRenderTimeChange:t.maximumRenderTimeChange,depthPlaneEllipsoidOffset:t.depthPlaneEllipsoidOffset,msaaSamples:t.msaaSamples});this._scene=n,n.camera.constrainedAxis=j.A.UNIT_Z,y$(this),T$(this);let o=t.globe;(0,d.A)(o)||(o=new xB(e)),!1!==o&&(n.globe=o,n.globe.shadows=t.terrainShadows??kn.A.RECEIVE_ONLY);let r=t.skyBox;!(0,d.A)(r)&&K.A.WGS84.equals(e)&&(r=bK.createEarthSkyBox()),!1!==r&&(n.skyBox=r,n.sun=new IK,K.A.WGS84.equals(e)&&(n.moon=new LB));let a=t.skyAtmosphere;!(0,d.A)(a)&&K.A.WGS84.equals(e)&&(a=new yK(e),a.show=!1!==t.globe&&o.show),!1!==a&&(n.skyAtmosphere=a);let l=t.baseLayer;if(!1!==t.globe&&!1!==l&&((0,d.A)(l)||(l=hL.A.fromWorldImagery()),n.imageryLayers.add(l)),(0,d.A)(t.terrainProvider)&&!1!==t.globe&&(n.terrainProvider=t.terrainProvider),(0,d.A)(t.terrain)&&!1!==t.globe){if((0,d.A)(t.terrainProvider))throw new A.A("Specify either options.terrainProvider or options.terrain.");n.setTerrain(t.terrain)}this._screenSpaceEventHandler=new bR.A(i),(0,d.A)(t.sceneMode)&&(t.sceneMode===Ce.A.SCENE2D&&this._scene.morphTo2D(0),t.sceneMode===Ce.A.COLUMBUS_VIEW&&this._scene.morphToColumbusView(0)),this._useDefaultRenderLoop=void 0,this.useDefaultRenderLoop=t.useDefaultRenderLoop??!0,this._targetFrameRate=void 0,this.targetFrameRate=t.targetFrameRate;const u=this;this._onRenderError=function(e,t){if(u._useDefaultRenderLoop=!1,u._renderLoopRunning=!1,u._showRenderLoopErrors){const e="An error occurred while rendering.  Rendering has stopped.";u.showErrorPanel(e,void 0,t)}},n.renderError.addEventListener(this._onRenderError);let h=t.dataSources,p=!1;(0,d.A)(h)||(h=new Gl,p=!0);const f=new qm({scene:n,dataSourceCollection:h}),m=new Gi.A;this._dataSourceChangedListeners={},this._automaticallyTrackDataSourceClocks=t.automaticallyTrackDataSourceClocks??!0,this._dataSourceCollection=h,this._destroyDataSourceCollection=p,this._dataSourceDisplay=f,this._eventHelper=m,this._canAnimateUpdateCallback=this._updateCanAnimate,m.add(this._clock.onTick,b$.prototype._onTick,this),m.add(n.morphStart,b$.prototype._clearTrackedObject,this),m.add(h.dataSourceAdded,b$.prototype._onDataSourceAdded,this),m.add(h.dataSourceRemoved,b$.prototype._onDataSourceRemoved,this),m.add(n.postRender,b$.prototype._postRender,this);const g=h.length;for(let e=0;e<g;e++)this._dataSourceAdded(h,h.get(e));this._dataSourceAdded(void 0,f.defaultDataSource),m.add(h.dataSourceAdded,b$.prototype._dataSourceAdded,this),m.add(h.dataSourceRemoved,b$.prototype._dataSourceRemoved,this)}catch(e){if(l){const t="Error constructing CesiumWidget.",n='Visit <a href="http://get.webgl.org">http://get.webgl.org</a> to verify that your web browser and hardware support WebGL.  Consider trying a different web browser or updating your video drivers.  Detailed error information is below:';this.showErrorPanel(t,n,e)}throw e}}Object.defineProperties(b$.prototype,{container:{get:function(){return this._container}},canvas:{get:function(){return this._canvas}},creditContainer:{get:function(){return this._creditContainer}},creditViewport:{get:function(){return this._creditViewport}},scene:{get:function(){return this._scene}},imageryLayers:{get:function(){return this._scene.imageryLayers}},terrainProvider:{get:function(){return this._scene.terrainProvider},set:function(e){this._scene.terrainProvider=e}},creditDisplay:{get:function(){return this._scene.frameState.creditDisplay}},dataSourceDisplay:{get:function(){return this._dataSourceDisplay}},entities:{get:function(){return this._dataSourceDisplay.defaultDataSource.entities}},dataSources:{get:function(){return this._dataSourceCollection}},camera:{get:function(){return this._scene.camera}},ellipsoid:{get:function(){return this._scene.ellipsoid}},clock:{get:function(){return this._clock}},screenSpaceEventHandler:{get:function(){return this._screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._targetFrameRate},set:function(e){if(e<=0)throw new A.A("targetFrameRate must be greater than 0, or undefined.");this._targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._useDefaultRenderLoop},set:function(e){this._useDefaultRenderLoop!==e&&(this._useDefaultRenderLoop=e,e&&!this._renderLoopRunning&&function(e){e._renderLoopRunning=!0;let t=0;requestAnimationFrame(function n(i){if(!e.isDestroyed())if(e._useDefaultRenderLoop)try{const o=e._targetFrameRate;if((0,d.A)(o)){const r=1e3/o,s=i-t;s>r&&(e.resize(),e.render(),t=i-s%r),requestAnimationFrame(n)}else e.resize(),e.render(),requestAnimationFrame(n)}catch(t){if(e._useDefaultRenderLoop=!1,e._renderLoopRunning=!1,e._showRenderLoopErrors){const n="An error occurred while rendering.  Rendering has stopped.";e.showErrorPanel(n,void 0,t)}}else e._renderLoopRunning=!1})}(this))}},resolutionScale:{get:function(){return this._resolutionScale},set:function(e){if(e<=0)throw new A.A("resolutionScale must be greater than 0.");this._resolutionScale!==e&&(this._resolutionScale=e,this._forceResize=!0)}},useBrowserRecommendedResolution:{get:function(){return this._useBrowserRecommendedResolution},set:function(e){this._useBrowserRecommendedResolution!==e&&(this._useBrowserRecommendedResolution=e,this._forceResize=!0)}},allowDataSourcesToSuspendAnimation:{get:function(){return this._allowDataSourcesToSuspendAnimation},set:function(e){this._allowDataSourcesToSuspendAnimation=e}},trackedEntity:{get:function(){return this._trackedEntity},set:function(e){if(this._trackedEntity!==e){this._trackedEntity=e,E$(this);const t=this.scene,n=t.mode;(0,d.A)(e)&&(0,d.A)(e.position)?this._needTrackedEntityUpdate=!0:(this._needTrackedEntityUpdate=!1,n!==Ce.A.COLUMBUS_VIEW&&n!==Ce.A.SCENE2D||(t.screenSpaceCameraController.enableTranslate=!0),n!==Ce.A.COLUMBUS_VIEW&&n!==Ce.A.SCENE3D||(t.screenSpaceCameraController.enableTilt=!0),this._entityView=void 0,this.camera.lookAtTransform(O.A.IDENTITY)),this._trackedEntityChanged.raiseEvent(e),this.scene.requestRender()}}},trackedEntityChanged:{get:function(){return this._trackedEntityChanged}},clockTrackedDataSource:{get:function(){return this._clockTrackedDataSource},set:function(e){this._clockTrackedDataSource!==e&&(this._clockTrackedDataSource=e,_$(this.clock,e))}}}),b$.prototype.showErrorPanel=function(e,t,n){const i=this._element,o=document.createElement("div");o.className="cesium-widget-errorPanel";const r=document.createElement("div");r.className="cesium-widget-errorPanel-content",o.appendChild(r);const s=document.createElement("div");s.className="cesium-widget-errorPanel-header",s.appendChild(document.createTextNode(e)),r.appendChild(s);const a=document.createElement("div");function c(){a.style.maxHeight=`${Math.max(Math.round(.9*i.clientHeight-100),30)}px`}a.className="cesium-widget-errorPanel-scroll",r.appendChild(a),c(),(0,d.A)(window.addEventListener)&&window.addEventListener("resize",c,!1);const l=(0,d.A)(t),u=(0,d.A)(n);if(l||u){const i=document.createElement("div");if(i.className="cesium-widget-errorPanel-message",a.appendChild(i),u){let i=(0,mM.A)(n);l||("string"==typeof n&&(n=new Error(n)),t=(0,mM.A)({name:n.name,message:n.message}),i=n.stack),"undefined"!=typeof console&&console.error(`${e}\n${t}\n${i}`);const o=document.createElement("div");o.className="cesium-widget-errorPanel-message-details collapsed";const s=document.createElement("span");s.className="cesium-widget-errorPanel-more-details",s.appendChild(document.createTextNode("See more...")),o.appendChild(s),o.onclick=function(e){o.removeChild(s),o.appendChild(document.createTextNode(i)),o.className="cesium-widget-errorPanel-message-details",r.className="cesium-widget-errorPanel-content expanded",o.onclick=void 0},a.appendChild(o)}i.innerHTML=`<p>${t}</p>`}const h=document.createElement("div");h.className="cesium-widget-errorPanel-buttonPanel",r.appendChild(h);const A=document.createElement("button");A.setAttribute("type","button"),A.className="cesium-button",A.appendChild(document.createTextNode("OK")),A.onclick=function(){(0,d.A)(c)&&(0,d.A)(window.removeEventListener)&&window.removeEventListener("resize",c,!1),i.removeChild(o)},h.appendChild(A),i.appendChild(o)},b$.prototype.isDestroyed=function(){return!1},b$.prototype.destroy=function(){const e=this.dataSources,t=e.length;for(let n=0;n<t;n++)this._dataSourceRemoved(e,e.get(n));this._dataSourceRemoved(void 0,this._dataSourceDisplay.defaultDataSource),this._dataSourceDisplay=this._dataSourceDisplay.destroy(),(0,d.A)(this._scene)&&(this._scene.renderError.removeEventListener(this._onRenderError),this._scene=this._scene.destroy()),this._container.removeChild(this._element),this._creditContainer.removeChild(this._innerCreditContainer),this._eventHelper.removeAll(),this._destroyDataSourceCollection&&(this._dataSourceCollection=this._dataSourceCollection.destroy()),(0,h.A)(this)},b$.prototype.resize=function(){const e=this._canvas;(this._forceResize||this._canvasClientWidth!==e.clientWidth||this._canvasClientHeight!==e.clientHeight||this._lastDevicePixelRatio!==window.devicePixelRatio)&&(this._forceResize=!1,v$(this),T$(this),this._scene.requestRender())},b$.prototype.render=function(){if(this._canRender){this._scene.initializeFrame();const e=this._clock.tick();this._scene.render(e)}else this._clock.tick()},b$.prototype._dataSourceAdded=function(e,t){t.entities.collectionChanged.addEventListener(b$.prototype._onEntityCollectionChanged,this)},b$.prototype._dataSourceRemoved=function(e,t){const n=t.entities;n.collectionChanged.removeEventListener(b$.prototype._onEntityCollectionChanged,this),(0,d.A)(this.trackedEntity)&&n.getById(this.trackedEntity.id)===this.trackedEntity&&(this.trackedEntity=void 0)},b$.prototype._updateCanAnimate=function(e){this._clock.canAnimate=e};const w$=new Sn.A;function x$(e,t,n,i){if(!(0,d.A)(t))throw new A.A("zoomTarget is required.");E$(e);const o=new Promise(t=>{e._completeZoom=function(e){t(e)}});return e._zoomPromise=o,e._zoomIsFlight=i,e._zoomOptions=n,Promise.resolve(t).then(function(t){if(e._zoomPromise===o){if(t instanceof hL.A){let n;return n=(0,d.A)(t.imageryProvider)?Promise.resolve(t.getImageryRectangle()):new Promise(e=>{const n=t.readyEvent.addEventListener(()=>{n(),e(t.getImageryRectangle())})}),void n.then(function(t){return WM(t,e.scene)}).then(function(t){e._zoomPromise===o&&(e._zoomTarget=t)})}if(t instanceof yi.A||t instanceof g$||t instanceof uX)e._zoomTarget=t;else{if(t.isLoading&&(0,d.A)(t.loadingEvent)){const n=t.loadingEvent.addEventListener(function(){n(),e._zoomPromise===o&&(e._zoomTarget=t.entities.values.slice(0))});return}Array.isArray(t)?e._zoomTarget=t.slice(0):(t=t.values??t,(0,d.A)(t.entities)&&(t=t.entities.values),Array.isArray(t)?e._zoomTarget=t.slice(0):e._zoomTarget=[t])}}}),e.scene.requestRender(),o}function C$(e){e._zoomPromise=void 0,e._zoomTarget=void 0,e._zoomOptions=void 0}function E$(e){const t=e._zoomPromise;(0,d.A)(t)&&(C$(e),e._completeZoom(!1))}b$.prototype._onTick=function(e){const t=e.currentTime,n=this._dataSourceDisplay.update(t);this._allowDataSourcesToSuspendAnimation&&this._canAnimateUpdateCallback(n);const i=this._entityView;if((0,d.A)(i)){const e=this._trackedEntity;this._dataSourceDisplay.getBoundingSphere(e,!1,i.boundingSphere??w$)===Gt.DONE&&i.update(t)}},b$.prototype._onEntityCollectionChanged=function(e,t,n){const i=n.length;for(let e=0;e<i;e++){const t=n[e];this.trackedEntity===t&&(this.trackedEntity=void 0)}},b$.prototype._clearTrackedObject=function(){this.trackedEntity=void 0},b$.prototype._onDataSourceChanged=function(e){this.clockTrackedDataSource===e&&_$(this.clock,e)},b$.prototype._onDataSourceAdded=function(e,t){this._automaticallyTrackDataSourceClocks&&(this.clockTrackedDataSource=t);const n=t.entities.id,i=this._eventHelper.add(t.changedEvent,b$.prototype._onDataSourceChanged,this);this._dataSourceChangedListeners[n]=i},b$.prototype._onDataSourceRemoved=function(e,t){const n=this.clockTrackedDataSource===t,i=t.entities.id;if(this._dataSourceChangedListeners[i](),this._dataSourceChangedListeners[i]=void 0,n){const t=e.length;this._automaticallyTrackDataSourceClocks&&t>0?this.clockTrackedDataSource=e.get(t-1):this.clockTrackedDataSource=void 0}},b$.prototype.zoomTo=function(e,t){return x$(this,e,{offset:t},!1)},b$.prototype.flyTo=function(e,t){return x$(this,e,t,!0)},b$.prototype._postRender=function(){!function(e){const t=e._zoomTarget;if(!(0,d.A)(t)||e.scene.mode===Ce.A.MORPHING)return;const n=e.scene,i=n.camera,o=e._zoomOptions??{};let r;function s(n){(0,d.A)(o.offset)||(o.offset=new jm.A(0,-.5,n.radius)),r={offset:o.offset,duration:o.duration,maximumHeight:o.maximumHeight,complete:function(){e._completeZoom(!0)},cancel:function(){e._completeZoom(!1)}},e._zoomIsFlight?i.flyToBoundingSphere(t.boundingSphere,r):(i.viewBoundingSphere(n,o.offset),i.lookAtTransform(O.A.IDENTITY),e._completeZoom(!0)),C$(e)}if(t instanceof g$){if((0,d.A)(t.boundingSphere))return void s(t.boundingSphere);const e=t.frameChanged.addEventListener(function(t){s(t.boundingSphere),e()});return}if(t instanceof yi.A||t instanceof uX)return void s(t.boundingSphere);if(t instanceof X.A)return r={destination:n.ellipsoid.cartographicToCartesian(t),duration:o.duration,maximumHeight:o.maximumHeight,complete:function(){e._completeZoom(!0)},cancel:function(){e._completeZoom(!1)}},e._zoomIsFlight?i.flyTo(r):(i.setView(r),e._completeZoom(!0)),void C$(e);const a=t,c=[];for(let t=0,n=a.length;t<n;t++){const n=e._dataSourceDisplay.getBoundingSphere(a[t],!1,S$);if(n===Gt.PENDING)return;n!==Gt.FAILED&&c.push(Sn.A.clone(S$))}if(0===c.length)return void E$(e);e.trackedEntity=void 0;const l=Sn.A.fromBoundingSpheres(c);e._zoomIsFlight?(C$(e),i.flyToBoundingSphere(l,{duration:o.duration,maximumHeight:o.maximumHeight,complete:function(){e._completeZoom(!0)},cancel:function(){e._completeZoom(!1)},offset:o.offset})):(i.viewBoundingSphere(l,o.offset),i.lookAtTransform(O.A.IDENTITY),C$(e),e._completeZoom(!0))}(this),function(e){if(!e._needTrackedEntityUpdate)return;const t=e._trackedEntity,n=e.clock.currentTime,i=Wt.A.getValueOrUndefined(t.position,n);if(!(0,d.A)(i))return;const o=e.scene,r=e._dataSourceDisplay.getBoundingSphere(t,!1,I$);if(r===Gt.PENDING)return;const s=o.mode;s!==Ce.A.COLUMBUS_VIEW&&s!==Ce.A.SCENE2D||(o.screenSpaceCameraController.enableTranslate=!1),s!==Ce.A.COLUMBUS_VIEW&&s!==Ce.A.SCENE3D||(o.screenSpaceCameraController.enableTilt=!1);const a=r!==Gt.FAILED?I$:void 0;e._entityView=new hg(t,o,o.ellipsoid),e._entityView.update(n,a),e._needTrackedEntityUpdate=!1}(this)};const S$=new Sn.A,I$=new Sn.A,P$=b$;var D$=n(953019),O$=n(207828),R$=n(418510),M$=n(531573),L$=n(95146),N$=n(730839),B$=n(511517),F$=n(425438),U$=n(744671),k$=n(653565),V$=n(124547),z$=n(770103),H$=n(734814),G$=n(208836),W$=n(886626),Y$=n(74006),q$=n(416882),j$=n(655979);const Q$=new j.A(1,1,1);function X$(e){e=e??Q$,l.A.defined("dimensions",e),l.A.typeOf.number.greaterThanOrEquals("dimensions.x",e.x,0),l.A.typeOf.number.greaterThanOrEquals("dimensions.y",e.y,0),l.A.typeOf.number.greaterThanOrEquals("dimensions.z",e.z,0),this._dimensions=j.A.clone(e)}Object.defineProperties(X$.prototype,{dimensions:{get:function(){return this._dimensions},set:function(e){l.A.defined("value",e),l.A.typeOf.number.greaterThanOrEquals("value.x",e.x,0),l.A.typeOf.number.greaterThanOrEquals("value.y",e.y,0),l.A.typeOf.number.greaterThanOrEquals("value.z",e.z,0),j.A.clone(e,this._dimensions)}}});const K$=new j.A;X$.prototype.emit=function(e){const t=this._dimensions,n=j.A.multiplyByScalar(t,.5,K$),i=J.A.randomBetween(-n.x,n.x),o=J.A.randomBetween(-n.y,n.y),r=J.A.randomBetween(-n.z,n.z);e.position=j.A.fromElements(i,o,r,e.position),e.velocity=j.A.normalize(e.position,e.velocity)};const $$=X$;var J$=n(452663),Z$=n(625224),eJ=n(308695),tJ=n(474751),nJ=n(716750);function iJ(){this.featurePropertiesDirty=!1}Object.defineProperties(iJ.prototype,{featuresLength:{get:function(){A.A.throwInstantiationError()}},pointsLength:{get:function(){A.A.throwInstantiationError()}},trianglesLength:{get:function(){A.A.throwInstantiationError()}},geometryByteLength:{get:function(){A.A.throwInstantiationError()}},texturesByteLength:{get:function(){A.A.throwInstantiationError()}},batchTableByteLength:{get:function(){A.A.throwInstantiationError()}},innerContents:{get:function(){A.A.throwInstantiationError()}},ready:{get:function(){A.A.throwInstantiationError()}},tileset:{get:function(){A.A.throwInstantiationError()}},tile:{get:function(){A.A.throwInstantiationError()}},url:{get:function(){A.A.throwInstantiationError()}},batchTable:{get:function(){A.A.throwInstantiationError()}},metadata:{get:function(){A.A.throwInstantiationError()},set:function(e){A.A.throwInstantiationError()}},group:{get:function(){A.A.throwInstantiationError()},set:function(e){A.A.throwInstantiationError()}}}),iJ.prototype.hasProperty=function(e,t){A.A.throwInstantiationError()},iJ.prototype.getFeature=function(e){A.A.throwInstantiationError()},iJ.prototype.applyDebugSettings=function(e,t){A.A.throwInstantiationError()},iJ.prototype.applyStyle=function(e){A.A.throwInstantiationError()},iJ.prototype.update=function(e,t){A.A.throwInstantiationError()},iJ.prototype.pick=function(e,t,n){A.A.throwInstantiationError()},iJ.prototype.isDestroyed=function(){A.A.throwInstantiationError()},iJ.prototype.destroy=function(){A.A.throwInstantiationError()};const oJ=iJ;var rJ=n(891846),sJ=n(621065),aJ=n(223702),cJ=n(468741),lJ=n(45679),uJ=n(649413),dJ=n(294023),hJ=n(661314),AJ=n(629606),pJ=n(816968),fJ=n(979830),mJ=n(800859),gJ=n(409211);function _J(e){e=e??S.A.EMPTY_OBJECT,this._maximumSubtreeCount=e.maximumSubtreeCount??0,this._subtreeRequestCounter=0,this._queue=new tP({comparator:_J.comparator})}function yJ(e,t){this.subtree=e,this.stamp=t}_J.prototype.addSubtree=function(e){const t=new yJ(e,this._subtreeRequestCounter);this._subtreeRequestCounter++,this._queue.insert(t);const n=e.implicitCoordinates;if(n.level>0){const e=n.getParentSubtreeCoordinates();if(void 0===this.find(e))throw new A.A("parent node needs to exist")}if(this._maximumSubtreeCount>0)for(;this._queue.length>this._maximumSubtreeCount&&this._queue.getMinimum()!==t;)this._queue.removeMinimum()},_J.prototype.find=function(e){const t=this._queue,n=t.internalArray,i=t.length;for(let t=0;t<i;t++){const i=n[t],o=i.subtree.implicitCoordinates;if(e.isEqual(o))return i.subtree}},_J.comparator=function(e,t){const n=e.subtree.implicitCoordinates,i=t.subtree.implicitCoordinates;return n.isAncestor(i)?1:i.isAncestor(n)?-1:e.stamp-t.stamp};const vJ=_J;var TJ=n(410974),bJ=n(834957),wJ=n(165955),xJ=n(192518),CJ=n(872182);function EJ(e){e=e??S.A.EMPTY_OBJECT;const{className:t,names:n,types:i,componentTypes:o,shape:r,dimensions:s,paddingBefore:a=j.A.ZERO.clone(),paddingAfter:c=j.A.ZERO.clone(),globalTransform:u=O.A.IDENTITY.clone(),shapeTransform:d=O.A.IDENTITY.clone(),minBounds:h,maxBounds:A,minimumValues:p,maximumValues:f,maximumTileCount:m}=e;l.A.typeOf.string("className",t),l.A.typeOf.object("names",n),l.A.typeOf.object("types",i),l.A.typeOf.object("componentTypes",o),l.A.typeOf.string("shape",r),l.A.typeOf.object("dimensions",s),this._shapeTransform=d,this._globalTransform=u,this._shape=r,this._minBounds=h,this._maxBounds=A,this._dimensions=s,this._paddingBefore=a,this._paddingAfter=c,this._className=t,this._names=n,this._types=i,this._componentTypes=o,this._metadataOrder=r===mQ.ELLIPSOID?kq.Z_UP:kq.Y_UP,this._minimumValues=p,this._maximumValues=f,this._maximumTileCount=m,this._availableLevels=void 0,this._implicitTileset=void 0,this._subtreeCache=new vJ}Object.defineProperties(EJ.prototype,{globalTransform:{get:function(){return this._globalTransform}},shapeTransform:{get:function(){return this._shapeTransform}},shape:{get:function(){return this._shape}},minBounds:{get:function(){return this._minBounds}},maxBounds:{get:function(){return this._maxBounds}},dimensions:{get:function(){return this._dimensions}},paddingBefore:{get:function(){return this._paddingBefore}},paddingAfter:{get:function(){return this._paddingAfter}},className:{get:function(){return this._className}},names:{get:function(){return this._names}},types:{get:function(){return this._types}},componentTypes:{get:function(){return this._componentTypes}},metadataOrder:{get:function(){return this._metadataOrder}},minimumValues:{get:function(){return this._minimumValues}},maximumValues:{get:function(){return this._maximumValues}},maximumTileCount:{get:function(){return this._maximumTileCount}},availableLevels:{get:function(){return this._availableLevels}}}),EJ.fromUrl=async function(e){l.A.defined("url",e);const t=Lt.A.createIfNeeded(e),n=await t.fetchJson();!function(e){const t=e.root;if(!(0,d.A)(t.content))throw new M.A("Root must have content");if(!(0,mJ.A)(t.content,"3DTILES_content_voxels"))throw new M.A("Root tile content must have 3DTILES_content_voxels extension");if(!(0,mJ.A)(t,"3DTILES_implicit_tiling")&&!(0,d.A)(t.implicitTiling))throw new M.A("Root tile must have implicit tiling");if(!(0,d.A)(e.schema)&&!(0,d.A)(e.schemaUri)&&!(0,mJ.A)(e,"3DTILES_metadata"))throw new M.A("Tileset must have a metadata schema")}(n);const i=function(e,t){const{schemaUri:n,schema:i}=e;return(0,d.A)(n)?CJ.A.getSchemaLoader({resource:t.getDerivedResource({url:n})}):CJ.A.getSchemaLoader({schema:i})}(n,t);await i.load();const{root:o}=n,r=(0,mJ.A)(n,"3DTILES_metadata")?n.extensions["3DTILES_metadata"]:n,s=new fJ.A({metadataJson:r,schema:i.schema}),a=o.content.extensions["3DTILES_content_voxels"],c=function(e,t){const{schema:n,statistics:i}=e,o=i?.classes[t],r=n.classes[t].properties,s=Object.entries(r).map(([e,t])=>{const{type:n,componentType:i}=t,r=o?.properties[e].min,s=o?.properties[e].max,a=yF.A.getComponentCount(n);return{id:e,type:n,componentType:i,minValue:PJ(r,a),maxValue:PJ(s,a)}}),a=s.map(e=>e.id),c=s.map(e=>e.type),l=s.map(e=>e.componentType),u=s.map(e=>e.minValue),h=s.map(e=>e.maxValue),A=u.some(d.A);return{className:t,names:a,types:c,componentTypes:l,minimumValues:A?u:void 0,maximumValues:A?h:void 0}}(s,a.class);Object.assign(c,function(e){const t=e.boundingVolume;if((0,d.A)(t.box))return function(e){const t=lD.A.unpack(e),n=Z.A.getScale(t.halfAxes,SJ),i=Z.A.getRotation(t.halfAxes,IJ);return{shape:mQ.BOX,minBounds:j.A.negate(n,new j.A),maxBounds:j.A.clone(n),shapeTransform:O.A.fromRotationTranslation(i,t.center)}}(t.box);if((0,d.A)(t.region))return function(e){const t=e[0],n=e[1],i=e[2],o=e[3],r=e[4],s=e[5],a=O.A.fromScale(K.A.WGS84.radii),c=new j.A(t,n,r),l=new j.A(i,o,s);return{shape:mQ.ELLIPSOID,minBounds:c,maxBounds:l,shapeTransform:a}}(t.region);if((0,mJ.A)(t,"3DTILES_bounding_volume_cylinder"))return function(e){const{minRadius:t,maxRadius:n,height:i,minAngle:o=-J.A.PI,maxAngle:r=J.A.PI,translation:s=[0,0,0],rotation:a=[0,0,0,1]}=e;l.A.typeOf.number("minRadius",t),l.A.typeOf.number("maxRadius",n),l.A.typeOf.number("height",i),l.A.typeOf.number("minAngle",o),l.A.typeOf.number("maxAngle",r),l.A.typeOf.object("translation",s),l.A.typeOf.object("rotation",a);const c=-.5*i+s[2],u=.5*i+s[2],d=O.A.fromTranslationQuaternionRotationScale(j.A.unpack(s),To.A.unpack(a),j.A.ONE);return{shape:mQ.CYLINDER,minBounds:j.A.fromElements(t,o,c),maxBounds:j.A.fromElements(n,r,u),shapeTransform:d}}(t.extensions["3DTILES_bounding_volume_cylinder"]);throw new M.A("Only box, region and 3DTILES_bounding_volume_cylinder are supported in Cesium3DTilesVoxelProvider")}(o)),(0,d.A)(o.transform)?c.globalTransform=O.A.unpack(o.transform):c.globalTransform=O.A.clone(O.A.IDENTITY),c.dimensions=j.A.unpack(a.dimensions),c.maximumTileCount=function(e){if((0,d.A)(e.tileset))return e.tileset.getPropertyBySemantic(wJ.A.TILESET_TILE_COUNT)}(s),(0,d.A)(a.padding)&&(c.paddingBefore=j.A.unpack(a.padding.before),c.paddingAfter=j.A.unpack(a.padding.after));const u=new EJ(c),h=new bJ.A(t,o,i.schema);return u._implicitTileset=h,u._availableLevels=h.availableLevels,CJ.A.unload(i),u};const SJ=new j.A,IJ=new Z.A;function PJ(e,t){if(!(0,d.A)(e))return;const n=Array.isArray(e)?e:[e];return Array.from({length:t},(e,t)=>n[t])}EJ.prototype.requestData=async function(e){e=e??S.A.EMPTY_OBJECT;const{tileLevel:t=0,tileX:n=0,tileY:i=0,tileZ:o=0,keyframe:r=0}=e;if(0!==r)return Promise.reject("3D Tiles currently doesn't support time-dynamic data.");const s=this._implicitTileset,a=new TJ.A({subdivisionScheme:s.subdivisionScheme,subtreeLevels:s.subtreeLevels,level:t,x:n,y:i,z:o}),c=a.isSubtreeRoot()&&a.level>0,l=c?a.getParentSubtreeCoordinates():a.getSubtreeCoordinates(),u=await async function(e,t){const n=e._implicitTileset,i=e._subtreeCache;let o=i.find(t);if((0,d.A)(o))return o;const r=n.subtreeUriTemplate.getDerivedResource({templateValues:t.getTemplateValues()}),s=n.baseResource.getDerivedResource({url:r.url}),a=await s.fetchArrayBuffer();if(o=i.find(t),(0,d.A)(o))return o;const c=(0,xJ.A)(a);return o=await gJ.A.fromSubtreeJson(s,c.jsonPayload,c.binaryPayload,n,t),i.addSubtree(o),o}(this,l);if(!(c?u.childSubtreeIsAvailableAtCoordinates:u.tileIsAvailableAtCoordinates).call(u,a))return Promise.reject(`Tile is not available at level ${t}, x ${n}, y ${i}, z ${o}.`);const{contentUriTemplates:h,baseResource:A}=s,p=h[0].getDerivedResource({templateValues:a.getTemplateValues()}),f=A.getDerivedResource({url:p.url});return hj.fromGltf(f)};const DJ=EJ;var OJ=n(329554),RJ=n(648117),MJ=n(529755),LJ=n(741740),NJ=n(724812),BJ=n(727541);function FJ(e){e=e??1,l.A.typeOf.number.greaterThan("radius",e,0),this._radius=e??1}Object.defineProperties(FJ.prototype,{radius:{get:function(){return this._radius},set:function(e){l.A.typeOf.number.greaterThan("value",e,0),this._radius=e}}}),FJ.prototype.emit=function(e){const t=J.A.randomBetween(0,J.A.TWO_PI),n=J.A.randomBetween(0,this._radius),i=n*Math.cos(t),o=n*Math.sin(t);e.position=j.A.fromElements(i,o,0,e.position),e.velocity=j.A.clone(j.A.UNIT_Z,e.velocity)};const UJ=FJ;var kJ=n(627853),VJ=n(23708),zJ=n(506964);const HJ={CUMULUS:0,validate:function(e){return e===HJ.CUMULUS}},GJ=Object.freeze(HJ);function WJ(e,t){if(e=e??S.A.EMPTY_OBJECT,this._show=e.show??!0,this._position=j.A.clone(e.position??j.A.ZERO),!(0,d.A)(e.scale)&&(0,d.A)(e.maximumSize))this._maximumSize=j.A.clone(e.maximumSize),this._scale=new q.A(this._maximumSize.x,this._maximumSize.y);else{this._scale=q.A.clone(e.scale??new q.A(20,12));const t=new j.A(this._scale.x,this._scale.y,Math.min(this._scale.x,this._scale.y)/1.5);this._maximumSize=j.A.clone(e.maximumSize??t)}this._slice=e.slice??-1,this._color=u.A.clone(e.color??u.A.WHITE),this._brightness=e.brightness??1,this._cloudCollection=t,this._index=-1}const YJ=WJ.SHOW_INDEX=0,qJ=WJ.POSITION_INDEX=1,jJ=WJ.SCALE_INDEX=2,QJ=WJ.MAXIMUM_SIZE_INDEX=3,XJ=WJ.SLICE_INDEX=4,KJ=WJ.BRIGHTNESS_INDEX=5,$J=WJ.COLOR_INDEX=6;function JJ(e,t){const n=e._cloudCollection;(0,d.A)(n)&&(n._updateCloud(e,t),e._dirty=!0)}WJ.NUMBER_OF_PROPERTIES=7,Object.defineProperties(WJ.prototype,{show:{get:function(){return this._show},set:function(e){l.A.typeOf.bool("value",e),this._show!==e&&(this._show=e,JJ(this,YJ))}},position:{get:function(){return this._position},set:function(e){l.A.typeOf.object("value",e);const t=this._position;j.A.equals(t,e)||(j.A.clone(e,t),JJ(this,qJ))}},scale:{get:function(){return this._scale},set:function(e){l.A.typeOf.object("value",e);const t=this._scale;q.A.equals(t,e)||(q.A.clone(e,t),JJ(this,jJ))}},maximumSize:{get:function(){return this._maximumSize},set:function(e){l.A.typeOf.object("value",e);const t=this._maximumSize;j.A.equals(t,e)||(j.A.clone(e,t),JJ(this,QJ))}},color:{get:function(){return this._color},set:function(e){l.A.typeOf.object("value",e);const t=this._color;u.A.equals(t,e)||(u.A.clone(e,t),JJ(this,$J))}},slice:{get:function(){return this._slice},set:function(e){l.A.typeOf.number("value",e),this._slice!==e&&(this._slice=e,JJ(this,XJ))}},brightness:{get:function(){return this._brightness},set:function(e){l.A.typeOf.number("value",e),this._brightness!==e&&(this._brightness=e,JJ(this,KJ))}}}),WJ.prototype._destroy=function(){this._cloudCollection=void 0};const ZJ=WJ;let eZ;const tZ=new j.A,nZ={positionHighAndScaleX:0,positionLowAndScaleY:1,packedAttribute0:2,packedAttribute1:3,color:4},iZ={direction:0,positionHighAndScaleX:1,positionLowAndScaleY:2,packedAttribute0:3,packedAttribute1:4,color:5},oZ=ZJ.SHOW_INDEX,rZ=ZJ.POSITION_INDEX,sZ=ZJ.SCALE_INDEX,aZ=ZJ.MAXIMUM_SIZE_INDEX,cZ=ZJ.SLICE_INDEX,lZ=ZJ.BRIGHTNESS_INDEX,uZ=ZJ.NUMBER_OF_PROPERTIES,dZ=ZJ.COLOR_INDEX;function hZ(e){e=e??S.A.EMPTY_OBJECT,this._clouds=[],this._cloudsToUpdate=[],this._cloudsToUpdateIndex=0,this._cloudsRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(uZ),this._noiseTexture=void 0,this._textureSliceWidth=128,this._noiseTextureRows=4,this.noiseDetail=e.noiseDetail??16,this.noiseOffset=j.A.clone(e.noiseOffset??j.A.ZERO),this._loading=!1,this._ready=!1;const t=this;this._uniforms={u_noiseTexture:function(){return t._noiseTexture},u_noiseTextureDimensions:AZ(t),u_noiseDetail:function(){return t.noiseDetail}},this._vaNoise=void 0,this._spNoise=void 0,this._spCreated=!1,this._sp=void 0,this._rs=void 0,this.show=e.show??!0,this._colorCommands=[],this.debugBillboards=e.debugBillboards??!1,this._compiledDebugBillboards=!1,this.debugEllipsoids=e.debugEllipsoids??!1,this._compiledDebugEllipsoids=!1}function AZ(e){return function(){return tZ.x=e._textureSliceWidth,tZ.y=e._noiseTextureRows,tZ.z=1/e._noiseTextureRows,tZ}}function pZ(e){const t=e.length;for(let n=0;n<t;++n)e[n]&&e[n]._destroy()}function fZ(e){if(e._cloudsRemoved){e._cloudsRemoved=!1;const t=[],n=e._clouds,i=n.length;for(let e=0,o=0;e<i;++e){const i=n[e];(0,d.A)(i)&&(n._index=o++,t.push(i))}e._clouds=t}}Object.defineProperties(hZ.prototype,{length:{get:function(){return fZ(this),this._clouds.length}}}),hZ.prototype.add=function(e){const t=(e=e??S.A.EMPTY_OBJECT).cloudType??GJ.CUMULUS;if(!GJ.validate(t))throw new A.A("invalid cloud type");let n;return t===GJ.CUMULUS&&(n=new ZJ(e,this),n._index=this._clouds.length,this._clouds.push(n),this._createVertexArray=!0),n},hZ.prototype.remove=function(e){return!!this.contains(e)&&(this._clouds[e._index]=void 0,this._cloudsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0)},hZ.prototype.removeAll=function(){pZ(this._clouds),this._clouds=[],this._cloudsToUpdate=[],this._cloudsToUpdateIndex=0,this._cloudsRemoved=!1,this._createVertexArray=!0},hZ.prototype._updateCloud=function(e,t){e._dirty||(this._cloudsToUpdate[this._cloudsToUpdateIndex++]=e),++this._propertiesChanged[t]},hZ.prototype.contains=function(e){return(0,d.A)(e)&&e._cloudCollection===this},hZ.prototype.get=function(e){return l.A.typeOf.number("index",e),fZ(this),this._clouds[e]};const mZ=new Float32Array([-1,-1,1,-1,1,1,-1,1]),gZ=new Uint16Array([0,1,2,0,2,3]);let _Z;function yZ(e){let t=e.cache.cloudCollection_indexBufferBatched;if((0,d.A)(t))return t;const n=new Uint16Array(98298);for(let e=0,t=0;e<98298;e+=6,t+=4)n[e]=t,n[e+1]=t+1,n[e+2]=t+2,n[e+3]=t,n[e+4]=t+2,n[e+5]=t+3;return t=o.A.createIndexBuffer({context:e,typedArray:n,usage:r.A.STATIC_DRAW,indexDatatype:Pr.A.UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.cloudCollection_indexBufferBatched=t,t}function vZ(e){let t=e.cache.cloudCollection_indexBufferInstanced;return(0,d.A)(t)||(t=o.A.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:r.A.STATIC_DRAW,indexDatatype:Pr.A.UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.cloudCollection_indexBufferInstanced=t),t}function TZ(e){let t=e.cache.cloudCollection_vertexBufferInstanced;return(0,d.A)(t)||(t=o.A.createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:r.A.STATIC_DRAW}),t.vertexArrayDestroyable=!1,e.cache.cloudCollection_vertexBufferInstanced=t),t}const bZ=new $.A;function wZ(e,t,n,i){let o;const r=n[eZ.positionHighAndScaleX],s=n[eZ.positionLowAndScaleY],a=i.position;$.A.fromCartesian(a,bZ);const c=i.scale,l=bZ.high,u=bZ.low;e._instanced?(o=i._index,r(o,l.x,l.y,l.z,c.x),s(o,u.x,u.y,u.z,c.y)):(o=4*i._index,r(o+0,l.x,l.y,l.z,c.x),r(o+1,l.x,l.y,l.z,c.x),r(o+2,l.x,l.y,l.z,c.x),r(o+3,l.x,l.y,l.z,c.x),s(o+0,u.x,u.y,u.z,c.y),s(o+1,u.x,u.y,u.z,c.y),s(o+2,u.x,u.y,u.z,c.y),s(o+3,u.x,u.y,u.z,c.y))}function xZ(e,t,n,i){let o;const r=n[eZ.packedAttribute0],s=i.show,a=i.brightness;e._instanced?(o=i._index,r(o,s,a,0,0)):(o=4*i._index,r(o+0,s,a,0,0),r(o+1,s,a,1,0),r(o+2,s,a,1,1),r(o+3,s,a,0,1))}function CZ(e,t,n,i){let o;const r=n[eZ.packedAttribute1],s=i.maximumSize,a=i.slice;e._instanced?(o=i._index,r(o,s.x,s.y,s.z,a)):(o=4*i._index,r(o+0,s.x,s.y,s.z,a),r(o+1,s.x,s.y,s.z,a),r(o+2,s.x,s.y,s.z,a),r(o+3,s.x,s.y,s.z,a))}function EZ(e,t,n,i){let o;const r=n[eZ.color],s=i.color,a=u.A.floatToByte(s.red),c=u.A.floatToByte(s.green),l=u.A.floatToByte(s.blue),d=u.A.floatToByte(s.alpha);e._instanced?(o=i._index,r(o,a,c,l,d)):(o=4*i._index,r(o+0,a,c,l,d),r(o+1,a,c,l,d),r(o+2,a,c,l,d),r(o+3,a,c,l,d))}function SZ(e,t,n,i){wZ(e,0,n,i),xZ(e,0,n,i),CZ(e,0,n,i),EZ(e,0,n,i)}const IZ=[];hZ.prototype.update=function(e){if(fZ(this),!this.show)return;const t=this.debugBillboards||this.debugEllipsoids;this._ready=!!t||(0,d.A)(this._noiseTexture),this._ready||this._loading||t||function(e,t,n,i){const s=e,c=s._textureSliceWidth,l=s._noiseTextureRows;if(c/l<1||c%l!==0)throw new A.A("noiseTextureRows must evenly divide textureSliceWidth");const u=t.context;s._vaNoise=function(e){const t=o.A.createVertexBuffer({context:e,typedArray:mZ,usage:r.A.STATIC_DRAW}),n=o.A.createIndexBuffer({context:e,typedArray:gZ,usage:r.A.STATIC_DRAW,indexDatatype:Pr.A.UNSIGNED_SHORT}),i=[{index:0,vertexBuffer:t,componentsPerAttribute:2,componentDatatype:C.A.FLOAT}];return new je.A({context:e,attributes:i,indexBuffer:n})}(u),s._spNoise=y.A.fromCache({context:u,vertexShaderSource:n,fragmentShaderSource:i,attributeLocations:{position:0}});const d=s.noiseDetail,h=s.noiseOffset;s._noiseTexture=new G.A({context:u,width:c*c/l,height:c*l,pixelDatatype:U.A.UNSIGNED_BYTE,pixelFormat:R.A.RGBA,sampler:new At.A({wrapS:It.A.REPEAT,wrapT:It.A.REPEAT,minificationFilter:bt.A.NEAREST,magnificationFilter:Tt.A.NEAREST})});const p=new a.A({vertexArray:s._vaNoise,shaderProgram:s._spNoise,outputTexture:s._noiseTexture,uniformMap:{u_noiseTextureDimensions:AZ(s),u_noiseDetail:function(){return d},u_noiseOffset:function(){return h}},persists:!1,owner:e,postExecute:function(e){s._ready=!0,s._loading=!1}});t.commandList.push(p),s._loading=!0}(this,e,lS,cS),this._instanced=e.context.instancedArrays,eZ=this._instanced?iZ:nZ,_Z=this._instanced?vZ:yZ;const n=this._clouds.length,i=this._cloudsToUpdate,s=this._cloudsToUpdateIndex;this._createVertexArray?function(e,t){const n=e,i=t.context;n._createVertexArray=!1,n._vaf=n._vaf&&n._vaf.destroy();const o=e._clouds,s=o.length;if(s>0){n._vaf=function(e,t,n){const i=[{index:eZ.positionHighAndScaleX,componentsPerAttribute:4,componentDatatype:C.A.FLOAT,usage:r.A.STATIC_DRAW},{index:eZ.positionLowAndScaleY,componentsPerAttribute:4,componentDatatype:C.A.FLOAT,usage:r.A.STATIC_DRAW},{index:eZ.packedAttribute0,componentsPerAttribute:4,componentDatatype:C.A.FLOAT,usage:r.A.STATIC_DRAW},{index:eZ.packedAttribute1,componentsPerAttribute:4,componentDatatype:C.A.FLOAT,usage:r.A.STATIC_DRAW},{index:eZ.color,componentsPerAttribute:4,componentDatatype:C.A.UNSIGNED_BYTE,normalize:!0,usage:r.A.STATIC_DRAW}];n&&i.push({index:eZ.direction,componentsPerAttribute:2,componentDatatype:C.A.FLOAT,vertexBuffer:TZ(e)});const o=n?t:4*t;return new Pt.A(e,i,o,n)}(i,s,n._instanced);const t=n._vaf.writers;let a;for(a=0;a<s;++a)SZ(e,0,t,o[a]);n._vaf.commit(_Z(i))}}(this,e):s>0&&function(e,t){const n=t.context,i=e,o=i._clouds.length,r=i._cloudsToUpdate,s=i._cloudsToUpdateIndex,a=i._propertiesChanged,c=IZ;c.length=0,(a[rZ]||a[sZ])&&c.push(wZ),(a[oZ]||a[lZ])&&c.push(xZ),(a[aZ]||a[cZ])&&c.push(CZ),a[dZ]&&c.push(EZ);const l=c.length,u=i._vaf.writers;let d,h,A;if(s/o>.1){for(d=0;d<s;++d)for(h=r[d],h._dirty=!1,A=0;A<l;++A)c[A](e,t,u,h);i._vaf.commit(_Z(n))}else{for(d=0;d<s;++d){for(h=r[d],h._dirty=!1,A=0;A<l;++A)c[A](e,t,u,h);i._instanced?i._vaf.subCommit(h._index,1):i._vaf.subCommit(4*h._index,4)}i._vaf.endSubCommits()}i._cloudsToUpdateIndex=0}(this,e),s>1.5*n&&(i.length=n),!(0,d.A)(this._vaf)||!(0,d.A)(this._vaf.va)||!this._ready&!t||(this._spCreated&&this.debugBillboards===this._compiledDebugBillboards&&this.debugEllipsoids===this._compiledDebugEllipsoids||function(e,t,n,i){const o=t.context,r=e,s=new k.A({defines:[],sources:[n]});r._instanced&&s.defines.push("INSTANCED");const a=new k.A({defines:[],sources:[i]});r.debugBillboards&&a.defines.push("DEBUG_BILLBOARDS"),r.debugEllipsoids&&a.defines.push("DEBUG_ELLIPSOIDS"),r._sp=y.A.replaceCache({context:o,shaderProgram:r._sp,vertexShaderSource:s,fragmentShaderSource:a,attributeLocations:eZ}),r._rs=_.A.fromCache({depthTest:{enabled:!0,func:L.A.LESS},depthMask:!1,blending:$M.A.ALPHA_BLEND}),r._spCreated=!0,r._compiledDebugBillboards=r.debugBillboards,r._compiledDebugEllipsoids=r.debugEllipsoids}(this,e,aS,sS),function(e,t){const n=e,i=t.passes,o=n._uniforms,r=t.commandList;if(i.render){const t=n._colorCommands,i=n._vaf.va,s=i.length;t.length=s;for(let a=0;a<s;a++){let s=t[a];(0,d.A)(s)||(s=t[a]=new m.A),s.pass=ut.A.TRANSLUCENT,s.owner=e,s.uniformMap=o,s.count=i[a].indicesCount,s.vertexArray=i[a].va,s.shaderProgram=n._sp,s.renderState=n._rs,n._instanced&&(s.count=6,s.instanceCount=n._clouds.length),r.push(s)}}}(this,e))},hZ.prototype.isDestroyed=function(){return!1},hZ.prototype.destroy=function(){return this._noiseTexture=this._noiseTexture&&this._noiseTexture.destroy(),this._sp=this._sp&&this._sp.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),pZ(this._clouds),(0,h.A)(this)};const PZ=hZ;var DZ=n(583511),OZ=n(33138);const RZ=J.A.toRadians(30);function MZ(e){this._angle=e??RZ}Object.defineProperties(MZ.prototype,{angle:{get:function(){return this._angle},set:function(e){l.A.typeOf.number("value",e),this._angle=e}}}),MZ.prototype.emit=function(e){const t=Math.tan(this._angle),n=J.A.randomBetween(0,J.A.TWO_PI),i=J.A.randomBetween(0,t),o=i*Math.cos(n),r=i*Math.sin(n);e.velocity=j.A.fromElements(o,r,1,e.velocity),j.A.normalize(e.velocity,e.velocity),e.position=j.A.clone(j.A.ZERO,e.position)};const LZ=MZ;var NZ=n(35204);function BZ(e){const t=(e=e??S.A.EMPTY_OBJECT).attributeName;let n=e.perInstanceAttribute;if(!(0,d.A)(t))throw new A.A("options.attributeName is required.");(0,d.A)(n)||(n=!1);let i=e.glslDatatype??"vec3";const o=`v_${t}`;let r;if("normal"===t||"tangent"===t||"bitangent"===t)r=`vec4 getColor() { return vec4((${o} + vec3(1.0)) * 0.5, 1.0); }\n`;else switch("st"===t&&(i="vec2"),i){case"float":r=`vec4 getColor() { return vec4(vec3(${o}), 1.0); }\n`;break;case"vec2":r=`vec4 getColor() { return vec4(${o}, 0.0, 1.0); }\n`;break;case"vec3":r=`vec4 getColor() { return vec4(${o}, 1.0); }\n`;break;case"vec4":r=`vec4 getColor() { return ${o}; }\n`;break;default:throw new A.A("options.glslDatatype must be float, vec2, vec3, or vec4.")}const s=`in vec3 position3DHigh;\nin vec3 position3DLow;\nin float batchId;\n${n?"":`in ${i} ${t};\n`}out ${i} ${o};\nvoid main()\n{\nvec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);\n${n?`${o} = czm_batchTable_${t}(batchId);\n`:`${o} = ${t};\n`}gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}`,a=`in ${i} ${o};\n${r}\nvoid main()\n{\nout_FragColor = getColor();\n}`;this.material=void 0,this.translucent=e.translucent??!1,this._vertexShaderSource=e.vertexShaderSource??s,this._fragmentShaderSource=e.fragmentShaderSource??a,this._renderState=O$.A.getDefaultRenderState(!1,!1,e.renderState),this._closed=e.closed??!1,this._attributeName=t,this._glslDatatype=i}Object.defineProperties(BZ.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},attributeName:{get:function(){return this._attributeName}},glslDatatype:{get:function(){return this._glslDatatype}}}),BZ.prototype.getFragmentShaderSource=O$.A.prototype.getFragmentShaderSource,BZ.prototype.isTranslucent=O$.A.prototype.isTranslucent,BZ.prototype.getRenderState=O$.A.prototype.getRenderState;const FZ=BZ;function UZ(e){e=e??S.A.EMPTY_OBJECT,this.length=e.length??1e7,this._length=void 0,this.width=e.width??2,this._width=void 0,this.show=e.show??!0,this.modelMatrix=O.A.clone(e.modelMatrix??O.A.IDENTITY),this._modelMatrix=new O.A,this.id=e.id,this._id=void 0,this._primitive=void 0}UZ.prototype.update=function(e){if(this.show){if(!(0,d.A)(this._primitive)||!O.A.equals(this._modelMatrix,this.modelMatrix)||this._length!==this.length||this._width!==this.width||this._id!==this.id){this._modelMatrix=O.A.clone(this.modelMatrix,this._modelMatrix),this._length=this.length,this._width=this.width,this._id=this.id,(0,d.A)(this._primitive)&&this._primitive.destroy(),0===this.modelMatrix[12]&&0===this.modelMatrix[13]&&0===this.modelMatrix[14]&&(this.modelMatrix[14]=.01);const e=new yn.A({geometry:new Am.A({positions:[j.A.ZERO,j.A.UNIT_X],width:this.width,vertexFormat:um.A.VERTEX_FORMAT,colors:[u.A.RED,u.A.RED],arcType:zs.A.NONE}),modelMatrix:O.A.multiplyByUniformScale(this.modelMatrix,this.length,new O.A),id:this.id,pickPrimitive:this}),t=new yn.A({geometry:new Am.A({positions:[j.A.ZERO,j.A.UNIT_Y],width:this.width,vertexFormat:um.A.VERTEX_FORMAT,colors:[u.A.GREEN,u.A.GREEN],arcType:zs.A.NONE}),modelMatrix:O.A.multiplyByUniformScale(this.modelMatrix,this.length,new O.A),id:this.id,pickPrimitive:this}),n=new yn.A({geometry:new Am.A({positions:[j.A.ZERO,j.A.UNIT_Z],width:this.width,vertexFormat:um.A.VERTEX_FORMAT,colors:[u.A.BLUE,u.A.BLUE],arcType:zs.A.NONE}),modelMatrix:O.A.multiplyByUniformScale(this.modelMatrix,this.length,new O.A),id:this.id,pickPrimitive:this});this._primitive=new Pn.A({geometryInstances:[e,t,n],appearance:new um.A,asynchronous:!1})}this._primitive.update(e)}},UZ.prototype.isDestroyed=function(){return!1},UZ.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),(0,h.A)(this)};const kZ=UZ;var VZ=n(489970),zZ=n(253478),HZ=n(836721),GZ=n(615557);const WZ="in vec3 v_positionMC;\nin vec3 v_positionEC;\nin vec2 v_st;\n\nvoid main()\n{\n    czm_materialInput materialInput;\n\n    vec3 normalEC = normalize(czm_normal3D * czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0)));\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    materialInput.s = v_st.s;\n    materialInput.st = v_st;\n    materialInput.str = vec3(v_st, 0.0);\n\n    // Convert tangent space material normal to eye space\n    materialInput.normalEC = normalEC;\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, materialInput.normalEC);\n\n    // Convert view vector to world space\n    vec3 positionToEyeEC = -v_positionEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n#endif\n}\n",YZ="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec2 st;\nin float batchId;\n\nout vec3 v_positionMC;\nout vec3 v_positionEC;\nout vec2 v_st;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionMC = position3DHigh + position3DLow;           // position in model coordinates\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;     // position in eye coordinates\n    v_st = st;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n";function qZ(e){const t=(e=e??S.A.EMPTY_OBJECT).translucent??!0,n=e.aboveGround??!1;this.material=(0,d.A)(e.material)?e.material:Dn.A.fromType(Dn.A.ColorType),this.translucent=e.translucent??!0,this._vertexShaderSource=e.vertexShaderSource??YZ,this._fragmentShaderSource=e.fragmentShaderSource??WZ,this._renderState=O$.A.getDefaultRenderState(t,!n,e.renderState),this._closed=!1,this._flat=e.flat??!1,this._faceForward=e.faceForward??n,this._aboveGround=n}Object.defineProperties(qZ.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return qZ.VERTEX_FORMAT}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}},aboveGround:{get:function(){return this._aboveGround}}}),qZ.VERTEX_FORMAT=Rr.A.POSITION_AND_ST,qZ.prototype.getFragmentShaderSource=O$.A.prototype.getFragmentShaderSource,qZ.prototype.isTranslucent=O$.A.prototype.isTranslucent,qZ.prototype.getRenderState=O$.A.prototype.getRenderState;const jZ=qZ;var QZ=n(84269),XZ=n(168064),KZ=n(203576);function $Z(e){if(!(0,d.A)(e)||!(0,d.A)(e.scene))throw new A.A("options.scene is required.");this._scene=e.scene,this.samplingWindow=e.samplingWindow??$Z.defaultSettings.samplingWindow,this.quietPeriod=e.quietPeriod??$Z.defaultSettings.quietPeriod,this.warmupPeriod=e.warmupPeriod??$Z.defaultSettings.warmupPeriod,this.minimumFrameRateDuringWarmup=e.minimumFrameRateDuringWarmup??$Z.defaultSettings.minimumFrameRateDuringWarmup,this.minimumFrameRateAfterWarmup=e.minimumFrameRateAfterWarmup??$Z.defaultSettings.minimumFrameRateAfterWarmup,this._lowFrameRate=new Bn.A,this._nominalFrameRate=new Bn.A,this._frameTimes=[],this._needsQuietPeriod=!0,this._quietPeriodEndTime=0,this._warmupPeriodEndTime=0,this._frameRateIsLow=!1,this._lastFramesPerSecond=void 0,this._pauseCount=0;const t=this;this._preUpdateRemoveListener=this._scene.preUpdate.addEventListener(function(e,n){!function(e){if(e._pauseCount>0)return;const t=(0,aa.A)();if(e._needsQuietPeriod)e._needsQuietPeriod=!1,e._frameTimes.length=0,e._quietPeriodEndTime=t+e.quietPeriod/ne.A.SECONDS_PER_MILLISECOND,e._warmupPeriodEndTime=e._quietPeriodEndTime+(e.warmupPeriod+e.samplingWindow)/ne.A.SECONDS_PER_MILLISECOND;else if(t>=e._quietPeriodEndTime){e._frameTimes.push(t);const n=t-e.samplingWindow/ne.A.SECONDS_PER_MILLISECOND;if(e._frameTimes.length>=2&&e._frameTimes[0]<=n){for(;e._frameTimes.length>=2&&e._frameTimes[1]<n;)e._frameTimes.shift();const i=(t-e._frameTimes[0])/(e._frameTimes.length-1);e._lastFramesPerSecond=1e3/i,i>1e3/(t>e._warmupPeriodEndTime?e.minimumFrameRateAfterWarmup:e.minimumFrameRateDuringWarmup)?e._frameRateIsLow||(e._frameRateIsLow=!0,e._needsQuietPeriod=!0,e.lowFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond)):e._frameRateIsLow&&(e._frameRateIsLow=!1,e._needsQuietPeriod=!0,e.nominalFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond))}}}(t)}),this._hiddenPropertyName=void 0!==document.hidden?"hidden":void 0!==document.mozHidden?"mozHidden":void 0!==document.msHidden?"msHidden":void 0!==document.webkitHidden?"webkitHidden":void 0;const n=void 0!==document.hidden?"visibilitychange":void 0!==document.mozHidden?"mozvisibilitychange":void 0!==document.msHidden?"msvisibilitychange":void 0!==document.webkitHidden?"webkitvisibilitychange":void 0;function i(){var e;e=t,document[e._hiddenPropertyName]?e.pause():e.unpause()}this._visibilityChangeRemoveListener=void 0,(0,d.A)(n)&&(document.addEventListener(n,i,!1),this._visibilityChangeRemoveListener=function(){document.removeEventListener(n,i,!1)})}$Z.defaultSettings={samplingWindow:5,quietPeriod:2,warmupPeriod:5,minimumFrameRateDuringWarmup:4,minimumFrameRateAfterWarmup:8},$Z.fromScene=function(e){if(!(0,d.A)(e))throw new A.A("scene is required.");return(0,d.A)(e._frameRateMonitor)&&!e._frameRateMonitor.isDestroyed()||(e._frameRateMonitor=new $Z({scene:e})),e._frameRateMonitor},Object.defineProperties($Z.prototype,{scene:{get:function(){return this._scene}},lowFrameRate:{get:function(){return this._lowFrameRate}},nominalFrameRate:{get:function(){return this._nominalFrameRate}},lastFramesPerSecond:{get:function(){return this._lastFramesPerSecond}}}),$Z.prototype.pause=function(){++this._pauseCount,1===this._pauseCount&&(this._frameTimes.length=0,this._lastFramesPerSecond=void 0)},$Z.prototype.unpause=function(){--this._pauseCount,this._pauseCount<=0&&(this._pauseCount=0,this._needsQuietPeriod=!0)},$Z.prototype.isDestroyed=function(){return!1},$Z.prototype.destroy=function(){return this._preUpdateRemoveListener(),(0,d.A)(this._visibilityChangeRemoveListener)&&this._visibilityChangeRemoveListener(),(0,h.A)(this)};const JZ=$Z;var ZZ=n(271845),e0=n(472360),t0=n(873536),n0=n(44706),i0=n(257601),o0=n(823064),r0=n(463823),s0=n(582047),a0=n(201783),c0=n(395989),l0=n(385618),u0=n(560710),d0=n(782556),h0=n(705919),A0=n(582998),p0=n(952575),f0=n(946240);function m0(){this._image=new Image}function g0(e){e=e??S.A.EMPTY_OBJECT,this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tileDiscardPolicy=e.tileDiscardPolicy,this._tilingScheme=new eI.A({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new Or.A(-J.A.PI,-J.A.PI,J.A.PI,J.A.PI),ellipsoid:e.ellipsoid});let t=e.credit;"string"==typeof t&&(t=new Ws.A(t)),this._credit=t,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=23,(0,d.A)(this._tileDiscardPolicy)||(this._tileDiscardPolicy=new m0),this._errorEvent=new Bn.A}m0.prototype.isReady=function(){return!0},m0.prototype.shouldDiscardImage=function(e){return e===this._image},Object.defineProperties(g0.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._metadata.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!1}}}),g0.fromMetadata=function(e,t){if(l.A.defined("metadata",e),!e.imageryPresent)throw new M.A(`The server ${e.url} doesn't have imagery`);const n=new g0(t);return n._metadata=e,n},g0.prototype.getTileCredits=function(e,t,n){const i=this._metadata,o=i.getTileInformation(e,t,n);if((0,d.A)(o)){const e=i.providers[o.imageryProvider];if((0,d.A)(e))return[e]}},g0.prototype.requestImage=function(e,t,n,i){const o=this._tileDiscardPolicy._image,r=this._metadata,s=aD.tileXYToQuadKey(e,t,n),a=r.getTileInformation(e,t,n);if(!(0,d.A)(a)){if(r.isValid(s)){const o=new iI.A({throttle:i.throttle,throttleByServer:i.throttleByServer,type:i.type,priorityFunction:i.priorityFunction});return void r.populateSubtree(e,t,n,o)}return Promise.resolve(o)}if(!a.hasImagery())return Promise.resolve(o);const c=function(e,t,n,i,o,r){const s=aD.tileXYToQuadKey(n,i,o);let a=t.imageryVersion;return a=(0,d.A)(a)&&a>0?a:1,e._metadata.resource.getDerivedResource({url:`flatfile?f1-0${s}-i.${a.toString()}`,request:r})}(this,a,e,t,n,i).fetchArrayBuffer();return(0,d.A)(c)?c.then(function(e){hM(r.key,e);let t,n=new Uint8Array(e);const i=r.protoImagery;if((0,d.A)(i)&&i||(t=function(e){const t="JFIF";if(e[6]===t.charCodeAt(0)&&e[7]===t.charCodeAt(1)&&e[8]===t.charCodeAt(2)&&e[9]===t.charCodeAt(3))return"image/jpeg";const n="PNG";return e[1]===n.charCodeAt(0)&&e[2]===n.charCodeAt(1)&&e[3]===n.charCodeAt(2)?"image/png":void 0}(n)),!(0,d.A)(t)&&(!(0,d.A)(i)||i)){const e=function(e){const t=qP.Reader.create(e),n=t.len,i={};for(;t.pos<n;){const e=t.uint32();let n;switch(e>>>3){case 1:i.imageType=t.uint32();break;case 2:i.imageData=t.bytes();break;case 3:i.alphaType=t.uint32();break;case 4:i.imageAlpha=t.bytes();break;case 5:if(n=i.copyrightIds,(0,d.A)(n)||(n=i.copyrightIds=[]),2==(7&e)){const e=t.uint32()+t.pos;for(;t.pos<e;)n.push(t.uint32())}else n.push(t.uint32());break;default:t.skipType(7&e)}}const o=i.imageType;if((0,d.A)(o))switch(o){case 0:i.imageType="image/jpeg";break;case 4:i.imageType="image/png";break;default:throw new M.A("GoogleEarthEnterpriseImageryProvider: Unsupported image type.")}const r=i.alphaType;return(0,d.A)(r)&&0!==r&&(console.log("GoogleEarthEnterpriseImageryProvider: External alpha not supported."),delete i.alphaType,delete i.imageAlpha),i}(n);t=e.imageType,n=e.imageData}return(0,d.A)(t)&&(0,d.A)(n)?(0,EM.A)({uint8Array:n,format:t,flipY:!0}):o}):void 0},g0.prototype.pickFeatures=function(e,t,n,i,o){};const _0=g0;var y0=n(38300);const v0=new u.A(1,1,1,.4),T0=new u.A(0,1,0,.05),b0=new u.A(0,.5,0,.2);function w0(e){e=e??S.A.EMPTY_OBJECT,this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tilingScheme=(0,d.A)(e.tilingScheme)?e.tilingScheme:new eI.A({ellipsoid:e.ellipsoid}),this._cells=e.cells??8,this._color=e.color??v0,this._glowColor=e.glowColor??T0,this._glowWidth=e.glowWidth??6,this._backgroundColor=e.backgroundColor??b0,this._errorEvent=new Bn.A,this._tileWidth=e.tileWidth??256,this._tileHeight=e.tileHeight??256,this._canvasSize=e.canvasSize??256,this._canvas=this._createGridCanvas()}Object.defineProperties(w0.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}}),w0.prototype._drawGrid=function(e){const t=this._canvasSize;for(let n=0;n<=this._cells;++n){const i=1+n/this._cells*(t-1);e.moveTo(i,0),e.lineTo(i,t),e.moveTo(0,i),e.lineTo(t,i)}e.stroke()},w0.prototype._createGridCanvas=function(){const e=document.createElement("canvas");e.width=this._canvasSize,e.height=this._canvasSize;const t=this._canvasSize,n=e.getContext("2d"),i=this._backgroundColor.toCssColorString();n.fillStyle=i,n.fillRect(0,0,t,t);const o=this._glowColor.toCssColorString();n.strokeStyle=o,n.lineWidth=this._glowWidth,n.strokeRect(0,0,t,t),this._drawGrid(n),n.lineWidth=.5*this._glowWidth,n.strokeRect(0,0,t,t),this._drawGrid(n);const r=this._color.toCssColorString();return n.strokeStyle=r,n.lineWidth=2,n.strokeRect(0,0,t,t),n.lineWidth=1,this._drawGrid(n),e},w0.prototype.getTileCredits=function(e,t,n){},w0.prototype.requestImage=function(e,t,n,i){return Promise.resolve(this._canvas)},w0.prototype.pickFeatures=function(e,t,n,i,o){};const x0=w0;var C0=n(834298);function E0(){}E0._maxDecodingConcurrency=Math.max(lP.A.hardwareConcurrency-1,1),E0._decodeTaskProcessor=new ZP.A("decodeI3S",E0._maxDecodingConcurrency),E0._promise=void 0,E0.decode=async function(e,t,n,i,o){return l.A.typeOf.string("url",e),l.A.defined("defaultGeometrySchema",t),l.A.defined("geometryData",n),(0,d.A)(E0._promise)||(E0._promise=async function(){if(await E0._decodeTaskProcessor.initWebAssemblyModule({wasmBinaryFile:"ThirdParty/draco_decoder.wasm"}))return E0._decodeTaskProcessor;throw new M.A("I3S decoder could not be initialized.")}()),E0._promise.then(function(r){const s=n._parent._data,a=n._parent._inverseRotationMatrix;let c=0,l=0,u=0;(0,d.A)(s.obb)?(c=s.obb.center[0],l=s.obb.center[1],u=s.obb.center[2]):(0,d.A)(s.mbs)&&(c=s.mbs[0],l=s.mbs[1],u=s.mbs[2]);const h=Z.A.fromRotationX(-J.A.PI_OVER_TWO),A=new Z.A;Z.A.multiply(h,a,A);const p=X.A.fromDegrees(c,l,u),f=K.A.WGS84.cartographicToCartesian(p),m={binaryData:n._data,featureData:(0,d.A)(i)&&(0,d.A)(i[0])?i[0].data:void 0,schema:t,bufferInfo:n._geometryBufferInfo,ellipsoidRadiiSquare:K.A.WGS84.radiiSquared,url:e,geoidDataList:n._dataProvider._geoidDataList,cartographicCenter:p,cartesianCenter:f,parentRotation:A,enableFeatures:n._dataProvider.showFeatures,splitGeometryByColorTransparency:n._dataProvider.adjustMaterialAlphaMode,symbologyData:o,calculateNormals:n._dataProvider.calculateNormals};return r.scheduleTask(m)})};const S0=E0;function I0(e,t){this._parent=e,this._dataProvider=e._dataProvider,this._layer=e._layer,(0,d.A)(this._parent._nodeIndex)?this._resource=this._parent._layer.resource.getDerivedResource({url:`nodes/${this._parent._data.mesh.attribute.resource}/${t}`}):this._resource=this._parent.resource.getDerivedResource({url:t})}Object.defineProperties(I0.prototype,{resource:{get:function(){return this._resource}},data:{get:function(){return this._data}}}),I0.prototype.load=async function(){return this._data=await T1.loadJson(this._resource),this._data};const P0=I0;function D0(e,t){this._storageInfo=t,this._parent=e,this._dataProvider=e._dataProvider,this._loadPromise=void 0;const n=`attributes/${t.key}/0`;(0,d.A)(this._parent._nodeIndex)?this._resource=this._parent._layer.resource.getDerivedResource({url:`nodes/${this._parent._data.mesh.attribute.resource}/${n}`}):this._resource=this._parent.resource.getDerivedResource({url:n})}function O0(e){return"UInt8"===e||"Int8"===e?1:"UInt16"===e||"Int16"===e?2:"UInt32"===e||"Int32"===e||"Oid32"===e||"Float32"===e?4:"UInt64"===e||"Int64"===e||"Float64"===e?8:0}function R0(e){return"String"===e?1:O0(e)}Object.defineProperties(D0.prototype,{resource:{get:function(){return this._resource}},header:{get:function(){return this._header}},values:{get:function(){if((0,d.A)(this._values)){if((0,d.A)(this._values.attributeValues))return this._values.attributeValues;if((0,d.A)(this._values.objectIds))return this._values.objectIds}return[]}},name:{get:function(){return this._storageInfo.name}}}),D0.prototype.load=function(){return(0,d.A)(this._loadPromise)||(this._loadPromise=async function(e){const t=await e._dataProvider._loadBinary(e._resource),n=new DataView(t);e._data=t,e._validateHeader(n);const i=e._parseHeader(n),o=e._getBodyOffset(i);e._validateBody(n,o),e._parseBody(n,o)}(this).catch(function(e){console.error(e)})),this._loadPromise},D0.prototype._parseValue=function(e,t,n){let i;if("UInt8"===t)i=e.getUint8(n),n+=1;else if("Int8"===t)i=e.getInt8(n),n+=1;else if("UInt16"===t)i=e.getUint16(n,!0),n+=2;else if("Int16"===t)i=e.getInt16(n,!0),n+=2;else if("UInt32"===t)i=e.getUint32(n,!0),n+=4;else if("Oid32"===t)i=e.getUint32(n,!0),n+=4;else if("Int32"===t)i=e.getInt32(n,!0),n+=4;else if("UInt64"===t){const t=e.getUint32(n,!0),o=e.getUint32(n+4,!0);i=t+Math.pow(2,32)*o,n+=8}else if("Int64"===t){const t=e.getUint32(n,!0),o=e.getUint32(n+4,!0);i=o<Math.pow(2,31)?t+Math.pow(2,32)*o:t+Math.pow(2,32)*(o-Math.pow(2,32)),n+=8}else"Float32"===t?(i=e.getFloat32(n,!0),n+=4):"Float64"===t?(i=e.getFloat64(n,!0),n+=8):"String"===t&&(i=String.fromCharCode(e.getUint8(n)),n+=1);return{value:i,offset:n}},D0.prototype._parseHeader=function(e){let t=0;this._header={};for(let n=0;n<this._storageInfo.header.length;n++){const i=this._storageInfo.header[n],o=this._parseValue(e,i.valueType,t);this._header[i.property]=o.value,t=o.offset}return t},D0.prototype._parseBody=function(e,t){this._values={};for(let n=0;n<this._storageInfo.ordering.length;n++){const i=this._storageInfo.ordering[n],o="ObjectIds"===i?"objectIds":i,r=this._storageInfo[o];if((0,d.A)(r)){this._values[o]=[];for(let n=0;n<this._header.count;++n)if("String"!==r.valueType){const n=this._parseValue(e,r.valueType,t);this._values[o].push(n.value),t=n.offset}else{const i=this._values.attributeByteCounts[n];let s="";for(let n=0;n<i;++n){const n=this._parseValue(e,r.valueType,t);0!==n.value.charCodeAt(0)&&(s+=n.value),t=n.offset}this._values[o].push(s)}}}},D0.prototype._getBodyOffset=function(e){let t=0;return(0,d.A)(this._storageInfo.attributeValues)?t=O0(this._storageInfo.attributeValues.valueType):(0,d.A)(this._storageInfo.objectIds)&&(t=O0(this._storageInfo.objectIds.valueType)),t>0?Math.ceil(e/t)*t:e},D0.prototype._validateHeader=function(e){let t=0;for(let e=0;e<this._storageInfo.header.length;e++)t+=R0(this._storageInfo.header[e].valueType);if(e.byteLength<t)throw new M.A(`Invalid attribute buffer size (field: ${this.name}, header: ${t}, actual: ${e.byteLength})`)},D0.prototype._validateBody=function(e,t){if(!(0,d.A)(this._header.count))throw new M.A(`Invalid attribute buffer (field: ${this.name}, count is missing)`);let n;for(let i=0;i<this._storageInfo.ordering.length&&t<e.byteLength;i++){const o=this._storageInfo.ordering[i],r="ObjectIds"===o?"objectIds":o,s=this._storageInfo[r];if(!(0,d.A)(s))throw new M.A(`Invalid attribute buffer (field: ${this.name}, ${r} is missing)`);if("String"!==s.valueType)"attributeByteCounts"===r&&(n=t),t+=O0(s.valueType)*this._header.count;else{if(!(0,d.A)(n))throw new M.A(`Invalid attribute buffer (field: ${this.name}, attributeByteCounts is missing)`);for(let i=0;i<this._header.count&&t<e.byteLength;++i){const i=this._parseValue(e,this._storageInfo.attributeByteCounts.valueType,n);t+=i.value,n=i.offset}}}if(e.byteLength<t)throw new M.A(`Invalid attribute buffer size (field: ${this.name}, expected: ${t}, actual: ${e.byteLength})`)};const M0=D0;function L0(e,t){const n=e._dataProvider,i=e._layer;let o;o=(0,d.A)(e._nodeIndex)?i.resource.getDerivedResource({url:`nodes/${e._data.mesh.geometry.resource}/${t}`}):e.resource.getDerivedResource({url:t}),this._parent=e,this._dataProvider=n,this._layer=i,this._resource=o,this._customAttributes=void 0}Object.defineProperties(L0.prototype,{resource:{get:function(){return this._resource}},data:{get:function(){return this._data}},customAttributes:{get:function(){return this._customAttributes}}}),L0.prototype.load=function(){const e=this;return this._dataProvider._loadBinary(this._resource).then(function(t){return e._data=t,t})};const N0=new j.A,B0=new j.A,F0=new j.A,U0=new j.A,k0=new j.A;function V0(e,t,n,i){const o=j.A.subtract(i,n,N0),r=j.A.cross(o,j.A.subtract(e,n,B0),U0),s=j.A.cross(o,j.A.subtract(t,n,F0),k0);return j.A.dot(r,s)>=0}const z0=new j.A,H0=new j.A,G0=new j.A,W0=new j.A,Y0=new j.A,q0=new j.A,j0=new j.A,Q0=new j.A,X0=new j.A,K0=new j.A;function $0(e){const t=[],n=e.length;for(let i=0;i<n;i++)i<3?t.push(UM(e[i])):t.push(e[i]);return t}L0.prototype.getClosestPointIndexOnTriangle=function(e,t,n){if((0,d.A)(this._customAttributes)&&(0,d.A)(this._customAttributes.positions)){const i=new j.A(e,t,n);i.x-=this._customAttributes.cartesianCenter.x,i.y-=this._customAttributes.cartesianCenter.y,i.z-=this._customAttributes.cartesianCenter.z,Z.A.multiplyByVector(this._customAttributes.parentRotation,i,i);let o,r,s,a,c=Number.MAX_VALUE;const l=this._customAttributes.positions,u=this._customAttributes.indices;let h;h=(0,d.A)(u)?u.length:l.length/3;for(let e=0;e<h;e++){let t,n,h;(0,d.A)(u)?(t=u[e],n=u[e+1],h=u[e+2]):(t=3*e,n=3*e+1,h=3*e+2);const A=j.A.fromElements(l[3*t],l[3*t+1],l[3*t+2],z0),p=j.A.fromElements(l[3*n],l[3*n+1],l[3*n+2],H0),f=new j.A(l[3*h],l[3*h+1],l[3*h+2],G0);if(!V0(i,A,p,f)||!V0(i,p,A,f)||!V0(i,f,A,p))continue;const m=j.A.subtract(p,A,W0),g=j.A.subtract(f,A,Y0),_=j.A.cross(m,g,q0);if(0===j.A.magnitude(_))continue;const y=j.A.normalize(_,j0),v=j.A.subtract(i,A,Q0),T=Math.abs(j.A.dot(v,y));if(T<c){c=T,o=e;const l=j.A.magnitudeSquared(j.A.subtract(i,A,v)),u=j.A.magnitudeSquared(j.A.subtract(i,p,X0)),d=j.A.magnitudeSquared(j.A.subtract(i,f,K0));l<u&&l<d?(s=t,a=A,r=l):u<d?(s=n,a=p,r=u):(s=h,a=f,r=d)}}if((0,d.A)(o))return{index:s,distanceSquared:r,distance:Math.sqrt(r),queriedPosition:i,closestPosition:j.A.clone(a)}}return{index:-1,distanceSquared:Number.Infinity,distance:Number.Infinity}},L0.prototype._generateGltf=function(e,t,n,i,o,r,s,a){let c,l={pbrMetallicRoughness:{metallicFactor:0},doubleSided:!0,name:"Material"},u=!1,h="";if((0,d.A)(this._parent._data.mesh)&&(0,d.A)(this._layer._data.materialDefinitions)){const e=this._parent._data.mesh.material.definition;if(e>=0&&e<this._layer._data.materialDefinitions.length){if(c=this._layer._data.materialDefinitions[e],l=c,(0,d.A)(l.pbrMetallicRoughness)&&(0,d.A)(l.pbrMetallicRoughness.baseColorTexture)){u=!0,l.pbrMetallicRoughness.baseColorTexture.index=0;let e="0";if((0,d.A)(this._layer._data.textureSetDefinitions))for(let t=0;t<this._layer._data.textureSetDefinitions.length;t++){const n=this._layer._data.textureSetDefinitions[t];for(let t=0;t<n.formats.length;t++){const i=n.formats[t];if("jpg"===i.format){e=i.name;break}}}(0,d.A)(this._parent._data.mesh)&&this._parent._data.mesh.material.resource>=0&&(h=this._layer.resource.getDerivedResource({url:`nodes/${this._parent._data.mesh.material.resource}/textures/${e}`}).url)}(0,d.A)(l.pbrMetallicRoughness)&&(0,d.A)(l.pbrMetallicRoughness.baseColorFactor)&&(l.pbrMetallicRoughness.baseColorFactor=$0(l.pbrMetallicRoughness.baseColorFactor)),(0,d.A)(l.emissiveFactor)&&(l.emissiveFactor=$0(l.emissiveFactor))}}else(0,d.A)(this._parent._data.textureData)&&(u=!0,h=this._parent.resource.getDerivedResource({url:`${this._parent._data.textureData[0].href}`}).url,l.pbrMetallicRoughness.baseColorTexture={index:0});(0,d.A)(l.alphaMode)&&(l.alphaMode=l.alphaMode.toUpperCase());let A=[],p=[],f=[];u&&(A=[{sampler:0,source:0}],p=[{uri:h}],f=[{magFilter:9729,minFilter:9986,wrapS:10497,wrapT:10497}]);const m=[],g=n.length;for(let e=0;e<g;e++){const t=n[e].primitives,i=t.length;for(let e=0;e<i;e++){const n=t[e];if((0,d.A)(n.material)){for(;n.material>=m.length;){const e=(0,_t.A)(l,!0);m.push(e)}const e=m[n.material];(0,d.A)(n.extra)&&n.extra.isTransparent?(0,d.A)(e.alphaMode)||(e.alphaMode="BLEND"):"BLEND"===e.alphaMode&&(e.alphaMode="OPAQUE")}}}return{scene:0,scenes:[{nodes:e}],nodes:t,meshes:n,buffers:i,bufferViews:o,accessors:r,materials:m,textures:A,images:p,samplers:f,asset:{version:"2.0"},extensions:s,extensionsUsed:a}};const J0=L0;function Z0(e,t,n){let i,o,r,s;n?(i=0,o=e):(i=e._level+1,o=e._layer),"number"==typeof t?r=t:s=e.resource.getDerivedResource({url:`${t}/`}),this._parent=e,this._dataProvider=e._dataProvider,this._isRoot=n,this._level=i,this._layer=o,this._nodeIndex=r,this._resource=s,this._isLoading=!1,this._tile=void 0,this._data=void 0,this._geometryData=[],this._featureData=[],this._fields={},this._children=[],this._childrenReadyPromise=void 0,this._globalTransform=void 0,this._inverseGlobalTransform=void 0,this._inverseRotationMatrix=void 0,this._symbologyData=void 0}function e1(e,t){const n=new M0(e,t);return e._fields[t.name]=n,n.load()}function t1(e,t,n){if(!(0,d.A)(n.values)||0===n.values.length)return!1;const i=(0,d.A)(t)?t.values:[];let o;e<i.length&&(o=i[e]);let r=!1;for(let e=0;e<n.values.length;e++)if(n.values[e]===o){r=!0;break}return r}async function n1(e,t){const n=e._tile.content.batchTable;if((0,d.A)(n)&&n.featuresLength>0){n.setAllShow(!0);const t=await async function(e){const t=e._layer._filters,n=[];for(let i=0;i<t.length;i++){const o=e.loadField(t[i].name);n.push(o)}return await Promise.all(n),t}(e);if(t.length>0)for(let i=0;i<n.featuresLength;i++)for(let o=0;o<t.length;o++){const r=t[o];if(!t1(i,e._fields[r.name],r)){n.setShow(i,!1);break}}}t.show=!0}function i1(e,t,n,i){return i[e+t*n]}function o1(e,t,n){const i=n.nativeExtent;let o=(e-i.west)/(i.east-i.west)*(n.width-1),r=(t-i.south)/(i.north-i.south)*(n.height-1);const s=Math.floor(o);let a=Math.floor(r);o-=s,r-=a;const c=s<n.width?s+1:s;let l=a<n.height?a+1:a;a=n.height-1-a,l=n.height-1-l;let u=(d=o,h=r,A=i1(s,a,n.width,n.buffer),p=i1(c,a,n.width,n.buffer),f=i1(s,l,n.width,n.buffer),m=i1(c,l,n.width,n.buffer),(A*(1-d)+p*d)*(1-h)+(f*(1-d)+m*d)*h);var d,h,A,p,f,m;return u=u*n.scale+n.offset,u}Object.defineProperties(Z0.prototype,{resource:{get:function(){return this._resource}},layer:{get:function(){return this._layer}},parent:{get:function(){return this._parent}},children:{get:function(){return this._children}},geometryData:{get:function(){return this._geometryData}},featureData:{get:function(){return this._featureData}},fields:{get:function(){return this._fields}},tile:{get:function(){return this._tile}},data:{get:function(){return this._data}}}),Z0.prototype.load=async function(){const e=this;function t(){if(!e._isRoot){const t=e._create3DTileDefinition();e._tile=new tJ.A(e._layer._tileset,e._dataProvider.resource,t,e._parent._tile),e._tile._i3sNode=e}}if(!(0,d.A)(this._nodeIndex)){const n=await T1.loadJson(this._resource);return e._data=n,void t()}const n=await this._layer._getNodeInNodePages(this._nodeIndex);let i;e._data=n,e._isRoot?i="nodes/root/":(0,d.A)(n.mesh)&&(i=`../${n.mesh.geometry.resource}/`),(0,d.A)(i)&&(0,d.A)(e._parent.resource)&&(e._resource=e._parent.resource.getDerivedResource({url:i})),t()},Z0.prototype.loadFields=function(){const e=this._layer._data.attributeStorageInfo,t=[];if((0,d.A)(e))for(let n=0;n<e.length;n++){const i=e[n],o=this._fields[i.name];(0,d.A)(o)?t.push(o.load()):t.push(e1(this,i))}return Promise.all(t)},Z0.prototype.loadField=function(e){l.A.defined("name",e);const t=this._fields[e];if((0,d.A)(t))return t.load();const n=this._layer._data.attributeStorageInfo;if((0,d.A)(n))for(let t=0;t<n.length;t++){const i=n[t];if(i.name===e)return e1(this,i)}return Promise.resolve()},Z0.prototype.getFieldsForPickedPosition=function(e){const t=this.geometryData[0];if(!(0,d.A)(t.customAttributes.featureIndex))return{};const n=t.getClosestPointIndexOnTriangle(e.x,e.y,e.z);if(-1===n.index||n.index>t.customAttributes.featureIndex.length)return{};const i=t.customAttributes.featureIndex[n.index];return this.getFieldsForFeature(i)},Z0.prototype.getFieldsForFeature=function(e){const t={};for(const n in this.fields)if(this.fields.hasOwnProperty(n)){const i=this.fields[n];e>=0&&e<i.values.length&&(t[i.name]=i.values[e])}return t},Z0.prototype._loadChildren=function(){const e=this;if((0,d.A)(this._childrenReadyPromise))return this._childrenReadyPromise;const t=[];if((0,d.A)(e._data.children))for(let n=0;n<e._data.children.length;n++){const i=e._data.children[n],o=new Z0(e,i.href??i,!1);e._children.push(o),t.push(o.load())}return this._childrenReadyPromise=Promise.all(t).then(function(){for(let t=0;t<e._children.length;t++)e._tile.children.push(e._children[t]._tile)}),this._childrenReadyPromise},Z0.prototype._loadGeometryData=function(){const e=[];if((0,d.A)(this._data.geometryData))for(let t=0;t<this._data.geometryData.length;t++){const n=new J0(this,this._data.geometryData[t].href);this._geometryData.push(n),e.push(n.load())}else if((0,d.A)(this._data.mesh)){const t=this._layer._findBestGeometryBuffers(this._data.mesh.geometry.definition,["position","uv0"]),n=`./geometries/${t.bufferIndex}/`,i=new J0(this,n);i._geometryDefinitions=t.definition,i._geometryBufferInfo=t.geometryBufferInfo,this._geometryData.push(i),e.push(i.load())}return Promise.all(e)},Z0.prototype._loadFeatureData=function(){const e=[];if((0,d.A)(this._data.featureData))for(let t=0;t<this._data.featureData.length;t++){const n=new P0(this,this._data.featureData[t].href);this._featureData.push(n),e.push(n.load())}return Promise.all(e)},Z0.prototype._clearGeometryData=function(){this._geometryData=[]},Z0.prototype._create3DTileDefinition=function(){const e=this._data.obb,t=this._data.mbs;if(!(0,d.A)(e)&&!(0,d.A)(t))return void console.error("Failed to load I3S node. Bounding volume is required.");let n;if(n=(0,d.A)(e)?X.A.fromDegrees(e.center[0],e.center[1],e.center[2]):X.A.fromDegrees(t[0],t[1],t[2]),(0,d.A)(this._dataProvider._geoidDataList)&&(0,d.A)(n))for(let e=0;e<this._dataProvider._geoidDataList.length;e++){const t=this._dataProvider._geoidDataList[e],i=t.projection.project(n);if(i.x>t.nativeExtent.west&&i.x<t.nativeExtent.east&&i.y>t.nativeExtent.south&&i.y<t.nativeExtent.north){n.height+=o1(i.x,i.y,t);break}}let i,o={},r=0;(0,d.A)(e)?(o={box:[0,0,0,e.halfSize[0],0,0,0,e.halfSize[1],0,0,0,e.halfSize[2]]},r=Math.max(Math.max(this._data.obb.halfSize[0],this._data.obb.halfSize[1]),this._data.obb.halfSize[2]),i=K.A.WGS84.cartographicToCartesian(n)):(o={sphere:[0,0,0,t[3]]},i=K.A.WGS84.cartographicToCartesian(n),r=this._data.mbs[3]),r*=2;let s=1/0;if((0,d.A)(this._data.lodThreshold))"maxScreenThresholdSQ"===this._layer._data.nodePages.lodSelectionMetricType?s=r/Math.sqrt(this._data.lodThreshold/(.25*Math.PI)):"maxScreenThreshold"===this._layer._data.nodePages.lodSelectionMetricType?s=r/this._data.lodThreshold:console.error("Invalid lodSelectionMetricType in Layer");else if((0,d.A)(this._data.lodSelection))for(let e=0;e<this._data.lodSelection.length;e++)"maxScreenThreshold"===this._data.lodSelection[e].metricType&&(s=r/this._data.lodSelection[e].maxError);s===1/0&&(s=1e5);const a=16*s,c=new bv.A(0,0,0);let l=xe.A.headingPitchRollQuaternion(i,c);(0,d.A)(this._data.obb)&&(l=new To.A(this._data.obb.quaternion[0],this._data.obb.quaternion[1],this._data.obb.quaternion[2],this._data.obb.quaternion[3]));const u=Z.A.fromQuaternion(l),h=Z.A.inverse(u,new Z.A),A=new O.A(u[0],u[1],u[2],0,u[3],u[4],u[5],0,u[6],u[7],u[8],0,i.x,i.y,i.z,1),p=O.A.inverse(A,new O.A),f=O.A.clone(A);(0,d.A)(this._parent._globalTransform)&&O.A.multiply(A,this._parent._inverseGlobalTransform,f),this._globalTransform=A,this._inverseGlobalTransform=p,this._inverseRotationMatrix=h;const m=[];for(let e=0;e<this._children.length;e++)m.push(this._children[e]._create3DTileDefinition());return{children:m,refine:"REPLACE",boundingVolume:o,transform:[f[0],f[4],f[8],f[12],f[1],f[5],f[9],f[13],f[2],f[6],f[10],f[14],f[3],f[7],f[11],f[15]],content:{uri:(0,d.A)(this._resource)?this._resource.url:void 0},geometricError:a}},Z0.prototype._loadSymbology=async function(){!(0,d.A)(this._symbologyData)&&(0,d.A)(this._layer._symbology)&&(this._symbologyData=await this._layer._symbology._getSymbology(this))},Z0.prototype._createContentURL=async function(){let e={scene:0,scenes:[{nodes:[0]}],nodes:[{name:"singleNode"}],meshes:[],buffers:[],bufferViews:[],accessors:[],materials:[],textures:[],images:[],samplers:[],asset:{version:"2.0"}};const t=[this._loadGeometryData()];if(this._dataProvider.legacyVersion16&&t.push(this._loadFeatureData()),await Promise.all(t),(0,d.A)(this._geometryData)&&this._geometryData.length>0){this._dataProvider._applySymbology&&await this._loadSymbology();const t=this._geometryData[0].resource.url,n=this._layer._data.store.defaultGeometrySchema,i=this._geometryData[0],o=await S0.decode(t,n,i,this._featureData[0],this._symbologyData);if(!(0,d.A)(o))return;e=i._generateGltf(o.meshData.nodesInScene,o.meshData.nodes,o.meshData.meshes,o.meshData.buffers,o.meshData.bufferViews,o.meshData.accessors,o.meshData.rootExtensions,o.meshData.extensionsUsed),this._geometryData[0]._customAttributes=o.meshData._customAttributes}const n=this._dataProvider._binarizeGltf(e),i=new Blob([n],{type:"application/binary"});return URL.createObjectURL(i)},Z0.prototype._filterFeatures=function(){const e=[];for(let t=0;t<this._children.length;t++){const n=this._children[t]._filterFeatures();e.push(n)}const t=this._tile?.content?._model;if((0,d.A)(this._geometryData)&&this._geometryData.length>0&&(0,d.A)(t)&&t.ready){t.show=!1;const n=n1(this,t);e.push(n)}return Promise.all(e)},tJ.A.prototype._hookedRequestContent=tJ.A.prototype.requestContent,tJ.A.prototype.requestContent=function(){if(!this.tileset._isI3STileSet)return this._hookedRequestContent();if(!this._isLoading){this._isLoading=!0;const e=this;return this._i3sNode._createContentURL().then(t=>{if((0,d.A)(t))return e._contentResource=new Lt.A({url:t}),e._hookedRequestContent();e._isLoading=!1}).then(t=>{const n=t?._model;return(0,d.A)(e._i3sNode._geometryData)&&e._i3sNode._geometryData.length>0&&(0,d.A)(n)&&(n.show=!1,n.readyEvent.addEventListener(()=>{n1(e._i3sNode,n)})),e._isLoading=!1,t})}},Object.defineProperties(tJ.A.prototype,{i3sNode:{get:function(){return this._i3sNode}}});const r1=Z0;function s1(e){this._layer=e,this._defaultSymbology=void 0,this._valueFields=[],this._uniqueValueHash=void 0,this._classBreaksHash=void 0,this._parseLayerSymbology()}function a1(e,t){const n=[];for(let t=0;t<e.length;t++){const i=u.A.byteToFloat(e[t]);t<3?n.push(UM(i)):n.push(i)}return 3===n.length&&((0,d.A)(t)?n.push(1-t/100):n.push(1)),n}function c1(e,t){const n={edges:void 0,material:void 0};if((0,d.A)(e)&&(0,d.A)(e.symbolLayers))for(let i=0;i<e.symbolLayers.length;i++){const o=e.symbolLayers[i];if("Fill"===o.type){const e=o.edges,i=o.outline;if((0,d.A)(e)?(n.edges={},(0,d.A)(e.color)&&(n.edges.color=a1(e.color,e.transparency))):(0,d.A)(i)&&(n.edges={},(0,d.A)(i.color)&&(n.edges.color=a1(i.color,i.transparency))),!t){const e=o.material;(0,d.A)(e)&&(n.material={colorMixMode:e.colorMixMode},(0,d.A)(e.color)&&(n.material.color=a1(e.color,e.transparency)))}break}}return n}function l1(e,t,n,i){const o=t[n];if(i<o.length){const r=e[o[i]];return(0,d.A)(r)&&++n<t.length?l1(r,t,n,i):r}}Object.defineProperties(s1.prototype,{defaultSymbology:{get:function(){return this._defaultSymbology}}}),s1.prototype._parseLayerSymbology=function(){const e=this._layer.data.drawingInfo;if((0,d.A)(e)&&(0,d.A)(e.renderer)){const t=this._layer.data.cachedDrawingInfo,n=(0,d.A)(t)&&!0===t.color,i=e.renderer;"simple"===i.type?this._defaultSymbology=c1(i.symbol,n):"uniqueValue"===i.type?(this._defaultSymbology=c1(i.defaultSymbol,n),this._valueFields.push(i.field1),(0,d.A)(i.field2)&&this._valueFields.push(i.field2),(0,d.A)(i.field3)&&this._valueFields.push(i.field3),this._uniqueValueHash=function(e,t){if((0,d.A)(e.uniqueValueGroups)){const n={};for(let i=0;i<e.uniqueValueGroups.length;i++){const o=e.uniqueValueGroups[i].classes;if((0,d.A)(o))for(let e=0;e<o.length;e++){const i=c1(o[e].symbol,t),r=o[e].values;for(let e=0;e<r.length;e++){const t=r[e];let o=n;for(let e=0;e<t.length;e++){const n=t[e];e===t.length-1?o[n]=i:((0,d.A)(o[n])||(o[n]={}),o=o[n])}}}}return n}if((0,d.A)(e.uniqueValueInfos)){const n={};for(let i=0;i<e.uniqueValueInfos.length;i++){const o=e.uniqueValueInfos[i];n[o.value]=c1(o.symbol,t)}return n}}(i,n)):"classBreaks"===i.type&&(this._defaultSymbology=c1(i.defaultSymbol,n),this._valueFields.push(i.field),this._classBreaksHash=function(e,t){if((0,d.A)(e.classBreakInfos)){const n=[...e.classBreakInfos];n.sort(function(e,t){return(e.classMaxValue??e.classMinValue)-(t.classMaxValue??t.classMinValue)});const i={ranges:[],symbols:[]};(0,d.A)(e.minValue)&&(i.ranges.push(e.minValue),i.symbols.push(void 0));for(let e=0;e<n.length;e++){const o=n[e];(0,d.A)(o.classMinValue)&&(0===i.ranges.length||o.classMinValue>i.ranges[i.ranges.length-1])&&(i.ranges.push(o.classMinValue),i.symbols.push(void 0)),(0,d.A)(o.classMaxValue)&&(0===i.ranges.length||o.classMaxValue>i.ranges[i.ranges.length-1])&&(i.ranges.push(o.classMaxValue),i.symbols.push(c1(o.symbol,t)))}return i.symbols.push(void 0),i}}(i,n))}},s1.prototype._getSymbology=async function(e){const t={default:this._defaultSymbology};if(this._valueFields.length>0){const n=[];for(let t=0;t<this._valueFields.length;t++)n.push(e.loadField(this._valueFields[t]));await Promise.all(n);const i=[];for(let t=0;t<this._valueFields.length;t++)i.push(e.fields[this._valueFields[t]].values);let o;if((0,d.A)(this._uniqueValueHash)?o=e=>l1(this._uniqueValueHash,i,0,e):(0,d.A)(this._classBreaksHash)&&(o=e=>function(e,t,n){const i=t[n],o=function(e,t){let n=0,i=e.length;if(n<i)do{const o=n+i>>>1;e[o]<t?n=o+1:i=o}while(n<i);return n}(e.ranges,i);return e.symbols[o]}(this._classBreaksHash,i[0],e)),(0,d.A)(o)){const e=i[0];for(let n=0;n<e.length;n++){const e=o(n);(0,d.A)(e)&&(t[n]=e)}}}return t};const u1=s1;function d1(e,t,n){this._dataProvider=e,this._parent=n,!(0,d.A)(t.href)&&(0,d.A)(t.id)&&(t.href=`layers/${t.id}`);const i=this._parent.resource.getUrlComponent();let o="";o=i.match(/layers\/\d/)?`${i}`.replace(/\/+$/,""):`${i}`.replace(/\/?$/,"/").concat(`${t.href}`),this._version=t.store.version;const r=this._version.split(".");this._majorVersion=parseInt(r[0]),this._minorVersion=r.length>1?parseInt(r[1]):0,this._resource=new Lt.A({url:o}),this._resource.setQueryParameters(this._dataProvider.resource.queryParameters),this._resource.appendForwardSlash(),this._data=t,this._rootNode=void 0,this._nodePages={},this._nodePageFetches={},this._extent=void 0,this._tileset=void 0,this._geometryDefinitions=void 0,this._filters=[],this._symbology=void 0,this._computeGeometryDefinitions(!0),this._computeExtent()}Object.defineProperties(d1.prototype,{resource:{get:function(){return this._resource}},rootNode:{get:function(){return this._rootNode}},tileset:{get:function(){return this._tileset}},data:{get:function(){return this._data}},version:{get:function(){return this._version}},majorVersion:{get:function(){return this._majorVersion}},minorVersion:{get:function(){return this._minorVersion}},legacyVersion16:{get:function(){if((0,d.A)(this.version))return this.majorVersion<1||1===this.majorVersion&&this.minorVersion<=6}}}),d1.prototype.load=async function(e){if(4326!==this._data.spatialReference.wkid)throw new M.A(`Unsupported spatial reference: ${this._data.spatialReference.wkid}`);if(this._dataProvider.applySymbology&&(this._symbology=new u1(this)),await this._dataProvider.loadGeoidData(),await this._loadRootNode(e),await this._create3DTileset(e),this._rootNode._tile=this._tileset._root,this._tileset._root._i3sNode=this._rootNode,this.legacyVersion16)return this._rootNode._loadChildren()},d1.prototype._computeGeometryDefinitions=function(e){if(this._geometryDefinitions=[],(0,d.A)(this._data.geometryDefinitions))for(let t=0;t<this._data.geometryDefinitions.length;t++){const n=[],i=this._data.geometryDefinitions[t].geometryBuffers;for(let t=0;t<i.length;t++){const o=i[t],r=[];let s=!1;if((0,d.A)(o.compressedAttributes)&&e){s=!0;const e=o.compressedAttributes.attributes;for(let t=0;t<e.length;t++)r.push(e[t])}else for(const e in o)"offset"!==e&&r.push(e);n.push({compressed:s,attributes:r,index:i.indexOf(o)})}n.sort(function(e,t){return e.compressed&&!t.compressed?-1:!e.compressed&&t.compressed?1:e.attributes.length-t.attributes.length}),this._geometryDefinitions.push(n)}},d1.prototype._findBestGeometryBuffers=function(e,t){const n=this._geometryDefinitions[e];if((0,d.A)(n)){for(let e=0;e<n.length;++e){const i=n[e];let o=!1;const r=i.attributes;for(let e=0;e<t.length;e++)if(!r.includes(t[e])){o=!0;break}if(!o)return{bufferIndex:i.index,definition:n,geometryBufferInfo:i}}if((0,d.A)(n[0]))return{bufferIndex:0,definition:n,geometryBufferInfo:n[0]}}},d1.prototype._loadRootNode=function(e){if((0,d.A)(this._data.nodePages)){let e=0;(0,d.A)(this._data.nodePages.rootIndex)&&(e=this._data.nodePages.rootIndex),this._rootNode=new r1(this,e,!0)}else this._rootNode=new r1(this,this._data.store.rootNode,!0);return this._rootNode.load(e)},d1.prototype._getNodeInNodePages=function(e){const t=Math.floor(e/this._data.nodePages.nodesPerPage),n=e%this._data.nodePages.nodesPerPage;return this._loadNodePage(t).then(function(e){return e.nodes[n]})},d1._fetchJson=function(e){return e.fetchJson()},d1.prototype._loadNodePage=function(e){const t=this;if(!(0,d.A)(this._nodePageFetches[e])){const n=this.resource.getDerivedResource({url:`nodepages/${e}/`}),i=d1._fetchJson(n).then(function(n){return(0,d.A)(n.error)&&200!==n.error.code?Promise.reject(n.error):(t._nodePages[e]=n.nodes,n)});this._nodePageFetches[e]=i}return this._nodePageFetches[e]},d1.prototype._computeExtent=function(){(0,d.A)(this._data.fullExtent)?this._extent=Or.A.fromDegrees(this._data.fullExtent.xmin,this._data.fullExtent.ymin,this._data.fullExtent.xmax,this._data.fullExtent.ymax):(0,d.A)(this._data.store.extent)&&(this._extent=Or.A.fromDegrees(this._data.store.extent[0],this._data.store.extent[1],this._data.store.extent[2],this._data.store.extent[3]))},d1.prototype._create3DTileset=async function(e){const t={asset:{version:"1.0"},geometricError:Number.MAX_VALUE,root:this._rootNode._create3DTileDefinition()},n=new Blob([JSON.stringify(t)],{type:"application/json"}),i=URL.createObjectURL(n),o=this._symbology?.defaultSymbology?.edges?.color;(0,d.A)(o)&&!(0,d.A)(e?.outlineColor)&&((e=(0,d.A)(e)?(0,_t.A)(e):{}).outlineColor=u.A.fromCartesian4(Q.A.fromArray(o))),this._tileset=await yi.A.fromUrl(i,e),this._tileset.show=this._parent.show,this._tileset._isI3STileSet=!0,this._tileset.tileUnload.addEventListener(function(e){e._i3sNode._clearGeometryData(),URL.revokeObjectURL(e._contentResource._url),e._contentResource=e._i3sNode.resource}),this._tileset.tileVisible.addEventListener(function(e){(0,d.A)(e._i3sNode)&&e._i3sNode._loadChildren()})},d1.prototype._updateVisibility=function(){(0,d.A)(this._tileset)&&(this._tileset.show=this._parent.show)},d1.prototype.filterByAttributes=function(e){this._filters=(0,d.A)(e)?(0,_t.A)(e,!0):[];const t=this._rootNode;return(0,d.A)(t)?t._filterFeatures():Promise.resolve()};const h1=d1;function A1(e,t){this._dataProvider=e,this._resource=new Lt.A({url:t}),this._resource.setQueryParameters(e.resource.queryParameters),this._resource.appendForwardSlash()}Object.defineProperties(A1.prototype,{resource:{get:function(){return this._resource}},data:{get:function(){return this._data}},names:{get:function(){const e=[],t=this._data.summary;if((0,d.A)(t))for(let n=0;n<t.length;++n)e.push(t[n].fieldName);return e}}}),A1.prototype.load=async function(){return this._data=await T1.loadJson(this._resource),this._data},A1.prototype._getValues=function(e){const t=this._data.summary;if((0,d.A)(t))for(let n=0;n<t.length;++n){const i=t[n];if(i.fieldName===e)return(0,d.A)(i.mostFrequentValues)?[...i.mostFrequentValues]:[]}};const p1=A1;function f1(e,t,n){this._dataProvider=e,this._parent=t,this._data=n,this._name=n.name,this._modelName=n.modelName,this._visibility=n.visibility??!0,this._resource=void 0,this._sublayers=[],this._i3sLayers=[]}Object.defineProperties(f1.prototype,{resource:{get:function(){return this._resource}},data:{get:function(){return this._data}},name:{get:function(){return this._name}},modelName:{get:function(){return this._modelName}},sublayers:{get:function(){return this._sublayers}},visibility:{get:function(){return this._visibility},set:function(e){if(l.A.defined("value",e),this._visibility!==e){this._visibility=e;for(let e=0;e<this._i3sLayers.length;e++)this._i3sLayers[e]._updateVisibility()}}},show:{get:function(){return this._visibility&&this._parent.show}}}),f1._fromData=async function(e,t,n,i){const o=new f1(e,i,n);if("group"===o._data.layerType){const n=o._data.sublayers;if((0,d.A)(n)){const i=[];for(let r=0;r<n.length;r++){const s=f1._fromData(e,t,n[r],o);i.push(s)}const r=await Promise.all(i);for(let e=0;e<r.length;e++){const t=r[e];o._sublayers.push(t),o._i3sLayers.push(...t._i3sLayers)}}}else if("3DObject"===o._data.layerType){const n=t.concat(`/sublayers/${o._data.id}`),i=new Lt.A({url:n});i.setQueryParameters(e.resource.queryParameters),i.appendForwardSlash(),o._resource=i;const r=await T1.loadJson(o._resource),s=new h1(e,r,o);o._i3sLayers.push(s)}else console.log(`${o._data.layerType} layer ${o._data.name} is skipped as not supported.`);return o};const m1=f1;var g1=n(24827);function _1(e){e=e??S.A.EMPTY_OBJECT,this._name=e.name,this._show=e.show??!0,this._geoidTiledTerrainProvider=e.geoidTiledTerrainProvider,this._showFeatures=e.showFeatures??!1,this._adjustMaterialAlphaMode=e.adjustMaterialAlphaMode??!1,this._applySymbology=e.applySymbology??!1,this._calculateNormals=e.calculateNormals??!1,this._cesium3dTilesetOptions=e.cesium3dTilesetOptions??S.A.EMPTY_OBJECT,this._layers=[],this._sublayers=[],this._data=void 0,this._extent=void 0,this._geoidDataPromise=void 0,this._geoidDataList=void 0,this._decoderTaskProcessor=void 0,this._taskProcessorReadyPromise=void 0,this._attributeStatistics=[],this._layersExtent=[]}async function y1(e,t,n){if("Building"===t.layerType){(0,d.A)(n.showFeatures)||(e._showFeatures=!0),(0,d.A)(n.adjustMaterialAlphaMode)||(e._adjustMaterialAlphaMode=!0),(0,d.A)(n.applySymbology)||(e._applySymbology=!0),(0,d.A)(n.calculateNormals)||(e._calculateNormals=!0);const i=function(e,t){const n=e.resource.getUrlComponent();let i="";return i=n.match(/layers\/\d/)?`${n}`.replace(/\/+$/,""):`${n}`.replace(/\/?$/,"/").concat(`layers/${t}`),i}(e,t.id);if((0,d.A)(t.sublayers)){const n=[];for(let o=0;o<t.sublayers.length;o++){const r=m1._fromData(e,i,t.sublayers[o],e);n.push(r)}const o=await Promise.all(n);for(let t=0;t<o.length;t++){const n=o[t];e._sublayers.push(n),e._layers.push(...n._i3sLayers)}}if((0,d.A)(t.statisticsHRef)){const n=i.concat(`/${t.statisticsHRef}`),o=new p1(e,n);await o.load(),e._attributeStatistics.push(o)}if((0,d.A)(t.fullExtent)){const n=Or.A.fromDegrees(t.fullExtent.xmin,t.fullExtent.ymin,t.fullExtent.xmax,t.fullExtent.ymax);e._layersExtent.push(n)}}else if("3DObject"===t.layerType||"IntegratedMesh"===t.layerType){(0,d.A)(n.calculateNormals)||(0,d.A)(t.textureSetDefinitions)||(e._calculateNormals=!0);const i=new h1(e,t,e);e._layers.push(i),(0,d.A)(i._extent)&&e._layersExtent.push(i._extent)}else console.log(`${t.layerType} layer ${t.name} is skipped as not supported.`)}Object.defineProperties(_1.prototype,{name:{get:function(){return this._name}},show:{get:function(){return this._show},set:function(e){if(l.A.defined("value",e),this._show!==e){this._show=e;for(let e=0;e<this._layers.length;e++)this._layers[e]._updateVisibility()}}},geoidTiledTerrainProvider:{get:function(){return this._geoidTiledTerrainProvider}},layers:{get:function(){return this._layers}},sublayers:{get:function(){return this._sublayers}},data:{get:function(){return this._data}},extent:{get:function(){return this._extent}},resource:{get:function(){return this._resource}},showFeatures:{get:function(){return this._showFeatures}},adjustMaterialAlphaMode:{get:function(){return this._adjustMaterialAlphaMode}},applySymbology:{get:function(){return this._applySymbology}},calculateNormals:{get:function(){return this._calculateNormals}}}),_1.prototype.destroy=function(){for(let e=0;e<this._layers.length;e++)(0,d.A)(this._layers[e]._tileset)&&this._layers[e]._tileset.destroy();return(0,h.A)(this)},_1.prototype.isDestroyed=function(){return!1},_1.prototype.update=function(e){for(let t=0;t<this._layers.length;t++)(0,d.A)(this._layers[t]._tileset)&&this._layers[t]._tileset.update(e)},_1.prototype.prePassesUpdate=function(e){for(let t=0;t<this._layers.length;t++)(0,d.A)(this._layers[t]._tileset)&&this._layers[t]._tileset.prePassesUpdate(e)},_1.prototype.postPassesUpdate=function(e){for(let t=0;t<this._layers.length;t++)(0,d.A)(this._layers[t]._tileset)&&this._layers[t]._tileset.postPassesUpdate(e)},_1.prototype.updateForPass=function(e,t){for(let n=0;n<this._layers.length;n++)(0,d.A)(this._layers[n]._tileset)&&this._layers[n]._tileset.updateForPass(e,t)},_1.fromUrl=async function(e,t){l.A.defined("url",e),t=t??S.A.EMPTY_OBJECT;const n=Lt.A.createIfNeeded(e);n.setQueryParameters({f:"pjson"},!0);const i=await _1.loadJson(n),o=new _1(t);if(o._resource=n,o._data=i,(0,d.A)(i.layers)){const e=[];for(let n=0;n<i.layers.length;n++){const r=y1(o,i.layers[n],t);e.push(r)}await Promise.all(e)}else await y1(o,i,t);o._computeExtent();const r=[];for(let e=0;e<o._layers.length;e++)r.push(o._layers[e].load(t.cesium3dTilesetOptions));return await Promise.all(r),o},_1._fetchJson=function(e){return e.fetchJson()},_1.loadJson=async function(e){const t=await _1._fetchJson(e);if((0,d.A)(t.error)){if(console.error("Failed to fetch I3S ",e.url),(0,d.A)(t.error.message)&&console.error(t.error.message),(0,d.A)(t.error.details))for(let e=0;e<t.error.details.length;e++)console.log(t.error.details[e]);throw new M.A(t.error)}return t},_1.prototype._loadBinary=async function(e){const t=await e.fetchArrayBuffer();if(t.byteLength>0&&new Uint8Array(t)[0]==="{".charCodeAt(0)&&(new TextDecoder).decode(t).includes("404"))throw new M.A(`Failed to load binary: ${e.url}`);return t},_1.prototype._binarizeGltf=function(e){const t=(new TextEncoder).encode(JSON.stringify(e)),n=new Uint8Array(t.byteLength+20),i={magic:new Uint8Array(n.buffer,0,4),version:new Uint32Array(n.buffer,4,1),length:new Uint32Array(n.buffer,8,1),chunkLength:new Uint32Array(n.buffer,12,1),chunkType:new Uint32Array(n.buffer,16,1),chunkData:new Uint8Array(n.buffer,20,t.byteLength)};return i.magic[0]="g".charCodeAt(),i.magic[1]="l".charCodeAt(),i.magic[2]="T".charCodeAt(),i.magic[3]="F".charCodeAt(),i.version[0]=2,i.length[0]=n.byteLength,i.chunkLength[0]=t.byteLength,i.chunkType[0]=1313821514,i.chunkData.set(t),n};const v1=new q.A;_1.prototype.loadGeoidData=async function(){return(0,d.A)(this._geoidDataPromise)||(this._geoidDataPromise=async function(e){const t=e._geoidTiledTerrainProvider;if((0,d.A)(t))try{const n=await function(e,t){const n=e.tilingScheme,i=[],o={},r=e._lodCount,s=X.A.fromRadians(t.west,t.north),a=X.A.fromRadians(t.east,t.south),c=n.positionToTileXY(s,r),l=n.positionToTileXY(a,r);for(let t=c.x;t<=l.x;t++)for(let s=c.y;s<=l.y;s++){const a=q.A.fromElements(t,s,v1),c=a.toString();if(!o.hasOwnProperty(c)){const t={x:a.x,y:a.y,level:r,tilingScheme:n,terrainProvider:e,positions:[]};o[c]=t,i.push(t)}}const u=[];for(let e=0;e<i.length;++e){const t=i[e],n=t.terrainProvider.requestTileGeometry(t.x,t.y,t.level);u.push(n)}return Promise.all(u).then(function(e){const t=[];for(let o=0;o<e.length;o++){const r={tilingScheme:n,x:i[o].x,y:i[o].y,level:i[o].level},s=e[o];let a="Geographic";n._projection instanceof oM.A&&(a="WebMercator");const c={projectionType:a,projection:n._projection,nativeExtent:n.tileXYToNativeRectangle(r.x,r.y,r.level),height:s._height,width:s._width,scale:s._structure.heightScale,offset:s._structure.heightOffset};if(s._encoding===tI.A.LERC){const e=g1.decode(s._buffer);c.buffer=e.pixels[0]}else c.buffer=s._buffer;t.push(c)}return t})}(t,e._extent);e._geoidDataList=n}catch(e){console.log("Error retrieving Geoid Terrain tiles - no geoid conversion will be performed.")}}(this)),this._geoidDataPromise},_1.prototype._computeExtent=function(){let e;for(let t=0;t<this._layersExtent.length;t++){const n=this._layersExtent[t];(0,d.A)(e)?Or.A.union(e,n,e):e=Or.A.clone(n)}this._extent=e},_1.prototype.getAttributeNames=function(){const e=[];for(let t=0;t<this._attributeStatistics.length;++t)e.push(...this._attributeStatistics[t].names);return e},_1.prototype.getAttributeValues=function(e){l.A.defined("name",e);for(let t=0;t<this._attributeStatistics.length;++t){const n=this._attributeStatistics[t]._getValues(e);if((0,d.A)(n))return n}return[]},_1.prototype.filterByAttributes=function(e){const t=[];for(let n=0;n<this._layers.length;n++){const i=this._layers[n].filterByAttributes(e);t.push(i)}return Promise.all(t)};const T1=_1;var b1=n(680278);const w1={createTilesetFromIModelId:async function({iModelId:e,changesetId:t,tilesetOptions:n}){const{exports:i}=await qD.getExports(e,t);if(i.length>0&&i.every(e=>e.status===qD.ExportStatus.Invalid))throw new M.A(`All exports for this iModel are Invalid: ${e}`);const o=i.find(e=>e.status===qD.ExportStatus.Complete);if(!(0,d.A)(o))return;const r=new URL(o._links.mesh.href);r.pathname=`${r.pathname}/tileset.json`;const s=r.toString(),a=new Lt.A({url:s});return yi.A.fromUrl(a,n)},createTilesetForRealityDataId:async function({iTwinId:e,realityDataId:t,type:n,rootDocument:i,tilesetOptions:o}){if(l.A.typeOf.string("iTwinId",e),l.A.typeOf.string("realityDataId",t),(0,d.A)(n)&&l.A.typeOf.string("type",n),(0,d.A)(i)&&l.A.typeOf.string("rootDocument",i),!(0,d.A)(n)||!(0,d.A)(i)){const o=await qD.getRealityDataMetadata(e,t);i=o.rootDocument,n=o.type}if(![qD.RealityDataType.Cesium3DTiles,qD.RealityDataType.PNTS,qD.RealityDataType.RealityMesh3DTiles,qD.RealityDataType.Terrain3DTiles].includes(n))throw new M.A(`Reality data type is not a mesh type: ${n}`);const r=await qD.getRealityDataURL(e,t,i),s={maximumScreenSpaceError:4,...o};return yi.A.fromUrl(r,s)},createDataSourceForRealityDataId:async function({iTwinId:e,realityDataId:t,type:n,rootDocument:i}){if(l.A.typeOf.string("iTwinId",e),l.A.typeOf.string("realityDataId",t),(0,d.A)(n)&&l.A.typeOf.string("type",n),(0,d.A)(i)&&l.A.typeOf.string("rootDocument",i),!(0,d.A)(n)||!(0,d.A)(i)){const o=await qD.getRealityDataMetadata(e,t);i=o.rootDocument,n=o.type}if(![qD.RealityDataType.KML,qD.RealityDataType.GeoJSON].includes(n))throw new M.A(`Reality data type is not a data source type: ${n}`);const o=await qD.getRealityDataURL(e,t,i);return n===qD.RealityDataType.GeoJSON?Ag.A.load(o):bE.load(o)},loadGeospatialFeatures:async function({iTwinId:e,collectionId:t,limit:n}){if(l.A.typeOf.string("iTwinId",e),l.A.typeOf.string("collectionId",t),(0,d.A)(n)&&(l.A.typeOf.number("limit",n),l.A.typeOf.number.lessThanOrEquals("limit",n,1e4),l.A.typeOf.number.greaterThanOrEquals("limit",n,1)),!(0,d.A)(qD.defaultAccessToken)&&!(0,d.A)(qD.defaultShareKey))throw new A.A("Must set ITwinPlatform.defaultAccessToken or ITwinPlatform.defaultShareKey first");const i=n??1e4,o=`${qD.apiEndpoint}geospatial-features/itwins/${e}/ogc/collections/${t}/items`,r=new Lt.A({url:o,headers:{Authorization:qD._getAuthorizationHeader(),Accept:"application/vnd.bentley.itwin-platform.v1+json"},queryParameters:{limit:i,client:"CesiumJS"}});return Ag.A.load(r)}};var x1=n(208198),C1=n(17656),E1=n(789989),S1=n(553909),I1=n(961965),P1=n(1235),D1=n(829513),O1=n(586067),R1=n(123314),M1=n(866857),L1=n(670549),N1=n(231097),B1=n(784749),F1=n(566798),U1=n(465674);function k1(){}Object.defineProperties(k1.prototype,{color:{get:A.A.throwInstantiationError},intensity:{get:A.A.throwInstantiationError}});const V1=k1;var z1=n(847072),H1=n(66458);const G1=/\/$/,W1=new Ws.A('&copy; <a href="https://www.mapbox.com/about/maps/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/">Improve this map</a></strong>');function Y1(e){const t=(e=e??S.A.EMPTY_OBJECT).styleId;if(!(0,d.A)(t))throw new A.A("options.styleId is required.");const n=e.accessToken;if(!(0,d.A)(n))throw new A.A("options.accessToken is required.");this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0;const i=Lt.A.createIfNeeded(e.url??"https://api.mapbox.com/styles/v1/");this._styleId=t,this._accessToken=n;const o=e.tilesize??512;this._tilesize=o;const r=e.username??"mapbox";this._username=r;const s=(0,d.A)(e.scaleFactor)?"@2x":"";let a,c=i.getUrlComponent();G1.test(c)||(c+="/"),c+=`${this._username}/${t}/tiles/${this._tilesize}/{z}/{x}/{y}${s}`,i.url=c,i.setQueryParameters({access_token:n}),(0,d.A)(e.credit)?(a=e.credit,"string"==typeof a&&(a=new Ws.A(a))):a=W1,this._resource=i,this._imageryProvider=new H1.A({url:i,credit:a,ellipsoid:e.ellipsoid,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,rectangle:e.rectangle})}Object.defineProperties(Y1.prototype,{url:{get:function(){return this._imageryProvider.url}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}}),Y1.prototype.getTileCredits=function(e,t,n){},Y1.prototype.requestImage=function(e,t,n,i){return this._imageryProvider.requestImage(e,t,n,i)},Y1.prototype.pickFeatures=function(e,t,n,i,o){return this._imageryProvider.pickFeatures(e,t,n,i,o)},Y1._defaultCredit=W1;const q1=Y1;var j1=n(32335),Q1=n(965976),X1=n(266262),K1=n(901717),$1=n(4024),J1=n(729295),Z1=n(874403),e2=n(140182),t2=n(304686),n2=n(995537),i2=n(409816),o2=n(952392),r2=n(566334);const s2=new q.A(1,1);function a2(e){e=e??S.A.EMPTY_OBJECT,this.mass=e.mass??1,this.position=j.A.clone(e.position??j.A.ZERO),this.velocity=j.A.clone(e.velocity??j.A.ZERO),this.life=e.life??Number.MAX_VALUE,this.image=e.image,this.startColor=u.A.clone(e.startColor??u.A.WHITE),this.endColor=u.A.clone(e.endColor??u.A.WHITE),this.startScale=e.startScale??1,this.endScale=e.endScale??1,this.imageSize=q.A.clone(e.imageSize??s2),this._age=0,this._normalizedAge=0,this._billboard=void 0}Object.defineProperties(a2.prototype,{age:{get:function(){return this._age}},normalizedAge:{get:function(){return this._normalizedAge}}});const c2=new j.A;a2.prototype.update=function(e,t){return j.A.multiplyByScalar(this.velocity,e,c2),j.A.add(this.position,c2,this.position),(0,d.A)(t)&&t(this,e),this._age+=e,this.life===Number.MAX_VALUE?this._normalizedAge=0:this._normalizedAge=this._age/this.life,this._age<=this.life};const l2=a2;function u2(e){e=e??S.A.EMPTY_OBJECT,this.time=e.time??0,this.minimum=e.minimum??0,this.maximum=e.maximum??50,this._complete=!1}Object.defineProperties(u2.prototype,{complete:{get:function(){return this._complete}}});const d2=u2;function h2(e){throw new A.A("This type should not be instantiated directly.  Instead, use BoxEmitter, CircleEmitter, ConeEmitter or SphereEmitter.")}h2.prototype.emit=function(e){A.A.throwInstantiationError()};const A2=h2,p2=new q.A(1,1);function f2(e){e=e??S.A.EMPTY_OBJECT,this.show=e.show??!0,this.updateCallback=e.updateCallback,this.loop=e.loop??!0,this.image=e.image??void 0;let t=e.emitter;(0,d.A)(t)||(t=new UJ(.5)),this._emitter=t,this._bursts=e.bursts,this._modelMatrix=O.A.clone(e.modelMatrix??O.A.IDENTITY),this._emitterModelMatrix=O.A.clone(e.emitterModelMatrix??O.A.IDENTITY),this._matrixDirty=!0,this._combinedMatrix=new O.A,this._startColor=u.A.clone(e.color??e.startColor??u.A.WHITE),this._endColor=u.A.clone(e.color??e.endColor??u.A.WHITE),this._startScale=e.scale??e.startScale??1,this._endScale=e.scale??e.endScale??1,this._emissionRate=e.emissionRate??5,this._minimumSpeed=e.speed??e.minimumSpeed??1,this._maximumSpeed=e.speed??e.maximumSpeed??1,this._minimumParticleLife=e.particleLife??e.minimumParticleLife??5,this._maximumParticleLife=e.particleLife??e.maximumParticleLife??5,this._minimumMass=e.mass??e.minimumMass??1,this._maximumMass=e.mass??e.maximumMass??1,this._minimumImageSize=q.A.clone(e.imageSize??e.minimumImageSize??p2),this._maximumImageSize=q.A.clone(e.imageSize??e.maximumImageSize??p2),this._sizeInMeters=e.sizeInMeters??!1,this._lifetime=e.lifetime??Number.MAX_VALUE,this._billboardCollection=void 0,this._particles=[],this._particlePool=[],this._previousTime=void 0,this._currentTime=0,this._carryOver=0,this._complete=new Bn.A,this._isComplete=!1,this._updateParticlePool=!0,this._particleEstimate=0}function m2(e){let t=e._particlePool.pop();return(0,d.A)(t)||(t=new l2),t}function g2(e,t){e._particlePool.push(t)}function _2(e){(0,d.A)(e._billboard)&&(e._billboard.show=!1)}function y2(e,t){let n=t._billboard;(0,d.A)(n)||(n=t._billboard=e._billboardCollection.add({image:t.image})),n.width=t.imageSize.x,n.height=t.imageSize.y,n.position=t.position,n.sizeInMeters=e.sizeInMeters,n.show=!0;const i=J.A.lerp(t.startColor.red,t.endColor.red,t.normalizedAge),o=J.A.lerp(t.startColor.green,t.endColor.green,t.normalizedAge),r=J.A.lerp(t.startColor.blue,t.endColor.blue,t.normalizedAge),s=J.A.lerp(t.startColor.alpha,t.endColor.alpha,t.normalizedAge);n.color=new u.A(i,o,r,s),n.scale=J.A.lerp(t.startScale,t.endScale,t.normalizedAge)}function v2(e,t){t.startColor=u.A.clone(e._startColor,t.startColor),t.endColor=u.A.clone(e._endColor,t.endColor),t.startScale=e._startScale,t.endScale=e._endScale,t.image=e.image,t.life=J.A.randomBetween(e._minimumParticleLife,e._maximumParticleLife),t.mass=J.A.randomBetween(e._minimumMass,e._maximumMass),t.imageSize.x=J.A.randomBetween(e._minimumImageSize.x,e._maximumImageSize.x),t.imageSize.y=J.A.randomBetween(e._minimumImageSize.y,e._maximumImageSize.y),t._normalizedAge=0,t._age=0;const n=J.A.randomBetween(e._minimumSpeed,e._maximumSpeed);j.A.multiplyByScalar(t.velocity,n,t.velocity),e._particles.push(t)}Object.defineProperties(f2.prototype,{emitter:{get:function(){return this._emitter},set:function(e){l.A.defined("value",e),this._emitter=e}},bursts:{get:function(){return this._bursts},set:function(e){this._bursts=e,this._updateParticlePool=!0}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){l.A.defined("value",e),this._matrixDirty=this._matrixDirty||!O.A.equals(this._modelMatrix,e),O.A.clone(e,this._modelMatrix)}},emitterModelMatrix:{get:function(){return this._emitterModelMatrix},set:function(e){l.A.defined("value",e),this._matrixDirty=this._matrixDirty||!O.A.equals(this._emitterModelMatrix,e),O.A.clone(e,this._emitterModelMatrix)}},startColor:{get:function(){return this._startColor},set:function(e){l.A.defined("value",e),u.A.clone(e,this._startColor)}},endColor:{get:function(){return this._endColor},set:function(e){l.A.defined("value",e),u.A.clone(e,this._endColor)}},startScale:{get:function(){return this._startScale},set:function(e){l.A.typeOf.number.greaterThanOrEquals("value",e,0),this._startScale=e}},endScale:{get:function(){return this._endScale},set:function(e){l.A.typeOf.number.greaterThanOrEquals("value",e,0),this._endScale=e}},emissionRate:{get:function(){return this._emissionRate},set:function(e){l.A.typeOf.number.greaterThanOrEquals("value",e,0),this._emissionRate=e,this._updateParticlePool=!0}},minimumSpeed:{get:function(){return this._minimumSpeed},set:function(e){l.A.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumSpeed=e}},maximumSpeed:{get:function(){return this._maximumSpeed},set:function(e){l.A.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumSpeed=e}},minimumParticleLife:{get:function(){return this._minimumParticleLife},set:function(e){l.A.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumParticleLife=e}},maximumParticleLife:{get:function(){return this._maximumParticleLife},set:function(e){l.A.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumParticleLife=e,this._updateParticlePool=!0}},minimumMass:{get:function(){return this._minimumMass},set:function(e){l.A.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumMass=e}},maximumMass:{get:function(){return this._maximumMass},set:function(e){l.A.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumMass=e}},minimumImageSize:{get:function(){return this._minimumImageSize},set:function(e){l.A.typeOf.object("value",e),l.A.typeOf.number.greaterThanOrEquals("value.x",e.x,0),l.A.typeOf.number.greaterThanOrEquals("value.y",e.y,0),this._minimumImageSize=e}},maximumImageSize:{get:function(){return this._maximumImageSize},set:function(e){l.A.typeOf.object("value",e),l.A.typeOf.number.greaterThanOrEquals("value.x",e.x,0),l.A.typeOf.number.greaterThanOrEquals("value.y",e.y,0),this._maximumImageSize=e}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){l.A.typeOf.bool("value",e),this._sizeInMeters=e}},lifetime:{get:function(){return this._lifetime},set:function(e){l.A.typeOf.number.greaterThanOrEquals("value",e,0),this._lifetime=e}},complete:{get:function(){return this._complete}},isComplete:{get:function(){return this._isComplete}}});const T2=new j.A;f2.prototype.update=function(e){if(!this.show)return;(0,d.A)(this._billboardCollection)||(this._billboardCollection=new z$.A),this._updateParticlePool&&(function(e){const t=e._emissionRate,n=e._maximumParticleLife;let i=0;const o=e._bursts;if((0,d.A)(o)){const e=o.length;for(let t=0;t<e;++t)i+=o[t].maximum}const r=e._billboardCollection,s=e.image,a=Math.ceil(t*n+i),c=e._particles,l=e._particlePool,u=Math.max(a-c.length-l.length,0);for(let e=0;e<u;++e){const e=new l2;e._billboard=r.add({image:s,show:!1}),l.push(e)}e._particleEstimate=a}(this),this._updateParticlePool=!1);let t=0;this._previousTime&&(t=te.A.secondsDifference(e.time,this._previousTime)),t<0&&(t=0);const n=this._particles,i=this._emitter,o=this.updateCallback;let r,s,a=n.length;for(r=0;r<a;++r)s=n[r],s.update(t,o)?y2(this,s):(_2(s),g2(this,s),n[r]=n[a-1],--r,--a);n.length=a;const c=function(e,t){if(e._isComplete)return 0;const n=(t=J.A.mod(t,e._lifetime))*e._emissionRate;let i=Math.floor(n);if(e._carryOver+=n-i,e._carryOver>1&&(i++,e._carryOver-=1),(0,d.A)(e.bursts)){const t=e.bursts.length;for(let n=0;n<t;n++){const t=e.bursts[n],o=e._currentTime;(0,d.A)(t)&&!t._complete&&o>t.time&&(i+=J.A.randomBetween(t.minimum,t.maximum),t._complete=!0)}}return i}(this,t);if(c>0&&(0,d.A)(i)){this._matrixDirty&&(this._combinedMatrix=O.A.multiply(this.modelMatrix,this.emitterModelMatrix,this._combinedMatrix),this._matrixDirty=!1);const e=this._combinedMatrix;for(r=0;r<c;r++)s=m2(this),this._emitter.emit(s),j.A.add(s.position,s.velocity,T2),O.A.multiplyByPoint(e,T2,T2),s.position=O.A.multiplyByPoint(e,s.position,s.position),j.A.subtract(T2,s.position,s.velocity),j.A.normalize(s.velocity,s.velocity),v2(this,s),y2(this,s)}if(this._billboardCollection.update(e),this._previousTime=te.A.clone(e.time,this._previousTime),this._currentTime+=t,this._lifetime!==Number.MAX_VALUE&&this._currentTime>this._lifetime)if(this.loop){if(this._currentTime=J.A.mod(this._currentTime,this._lifetime),this.bursts){const e=this.bursts.length;for(r=0;r<e;r++)this.bursts[r]._complete=!1}}else this._isComplete=!0,this._complete.raiseEvent(this);e.frameNumber%120==0&&function(e){const t=e._particles,n=e._particlePool,i=e._billboardCollection,o=t.length,r=n.length,s=e._particleEstimate,a=r-Math.max(s-o-r,0);for(let e=a;e<r;++e){const t=n[e];i.remove(t._billboard)}n.length=a}(this)},f2.prototype.isDestroyed=function(){return!1},f2.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),(0,h.A)(this)};const b2=f2;var w2=n(520853),x2=n(24013),C2=n(154622),E2=n(289758),S2=n(632791),I2=n(871160),P2=n(828847),D2=n(663386),O2=n(287659),R2=n(105792),M2=n(875037);function L2(){A.A.throwInstantiationError()}L2.computeDefaultLevelZeroMaximumGeometricError=function(e){return 2*e.ellipsoid.maximumRadius*Math.PI*.25/(65*e.getNumberOfXTilesAtLevel(0))},Object.defineProperties(L2.prototype,{quadtree:{get:A.A.throwInstantiationError,set:A.A.throwInstantiationError},tilingScheme:{get:A.A.throwInstantiationError},errorEvent:{get:A.A.throwInstantiationError}}),L2.prototype.update=A.A.throwInstantiationError,L2.prototype.beginUpdate=A.A.throwInstantiationError,L2.prototype.endUpdate=A.A.throwInstantiationError,L2.prototype.getLevelMaximumGeometricError=A.A.throwInstantiationError,L2.prototype.loadTile=A.A.throwInstantiationError,L2.prototype.computeTileVisibility=A.A.throwInstantiationError,L2.prototype.showTileThisFrame=A.A.throwInstantiationError,L2.prototype.computeDistanceToTile=A.A.throwInstantiationError,L2.prototype.isDestroyed=A.A.throwInstantiationError,L2.prototype.destroy=A.A.throwInstantiationError;const N2=L2;var B2=n(147795),F2=n(366165),U2=n(569445),k2=n(48660),V2=n(589834),z2=n(556541);function H2(e){e=e??1,l.A.typeOf.number.greaterThan("radius",e,0),this._radius=e??1}Object.defineProperties(H2.prototype,{radius:{get:function(){return this._radius},set:function(e){l.A.typeOf.number.greaterThan("value",e,0),this._radius=e}}}),H2.prototype.emit=function(e){const t=J.A.randomBetween(0,J.A.TWO_PI),n=J.A.randomBetween(0,J.A.PI),i=J.A.randomBetween(0,this._radius),o=i*Math.cos(t)*Math.sin(n),r=i*Math.sin(t)*Math.sin(n),s=i*Math.cos(n);e.position=j.A.fromElements(o,r,s,e.position),e.velocity=j.A.normalize(e.position,e.velocity)};const G2=H2;var W2=n(590732);function Y2(){}Y2.prototype.evaluate=function(e,t){A.A.throwInstantiationError()},Y2.prototype.evaluateColor=function(e,t){A.A.throwInstantiationError()},Y2.prototype.getShaderFunction=function(e,t,n,i){A.A.throwInstantiationError()},Y2.prototype.getVariables=function(){A.A.throwInstantiationError()};const q2=Y2;var j2=n(768213),Q2=n(557417),X2=n(224159),K2=n(315747);function $2(){}$2.prototype.boundingVolume=void 0,$2.prototype.boundingSphere=void 0,$2.prototype.distanceToCamera=function(e){A.A.throwInstantiationError()},$2.prototype.intersectPlane=function(e){A.A.throwInstantiationError()},$2.prototype.createDebugVolume=function(e){A.A.throwInstantiationError()};const J2=$2;function Z2(e){e=e??S.A.EMPTY_OBJECT,this._tilingScheme=(0,d.A)(e.tilingScheme)?e.tilingScheme:new eI.A({ellipsoid:e.ellipsoid}),this._color=e.color??u.A.YELLOW,this._errorEvent=new Bn.A,this._tileWidth=e.tileWidth??256,this._tileHeight=e.tileHeight??256,this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0}Object.defineProperties(Z2.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}}),Z2.prototype.getTileCredits=function(e,t,n){},Z2.prototype.requestImage=function(e,t,n,i){const o=document.createElement("canvas");o.width=256,o.height=256;const r=o.getContext("2d"),s=this._color.toCssColorString();return r.strokeStyle=s,r.lineWidth=2,r.strokeRect(1,1,255,255),r.font="bold 25px Arial",r.textAlign="center",r.fillStyle=s,r.fillText(`L: ${n}`,124,86),r.fillText(`X: ${e}`,124,136),r.fillText(`Y: ${t}`,124,186),Promise.resolve(o)},Z2.prototype.pickFeatures=function(e,t,n,i,o){};const e3=Z2;function t3(e){A.A.throwInstantiationError()}t3.prototype.isReady=A.A.throwInstantiationError,t3.prototype.shouldDiscardImage=A.A.throwInstantiationError;const n3=t3;var i3=n(976092),o3=n(829670),r3=n(335859),s3=n(11745);const a3=Object.freeze({START:0,LOADING:1,READY:2,UPSAMPLED_ONLY:3});var c3=n(323314),l3=n(751069),u3=n(99520),d3=n(28940),h3=n(308521),A3=n(868897),p3=n(301350),f3=n(601165),m3=n(566453),g3=n(953681),_3=n(471293),y3=n(595826);function v3(e,t){this.show=!0,(0,d.A)(e)||(e=new c.A),this.rectangle=c.A.clone(e),(0,d.A)(t)||(t=Dn.A.fromType(Dn.A.ColorType,{color:new u.A(1,1,1,1)})),this.material=t,this._material=void 0,this._overlayCommand=void 0,this._rs=void 0}v3.prototype.update=function(e){if(!this.show)return;if(!(0,d.A)(this.material))throw new A.A("this.material must be defined.");if(!(0,d.A)(this.rectangle))throw new A.A("this.rectangle must be defined.");const t=this._rs;if((0,d.A)(t)&&c.A.equals(t.viewport,this.rectangle)||(this._rs=_.A.fromCache({blending:$M.A.ALPHA_BLEND,viewport:this.rectangle})),e.passes.render){const t=e.context;if(this._material!==this.material||!(0,d.A)(this._overlayCommand)){this._material=this.material,(0,d.A)(this._overlayCommand)&&this._overlayCommand.shaderProgram.destroy();const e=new k.A({sources:[this._material.shaderSource,ZS]});this._overlayCommand=t.createViewportQuadCommand(e,{renderState:this._rs,uniformMap:this._material._uniforms,owner:this}),this._overlayCommand.pass=ut.A.OVERLAY}this._material.update(t),this._overlayCommand.renderState=this._rs,this._overlayCommand.uniformMap=this._material._uniforms,e.commandList.push(this._overlayCommand)}},v3.prototype.isDestroyed=function(){return!1},v3.prototype.destroy=function(){return(0,d.A)(this._overlayCommand)&&(this._overlayCommand.shaderProgram=this._overlayCommand.shaderProgram&&this._overlayCommand.shaderProgram.destroy()),(0,h.A)(this)};const T3=v3;function b3(){A.A.throwInstantiationError()}Object.defineProperties(b3.prototype,{globalTransform:{get:A.A.throwInstantiationError},shapeTransform:{get:A.A.throwInstantiationError},shape:{get:A.A.throwInstantiationError},minBounds:{get:A.A.throwInstantiationError},maxBounds:{get:A.A.throwInstantiationError},dimensions:{get:A.A.throwInstantiationError},paddingBefore:{get:A.A.throwInstantiationError},paddingAfter:{get:A.A.throwInstantiationError},names:{get:A.A.throwInstantiationError},types:{get:A.A.throwInstantiationError},componentTypes:{get:A.A.throwInstantiationError},minimumValues:{get:A.A.throwInstantiationError},maximumValues:{get:A.A.throwInstantiationError},maximumTileCount:{get:A.A.throwInstantiationError},availableLevels:{get:A.A.throwInstantiationError},keyframeCount:{get:A.A.throwInstantiationError},timeIntervalCollection:{get:A.A.throwInstantiationError}}),b3.prototype.requestData=function(e){A.A.throwInstantiationError()};const w3=b3;function x3(){A.A.throwInstantiationError()}Object.defineProperties(x3.prototype,{orientedBoundingBox:{get:A.A.throwInstantiationError},boundingSphere:{get:A.A.throwInstantiationError},boundTransform:{get:A.A.throwInstantiationError},shapeTransform:{get:A.A.throwInstantiationError},shaderUniforms:{get:A.A.throwInstantiationError},shaderDefines:{get:A.A.throwInstantiationError},shaderMaximumIntersectionsLength:{get:A.A.throwInstantiationError}}),x3.prototype.update=A.A.throwInstantiationError,x3.prototype.computeOrientedBoundingBoxForTile=A.A.throwInstantiationError,x3.prototype.computeOrientedBoundingBoxForSample=A.A.throwInstantiationError,x3.DefaultMinBounds=A.A.throwInstantiationError,x3.DefaultMaxBounds=A.A.throwInstantiationError;const C3=x3;var E3=n(762270),S3=n(32706);const I3=new u.A,P3=new u.A,D3=new u.A,O3=new u.A,R3=new Q.A,M3=new Uint8Array(4);function L3(e,t,n,i){const o=t.height===n.height?0:(e-t.height)/(n.height-t.height);return u.A.lerp(t.color,n.color,o,i)}function N3(e,t){return{height:e,color:u.A.clone(t)}}function B3(e){return(e=(e=e.filter(function(e,t,n){const i=t>0,o=t<n.length-1,r=!i||e.height===n[t-1].height,s=!o||e.height===n[t+1].height;return!r||!s})).filter(function(e,t,n){const i=t>0,o=t<n.length-1,r=!!i&&u.A.equals(e.color,n[t-1].color),s=!!o&&u.A.equals(e.color,n[t+1].color);return!r||!s})).filter(function(e,t,n){const i=t>0,o=!!i&&u.A.equals(e.color,n[t-1].color),r=!i||e.height===n[t-1].height;return!o||!r})}function F3(e){const{scene:t,layers:n}=e??S.A.EMPTY_OBJECT;l.A.typeOf.object("options.scene",t),l.A.defined("options.layers",n),l.A.typeOf.number.greaterThan("options.layers.length",n.length,0);const{context:i}=t,o=function(e){const t=function(e){let t,n;const i=[],o=e.length;for(t=0;t<o;t++){const o=e[t],r=o.entries,s=r.length;if(!Array.isArray(r)||0===s)throw new A.A("entries must be an array with size > 0.");let a=[];for(n=0;n<s;n++){const e=r[n];if(!(0,d.A)(e.height))throw new A.A("entry requires a height.");if(!(0,d.A)(e.color))throw new A.A("entry requires a color.");const t=J.A.clamp(e.height,F3._minimumHeight,F3._maximumHeight),i=u.A.clone(e.color,I3);i.red*=i.alpha,i.green*=i.alpha,i.blue*=i.alpha,a.push(N3(t,i))}let c=!0,l=!0;for(n=0;n<s-1;n++){const e=a[n+0],t=a[n+1];c=c&&e.height<=t.height,l=l&&e.height>=t.height}l?a=a.reverse():c||DM(a,function(e,t){return J.A.sign(e.height-t.height)});let h=o.extendDownwards??!1,p=o.extendUpwards??!1;1!==a.length||h||p||(h=!0,p=!0),h&&a.splice(0,0,N3(F3._minimumHeight,a[0].color)),p&&a.splice(a.length,0,N3(F3._maximumHeight,a[a.length-1].color)),a=B3(a),i.push(a)}return i}(e);let n,i=[],o=[];function r(e,t){i.push(N3(e,t))}function s(e,t,n){let i=u.A.multiplyByScalar(n,1-t.alpha,O3);i=u.A.add(i,t,i),r(e,i)}const a=t.length;for(n=0;n<a;n++){const e=t[n];let a=0,c=0;o=i,i=[];const l=e.length,u=o.length;for(;a<l||c<u;){const t=a<l?e[a]:void 0,n=a>0?e[a-1]:void 0,i=a<l-1?e[a+1]:void 0,h=c<u?o[c]:void 0,A=c>0?o[c-1]:void 0,p=c<u-1?o[c+1]:void 0;if((0,d.A)(t)&&(0,d.A)(h)&&t.height===h.height){const e=(0,d.A)(p)&&h.height===p.height,o=!(0,d.A)(A),l=!(0,d.A)(p),u=(0,d.A)(i)&&t.height===i.height,f=!(0,d.A)(n),m=!(0,d.A)(i);e?u?(s(t.height,t.color,h.color),s(t.height,i.color,p.color)):f?(r(t.height,h.color),s(t.height,t.color,p.color)):m?(s(t.height,t.color,h.color),r(t.height,p.color)):(s(t.height,t.color,h.color),s(t.height,t.color,p.color)):o?u?(r(t.height,t.color),s(t.height,i.color,h.color)):m?(r(t.height,t.color),r(t.height,h.color)):(f||r(t.height,t.color),s(t.height,t.color,h.color)):l?u?(s(t.height,t.color,h.color),r(t.height,i.color)):f?(r(t.height,h.color),r(t.height,t.color)):m?s(t.height,t.color,h.color):(s(t.height,t.color,h.color),r(t.height,t.color)):u?(s(t.height,t.color,h.color),s(t.height,i.color,h.color)):f?(r(t.height,h.color),s(t.height,t.color,h.color)):m?(s(t.height,t.color,h.color),r(t.height,h.color)):s(t.height,t.color,h.color),a+=u?2:1,c+=e?2:1}else if((0,d.A)(t)&&(0,d.A)(h)&&(0,d.A)(A)&&t.height<h.height){const e=L3(t.height,A,h,D3);(0,d.A)(n)?(0,d.A)(i)?s(t.height,t.color,e):(s(t.height,t.color,e),r(t.height,e)):(r(t.height,e),s(t.height,t.color,e)),a++}else if((0,d.A)(h)&&(0,d.A)(t)&&(0,d.A)(n)&&h.height<t.height){const e=L3(h.height,n,t,P3);(0,d.A)(A)?(0,d.A)(p)?s(h.height,e,h.color):(s(h.height,e,h.color),r(h.height,e)):(r(h.height,e),s(h.height,e,h.color)),c++}else(0,d.A)(t)&&(!(0,d.A)(h)||t.height<h.height)?(!(0,d.A)(h)||(0,d.A)(A)||(0,d.A)(i)?((0,d.A)(h)||!(0,d.A)(A)||(0,d.A)(n)||(r(A.height,F3._emptyColor),r(t.height,F3._emptyColor)),r(t.height,t.color)):(r(t.height,t.color),r(t.height,F3._emptyColor),r(h.height,F3._emptyColor)),a++):(0,d.A)(h)&&(!(0,d.A)(t)||h.height<t.height)&&(r(h.height,h.color),c++)}}return B3(i)}(n),r=o.length;let s,a,c;if(F3._useFloatTexture(i)){a=U.A.FLOAT,c=i.webgl2?R.A.RED:R.A.LUMINANCE,s=new Float32Array(r);for(let e=0;e<r;e++)s[e]=o[e].height}else{a=U.A.UNSIGNED_BYTE,c=R.A.RGBA,s=new Uint8Array(4*r);for(let e=0;e<r;e++)Q.A.packFloat(o[e].height,R3),Q.A.pack(R3,s,4*e)}const h=G.A.create({context:i,pixelFormat:c,pixelDatatype:a,source:{arrayBufferView:s,width:r,height:1},sampler:new At.A({wrapS:It.A.CLAMP_TO_EDGE,wrapT:It.A.CLAMP_TO_EDGE,minificationFilter:bt.A.NEAREST,magnificationFilter:Tt.A.NEAREST})}),p=new Uint8Array(4*r);for(let e=0;e<r;e++)o[e].color.toBytes(M3),p[4*e+0]=M3[0],p[4*e+1]=M3[1],p[4*e+2]=M3[2],p[4*e+3]=M3[3];const f=G.A.create({context:i,pixelFormat:R.A.RGBA,pixelDatatype:U.A.UNSIGNED_BYTE,source:{arrayBufferView:p,width:r,height:1},sampler:new At.A({wrapS:It.A.CLAMP_TO_EDGE,wrapT:It.A.CLAMP_TO_EDGE,minificationFilter:bt.A.LINEAR,magnificationFilter:Tt.A.LINEAR})});return Dn.A.fromType("ElevationBand",{heights:h,colors:f})}F3._useFloatTexture=function(e){return e.floatingPointTexture},F3._maximumHeight=5906376425472,F3._minimumHeight=-5906376425472,F3._emptyColor=new u.A(0,0,0,0);const U3=F3,k3={},V3=async function(e,t){(t=t??{}).cacheBytes=t.cacheBytes??1610612736,t.maximumCacheOverflowBytes=t.maximumCacheOverflowBytes??1073741824,t.enableCollision=t.enableCollision??!0,e=e??S.A.EMPTY_OBJECT,l.A.typeOf.object("apiOptions",e),e.onlyUsingWithGoogleGeocoder||(0,Fn.A)("google-tiles-with-google-geocoder","Only the Google geocoder can be used with Google Photorealistic 3D Tiles.  Set the `geocode` property of Viewer constructor options.  You can set additionalOptions.onlyUsingWithGoogleGeocoder to hide this warning once you have configured the geocoder.");const n=e.key??zD.defaultApiKey;if(!(0,d.A)(n))return async function(e){const t=2275207;let n=k3[2275207];(0,d.A)(n)||(n=MO.A.fromAssetId(t),k3[2275207]=n);const i=await n;return yi.A.fromUrl(i,e)}(t);let i;const o=zD.getDefaultCredit();(0,d.A)(o)&&(i=[o]);const r=new Lt.A({url:`${zD.mapTilesApiEndpoint}3dtiles/root.json`,queryParameters:{key:n},credits:i});return yi.A.fromUrl(r,t)},z3=async function(e){const t=await yi.A.fromIonAssetId(96188,e);let n=(e=e??S.A.EMPTY_OBJECT).style;if(!(0,d.A)(n)){const t=(e.defaultColor??u.A.WHITE).toCssColorString();n=new AJ.A({color:`Boolean(\${feature['cesium#color']}) ? color(\${feature['cesium#color']}) : ${t}`})}return t.style=n,t},H3=function(e){const t=[];let n=(e=e??S.A.EMPTY_OBJECT).geometry;if(!(0,d.A)(n))throw new A.A("options.geometry is required.");(0,d.A)(n.attributes)&&(0,d.A)(n.primitiveType)||(n=n.constructor.createGeometry(n));const i=n.attributes,o=O.A.clone(e.modelMatrix??O.A.IDENTITY),r=e.length??1e4;if((0,d.A)(i.normal)&&t.push(new yn.A({geometry:Ad.A.createLineSegmentsForVectors(n,"normal",r),attributes:{color:new mn.A(1,0,0,1)},modelMatrix:o})),(0,d.A)(i.tangent)&&t.push(new yn.A({geometry:Ad.A.createLineSegmentsForVectors(n,"tangent",r),attributes:{color:new mn.A(0,1,0,1)},modelMatrix:o})),(0,d.A)(i.bitangent)&&t.push(new yn.A({geometry:Ad.A.createLineSegmentsForVectors(n,"bitangent",r),attributes:{color:new mn.A(0,0,1,1)},modelMatrix:o})),t.length>0)return new Pn.A({asynchronous:!1,geometryInstances:t,appearance:new Cn.A({flat:!0,translucent:!1})})};var G3=n(655028),W3=n(635649),Y3=n(217543),q3=n(961624),j3=n(351554),Q3=n(63267),X3=n(115959),K3=n(4471),$3=n(613161),J3=n(2218),Z3=n(301005),e4=n(980509),t4=n(291192),n4=n(149800),i4=n(495702),o4=n(328326),r4=n(857831),s4=n(537335),a4=n(692608),c4=n(438376),l4=n(64137),u4=n(373785),d4=n(239942),h4=n(980360),A4=n(874099),p4=n(360069),f4=n(70966),m4=n(21561),g4=n(831373),_4=n(375916),y4=n(76846),v4=n(320441),T4=n(830539),b4=n(227798),w4=n(207131),x4=n(889216),C4=n(865114),E4=n(256773),S4=n(807783),I4=n(551672),P4=n(733185),D4=n(50937),O4=n(390249),R4=n(759889),M4=n(726401),L4=n(58747),N4=n(181163),B4=n(625322),F4=n(204410),U4=n(896077),k4=n(575581),V4=n(490129),z4=n(75899),H4=n(295673),G4=n(370988),W4=n(419421),Y4=n(563402),q4=n(143938),j4=n(801202),Q4=n(403139),X4=n(521791),K4=n(212143),$4=n(325161),J4=n(261126),Z4=n(221334),e6=n(980678),t6=n(768601),n6=n(501782),i6=n(828077),o6=n(7562),r6=n(34274),s6=n(494098),a6=n(443045),c6=n(40640),l6=n(323745);const u6="uniform sampler2D u_depthTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture(u_depthTexture, v_textureCoordinates));\n    z_window = czm_reverseLogDepth(z_window);\n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    out_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n";var d6=n(812178),h6=n(133240),A6=n(724447),p6=n(267047),f6=n(84334),m6=n(114098),g6=n(865980),_6=n(155463),y6=n(839078),v6=n(464335),T6=n(534702),b6=n(614480),w6=n(884137),x6=n(494490),C6=n(137261),E6=n(512286),S6=n(578283),I6=n(166479),P6=n(495331),D6=n(277315),O6=n(899557),R6=n(330483),M6=n(94334),L6=n(913081),N6=n(493435),B6=n(19120),F6=n(538198),U6=n(802227),k6=n(186919),V6=n(212642),z6=n(503631),H6=n(899700),G6=n(662274),W6=n(381508),Y6=n(13916),q6=n(598073),j6=n(66502),Q6=n(320578),X6=n(521032),K6=n(3282),$6=n(509830),J6=n(890692),Z6=n(577847),e5=n(610084),t5=n(391648),n5=n(281810),i5=n(10803),o5=n(817082),r5=n(736355),s5=n(193497),a5=n(64389),c5=n(224975),l5=n(56241),u5=n(156621),d5=n(275670),h5=n(4773),A5=n(41358),p5=n(647478),f5=n(303036),m5=n(855692),g5=n(542614),_5=n(270316),y5=n(652259),v5=n(242893),T5=n(947129),b5=n(701111),w5=n(112497),x5=n(127329),C5=n(657685),E5=n(922167),S5=n(17728),I5=n(949020),P5=n(136426),D5=n(885251),O5=n(850210),R5=n(814071),M5=n(746761),L5=n(496854),N5=n(566258),B5=n(650884),F5=n(226827),U5=n(471147),k5=n(163010),V5=n(604883),z5=n(799395),H5=n(601945),G5=n(31908),W5=n(752709),Y5=n(623524),q5=n(366413),j5=n(214666),Q5=n(531218),X5=n(252843),K5=n(391852),$5=n(456727),J5=n(942836);const Z5=function(e){e=e??S.A.EMPTY_OBJECT;const t=(0,d.A)(e.typedArray);if(t===(0,d.A)(e.url))throw new A.A("exactly one of options.typedArray, options.url must be defined");if(t&&(!(0,d.A)(e.width)||!(0,d.A)(e.height)))throw new A.A("options.width and options.height are required when options.typedArray is defined");this.typedArray=e.typedArray,this.width=e.width,this.height=e.height,this.pixelFormat=e.pixelFormat??R.A.RGBA,this.pixelDatatype=e.pixelDatatype??U.A.UNSIGNED_BYTE;let n=e.url;"string"==typeof n&&(n=Lt.A.createIfNeeded(n)),this.resource=n;const i=e.repeat??1?It.A.REPEAT:It.A.CLAMP_TO_EDGE;this.sampler=new At.A({wrapS:i,wrapT:i,minificationFilter:e.minificationFilter,magnificationFilter:e.magnificationFilter,maximumAnisotropy:e.maximumAnisotropy})};var e8=n(807048);const t8=Object.freeze({FLOAT:"float",VEC2:"vec2",VEC3:"vec3",VEC4:"vec4",MAT2:"mat2",MAT3:"mat3",MAT4:"mat4"});var n8=n(641882),i8=n(6214),o8=n(965020),r8=n(433175),s8=n(779548),a8=n(945363),c8=n(575190),l8=n(703381),u8=n(960352),d8=n(550071),h8=n(291146),A8=n(680633),p8=n(751418),f8=n(616053),m8=n(509473),g8=n(54754),_8=n(484374),y8=n(673089),v8=n(178303),T8=n(658594),b8=n(228970),w8=n(135869),x8=n(517382),C8=n(538496),E8=n(747543),S8=n(317374),I8=n(884252),P8=n(485806),D8=n(903149),O8=n(601995),R8=n(552111),M8=n(154487),L8=n(856253),N8=n(685879),B8=n(570941),F8=n(819888),U8=n(656328),k8=n(915065),V8=n(564363),z8=n(300255),H8=n(658169),G8=n(820965),W8=n(30284),Y8=n(851714),q8=n(423340),j8=n(416407),Q8=n(171037),X8=n(41715),K8=n(229806),$8=n(731759),J8=n(106245),Z8=n(638211),e7=n(702673),t7=n(461091),n7=n(187411),i7=n(812499),o7=n(498386),r7=n(264968),s7=n(668784),a7=n(990227),c7=n(922956),l7=n(981767),u7=n(413799),d7=n(919085),h7=n(892987),A7=n(498969),p7=n(505559),f7=n(436749),m7=n(641179),g7=n(68787),_7=n(803270),y7=n(225424),v7=n(441786),T7=n(865459),b7=n(269453),w7=n(817515),x7=n(240790),C7=n(12624),E7=n(13500),S7=n(943703),I7=n(915493),P7=n(493458),D7=n(820789),O7=n(565274),R7=n(247408),M7=n(177627),L7=n(624782),N7=n(195814),B7=n(9102),F7=n(534173),U7=n(348941),k7=n(431443),V7=n(448358),z7=n(633899),H7=n(393597),G7=n(293367),W7=n(31862),Y7=n(610675),q7=n(160958),j7=n(21038),Q7=n(363063),X7=n(973717),K7=n(254805),$7=n(548051),J7=n(191195),Z7=n(738340),e9=n(674794),t9=n(584312),n9=n(428395),i9=n(696042),o9=n(820121),r9=n(147769),s9=n(394839),a9=n(932901),c9=n(527105),l9=n(916117),u9=n(755541),d9=n(463540),h9=n(199494),A9=n(82914),p9=n(568758),f9=n(562348),m9=n(19687),g9=n(501738),_9=n(660164),y9=n(480262),v9=n(608860),T9=n(980902),b9=n(367309),w9=n(880691),x9=n(648777),C9=n(231511),E9=n(293752),S9=n(617172),I9=n(169513),P9=n(720547),D9=n(584783),O9=n(10451),R9=n(237688),M9=n(322556),L9=n(593920),N9=n(316923),B9=n(882209),F9=n(659282),U9=n(912726),k9=n(893828),V9=n(47367),z9=n(714574);const H9=Object.freeze({SIGX:"SIGX",SIGY:"SIGY",SIGZ:"SIGZ",VARX:"VARX",VARY:"VARY",VARZ:"VARZ",SIGR:"VARZ"});var G9=n(858288),W9=n(453056),Y9=n(844833);const q9=function(e){return self.onmessage=async function({data:t}){const n=[],i={id:t.id,result:void 0,error:void 0};self.CESIUM_BASE_URL=t.baseUrl;try{const o=await e(t.parameters,n);i.result=o}catch(e){e instanceof Error?i.error={name:e.name,message:e.message,stack:e.stack}:i.error=e}t.canTransferArrayBuffer||(n.length=0);try{postMessage(i,n)}catch(e){i.result=void 0,i.error=`postMessage failed with error: ${(0,mM.A)(e)}\n  with responseMessage: ${JSON.stringify(i)}`,postMessage(i)}},self.onmessageerror=function(e){postMessage({id:e.data?.id,error:`postMessage failed with error: ${JSON.stringify(e)}`})},self};var j9=n(112306),Q9=n(562459);const X9=function(){this.canExecute=void 0,this.beforeExecute=void 0,this.afterExecute=void 0,Q9.A.throwInstantiationError()};var K9=n(725903),$9=n(117502);const J9={createCheckbox:function(e,t,n){K9.A.typeOf.string("labelText",e),K9.A.typeOf.string("checkedBinding",t);const i=document.createElement("div"),o=document.createElement("label"),r=document.createElement("input");r.type="checkbox";let s=`checked: ${t}`;return(0,$9.A)(n)&&(s+=`, enable: ${n}`),r.setAttribute("data-bind",s),o.appendChild(r),o.appendChild(document.createTextNode(e)),i.appendChild(o),i},createSection:function(e,t,n,i){K9.A.defined("panel",e),K9.A.typeOf.string("headerText",t),K9.A.typeOf.string("sectionVisibleBinding",n),K9.A.typeOf.string("toggleSectionVisibilityBinding",i);const o=document.createElement("div");o.className="cesium-cesiumInspector-section",o.setAttribute("data-bind",`css: { "cesium-cesiumInspector-section-collapsed": !${n} }`),e.appendChild(o);const r=document.createElement("h3");r.className="cesium-cesiumInspector-sectionHeader",r.appendChild(document.createTextNode(t)),r.setAttribute("data-bind",`click: ${i}`),o.appendChild(r);const s=document.createElement("div");return s.className="cesium-cesiumInspector-sectionContent",o.appendChild(s),s},createRangeInput:function(e,t,n,i,o,r){K9.A.typeOf.string("rangeText",e),K9.A.typeOf.string("sliderValueBinding",t),K9.A.typeOf.number("min",n),K9.A.typeOf.number("max",i),r=r??t;const s=document.createElement("input");s.setAttribute("data-bind",`value: ${r}`),s.type="number";const a=document.createElement("input");a.type="range",a.min=n,a.max=i,a.step=o??"any",a.setAttribute("data-bind",`valueUpdate: "input", value: ${t}`);const c=document.createElement("div");c.appendChild(a);const l=document.createElement("div");return l.className="cesium-cesiumInspector-slider",l.appendChild(document.createTextNode(e)),l.appendChild(s),l.appendChild(c),l},createRangeInputWithDynamicMinMax:function(e,t,n,i){K9.A.typeOf.string("rangeText",e),K9.A.typeOf.string("sliderValueBinding",t),i=i??t;const o=document.createElement("input");o.setAttribute("data-bind",`value: ${i}`),o.type="number";const r=document.createElement("input");r.type="range",r.step=n??"any",r.setAttribute("data-bind",`valueUpdate: "input", value: ${t}, attr: { min: ${t}Min, max: ${t}Max }`);const s=document.createElement("div");s.appendChild(r);const a=document.createElement("div");return a.className="cesium-cesiumInspector-slider",a.appendChild(document.createTextNode(e)),a.appendChild(o),a.appendChild(s),a},createButton:function(e,t,n){K9.A.typeOf.string("buttonText",e),K9.A.typeOf.string("clickedBinding",t);const i=document.createElement("button");i.type="button",i.textContent=e,i.className="cesium-cesiumInspector-pickButton";let o=`click: ${t}`;return(0,$9.A)(n)&&(o+=`, css: {"cesium-cesiumInspector-pickButtonHighlight" : ${n}}`),i.setAttribute("data-bind",o),i}},Z9=J9;var eee=n(677854),tee=n(798518),nee=n(277441),iee=n(618168),oee=n(338863),ree=n(806441),see=n(622463),aee=n(647054),cee=n(687194),lee=n(364310),uee=n(177647),dee=n(181576),hee=n(680210),Aee=n(914684),pee=n(705222),fee=n(624129),mee=n(378970),gee=n(889653),_ee=n(189158),yee=n(4828),vee=n(376185),Tee=n(378478),bee=n(23201),wee=n(10991),xee=n(526126),Cee=n(728837),Eee=n(640124),See=n(808240);function Iee(e,t){this._conditionsExpression=(0,xee.A)(e,!0),this._conditions=e.conditions,this._runtimeConditions=void 0,function(e,t){const n=[],i=e._conditions;if(!(0,$9.A)(i))return;const o=i.length;for(let e=0;e<o;++e){const o=i[e],r=String(o[0]),s=String(o[1]);n.push(new Pee(new See.A(r,t),new See.A(s,t)))}e._runtimeConditions=n}(this,t)}function Pee(e,t){this.condition=e,this.expression=t}Object.defineProperties(Iee.prototype,{conditionsExpression:{get:function(){return this._conditionsExpression}}}),Iee.prototype.evaluate=function(e,t){const n=this._runtimeConditions;if(!(0,$9.A)(n))return;const i=n.length;for(let o=0;o<i;++o){const i=n[o];if(i.condition.evaluate(e))return i.expression.evaluate(e,t)}},Iee.prototype.evaluateColor=function(e,t){const n=this._runtimeConditions;if(!(0,$9.A)(n))return;const i=n.length;for(let o=0;o<i;++o){const i=n[o];if(i.condition.evaluate(e))return i.expression.evaluateColor(e,t)}},Iee.prototype.getShaderFunction=function(e,t,n,i){const o=this._runtimeConditions;if(!(0,$9.A)(o)||0===o.length)return;let r="";const s=o.length;for(let e=0;e<s;++e){const i=o[e];r+=`    ${0===e?"if":"else if"} (${i.condition.getShaderExpression(t,n)})\n    {\n        return ${i.expression.getShaderExpression(t,n)};\n    }\n`}return r=`${i} ${e}\n{\n${r}    return ${i}(1.0);\n}\n`,r},Iee.prototype.getVariables=function(){let e=[];const t=this._runtimeConditions;if(!(0,$9.A)(t)||0===t.length)return e;const n=t.length;for(let i=0;i<n;++i){const n=t[i];(0,wee.A)(e,n.condition.getVariables()),(0,wee.A)(e,n.expression.getVariables())}return e=e.filter(function(e,t,n){return n.indexOf(e)===t}),e};const Dee=Iee;function Oee(e){this._style={},this._ready=!1,this._show=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._labelColor=void 0,this._labelOutlineColor=void 0,this._labelOutlineWidth=void 0,this._font=void 0,this._labelStyle=void 0,this._labelText=void 0,this._backgroundColor=void 0,this._backgroundPadding=void 0,this._backgroundEnabled=void 0,this._scaleByDistance=void 0,this._translucencyByDistance=void 0,this._distanceDisplayCondition=void 0,this._heightOffset=void 0,this._anchorLineEnabled=void 0,this._anchorLineColor=void 0,this._image=void 0,this._disableDepthTestDistance=void 0,this._horizontalOrigin=void 0,this._verticalOrigin=void 0,this._labelHorizontalOrigin=void 0,this._labelVerticalOrigin=void 0,this._meta=void 0,this._colorShaderFunction=void 0,this._showShaderFunction=void 0,this._pointSizeShaderFunction=void 0,this._colorShaderFunctionReady=!1,this._showShaderFunctionReady=!1,this._pointSizeShaderFunctionReady=!1,this._colorShaderTranslucent=!1,function(e,t){t=(0,xee.A)(t,!0)??e._style,e._style=t,e.show=t.show,e.color=t.color,e.pointSize=t.pointSize,e.pointOutlineColor=t.pointOutlineColor,e.pointOutlineWidth=t.pointOutlineWidth,e.labelColor=t.labelColor,e.labelOutlineColor=t.labelOutlineColor,e.labelOutlineWidth=t.labelOutlineWidth,e.labelStyle=t.labelStyle,e.font=t.font,e.labelText=t.labelText,e.backgroundColor=t.backgroundColor,e.backgroundPadding=t.backgroundPadding,e.backgroundEnabled=t.backgroundEnabled,e.scaleByDistance=t.scaleByDistance,e.translucencyByDistance=t.translucencyByDistance,e.distanceDisplayCondition=t.distanceDisplayCondition,e.heightOffset=t.heightOffset,e.anchorLineEnabled=t.anchorLineEnabled,e.anchorLineColor=t.anchorLineColor,e.image=t.image,e.disableDepthTestDistance=t.disableDepthTestDistance,e.horizontalOrigin=t.horizontalOrigin,e.verticalOrigin=t.verticalOrigin,e.labelHorizontalOrigin=t.labelHorizontalOrigin,e.labelVerticalOrigin=t.labelVerticalOrigin;const n={};if((0,$9.A)(t.meta)){const e=t.defines,i=t.meta??Cee.A.EMPTY_OBJECT;for(const t in i)i.hasOwnProperty(t)&&(n[t]=new See.A(i[t],e))}e._meta=n,e._ready=!0}(this,e)}function Ree(e,t){const n=(e._style??Cee.A.EMPTY_OBJECT).defines;if((0,$9.A)(t))return"boolean"==typeof t||"number"==typeof t?new See.A(String(t)):"string"==typeof t?new See.A(t,n):(0,$9.A)(t.conditions)?new Dee(t,n):t}function Mee(e){if((0,$9.A)(e))return(0,$9.A)(e.expression)?e.expression:(0,$9.A)(e.conditionsExpression)?(0,xee.A)(e.conditionsExpression,!0):e}Object.defineProperties(Oee.prototype,{style:{get:function(){return this._style}},show:{get:function(){return this._show},set:function(e){this._show=Ree(this,e),this._style.show=Mee(this._show),this._showShaderFunctionReady=!1}},color:{get:function(){return this._color},set:function(e){this._color=Ree(this,e),this._style.color=Mee(this._color),this._colorShaderFunctionReady=!1}},pointSize:{get:function(){return this._pointSize},set:function(e){this._pointSize=Ree(this,e),this._style.pointSize=Mee(this._pointSize),this._pointSizeShaderFunctionReady=!1}},pointOutlineColor:{get:function(){return this._pointOutlineColor},set:function(e){this._pointOutlineColor=Ree(this,e),this._style.pointOutlineColor=Mee(this._pointOutlineColor)}},pointOutlineWidth:{get:function(){return this._pointOutlineWidth},set:function(e){this._pointOutlineWidth=Ree(this,e),this._style.pointOutlineWidth=Mee(this._pointOutlineWidth)}},labelColor:{get:function(){return this._labelColor},set:function(e){this._labelColor=Ree(this,e),this._style.labelColor=Mee(this._labelColor)}},labelOutlineColor:{get:function(){return this._labelOutlineColor},set:function(e){this._labelOutlineColor=Ree(this,e),this._style.labelOutlineColor=Mee(this._labelOutlineColor)}},labelOutlineWidth:{get:function(){return this._labelOutlineWidth},set:function(e){this._labelOutlineWidth=Ree(this,e),this._style.labelOutlineWidth=Mee(this._labelOutlineWidth)}},font:{get:function(){return this._font},set:function(e){this._font=Ree(this,e),this._style.font=Mee(this._font)}},labelStyle:{get:function(){return this._labelStyle},set:function(e){this._labelStyle=Ree(this,e),this._style.labelStyle=Mee(this._labelStyle)}},labelText:{get:function(){return this._labelText},set:function(e){this._labelText=Ree(this,e),this._style.labelText=Mee(this._labelText)}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=Ree(this,e),this._style.backgroundColor=Mee(this._backgroundColor)}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){this._backgroundPadding=Ree(this,e),this._style.backgroundPadding=Mee(this._backgroundPadding)}},backgroundEnabled:{get:function(){return this._backgroundEnabled},set:function(e){this._backgroundEnabled=Ree(this,e),this._style.backgroundEnabled=Mee(this._backgroundEnabled)}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){this._scaleByDistance=Ree(this,e),this._style.scaleByDistance=Mee(this._scaleByDistance)}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){this._translucencyByDistance=Ree(this,e),this._style.translucencyByDistance=Mee(this._translucencyByDistance)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=Ree(this,e),this._style.distanceDisplayCondition=Mee(this._distanceDisplayCondition)}},heightOffset:{get:function(){return this._heightOffset},set:function(e){this._heightOffset=Ree(this,e),this._style.heightOffset=Mee(this._heightOffset)}},anchorLineEnabled:{get:function(){return this._anchorLineEnabled},set:function(e){this._anchorLineEnabled=Ree(this,e),this._style.anchorLineEnabled=Mee(this._anchorLineEnabled)}},anchorLineColor:{get:function(){return this._anchorLineColor},set:function(e){this._anchorLineColor=Ree(this,e),this._style.anchorLineColor=Mee(this._anchorLineColor)}},image:{get:function(){return this._image},set:function(e){this._image=Ree(this,e),this._style.image=Mee(this._image)}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance=Ree(this,e),this._style.disableDepthTestDistance=Mee(this._disableDepthTestDistance)}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin=Ree(this,e),this._style.horizontalOrigin=Mee(this._horizontalOrigin)}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){this._verticalOrigin=Ree(this,e),this._style.verticalOrigin=Mee(this._verticalOrigin)}},labelHorizontalOrigin:{get:function(){return this._labelHorizontalOrigin},set:function(e){this._labelHorizontalOrigin=Ree(this,e),this._style.labelHorizontalOrigin=Mee(this._labelHorizontalOrigin)}},labelVerticalOrigin:{get:function(){return this._labelVerticalOrigin},set:function(e){this._labelVerticalOrigin=Ree(this,e),this._style.labelVerticalOrigin=Mee(this._labelVerticalOrigin)}},meta:{get:function(){return this._meta},set:function(e){this._meta=e}}}),Oee.fromUrl=function(e){if(!(0,$9.A)(e))throw new Q9.A("url is required");return Eee.A.createIfNeeded(e).fetchJson(e).then(function(e){return new Oee(e)})},Oee.prototype.getColorShaderFunction=function(e,t,n){return this._colorShaderFunctionReady?(n.translucent=this._colorShaderTranslucent,this._colorShaderFunction):(this._colorShaderFunctionReady=!0,(0,$9.A)(this.color)&&(0,$9.A)(this.color.getShaderFunction)?this._colorShaderFunction=this.color.getShaderFunction(e,t,n,"vec4"):this._colorShaderFunction=void 0,this._colorShaderTranslucent=n.translucent,this._colorShaderFunction)},Oee.prototype.getShowShaderFunction=function(e,t,n){return this._showShaderFunctionReady||(this._showShaderFunctionReady=!0,(0,$9.A)(this.show)&&(0,$9.A)(this.show.getShaderFunction)?this._showShaderFunction=this.show.getShaderFunction(e,t,n,"bool"):this._showShaderFunction=void 0),this._showShaderFunction},Oee.prototype.getPointSizeShaderFunction=function(e,t,n){return this._pointSizeShaderFunctionReady||(this._pointSizeShaderFunctionReady=!0,(0,$9.A)(this.pointSize)&&(0,$9.A)(this.pointSize.getShaderFunction)?this._pointSizeShaderFunction=this.pointSize.getShaderFunction(e,t,n,"float"):this._pointSizeShaderFunction=void 0),this._pointSizeShaderFunction},Oee.prototype.getVariables=function(){let e=[];return(0,$9.A)(this.color)&&(0,$9.A)(this.color.getVariables)&&(0,wee.A)(e,this.color.getVariables()),(0,$9.A)(this.show)&&(0,$9.A)(this.show.getVariables)&&(0,wee.A)(e,this.show.getVariables()),(0,$9.A)(this.pointSize)&&(0,$9.A)(this.pointSize.getVariables)&&(0,wee.A)(e,this.pointSize.getVariables()),e=e.filter(function(e,t,n){return n.indexOf(e)===t}),e};const Lee=Oee;function Nee(e,t){t?e._eventHandler.setInputAction(function(t){const n=e._scene.pick(t.endPosition);(0,$9.A)(n)&&n.primitive instanceof pee.A&&(e.tileset=n.primitive)},fee.A.MOUSE_MOVE):(e._eventHandler.removeInputAction(fee.A.MOUSE_MOVE),e.picking=e.picking)}const Bee={maximumFractionDigits:3};function Fee(e){const t=e/1048576;return t<1?t.toLocaleString(void 0,Bee):Math.round(t).toLocaleString()}function Uee(e,t){if(!(0,$9.A)(e))return"";const n=t?e._statisticsPerPass[mee.A.PICK]:e._statisticsPerPass[mee.A.RENDER];let i='<ul class="cesium-cesiumInspector-statistics">';return i+=`<li><strong>Visited: </strong>${n.visited.toLocaleString()}</li><li><strong>Selected: </strong>${n.selected.toLocaleString()}</li><li><strong>Commands: </strong>${n.numberOfCommands.toLocaleString()}</li>`,i+="</ul>",t||(i+='<ul class="cesium-cesiumInspector-statistics">',i+=`<li><strong>Requests: </strong>${n.numberOfPendingRequests.toLocaleString()}</li><li><strong>Attempted: </strong>${n.numberOfAttemptedRequests.toLocaleString()}</li><li><strong>Processing: </strong>${n.numberOfTilesProcessing.toLocaleString()}</li><li><strong>Content Ready: </strong>${n.numberOfTilesWithContentReady.toLocaleString()}</li><li><strong>Total: </strong>${n.numberOfTilesTotal.toLocaleString()}</li>`,i+="</ul>",i+='<ul class="cesium-cesiumInspector-statistics">',i+=`<li><strong>Features Selected: </strong>${n.numberOfFeaturesSelected.toLocaleString()}</li><li><strong>Features Loaded: </strong>${n.numberOfFeaturesLoaded.toLocaleString()}</li><li><strong>Points Selected: </strong>${n.numberOfPointsSelected.toLocaleString()}</li><li><strong>Points Loaded: </strong>${n.numberOfPointsLoaded.toLocaleString()}</li><li><strong>Triangles Selected: </strong>${n.numberOfTrianglesSelected.toLocaleString()}</li>`,i+="</ul>",i+='<ul class="cesium-cesiumInspector-statistics">',i+=`<li><strong>Tiles styled: </strong>${n.numberOfTilesStyled.toLocaleString()}</li><li><strong>Features styled: </strong>${n.numberOfFeaturesStyled.toLocaleString()}</li>`,i+="</ul>",i+='<ul class="cesium-cesiumInspector-statistics">',i+=`<li><strong>Children Union Culled: </strong>${n.numberOfTilesCulledWithChildrenUnion.toLocaleString()}</li>`,i+="</ul>",i+='<ul class="cesium-cesiumInspector-statistics">',i+=`<li><strong>Geometry Memory (MB): </strong>${Fee(n.geometryByteLength)}</li><li><strong>Texture Memory (MB): </strong>${Fee(n.texturesByteLength)}</li><li><strong>Batch Table Memory (MB): </strong>${Fee(n.batchTableByteLength)}</li>`,i+="</ul>"),i}function kee(){const e=gee.A.statistics;return`\n  <ul class="cesium-cesiumInspector-statistics">\n    <li><strong>Geometry Memory (MB): </strong>${Fee(e.geometryByteLength)}</li>\n    <li><strong>Texture Memory (MB): </strong>${Fee(e.texturesByteLength)}</li>\n  </ul>\n  `}const Vee=[{text:"Highlight",value:_ee.A.HIGHLIGHT},{text:"Replace",value:_ee.A.REPLACE},{text:"Mix",value:_ee.A.MIX}],zee=new yee.A(1,1,0,.4),Hee=new yee.A,Gee=new yee.A;function Wee(e,t){K9.A.typeOf.object("scene",e),K9.A.typeOf.object("performanceContainer",t);const n=this,i=e.canvas;this._eventHandler=new vee.A(i),this._scene=e,this._performanceContainer=t,this._canvas=i,this._performanceDisplay=new Tee.A({container:t}),this._statisticsText="",this._pickStatisticsText="",this._resourceCacheStatisticsText="",this._editorError="",this.performance=!1,this.showStatistics=!0,this.showPickStatistics=!0,this.showResourceCacheStatistics=!1,this.inspectorVisible=!0,this.tilesetVisible=!1,this.displayVisible=!1,this.updateVisible=!1,this.loggingVisible=!1,this.styleVisible=!1,this.tileDebugLabelsVisible=!1,this.optimizationVisible=!1,this.styleString="{}",this.hasEnabledWireframe=!1,this._tileset=void 0,this._feature=void 0,this._tile=void 0,Aee.A.track(this,["performance","inspectorVisible","_statisticsText","_pickStatisticsText","_resourceCacheStatisticsText","_editorError","showPickStatistics","showStatistics","showResourceCacheStatistics","tilesetVisible","displayVisible","updateVisible","loggingVisible","styleVisible","optimizationVisible","tileDebugLabelsVisible","styleString","_feature","_tile","_tileset","hasEnabledWireframe"]),this._properties=Aee.A.observable({}),this.properties=[],Aee.A.defineProperty(this,"properties",function(){const e=[],t=n._properties();for(const n in t)t.hasOwnProperty(n)&&e.push(n);return e});const o=Aee.A.observable();Aee.A.defineProperty(this,"dynamicScreenSpaceError",{get:function(){return o()},set:function(e){o(e),(0,$9.A)(n._tileset)&&(n._tileset.dynamicScreenSpaceError=e)}}),this.dynamicScreenSpaceError=!1;const r=Aee.A.observable();Aee.A.defineProperty(this,"colorBlendMode",{get:function(){return r()},set:function(e){r(e),(0,$9.A)(n._tileset)&&(n._tileset.colorBlendMode=e,n._scene.requestRender())}}),this.colorBlendMode=_ee.A.HIGHLIGHT;const s=Aee.A.observable(),a=Aee.A.observable();Aee.A.defineProperty(this,"picking",{get:function(){return a()},set:function(t){a(t),t?n._eventHandler.setInputAction(function(t){const i=e.pick(t.endPosition);if(i instanceof bee.A?(n.feature=i,n.tile=i.content.tile):(0,$9.A)(i)&&(0,$9.A)(i.content)?(n.feature=void 0,n.tile=i.content.tile):(n.feature=void 0,n.tile=void 0),(0,$9.A)(n._tileset)){if(s&&(0,$9.A)(i)&&(0,$9.A)(i.content)){let o;e.pickPositionSupported&&(o=e.pickPosition(t.endPosition),(0,$9.A)(o)&&(n._tileset.debugPickPosition=o)),n._tileset.debugPickedTile=i.content.tile}else n._tileset.debugPickedTile=void 0;n._scene.requestRender()}},fee.A.MOUSE_MOVE):(n.feature=void 0,n.tile=void 0,n._eventHandler.removeInputAction(fee.A.MOUSE_MOVE))}}),this.picking=!0;const c=Aee.A.observable();Aee.A.defineProperty(this,"colorize",{get:function(){return c()},set:function(e){c(e),(0,$9.A)(n._tileset)&&(n._tileset.debugColorizeTiles=e,n._scene.requestRender())}}),this.colorize=!1;const l=Aee.A.observable();Aee.A.defineProperty(this,"wireframe",{get:function(){return l()},set:function(e){l(e),(0,$9.A)(n._tileset)&&(n._tileset.debugWireframe=e,n._scene.requestRender())}}),this.wireframe=!1;const u=Aee.A.observable();Aee.A.defineProperty(this,"showBoundingVolumes",{get:function(){return u()},set:function(e){u(e),(0,$9.A)(n._tileset)&&(n._tileset.debugShowBoundingVolume=e,n._scene.requestRender())}}),this.showBoundingVolumes=!1;const d=Aee.A.observable();Aee.A.defineProperty(this,"showContentBoundingVolumes",{get:function(){return d()},set:function(e){d(e),(0,$9.A)(n._tileset)&&(n._tileset.debugShowContentBoundingVolume=e,n._scene.requestRender())}}),this.showContentBoundingVolumes=!1;const h=Aee.A.observable();Aee.A.defineProperty(this,"showRequestVolumes",{get:function(){return h()},set:function(e){h(e),(0,$9.A)(n._tileset)&&(n._tileset.debugShowViewerRequestVolume=e,n._scene.requestRender())}}),this.showRequestVolumes=!1;const A=Aee.A.observable();Aee.A.defineProperty(this,"freezeFrame",{get:function(){return A()},set:function(e){A(e),(0,$9.A)(n._tileset)&&(n._tileset.debugFreezeFrame=e,n._scene.debugShowFrustumPlanes=e,n._scene.requestRender())}}),this.freezeFrame=!1,Aee.A.defineProperty(this,"showOnlyPickedTileDebugLabel",{get:function(){return s()},set:function(e){s(e),(0,$9.A)(n._tileset)&&(n._tileset.debugPickedTileLabelOnly=e,n._scene.requestRender())}}),this.showOnlyPickedTileDebugLabel=!1;const p=Aee.A.observable();Aee.A.defineProperty(this,"showGeometricError",{get:function(){return p()},set:function(e){p(e),(0,$9.A)(n._tileset)&&(n._tileset.debugShowGeometricError=e,n._scene.requestRender())}}),this.showGeometricError=!1;const f=Aee.A.observable();Aee.A.defineProperty(this,"showRenderingStatistics",{get:function(){return f()},set:function(e){f(e),(0,$9.A)(n._tileset)&&(n._tileset.debugShowRenderingStatistics=e,n._scene.requestRender())}}),this.showRenderingStatistics=!1;const m=Aee.A.observable();Aee.A.defineProperty(this,"showMemoryUsage",{get:function(){return m()},set:function(e){m(e),(0,$9.A)(n._tileset)&&(n._tileset.debugShowMemoryUsage=e,n._scene.requestRender())}}),this.showMemoryUsage=!1;const g=Aee.A.observable();Aee.A.defineProperty(this,"showUrl",{get:function(){return g()},set:function(e){g(e),(0,$9.A)(n._tileset)&&(n._tileset.debugShowUrl=e,n._scene.requestRender())}}),this.showUrl=!1;const _=Aee.A.observable();Aee.A.defineProperty(this,"maximumScreenSpaceError",{get:function(){return _()},set:function(e){e=Number(e),isNaN(e)||(_(e),(0,$9.A)(n._tileset)&&(n._tileset.maximumScreenSpaceError=e))}}),this.maximumScreenSpaceError=16;const y=Aee.A.observable();Aee.A.defineProperty(this,"dynamicScreenSpaceErrorDensity",{get:function(){return y()},set:function(e){e=Number(e),isNaN(e)||(y(e),(0,$9.A)(n._tileset)&&(n._tileset.dynamicScreenSpaceErrorDensity=e))}}),this.dynamicScreenSpaceErrorDensity=2e-4,this.dynamicScreenSpaceErrorDensitySliderValue=void 0,Aee.A.defineProperty(this,"dynamicScreenSpaceErrorDensitySliderValue",{get:function(){return Math.pow(y(),1/6)},set:function(e){const t=Math.pow(e,6);y(t),(0,$9.A)(n._tileset)&&(n._tileset.dynamicScreenSpaceErrorDensity=t)}});const v=Aee.A.observable();Aee.A.defineProperty(this,"dynamicScreenSpaceErrorFactor",{get:function(){return v()},set:function(e){e=Number(e),isNaN(e)||(v(e),(0,$9.A)(n._tileset)&&(n._tileset.dynamicScreenSpaceErrorFactor=e))}}),this.dynamicScreenSpaceErrorFactor=24;const T=(b=this,function(e){const t=b._scene.pick(e.position);(0,$9.A)(t)&&t.primitive instanceof pee.A&&(b.tileset=t.primitive),b.pickActive=!1});var b;const w=Aee.A.observable();Aee.A.defineProperty(this,"pickActive",{get:function(){return w()},set:function(e){w(e),e?n._eventHandler.setInputAction(T,fee.A.LEFT_CLICK):n._eventHandler.removeInputAction(fee.A.LEFT_CLICK)}});const x=Aee.A.observable();Aee.A.defineProperty(this,"pointCloudShading",{get:function(){return x()},set:function(e){x(e),(0,$9.A)(n._tileset)&&(n._tileset.pointCloudShading.attenuation=e)}}),this.pointCloudShading=!1;const C=Aee.A.observable();Aee.A.defineProperty(this,"geometricErrorScale",{get:function(){return C()},set:function(e){e=Number(e),isNaN(e)||(C(e),(0,$9.A)(n._tileset)&&(n._tileset.pointCloudShading.geometricErrorScale=e))}}),this.geometricErrorScale=1;const E=Aee.A.observable();Aee.A.defineProperty(this,"maximumAttenuation",{get:function(){return E()},set:function(e){e=Number(e),isNaN(e)||(E(e),(0,$9.A)(n._tileset)&&(n._tileset.pointCloudShading.maximumAttenuation=0===e?void 0:e))}}),this.maximumAttenuation=0;const S=Aee.A.observable();Aee.A.defineProperty(this,"baseResolution",{get:function(){return S()},set:function(e){e=Number(e),isNaN(e)||(S(e),(0,$9.A)(n._tileset)&&(n._tileset.pointCloudShading.baseResolution=0===e?void 0:e))}}),this.baseResolution=0;const I=Aee.A.observable();Aee.A.defineProperty(this,"eyeDomeLighting",{get:function(){return I()},set:function(e){I(e),(0,$9.A)(n._tileset)&&(n._tileset.pointCloudShading.eyeDomeLighting=e)}}),this.eyeDomeLighting=!1;const P=Aee.A.observable();Aee.A.defineProperty(this,"eyeDomeLightingStrength",{get:function(){return P()},set:function(e){e=Number(e),isNaN(e)||(P(e),(0,$9.A)(n._tileset)&&(n._tileset.pointCloudShading.eyeDomeLightingStrength=e))}}),this.eyeDomeLightingStrength=1;const D=Aee.A.observable();Aee.A.defineProperty(this,"eyeDomeLightingRadius",{get:function(){return D()},set:function(e){e=Number(e),isNaN(e)||(D(e),(0,$9.A)(n._tileset)&&(n._tileset.pointCloudShading.eyeDomeLightingRadius=e))}}),this.eyeDomeLightingRadius=1,this.pickActive=!1;const O=Aee.A.observable();Aee.A.defineProperty(this,"skipLevelOfDetail",{get:function(){return O()},set:function(e){O(e),(0,$9.A)(n._tileset)&&(n._tileset.skipLevelOfDetail=e)}}),this.skipLevelOfDetail=!0;const R=Aee.A.observable();Aee.A.defineProperty(this,"skipScreenSpaceErrorFactor",{get:function(){return R()},set:function(e){e=Number(e),isNaN(e)||(R(e),(0,$9.A)(n._tileset)&&(n._tileset.skipScreenSpaceErrorFactor=e))}}),this.skipScreenSpaceErrorFactor=16;const M=Aee.A.observable();Aee.A.defineProperty(this,"baseScreenSpaceError",{get:function(){return M()},set:function(e){e=Number(e),isNaN(e)||(M(e),(0,$9.A)(n._tileset)&&(n._tileset.baseScreenSpaceError=e))}}),this.baseScreenSpaceError=1024;const L=Aee.A.observable();Aee.A.defineProperty(this,"skipLevels",{get:function(){return L()},set:function(e){e=Number(e),isNaN(e)||(L(e),(0,$9.A)(n._tileset)&&(n._tileset.skipLevels=e))}}),this.skipLevels=1;const N=Aee.A.observable();Aee.A.defineProperty(this,"immediatelyLoadDesiredLevelOfDetail",{get:function(){return N()},set:function(e){N(e),(0,$9.A)(n._tileset)&&(n._tileset.immediatelyLoadDesiredLevelOfDetail=e)}}),this.immediatelyLoadDesiredLevelOfDetail=!1;const B=Aee.A.observable();Aee.A.defineProperty(this,"loadSiblings",{get:function(){return B()},set:function(e){B(e),(0,$9.A)(n._tileset)&&(n._tileset.loadSiblings=e)}}),this.loadSiblings=!1,this._style=void 0,this._shouldStyle=!1,this._definedProperties=["properties","dynamicScreenSpaceError","colorBlendMode","picking","colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","maximumScreenSpaceError","dynamicScreenSpaceErrorDensity","baseScreenSpaceError","skipScreenSpaceErrorFactor","skipLevelOfDetail","skipLevels","immediatelyLoadDesiredLevelOfDetail","loadSiblings","dynamicScreenSpaceErrorDensitySliderValue","dynamicScreenSpaceErrorFactor","pickActive","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl","pointCloudShading","geometricErrorScale","maximumAttenuation","baseResolution","eyeDomeLighting","eyeDomeLightingStrength","eyeDomeLightingRadius"],this._removePostRenderEvent=e.postRender.addEventListener(function(){n._update()}),(0,$9.A)(this._tileset)||Nee(this,!0)}function Yee(e){if(!(0,$9.A)(e))return!1;if(e.featuresLength>0)return!0;const t=e.innerContents;if((0,$9.A)(t)){const e=t.length;for(let n=0;n<e;++n)if(!Yee(t[n]))return!1;return!0}return!1}Object.defineProperties(Wee.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},statisticsText:{get:function(){return this._statisticsText}},pickStatisticsText:{get:function(){return this._pickStatisticsText}},resourceCacheStatisticsText:{get:function(){return this._resourceCacheStatisticsText}},colorBlendModes:{get:function(){return Vee}},editorError:{get:function(){return this._editorError}},tileset:{get:function(){return this._tileset},set:function(e){if(this._tileset=e,this._style=void 0,this.styleString="{}",this.feature=void 0,this.tile=void 0,(0,$9.A)(e)){this._properties(e.properties);const t=["colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl"],n=t.length;for(let e=0;e<n;++e){const n=t[e];this[n]=this[n]}this.maximumScreenSpaceError=e.maximumScreenSpaceError,this.dynamicScreenSpaceError=e.dynamicScreenSpaceError,this.dynamicScreenSpaceErrorDensity=e.dynamicScreenSpaceErrorDensity,this.dynamicScreenSpaceErrorFactor=e.dynamicScreenSpaceErrorFactor,this.colorBlendMode=e.colorBlendMode,this.skipLevelOfDetail=e.skipLevelOfDetail,this.skipScreenSpaceErrorFactor=e.skipScreenSpaceErrorFactor,this.baseScreenSpaceError=e.baseScreenSpaceError,this.skipLevels=e.skipLevels,this.immediatelyLoadDesiredLevelOfDetail=e.immediatelyLoadDesiredLevelOfDetail,this.loadSiblings=e.loadSiblings,this.hasEnabledWireframe=e._enableDebugWireframe;const i=e.pointCloudShading;this.pointCloudShading=i.attenuation,this.geometricErrorScale=i.geometricErrorScale,this.maximumAttenuation=i.maximumAttenuation?i.maximumAttenuation:0,this.baseResolution=i.baseResolution?i.baseResolution:0,this.eyeDomeLighting=i.eyeDomeLighting,this.eyeDomeLightingStrength=i.eyeDomeLightingStrength,this.eyeDomeLightingRadius=i.eyeDomeLightingRadius,this._scene.requestRender()}else this._properties({});this._statisticsText=Uee(e,!1),this._pickStatisticsText=Uee(e,!0),this._resourceCacheStatisticsText=kee(),Nee(this,!1)}},feature:{get:function(){return this._feature},set:function(e){if(this._feature===e)return;const t=this._feature;(0,$9.A)(t)&&!t.content.isDestroyed()&&(!this.colorize&&(0,$9.A)(this._style)?t.color=(0,$9.A)(this._style.color)?this._style.color.evaluateColor(t,Hee):yee.A.WHITE:t.color=Gee,this._scene.requestRender()),(0,$9.A)(e)&&(yee.A.clone(e.color,Gee),e.color=zee,this._scene.requestRender()),this._feature=e}},tile:{get:function(){return this._tile},set:function(e){if(this._tile===e)return;const t=this._tile;!(0,$9.A)(t)||t.isDestroyed()||Yee(t.content)||(t.color=Gee,this._scene.requestRender()),(0,$9.A)(e)&&!Yee(e.content)&&(yee.A.clone(e.color,Gee),e.color=zee,this._scene.requestRender()),this._tile=e}}}),Wee.prototype.togglePickTileset=function(){this.pickActive=!this.pickActive},Wee.prototype.toggleInspector=function(){this.inspectorVisible=!this.inspectorVisible},Wee.prototype.toggleTileset=function(){this.tilesetVisible=!this.tilesetVisible},Wee.prototype.toggleDisplay=function(){this.displayVisible=!this.displayVisible},Wee.prototype.toggleUpdate=function(){this.updateVisible=!this.updateVisible},Wee.prototype.toggleLogging=function(){this.loggingVisible=!this.loggingVisible},Wee.prototype.toggleStyle=function(){this.styleVisible=!this.styleVisible},Wee.prototype.toggleTileDebugLabels=function(){this.tileDebugLabelsVisible=!this.tileDebugLabelsVisible},Wee.prototype.toggleOptimization=function(){this.optimizationVisible=!this.optimizationVisible},Wee.prototype.trimTilesCache=function(){(0,$9.A)(this._tileset)&&this._tileset.trimLoadedTiles()},Wee.prototype.compileStyle=function(){const e=this._tileset;if((0,$9.A)(e)&&this.styleString!==JSON.stringify(e.style)){this._editorError="";try{0===this.styleString.length&&(this.styleString="{}"),this._style=new Lee(JSON.parse(this.styleString)),this._shouldStyle=!0,this._scene.requestRender()}catch(e){this._editorError=e.toString()}this.feature=this._feature,this.tile=this._tile}},Wee.prototype.styleEditorKeyPress=function(e,t){if(9===t.keyCode){t.preventDefault();const e=t.target,n=e.selectionStart,i=e.selectionEnd;let o=i;const r=e.value.slice(n,i).split("\n"),s=r.length;let a;if(t.shiftKey)for(a=0;a<s;++a)" "===r[a][0]&&(" "===r[a][1]?(r[a]=r[a].substr(2),o-=2):(r[a]=r[a].substr(1),o-=1));else for(a=0;a<s;++a)r[a]=`  ${r[a]}`,o+=2;const c=r.join("\n");e.value=e.value.slice(0,n)+c+e.value.slice(i),e.selectionStart=n!==i?n:o,e.selectionEnd=o}else!t.ctrlKey||10!==t.keyCode&&13!==t.keyCode||this.compileStyle();return!0},Wee.prototype._update=function(){const e=this._tileset;if(this.performance&&this._performanceDisplay.update(),(0,$9.A)(e)){if(e.isDestroyed())return this.tile=void 0,this.feature=void 0,void(this.tileset=void 0);const t=e.style;this._style!==e.style&&(this._shouldStyle?(e.style=this._style,this._shouldStyle=!1):(this._style=t,this.styleString=JSON.stringify(t.style,null,"  ")))}this.showStatistics&&(this._statisticsText=Uee(e,!1),this._pickStatisticsText=Uee(e,!0),this._resourceCacheStatisticsText=kee())},Wee.prototype.isDestroyed=function(){return!1},Wee.prototype.destroy=function(){this._eventHandler.destroy(),this._removePostRenderEvent();const e=this;return this._definedProperties.forEach(function(t){Aee.A.getObservable(e,t).dispose()}),(0,hee.A)(this)},Wee.getStatistics=Uee;const qee=Wee;function jee(e,t){K9.A.defined("container",e),K9.A.typeOf.object("scene",t),e=(0,dee.A)(e);const n=document.createElement("div"),i=document.createElement("div");i.setAttribute("data-bind","visible: performance");const o=new qee(t,i);this._viewModel=o,this._container=e,this._element=n;const r=document.createElement("div");r.textContent="3D Tiles Inspector",r.className="cesium-cesiumInspector-button",r.setAttribute("data-bind","click: toggleInspector"),n.appendChild(r),n.className="cesium-cesiumInspector cesium-3DTilesInspector",n.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible}'),e.appendChild(n);const s=document.createElement("div");s.className="cesium-cesiumInspector-dropDown",n.appendChild(s);const a=Z9.createSection,c=Z9.createCheckbox,l=Z9.createRangeInput,u=Z9.createButton,d=a(s,"Tileset","tilesetVisible","toggleTileset"),h=a(s,"Display","displayVisible","toggleDisplay"),A=a(s,"Update","updateVisible","toggleUpdate"),p=a(s,"Logging","loggingVisible","toggleLogging"),f=a(s,"Tile Debug Labels","tileDebugLabelsVisible","toggleTileDebugLabels"),m=a(s,"Style","styleVisible","toggleStyle"),g=a(s,"Optimization","optimizationVisible","toggleOptimization"),_=document.createElement("div");_.className="field-group";const y=document.createElement("label");y.className="field-label",y.appendChild(document.createTextNode("Properties: "));const v=document.createElement("div");v.setAttribute("data-bind","text: properties"),_.appendChild(y),_.appendChild(v),d.appendChild(_),d.appendChild(u("Pick Tileset","togglePickTileset","pickActive")),d.appendChild(u("Trim Tiles Cache","trimTilesCache")),d.appendChild(c("Enable Picking","picking")),h.appendChild(c("Colorize","colorize"));const T=h.appendChild(c("Wireframe","wireframe","_tileset === undefined || hasEnabledWireframe")),b=document.createElement("p");b.setAttribute("data-bind","visible: _tileset !== undefined && !hasEnabledWireframe"),b.setAttribute("class","cesium-3DTilesInspector-disabledElementsInfo"),b.innerText="Set enableDebugWireframe to true in the tileset constructor to enable this option.",T.appendChild(b),h.appendChild(c("Bounding Volumes","showBoundingVolumes")),h.appendChild(c("Content Volumes","showContentBoundingVolumes")),h.appendChild(c("Request Volumes","showRequestVolumes")),h.appendChild(c("Point Cloud Shading","pointCloudShading"));const w=document.createElement("div");w.setAttribute("data-bind","visible: pointCloudShading"),w.appendChild(l("Geometric Error Scale","geometricErrorScale",0,2,.01)),w.appendChild(l("Maximum Attenuation","maximumAttenuation",0,32,1)),w.appendChild(l("Base Resolution","baseResolution",0,1,.01)),w.appendChild(c("Eye Dome Lighting (EDL)","eyeDomeLighting")),h.appendChild(w);const x=document.createElement("div");x.setAttribute("data-bind","visible: eyeDomeLighting"),x.appendChild(l("EDL Strength","eyeDomeLightingStrength",0,2,.1)),x.appendChild(l("EDL Radius","eyeDomeLightingRadius",0,4,.1)),w.appendChild(x),A.appendChild(c("Freeze Frame","freezeFrame")),A.appendChild(c("Dynamic Screen Space Error","dynamicScreenSpaceError"));const C=document.createElement("div");C.appendChild(l("Maximum Screen Space Error","maximumScreenSpaceError",0,128,1)),A.appendChild(C);const E=document.createElement("div");E.setAttribute("data-bind","visible: dynamicScreenSpaceError"),E.appendChild(l("Screen Space Error Density","dynamicScreenSpaceErrorDensitySliderValue",0,1,.005,"dynamicScreenSpaceErrorDensity")),E.appendChild(l("Screen Space Error Factor","dynamicScreenSpaceErrorFactor",1,32,.1)),A.appendChild(E),p.appendChild(c("Performance","performance")),p.appendChild(i),p.appendChild(c("Statistics","showStatistics"));const S=document.createElement("div");S.className="cesium-3dTilesInspector-statistics",S.setAttribute("data-bind","html: statisticsText, visible: showStatistics"),p.appendChild(S),p.appendChild(c("Pick Statistics","showPickStatistics"));const I=document.createElement("div");I.className="cesium-3dTilesInspector-statistics",I.setAttribute("data-bind","html: pickStatisticsText, visible: showPickStatistics"),p.appendChild(I),p.appendChild(c("Resource Cache Statistics","showResourceCacheStatistics"));const P=document.createElement("div");P.className="cesium-3dTilesInspector-statistics",P.setAttribute("data-bind","html: resourceCacheStatisticsText, visible: showResourceCacheStatistics"),p.appendChild(P);const D=document.createElement("div");m.appendChild(D),D.appendChild(document.createTextNode("Color Blend Mode: "));const O=document.createElement("select");O.setAttribute("data-bind",'options: colorBlendModes, optionsText: "text", optionsValue: "value", value: colorBlendMode'),D.appendChild(O);const R=document.createElement("textarea");R.setAttribute("data-bind","textInput: styleString, event: { keydown: styleEditorKeyPress }"),D.className="cesium-cesiumInspector-styleEditor",D.appendChild(R);const M=u("Compile (Ctrl+Enter)","compileStyle");D.appendChild(M);const L=document.createElement("div");L.className="cesium-cesiumInspector-error",L.setAttribute("data-bind","text: editorError"),D.appendChild(L),f.appendChild(c("Show Picked Only","showOnlyPickedTileDebugLabel")),f.appendChild(c("Geometric Error","showGeometricError")),f.appendChild(c("Rendering Statistics","showRenderingStatistics")),f.appendChild(c("Memory Usage (MB)","showMemoryUsage")),f.appendChild(c("Url","showUrl")),g.appendChild(c("Skip Tile LODs","skipLevelOfDetail"));const N=document.createElement("div");N.appendChild(l("Skip SSE Factor","skipScreenSpaceErrorFactor",1,50,1)),g.appendChild(N);const B=document.createElement("div");B.appendChild(l("SSE before skipping LOD","baseScreenSpaceError",0,4096,1)),g.appendChild(B);const F=document.createElement("div");F.appendChild(l("Min. levels to skip","skipLevels",0,10,1)),g.appendChild(F),g.appendChild(c("Load only tiles that meet the max SSE.","immediatelyLoadDesiredLevelOfDetail")),g.appendChild(c("Load siblings of visible tiles","loadSiblings")),Aee.A.applyBindings(o,n)}Object.defineProperties(jee.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),jee.prototype.isDestroyed=function(){return!1},jee.prototype.destroy=function(){return Aee.A.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),(0,hee.A)(this)};const Qee=jee;var Xee=n(877987),Kee=n(377909),$ee=n(413369),Jee=n(841133),Zee=n(306923),ete=n(43940),tte=n(493815),nte=n(48024),ite=n(931324),ote=n(947899),rte=n(87313),ste=n(304729);function ate(e){e=e??Cee.A.EMPTY_OBJECT,this.length=e.length??1e7,this._length=void 0,this.width=e.width??2,this._width=void 0,this.show=e.show??!0,this.modelMatrix=ite.A.clone(e.modelMatrix??ite.A.IDENTITY),this._modelMatrix=new ite.A,this.id=e.id,this._id=void 0,this._primitive=void 0}ate.prototype.update=function(e){if(this.show){if(!(0,$9.A)(this._primitive)||!ite.A.equals(this._modelMatrix,this.modelMatrix)||this._length!==this.length||this._width!==this.width||this._id!==this.id){this._modelMatrix=ite.A.clone(this.modelMatrix,this._modelMatrix),this._length=this.length,this._width=this.width,this._id=this.id,(0,$9.A)(this._primitive)&&this._primitive.destroy(),0===this.modelMatrix[12]&&0===this.modelMatrix[13]&&0===this.modelMatrix[14]&&(this.modelMatrix[14]=.01);const e=new nte.A({geometry:new ote.A({positions:[ete.A.ZERO,ete.A.UNIT_X],width:this.width,vertexFormat:rte.A.VERTEX_FORMAT,colors:[yee.A.RED,yee.A.RED],arcType:tte.A.NONE}),modelMatrix:ite.A.multiplyByUniformScale(this.modelMatrix,this.length,new ite.A),id:this.id,pickPrimitive:this}),t=new nte.A({geometry:new ote.A({positions:[ete.A.ZERO,ete.A.UNIT_Y],width:this.width,vertexFormat:rte.A.VERTEX_FORMAT,colors:[yee.A.GREEN,yee.A.GREEN],arcType:tte.A.NONE}),modelMatrix:ite.A.multiplyByUniformScale(this.modelMatrix,this.length,new ite.A),id:this.id,pickPrimitive:this}),n=new nte.A({geometry:new ote.A({positions:[ete.A.ZERO,ete.A.UNIT_Z],width:this.width,vertexFormat:rte.A.VERTEX_FORMAT,colors:[yee.A.BLUE,yee.A.BLUE],arcType:tte.A.NONE}),modelMatrix:ite.A.multiplyByUniformScale(this.modelMatrix,this.length,new ite.A),id:this.id,pickPrimitive:this});this._primitive=new ste.A({geometryInstances:[e,t,n],appearance:new rte.A,asynchronous:!1})}this._primitive.update(e)}},ate.prototype.isDestroyed=function(){return!1},ate.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),(0,hee.A)(this)};const cte=ate;var lte=n(897471),ute=n(633076);function dte(e){e=e??Cee.A.EMPTY_OBJECT,this._tilingScheme=(0,$9.A)(e.tilingScheme)?e.tilingScheme:new ute.A({ellipsoid:e.ellipsoid}),this._color=e.color??yee.A.YELLOW,this._errorEvent=new lte.A,this._tileWidth=e.tileWidth??256,this._tileHeight=e.tileHeight??256,this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0}Object.defineProperties(dte.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}}),dte.prototype.getTileCredits=function(e,t,n){},dte.prototype.requestImage=function(e,t,n,i){const o=document.createElement("canvas");o.width=256,o.height=256;const r=o.getContext("2d"),s=this._color.toCssColorString();return r.strokeStyle=s,r.lineWidth=2,r.strokeRect(1,1,255,255),r.font="bold 25px Arial",r.textAlign="center",r.fillStyle=s,r.fillText(`L: ${n}`,124,86),r.fillText(`X: ${e}`,124,136),r.fillText(`Y: ${t}`,124,186),Promise.resolve(o)},dte.prototype.pickFeatures=function(e,t,n,i,o){};const hte=dte;var Ate=n(868758);function pte(e,t,n){let i=Math.min(n,t);return i=Math.max(i,e),i}const fte=new Zee.A,mte=new ete.A;function gte(e,t){if(!(0,$9.A)(e))throw new Q9.A("scene is required");if(!(0,$9.A)(t))throw new Q9.A("performanceContainer is required");const n=this,i=e.canvas,o=new vee.A(i);this._eventHandler=o,this._scene=e,this._canvas=i,this._primitive=void 0,this._tile=void 0,this._modelMatrixPrimitive=void 0,this._performanceDisplay=void 0,this._performanceContainer=t;const r=this._scene.globe;let s;function a(e){const t=n._scene.pick({x:e.position.x,y:e.position.y});(0,$9.A)(t)&&(n.primitive=(0,$9.A)(t.collection)?t.collection:t.primitive),n._scene.requestRender(),n.pickPrimitiveActive=!1}function c(e){let t;const i=r.ellipsoid,o=n._scene.camera.getPickRay(e.position,fte),s=r.pick(o,n._scene,mte);if((0,$9.A)(s)){const e=i.cartesianToCartographic(s),n=r._surface.tileProvider._tilesToRenderByTextureCount;for(let i=0;!t&&i<n.length;++i){const o=n[i];if((0,$9.A)(o))for(let n=0;!t&&n<o.length;++n){const i=o[n];Ate.A.contains(i.rectangle,e)&&(t=i)}}}n.tile=t,n.pickTileActive=!1}r.depthTestAgainstTerrain=!0,this.frustums=!1,this.frustumPlanes=!1,this.performance=!1,this.shaderCacheText="",this.primitiveBoundingSphere=!1,this.primitiveReferenceFrame=!1,this.filterPrimitive=!1,this.tileBoundingSphere=!1,this.filterTile=!1,this.wireframe=!1,this.depthFrustum=1,this._numberOfFrustums=1,this.suspendUpdates=!1,this.tileCoordinates=!1,this.frustumStatisticText=!1,this.tileText="",this.hasPickedPrimitive=!1,this.hasPickedTile=!1,this.pickPrimitiveActive=!1,this.pickTileActive=!1,this.dropDownVisible=!0,this.generalVisible=!0,this.primitivesVisible=!1,this.terrainVisible=!1,this.depthFrustumText="",Aee.A.track(this,["frustums","frustumPlanes","performance","shaderCacheText","primitiveBoundingSphere","primitiveReferenceFrame","filterPrimitive","tileBoundingSphere","filterTile","wireframe","depthFrustum","suspendUpdates","tileCoordinates","frustumStatisticText","tileText","hasPickedPrimitive","hasPickedTile","pickPrimitiveActive","pickTileActive","dropDownVisible","generalVisible","primitivesVisible","terrainVisible","depthFrustumText"]),this._toggleDropDown=(0,nee.A)(function(){n.dropDownVisible=!n.dropDownVisible}),this._toggleGeneral=(0,nee.A)(function(){n.generalVisible=!n.generalVisible}),this._togglePrimitives=(0,nee.A)(function(){n.primitivesVisible=!n.primitivesVisible}),this._toggleTerrain=(0,nee.A)(function(){n.terrainVisible=!n.terrainVisible}),this._frustumsSubscription=Aee.A.getObservable(this,"frustums").subscribe(function(e){n._scene.debugShowFrustums=e,n._scene.requestRender()}),this._frustumPlanesSubscription=Aee.A.getObservable(this,"frustumPlanes").subscribe(function(e){n._scene.debugShowFrustumPlanes=e,n._scene.requestRender()}),this._performanceSubscription=Aee.A.getObservable(this,"performance").subscribe(function(e){e?n._performanceDisplay=new Tee.A({container:n._performanceContainer}):n._performanceContainer.innerHTML=""}),this._showPrimitiveBoundingSphere=(0,nee.A)(function(){return n._primitive.debugShowBoundingVolume=n.primitiveBoundingSphere,n._scene.requestRender(),!0}),this._primitiveBoundingSphereSubscription=Aee.A.getObservable(this,"primitiveBoundingSphere").subscribe(function(){n._showPrimitiveBoundingSphere()}),this._showPrimitiveReferenceFrame=(0,nee.A)(function(){if(n.primitiveReferenceFrame){const e=n._primitive.modelMatrix;n._modelMatrixPrimitive=new cte({modelMatrix:e}),n._scene.primitives.add(n._modelMatrixPrimitive)}else(0,$9.A)(n._modelMatrixPrimitive)&&(n._scene.primitives.remove(n._modelMatrixPrimitive),n._modelMatrixPrimitive=void 0);return n._scene.requestRender(),!0}),this._primitiveReferenceFrameSubscription=Aee.A.getObservable(this,"primitiveReferenceFrame").subscribe(function(){n._showPrimitiveReferenceFrame()}),this._doFilterPrimitive=(0,nee.A)(function(){return n.filterPrimitive?n._scene.debugCommandFilter=function(e){return!(!(0,$9.A)(n._modelMatrixPrimitive)||e.owner!==n._modelMatrixPrimitive._primitive)||!!(0,$9.A)(n._primitive)&&(e.owner===n._primitive||e.owner===n._primitive._billboardCollection||e.owner.primitive===n._primitive)}:n._scene.debugCommandFilter=void 0,!0}),this._filterPrimitiveSubscription=Aee.A.getObservable(this,"filterPrimitive").subscribe(function(){n._doFilterPrimitive(),n._scene.requestRender()}),this._wireframeSubscription=Aee.A.getObservable(this,"wireframe").subscribe(function(e){r._surface.tileProvider._debug.wireframe=e,n._scene.requestRender()}),this._depthFrustumSubscription=Aee.A.getObservable(this,"depthFrustum").subscribe(function(e){n._scene.debugShowDepthFrustum=e,n._scene.requestRender()}),this._incrementDepthFrustum=(0,nee.A)(function(){const e=n.depthFrustum+1;return n.depthFrustum=pte(1,n._numberOfFrustums,e),n._scene.requestRender(),!0}),this._decrementDepthFrustum=(0,nee.A)(function(){const e=n.depthFrustum-1;return n.depthFrustum=pte(1,n._numberOfFrustums,e),n._scene.requestRender(),!0}),this._suspendUpdatesSubscription=Aee.A.getObservable(this,"suspendUpdates").subscribe(function(e){r._surface._debug.suspendLodUpdate=e,e||(n.filterTile=!1)}),this._showTileCoordinates=(0,nee.A)(function(){return n.tileCoordinates&&!(0,$9.A)(s)?s=e.imageryLayers.addImageryProvider(new hte({tilingScheme:e.terrainProvider.tilingScheme})):!n.tileCoordinates&&(0,$9.A)(s)&&(e.imageryLayers.remove(s),s=void 0),!0}),this._tileCoordinatesSubscription=Aee.A.getObservable(this,"tileCoordinates").subscribe(function(){n._showTileCoordinates(),n._scene.requestRender()}),this._tileBoundingSphereSubscription=Aee.A.getObservable(this,"tileBoundingSphere").subscribe(function(){n._showTileBoundingSphere(),n._scene.requestRender()}),this._showTileBoundingSphere=(0,nee.A)(function(){return n.tileBoundingSphere?r._surface.tileProvider._debug.boundingSphereTile=n._tile:r._surface.tileProvider._debug.boundingSphereTile=void 0,n._scene.requestRender(),!0}),this._doFilterTile=(0,nee.A)(function(){return n.filterTile?(n.suspendUpdates=!0,r._surface._tilesToRender=[],(0,$9.A)(n._tile)&&n._tile.renderable&&r._surface._tilesToRender.push(n._tile)):n.suspendUpdates=!1,!0}),this._filterTileSubscription=Aee.A.getObservable(this,"filterTile").subscribe(function(){n.doFilterTile(),n._scene.requestRender()}),this._pickPrimitive=(0,nee.A)(function(){n.pickPrimitiveActive=!n.pickPrimitiveActive}),this._pickPrimitiveActiveSubscription=Aee.A.getObservable(this,"pickPrimitiveActive").subscribe(function(e){e?o.setInputAction(a,fee.A.LEFT_CLICK):o.removeInputAction(fee.A.LEFT_CLICK)}),this._pickTile=(0,nee.A)(function(){n.pickTileActive=!n.pickTileActive}),this._pickTileActiveSubscription=Aee.A.getObservable(this,"pickTileActive").subscribe(function(e){e?o.setInputAction(c,fee.A.LEFT_CLICK):o.removeInputAction(fee.A.LEFT_CLICK)}),this._removePostRenderEvent=e.postRender.addEventListener(function(){n._update()})}Object.defineProperties(gte.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},toggleDropDown:{get:function(){return this._toggleDropDown}},showPrimitiveBoundingSphere:{get:function(){return this._showPrimitiveBoundingSphere}},showPrimitiveReferenceFrame:{get:function(){return this._showPrimitiveReferenceFrame}},doFilterPrimitive:{get:function(){return this._doFilterPrimitive}},incrementDepthFrustum:{get:function(){return this._incrementDepthFrustum}},decrementDepthFrustum:{get:function(){return this._decrementDepthFrustum}},showTileCoordinates:{get:function(){return this._showTileCoordinates}},showTileBoundingSphere:{get:function(){return this._showTileBoundingSphere}},doFilterTile:{get:function(){return this._doFilterTile}},toggleGeneral:{get:function(){return this._toggleGeneral}},togglePrimitives:{get:function(){return this._togglePrimitives}},toggleTerrain:{get:function(){return this._toggleTerrain}},pickPrimitive:{get:function(){return this._pickPrimitive}},pickTile:{get:function(){return this._pickTile}},selectParent:{get:function(){const e=this;return(0,nee.A)(function(){e.tile=e.tile.parent})}},selectNW:{get:function(){const e=this;return(0,nee.A)(function(){e.tile=e.tile.northwestChild})}},selectNE:{get:function(){const e=this;return(0,nee.A)(function(){e.tile=e.tile.northeastChild})}},selectSW:{get:function(){const e=this;return(0,nee.A)(function(){e.tile=e.tile.southwestChild})}},selectSE:{get:function(){const e=this;return(0,nee.A)(function(){e.tile=e.tile.southeastChild})}},primitive:{get:function(){return this._primitive},set:function(e){const t=this._primitive;e!==t&&(this.hasPickedPrimitive=!0,(0,$9.A)(t)&&(t.debugShowBoundingVolume=!1),this._scene.debugCommandFilter=void 0,(0,$9.A)(this._modelMatrixPrimitive)&&(this._scene.primitives.remove(this._modelMatrixPrimitive),this._modelMatrixPrimitive=void 0),this._primitive=e,e.show=!1,setTimeout(function(){e.show=!0},50),this.showPrimitiveBoundingSphere(),this.showPrimitiveReferenceFrame(),this.doFilterPrimitive())}},tile:{get:function(){return this._tile},set:function(e){if((0,$9.A)(e)){if(this.hasPickedTile=!0,e!==this._tile){this.tileText=`L: ${e.level} X: ${e.x} Y: ${e.y}`,this.tileText+=`<br>SW corner: ${e.rectangle.west}, ${e.rectangle.south}`,this.tileText+=`<br>NE corner: ${e.rectangle.east}, ${e.rectangle.north}`;const t=e.data;(0,$9.A)(t)&&(0,$9.A)(t.tileBoundingRegion)?this.tileText+=`<br>Min: ${t.tileBoundingRegion.minimumHeight} Max: ${t.tileBoundingRegion.maximumHeight}`:this.tileText+="<br>(Tile is not loaded)"}this._tile=e,this.showTileBoundingSphere(),this.doFilterTile()}else this.hasPickedTile=!1,this._tile=void 0}}}),gte.prototype._update=function(){this.frustums&&(this.frustumStatisticText=function(e){let t;if((0,$9.A)(e)){t="Command Statistics";const n=e.commandsInFrustums;for(const e in n)if(n.hasOwnProperty(e)){let i,o=parseInt(e,10);if(7===o)i="1, 2 and 3";else{const e=[];for(let t=2;t>=0;t--){const n=Math.pow(2,t);o>=n&&(e.push(t+1),o-=n)}i=e.reverse().join(" and ")}t+=`<br>&nbsp;&nbsp;&nbsp;&nbsp;${n[e]} in frustum ${i}`}t+=`<br>Total: ${e.totalCommands}`}return t}(this._scene.debugFrustumStatistics));const e=this._scene.numberOfFrustums;this._numberOfFrustums=e,this.depthFrustum=pte(1,e,this.depthFrustum),this.depthFrustumText=`${this.depthFrustum} of ${e}`,this.performance&&this._performanceDisplay.update(),this.primitiveReferenceFrame&&(this._modelMatrixPrimitive.modelMatrix=this._primitive.modelMatrix),this.shaderCacheText=`Cached shaders: ${this._scene.context.shaderCache.numberOfShaders}`},gte.prototype.isDestroyed=function(){return!1},gte.prototype.destroy=function(){return this._eventHandler.destroy(),this._removePostRenderEvent(),this._frustumsSubscription.dispose(),this._frustumPlanesSubscription.dispose(),this._performanceSubscription.dispose(),this._primitiveBoundingSphereSubscription.dispose(),this._primitiveReferenceFrameSubscription.dispose(),this._filterPrimitiveSubscription.dispose(),this._wireframeSubscription.dispose(),this._depthFrustumSubscription.dispose(),this._suspendUpdatesSubscription.dispose(),this._tileCoordinatesSubscription.dispose(),this._tileBoundingSphereSubscription.dispose(),this._filterTileSubscription.dispose(),this._pickPrimitiveActiveSubscription.dispose(),this._pickTileActiveSubscription.dispose(),(0,hee.A)(this)};const _te=gte;function yte(e,t){if(!(0,$9.A)(e))throw new Q9.A("container is required.");if(!(0,$9.A)(t))throw new Q9.A("scene is required.");e=(0,dee.A)(e);const n=document.createElement("div"),i=new _te(t,n);this._viewModel=i,this._container=e;const o=document.createElement("div");this._element=o;const r=document.createElement("div");r.textContent="Cesium Inspector",r.className="cesium-cesiumInspector-button",r.setAttribute("data-bind","click: toggleDropDown"),o.appendChild(r),o.className="cesium-cesiumInspector",o.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : dropDownVisible, "cesium-cesiumInspector-hidden" : !dropDownVisible }'),e.appendChild(this._element);const s=document.createElement("div");s.className="cesium-cesiumInspector-dropDown",o.appendChild(s);const a=Z9.createSection,c=Z9.createCheckbox,l=a(s,"General","generalVisible","toggleGeneral"),u=c("Show Frustums","frustums"),d=document.createElement("div");d.className="cesium-cesiumInspector-frustumStatistics",d.setAttribute("data-bind","visible: frustums, html: frustumStatisticText"),u.appendChild(d),l.appendChild(u),l.appendChild(c("Show Frustum Planes","frustumPlanes")),l.appendChild(c("Performance Display","performance")),n.className="cesium-cesiumInspector-performanceDisplay",l.appendChild(n);const h=document.createElement("div");h.className="cesium-cesiumInspector-shaderCache",h.setAttribute("data-bind","html: shaderCacheText"),l.appendChild(h);const A=document.createElement("div");l.appendChild(A);const p=document.createElement("span");p.setAttribute("data-bind",'html: "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Frustum:"'),A.appendChild(p);const f=document.createElement("span");f.setAttribute("data-bind","text: depthFrustumText"),A.appendChild(f);const m=document.createElement("input");m.type="button",m.value="-",m.className="cesium-cesiumInspector-pickButton",m.setAttribute("data-bind","click: decrementDepthFrustum"),A.appendChild(m);const g=document.createElement("input");g.type="button",g.value="+",g.className="cesium-cesiumInspector-pickButton",g.setAttribute("data-bind","click: incrementDepthFrustum"),A.appendChild(g);const _=a(s,"Primitives","primitivesVisible","togglePrimitives"),y=document.createElement("div");y.className="cesium-cesiumInspector-pickSection",_.appendChild(y);const v=document.createElement("input");v.type="button",v.value="Pick a primitive",v.className="cesium-cesiumInspector-pickButton",v.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickPrimitiveActive}, click: pickPrimitive');let T=document.createElement("div");T.className="cesium-cesiumInspector-center",T.appendChild(v),y.appendChild(T),y.appendChild(c("Show bounding sphere","primitiveBoundingSphere","hasPickedPrimitive")),y.appendChild(c("Show reference frame","primitiveReferenceFrame","hasPickedPrimitive")),this._primitiveOnly=c("Show only selected","filterPrimitive","hasPickedPrimitive"),y.appendChild(this._primitiveOnly);const b=a(s,"Terrain","terrainVisible","toggleTerrain"),w=document.createElement("div");w.className="cesium-cesiumInspector-pickSection",b.appendChild(w);const x=document.createElement("input");x.type="button",x.value="Pick a tile",x.className="cesium-cesiumInspector-pickButton",x.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickTileActive}, click: pickTile'),T=document.createElement("div"),T.appendChild(x),T.className="cesium-cesiumInspector-center",w.appendChild(T);const C=document.createElement("div");w.appendChild(C);const E=document.createElement("input");E.type="button",E.value="Parent",E.className="cesium-cesiumInspector-pickButton",E.setAttribute("data-bind","click: selectParent");const S=document.createElement("input");S.type="button",S.value="NW",S.className="cesium-cesiumInspector-pickButton",S.setAttribute("data-bind","click: selectNW");const I=document.createElement("input");I.type="button",I.value="NE",I.className="cesium-cesiumInspector-pickButton",I.setAttribute("data-bind","click: selectNE");const P=document.createElement("input");P.type="button",P.value="SW",P.className="cesium-cesiumInspector-pickButton",P.setAttribute("data-bind","click: selectSW");const D=document.createElement("input");D.type="button",D.value="SE",D.className="cesium-cesiumInspector-pickButton",D.setAttribute("data-bind","click: selectSE");const O=document.createElement("div");O.className="cesium-cesiumInspector-tileText",C.className="cesium-cesiumInspector-frustumStatistics",C.appendChild(O),C.setAttribute("data-bind","visible: hasPickedTile"),O.setAttribute("data-bind","html: tileText");const R=document.createElement("div");R.className="cesium-cesiumInspector-relativeText",R.textContent="Select relative:",C.appendChild(R);const M=document.createElement("table"),L=document.createElement("tr"),N=document.createElement("tr"),B=document.createElement("td");B.appendChild(E);const F=document.createElement("td");F.appendChild(S);const U=document.createElement("td");U.appendChild(I),L.appendChild(B),L.appendChild(F),L.appendChild(U);const k=document.createElement("td"),V=document.createElement("td");V.appendChild(P);const z=document.createElement("td");z.appendChild(D),N.appendChild(k),N.appendChild(V),N.appendChild(z),M.appendChild(L),M.appendChild(N),C.appendChild(M),w.appendChild(c("Show bounding volume","tileBoundingSphere","hasPickedTile")),w.appendChild(c("Show only selected","filterTile","hasPickedTile")),b.appendChild(c("Wireframe","wireframe")),b.appendChild(c("Suspend LOD update","suspendUpdates")),b.appendChild(c("Show tile coordinates","tileCoordinates")),Aee.A.applyBindings(i,this._element)}Object.defineProperties(yte.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),yte.prototype.isDestroyed=function(){return!1},yte.prototype.destroy=function(){return Aee.A.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),(0,hee.A)(this)};const vte=yte;var Tte=n(217263),bte=n(863529);function wte(e,t){t.currentTarget.parentElement.parentElement.querySelector(`#${e.name}-expander`).classList.toggle("active"),t.currentTarget.textContent="+"===t.currentTarget.textContent?"-":"+"}function xte(e,t){Aee.A.track(e);for(let n=0;n<e.sublayers.length;n++)xte(e.sublayers[n],t)}function Cte(e){return"FullModel"===e.modelName}function Ete(e){return"Overview"===e.modelName}function Ste(e){return Ete(e)||Cte(e)}function Ite(e,t){if(Ste(e)){e.visibility=!1;for(let t=0;t<e.sublayers.length;t++)e.sublayers[t].visibility=!0;const n={name:e.name,modelName:e.modelName,disable:Aee.A.observable(!1),index:t.sublayers.length};return t.topLayers.push(n),t.sublayers.push(e),n}}const Pte=function(e){const t=this;this.levels=[],this.viewModel={sublayers:[],levels:this.levels,currentLevel:Aee.A.observable(),selectedLevel:"All",topLayers:[{name:"Select a layer to explore...",disable:Aee.A.observable(!0),index:-1}],currentLayer:Aee.A.observable(),expandClickHandler:wte,setOptionDisable:function(e,t){Aee.A.applyBindingsToNode(e,{disable:t.disable},t)},defaultLayer:void 0},this.viewModel.currentLayer.subscribe(function(e){!function(e,t){if(Ste(e)){t.sublayers.forEach(e=>e.visibility=!1),t.sublayers[e.index].visibility=!0;const n=document.getElementById("bsl-wrapper");Cte(e)?(t.currentLevel=t.selectedLevel,n.style.display="block"):(t.selectedLevel=t.currentLevel,t.currentLevel="All",n.style.display="none")}}(e,t.viewModel)});const n=e.sublayers;for(let e=0;e<n.length;e++){xte(n[e],this.viewModel);const t=Ite(n[e],this.viewModel);(0,$9.A)(t)&&(Ete(t)||!(0,$9.A)(this.viewModel.defaultLayer)&&Cte(t))&&(this.viewModel.defaultLayer=t)}if(1===this.viewModel.topLayers.length&&n.length>0){e.show=!1;const t={name:"Full Model",modelName:"FullModel",visibility:e.show,sublayers:e.sublayers};this.viewModel.defaultLayer=Ite(t,this.viewModel),this.viewModel.currentLayer.subscribe(function(t){e.show=Cte(t)})}else 1===this.viewModel.topLayers.length&&(this.viewModel.topLayers[0].name="Building layers not found");return async function(e,t){try{const n=e.getAttributeNames();for(let i=0;i<n.length;i++)if("BldgLevel"===n[i]){const o=e.getAttributeValues(n[i]);for(let e=0;e<o.length;e++)t.push(o[e])}t.sort((e,t)=>e-t),t.unshift("All")}catch(e){console.log(`There was an error getting attributes: ${e}`)}}(e,this.levels),this.viewModel.currentLevel.subscribe(function(t){"All"!==t?e.filterByAttributes([{name:"BldgLevel",values:[t]}]):e.filterByAttributes()}),this.viewModel},Dte=function(e,t){const n=document.getElementById(e);K9.A.defined("container",n),K9.A.defined("i3sProvider",t);const i=document.createElement("div");i.classList.add("cesium-viewer-i3s-explorer"),i.innerHTML='\n        <h3>Building explorer</h3>\n        <select\n          data-bind="options: topLayers, optionsText: \'name\', optionsAfterRender: setOptionDisable, value: currentLayer"\n        ></select>\n        <div id="bsl-wrapper">\n          <h3>Select Level</h3>\n          <select data-bind="options: levels, value: currentLevel"></select>\n          <h3>Disciplines & Categories</h3>\n          <ul class="layersList" data-bind="foreach: sublayers">\n            <ul class="layersList" data-bind="foreach: sublayers.sort(function (l, r) { return l.name.localeCompare(r.name) })">\n              <li>\n                <div class="li-wrapper">\n                  <span\n                    class="expandItem"\n                    data-bind="click: $root.expandClickHandler"\n                    >+</span\n                  >\n                  <input\n                    type="checkbox"\n                    data-bind="checked: visibility, valueUpdate: \'input\', attr: { id: name}"\n                  />\n                  <label data-bind="attr: { for: name}">\n                    <span data-bind="text: name"></span>\n                  </label>\n                </div>\n                <ul class="nested" data-bind="attr: { id: name + \'-expander\'}">\n                  <li data-bind="foreach: sublayers.sort(function (l, r) { return l.name.localeCompare(r.name) })">\n                    <div class="li-wrapper">\n                      <input\n                        type="checkbox"\n                        data-bind="checked: visibility, valueUpdate: \'input\', attr: { id: name}"\n                      />\n                      <label data-bind="attr: { for: name}">\n                        <span data-bind="text: name"></span>\n                      </label>\n                    </div>\n                  </li>\n                </ul>\n              </li>\n            </ul>\n          </ul>\n        </div>',n.appendChild(i);const o=new Pte(t);Aee.A.track(o),Aee.A.applyBindings(o,n),(0,$9.A)(o.defaultLayer)&&(o.currentLayer=o.defaultLayer)};var Ote=n(221899),Rte=n(720749),Mte=n(506527),Lte=n(504377),Nte=n(72211),Bte=n(522437),Fte=n(806203),Ute=n(992993);function kte(e){if(!(0,$9.A)(e)||!(0,$9.A)(e.scene))throw new Q9.A("options.scene is required.");this._scene=e.scene,this.samplingWindow=e.samplingWindow??kte.defaultSettings.samplingWindow,this.quietPeriod=e.quietPeriod??kte.defaultSettings.quietPeriod,this.warmupPeriod=e.warmupPeriod??kte.defaultSettings.warmupPeriod,this.minimumFrameRateDuringWarmup=e.minimumFrameRateDuringWarmup??kte.defaultSettings.minimumFrameRateDuringWarmup,this.minimumFrameRateAfterWarmup=e.minimumFrameRateAfterWarmup??kte.defaultSettings.minimumFrameRateAfterWarmup,this._lowFrameRate=new lte.A,this._nominalFrameRate=new lte.A,this._frameTimes=[],this._needsQuietPeriod=!0,this._quietPeriodEndTime=0,this._warmupPeriodEndTime=0,this._frameRateIsLow=!1,this._lastFramesPerSecond=void 0,this._pauseCount=0;const t=this;this._preUpdateRemoveListener=this._scene.preUpdate.addEventListener(function(e,n){!function(e){if(e._pauseCount>0)return;const t=(0,Fte.A)();if(e._needsQuietPeriod)e._needsQuietPeriod=!1,e._frameTimes.length=0,e._quietPeriodEndTime=t+e.quietPeriod/Ute.A.SECONDS_PER_MILLISECOND,e._warmupPeriodEndTime=e._quietPeriodEndTime+(e.warmupPeriod+e.samplingWindow)/Ute.A.SECONDS_PER_MILLISECOND;else if(t>=e._quietPeriodEndTime){e._frameTimes.push(t);const n=t-e.samplingWindow/Ute.A.SECONDS_PER_MILLISECOND;if(e._frameTimes.length>=2&&e._frameTimes[0]<=n){for(;e._frameTimes.length>=2&&e._frameTimes[1]<n;)e._frameTimes.shift();const i=(t-e._frameTimes[0])/(e._frameTimes.length-1);e._lastFramesPerSecond=1e3/i,i>1e3/(t>e._warmupPeriodEndTime?e.minimumFrameRateAfterWarmup:e.minimumFrameRateDuringWarmup)?e._frameRateIsLow||(e._frameRateIsLow=!0,e._needsQuietPeriod=!0,e.lowFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond)):e._frameRateIsLow&&(e._frameRateIsLow=!1,e._needsQuietPeriod=!0,e.nominalFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond))}}}(t)}),this._hiddenPropertyName=void 0!==document.hidden?"hidden":void 0!==document.mozHidden?"mozHidden":void 0!==document.msHidden?"msHidden":void 0!==document.webkitHidden?"webkitHidden":void 0;const n=void 0!==document.hidden?"visibilitychange":void 0!==document.mozHidden?"mozvisibilitychange":void 0!==document.msHidden?"msvisibilitychange":void 0!==document.webkitHidden?"webkitvisibilitychange":void 0;function i(){var e;e=t,document[e._hiddenPropertyName]?e.pause():e.unpause()}this._visibilityChangeRemoveListener=void 0,(0,$9.A)(n)&&(document.addEventListener(n,i,!1),this._visibilityChangeRemoveListener=function(){document.removeEventListener(n,i,!1)})}kte.defaultSettings={samplingWindow:5,quietPeriod:2,warmupPeriod:5,minimumFrameRateDuringWarmup:4,minimumFrameRateAfterWarmup:8},kte.fromScene=function(e){if(!(0,$9.A)(e))throw new Q9.A("scene is required.");return(0,$9.A)(e._frameRateMonitor)&&!e._frameRateMonitor.isDestroyed()||(e._frameRateMonitor=new kte({scene:e})),e._frameRateMonitor},Object.defineProperties(kte.prototype,{scene:{get:function(){return this._scene}},lowFrameRate:{get:function(){return this._lowFrameRate}},nominalFrameRate:{get:function(){return this._nominalFrameRate}},lastFramesPerSecond:{get:function(){return this._lastFramesPerSecond}}}),kte.prototype.pause=function(){++this._pauseCount,1===this._pauseCount&&(this._frameTimes.length=0,this._lastFramesPerSecond=void 0)},kte.prototype.unpause=function(){--this._pauseCount,this._pauseCount<=0&&(this._pauseCount=0,this._needsQuietPeriod=!0)},kte.prototype.isDestroyed=function(){return!1},kte.prototype.destroy=function(){return this._preUpdateRemoveListener(),(0,$9.A)(this._visibilityChangeRemoveListener)&&this._visibilityChangeRemoveListener(),(0,hee.A)(this)};const Vte=kte;function zte(e){if(!(0,$9.A)(e)||!(0,$9.A)(e.scene))throw new Q9.A("options.scene is required.");this._scene=e.scene,this.lowFrameRateMessage=e.lowFrameRateMessage??"This application appears to be performing poorly on your system.  Please try using a different web browser or updating your video drivers.",this.lowFrameRateMessageDismissed=!1,this.showingLowFrameRateMessage=!1,Aee.A.track(this,["lowFrameRateMessage","lowFrameRateMessageDismissed","showingLowFrameRateMessage"]);const t=this;this._dismissMessage=(0,nee.A)(function(){t.showingLowFrameRateMessage=!1,t.lowFrameRateMessageDismissed=!0});const n=Vte.fromScene(e.scene);this._unsubscribeLowFrameRate=n.lowFrameRate.addEventListener(function(){t.lowFrameRateMessageDismissed||(t.showingLowFrameRateMessage=!0)}),this._unsubscribeNominalFrameRate=n.nominalFrameRate.addEventListener(function(){t.showingLowFrameRateMessage=!1})}Object.defineProperties(zte.prototype,{scene:{get:function(){return this._scene}},dismissMessage:{get:function(){return this._dismissMessage}}}),zte.prototype.destroy=function(){return this._unsubscribeLowFrameRate(),this._unsubscribeNominalFrameRate(),(0,hee.A)(this)};const Hte=zte;function Gte(e){if(!(0,$9.A)(e)||!(0,$9.A)(e.container))throw new Q9.A("options.container is required.");if(!(0,$9.A)(e.scene))throw new Q9.A("options.scene is required.");const t=(0,dee.A)(e.container),n=new Hte(e),i=document.createElement("div");i.className="cesium-performance-watchdog-message-area",i.setAttribute("data-bind","visible: showingLowFrameRateMessage");const o=document.createElement("button");o.setAttribute("type","button"),o.className="cesium-performance-watchdog-message-dismiss",o.innerHTML="&times;",o.setAttribute("data-bind","click: dismissMessage"),i.appendChild(o);const r=document.createElement("div");r.className="cesium-performance-watchdog-message",r.setAttribute("data-bind","html: lowFrameRateMessage"),i.appendChild(r),t.appendChild(i),Aee.A.applyBindings(n,i),this._container=t,this._viewModel=n,this._element=i}Object.defineProperties(Gte.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),Gte.prototype.isDestroyed=function(){return!1},Gte.prototype.destroy=function(){return this._viewModel.destroy(),Aee.A.cleanNode(this._element),this._container.removeChild(this._element),(0,hee.A)(this)};const Wte=Gte;var Yte=n(585820),qte=n(956009),jte=n(288823),Qte=n(828033),Xte=n(973292),Kte=n(595394),$te=n(544835),Jte=n(273578),Zte=n(249944),ene=n(674221),tne=n(316375),nne=n(369281),ine=n(213213),one=n(208772),rne=n(421801),sne=n(267295);function ane(e){const t=e.split("\n");let n;for(n=0;n<t.length&&!t[n].match(/\S/);n++);if(n===t.length)return"";let i="";const o=/^\s*/,r=t[n].match(o)[0].length;for(let e=n;e<t.length;e++){let n=t[e];n.match(o)[0].length>=r&&(n=n.slice(r)),i+=`${n}\n`}return i}function cne(e){K9.A.typeOf.object("scene",e),this._scene=e,this._voxelPrimitive=void 0,this._customShaderCompilationRemoveCallback=void 0,this._definedProperties=[],this._getPrimitiveFunctions=[],this._modelMatrixReady=!1;const t=this;function n(n){const{name:i,initialValue:o}=n;t._definedProperties.push(i);let r=n.setPrimitiveFunction;!0===r&&(r=function(e){t._voxelPrimitive[i]=e});let s=n.getPrimitiveFunction;!0===s&&(s=function(){t[i]=t._voxelPrimitive[i]}),(0,$9.A)(s)&&t._getPrimitiveFunctions.push(s);const a=Aee.A.observable();return Aee.A.defineProperty(t,i,{get:function(){return a()},set:function(n){"number"==typeof o&&"string"==typeof n&&(n=Number(n),isNaN(n)&&(n=o)),"boolean"==typeof o&&"number"==typeof n&&(n=1===n),a(n),(0,$9.A)(r)&&(0,$9.A)(t._voxelPrimitive)&&(r(n),e.requestRender())}}),t[i]=o,a}function i(e,n){return function(i){const o=t._voxelPrimitive[e].clone();o[n]=i,t._voxelPrimitive[e]=o}}n({name:"inspectorVisible",initialValue:!0}),n({name:"displayVisible",initialValue:!1}),n({name:"transformVisible",initialValue:!1}),n({name:"boundsVisible",initialValue:!1}),n({name:"clippingVisible",initialValue:!1}),n({name:"shaderVisible",initialValue:!1}),n({name:"shaderString",initialValue:"",getPrimitiveFunction:function(){const e=t._voxelPrimitive.customShader.fragmentShaderText;t.shaderString=ane(e)}}),n({name:"shaderCompilationMessage",initialValue:""}),n({name:"shaderCompilationSuccess",initialValue:!0}),n({name:"depthTest",initialValue:!1,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"show",initialValue:!0,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"disableUpdate",initialValue:!1,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"debugDraw",initialValue:!1,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"jitter",initialValue:!0,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"nearestSampling",initialValue:!0,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"screenSpaceError",initialValue:4,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"stepSize",initialValue:1,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),n({name:"shapeIsBox",getPrimitiveFunction:function(){const e=t._voxelPrimitive.shape;t.shapeIsBox=e===ine.A.BOX}}),n({name:"shapeIsEllipsoid",getPrimitiveFunction:function(){const e=t._voxelPrimitive.shape;t.shapeIsEllipsoid=e===ine.A.ELLIPSOID}}),n({name:"shapeIsCylinder",getPrimitiveFunction:function(){const e=t._voxelPrimitive.shape;t.shapeIsCylinder=e===ine.A.CYLINDER}}),n({name:"clippingBoxMaxXMin",initialValue:0,getPrimitiveFunction:function(){t.clippingBoxMaxXMin=t._voxelPrimitive.minBounds.x}}),n({name:"clippingBoxMaxXMax",initialValue:1,getPrimitiveFunction:function(){t.clippingBoxMaxXMax=t._voxelPrimitive.maxBounds.x}}),n({name:"clippingBoxMaxX",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","x"),getPrimitiveFunction:function(){t.clippingBoxMaxX=t._voxelPrimitive.maxClippingBounds.x}}),n({name:"clippingBoxMinXMin",initialValue:0,getPrimitiveFunction:function(){t.clippingBoxMinXMin=t._voxelPrimitive.minBounds.x}}),n({name:"clippingBoxMinXMax",initialValue:1,getPrimitiveFunction:function(){t.clippingBoxMinXMax=t._voxelPrimitive.maxBounds.x}}),n({name:"clippingBoxMinX",initialValue:0,setPrimitiveFunction:i("minClippingBounds","x"),getPrimitiveFunction:function(){t.clippingBoxMinX=t._voxelPrimitive.minClippingBounds.x}}),n({name:"clippingBoxMaxYMin",initialValue:0,getPrimitiveFunction:function(){t.clippingBoxMaxYMin=t._voxelPrimitive.minBounds.y}}),n({name:"clippingBoxMaxYMax",initialValue:1,getPrimitiveFunction:function(){t.clippingBoxMaxYMax=t._voxelPrimitive.maxBounds.y}}),n({name:"clippingBoxMaxY",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","y"),getPrimitiveFunction:function(){t.clippingBoxMaxY=t._voxelPrimitive.maxClippingBounds.y}}),n({name:"clippingBoxMinYMin",initialValue:0,getPrimitiveFunction:function(){t.clippingBoxMinYMin=t._voxelPrimitive.minBounds.y}}),n({name:"clippingBoxMinYMax",initialValue:1,getPrimitiveFunction:function(){t.clippingBoxMinYMax=t._voxelPrimitive.maxBounds.y}}),n({name:"clippingBoxMinY",initialValue:0,setPrimitiveFunction:i("minClippingBounds","y"),getPrimitiveFunction:function(){t.clippingBoxMinY=t._voxelPrimitive.minClippingBounds.y}}),n({name:"clippingBoxMaxZMin",initialValue:0,getPrimitiveFunction:function(){t.clippingBoxMaxZMin=t._voxelPrimitive.minBounds.z}}),n({name:"clippingBoxMaxZMax",initialValue:1,getPrimitiveFunction:function(){t.clippingBoxMaxZMax=t._voxelPrimitive.maxBounds.z}}),n({name:"clippingBoxMaxZ",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","z"),getPrimitiveFunction:function(){t.clippingBoxMaxZ=t._voxelPrimitive.maxClippingBounds.z}}),n({name:"clippingBoxMinZMin",initialValue:0,getPrimitiveFunction:function(){t.clippingBoxMinZMin=t._voxelPrimitive.minBounds.z}}),n({name:"clippingBoxMinZMax",initialValue:1,getPrimitiveFunction:function(){t.clippingBoxMinZMax=t._voxelPrimitive.maxBounds.z}}),n({name:"clippingBoxMinZ",initialValue:0,setPrimitiveFunction:i("minClippingBounds","z"),getPrimitiveFunction:function(){t.clippingBoxMinZ=t._voxelPrimitive.minClippingBounds.z}}),n({name:"clippingEllipsoidMaxLongitudeMin",initialValue:-nne.A.PI,getPrimitiveFunction:function(){t.clippingEllipsoidMaxLongitudeMin=t._voxelPrimitive.minBounds.x}}),n({name:"clippingEllipsoidMaxLongitudeMax",initialValue:nne.A.PI,getPrimitiveFunction:function(){t.clippingEllipsoidMaxLongitudeMax=t._voxelPrimitive.maxBounds.x}}),n({name:"clippingEllipsoidMaxLongitude",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","x"),getPrimitiveFunction:function(){t.clippingEllipsoidMaxLongitude=t._voxelPrimitive.maxClippingBounds.x}}),n({name:"clippingEllipsoidMinLongitudeMin",initialValue:-nne.A.PI,getPrimitiveFunction:function(){t.clippingEllipsoidMinLongitudeMin=t._voxelPrimitive.minBounds.x}}),n({name:"clippingEllipsoidMinLongitudeMax",initialValue:nne.A.PI,getPrimitiveFunction:function(){t.clippingEllipsoidMinLongitudeMax=t._voxelPrimitive.maxBounds.x}}),n({name:"clippingEllipsoidMinLongitude",initialValue:0,setPrimitiveFunction:i("minClippingBounds","x"),getPrimitiveFunction:function(){t.clippingEllipsoidMinLongitude=t._voxelPrimitive.minClippingBounds.x}}),n({name:"clippingEllipsoidMaxLatitudeMin",initialValue:-nne.A.PI_OVER_TWO,getPrimitiveFunction:function(){t.clippingEllipsoidMaxLatitudeMin=t._voxelPrimitive.minBounds.y}}),n({name:"clippingEllipsoidMaxLatitudeMax",initialValue:nne.A.PI_OVER_TWO,getPrimitiveFunction:function(){t.clippingEllipsoidMaxLatitudeMax=t._voxelPrimitive.maxBounds.y}}),n({name:"clippingEllipsoidMaxLatitude",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","y"),getPrimitiveFunction:function(){t.clippingEllipsoidMaxLatitude=t._voxelPrimitive.maxClippingBounds.y}}),n({name:"clippingEllipsoidMinLatitudeMin",initialValue:-nne.A.PI_OVER_TWO,getPrimitiveFunction:function(){t.clippingEllipsoidMinLatitudeMin=t._voxelPrimitive.minBounds.y}}),n({name:"clippingEllipsoidMinLatitudeMax",initialValue:nne.A.PI_OVER_TWO,getPrimitiveFunction:function(){t.clippingEllipsoidMinLatitudeMax=t._voxelPrimitive.maxBounds.y}}),n({name:"clippingEllipsoidMinLatitude",initialValue:0,setPrimitiveFunction:i("minClippingBounds","y"),getPrimitiveFunction:function(){t.clippingEllipsoidMinLatitude=t._voxelPrimitive.minClippingBounds.y}}),n({name:"clippingEllipsoidMaxHeightMin",initialValue:0,getPrimitiveFunction:function(){t.clippingEllipsoidMaxHeightMin=t._voxelPrimitive.minBounds.z}}),n({name:"clippingEllipsoidMaxHeightMax",initialValue:1e5,getPrimitiveFunction:function(){t.clippingEllipsoidMaxHeightMax=t._voxelPrimitive.maxBounds.z}}),n({name:"clippingEllipsoidMaxHeight",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","z"),getPrimitiveFunction:function(){t.clippingEllipsoidMaxHeight=t._voxelPrimitive.maxClippingBounds.z}}),n({name:"clippingEllipsoidMinHeightMin",initialValue:-1e5,getPrimitiveFunction:function(){t.clippingEllipsoidMinHeightMin=t._voxelPrimitive.minBounds.z}}),n({name:"clippingEllipsoidMinHeightMax",initialValue:0,getPrimitiveFunction:function(){t.clippingEllipsoidMinHeightMax=t._voxelPrimitive.maxBounds.z}}),n({name:"clippingEllipsoidMinHeight",initialValue:0,setPrimitiveFunction:i("minClippingBounds","z"),getPrimitiveFunction:function(){t.clippingEllipsoidMinHeight=t._voxelPrimitive.minClippingBounds.z}}),n({name:"clippingCylinderMaxRadiusMin",initialValue:0,getPrimitiveFunction:function(){t.clippingCylinderMaxRadiusMin=t._voxelPrimitive.minBounds.x}}),n({name:"clippingCylinderMaxRadiusMax",initialValue:1,getPrimitiveFunction:function(){t.clippingCylinderMaxRadiusMax=t._voxelPrimitive.maxBounds.x}}),n({name:"clippingCylinderMaxRadius",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","x"),getPrimitiveFunction:function(){t.clippingCylinderMaxRadius=t._voxelPrimitive.maxClippingBounds.x}}),n({name:"clippingCylinderMinRadiusMin",initialValue:0,getPrimitiveFunction:function(){t.clippingCylinderMinRadiusMin=t._voxelPrimitive.minBounds.x}}),n({name:"clippingCylinderMinRadiusMax",initialValue:1,getPrimitiveFunction:function(){t.clippingCylinderMinRadiusMax=t._voxelPrimitive.maxBounds.x}}),n({name:"clippingCylinderMinRadius",initialValue:0,setPrimitiveFunction:i("minClippingBounds","x"),getPrimitiveFunction:function(){t.clippingCylinderMinRadius=t._voxelPrimitive.minClippingBounds.x}}),n({name:"clippingCylinderMaxAngleMin",initialValue:-nne.A.PI,getPrimitiveFunction:function(){t.clippingCylinderMaxAngleMin=t._voxelPrimitive.minBounds.y}}),n({name:"clippingCylinderMaxAngleMax",initialValue:nne.A.PI,getPrimitiveFunction:function(){t.clippingCylinderMaxAngleMax=t._voxelPrimitive.maxBounds.y}}),n({name:"clippingCylinderMaxAngle",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","y"),getPrimitiveFunction:function(){t.clippingCylinderMaxAngle=t._voxelPrimitive.maxClippingBounds.y}}),n({name:"clippingCylinderMinAngleMin",initialValue:-nne.A.PI}),n({name:"clippingCylinderMinAngleMax",initialValue:nne.A.PI}),n({name:"clippingCylinderMinAngle",initialValue:0,setPrimitiveFunction:i("minClippingBounds","y"),getPrimitiveFunction:function(){t.clippingCylinderMinAngle=t._voxelPrimitive.minClippingBounds.y}}),n({name:"clippingCylinderMaxHeightMin",initialValue:-1,getPrimitiveFunction:function(){t.clippingCylinderMaxHeightMin=t._voxelPrimitive.minBounds.z}}),n({name:"clippingCylinderMaxHeightMax",initialValue:1,getPrimitiveFunction:function(){t.clippingCylinderMaxHeightMax=t._voxelPrimitive.maxBounds.z}}),n({name:"clippingCylinderMaxHeight",initialValue:0,setPrimitiveFunction:i("maxClippingBounds","z"),getPrimitiveFunction:function(){t.clippingCylinderMaxHeight=t._voxelPrimitive.maxClippingBounds.z}}),n({name:"clippingCylinderMinHeightMin",initialValue:-1,getPrimitiveFunction:function(){t.clippingCylinderMinHeightMin=t._voxelPrimitive.minBounds.z}}),n({name:"clippingCylinderMinHeightMax",initialValue:1,getPrimitiveFunction:function(){t.clippingCylinderMinHeightMax=t._voxelPrimitive.maxBounds.z}}),n({name:"clippingCylinderMinHeight",initialValue:0,setPrimitiveFunction:i("minClippingBounds","z"),getPrimitiveFunction:function(){t.clippingCylinderMinHeight=t._voxelPrimitive.minClippingBounds.z}}),n({name:"translationX",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&Ane(t)},getPrimitiveFunction:function(){t.translationX=ite.A.getTranslation(t._voxelPrimitive.modelMatrix,new ete.A).x}}),n({name:"translationY",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&Ane(t)},getPrimitiveFunction:function(){t.translationY=ite.A.getTranslation(t._voxelPrimitive.modelMatrix,new ete.A).y}}),n({name:"translationZ",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&Ane(t)},getPrimitiveFunction:function(){t.translationZ=ite.A.getTranslation(t._voxelPrimitive.modelMatrix,new ete.A).z}}),n({name:"scaleX",initialValue:1,setPrimitiveFunction:function(){t._modelMatrixReady&&Ane(t)},getPrimitiveFunction:function(){t.scaleX=ite.A.getScale(t._voxelPrimitive.modelMatrix,new ete.A).x}}),n({name:"scaleY",initialValue:1,setPrimitiveFunction:function(){t._modelMatrixReady&&Ane(t)},getPrimitiveFunction:function(){t.scaleY=ite.A.getScale(t._voxelPrimitive.modelMatrix,new ete.A).y}}),n({name:"scaleZ",initialValue:1,setPrimitiveFunction:function(){t._modelMatrixReady&&Ane(t)},getPrimitiveFunction:function(){t.scaleZ=ite.A.getScale(t._voxelPrimitive.modelMatrix,new ete.A).z}}),n({name:"angleX",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&Ane(t)}}),n({name:"angleY",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&Ane(t)}}),n({name:"angleZ",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&Ane(t)}})}const lne=new ete.A,une=new ete.A,dne=new one.A,hne=new rne.A;function Ane(e){const t=ete.A.fromElements(e.translationX,e.translationY,e.translationZ,lne),n=ete.A.fromElements(e.scaleX,e.scaleY,e.scaleZ,une),i=dne;i.heading=e.angleX,i.pitch=e.angleY,i.roll=e.angleZ;const o=rne.A.fromHeadingPitchRoll(i,hne),r=rne.A.multiplyByScale(o,n,o);e._voxelPrimitive.modelMatrix=ite.A.fromRotationTranslation(r,t,e._voxelPrimitive.modelMatrix)}Object.defineProperties(cne.prototype,{scene:{get:function(){return this._scene}},voxelPrimitive:{get:function(){return this._voxelPrimitive},set:function(e){if((0,$9.A)(this._customShaderCompilationRemoveCallback)&&this._customShaderCompilationRemoveCallback(),!(0,$9.A)(e))return;this._voxelPrimitive=e;const t=this;t._customShaderCompilationRemoveCallback=t._voxelPrimitive.customShaderCompilationEvent.addEventListener(function(e){const n=t._voxelPrimitive.customShader.fragmentShaderText;t.shaderString=ane(n),(0,$9.A)(e)?(t.shaderCompilationMessage=e.message,t.shaderCompilationSuccess=!1):(t.shaderCompilationMessage="Shader compiled successfully!",t.shaderCompilationSuccess=!0)}),t._modelMatrixReady=!1;for(let e=0;e<t._getPrimitiveFunctions.length;e++)t._getPrimitiveFunctions[e]();t._modelMatrixReady=!0,Ane(t)}}}),cne.prototype.toggleInspector=function(){this.inspectorVisible=!this.inspectorVisible},cne.prototype.toggleDisplay=function(){this.displayVisible=!this.displayVisible},cne.prototype.toggleTransform=function(){this.transformVisible=!this.transformVisible},cne.prototype.toggleBounds=function(){this.boundsVisible=!this.boundsVisible},cne.prototype.toggleClipping=function(){this.clippingVisible=!this.clippingVisible},cne.prototype.toggleShader=function(){this.shaderVisible=!this.shaderVisible},cne.prototype.compileShader=function(){(0,$9.A)(this._voxelPrimitive)&&(this._voxelPrimitive.customShader=new sne.A({fragmentShaderText:this.shaderString,uniforms:this._voxelPrimitive.customShader.uniforms}))},cne.prototype.shaderEditorKeyPress=function(e,t){if(9===t.keyCode){t.preventDefault();const e=t.target,n=e.selectionStart,i=e.selectionEnd;let o=i;const r=e.value.slice(n,i).split("\n"),s=r.length;let a;if(t.shiftKey)for(a=0;a<s;++a)" "===r[a][0]&&(" "===r[a][1]?(r[a]=r[a].substr(2),o-=2):(r[a]=r[a].substr(1),o-=1));else for(a=0;a<s;++a)r[a]=`  ${r[a]}`,o+=2;const c=r.join("\n");e.value=e.value.slice(0,n)+c+e.value.slice(i),e.selectionStart=n!==i?n:o,e.selectionEnd=o}else!t.ctrlKey||10!==t.keyCode&&13!==t.keyCode||this.compileShader();return!0},cne.prototype.isDestroyed=function(){return!1},cne.prototype.destroy=function(){const e=this;return this._definedProperties.forEach(function(t){Aee.A.getObservable(e,t).dispose()}),(0,hee.A)(this)};const pne=cne;function fne(e,t){K9.A.defined("container",e),K9.A.typeOf.object("scene",t),e=(0,dee.A)(e);const n=document.createElement("div"),i=new pne(t);this._viewModel=i,this._container=e,this._element=n;const o=document.createElement("div");o.textContent="Voxel Inspector",o.className="cesium-cesiumInspector-button",o.setAttribute("data-bind","click: toggleInspector"),n.appendChild(o),n.className="cesium-cesiumInspector cesium-VoxelInspector",n.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible}'),e.appendChild(n);const r=document.createElement("div");r.className="cesium-cesiumInspector-dropDown",n.appendChild(r);const{createSection:s,createCheckbox:a,createRangeInput:c,createButton:l}=Z9,u=s(r,"Display","displayVisible","toggleDisplay"),d=s(r,"Transform","transformVisible","toggleTransform"),h=s(r,"Clipping","clippingVisible","toggleClipping"),A=s(r,"Shader","shaderVisible","toggleShader");u.appendChild(a("Depth Test","depthTest")),u.appendChild(a("Show","show")),u.appendChild(a("Disable Update","disableUpdate")),u.appendChild(a("Debug Draw","debugDraw")),u.appendChild(a("Jitter","jitter")),u.appendChild(a("Nearest Sampling","nearestSampling")),u.appendChild(c("Screen Space Error","screenSpaceError",0,128)),u.appendChild(c("Step Size","stepSize",0,2));const p=nne.A.PI;d.appendChild(c("Translation X","translationX",-10,10)),d.appendChild(c("Translation Y","translationY",-10,10)),d.appendChild(c("Translation Z","translationZ",-10,10)),d.appendChild(c("Scale X","scaleX",0,10)),d.appendChild(c("Scale Y","scaleY",0,10)),d.appendChild(c("Scale Z","scaleZ",0,10)),d.appendChild(c("Heading","angleX",-p,+p)),d.appendChild(c("Pitch","angleY",-p,+p)),d.appendChild(c("Roll","angleZ",-p,+p)),mne("Max X","Min X","Max Y","Min Y","Max Z","Min Z","clippingBoxMaxX","clippingBoxMinX","clippingBoxMaxY","clippingBoxMinY","clippingBoxMaxZ","clippingBoxMinZ","shapeIsBox",h),mne("Max Longitude","Min Longitude","Max Latitude","Min Latitude","Max Height","Min Height","clippingEllipsoidMaxLongitude","clippingEllipsoidMinLongitude","clippingEllipsoidMaxLatitude","clippingEllipsoidMinLatitude","clippingEllipsoidMaxHeight","clippingEllipsoidMinHeight","shapeIsEllipsoid",h),mne("Max Radius","Min Radius","Max Angle","Min Angle","Max Height","Min Height","clippingCylinderMaxRadius","clippingCylinderMinRadius","clippingCylinderMaxAngle","clippingCylinderMinAngle","clippingCylinderMaxHeight","clippingCylinderMinHeight","shapeIsCylinder",h);const f=document.createElement("div");A.appendChild(f);const m=document.createElement("textarea");m.setAttribute("data-bind","textInput: shaderString, event: { keydown: shaderEditorKeyPress }"),f.className="cesium-cesiumInspector-styleEditor",f.appendChild(m);const g=l("Compile (Ctrl+Enter)","compileShader");f.appendChild(g);const _=document.createElement("label");_.style.display="block",_.setAttribute("data-bind","text: shaderCompilationMessage, style: {color: shaderCompilationSuccess ? 'green' : 'red'}"),f.appendChild(_),Aee.A.applyBindings(i,n)}function mne(e,t,n,i,o,r,s,a,c,l,u,d,h,A){const p=Z9.createRangeInputWithDynamicMinMax,f=A.appendChild(document.createElement("div"));f.setAttribute("data-bind",`if: ${h}`),f.appendChild(p(e,s)),f.appendChild(p(t,a)),f.appendChild(p(n,c)),f.appendChild(p(i,l)),f.appendChild(p(o,u)),f.appendChild(p(r,d))}Object.defineProperties(fne.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),fne.prototype.isDestroyed=function(){return!1},fne.prototype.destroy=function(){return Aee.A.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),(0,hee.A)(this)};const gne=fne;var _ne=n(129309);const yne=function(e){K9.A.typeOf.object("viewer",e);const t=document.createElement("div");t.className="cesium-viewer-cesium3DTilesInspectorContainer",e.container.appendChild(t);const n=new Qee(t,e.scene);Object.defineProperties(e,{cesium3DTilesInspector:{get:function(){return n}}})},vne=function(e){if(!(0,$9.A)(e))throw new Q9.A("viewer is required.");const t=document.createElement("div");t.className="cesium-viewer-cesiumInspectorContainer",e.container.appendChild(t);const n=new vte(t,e.scene);Object.defineProperties(e,{cesiumInspector:{get:function(){return n}}})};var Tne=n(284742),bne=n(609035),wne=n(620730),xne=n(27880),Cne=n(305643),Ene=n(229558),Sne=n(93494),Ine=n(833722),Pne=n(609307),Dne=n(534582),One=n(17317);const Rne=function(e){if(!(0,$9.A)(e))throw new Q9.A("uri is required.");const t=new ra(e);t.normalize();let n=t.path();const i=n.lastIndexOf("/");return-1!==i&&(n=n.substr(i+1)),n},Mne=nne.A.factorial;function Lne(e,t,n,i,o,r){let s,a,c,l=0;if(i>0){for(a=0;a<o;a++){for(s=!1,c=0;c<r.length&&!s;c++)a===r[c]&&(s=!0);s||(r.push(a),l+=Lne(e,t,n,i-1,o,r),r.splice(r.length-1,1))}return l}for(l=1,a=0;a<o;a++){for(s=!1,c=0;c<r.length&&!s;c++)a===r[c]&&(s=!0);s||(l*=e-n[t[a]])}return l}const Nne={type:"Hermite",getRequiredDataPoints:function(e,t){if(t=t??0,!(0,$9.A)(e))throw new Q9.A("degree is required.");if(e<0)throw new Q9.A("degree must be 0 or greater.");if(t<0)throw new Q9.A("inputOrder must be 0 or greater.");return Math.max(Math.floor((e+1)/(t+1)),2)},interpolateOrderZero:function(e,t,n,i,o){let r,s,a,c,l,u;(0,$9.A)(o)||(o=new Array(i));const d=t.length,h=new Array(i);for(r=0;r<i;r++){o[r]=0;const e=new Array(d);for(h[r]=e,s=0;s<d;s++)e[s]=[]}const A=d,p=new Array(A);for(r=0;r<A;r++)p[r]=r;let f=d-1;for(c=0;c<i;c++){for(s=0;s<A;s++)u=p[s]*i+c,h[c][0].push(n[u]);for(r=1;r<A;r++){let e=!1;for(s=0;s<A-r;s++){const o=t[p[s]],a=t[p[s+r]];let l;a-o<=0?(u=p[s]*i+i*r+c,l=n[u],h[c][r].push(l/Mne(r))):(l=h[c][r-1][s+1]-h[c][r-1][s],h[c][r].push(l/(a-o))),e=e||0!==l}e||(f=r-1)}}for(a=0,l=0;a<=0;a++)for(r=a;r<=f;r++){const n=Lne(e,p,t,a,r,[]);for(c=0;c<i;c++){const e=h[c][r][0];o[c+a*i]+=e*n}}return o}},Bne=[];Nne.interpolate=function(e,t,n,i,o,r,s){const a=i*(r+1);(0,$9.A)(s)||(s=new Array(a));for(let e=0;e<a;e++)s[e]=0;const c=t.length,l=new Array(c*(o+1));let u;for(u=0;u<c;u++)for(let e=0;e<o+1;e++)l[u*(o+1)+e]=u;const d=l.length,h=Bne,A=function(e,t,n,i,o,r){let s,a,c=-1;const l=t.length,u=l*(l+1)/2;for(let d=0;d<o;d++){const h=Math.floor(d*u);for(s=0;s<l;s++)a=t[s]*o*(r+1)+d,e[h+s]=i[a];for(let u=1;u<l;u++){let A=0;const p=Math.floor(u*(1-u)/2)+l*u;let f=!1;for(s=0;s<l-u;s++){const c=n[t[s]],m=n[t[s+u]];let g,_;if(m-c<=0)a=t[s]*o*(r+1)+o*u+d,g=i[a],_=g/nne.A.factorial(u),e[h+p+A]=_,A++;else{const t=Math.floor((u-1)*(2-u)/2)+l*(u-1);g=e[h+t+s+1]-e[h+t+s],_=g/(m-c),e[h+p+A]=_,A++}f=f||0!==g}f&&(c=Math.max(c,u))}}return c}(h,l,t,n,i,o),p=[],f=d*(d+1)/2,m=Math.min(A,r);for(let n=0;n<=m;n++)for(u=n;u<=A;u++){p.length=0;const o=Lne(e,l,t,n,u,p),r=Math.floor(u*(1-u)/2)+d*u;for(let e=0;e<i;e++){const t=h[Math.floor(e*f)+r];s[e+n*i]+=t*o}}return s};const Fne=Nne;var Une=n(366695),kne=n(656418);const Vne={type:"Lagrange",getRequiredDataPoints:function(e){return Math.max(e+1,2)},interpolateOrderZero:function(e,t,n,i,o){let r,s;(0,$9.A)(o)||(o=new Array(i));const a=t.length;for(r=0;r<i;r++)o[r]=0;for(r=0;r<a;r++){let c=1;for(s=0;s<a;s++)if(s!==r){const n=t[r]-t[s];c*=(e-t[s])/n}for(s=0;s<i;s++)o[s]+=c*n[r*i+s]}return o}};var zne=n(270747),Hne=n(682504),Gne=n(763482),Wne=n(291599),Yne=n(325129),qne=n(173925);function jne(e,t,n){this.clock=e??0,this.cone=t??0,this.magnitude=n??1}jne.fromCartesian3=function(e,t){K9.A.typeOf.object("cartesian3",e);const n=e.x,i=e.y,o=e.z,r=n*n+i*i;return(0,$9.A)(t)||(t=new jne),t.clock=Math.atan2(i,n),t.cone=Math.atan2(Math.sqrt(r),o),t.magnitude=Math.sqrt(r+o*o),t},jne.clone=function(e,t){if((0,$9.A)(e))return(0,$9.A)(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=e.magnitude,t):new jne(e.clock,e.cone,e.magnitude)},jne.normalize=function(e,t){return K9.A.typeOf.object("spherical",e),(0,$9.A)(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=1,t):new jne(e.clock,e.cone,1)},jne.equals=function(e,t){return e===t||(0,$9.A)(e)&&(0,$9.A)(t)&&e.clock===t.clock&&e.cone===t.cone&&e.magnitude===t.magnitude},jne.equalsEpsilon=function(e,t,n){return n=n??0,e===t||(0,$9.A)(e)&&(0,$9.A)(t)&&Math.abs(e.clock-t.clock)<=n&&Math.abs(e.cone-t.cone)<=n&&Math.abs(e.magnitude-t.magnitude)<=n},jne.prototype.equals=function(e){return jne.equals(this,e)},jne.prototype.clone=function(e){return jne.clone(this,e)},jne.prototype.equalsEpsilon=function(e,t){return jne.equalsEpsilon(this,e,t)},jne.prototype.toString=function(){return`(${this.clock}, ${this.cone}, ${this.magnitude})`};const Qne=jne;var Xne=n(702371),Kne=n(502295),$ne=n(198578),Jne=n(797587),Zne=n(34988),eie=n(49592),tie=n(548625),nie=n(289897),iie=n(396006),oie=n(754372),rie=n(276270),sie=n(76794),aie=n(411432),cie=n(590617);const lie=yee.A.WHITE,uie=yee.A.BLACK,die=new bne.A(2,2);function hie(e){e=e??Cee.A.EMPTY_OBJECT,this._definitionChanged=new lte.A,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.repeat=e.repeat}Object.defineProperties(hie.prototype,{isConstant:{get:function(){return cie.A.isConstant(this._evenColor)&&cie.A.isConstant(this._oddColor)&&cie.A.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},evenColor:(0,aie.A)("evenColor"),oddColor:(0,aie.A)("oddColor"),repeat:(0,aie.A)("repeat")}),hie.prototype.getType=function(e){return"Checkerboard"};const Aie=new kne.A;hie.prototype.getValue=function(e,t){return(0,$9.A)(e)||(e=kne.A.now(Aie)),(0,$9.A)(t)||(t={}),t.lightColor=cie.A.getValueOrClonedDefault(this._evenColor,e,lie,t.lightColor),t.darkColor=cie.A.getValueOrClonedDefault(this._oddColor,e,uie,t.darkColor),t.repeat=cie.A.getValueOrDefault(this._repeat,e,die),t},hie.prototype.equals=function(e){return this===e||e instanceof hie&&cie.A.equals(this._evenColor,e._evenColor)&&cie.A.equals(this._oddColor,e._oddColor)&&cie.A.equals(this._repeat,e._repeat)};const pie=hie;var fie=n(151709),mie=n(129380);function gie(){this._definitionChanged=new lte.A,this._composite=new mie.A,this._composite.definitionChanged.addEventListener(gie.prototype._raiseDefinitionChanged,this)}Object.defineProperties(gie.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite._intervals}}}),gie.prototype.getType=function(e){if(!(0,$9.A)(e))throw new Q9.A("time is required");const t=this._composite._intervals.findDataForIntervalContainingDate(e);if((0,$9.A)(t))return t.getType(e)};const _ie=new kne.A;gie.prototype.getValue=function(e,t){(0,$9.A)(e)||(e=kne.A.now(_ie));const n=this._composite._intervals.findDataForIntervalContainingDate(e);if((0,$9.A)(n))return n.getValue(e,t)},gie.prototype.equals=function(e){return this===e||e instanceof gie&&this._composite.equals(e._composite,cie.A.equals)},gie.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};const yie=gie;var vie=n(105039),Tie=n(379250),bie=n(851213),wie=n(70899),xie=n(80983),Cie=n(4709),Eie=n(458209),Sie=n(750952);function Iie(){this._definitionChanged=new lte.A,this._startTime=void 0,this._stopTime=void 0,this._currentTime=void 0,this._clockRange=void 0,this._clockStep=void 0,this._multiplier=void 0}Object.defineProperties(Iie.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},startTime:(0,Sie.A)("startTime"),stopTime:(0,Sie.A)("stopTime"),currentTime:(0,Sie.A)("currentTime"),clockRange:(0,Sie.A)("clockRange"),clockStep:(0,Sie.A)("clockStep"),multiplier:(0,Sie.A)("multiplier")}),Iie.prototype.clone=function(e){return(0,$9.A)(e)||(e=new Iie),e.startTime=this.startTime,e.stopTime=this.stopTime,e.currentTime=this.currentTime,e.clockRange=this.clockRange,e.clockStep=this.clockStep,e.multiplier=this.multiplier,e},Iie.prototype.equals=function(e){return this===e||(0,$9.A)(e)&&kne.A.equals(this.startTime,e.startTime)&&kne.A.equals(this.stopTime,e.stopTime)&&kne.A.equals(this.currentTime,e.currentTime)&&this.clockRange===e.clockRange&&this.clockStep===e.clockStep&&this.multiplier===e.multiplier},Iie.prototype.merge=function(e){if(!(0,$9.A)(e))throw new Q9.A("source is required.");this.startTime=this.startTime??e.startTime,this.stopTime=this.stopTime??e.stopTime,this.currentTime=this.currentTime??e.currentTime,this.clockRange=this.clockRange??e.clockRange,this.clockStep=this.clockStep??e.clockStep,this.multiplier=this.multiplier??e.multiplier},Iie.prototype.getValue=function(e){return(0,$9.A)(e)||(e=new Eie.A),e.startTime=this.startTime??e.startTime,e.stopTime=this.stopTime??e.stopTime,e.currentTime=this.currentTime??e.currentTime,e.clockRange=this.clockRange??e.clockRange,e.multiplier=this.multiplier??e.multiplier,e.clockStep=this.clockStep??e.clockStep,e};const Pie=Iie;var Die=n(93049),Oie=n(725106),Rie=n(147687),Mie=n(604955);const Lie=yee.A.WHITE,Nie=new bne.A(8,8),Bie=new bne.A(0,0),Fie=new bne.A(1,1);function Uie(e){e=e??Cee.A.EMPTY_OBJECT,this._definitionChanged=new lte.A,this._color=void 0,this._colorSubscription=void 0,this._cellAlpha=void 0,this._cellAlphaSubscription=void 0,this._lineCount=void 0,this._lineCountSubscription=void 0,this._lineThickness=void 0,this._lineThicknessSubscription=void 0,this._lineOffset=void 0,this._lineOffsetSubscription=void 0,this.color=e.color,this.cellAlpha=e.cellAlpha,this.lineCount=e.lineCount,this.lineThickness=e.lineThickness,this.lineOffset=e.lineOffset}Object.defineProperties(Uie.prototype,{isConstant:{get:function(){return cie.A.isConstant(this._color)&&cie.A.isConstant(this._cellAlpha)&&cie.A.isConstant(this._lineCount)&&cie.A.isConstant(this._lineThickness)&&cie.A.isConstant(this._lineOffset)}},definitionChanged:{get:function(){return this._definitionChanged}},color:(0,aie.A)("color"),cellAlpha:(0,aie.A)("cellAlpha"),lineCount:(0,aie.A)("lineCount"),lineThickness:(0,aie.A)("lineThickness"),lineOffset:(0,aie.A)("lineOffset")}),Uie.prototype.getType=function(e){return"Grid"};const kie=new kne.A;Uie.prototype.getValue=function(e,t){return(0,$9.A)(e)||(e=kne.A.now(kie)),(0,$9.A)(t)||(t={}),t.color=cie.A.getValueOrClonedDefault(this._color,e,Lie,t.color),t.cellAlpha=cie.A.getValueOrDefault(this._cellAlpha,e,.1),t.lineCount=cie.A.getValueOrClonedDefault(this._lineCount,e,Nie,t.lineCount),t.lineThickness=cie.A.getValueOrClonedDefault(this._lineThickness,e,Fie,t.lineThickness),t.lineOffset=cie.A.getValueOrClonedDefault(this._lineOffset,e,Bie,t.lineOffset),t},Uie.prototype.equals=function(e){return this===e||e instanceof Uie&&cie.A.equals(this._color,e._color)&&cie.A.equals(this._cellAlpha,e._cellAlpha)&&cie.A.equals(this._lineCount,e._lineCount)&&cie.A.equals(this._lineThickness,e._lineThickness)&&cie.A.equals(this._lineOffset,e._lineOffset)};const Vie=Uie;var zie=n(1647),Hie=n(114949),Gie=n(476906),Wie=n(990524),Yie=n(438222),qie=n(190309),jie=n(464301);function Qie(e){this._definitionChanged=new lte.A,this._color=void 0,this._colorSubscription=void 0,this.color=e}Object.defineProperties(Qie.prototype,{isConstant:{get:function(){return cie.A.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:(0,aie.A)("color")}),Qie.prototype.getType=function(e){return"PolylineArrow"};const Xie=new kne.A;Qie.prototype.getValue=function(e,t){return(0,$9.A)(e)||(e=kne.A.now(Xie)),(0,$9.A)(t)||(t={}),t.color=cie.A.getValueOrClonedDefault(this._color,e,yee.A.WHITE,t.color),t},Qie.prototype.equals=function(e){return this===e||e instanceof Qie&&cie.A.equals(this._color,e._color)};const Kie=Qie,$ie=yee.A.WHITE,Jie=yee.A.TRANSPARENT;function Zie(e){e=e??Cee.A.EMPTY_OBJECT,this._definitionChanged=new lte.A,this._color=void 0,this._colorSubscription=void 0,this._gapColor=void 0,this._gapColorSubscription=void 0,this._dashLength=void 0,this._dashLengthSubscription=void 0,this._dashPattern=void 0,this._dashPatternSubscription=void 0,this.color=e.color,this.gapColor=e.gapColor,this.dashLength=e.dashLength,this.dashPattern=e.dashPattern}Object.defineProperties(Zie.prototype,{isConstant:{get:function(){return cie.A.isConstant(this._color)&&cie.A.isConstant(this._gapColor)&&cie.A.isConstant(this._dashLength)&&cie.A.isConstant(this._dashPattern)}},definitionChanged:{get:function(){return this._definitionChanged}},color:(0,aie.A)("color"),gapColor:(0,aie.A)("gapColor"),dashLength:(0,aie.A)("dashLength"),dashPattern:(0,aie.A)("dashPattern")}),Zie.prototype.getType=function(e){return"PolylineDash"};const eoe=new kne.A;Zie.prototype.getValue=function(e,t){return(0,$9.A)(e)||(e=kne.A.now(eoe)),(0,$9.A)(t)||(t={}),t.color=cie.A.getValueOrClonedDefault(this._color,e,$ie,t.color),t.gapColor=cie.A.getValueOrClonedDefault(this._gapColor,e,Jie,t.gapColor),t.dashLength=cie.A.getValueOrDefault(this._dashLength,e,16,t.dashLength),t.dashPattern=cie.A.getValueOrDefault(this._dashPattern,e,255,t.dashPattern),t},Zie.prototype.equals=function(e){return this===e||e instanceof Zie&&cie.A.equals(this._color,e._color)&&cie.A.equals(this._gapColor,e._gapColor)&&cie.A.equals(this._dashLength,e._dashLength)&&cie.A.equals(this._dashPattern,e._dashPattern)};const toe=Zie,noe=yee.A.WHITE;function ioe(e){e=e??Cee.A.EMPTY_OBJECT,this._definitionChanged=new lte.A,this._color=void 0,this._colorSubscription=void 0,this._glowPower=void 0,this._glowPowerSubscription=void 0,this._taperPower=void 0,this._taperPowerSubscription=void 0,this.color=e.color,this.glowPower=e.glowPower,this.taperPower=e.taperPower}Object.defineProperties(ioe.prototype,{isConstant:{get:function(){return cie.A.isConstant(this._color)&&cie.A.isConstant(this._glow)}},definitionChanged:{get:function(){return this._definitionChanged}},color:(0,aie.A)("color"),glowPower:(0,aie.A)("glowPower"),taperPower:(0,aie.A)("taperPower")}),ioe.prototype.getType=function(e){return"PolylineGlow"};const ooe=new kne.A;ioe.prototype.getValue=function(e,t){return(0,$9.A)(e)||(e=kne.A.now(ooe)),(0,$9.A)(t)||(t={}),t.color=cie.A.getValueOrClonedDefault(this._color,e,noe,t.color),t.glowPower=cie.A.getValueOrDefault(this._glowPower,e,.25,t.glowPower),t.taperPower=cie.A.getValueOrDefault(this._taperPower,e,1,t.taperPower),t},ioe.prototype.equals=function(e){return this===e||e instanceof ioe&&cie.A.equals(this._color,e._color)&&cie.A.equals(this._glowPower,e._glowPower)&&cie.A.equals(this._taperPower,e._taperPower)};const roe=ioe;var soe=n(615517);const aoe=yee.A.WHITE,coe=yee.A.BLACK;function loe(e){e=e??Cee.A.EMPTY_OBJECT,this._definitionChanged=new lte.A,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this.color=e.color,this.outlineColor=e.outlineColor,this.outlineWidth=e.outlineWidth}Object.defineProperties(loe.prototype,{isConstant:{get:function(){return cie.A.isConstant(this._color)&&cie.A.isConstant(this._outlineColor)&&cie.A.isConstant(this._outlineWidth)}},definitionChanged:{get:function(){return this._definitionChanged}},color:(0,aie.A)("color"),outlineColor:(0,aie.A)("outlineColor"),outlineWidth:(0,aie.A)("outlineWidth")}),loe.prototype.getType=function(e){return"PolylineOutline"};const uoe=new kne.A;loe.prototype.getValue=function(e,t){return(0,$9.A)(e)||(e=kne.A.now(uoe)),(0,$9.A)(t)||(t={}),t.color=cie.A.getValueOrClonedDefault(this._color,e,aoe,t.color),t.outlineColor=cie.A.getValueOrClonedDefault(this._outlineColor,e,coe,t.outlineColor),t.outlineWidth=cie.A.getValueOrDefault(this._outlineWidth,e,1),t},loe.prototype.equals=function(e){return this===e||e instanceof loe&&cie.A.equals(this._color,e._color)&&cie.A.equals(this._outlineColor,e._outlineColor)&&cie.A.equals(this._outlineWidth,e._outlineWidth)};const doe=loe;var hoe=n(819003),Aoe=n(931895);function poe(e,t){this._value=void 0,this._definitionChanged=new lte.A,this._eventHelper=new Aoe.A,this._referenceFrame=t??Yne.A.FIXED,this.setValue(e)}Object.defineProperties(poe.prototype,{isConstant:{get:function(){const e=this._value;if(!(0,$9.A)(e))return!0;const t=e.length;for(let n=0;n<t;n++)if(!cie.A.isConstant(e[n]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});const foe=new kne.A;poe.prototype.getValue=function(e,t){return(0,$9.A)(e)||(e=kne.A.now(foe)),this.getValueInReferenceFrame(e,Yne.A.FIXED,t)},poe.prototype.getValueInReferenceFrame=function(e,t,n){if(!(0,$9.A)(e))throw new Q9.A("time is required.");if(!(0,$9.A)(t))throw new Q9.A("referenceFrame is required.");const i=this._value;if(!(0,$9.A)(i))return;const o=i.length;(0,$9.A)(n)||(n=new Array(o));let r=0,s=0;for(;r<o;){const o=i[r].getValueInReferenceFrame(e,t,n[r]);(0,$9.A)(o)&&(n[s]=o,s++),r++}return n.length=s,n},poe.prototype.setValue=function(e){const t=this._eventHelper;if(t.removeAll(),(0,$9.A)(e)){this._value=e.slice();const n=e.length;for(let i=0;i<n;i++){const n=e[i];(0,$9.A)(n)&&t.add(n.definitionChanged,poe.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)},poe.prototype.equals=function(e){return this===e||e instanceof poe&&this._referenceFrame===e._referenceFrame&&cie.A.arrayEquals(this._value,e._value)},poe.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};const moe=poe;function goe(e){this._value=void 0,this._definitionChanged=new lte.A,this._eventHelper=new Aoe.A,this.setValue(e)}Object.defineProperties(goe.prototype,{isConstant:{get:function(){const e=this._value;if(!(0,$9.A)(e))return!0;const t=e.length;for(let n=0;n<t;n++)if(!cie.A.isConstant(e[n]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}});const _oe=new kne.A;goe.prototype.getValue=function(e,t){(0,$9.A)(e)||(e=kne.A.now(_oe));const n=this._value;if(!(0,$9.A)(n))return;const i=n.length;(0,$9.A)(t)||(t=new Array(i));let o=0,r=0;for(;o<i;){const n=this._value[o].getValue(e,t[o]);(0,$9.A)(n)&&(t[r]=n,r++),o++}return t.length=r,t},goe.prototype.setValue=function(e){const t=this._eventHelper;if(t.removeAll(),(0,$9.A)(e)){this._value=e.slice();const n=e.length;for(let i=0;i<n;i++){const n=e[i];(0,$9.A)(n)&&t.add(n.definitionChanged,goe.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)},goe.prototype.equals=function(e){return this===e||e instanceof goe&&cie.A.arrayEquals(this._value,e._value)},goe.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};const yoe=goe;var voe=n(606727),Toe=n(55954),boe=n(500822);const woe={packedLength:1,pack:function(e,t,n){if(!(0,$9.A)(e))throw new Q9.A("value is required");if(!(0,$9.A)(t))throw new Q9.A("array is required");return t[n=n??0]=e,t},unpack:function(e,t,n){if(!(0,$9.A)(e))throw new Q9.A("array is required");return e[t=t??0]},convertPackedArrayForInterpolation:function(e,t,n,i){if(!(0,$9.A)(e))throw new Q9.A("packedArray is required");let o;(0,$9.A)(i)||(i=[]),t=t??0;for(let r=0,s=(n=n??e.length)-t+1;r<s;r++){const n=e[t+r];0===r||Math.abs(o-n)<Math.PI?i[r]=n:i[r]=n-nne.A.TWO_PI,o=n}},unpackInterpolationResult:function(e,t,n,i,o){if(!(0,$9.A)(e))throw new Q9.A("array is required");if(!(0,$9.A)(t))throw new Q9.A("sourceArray is required");return(o=e[0])<0?o+nne.A.TWO_PI:o}};var xoe=n(201746),Coe=n(529261);const Eoe=Object.freeze({HORIZONTAL:0,VERTICAL:1}),Soe=Eoe.HORIZONTAL,Ioe=yee.A.WHITE,Poe=yee.A.BLACK;function Doe(e){e=e??Cee.A.EMPTY_OBJECT,this._definitionChanged=new lte.A,this._orientation=void 0,this._orientationSubscription=void 0,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._offset=void 0,this._offsetSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.orientation=e.orientation,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.offset=e.offset,this.repeat=e.repeat}Object.defineProperties(Doe.prototype,{isConstant:{get:function(){return cie.A.isConstant(this._orientation)&&cie.A.isConstant(this._evenColor)&&cie.A.isConstant(this._oddColor)&&cie.A.isConstant(this._offset)&&cie.A.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},orientation:(0,aie.A)("orientation"),evenColor:(0,aie.A)("evenColor"),oddColor:(0,aie.A)("oddColor"),offset:(0,aie.A)("offset"),repeat:(0,aie.A)("repeat")}),Doe.prototype.getType=function(e){return"Stripe"};const Ooe=new kne.A;Doe.prototype.getValue=function(e,t){return(0,$9.A)(e)||(e=kne.A.now(Ooe)),(0,$9.A)(t)||(t={}),t.horizontal=cie.A.getValueOrDefault(this._orientation,e,Soe)===Eoe.HORIZONTAL,t.evenColor=cie.A.getValueOrClonedDefault(this._evenColor,e,Ioe,t.evenColor),t.oddColor=cie.A.getValueOrClonedDefault(this._oddColor,e,Poe,t.oddColor),t.offset=cie.A.getValueOrDefault(this._offset,e,0),t.repeat=cie.A.getValueOrDefault(this._repeat,e,1),t},Doe.prototype.equals=function(e){return this===e||e instanceof Doe&&cie.A.equals(this._orientation,e._orientation)&&cie.A.equals(this._evenColor,e._evenColor)&&cie.A.equals(this._oddColor,e._oddColor)&&cie.A.equals(this._offset,e._offset)&&cie.A.equals(this._repeat,e._repeat)};const Roe=Doe;var Moe=n(57930);function Loe(){this._definitionChanged=new lte.A,this._intervals=new Kne.A,this._intervals.changedEvent.addEventListener(Loe.prototype._intervalsChanged,this)}Object.defineProperties(Loe.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});const Noe=new kne.A;Loe.prototype.getValue=function(e,t){(0,$9.A)(e)||(e=kne.A.now(Noe));const n=this._intervals.findDataForIntervalContainingDate(e);return(0,$9.A)(n)&&"function"==typeof n.clone?n.clone(t):n},Loe.prototype.equals=function(e){return this===e||e instanceof Loe&&this._intervals.equals(e._intervals,cie.A.equals)},Loe.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};const Boe=Loe;var Foe=n(157298),Uoe=n(36169);function koe(e,t){this._velocityVectorProperty=new Uoe.A(e,!0),this._subscription=void 0,this._ellipsoid=void 0,this._definitionChanged=new lte.A,this.ellipsoid=t??Dne.A.default;const n=this;this._velocityVectorProperty.definitionChanged.addEventListener(function(){n._definitionChanged.raiseEvent(n)})}Object.defineProperties(koe.prototype,{isConstant:{get:function(){return cie.A.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(e){this._velocityVectorProperty.position=e}},ellipsoid:{get:function(){return this._ellipsoid},set:function(e){this._ellipsoid!==e&&(this._ellipsoid=e,this._definitionChanged.raiseEvent(this))}}});const Voe=new ete.A,zoe=new ete.A,Hoe=new rne.A,Goe=new kne.A;koe.prototype.getValue=function(e,t){(0,$9.A)(e)||(e=kne.A.now(Goe));const n=this._velocityVectorProperty._getValue(e,zoe,Voe);if((0,$9.A)(n))return Foe.A.rotationMatrixFromPositionVelocity(Voe,n,this._ellipsoid,Hoe),Wne.A.fromRotationMatrix(Hoe,t)},koe.prototype.equals=function(e){return this===e||e instanceof koe&&cie.A.equals(this._velocityVectorProperty,e._velocityVectorProperty)&&(this._ellipsoid===e._ellipsoid||this._ellipsoid.equals(e._ellipsoid))};const Woe=koe;var Yoe=n(668481),qoe=n(812688);const joe={COMPLETE:0,BELOW_ELLIPSOID_HORIZON:1,ABOVE_ELLIPSOID_HORIZON:2,validate:function(e){return e===joe.COMPLETE||e===joe.BELOW_ELLIPSOID_HORIZON||e===joe.ABOVE_ELLIPSOID_HORIZON},toString:function(e){switch(e){case joe.COMPLETE:return"COMPLETE";case joe.BELOW_ELLIPSOID_HORIZON:return"BELOW_ELLIPSOID_HORIZON";case joe.ABOVE_ELLIPSOID_HORIZON:return"ABOVE_ELLIPSOID_HORIZON";default:throw new Q9.A("SensorVolumePortionToDisplay value is not valid and cannot be converted to a String.")}}},Qoe=joe;function Xoe(){}let Koe;function $oe(e,t){return"#"===t[0]&&(t=Koe+t),boe.A.fromString(e,t)}function Joe(e,t,n){if((0,$9.A)(n.reference))return $oe(t,n.reference);if((0,$9.A)(n.velocityReference)){const i=$oe(t,n.velocityReference);switch(e){case ete.A:case Xoe:return new Uoe.A(i,e===Xoe);case Wne.A:return new Woe(i)}}throw new qne.A(`${JSON.stringify(n)} is not valid CZML.`)}Xoe.packedLength=ete.A.packedLength,Xoe.unpack=ete.A.unpack,Xoe.pack=ete.A.pack;const Zoe=new ete.A,ere=new Qne,tre=new wne.A,nre=new Xne.A,ire=new Wne.A;function ore(e,t){const n=e.uri??e;return(0,$9.A)(t)?t.getDerivedResource({url:n}):Eee.A.createIfNeeded(n)}function rre(e){const t=e.cartesian;if((0,$9.A)(t))return t;const n=e.cartesianVelocity;if((0,$9.A)(n))return n;const i=e.unitCartesian;if((0,$9.A)(i))return i;const o=e.unitSpherical;if((0,$9.A)(o))return function(e){const t=e.length;if(ere.magnitude=1,2===t)return ere.clock=e[0],ere.cone=e[1],ete.A.fromSpherical(ere,Zoe),[Zoe.x,Zoe.y,Zoe.z];const n=new Array(t/3*4);for(let i=0,o=0;i<t;i+=3,o+=4)n[o]=e[i],ere.clock=e[i+1],ere.cone=e[i+2],ete.A.fromSpherical(ere,Zoe),n[o+1]=Zoe.x,n[o+2]=Zoe.y,n[o+3]=Zoe.z;return n}(o);const r=e.spherical;if((0,$9.A)(r))return function(e){const t=e.length;if(3===t)return ere.clock=e[0],ere.cone=e[1],ere.magnitude=e[2],ete.A.fromSpherical(ere,Zoe),[Zoe.x,Zoe.y,Zoe.z];const n=new Array(t);for(let i=0;i<t;i+=4)n[i]=e[i],ere.clock=e[i+1],ere.cone=e[i+2],ere.magnitude=e[i+3],ete.A.fromSpherical(ere,Zoe),n[i+1]=Zoe.x,n[i+2]=Zoe.y,n[i+3]=Zoe.z;return n}(r);const s=e.cartographicRadians;if((0,$9.A)(s))return function(e){const t=e.length;if(3===t)return tre.longitude=e[0],tre.latitude=e[1],tre.height=e[2],Dne.A.default.cartographicToCartesian(tre,Zoe),[Zoe.x,Zoe.y,Zoe.z];const n=new Array(t);for(let i=0;i<t;i+=4)n[i]=e[i],tre.longitude=e[i+1],tre.latitude=e[i+2],tre.height=e[i+3],Dne.A.default.cartographicToCartesian(tre,Zoe),n[i+1]=Zoe.x,n[i+2]=Zoe.y,n[i+3]=Zoe.z;return n}(s);const a=e.cartographicDegrees;if((0,$9.A)(a))return function(e){const t=e.length;if(3===t)return tre.longitude=nne.A.toRadians(e[0]),tre.latitude=nne.A.toRadians(e[1]),tre.height=e[2],Dne.A.default.cartographicToCartesian(tre,Zoe),[Zoe.x,Zoe.y,Zoe.z];const n=new Array(t);for(let i=0;i<t;i+=4)n[i]=e[i],tre.longitude=nne.A.toRadians(e[i+1]),tre.latitude=nne.A.toRadians(e[i+2]),tre.height=e[i+3],Dne.A.default.cartographicToCartesian(tre,Zoe),n[i+1]=Zoe.x,n[i+2]=Zoe.y,n[i+3]=Zoe.z;return n}(a);throw new qne.A(`${JSON.stringify(e)} is not a valid CZML interval.`)}function sre(e,t){ete.A.unpack(e,t,Zoe),ete.A.normalize(Zoe,Zoe),ete.A.pack(Zoe,e,t)}function are(e,t){Wne.A.unpack(e,t,ire),Wne.A.normalize(ire,ire),Wne.A.pack(ire,e,t)}function cre(e){return"boolean"==typeof e?Boolean:"number"==typeof e?Number:"string"==typeof e?String:e.hasOwnProperty("array")?Array:e.hasOwnProperty("boolean")?Boolean:e.hasOwnProperty("boundingRectangle")?Tne.A:e.hasOwnProperty("cartesian2")?bne.A:e.hasOwnProperty("cartesian")||e.hasOwnProperty("spherical")||e.hasOwnProperty("cartographicRadians")||e.hasOwnProperty("cartographicDegrees")?ete.A:e.hasOwnProperty("unitCartesian")||e.hasOwnProperty("unitSpherical")?Xoe:e.hasOwnProperty("rgba")||e.hasOwnProperty("rgbaf")?yee.A:e.hasOwnProperty("arcType")?tte.A:e.hasOwnProperty("classificationType")?$ne.A:e.hasOwnProperty("colorBlendMode")?Jne.A:e.hasOwnProperty("cornerType")?Ene.A:e.hasOwnProperty("heightReference")?Zne.Ay:e.hasOwnProperty("horizontalOrigin")?eie.A:e.hasOwnProperty("date")?kne.A:e.hasOwnProperty("labelStyle")?tie.A:e.hasOwnProperty("number")?Number:e.hasOwnProperty("nearFarScalar")?Hne.A:e.hasOwnProperty("distanceDisplayCondition")?Pne.A:e.hasOwnProperty("object")||e.hasOwnProperty("value")?Object:e.hasOwnProperty("unitQuaternion")?Wne.A:e.hasOwnProperty("shadowMode")?nie.A:e.hasOwnProperty("string")?String:e.hasOwnProperty("stripeOrientation")?Eoe:e.hasOwnProperty("wsen")||e.hasOwnProperty("wsenDegrees")?Ate.A:e.hasOwnProperty("uri")?ra:e.hasOwnProperty("verticalOrigin")?iie.A:Object}const lre={HERMITE:Fne,LAGRANGE:Vne,LINEAR:zne.A};function ure(e,t){const n=e.interpolationAlgorithm,i=e.interpolationDegree;((0,$9.A)(n)||(0,$9.A)(i))&&t.setInterpolationOptions({interpolationAlgorithm:lre[n],interpolationDegree:i});const o=e.forwardExtrapolationType;(0,$9.A)(o)&&(t.forwardExtrapolationType=One.A[o]);const r=e.forwardExtrapolationDuration;(0,$9.A)(r)&&(t.forwardExtrapolationDuration=r);const s=e.backwardExtrapolationType;(0,$9.A)(s)&&(t.backwardExtrapolationType=One.A[s]);const a=e.backwardExtrapolationDuration;(0,$9.A)(a)&&(t.backwardExtrapolationDuration=a)}const dre={iso8601:void 0};function hre(e){if((0,$9.A)(e))return dre.iso8601=e,Xne.A.fromIso8601(dre)}function Are(e){const t=Une.A.MAXIMUM_INTERVAL.clone();return t.data=e,t}function pre(e){const t=new mie.A;return t.intervals.addInterval(Are(e)),t}function fre(e){const t=new vie.A(e.referenceFrame);return t.intervals.addInterval(Are(e)),t}function mre(e,t,n,i,o,r,s){let a,c,l,u=hre(i.interval);(0,$9.A)(o)&&(u=(0,$9.A)(u)?Xne.A.intersect(u,o,nre):o);const d=!(0,$9.A)(i.reference)&&!(0,$9.A)(i.velocityReference),h=(0,$9.A)(u)&&!u.equals(Une.A.MAXIMUM_INTERVAL);if(!0===i.delete)return h?gre(t[n],u):void(t[n]=void 0);let A=!1;if(d){if(c=function(e,t,n){switch(e){case tte.A:return tte.A[t.arcType??t];case Array:return t.array;case Boolean:return t.boolean??t;case Tne.A:return t.boundingRectangle;case bne.A:return t.cartesian2;case ete.A:return rre(t);case Xoe:return function(e){const t=rre(e);if(3===t.length)return sre(t,0),t;for(let e=1;e<t.length;e+=4)sre(t,e);return t}(t);case yee.A:return function(e){let t=e.rgbaf;if((0,$9.A)(t))return t;const n=e.rgba;if(!(0,$9.A)(n))return;const i=n.length;if(i===yee.A.packedLength)return[yee.A.byteToFloat(n[0]),yee.A.byteToFloat(n[1]),yee.A.byteToFloat(n[2]),yee.A.byteToFloat(n[3])];t=new Array(i);for(let e=0;e<i;e+=5)t[e]=n[e],t[e+1]=yee.A.byteToFloat(n[e+1]),t[e+2]=yee.A.byteToFloat(n[e+2]),t[e+3]=yee.A.byteToFloat(n[e+3]),t[e+4]=yee.A.byteToFloat(n[e+4]);return t}(t);case $ne.A:return $ne.A[t.classificationType??t];case Jne.A:return Jne.A[t.colorBlendMode??t];case Ene.A:return Ene.A[t.cornerType??t];case Zne.Ay:return Zne.Ay[t.heightReference??t];case eie.A:return eie.A[t.horizontalOrigin??t];case Image:return ore(t,n);case kne.A:return kne.A.fromIso8601(t.date??t);case tie.A:return tie.A[t.labelStyle??t];case Number:return t.number??t;case Hne.A:return t.nearFarScalar;case Pne.A:return t.distanceDisplayCondition;case Object:return t.object??t.value??t;case Wne.A:return function(e){const t=e.unitQuaternion;if((0,$9.A)(t)){if(4===t.length)return are(t,0),t;for(let e=1;e<t.length;e+=5)are(t,e)}return t}(t);case woe:return t.number??t;case Qoe:return Qoe[t.portionToDisplay??t];case nie.A:return nie.A[t.shadowMode??t.shadows??t];case String:return t.string??t;case Eoe:return Eoe[t.stripeOrientation??t];case Ate.A:return function(e){let t=e.wsen;if((0,$9.A)(t))return t;const n=e.wsenDegrees;if(!(0,$9.A)(n))return;const i=n.length;if(i===Ate.A.packedLength)return[nne.A.toRadians(n[0]),nne.A.toRadians(n[1]),nne.A.toRadians(n[2]),nne.A.toRadians(n[3])];t=new Array(i);for(let e=0;e<i;e+=5)t[e]=n[e],t[e+1]=nne.A.toRadians(n[e+1]),t[e+2]=nne.A.toRadians(n[e+2]),t[e+3]=nne.A.toRadians(n[e+3]),t[e+4]=nne.A.toRadians(n[e+4]);return t}(t);case ra:return ore(t,n);case iie.A:return iie.A[t.verticalOrigin??t];default:throw new qne.A(`Unknown CzmlDataSource interval type: ${e}`)}}(e,i,r),!(0,$9.A)(c))return;a=e.packedLength??1,l=c.length??1,A=!(0,$9.A)(i.array)&&"string"!=typeof c&&l>a&&e!==Object}const p="function"==typeof e.unpack&&e!==woe;if(!A&&!h)return void(t[n]=d?new bie.A(p?e.unpack(c,0):c):Joe(e,s,i));let f,m=t[n];const g=i.epoch;if((0,$9.A)(g)&&(f=kne.A.fromIso8601(g)),A&&!h)return m instanceof Coe.A||(t[n]=m=new Coe.A(e)),m.addSamplesPackedArray(c,f),void ure(i,m);let _;if(!A&&h)return u=u.clone(),u.data=d?p?e.unpack(c,0):c:Joe(e,s,i),(0,$9.A)(m)||(t[n]=m=d?new Boe:new mie.A),void(d&&m instanceof Boe?m.intervals.addInterval(u):m instanceof mie.A?(d&&(u.data=new bie.A(u.data)),m.intervals.addInterval(u)):(t[n]=m=pre(m),d&&(u.data=new bie.A(u.data)),m.intervals.addInterval(u)));(0,$9.A)(m)||(t[n]=m=new mie.A),m instanceof mie.A||(t[n]=m=pre(m));const y=m.intervals;_=y.findInterval(u),(0,$9.A)(_)&&_.data instanceof Coe.A||(_=u.clone(),_.data=new Coe.A(e),y.addInterval(_)),_.data.addSamplesPackedArray(c,f),ure(i,_.data)}function gre(e,t){if(e instanceof Coe.A)e.removeSamples(t);else if(e instanceof Boe)e.intervals.removeInterval(t);else if(e instanceof mie.A){const n=e.intervals;for(let e=0;e<n.length;++e){const i=Xne.A.intersect(n.get(e),t,nre);i.isEmpty||gre(i.data,t)}return void n.removeInterval(t)}}function _re(e,t,n,i,o,r,s){if((0,$9.A)(i))if(Array.isArray(i))for(let a=0,c=i.length;a<c;++a)mre(e,t,n,i[a],o,r,s);else mre(e,t,n,i,o,r,s)}function yre(e,t,n,i,o,r){let s=hre(n.interval);(0,$9.A)(i)&&(s=(0,$9.A)(s)?Xne.A.intersect(s,i,nre):i);const a=(0,$9.A)(n.cartesianVelocity)?1:0,c=ete.A.packedLength*(a+1);let l,u;const d=!(0,$9.A)(n.reference),h=(0,$9.A)(s)&&!s.equals(Une.A.MAXIMUM_INTERVAL);if(!0===n.delete)return h?vre(e[t],s):void(e[t]=void 0);let A,p=!1;if(d&&((0,$9.A)(n.referenceFrame)&&(A=Yne.A[n.referenceFrame]),A=A??Yne.A.FIXED,l=rre(n),u=l.length??1,p=u>c),!p&&!h)return void(e[t]=d?new Tie.A(ete.A.unpack(l),A):$oe(r,n.reference));let f,m=e[t];const g=n.epoch;if((0,$9.A)(g)&&(f=kne.A.fromIso8601(g)),p&&!h)return m instanceof xoe.A&&(!(0,$9.A)(A)||m.referenceFrame===A)||(e[t]=m=new xoe.A(A,a)),m.addSamplesPackedArray(l,f),void ure(n,m);let _;if(!p&&h)return s=s.clone(),s.data=d?ete.A.unpack(l):$oe(r,n.reference),(0,$9.A)(m)||(m=d?new Moe.A(A):new vie.A(A),e[t]=m),void(d&&m instanceof Moe.A&&(0,$9.A)(A)&&m.referenceFrame===A?m.intervals.addInterval(s):m instanceof vie.A?(d&&(s.data=new Tie.A(s.data,A)),m.intervals.addInterval(s)):(e[t]=m=fre(m),d&&(s.data=new Tie.A(s.data,A)),m.intervals.addInterval(s)));(0,$9.A)(m)?m instanceof vie.A||(e[t]=m=fre(m)):e[t]=m=new vie.A(A);const y=m.intervals;_=y.findInterval(s),(0,$9.A)(_)&&_.data instanceof xoe.A&&(!(0,$9.A)(A)||_.data.referenceFrame===A)||(_=s.clone(),_.data=new xoe.A(A,a),y.addInterval(_)),_.data.addSamplesPackedArray(l,f),ure(n,_.data)}function vre(e,t){if(e instanceof xoe.A)e.removeSamples(t);else if(e instanceof Moe.A)e.intervals.removeInterval(t);else if(e instanceof vie.A){const n=e.intervals;for(let e=0;e<n.length;++e){const i=Xne.A.intersect(n.get(e),t,nre);i.isEmpty||vre(i.data,t)}return void n.removeInterval(t)}}function Tre(e,t,n,i,o,r){if((0,$9.A)(n))if(Array.isArray(n))for(let o=0,s=n.length;o<s;++o)yre(e,t,n[o],i,0,r);else yre(e,t,n,i,0,r)}function bre(e,t,n,i){(0,$9.A)(n.references)?Cre(e,t,n.references,n.interval,i,yoe,mie.A):((0,$9.A)(n.cartesian2)?n.array=bne.A.unpackArray(n.cartesian2):(0,$9.A)(n.cartesian)&&(n.array=bne.A.unpackArray(n.cartesian)),(0,$9.A)(n.array)&&_re(Array,e,t,n,void 0,void 0,i))}function wre(e,t,n,i,o,r){let s=hre(n.interval);(0,$9.A)(i)&&(s=(0,$9.A)(s)?Xne.A.intersect(s,i,nre):i);let a,c,l,u=e[t];if((0,$9.A)(s)){u instanceof yie||(u=new yie,e[t]=u);const n=u.intervals;c=n.findInterval({start:s.start,stop:s.stop}),(0,$9.A)(c)?a=c.data:(c=s.clone(),n.addInterval(c))}else a=u;(0,$9.A)(n.solidColor)?(a instanceof fie.A||(a=new fie.A),l=n.solidColor,_re(yee.A,a,"color",l.color,void 0,void 0,r)):(0,$9.A)(n.grid)?(a instanceof Vie||(a=new Vie),l=n.grid,_re(yee.A,a,"color",l.color,void 0,o,r),_re(Number,a,"cellAlpha",l.cellAlpha,void 0,o,r),_re(bne.A,a,"lineCount",l.lineCount,void 0,o,r),_re(bne.A,a,"lineThickness",l.lineThickness,void 0,o,r),_re(bne.A,a,"lineOffset",l.lineOffset,void 0,o,r)):(0,$9.A)(n.image)?(a instanceof zie.A||(a=new zie.A),l=n.image,_re(Image,a,"image",l.image,void 0,o,r),_re(bne.A,a,"repeat",l.repeat,void 0,o,r),_re(yee.A,a,"color",l.color,void 0,o,r),_re(Boolean,a,"transparent",l.transparent,void 0,o,r)):(0,$9.A)(n.stripe)?(a instanceof Roe||(a=new Roe),l=n.stripe,_re(Eoe,a,"orientation",l.orientation,void 0,o,r),_re(yee.A,a,"evenColor",l.evenColor,void 0,o,r),_re(yee.A,a,"oddColor",l.oddColor,void 0,o,r),_re(Number,a,"offset",l.offset,void 0,o,r),_re(Number,a,"repeat",l.repeat,void 0,o,r)):(0,$9.A)(n.polylineOutline)?(a instanceof doe||(a=new doe),l=n.polylineOutline,_re(yee.A,a,"color",l.color,void 0,o,r),_re(yee.A,a,"outlineColor",l.outlineColor,void 0,o,r),_re(Number,a,"outlineWidth",l.outlineWidth,void 0,o,r)):(0,$9.A)(n.polylineGlow)?(a instanceof roe||(a=new roe),l=n.polylineGlow,_re(yee.A,a,"color",l.color,void 0,o,r),_re(Number,a,"glowPower",l.glowPower,void 0,o,r),_re(Number,a,"taperPower",l.taperPower,void 0,o,r)):(0,$9.A)(n.polylineArrow)?(a instanceof Kie||(a=new Kie),l=n.polylineArrow,_re(yee.A,a,"color",l.color,void 0,void 0,r)):(0,$9.A)(n.polylineDash)?(a instanceof toe||(a=new toe),l=n.polylineDash,_re(yee.A,a,"color",l.color,void 0,void 0,r),_re(yee.A,a,"gapColor",l.gapColor,void 0,void 0,r),_re(Number,a,"dashLength",l.dashLength,void 0,o,r),_re(Number,a,"dashPattern",l.dashPattern,void 0,o,r)):(0,$9.A)(n.checkerboard)&&(a instanceof pie||(a=new pie),l=n.checkerboard,_re(yee.A,a,"evenColor",l.evenColor,void 0,o,r),_re(yee.A,a,"oddColor",l.oddColor,void 0,o,r),_re(bne.A,a,"repeat",l.repeat,void 0,o,r)),(0,$9.A)(c)?c.data=a:e[t]=a}function xre(e,t,n,i,o,r){if((0,$9.A)(n))if(Array.isArray(n))for(let s=0,a=n.length;s<a;++s)wre(e,t,n[s],i,o,r);else wre(e,t,n,i,o,r)}function Cre(e,t,n,i,o,r,s){const a=n.map(function(e){return $oe(o,e)});if((0,$9.A)(i)){i=hre(i);let n=e[t];if(!(n instanceof s)){const i=new s;i.intervals.addInterval(Are(n)),e[t]=n=i}i.data=new r(a),n.intervals.addInterval(i)}else e[t]=new r(a)}function Ere(e,t,n,i){const o=n.references;(0,$9.A)(o)?Cre(e,t,o,n.interval,i,yoe,mie.A):_re(Array,e,t,n,void 0,void 0,i)}function Sre(e,t,n,i){if((0,$9.A)(n))if(Array.isArray(n))for(let o=0,r=n.length;o<r;++o)Ere(e,t,n[o],i);else Ere(e,t,n,i)}function Ire(e,t,n,i){const o=n.references;(0,$9.A)(o)?Cre(e,t,o,n.interval,i,moe,vie.A):((0,$9.A)(n.cartesian)?n.array=ete.A.unpackArray(n.cartesian):(0,$9.A)(n.cartographicRadians)?n.array=ete.A.fromRadiansArrayHeights(n.cartographicRadians,Dne.A.default):(0,$9.A)(n.cartographicDegrees)&&(n.array=ete.A.fromDegreesArrayHeights(n.cartographicDegrees,Dne.A.default)),(0,$9.A)(n.array)&&_re(Array,e,t,n,void 0,void 0,i))}function Pre(e,t,n,i){if((0,$9.A)(n))if(Array.isArray(n))for(let o=0,r=n.length;o<r;++o)Ire(e,t,n[o],i);else Ire(e,t,n,i)}function Dre(e){return ete.A.unpackArray(e)}function Ore(e){return ete.A.fromRadiansArrayHeights(e,Dne.A.default)}function Rre(e){return ete.A.fromDegreesArrayHeights(e,Dne.A.default)}function Mre(e,t,n,i){const o=n.references;if((0,$9.A)(o)){const r=o.map(function(e){const t={};return Cre(t,"positions",e,n.interval,i,moe,vie.A),t.positions});e[t]=new moe(r)}else(0,$9.A)(n.cartesian)?n.array=n.cartesian.map(Dre):(0,$9.A)(n.cartographicRadians)?n.array=n.cartographicRadians.map(Ore):(0,$9.A)(n.cartographicDegrees)&&(n.array=n.cartographicDegrees.map(Rre)),(0,$9.A)(n.array)&&_re(Array,e,t,n,void 0,void 0,i)}function Lre(e,t,n,i,o){let r=hre(t.interval);(0,$9.A)(n)&&(r=(0,$9.A)(r)?Xne.A.intersect(r,n,nre):n);let s=e.nodeTransformations;const a=Object.keys(t);for(let n=0,c=a.length;n<c;++n){const c=a[n];if("interval"===c)continue;const l=t[c];if(!(0,$9.A)(l))continue;(0,$9.A)(s)||(e.nodeTransformations=s=new voe.A),s.hasProperty(c)||s.addProperty(c);let u=s[c];(0,$9.A)(u)||(s[c]=u=new Wie.A),_re(ete.A,u,"translation",l.translation,r,i,o),_re(Wne.A,u,"rotation",l.rotation,r,i,o),_re(ete.A,u,"scale",l.scale,r,i,o)}}function Nre(e,t,n,i,o){let r=hre(t.interval);(0,$9.A)(n)&&(r=(0,$9.A)(r)?Xne.A.intersect(r,n,nre):n);let s=e.articulations;const a=Object.keys(t);for(let n=0,c=a.length;n<c;++n){const c=a[n];if("interval"===c)continue;const l=t[c];(0,$9.A)(l)&&((0,$9.A)(s)||(e.articulations=s=new voe.A),s.hasProperty(c)||s.addProperty(c),_re(Number,s,c,l,r,i,o))}}function Bre(e){this.polygon=e,this._definitionChanged=new lte.A}function Fre(e){return e?tte.A.GEODESIC:tte.A.NONE}function Ure(e,t,n,i,o){let r=e.id;if((0,$9.A)(r)||(r=(0,Ine.A)()),Koe=r,!(0,$9.A)(o._version)&&"document"!==r)throw new qne.A("The first CZML packet is required to be the document object.");if(!0===e.delete)t.removeById(r);else if("document"===r)!function(e,t){const n=e.version;if((0,$9.A)(n)&&"string"==typeof n){const e=n.split(".");if(2===e.length){if("1"!==e[0])throw new qne.A("Cesium only supports CZML version 1.");t._version=n}}if(!(0,$9.A)(t._version))throw new qne.A("CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.");const i=t._documentPacket;(0,$9.A)(e.name)&&(i.name=e.name);const o=e.clock;if((0,$9.A)(o)){const e=i.clock;(0,$9.A)(e)?(e.interval=o.interval??e.interval,e.currentTime=o.currentTime??e.currentTime,e.range=o.range??e.range,e.step=o.step??e.step,e.multiplier=o.multiplier??e.multiplier):i.clock={interval:o.interval,currentTime:o.currentTime,range:o.range,step:o.step,multiplier:o.multiplier}}}(e,o);else{const o=t.getOrCreateEntity(r),s=e.parent;(0,$9.A)(s)&&(o.parent=t.getOrCreateEntity(s));for(let r=n.length-1;r>-1;r--)n[r](o,e,t,i)}Koe=void 0}function kre(e,t,n,i){if(!(0,$9.A)(t))throw new Q9.A("czml is required.");let o=t,r=(n=n??Cee.A.EMPTY_OBJECT).sourceUri,s=n.credit;if("string"==typeof s&&(s=new Sne.A(s)),e._credit=s,"string"==typeof t||t instanceof Eee.A){o=(t=Eee.A.createIfNeeded(t)).fetchJson(),r=r??t.clone();const n=e._resourceCredits,i=t.credits;if((0,$9.A)(i)){const e=i.length;for(let t=0;t<e;t++)n.push(i[t])}}return r=Eee.A.createIfNeeded(r),Cie.A.setLoading(e,!0),Promise.resolve(o).then(function(t){return function(e,t,n,i){Cie.A.setLoading(e,!0);const o=e._entityCollection;i&&(e._version=void 0,e._documentPacket=new Vre,o.removeAll()),zre._processCzml(t,o,n,void 0,e);let r=function(e){let t;const n=e._documentPacket.clock;if(!(0,$9.A)(n)){if(!(0,$9.A)(e._clock)){const n=e._entityCollection.computeAvailability();if(!n.start.equals(Une.A.MINIMUM_VALUE)){const i=n.start,o=n.stop,r=kne.A.secondsDifference(o,i),s=Math.round(r/120);return t=new Pie,t.startTime=kne.A.clone(i),t.stopTime=kne.A.clone(o),t.clockRange=xne.A.LOOP_STOP,t.multiplier=s,t.currentTime=kne.A.clone(i),t.clockStep=Cne.A.SYSTEM_CLOCK_MULTIPLIER,e._clock=t,!0}}return!1}(0,$9.A)(e._clock)?t=e._clock.clone():(t=new Pie,t.startTime=Une.A.MINIMUM_VALUE.clone(),t.stopTime=Une.A.MAXIMUM_VALUE.clone(),t.currentTime=Une.A.MINIMUM_VALUE.clone(),t.clockRange=xne.A.LOOP_STOP,t.clockStep=Cne.A.SYSTEM_CLOCK_MULTIPLIER,t.multiplier=1);const i=hre(n.interval);return(0,$9.A)(i)&&(t.startTime=i.start,t.stopTime=i.stop),(0,$9.A)(n.currentTime)&&(t.currentTime=kne.A.fromIso8601(n.currentTime)),(0,$9.A)(n.range)&&(t.clockRange=xne.A[n.range]??xne.A.LOOP_STOP),(0,$9.A)(n.step)&&(t.clockStep=Cne.A[n.step]??Cne.A.SYSTEM_CLOCK_MULTIPLIER),(0,$9.A)(n.multiplier)&&(t.multiplier=n.multiplier),!t.equals(e._clock)&&(e._clock=t.clone(e._clock),!0)}(e);const s=e._documentPacket;return(0,$9.A)(s.name)&&e._name!==s.name?(e._name=s.name,r=!0):!(0,$9.A)(e._name)&&(0,$9.A)(n)&&(e._name=Rne(n.getUrlComponent()),r=!0),Cie.A.setLoading(e,!1),r&&e._changed.raiseEvent(e),e}(e,t,r,i)}).catch(function(t){return Cie.A.setLoading(e,!1),e._error.raiseEvent(e,t),console.log(t),Promise.reject(t)})}function Vre(){this.name=void 0,this.clock=void 0}function zre(e){this._name=e,this._changed=new lte.A,this._error=new lte.A,this._isLoading=!1,this._loading=new lte.A,this._clock=void 0,this._documentPacket=new Vre,this._version=void 0,this._entityCollection=new Mie.A(this),this._entityCluster=new Rie.A,this._credit=void 0,this._resourceCredits=[]}Object.defineProperties(Bre.prototype,{isConstant:{get:function(){const e=this.polygon._positions,t=this.polygon._holes;return(!(0,$9.A)(e)||e.isConstant)&&(!(0,$9.A)(t)||t.isConstant)}},definitionChanged:{get:function(){return this._definitionChanged}}}),Bre.prototype.getValue=function(e,t){let n,i;return(0,$9.A)(this.polygon._positions)&&(n=this.polygon._positions.getValue(e)),(0,$9.A)(this.polygon._holes)&&(i=this.polygon._holes.getValue(e),(0,$9.A)(i)&&(i=i.map(function(e){return new Gne.A(e)}))),(0,$9.A)(t)?(t.positions=n,t.holes=i,t):new Gne.A(n,i)},Bre.prototype.equals=function(e){return this===e||e instanceof Bre&&cie.A.equals(this.polygon._positions,e.polygon._positions)&&cie.A.equals(this.polygon._holes,e.polygon._holes)},zre.load=function(e,t){return(new zre).load(e,t)},Object.defineProperties(zre.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!(0,$9.A)(e))throw new Q9.A("value must be defined.");this._entityCluster=e}},credit:{get:function(){return this._credit}}}),zre.updaters=[function(e,t,n,i){const o=t.billboard;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.billboard;(0,$9.A)(s)||(e.billboard=s=new oie.A),_re(Boolean,s,"show",o.show,r,i,n),_re(Image,s,"image",o.image,r,i,n),_re(Number,s,"scale",o.scale,r,i,n),_re(bne.A,s,"pixelOffset",o.pixelOffset,r,i,n),_re(ete.A,s,"eyeOffset",o.eyeOffset,r,i,n),_re(eie.A,s,"horizontalOrigin",o.horizontalOrigin,r,i,n),_re(iie.A,s,"verticalOrigin",o.verticalOrigin,r,i,n),_re(Zne.Ay,s,"heightReference",o.heightReference,r,i,n),_re(yee.A,s,"color",o.color,r,i,n),_re(woe,s,"rotation",o.rotation,r,i,n),function(e,t,n,i,o){(0,$9.A)(t)&&_re(Xoe,e,"alignedAxis",t,n,i,o)}(s,o.alignedAxis,r,i,n),_re(Boolean,s,"sizeInMeters",o.sizeInMeters,r,i,n),_re(Number,s,"width",o.width,r,i,n),_re(Number,s,"height",o.height,r,i,n),_re(Hne.A,s,"scaleByDistance",o.scaleByDistance,r,i,n),_re(Hne.A,s,"translucencyByDistance",o.translucencyByDistance,r,i,n),_re(Hne.A,s,"pixelOffsetScaleByDistance",o.pixelOffsetScaleByDistance,r,i,n),_re(Tne.A,s,"imageSubRegion",o.imageSubRegion,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),_re(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,r,i,n)},function(e,t,n,i){const o=t.box;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.box;(0,$9.A)(s)||(e.box=s=new rie.A),_re(Boolean,s,"show",o.show,r,i,n),_re(ete.A,s,"dimensions",o.dimensions,r,i,n),_re(Zne.Ay,s,"heightReference",o.heightReference,r,i,n),_re(Boolean,s,"fill",o.fill,r,i,n),xre(s,"material",o.material,r,i,n),_re(Boolean,s,"outline",o.outline,r,i,n),_re(yee.A,s,"outlineColor",o.outlineColor,r,i,n),_re(Number,s,"outlineWidth",o.outlineWidth,r,i,n),_re(nie.A,s,"shadows",o.shadows,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)},function(e,t,n,i){const o=t.corridor;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.corridor;(0,$9.A)(s)||(e.corridor=s=new wie.A),_re(Boolean,s,"show",o.show,r,i,n),Pre(s,"positions",o.positions,n),_re(Number,s,"width",o.width,r,i,n),_re(Number,s,"height",o.height,r,i,n),_re(Zne.Ay,s,"heightReference",o.heightReference,r,i,n),_re(Number,s,"extrudedHeight",o.extrudedHeight,r,i,n),_re(Zne.Ay,s,"extrudedHeightReference",o.extrudedHeightReference,r,i,n),_re(Ene.A,s,"cornerType",o.cornerType,r,i,n),_re(Number,s,"granularity",o.granularity,r,i,n),_re(Boolean,s,"fill",o.fill,r,i,n),xre(s,"material",o.material,r,i,n),_re(Boolean,s,"outline",o.outline,r,i,n),_re(yee.A,s,"outlineColor",o.outlineColor,r,i,n),_re(Number,s,"outlineWidth",o.outlineWidth,r,i,n),_re(nie.A,s,"shadows",o.shadows,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),_re($ne.A,s,"classificationType",o.classificationType,r,i,n),_re(Number,s,"zIndex",o.zIndex,r,i,n)},function(e,t,n,i){const o=t.cylinder;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.cylinder;(0,$9.A)(s)||(e.cylinder=s=new xie.A),_re(Boolean,s,"show",o.show,r,i,n),_re(Number,s,"length",o.length,r,i,n),_re(Number,s,"topRadius",o.topRadius,r,i,n),_re(Number,s,"bottomRadius",o.bottomRadius,r,i,n),_re(Zne.Ay,s,"heightReference",o.heightReference,r,i,n),_re(Boolean,s,"fill",o.fill,r,i,n),xre(s,"material",o.material,r,i,n),_re(Boolean,s,"outline",o.outline,r,i,n),_re(yee.A,s,"outlineColor",o.outlineColor,r,i,n),_re(Number,s,"outlineWidth",o.outlineWidth,r,i,n),_re(Number,s,"numberOfVerticalLines",o.numberOfVerticalLines,r,i,n),_re(Number,s,"slices",o.slices,r,i,n),_re(nie.A,s,"shadows",o.shadows,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)},function(e,t,n,i){const o=t.ellipse;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.ellipse;(0,$9.A)(s)||(e.ellipse=s=new Die.A),_re(Boolean,s,"show",o.show,r,i,n),_re(Number,s,"semiMajorAxis",o.semiMajorAxis,r,i,n),_re(Number,s,"semiMinorAxis",o.semiMinorAxis,r,i,n),_re(Number,s,"height",o.height,r,i,n),_re(Zne.Ay,s,"heightReference",o.heightReference,r,i,n),_re(Number,s,"extrudedHeight",o.extrudedHeight,r,i,n),_re(Zne.Ay,s,"extrudedHeightReference",o.extrudedHeightReference,r,i,n),_re(woe,s,"rotation",o.rotation,r,i,n),_re(woe,s,"stRotation",o.stRotation,r,i,n),_re(Number,s,"granularity",o.granularity,r,i,n),_re(Boolean,s,"fill",o.fill,r,i,n),xre(s,"material",o.material,r,i,n),_re(Boolean,s,"outline",o.outline,r,i,n),_re(yee.A,s,"outlineColor",o.outlineColor,r,i,n),_re(Number,s,"outlineWidth",o.outlineWidth,r,i,n),_re(Number,s,"numberOfVerticalLines",o.numberOfVerticalLines,r,i,n),_re(nie.A,s,"shadows",o.shadows,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),_re($ne.A,s,"classificationType",o.classificationType,r,i,n),_re(Number,s,"zIndex",o.zIndex,r,i,n)},function(e,t,n,i){const o=t.ellipsoid;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.ellipsoid;(0,$9.A)(s)||(e.ellipsoid=s=new Oie.A),_re(Boolean,s,"show",o.show,r,i,n),_re(ete.A,s,"radii",o.radii,r,i,n),_re(ete.A,s,"innerRadii",o.innerRadii,r,i,n),_re(Number,s,"minimumClock",o.minimumClock,r,i,n),_re(Number,s,"maximumClock",o.maximumClock,r,i,n),_re(Number,s,"minimumCone",o.minimumCone,r,i,n),_re(Number,s,"maximumCone",o.maximumCone,r,i,n),_re(Zne.Ay,s,"heightReference",o.heightReference,r,i,n),_re(Boolean,s,"fill",o.fill,r,i,n),xre(s,"material",o.material,r,i,n),_re(Boolean,s,"outline",o.outline,r,i,n),_re(yee.A,s,"outlineColor",o.outlineColor,r,i,n),_re(Number,s,"outlineWidth",o.outlineWidth,r,i,n),_re(Number,s,"stackPartitions",o.stackPartitions,r,i,n),_re(Number,s,"slicePartitions",o.slicePartitions,r,i,n),_re(Number,s,"subdivisions",o.subdivisions,r,i,n),_re(nie.A,s,"shadows",o.shadows,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)},function(e,t,n,i){const o=t.label;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.label;(0,$9.A)(s)||(e.label=s=new Hie.A),_re(Boolean,s,"show",o.show,r,i,n),_re(String,s,"text",o.text,r,i,n),_re(String,s,"font",o.font,r,i,n),_re(tie.A,s,"style",o.style,r,i,n),_re(Number,s,"scale",o.scale,r,i,n),_re(Boolean,s,"showBackground",o.showBackground,r,i,n),_re(yee.A,s,"backgroundColor",o.backgroundColor,r,i,n),_re(bne.A,s,"backgroundPadding",o.backgroundPadding,r,i,n),_re(bne.A,s,"pixelOffset",o.pixelOffset,r,i,n),_re(ete.A,s,"eyeOffset",o.eyeOffset,r,i,n),_re(eie.A,s,"horizontalOrigin",o.horizontalOrigin,r,i,n),_re(iie.A,s,"verticalOrigin",o.verticalOrigin,r,i,n),_re(Zne.Ay,s,"heightReference",o.heightReference,r,i,n),_re(yee.A,s,"fillColor",o.fillColor,r,i,n),_re(yee.A,s,"outlineColor",o.outlineColor,r,i,n),_re(Number,s,"outlineWidth",o.outlineWidth,r,i,n),_re(Hne.A,s,"translucencyByDistance",o.translucencyByDistance,r,i,n),_re(Hne.A,s,"pixelOffsetScaleByDistance",o.pixelOffsetScaleByDistance,r,i,n),_re(Hne.A,s,"scaleByDistance",o.scaleByDistance,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),_re(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,r,i,n)},function(e,t,n,i){const o=t.model;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s,a,c=e.model;(0,$9.A)(c)||(e.model=c=new Gie.A),_re(Boolean,c,"show",o.show,r,i,n),_re(ra,c,"uri",o.gltf,r,i,n),_re(Number,c,"scale",o.scale,r,i,n),_re(Number,c,"minimumPixelSize",o.minimumPixelSize,r,i,n),_re(Number,c,"maximumScale",o.maximumScale,r,i,n),_re(Boolean,c,"incrementallyLoadTextures",o.incrementallyLoadTextures,r,i,n),_re(Boolean,c,"runAnimations",o.runAnimations,r,i,n),_re(Boolean,c,"clampAnimations",o.clampAnimations,r,i,n),_re(nie.A,c,"shadows",o.shadows,r,i,n),_re(Zne.Ay,c,"heightReference",o.heightReference,r,i,n),_re(yee.A,c,"silhouetteColor",o.silhouetteColor,r,i,n),_re(Number,c,"silhouetteSize",o.silhouetteSize,r,i,n),_re(yee.A,c,"color",o.color,r,i,n),_re(Jne.A,c,"colorBlendMode",o.colorBlendMode,r,i,n),_re(Number,c,"colorBlendAmount",o.colorBlendAmount,r,i,n),_re(Pne.A,c,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n);const l=o.nodeTransformations;if((0,$9.A)(l))if(Array.isArray(l))for(s=0,a=l.length;s<a;++s)Lre(c,l[s],r,i,n);else Lre(c,l,r,i,n);const u=o.articulations;if((0,$9.A)(u))if(Array.isArray(u))for(s=0,a=u.length;s<a;++s)Nre(c,u[s],r,i,n);else Nre(c,u,r,i,n)},function(e,t,n,i){const o=t.name;(0,$9.A)(o)&&(e.name=t.name)},function(e,t,n,i){const o=t.description;(0,$9.A)(o)&&_re(String,e,"description",o,void 0,i,n)},function(e,t,n,i){const o=t.path;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.path;(0,$9.A)(s)||(e.path=s=new Yie.A),_re(Boolean,s,"show",o.show,r,i,n),_re(Number,s,"leadTime",o.leadTime,r,i,n),_re(Number,s,"trailTime",o.trailTime,r,i,n),_re(Number,s,"width",o.width,r,i,n),_re(Number,s,"resolution",o.resolution,r,i,n),xre(s,"material",o.material,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)},function(e,t,n,i){const o=t.point;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.point;(0,$9.A)(s)||(e.point=s=new qie.A),_re(Boolean,s,"show",o.show,r,i,n),_re(Number,s,"pixelSize",o.pixelSize,r,i,n),_re(Zne.Ay,s,"heightReference",o.heightReference,r,i,n),_re(yee.A,s,"color",o.color,r,i,n),_re(yee.A,s,"outlineColor",o.outlineColor,r,i,n),_re(Number,s,"outlineWidth",o.outlineWidth,r,i,n),_re(Hne.A,s,"scaleByDistance",o.scaleByDistance,r,i,n),_re(Hne.A,s,"translucencyByDistance",o.translucencyByDistance,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),_re(Number,s,"disableDepthTestDistance",o.disableDepthTestDistance,r,i,n)},function(e,t,n,i){const o=t.polygon;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.polygon;(0,$9.A)(s)||(e.polygon=s=new jie.A),_re(Boolean,s,"show",o.show,r,i,n),Pre(s,"_positions",o.positions,n),function(e,t,n,i){if((0,$9.A)(n))if(Array.isArray(n))for(let o=0,r=n.length;o<r;++o)Mre(e,t,n[o],i);else Mre(e,t,n,i)}(s,"_holes",o.holes,n),((0,$9.A)(s._positions)||(0,$9.A)(s._holes))&&(s.hierarchy=new Bre(s)),_re(Number,s,"height",o.height,r,i,n),_re(Zne.Ay,s,"heightReference",o.heightReference,r,i,n),_re(Number,s,"extrudedHeight",o.extrudedHeight,r,i,n),_re(Zne.Ay,s,"extrudedHeightReference",o.extrudedHeightReference,r,i,n),_re(woe,s,"stRotation",o.stRotation,r,i,n),_re(Number,s,"granularity",o.granularity,r,i,n),_re(Boolean,s,"fill",o.fill,r,i,n),xre(s,"material",o.material,r,i,n),_re(Boolean,s,"outline",o.outline,r,i,n),_re(yee.A,s,"outlineColor",o.outlineColor,r,i,n),_re(Number,s,"outlineWidth",o.outlineWidth,r,i,n),_re(Boolean,s,"perPositionHeight",o.perPositionHeight,r,i,n),_re(Boolean,s,"closeTop",o.closeTop,r,i,n),_re(Boolean,s,"closeBottom",o.closeBottom,r,i,n),_re(tte.A,s,"arcType",o.arcType,r,i,n),_re(nie.A,s,"shadows",o.shadows,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),_re($ne.A,s,"classificationType",o.classificationType,r,i,n),_re(Number,s,"zIndex",o.zIndex,r,i,n)},function(e,t,n,i){const o=t.polyline;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.polyline;if((0,$9.A)(s)||(e.polyline=s=new soe.A),_re(Boolean,s,"show",o.show,r,i,n),Pre(s,"positions",o.positions,n),_re(Number,s,"width",o.width,r,i,n),_re(Number,s,"granularity",o.granularity,r,i,n),xre(s,"material",o.material,r,i,n),xre(s,"depthFailMaterial",o.depthFailMaterial,r,i,n),_re(tte.A,s,"arcType",o.arcType,r,i,n),_re(Boolean,s,"clampToGround",o.clampToGround,r,i,n),_re(nie.A,s,"shadows",o.shadows,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),_re($ne.A,s,"classificationType",o.classificationType,r,i,n),_re(Number,s,"zIndex",o.zIndex,r,i,n),(0,$9.A)(o.followSurface)&&!(0,$9.A)(o.arcType)){const e={};_re(Boolean,e,"followSurface",o.followSurface,r,i,n),s.arcType=(a=e.followSurface,c=Fre,new sie.A(function(e,t){return c(a.getValue(e,t))},a.isConstant))}var a,c},function(e,t,n,i){const o=t.polylineVolume;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.polylineVolume;(0,$9.A)(s)||(e.polylineVolume=s=new hoe.A),Pre(s,"positions",o.positions,n),function(e,t,n,i){if((0,$9.A)(n))if(Array.isArray(n))for(let o=0,r=n.length;o<r;o++)bre(e,t,n[o],i);else bre(e,t,n,i)}(s,"shape",o.shape,n),_re(Boolean,s,"show",o.show,r,i,n),_re(Ene.A,s,"cornerType",o.cornerType,r,i,n),_re(Boolean,s,"fill",o.fill,r,i,n),xre(s,"material",o.material,r,i,n),_re(Boolean,s,"outline",o.outline,r,i,n),_re(yee.A,s,"outlineColor",o.outlineColor,r,i,n),_re(Number,s,"outlineWidth",o.outlineWidth,r,i,n),_re(Number,s,"granularity",o.granularity,r,i,n),_re(nie.A,s,"shadows",o.shadows,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)},function(e,t,n,i){const o=t.properties;if((0,$9.A)(o)){(0,$9.A)(e.properties)||(e.properties=new voe.A);for(const t in o)if(o.hasOwnProperty(t)){e.properties.hasProperty(t)||e.properties.addProperty(t);const r=o[t];if(Array.isArray(r))for(let o=0,s=r.length;o<s;++o)mre(cre(r[o]),e.properties,t,r[o],void 0,i,n);else mre(cre(r),e.properties,t,r,void 0,i,n)}}},function(e,t,n,i){const o=t.rectangle;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.rectangle;(0,$9.A)(s)||(e.rectangle=s=new Toe.A),_re(Boolean,s,"show",o.show,r,i,n),_re(Ate.A,s,"coordinates",o.coordinates,r,i,n),_re(Number,s,"height",o.height,r,i,n),_re(Zne.Ay,s,"heightReference",o.heightReference,r,i,n),_re(Number,s,"extrudedHeight",o.extrudedHeight,r,i,n),_re(Zne.Ay,s,"extrudedHeightReference",o.extrudedHeightReference,r,i,n),_re(woe,s,"rotation",o.rotation,r,i,n),_re(woe,s,"stRotation",o.stRotation,r,i,n),_re(Number,s,"granularity",o.granularity,r,i,n),_re(Boolean,s,"fill",o.fill,r,i,n),xre(s,"material",o.material,r,i,n),_re(Boolean,s,"outline",o.outline,r,i,n),_re(yee.A,s,"outlineColor",o.outlineColor,r,i,n),_re(Number,s,"outlineWidth",o.outlineWidth,r,i,n),_re(nie.A,s,"shadows",o.shadows,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n),_re($ne.A,s,"classificationType",o.classificationType,r,i,n),_re(Number,s,"zIndex",o.zIndex,r,i,n)},function(e,t,n,i){const o=t.position;(0,$9.A)(o)&&Tre(e,"position",o,void 0,0,n)},function(e,t,n,i){const o=t.tileset;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.tileset;(0,$9.A)(s)||(e.tileset=s=new qoe.A),_re(Boolean,s,"show",o.show,r,i,n),_re(ra,s,"uri",o.uri,r,i,n),_re(Number,s,"maximumScreenSpaceError",o.maximumScreenSpaceError,r,i,n)},function(e,t,n,i){const o=t.viewFrom;(0,$9.A)(o)&&_re(ete.A,e,"viewFrom",o,void 0,i,n)},function(e,t,n,i){const o=t.wall;if(!(0,$9.A)(o))return;const r=hre(o.interval);let s=e.wall;(0,$9.A)(s)||(e.wall=s=new Yoe.A),_re(Boolean,s,"show",o.show,r,i,n),Pre(s,"positions",o.positions,n),Sre(s,"minimumHeights",o.minimumHeights,n),Sre(s,"maximumHeights",o.maximumHeights,n),_re(Number,s,"granularity",o.granularity,r,i,n),_re(Boolean,s,"fill",o.fill,r,i,n),xre(s,"material",o.material,r,i,n),_re(Boolean,s,"outline",o.outline,r,i,n),_re(yee.A,s,"outlineColor",o.outlineColor,r,i,n),_re(Number,s,"outlineWidth",o.outlineWidth,r,i,n),_re(nie.A,s,"shadows",o.shadows,r,i,n),_re(Pne.A,s,"distanceDisplayCondition",o.distanceDisplayCondition,r,i,n)},function(e,t,n,i){const o=t.orientation;(0,$9.A)(o)&&_re(Wne.A,e,"orientation",o,void 0,i,n)},function(e,t,n,i){const o=t.availability;if(!(0,$9.A)(o))return;let r;if(Array.isArray(o))for(let e=0,t=o.length;e<t;++e)(0,$9.A)(r)||(r=new Kne.A),r.addInterval(hre(o[e]));else r=new Kne.A,r.addInterval(hre(o));e.availability=r}],zre.registerUpdater=function(e){zre.updaters.includes(e)||zre.updaters.push(e)},zre.unregisterUpdater=function(e){if(zre.updaters.includes(e)){const t=zre.updaters.indexOf(e);zre.updaters.splice(t,1)}},zre.prototype.process=function(e,t){return kre(this,e,t,!1)},zre.prototype.load=function(e,t){return kre(this,e,t,!0)},zre.prototype.update=function(e){return!0},zre.processPacketData=_re,zre.processPositionPacketData=Tre,zre.processMaterialPacketData=xre,zre._processCzml=function(e,t,n,i,o){if(i=i??zre.updaters,Array.isArray(e))for(let r=0,s=e.length;r<s;++r)Ure(e[r],t,i,n,o);else Ure(e,t,i,n,o)};const Hre=zre;var Gre=n(908978),Wre=n(259950);function Yre(){this._cache={}}Yre.prototype.fromColor=function(e,t){if(!(0,$9.A)(e))throw new Q9.A("color is required");if(!(0,$9.A)(t))throw new Q9.A("size is required");return Xre(void 0,void 0,e,t,this._cache)},Yre.prototype.fromUrl=function(e,t,n){if(!(0,$9.A)(e))throw new Q9.A("url is required");if(!(0,$9.A)(t))throw new Q9.A("color is required");if(!(0,$9.A)(n))throw new Q9.A("size is required");return Xre(e,void 0,t,n,this._cache)},Yre.prototype.fromMakiIconId=function(e,t,n){if(!(0,$9.A)(e))throw new Q9.A("id is required");if(!(0,$9.A)(t))throw new Q9.A("color is required");if(!(0,$9.A)(n))throw new Q9.A("size is required");return Xre((0,Gre.A)(`Assets/Textures/maki/${encodeURIComponent(e)}.png`),void 0,t,n,this._cache)},Yre.prototype.fromText=function(e,t,n){if(!(0,$9.A)(e))throw new Q9.A("text is required");if(!(0,$9.A)(t))throw new Q9.A("color is required");if(!(0,$9.A)(n))throw new Q9.A("size is required");return Xre(void 0,e,t,n,this._cache)};const qre=new yee.A;function jre(e,t,n){const i=n/2.5;let o=i,r=i;t.width>t.height?r=i*(t.height/t.width):t.width<t.height&&(o=i*(t.width/t.height));const s=Math.round((n-o)/2),a=Math.round(7/24*n-r/2);e.globalCompositeOperation="destination-out",e.drawImage(t,s-1,a,o,r),e.drawImage(t,s,a-1,o,r),e.drawImage(t,s+1,a,o,r),e.drawImage(t,s,a+1,o,r),e.globalCompositeOperation="destination-over",e.fillStyle=yee.A.BLACK.toCssColorString(),e.fillRect(s-1,a-1,o+2,r+2),e.globalCompositeOperation="destination-out",e.drawImage(t,s,a,o,r),e.globalCompositeOperation="destination-over",e.fillStyle=yee.A.WHITE.toCssColorString(),e.fillRect(s-1,a-2,o+2,r+2)}const Qre=new Array(4);function Xre(e,t,n,i,o){Qre[0]=e,Qre[1]=t,Qre[2]=n,Qre[3]=i;const r=JSON.stringify(Qre),s=o[r];if((0,$9.A)(s))return s;const a=document.createElement("canvas");a.width=i,a.height=i;const c=a.getContext("2d");if(function(e,t,n){e.save(),e.scale(n/24,n/24),e.fillStyle=t.toCssColorString(),e.strokeStyle=t.brighten(.6,qre).toCssColorString(),e.lineWidth=.846,e.beginPath(),e.moveTo(6.72,.422),e.lineTo(17.28,.422),e.bezierCurveTo(18.553,.422,19.577,1.758,19.577,3.415),e.lineTo(19.577,10.973),e.bezierCurveTo(19.577,12.63,18.553,13.966,17.282,13.966),e.lineTo(14.386,14.008),e.lineTo(11.826,23.578),e.lineTo(9.614,14.008),e.lineTo(6.719,13.965),e.bezierCurveTo(5.446,13.983,4.422,12.629,4.422,10.972),e.lineTo(4.422,3.416),e.bezierCurveTo(4.423,1.76,5.447,.423,6.718,.423),e.closePath(),e.fill(),e.stroke(),e.restore()}(c,n,i),(0,$9.A)(e)){const t=Eee.A.createIfNeeded(e).fetchImage().then(function(e){return jre(c,e,i),o[r]=a,a});return o[r]=t,t}if((0,$9.A)(t)){const e=(0,Wre.A)(t,{font:`bold ${i}px sans-serif`});jre(c,e,i)}return o[r]=a,a}const Kre=Yre;var $re=n(789344);function Jre(e){return ete.A.fromDegrees(e[0],e[1],e[2])}const Zre={"urn:ogc:def:crs:OGC:1.3:CRS84":Jre,"EPSG:4326":Jre,"urn:ogc:def:crs:EPSG::4326":Jre},ese={},tse={};let nse,ise=48,ose=yee.A.ROYALBLUE,rse=yee.A.YELLOW,sse=2,ase=yee.A.fromBytes(255,255,0,100),cse=!1;const lse={small:24,medium:48,large:64},use=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function dse(e,t){let n="";for(const i in e)if(e.hasOwnProperty(i)){if(i===t||-1!==use.indexOf(i))continue;const o=e[i];(0,$9.A)(o)&&(n+="object"==typeof o?`<tr><th>${i}</th><td>${dse(o)}</td></tr>`:`<tr><th>${i}</th><td>${o}</td></tr>`)}return n.length>0&&(n=`<table class="cesium-infoBox-defaultTable"><tbody>${n}</tbody></table>`),n}function hse(e,t){return new sie.A(function(e,t,n){let i;return function(o,r){return(0,$9.A)(i)||(i=e(t,n)),i}}(dse,e,t),!0)}function Ase(e,t,n){let i=e.id;if((0,$9.A)(i)&&"Feature"===e.type){let e=2,n=i;for(;(0,$9.A)(t.getById(n));)n=`${i}_${e}`,e++;i=n}else i=(0,Ine.A)();const o=t.getOrCreateEntity(i),r=e.properties;if((0,$9.A)(r)){let e;o.properties=r;const t=r.title;if((0,$9.A)(t))o.name=t,e="title";else{let t=Number.MAX_VALUE;for(const n in r)if(r.hasOwnProperty(n)&&r[n]){const i=n.toLowerCase();if(t>1&&"title"===i){t=1,e=n;break}t>2&&"name"===i?(t=2,e=n):t>3&&/title/i.test(n)?(t=3,e=n):t>4&&/name/i.test(n)&&(t=4,e=n)}(0,$9.A)(e)&&(o.name=r[e])}const i=r.description;null!==i&&(o.description=(0,$9.A)(i)?new bie.A(i):n(r,e))}return o}function pse(e,t){const n=new Array(e.length);for(let i=0;i<e.length;i++)n[i]=t(e[i]);return n}const fse={Feature:gse,FeatureCollection:function(e,t,n,i,o){const r=t.features;for(let t=0,n=r.length;t<n;t++)gse(e,r[t],0,i,o)},GeometryCollection:_se,LineString:wse,MultiLineString:xse,MultiPoint:Tse,MultiPolygon:Sse,Point:vse,Polygon:Ese,Topology:Ise},mse={GeometryCollection:_se,LineString:wse,MultiLineString:xse,MultiPoint:Tse,MultiPolygon:Sse,Point:vse,Polygon:Ese,Topology:Ise};function gse(e,t,n,i,o){if(null===t.geometry)return void Ase(t,e._entityCollection,o.describe);if(!(0,$9.A)(t.geometry))throw new qne.A("feature.geometry is required.");const r=t.geometry.type,s=mse[r];if(!(0,$9.A)(s))throw new qne.A(`Unknown geometry type: ${r}`);s(e,t,t.geometry,i,o)}function _se(e,t,n,i,o){const r=n.geometries;for(let n=0,s=r.length;n<s;n++){const s=r[n],a=s.type,c=mse[a];if(!(0,$9.A)(c))throw new qne.A(`Unknown geometry type: ${a}`);c(e,t,s,i,o)}}function yse(e,t,n,i,o){let r=o.markerSymbol,s=o.markerColor,a=o.markerSize;const c=t.properties;if((0,$9.A)(c)){const e=c["marker-color"];(0,$9.A)(e)&&(s=yee.A.fromCssColorString(e)),a=lse[c["marker-size"]]??a;const t=c["marker-symbol"];(0,$9.A)(t)&&(r=t)}let l;l=(0,$9.A)(r)?1===r.length?e._pinBuilder.fromText(r.toUpperCase(),s,a):e._pinBuilder.fromMakiIconId(r,s,a):e._pinBuilder.fromColor(s,a);const u=new oie.A;u.verticalOrigin=new bie.A(iie.A.BOTTOM),2===i.length&&o.clampToGround&&(u.heightReference=Zne.Ay.CLAMP_TO_GROUND);const d=Ase(t,e._entityCollection,o.describe);d.billboard=u,d.position=new Tie.A(n(i));const h=Promise.resolve(l).then(function(e){u.image=new bie.A(e)}).catch(function(){u.image=new bie.A(e._pinBuilder.fromColor(s,a))});e._promises.push(h)}function vse(e,t,n,i,o){yse(e,t,i,n.coordinates,o)}function Tse(e,t,n,i,o){const r=n.coordinates;for(let n=0;n<r.length;n++)yse(e,t,i,r[n],o)}function bse(e,t,n,i,o){let r=o.strokeMaterialProperty,s=o.strokeWidthProperty;const a=t.properties;if((0,$9.A)(a)){const e=a["stroke-width"];let t;(0,$9.A)(e)&&(s=new bie.A(e));const n=a.stroke;(0,$9.A)(n)&&(t=yee.A.fromCssColorString(n));const i=a["stroke-opacity"];(0,$9.A)(i)&&1!==i&&((0,$9.A)(t)||(t=r.color.getValue().clone()),t.alpha=i),(0,$9.A)(t)&&(r=new fie.A(t))}const c=Ase(t,e._entityCollection,o.describe),l=new soe.A;c.polyline=l,l.clampToGround=o.clampToGround,l.material=r,l.width=s,l.positions=new bie.A(pse(i,n)),l.arcType=tte.A.RHUMB}function wse(e,t,n,i,o){bse(e,t,i,n.coordinates,o)}function xse(e,t,n,i,o){const r=n.coordinates;for(let n=0;n<r.length;n++)bse(e,t,i,r[n],o)}function Cse(e,t,n,i,o){if(0===i.length||0===i[0].length)return;let r=o.strokeMaterialProperty.color,s=o.fillMaterialProperty,a=o.strokeWidthProperty;const c=t.properties;if((0,$9.A)(c)){const e=c["stroke-width"];let t;(0,$9.A)(e)&&(a=new bie.A(e));const n=c.stroke;(0,$9.A)(n)&&(t=yee.A.fromCssColorString(n));let i,o=c["stroke-opacity"];(0,$9.A)(o)&&1!==o&&((0,$9.A)(t)||(t=r.getValue().clone()),t.alpha=o),(0,$9.A)(t)&&(r=new bie.A(t));const l=c.fill,u=s.color.getValue();(0,$9.A)(l)&&(i=yee.A.fromCssColorString(l),i.alpha=u.alpha),o=c["fill-opacity"],(0,$9.A)(o)&&o!==u.alpha&&((0,$9.A)(i)||(i=u.clone()),i.alpha=o),(0,$9.A)(i)&&(s=new fie.A(i))}const l=new jie.A;l.outline=new bie.A(!0),l.outlineColor=r,l.outlineWidth=a,l.material=s,l.arcType=tte.A.RHUMB;const u=[];for(let e=1,t=i.length;e<t;e++)u.push(new Gne.A(pse(i[e],n)));const d=i[0];l.hierarchy=new bie.A(new Gne.A(pse(d,n),u)),d[0].length>2?l.perPositionHeight=new bie.A(!0):o.clampToGround||(l.height=0),Ase(t,e._entityCollection,o.describe).polygon=l}function Ese(e,t,n,i,o){Cse(e,t,i,n.coordinates,o)}function Sse(e,t,n,i,o){const r=n.coordinates;for(let n=0;n<r.length;n++)Cse(e,t,i,r[n],o)}function Ise(e,t,n,i,o){for(const t in n.objects)if(n.objects.hasOwnProperty(t)){const r=$re.A(n,n.objects[t]);(0,fse[r.type])(e,r,r,i,o)}}function Pse(e){this._name=e,this._changed=new lte.A,this._error=new lte.A,this._isLoading=!1,this._loading=new lte.A,this._entityCollection=new Mie.A(this),this._promises=[],this._pinBuilder=new Kre,this._entityCluster=new Rie.A,this._credit=void 0,this._resourceCredits=[]}function Dse(e,t,n,i){if(!(0,$9.A)(t))throw new Q9.A("data is required.");Cie.A.setLoading(e,!0);let o=(n=n??Cee.A.EMPTY_OBJECT).credit;"string"==typeof o&&(o=new Sne.A(o)),e._credit=o;let r=t,s=n.sourceUri;if("string"==typeof t||t instanceof Eee.A){r=(t=Eee.A.createIfNeeded(t)).fetchJson(),s=s??t.getUrlComponent();const n=e._resourceCredits,i=t.credits;if((0,$9.A)(i)){const e=i.length;for(let t=0;t<e;t++)n.push(i[t])}}return n={describe:n.describe??hse,markerSize:n.markerSize??ise,markerSymbol:n.markerSymbol??nse,markerColor:n.markerColor??ose,strokeWidthProperty:new bie.A(n.strokeWidth??sse),strokeMaterialProperty:new fie.A(n.stroke??rse),fillMaterialProperty:new fie.A(n.fill??ase),clampToGround:n.clampToGround??cse},Promise.resolve(r).then(function(t){return function(e,t,n,i,o){let r;(0,$9.A)(i)&&(r=Rne(i)),(0,$9.A)(r)&&e._name!==r&&(e._name=r,e._changed.raiseEvent(e));const s=fse[t.type];if(!(0,$9.A)(s))throw new qne.A(`Unsupported GeoJSON object type: ${t.type}`);const a=t.crs;let c=null!==a?Jre:null;if((0,$9.A)(a)){if(!(0,$9.A)(a.properties))throw new qne.A("crs.properties is undefined.");const e=a.properties;if("name"===a.type){if(c=Zre[e.name],!(0,$9.A)(c))throw new qne.A(`Unknown crs name: ${e.name}`)}else if("link"===a.type){let t=ese[e.href];if((0,$9.A)(t)||(t=tse[e.type]),!(0,$9.A)(t))throw new qne.A(`Unable to resolve crs link: ${JSON.stringify(e)}`);c=t(e)}else{if("EPSG"!==a.type)throw new qne.A(`Unknown crs type: ${a.type}`);if(c=Zre[`EPSG:${e.code}`],!(0,$9.A)(c))throw new qne.A(`Unknown crs EPSG code: ${e.code}`)}}return Promise.resolve(c).then(function(i){return o&&e._entityCollection.removeAll(),null!==i&&s(e,t,t,i,n),Promise.all(e._promises).then(function(){return e._promises.length=0,Cie.A.setLoading(e,!1),e})})}(e,t,n,s,i)}).catch(function(t){throw Cie.A.setLoading(e,!1),e._error.raiseEvent(e,t),t})}Pse.load=function(e,t){return(new Pse).load(e,t)},Object.defineProperties(Pse,{markerSize:{get:function(){return ise},set:function(e){ise=e}},markerSymbol:{get:function(){return nse},set:function(e){nse=e}},markerColor:{get:function(){return ose},set:function(e){ose=e}},stroke:{get:function(){return rse},set:function(e){rse=e}},strokeWidth:{get:function(){return sse},set:function(e){sse=e}},fill:{get:function(){return ase},set:function(e){ase=e}},clampToGround:{get:function(){return cse},set:function(e){cse=e}},crsNames:{get:function(){return Zre}},crsLinkHrefs:{get:function(){return ese}},crsLinkTypes:{get:function(){return tse}}}),Object.defineProperties(Pse.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{value:void 0,writable:!1},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!(0,$9.A)(e))throw new Q9.A("value must be defined.");this._entityCluster=e}},credit:{get:function(){return this._credit}}}),Pse.prototype.load=function(e,t){return Dse(this,e,t,!0)},Pse.prototype.process=function(e,t){return Dse(this,e,t,!1)},Pse.prototype.update=function(e){return!0};const Ose=Pse;var Rse=n(773643),Mse=n(138563),Lse=n(482546),Nse=n(559226),Bse=n(728065),Fse=n(586356),Use=n(822189),kse=n(884811);const Vse=4294967295,zse=65535,Hse=134695760,Gse=Hse,Wse=33639248,Yse=101075792,qse=22,jse=(new Date(2107,11,31),void new Date(1980,0,1)),Qse="undefined",Xse="function";let Kse=2;try{typeof navigator!=Qse&&navigator.hardwareConcurrency&&(Kse=navigator.hardwareConcurrency)}catch{}const $se={workerURI:"./core/web-worker-wasm.js",wasmURI:"./core/streams/zlib-wasm/zlib-streams.wasm",chunkSize:65536,maxWorkers:Kse,terminateWorkerTimeout:5e3,useWebWorkers:!0,useCompressionStream:!0,CompressionStream:typeof CompressionStream!=Qse&&CompressionStream,DecompressionStream:typeof DecompressionStream!=Qse&&DecompressionStream},Jse=Object.assign({},$se);function Zse(e){const{baseURI:t,chunkSize:n,maxWorkers:i,terminateWorkerTimeout:o,useCompressionStream:r,useWebWorkers:s,CompressionStream:a,DecompressionStream:c,CompressionStreamZlib:l,DecompressionStreamZlib:u,workerURI:d,wasmURI:h}=e;eae("baseURI",t),eae("wasmURI",h),eae("workerURI",d),eae("chunkSize",n),eae("maxWorkers",i),eae("terminateWorkerTimeout",o),eae("useCompressionStream",r),eae("useWebWorkers",s),eae("CompressionStream",a),eae("DecompressionStream",c),eae("CompressionStreamZlib",l),eae("DecompressionStreamZlib",u)}function eae(e,t){t!==jse&&(Jse[e]=t)}const tae=[];for(let e=0;e<256;e++){let t=e;for(let e=0;e<8;e++)1&t?t=t>>>1^3988292384:t>>>=1;tae[e]=t}class nae{constructor(e){this.crc=e||-1}append(e){let t=0|this.crc;for(let n=0,i=0|e.length;n<i;n++)t=t>>>8^tae[255&(t^e[n])];this.crc=t}get(){return~this.crc}}class iae extends TransformStream{constructor(){let e;const t=new nae;super({transform(e,n){t.append(e),n.enqueue(e)},flush(){const n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,t.get()),e.value=n}}),e=this}}const oae={concat(e,t){if(0===e.length||0===t.length)return e.concat(t);const n=e[e.length-1],i=oae.getPartial(n);return 32===i?e.concat(t):oae._shiftRight(t,i,0|n,e.slice(0,e.length-1))},bitLength(e){const t=e.length;if(0===t)return 0;const n=e[t-1];return 32*(t-1)+oae.getPartial(n)},clamp(e,t){if(32*e.length<t)return e;const n=(e=e.slice(0,Math.ceil(t/32))).length;return t&=31,n>0&&t&&(e[n-1]=oae.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:(e,t,n)=>32===e?t:(n?0|t:t<<32-e)+1099511627776*e,getPartial:e=>Math.round(e/1099511627776)||32,_shiftRight(e,t,n,i){for(void 0===i&&(i=[]);t>=32;t-=32)i.push(n),n=0;if(0===t)return i.concat(e);for(let o=0;o<e.length;o++)i.push(n|e[o]>>>t),n=e[o]<<32-t;const o=e.length?e[e.length-1]:0,r=oae.getPartial(o);return i.push(oae.partial(t+r&31,t+r>32?n:i.pop(),1)),i}},rae={bytes:{fromBits(e){const t=oae.bitLength(e)/8,n=new Uint8Array(t);let i;for(let o=0;o<t;o++)3&o||(i=e[o/4]),n[o]=i>>>24,i<<=8;return n},toBits(e){const t=[];let n,i=0;for(n=0;n<e.length;n++)i=i<<8|e[n],3&~n||(t.push(i),i=0);return 3&n&&t.push(oae.partial(8*(3&n),i)),t}}},sae=class{constructor(e){const t=this;t.blockSize=512,t._init=[1732584193,4023233417,2562383102,271733878,3285377520],t._key=[1518500249,1859775393,2400959708,3395469782],e?(t._h=e._h.slice(0),t._buffer=e._buffer.slice(0),t._length=e._length):t.reset()}reset(){const e=this;return e._h=e._init.slice(0),e._buffer=[],e._length=0,e}update(e){const t=this;"string"==typeof e&&(e=rae.utf8String.toBits(e));const n=t._buffer=oae.concat(t._buffer,e),i=t._length,o=t._length=i+oae.bitLength(e);if(o>9007199254740991)throw new Error("Cannot hash more than 2^53 - 1 bits");const r=new Uint32Array(n);let s=0;for(let e=t.blockSize+i-(t.blockSize+i&t.blockSize-1);e<=o;e+=t.blockSize)t._block(r.subarray(16*s,16*(s+1))),s+=1;return n.splice(0,16*s),t}finalize(){const e=this;let t=e._buffer;const n=e._h;t=oae.concat(t,[oae.partial(1,1)]);for(let e=t.length+2;15&e;e++)t.push(0);for(t.push(Math.floor(e._length/4294967296)),t.push(0|e._length);t.length;)e._block(t.splice(0,16));return e.reset(),n}_f(e,t,n,i){return e<=19?t&n|~t&i:e<=39?t^n^i:e<=59?t&n|t&i|n&i:e<=79?t^n^i:void 0}_S(e,t){return t<<e|t>>>32-e}_block(e){const t=this,n=t._h,i=Array(80);for(let t=0;t<16;t++)i[t]=e[t];let o=n[0],r=n[1],s=n[2],a=n[3],c=n[4];for(let e=0;e<=79;e++){e>=16&&(i[e]=t._S(1,i[e-3]^i[e-8]^i[e-14]^i[e-16]));const n=t._S(5,o)+t._f(e,r,s,a)+c+i[e]+t._key[Math.floor(e/20)]|0;c=a,a=s,s=t._S(30,r),r=o,o=n}n[0]=n[0]+o|0,n[1]=n[1]+r|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+c|0}},aae=class{constructor(e){const t=this;t._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],t._tables[0][0][0]||t._precompute();const n=t._tables[0][4],i=t._tables[1],o=e.length;let r,s,a,c=1;if(4!==o&&6!==o&&8!==o)throw new Error("invalid aes key size");for(t._key=[s=e.slice(0),a=[]],r=o;r<4*o+28;r++){let e=s[r-1];(r%o===0||8===o&&r%o===4)&&(e=n[e>>>24]<<24^n[e>>16&255]<<16^n[e>>8&255]<<8^n[255&e],r%o===0&&(e=e<<8^e>>>24^c<<24,c=c<<1^283*(c>>7))),s[r]=s[r-o]^e}for(let e=0;r;e++,r--){const t=s[3&e?r:r-4];a[e]=r<=4||e<4?t:i[0][n[t>>>24]]^i[1][n[t>>16&255]]^i[2][n[t>>8&255]]^i[3][n[255&t]]}}encrypt(e){return this._crypt(e,0)}decrypt(e){return this._crypt(e,1)}_precompute(){const e=this._tables[0],t=this._tables[1],n=e[4],i=t[4],o=[],r=[];let s,a,c,l;for(let e=0;e<256;e++)r[(o[e]=e<<1^283*(e>>7))^e]=e;for(let u=s=0;!n[u];u^=a||1,s=r[s]||1){let r=s^s<<1^s<<2^s<<3^s<<4;r=r>>8^255&r^99,n[u]=r,i[r]=u,l=o[c=o[a=o[u]]];let d=16843009*l^65537*c^257*a^16843008*u,h=257*o[r]^16843008*r;for(let n=0;n<4;n++)e[n][u]=h=h<<24^h>>>8,t[n][r]=d=d<<24^d>>>8}for(let n=0;n<5;n++)e[n]=e[n].slice(0),t[n]=t[n].slice(0)}_crypt(e,t){if(4!==e.length)throw new Error("invalid aes block size");const n=this._key[t],i=n.length/4-2,o=[0,0,0,0],r=this._tables[t],s=r[0],a=r[1],c=r[2],l=r[3],u=r[4];let d,h,A,p=e[0]^n[0],f=e[t?3:1]^n[1],m=e[2]^n[2],g=e[t?1:3]^n[3],_=4;for(let e=0;e<i;e++)d=s[p>>>24]^a[f>>16&255]^c[m>>8&255]^l[255&g]^n[_],h=s[f>>>24]^a[m>>16&255]^c[g>>8&255]^l[255&p]^n[_+1],A=s[m>>>24]^a[g>>16&255]^c[p>>8&255]^l[255&f]^n[_+2],g=s[g>>>24]^a[p>>16&255]^c[f>>8&255]^l[255&m]^n[_+3],_+=4,p=d,f=h,m=A;for(let e=0;e<4;e++)o[t?3&-e:e]=u[p>>>24]<<24^u[f>>16&255]<<16^u[m>>8&255]<<8^u[255&g]^n[_++],d=p,p=f,f=m,m=g,g=d;return o}},cae={getRandomValues(e){const t=new Uint32Array(e.buffer),n=e=>{let t=987654321;const n=4294967295;return function(){return t=36969*(65535&t)+(t>>16)&n,(((t<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n)/4294967296+.5)*(Math.random()>.5?1:-1)}};for(let i,o=0;o<e.length;o+=4){const e=n(4294967296*(i||Math.random()));i=987654071*e(),t[o/4]=4294967296*e()|0}return e}},lae=class{constructor(e,t){this._prf=e,this._initIv=t,this._iv=t}reset(){this._iv=this._initIv}update(e){return this.calculate(this._prf,e,this._iv)}incWord(e){if(255&~(e>>24))e+=1<<24;else{let t=e>>16&255,n=e>>8&255,i=255&e;255===t?(t=0,255===n?(n=0,255===i?i=0:++i):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=i}return e}incCounter(e){0===(e[0]=this.incWord(e[0]))&&(e[1]=this.incWord(e[1]))}calculate(e,t,n){let i;if(!(i=t.length))return[];const o=oae.bitLength(t);for(let o=0;o<i;o+=4){this.incCounter(n);const i=e.encrypt(n);t[o]^=i[0],t[o+1]^=i[1],t[o+2]^=i[2],t[o+3]^=i[3]}return oae.clamp(t,o)}},uae={importKey:e=>new uae.hmacSha1(rae.bytes.toBits(e)),pbkdf2(e,t,n,i){if(n=n||1e4,i<0||n<0)throw new Error("invalid params to pbkdf2");const o=1+(i>>5)<<2;let r,s,a,c,l;const u=new ArrayBuffer(o),d=new DataView(u);let h=0;const A=oae;for(t=rae.bytes.toBits(t),l=1;h<(o||1);l++){for(r=s=e.encrypt(A.concat(t,[l])),a=1;a<n;a++)for(s=e.encrypt(s),c=0;c<s.length;c++)r[c]^=s[c];for(a=0;h<(o||1)&&a<r.length;a++)d.setInt32(h,r[a]),h+=4}return u.slice(0,i/8)},hmacSha1:class{constructor(e){const t=this,n=t._hash=sae,i=[[],[]];t._baseHash=[new n,new n];const o=t._baseHash[0].blockSize/32;e.length>o&&(e=(new n).update(e).finalize());for(let t=0;t<o;t++)i[0][t]=909522486^e[t],i[1][t]=1549556828^e[t];t._baseHash[0].update(i[0]),t._baseHash[1].update(i[1]),t._resultHash=new n(t._baseHash[0])}reset(){const e=this;e._resultHash=new e._hash(e._baseHash[0]),e._updated=!1}update(e){this._updated=!0,this._resultHash.update(e)}digest(){const e=this,t=e._resultHash.finalize(),n=new e._hash(e._baseHash[1]).update(t).finalize();return e.reset(),n}encrypt(e){if(this._updated)throw new Error("encrypt on already updated hmac called!");return this.update(e),this.digest(e)}}},dae=typeof crypto!=Qse&&typeof crypto.getRandomValues==Xse,hae="Invalid password",Aae="Invalid signature",pae="zipjs-abort-check-password";function fae(e){return dae?crypto.getRandomValues(e):cae.getRandomValues(e)}const mae=16,gae={name:"PBKDF2"},_ae=Object.assign({hash:{name:"HMAC"}},gae),yae=Object.assign({iterations:1e3,hash:{name:"SHA-1"}},gae),vae=["deriveBits"],Tae=[8,12,16],bae=[16,24,32],wae=10,xae=[0,0,0,0],Cae=typeof crypto!=Qse,Eae=Cae&&crypto.subtle,Sae=Cae&&typeof Eae!=Qse,Iae=rae.bytes,Pae=aae,Dae=lae,Oae=uae.hmacSha1;let Rae=Cae&&Sae&&typeof Eae.importKey==Xse,Mae=Cae&&Sae&&typeof Eae.deriveBits==Xse;class Lae extends TransformStream{constructor({password:e,rawPassword:t,signed:n,encryptionStrength:i,checkPasswordOnly:o}){super({start(){Object.assign(this,{ready:new Promise(e=>this.resolveReady=e),password:Uae(e,t),signed:n,strength:i-1,pending:new Uint8Array})},async transform(e,t){const n=this,{password:i,strength:r,resolveReady:s,ready:a}=n;i?(await async function(e,t,n,i){const o=await Fae(e,t,n,Vae(i,0,Tae[t])),r=Vae(i,Tae[t]);if(o[0]!=r[0]||o[1]!=r[1])throw new Error(hae)}(n,r,i,Vae(e,0,Tae[r]+2)),e=Vae(e,Tae[r]+2),o?t.error(new Error(pae)):s()):await a;const c=new Uint8Array(e.length-wae-(e.length-wae)%mae);t.enqueue(Bae(n,e,c,0,wae,!0))},async flush(e){const{signed:t,ctr:n,hmac:i,pending:o,ready:r}=this;if(i&&n){await r;const s=Vae(o,0,o.length-wae),a=Vae(o,o.length-wae);let c=new Uint8Array;if(s.length){const e=Hae(Iae,s);i.update(e);const t=n.update(e);c=zae(Iae,t)}if(t){const e=Vae(zae(Iae,i.digest()),0,wae);for(let t=0;t<wae;t++)if(e[t]!=a[t])throw new Error(Aae)}e.enqueue(c)}}})}}class Nae extends TransformStream{constructor({password:e,rawPassword:t,encryptionStrength:n}){let i;super({start(){Object.assign(this,{ready:new Promise(e=>this.resolveReady=e),password:Uae(e,t),strength:n-1,pending:new Uint8Array})},async transform(e,t){const n=this,{password:i,strength:o,resolveReady:r,ready:s}=n;let a=new Uint8Array;i?(a=await async function(e,t,n){const i=fae(new Uint8Array(Tae[t]));return kae(i,await Fae(e,t,n,i))}(n,o,i),r()):await s;const c=new Uint8Array(a.length+e.length-e.length%mae);c.set(a,0),t.enqueue(Bae(n,e,c,a.length,0))},async flush(e){const{ctr:t,hmac:n,pending:o,ready:r}=this;if(n&&t){await r;let s=new Uint8Array;if(o.length){const e=t.update(Hae(Iae,o));n.update(e),s=zae(Iae,e)}i.signature=zae(Iae,n.digest()).slice(0,wae),e.enqueue(kae(s,i.signature))}}}),i=this}}function Bae(e,t,n,i,o,r){const{ctr:s,hmac:a,pending:c}=e,l=t.length-o;let u;for(c.length&&(t=kae(c,t),n=function(e,t){if(t&&t>e.length){const n=e;(e=new Uint8Array(t)).set(n,0)}return e}(n,l-l%mae)),u=0;u<=l-mae;u+=mae){const e=Hae(Iae,Vae(t,u,u+mae));r&&a.update(e);const o=s.update(e);r||a.update(o),n.set(zae(Iae,o),u+i)}return e.pending=Vae(t,u),n}async function Fae(e,t,n,i){e.password=null;const o=await async function(e,t,n,i,o){if(!Rae)return uae.importKey(t);try{return await Eae.importKey("raw",t,n,!1,o)}catch{return Rae=!1,uae.importKey(t)}}(0,n,_ae,0,vae),r=await async function(e,t,n){if(!Mae)return uae.pbkdf2(t,e.salt,yae.iterations,n);try{return await Eae.deriveBits(e,t,n)}catch{return Mae=!1,uae.pbkdf2(t,e.salt,yae.iterations,n)}}(Object.assign({salt:i},yae),o,8*(2*bae[t]+2)),s=new Uint8Array(r),a=Hae(Iae,Vae(s,0,bae[t])),c=Hae(Iae,Vae(s,bae[t],2*bae[t])),l=Vae(s,2*bae[t]);return Object.assign(e,{keys:{key:a,authentication:c,passwordVerification:l},ctr:new Dae(new Pae(a),Array.from(xae)),hmac:new Oae(c)}),l}function Uae(e,t){return t===jse?function(e){if(typeof TextEncoder==Qse){e=unescape(encodeURIComponent(e));const t=new Uint8Array(e.length);for(let n=0;n<t.length;n++)t[n]=e.charCodeAt(n);return t}return(new TextEncoder).encode(e)}(e):t}function kae(e,t){let n=e;return e.length+t.length&&(n=new Uint8Array(e.length+t.length),n.set(e,0),n.set(t,e.length)),n}function Vae(e,t,n){return e.subarray(t,n)}function zae(e,t){return e.fromBits(t)}function Hae(e,t){return e.toBits(t)}class Gae extends TransformStream{constructor({password:e,passwordVerification:t,checkPasswordOnly:n}){super({start(){Object.assign(this,{password:e,passwordVerification:t}),jae(this,e)},transform(e,t){const i=this;if(i.password){const t=Yae(i,e.subarray(0,12));if(i.password=null,t.at(-1)!=i.passwordVerification)throw new Error(hae);e=e.subarray(12)}n?t.error(new Error(pae)):t.enqueue(Yae(i,e))}})}}class Wae extends TransformStream{constructor({password:e,passwordVerification:t}){super({start(){Object.assign(this,{password:e,passwordVerification:t}),jae(this,e)},transform(e,t){const n=this;let i,o;if(n.password){n.password=null;const t=fae(new Uint8Array(12));t[11]=n.passwordVerification,i=new Uint8Array(e.length+t.length),i.set(qae(n,t),0),o=12}else i=new Uint8Array(e.length),o=0;i.set(qae(n,e),o),t.enqueue(i)}})}}function Yae(e,t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=Xae(e)^t[i],Qae(e,n[i]);return n}function qae(e,t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=Xae(e)^t[i],Qae(e,t[i]);return n}function jae(e,t){const n=[305419896,591751049,878082192];Object.assign(e,{keys:n,crcKey0:new nae(n[0]),crcKey2:new nae(n[2])});for(let n=0;n<t.length;n++)Qae(e,t.charCodeAt(n))}function Qae(e,t){let[n,i,o]=e.keys;e.crcKey0.append([t]),n=~e.crcKey0.get(),i=$ae(Math.imul($ae(i+Kae(n)),134775813)+1),e.crcKey2.append([i>>>24]),o=~e.crcKey2.get(),e.keys=[n,i,o]}function Xae(e){const t=2|e.keys[2];return Kae(Math.imul(t,1^t)>>>8)}function Kae(e){return 255&e}function $ae(e){return 4294967295&e}const Jae="Invalid uncompressed size";class Zae extends TransformStream{constructor(e,{chunkSize:t,CompressionStreamZlib:n,CompressionStream:i}){super({});const{compressed:o,encrypted:r,useCompressionStream:s,zipCrypto:a,signed:c,level:l}=e,u=this;let d,h,A=super.readable;r&&!a||!c||(d=new iae,A=ice(A,d)),o&&(A=nce(A,s,{level:l,chunkSize:t},i,n,i)),r&&(a?A=ice(A,new Wae(e)):(h=new Nae(e),A=ice(A,h))),tce(u,A,()=>{let e;r&&!a&&(e=h.signature),r&&!a||!c||(e=new DataView(d.value.buffer).getUint32(0)),u.signature=e})}}class ece extends TransformStream{constructor(e,{chunkSize:t,DecompressionStreamZlib:n,DecompressionStream:i}){super({});const{zipCrypto:o,encrypted:r,signed:s,signature:a,compressed:c,useCompressionStream:l,deflate64:u}=e;let d,h,A=super.readable;r&&(o?A=ice(A,new Gae(e)):(h=new Lae(e),A=ice(A,h))),c&&(A=nce(A,l,{chunkSize:t,deflate64:u},i,n,i)),r&&!o||!s||(d=new iae,A=ice(A,d)),tce(this,A,()=>{if((!r||o)&&s){const e=new DataView(d.value.buffer);if(a!=e.getUint32(0,!1))throw new Error(Aae)}})}}function tce(e,t,n){t=ice(t,new TransformStream({flush:n})),Object.defineProperty(e,"readable",{get:()=>t})}function nce(e,t,n,i,o,r){const s=t&&i?i:o||r,a=n.deflate64?"deflate64-raw":"deflate-raw";try{e=ice(e,new s(a,n))}catch(i){if(!t)throw i;if(o)e=ice(e,new o(a,n));else{if(!r)throw i;e=ice(e,new r(a,n))}}return e}function ice(e,t){return e.pipeThrough(t)}const oce="data",rce="close",sce="inflate";class ace extends TransformStream{constructor(e,t){super({});const n=this,{codecType:i}=e;let o;i.startsWith("deflate")?o=Zae:i.startsWith(sce)&&(o=ece),n.outputSize=0;let r=0;const s=new o(e,t),a=super.readable,c=new TransformStream({transform(e,t){e&&e.length&&(r+=e.length,t.enqueue(e))},flush(){Object.assign(n,{inputSize:r})}}),l=new TransformStream({transform(t,i){if(t&&t.length&&(i.enqueue(t),n.outputSize+=t.length,e.outputSize!==jse&&n.outputSize>e.outputSize))throw new Error(Jae)},flush(){const{signature:e}=s;Object.assign(n,{signature:e,inputSize:r})}});Object.defineProperty(n,"readable",{get:()=>a.pipeThrough(c).pipeThrough(s).pipeThrough(l)})}}class cce extends TransformStream{constructor(e){let t;super({transform:function n(i,o){if(t){const e=new Uint8Array(t.length+i.length);e.set(t),e.set(i,t.length),i=e,t=null}i.length>e?(o.enqueue(i.slice(0,e)),n(i.slice(e),o)):t=i},flush(e){t&&t.length&&e.enqueue(t)}})}}let lce=typeof Worker!=Qse,uce=()=>{};class dce{constructor(e,{readable:t,writable:n},{options:i,config:o,streamOptions:r,useWebWorkers:s,transferStreams:a,workerURI:c},l){const{signal:u}=r;return Object.assign(e,{busy:!0,readable:t.pipeThrough(new cce(o.chunkSize)).pipeThrough(new hce(r),{signal:u}),writable:n,options:Object.assign({},i),workerURI:c,transferStreams:a,terminate:()=>new Promise(t=>{const{worker:n,busy:i}=e;n?(i?e.resolveTerminated=t:(n.terminate(),t()),e.interface=null):t()}),onTaskFinished(){const{resolveTerminated:t}=e;t&&(e.resolveTerminated=null,e.terminated=!0,e.worker.terminate(),t()),e.busy=!1,l(e)}}),(s&&lce?fce:pce)(e,o)}}class hce extends TransformStream{constructor({onstart:e,onprogress:t,size:n,onend:i}){let o=0;super({async start(){e&&await Ace(e,n)},async transform(e,i){o+=e.length,t&&await Ace(t,o,n),i.enqueue(e)},async flush(){i&&await Ace(i,o)}})}}async function Ace(e,...t){try{await e(...t)}catch{}}function pce(e,t){return{run:()=>async function({options:e,readable:t,writable:n,onTaskFinished:i},o){let r;try{if(!e.useCompressionStream)try{await uce(o)}catch{e.useCompressionStream=!0}r=new ace(e,o),await t.pipeThrough(r).pipeTo(n,{preventClose:!0,preventAbort:!0});const{signature:i,inputSize:s,outputSize:a}=r;return{signature:i,inputSize:s,outputSize:a}}catch(e){throw r&&(e.outputSize=r.outputSize),e}finally{i()}}(e,t)}}function fce(e,t){const{baseURI:n,chunkSize:i}=t;let{wasmURI:o}=t;if(!e.interface){let r;typeof o==Xse&&(o=o());try{r=function(e,t,n){const i={type:"module"};let o,r;if(typeof e==Xse&&(e=e()),e.startsWith("data:")||e.startsWith("blob:"))try{r=new Worker(e)}catch{r=new Worker(e,i)}else{try{o=new URL(e,t)}catch{o=e}r=new Worker(o,i)}return r.addEventListener("message",e=>async function({data:e},t){const{type:n,value:i,messageId:o,result:r,error:s}=e,{reader:a,writer:c,resolveResult:l,rejectResult:u,onTaskFinished:d}=t;try{if(s){const{message:e,stack:t,code:n,name:i,outputSize:o}=s,r=new Error(e);Object.assign(r,{stack:t,code:n,name:i,outputSize:o}),h(r)}else{if("pull"==n){const{value:e,done:n}=await a.read();gce({type:oce,value:e,done:n,messageId:o},t)}n==oce&&(await c.ready,await c.write(new Uint8Array(i)),gce({type:"ack",messageId:o},t)),n==rce&&h(null,r)}}catch(s){gce({type:rce,messageId:o},t),h(s)}function h(e,t){e?u(e):l(t),c&&c.releaseLock(),d()}}(e,n)),r}(e.workerURI,n,e)}catch{return lce=!1,pce(e,t)}Object.assign(e,{worker:r,interface:{run:()=>async function(e,t){let n,i;const o=new Promise((e,t)=>{n=e,i=t});Object.assign(e,{reader:null,writer:null,resolveResult:n,rejectResult:i,result:o});const{readable:r,options:s}=e,{writable:a,closed:c}=function(e){let t;const n=new Promise(e=>t=e);return{writable:new WritableStream({async write(t){const n=e.getWriter();await n.ready,await n.write(t),n.releaseLock()},close(){t()},abort:t=>e.getWriter().abort(t)}),closed:n}}(e.writable),l=gce({type:"start",options:s,config:t,readable:r,writable:a},e);l||Object.assign(e,{reader:r.getReader(),writer:a.getWriter()});const u=await o;return l||await a.getWriter().close(),await c,u}(e,{chunkSize:i,wasmURI:o,baseURI:n})}})}return e.interface}let mce=!0;function gce(e,{worker:t,writer:n,onTaskFinished:i,transferStreams:o}){try{const{value:n,readable:i,writable:r}=e,s=[];if(n&&(e.value=n,s.push(e.value.buffer)),o&&mce?(i&&s.push(i),r&&s.push(r)):e.readable=e.writable=null,s.length)try{return t.postMessage(e,s),!0}catch{mce=!1,e.readable=e.writable=null,t.postMessage(e)}else t.postMessage(e)}catch(e){throw n&&n.releaseLock(),i(),e}}let _ce=[];const yce=[];let vce=0;function Tce(e){const{terminateTimeout:t}=e;t&&(clearTimeout(t),e.terminateTimeout=null)}const bce=65536,wce="writable";class xce{constructor(){this.size=0}init(){this.initialized=!0}}class Cce extends xce{get readable(){const e=this,{chunkSize:t=bce}=e,n=new ReadableStream({start(){this.chunkOffset=0},async pull(i){const{offset:o=0,size:r,diskNumberStart:s}=n,{chunkOffset:a}=this,c=r===jse?t:Math.min(t,r-a),l=await Bce(e,o+a,c,s);i.enqueue(l),a+t>r||r===jse&&!l.length&&c?i.close():this.chunkOffset+=t}});return n}}class Ece extends xce{constructor(){super();const e=this,t=new WritableStream({write(t){if(!e.initialized)throw new Error("Writer not initialized");return e.writeUint8Array(t)}});Object.defineProperty(e,wce,{get:()=>t})}writeUint8Array(){}}class Sce extends Ece{constructor(e){super(),Object.assign(this,{data:"data:"+(e||"")+";base64,",pending:[]})}writeUint8Array(e){const t=this;let n=0,i=t.pending;const o=t.pending.length;for(t.pending="",n=0;n<3*Math.floor((o+e.length)/3)-o;n++)i+=String.fromCharCode(e[n]);for(;n<e.length;n++)t.pending+=String.fromCharCode(e[n]);i.length&&(i.length>2?t.data+=btoa(i):t.pending+=i)}getData(){return this.data+btoa(this.pending)}}class Ice extends Cce{constructor(e){super(),Object.assign(this,{blob:e,size:e.size})}async readUint8Array(e,t){const n=this,i=e+t,o=e||i<n.size?n.blob.slice(e,i):n.blob;let r=await o.arrayBuffer();return r.byteLength>t&&(r=r.slice(e,i)),new Uint8Array(r)}}class Pce extends xce{constructor(e){super();const t=new TransformStream,n=[];e&&n.push(["Content-Type",e]),Object.defineProperty(this,wce,{get:()=>t.writable}),this.blob=new Response(t.readable,{headers:n}).blob()}getData(){return this.blob}}class Dce extends Pce{constructor(e){super(e),Object.assign(this,{encoding:e,utf8:!e||"utf-8"==e.toLowerCase()})}async getData(){const{encoding:e,utf8:t}=this,n=await super.getData();if(n.text&&t)return n.text();{const t=new FileReader;return new Promise((i,o)=>{Object.assign(t,{onload:({target:e})=>i(e.result),onerror:()=>o(t.error)}),t.readAsText(n,e)})}}}class Oce extends Cce{constructor(e){super(),this.readers=e}async init(){const e=this,{readers:t}=e;e.lastDiskNumber=0,e.lastDiskOffset=0,await Promise.all(t.map(async(n,i)=>{await n.init(),i!=t.length-1&&(e.lastDiskOffset+=n.size),e.size+=n.size})),super.init()}async readUint8Array(e,t,n=0){const i=this,{readers:o}=this;let r,s=n;-1==s&&(s=o.length-1);let a=e;for(;o[s]&&a>=o[s].size;)a-=o[s].size,s++;const c=o[s];if(c){const o=c.size;if(a+t<=o)r=await Bce(c,a,t);else{const s=o-a;r=new Uint8Array(t);const l=await Bce(c,a,s);r.set(l,0);const u=await i.readUint8Array(e+s,t-s,n);r.set(u,s),l.length+u.length<t&&(r=r.subarray(0,l.length+u.length))}}else r=new Uint8Array;return i.lastDiskNumber=Math.max(s,i.lastDiskNumber),r}}class Rce extends xce{constructor(e,t=4294967295){super();const n=this;let i,o,r;Object.assign(n,{diskNumber:0,diskOffset:0,size:0,maxSize:t,availableSize:t});const s=new WritableStream({async write(t){const{availableSize:s}=n;if(r)t.length>=s?(await a(t.subarray(0,s)),await c(),n.diskOffset+=i.size,n.diskNumber++,r=null,await this.write(t.subarray(s))):await a(t);else{const{value:s,done:a}=await e.next();if(a&&!s)throw new Error("Writer iterator completed too soon");i=s,i.size=0,i.maxSize&&(n.maxSize=i.maxSize),n.availableSize=n.maxSize,await Nce(i),o=s.writable,r=o.getWriter(),await this.write(t)}},async close(){await r.ready,await c()}});async function a(e){const t=e.length;t&&(await r.ready,await r.write(e),i.size+=t,n.size+=t,n.availableSize-=t)}async function c(){await r.close()}Object.defineProperty(n,wce,{get:()=>s})}}class Mce{constructor(e){return Array.isArray(e)&&(e=new Oce(e)),e instanceof ReadableStream&&(e={readable:e}),e}}class Lce{constructor(e){return e.writable===jse&&typeof e.next==Xse&&(e=new Rce(e)),e instanceof WritableStream&&(e={writable:e}),e.size===jse&&(e.size=0),e instanceof Rce||Object.assign(e,{diskNumber:0,diskOffset:0,availableSize:1/0,maxSize:1/0}),e}}async function Nce(e,t){if(!e.init||e.initialized)return Promise.resolve();await e.init(t)}function Bce(e,t,n,i){return e.readUint8Array(t,n,i)}const Fce="\0☺☻♥♦♣♠•◘○◙♂♀♪♫☼►◄↕‼¶§▬↨↑↓→←∟↔▲▼ !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~⌂ÇüéâäàåçêëèïîìÄÅÉæÆôöòûùÿÖÜ¢£¥₧ƒáíóúñÑªº¿⌐¬½¼¡«»░▒▓│┤╡╢╖╕╣║╗╝╜╛┐└┴┬├─┼╞╟╚╔╩╦╠═╬╧╨╤╥╙╘╒╓╫╪┘┌█▄▌▐▀αßΓπΣσµτΦΘΩδ∞φε∩≡±≥≤⌠⌡÷≈°∙·√ⁿ²■ ".split(""),Uce=256==Fce.length;function kce(e,t){return t&&"cp437"==t.trim().toLowerCase()?function(e){if(Uce){let t="";for(let n=0;n<e.length;n++)t+=Fce[e[n]];return t}return(new TextDecoder).decode(e)}(e):new TextDecoder(t).decode(e)}const Vce="filename",zce="rawFilename",Hce="comment",Gce="rawComment",Wce="uncompressedSize",Yce="compressedSize",qce="offset",jce="diskNumberStart",Qce="lastModDate",Xce="rawLastModDate",Kce="lastAccessDate",$ce="creationDate",Jce=[Vce,zce,Yce,Wce,Qce,Xce,Hce,Gce,Kce,$ce,qce,jce,jce,"internalFileAttributes","externalFileAttributes","msDosCompatible","zip64","encrypted","version","versionMadeBy","zipCrypto","directory","executable","compressionMethod","signature","extraField","bitFlag","filenameUTF8","commentUTF8","rawExtraField","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","extraFieldNTFS","extraFieldExtendedTimestamp"];class Zce{constructor(e){Jce.forEach(t=>this[t]=e[t])}}const ele="File format is not recognized",tle="Compression method not supported",nle="Split zip file",ile="utf-8",ole="cp437",rle=[[Wce,Vse],[Yce,Vse],[qce,Vse],[jce,zse]],sle={[zse]:{getValue:gle,bytes:4},[Vse]:{getValue:_le,bytes:8}};class ale{constructor(e,t={}){Object.assign(this,{reader:new Mce(e),options:t,config:Jse,readRanges:[]})}async*getEntriesGenerator(e={}){const t=this;let{reader:n}=t;const{config:i}=t;if(await Nce(n),n.size!==jse&&n.readUint8Array||(n=new Ice(await new Response(n.readable).blob()),await Nce(n)),n.size<qse)throw new Error(ele);n.chunkSize=function(e){return Math.max(e.chunkSize,64)}(i);const o=await async function(e,t,n){const i=new Uint8Array(4);var o,r;o=yle(i),r=101010256,o.setUint32(0,r,!0);return await s(22)||await s(Math.min(1048582,n));async function s(t){const o=n-t,r=await Bce(e,o,t);for(let e=r.length-22;e>=0;e--)if(r[e]==i[0]&&r[e+1]==i[1]&&r[e+2]==i[2]&&r[e+3]==i[3])return{offset:o+e,buffer:r.slice(e,e+22).buffer}}}(n,0,n.size);if(!o)throw gle(yle(await Bce(n,0,4)))==Hse?new Error(nle):new Error("End of central directory not found");const r=yle(o);let s=gle(r,12),a=gle(r,16);const c=o.offset,l=mle(r,20),u=c+qse+l;let d=mle(r,4);const h=n.lastDiskNumber||0;let A=mle(r,6),p=mle(r,8),f=0,m=0;if(a==Vse||s==Vse||p==zse||A==zse){const e=yle(await Bce(n,o.offset-20,20));if(117853008==gle(e,0)){a=_le(e,8);let t=await Bce(n,a,56,-1),i=yle(t);const r=o.offset-20-56;if(gle(i,0)!=Yse&&a!=r){const e=a;a=r,a>e&&(f=a-e),t=await Bce(n,a,56,-1),i=yle(t)}if(gle(i,0)!=Yse)throw new Error("End of Zip64 central directory locator not found");d==zse&&(d=gle(i,16)),A==zse&&(A=gle(i,20)),p==zse&&(p=_le(i,32)),s==Vse&&(s=_le(i,40)),a-=s}}if(a>=n.size&&(f=n.size-a-s-qse,a=n.size-s-qse),h!=d)throw new Error(nle);if(a<0)throw new Error(ele);let g=0,_=await Bce(n,a,s,A),y=yle(_);if(s){const e=o.offset-s;if(gle(y,g)!=Wse&&a!=e){const t=a;a=e,a>t&&(f+=a-t),_=await Bce(n,a,s,A),y=yle(_)}}const v=o.offset-a-(n.lastDiskOffset||0);if(s!=v&&v>=0&&(s=v,_=await Bce(n,a,s,A),y=yle(_)),a<0||a>=n.size)throw new Error(ele);const T=hle(t,e,"filenameEncoding"),b=hle(t,e,"commentEncoding");for(let o=0;o<p;o++){const r=new cle(n,i,t.options);if(gle(y,g)!=Wse)throw new Error("Central directory header not found");lle(r,y,g+6);const s=Boolean(r.bitFlag.languageEncodingFlag),a=g+46,c=a+r.filenameLength,l=c+r.extraFieldLength,u=mle(y,g+4),d=!(u>>8),h=u>>8==3,A=_.subarray(a,c),v=mle(y,g+32),w=l+v,x=_.subarray(l,w),C=s,E=s,S=gle(y,g+38),I=d&&!(16&~fle(y,g+38))||h&&16384==(S>>16&61440)||A.length&&A.at(-1)=="/".charCodeAt(0),P=h&&!!(S>>16&73),D=gle(y,g+42)+f;Object.assign(r,{versionMadeBy:u,msDosCompatible:d,compressedSize:0,uncompressedSize:0,commentLength:v,directory:I,offset:D,diskNumberStart:mle(y,g+34),internalFileAttributes:mle(y,g+36),externalFileAttributes:S,rawFilename:A,filenameUTF8:C,commentUTF8:E,rawExtraField:_.subarray(c,l),executable:P}),r.internalFileAttribute=r.internalFileAttributes,r.externalFileAttribute=r.externalFileAttributes;const O=hle(t,e,"decodeText")||kce,R=C?ile:T||ole,M=E?ile:b||ole;let L=O(A,R);L===jse&&(L=kce(A,R));let N=O(x,M);N===jse&&(N=kce(x,M)),Object.assign(r,{rawComment:x,filename:L,comment:N,directory:I||L.endsWith("/")}),m=Math.max(D,m),ule(r,r,y,g+6),r.zipCrypto=r.encrypted&&!r.extraFieldAES;const B=new Zce(r);B.getData=(e,n)=>r.getData(e,B,t.readRanges,n),B.arrayBuffer=async e=>{const n=new TransformStream,[i]=await Promise.all([new Response(n.readable).arrayBuffer(),r.getData(n,B,t.readRanges,e)]);return i},g=w;const{onprogress:F}=e;if(F)try{await F(o+1,p,new Zce(r))}catch{}yield B}const w=hle(t,e,"extractPrependedData"),x=hle(t,e,"extractAppendedData");return w&&(t.prependedData=m>0?await Bce(n,0,m):new Uint8Array),t.comment=l?await Bce(n,c+qse,l):new Uint8Array,x&&(t.appendedData=u<n.size?await Bce(n,u,n.size-u):new Uint8Array),!0}async getEntries(e={}){const t=[];for await(const n of this.getEntriesGenerator(e))t.push(n);return t}async close(){}}class cle{constructor(e,t,n){Object.assign(this,{reader:e,config:t,options:n})}async getData(e,t,n,i={}){const o=this,{reader:r,offset:s,diskNumberStart:a,extraFieldAES:c,extraFieldZip64:l,compressionMethod:u,config:d,bitFlag:h,signature:A,rawLastModDate:p,uncompressedSize:f,compressedSize:m}=o,{dataDescriptor:g}=h,_=t.localDirectory={},y=yle(await Bce(r,s,30,a));let v=hle(o,i,"password"),T=hle(o,i,"rawPassword");const b=hle(o,i,"passThrough");if(v=v&&v.length&&v,T=T&&T.length&&T,c&&99!=c.originalCompressionMethod)throw new Error(tle);if(0!=u&&8!=u&&9!=u&&!b)throw new Error(tle);if(67324752!=gle(y,0))throw new Error("Local file header not found");lle(_,y,4);const{extraFieldLength:w,filenameLength:x,lastAccessDate:C,creationDate:E}=_;_.rawExtraField=w?await Bce(r,s+30+x,w,a):new Uint8Array,ule(o,_,y,4,!0),Object.assign(t,{lastAccessDate:C,creationDate:E});const S=o.encrypted&&_.encrypted&&!b,I=S&&!c;if(b||(t.zipCrypto=I),S){if(!I&&c.strength===jse)throw new Error("Encryption method not supported");if(!v&&!T)throw new Error("File contains encrypted entry")}const P=s+30+x+w,D=m,O=r.readable;Object.assign(O,{diskNumberStart:a,offset:P,size:D});const R=hle(o,i,"signal"),M=hle(o,i,"checkPasswordOnly");let L=hle(o,i,"checkOverlappingEntry");const N=hle(o,i,"checkOverlappingEntryOnly");N&&(L=!0);const{onstart:B,onprogress:F,onend:U}=i,k=9==u;let V=hle(o,i,"useCompressionStream");k&&(V=!1);const z={options:{codecType:sce,password:v,rawPassword:T,zipCrypto:I,encryptionStrength:c&&c.strength,signed:hle(o,i,"checkSignature")&&!b,passwordVerification:I&&(g?p>>>8&255:A>>>24&255),outputSize:b?m:f,signature:A,compressed:0!=u&&!b,encrypted:o.encrypted&&!b,useWebWorkers:hle(o,i,"useWebWorkers"),useCompressionStream:V,transferStreams:hle(o,i,"transferStreams"),deflate64:k,checkPasswordOnly:M},config:d,streamOptions:{signal:R,size:D,onstart:B,onprogress:F,onend:U}};let H;L&&await async function({reader:e,fileEntry:t,offset:n,diskNumberStart:i,signature:o,compressedSize:r,uncompressedSize:s,dataOffset:a,dataDescriptor:c,extraFieldZip64:l,readRanges:u}){let d=0;if(i)for(let t=0;t<i;t++)d+=e.readers[t].size;let h=0;if(c&&(h=l?20:12),h){const n=await Bce(e,a+r,h+4,i);if(gle(yle(n),0)==Gse){const e=gle(yle(n),4);let i,a;l?(i=_le(yle(n),8),a=_le(yle(n),16)):(i=gle(yle(n),8),a=gle(yle(n),12)),(t.encrypted&&!t.zipCrypto||e==o)&&i==r&&a==s&&(h+=4)}}const A={start:d+n,end:d+a+r+h,fileEntry:t};for(const e of u)if(e.fileEntry!=t&&A.start>=e.start&&A.start<e.end){const t=new Error("Overlapping entry found");throw t.overlappingEntry=e.fileEntry,t}u.push(A)}({reader:r,fileEntry:t,offset:s,diskNumberStart:a,signature:A,compressedSize:m,uncompressedSize:f,dataOffset:P,dataDescriptor:g||_.bitFlag.dataDescriptor,extraFieldZip64:l||_.extraFieldZip64,readRanges:n});try{if(!N){M&&(e=new WritableStream),e=new Lce(e),await Nce(e,b?m:f),({writable:H}=e);const{outputSize:t}=await async function(e,t){const{options:n,config:i}=t,{transferStreams:o,useWebWorkers:r,useCompressionStream:s,compressed:a,signed:c,encrypted:l}=n,{workerURI:u,maxWorkers:d}=i;t.transferStreams=o||o===jse;const h=!(a||c||l||t.transferStreams);return t.useWebWorkers=!h&&(r||r===jse&&i.useWebWorkers),t.workerURI=t.useWebWorkers&&u?u:jse,n.useCompressionStream=s||s===jse&&i.useCompressionStream,(await async function(){const n=_ce.find(e=>!e.busy);if(n)return Tce(n),new dce(n,e,t,A);if(_ce.length<d){const n={indexWorker:vce};return vce++,_ce.push(n),new dce(n,e,t,A)}return new Promise(n=>yce.push({resolve:n,stream:e,workerOptions:t}))}()).run();function A(e){if(yce.length){const[{resolve:t,stream:n,workerOptions:i}]=yce.splice(0,1);t(new dce(e,n,i,A))}else e.worker?(Tce(e),function(e,t){const{config:n}=t,{terminateWorkerTimeout:i}=n;Number.isFinite(i)&&i>=0&&(e.terminated?e.terminated=!1:e.terminateTimeout=setTimeout(async()=>{_ce=_ce.filter(t=>t!=e);try{await e.terminate()}catch{}},i))}(e,t)):_ce=_ce.filter(t=>t!=e)}}({readable:O,writable:H},z);if(e.size+=t,t!=(b?m:f))throw new Error(Jae)}}catch(t){if(t.outputSize!==jse&&(e.size+=t.outputSize),!M||t.message!=pae)throw t}finally{hle(o,i,"preventClose")||!H||H.locked||await H.getWriter().close()}return M||N?jse:e.getData?e.getData():H}}function lle(e,t,n){const i=e.rawBitFlag=mle(t,n+2),o=!(1&~i),r=gle(t,n+6);Object.assign(e,{encrypted:o,version:mle(t,n),bitFlag:{level:(6&i)>>1,dataDescriptor:!(8&~i),languageEncodingFlag:!(2048&~i)},rawLastModDate:r,lastModDate:Ale(r),filenameLength:mle(t,n+22),extraFieldLength:mle(t,n+24)})}function ule(e,t,n,i,o){const{rawExtraField:r}=t,s=t.extraField=new Map,a=yle(new Uint8Array(r));let c=0;try{for(;c<r.length;){const e=mle(a,c),t=mle(a,c+2);s.set(e,{type:e,data:r.slice(c+4,c+4+t)}),c+=4+t}}catch{}const l=mle(n,i+4);Object.assign(t,{signature:gle(n,i+10),compressedSize:gle(n,i+14),uncompressedSize:gle(n,i+18)});const u=s.get(1);u&&(function(e,t){t.zip64=!0;const n=yle(e.data),i=rle.filter(([e,n])=>t[e]==n);for(let o=0,r=0;o<i.length;o++){const[s,a]=i[o];if(t[s]==a){const i=sle[a];t[s]=e[s]=i.getValue(n,r),r+=i.bytes}else if(e[s])throw new Error("Zip64 extra field not found")}}(u,t),t.extraFieldZip64=u);const d=s.get(28789);d&&(dle(d,Vce,zce,t,e),t.extraFieldUnicodePath=d);const h=s.get(25461);h&&(dle(h,Hce,Gce,t,e),t.extraFieldUnicodeComment=h);const A=s.get(39169);A?(function(e,t,n){const i=yle(e.data),o=fle(i,4);Object.assign(e,{vendorVersion:fle(i,0),vendorId:fle(i,2),strength:o,originalCompressionMethod:n,compressionMethod:mle(i,5)}),t.compressionMethod=e.compressionMethod}(A,t,l),t.extraFieldAES=A):t.compressionMethod=l;const p=s.get(10);p&&(function(e,t){const n=yle(e.data);let i,o=4;try{for(;o<e.data.length&&!i;){const t=mle(n,o),r=mle(n,o+2);1==t&&(i=e.data.slice(o+4,o+4+r)),o+=4+r}}catch{}try{if(i&&24==i.length){const n=yle(i),o=n.getBigUint64(0,!0),r=n.getBigUint64(8,!0),s=n.getBigUint64(16,!0);Object.assign(e,{rawLastModDate:o,rawLastAccessDate:r,rawCreationDate:s});const a=ple(o),c={lastModDate:a,lastAccessDate:ple(r),creationDate:ple(s)};Object.assign(e,c),Object.assign(t,c)}}catch{}}(p,t),t.extraFieldNTFS=p);const f=s.get(21589);f&&(function(e,t,n){const i=yle(e.data),o=fle(i,0),r=[],s=[];n?(1&~o||(r.push(Qce),s.push(Xce)),2&~o||(r.push(Kce),s.push("rawLastAccessDate")),4&~o||(r.push($ce),s.push("rawCreationDate"))):e.data.length>=5&&(r.push(Qce),s.push(Xce));let a=1;r.forEach((n,o)=>{if(e.data.length>=a+4){const r=gle(i,a);t[n]=e[n]=new Date(1e3*r);const c=s[o];e[c]=r}a+=4})}(f,t,o),t.extraFieldExtendedTimestamp=f);const m=s.get(6534);m&&(t.extraFieldUSDZ=m)}function dle(e,t,n,i,o){const r=yle(e.data),s=new nae;s.append(o[n]);const a=yle(new Uint8Array(4));a.setUint32(0,s.get(),!0);const c=gle(r,1);Object.assign(e,{version:fle(r,0),[t]:kce(e.data.subarray(5)),valid:!o.bitFlag.languageEncodingFlag&&c==gle(a,0)}),e.valid&&(i[t]=e[t],i[t+"UTF8"]=!0)}function hle(e,t,n){return t[n]===jse?e.options[n]:t[n]}function Ale(e){const t=(4294901760&e)>>16,n=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&n)>>11,(2016&n)>>5,2*(31&n),0)}catch{}}function ple(e){return new Date(Number(e/BigInt(1e4)-BigInt(116444736e5)))}function fle(e,t){return e.getUint8(t)}function mle(e,t){return e.getUint16(t,!0)}function gle(e,t){return e.getUint32(t,!0)}function _le(e,t){return Number(e.getBigUint64(t,!0))}function yle(e){return new DataView(e.buffer)}new Uint8Array([7,0,2,0,65,69,3,0,0]);try{Zse({baseURI:"file:///home/runner/work/geonode-mapstore-client/geonode-mapstore-client/geonode_mapstore_client/client/node_modules/@cesium/widgets/node_modules/@zip.js/zip.js/lib/zip-core-base.js"})}catch{}const vle="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";let Tle,ble,wle,xle;function Cle(e,t,n={}){const i="number"==typeof n.level?n.level:-1,o="number"==typeof n.outBuffer?n.outBuffer:65536,r="number"==typeof n.inBufferSize?n.inBufferSize:65536;return new TransformStream({start(){let n;if(this.out=ble(o),this.in=ble(r),this.inBufferSize=r,this._scratch=new Uint8Array(o),e?(this._process=Tle.deflate_process,this._last_consumed=Tle.deflate_last_consumed,this._end=Tle.deflate_end,this.streamHandle=Tle.deflate_new(),n="gzip"===t?Tle.deflate_init_gzip(this.streamHandle,i):"deflate-raw"===t?Tle.deflate_init_raw(this.streamHandle,i):Tle.deflate_init(this.streamHandle,i)):"deflate64-raw"===t?(this._process=Tle.inflate9_process,this._last_consumed=Tle.inflate9_last_consumed,this._end=Tle.inflate9_end,this.streamHandle=Tle.inflate9_new(),n=Tle.inflate9_init_raw(this.streamHandle)):(this._process=Tle.inflate_process,this._last_consumed=Tle.inflate_last_consumed,this._end=Tle.inflate_end,this.streamHandle=Tle.inflate_new(),n="deflate-raw"===t?Tle.inflate_init_raw(this.streamHandle):"gzip"===t?Tle.inflate_init_gzip(this.streamHandle):Tle.inflate_init(this.streamHandle)),0!==n)throw new Error("init failed:"+n)},transform(t,n){try{const i=t,r=new Uint8Array(xle.buffer),s=this._process,a=this._last_consumed,c=this.out,l=this._scratch;let u=0;for(;u<i.length;){const t=Math.min(i.length-u,32768);(!this.in||this.inBufferSize<t)&&(this.in&&wle&&wle(this.in),this.in=ble(t),this.inBufferSize=t),r.set(i.subarray(u,u+t),this.in);const d=s(this.streamHandle,this.in,t,c,o,0);if(!e&&d<0)throw new Error("process error:"+d);const h=16777215&d;h&&(l.set(r.subarray(c,c+h),0),n.enqueue(l.slice(0,h)));const A=a(this.streamHandle);if(0===A)break;u+=A}}catch(e){this._end&&this.streamHandle&&this._end(this.streamHandle),this.in&&wle&&wle(this.in),this.out&&wle&&wle(this.out),n.error(e)}},flush(t){try{const n=new Uint8Array(xle.buffer),i=this._process,r=this.out,s=this._scratch;for(;;){const a=i(this.streamHandle,0,0,r,o,4);if(!e&&a<0)throw new Error("process error:"+a);const c=16777215&a,l=a>>24&255;if(c&&(s.set(n.subarray(r,r+c),0),t.enqueue(s.slice(0,c))),1===l||0===c)break}}catch(e){t.error(e)}finally{if(this._end&&this.streamHandle){const e=this._end(this.streamHandle);0!==e&&t.error(new Error("end error:"+e))}this.in&&wle&&wle(this.in),this.out&&wle&&wle(this.out)}}})}let Ele,Sle=!1;!function(e){let t;e({wasmURI:()=>(t||(t="data:application/wasm;base64,"+(e=>{e=(e=>{const t=(e=(e+"").replace(/[^A-Za-z0-9+/=]/g,"")).length,n=[];for(let i=0;t>i;i+=4){const t=vle.indexOf(e[i])<<18|vle.indexOf(e[i+1])<<12|(63&vle.indexOf(e[i+2]))<<6|63&vle.indexOf(e[i+3]);n.push(t>>16&255),"="!==e[i+2]&&n.push(t>>8&255),"="!==e[i+3]&&n.push(255&t)}return new Uint8Array(n)})(e);let t=new Uint8Array(1024),n=0;for(let o=0;o<e.length;){const r=e[o++];if(128&r){const s=3+(127&r),a=e[o++]<<8|e[o++],c=n-a;i(n+s);for(let e=0;s>e;e++)t[n++]=t[c+e]}else{const s=r;i(n+s);for(let i=0;s>i&&o<e.length;i++)t[n++]=e[o++]}}return(e=>{let t="";const n=e.length;let i=0;for(;n>i+2;i+=3){const n=e[i]<<16|e[i+1]<<8|e[i+2];t+=vle[n>>18&63]+vle[n>>12&63]+vle[n>>6&63]+vle[63&n]}const o=n-i;if(1===o){const n=e[i]<<16;t+=vle[n>>18&63]+vle[n>>12&63]+"=="}else if(2===o){const n=e[i]<<16|e[i+1]<<8;t+=vle[n>>18&63]+vle[n>>12&63]+vle[n>>6&63]+"="}return t})(new Uint8Array(t.buffer.slice(0,n)));function i(e){if(t.length<e){let i=2*t.length;for(;e>i;)i*=2;const o=new Uint8Array(i);o.set(t.subarray(0,n)),t=o}}})("EwBhc20BAAAAAUULYAF/AX9gAn+BAAYCA3+CAAeAAA0BAIAAFwMAYAaAABCDABOBABoDAGAAgAADgAANAQSBABUDAGAHgwAegAAfEQNCQQcABAMABAgIAAEABQEKgABaggADAQWBAAcCAQGBAAcQAwIABQYAAgIFBAkEBAkDBoAAAR4AAQQCAQQBAQMEBwICBAUBcAENDQUGAQGCAoICBgiAAJgiQdDVBAsHigQcBm1lbW9yeQIADGluZmxhdGU5X25ldwAHDYYADwdpbml0AAgRigAQB19yYXcAChCGABQJcHJvY2VzcwALhwBGBmVuZAAOFoYADxBsYXN0X2NvbnN1bWVkABELhAAZgwBthQA2gwBsARKFAFiHAGsBFIUAf4MAEwdnemlwABUPhQAUhQB+ARaGAFaBAH0CGBWFAA6NAHwCZGWJAHyFAA6CAHwCGhCJAA+CAHwCGxGKABOCAHwCHA+FABSFAHwBHYYAVoEAfAkfBGZyZWUAAhWFABWMAIMKBm1hbGxvYwABC4IAVQppYWxpemUAABlfgAAPFmRpcmVjdF9mdW5jdGlvbl90YWJsZQGAABwbZW1zY3JpcHRlbl9zdGFja19yZXN0b3JlAAUcjgAbAmdlgABvDnVycmVudAAGIl9fY3hhgABbBGNyZW2AABIGX2V4Y2VwggBdBnJlZmNvdYAAJS09CRIBAEEBCwwAISIMDxcZHj41ODsK3OQCQQIAC78nAQt/IwBBEGsiCiQAAkCPAAISIABB9AFNBEBBpCcoAgAiA0EQgAASBgtqQfgDcYEACRBJGyIGQQN2IgB2IgFBA3EEgQAyBgFBf3NBAYAAHwZqIgJBA3SAABkMzCdqIgAgASgC1CcigAAGBAgiBUaCAFIJIANBfiACd3E2gAKmEQELIAUgADYCDCAAIAU2AggLgABIAwhqIYAANwEgggBGgAAFBHI2AgSBAA8DaiIBgQBNAwRBAYEAEgcMCwsgBkGsggCfAwhNDYAAG4EAhgRBAiAAgQA1BQAgAmtygAA1BAB0cWiBAKMDdCIAggCPgAAfggCPgAAGiwCPBQF3cSIDhgCRAQKBAJEBAoQAkQEAgABogwCFgAAKAmoigACMggDfBSAGayIFgwCMgAAZAgFqgQAuCgAgCARAIAhBeHGBAG4EIQFBuIEAoAQhAgJ/gABlAQGAABkHA3Z0IgdxRYQAeAIgB4AAPoAAPIEAdYEBIQMLIQOBAOmAAHaAAByEAIQBAYMAB4AAnIEAi4IBHIAAVgIgBIAAOYAA/oIAdYABCwJBqIIBCQILRYABCQULaEECdIAA5gMpIgKBAS4CeHGAAKoHIQQgAiEBA4IBqAUoAhAiAIAAg4EACgEUgAAKAQ2AAH6AARCEACqAANmBAW4FBEkiARuAADaAAUkBIIAACYABOAEhgQCnAgsggABUAxghCYAAFoAACQQMIgBHgABIgAAKAQiAADeEAcaAALEDCAwKggApBRQiAQR/gAHIAhRqgAFTgQB3AwFFDYAA2Q5BEGoLIQUDQCAFIQcgAYABmgMUaiGAAgWCADACDQCAAOUBEIQAEIAAMQYNAAsgB0GAAFsIAAwJC0F/IQaAAB8Dv39LggAnAQuAAhKAALUCIQaEAP4IB0UNAEEfIQiAAf6CAPKAAsQD//8HgALGgAHBASaBAlgGdmciAGt2ggKlCkEBdGtBPmohCAuEAvEBCIUBNQEBgQGeAgAhgQIKgQAHgAA8ARmAAB0DAXZrgABXCAhBH0cbdCEChQFJhQE0BAMgBE+AAJMBAYAAtwMDIgSAAIYBAIAAfwEBgABEAQOBAj+CAWgBA4AB04EC1AYddkEEcWqCANwCRhuAAB0CAxuAAGQBAoAAj4ABZIEA7oEAMQIFcoMAhAEFgALPAQiBAruAAO6AAs8CB3GBAa4DAyAAhQHhASGAAR2CAcCAAUyIAcIBAoABvgEhgABsgQHJgwHEAQWBAAmFAVOAAZMBAYMBbwMLIgCCAHIBBYABOQIgBIMDTYAAQYEAywEFgQHnAQiAADmAAAmEAeeAAAqNAeeAApOAABaDAecBBYIB54AAD4QB5wEFggHngAErgAJ6gAD7gwHnggOAiAHnggAQhAHnAQODAecBB4cD2AEFgQSCgwNDgASmgACNgQKfA0EQT4AAjYIDi4ABMoYDgQIFaoEAk4AAV4UDroEDVYAAF4YDuwEFiwRAgAFfgAQnASGAAeWAA0aBADqBA1aAA3SBAJmBA2WAAm+AAEoBsIIAiAICSYAAiAGwgAAfggCBgQAsArwngAADgQAbgwCIgQA3iQCNhgQxhQBLhAJKAS+ABD8FAn9B/CqAADuAAFMChCuAAAiBAmgFiCtCfzeAAFcGgCtCgKCAgAABAQSBAA4R/CogCkEMakFwcUHYqtWqBXOBAHoCkCuCAScDQeAqgwAIBoAgCyIBaoAFooABkwFrgARcgQSZBU0NCEHcgQBkAiIFgABmAdSCAAoBCIAEowUiCSAITYABRwUJSXINCYAC+YAARQMtAACAApCAAm+FBfqEANiBADkE5CohAIMCWoEAP4EBjYAAPAEIggJqA2pJDYEC24ECEoICQwRBABAEgAV3An9GgAH5AwEhA4AAyYIBHQFBgACTgAP7gAYhgQL8AWuBBVMBaoICzQNxaiGAAEABA4EAqwEDhACrgQERgwCrgANFA2oiB4AAcYABSgEHgACrAQSAACqAAF+AAWMFRw0BDAWBADiAAEyAAOuBABaCAkKAAFOBAJUBRoAE/gECggMVgQCKgAEJBUEwaiADgQC4gAHtAwwEC4MBcYEDIAMgA2uBAIkHAmtxIgIQBIMALoAFZYAAloIAK4AAnIAAzQRHDQILgQFoAeCBAJYCQQSBBayABaiEAOmCAPKBAGgBcoEFJANNcg2AA1OAAFCAA+gIBkEoak0NBQuAAM6DANGBAM+CAawB2IIADgEAgQJOAtgqgQNJAQCBAYWDAXEBBIcBcYMA04EDa4AA1QIiBYAA14IAEoMBa4EAxwG0gwJ7gQFKgAB7ARuBBC0BtIMCvYICaQNB6CqBBjABAIAAUIIAFQVBxCdBf4EACALIJ4MCe4EADAHwgwJAgQHggwbPgwewgAZQAdSAAxCBBlgC2CeBBSeAALsDQSBHgAB5gQMBBANBKGuAABABeIAA6QFBgQJrgAHegwMOhAegggbOgAN0hQMIBAJqQSiBA2wEwCdBjIEBe4ED4IABzoABgQFNgQZkAktygwDaBAxBCHGBAAqAAdkCBWqBADCAAFGABM0CIASCAGaACFGCA3QCsCeDA4+BAU+AAC2AAImDAG+AAKWCAG+AAFaQAG8BA4IBEwIMBoMAB4UBPQMgAkuIATWDAfsBBYIBgAICQIEGmYQBgoEE94QBegMBDAKBBZwCLQCBAK2ABOABC4QBroEJLIMBrgEEgQJpgQc8ggKMAyIFSYQHWQEIggZMlAFAAQeQAUABB5kBQIAAYgIFQYAH+IEAQQNqQS+AAE+AACgBBIAFTIAJlAMBQRuCCSwJQewqKQIANwIQgAALAeSDAAsBCIAAFIIJW4EAcI0CIIQCDIAAIAEYgASvggITgACYgwS/gAAFAQSBCZCAAM+BAv4DIARGgQbpgwVJAX6ACcMBBIMIL4AGdoQAtoIIwQEAgAjyAwJB/4EKQ4AACIQJD4AAFYQKUIAFKoEJ34AJDQEChQkNgAARggkNggmCgQE2AQuABsOAANqBCQ2AAGCABnUCQQyABbIBCIEFLwEfggczAf+EB90BAoAH3YAAGZAH3YAAsYAAxQY2AhwgBEKCAQ8BAIAHOQNB1CmACZqCBOuDCDeAAq+BCjUBA4IAigGogQmXAQWDCZeCCWWBAI8BAoAIA4AAVYIIA4AIYoEIA4IH1oAHooECLYEK3YIHfAECggOqgAfjgQdsgQfTgwMOgAfwAiIDgQbnAQWCBueBAFcBEIEAmoAB7wMYQQiABwQCBCKACCwCQQyFCgeAAdOBAPCDAIEBCIMAw4AI1YAAIwEYgAECAQyAADuEBuyBAvKDBEeEBqmABmQBTYAIfoACaoEHyLEGq4ADIQSgJ0EwgQA5gQMwggjAgwcWggLXgAMoggNrhQLDAWqABhmFAEKACYyABoOCABWABQUCIAiABuwDayEHhQThAiADgQtugQPZigPMAQeDBRuBAOWEC9iAAeCCB/ODADGHCuuECJ+OADGBAiWDAQaBAUCAAWiBBZcEA3FBAYAAP4AAJIAKIAEJgQAWgAI9ggzXgwKUgAARgQjMAQKDDAKDApaADAaAADkBdoMMmAECgQLshwuDgQJ3gQA1AxghBoAARoAEL4EEGoIARYIBH4EAJoEBpYAAJoAAH4AAGIALWIAJEwEDggkTggH7gQmngAAQgQkTgAuHggoqgAaJgQkTggQwgAAwgANXgQsagQm5ggAxgQIsAQWDCROCCoqAAJIBBoAJqIMAYAEcgADkAQKABbaBCgaCASmAAX6AAtiDAasDAg0BgALIgwLegQDVhQDSgQA7AiAGgABdgQAwAQaBACwBEIEA14IACgEUgALmggwKgAjkgAKXhAC1gQNegQDZgAM6gQAlARiCAQSCDDSBAkWAABkBFIYAGQQHIAlqgAvPAQOAAAeBAu0BBIEDfYAHTYYEJIUE1YAACgJqIIEE9oAAEoMBjAEHkwQgAQetBCCDAymBAAeEAbGABCgBAoEAZoQEKAEHgAQoAQeSBCiAAVuAAtSIBCiADyaDBCiCDx2EBCiCBLUDdCIFhQQogAPbgwCShgQoAQeABCiABQeCBCgBAoQMK4IGHoMB9IEOdoIEKAEHgQQogQwLgQHtgwv7gQV9gQQogwtAggH8hgQogADWARiAAAeEAOSBAPKFAQSBBnaDC4+DBCqBAi+BACuIAQgBC4AMtYID2oICAAEIgwJCgABmARyAANCAAM6AAmyAAkKBDwqAAIqBAkKCA12ABu+BAOIBB4QPGYEBr4MAQIAKAIQCQIAKCIQCQIIACoACQIQOSgIgCIEAhIMAyIILqYAAhoAGiYIAxoUML4ECQIIAGQEUhQAZgABcAwRBD4MKYwEEgQSpgAOLhwu5gwR9hgQhgQwKhAAfgAAKgQRvhAAcgQVdAWqCAY+AABKDAl6BAXGQAl4BBKICXoEPdoAAHIAABwEMgQLNgwAHhwJeggBmhAJeAQSAAl4BBJUGhoIAPAMcIAORBoaBAxqCELWFAliAArSEBoCBB6WDAHEBGIEAmAEElgaHgwJfhQ/vgAejhAaHggkdgQAmgQXygQJfAQeHD1WBAF4BEIMQaIED2IUA5YEA84IG9IME3YIAFoMQf4MNoYAEG4ME8oIA1IEOAYMCX4IE+gEJgwJfgAA8hAJfgAHvgAJfgQVngAAojQJfAQuDAl+GAl0DAiAJhAJdAQmGAl2CAAqIAl0BCYEAgoMQTI8CXYMQc5kCXYEL+4oCXYAJdo0CXYAFAoQAH4AACoADkoYCXYACboQCXYoR5oEOOoIBhYACYYYR5AEggwhPiBHmiAJbgAE7ggJGgwHcgQfpggJbggHxAQiBBv+CEdeBDpmBAG6BCICBAWMBC4AODgMQaiSAAEoGC94LAQh/gQbPggDsAkEIgQx3gAmoAWuDAt4BeIELNAIhBYITlAIBcYEJrwFBgAJdgQaAgQW/gAAigAAvgwsHgAqjghK8gwTogATqhAd6hAbegAc0gAA8hAnGgwbvAQSADRWJBzKAEwyEBzKBDZiCByGKBx+LB0WBDcqFEDCIBx2CEDCDBx0BBIACygEEghIXggcdgAGEhRAwggcdggAQixIXgAijgAJmgAlDgQf1AgNHgA5QgAE4ggJngBD2hAZ/gQEegwHEghRtAgAPhAXxgQCZggVQgA3pjgdiggLBAQSHB2IBBJYHYokCxasHYoECxYIBHIECxYgHYoICxYIAGYECxYUDowEFhBGagQDtAQGAAdKGFbuDAeKCCWCBAcCCFNmACWuCC+WGCWuADUiCAReHAQ0BA4MB8AJHDYERcYMQTwG4gwAIAQ+ECYWBD/iECYeCAE2GCYePAE2BDZiFAV2BAoSAACOBDDeLAkaCEkSAAXuMCXiKAkaLAZqAAjOCEoyBAlcBBYgSh4kCV4MCA5ESh4AANLQCV4ACDZECQIYA5oMOWYcCM4cHU4MCM4IHU6MCM4AGxKMCM4YHVYwCM4cHVY4CM44AuIAAFAEIgA/PhQMlgAGthQsUgQssgxa3hgcqgAT6ggsUgBSEhQTPgAb0jRa1hAargAgIhQZFggTWgwYhgAJKgQmHgABlhAcpAQCABymABLOABykBAYMHKYACzIYJh4IGXIYHKYYJh4ATNYAC5wF/iwmJgxdIggmJgwVigAGogQKkgQ0lgwkikQmPgAGegBWdgQIPhg23AQCGCY+BDNqDFYqAAbuGBzCAFdGFBzCBAF2AC72AB+mBAPcCAyKGAQaAAtWCAPyDAQqAACeAAOOBFGEBC4ACdYEQXoMGOIQBGoIBjYIP+oARmgHEggISgAWUgBJNAiAAgA/BgBNPBIwLAQeAAA2BBZqABceDEGOBEneCBc6AARaCBc6CEHeAAI6ECEiBACaBEoGEBo+EELsBDIAGbYUPiYABkZEFw4EPiYYDfYAAIoEDbIQGBIIAMIIH/oEBz4EYmYEDkIIMsAEEgANsgRXThBZWAQSCFpmIFfMBB4ABYYEF44ABMIIE0oABRYIF44MAEIUBVYsFw4AAiocFw4IO4oAUPYQDg4EGxoUFw4EAG4IFw4QAmYcFw4AASoQDkIAAlgEcgABRhgOQAQCHA5CDCVeLA5CEGo+CA5CADxWGA5CBAfWDA5CAAAqAA5ABA4IDkIAF5YEDkIIA+gECggFagQO4gwkogAN3ggEhgAO6gQHxgQPHhQAZhgWvhADukQW0ggWGhgW0gBN/hBbWhg+yqQW0ggAfhgW0kABNgRq4hAFOgRGnggJNgwW0hwI3hAW0gg+PlQI3iwGLhwW0gAa0hgW0iwJIhQW0gQJIiAW0gAJIhQW0rwJIggW0jwIxhgDmgwW0hwIkggW0iAIkiAW0nQIkiQW0mgIkggDWkAIkggD9kAIkkQC4gQ1VhAW0hAGthQdQgQdpggW0gBxjhh2sgRXMgQW0gAgjhQzegQrQgAQehQvZgQzegxCyhQp8hBDHgwqYggW0gASshgW0AQGGG0ABAoMFtIEFJ4IFtIISIYAAuQMcIACDBbQBA4UFtIARb4YPO4EGSIAWZYYFsoAQBYMAkYQMEIIGr4IFS4AFs4AAwYIFswEDgwWzgAEfgQWzggIOgQGoggWzAQGBBbMBA4EFs4EAB4AFs4ACeoAAlYYFswECgwWzhBC7gAKVggFZhADqgwaXgQYKhhrQgxNkgANdggzihBOAgwENAwsLSYEHEQGQgwZ7gRUbAWqBC2IBAoILNYAAdIIDUIIXhQMgAD+ABQIBdIAejYcTRQF/gAFMAZCECpADAQsGgAAtBiQACwQAI4ATswIBAYAG1QRBxAAQgBAZgwvIAgRrgRmPgAw6ggAOgAYeAwD8C4EYzoIFa4ABIwEkgQeNBTYCICAAgBIZAwsLEYAAJoEBUQF+ggfFCxAQCQvZAgEDf0F6gAcwBEBBlAiBAE0BMYECOAF+gRwFhABVhAS4ASCDAnyAAAoBJIQACAkoQQFB2DcgAhGBBlaBAFcBfIEAV4MHkIAA5gM2AjiFAa8EAkG//oAACYAAZQQgABAjgxYPBkEfdSIDc4AZV4ECgIAUBYAWLoMC0gEogw58AnZBghn6BAFBAE6AHlmBH2uAAWCCAD2CAFwDNCACgQI/ASyJABSAAOeBAAeAAZaBABuACNWCDfGAAF+AA4YBMIACyIEAFgE8gwArASSAAAeAGzWCDhwBQoEbQAFwggg/AUKAAKgBN4ENyAJCgYMAFAHMgADggAArArQKggq+AXCDANEBVIMABwJQQYIJDYABCYMZgQMkEQOEATEBHIACLIwBbQFwgAFtARKCAfqBAOaCF5QIBBANC/0kASKEIVkCFCSBAXgBGYYBJIEHjAIiEoQBbAMEIROEG1eBAjcBE4AEZwMAIROCAH2BBJAB3IALOgEfgACnBfQFaiEVgAAIAdiAABABG4AACAHwgAAIARqDAL8CIRaBACCAABADEUGcgRgZBCEcQZiCAAgEHUGUK4AB+AIhHoEDNgNAIQqBAAcBPIEK+QFBgBgyCAJJISBBfSENgAAOBgZHISEgE4ECGIEDLwMXIRCBGPiRIgqSAAKBCY6RIjaBEIKAIhqAAXcXaw4TBAUGBwgJAwIMDQEZABsPIiIUISKCBH8FTCEGDBmGAAqAFtCAAAoBbIEeTIEACAEigAvWAygCYIIfMAMMSRuAACEEBgsgIIEf2oAAVoAGUgQOIQ0MgAGRgQTGAg0PgA8SAghygBXgAQiBBACCF40DCkECgga0A0UNDoEaiAFrgR+SgAEQAyAKdIAUeIEUoIAa0oAALQMJIQqDIM6BEX6AAlADCEHBgABegALShgDLgAAYAXaCFkcGaw4DAAECgAToAR6BDXSCH5gFCANAQZCACgaAD+0BkIIaJAERgSAiBnRqQQg7AYEgJYAAY4EKgYAflwNBgAKAH0YBBIAAB4MAJ4AFCYAAJwEJgQAngAALgArZhAAnApgCggBOAZiEACeDAE4BB40AToAANAGgigBJggBwhwBJgSB3gAIIA0GgK4EEewKgPIMACQMgFEGAETYBDIAFgwERgAA/gAAXgAARBwxqIBUQJBqCAFMBIIkAUgEFjABSAZyAAE4BPIECqgEcgwBKgBCZAQyAIJYDEUEgigBJgAJ2A0EBOoAEcASgKyEdgQFXAR2AA1GAA3gBiYADeAHQgAOEAViAABOAAEKAA2sCQceCBDwCQQGAAqMBIYAKNAQKQQNrgAKngRXuAiEHgQAdgQg2gSB6gAERgQHsBB8LQcSBAZuDC9ECwguBGTQB0YEAEYIcR4AASoERF4gAQ4UAPQIMGoEAGYAX/gEFgAYIAQqAGJaAAByBGa0CQR+CE66CB+mAAh+AAXaBAh8BBYQCH4MBboMS1AMFDAKABWeAAVKBAhsBBoAAVAEKggCRAR2ABZOBCHID//8DgB6CgAAJgCT3AhB2ggsuAkHdgxKfgQChggqqgAJmBBoLQcKCAEABAoEACIMSVoAE/gFEgABagAi2gABUgQOMgAQWgQBbgACzAwJBw4IAJoIC4gNEIgOCCDmCFNiAG+ACAyCBE7EBEIEACoECiYAAKoQDEYAAOQESgBWIAwMQJYMjmQFEgAWJgABkgAAtBBJqIRKBADYCayGBADuAANaBGlCAAA4CBAyBEzCEBckCDBeACNOCAz0CDUuADFmNAR2FAzyEAR2AA3QBaoMDP4IBHoEBnoMAhoEAUoABEAEfgAEXA0GBAoAaKQFkggAQAgV2gAATgAA7AzYCaIIAEAUKdkEPcYAcVQEigAkgAWCAAE4BDoMBvQEOggG9AkEegiHeAkGhigFKgAChgAAMAcWDAjoCACGABCOBBZgBbIADE4ADqgMGIAyBCpsBE4AACQcGQRNNGyEJgADLAwYgCYIN1oAAE4EhHoAALYAC44AADAV0LwGwDoIC6gEAgQLqAQOABGABAIEHZJgESQEKowRJgANhgBrygwBpgAAMhgBpgADbAgdxgQBsiwKnAQSAAMaFAquDAEEBFoMGi4AAB4AGmYEdgYEDNYAADoAGmYADcAUTIBogG4EDbAIiDoIBIQG/ghdnhgEhARaBASEBxoQCYYIBHYABKAEOgQ6AggJKA2QiD4EABwRoaiEMgADcAQuABVqAATKAHaMEKAJYdIACwQEhghVUA1AhIoABAQEJgACbgAOXggEFASKAAzwCGHGACdIHaiIjLQABIoADBoAfOIEK4YEWDoABFYABAYkDPwEJgQEVAQmFAz+AANeAAZ8GIy8BAiIIhRV/gAj3hgEmgAAMgAEfggTEgSPbgQEcAiAGgwEcAQuBFlABf4UGaIACegQQaw4CgAWHgSOUgAl6gg/AhgCMgBAwoQCMigBlAwUgC4IJsgJBh4sDswEJgAGTAQOAAvmAJpuBBmeAAgaBADOAJYmBAJiAJE2ADqCBJp2BALsDIBFqgAAeAi8Bgg7AgBYzjQCXARuoAJeEAhuAAJqACyyDAiCAAjaAAFSCDFiACnOMAFwBGqkAXAEHiABcAQeDAFwD/wBxgCc/gCeGgQIiAwQgDIAAKQILaoACFJYBEYAD3YEFPoIGKoMBuAEEgQG4gQHPgAJigwMhhALIgAWjAWyAF7mEADiCABQELwH0BIMBbwKUCooCtwEVgQK3gABxhQLrhAMAgQasAiAPjALyAaOLAvKCADuABEMBXIME8wFwgAM+gQaZggLuggChgQLwgABDAR+IAEMB8Y0AQ4QGcYYGloADNIQFkYAACwENgwBkAciFBZGBA1cC0DeJAzeCA1UBUIADyosDNwEMgAFugATjgQM3AQuLAzeBJuahAbgBC4ADNQIhD4AC+oAAQIAp14ELUwX/AXFBDoEARwMGIQyAAJ0BBoECGgMMIA+BAGYCIRiAAJUBBoABwoIAlYIBqQIgGIAAhAELgCgPAXaCAIcBD4EAhwEMgBjPgQHkgACIgAR8pwMzgQdCggOYgABGAQCAAe4BD4IAnYEB6wEPgQZlgAVkAiAMgAXeAtA3gAAvAQyDAmwBDIEALwELgQC0gA/SgQP5AkHNgwFzARGBGscBIIEmEYUGfYAACYAknQLQN4MAGwLAAIEAHAMAQdWBB+mHAaqAABwDAkHJhQdAgBnNAXGBBj4BTIUCZoIP0oAGoYoBhoAAvIQA7oAIUqIA7oICSYAAxwEGgwDOhAdLgAfiAiAGgQFagA5dAQyBAPGLBK2FAumAKDABEIMKHwEQgQDthAcUARKBB5qBAEeACR2GAkwCIBCBAI8DECASgQCCAhIMgh3lggebAQqBHJiAAdABCoIHWoAFz4QARoYAIoIAGIAHCIQAGIITBYUAGIIAEgEOlABMgAE8hAA0AQ2AAk6AAAeBC3cCQdCDAI+GCSGDCTIBCoQrvwJEIYIik5IAUIAAyYQAUIAA+AMCQcqFAZuAASEC1DeAK6mBAEABXIMCj4EACwFUkgMkAQuDAySCAp2HAySAB2miAa6CAoeBBmKBApcCIg+DKhiCAcGCB5SAAGIBC4gDHQEPgwMdAQ+GAx0BD4YDHYIDpIgDHaUCL4sDHYUCO4ACGoEDtYAEHIIDxYAAiAEhgAzCgQMlAQqFAyWJAj8BD4YC8wHxigLzhgJYgCsQAwJBy4UBYAEPhgL7ggVpAUiHAwKIAV8DIAYEgybGhQMBgRnrtQMBAUiJAwGBAHKSAv+BAKUBzIQFKYYDB4AAEYQCJQEGgAfOggBNgArEAhcggA8fAQmAAe2CGy4BCYEcvIAAGgEwgCS5gQAIAsw3gxCpAfyLBikBB4QAQQE0gCrEAQOBANaAAAyAEJEBKIAQM4MARAFrggcrggAWgAAiAWuBBtyBE1qBC0WBFIcDBkkbgQAgARKBCvyCLo2AABeBHYmBAZiHC1cBCYILNgMJIQOAAT4DEiAFgAEtgQO3gwOngQblgQf7gQFKAiIDgRJgARCAAHmAA8aBAE2AAWKFA92BFP6SAzOAAcSEAQ6BDLSFABuJA9mAA0aEACKACFKIB0GIBA6BABaEDIqBEZ4BEIMS4QEShiIFgRQ2gAblgRF9gAFBgQlygApJATyHD58BLIABXQQQIBdGgAhVgAP9gCmBgRG8gBgSgSYJgAARgCsIhBCHgBVdATiDBbyCGDeAEh6BFXACKHSBGhKAEj+BEiaAAG8COCCBFbGCHLUDLCIFggAugRGXATCCMO+CADCBKiICLAuDAfWAALuBA6QBBIEBXANrIAWADK6CIFMBNIMemQEsgBHXgwRwgAANgAHoAWqBDNSAACeBAd+AASWBASkGSSIJGyIEgAA4AQmBAGqBAeyBDPeAKH0DBGsggQAXghaAjABPggANATSAIhiACoWAARyDAKsCCUeAGWmAACmAAniAAJYBCYEdWIENZ4EpH4ASW4IRpAIIIIIRpAEEgABcgAAWgRrdAReDES2AEuSCLQUBFIAAF4EVt4ABVgEgggA6gBKxghF2gAPSgRpygABDBBtqQYCAEdyDERiCEMIBRoEAE4ASrYIUOIEOEoEwBYEIfoAAGYABKQcgDUF7IA0bginVAQ2AAJMBF4AAHwENgACZAROAAAiAAagERhshGYMokQHSgwiwAnwhgBFJARSDIBcGGQuUCQEMgBQrhhKngAEhgAjQgAAHgBMngAM0gANCAQ6CB40BEIIatwMCQUCAAY6HJ++CC3OAM+kBAoEz6YEozoEz6IAEwAEOgSBggCGaAQSABWSABh4BDYEFcoEUpYAASgELgADJgSBEAQuADc8CIA2BC+IBCYAEEwQNIAtrgy1rgAmIAU2BLUWCF5sDCSANgAx/gQjUgwArgQAngAGUARCBAEEBCYAAFQEPgBFgAnJBgSOIgAT9gAjNgCFFgCFNggAPAwwgDIYho4AEeQMIEAOBI4GDGTmCDf2DGS4DDWoigABVgABykwBQAQiDAHOEJoqBKSaFK36BAzKBAFKDIP+CAFKDGTOAAFIFCCALSQ2BKDyAAAmBAD2CBmeSAGABDYYm5YACU4EAOYIm5wEIgSUzhCssgyLSgQA5AiAIhQA7ggAsAgcggBa3hzCagRAagAeogBnCAQ2EIgmCJYOBBtWBAYiAMqwBcYABNYEigoEAooALkoEBRIAABwFrgASngAAiAwwhCoINNYMYJIAAEQEIgABhAQqMGcCBIqmGKOyAAB+BBEOABdaEI/+AADUBGIEUFYAAEwEMgRDchQBFigAmgAAfgAAYAxQiB4AWoQEMghnEgAAPARCBM4gBAYAAEIEZxAENgAVJAQ2ABLMDByIKgRnEgAEiggAwgANvgSLMgAAQAQqCADGBBU6AA56EAYaAERaBBkWCGaOAAFEBHIEA8IAYPYIZo4EBnIABZ4EZo4AAjIAAR4sZowEIiBmjAwwgEIQZowEQgQAsghmjggAKgBmjAQqCGaMBCoEFQAEYhAC1gAAoggDZARCDAQ2AEM2DANyBBo+CABkBFIYAGQESgw7OhAHKARGHAgUBEYsByoMB75ICigEShALajgA0gAIQAhIQggX/gAf5AgcLggCYgCi2gQbegQRJgBgtgSVlAxpBfIArbgEOhCPzgBBTAnEbgilIgQBMgRD2AwdLG4IAOgYJIA4gB/yAOmaAA8cBEIADFwILIoEEAocX2wE8gAAHAQ6ABceABA6AAC6ADPwCIAKDAC6CBk2BBluDF6qBACyBBluBBFODGbKACAYCEQGAJPWBAByCBSiABzuBBduBBSOADK2AGjmBH9oFGHRyCwiBBOoDBRAQghj+BBAZCx2JF0oDIAERgAdigQBXgACfBQAQAgsQhAAehBeNAUCMF3kFDxATC9KBGOaHJP6bGNOBCMehGNMBtIcY0wEmgQ3+gCzLgADAgAolgAXAA0giBIATcwNBD0uCGscDQYH+gAT+AXKIGOGCGNmCGOMBIIEAKYMY3IAARo4Y3IYAFI4Y3IAZGJ0Y34EbJIsY34AAtIoY3wHEtBjfAkF+jAFmAXGAAWaLABIBH4AAEowY8QEGgBjxBIBEASOEGPEBEIIY8QEXhQFCgxjxAQyEAYqEGOqBAiiGCGKCBxUBA4IHFYIODwHAgwbTgAAHgRxWgRixAiEdgAAXgRkOgBjOghkOgAdvkhkOgRkmghkOgxj2gA/Rgxj2ggfAARyFGOYDDiESiRiugRQ9gBkOgiFhpRjiwwACgAHmgAG7A2sOH4IZIhszNDU2CgsMDQ4PEBEDAhQVASQAJhcYBD4/QEGEGSUDCwwkhgAKgSQUgBkngw4VghkxghnkgxkxAQqBB7GBDgSAABIBDIAL1AEygwAKghYvhgFiAgwzgRAiAQaDBMSACb8BN4oV7QEGixXtAQaBDB2BEGyBELqAILCABGYEn5YCR4E4oYEAWwEogwBZgBAIASiBBbiABH2AHLeAAAICECeBAwcBHIAO6YAALgI7AYEo6gEQgABKBEECECeCIFoBtYgXCwEcghDOATOCAKsBJIE2eYACXIAQEoADBIAE+AN0QYCAA26CLbgFakEfcEWCAyGCCHwDAEG5iwwjgABCAQeBFloBCIMXjAGHgA6LjQAeAgR2gQPHA3EiCYIM84ANAQIHTYIAxgIiCoAGwgEKgAwYgSl5AigggCDRBAVPcQ2AFlKABWGCOnMBrosNnAEDgBQeATKLAUYBNqQBRoILkYAGS4IR0JMAq4ABtgQHQYDAgT1YgAAdAdiLErSDAdMBJIQYGoEBGIIEMoE2SoEANoA3zIEEZIE0p4MAC4ABdwM6AAiABvmBACsCOgCEO7qBAZqDAY+CHN8DAkG2hRMAgQh7AQaDANuDGSoDRQ01pQDbiACYgQ4JgQxyAy0AFYIkr4sAlIIIQYoAigEEhgCKAbeQAIqFAWWAC8euAIqAAPeDIneCAXOBH9GZAJiBAqyTASIBuIsAmIEAJIA71gNBgAiBAacBB4IQ1IUAqYEABIsAqIAEvIAvO4oAqIMaXYIWaQE2ghpTggJ9gBNPgQC8gQzggA+agQisggNXgABogQCjgAW8hQCuASiAAK6AG62RAK4CDCiFAQKBACeCDWMBEIAAFIoB1AEypwKvgAfFgQJagAOHgAOPgDyGgQJzhAOVBBh2cnKDA+mCCCkBMIABJwG+jwEngRAQgwhogQhRgALsjw6sgBDShQ6sBEECIReAARKGBEoBKIwAYYMUNgMLIB2AHs8CDS+EHgqBGdyMGcGAGCmEGcEBD4oZwYUA7IYZwYcA6aQeCoEeAoAGOwKkPIAAT4EMKoEdIIIPqf8eF5ceFwWoPEGwPIImXAHNgAAEgQAKgAIziR4YgAAYgAASgB3QAxQQKaAeGQGsgABQAc2CB9qCKNoBEIkeGooAS4ABKIIeG4EB0gGogQErjx4agABChx4agxeAgTtHgBGrAQaNHdYBMp8eD5MAOQEqgQAZhB4PgBlRtx4PgABOAwYMMKkeBQEGgQB9kx3/AQaEGG4CDC2eHfsBDoAACgEOgh37Ag0sgAzckh3uAQyAD2GBACkBa4AP94sd7oEEE4Ud7gEngwQLgg+FgAQLASuoBAuSHdyBOUKPHd6AAZsBYIAAP4Ad3oEBjIId3gQFQR5JgSW2AU2FB8GLHeUBJ4od5YAI14gd5YAVVYMd5YAZHIId5YMX4gELgx3lghxWhB3lgRqejR3lgEUHgR3lmAQkgBsCoQQkAQqBAGmABLSBAGmAAAyPHeWLAn0BCIAAxosd5QEVgwuRgAAHiB3lgAAOgAufAiENiB3pgAM6AiIWggEljB3pASaRHemBHf6JHeWBAeGAEWaBPOSIGq4BE4MargEYhhYrAQaCAQWBFw0BE4MXigEZgRcKgBzvhBeKgAC9pB3lARmBHeWGM2QBDYgBJoAADIUcLQMFIAqCARwCIAqDARwBDYsd5YA8xYUd5YAdd4ACfYIB4gEIhBbDgRQsoxeVhwBlAwUgDZ4d5YAUnIACBoEAM4wd5QEEggC7ih3lgB/CjQCXASSoAJeEAhuAAJqAENKDAiCHHeWAGYKNAFwBI6kAXIAd5YYAXIId5YAR/4Qd5YADTgELgADygRVaAQ2bHeWCCCWBBQ2FAbiCBkqBAc+AEauDBCaEAsiAEpimHeUBJYgd5YEC64QDAIgd5YcC7owd5YIAO6Ad5QEeiABDjB3lggBDhh3fARaHHd8DBQwriR3fBARBBkmAEVIDggJJggzdpgiwgAWMAg5qgAUUAWuAGfKBBX0CEmuBJ76BFkyBDsKCFkQDHCINgRbSgAOSgRZ8BCBqISGAA5eAAAyDGyEBIoMADYMDpAEjgQALAVSAA6SAAAcDUCEZgQAHAUCBAsiBDtABA4EAB4EV0oAABwMwISSCBr8BDoEDcoUGtIAwVoAAC4E+cwIIaoAYXIJFhAFyggp5gQNPAgsggCtcAiAjggPqgTzHhEDqAQaBA/SADOeBGS8CBHaBBBaBG0+CAcqAGxQDLQACgRkDgSLdgBwOgAMEgAOmgQrxAQaBGtwBCYAWUoIdjIIALoIE7YID04EQH4IAmIEhO4EC3YIGTQEKiACoggCcAghqgABPggB5gAECAQSCGmGBPEWAGb+AAImBMTmEAN8BCoYC/4EAC4YA34EcroAA2IEhnoEA5gELggTJASKEAN+HANsBCIMbpAEIgQMUggDbgBZzgUqyAX+AAJaBALuERNmBGzqCA4iJA2yBBe+CEOyAPs0BA4AaoQEagwCBAQOEAB+BLqiBADiAAIeBA2GAALeDAGyDAUeAASKCGzuDANoBaoAFWAMMIB+AGKuDGvqAGfmBGNcBJIEa94AB0AHEgRr3gBr1gAZqgRzUgRcmgQFUAw4gIIAAKIMHgoAAiQELgQWZAw4gIYMAFIEAEYAARIEh0YEYw4EtIoIBsoIatYMBsoIk/4IGkIFCbIEVZwEOgRpFgQB8gBSJAiIHgBcsogA2gBX1gQRggAA0A2shCYEWMQEOgQRPgQCFgAAHgBR0gRlCqwBJgAErAQmBBG4DCUEDgRdRiAA6ggG3ATqAAWeFAn+AFLiBBTsBCYAAVYACOoEAVYAAB4MHkoAVDIAgfYYAPAIJQYBBg4AWhoMCroAAnIIAb4EjOwEMgBwGgACphAAogAAMhABkggAKggBkggBWgC4KgwX8gQBygBAnAQKASmqCAGaAAk2BACqAAD6ABY8BQYILboAQHYQAZoAA4QUtAAQ6AIA6XIAUBIAAFIACjQEIgx3YgB3WgQEAgh2YAwgMH4Eee4ECGYECpYICHYAQ4YACHYMCtIAA0oIIp4IhBoEB/gEZhwAshwMjhgAsAQuBCdCCIU4DDRwagCExgAAVARuBAPKGAT+BAx6AH+eAGskBT4AkjYAiLIFDw4MoZYAE8wHIkSLKgAOkiggcgR3nhCLKAQ2BA02ABm2rCBwCIA2FIsqAAEACACKABkuIIsoBC4IdGoEl7IAAaYMiygETgACVgAA1gx+tgRg+AQWAG4eAGlMDcSALiCLKgAoOhR+tpQCIgAosgwOdAQuGIsoBDY8iyoEAWYEBG4wIrAENgiLKghTDhiLKgCiTAQiRIsoCyDeDABuUIsqCKMqGIsqCBIOAACGIIsqATcSBCqOJAYaAALyEAO6CCpOlH8mAAMeEAM6IIsoBC4UEjoMiyoABFYEA5oIBFYUHzoACNAEOgQ82gi2KiyK5gArtgQxchANhgAGqghRfgR35ggdRAQqLEGUBJKQMWoAewQIgDoI8xIwdVoFEbgEggkVCgBj2gQdcAUaCB5yAEc6BIIKBEPiCIgGBEYuBAk+AAb8BA4MUYYIAloAAN4AErYACXYMAGQEogRZXgxRyhBBOggPagBFCgRFAgBmEnBDpggBnAhtGgAAxAwBB54oI4oAFVQESgSypgyZLgAASgRaoAYCABLcBdIMAJpMQyQK9/oIeEoIT7AIAcYFHuoEOFQIMHoYgP4AEcoIgJAEGgQFpgwAUgABmjwAekQAygC2FjgAUghLHAc6FI/OEDwWDDxYBBoIrvYEj8wEKgzdJgw6dgADYgQA0Ac+DAruBFnuHI+qAAQIBzIsj6oIBkgFUgANXiwK+gBv1AiAKiCPqhwREpCpFgwOngRzTjCPqAsg3gwcZgBxHiAQ9iiPqgQQ9gBnFhAQ9gQe+gR4jhQQ9pQCBiwQ9hQNbgAEhgQgugAU8AQqCAKGAHOqCA3uBJ4qEBEWJA1+eI+qCAWCLI+qCBBuBDneBEGmSI++AAWQCIAuEI++FBCaqJvCMBCaDI++EBCaDI++JAMWBDTeAAISJI+8BDoE08IApOYAAwIcj5YID0YEB6IIj5QEFjCPlggjujyPlARKGI+WAChSNI+WBAESII+WAACKKI+WBIemAILCDJfmHI+UBC4Mj5YEAHoURQYkj5YAP94sIsY4j5QEOgSPlAQ6CAE2ABROGI+WGJ3qIA2CBKMGNABSHJ9yHABSAADyFAfOCBP2BOCiBAQOBK4qADWeCAVWGDHiBEn4CA3aAISmDHXeABZYBa4ERgQEihAyeAROAIyOACHSBE4WBAD0BBYFMV4ATioEDdoEIMwEFggHIgQymixsZgAAHAQSBBH0BR4EE/4QGtoBCeoES34MkYgEGgVRVgxXBAkG5hxKXARSACRSDFvKCAV6BRayBLJWAEpaCAeqCFnaAH1yAHzKBG3EBDYQACgEYgAGegAAHARSBAcQBBYECA4AM0YAMq4ABloAkB4EauIAdOQMLSxuBEtCAACaAChiBREuQGMyEFuuBEvuEF5aFEv+BAPQBRIQS7IQS+oAAXYBQ5YAAvwG6iBEtAUSGF/2BAMWBBrSBBqiED3cBaoEDzQEDhQDHgR9ngUSRARyBVVaCArYBRIAIeIAAEQEggSQugxILgQB1gQgzAiADghThgVGFgQJBgQEYAkkbgAI+lhhqhgDKAQWEAMqBAH+CE66ADjSAAMKAIJ+CKVmEF8aBHhiCHaqAAMYBu5IAz4EM04UAz4IU2ZUAzwEkjQDPASjkAM+DNeCJAM+BHNUCQbyJAl0BBYEB9YIEzYcZ9IEur6AIRYMAnIUAkYAC4gMvARyBTqsDAEGaiwmBghfAhxidhBooAUGAOeuAJraAAPABCYMbUYASGIwczIwYgoEEaoAUOYIEaAEUgAAIigj6gkY1oAj6gQikgSMuggOSASCBUoYDAEHQigUVggClgAXphBfJggC5gwejgAAbARaBFpaBAKmDK8mBK9qBP8SlELuEE3mBBWGBNIKACV+BUweDJGKBKB6HKB0BCIEK9oAAEIkoHYILD5YoHYAAbgE4gUpvhSgdgyhLjSgdgACbASyBAbuCBi+ABtGBB9kBCIAFloUn0JAoH4InwgQ0IgZqgAAnAQmAACeBTumAJUSBJUgBSYEhqAEIgAA4gRLDgigfgAAjgAUhgBAEgCY0gSgfgACWkygfgU6ugALvgih8iygfgg9ciygfgATcgydYAQSBAYWEKC6ATD2FKCmCAM6VKCSFAqaHCs+BISqAAKaDCrgBHIFZXYMHB4EK1IERDQMIECeDJEqBAAsCKAuBAVuBAo6AAAeCKKyBBdq5KHMBBYAocwEFgyhzAQWCAJUBG4JLhAEchihzAReDAmSDKHMBC4AodIAMxAEQgyh0AReDI94BB4Aj3gFLgD0mgSH7BAR/QX6CQhWARQ+BAieBJFmNIneBAOeDAkwBKINTMIgijoE82gEKg0ClAw8QP4UACwFxhwALAR+AAAuMIosBCIAiiwLXJIAo/YEhuoFO8wIQNIEiQYAq3wIAGoIC44EBY4QiiwEcg02UgFVZgwCZg0pagQDqgwE0BQRBmgVHgCsYgRpgAYeBA4uFKUyAJpKCAx6ADEiAAHmABDCAAXiHA0KBAa0DABA2ggApgwcfgAIdgwE5gAdfASiFRlABBIBWMIFE8QJBd4MkNQJLG4EP3IQAEAcDQQRKG2pKgAC2gBBCmCI/AwRBKoEQgYIAqoNECYAEcwELgTBsgAB3ARiDDqYB8YIEpIMvyQMwQQyAIUgB8IEY4IEEOIMAsQGIgACHAUqDBgoChAGAGdYCAkiAEoEBwIEIAgEDgBUKgAAMgAJHAcCBULQBBoACA4MbX4BO8YAAKQIgcoMJdAFsgSUUAh9wgEBcBEEfcxCCCGIBbIIX/wQALwEygQAQgQAJAzAQPIEBSYQNAoMFQIIAm4IBLYEBOIQEc4EAYwMEQTmDUbWEBXiCAC+DBhqBGYqBA0uCAHqAFVsBH4IOl5MAHAGLgRxvlQAdgCEOhkyjgyMXkwAoggoV7AAcgB77gkiKggGQAQmAAeMBQYBGhoMDzIIBroE2UgICSIQBjpEARgEggBKFlgBigQfVjgF+ggLUgwKigALmgATxASSBCv6BAyaADEWBHtiAC/OABRKBCq+BBPaBAvqECgeCAF2CALKABLGCAH2ABpwCR0GBBGYDCBtyggC4AQOAAAiCXY6AAAgBEIEITQIbcoIAhIAAX4IG1IUATYMcQIAKH4QASYMAqp4AJoIi0YMAKQMvAQagAE8CLQCBE4mcACa9AX2CALeCRUCcAI6CVhSBTQmBCvShAQyZACaIAQyAAcABC4ABs4IYxIAEG4ADQ4EGn4EAN4IDUoIdZYcKQwEgglrtgwOBggRbAcWAJpkGBQIJCQkDghSLAduAMBSBUWAB54EMLIJZvYICLoIoTocAxoAHbwIvAYAG6YAG54EOLYEAbYEEaIFDtIImgIJPdwFPgwPrgAoXghm4gADSgjE9ASCAAL+BFpGGHtCAEbuCBzaCACMCLEWBBHgBT4QZlIcA0IAARIAGpgFrhQDTggBJhBIwhgLcgRWlgQwTAQaBBPaDDvKDAuuDQHSQAIkBBoUAhAEUglJYigCHgAClAU2RAIeBAL2GAVqBAVKCE+KGCbyAAD0BHIMGEQEUgiBzgQAThAEjgU0KgADvgkZGhADqAQePAGOAGPeAABiFAGOGBTeCAfuAAEqEChWBIPmBC4SDAQqEAiGAEzyDDAaBBb6EAjOGALeBAjCBDuOEBQ6BAIGDBg+BYK2AGBqBB2OKAIaAABaPAOkB24IA6YYARIIre+MA7IArFq4A7LEA6gHniQHLgQNXgQDIhADUgBdjgh1RhQCpgRPDg0siATCXAImGAB6aA8uJBwaBAIeNBbiBKUeCAs2CNiGCAAqCD66CAAqADAaEAAqDAI6CK3aAADgBdIFFroFJY4ED8oAIP4Ez8IQIV4IKc4EE/YMHFQMBEDWCL+KFCOCABQQBAoUfnwMCQZSBESaDRDGFAFcDAhA5iABihBUJArQtgwxCgQmrgAAdAVyBYKgBToFkFIELnQIDaoE8f4EADAFsgAOmBEEBEC6DACYBbIId8IAGfQMQNkGABXSCAAuAA6MBG4MA1oAAVgFggwBAgQArhgHzgAANAqAtgUhpgAFNAqAtgUgOBCgCmC2JB3SwAB+DAbCBEg+BFD6ADCuAIAmAACSBHxWCADSADPGAEk0BdIQAt4EPK4I+24IAToEABgKkLZsA+4EQsYAB448A+IUA9IJg8IIBIwKgLYIObJ4BRpkAToACNYMBRIEBv4IjWIMhfYIAy4BFuAKDAoIVWYYBYwFsgyVogQHaAgFFhwAlAklxgA+VgDhjiwAqgSFHgQ4ygQCVgBbHggInhgICgi3iwAICgQLsgwEMhCrJuAEMAQeEEWKAAK6AD7OCET+CAO+BWqKAMq8BAYFJjYANxoEV44IPA4Id/IYACoBijIEyxQGCgRtkgAkGgBFoiQACgAT8gBvygBE6gR4vAQiDWTCAAAyAADWAGfSBAAqBTuaDAAqAAx6BMfWAAAqAC82BY2CAAAqAIKKAXUGBAAoCB0eBPNiBGMCBHoSAE+mBFdOBE7YFA0H6AUmBHreCEVuCP4OAFd6BBAOAIsiBAAqBLMWBHMwBCYJNj4EcrAEJgk11gRyigh3DgC/CgQAKgRDHgSJ8gQENgAnLgBRfgADUgl3Cgjk2gQcFggHjgAMggQMJAQOANGuAL3eCAHCCAyyCAyqBY9iHC3aBACuFAB+CBNeOA2qOAB+BAFqACAOCBaiBG20ELQCQIYADdYASjQJBhIEffYoDe4Au74IuRoMCfoER6wKIE4IAHAGIgCTjggKogicSgQOYgwyqgwOYggKUgQB/gRYUgQHmgQQ8gQNUgwnJhgDMAQOMAK2GAB+CAE2OAMyOAB8CIAWBAB+CAYmoBDaEAJyFBDeEACy0BDeAHeiBAO2BTfoGQQxsQZgggGhyAQCAM7ABC4AATwF+gBmMgzFyAZqACWiBV5MCQX2ANk+BNF+CADwBBoExVoYJ5IAA3oAExIUGCYALCYAKHoFuqgECglSXgAF7ArgtgwOhAbyAAQoFdHIiBjuAABKCEMIDA0EOgTLUlAstAQaXDKqBESMCuS2DDK6AVZ+FAF0Ca3aEAF0EA0ENa4IRu4AC34AA0QE2gAAehABxAQq/AHGAKDKBAMCBAHMCQQmEAGcCB2qAFEOBAGUCEC2CBRCEB5oBK4FPaIIBqoAxm4EPxIJl/4AADYAXGYUoe4EiW4ENCoJNyYEB/IU0AoAFGIIACIABu4Mo54YQPoIAIoIHvIMQmIEkroIFVwEYgQIMBEwNAxqDCEKBAdyBZxKVANWCA5CEACqVACOFCGyAD7KYACaCACMDLQAznQAjgAALuwAjhwCPAQqfAI+DUMWWACOCFSWCH9yAajMBdosQkIMDKgEYgWdDAUqDBsiAZlCGXEMCRQuCNPMB+oEnJARBewscgE+piDULARCADGGHNq8Bu4BxlYES9wE0ixL3gQ63glYXmBL+gAAgAUScACABQJwAILATXgF9ghJoAfGAE/0BC4E3kQEBgADEAQmCE0sCbBCBcC6AACcBbYET6gcQQAu6CQEVgTXcAUCAJWSCBtICBkGBOU6DDdYCIAeBEoICCkGADTSCZrECdGqCBOWABPCASYaHBPCAABqAFvmCDXuCV3mAF9cCIQmAbccBDoEj+oFAmIIAQoAQTYIAQIEKeoAADIEkY4EAMoEkJ4AABIFOBYAW2YEZpYAlu4EsBgEQgB8JgiomgAA8gi8UgAA8gjsQgi8UgSNEgCG/gQAdgUnxhAOKgySKhABYgRuOBAhLGyGAOZmADFEBAYImL4A72oEA04EAzIE6qIIAuYIAQYIeXwIgaoEAZQFrgAkAAgBOhGgMgAALgAIXgQCxAkdygBkegjGogCLQATuAI7KDAFKAAO2AAK6HAS6HASkBIoEJPgEKgwCfhAExgABagwEzgWDcgixSgAANgS5jhQFBAkETgUCEgE9FARWEBYwDAA4CgAuPgT2DDCESQe4IIRVBrgghFIE6KAF/gAARAvANgAARA7ANIYAyQQEBgBatBA9BCUuBaTaAZReBYJsBAoAU7QFxgGl+gARZAw90IoAHPQNrIReDEfCAKZOCDWSABIOBCiOBY4kDdCEYgAosAX+BEcECIBaFAMKARL6AFDEBGoAyhgISTIRB7wHggjyiARSBRN6ACimBACaAQR4DBiAVgQdoAwshGoEk7oAIXwIiDoEBYIApw4BGJYMkzAIgGIIOLYEeZIA8zgEHgyyKAiAQgAFJgCUCAQ6BJMsDGSAagQP1gSZCgl9jAwFrdIMBYoE9zQF2glwcAQeAWRuJAhOGAoiAAbSEAoqAbICAIcyBUocBB4Fw0oAAy4FRSAEGgh9cgijBgEw0gwGwghzNAQyDChSCRQQDAiAXgCBFgRpQgwElgQAYBSAPIgkhgDdshwDLgQRQgQC2gBlMgQC2gRVPgRPWgD7fiACygWHCglligD3EgmyrgwCYAQCCbRmAAJiCAqODX6oCIBOBAFaDWtuAJKGBAmMBDoEJ4oApA4YBiYQAB4Ifk4AApYEg3gFGgADKAQ+AbJKBPVWDGRkBS4Il/wQgDBsigEegAQeAALIBGIIBegERgQFNgQGTBAZ0IRCCL2eBA3EBDIAvvIEhoYA9LIEBToJJ7oIC/IAFUAFKgW1WgDyaggJUgQJNggIgAyATaoACRAPTBkuEAlsFE0HRBEuAAl+CFEqAAtqAJUCCRWgCIA+BAReAAtWDCSCAM7WAUpQBdoEBMoAhOoED0oEAbIECNIMDrIEDyQEAgwMPgT4qg03LgwMdhwOTgAAYAQ2BAAiBAzyFJ0EDDgsrgAFfggHLgATbhB/hgQSTgVyrgQAHgmV3gGqzgW67gwT1A2BB1IIE9QLEA4JxIIQ8goFVoAHVgRgkgRcbAdWABnSCAAeDUOoBAYEdcoMAHoMlpYAQVIEmy4ADNIEOkoFQwIAcz4EoKoEMDYM364AOYYAIxQdBoIbi7X5zgiASAgFxgXGigzBohBwSgAoagAoQAcCAb6mBABaCIaqBAGiBHKKDbtsBc4Agu4FrX4AuKAF/gwKuggDlAyADc4InW4FyHIAAPoEQSIAAKokA8YUCXYAAQ4AYjJQAM4ACoQIIdoEAHoACwYkAHocAGYAC4ZMAGYAcDZMAGYAQuJMAGYAHMpMAGYADIZMAGYA71YoAGYIA4oAdUIEA4oAbRIIA4gMLvQWCB5aCA9qAACGAPKCEXdyBCviAADGAAPuBA60E8f8Da4ER+wRB8P8DgCDEgWpJgXJggXZBA4CAPIAKF4AAW4IAGwMgAHKBWXWCdM2BHpiEAXaDAVSGAFGBZn2Bc/iCAXGDBvSBAGMBcIAAUoEHc4EAbYFi54IAUoAAUIACKQLbAoEMgANBsCuBD3iAbASCDjeBAmeDAE2DAA2BMtuEAAuBDZmEAAuAbwWFAAuAALaFAAuADiGFAAuBFMCEAAuADtCFAAuBDUyEAAuBaamEAAuADqqFAAuAQJ6FAAuABAmFAAuABZiFAAsBDocACwEPgQALgnVpgC0IgiAsgCGJgQR3gwD4ggLZggAJgQGkArArgwGlArArhQKIAQKAAr+BAVIBEIcCyKQBUoYAWoEj/4QBzoJsBoICuIAADYQAC4Fl3oQAC4FxhIQAC4ABMIUAC4FoXIQAC4FmF4QAC4FsZIQAC4ABMIUAC4ABMIUAC4E/YYQAC4ABMIUAC4ABMIUAC4ABMIUAC4ABMIUAC4UBMIACZIMBDAEQhAELgRezgS9aAnRygAFEAwsLkYkJeoARooMInocJfAEGiAl8ggUQhQl8gCjFhwl8iAjyhwl8ggBCgTpeigl5gUUyhwl4hGYngW/5giR1BEHAAjaBDMySABeCTE2BFZGPCa2CB0+BJFCjCa2CCR2DCa2ICjeHCa2ALDyCAFyAblOECo2Cc+OABh2BCYyFLmiAEDOICa+ACMoBToEINYBbhwEggEMQgWFihAmyAg0CgFWagSjkhgmzgQiEgD5BjAFnhwFihUQjiAFqgQh/hAm1ggAXASCBCGuFAI6CBbkBFIAGzwUFIhMhFIwJtQKBAoAJMQmgDyEUQeAOIROBCbWBCUICoBCBABEBD4BaDIAHWAENkgmzAgQagQAbAnQigEqVAWuAMiCECbQBDYIXHIEJtIBT4IAAIYAH0QEWhAm0gACAAiAVhQDDgCvAAWqALtMBGoAf6IADdoEGqgEOhAm3AROBABOAE4OFCboBDoABdgEUiQm6BA9rIheBAWuBCO8BD4MJugEHgCKBggs7gijzgAbZgQfmAxggDoEH0gMYIBeBB+0BGIMJugEGiQm6ggFpgQfJgilNAiAGjQm6hQLGgAG/hALIggkiAQaBCSIBBoEJuoAAz4FB9IM5f4UJuoF2eogA64oJGAEZgClKgEY7gAAoAQ2NCRgBD4AITAQPGyIPgRq3ARGACVaHCRiAAPGACvuADKqCCRiAKcCAT/+DMYCCAKyBVeSDAmWAUY+BCRgBB4AkUoJlMIIJFoAj9AISaoABpgHUhgkWAxJB0IIJFgEHgFO9gkW2g06ggE56AQ2EMO6DMP8BEYAYfYQJFwELgAp+gAM8gQBrgAGRhAMWggkXgAM1ggyqgSzbgQAYgQKKgAKAhwL8giXJhwkYgQVugTXXgjBOhwqoggGkhAqohgp2ARKECnaCNjGCCncDCwuqgBHygQdSgRY6gTIzAwFBnoISRQQAQYgTgAASgAJJgmyEAkEegwAVAfyBYbGGABUBE4J8JoAACYAAWIMD4YgF0oABMAM7AZSAa+iBDqACsC2DRRIBqIAACIEAEAKgLYEToJIAOZYAGQMLrwKCAKyBD++BEi6BDwKAEkABBIASnYA8xYAAEoF0nQEEgxKdgg8ugRnIgxBAgkQpgBBAghPBlAAcgAb4gxIsgmKIhABdgBKdihKbgTJGgxI0AgAQgEX5gwBKhxCmgwBKgjValQAchRELlQAfgAL7AXODFTCUAKiGHhODECKEJI+BD+oBEIA3E4MANYBs/4FAYwGngBPQgkdRggDMAwFBCYgBG4EBWIRtS4UA/wG4hAD/lQAgggEfgxK9gBKvmQAqggBKgiIggwGZgQCAgm61gAH7gQE8ghRwgTkkgQA6BMAtC6aFAKmBAeCEAK2CSeK8AK2FAIKCTQWBClABSIJtGZ4AVIEAP4cAuoAKgIIB9AQLC/wKgGfAgwarhQX4gRtcgxJugQwyASKAKw8BLIETvoEKnYEDVAcJQf+A/59/gjSsAQaDP3qBDB2BB0CBGVmDBzaCIyOABTaBGWyGBmKABxWCAuoBAYFv9QMvAbyEAAgByIAACAJBIINYN4AMh4E9KIAcroAMW4EAOoAhtIIRcIUWKIEYFIQpGoAOX4ANaoIpAIEBFwWYFmoQL4IACgGkhgAKgACwgQDFBJwWEDCCABCABAKBABABqIUAEAGwgwAqAkH+gX/YAkESgQYjgAECgDVggQZyAQKDL7OCN50B8IBBxIMA2oMF5oYyD4EATgEtgQAygBe6AwVBEYABgIEEEQYoAqwtQQqAIsmAWMmACm2AJteAAAqCLFCAABuAHKCBeJuCEYaADXyBHpKBGrSBTpmAemiDHmiCJjECECuBAICCBByDdXyAAnOAGA2EACGAFVOABCeANWsCciKARriSBC2NAhGJA8eXAmGBOC2FArSEBC0BAY8ELQJBoIBBjAMaEDGCAoeBJhCEAI2Cdr2GAIeEAJq5AI+EAz0BDYEqpIEAmoAAlIIKi4Q3AIRMAYEAk4EB6YEt9gH+glr5ggHogUlaggEXAQyEAJCBIYuHATK4AJgBBYIH04kBKoJuPQELggEohABngWvFgAKxgH73gwChgACKAQGHAIqAYuvCAIqDCF2WAIqCAGeCABKHAIoEBkH9/4MBJYIAkwENhwEdwwCTkQEfASKAPaKCAksBDIIAmYcAb4UAGAEEgACfgwHKggQ0AQqGA5iAA+uCE3UBCoJCtoEcbooDk4F/JoYAR58DBYEnV6AAwYEZz48AvIgDB4kArIYEDoEEcoAAkAMJEDKFBHCAZ4kBB4IADoEgqQExgReWgHzTgiGJBywLC5YLARKBDT8EIGsiD4AqpIJ1IoBhaIIXj4INCYEX5oElogEAgk1NAtDHgAhxAdCCRymBAAQBSoKDKgNB2CiDDtoC3BaBVZ4Bf4MVFIIMF4FqJoESWoBXKgEogW2UgBT/ggDagQCkgFc3ASiAAUuFOeCBLzyBFG+AJjmBVLqCcAmBQtiAH0mAgdiACPiBAMGAfraDEqGDBPeCHB2ABO+BNG8CCRuBFoSCbe2DBP+CE5+ANG2AACMBrIEajAELgXPmgwBSgB4bgAG3hQGiAdCALZSAChWEAJCCFVSEcIiGAHCAa1yCLFeCCgyBBgWBCduCAXOAAV2DJiCABmyCAPSAB8iDBrkC0CiCABGCAO+AAISAAF2AABUB4IAMBoICQoIAh4JF4gLgFoAAEYAfRAIQM4MAjwHUgACPgjGlAdSFADKCHwiCAJeABm2EAP2JACaFAB6EATSCIYKGAOoBBYMK4YMMcYEA94INhYN3/YAMKIEfuYEWFAEEggAKgBokgR7JgADfhCHNgQr7gC1NgwsCgBw/iACthEPxhgHcgCshhAaQgwCcgACOggCcgwHhggDKgw8MAbyAAieARc2BGfqAcAWBAmYBCYYCcgEQg3vUAQiDWwsBBINOpoJD74I0hIAKRoI8T4IsCIUcOIYUEYIx1YEMrYMAhIMBYYUK94AxP4IJ7wHUgACtgACUBrwETBshEoIHboIBzoEjGIAv1IAx+IEvNoQAPIEktYAX84A0QoAB6IBSIIQ8YoFDwYEANYEHJQVMIgIbIoIXgIGDsYEqEYEFdAIgDIIV/oIX34se14IU8YA+jYEEIIBIMIFV/4MAbINsH4MHzoAAaYAAfIABpQMQamyDB9GANB+HAtmAQN2AFkeAAIaAAcOBACCDAt+AAMqChp2BRyiAAHaCRNkBAYICg4AB4IEK84KAeIE8noIO3oEI0YAASIE6poIOOoNIvIEBHIEArAECggImgl9dgQ5egg+4A0ECSoEABYAtGoAAO4EAXYEAlIQAboEOP4IC/4ID8IM4LIEtKYQBR4EBEIE+HYIJWIAfxIEBQoAFfIMFT4MA9IAAFIEIVQIFa4QA8oAR+4UDbIUTBYEK4oAMuIIWuAMAQbqAAkeBAU+BEJCEAhyBGvEBf4I6nwIASIECxYIEioINWIQbhIMNBoMAgIEFBAEPgwJJgS/RggXIhgGkgoHagQB8AXGABdiBDj2CAmgBS4QD6IQ4NIITv4JD+IIAnIUNpgEPgA5XASSAFa+DAF2AhnKBHHGAbqCBA3yBABGABt6JAraBhQ2AA62AA1KHAOsFC7YCAQmABxmBOSyCgieCAsaABtECOwGAP0sBQYACQoAE7gRBB0GKgGaCARuALHGDDkaBHC4BCoE6ZoEEhoMBAYJ1eYEK2ICGaYADHoNCyIIaBYAZooF45oIW7oGMh4QC2IAv24EET4EFjgFLgRBtgAbOgAVegSe5gAQHggE9gxotgALtggDHgh/2ghYqggcdhQAlgHCjhgLzggLYgAtugRCLATuAAAeDQvqBCuYBCYJ05YEAHQHAgwAdAsAVgweagAASAcSDABIBxIBieYARWAIKQYA7hIEEtgRGIgMbhQD3gCTwgAMlARuEAQ+CATgC0AiAATiDDESAJPqBAF6CCr2CCY2ACr2BAHqDBpCAIryAEYeBQNGCef6CB7YBL4EFDIEANYFDOIIikIMBgIIAkIEOsoIcfIQHlYEhwYIPJIAHp4AzgwIDSIcH8Y0OgokPI40AHIgH8YATp4UAXIAH8YMPgIEFqIAU+4EMeoEAC4MK7IAk7AKQIYFBcgJ0IoEWpAQvAYYIiwCmAoQIgDawgwBLAQeAAKeAAjaDCJmDAKsBB4gAq4EHeIEAj4JUAIUtQ58Aq4BYkoUAYIAAq4MAYIEkJoEAq4QmF4UInwYJQRxrQWyBF7WCfxECkB6BOnCDAIyAAA8BoIA0hYA0mYMAkoAaCoIJSYBJAocJ/40AhoIuOoQAHJYQcIwJ/QEEgAqSgzSVhAChhABqhAAVhQCrgACCgQB6gQq0gQ1jgCbRgUgggA4SgR8eBIECSRuAAXgBI4MBeIAW94AC4YANoYMAt4ECGYBEpokRN4AAfQEGhgDakgCupBE6hwFsgADHhABggQe6hgFsAQaGI9oDCUEEgVregAjFgAFpAR+ADLCAADuAAAsDoBwigACLhAKigTSwgQK8hAIVgwB/hytZqgIHgX/TiwFnjwCghwByhQLShgCwgRzFgBhsgiF/AqAtgUNygALeAy8BgoGF6IJ8kwMvAYCBcneBAD2EAhSDXXabA2+iAiKBETCFALiAgIaEAQ2AiEWDALaBeIiDEKEFswsBCn+DBWuBBY8BIoAfEIEw7YAs9wEbghsvhAV5iwV1gI99ghzcgA6LgQcVgALygU2VgTgkg00Xgj+EgmntgILhgStDggWEgwVxgQs4gj3SgBVJghVjgABmggTFggDEgATFgR1CggSagQJ9gAFbgQJ9gD2OjAElgAHyAQWIASWNAeKJASWNAByIASWAXJuEASUBBYAB3YMAYIGCSIQBJ4EACwELgQqGgSXyhR4ngRXehxA4hBRUgXqYgRA6gQX4gAD0gRTlgh2whQDmASKCSSaDitmDIeSCA0+CAqaAHluCAfWZA02iArKCI/mBBWCBAMCCEhuBbe+ABByDAfOBG0GGD86CfBKBBraDAIqBKraBAQwELwG+FYB12oYEs4kDRsAAlIEEeo0AlIAF/IAAJ4IBZAEFhQ83gB1chFsFgSoXjQ8zgQ4TgQBtggasjA8zgQJrgi9njwHtjAU2gHbAgyfhgVCZgA/HgQaFhgBxhAAagCs/gQAagkrKgDwQhHs7gQfQjQE3AcL6ATcB/oUBN4QPmeIBN4APrJABM4NOxIIBJgHEjgEmAcb6ASYB9oUBJoIqHeQBJoMqOo0BJoAIQYN+FIIj/4IDkYIKA4At4gFGgA1zgQWPAQiBBYqBCgOAAA+ALiGBBY8BCIQKBwL/AYCXtoMQmoEJsYEQmoGRXYUMkIBNOoAMC4FKnYMNKIMOBYCM2IEAnYAOzgEEgAyugkONAQSAHRKCGyuAAWKABV+FAECCBLKBBKWBehSEMPOBABiALt6DABgBDYM9nQENgSpzgATvgQ9cghCPgAAIgj4agAuPgw1cgBraigBCggBjggBagXgWgQDtgQy3gQA/hA+tgXkygQEpgg9Vg38phA0ehQAVgCmLAwALg4EahIANGYKLyYQ7zoF2GoEACIVf84ApfoEACoEPggEggS+3gRYHgz0KAduAG6oEAUEWTYAru4AGs4BfxgSggAJxgCe4gQBNgzb1BAECAgKCC9oDQSpGgUA4AgVGgV/lAwBBOYEtAYEG+YACXwML3AmCAYaBkLWAQs6CAhQBLIEr9oAG34ByeoEAD4AAA4BUXoIruoMpOYMXo4J7nIJ6nIMCLgJBKoAWwAJ1IoB5KoEBtYACSIEAFwFsgwg5AVyAJaiAAYiBi0iBmHGABI6BAGuAAtyBYdeDFJsBT4ASTwFLgRbjgBwAAUWAZa0FIARHcnKBZBaCLJyEPNCADFuAai6ALKmBArqCAs6AW2qAHU2EFgOFABOAIpmGGnCHABaBk7CAJCqEGmWHABiAHY6GNKSDLnaAHKKEgC6BARiBAAgBOIIAxoFD5IEAt4AfvoI33oIBBIBEMoEAJYE3q4KKz4E3fYEvroALx4EADYAD8YIDboIAXQFcggANgVH9gDfGgQF/hRk/ghyqgDWFAhA3gi0NhwARggBWggANgQdeg4jigTlhhBrqgn36ggFjgBCcghjugQMTgn+Og33+gQGEggJ8gRB6gYFPggSbAiwigjMagnuFgRyjgi+MgQJjgQEkgQDZhAAlgi3XggPbAWyDAEOAABeAY2OBAdiAAWQBBIKYt4AAkYEuKIE0KIEASIEDw4FFAIQBIAGwgARGAUGDg4+CCUGBAHCCALCAAEKBAAcCtC2BQI2CErcBtIMAGYEwFoQBe4ADUYNBOIIAkAFsgSTPgQCLgglSgQChgwBBgWjBgQq/AgVJgDrTgABhggBIgQC0AVyBBT+AACMCxC2BHueCABMCxC2CDtUBBIM0JwEBgAMkgZ8MhAFCgTZXgSIAgQL+gQGtgBpkhgD0gi8LhAAlggCygQLVggmMgEILgCo5gQBfgpI2gwCggTnLgQHphAESgolqggFZmAESgEgVhBOsAWyDA1SFARyCAYeCBo6CAnCCP+yBBYqBMs2BG1iDATaADQEBA4ICP4MBLIGUVYMAjIIAOIUBLIAAo4QAPIABToMAWJABJIQBAYAMkoAKeIQDy4IDCIUD54EBDoAy2IIDt4QCUoFG+IAD0IMhhoAQtAFFhQO0AQaAYV6ElRmCAWODgtmDAKgBOIAFMYIMfINHdoF/9oID7IAE6gEagzHAgwGWARqCOzWAGJmBA/yDA0qBAwGCAWGBA7KBEucBQYBa0AEDgoqNAUGAQkuAHV6AJIUBi4Muz4JjnwEQgAqkgy9fghfJgGr5gRqTgZRnhAVsgjkFgBo7hQJxgBT5ggN/gi+VgAAYgAANgUSGgQQ2ggANhAPVgRptg4EKggBdgWVqgwAcgjVdggAWgACQBBALC4SBHe6BADKAZCeCBEiBJ6WCBAOCA0SCXCyCANGBAiuHHWiAOaYBGIEyp4M4rIIAcwEwgh73gUB/hBGLhQAThDpohABGgACkhAf2gAS4gAANgSI8BQuECQEPgQd3gSDogRk+gR2ugiSDhwByA3RBhYJaSAEAgTcpggARgAKzAoYCgjy1gzCEgzmvgTU8hABuAVSDAriDAoyABwSCAe8BSIEABQNYdHOAgF6BS3qAAA2EAq4BNIAfAoMWcIBQpYMU04EHUIAJTIIDR4IStYQBlQEsgAB5gUUWAgNrgQdtggQrAhA6gjXFggD7gjU7ggT1g1N4ggA0gDTFgwNagTR/gQARgTTFggMWgAAFAXCABQSGCQ6SACqBjvebACKCNd2CBnaBhFWGNd2AEVyBNd2EFZ+DJUqBbxmBUiSBXVmBDn+EEKyBRMCAF8QCkCOBCDCCDVyKADaCAHsBdIIA34EE34ABP4IADQKkLYEUSIEAlYFFVoABgIMD3QKAAYUeEoIV04AN6wFgggGIgRz7ggEkAUiDB7EBbIMEXwE0gBfTgQGMgCyFgQGCg0X7AVSATfeBAa6BLTmBAEmCAPaEBdeBFIqECR8DEHRzgE6AgXGyAUiCbdEBDIMByoAlXoIBx4EWIYJfWYELGIMKUoUAkYIpSYI1A4QAV4AksIA4K4ILfoM2+ocEuoQAd4IEIYAAD4FUqYQCQ4MCbIFU7oMBjoECXoEAGYIATYILMoIANYEASYQ7S5YBxogaprAAH4ML3IFSwJQBvYQ3FYMA1YcBTII3FIIBy4Kbj4FEoIQGToALSoE3GYIAwAECgzcZgQQXgjcZgwBGiATxgQAHgztQgpnHgaIogwY4gAFgAU+AR+2HOqeEAF6CaZKEAF4BAYQ6V4GW34E6pI0AXoI6pIQAYgEbg0YtAqAtgzpRnQBPmQCtgUaZgAdfgSH2Agu+gKYsggA/ASyAC6mAA+KDCmuCoIuBAAmCNN6CBFEBaoEUi4IAHQEsgAOaggSWgQdUgRGmgZV5gBiMhQWvAXCAClaBXoeEAkeACmOCPL2EBi+BABwBXIMEfgK0LYI+5IELmoQIdAFEgQAFAUyBHemDEcuBRCKBAIqAAQiCBuqDEOyAAAyCQ/4EIAhPG4Qlo4ALg4QJgIMMnoIapIIYzqUAO4AXuYANz4QIaICFkYJG/IECRIMFeYMBYgIEaoAHJgIQN4IAEoIH2AF0gwAwgQfRgRMQgAWJhAJ3gQhuggD/gUKBgB5Xghw7hwM6gQ0NgQM8ggQPAViAMSiABZyAH+2AURaBECaBErWAAH6ClCqDQH6BKi+AA/IBCIQAJoIA6IAABYBKS4gFwoIBNwEigFI0ggP7gBzcgwMFghrOggFkhRyHgh2sgliDgRozAYWBAAqEAhyBP9CFCWyDCWkBxIAfU4IjC4MlG4IBCYAjPoACZYFgBgGCgjsKgaPdAQGAAAyACIWBIxyAidOFSoCBA0KBCEqCOKeBnIyCD0yCPAqAAEKBpV+BAq6BicOBAAeEDO+AB4yAFCOFAEEBAYKfUYOGsYEAj4ANAoAAQ4EUcYAJIQMLqwSAH5SBABkBfIEZR4Ao34EADAF4gwF9AowBhQ07hArlAixrgALjgRnAgQVKAQOAYe2CBYABkICPvYIA24ABlYAMVIAANIIFkAE4gBzJgaAwgVEWgAWUAQeCPZOBKvWBLvaBBNODWCKBAAqCAJoBNIAdgIEBmIMdKYEK1oBdwIEL/4MAL4AZ84JOoIIAMgIgC4IIk4EACoFaO4QADYADSoM+CoE9+IMSMIhmMIY9/4AAgIIALYEFfYE90IAADYAB0YI+BYAL9IExLoAADYA6QIACkoExIoAADYAJx4AAUIExFoAADYA+DoAEnoExCoAADYA+EYABg4Ew/oAADYIUaoEFSoEHPIAQDIIPSoAuq4E+F4AHjIEguIM+HoAAn4Q+HoEQfIOFS4BfT4EACoJAB4Ad3AEGg0XTgBE1AQaDoPaCW1uCHKOAANeCFPOCHkuCWuaAbeaDAhSAAu6DJ9mAAuaASgEBIIIi6wEDg06NgQD5gwF3gCwoggAKgAAUgU6XAQyATRiAX/OCAwmBA+YBAYELroEudwIiCYECzoEZS4EABAVJGwugC4EcKYMJc4EqGYQJc4UJdYICBYkJcwFFgwIXgQl0gECcgAFdgELiggV9kQlzggJimglzgwf1kwlzgglsgAKVhRwDgghxAzYCeIQFU4BlGIACFYEiQIAATwFggU6IhQBQAYCCAO+BAt2CCaGEBHSFCaQBBIAJpIMH9oBMtoYm0YIeTIALpYAB/QFBgAFDgwA1gQBngFQDASCBANmIAGyCAtwBeIKjVoMI6AEFhWDIgAAYiQeRggY3gQNCgAAJhQnogwqIAWSAD+6AAk+bB8eAUL3HCe2BKNy0Ce0BeIEd34IJK4QBfIA/UIAHnoAAjIAo5IEbFYJaI4EA3YMGoQGkggD6AqAtjgmugB3lhB2yhAIjgQUMgjTMiQIegAWYlQXPgyBkiwnKghojhAnLAXiECcuDAhOCCbwBaIUJ2YEOc4GRj4YJeQFcgVCHhggqAQSFCCqAowqaCNeCpLOAAAoBaIUFjoIF/oQE9/IJ1IcJuIgJVZAJs4IC1JQJtoQDYoEKDoYImoYKKIYA+gEEgqFtgwFVlAAugASYgqla/wEhhwEhggII6AqLhgJhuAqLgQRegI7RAwALP4IPmoEAHo8XIIY/xpQAH4AAHIJSNgIEQIABlAEDgAANAoMHgTdahT9igBDTgCIlgS48gE1tgJeBglCwjnXrhQ7vgRX4AUGAI7CAADABf4BQqAEGgqR4AgBIgD+OgROdgRY/gjLogFUYgnqFggUxgTV4gReJggbcgBd6gpDQAghJgSG8AktygBXzgFLiggUQgXY/AciACY2BVM+DAHCDXj2DV4yBBWOCmcgCQSqBEIqAAV+CFrkEQv//gYJs2QFUgAAMA4CAgoBRdwE3gFvEgE5TgQFmgAl5glZoghaDgQAMgVragQrdg1SYgQB1gSPPggDkgAB3gVVEhAAWgU+GiQAZggLHggAXAUyHABeCQhSAAB0BxIEek4AAXoBZG4A4yoAACQGchDEIASiBAA+AGF6EADCBBICBZLiAAEYBnIEsDwECgF6xgHuigxUUATiCV6mABPOEAAgBRIJLNYKS24NEOoABkQGAgmdsgEEUgHiRggf9gQB+AYiBI4SAC0UBhIEAjoAqGYBpJIIKVAE2gkVdgUM1AWyABZ4BNoAEG4OQmgIQNIIB3YAAjIATdop3F4AAp4GPEYNfUoUSGYNBu4AFJ4EaUYEKJIFlSYNBvQRBOUEqgSWPgAHUgqcKgiuJgQL+g0tKgjVng1KKgAqXgEvvgQBmgBOjgwgrhEP6BkGIETYCuICPYIAAC4AfCIAUb4KPbIB6KgGsgwAVgAiWgAC8gQAVAeCAABUBoIMAFYAIo4AA34EAFQF+gngTgCqQgwC9gQCuASyABiKEW4SFRCiCKBIBRIA4GoQyvoIWXoULgYZEIYIqoAIgN4EG3IEAq4BtYoUAEoRENwFIgwEXgDBbAgxsgBjkApQggQlaATaACyuBA28CQZCEAA8BjIMADwGShAAPAYCDAA8BloQADwF8gQ5gAgtDgxlcgVowlxlcgg1rgThNghlcgQAKgAE5gHkoAUmCBBoDCwvjgI0dgAIUBAuhBGmAsxsFZmZpY2mAsqABIIO0lBMAMS4zLjEuMS1tb3RsZXkAaW52gLMoFWQgbGl0ZXJhbC9sZW5ndGhzIHNldIYAHAVjb2RlIIkAGQ91bmtub3duIGhlYWRlciCAs44BZ4sAMgJkaYCzMgFugLPEigAWA2JpdIQARxAgcmVwZWF0AHRvbyBtYW55hQAXB3N5bWJvbHOOABgCb3KGAFOGACSFAFaCs6+AAF2As/sBa4UApgIAYoAA+IAAmgxlcnJvcgBzdHJlYW2EAA2KANULLS0gbWlzc2luZyCAtGIELW9mLYIAR4AAJQJjb4Cz6AJjdIUA4wNjaGWKABeEAJiNABcEZGF0YYYAFYsBCwEggQDUBWZhciBigLRLAQCFAFcCcmOBAIEFbWF0Y2iGADIBd4C0rwRvdyBzgbS+hgE7ggDeA3R5cIcAE4sBsoIA0I8AdYIAFoUBrwRjb21wgLTfAXOAtKSAAg4EdGhvZIAyJwQMC6UCgLcLDAAFAAYABwAIAAkACoApBw0NAA8AEQATABcAGwAfgJUpFisAMwA7AEMAUwBjAHMAgwCjAMMA4wCABjiCAAEBgIwAAgGBhAACAYKEAAIBg4QAAgGEhAACAYWEAAIFkABJAMiCGMyArQSCAIQBB4AAgAENgAB6ARmAKSkBMYADjAFhgABGAcGASOoBgYFI7IBAFgQBBgEIgCkMAxABGIAFvAkwAUABYAGAAcCJAHiFAHCFAGgBhoAAAgGHgAACAYiAAAIBiYAAAgGKgAACAYuAAAIBjIAAAgGNgAACAY6AAAIBEIAAcgESgACIAQiCAIABBoABAgEFgAEEAwQADIAAloAcnAIADoAAogEPgK/uBA4Ltwy1ASyAHNWCAAEBEIwAAgERhAACARKEAAIBE4QAAgEUhAACARWEAAIBEMABLIkAgIUAdIUAbIEAZAEWgAACAReAAAIBGIAAAgEZgAACARqAAAIBG4AAAgEcgAACAR2AAAIBQIAAAgagCAAAoA2BuSgDAAAegAAEAQ+AAFQBIIAAEAIgDoMA4AEegAAEgQAUgQABAaCEABQBE4AABAEHhAAUAQyAATgBjIAABAFMgAAEAcyAAAQBLIAABAGsgAAEAWyAAAQB7IAABAEcgAAEAZyAAAQBXIAABAHcgAAEATyAAAQBvIAABAF8gAAEAfyAAAQBAoAABAGCgAAEAUKAAAQBwoAABAEigAAEAaKAAAQBYoAABAHigAAEARKAAAQBkoAABAFSgAAEAdKAAAQBMoAABAGygAAEAXKAAAQB8oAABAEKgAAEAYqAAAQBSoAABAHKgAAEASqAAAQBqoAABAFqgAAEAeqAAAQBGoAABAGagAAEAVqAAAQB2oAABIB5uAIAuoAABAF6gAAEAfqAAAQBBoAABAGGgAAEAUaAAAQBxoAABAEmgAAEAaaAAAQBZoAABAHmgAAEARaAAAQBloAABAFWgAAEAdaAAAQBNoAABAG2gAAEAXaAAAQB9oAABAEOgAAEAY6AAAQBToAABAHOgAAEAS6AAAQBroAABAFugAAEAe6AAAQBHoAABAGegAAEAV6AAAQB3oAABAE+gAAEAb6AAAQBfoAABAH+gAAEAQGAAAQBgYAABAFBgAAEAcGAAAQBIYAABAGhgAAEAWGAAAQB4YAABAERgAAEAZGAAAQBUYAABAHRgAAEATGAAAQBsYAABAFxgAAEAfGAAAQBCYAABAGJgAAEAUmAAAQByYAABAEpgAAEAamAAAQBaYAABAHpgAAEARmAAAQBmYAABAFZgAAEAdmAAAQBOYAABAG5gAAEAXmAAAQB+YAABAEFgAAEAYWAAAQBRYAABAHFgAAEASWAAAQBpYAABAFlgAAEAeWAAAQBFYAABAGVgAAEAVWAAAQB1YAABAE1gAAEAbWAAAQBdYAABAH1gAAEAQ2AAAQBjYAABAFNgAAEAc2AAASAETMCAK2AAAQBbYAABAHtgAAEAR2AAAQBnYAABAFdgAAEAd2AAAQBPYAABAG9gAAEAX2AAAQB/YAABAETgADCBRMBCQCTgAAIAZOAAAgBU4AACAFTgAAIAdOAAAgB04AACAEzgAAIATOAAAgBs4AACAGzgAAIAXOAAAgBc4AACAHzgAAIAfOAAAgBC4AACIAQ2oAEAoAABIAACAFLgAAIAUuAAAgBy4AACAHLgAAIASuAAAgBK4AACAGrgAAIAauAAAgBa4AACAFrgAAIAeuAAAgB64AACAEbgAAIARuAAAgBm4AACAGbgAAIAVuAAAgBW4AACAHbgAAIAduAAAgBO4AACAE7gAAIAbuAAAgBu4AACAF7gAAIAXuAAAgB+4AACAH7gAAIgQO2AQeAAAgBh4AACAGHgAAIAUeAAAgBR4AACAHHgAAIAceAAAgBJ4AACAEngAAIAaeAAAgBp4AACAFngAAIAWeAAAgB54AACAHngAAIAReAAAgBF4AACAGXgAAIAZeAAAgBV4AACAFXgAAIAdeAAAgB14AACAE3gAAIATeAAAgBt4AACAG3gAAIAXeAAAgBd4AACAH3gAAIAfeAAAgBD4AACAEPgAAIAY+AAAgBj4AACAFPgAAIAU+AAAgBz4AACAHPgAAIAS+AAAgBL4AACAGvgAAIAa+AAAgBb4AACAFvgAAIAe+AAAgB74AACAEfgAAIAR+AAAgBn4AACAGfgAAIAV+AAAgBX4AACAHfgAAIAd+AAAgBP4AACAE/gAAIAb+AAAgBv4AACAF/gAAIAX+AAAgB/4AACAH/gAAIgQQKAUCAAAQBIIAABAFggAAEARCAAAQBUIAABAEwgAAEAXCCBVYDBwBIgAAEASiAAAQBaIAABAEYgAAEAViAAAQBOIAABAF4gAAEAQSAAAQBRIAABAEkgAAEAWSAAAQBFIAABAFUgAAEATSAAAQBdIAABAEDgABCAYOAAAQBQ4AABAHDgAAEASOAAAQBo4AABAFjgAAEAeOAAASAveaAAHSBAsYBBYAAXAEFggVKARSAAAQBDIAABAEcgAAEgL34gAREAQWCBgQBGoIF6gEFgAPUAQWAA7gBBYADnIBPdoAABAERgAAEAQmAAAQBGYAABIEAAgEVgAAEAQ2AAAQBHYAABAEDgAAEAROCBkABBYACLIEFpgEFgAG0AQWAPd8DGwtNgx+5hwAEAQKMAASBB1GJAAQBBIwABAEFigAEBEGwHAuAvMWLAEuNADuFAC8BBoQABIEFiIEABIEBCoEABIEBkoEABICEcYIABAELhAAEAQyEAASABduBR3kE4B0LI4UAX4UFywIQEYAFbQYHCQYKBQuAOrgEDQIOAYAHJQSUHgtphQCQhQCIhQCAhQB4gQBogQBcgQYfARCAAAQBFIAABAEYgAAEARyAAAQBIIAABAEogAAEATCAAAQBOIAABAFAgAAEAVCAAASBBr0BcIAABAGAgAAEAaCAAAQBwIAABAHggABvAx8Lco0Ab4EAa4EAZ4EAY4EAX4EAW4EAV4EAU4EAT4EAS4EAR4EAQ4EBPAGArwBBgFHNAgttgQDHAQSAAAIBCIAABIEBM4ECSwEQgAAOgwAMgYVpgKomhAAkgQdzgQBPAQiAAAiBABiFAAyBCLeDAAwBIIEAlIAyhIEAawGAgQgvAQSDAAyAP0gKAQAQDABBkSEL/4AlHwEDgpvTBQgJCQoKgEk3gAABAQ2AAAEBDoAAAQEPgAABARCEAAEBEYQAAQEShAABAROEAAEBFIwAAQEVjAABARaMAAEBF4wAAQEYnAABARmcAAEBGpwAAQEbmwABARyBffsEBAQFBYHBkAEHgAABAQiEAAGAXSqCAAEBCowAAYAnsooAAYEBMJkAAYEBTJkAAYEBaLkAAYEBpLkAAYIDdYABzoUBvI0BqJ0BkLwBgAIbHLwAAQEdvAABgA9PgH05A9AqAQ==")),t)})}(Zse),function({initModule:e}){uce=e}({initModule:e=>{if(!Ele){let{wasmURI:t}=e;typeof t==Xse&&(t=t()),Ele=async function(e,{baseURI:t}){if(!Sle){let n,i;try{try{i=new URL(e,t)}catch{}const o=await fetch(i);n=await o.arrayBuffer()}catch(t){if(!e.startsWith("data:application/wasm;base64,"))throw t;n=function(e){const t=e.split(",")[1],n=atob(t),i=n.length,o=new Uint8Array(i);for(let e=0;e<i;++e)o[e]=n.charCodeAt(e);return o.buffer}(e)}!function(e){if(Tle=e,({malloc:ble,free:wle,memory:xle}=Tle),"function"!=typeof ble||"function"!=typeof wle||!xle)throw Tle=ble=wle=xle=null,new Error("Invalid WASM module")}((await WebAssembly.instantiate(n)).instance.exports),Sle=!0}}(t,e)}return Ele}}),Zse({CompressionStreamZlib:class{constructor(e="deflate",t){return Cle(!0,e,t)}},DecompressionStreamZlib:class{constructor(e="deflate",t){return Cle(!1,e,t)}}});var Ile=n(872203);const Ple=function(e,t){this.position=e,this.headingPitchRoll=t},Dle=function(e,t){this.position=e,this.headingPitchRange=t};function Ole(e,t){this.id=t,this.name=e,this.playlistIndex=0,this.playlist=[],this.tourStart=new lte.A,this.tourEnd=new lte.A,this.entryStart=new lte.A,this.entryEnd=new lte.A,this._activeEntries=[]}function Rle(e){for(let t=e.pop();void 0!==t;t=e.pop())t.stop()}function Mle(e,t,n){const i=this.playlist[this.playlistIndex];if(i){const o=Lle.bind(this,e,t,n);if(this._activeEntries.push(i),this.entryStart.raiseEvent(i),i.blocking)i.play(o,e.scene.camera,t);else{const r=this;i.play(function(){r.entryEnd.raiseEvent(i);const e=r._activeEntries.indexOf(i);e>=0&&r._activeEntries.splice(e,1)}),o(e,t,n)}}else(0,$9.A)(n)&&n(!1)}function Lle(e,t,n,i){const o=this.playlist[this.playlistIndex];if(this.entryEnd.raiseEvent(o,i),i)n(i);else{const i=this._activeEntries.indexOf(o);i>=0&&this._activeEntries.splice(i,1),this.playlistIndex++,Mle.call(this,e,t,n)}}Ole.prototype.addPlaylistEntry=function(e){this.playlist.push(e)},Ole.prototype.play=function(e,t){this.tourStart.raiseEvent();const n=this;Mle.call(this,e,t,function(e){n.playlistIndex=0,e||Rle(n._activeEntries),n.tourEnd.raiseEvent(e)})},Ole.prototype.stop=function(){Rle(this._activeEntries)};const Nle=Ole;var Ble=n(228894),Fle=n(464850),Ule=n(964218);function kle(e,t,n){this.type="KmlTourFlyTo",this.blocking=!0,this.activeCamera=null,this.activeCallback=null,this.duration=e,this.view=n,this.flyToMode=t}kle.prototype.play=function(e,t,n){if(this.activeCamera=t,(0,$9.A)(e)&&null!==e){const t=this;this.activeCallback=function(n){delete t.activeCallback,delete t.activeCamera,e(!(0,$9.A)(n)&&n)}}const i=this.getCameraOptions(n);if(this.view.headingPitchRoll)t.flyTo(i);else if(this.view.headingPitchRange){const e=new Ble.A(this.view.position);t.flyToBoundingSphere(e,i)}},kle.prototype.stop=function(){(0,$9.A)(this.activeCamera)&&this.activeCamera.cancelFlight(),(0,$9.A)(this.activeCallback)&&this.activeCallback(!0)},kle.prototype.getCameraOptions=function(e){let t={duration:this.duration};return(0,$9.A)(this.activeCallback)&&(t.complete=this.activeCallback),"smooth"===this.flyToMode&&(t.easingFunction=Ule.A.LINEAR_NONE),this.view.headingPitchRoll?(t.destination=this.view.position,t.orientation=this.view.headingPitchRoll):this.view.headingPitchRange&&(t.offset=this.view.headingPitchRange),(0,$9.A)(e)&&(t=(0,Fle.A)(t,e)),t};const Vle=kle;function zle(e){this.type="KmlTourWait",this.blocking=!0,this.duration=e,this.timeout=null}zle.prototype.play=function(e){const t=this;this.activeCallback=e,this.timeout=setTimeout(function(){delete t.activeCallback,e(!1)},1e3*this.duration)},zle.prototype.stop=function(){clearTimeout(this.timeout),(0,$9.A)(this.activeCallback)&&this.activeCallback(!0)};const Hle=zle;var Gle=n(145024);const Wle={avi:"video/x-msvideo",bmp:"image/bmp",bz2:"application/x-bzip2",chm:"application/vnd.ms-htmlhelp",css:"text/css",csv:"text/csv",doc:"application/msword",dvi:"application/x-dvi",eps:"application/postscript",flv:"video/x-flv",gif:"image/gif",gz:"application/x-gzip",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",jnlp:"application/x-java-jnlp-file",jpeg:"image/jpeg",jpg:"image/jpeg",m3u:"audio/x-mpegurl",m4v:"video/mp4",mathml:"application/mathml+xml",mid:"audio/midi",midi:"audio/midi",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mp4v:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogg:"application/ogg",pdf:"application/pdf",png:"image/png",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",ps:"application/postscript",qt:"video/quicktime",rdf:"application/rdf+xml",rss:"application/rss+xml",rtf:"application/rtf",svg:"image/svg+xml",swf:"application/x-shockwave-flash",text:"text/plain",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/x-wav",wma:"audio/x-ms-wma",wmv:"video/x-ms-wmv",xml:"application/xml",zip:"application/zip",detectFromFilename:function(e){let t=e.toLowerCase();return t=(0,Lse.A)(t),Wle[t]}};let Yle;"undefined"!=typeof DOMParser&&(Yle=new DOMParser);const qle=new Hy({stripPrefix:!1,email:!1,replaceFn:function(e){return"scheme"===e.urlMatchType||"www"===e.urlMatchType}}),jle=32,Qle=2414016,Xle=16093e3,Kle=[null,void 0,"http://www.opengis.net/kml/2.2","http://earth.google.com/kml/2.2","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.0"],$le=["http://www.google.com/kml/ext/2.2"],Jle={kml:Kle,gx:$le,atom:["http://www.w3.org/2005/Atom"],kmlgx:Kle.concat($le)},Zle={Document:Vue,Folder:function(e,t,n,i){const o=kue(e,t,n),r=(0,xee.A)(n);r.parentEntity=o.entity,Vue(0,t,r,i)},Placemark:function(e,t,n,i){const o=kue(e,t,n),r=o.entity,s=o.styleEntity;let a=!1;const c=t.childNodes;for(let t=0,i=c.length;t<i&&!a;t++){const i=c.item(t),o=Fue[i.localName];(0,$9.A)(o)&&(o(e,n.entityCollection,i,r,s,r.id),a=!0)}a||(r.merge(s),Mue(e,r,s))},NetworkLink:function(e,t,n,i){const o=kue(e,t,n).entity,r=n.sourceResource,s=n.uriResolver;let a=hue(t,"Link",Jle.kml);if((0,$9.A)(a)||(a=hue(t,"Url",Jle.kml)),(0,$9.A)(a)){let t,c,l=mue(a,"href",Jle.kml);if((0,$9.A)(l)){let u=l;if(l=_ue(l,r,n.uriResolver),/^data:/.test(l.getUrlComponent()))/\.kmz/i.test(r.getUrlComponent())||(u=r.getDerivedResource({url:u}));else{if(u=l.clone(),t=mue(a,"viewRefreshMode",Jle.kml),"onRegion"===t)return void(0,Fse.A)("kml-refrehMode-onRegion","KML - Unsupported viewRefreshMode: onRegion");c=mue(a,"viewBoundScale",Jle.kml)??1;const n="onStop"===t?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",i=mue(a,"viewFormat",Jle.kml)??n,o=mue(a,"httpQuery",Jle.kml);(0,$9.A)(i)&&l.setQueryParameters((0,Use.A)(jue(i))),(0,$9.A)(o)&&l.setQueryParameters((0,Use.A)(jue(o)));const r=e._ellipsoid;Jue(l,e.camera,e.canvas,c,e._lastCameraView.bbox,r)}const d={sourceUri:u,uriResolver:s,context:o.id,screenOverlayContainer:n.screenOverlayContainer},h=new Mie.A,A=ede(e,h,l,d).then(function(n){const i=e._entityCollection,r=h.values;i.suspendEvents();for(let e=0;e<r.length;e++){const t=r[e];(0,$9.A)(t.parent)||(t.parent=o,nde(t)),i.add(t)}i.resumeEvents();const s=mue(a,"refreshMode",Jle.kml);let u=fue(a,"refreshInterval",Jle.kml)??0;if("onInterval"===s&&u>0||"onExpire"===s||"onStop"===t){const t=hue(n,"NetworkLinkControl",Jle.kml),i=(0,$9.A)(t),r=kne.A.now(),d={id:(0,Ine.A)(),href:l,cookie:{},lastUpdated:r,updating:!1,entity:o,viewBoundScale:c,needsUpdate:!1,cameraUpdateTime:r};let h=0;if(i&&(d.cookie=(0,Use.A)(mue(t,"cookie",Jle.kml)??""),h=fue(t,"minRefreshPeriod",Jle.kml)??0),"onInterval"===s)i&&(u=Math.max(h,u)),d.refreshMode=que.INTERVAL,d.time=u;else if("onExpire"===s){let e;if(i&&(e=mue(t,"expires",Jle.kml)),(0,$9.A)(e))try{const t=kne.A.fromIso8601(e),n=kne.A.secondsDifference(t,r);n>0&&n<h&&kne.A.addSeconds(r,h,t),d.refreshMode=que.EXPIRE,d.time=t}catch(e){(0,Fse.A)("kml-refreshMode-onInterval-onExpire","KML - NetworkLinkControl expires is not a valid date")}else(0,Fse.A)("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element")}else(0,$9.A)(e.camera)?(d.refreshMode=que.STOP,d.time=fue(a,"viewRefreshTime",Jle.kml)??0):(0,Fse.A)("kml-refrehMode-onStop-noCamera","A NetworkLink with viewRefreshMode=onStop requires the `camera` property to be defined.");(0,$9.A)(d.refreshMode)&&e._networkLinks.set(d.id,d)}}).catch(function(t){(0,Fse.A)(`An error occured during loading ${l.url}`),e._error.raiseEvent(e,t)});i.addPromise(A)}}},GroundOverlay:function(e,t,n,i){const o=kue(e,t,n).entity;let r,s=!1;const a=e._ellipsoid,c=lue(hue(t,"LatLonQuad",Jle.gx),a),l=fue(t,"drawOrder",Jle.kml);if((0,$9.A)(c))r=wue(),r.hierarchy=new Gne.A(c),r.zIndex=l,o.polygon=r,s=!0;else{r=new Toe.A,r.zIndex=l,o.rectangle=r;const e=hue(t,"LatLonBox",Jle.kml);if((0,$9.A)(e)){let t=fue(e,"west",Jle.kml),n=fue(e,"south",Jle.kml),i=fue(e,"east",Jle.kml),o=fue(e,"north",Jle.kml);(0,$9.A)(t)&&(t=nne.A.negativePiToPi(nne.A.toRadians(t))),(0,$9.A)(n)&&(n=nne.A.clampToLatitudeRange(nne.A.toRadians(n))),(0,$9.A)(i)&&(i=nne.A.negativePiToPi(nne.A.toRadians(i))),(0,$9.A)(o)&&(o=nne.A.clampToLatitudeRange(nne.A.toRadians(o))),r.coordinates=new Ate.A(t,n,i,o);const s=fue(e,"rotation",Jle.kml);if((0,$9.A)(s)){const e=nne.A.toRadians(s);r.rotation=e,r.stRotation=e}}}const u=hue(t,"Icon",Jle.kml),d=Cue(u,e,n.sourceResource,n.uriResolver,!0);if((0,$9.A)(d)){s&&(0,Fse.A)("kml-gx:LatLonQuad","KML - gx:LatLonQuad Icon does not support texture projection.");const e=fue(u,"x",Jle.gx),n=fue(u,"y",Jle.gx),i=fue(u,"w",Jle.gx),o=fue(u,"h",Jle.gx);((0,$9.A)(e)||(0,$9.A)(n)||(0,$9.A)(i)||(0,$9.A)(o))&&(0,Fse.A)("kml-groundOverlay-xywh","KML - gx:x, gx:y, gx:w, gx:h aren't supported for GroundOverlays"),r.material=d,r.material.color=Tue(t,"color",Jle.kml),r.material.transparent=!0}else r.material=Tue(t,"color",Jle.kml);let h=mue(t,"altitudeMode",Jle.kml);(0,$9.A)(h)?"absolute"===h?(r.height=fue(t,"altitude",Jle.kml),r.zIndex=void 0):"clampToGround"!==h&&(0,Fse.A)("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${h}`):(h=mue(t,"altitudeMode",Jle.gx),"relativeToSeaFloor"===h?((0,Fse.A)("kml-altitudeMode-relativeToSeaFloor","KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute."),r.height=fue(t,"altitude",Jle.kml),r.zIndex=void 0):"clampToSeaFloor"===h?(0,Fse.A)("kml-altitudeMode-clampToSeaFloor","KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround."):(0,$9.A)(h)&&(0,Fse.A)("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${h}`))},PhotoOverlay:Yue,ScreenOverlay:function(e,t,n,i){const o=n.screenOverlayContainer;if(!(0,$9.A)(o))return;const r=n.sourceResource,s=n.uriResolver,a=Cue(hue(t,"Icon",Jle.kml),e,r,s,!1);if(!(0,$9.A)(a))return;const c=document.createElement("img");e._screenOverlays.push(c),c.src=a.url,c.onload=function(){const e=["position: absolute"],n=hue(t,"screenXY",Jle.kml),i=hue(t,"overlayXY",Jle.kml),o=hue(t,"size",Jle.kml);let r,s,a,l,u,d;(0,$9.A)(o)&&(r=uue(o,"x"),s=uue(o,"y"),a=due(o,"xunits"),l=due(o,"yunits"),(0,$9.A)(r)&&-1!==r&&0!==r&&("fraction"===a?u=`width: ${Math.floor(100*r)}%`:"pixels"===a&&(u=`width: ${r}px`),e.push(u)),(0,$9.A)(s)&&-1!==s&&0!==s&&("fraction"===l?d=`height: ${Math.floor(100*s)}%`:"pixels"===l&&(d=`height: ${s}px`),e.push(d))),c.style=e.join(";");let h=0,A=c.height;(0,$9.A)(i)&&(r=uue(i,"x"),s=uue(i,"y"),a=due(i,"xunits"),l=due(i,"yunits"),(0,$9.A)(r)&&("fraction"===a?h=r*c.width:("pixels"===a||"insetPixels"===a)&&(h=r)),(0,$9.A)(s)&&("fraction"===l?A=s*c.height:("pixels"===l||"insetPixels"===l)&&(A=s))),(0,$9.A)(n)&&(r=uue(n,"x"),s=uue(n,"y"),a=due(n,"xunits"),l=due(n,"yunits"),(0,$9.A)(r)&&("fraction"===a?u=`left: calc(${Math.floor(100*r)}% - ${h}px)`:"pixels"===a?u=`left: ${r-h}px`:"insetPixels"===a&&(u=`right: ${r-h}px`),e.push(u)),(0,$9.A)(s)&&("fraction"===l?d=`bottom: calc(${Math.floor(100*s)}% - ${A}px)`:"pixels"===l?d=`bottom: ${s-A}px`:"insetPixels"===l&&(d=`top: ${s-A}px`),e.push(d))),c.style=e.join(";")},o.appendChild(c)},Tour:function(e,t,n,i){const o=mue(t,"name",Jle.kml),r=due(t,"id"),s=new Nle(o,r),a=hue(t,"Playlist",Jle.gx);if(a){const t=e._ellipsoid,n=a.childNodes;for(let e=0;e<n.length;e++){const i=n[e];if(i.localName){const e=zue[i.localName];e?e(s,i,t):console.log(`Unknown KML Tour playlist entry type ${i.localName}`)}}}e._kmlTours.push(s)}};function eue(e){this._dataSource=e,this._deferred=(0,Mse.A)(),this._stack=[],this._promises=[],this._timeoutSet=!1,this._used=!1,this._started=0,this._timeThreshold=1e3}function tue(e){const t={xsi:"http://www.w3.org/2001/XMLSchema-instance"};let n,i,o,r;for(const s in t)t.hasOwnProperty(s)&&(o=RegExp(`[< ]${s}:`),r=`xmlns:${s}=`,o.test(e)&&-1===e.indexOf(r)&&((0,$9.A)(n)||(n=e.substr(0,e.indexOf("<kml")+4),i=e.substr(n.length)),n+=` ${r}"${t[s]}"`));return(0,$9.A)(n)&&(e=n+i),e}function nue(e){let t=e.indexOf("xmlns:");const n=e.indexOf(">",t);let i,o,r;for(;-1!==t&&t<n;)i=e.slice(t,e.indexOf('"',t)),o=t,t=e.indexOf(i,t+1),-1!==t?(r=e.indexOf('"',e.indexOf('"',t)+1),t=(e=e.slice(0,t-1)+e.slice(r+1,e.length)).indexOf("xmlns:",o-1)):t=e.indexOf("xmlns:",o+1);return e}async function iue(e,t){const n=Wle.detectFromFilename(e.filename)??"application/octet-stream",i=await e.getData(new Sce(n));t[e.filename]=i}function oue(e,t,n,i){const o=i.keys,r=new ra("."),s=e.querySelectorAll(t);for(let e=0;e<s.length;e++){const a=s[e],c=a.getAttribute(n);if((0,$9.A)(c)){const e=new ra(c).absoluteTo(r).toString(),s=o.indexOf(e);if(-1!==s){const e=o[s];a.setAttribute(n,i[e]),"a"===t&&null===a.getAttribute("download")&&a.setAttribute("download",e)}}}}function rue(e,t,n,i){const o=e.querySelectorAll(t);for(let e=0;e<o.length;e++){const t=o[e],r=_ue(t.getAttribute(n),i);(0,$9.A)(r)&&t.setAttribute(n,r.url)}}function sue(e,t,n){let i=due(e,"id");i=(0,$9.A)(i)&&0!==i.length?i:(0,Ine.A)(),(0,$9.A)(n)&&(i=n+i);let o=t.getById(i);return(0,$9.A)(o)&&(i=(0,Ine.A)(),(0,$9.A)(n)&&(i=n+i)),o=t.add(new Ile.A({id:i})),(0,$9.A)(o.kml)||(o.addProperty("kml"),o.kml=new ode),o}function aue(e,t){return"absolute"===e||"relativeToGround"===e||"relativeToSeaFloor"===t}function cue(e,t){if(!(0,$9.A)(e))return ete.A.fromDegrees(0,0,0,t);const n=e.match(/[^\s,\n]+/g);if(!(0,$9.A)(n))return ete.A.fromDegrees(0,0,0,t);let i=parseFloat(n[0]),o=parseFloat(n[1]),r=parseFloat(n[2]);return i=isNaN(i)?0:i,o=isNaN(o)?0:o,r=isNaN(r)?0:r,ete.A.fromDegrees(i,o,r,t)}function lue(e,t){if(!(0,$9.A)(e))return;const n=e.textContent.match(/[^\s\n]+/g);if(!(0,$9.A)(n))return;const i=n.length,o=new Array(i);let r=0;for(let e=0;e<i;e++)o[r++]=cue(n[e],t);return o}function uue(e,t){if(!(0,$9.A)(e))return;const n=e.getAttribute(t);if(null!==n){const e=parseFloat(n);return isNaN(e)?void 0:e}}function due(e,t){if(!(0,$9.A)(e))return;const n=e.getAttribute(t);return null!==n?n:void 0}function hue(e,t,n){if(!(0,$9.A)(e))return;const i=e.childNodes,o=i.length;for(let e=0;e<o;e++){const o=i[e];if(o.localName===t&&-1!==n.indexOf(o.namespaceURI))return o}}function Aue(e,t,n){if(!(0,$9.A)(e))return;const i=[],o=e.getElementsByTagNameNS("*",t),r=o.length;for(let e=0;e<r;e++){const r=o[e];r.localName===t&&-1!==n.indexOf(r.namespaceURI)&&i.push(r)}return i}function pue(e,t,n){if(!(0,$9.A)(e))return[];const i=[],o=e.childNodes,r=o.length;for(let e=0;e<r;e++){const r=o[e];r.localName===t&&-1!==n.indexOf(r.namespaceURI)&&i.push(r)}return i}function fue(e,t,n){const i=hue(e,t,n);if((0,$9.A)(i)){const e=parseFloat(i.textContent);return isNaN(e)?void 0:e}}function mue(e,t,n){const i=hue(e,t,n);if((0,$9.A)(i))return i.textContent.trim()}function gue(e,t,n){const i=hue(e,t,n);if((0,$9.A)(i)){const e=i.textContent.trim();return"1"===e||/^true$/i.test(e)}}function _ue(e,t,n){if(!(0,$9.A)(e))return;let i;if((0,$9.A)(n)){let o=n[e=e.replace(/\\/g,"/")];if((0,$9.A)(o))i=new Eee.A({url:o});else{const r=new ra(t.getUrlComponent());o=n[new ra(e).absoluteTo(r)],(0,$9.A)(o)&&(i=new Eee.A({url:o}))}}return(0,$9.A)(i)||(i=t.getDerivedResource({url:e})),i}Object.defineProperties(eue.prototype,{dataSource:{get:function(){return this._dataSource}}}),eue.prototype.addNodes=function(e,t){this._stack.push({nodes:e,index:0,processingData:t}),this._used=!0},eue.prototype.addPromise=function(e){this._promises.push(e)},eue.prototype.wait=function(){const e=this._deferred;return this._used||e.resolve(),Promise.all([e.promise,Promise.all(this._promises)])},eue.prototype.process=function(){const e=1===this._stack.length;return e&&(this._started=tde._getTimestamp()),this._process(e)},eue.prototype._giveUpTime=function(){if(this._timeoutSet)return;this._timeoutSet=!0,this._timeThreshold=50;const e=this;setTimeout(function(){e._timeoutSet=!1,e._started=tde._getTimestamp(),e._process(!0)},0)},eue.prototype._nextNode=function(){const e=this._stack,t=e[e.length-1],n=t.index,i=t.nodes;if(n!==i.length)return++t.index,i[n]},eue.prototype._pop=function(){const e=this._stack;return e.pop(),0!==e.length||(this._deferred.resolve(),!1)},eue.prototype._process=function(e){const t=this.dataSource,n=this._stack[this._stack.length-1].processingData;let i=this._nextNode();for(;(0,$9.A)(i);){const e=Zle[i.localName];if((0,$9.A)(e)&&(-1!==Jle.kml.indexOf(i.namespaceURI)||-1!==Jle.gx.indexOf(i.namespaceURI))&&(e(t,i,n,this),this._timeoutSet||tde._getTimestamp()>this._started+this._timeThreshold))return void this._giveUpTime();i=this._nextNode()}this._pop()&&e&&this._process(!0)};const yue={maximumRed:void 0,red:void 0,maximumGreen:void 0,green:void 0,maximumBlue:void 0,blue:void 0};function vue(e,t){if(!(0,$9.A)(e)||/^\s*$/gm.test(e))return;"#"===e[0]&&(e=e.substring(1));const n=parseInt(e.substring(0,2),16)/255,i=parseInt(e.substring(2,4),16)/255,o=parseInt(e.substring(4,6),16)/255,r=parseInt(e.substring(6,8),16)/255;return t?(r>0?(yue.maximumRed=r,yue.red=void 0):(yue.maximumRed=void 0,yue.red=0),o>0?(yue.maximumGreen=o,yue.green=void 0):(yue.maximumGreen=void 0,yue.green=0),i>0?(yue.maximumBlue=i,yue.blue=void 0):(yue.maximumBlue=void 0,yue.blue=0),yue.alpha=n,yee.A.fromRandom(yue)):new yee.A(r,o,i,n)}function Tue(e,t,n){const i=mue(e,t,n);if((0,$9.A)(i))return vue(i,"random"===mue(e,"colorMode",n))}function bue(){const e=new oie.A;return e.width=jle,e.height=jle,e.scaleByDistance=new Hne.A(Qle,1,Xle,.1),e.pixelOffsetScaleByDistance=new Hne.A(Qle,1,Xle,.1),e}function wue(){const e=new jie.A;return e.outline=!0,e.outlineColor=yee.A.WHITE,e}function xue(){const e=new Hie.A;return e.translucencyByDistance=new Hne.A(3e6,1,5e6,0),e.pixelOffset=new bne.A(17,0),e.horizontalOrigin=eie.A.LEFT,e.font="16px sans-serif",e.style=tie.A.FILL_AND_OUTLINE,e}function Cue(e,t,n,i,o){let r=mue(e,"href",Jle.kml);if(!(0,$9.A)(r)||0===r.length)return;if(0===r.indexOf("root://icons/palette-")){const t=r.charAt(21);let n=fue(e,"x",Jle.gx)??0,i=fue(e,"y",Jle.gx)??0;n=Math.min(n/32,7),i=7-Math.min(i/32,7),r=`https://maps.google.com/mapfiles/kml/pal${t}/icon${8*i+n}.png`}const s=_ue(r,n,i);if(o){const n=mue(e,"refreshMode",Jle.kml),i=mue(e,"viewRefreshMode",Jle.kml);"onInterval"===n||"onExpire"===n?(0,Fse.A)(`kml-refreshMode-${n}`,`KML - Unsupported Icon refreshMode: ${n}`):"onStop"!==i&&"onRegion"!==i||(0,Fse.A)(`kml-refreshMode-${i}`,`KML - Unsupported Icon viewRefreshMode: ${i}`);const o=mue(e,"viewBoundScale",Jle.kml)??1,r="onStop"===i?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",a=mue(e,"viewFormat",Jle.kml)??r,c=mue(e,"httpQuery",Jle.kml);(0,$9.A)(a)&&s.setQueryParameters((0,Use.A)(jue(a))),(0,$9.A)(c)&&s.setQueryParameters((0,Use.A)(jue(c)));const l=t._ellipsoid;return Jue(s,t.camera,t.canvas,o,t._lastCameraView.bbox,l),s}return s}function Eue(e,t,n,i,o){let r=fue(t,"scale",Jle.kml);const s=fue(t,"heading",Jle.kml),a=Tue(t,"color",Jle.kml),c=hue(t,"Icon",Jle.kml);let l=Cue(c,e,i,o,!1);(0,$9.A)(c)&&!(0,$9.A)(l)&&(l=!1);const u=fue(c,"x",Jle.gx),d=fue(c,"y",Jle.gx),h=fue(c,"w",Jle.gx),A=fue(c,"h",Jle.gx),p=hue(t,"hotSpot",Jle.kml),f=uue(p,"x"),m=uue(p,"y"),g=due(p,"xunits"),_=due(p,"yunits");let y,v,T=n.billboard;(0,$9.A)(T)||(T=bue(),n.billboard=T),T.image=l,T.scale=r,T.color=a,((0,$9.A)(u)||(0,$9.A)(d)||(0,$9.A)(h)||(0,$9.A)(A))&&(T.imageSubRegion=new Tne.A(u,d,h,A)),(0,$9.A)(s)&&0!==s&&(T.rotation=nne.A.toRadians(-s),T.alignedAxis=ete.A.UNIT_Z),r=r??1,(0,$9.A)(f)&&("pixels"===g?y=-f*r:"insetPixels"===g?y=(f-jle)*r:"fraction"===g&&(y=-f*jle*r),y+=16*r),(0,$9.A)(m)&&("pixels"===_?v=m*r:"insetPixels"===_?v=(-m+jle)*r:"fraction"===_&&(v=m*jle*r),v-=16*r),((0,$9.A)(y)||(0,$9.A)(v))&&(T.pixelOffset=new bne.A(y,v))}function Sue(e,t,n,i,o){for(let r=0,s=t.childNodes.length;r<s;r++){const s=t.childNodes.item(r);if("IconStyle"===s.localName)Eue(e,s,n,i,o);else if("LabelStyle"===s.localName){let e=n.label;(0,$9.A)(e)||(e=xue(),n.label=e),e.scale=fue(s,"scale",Jle.kml)??e.scale,e.fillColor=Tue(s,"color",Jle.kml)??e.fillColor,e.text=n.name}else if("LineStyle"===s.localName){let e=n.polyline;(0,$9.A)(e)||(e=new soe.A,n.polyline=e),e.width=fue(s,"width",Jle.kml),e.material=Tue(s,"color",Jle.kml),(0,$9.A)(Tue(s,"outerColor",Jle.gx))&&(0,Fse.A)("kml-gx:outerColor","KML - gx:outerColor is not supported in a LineStyle"),(0,$9.A)(fue(s,"outerWidth",Jle.gx))&&(0,Fse.A)("kml-gx:outerWidth","KML - gx:outerWidth is not supported in a LineStyle"),(0,$9.A)(fue(s,"physicalWidth",Jle.gx))&&(0,Fse.A)("kml-gx:physicalWidth","KML - gx:physicalWidth is not supported in a LineStyle"),(0,$9.A)(gue(s,"labelVisibility",Jle.gx))&&(0,Fse.A)("kml-gx:labelVisibility","KML - gx:labelVisibility is not supported in a LineStyle")}else if("PolyStyle"===s.localName){let e=n.polygon;(0,$9.A)(e)||(e=wue(),n.polygon=e),e.material=Tue(s,"color",Jle.kml)??e.material,e.fill=gue(s,"fill",Jle.kml)??e.fill,e.outline=gue(s,"outline",Jle.kml)??e.outline}else if("BalloonStyle"===s.localName){const e=vue(mue(s,"bgColor",Jle.kml))??yee.A.WHITE,t=vue(mue(s,"textColor",Jle.kml))??yee.A.BLACK,i=mue(s,"text",Jle.kml);n.addProperty("balloonStyle"),n.balloonStyle={bgColor:e,textColor:t,text:i}}else if("ListStyle"===s.localName){const e=mue(s,"listItemType",Jle.kml);"radioFolder"!==e&&"checkOffOnly"!==e||(0,Fse.A)(`kml-listStyle-${e}`,`KML - Unsupported ListStyle with listItemType: ${e}`)}}}function Iue(e,t,n){return t.fetchXML().then(function(i){return Pue(e,i,n,t,!0)})}function Pue(e,t,n,i,o,r){let s,a,c,l;const u=Aue(t,"Style",Jle.kml);if((0,$9.A)(u)){const t=u.length;for(s=0;s<t;s++)l=u[s],a=due(l,"id"),(0,$9.A)(a)&&(a=`#${a}`,o&&(0,$9.A)(i)&&(a=i.getUrlComponent()+a),(0,$9.A)(n.getById(a))||(c=new Ile.A({id:a}),n.add(c),Sue(e,l,c,i,r)))}const d=Aue(t,"StyleMap",Jle.kml);if((0,$9.A)(d)){const t=d.length;for(s=0;s<t;s++){const t=d[s];if(a=due(t,"id"),(0,$9.A)(a)){const s=pue(t,"Pair",Jle.kml);for(let t=0;t<s.length;t++){const u=s[t],d=mue(u,"key",Jle.kml);if("normal"===d){if(a=`#${a}`,o&&(0,$9.A)(i)&&(a=i.getUrlComponent()+a),!(0,$9.A)(n.getById(a))){c=n.getOrCreateEntity(a);let t=mue(u,"styleUrl",Jle.kml);if((0,$9.A)(t)){"#"!==t[0]&&(t=`#${t}`),o&&(0,$9.A)(i)&&(t=i.getUrlComponent()+t);const e=n.getById(t);(0,$9.A)(e)&&c.merge(e)}else l=hue(u,"Style",Jle.kml),Sue(e,l,c,i,r)}}else(0,Fse.A)(`kml-styleMap-${d}`,`KML - Unsupported StyleMap key: ${d}`)}}}}const h=[],A=t.getElementsByTagName("styleUrl"),p=A.length;for(s=0;s<p;s++){const t=A[s].textContent;if("#"!==t[0]){const o=t.split("#");if(2===o.length){const t=o[0],r=i.getDerivedResource({url:t});h.push(Iue(e,r,n))}}}return h}function Due(e,t,n){const i=new boe.A(e,t.id,["position"]),o=new Gle.A(t.position);t.polyline=(0,$9.A)(n.polyline)?n.polyline.clone():new soe.A,t.polyline.positions=new moe([i,o])}function Oue(e,t){return!(0,$9.A)(e)&&!(0,$9.A)(t)||"clampToGround"===e?Zne.Ay.CLAMP_TO_GROUND:"relativeToGround"===e?Zne.Ay.RELATIVE_TO_GROUND:"absolute"===e?Zne.Ay.NONE:"clampToSeaFloor"===t?((0,Fse.A)("kml-gx:altitudeMode-clampToSeaFloor","KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround."),Zne.Ay.CLAMP_TO_GROUND):"relativeToSeaFloor"===t?((0,Fse.A)("kml-gx:altitudeMode-relativeToSeaFloor","KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround."),Zne.Ay.RELATIVE_TO_GROUND):((0,$9.A)(e)?(0,Fse.A)("kml-altitudeMode-unknown",`KML - Unknown <kml:altitudeMode>:${e}, using <kml:altitudeMode>:CLAMP_TO_GROUND.`):(0,Fse.A)("kml-gx:altitudeMode-unknown",`KML - Unknown <gx:altitudeMode>:${t}, using <kml:altitudeMode>:CLAMP_TO_GROUND.`),Zne.Ay.CLAMP_TO_GROUND)}function Rue(e,t,n){return"relativeToSeaFloor"===n||"absolute"===t||"relativeToGround"===t?e:(((0,$9.A)(t)&&"clampToGround"!==t||(0,$9.A)(n)&&"clampToSeaFloor"!==n)&&(0,Fse.A)("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${t??n}`),new Gle.A(e))}function Mue(e,t,n,i){let o=t.label;(0,$9.A)(o)||(o=(0,$9.A)(n.label)?n.label.clone():xue(),t.label=o),o.text=t.name;let r=t.billboard;(0,$9.A)(r)||(r=(0,$9.A)(n.billboard)?n.billboard.clone():bue(),t.billboard=r),(0,$9.A)(r.image)?r.image.getValue()||(r.image=void 0):r.image=e._pinBuilder.fromColor(yee.A.YELLOW,64);let s=1;(0,$9.A)(r.scale)&&(s=r.scale.getValue(),0!==s?o.pixelOffset=new bne.A(16*s+1,0):(o.pixelOffset=void 0,o.horizontalOrigin=void 0)),(0,$9.A)(i)&&e._clampToGround&&(r.heightReference=i,o.heightReference=i)}function Lue(e,t){let n=e.path;(0,$9.A)(n)||(n=new Yie.A,n.leadTime=0,e.path=n);const i=t.polyline;(0,$9.A)(i)&&(n.material=i.material,n.width=i.width)}function Nue(e,t,n,i,o){const r=hue(n,"coordinates",Jle.kml),s=mue(n,"altitudeMode",Jle.kml),a=mue(n,"altitudeMode",Jle.gx),c=gue(n,"extrude",Jle.kml),l=gue(n,"tessellate",Jle.kml),u=aue(s,a),d=fue(n,"drawOrder",Jle.gx),h=e._ellipsoid,A=lue(r,h);let p=o.polyline;if(u&&c){const e=new Yoe.A;i.wall=e,e.positions=A;const t=o.polygon;(0,$9.A)(t)&&(e.fill=t.fill,e.material=t.material),e.outline=!0,(0,$9.A)(p)?(e.outlineColor=(0,$9.A)(p.material)?p.material.color:yee.A.WHITE,e.outlineWidth=p.width):(0,$9.A)(t)&&(e.outlineColor=(0,$9.A)(t.material)?t.material.color:yee.A.WHITE)}else if(e._clampToGround&&!u&&l){const e=new soe.A;e.clampToGround=!0,i.polyline=e,e.positions=A,(0,$9.A)(p)?(e.material=(0,$9.A)(p.material)?p.material.color.getValue(Une.A.MINIMUM_VALUE):yee.A.WHITE,e.width=p.width??1):(e.material=yee.A.WHITE,e.width=1),e.zIndex=d}else(0,$9.A)(d)&&(0,Fse.A)("kml-gx:drawOrder","KML - gx:drawOrder is not supported in LineStrings when clampToGround is false"),e._clampToGround&&!l&&(0,Fse.A)("kml-line-tesselate","Ignoring clampToGround for KML lines without the tessellate flag."),p=(0,$9.A)(p)?p.clone():new soe.A,i.polyline=p,p.positions=function(e,t,n,i){if(!(0,$9.A)(e))return;if("relativeToSeaFloor"===n||"absolute"===t||"relativeToGround"===t)return e;((0,$9.A)(t)&&"clampToGround"!==t||(0,$9.A)(n)&&"clampToSeaFloor"!==n)&&(0,Fse.A)("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${t??n}`);const o=e.length;for(let t=0;t<o;t++){const n=e[t];i.scaleToGeodeticSurface(n,n)}return e}(A,s,a,h),l&&!u||(p.arcType=tte.A.NONE);return!0}function Bue(e,t,n,i,o,r,s,a,c){const l=e[0],u=e[e.length-1],d=new xoe.A;d.addSamples(e,t),n.intervals.addInterval(new Xne.A({start:l,stop:u,isStartIncluded:c,isStopIncluded:c,data:Rue(d,s,a)})),i.addInterval(new Xne.A({start:l,stop:u,isStartIncluded:c,isStopIncluded:c})),o.intervals.addInterval(new Xne.A({start:l,stop:u,isStartIncluded:c,isStopIncluded:c,data:r}))}const Fue={Point:function(e,t,n,i,o){const r=mue(n,"coordinates",Jle.kml),s=mue(n,"altitudeMode",Jle.kml),a=mue(n,"altitudeMode",Jle.gx),c=gue(n,"extrude",Jle.kml),l=cue(r,e._ellipsoid);return i.position=l,Mue(e,i,o,Oue(s,a)),c&&aue(s,a)&&Due(t,i,o),!0},LineString:Nue,LinearRing:Nue,Polygon:function(e,t,n,i,o){const r=hue(n,"outerBoundaryIs",Jle.kml);let s=hue(r,"LinearRing",Jle.kml),a=hue(s,"coordinates",Jle.kml);const c=e._ellipsoid;let l=lue(a,c);const u=gue(n,"extrude",Jle.kml),d=aue(mue(n,"altitudeMode",Jle.kml),mue(n,"altitudeMode",Jle.gx)),h=(0,$9.A)(o.polygon)?o.polygon.clone():wue(),A=o.polyline;if((0,$9.A)(A)&&(h.outlineColor=(0,$9.A)(A.material)?A.material.color:yee.A.WHITE,h.outlineWidth=A.width),i.polygon=h,d?(h.perPositionHeight=!0,h.extrudedHeight=u?0:void 0):e._clampToGround||(h.height=0),(0,$9.A)(l)){const e=new Gne.A(l),t=pue(n,"innerBoundaryIs",Jle.kml);for(let n=0;n<t.length;n++){s=pue(t[n],"LinearRing",Jle.kml);for(let t=0;t<s.length;t++)a=hue(s[t],"coordinates",Jle.kml),l=lue(a,c),(0,$9.A)(l)&&e.holes.push(new Gne.A(l))}h.hierarchy=e}return!0},Track:function(e,t,n,i,o){const r=mue(n,"altitudeMode",Jle.kml),s=mue(n,"altitudeMode",Jle.gx),a=pue(n,"coord",Jle.gx),c=pue(n,"angles",Jle.gx),l=pue(n,"when",Jle.kml),u=gue(n,"extrude",Jle.kml),d=aue(r,s),h=e._ellipsoid;c.length>0&&(0,Fse.A)("kml-gx:angles","KML - gx:angles are not supported in gx:Tracks");const A=Math.min(a.length,l.length),p=[],f=[];for(let e=0;e<A;e++){const t=cue(a[e].textContent,h);p.push(t),f.push(kne.A.fromIso8601(l[e].textContent))}const m=new xoe.A;return m.addSamples(f,p),i.position=m,Mue(e,i,o,Oue(r,s)),Lue(i,o),i.availability=new Kne.A,l.length>0&&i.availability.addInterval(new Xne.A({start:f[0],stop:f[f.length-1]})),d&&u&&Due(t,i,o),!0},MultiTrack:function(e,t,n,i,o){const r=gue(n,"interpolate",Jle.gx),s=pue(n,"Track",Jle.gx);let a,c,l,u=!1;const d=new Boe,h=new Kne.A,A=new vie.A,p=e._ellipsoid;for(let e=0,t=s.length;e<t;e++){const t=s[e],n=pue(t,"when",Jle.kml),i=pue(t,"coord",Jle.gx),o=mue(t,"altitudeMode",Jle.kml),f=mue(t,"altitudeMode",Jle.gx),m=aue(o,f),g=gue(t,"extrude",Jle.kml),_=Math.min(i.length,n.length),y=[];a=[];for(let e=0;e<_;e++){const t=cue(i[e].textContent,p);y.push(t),a.push(kne.A.fromIso8601(n[e].textContent))}r&&((0,$9.A)(c)&&Bue([c,a[0]],[l,y[0]],A,h,d,!1,"absolute",void 0,!1),c=a[_-1],l=y[y.length-1]),Bue(a,y,A,h,d,m&&g,o,f,!0),u=u||m&&g}return i.availability=h,i.position=A,Mue(e,i,o),Lue(i,o),u&&(Due(t,i,o),i.polyline.show=d),!0},MultiGeometry:function(e,t,n,i,o,r){const s=n.childNodes;let a=!1;for(let n=0,c=s.length;n<c;n++){const c=s.item(n),l=Fue[c.localName];if((0,$9.A)(l)){const n=sue(c,t,r);n.parent=i,n.name=i.name,n.availability=i.availability,n.description=i.description,n.kml=i.kml,l(e,t,c,n,o)&&(a=!0)}}return a},Model:function(e,t,n,i,o){return(0,Fse.A)("kml-unsupportedGeometry",`KML - Unsupported geometry: ${n.localName}`),!1}};let Uue;function kue(e,t,n){const i=n.entityCollection,o=n.parentEntity,r=n.sourceResource,s=n.uriResolver,a=sue(t,i,n.context),c=a.kml,l=function(e,t,n,i,o){const r=new Ile.A;let s,a=-1;const c=t.childNodes,l=c.length;for(let e=0;e<l;e++){const t=c[e];"Style"!==t.localName&&"StyleMap"!==t.localName||(a=e)}if(-1!==a){const t=c[a];if("Style"===t.localName)Sue(e,t,r,i,o);else{const a=pue(t,"Pair",Jle.kml);for(let t=0;t<a.length;t++){const c=a[t],l=mue(c,"key",Jle.kml);if("normal"===l){const t=mue(c,"styleUrl",Jle.kml);(0,$9.A)(t)?(s=n.getById(t),(0,$9.A)(s)||(s=n.getById(`#${t}`)),(0,$9.A)(s)&&r.merge(s)):Sue(e,hue(c,"Style",Jle.kml),r,i,o)}else(0,Fse.A)(`kml-styleMap-${l}`,`KML - Unsupported StyleMap key: ${l}`)}}}const u=mue(t,"styleUrl",Jle.kml);if((0,$9.A)(u)){let e=u;if("#"!==u[0]&&-1!==u.indexOf("#")){const t=u.split("#"),n=t[0];e=`${i.getDerivedResource({url:n}).getUrlComponent()}#${t[1]}`}s=n.getById(e),(0,$9.A)(s)||(s=n.getById(`#${e}`)),(0,$9.A)(s)&&r.merge(s)}return r}(e,t,n.styleCollection,r,s),u=mue(t,"name",Jle.kml);a.name=u,a.parent=o;let d=function(e){const t=hue(e,"TimeSpan",Jle.kmlgx);if(!(0,$9.A)(t))return;let n;const i=hue(t,"begin",Jle.kmlgx);let o=(0,$9.A)(i)?kne.A.fromIso8601(i.textContent):void 0;const r=hue(t,"end",Jle.kmlgx);let s=(0,$9.A)(r)?kne.A.fromIso8601(r.textContent):void 0;if((0,$9.A)(o)&&(0,$9.A)(s)){if(kne.A.lessThan(s,o)){const e=o;o=s,s=e}n=new Kne.A,n.addInterval(new Xne.A({start:o,stop:s}))}else(0,$9.A)(o)?(n=new Kne.A,n.addInterval(new Xne.A({start:o,stop:Une.A.MAXIMUM_VALUE}))):(0,$9.A)(s)&&(n=new Kne.A,n.addInterval(new Xne.A({start:Une.A.MINIMUM_VALUE,stop:s})));return n}(t);(0,$9.A)(d)||(d=function(e){const t=hue(e,"TimeStamp",Jle.kmlgx),n=mue(t,"when",Jle.kmlgx);if(!(0,$9.A)(t)||!(0,$9.A)(n)||0===n.length)return;const i=kne.A.fromIso8601(n),o=new Kne.A;return o.addInterval(new Xne.A({start:i,stop:Une.A.MAXIMUM_VALUE})),o}(t)),a.availability=d,nde(a);const h=gue(t,"visibility",Jle.kml);a.show=function e(t){return!t||t.show&&e(t.parent)}(o)&&(h??!0);const A=hue(t,"author",Jle.atom),p=c.author;p.name=mue(A,"name",Jle.atom),p.uri=mue(A,"uri",Jle.atom),p.email=mue(A,"email",Jle.atom);const f=hue(t,"link",Jle.atom),m=c.link;m.href=due(f,"href"),m.hreflang=due(f,"hreflang"),m.rel=due(f,"rel"),m.type=due(f,"type"),m.title=due(f,"title"),m.length=due(f,"length"),c.address=mue(t,"address",Jle.kml),c.phoneNumber=mue(t,"phoneNumber",Jle.kml),c.snippet=mue(t,"Snippet",Jle.kml),function(e,t){const n=hue(e,"ExtendedData",Jle.kml);if(!(0,$9.A)(n))return;(0,$9.A)(hue(n,"SchemaData",Jle.kml))&&(0,Fse.A)("kml-schemaData","KML - SchemaData is unsupported"),(0,$9.A)(due(n,"xmlns:prefix"))&&(0,Fse.A)("kml-extendedData","KML - ExtendedData with xmlns:prefix is unsupported");const i={},o=pue(n,"Data",Jle.kml);if((0,$9.A)(o)){const e=o.length;for(let t=0;t<e;t++){const e=o[t],n=due(e,"name");(0,$9.A)(n)&&(i[n]={displayName:mue(e,"displayName",Jle.kml),value:mue(e,"value",Jle.kml)})}}t.kml.extendedData=i}(t,a),function(e,t,n,i,o){let r,s,a;const c=t.kml,l=c.extendedData,u=mue(e,"description",Jle.kml),d=t.balloonStyle??n.balloonStyle;let h,A=yee.A.WHITE,p=yee.A.BLACK,f=u;if((0,$9.A)(d)&&(A=d.bgColor??yee.A.WHITE,p=d.textColor??yee.A.BLACK,f=d.text??u),(0,$9.A)(f)){if(f=f.replace("$[name]",t.name??""),f=f.replace("$[description]",u??""),f=f.replace("$[address]",c.address??""),f=f.replace("$[Snippet]",c.snippet??""),f=f.replace("$[id]",t.id),f=f.replace("$[geDirections]",""),(0,$9.A)(l)){const e=f.match(/\$\[.+?\]/g);if(null!==e)for(r=0;r<e.length;r++){const t=e[r];let n=t.substr(2,t.length-3);const i=/\/displayName$/.test(n);n=n.replace(/\/displayName$/,""),h=l[n],(0,$9.A)(h)&&(h=i?h.displayName:h.value),(0,$9.A)(h)&&(f=f.replace(t,h??""))}}}else if((0,$9.A)(l)&&(a=Object.keys(l),a.length>0)){for(f='<table class="cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter"><tbody>',r=0;r<a.length;r++)s=a[r],h=l[s],f+=`<tr><th>${h.displayName??s}</th><td>${h.value??""}</td></tr>`;f+="</tbody></table>"}if(!(0,$9.A)(f))return;f=qle.link(f),Uue.innerHTML=f;const m=Uue.querySelectorAll("a");for(r=0;r<m.length;r++)m[r].setAttribute("target","_blank");(0,$9.A)(i)&&i.keys.length>1&&(oue(Uue,"a","href",i),oue(Uue,"link","href",i),oue(Uue,"area","href",i),oue(Uue,"img","src",i),oue(Uue,"iframe","src",i),oue(Uue,"video","src",i),oue(Uue,"audio","src",i),oue(Uue,"source","src",i),oue(Uue,"track","src",i),oue(Uue,"input","src",i),oue(Uue,"embed","src",i),oue(Uue,"script","src",i),oue(Uue,"video","poster",i)),rue(Uue,"a","href",o),rue(Uue,"link","href",o),rue(Uue,"area","href",o),rue(Uue,"img","src",o),rue(Uue,"iframe","src",o),rue(Uue,"video","src",o),rue(Uue,"audio","src",o),rue(Uue,"source","src",o),rue(Uue,"track","src",o),rue(Uue,"input","src",o),rue(Uue,"embed","src",o),rue(Uue,"script","src",o),rue(Uue,"video","poster",o);let g='<div class="cesium-infoBox-description-lighter" style="';g+="overflow:auto;",g+="word-wrap:break-word;",g+=`background-color:${A.toCssColorString()};`,g+=`color:${p.toCssColorString()};`,g+='">',g+=`${Uue.innerHTML}</div>`,Uue.innerHTML="",t.description=g}(t,a,l,s,r);const g=e._ellipsoid;return Wue(t,a,g),Gue(t,a,g),(0,$9.A)(hue(t,"Region",Jle.kml))&&(0,Fse.A)("kml-region","KML - Placemark Regions are unsupported"),{entity:a,styleEntity:l}}function Vue(e,t,n,i){i.addNodes(t.childNodes,n),i.process()}"undefined"!=typeof document&&(Uue=document.createElement("div"));const zue={FlyTo:function(e,t,n){const i=fue(t,"duration",Jle.gx),o=mue(t,"flyToMode",Jle.gx),r={kml:{}};Wue(t,r,n),Gue(t,r,n);const s=r.kml.lookAt||r.kml.camera,a=new Vle(i,o,s);e.addPlaylistEntry(a)},Wait:function(e,t){const n=fue(t,"duration",Jle.gx);e.addPlaylistEntry(new Hle(n))},SoundCue:Hue,AnimatedUpdate:Hue,TourControl:Hue};function Hue(e,t){(0,Fse.A)(`KML Tour unsupported node ${t.localName}`)}function Gue(e,t,n){const i=hue(e,"Camera",Jle.kml);if((0,$9.A)(i)){const e=fue(i,"longitude",Jle.kml)??0,o=fue(i,"latitude",Jle.kml)??0,r=fue(i,"altitude",Jle.kml)??0,s=fue(i,"heading",Jle.kml)??0,a=fue(i,"tilt",Jle.kml)??0,c=fue(i,"roll",Jle.kml)??0,l=ete.A.fromDegrees(e,o,r,n),u=one.A.fromDegrees(s,a-90,c);t.kml.camera=new Ple(l,u)}}function Wue(e,t,n){const i=hue(e,"LookAt",Jle.kml);if((0,$9.A)(i)){const e=fue(i,"longitude",Jle.kml)??0,o=fue(i,"latitude",Jle.kml)??0,r=fue(i,"altitude",Jle.kml)??0;let s=fue(i,"heading",Jle.kml),a=fue(i,"tilt",Jle.kml);const c=fue(i,"range",Jle.kml)??0;a=nne.A.toRadians(a??0),s=nne.A.toRadians(s??0);const l=new Nse.A(s,a-nne.A.PI_OVER_TWO,c),u=ete.A.fromDegrees(e,o,r,n);t.kml.lookAt=new Dle(u,l)}}function Yue(e,t,n,i){e._unsupportedNode.raiseEvent(e,n.parentEntity,t,n.entityCollection,n.styleCollection,n.sourceResource,n.uriResolver),(0,Fse.A)(`kml-unsupportedFeature-${t.nodeName}`,`KML - Unsupported feature: ${t.nodeName}`)}const que={INTERVAL:0,EXPIRE:1,STOP:2};function jue(e){if(!(0,$9.A)(e)||0===e.length)return"";const t=e[0];return"&"!==t&&"?"!==t||(e=e.substring(1)),e}const Que=new Ate.A,Xue=new wne.A,Kue=new bne.A,$ue=new ete.A;function Jue(e,t,n,i,o,r){function s(e){return e<-nne.A.PI_OVER_TWO?-nne.A.PI_OVER_TWO:e>nne.A.PI_OVER_TWO?nne.A.PI_OVER_TWO:e}function a(e){return e>nne.A.PI?e-nne.A.TWO_PI:e<-nne.A.PI?e+nne.A.TWO_PI:e}let c=(0,Bse.A)(e.queryParameters);if(c=c.replace(/%5B/g,"[").replace(/%5D/g,"]"),(0,$9.A)(t)&&t._mode!==kse.A.MORPHING){let e,l;if(o=o??Que,(0,$9.A)(n)&&(Kue.x=.5*n.clientWidth,Kue.y=.5*n.clientHeight,e=t.pickEllipsoid(Kue,r,$ue)),(0,$9.A)(e)?l=r.cartesianToCartographic(e,Xue):(l=Ate.A.center(o,Xue),e=r.cartographicToCartesian(l)),(0,$9.A)(i)&&!nne.A.equalsEpsilon(i,1,nne.A.EPSILON9)){const e=o.width*i*.5,t=o.height*i*.5;o=new Ate.A(a(l.longitude-e),s(l.latitude-t),a(l.longitude+e),s(l.latitude+t))}c=c.replace("[bboxWest]",nne.A.toDegrees(o.west).toString()),c=c.replace("[bboxSouth]",nne.A.toDegrees(o.south).toString()),c=c.replace("[bboxEast]",nne.A.toDegrees(o.east).toString()),c=c.replace("[bboxNorth]",nne.A.toDegrees(o.north).toString());const u=nne.A.toDegrees(l.longitude).toString(),d=nne.A.toDegrees(l.latitude).toString();c=c.replace("[lookatLon]",u),c=c.replace("[lookatLat]",d),c=c.replace("[lookatTilt]",nne.A.toDegrees(t.pitch).toString()),c=c.replace("[lookatHeading]",nne.A.toDegrees(t.heading).toString()),c=c.replace("[lookatRange]",ete.A.distance(t.positionWC,e)),c=c.replace("[lookatTerrainLon]",u),c=c.replace("[lookatTerrainLat]",d),c=c.replace("[lookatTerrainAlt]",l.height.toString()),r.cartesianToCartographic(t.positionWC,Xue),c=c.replace("[cameraLon]",nne.A.toDegrees(Xue.longitude).toString()),c=c.replace("[cameraLat]",nne.A.toDegrees(Xue.latitude).toString()),c=c.replace("[cameraAlt]",nne.A.toDegrees(Xue.height).toString());const h=t.frustum,A=h.aspectRatio;let p="",f="";if((0,$9.A)(A)){const e=nne.A.toDegrees(h.fov);A>1?(p=e,f=e/A):(f=e,p=e*A)}c=c.replace("[horizFov]",p.toString()),c=c.replace("[vertFov]",f.toString())}else c=c.replace("[bboxWest]","-180"),c=c.replace("[bboxSouth]","-90"),c=c.replace("[bboxEast]","180"),c=c.replace("[bboxNorth]","90"),c=c.replace("[lookatLon]",""),c=c.replace("[lookatLat]",""),c=c.replace("[lookatRange]",""),c=c.replace("[lookatTilt]",""),c=c.replace("[lookatHeading]",""),c=c.replace("[lookatTerrainLon]",""),c=c.replace("[lookatTerrainLat]",""),c=c.replace("[lookatTerrainAlt]",""),c=c.replace("[cameraLon]",""),c=c.replace("[cameraLat]",""),c=c.replace("[cameraAlt]",""),c=c.replace("[horizFov]",""),c=c.replace("[vertFov]","");(0,$9.A)(n)?(c=c.replace("[horizPixels]",n.clientWidth),c=c.replace("[vertPixels]",n.clientHeight)):(c=c.replace("[horizPixels]",""),c=c.replace("[vertPixels]","")),c=c.replace("[terrainEnabled]","1"),c=c.replace("[clientVersion]","1"),c=c.replace("[kmlVersion]","2.2"),c=c.replace("[clientName]","Cesium"),c=c.replace("[language]","English"),e.setQueryParameters((0,Use.A)(c))}function Zue(e,t,n,i,o,r,s){t.removeAll();const a=n.documentElement;let c=mue("Document"===a.localName?a:hue(a,"Document",Jle.kml),"name",Jle.kml);(0,$9.A)(c)||(c=Rne(i.getUrlComponent())),(0,$9.A)(e._name)||(e._name=c);const l=new tde._DeferredLoading(e),u=new Mie.A(e);return Promise.all(Pue(e,n,u,i,!1,o)).then(function(){let a=n.documentElement;if("kml"===a.localName){const e=a.childNodes;for(let t=0;t<e.length;t++){const n=e[t];if((0,$9.A)(Zle[n.localName])){a=n;break}}}const c={parentEntity:void 0,entityCollection:t,styleCollection:u,sourceResource:i,uriResolver:o,context:s,screenOverlayContainer:r};return t.suspendEvents(),function(e,t,n,i){const o=Zle[t.localName];(0,$9.A)(o)?o(e,t,n,i):Yue(e,t,n)}(e,a,c,l),t.resumeEvents(),l.wait().then(function(){return n.documentElement})})}function ede(e,t,n,i){let o=(i=i??Cee.A.EMPTY_OBJECT).sourceUri;const r=i.uriResolver,s=i.context;let a=i.screenOverlayContainer,c=n;if("string"==typeof n||n instanceof Eee.A){c=(n=Eee.A.createIfNeeded(n)).fetchBlob(),o=o??n.clone();const t=e._resourceCredits,i=n.credits;if((0,$9.A)(i)){const e=i.length;for(let n=0;n<e;n++)t.push(i[n])}}else o=o??Eee.A.DEFAULT.clone();return o=Eee.A.createIfNeeded(o),(0,$9.A)(a)&&(a=(0,dee.A)(a)),Promise.resolve(c).then(function(n){return n instanceof Blob?function(e){const t=e.slice(0,Math.min(4,e.size)),n=(0,Mse.A)(),i=new FileReader;return i.addEventListener("load",function(){n.resolve(1347093252===new DataView(i.result).getUint32(0,!1))}),i.addEventListener("error",function(){n.reject(i.error)}),i.readAsArrayBuffer(t),n.promise}(n).then(function(i){return i?async function(e,t,n,i,o){Zse({workerURI:(0,Gre.A)("ThirdParty/Workers/zip-web-worker.js"),wasmURI:(0,Gre.A)("ThirdParty/zip-module.wasm")});const r=new ale(new Ice(n)),s=await r.getEntries(),a=[],c={};let l;for(let e=0;e<s.length;e++){const t=s[e];t.directory||(/\.kml$/i.test(t.filename)?(0,$9.A)(l)&&/\//i.test(t.filename)?a.push(iue(t,c)):((0,$9.A)(l)&&a.push(iue(l,c)),l=t):a.push(iue(t,c)))}if((0,$9.A)(l)&&a.push(async function(e,t){let n=await e.getData(new Dce);n=tue(n),n=nue(n),t.kml=Yle.parseFromString(n,"application/xml")}(l,c)),await Promise.all(a),r.close(),!(0,$9.A)(c.kml))throw new qne.A("KMZ file does not contain a KML document.");return c.keys=Object.keys(c),Zue(e,t,c.kml,i,c,o)}(e,t,n,o,a):function(e){const t=(0,Mse.A)(),n=new FileReader;return n.addEventListener("load",function(){t.resolve(n.result)}),n.addEventListener("error",function(){t.reject(n.error)}),n.readAsText(e),t.promise}(n).then(function(n){let i,c;n=nue(n=tue(n));try{i=Yle.parseFromString(n,"application/xml")}catch(e){c=e.toString()}if((0,$9.A)(c)||i.body||"parsererror"===i.documentElement.tagName){let e=(0,$9.A)(c)?c:i.documentElement.firstChild.nodeValue;throw e||(e=i.body.innerText),new qne.A(e)}return Zue(e,t,i,o,r,a,s)})}):Zue(e,t,n,o,r,a,s)}).catch(function(t){return e._error.raiseEvent(e,t),console.log(t),Promise.reject(t)})}function tde(e){const t=(e=e??Cee.A.EMPTY_OBJECT).camera,n=e.canvas;this._changed=new lte.A,this._error=new lte.A,this._loading=new lte.A,this._refresh=new lte.A,this._unsupportedNode=new lte.A,this._clock=void 0,this._entityCollection=new Mie.A(this),this._name=void 0,this._isLoading=!1,this._pinBuilder=new Kre,this._networkLinks=new Rse.A,this._entityCluster=new Rie.A,this.canvas=n,this.camera=t,this._lastCameraView={position:(0,$9.A)(t)?ete.A.clone(t.positionWC):void 0,direction:(0,$9.A)(t)?ete.A.clone(t.directionWC):void 0,up:(0,$9.A)(t)?ete.A.clone(t.upWC):void 0,bbox:(0,$9.A)(t)?t.computeViewRectangle():Ate.A.clone(Ate.A.MAX_VALUE)},this._ellipsoid=e.ellipsoid??Dne.A.default;let i=e.credit;"string"==typeof i&&(i=new Sne.A(i)),this._credit=i,this._resourceCredits=[],this._kmlTours=[],this._screenOverlays=[]}function nde(e){const t=e.parent;if((0,$9.A)(t)){const n=t.availability;if((0,$9.A)(n)){const t=e.availability;(0,$9.A)(t)?t.intersect(n):e.availability=n}}}tde.load=function(e,t){return new tde(t=t??Cee.A.EMPTY_OBJECT).load(e,t)},Object.defineProperties(tde.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},refreshEvent:{get:function(){return this._refresh}},unsupportedNodeEvent:{get:function(){return this._unsupportedNode}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!(0,$9.A)(e))throw new Q9.A("value must be defined.");this._entityCluster=e}},credit:{get:function(){return this._credit}},kmlTours:{get:function(){return this._kmlTours}}}),tde.prototype.load=function(e,t){if(!(0,$9.A)(e))throw new Q9.A("data is required.");t=t??Cee.A.EMPTY_OBJECT,Cie.A.setLoading(this,!0);const n=this._name;this._name=void 0,this._clampToGround=t.clampToGround??!1;const i=this;return ede(this,this._entityCollection,e,t).then(function(){let e;const t=i._entityCollection.computeAvailability();let o=t.start,r=t.stop;const s=kne.A.equals(o,Une.A.MINIMUM_VALUE),a=kne.A.equals(r,Une.A.MAXIMUM_VALUE);if(!s||!a){let t;s&&(t=new Date,t.setHours(0,0,0,0),o=kne.A.fromDate(t)),a&&(t=new Date,t.setHours(24,0,0,0),r=kne.A.fromDate(t)),e=new Pie,e.startTime=o,e.stopTime=r,e.currentTime=kne.A.clone(o),e.clockRange=xne.A.LOOP_STOP,e.clockStep=Cne.A.SYSTEM_CLOCK_MULTIPLIER,e.multiplier=Math.round(Math.min(Math.max(kne.A.secondsDifference(r,o)/60,1),31556900))}let c=!1;return e!==i._clock&&(i._clock=e,c=!0),n!==i._name&&(c=!0),c&&i._changed.raiseEvent(i),Cie.A.setLoading(i,!1),i}).catch(function(e){return Cie.A.setLoading(i,!1),i._error.raiseEvent(i,e),console.log(e),Promise.reject(e)})},tde.prototype.destroy=function(){for(;this._screenOverlays.length>0;)this._screenOverlays.pop().remove()};const ide=new Rse.A;function ode(){this.author={name:void 0,uri:void 0,email:void 0},this.link={href:void 0,hreflang:void 0,rel:void 0,type:void 0,title:void 0,length:void 0},this.address=void 0,this.phoneNumber=void 0,this.snippet=void 0,this.extendedData=void 0}tde.prototype.update=function(e){const t=this._networkLinks;if(0===t.length)return!0;const n=kne.A.now(),i=this;function o(e){const t=e._children,n=t.length;for(let e=0;e<n;++e){const n=t[e];ide.set(n.id,n),o(n)}}ide.removeAll();let r=!1;const s=this._lastCameraView,a=this.camera;!(0,$9.A)(a)||a.positionWC.equalsEpsilon(s.position,nne.A.EPSILON7)&&a.directionWC.equalsEpsilon(s.direction,nne.A.EPSILON7)&&a.upWC.equalsEpsilon(s.up,nne.A.EPSILON7)||(s.position=ete.A.clone(a.positionWC),s.direction=ete.A.clone(a.directionWC),s.up=ete.A.clone(a.upWC),s.bbox=a.computeViewRectangle(),r=!0);const c=new Rse.A;let l=!1;return t.values.forEach(function(e){const t=e.entity;if(!ide.contains(t.id)){if(!e.updating){let a=!1;if(e.refreshMode===que.INTERVAL?kne.A.secondsDifference(n,e.lastUpdated)>e.time&&(a=!0):e.refreshMode===que.EXPIRE?kne.A.greaterThan(n,e.time)&&(a=!0):e.refreshMode===que.STOP&&(r&&(e.needsUpdate=!0,e.cameraUpdateTime=n),e.needsUpdate&&kne.A.secondsDifference(n,e.cameraUpdateTime)>=e.time&&(a=!0)),a){o(t),e.updating=!0;const n=new Mie.A,r=e.href.clone();r.setQueryParameters(e.cookie);const a=i._ellipsoid??Dne.A.default;Jue(r,i.camera,i.canvas,e.viewBoundScale,s.bbox,a),ede(i,n,r,{context:t.id}).then(function(e,t,n,i,o){return function(r){if(!i.contains(t.id))return;let s=!1;const a=hue(r,"NetworkLinkControl",Jle.kml);let c=0;if((0,$9.A)(a)){if((0,$9.A)(hue(a,"Update",Jle.kml)))return(0,Fse.A)("kml-networkLinkControl-update","KML - NetworkLinkControl updates aren't supported."),t.updating=!1,void i.remove(t.id);t.cookie=(0,Use.A)(mue(a,"cookie",Jle.kml)??""),c=fue(a,"minRefreshPeriod",Jle.kml)??0}const l=kne.A.now(),u=t.refreshMode;if(u===que.INTERVAL)(0,$9.A)(a)&&(t.time=Math.max(c,t.time));else if(u===que.EXPIRE){let e;if((0,$9.A)(a)&&(e=mue(a,"expires",Jle.kml)),(0,$9.A)(e))try{const n=kne.A.fromIso8601(e),i=kne.A.secondsDifference(n,l);i>0&&i<c&&kne.A.addSeconds(l,c,n),t.time=n}catch(e){(0,Fse.A)("kml-networkLinkControl-expires","KML - NetworkLinkControl expires is not a valid date"),s=!0}else(0,Fse.A)("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element"),s=!0}const d=t.entity,h=e._entityCollection,A=n.values;function p(e){h.remove(e);const t=e._children,n=t.length;for(let e=0;e<n;++e)p(t[e])}h.suspendEvents();const f=h.values.slice();let m;for(m=0;m<f.length;++m){const e=f[m];e.parent===d&&(e.parent=void 0,p(e))}for(h.resumeEvents(),h.suspendEvents(),m=0;m<A.length;m++){const e=A[m];(0,$9.A)(e.parent)||(e.parent=d,nde(e)),h.add(e)}h.resumeEvents(),s?i.remove(t.id):t.lastUpdated=l;const g=h.computeAvailability(),_=g.start,y=g.stop,v=kne.A.equals(_,Une.A.MINIMUM_VALUE),T=kne.A.equals(y,Une.A.MAXIMUM_VALUE);if(!v||!T){const t=e._clock;t.startTime===_&&t.stopTime===y||(t.startTime=_,t.stopTime=y,e._changed.raiseEvent(e))}t.updating=!1,t.needsUpdate=!1,e._refresh.raiseEvent(e,o.getUrlComponent(!0))}}(i,e,n,c,r)).catch(function(t){const n=`NetworkLink ${e.href} refresh failed: ${t}`;console.log(n),i._error.raiseEvent(i,n)}),l=!0}}c.set(e.id,e)}}),l&&(this._networkLinks=c,this._changed.raiseEvent(this)),!0},tde._DeferredLoading=eue,tde._getTimestamp=Fte.A;const rde=tde;let sde;"undefined"!=typeof DOMParser&&(sde=new DOMParser);const ade=new Hy({stripPrefix:!1,email:!1,replaceFn:function(e,t){return"scheme"===t.urlMatchType||"www"===t.urlMatchType}}),cde=2414016,lde=16093e3,ude={gpx:[null,void 0,"http://www.topografix.com/GPX/1/1"]};function dde(e,t){let n=pde(e,"id");return n=(0,$9.A)(n)?n:(0,Ine.A)(),t.getOrCreateEntity(n)}function hde(e){const t=Ade(e,"lon"),n=Ade(e,"lat"),i=gde(e,"ele",ude.gpx);return ete.A.fromDegrees(t,n,i)}function Ade(e,t){if(!(0,$9.A)(e))return;const n=e.getAttribute(t);if(null!==n){const e=parseFloat(n);return isNaN(e)?void 0:e}}function pde(e,t){if(!(0,$9.A)(e))return;const n=e.getAttribute(t);return null!==n?n:void 0}function fde(e,t,n){if(!(0,$9.A)(e))return;const i=e.childNodes,o=i.length;for(let e=0;e<o;e++){const o=i[e];if(o.localName===t&&-1!==n.indexOf(o.namespaceURI))return o}}function mde(e,t,n){if(!(0,$9.A)(e))return;const i=[],o=e.getElementsByTagName(t),r=o.length;for(let e=0;e<r;e++){const r=o[e];r.localName===t&&-1!==n.indexOf(r.namespaceURI)&&i.push(r)}return i}function gde(e,t,n){const i=fde(e,t,n);if((0,$9.A)(i)){const e=parseFloat(i.textContent);return isNaN(e)?void 0:e}}function _de(e,t,n){const i=fde(e,t,n);if((0,$9.A)(i))return i.textContent.trim()}function yde(e){const t=new oie.A;return t.width=32,t.height=32,t.scaleByDistance=new Hne.A(cde,1,lde,.1),t.pixelOffsetScaleByDistance=new Hne.A(cde,1,lde,.1),t.verticalOrigin=new bie.A(iie.A.BOTTOM),t.image=e,t}function vde(e){const t=new soe.A;return t.width=4,t.material=new doe,t.material.color=(0,$9.A)(e)?e:yee.A.RED,t.material.outlineWidth=2,t.material.outlineColor=yee.A.BLACK,t}const Tde={time:{text:"Time",tag:"time"},comment:{text:"Comment",tag:"cmt"},description:{text:"Description",tag:"desc"},source:{text:"Source",tag:"src"},number:{text:"GPS track/route number",tag:"number"},type:{text:"Type",tag:"type"}};let bde;function wde(e,t){let n,i="";const o=Object.keys(Tde),r=o.length;for(n=0;n<r;n++){const t=o[n],r=Tde[t];r.value=_de(e,r.tag,ude.gpx)??"",(0,$9.A)(r.value)&&""!==r.value&&(i=`${i}<p>${r.text}: ${r.value}</p>`)}if(!(0,$9.A)(i)||""===i)return;i=ade.link(i),bde.innerHTML=i;const s=bde.querySelectorAll("a");for(n=0;n<s.length;n++)s[n].setAttribute("target","_blank");const a=yee.A.WHITE,c=yee.A.BLACK;let l='<div class="cesium-infoBox-description-lighter" style="';return l+="overflow:auto;",l+="word-wrap:break-word;",l+=`background-color:${a.toCssColorString()};`,l+=`color:${c.toCssColorString()};`,l+='">',l+=`${bde.innerHTML}</div>`,bde.innerHTML="",l}function xde(e,t,n,i){const o=hde(t),r=dde(t,n);r.position=o;const s=(0,$9.A)(i.waypointImage)?i.waypointImage:e._pinBuilder.fromMakiIconId("marker",yee.A.RED,32);r.billboard=yde(s);const a=_de(t,"name",ude.gpx);r.name=a,r.label=function(){const e=new Hie.A;return e.translucencyByDistance=new Hne.A(3e6,1,5e6,0),e.pixelOffset=new bne.A(17,0),e.horizontalOrigin=eie.A.LEFT,e.font="16px sans-serif",e.style=tie.A.FILL_AND_OUTLINE,e}(),r.label.text=a,r.description=wde(t),i.clampToGround&&(r.billboard.heightReference=Zne.Ay.CLAMP_TO_GROUND,r.label.heightReference=Zne.Ay.CLAMP_TO_GROUND)}function Cde(e){const t={positions:[],times:[]},n=mde(e,"trkpt",ude.gpx);let i;for(let e=0;e<n.length;e++){const o=hde(n[e]);t.positions.push(o),i=_de(n[e],"time",ude.gpx),(0,$9.A)(i)&&t.times.push(kne.A.fromIso8601(i))}return t}function Ede(e){const t=fde(e,"author",ude.gpx);if((0,$9.A)(t)){const e={name:_de(t,"name",ude.gpx),email:Sde(t),link:Ide(t)};if((0,$9.A)(e.name)||(0,$9.A)(e.email)||(0,$9.A)(e.link))return e}}function Sde(e){const t=fde(e,"email",ude.gpx);if((0,$9.A)(t))return`${_de(t,"id",ude.gpx)}@${_de(t,"domain",ude.gpx)}`}function Ide(e){const t=fde(e,"link",ude.gpx);if((0,$9.A)(t)){const e={href:pde(t,"href"),text:_de(t,"text",ude.gpx),mimeType:_de(t,"type",ude.gpx)};if((0,$9.A)(e.href)||(0,$9.A)(e.text)||(0,$9.A)(e.mimeType))return e}}function Pde(e){const t=fde(e,"copyright",ude.gpx);if((0,$9.A)(t)){const e={author:pde(t,"author"),year:_de(t,"year",ude.gpx),license:_de(t,"license",ude.gpx)};if((0,$9.A)(e.author)||(0,$9.A)(e.year)||(0,$9.A)(e.license))return e}}function Dde(e){const t=fde(e,"bounds",ude.gpx);if((0,$9.A)(t)){const e={minLat:gde(t,"minlat",ude.gpx),maxLat:gde(t,"maxlat",ude.gpx),minLon:gde(t,"minlon",ude.gpx),maxLon:gde(t,"maxlon",ude.gpx)};if((0,$9.A)(e.minLat)||(0,$9.A)(e.maxLat)||(0,$9.A)(e.minLon)||(0,$9.A)(e.maxLon))return e}}"undefined"!=typeof document&&(bde=document.createElement("div"));const Ode={wpt:xde,rte:function(e,t,n,i){const o=dde(t,n);o.description=wde(t);const r=mde(t,"rtept",ude.gpx),s=new Array(r.length);for(let t=0;t<r.length;t++)xde(e,r[t],n,i),s[t]=hde(r[t]);o.polyline=vde(i.routeColor),i.clampToGround&&(o.polyline.clampToGround=!0),o.polyline.positions=s},trk:function(e,t,n,i){const o=dde(t,n);o.description=wde(t);const r=mde(t,"trkseg",ude.gpx);let s,a=[],c=[],l=!0;const u=new xoe.A;for(let e=0;e<r.length;e++)s=Cde(r[e]),a=a.concat(s.positions),s.times.length>0?(c=c.concat(s.times),u.addSamples(c,a),l=l&&!0):l=!1;if(l){const t=(0,$9.A)(i.waypointImage)?i.waypointImage:e._pinBuilder.fromMakiIconId("marker",yee.A.RED,32);o.billboard=yde(t),o.position=u,i.clampToGround&&(o.billboard.heightReference=Zne.Ay.CLAMP_TO_GROUND),o.availability=new Kne.A,o.availability.addInterval(new Xne.A({start:c[0],stop:c[c.length-1]}))}o.polyline=vde(i.trackColor),o.polyline.positions=a,i.clampToGround&&(o.polyline.clampToGround=!0)}};function Rde(e,t,n){const i=e._entityCollection;i.removeAll();const o=t.documentElement,r=pde(o,"version"),s=pde(o,"creator");let a;const c=function(e){const t=fde(e,"metadata",ude.gpx);if((0,$9.A)(t)){const e={name:_de(t,"name",ude.gpx),desc:_de(t,"desc",ude.gpx),author:Ede(t),copyright:Pde(t),link:Ide(t),time:_de(t,"time",ude.gpx),keywords:_de(t,"keywords",ude.gpx),bounds:Dde(t)};if((0,$9.A)(e.name)||(0,$9.A)(e.desc)||(0,$9.A)(e.author)||(0,$9.A)(e.copyright)||(0,$9.A)(e.link)||(0,$9.A)(e.time)||(0,$9.A)(e.keywords)||(0,$9.A)(e.bounds))return e}}(o);let l;(0,$9.A)(c)&&(a=c.name),"gpx"===o.localName?function(e,t,n,i){const o=Object.keys(Ode),r=o.length;for(let s=0;s<r;s++){const r=o[s],a=Ode[r],c=t.childNodes,l=c.length;for(let t=0;t<l;t++){const o=c[t];o.localName===r&&-1!==ude.gpx.indexOf(o.namespaceURI)&&a(e,o,n,i)}}}(e,o,i,n):console.log(`GPX - Unsupported node: ${o.localName}`);const u=i.computeAvailability();let d=u.start,h=u.stop;const A=kne.A.equals(d,Une.A.MINIMUM_VALUE),p=kne.A.equals(h,Une.A.MAXIMUM_VALUE);if(!A||!p){let e;A&&(e=new Date,e.setHours(0,0,0,0),d=kne.A.fromDate(e)),p&&(e=new Date,e.setHours(24,0,0,0),h=kne.A.fromDate(e)),l=new Pie,l.startTime=d,l.stopTime=h,l.currentTime=kne.A.clone(d),l.clockRange=xne.A.LOOP_STOP,l.clockStep=Cne.A.SYSTEM_CLOCK_MULTIPLIER,l.multiplier=Math.round(Math.min(Math.max(kne.A.secondsDifference(h,d)/60,1),31556900))}let f=!1;return e._name!==a&&(e._name=a,f=!0),e._creator!==s&&(e._creator=s,f=!0),m=e._metadata,g=c,!(!(0,$9.A)(m)&&!(0,$9.A)(g)||(0,$9.A)(m)&&(0,$9.A)(g)&&m.name===g.name&&m.dec===g.desc&&m.src===g.src&&m.author===g.author&&m.copyright===g.copyright&&m.link===g.link&&m.time===g.time&&m.bounds===g.bounds)&&(e._metadata=c,f=!0),e._version!==r&&(e._version=r,f=!0),l!==e._clock&&(f=!0,e._clock=l),f&&e._changed.raiseEvent(e),Cie.A.setLoading(e,!1),e;var m,g}function Mde(){this._changed=new lte.A,this._error=new lte.A,this._loading=new lte.A,this._clock=void 0,this._entityCollection=new Mie.A(this),this._entityCluster=new Rie.A,this._name=void 0,this._version=void 0,this._creator=void 0,this._metadata=void 0,this._isLoading=!1,this._pinBuilder=new Kre}Mde.load=function(e,t){return(new Mde).load(e,t)},Object.defineProperties(Mde.prototype,{name:{get:function(){return this._name}},version:{get:function(){return this._version}},creator:{get:function(){return this._creator}},metadata:{get:function(){return this._metadata}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!(0,$9.A)(e))throw new Q9.A("value must be defined.");this._entityCluster=e}}}),Mde.prototype.update=function(e){return!0},Mde.prototype.load=function(e,t){if(!(0,$9.A)(e))throw new Q9.A("data is required.");t=t??Cee.A.EMPTY_OBJECT,Cie.A.setLoading(this,!0);const n=this._name,i=this;return function(e,t,n,i){i=i??Cee.A.EMPTY_OBJECT;let o=n;if("string"==typeof n||n instanceof Eee.A){o=(n=Eee.A.createIfNeeded(n)).fetchBlob();const t=e._resourceCredits,i=n.credits;if((0,$9.A)(i)){const e=i.length;for(let n=0;n<e;n++)t.push(i[n])}}return Promise.resolve(o).then(function(t){return t instanceof Blob?(n=t,new Promise((e,t)=>{const i=new FileReader;i.addEventListener("load",function(){e(i.result)}),i.addEventListener("error",function(){t(i.error)}),i.readAsText(n)})).then(function(t){let n,o;try{n=sde.parseFromString(t,"application/xml")}catch(e){o=e.toString()}if((0,$9.A)(o)||n.body||"parsererror"===n.documentElement.tagName){let e=(0,$9.A)(o)?o:n.documentElement.firstChild.nodeValue;throw e||(e=n.body.innerText),new qne.A(e)}return Rde(e,n,i)}):Rde(e,t,i);var n}).catch(function(t){return e._error.raiseEvent(e,t),console.log(t),Promise.reject(t)})}(this,this._entityCollection,e,t).then(function(){let e;const t=i._entityCollection.computeAvailability();let o=t.start,r=t.stop;const s=kne.A.equals(o,Une.A.MINIMUM_VALUE),a=kne.A.equals(r,Une.A.MAXIMUM_VALUE);if(!s||!a){let t;s&&(t=new Date,t.setHours(0,0,0,0),o=kne.A.fromDate(t)),a&&(t=new Date,t.setHours(24,0,0,0),r=kne.A.fromDate(t)),e=new Pie,e.startTime=o,e.stopTime=r,e.currentTime=kne.A.clone(o),e.clockRange=xne.A.LOOP_STOP,e.clockStep=Cne.A.SYSTEM_CLOCK_MULTIPLIER,e.multiplier=Math.round(Math.min(Math.max(kne.A.secondsDifference(r,o)/60,1),31556900))}let c=!1;return e!==i._clock&&(i._clock=e,c=!0),n!==i._name&&(c=!0),c&&i._changed.raiseEvent(i),Cie.A.setLoading(i,!1),i}).catch(function(e){return Cie.A.setLoading(i,!1),i._error.raiseEvent(i,e),console.log(e),Promise.reject(e)})};const Lde=Mde;function Nde(e){e.stopPropagation(),e.preventDefault()}function Bde(e,t){const n=e;(0,$9.A)(n)&&(n.removeEventListener("drop",t,!1),n.removeEventListener("dragenter",Nde,!1),n.removeEventListener("dragover",Nde,!1),n.removeEventListener("dragexit",Nde,!1))}function Fde(e,t){e.addEventListener("drop",t,!1),e.addEventListener("dragenter",Nde,!1),e.addEventListener("dragover",Nde,!1),e.addEventListener("dragexit",Nde,!1)}function Ude(e,t,n,i){const o=e.scene;return function(r){const s=t.name;try{let a;if(/\.czml$/i.test(s))a=Hre.load(JSON.parse(r.target.result),{sourceUri:s});else if(/\.geojson$/i.test(s)||/\.json$/i.test(s)||/\.topojson$/i.test(s))a=Ose.load(JSON.parse(r.target.result),{sourceUri:s,clampToGround:i});else if(/\.(kml|kmz)$/i.test(s))a=rde.load(t,{sourceUri:s,proxy:n,camera:o.camera,canvas:o.canvas,clampToGround:i,screenOverlayContainer:e.container});else{if(!/\.gpx$/i.test(s))return void e.dropError.raiseEvent(e,s,`Unrecognized file: ${s}`);a=Lde.load(t,{sourceUri:s,proxy:n})}(0,$9.A)(a)&&e.dataSources.add(a).then(function(t){e.flyToOnDrop&&e.flyTo(t)}).catch(function(t){e.dropError.raiseEvent(e,s,t)})}catch(t){e.dropError.raiseEvent(e,s,t)}}}function kde(e,t){return function(n){e.dropError.raiseEvent(e,t.name,n.target.error)}}const Vde=function(e,t){if(!(0,$9.A)(e))throw new Q9.A("viewer is required.");if(e.hasOwnProperty("dropTarget"))throw new Q9.A("dropTarget is already defined by another mixin.");if(e.hasOwnProperty("dropEnabled"))throw new Q9.A("dropEnabled is already defined by another mixin.");if(e.hasOwnProperty("dropError"))throw new Q9.A("dropError is already defined by another mixin.");if(e.hasOwnProperty("clearOnDrop"))throw new Q9.A("clearOnDrop is already defined by another mixin.");if(e.hasOwnProperty("flyToOnDrop"))throw new Q9.A("flyToOnDrop is already defined by another mixin.");t=t??Cee.A.EMPTY_OBJECT;let n=!0,i=t.flyToOnDrop??!0;const o=new lte.A;let r=t.clearOnDrop??!0,s=t.dropTarget??e.container,a=t.clampToGround??!0,c=t.proxy;function l(t){Nde(t),r&&(e.entities.removeAll(),e.dataSources.removeAll());const n=t.dataTransfer.files,i=n.length;for(let t=0;t<i;t++){const i=n[t],o=new FileReader;o.onload=Ude(e,i,c,a),o.onerror=kde(e,i),o.readAsText(i)}}s=(0,dee.A)(s),Object.defineProperties(e,{dropTarget:{get:function(){return s},set:function(e){if(!(0,$9.A)(e))throw new Q9.A("value is required.");Bde(s,l),s=e,Fde(s,l)}},dropEnabled:{get:function(){return n},set:function(e){e!==n&&(e?Fde(s,l):Bde(s,l),n=e)}},dropError:{get:function(){return o}},clearOnDrop:{get:function(){return r},set:function(e){r=e}},flyToOnDrop:{get:function(){return i},set:function(e){i=e}},proxy:{get:function(){return c},set:function(e){c=e}},clampToGround:{get:function(){return a},set:function(e){a=e}}}),Fde(s,l),e.destroy=function(e,t,n){if("function"!=typeof t)throw new Q9.A("oldFunction is required to be a function.");if("function"!=typeof n)throw new Q9.A("oldFunction is required to be a function.");return function(){n.apply(e,arguments),t.apply(e,arguments)}}(e,e.destroy,function(){e.dropEnabled=!1}),e._handleDrop=l},zde=function(e,t){if(!(0,$9.A)(e))throw new Q9.A("viewer is required.");t=t??Cee.A.EMPTY_OBJECT;const n=new Wte({scene:e.scene,container:e.bottomContainer,lowFrameRateMessage:t.lowFrameRateMessage});Object.defineProperties(e,{performanceWatchdog:{get:function(){return n}}})},Hde=function(e){K9.A.typeOf.object("viewer",e);const t=document.createElement("div");t.className="cesium-viewer-voxelInspectorContainer",e.container.appendChild(t);const n=new gne(t,e.scene);Object.defineProperties(e,{voxelInspector:{get:function(){return n}}})},Gde="1.133.1"}}]);