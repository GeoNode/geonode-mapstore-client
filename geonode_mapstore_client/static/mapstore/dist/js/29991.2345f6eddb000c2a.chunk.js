"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[29991],{277327:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(273517),i=r.n(n),a=r(8571),o=r(8117);function l(e){var t=e.msgId,r=e.icon;return i().createElement("div",{className:"gn-main-event-container"},i().createElement("div",{className:"gn-main-event-content"},i().createElement("div",{className:"gn-main-event-text"},i().createElement("div",{className:"gn-main-icon"},i().createElement(o.e6,{glyph:r})),t&&i().createElement(a.A,{msgId:t}))))}l.defaultProps={msgId:"",icon:"exclamation-sign"};const u=l},29991:(e,t,r)=>{r.r(t),r.d(t,{default:()=>_e});var n=r(273517),i=r.n(n),a=r(605556),o=r.n(a),l=r(548975),u=r(466732),c=r(8117),s=r(962193),m=r.n(s),f=r(192202),d=r(899703);var p=r(487581),y=(0,n.lazy)(function(){return Promise.all([r.e(50953),r.e(15096),r.e(53651)]).then(r.bind(r,653651))});const v={SelectWidget:function(e){return i().createElement(d.A,e)},TextareaWidget:function(e){var t=e.id,r=e.options,a=void 0===r?{}:r,o=e.value,l=e.onChange;return null!=a&&a["geonode-ui:richTextEditor"]?i().createElement(n.Suspense,{fallback:null},i().createElement(y,{id:t,value:o,onChange:l})):i().createElement(p.A,e)}};var b=r(836970);var g=r(770491),h=["key"];function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},O.apply(null,arguments)}var E=r(8571),S=r(628017),j=r(221604);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach(function(t){A(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function A(e,t,r){return(t=function(e){var t=function(e){if("object"!=w(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,o,l=[],u=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return l}}(e,t)||C(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){if(e){if("string"==typeof e)return x(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(e,t):void 0}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var N=function(e){var t=document.querySelector("[for=".concat(e,"]"))||document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth",block:"start"})};function F(e){var t=e.idSchema,r=e.title,a=e.group,o=e.expanded,l=e.capitalizeTitle,u=k((0,n.useState)(!1),2),s=u[0],m=u[1],f=a.some(function(e){return e.error}),d=void 0===o?s:o;return i().createElement("li",null,i().createElement(b.A,{className:"".concat(f?"gn-metadata-error":"").concat(l?" capitalize":""),size:"xs",onClick:function(){return m(function(e){return!e})}},i().createElement(c.e6,{glyph:d?"bottom":"next"})," ",r,f?i().createElement(i().Fragment,null," ",i().createElement(c.e6,{glyph:"exclamation-sign"})):null),d?i().createElement("ul",null,a.map(function(e){return i().createElement("li",{key:e.name},i().createElement(b.A,{size:"xs",className:"".concat(e.error?"gn-metadata-error":"").concat(l?" capitalize":""),onClick:function(){var r;return N(null===(r=t[e.name])||void 0===r?void 0:r.$id)}},e.title,e.error?i().createElement(i().Fragment,null," ",i().createElement(c.e6,{glyph:"exclamation-sign"})):null))})):null)}function I(e,t){var r=e.idSchema,a=e.schema,o=e.uiSchema,l=e.properties,u=e.errorSchema,c=e.formContext,s=c.title,m=c.capitalizeTitle,f=k((0,n.useState)(""),2),d=f[0],p=f[1],y=l.reduce(function(e,r){var n,i,l=(null==a||null===(n=a.properties)||void 0===n||null===(n=n[r.name])||void 0===n?void 0:n.title)||r.name,c=(null==o?void 0:o[null==r?void 0:r.name])||{},s=(null==c?void 0:c["ui:options"])||{};if("hidden"===((null==c?void 0:c["ui:widget"])||s.widget)||!l.toLowerCase().includes((d||"").toLowerCase()))return e;var m,f=(null==s?void 0:s["geonode-ui:group"])||(0,S.kA)(t.messages,"gnviewer.metadataGroupTitle"),p=e[f]||[];return T(T({},e),{},A({},f,[].concat(function(e){if(Array.isArray(e))return x(e)}(m=p)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(m)||C(m)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[T(T({},r),{},{uiSchema:c,schema:null==a||null===(i=a.properties)||void 0===i?void 0:i[r.name],error:u[r.name],title:l})])))},{}),v="gn-metadata-title",g=!Object.keys(y).some(function(e){return y[e].length>0});return i().createElement("div",{className:"gn-metadata-layout"},i().createElement("ul",{className:"gn-metadata-list"},i().createElement(j.A,{placeholder:"gnviewer.filterMetadata",value:d,onChange:function(e){return p(e)}}),s?i().createElement("li",null,i().createElement(b.A,{size:"xs",onClick:function(){return N(v)}},i().createElement(E.A,{msgId:"gnviewer.metadataFor"})," ",s)):null,Object.keys(y).filter(function(e){return y[e].length>0}).map(function(e){var t=y[e];return i().createElement(F,{key:e,idSchema:r,title:e,group:t,expanded:!!d||void 0,capitalizeTitle:m})})),i().createElement("div",{className:"gn-metadata-groups"},s?i().createElement("div",{id:v,className:"gn-metadata-title"},i().createElement(E.A,{msgId:"gnviewer.metadataFor"})," ",s):null,g?i().createElement("div",{className:"field"},i().createElement(E.A,{msgId:"gnviewer.noMetadataFound"})):null,Object.keys(y).filter(function(e){return y[e].length>0}).map(function(e,t){var r=y[e];return i().createElement("div",{className:"gn-metadata-group",key:t},i().createElement("div",{className:"gn-metadata-group-title"},e),r.map(function(e,r){return i().createElement(i().Fragment,{key:"".concat(t,"_").concat(r)},e.content)}))})))}I.contextTypes={messages:o().object};const q=(0,r(164045).A)(function(e){return i().createElement("span",e,i().createElement(c.e6,{glyph:"info-sign"}))}),D={ArrayFieldItemTemplate:function(e){var t=e.children,r=e.className,n=e.disabled,a=e.hasToolbar,o=e.hasMoveDown,l=e.hasMoveUp,u=e.hasRemove,c=e.hasCopy,s=e.index,m=e.onCopyIndexClick,f=e.onDropIndexClick,d=e.onReorderClick,p=e.readonly,y=e.registry,v=e.uiSchema,b=y.templates.ButtonTemplates,g=b.CopyButton,h=b.MoveDownButton,O=b.MoveUpButton,E=b.RemoveButton;return i().createElement("div",{className:r},t,a&&i().createElement("div",{className:"field-item-toolbar"},(l||o)&&i().createElement(O,{disabled:n||p||!l,onClick:d(s,s-1),uiSchema:v,registry:y}),(l||o)&&i().createElement(h,{disabled:n||p||!o,onClick:d(s,s+1),uiSchema:v,registry:y}),c&&i().createElement(g,{disabled:n||p,onClick:m(s),uiSchema:v,registry:y}),u&&i().createElement(E,{disabled:n||p,onClick:f(s),uiSchema:v,registry:y})))},ArrayFieldTemplate:function(e){var t=e.canAdd,r=e.disabled,n=e.idSchema,a=e.uiSchema,o=e.items,l=e.onAddClick,u=e.readonly,c=e.registry,s=e.required,m=e.schema,f=e.title,d=(0,g.$R)(a),p=(0,g.$F)("ArrayFieldDescriptionTemplate",c,d),y=(0,g.$F)("ArrayFieldItemTemplate",c,d),v=(0,g.$F)("ArrayFieldTitleTemplate",c,d),b=c.templates.ButtonTemplates.AddButton;return i().createElement("div",{id:n.$id},i().createElement("div",{className:"field-array-header"},i().createElement(v,{idSchema:n,title:d.title||f,required:s,schema:m,uiSchema:a,registry:c,description:i().createElement(p,{idSchema:n,description:d.description||m.description,schema:m,uiSchema:a,registry:c})}),t&&i().createElement(b,{className:"array-item-add",onClick:l,disabled:r||u,uiSchema:a,registry:c})),i().createElement("div",{className:"array-item-list"},o&&o.map(function(e){var t=e.key,r=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,h);return i().createElement(y,O({key:t},r))})))},ArrayFieldTitleTemplate:function(e){var t=e.idSchema,r=e.title,n=e.schema,a=e.uiSchema,o=e.required,l=e.registry,u=e.description,c=(0,g.$R)(a,l.globalUiOptions),s=c.label;if(!r||void 0!==s&&!s)return null;var m=(0,g.$F)("TitleFieldTemplate",l,c);return i().createElement(m,{id:(0,g.EH)(t),title:r,required:o,schema:n,uiSchema:a,registry:l,description:u})},ObjectFieldTemplate:function(e){var t;if("root"===(null==e||null===(t=e.idSchema)||void 0===t?void 0:t.$id))return i().createElement(I,e);var r=e.description,n=e.disabled,a=e.formData,o=e.idSchema,l=e.onAddClick,u=e.properties,c=e.readonly,s=e.registry,m=e.required,f=e.schema,d=e.title,p=e.uiSchema,y=e.formContext,v=(0,g.$R)(p),b=(0,g.$F)("TitleFieldTemplate",s,v),h=(0,g.$F)("DescriptionFieldTemplate",s,v),O=s.templates.ButtonTemplates.AddButton;return i().createElement("div",{id:o.$id},d&&i().createElement(b,{id:(0,g.EH)(o),title:d,required:m,schema:f,uiSchema:p,registry:s,formContext:y,description:i().createElement(h,{id:(0,g.IR)(o),description:r,schema:f,uiSchema:p,registry:s})}),null!=u&&u.length?i().createElement("div",{className:"field-object-properties"},u.map(function(e){return e.content})):null,(0,g.Xl)(f,p,a)&&i().createElement(O,{onClick:l(f),disabled:n||c,uiSchema:p,registry:s}))},TitleFieldTemplate:function(e){var t=e.id,r=e.required,n=e.title,a=e.description,o=e.formContext;return i().createElement("div",{id:t},i().createElement("label",{className:null!=o&&o.capitalizeTitle?"capitalize":""},n,r&&i().createElement("span",{className:"required"}," ","*"),a?i().createElement(i().Fragment,null," ",a):null))},DescriptionFieldTemplate:function(e){var t=e.description,r=e.id;return m()(t)?null:i().createElement(q,{id:r,tooltip:t,tooltipPosition:"right"})},ErrorListTemplate:function(){return null},FieldTemplate:function(e){var t=e.id,r=e.label,n=e.children,a=e.errors,o=e.help,l=e.description,u=e.hidden,c=e.required,s=e.displayLabel,m=e.registry,f=e.uiSchema,d=e.formContext,p=(0,g.$R)(f),y=(0,g.$F)("WrapIfAdditionalTemplate",m,p);return u?i().createElement("div",{className:"hidden"},n):i().createElement(y,e,s&&i().createElement("label",{className:"control-label".concat(null!=d&&d.capitalizeTitle?" capitalize":""),htmlFor:t},r,c&&i().createElement("span",{className:"required"}," ","*"),l?i().createElement(i().Fragment,null," ",l):null),n,a,o)},ButtonTemplates:{AddButton:function(e){var t=e.onClick,r=e.disabled;return i().createElement(b.A,{disabled:r,className:"square-button-md",onClick:t,variant:"primary"},i().createElement(c.e6,{glyph:"plus"}))},MoveUpButton:function(e){var t=e.onClick,r=e.disabled;return i().createElement(b.A,{disabled:r,className:"square-button-md",onClick:t},i().createElement(c.e6,{glyph:"arrow-up"}))},MoveDownButton:function(e){var t=e.onClick,r=e.disabled;return i().createElement(b.A,{disabled:r,className:"square-button-md",onClick:t},i().createElement(c.e6,{glyph:"arrow-down"}))},RemoveButton:function(e){var t=e.onClick,r=e.disabled;return i().createElement(b.A,{disabled:r,className:"square-button-md",onClick:t},i().createElement(c.e6,{glyph:"trash"}))}}};var K=r(995531),z=r(499084),_=r.n(z),$=r(185015),R=r.n($),B=r(730872),M=r.n(B),L=r(956449),U=r.n(L),V=r(738221),W=r.n(V),H=r(192016),G=r(551783);function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}var J=["loadOptions","pageSize","debounceTime","labelKey","valueKey","newOptionPromptText"];function Q(){return Q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Q.apply(null,arguments)}function Y(e){return function(e){if(Array.isArray(e))return re(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||te(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t,r){return(t=function(e){var t=function(e){if("object"!=X(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=X(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==X(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,o,l=[],u=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw i}}return l}}(e,t)||te(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){if(e){if("string"==typeof e)return re(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?re(e,t):void 0}}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ne=(0,G.A)("placeholder")(H.Ay);const ie=function(e){var t=e.loadOptions,r=e.pageSize,a=void 0===r?20:r,o=e.debounceTime,l=void 0===o?500:o,u=e.labelKey,c=void 0===u?"label":u,s=e.valueKey,f=void 0===s?"value":s,d=e.newOptionPromptText,p=void 0===d?"Create option":d,y=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,J),v=ee((0,n.useState)(""),2),b=v[0],g=v[1],h=ee((0,n.useState)(!1),2),O=h[0],E=h[1],S=ee((0,n.useState)(!1),2),j=S[0],w=S[1],P=ee((0,n.useState)(!1),2),T=P[0],A=P[1],k=ee((0,n.useState)(1),2),C=k[0],x=k[1],N=ee((0,n.useState)([]),2),F=N[0],I=N[1],q=(0,n.useRef)(),D=(0,n.useRef)(),z=(0,n.useRef)();return z.current=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(){var e;q.current&&(null===(e=q.current)||void 0===e||e.cancel(),q.current=void 0);var t=K.A.CancelToken;q.current=t.source()}();var r=e.q,n=null!=r?r:b;E(!0);var i=e.page||C;t({q:n,page:i,pageSize:a,config:{cancelToken:q.current.token}}).then(function(e){var t=e.results.map(function(e){return e.selectOption});t=function(e,t){if(y.creatable&&!m()(t)){var r,n=function(e){var r;return(null==e||null===(r=e[c])||void 0===r?void 0:r.toLowerCase())===t.toLowerCase()},i=null===(r=y.value)||void 0===r?void 0:r.some(n),a=e.some(n);return i||a?e:[Z(Z(Z({},c,"".concat(p,' "').concat(t,'"')),f,t),"result",Z(Z({},f,t),c,t))].concat(e)}return e}(t=1===i?t:[].concat(Y(F),Y(t)),n),I(t),w(e.isNextPageAvailable),E(!1),q.current=void 0}).catch(function(){I([]),w(!1),E(!1),q.current=void 0})},(0,n.useEffect)(function(){D.current=W()(function(e){e!==b&&(g(e),x(1),I([]),z.current({q:e,page:1}))},l)},[b]),(0,n.useEffect)(function(){T&&(g(""),x(1),I([]),z.current({q:"",page:1}))},[T]),(0,n.useEffect)(function(){C>1&&z.current()},[C]),i().createElement(ne,Q({},y,{isLoading:O,options:F,labelKey:c,valueKey:f,onOpen:function(){return A(!0)},onClose:function(){return A(!1)},filterOptions:function(e){return e.map(function(e){var t=/\"(.*?)\"/.exec(b);return t?t[1]:e})},onInputChange:function(e){return t=e,q.current&&(null===(r=q.current)||void 0===r||r.cancel(),q.current=void 0),D.current.cancel(),void D.current(t);var t,r},onMenuScrollToBottom:function(){!O&&j&&x(C+1)}}))};function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}var oe=["className","description","error","helpTitleIcon","id","labelKey","name","title","value","valueKey","showLabel","required"];function le(){return le=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},le.apply(null,arguments)}function ue(e,t,r){return(t=function(e){var t=function(e){if("object"!=ae(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ae(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ce=function(e){var t=e.className,r=e.description,n=e.error,a=e.helpTitleIcon,o=e.id,l=e.labelKey,u=void 0===l?"label":l,c=e.name,s=e.title,f=e.value,d=e.valueKey,p=void 0===d?"value":d,y=e.showLabel,v=void 0===y||y,b=e.required,g=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,oe);return i().createElement("div",{className:"form-group".concat(t?" "+t:"").concat(n?" has-error":"")},v?i().createElement("label",{className:"control-label",htmlFor:o},s||c,b?i().createElement("span",{className:"required"}," ","*"):null,a&&!m()(r)?i().createElement(i().Fragment,null," ",i().createElement(q,{tooltip:r,tooltipPosition:"right"})):null):null,i().createElement(ie,le({},g,{id:o,value:f&&U()(f)?f.map(function(e){return ue(ue({result:e},p,R()(e)?e:e[p]),u,R()(e)?e:e[u])}):f,valueKey:p,labelKey:u})),n)};ce.propTypes={className:o().string,description:o().string,error:o().element,helpTitleIcon:o().bool,id:o().string.isRequired,labelKey:o().string,name:o().string,title:o().string,value:o().any.isRequired,valueKey:o().string,showLabel:o().bool};const se=ce;var me=r(283306),fe=r(858156),de=r.n(fe);function pe(e){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(e)}function ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(r),!0).forEach(function(t){be(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function be(e,t,r){return(t=function(e){var t=function(e){if("object"!=pe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==pe(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ge(e){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge(e)}var he=["name"],Oe=["result"],Ee=["q","config"];function Se(){return Se=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Se.apply(null,arguments)}function je(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function we(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?je(Object(r),!0).forEach(function(t){Pe(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):je(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Pe(e,t,r){return(t=function(e){var t=function(e){if("object"!=ge(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ge(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ge(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Te(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Ae(e,t){return Object.keys(t||{}).some(function(r){var n;return r===e||!(null===(n=t[r])||void 0===n||!n.properties)&&Ae(e,t[r].properties)})}function ke(e){var t,r=e.name,n=Te(e,he),i=(r||"").split("-"),a=parseFloat(i[i.length-1]);return!isNaN(a)&&!Ae(r,null==n||null===(t=n.registry)||void 0===t||null===(t=t.rootSchema)||void 0===t?void 0:t.properties)}const Ce={SchemaField:function(e){var t,r,a,o,l=e.onChange,u=e.schema,c=e.formData,s=e.idSchema,f=e.name,d=e.errorSchema,p=e.uiSchema,y=e.required,v=e.formContext,b=null==p?void 0:p["ui:options"],g=null==b?void 0:b["geonode-ui:autocomplete"],h="string"===(null==u||null===(t=u.items)||void 0===t?void 0:t.type),O="object"===(null==u||null===(r=u.items)||void 0===r?void 0:r.type),E="array"===(null==u?void 0:u.type)&&(h||O&&!m()(null==u||null===(a=u.items)||void 0===a?void 0:a.properties)),S="object"===(null==u?void 0:u.type)&&!m()(null==u?void 0:u.properties),j=function(e){var t=e.uiSchema,r=e.idSchema,i=e.onChange,a=e.isMultiSelect,o=e.formContext,l=e.name,u=null==t?void 0:t["ui:options"],c=null==u?void 0:u["geonode-ui:referencevalue"],s=null==u?void 0:u["geonode-ui:referencekey"],m=r.$id.match(/_(\d+)(_|$)/),f=m?parseInt(m[1],10):null,d=c?de()(o,"metadata.".concat(M()(c)({index:f}))):null,p=(0,n.useRef)(null),y=function(e){p.current=ve(ve({},p.current),{},be({},l,e))};return(0,n.useEffect)(function(){null===p.current&&c&&y(d)},[]),(0,n.useEffect)(function(){var e;c&&d!==(null===(e=p.current)||void 0===e?void 0:e[l])&&(y(d),i(a?[]:{}))},[c,d]),{referenceValue:d,referenceKey:s}}(we(we({},e),{},{isMultiSelect:E})),w=j.referenceValue,P=j.referenceKey;if(g&&(E||S)){var T,A=b.classNames,k=b.style,C=b.description,x=b.disabled,N=b.help,F=b.hideError,I=b.label,q=b.placeholder,D=b.title,z=(F?[]:_()(d)).reduce(function(e,t){return null!=t&&t.__errors?e.push({messages:t.__errors}):Object.keys(t||{}).forEach(function(r){var n;null!==(n=t[r])&&void 0!==n&&n.__errors&&e.push({key:r,messages:t[r].__errors})}),e},[]),$=R()(g)?{url:g}:g,B=null==$?void 0:$.url;w&&(B=M()(B)(Pe({},null!=P?P:"id",w)));var L=(null==$?void 0:$.queryKey)||"q",U=(null==$?void 0:$.resultsKey)||"results",V=(null==$?void 0:$.valueKey)||"id",W=(null==$?void 0:$.labelKey)||"label",H=!(null==$||!$.creatable),G=null!=q?q:" ",X={className:"field".concat(A?" "+A:""," ").concat(null!=v&&v.capitalizeTitle?"capitalize":""),clearable:!y,creatable:H,id:s.$id,labelKey:W,multi:E,name:f,placeholder:G,showLabel:null==I||I,title:null!=D?D:u.title,value:c,valueKey:V,helpTitleIcon:!0,description:null!==(T=null!=N?N:C)&&void 0!==T?T:u.description,disabled:x||(null==e?void 0:e.readonly)||(null==u?void 0:u.readOnly),style:k,required:y,onChange:function(e){var t,r=null!==(t=null==e?void 0:e.result)&&void 0!==t?t:void 0;return l(E?e.map(function(e){var t,r=e.result,n=Te(e,Oe);return void 0===r?n:R()(r)?r:h?r[V]:Object.fromEntries(Object.keys(null===(t=u.items)||void 0===t?void 0:t.properties).map(function(e){return[e,r[e]]}))}):r)},loadOptions:function(e){var t=e.q,r=e.config,n=Te(e,Ee);return K.A.get(B,we(we({},r),{},{params:we(we(we({},n),t&&Pe({},L,t)),{},{page:n.page})})).then(function(e){var t,r=e.data;return{isNextPageAvailable:!(null===(t=r.pagination)||void 0===t||!t.more),results:null==r?void 0:r[U].map(function(e){return{selectOption:Pe(Pe({result:e},V,R()(e)?e:e[V]),W,R()(e)?e:e[W])}})}})},error:m()(z)?null:i().createElement(i().Fragment,null,z.map(function(e,t){return i().createElement("ul",{key:t,className:"text-danger"},_()(e.messages).map(function(t,r){return i().createElement("li",{key:r},e.key?"".concat(e.key,": "):"",t)}))}))};return i().createElement(se,X)}var J=ke(e);return i().createElement(me.A,Se({},e,{uiSchema:J?we(we({},e.uiSchema),{},{"ui:label":!1,"ui:options":we(we({},null===(o=e.uiSchema)||void 0===o?void 0:o["ui:options"]),{},{label:!1})}):p}))}};var xe=r(277327),Ne=r(866875);function Fe(e){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fe(e)}var Ie=["__errors"];function qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function De(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(r),!0).forEach(function(t){Ke(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qe(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ke(e,t,r){return(t=function(e){var t=function(e){if("object"!=Fe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Fe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Fe(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ze(e,t){var r=e.pk,a=e.loading,o=e.error,s=e.extraErrors,d=e.metadata,p=e.schema,y=e.uiSchema,b=e.updateError,g=e.capitalizeFieldTitle,h=e.setLoading,O=e.setError,E=e.setUISchema,j=e.setSchema,w=e.setMetadata,P=e.setInitialMetadata,T=e.setUpdateError,A=e.setResource,k=e.updating,C=e.setExtraErrors,x=e.readOnly,N=t.messages,F=(0,n.useRef)(!1),I=(0,n.useRef)(),q=null!=s?s:{},K=q.__errors,z=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(q,Ie);return I.current=function(e){null!=e&&e.validateForm&&!F.current&&(F.current=!0,m()(z)&&e.validateForm())},(0,n.useEffect)(function(){r&&(h(!0),O(!1),(0,f._T)(r).then(function(e){E(e.uiSchema),j(e.schema),w(e.metadata),P(e.metadata),A(e.resource),C(e.extraErrors)}).catch(function(){O(!0)}).finally(function(){h(!1)}))},[r]),(0,n.useEffect)(function(){return function(){T(null),C({})}},[]),a?i().createElement(Ne.A,null):o?i().createElement(xe.A,{msgId:"gnviewer.metadataNotFound"}):d||p?i().createElement("div",{className:"gn-metadata"},i().createElement("div",{className:"gn-metadata-header"},!m()(b)&&i().createElement(c.Fc,{bsStyle:b.type,style:{margin:"0.25rem 0"}},b.message,!m()(K)&&i().createElement("ul",null,K.map(function(e,t){return i().createElement("li",{key:t},e)})))),i().createElement("div",{className:"gn-metadata-container"},i().createElement(u.Ay,{liveValidate:!0,readonly:x,ref:I.current,formContext:{title:null==d?void 0:d.title,metadata:d,capitalizeTitle:g},schema:p,widgets:v,uiSchema:y,formData:d,validator:l.Ay,templates:D,fields:Ce,extraErrors:z,transformErrors:function(e){return e.filter(function(e){return"must be equal to constant"!==e.message}).map(function(e){var t=(e.message||"").startsWith("must have required property")?"must have required property":e.message,r="metadata.error.".concat(t),n=(0,S.kA)(N,r);return De(De({},e),{},{message:r===n?t:n})})},experimental_defaultFormStateBehavior:{arrayMinItems:{populate:"never",mergeExtraDefaults:!1}},onChange:function(e){var t;t=e.formData,T(null),w(t)}},i().createElement(i().Fragment,null))),k?i().createElement(Ne.A,{style:{opacity:.5}}):null):null}ze.contextTypes={messages:o().object},ze.defaultProps={capitalizeFieldTitle:!0};const _e=ze}}]);