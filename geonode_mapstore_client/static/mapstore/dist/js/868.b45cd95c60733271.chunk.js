/*! For license information please see 868.b45cd95c60733271.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[868],{96891(e,t,r){r.d(t,{A:()=>i});var n=r(576314),o=r.n(n)()(function(e){return e[1]});o.push([e.id,".ms-filter-selector-header {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-end;\n}\n.ms-filter-selector-header .ms-filter-title {\n  flex: 1;\n  margin-bottom: 0;\n  padding: 5px 0;\n}\n",""]);const i=o},270871(e,t,r){r.d(t,{$7:()=>o,UN:()=>c,W0:()=>i,WU:()=>a,_O:()=>n,jD:()=>l});var n="MAP_EDITOR:SHOW",o="MAP_EDITOR:HIDE",i="MAP_EDITOR:SAVE",a=function(e,t){return{type:n,owner:e,map:t}},l=function(e){return{type:o,owner:e}},c=function(e,t){return{type:i,owner:t,map:e}}},637129(e,t,r){r.d(t,{A:()=>qr});var n=r(273517),o=r.n(n),i=r(916589),a=r(540285),l=r(332222),c=r(397619);const u=(0,i.compose)(l.A,(0,c.jZ)(),(0,c.o$)(),(0,c.rk)());var s=r(978632),d=r.n(s),f=r(811668),p=r(593737),v=r.n(p),y=r(382378),m=r.n(y),g=r(672975),b=r(273494),h=r(883832),O=r(115263),w=r(181817);function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function P(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof l?n:l,u=Object.create(c.prototype);return j(u,"_invoke",function(r,n,o){var i,l,c,u=0,s=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return i=t,l=0,c=e,f.n=r,a}};function p(r,n){for(l=r,c=n,t=0;!d&&u&&!o&&t<s.length;t++){var o,i=s[t],p=f.p,v=i[2];r>3?(o=v===n)&&(c=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=r<2&&p<i[1])?(l=0,f.v=n,f.n=i[1]):p<v&&(o=r<3||i[0]>n||n>v)&&(i[4]=r,i[5]=n,f.n=v,l=0))}if(o||r>1)return a;throw d=!0,n}return function(o,s,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===s&&p(s,v),l=s,c=v;(t=l<2?e:c)||!d;){i||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(u=2,i){if(l||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=i.return)&&t.call(i),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);i=e}else if((t=(d=f.n<0)?c:r.call(n,f))!==a)break}catch(t){i=e,l=1,c=t}finally{u=1}}return{value:t,done:d}}}(r,o,i),!0),u}var a={};function l(){}function c(){}function u(){}t=Object.getPrototypeOf;var s=[][n]?t(t([][n]())):(j(t={},n,function(){return this}),t),d=u.prototype=l.prototype=Object.create(s);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,j(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,j(d,"constructor",u),j(u,"constructor",c),c.displayName="GeneratorFunction",j(u,o,"GeneratorFunction"),j(d),j(d,o,"Generator"),j(d,n,function(){return this}),j(d,"toString",function(){return"[object Generator]"}),(P=function(){return{w:i,m:f}})()}function j(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}j=function(e,t,r,n){function i(t,r){j(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(i("next",0),i("throw",1),i("return",2))},j(e,t,r,n)}function E(e,t,r,n,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach(function(t){I(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function I(e,t,r){return(t=function(e){var t=function(e){if("object"!=S(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==S(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const T=(0,i.compose)((0,i.compose)((0,f.connect)(null,function(e,t){var r,n="table"===(null==t?void 0:t.widgetType)&&(null==t?void 0:t.enableZoomInTblWidget),i=n&&!(null==t||!t.isDashboardWidget),a=n&&!i,l=(null==t||null===(r=t.widgets)||void 0===r?void 0:r.filter(function(e){var r;return"map"===e.widgetType&&(null==e?void 0:e.dependenciesMap)&&(null==e||null===(r=e.dependenciesMap)||void 0===r||null===(r=r.mapSync)||void 0===r?void 0:r.includes(t.id))&&e.mapSync}))||[];return{gridTools:((null==t?void 0:t.mapSync)||l.length)&&i||a?O.qq.map(function(r){return A(A({},r),{},{events:{onClick:(n=P().m(function r(n,o,a){var l,c,u,s,d,f,p,v=arguments;return P().w(function(r){for(;;)switch(r.p=r.n){case 0:if(c=(l=v.length>3&&void 0!==v[3]?v[3]:{}).crs,u=l.maxZoom,null==t||!t.recordZoomLoading){r.n=1;break}return r.a(2);case 1:if(r.p=1,null!=n&&n.bbox){r.n=3;break}return null==t||t.updateProperty(t.id,"dependencies.zoomLoader",!0),r.n=2,(0,w.x$)(null==t||null===(s=t.layer)||void 0===s||null===(s=s.search)||void 0===s?void 0:s.url,null==t||null===(d=t.layer)||void 0===d?void 0:d.name,{outputFormat:"application/json",srsname:"EPSG:4326",featureId:n.id,propertyName:(null==t?void 0:t.geomProp)||"the_geom"});case 2:f=r.v,p=f.data,n.geometry=null==p?void 0:p.features[0].geometry,n.bbox=m()(null==p?void 0:p.features[0]),i?null==t||t.updateProperty(t.id,"dependencies.extentObj",{extent:n.bbox,crs:c||"EPSG:4326",maxZoom:u}):e((0,b.jc)(n.bbox,c||"EPSG:4326",u)),null==t||t.updateProperty(t.id,"dependencies.zoomLoader",!1),r.n=4;break;case 3:i?null==t||t.updateProperty(t.id,"dependencies.extentObj",{extent:n.bbox,crs:c||"EPSG:4326",maxZoom:u}):e((0,b.jc)(n.bbox,c||"EPSG:4326",u));case 4:r.n=6;break;case 5:r.p=5,r.v,e((0,h.z3)({title:"notification.warning",message:"notification.errorLoadingGF",action:{label:"notification.warning"},autoDismiss:3,position:"tc"})),null==t||t.updateProperty(t.id,"dependencies.zoomLoader",!1);case 6:return r.a(2)}},r,null,[[1,5]])}),a=function(){var e=this,t=arguments;return new Promise(function(r,o){var i=n.apply(e,t);function a(e){E(i,r,o,a,l,"next",e)}function l(e){E(i,r,o,a,l,"throw",e)}a(void 0)})},function(e,t,r){return a.apply(this,arguments)})},formatter:null!=t&&t.recordZoomLoading?o().createElement(o().Fragment,null,o().createElement("span",null,o().createElement(g.A,null))):r.tableWidgetFormatter});var n,a}):[]}})),(0,i.withPropsOnChange)(["gridEvents"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.gridEvents,r=void 0===t?{}:t,n=e.updateProperty,o=void 0===n?function(){}:n,i=e.id,a=v()(function(){return o.apply(void 0,arguments)},500);return{gridEvents:A(A({},r),{},{onAddFilter:function(e){return a(i,"quickFilters.".concat(e.attribute),e)},onColumnResize:function(e,t,r,n,a,l){return o(i,'options.columnSettings["'.concat(d()(l.filter(function(e){return!e.hide})[e],"name"),'"].width'),t)}})}}),l.A,(0,c.jZ)(),(0,c.o$)(),(0,c.rk)(),(0,i.withPropsOnChange)(["gridEvents"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.gridEvents,r=void 0===t?{}:t,n=e.updateProperty,o=void 0===n?function(){}:n,i=e.id;return{gridEvents:A(A({},r),{},{onGridSort:function(e,t){return o(i,"sortOptions",{sortBy:e,sortOrder:t})}})}}));var x=r(510448);const C=(0,i.compose)(l.A,(0,c.jZ)(),(0,c.qP)(),(0,c.o$)(),(0,c.rk)()),F=(0,i.compose)(l.A,(0,c.jZ)(),(0,c.o$)(),(0,c.rk)()),M=(0,i.compose)(l.A,(0,c.jZ)(),(0,c.qP)(),(0,c.o$)(),(0,c.rk)());var k=r(738885),R=r(452005),N=r(685591),L=r.n(N),W=r(722088),G=r.n(W),_=r(214158),z=r(159686),U=r(45388),q=r.n(U),H=r(545567),V=r(112585),Z=r(525859);const $=function(e){return e.switchMap(function(e){var t=e.layer,r=void 0===t?{}:t,n=e.options,o=void 0===n?{}:n,i=e.filter,a=e.onLoad,l=void 0===a?function(){}:a,c=e.onLoadError,u=void 0===c?function(){}:c;return(0,H.Gw)(r,i,{timeout:15e3,params:{propertyName:(0,Z.MI)(o.propertyName),viewParams:o.viewParams}}).map(function(){return{loading:!1,error:void 0}}).do(function(e){return l({features:e.features,pagination:{totalFeatures:e.totalFeatures}})}).catch(function(e){return q().Observable.of({loading:!1,error:e,data:[]}).do(u)})})};var K=r(549112);function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function Y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(r),!0).forEach(function(t){X(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function X(e,t,r){return(t=function(e){var t=function(e){if("object"!=J(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=J(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==J(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach(function(t){re(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function re(e,t,r){return(t=function(e){var t=function(e){if("object"!=Q(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Q(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(45388);function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach(function(t){ae(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ae(e,t,r){return(t=function(e){var t=function(e){if("object"!=ne(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ne(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ne(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var le=function(e,t){var r,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(r=e,r.filter(function(e){var t=e.layer,r=void 0===t?{}:t,n=e.mapSync,o=e.dependencies,i=e.dependenciesMap,a=e.widgets;return!(n&&(0,K.zR)(a,i)&&(null==o||!o.viewport))&&r.name}).distinctUntilChanged(function(e,t){var r=e.layer,n=void 0===r?{}:r,o=e.options,i=void 0===o?{}:o,a=e.filter,l=e.sortOptions;return t.layer&&n.name===t.layer.name&&n.loadingError===t.layer.loadingError&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.propertyName===t.propertyName&&e.viewParams===t.viewParams}(i,t.options)&&a===t.filter&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.sortBy===t.sortBy&&e.sortOrder===t.sortOrder}(l,t.sortOptions)}).map(function(e){return B(B({},e),{},{features:[],pages:[],pagination:{}})})).let(n?function(e){return function(t){return t.switchMap(function(t){var r=t.layer,n=void 0===r?{}:r,o=t.size,i=void 0===o?20:o,a=t.maxStoredPages,l=void 0===a?5:a,c=t.filter,u=t.options,s=void 0===u?{}:u,d=t.sortOptions,f=t.pages,p=t.features,v=void 0===p?[]:p,y=t.onLoad,m=void 0===y?function(){}:y,g=t.onLoadError,b=void 0===g?function(){}:g;return e.switchMap(function(e,t){var r=e.pagesRange,o=e.pagination,a=void 0===o?{}:o;return function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(t),(0,H.Gw)(n,c,te(te({},(0,Z.yJ)(r,f,i)),{},{sortOptions:d,timeout:15e3,totalFeatures:a.totalFeatures,propertyName:(0,Z.MI)(s.propertyName),viewParams:s.viewParams})).do(function(e){return m(te(te({},(0,Z.gz)(e,r,{pages:f,features:v},te(te({},(0,Z.yJ)(r,f,i)),{},{size:i,maxStoredPages:l}))),{},{pagination:{totalFeatures:e.totalFeatures}}))}).map(function(){return{loading:!1}}).catch(function(e){return q().Observable.of({loading:!1,error:e}).do(b)}).startWith({loading:!0})})})}}(t.withLatestFrom(e.map(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).pagination;return{pagination:void 0===e?{}:e}}),function(e,t){return ie({pagesRange:e},t)})):$).startWith({})},ce=function(e){var t,r=(0,i.createEventHandler)(),n=r.handler,o=r.stream;return(t=e,t.distinctUntilChanged(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).layer,t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).layer;return(0,V.U7)(e)===(0,V.U7)(t)&&e.loadingError===t.loadingError}).switchMap(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).layer;return(0,H.sq)({layer:e}).map(function(e){return{describeFeatureType:e.data,loading:!1,error:void 0}}).catch(function(e){return q().Observable.of({loading:!1,error:e})})})).combineLatest(le(e,o.startWith({startPage:0,endPage:1})),function(e,t){return ie(ie(ie({},e),t),{},{pageEvents:{moreFeatures:n,onPageChange:function(){}}})}).startWith({loading:!0})};const ue=(0,i.compose)((0,i.defaultProps)({virtualScroll:!0,size:20,maxStoredPages:5}),(0,i.withStateHandlers)({pages:[],features:[],pagination:{}},{setData:function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{pages:e.pages,features:e.features,pagination:e.pagination,error:void 0}}}}),(0,i.withHandlers)({onLoad:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.setData,r=void 0===t?function(){}:t,n=e.onLoad,o=void 0===n?function(){}:n;return function(){r.apply(void 0,arguments),o.apply(void 0,arguments)}}}),(0,i.withProps)(function(){return{dataStreamFactory:ce}}),z.A,(0,i.withProps)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,r=void 0===t?{}:t,n=e.describeFeatureType,o=e.columnSettings,i=void 0===o?{}:o;return{columnSettings:G()(n?(0,_.Mm)(n).filter(function(e){return!L()((0,Z.MI)(r.propertyName)||[],e.name)}).reduce(function(e,t){return ie(ie({},e),{},ae({},t.name,{hide:!0}))},{}):{},r.columnSettings||{},i)}}));var se=r(817603),de=r(367867),fe=r(859009),pe=r(738805),ve=r.n(pe),ye=r(227341),me=r.n(ye),ge=r(809136),be=r.n(ge),he=r(58884),Oe=r(325177),we=r(264053);var Se=r(102685),Pe=r(905185),je=r(6683);function Ee(e){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ee(e)}function De(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?De(Object(r),!0).forEach(function(t){Ie(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ie(e,t,r){return(t=function(e){var t=function(e){if("object"!=Ee(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ee(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Te(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const xe=(0,i.compose)((0,i.withPropsOnChange)(["id"],function(e){var t=e.hookRegister,r=void 0===t?null:t,n=e.id;return{hookRegister:(null==r?void 0:r.id)!==n?(0,je.sl)(n):r}}),(0,i.compose)((0,i.withPropsOnChange)(function(){var e,t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null===(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).widgets)||void 0===e?void 0:e.find(function(e){var t;return null==e||null===(t=e.dependencies)||void 0===t?void 0:t.extentObj}),o=null===(t=r.widgets)||void 0===t?void 0:t.find(function(e){var t;return null==e||null===(t=e.dependencies)||void 0===t?void 0:t.extentObj});return!be()(n,o)&&o},function(e){var t,r,n,o=e.id,i=e.widgets,a=e.updateProperty,l=e.hookRegister,c=null==i?void 0:i.find(function(e){var t;return null==e||null===(t=e.dependencies)||void 0===t?void 0:t.extentObj}),u=null==c||null===(t=c.dependencies)||void 0===t?void 0:t.extentObj,s=o;if(!c)return{};if(null!=c&&c.mapSync){var d,f=null==i?void 0:i.find(function(e){var t;return(null==c||null===(t=c.dependenciesMap)||void 0===t?void 0:t.mapSync.includes(e.id))&&e.id===s});r=null==f||null===(d=f.maps)||void 0===d?void 0:d.find(function(e){return e.mapStateSource===f.id})}if(!r||null==c||!c.mapSync){var p=i.filter(function(e){var t;return"map"===e.widgetType&&(null==e?void 0:e.dependenciesMap)&&(null==e||null===(t=e.dependenciesMap)||void 0===t||null===(t=t.mapSync)||void 0===t?void 0:t.includes(null==c?void 0:c.id))&&e.id===s});r=null!=p&&p.length?function(e){if(Array.isArray(e))return Te(e)}(n=p)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return Te(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Te(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}():void 0}var v=null==l?void 0:l.getHook("ZOOM_TO_EXTENT_HOOK");return v&&(null==l?void 0:l.id)===o&&r&&(v(u.extent,{crs:u.crs,maxZoom:u.maxZoom}),a(c.id,"dependencies.extentObj",void 0)),{}})),(0,i.branch)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mapSync,r=e.dependencies;return t&&(!me()(r.quickFilters)||!me()(r.filter))},(0,i.compose)((0,i.withPropsOnChange)(["id"],function(e){var t=e.hookRegister,r=void 0===t?null:t,n=e.id;return{hookRegister:(null==r?void 0:r.id)!==n?(0,je.sl)(n):r}}),(0,i.mapPropsStream)(function(e){return e.distinctUntilChanged(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return be()(e.dependencies.quickFilters,t.dependencies.quickFilters)&&be()(e.dependencies.filter,t.dependencies.filter)&&be()(e.dependencies.layer,t.dependencies.layer)}).debounceTime(500).switchMap(function(e){var t=e.mapSync,r=e.dependencies,n=void 0===r?{}:r,o=e.filter,i=e.hookRegister;if(!t||me()(n.layer))return U.Observable.of({loading:!1});var a={};n.quickFilters&&(a=Ae(Ae({},a),(0,he.gq)(o,n.quickFilters,n.options))),n.filter&&(a=Ae(Ae({},a),(0,Se.mA)([a,n.filter])));var l=n&&n.layer&&n.layer.name;if(!me()(a)){a=Ae(Ae({},a),{},{options:Ae(Ae({},a.options||{}),{},{noSchemaLocation:!0})});var c=(0,Se.T$)(l,a,"1.1.0");return function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,we.p4)(e,(r=t.wfsGetFeature,(0,we.Yy)("gs:Bounds",[(0,Oe.XH)("features",(0,Oe.Nj)("text/xml","http://geoserver/wfs","POST",r))],(0,Oe.mk)((0,Oe.Cs)("bounds","application/json")))),{},n)}((0,V.cs)(n.layer),{wfsGetFeature:c}).switchMap(function(e){var t,r,n;if(ve().parseString(e,{explicitArray:!1},function(e,o){t=o["ows:BoundingBox"],r=t["ows:LowerCorner"].split(" "),n=t["ows:UpperCorner"].split(" ")}),"0.0 0.0"===t["ows:LowerCorner"]&&"-1.0 -1.0"===t["ows:UpperCorner"])return U.Observable.of({loading:!1});var o={minx:parseFloat(r[0]),miny:parseFloat(r[1]),maxx:parseFloat(n[0]),maxy:parseFloat(n[1])},a=i.getHook(je.jY);return a&&a(o,{crs:"EPSG:4326",maxZoom:21}),U.Observable.of({loading:!1})}).startWith({loading:!0}).catch(function(e){return U.Observable.of({error:"error getting bounds from filter",details:e})})}return U.Observable.of({loading:!1})}).combineLatest(e,function(e){var t=e.loading,r=void 0!==t&&t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,Pe.hZ)("loading",r,n)})}))));var Ce=r(356513),Fe=r.n(Ce),Me=r(504631);function ke(e){return ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ke(e)}function Re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(r),!0).forEach(function(t){Le(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Re(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Le(e,t,r){return(t=function(e){var t=function(e){if("object"!=ke(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ke(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ke(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const We=(0,i.compose)((0,i.withPropsOnChange)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mapSync,r=e.dependencies,n=void 0===r?{}:r,o=e.maps,i=void 0===o?[]:o,a=e.selectedMapId,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=arguments.length>2?arguments[2]:void 0;return t!==l.mapSync||!be()(n,l.dependencies)||!be()(i,l.maps)||c!==l.filter||a!==l.selectedMapId},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mapSync,r=e.dependencies,n=void 0===r?{}:r,o=e.filter,i=void 0===o?{}:o,a=e.maps,l=void 0===a?[]:a,c=e.selectedMapId,u=n&&n.layer&&n.layer.name,s=Fe()(l,function(e){return e.mapId===c});if(s){var d=Fe()(null==s?void 0:s.layers,{name:u})||{},f={},p={},v=void 0;return t&&!me()(d)&&(n.quickFilters&&(f=Ne(Ne({},f),(0,he.gq)(i,n.quickFilters,n.options))),n.filter&&(f=Ne(Ne({},f),(0,Se.mA)([f,n.filter]))),!me()(f)&&(0,Se.Io)(f))?(v=(0,Se.Io)(f),p=(0,Pe.Rd)(!1,Ne(Ne({},d),{},{params:(0,Me.w)({params:{CQL_FILTER:v}},d&&d.params&&d.params.CQL_FILTER)}),{name:u},s.layers),{maps:(0,Pe.Rd)(!1,Ne(Ne({},s),{},{layers:p}),{mapId:c},l)}):(p=s.layers.map(function(e){return Ne(Ne({},e),{},{params:Ne(Ne({},e.params),{},{CQL_FILTER:void 0})})}),{maps:(0,Pe.Rd)(!1,Ne(Ne({},s),{},{layers:p}),{mapId:c},l)})}return{maps:l}})),Ge=function(e){return(0,i.withPropsOnChange)(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.mapSync,n=t.dependencies,o=void 0===n?{}:n,a=t.selectedMapId,l=arguments.length>1?arguments[1]:void 0,c=l.mapSync,u=l.dependencies,s=l.selectedMapId;return u&&(0,i.shallowEqual)(o[e],u[e])||r===c||a===s},function(t){var r=t.maps,n=void 0===r?[]:r,o=t.mapSync,i=t.dependencies,a=void 0===i?{}:i,l=t.selectedMapId,c=Fe()(n,{mapId:l})||{},u=a[e]&&o?(0,Pe.hZ)(e,a[e],c):c;return{mapStateSource:"__dependency_system__",maps:n.map(function(e){return e.mapId===u.mapId?u:e}),map:u}})};var _e=r(8117);function ze(e){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ze(e)}var Ue=["data"];function qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function He(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(r),!0).forEach(function(t){Ve(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qe(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ve(e,t,r){return(t=function(e){var t=function(e){if("object"!=ze(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ze(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ze(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ze=r(993456),$e=r(764997),Ke=r(721930),Je=r(992717),Ye=r(962787),Be=(0,$e.A)()((0,Ke.A)((0,Je.A)(Ye.A)));const Xe=function(e){return o().createElement("div",{className:"mapstore-widget-chart"},o().createElement(Ze.A,null,o().createElement(Be,e)))};var Qe=r(154150),et=r(534332),tt=r(192016),rt=r(32485),nt=r.n(rt),ot=r(711030);const it=function(e){var t,r,i=e.options,a=i.dropdownWidgets.length>1,l=i.dropdownWidgets.length-1,c=i.dropdownWidgets.findIndex(function(e){return e.id===i.activeWidget.id}),u=c===l?0:c+1,s=0===c?l:c-1;return o().createElement("div",{className:"widget-selector"},a?o().createElement(ot.A,{className:"previous-widget btn-sm no-border",onPointerDown:function(){return i.setActiveWidget(i.dropdownWidgets[s])}},o().createElement(_e.e6,{glyph:"arrow-left"})):null,o().createElement(tt.Ay,{openOnFocus:!0,clearable:!1,searchable:!1,value:{id:i.activeWidget.id,label:null!==(t=i.activeWidget.title)&&void 0!==t?t:null===(r=i.activeWidget)||void 0===r||null===(r=r.layer)||void 0===r?void 0:r.title},onChange:function(e){return i.setActiveWidget(i.dropdownWidgets.find(function(t){return t.id===e.value}))},options:(0,n.useMemo)(function(){return i.dropdownWidgets.map(function(e){var t,r;return{value:e.id,label:null!==(t=e.title)&&void 0!==t?t:null==e||null===(r=e.layer)||void 0===r?void 0:r.title,active:e.id===i.activeWidget.id}})},[i.dropdownWidgets]),optionComponent:function(e){var t=e.option,r=e.onSelect;return o().createElement("div",{className:nt()({"Select-option":!0,"is-focused":t.active}),onPointerDown:function(e){return r(t,e)}},t.label)}}),a?o().createElement(ot.A,{className:"next-widget btn-sm no-border",onPointerDown:function(){return i.setActiveWidget(i.dropdownWidgets[u])}},o().createElement(_e.e6,{glyph:"arrow-right"})):null)},at=function(e){var t=e.id,r=e.title,n=e.confirmDelete,i=void 0!==n&&n,a=e.className,l=e.isDraggable,c=void 0===l||l,u=e.toggleDeleteConfirm,s=void 0===u?function(){}:u,d=e.onDelete,f=void 0===d?function(){}:d,p=e.icons,v=e.topLeftItems,y=e.topRightItems,m=e.headerStyle,g=void 0===m?{}:m,b=e.options,h=void 0===b?{}:b,O=e.children;return o().createElement("div",{className:"mapstore-widget-card ".concat(h.singleWidget?"single-widget":""),id:t},o().createElement(Qe.A,{className:a,header:o().createElement("div",{style:g,className:"mapstore-widget-info ".concat(c?"draggableHandle":"")},o().createElement("div",{className:"mapstore-widget-header"},o().createElement("span",{className:"widget-icons"},p),v,h.singleWidget?o().createElement(it,{options:h}):o().createElement("span",{className:"widget-title"},r),o().createElement("span",{className:"mapstore-widget-options"},y)))},O),i?o().createElement(et.A,{confirmId:"widgets.widget.menu.delete",titleId:"widgets.widget.menu.confirmDelete",show:i,preventHide:!0,variant:"danger",onCancel:function(){return s(!1)},onConfirm:function(){return f(t)}}):null)};var lt=r(164045),ct=r(551783),ut=r(8571);function st(e){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},st(e)}var dt=["charts","onChange","value","disabled","className","editorData","setSelectedChart","selectedChart","withContainer","featureTypeProperties","width"];function ft(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function pt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ft(Object(r),!0).forEach(function(t){vt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ft(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function vt(e,t,r){return(t=function(e){var t=function(e){if("object"!=st(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=st(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==st(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return mt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var gt=(0,ct.A)(["noResultsText"])(tt.Ay),bt=(0,ct.A)("placeholder")(_e.MJ),ht=(0,lt.A)(ot.A);const Ot=function(e){var t,r=e.charts,i=void 0===r?[]:r,a=e.onChange,l=void 0===a?function(){}:a,c=e.value,u=void 0===c?"":c,s=e.disabled,f=void 0!==s&&s,p=e.className,v=void 0===p?"":p,y=e.editorData,m=void 0===y?{}:y,g=e.setSelectedChart,b=void 0===g?function(){}:g,h=e.selectedChart,O=e.withContainer,w=void 0!==O&&O,S=(e.featureTypeProperties,e.width),P=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,dt),j=yt((0,n.useState)(!1),2),E=j[0],D=j[1],A=yt((0,n.useState)(null==h?void 0:h.name),2),I=A[0],T=A[1],x=function(e){var t,r;if(1===e.length)return null;if(!w&&S<=410)return o().createElement(ht,{tooltipId:"widgets.chartSwitcher.infoOnHide",className:"square-button no-border",key:"info-sign"},o().createElement(_e.e6,{glyph:"info-sign"}));var n=null!=I?I:null==e||null===(t=e.find(function(e){return e.chartId===u}))||void 0===t?void 0:t.name;return o().createElement("div",{className:"chart-fields"},E?o().createElement(bt,{type:"text",placeholder:"widgets.chartSwitcher.placeholder",style:{textOverflow:"ellipsis"},value:n,onChange:function(e){return T(e.target.value)}}):o().createElement(gt,{className:v,disabled:f,noResultsText:"widgets.chartSwitcher.noResults",options:me()(e)?[]:e.map(function(e,t){return{label:(null==e?void 0:e.name)||"[Chart ".concat(t+1,"]"),value:e.chartId}}),onChange:function(e){e.value&&(l("selectedChartId",e.value),T(null))},value:u||(null==e||null===(r=e[0])||void 0===r?void 0:r.chartId),clearable:!1}),w&&o().createElement(ht,{bsStyle:"primary",disabled:E&&me()(n),onClick:function(){E?(I&&l("charts[".concat(null==h?void 0:h.chartId,"].name"),I),D(!1)):D(!0)}},o().createElement(_e.e6,{glyph:E?"ok":"pencil"})))};return w?((0,n.useEffect)(function(){if(!me()(null==m?void 0:m.charts)&&w){var e,t=d()(m,"charts[0]",{});me()(m.selectedChartId)?l("selectedChartId",t.chartId):t=null===(e=m.charts)||void 0===e?void 0:e.find(function(e){return e.chartId===m.selectedChartId}),b(pt(pt({},h),t))}},[m.charts,m.selectedChartId,w,b,l]),o().createElement(o().Fragment,null,(null==m||null===(t=m.charts)||void 0===t?void 0:t.length)>1?o().createElement("div",{className:"chart-switcher"},o().createElement("strong",null,o().createElement(ut.A,{msgId:"widgets.chartSwitcher.selectLabel"})),x(m.charts)):null,w&&P.children?o().Children.map(P.children,function(e,t){return o().cloneElement(e,pt({key:"chart-component-".concat(t)},P))}):null)):x(i)};var wt=["id","title","description","headerStyle","data","charts","selectedChartId","traces","loading","icons","showTable","topRightItems","confirmDelete","dataGrid","onDelete","toggleTableView","toggleDeleteConfirm","updateProperty","selectionActive"];function St(){return St=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},St.apply(null,arguments)}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var jt=(0,$e.A)()((0,Je.A)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?[]:t,n=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,Ue),i=r[0],a=Object.keys(i.reduce(function(e,t){return He(He({},e),t)},{}));return o().createElement("div",{className:"mapstore-widget-table"},o().createElement(_e.XI,{striped:!0},o().createElement("thead",null,o().createElement("tr",null,a.map(function(e,t){return o().createElement("th",null,t+1===a.length&&n.yAxisLabel?n.yAxisLabel:t>0?"".concat(e):e)}))),o().createElement("tbody",null,i.map(function(e){return o().createElement("tr",null,a.map(function(t){return o().createElement("td",null,e[t])}))}))))})),Et=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.showTable,r=e.toggleTableView,n=void 0===r?function(){}:r;return t?o().createElement(_e.e6,{onClick:function(){n()},glyph:"arrow-left pull-left"}):null};var Dt=r(563864),At=r(230454);const It=(0,Dt.A)(function(){return!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).text},function(){return{glyph:"sheet",messageId:"widgets.errors.notext"}},At.A);var Tt=It(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).text;return o().createElement("div",{className:"mapstore-widget-default-content ql-editor",dangerouslySetInnerHTML:{__html:e}})}),xt=r(874295),Ct=r.n(xt),Ft=r(138629),Mt=r(743445),kt=r(913121),Rt=r(193670);function Nt(e){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nt(e)}var Lt=["layers"];function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(r),!0).forEach(function(t){zt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gt(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function zt(e,t,r){return(t=function(e){var t=function(e){if("object"!=Nt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Nt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Nt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ut=(0,i.withHandlers)({onMapViewChanges:function(e){var t=e.onUpdateMapProperty,r=void 0===t?function(){}:t;return function(e){e.layers;var t=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,Lt);return r(t)}}})(Ft.A),qt=(0,i.withHandlers)({updateProperty:function(e){var t=e.onUpdateMapProperty,r=void 0===t?function(){}:t,n=e.map;return function(e,t){var o,i,a=null===(o=n.layers)||void 0===o?void 0:o.map(function(e){var r=null==t?void 0:t.layers.find(function(t){return t.id===e.id});return r?_t(_t({},e),{},{visibility:r.visibility,opacity:r.opacity,expanded:r.expanded,layerFilter:r.layerFilter}):e}),l=null===(i=n.groups)||void 0===i?void 0:i.map(function(e){var r=null==t?void 0:t.groups.find(function(t){return t.id===e.id});return r?_t(_t({},e),{},{visibility:r.visibility,expanded:r.expanded}):e});be()(n.layers,a)&&be()(n.groups,l)||r(_t(_t({},n),{},{layers:a,groups:l}))}}})(Rt.A),Ht=(0,i.withHandlers)({onPropertiesChange:function(e){var t=e.onUpdateMapProperty,r=e.map;return function(e,n){var o;if(e){var i=null===(o=r.layers)||void 0===o?void 0:o.map(function(t){if("background"===t.group){var r=_t(_t({},t),{},{visibility:!1});return t.id===e?_t(_t({},r),{},{visibility:!0},n):r}return t});be()(r.layers,i)||t(_t(_t({},r),{},{layers:i}))}}}})(kt.A),Vt=(0,i.compose)((0,i.withProps)(function(e){return{selectedMapId:e.selectedMapId}}),(0,i.withHandlers)({onUpdateMapProperty:function(e){var t=e.updateProperty,r=void 0===t?function(){}:t,n=e.id,o=e.selectedMapId;return function(e){var t=o?_t(_t({},e),{},{mapId:o}):e;r(n,"maps",t,"merge")}}}))(function(e){var t,r=e.updateProperty,n=void 0===r?function(){}:r,i=e.onUpdateMapProperty,a=void 0===i?function(){}:i,l=e.toggleDeleteConfirm,c=void 0===l?function(){}:l,u=e.id,s=e.title,d=e.map,f=void 0===d?{}:d,p=e.maps,v=void 0===p?[]:p,y=e.selectedMapId,m=e.icons,b=e.hookRegister,h=e.mapStateSource,O=e.topRightItems,w=void 0===O?[]:O,S=e.options,P=void 0===S?{}:S,j=e.confirmDelete,E=void 0!==j&&j,D=e.loading,A=void 0!==D&&D,I=e.dataGrid,T=void 0===I?{}:I,x=e.onDelete,C=void 0===x?function(){}:x,F=e.headerStyle,M=e.env,k=e.selectionActive,R=e.currentZoomLvl,N=e.scales,L=e.language,W=e.currentLocale,G=f.size,_=void 0===G?{}:G,z=_.height,U=_.width,q=f.mapInfoControl,H=(f.layers||[]).filter(function(e){return"background"===e.group}),Z=z>400&&U>400&&q;return o().createElement(at,{className:"map-widget-view",id:"widget-text-".concat(u),title:s,confirmDelete:E,onDelete:C,toggleDeleteConfirm:c,headerStyle:F,icons:m,topRightItems:[o().createElement(Mt.A,{key:"map-switcher",className:"map-switcher",maps:v,onChange:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.apply(void 0,[u].concat(t))},value:y,disabled:k})].concat((t=w,function(e){if(Array.isArray(e))return Wt(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return Wt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wt(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),isDraggable:T.isDraggable,options:P},o().createElement(Qe.A,{footer:A?o().createElement("div",{className:"widget-footer"},o().createElement("span",{style:{float:"right"}},o().createElement(g.A,null))):null},o().createElement("div",{className:"map-widget-view-content"},o().createElement(Ut,{tools:Z?["popup"]:[],onUpdateMapProperty:a,id:u,map:_t({},Ct()(f,"mapStateSource")),mapStateSource:h,hookRegister:b,layers:(0,V.UA)(f.layers,f.groups),options:{style:{margin:"0 10px 10px 10px",height:"calc(100% - 10px)"}},env:M}),Z&&o().createElement(o().Fragment,null,f.showBackgroundSelector&&(null==H?void 0:H.length)>0&&o().createElement(Ht,{id:u,map:f,onUpdateMapProperty:a,backgrounds:H,projection:f.projection,style:{position:"absolute",bottom:8,left:8,zIndex:100,marginBottom:0},alwaysVisible:!1,canEdit:!1,allowDeletion:!1,backgroundToolbarItems:[]}),f.showLegend&&o().createElement("div",{className:"legend-in-mapview"},o().createElement(qt,{id:u,map:f,onUpdateMapProperty:a,currentZoomLvl:R,scales:N,language:L,currentLocale:W}))))))});const Zt=Vt;var $t=r(742466);function Kt(e){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kt(e)}function Jt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Yt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(r),!0).forEach(function(t){Bt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jt(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Bt(e,t,r){return(t=function(e){var t=function(e){if("object"!=Kt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Kt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Xt=(0,i.compose)((0,i.mapPropsStream)(function(e){return e.combineLatest(e.pluck("quickFilterStream$").distinctUntilChanged().switchMap(function(e){return e}).startWith(void 0),function(e,t){var r,n=t&&e.options&&Fe()((0,Z.MI)(null===(r=e.options)||void 0===r?void 0:r.propertyName),function(t){return t===e.attributeName})&&t[e.attributeName]||{},o=n&&(n.rawValue||n.value);return Yt(Yt({},e),{},{value:o})})})),Qt=(0,i.compose)((0,i.mapPropsStream)(function(e){return e.map(function(t){return Yt(Yt({},t),{},{quickFilterStream$:e.pluck("quickFilters").distinctUntilChanged()})})})),er=(0,i.compose)(Qt,(0,i.withPropsOnChange)(["layer","describeFeatureType","options"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=void 0===t?{}:t,n=e.describeFeatureType,o=e.options,a=e.quickFilterStream$,l=(null==r?void 0:r.fields)||[];return n?{filterRenderers:(0,Z.CG)(n).reduce(function(e,t){var r=t.localType,n=t.name,c=function(e){var t,r,n=e.field,o=void 0===n?{}:n,a=e.options,l=e.localType,c=e.attributeName,u=e.quickFilterStream$;return(0,i.compose)((0,i.withProps)({quickFilterStream$:u,attributeName:c,options:a}),Xt)((0,$t.q5)({name:null===(t=o.filterRenderer)||void 0===t?void 0:t.name,type:l,options:null===(r=o.filterRenderer)||void 0===r?void 0:r.options}))}({field:Fe()(l,{name:n}),options:o,localType:r,attributeName:n,quickFilterStream$:a});return Yt(Yt({},e),{},Bt({},n,c))},{})}:{}})),tr=r(347018);function rr(e){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rr(e)}function nr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function or(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nr(Object(r),!0).forEach(function(t){ir(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ir(e,t,r){return(t=function(e){var t=function(e){if("object"!=rr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=rr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==rr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ar=(0,r(432060).A)()((0,n.lazy)(function(){return Promise.all([r.e(1206),r.e(8645),r.e(2719)]).then(r.bind(r,32719))})),lr=(0,Ke.A)((0,$e.A)(function(e){return!e.describeFeatureType})(ar)),cr=["rowHeight","headerRowHeight","headerFiltersHeight"].reduce(function(e,t){return or(or({},e),{},ir({},t,28))},"");const ur=er(function(e){var t=e.id,r=e.title,n=e.loading,i=e.confirmDelete,a=void 0!==i&&i,l=e.enableColumnFilters,c=void 0!==l&&l,u=e.headerStyle,s=e.icons,d=e.topRightItems,f=e.toggleDeleteConfirm,p=void 0===f?function(){}:f,v=e.onDelete,y=void 0===v?function(){}:v,m=e.gridEvents,b=void 0===m?function(){}:m,h=e.pageEvents,O=void 0===h?{moreFeatures:function(){}}:h,w=e.describeFeatureType,S=e.filterRenderers,P=e.columnSettings,j=e.features,E=e.layer,D=e.size,A=e.pages,I=e.error,T=e.pagination,x=void 0===T?{}:T,C=e.dataGrid,F=void 0===C?{}:C,M=e.virtualScroll,k=void 0===M||M,R=e.gridOpts,N=void 0===R?cr:R,L=e.options,W=void 0===L?{}:L,G=e.dateFormats,_=e.gridTools;return o().createElement(at,{id:"widget-chart-".concat(t),title:r,headerStyle:u,icons:s,isDraggable:F.isDraggable,confirmDelete:a,onDelete:y,toggleDeleteConfirm:p,topRightItems:d,options:W},o().createElement(Qe.A,{footer:x.totalFeatures?o().createElement("div",{className:"widget-footer"},n?o().createElement("span",{style:{float:"right"}},o().createElement(g.A,null)):null,void 0===I&&o().createElement("span",{className:"result-info"},o().createElement(ut.A,{msgId:"featuregrid.resultInfoVirtual",msgParams:{total:x.totalFeatures}}))):null},o().createElement(lr,{emptyRowsView:function(){return o().createElement(tr.A,{loading:n},o().createElement(At.A,{messageId:"featuregrid.noFeaturesAvailable",glyph:"features-grid"}))},gridEvents:b,sortable:!0,defaultSize:!1,columnSettings:P,pageEvents:O,virtualScroll:k,enableColumnFilters:c,filterRenderers:S,fields:null==E?void 0:E.fields,features:j,pages:A,error:I,size:D,rowKey:"id",describeFeatureType:w,pagination:x,gridOpts:N,options:W,tools:_,dateFormats:G})))});var sr=r(577103),dr=["id","title","description","data","series","loading","showTable","confirmDelete","headerStyle","icons","topRightItems","dataGrid","toggleTableView","toggleDeleteConfirm","onDelete"];function fr(){return fr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fr.apply(null,arguments)}var pr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.showTable,r=e.toggleTableView,n=void 0===r?function(){}:r;return t?o().createElement(_e.e6,{onClick:function(){n()},glyph:"arrow-left pull-left"}):null},vr=r(537336),yr=["toggleDeleteConfirm","id","title","icons","headerStyle","confirmDelete","topRightItems","dataGrid","onDelete"],mr=(0,vr.A)()(Rt.A),gr=r(605556),br=r.n(gr),hr=r(801081),Or=r(4222),wr=r(896067),Sr=r(785072),Pr=r.n(Sr),jr=r(96891);Pr()(jr.A,{insert:"head",singleton:!1}),jr.A.locals;var Er=r(737704);function Dr(e){return Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dr(e)}function Ar(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ir(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ar(Object(r),!0).forEach(function(t){Tr(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ar(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Tr(e,t,r){return(t=function(e){var t=function(e){if("object"!=Dr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Dr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Dr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var xr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.title,n=e.filters,i=void 0===n?[]:n,a=e.interactions,l=void 0===a?[]:a,c=e.activeTargets,u=void 0===c?{}:c,s=e.targetsWithDisabledFilter,d=void 0===s?{}:s,f=e.applyStyleOutOfSyncForWidget,p=void 0===f?{}:f,v=e.selections,y=void 0===v?{}:v,m=e.updateProperty,g=void 0===m?function(){}:m,b=e.toggleDeleteConfirm,h=void 0===b?function(){}:b,O=e.icons,w=e.topLeftItems,S=e.topRightItems,P=e.headerStyle,j=e.options,E=void 0===j?{}:j,D=e.dataGrid,A=void 0===D?{}:D,I=e.confirmDelete,T=void 0!==I&&I,x=e.onDelete,C=void 0===x?function(){}:x,F=e.dispatch,M=e.target,k=void 0===M?"floating":M;return o().createElement(at,{id:"widget-filter-".concat(t),title:r,confirmDelete:T,onDelete:C,toggleDeleteConfirm:h,headerStyle:P,isDraggable:A.isDraggable,icons:O,topLeftItems:w,topRightItems:S,options:E},o().createElement("div",{className:"mapstore-widget-filter-content",style:{padding:"15px"}},0===i.length?o().createElement("div",{className:"ms-filter-widget-empty",style:{textAlign:"center",color:"#999",padding:"20px"}},"No filters configured"):i.map(function(e,r){var n,a=l.filter(function(t){return t.source.nodePath.includes(e.id)});return o().createElement("div",{key:e.id,className:"ms-filter-widget-item",style:{marginBottom:r<i.length-1?"20px":"0"}},o().createElement(Or.A,{interactions:a,activeTargets:u,targetsWithDisabledFilter:d,applyStyleOutOfSync:p[e.id]||{},filterData:e,selections:y[e.id]||[],onSelectionChange:(n=e.id,function(e){var r=Ir(Ir({},y),{},Tr({},n,e));g(t,"selections",r),F&&setTimeout(function(){F((0,wr.K)(t,k,n))},0)})}))})))};xr.propTypes={id:br().string.isRequired,title:br().string,filters:br().arrayOf(br().shape({id:br().string.isRequired,label:br().string,layout:br().shape({variant:br().string,icon:br().string,selectionMode:br().string,direction:br().string,maxHeight:br().oneOfType([br().number,br().string])}),data:br().object,items:br().array})),selections:br().object,updateProperty:br().func,toggleDeleteConfirm:br().func,icons:br().node,topLeftItems:br().node,topRightItems:br().node,headerStyle:br().object,options:br().object,dataGrid:br().object,confirmDelete:br().bool,onDelete:br().func,dispatch:br().func,target:br().string};const Cr=(0,f.connect)((0,hr.j8)({activeTargets:Er.Tw,targetsWithDisabledFilter:Er.Gq,applyStyleOutOfSyncForWidget:function(e,t){return(0,Er.TL)(e,null==t?void 0:t.id)}}))(xr);var Fr=r(102179),Mr=(0,i.compose)(a.p,fe.A,se.A,de.A,k.Ay,a.A,Fr.A)(function(e){var t,r,n=e.id,i=e.title,a=e.description,l=e.headerStyle,c=e.data,u=void 0===c?[]:c,s=e.charts,d=void 0===s?[]:s,f=e.selectedChartId,p=e.traces,v=void 0===p?[]:p,y=e.loading,m=e.icons,g=e.showTable,b=e.topRightItems,h=e.confirmDelete,O=void 0!==h&&h,w=e.dataGrid,S=void 0===w?{}:w,P=e.onDelete,j=void 0===P?function(){}:P,E=e.toggleTableView,D=void 0===E?function(){}:E,A=e.toggleDeleteConfirm,I=void 0===A?function(){}:A,T=e.updateProperty,x=void 0===T?function(){}:T,C=e.selectionActive,F=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,wt),M="widget-chart-".concat(n),k=null===(t=document.getElementById(M))||void 0===t?void 0:t.clientWidth;return o().createElement(at,{className:"chart-widget-view",id:M,headerStyle:l,isDraggable:S.isDraggable,title:i,icons:m,topLeftItems:Et({loading:y,title:i,description:a,showTable:g,toggleTableView:D}),confirmDelete:O,onDelete:j,toggleDeleteConfirm:I,topRightItems:[o().createElement(Ot,{className:"chart-switcher",charts:d,onChange:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return x.apply(void 0,[n].concat(t))},value:f,disabled:C,width:k})].concat((r=b||[],function(e){if(Array.isArray(e))return Pt(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return Pt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pt(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),options:null==F?void 0:F.options},g?o().createElement(jt,St({data:u},F)):o().createElement(Xe,St({id:n,isAnimationActive:!y,loading:y,data:u,traces:v,iconFit:!0},F)))}),kr=(0,i.compose)(C)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.toggleDeleteConfirm,r=void 0===t?function(){}:t,n=e.icons,i=e.topLeftItems,a=e.id,l=e.title,c=e.text,u=e.headerStyle,s=e.topRightItems,d=e.options,f=void 0===d?{}:d,p=e.dataGrid,v=void 0===p?{}:p,y=e.confirmDelete,m=void 0!==y&&y,g=e.onDelete,b=void 0===g?function(){}:g;return o().createElement(at,{id:"widget-text-".concat(a),title:l,confirmDelete:m,onDelete:b,toggleDeleteConfirm:r,headerStyle:u,isDraggable:v.isDraggable,icons:n,topLeftItems:i,topRightItems:s,options:f},o().createElement(Tt,{text:c}))}),Rr=(0,i.compose)(fe.A,We,Ge("center"),Ge("zoom"),xe,F)(Zt),Nr=(0,i.compose)(fe.A,de.A,se.A,ue,T)(ur),Lr=(0,i.compose)(fe.A,se.A,de.A,R.A,u)(function(e){var t=e.id,r=e.title,n=e.description,i=e.data,a=void 0===i?[]:i,l=e.series,c=void 0===l?[]:l,u=e.loading,s=e.showTable,d=e.confirmDelete,f=void 0!==d&&d,p=e.headerStyle,v=e.icons,y=e.topRightItems,m=e.dataGrid,g=void 0===m?{}:m,b=e.toggleTableView,h=void 0===b?function(){}:b,O=e.toggleDeleteConfirm,w=void 0===O?function(){}:O,S=e.onDelete,P=void 0===S?function(){}:S,j=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,dr);return o().createElement(at,{className:"counter-widget",id:"widget-chart-".concat(t),title:r,isDraggable:g.isDraggable,icons:v,topLeftItems:pr({loading:u,title:r,description:n,showTable:s,toggleTableView:h}),confirmDelete:f,onDelete:P,toggleDeleteConfirm:w,headerStyle:p,topRightItems:y,options:null==j?void 0:j.options},o().createElement(sr.A,fr({id:t,isAnimationActive:!u,loading:u,data:a,series:c,iconFit:!0},j)))}),Wr=(0,i.compose)(fe.A,x.A)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.toggleDeleteConfirm,r=void 0===t?function(){}:t,n=e.id,i=e.title,a=e.icons,l=e.headerStyle,c=e.confirmDelete,u=void 0!==c&&c,s=e.topRightItems,d=e.dataGrid,f=void 0===d?{}:d,p=e.onDelete,v=void 0===p?function(){}:p,y=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,yr);return o().createElement(at,{id:"widget-text-".concat(n),title:i,confirmDelete:u,onDelete:v,toggleDeleteConfirm:r,headerStyle:l,icons:a,topRightItems:s,isDraggable:f.isDraggable,options:null==y?void 0:y.options},o().createElement(mr,y))}),Gr=(0,i.compose)(M)(Cr),_r=["items","dependencies","toggleCollapse","exportCSV","onDelete","onEdit"];function zr(){return zr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zr.apply(null,arguments)}var Ur=function(e){var t;return null==e||null===(t=e.widgetOpts)||void 0===t?void 0:t[e.widgetType]};const qr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.items,r=e.dependencies,n=e.toggleCollapse,i=void 0===n?function(){}:n,a=e.exportCSV,l=void 0===a?function(){}:a,c=e.onDelete,u=void 0===c?function(){}:c,s=e.onEdit,d=void 0===s?function(){}:s,f=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,_r);return"text"===f.widgetType?o().createElement(kr,zr({},f,{toggleCollapse:i,onDelete:u,onEdit:d})):"table"===f.widgetType?o().createElement(Nr,zr({},f,Ur(f),{toggleCollapse:i,exportCSV:l,dependencies:r,onDelete:u,onEdit:d,items:t})):"counter"===f.widgetType?o().createElement(Lr,zr({},f,Ur(f),{toggleCollapse:i,dependencies:r,onDelete:u,onEdit:d})):"map"===f.widgetType?o().createElement(Rr,zr({},f,Ur(f),{toggleCollapse:i,dependencies:r,onDelete:u,onEdit:d,items:t})):"legend"===f.widgetType?o().createElement(Wr,zr({},f,Ur(f),{toggleCollapse:i,dependencies:r,onDelete:u,onEdit:d})):"filter"===f.widgetType?o().createElement(Gr,zr({},f,Ur(f),{interactions:f.interactions,toggleCollapse:i,dependencies:r,onDelete:u,onEdit:d})):o().createElement(Mr,zr({},f,Ur(f),{toggleCollapse:i,exportCSV:l,dependencies:r,onDelete:u,onEdit:d}))}},639996(e,t,r){r.d(t,{A:()=>x});var n=r(273517),o=r.n(n),i=r(916589),a=r(356513),l=r.n(a),c=r(149576),u=r.n(c),s=r(566816),d=r(978632),f=r.n(d),p=r(962028),v=r.n(p);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach(function(t){b(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function b(e,t,r){return(t=function(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h=function(e){return f()(v()(e,function(e){return e.color}),"color")};const O=(0,i.withProps)(function(e){var t=e.groups,r=e.showGroupColor,n=e.headerStyle,o=void 0===n?{borderTop:"3px solid rgba(0,0,0,0)",transition:"border-color .5s ease-out"}:n;return{headerStyle:r&&t&&h(t)?g(g({},o),{},{borderTop:"3px solid ".concat(h(t))}):o}});function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}r(850890);var S=["id","style","className","toolsOptions","rowHeight","breakpoints","cols","widgetOpts","widgets","layouts","dependencies","compactType","compactMode","useDefaultWidthProvider","measureBeforeMount","width","showGroupColor","groups","canEdit","getWidgetClass","onWidgetClick","updateWidgetProperty","deleteWidget","toggleCollapse","toggleMaximize","editWidget","onLayoutChange","language","currentLocale","env"];function P(){return P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},P.apply(null,arguments)}function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach(function(t){D(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function D(e,t,r){return(t=function(e){var t=function(e){if("object"!=w(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var A=(0,i.branch)(function(e){var t=e.useDefaultWidthProvider;return void 0===t||t},s.WidthProvider)(s.Responsive),I=O(r(637129).A),T=function(){var e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(function(t){return l()(t.widgets,function(t){return t===e.id})})};const x=(0,i.pure)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.style,n=e.className,i=void 0===n?"":n,a=e.toolsOptions,c=void 0===a?{}:a,s=e.rowHeight,d=void 0===s?150:s,f=e.breakpoints,p=void 0===f?{lg:1200,md:996,sm:768,xs:480,xxs:0}:f,v=e.cols,y=void 0===v?{lg:6,md:6,sm:4,xs:2,xxs:1}:v,m=e.widgetOpts,g=void 0===m?{}:m,b=e.widgets,h=void 0===b?[]:b,O=e.layouts,w=e.dependencies,j=e.compactType,D=void 0===j?null:j,x=e.compactMode,C=e.useDefaultWidthProvider,F=void 0===C||C,M=e.measureBeforeMount,k=e.width,R=e.showGroupColor,N=e.groups,L=void 0===N?[]:N,W=e.canEdit,G=void 0===W||W,_=e.getWidgetClass,z=void 0===_?function(){}:_,U=e.onWidgetClick,q=void 0===U?function(){}:U,H=e.updateWidgetProperty,V=void 0===H?function(){}:H,Z=e.deleteWidget,$=void 0===Z?function(){}:Z,K=e.toggleCollapse,J=void 0===K?function(){}:K,Y=e.toggleMaximize,B=void 0===Y?function(){}:Y,X=e.editWidget,Q=void 0===X?function(){}:X,ee=e.onLayoutChange,te=void 0===ee?function(){}:ee,re=e.language,ne=e.currentLocale,oe=e.env,ie=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,S),ae=h.filter(function(e){var t=e.mapSync,r=e.dependenciesMap;return t&&r}).map(function(e){return e.dependenciesMap}),le=function(e){return"table"===e.widgetType&&ae.filter(function(t){return Object.keys(t).filter(function(r){return t[r]&&-1!==t[r].indexOf(e.id)}).length>0}).length>0};return o().createElement(A,{key:t||"widgets-view",useDefaultWidthProvider:F,measureBeforeMount:M,width:F?void 0:k,isResizable:G,isDraggable:G,draggableHandle:".draggableHandle",onLayoutChange:te,preventCollision:!0,style:r,className:"widget-container ".concat(i," ").concat(G?"":"no-drag"),rowHeight:d,autoSize:!0,compactType:D,compactMode:x,breakpoints:p,cols:y,layouts:O?JSON.parse(JSON.stringify(u()(O,function(e){return e.map(function(e){var t=l()(h,{id:e.i});return t?E(E({},e),{},{isResizable:t.dataGrid&&t.dataGrid.isResizable,isDraggable:t.dataGrid&&t.dataGrid.isDraggable,static:t.dataGrid&&t.dataGrid.static}):e})}))):void 0},h.map(function(e){return o().createElement("div",{key:e.id,"data-grid":e.dataGrid,onClick:function(){return q(e)},className:z(e)},o().createElement(I,P({"data-grid":e.dataGrid},ie,e,{widgets:h,widgetOpts:g,quickFilters:le(e)?e.quickFilters:void 0,toolsOptions:c,groups:T(L,e),showGroupColor:R,dependencies:w,enableColumnFilters:le(e),canEdit:G,updateProperty:function(){return V.apply(void 0,arguments)},toggleCollapse:function(){return J(e)},toggleMaximize:function(){return B(e)},onDelete:function(){return $(e)},onEdit:function(){return Q(e)},language:re,currentLocale:ne,env:oe})))}))})},697950(e,t,r){r.d(t,{Qy:()=>u,Ty:()=>s});var n=r(273517),o=r.n(n),i=r(368180),a=r(916589),l=r(109054);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c.apply(null,arguments)}var u=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).overrideWidthProvider;return(0,a.compose)((0,a.defaultProps)({useDefaultWidthProvider:!e}),function(e){return function(t){return o().createElement(i.A,{handleWidth:!0},function(){var r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).width;return o().createElement(e,c({width:r},t))})}})},s=function(e){return(0,a.compose)((0,a.withStateHandlers)(function(){return{}},{onResize:function(){return function(e){return{height:e.height}}}}),(0,l.A)(e))}},699518(e,t,r){r.d(t,{Ay:()=>F});var n=r(45388),o=r.n(n),i=r(978632),a=r.n(i),l=r(770613),c=r(71665),u=r(307679),s=r(904059),d=r(102685),f=(r(541033),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t||0===t.length)return null;var r=e.data||{},n=r.dataSource,o=r.valuesFrom,i=r.filterComposition,a=void 0===i?"OR":i,l=null;return"userDefined"===n?l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OR";if(!e||!e.data||!e.data.userDefinedItems||0===t.length)return null;var n=e.data.userDefinedItems,o=[];if(t.forEach(function(e){var t=n.find(function(t){return t.id===e});if(t&&t.filter){var r=(0,d.Io)(t.filter);r&&"INCLUDE"!==r&&o.push(r)}}),0===o.length)return null;var i=1===o.length?o[0]:o.map(function(e){return"(".concat(e,")")}).join(" ".concat(r.toUpperCase()," "));return{format:"cql",version:"1.0.0",body:i,id:"".concat(i),filterId:e.id}}(e,t,a):"features"!==n||"grouped"!==o&&"single"!==o||(l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OR";if(!e||!e.data||0===t.length)return null;var n=e.data.valueAttribute;if(!n)return null;var o=[];if(t.forEach(function(e){var t;(t=(0,d.sm)(n,"=",e))&&o.push(t)}),0===o.length)return null;var i=1===o.length?o[0]:o.map(function(e){return"(".concat(e,")")}).join(" ".concat(r.toUpperCase()," "));return{format:"cql",version:"1.0.0",body:i,id:"[".concat(i,"]"),filterId:e.id}}(e,t,a)),l}),p=r(608277),v=r(896067);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function m(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach(function(t){O(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function O(e,t,r){return(t=function(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e){if(!e)return null;var t=e.match(/(?:^|\.)widgets\[([^\]]+)\]/);return t?t[1]:null}function S(e){return e.layerFilter?e.layerFilter=h(h(h({},d.Fe),e.layerFilter),{},{filters:Array.isArray(e.layerFilter.filters)?e.layerFilter.filters:[]}):e.layerFilter=h(h({},d.Fe),{},{filters:[]}),e}function P(e){return Array.isArray(e.interactionFilters)||(e.interactionFilters=[]),e}function j(e,t){var r=e.findIndex(function(e){return e.id===t.id});return r>=0?e.map(function(e,n){return n===r?t:e}):[].concat(m(e),[t])}function E(e,t,r){return e.filter(function(e){return!(null==t||!t.appliedData)||e.id!==r})}function D(e,t){var r=h({},e.appliedData);return{id:e.id,format:"logic",version:"1.0.0",logic:"OR",filters:[r],appliedFromWidget:t}}function A(e,t){return e.filter(function(e){return!(e.appliedFromWidget===t)})}function I(e,t){var r=!1,n=h({},e);if(e.interactionFilters&&Array.isArray(e.interactionFilters)){var o=A(e.interactionFilters,t);o.length!==e.interactionFilters.length&&(r=!0,n.interactionFilters=o)}if(e.layer&&e.layer.layerFilter&&e.layer.layerFilter.filters&&Array.isArray(e.layer.layerFilter.filters)){var i=A(e.layer.layerFilter.filters,t);i.length!==e.layer.layerFilter.filters.length&&(r=!0,n.layer=h(h({},e.layer),{},{layerFilter:h(h({},e.layer.layerFilter),{},{filters:i})}))}return{updatedContainer:n,needsUpdate:r}}function T(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"floating";if(!e)return[];var n=function(e,t){var r=[];return((0,u.Kv)(t)||[]).forEach(function(t){if(t.layerFilter&&t.layerFilter.filters&&Array.isArray(t.layerFilter.filters)){var n=A(t.layerFilter.filters,e);n.length!==t.layerFilter.filters.length&&r.push((0,s.ju)(t.id,{layerFilter:h(h({},t.layerFilter),{},{filters:n})}))}}),r}(e,t),o=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"floating",n=[];return(a()(t,"widgets.containers[".concat(r,"].widgets"))||[]).forEach(function(t){var r=null;switch(t.widgetType){case"chart":r=function(e,t){if(!e.charts||!Array.isArray(e.charts))return null;var r=!1,n=e.charts.map(function(e){if(!e.traces||!Array.isArray(e.traces))return e;var n=e.traces.map(function(e){var n=I(e,t),o=n.updatedContainer;return n.needsUpdate?(r=!0,o):e});return h(h({},e),{},{traces:n})});return r?h(h({},e),{},{charts:n}):null}(t,e),r&&n.push((0,c.Dr)(t.id,"charts",r.charts));break;case"table":case"counter":r=function(e,t){var r=I(e,t),n=r.updatedContainer;return r.needsUpdate?n:null}(t,e),r&&n.push((0,c.Dr)(t.id,"interactionFilters",r.interactionFilters));break;case"map":r=function(e,t){if(!e.maps||!Array.isArray(e.maps))return null;var r=!1,n=e.maps.map(function(e){if(!e.layers||!Array.isArray(e.layers))return e;var n=e.layers.map(function(e){if(e.layerFilter&&e.layerFilter.filters){var n=A(e.layerFilter.filters,t);if(n.length!==e.layerFilter.filters.length)return r=!0,h(h({},e),{},{layerFilter:h(h({},e.layerFilter),{},{filters:n})})}return e});return h(h({},e),{},{layers:n})});return r?h(h({},e),{},{maps:n}):null}(t,e),r&&n.push((0,c.Dr)(t.id,"maps",r.maps))}}),n}(e,t,r);return[].concat(m(n),m(o))}function x(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"floating",n=e.target;if(!n||!n.nodePath)return null;if((0,l.P7)(n.nodePath))return function(e,t,r){var n;if(!t||!t.nodePath)return null;var o=(0,l.HX)(t.nodePath);if(!o)return{type:"TARGET_OPERATION_SKIPPED",reason:"layer_id_not_found"};var i=(0,u.pO)(r,o);if(!i)return{type:"TARGET_OPERATION_SKIPPED",reason:"layer_not_found"};var a=D(e,w(null==e||null===(n=e.source)||void 0===n?void 0:n.nodePath)),c=JSON.parse(JSON.stringify(i));S(c);var d=E(j(c.layerFilter.filters||[],a),e,a.id);return c.layerFilter.filters=d,(0,s.ju)(c.id,{layerFilter:c.layerFilter})}(e,n,t);var i=w(n.nodePath);if(!i)return o().Observable.empty();var d=(a()(t,"widgets.containers[".concat(r,"].widgets"))||[]).find(function(e){return e.id===i});return d?function(e,t,r,n){if(!e)return null;switch(e.widgetType){case"chart":var o=(0,l.Vy)(e,r.nodePath);return o?function(e,t,r,n){var o,i,a=JSON.parse(JSON.stringify(null!==(o=null==e?void 0:e.charts)&&void 0!==o?o:[])),l=w(null==t||null===(i=t.source)||void 0===i?void 0:i.nodePath),u=D(t,l);return a.forEach(function(e){e.traces=(e.traces||[]).map(function(e){if(e.id===r.id){P(e);var n=E(j(e.interactionFilters||[],u),t,u.id);return h(h({},e),{},{interactionFilters:n})}return e})}),(0,c.Dr)(n,"charts",a)}(e,t,o,n):null;case"table":case"counter":return function(e,t,r){var n,o=JSON.parse(JSON.stringify(e)),i=D(t,w(null==t||null===(n=t.source)||void 0===n?void 0:n.nodePath));P(o);var a=E(j(o.interactionFilters||[],i),t,i.id);return o.interactionFilters=a,(0,c.Dr)(r,"interactionFilters",o.interactionFilters)}(e,t,n);case"map":return function(e,t,r){var n;if(!t||!t.target||!t.target.nodePath)return null;var o=t.target.nodePath,i=JSON.parse(JSON.stringify(e)),a=D(t,w(null==t||null===(n=t.source)||void 0===n?void 0:n.nodePath)),l=o.match(/\.maps\[([^\]]+)\]\.layers\[([^\]]+)\]$/);if(!l)return null;var u=l[1],s=l[2];if(!i.maps||!Array.isArray(i.maps))return null;var d=i.maps.find(function(e){return e.mapId===u});if(!d)return null;if(!d.layers||!Array.isArray(d.layers))return null;var f=d.layers.find(function(e){return e.id===s});if(!f)return null;S(f);var p=E(j(f.layerFilter.filters||[],a),t,a.id);return f.layerFilter.filters=p,(0,c.Dr)(r,"maps",i.maps)}(e,t,n);default:return null}}(d,e,n,i):o().Observable.empty()}var C=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"floating",n=e.target;if(!n||!n.nodePath)return null;if((0,l.P7)(e.target.nodePath))return function(e,t,r){var n=(0,l.HX)(t.nodePath);if(!n)return o().Observable.empty();var i=(0,u.pO)(r,n);return i?(0,s.ju)(i.id,{style:e.appliedData}):o().Observable.empty()}(e,n,t);var i=w(n.nodePath);if(!i)return o().Observable.empty();var d=(a()(t,"widgets.containers[".concat(r,"].widgets"))||[]).find(function(e){return e.id===i});return d&&"map"===d.widgetType?function(e,t,r){if(!t||!t.target||!t.target.nodePath)return null;var n=t.target.nodePath,o=JSON.parse(JSON.stringify(e)),i=n.match(/\.maps\[([^\]]+)\]\.layers\[([^\]]+)\]$/);if(!i)return null;var a=i[1],l=i[2];if(!o.maps||!Array.isArray(o.maps))return null;var u=o.maps.find(function(e){return e.mapId===a});if(!u)return null;if(!u.layers||!Array.isArray(u.layers))return null;var s=u.layers.find(function(e){return e.id===l});return s?(s.style=t.appliedData,(0,c.Dr)(r,"maps",o.maps)):null}(d,e,i):o().Observable.empty()};const F={applyFilterWidgetInteractionsEpic:function(e,t){return e.ofType(v.L).switchMap(function(e){var r=e.widgetId,n=e.target,i=e.filterId,c=t.getState(),u=(a()(c,"widgets.containers[".concat(n,"].widgets"))||[]).find(function(e){return e.id===r});if(!u)return o().Observable.empty();if("filter"!==u.widgetType)return o().Observable.empty();var s=(u.interactions||[]).filter(function(e){return!0===e.plugged&&e.source.nodePath.includes(i)&&!!e.targetType});if(0===s.length)return o().Observable.empty();var v=u.selections||{},y=u.filters||[];return o().Observable.from(s).switchMap(function(e){var r,a,c,u=t.getState(),s=y.find(function(e){return e.id===i});if(e.targetType===l.oG.APPLY_STYLE){var m,g=v[i][0],b=null==s||null===(m=s.data)||void 0===m||null===(m=m.userDefinedItems)||void 0===m||null===(m=m.find(function(e){return e.id===g}))||void 0===m||null===(m=m.style)||void 0===m?void 0:m.name,O=h(h({},e),{},{appliedData:b}),w=C(O,u,n);return w?o().Observable.of(w):o().Observable.empty()}var S=v[i],P=s?f(s,S):null,j=null!==(r=null==s||null===(a=s.data)||void 0===a?void 0:a.noSelectionMode)&&void 0!==r?r:p.fV.NO_FILTER,E=null==s||null===(c=s.data)||void 0===c?void 0:c.defaultFilter,D=null;S&&0!==S.length||!s||(j===p.fV.EXCLUDE?D=function(e){return e?{format:"cql",version:"1.0.0",body:"EXCLUDE",id:"EXCLUDE",filterId:e}:null}(s.id):j===p.fV.CUSTOM&&E&&(D=function(e,t){if(!e||!t)return null;var r=(0,d.Io)(t);return r&&"INCLUDE"!==r?{format:"cql",version:"1.0.0",body:r,id:"".concat(r),filterId:e}:null}(s.id,s.data.defaultFilter)));var A=x(h(h({},e),{},{appliedData:P||D||null}),u,n);return A?o().Observable.of(A):o().Observable.empty()})})},cleanupAndReapplyFilterWidgetInteractionsEpic:function(e,t){return e.ofType(c.SJ,c.i,c.q6).mergeMap(function(e){var r,n=t.getState(),i=null,l=null,u="floating";if(e.type===c.SJ){var s;if(l=null===(s=i=e.widget)||void 0===s?void 0:s.id,u=e.target||"floating",!l)return o().Observable.empty();var d=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"floating";if(!e)return[];var n=[];return(a()(t,"widgets.containers[".concat(r,"].widgets"))||[]).filter(function(e){return"filter"===e.widgetType}).forEach(function(t){var o=t.interactions||[],i=o.filter(function(t){var r,n=(null==t||null===(r=t.target)||void 0===r?void 0:r.nodePath)||"";return!new RegExp("widgets\\[".concat(e,"\\]")).test(n)});i.length!==o.length&&n.push((0,c.Dr)(t.id,"interactions",i,"replace",r))}),n}(l,n,u);if(i&&"filter"===i.widgetType){var f=T(l,n,u),p=[].concat(m(d),m(f));return p.length>0?o().Observable.from(p):o().Observable.empty()}return d.length>0?o().Observable.from(d):o().Observable.empty()}if(e.type===c.i)i=e.widget,l=e.id||(null===(r=i)||void 0===r?void 0:r.id),u=e.target||"floating";else if(e.type===c.q6){var y;l=null===(y=i=e.widget)||void 0===y?void 0:y.id,u=e.target||"floating"}if(!i||"filter"!==i.widgetType||!l)return o().Observable.empty();var g=T(l,n,u);return(g.length>0?o().Observable.from(g):o().Observable.empty()).concat(o().Observable.defer(function(){var e=t.getState(),r=(a()(e,"widgets.containers[".concat(u,"].widgets"))||[]).filter(function(e){return"filter"===e.widgetType});return 0===r.length?o().Observable.empty():o().Observable.from(r).switchMap(function(e){var t=(e.filters||[]).map(function(e){return e.id});return o().Observable.from(t).switchMap(function(t){return o().Observable.of((0,v.K)(e.id,u,t))})})}))})}}},717140(e,t,r){r.d(t,{Ij:()=>y,Jb:()=>o,Kf:()=>c,Lu:()=>i,Ly:()=>d,Mm:()=>v,Mr:()=>g,Ne:()=>u,Nu:()=>P,Q4:()=>a,S$:()=>s,V9:()=>n,VX:()=>m,ZM:()=>l,d:()=>b,et:()=>p,jx:()=>O,tq:()=>h,uw:()=>w,vK:()=>f,vw:()=>S});var n="CHANGE_DRAWING_STATUS",o="DRAW:END_DRAWING",i="DRAW:SET_CURRENT_STYLE",a="DRAW:GEOMETRY_CHANGED",l="DRAW:DRAW_SUPPORT_STOPPED",c="DRAW:SET_SNAPPING_LAYER",u="DRAW:SNAPPING_IS_LOADING",s="DRAW:TOGGLE_SNAPPING",d="DRAW:SET_SNAPPING_CONFIG";function f(e,t,r,n,o){return{type:a,features:e,owner:t,enableEdit:r,textChanged:n,circleChanged:o}}function p(){return{type:"DRAW:FEATURES_SELECTED",features:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}}function v(){return{type:"DRAW:DRAWING_FEATURES",features:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}}function y(){return{type:l}}function m(e,t,r,o,i,a){return{type:n,status:e,method:t,owner:r,features:o,options:i,style:a}}function g(e,t){return{type:o,geometry:e,owner:t}}function b(e){return{type:i,currentStyle:e}}var h=function(e){return m("clean","",e,[],{})};function O(){return{type:s}}function w(e){return{type:c,snappingLayer:e}}function S(){return{type:u}}function P(e,t,r){return{type:d,value:e,prop:t,pluginCfg:r}}},779956(e,t,r){r.d(t,{Ay:()=>H});var n=r(45388),o=r.n(n),i=r(59404),a=r.n(i),l=r(395292),c=r.n(l),u=r(978632),s=r.n(u),d=r(685591),f=r.n(d),p=r(809136),v=r.n(p),y=r(874295),m=r.n(y),g=r(910006),b=r.n(g),h=r(71665),O=r(223062),w=r(538704),S=r(415392),P=r(130711),j=r(737704),E=r(904059),D=r(307679),A=r(24812),I=r(589769),T=r(985564),x=r(980971),C=r(791936),F=r(764932),M=r(77645),k=r(6683),R=r(549112),N=r(270871);function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function W(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?G(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach(function(t){U(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function U(e,t,r){return(t=function(e){var t=function(e){if("object"!=L(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==L(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var q=function(e,t,r){return o().Observable.of((0,h.zd)("mapSync",e),(0,h.zd)("dependenciesMap",function(e,t,r){var n=r.dependenciesMap,o=r.mappings,i=["layer","filter","quickFilters","options"],l=["layers","groups","viewport","zoom","center"],c=["dimension.currentTime","dimension.offsetTime"],u=(h.Yi.exec(t)||[])[1],s=b()(n,function(e){return-1===e.indexOf(u)}),d=t.split(".maps")[0],p=Object.keys(o).filter(function(e){return void 0!==o[e]}).reduce(function(e,r){return f()(c,r)?z(z({},e),{},U({},r,"map"===t?"dimension.".concat(o[r]):"".concat(d,".").concat(o[r]))):!a()(t,"map")&&f()(i,r)?z(z({},e),{},U({},r,"".concat(t,".").concat(o[r]))):a()(t,"map")?f()(l,r)?z(z({},e),{},U({},r,"map"===t?o[r]:"".concat(t.replace(/.map$/,""),".").concat(o[r]))):z(z({},e),{},U({},r,"".concat(d,".").concat(o[r]))):e},{});return e?z(z(z({},s),p),{},U(U({},"dependenciesMap","".concat(d,".dependenciesMap")),"mapSync","".concat(d,".mapSync"))):m()(s,[Object.keys(o)])}(e,t,r)))};const H={exportWidgetData:function(e){return e.ofType(h.Ok).do(function(e){var t=e.data,r=void 0===t?[]:t,n=e.title,o=void 0===n?"data":n;return(0,C.saveAs)(new Blob([(0,M.Vu)(r)],{type:"text/csv"}),o+".csv")}).filter(function(){return!1})},alignDependenciesToWidgets:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,r=void 0===t?function(){}:t;return e.ofType(w.mO,T.LL,h.i,h.FR).map(function(){return(0,j.Gw)(r())}).pluck("availableDependencies").distinctUntilChanged(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return v()(W(e),W(t))}).map(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,h.cV)(e.reduce(function(e,t){var r=t.split(".maps")[0],n=t.replace(/.map$/,"");return a()(t,"map")?z(z({},e),{},U(U(U(U(U(U(U(U(U({},"".concat(r,".dependenciesMap"),"".concat(r,".dependenciesMap")),"".concat(r,".mapSync"),"".concat(r,".mapSync")),"map"===t?"viewport":"".concat(n,".viewport"),"".concat(n,".bbox")),"map"===t?"center":"".concat(n,".center"),"".concat(n,".center")),"map"===t?"zoom":"".concat(n,".zoom"),"".concat(n,".zoom")),"map"===t?"layers":"".concat(n,".layers"),"map"===t?"layers.flat":"".concat(n,".layers")),"map"===t?"groups":"".concat(n,".groups"),"map"===t?"layers.groups":"".concat(n,".groups")),"dimension.currentTime","dimension.currentTime"),"dimension.offsetTime","dimension.offsetTime")):z(z({},e),{},U(U(U(U(U(U(U(U({},"".concat(t,".filter"),"".concat(t,".filter")),"".concat(t,".quickFilters"),"".concat(t,".quickFilters")),"".concat(r,".dependenciesMap"),"".concat(r,".dependenciesMap")),"".concat(r,".mapSync"),"".concat(r,".mapSync")),"".concat(t,".layer"),"".concat(t,".layer")),"".concat(t,".options"),"".concat(t,".options")),"dimension.currentTime","dimension.currentTime"),"dimension.offsetTime","dimension.offsetTime"))},{}))})},toggleWidgetConnectFlow:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,r=void 0===t?function(){}:t;return e.ofType(h.af).switchMap(function(t){var n=t.active,i=t.availableDependencies,a=void 0===i?[]:i,l=t.options;return n&&a.length>0?1===a.length?q(n,a[0],l):o().Observable.of((0,h.hY)(n,{availableDependencies:a})).merge(e.ofType(h.Zl).filter(function(){return(0,j.Zh)(r())}).switchMap(function(e){var t=e.widget,i=s()((0,j.f$)(r()),"availableDependencies").filter(function(e){return(h.Yi.exec(e)||[])[1]===t.id});return"map"===t.widgetType&&(i=i.filter(function(e){return(h.M9.exec(e)||[])[2]===t.selectedMapId})),q(n,i[0],l).concat(o().Observable.of((0,h.hY)(!1,{})))}).takeUntil(e.ofType(x.LK).merge(e.filter(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=e.key;return t===h._&&r===h.Ws})))):q(n,a[0],l)})},clearWidgetsOnLocationChange:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,r=void 0===t?function(){}:t;return e.ofType(w.mO).switchMap(function(){var t=(0,A.o)(r()).split("/"),n=t[t.length-1];return e.ofType(x.LK).filter(function(e){var t=e.payload,o=(0,A.o)(r()).split("/"),i=o[o.length-1];return"REPLACE"!==t.action&&i!==n}).switchMap(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).payload,t=void 0===e?{}:e;return t&&t.location&&t.location.pathname?o().Observable.of((0,h.LO)()):o().Observable.empty()})})},updateLayerOnLayerPropertiesChange:function(e,t){return e.ofType(E.nX,E.rN).filter(function(e){var t=e.layer,r=e.newProperties,n=e.nodeType,o=e.options;return t&&r||"layers"===n&&c()(o,"layerFilter")}).switchMap(function(e){var r=e.layer,n=e.newProperties,i=e.node,a=e.options,l=t.getState(),u=(0,D.pO)(l,null!=r?r:i);return u&&(c()(null!=n?n:a,"layerFilter")||c()(n,"fields"))?o().Observable.of((0,h.Dh)(u)):o().Observable.empty()})},updateLayerOnLoadingErrorChange:function(e,t){return e.ofType(E.ZL,E.dX).groupBy(function(e){return e.layerId}).map(function(e){return e.switchMap(function(e){var r,n=e.layerId,i=t.getState(),a=(0,D.pO)(i,n);return(r=o().Observable).of.apply(r,W(a&&a.previousLoadingError!==a.loadingError?[(0,h.Dh)(a)]:[]))})}).mergeAll()},updateDependenciesMapOnMapSwitch:function(e,t){return e.ofType(h.ao).filter(function(e){var t=e.key;return f()(["maps","selectedMapId"],t)}).switchMap(function(e){var r=e.id,n=e.value,i=o().Observable.empty(),a="string"==typeof n?n:null==n?void 0:n.mapId;if(a){var l=(0,j.Qs)(t.getState()),c=(0,R.y1)(l,r,a);v()(l,c)||(i=o().Observable.of((0,h.ID)(c)))}return i})},onWidgetCreationFromMap:function(e,t){return e.ofType(h.Pv).filter(function(e){var r=e.key,n=e.value;return"widgetType"===r&&"chart"===n&&!(0,I.Hd)(t.getState())}).switchMap(function(){var e=o().Observable.empty(),r=t.getState(),n=(0,j.oR)(r);return n&&(e=o().Observable.of((0,h.zd)("chart-layers",[n]))),e})},onOpenFilterEditorEpic:function(e,t){return e.ofType(h.aE).switchMap(function(){var e=t.getState(),r=(0,j.oR)(e),n=(0,k.Yd)((0,F.reprojectBbox)(r.bbox.bounds,"EPSG:4326","EPSG:3857"),R.tu.size,0,21,96,R.tu.resolutions),i=z(z({},R.tu),{},{zoom:n,center:{crs:r.bbox.crs,x:(r.bbox.bounds.maxx+r.bbox.bounds.minx)/2,y:(r.bbox.bounds.maxy+r.bbox.bounds.miny)/2}}),a=null!=r&&r.bbox?i:null;return o().Observable.of((0,O.Ap)(a))})},onResetMapEpic:function(e,t){return e.ofType(S.x7).filter(function(e,r){return!(0,P.sY)(t.getState())&&"queryPanel"===r&&(0,I.Hd)(t.getState())}).switchMap(function(){return o().Observable.of((0,O.Ap)(null))})},onMapEditorOpenEpic:function(e){return e.ofType(N.W0).filter(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).map;return null==e?void 0:e.widgetId}).switchMap(function(e){var t=e.map;return o().Observable.of((0,h.Dr)(t.widgetId,"maps",t,"merge"),(0,N.jD)("widgetInlineEditor"))})}}},795153(e,t,r){r.d(t,{A:()=>M});var n=r(541033),o=r.n(n),i=r(71665),a=r(754364),l=r(538704),c=r(985564),u=r(967487),s=r.n(u),d=r(978632),f=r.n(d),p=r(356513),v=r.n(p),y=r(874295),m=r.n(y),g=r(149576),b=r.n(g),h=r(39128),O=r.n(h),w=r(227341),S=r.n(w),P=r(905185),j=r(549112);function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function D(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||A(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){if(e){if("string"==typeof e)return I(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I(e,t):void 0}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach(function(t){C(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function C(e,t,r){return(t=function(e){var t=function(e){if("object"!=E(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==E(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var F={dependencies:{viewport:"map.bbox",center:"map.center",zoom:"map.zoom"},containers:{floating:{widgets:[]}},builder:{map:null,settings:{step:0}}};const M=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case i.Zz:return s()("defaults",r.cfg,t);case i._:return s()("builder.settings.".concat(r.key),r.value,t);case i.E1:return s()("builder.editor",r.widget,s()("builder.settings",r.settings||F.settings,t));case i.zx:return s()("builder.editor",x(x({},r.widget),{},{widgetType:r.widget&&r.widget.widgetType||"chart"}),s()("builder.settings.step",0,t));case i.Pv:return(0,j.YL)(r,t);case i.i:var n,u,d,p,y,g=x({},r.widget);"chart"===g.widgetType&&(g=m()(g,["layer","url"]));var h=null!==(n=null==t||null===(u=t.defaults)||void 0===u||null===(u=u.initialSize)||void 0===u?void 0:u.w)&&void 0!==n?n:1,w=null!==(d=null==t||null===(p=t.defaults)||void 0===p||null===(p=p.initialSize)||void 0===p?void 0:p.h)&&void 0!==d?d:1,E=f()(t,"containers[".concat(i.Kv,"].selectedLayoutId")),I=f()(t,"containers[".concat(i.Kv,"].layouts")),T=E||(null==I||null===(y=I[0])||void 0===y?void 0:y.id);return(0,P.Vo)("containers[".concat(r.target,"].widgets"),x(x(x({id:r.id},g),T?{layoutId:T}:{}),{},{dataGrid:r.id&&{w:h,h:w,x:0,y:0}}),{id:r.widget.id||r.id},t);case i.dj:var C="containers[".concat(r.target,"].widgets");return f()(t,C)?s()(C,r.widgets,t):t;case i.ao:var M,k=v()(f()(t,"containers[".concat(r.target,"].widgets")),{id:r.id}),R=r.value;return"merge"===r.mode&&(R="maps"===r.key?null==k||null===(M=k.maps)||void 0===M?void 0:M.map(function(e){var t;return e.mapId===(null===(t=r.value)||void 0===t?void 0:t.mapId)?x(x({},e),null==r?void 0:r.value):e}):Object.assign({},k[r.key],r.value)),(0,P.Vo)("containers[".concat(r.target,"].widgets"),s()(r.key,R,k),{id:r.id},t);case i._3:if(r.layer){var N=f()(t,"containers[".concat(i.Kv,"].widgets"));if(N)return s()("containers[".concat(i.Kv,"].widgets"),N.map(function(e){if("chart"===e.widgetType&&null!=e&&e.charts){var t,n=null!=e&&null!==(t=e.charts)&&void 0!==t&&t.length?D(e.charts):[];return n=n.map(function(e){var t,n=x({},e);return n.traces=null==n||null===(t=n.traces)||void 0===t?void 0:t.map(function(e){return f()(e,"layer.id")===r.layer.id?s()("layer",r.layer,e):e}),n}),s()("charts",n,e)}return f()(e,"layer.id")===r.layer.id?s()("layer",r.layer,e):e}),t)}return t;case i.SJ:var L="containers[".concat(i.Kv,"].widgets"),W=(0,P.XB)("containers[".concat(r.target,"].widgets"),{id:r.widget.id},t),G=f()(W,L,[]);return s()(L,G.map(function(e){if(e.dependenciesMap){var t=(n=i.Yi.exec((Object.values(e.dependenciesMap)||[])[0])||[],o=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(n,o)||A(n,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[1];if(t&&r.widget.id===t)return x(x({},m()(e,"dependenciesMap")),{},{mapSync:!1})}var n,o;return e}),t);case c.LL:var _=r.data;return s()("containers[".concat(i.Kv,"]"),x({},_),t);case a.if:var z,U,q,H=(null==t||null===(z=t.containers)||void 0===z?void 0:z[i.Kv].widgets)||[];H=null===(U=H)||void 0===U?void 0:U.map(function(e){var t,r=null===(t=e.maps)||void 0===t?void 0:t.map(function(e){var t;return x(x({},e),{},{layers:null===(t=e.layers)||void 0===t?void 0:t.map(function(e){return e.security?x(x({},e),{},{security:x(x({},e.security),{},{rand:o()()})}):e})})});return x(x({},e),{},{maps:r})});var V=null===(q=t.builder)||void 0===q||null===(q=q.editor)||void 0===q||null===(q=q.maps)||void 0===q?void 0:q.map(function(e){return x(x({},e),{},{layers:e.layers.map(function(e){return e.security?x(x({},e),{},{security:x(x({},e.security),{},{rand:o()()})}):e})})});return s()("containers[".concat(i.Kv,"].widgets"),H,s()("builder.editor.maps",V,t));case a.Lv:var Z,$,K,J=(null==t||null===(Z=t.containers)||void 0===Z?void 0:Z[i.Kv].widgets)||[];J=null===($=J)||void 0===$?void 0:$.map(function(e){var t,n=null===(t=e.maps)||void 0===t?void 0:t.map(function(e){return x(x({},e),{},{layers:e.layers.map(function(e){var t;return(null==e||null===(t=e.security)||void 0===t?void 0:t.sourceId)===r.protectedId?x(x({},e),{},{security:void 0}):e})})});return x(x({},e),{},{maps:n})});var Y=null===(K=t.builder)||void 0===K||null===(K=K.editor)||void 0===K||null===(K=K.maps)||void 0===K?void 0:K.map(function(e){return x(x({},e),{},{layers:e.layers.map(function(e){var t;return(null==e||null===(t=e.security)||void 0===t?void 0:t.sourceId)===r.protectedId?x(x({},e),{},{security:void 0}):e})})});return s()("containers[".concat(i.Kv,"].widgets"),J,s()("builder.editor.maps",Y,t));case l.mO:var B=(r.config||{}).widgetsConfig;return S()(B)?t:(B=(0,j.Mx)(B),s()("containers[".concat(i.Kv,"]"),x({},B),t));case i.cv:return s()("containers[".concat(r.target,"].layout"),r.layout)(s()("containers[".concat(r.target,"].layouts"),r.allLayouts,t));case i.Y3:case c.Vd:return s()("containers[".concat(i.Kv,"]"),F.containers[i.Kv],t);case i.OO:var X=r.key,Q=r.value;return s()("dependencies[".concat(X,"]"),Q,t);case i.V$:var ee=r.key;return s()("dependencies[".concat(ee,"]"),null,t);case i.j2:var te=r.dependencies;return s()("dependencies",te,t);case i.Up:return s()("dependencies",F.dependencies,t);case i.D5:var re=r.widget,ne=void 0===re?{}:re;if(ne.dataGrid&&ne.dataGrid.static)return t;var oe=f()(t,"containers[".concat(r.target,"].collapsed[").concat(ne.id));if(oe){var ie=[].concat(D(f()(t,"containers[".concat(r.target,"].layout"),[])),D(O()(f()(oe,"layout",[])))),ae=b()(f()(t,"containers[".concat(r.target,"].layouts"),{}),function(){var e=arguments.length>1?arguments[1]:void 0;return[].concat(D(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),D(O()(f()(oe,"layouts[".concat(e,"]"),[]))))});return m()((0,P.Zz)(s()("containers[".concat(r.target,"].layout"),ie),s()("containers[".concat(r.target,"].layouts"),ae))(t),"containers[".concat(r.target,"].collapsed[").concat(ne.id,"]"))}return s()("containers[".concat(r.target,"].collapsed[").concat(ne.id,"]"),{layout:v()(f()(t,"containers[".concat(r.target,"].layout"),[]),{i:ne.id}),layouts:b()(f()(t,"containers[".concat(r.target,"].layouts"),{}),function(e){return v()(e,{i:ne.id})})},t);case i.wf:var le,ce,ue,se,de,fe,pe,ve,ye,me,ge,be=r.widget,he=null==t||null===(le=t.containers)||void 0===le||null===(le=le[r.target])||void 0===le?void 0:le.maximized;if(!be||null!==(ce=be.dataGrid)&&void 0!==ce&&ce.static)return t;var Oe,we=null==t||null===(ue=t.containers)||void 0===ue||null===(ue=ue[r.target])||void 0===ue?void 0:ue.layouts,Se=(null==t||null===(se=t.containers)||void 0===se||null===(se=se[r.target])||void 0===se?void 0:se.selectedLayoutId)||(null==we||null===(de=we[0])||void 0===de?void 0:de.id),Pe=Array.isArray(we),je=null!=he&&he.widget&&Array.isArray(he.widget)?he.widget.find(function(e){return e.id===be.id}):be;if(je&&null!=he&&he.widget&&(null==he||null===(fe=he.widget)||void 0===fe?void 0:fe.length)>1){var Ee,De,Ae=x(x({},he),{},{widget:he.widget.filter(function(e){return e.id!==be.id})}),Ie=we.map(function(e){return e.id===be.layoutId?x({},he.layouts.find(function(e){return e.id===be.layoutId})):x({},e)});return(0,P.Zz)(s()("containers[".concat(r.target,"].maximized"),Ae),s()("containers[".concat(r.target,"].layout"),null===(Ee=Ie.find(function(e){return e.id===be.layoutId}))||void 0===Ee?void 0:Ee.md),s()("containers[".concat(r.target,"].layouts"),Ie),s()("containers[".concat(r.target,"].widgets"),null==t||null===(De=t.containers)||void 0===De||null===(De=De[r.target])||void 0===De||null===(De=De.widgets)||void 0===De?void 0:De.map(function(e){return e.id===be.id?x(x({},e),{},{dataGrid:x(x({},e.dataGrid),{},{isDraggable:!0,isResizable:!0})}):e})))(t)}if(je&&null!=he&&he.widget)return(0,P.Zz)(s()("containers[".concat(r.target,"].layout"),he.layout),s()("containers[".concat(r.target,"].layouts"),he.layouts),s()("containers[".concat(r.target,"].maximized"),{}),s()("containers[".concat(r.target,"].widgets"),null==t||null===(Oe=t.containers)||void 0===Oe||null===(Oe=Oe[r.target])||void 0===Oe||null===(Oe=Oe.widgets)||void 0===Oe?void 0:Oe.map(function(e){return e.id===he.widget.id?x(x({},e),{},{dataGrid:x(x({},e.dataGrid),{},{isDraggable:!0,isResizable:!0})}):e})))(t);if(null!=t&&null!==(pe=t.containers)&&void 0!==pe&&null!==(pe=pe[r.target])&&void 0!==pe&&null!==(pe=pe.collapsed)&&void 0!==pe&&pe[be.id])return t;var Te=x(x({},v()(null==t||null===(ve=t.containers)||void 0===ve||null===(ve=ve[r.target])||void 0===ve?void 0:ve.layout,{i:be.id})),{x:0,y:0,w:1,h:1}),xe=Pe?we.map(function(e){return e.id===Se?x(x({},e),{},{xxs:[Te],md:[]}):x({},e)}):{xxs:[Te]};return(0,P.Zz)(s()("containers[".concat(r.target,"].maximized"),{widget:Pe?[].concat(D((null==he?void 0:he.widget)||[]),[be]):be,layout:(null==he?void 0:he.layout)||(null==t||null===(ye=t.containers)||void 0===ye||null===(ye=ye[r.target])||void 0===ye?void 0:ye.layout),layouts:(null==he?void 0:he.layouts)||(null==t||null===(me=t.containers)||void 0===me||null===(me=me[r.target])||void 0===me?void 0:me.layouts)}),s()("containers[".concat(r.target,"].layout"),[Te]),s()("containers[".concat(r.target,"].layouts"),xe),s()("containers[".concat(r.target,"].widgets"),null==t||null===(ge=t.containers)||void 0===ge||null===(ge=ge[r.target])||void 0===ge||null===(ge=ge.widgets)||void 0===ge?void 0:ge.map(function(e){return e.id===be.id?x(x({},e),{},{dataGrid:x(x({},e.dataGrid),{},{isDraggable:!1,isResizable:!1})}):e})))(t);case i.FM:var Ce=f()(t,"containers[".concat(r.target,"].widgets"),[]).filter(function(e){return!e.dataGrid||!e.dataGrid.static}),Fe=Ce.filter(function(e){return f()(t,"containers[".concat(r.target,"].collapsed[").concat(e.id,"]"))}),Me=Ce.filter(function(e){return!f()(t,"containers[".concat(r.target,"].collapsed[").concat(e.id,"]"))});return 0===Me.length?Fe.reduce(function(t,r){return e(t,(0,i.Ye)(r))},t):Me.length>0?Me.reduce(function(t,r){return e(t,(0,i.Ye)(r))},t):t;case i.Mi:return s()("tray",r.value,t);case i.uh:return s()("containers[".concat(r.target,"].layouts"),r.layouts,t);case i.Kw:return s()("containers[".concat(r.target,"].selectedLayoutId"),r.viewId,t);case i.FR:var ke;return s()("containers[".concat(i.Kv,"]"),x(x({},null==t||null===(ke=t.containers)||void 0===ke?void 0:ke[i.Kv]),r.data),t);default:return t}}}}]);