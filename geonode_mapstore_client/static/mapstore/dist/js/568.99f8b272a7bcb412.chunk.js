(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[568,4971],{509095:(e,t,r)=>{"use strict";r.d(t,{AX:()=>s,C_:()=>x,D5:()=>l,Gh:()=>h,HW:()=>u,JG:()=>T,K5:()=>m,M_:()=>o,Nn:()=>a,SU:()=>g,S_:()=>f,Vu:()=>j,XP:()=>C,Xf:()=>O,Zb:()=>E,bS:()=>y,bj:()=>P,cm:()=>v,ct:()=>i,go:()=>d,hS:()=>R,kk:()=>c,l8:()=>p,lm:()=>n,nO:()=>b,o7:()=>w,vB:()=>S});var n="BACKGROUND_SELECTOR:ADD_BACKGROUND",o="BACKGROUND_SELECTOR:REMOVE_BACKGROUND",i="BACKGROUND_SELECTOR:BACKGROUND_ADDED",u="BACKGROUND_SELECTOR:BACKGROUND_EDITED",a="BACKGROUND_SELECTOR:ADD_BACKGROUND_PROPERTIES",l="BACKGROUND_SELECTOR:SET_BACKGROUND_MODAL_PARAMS",c="BACKGROUND_SELECTOR:UPDATE_BACKGROUND_THUMBNAIL",s="BACKGROUND_SELECTOR:BACKGROUNDS_CLEAR",f="BACKGROUND_SELECTOR:CREATE_BACKGROUNDS_LIST",p="BACKGROUND_SELECTOR:CLEAR_MODAL_PARAMETERS",d="BACKGROUND_SELECTOR:CONFIRM_DELETE_BACKGROUND_MODAL",b="BACKGROUND_SELECTOR:ALLOW_BACKGROUNDS_DELETION",y="BACKGROUND_SELECTOR:SYNC_CURRENT_BACKGROUND_LAYER",v="BACKGROUND_SELECTOR:STASH_SELECTED_SERVICE";function m(e){return{type:f,backgrounds:e}}function g(e){return{type:n,source:e}}function O(e){return{type:a,modalParams:e}}function h(e){return{type:l,modalParams:e}}function S(e){return{type:i,layerId:e}}function w(e){return{type:u,layerId:e}}function j(e){return{type:y,id:e}}function P(e){return{type:b,allow:e}}function x(e,t){return{type:c,thumbnailData:e,id:t}}function R(e){return{type:o,backgroundId:e}}function E(){return{type:p}}function T(e){return{type:d,show:e,layerTitle:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,layerId:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null}}function C(e){return{type:v,service:e}}},557238:(e,t,r)=>{"use strict";r.d(t,{Fu:()=>O,TN:()=>m});var n=r(584153),o=r(995531),i=r(764932),u=r(231521),a=r.n(u);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach(function(t){d(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e,t,r){return(t=function(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b={},y=function(e){var t,r,n,o,u=null!=e&&null!==(t=e.spatialReference)&&void 0!==t&&t.wkt?"4326":(null==e||null===(r=e.spatialReference)||void 0===r?void 0:r.latestWkid)||(null==e||null===(n=e.spatialReference)||void 0===n?void 0:n.wkid),a=null!=e&&null!==(o=e.spatialReference)&&void 0!==o&&o.wkt?(0,i.reprojectBbox)([null==e?void 0:e.xmin,null==e?void 0:e.ymin,null==e?void 0:e.xmax,null==e?void 0:e.ymax],e.spatialReference.wkt,"EPSG:4326"):e?[null==e?void 0:e.xmin,null==e?void 0:e.ymin,null==e?void 0:e.xmax,null==e?void 0:e.ymax]:null;return a?{bounds:{minx:a[0],miny:a[1],maxx:a[2],maxy:a[3]},crs:"EPSG:".concat(u)}:null},v=function(e){return{version:null==e?void 0:e.currentVersion,queryable:((null==e?void 0:e.capabilities)||"").includes("Data"),format:(e.supportedImageFormatTypes||"").split(",").filter(function(e){return/PNG|JPG|GIF/.test(e)})[0]||"PNG32"}},m=function(e,t){return void 0===t?o.A.get(e,{params:{f:"json"}}).then(function(e){var t=e.data,r=y(null==t?void 0:t.fullExtent);return p(p(p({},v(t)),r&&{bbox:r}),{},{description:t.description||t.serviceDescription,options:{layers:t.layers},data:t})}):o.A.get("".concat(a()(e,"/"),"/").concat(t),{params:{f:"json"}}).then(function(e){var t=e.data,r=y(null==t?void 0:t.extent);return p(p({},r&&{bbox:r}),{},{data:t})})},g=function(e,t){var r=t.startPosition,n=t.maxRecords,o=t.text,i=null==e?void 0:e.filter(function(e){return!o||-1!==(null==e?void 0:e.name.toLowerCase().indexOf(o.toLowerCase()))});return{numberOfRecordsMatched:i.length,numberOfRecordsReturned:Math.min(n,i.length),records:i.filter(function(e,t){return t>=r-1&&t<r-1+n})}},O=function(e,t,r,i,u){return function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=null==r||null===(t=r.info)||void 0===t||null===(t=t.options)||void 0===t||null===(t=t.service)||void 0===t?void 0:t.protectedId,u=(0,n.WZ)(i);return(b[e]?function(){return Promise.resolve(b[e])}:function(){return o.A.get(e,{params:{f:"json"},headers:u}).then(function(t){var r=t.data;return b[e]=r,r})})().then(function(t){var n,o,i=t||{},u=i.layers,l=i.services;if(l)return g(l.filter(function(e){return["MapServer","ImageServer"].includes(e.type)}).map(function(r){return{url:"".concat(a()(e,"/"),"/").concat(r.name,"/").concat(r.type),version:t.currentVersion,name:r.name,description:r.type}}),r);var s=((null==t?void 0:t.capabilities)||"").includes("Map")||((null==t?void 0:t.capabilities)||"").includes("Image"),f=p(p({url:e},v(t)),{},{layers:u}),d=y(null==t?void 0:t.fullExtent),b=[].concat(c(s?[p({name:(null==t||null===(n=t.documentInfo)||void 0===n?void 0:n.Title)||t.name||(null==r||null===(o=r.info)||void 0===o||null===(o=o.options)||void 0===o||null===(o=o.service)||void 0===o?void 0:o.title)||t.mapName,description:t.description||t.serviceDescription,bbox:d},f)]:[]),c((s&&u?u:[]).map(function(e){return p(p({},e),f)})));return g(b,r)})}(e,{startPosition:t,maxRecords:r,text:i,info:u}).then(function(e){return{numberOfRecordsMatched:e.numberOfRecordsMatched,numberOfRecordsReturned:e.numberOfRecordsReturned,records:e.records}})}},68982:(e,t,r)=>{"use strict";r.d(t,{A2:()=>v,Fu:()=>y,Ww:()=>p,_h:()=>b});var n=r(272505),o=r.n(n),i=r(183555),u=r(6683);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){s(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e,t,r){return(t=function(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var p=function(e){var t=e.data,r=e.ifcModule.ifcApi,n=new Uint8Array(t),o=r.OpenModel(n,{COORDINATE_TO_ORIGIN:!1,USE_FAST_BOOLS:!0});r.LoadAllGeometry(o);var i=r.GetCoordinationMatrix(o);i&&r.SetGeometryTransformation(o,i);var u=[],a=1/0,l=-1/0,c=1/0,s=-1/0,f=1/0,p=-1/0;return r.StreamAllMeshes(o,function(e){for(var t=e.geometries,n=[],i=0;i<t.size();i++){for(var d=t.get(i),b=r.GetGeometry(o,d.geometryExpressID),y=r.GetVertexArray(b.GetVertexData(),b.GetVertexDataSize()),v=r.GetIndexArray(b.GetIndexData(),b.GetIndexDataSize()),m=new Float64Array(y.length/2),g=new Float32Array(y.length/2),O=0;O<y.length;O+=6){var h=y[O],S=y[O+1],w=y[O+2];h<a&&(a=h),S<c&&(c=S),w<f&&(f=w),h>l&&(l=h),S>s&&(s=S),w>p&&(p=w),m[O/2]=h,m[O/2+1]=S,m[O/2+2]=w,g[O/2]=y[O+3],g[O/2+1]=y[O+4],g[O/2+2]=y[O+5]}n.push({color:d.color,positions:m,normals:g,indices:Array.from(v),flatTransformation:d.flatTransformation}),b.delete()}var j=r.GetLine(o,e.expressID);u.push({geometry:n,id:e.expressID,properties:Object.keys(j).reduce(function(e,t){var r;return e[t]=(null===(r=j[t])||void 0===r?void 0:r.value)||j[t],e},{})})}),r.CloseModel(o),{meshes:u,extent:[a,c,l,s,f,p],center:[a+(l-a)/2,c+(s-c)/2,f+(p-f)/2],size:[l-a,s-c,p-f]}},d={},b=function(e){return(d[e]?function(){return Promise.resolve(d[e])}:function(){return o().get(e,{responseType:"arraybuffer"}).then(function(t){var r=t.data;return d[e]=r,r})})().then(function(e){return r.e(9878).then(r.bind(r,149878)).then(function(e){var t=new e.IfcAPI;return t.SetWasmPath("./web-ifc/"),t.Init().then(function(){return{ifcApi:t,WebIFC:e}})}).then(function(t){return{data:e,ifcModule:t}})})},y=function(e){return b(e).then(function(t){var r=t.ifcModule,n=t.data,o=r.ifcApi,a=o.OpenModel(new Uint8Array(n),{COORDINATE_TO_ORIGIN:!1,USE_FAST_BOOLS:!0}),l=function(e,t,r){var n,o,i=e.ifcApi;return{version:void 0!==(null==i?void 0:i.GetModelSchema(t))?null!==(n=i.GetModelSchema(t))&&void 0!==n&&n.includes("IFC4")?"IFC4":i.GetModelSchema(t):"IFC4",format:(o=(r||"").split(/\./g))[o.length-1],properties:{}}}(r,a,e),s=function(e,t,r){var n=e.ifcApi,o=e.WebIFC,u={};if(null!=t&&t.includes("IFC4")){var a,l,c=n.GetLineIDsWithType(r,o.IFCPROJECTEDCRS),s=n.GetLineIDsWithType(r,o.IFCMAPCONVERSION);if(c.size()){var f,p=c.get(0),d=n.GetLine(r,p);a=null==d||null===(f=d.Name)||void 0===f?void 0:f.value}if(s.size()){var b,y,v,m,g,O,h,S,w=s.get(0),j=n.GetLine(r,w);if(l={northings:null==j||null===(b=j.Northings)||void 0===b?void 0:b.value,eastings:null==j||null===(y=j.Eastings)||void 0===y?void 0:y.value,orthogonalHeight:null==j||null===(v=j.OrthogonalHeight)||void 0===v?void 0:v.value,xAxisOrdinate:null==j||null===(m=j.XAxisOrdinate)||void 0===m?void 0:m.value,xAxisAbscissa:null==j||null===(g=j.XAxisAbscissa)||void 0===g?void 0:g.value,rotation:180*Math.atan2((null==j||null===(O=j.XAxisOrdinate)||void 0===O?void 0:O.value)||0,(null==j||null===(h=j.XAxisAbscissa)||void 0===h?void 0:h.value)||0)/Math.PI,scale:null==j||null===(S=j.Scale)||void 0===S?void 0:S.value},i.default.defs(a)){var P=(0,i.default)(i.default.defs(a),i.default.defs("EPSG:4326"),[l.eastings,l.northings]);u={projectedCrs:a,longitude:P[0]||0,latitude:P[1]||0,height:l.orthogonalHeight||0,scale:l.scale||1,heading:l.rotation,mapConversion:l}}else u={projectedCrs:a,projectedCrsNotSupported:!0,mapConversion:l}}}return u}(r,l.version,a),d=function(e){var t,r=e.modelID,n=e.ifcModule,o=e.data,i=n.ifcApi,u=n.WebIFC,a=i.GetLineIDsWithType(r,u.IFCBOUNDINGBOX).size();return a?(t=Array(a).keys(),function(e){if(Array.isArray(e))return f(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map(function(e){var t=i.GetLineIDsWithType(r,u.IFCBOUNDINGBOX).get(e),n=i.GetLine(r,t),o=i.GetLine(r,n.Corner.value),a=((null==o?void 0:o.Coordinates)||[]).map(function(e){return(null==e?void 0:e.value)||0});return[n.XDim.value+Math.abs(a[0]),n.YDim.value+Math.abs(a[1]),n.ZDim.value+Math.abs(a[2])]})[0]:p({data:o,ifcModule:n}).size}({modelID:a,ifcModule:r,data:n});l.properties=c(c(c({},l.properties),s),{},{size:d}),o.CloseModel(a);var b=l.properties,y={bounds:{minx:(b.longitude||0)-d[0]/2/u.Ig.degrees,miny:(b.latitude||0)-d[1]/2/u.Ig.degrees,maxx:(b.longitude||0)+d[0]/2/u.Ig.degrees,maxy:(b.latitude||0)+d[1]/2/u.Ig.degrees},crs:"EPSG:4326"};return c(c({},l),y&&{bbox:y})})},v="MODEL"},229665:(e,t,r)=>{"use strict";r.d(t,{A:()=>fn});var n={};r.r(n),r.d(n,{getCatalogRecords:()=>ae,getLayerFromRecord:()=>le,preprocess:()=>ne,testService:()=>ie,textSearch:()=>ue,validate:()=>oe});var o={};r.r(o),r.d(o,{getCatalogRecords:()=>Re,getLayerFromRecord:()=>Ee,preprocess:()=>we,testService:()=>Pe,textSearch:()=>xe,validate:()=>je});var i={};r.r(i),r.d(i,{getCatalogRecords:()=>Ve,getLayerFromRecord:()=>We,preprocess:()=>Fe,testService:()=>ke,textSearch:()=>Be,validate:()=>Ne});var u={};r.r(u),r.d(u,{getCatalogRecords:()=>ht,getLayerFromRecord:()=>jt,getRecords:()=>vt,testService:()=>Ot,textSearch:()=>mt,tileProviderToLayer:()=>wt,tmsToLayer:()=>St,validate:()=>gt});var a={};r.r(a),r.d(a,{getCatalogRecords:()=>_t,getLayerFromRecord:()=>Bt,getRecords:()=>Mt,preprocess:()=>It,testService:()=>Gt,textSearch:()=>Ut,validate:()=>Lt});var l={};r.r(l),r.d(l,{getCatalogRecords:()=>$t,getLayerFromRecord:()=>Xt,preprocess:()=>Wt,testService:()=>qt,textSearch:()=>zt,validate:()=>Kt});var c={};r.r(c),r.d(c,{getCatalogRecords:()=>nr,getLayerFromRecord:()=>or,preprocess:()=>er,testService:()=>rr,textSearch:()=>Qt,validate:()=>tr});var s={};r.r(s),r.d(s,{getCatalogRecords:()=>yr,getLayerFromRecord:()=>vr,preprocess:()=>pr,testService:()=>dr,textSearch:()=>br,validate:()=>mr});var f={};r.r(f),r.d(f,{cogToLayer:()=>_r,getCatalogRecords:()=>Ur,getLayerFromRecord:()=>Fr,getRecords:()=>Mr,testService:()=>Gr,textSearch:()=>Ir,validate:()=>Lr});var p={};r.r(p),r.d(p,{getCatalogRecords:()=>Hr,getLayerFromRecord:()=>Jr,preprocess:()=>$r,testService:()=>Xr,textSearch:()=>Zr,validate:()=>Yr});var d={};r.r(d),r.d(d,{getCatalogRecords:()=>ln,getLayerFromRecord:()=>cn,preprocess:()=>on,testService:()=>un,textSearch:()=>an,validate:()=>sn});var b=r(400912),y=r.n(b),v=r(185015),m=r.n(v),g=r(679859),O=r.n(g),h=r(499084),S=r.n(h),w=r(333031),j=r.n(w),P=r(763375),x=r.n(P),R=r(962193),E=r.n(R),T=r(956449),C=r.n(T),A=r(587612),D=r.n(A),M=r(269843),I=r.n(M),L=r(6683),G=r(45388),U=r.n(G),_=r(779893),B=r(112585),F=r(142974),N=r(421027),k=r(223856),V=r(375482),W=r(995531);function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function q(e){var t="function"==typeof Map?new Map:void 0;return q=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return function(e,t,r){if(z())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var o=new(e.bind.apply(e,n));return r&&$(o,r.prototype),o}(e,arguments,X(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),$(r,e)},q(e)}function z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(z=function(){return!!e})()}function $(e,t){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$(e,t)}function X(e){return X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},X(e)}var Z=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,r){return t=X(t),function(e,t){if(t&&("object"==K(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,z()?Reflect.construct(t,r||[],X(e).constructor):t.apply(e,r))}(this,t,[e])).name="ServiceValidationError",n.notification=r,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(t,e),r=t,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(q(Error)),H=function(e){return U().Observable.of(e)},J=function(e){return""===e.title||""===e.url?U().Observable.throw(new Z("Validation Error","catalog.notification.warningAddCatalogService")):U().Observable.of(e)},Y=function(e){var t=e.parseUrl,r=void 0===t?function(e){return e}:t;return function(e){var t="catalog.notification.errorServiceUrl";return U().Observable.defer(function(){return W.A.get(r(e.url))}).catch(function(){throw new Z("Service Test error",t)}).switchMap(function(r){if(r.error||""===r.data)throw new Z("Service Test error",t);return U().Observable.of(e)})}};function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach(function(t){re(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function re(e,t,r){return(t=function(e){var t=function(e){if("object"!=Q(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Q(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ne=function(e){var t=e.domainAliases;return e.domainAliases=D()(t),G.Observable.of(e)},oe=J,ie=Y({parseUrl:V.Dl}),ue=V.yZ,ae=function(e,t){return e&&e.records?e.records.map(function(r){var n=[{type:"OGC:WMS",url:t&&t.url,SRS:r.SRS&&(C()(r.SRS)?r.SRS:[r.SRS])||[],params:{name:r.Name}}],o=(0,k.VV)({references:n}).wms;return{serviceType:"wms",isValid:!!o,capabilities:r,credits:r.credits,boundingBox:(0,V.U7)(r),description:r.Abstract||r.Title||r.Name,identifier:r.Name,service:e.service,tags:"",layerOptions:te(te({},(null==t?void 0:t.layerOptions)||{}),(null==e?void 0:e.layerOptions)||{}),title:(0,B.Sj)(r)||r.Name,getMapFormats:r.getMapFormats,getFeatureInfoFormats:r.getFeatureInfoFormats,dimensions:(r.Dimension&&S()(r.Dimension)||[]).map(function(e){return Object.assign({},{values:e._&&e._.split(",")||[]},e.$||{})}).filter(function(e){return e&&"time"!==e.name}),references:n,ogcReferences:o}}):null},le=function(e,t,r){var n=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.removeParams,o=void 0===n?[]:n,i=r.service,u=r.catalogURL,a=r.url,l=r.map,c=void 0===l?{}:l,s=r.layerBaseConfig;if(!e||!e.references)return null;var f,p,d=(0,k.VV)(e).wms,b=function(e){return(0,k.Ln)((0,_.hG)(e),["request","layer","layers","service","version"].concat(o))},y=(0,k.mT)(d.url);if(y&&C()(y))f=y.map(function(e){return b(e)}).map(function(e){return e.url}),p=y.map(function(e){return b(e)}).map(function(e){return e.params}).reduce(function(e,t){return te(te({},e),t)},{});else{var v=b(y||u);f=v.url,p=v.params}var m,g,O=(m=a||f,C()(m)&&1===m.length?m[0]:m),h=(0,k.Zh)(d.SRS),S=null!==(t=null==e?void 0:e.capabilities)&&void 0!==t?t:{},w=S.MaxScaleDenominator,j=S.MinScaleDenominator,P=i||{},x=P.format,R=P.infoFormat,T=P.localizedLayerStyles,A=P.allowUnsecureLayers,D=P.autoSetVisibilityLimits,M=P.layerOptions,G=(e.getMapFormats||[]).filter(F.sJ),U=(e.getFeatureInfoFormats||[]).filter(F.gD),B=(null==G?void 0:G.find(function(e){return e===x}))||G[0]||x,V=R&&N.Y5[R]?{format:N.Y5[R]}:null;null!=i&&i.protectedId&&(g={sourceId:null==i?void 0:i.protectedId,type:"basic"});var W=te(te(te(te({type:"wms",requestEncoding:e.requestEncoding,style:e.style,format:B,featureInfo:V,url:O,capabilitiesURL:e.capabilitiesURL,queryable:e.queryable,visibility:!0,dimensions:e.dimensions||[],name:d.params&&d.params.name,title:e.title||d.params&&d.params.name,description:e.description||"",credits:!(0,_.Uh)("noCreditsFromCatalog")&&e.credits,bbox:{crs:e.boundingBox.crs,bounds:{minx:e.boundingBox.extent[0],miny:e.boundingBox.extent[1],maxx:e.boundingBox.extent[2],maxy:e.boundingBox.extent[3]}},security:g,links:(0,k.Jx)(e),params:p,allowedSRS:h,catalogURL:u},s),M),e.layerOptions),{},{localizedLayerStyles:I()(T)?void 0:T,imageFormats:G,infoFormats:U},!I()(A)&&{forceProxy:A});if(D&&!E()(c)&&(w||j)){var K=(!I()(j)&&(0,L.oq)(j,"scale",c)||{}).resolution,q=(!I()(w)&&(0,L.oq)(w,"scale",c)||{}).resolution;W=te(te({},W),{},{minResolution:K,maxResolution:q})}return W}(e,t);return r?Promise.resolve(n):n},ce=r(628017),se=r(764932),fe=r(725304),pe=r(46282),de=r(68982);function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}function ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(r),!0).forEach(function(t){me(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function me(e,t,r){return(t=function(e){var t=function(e){if("object"!=be(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=be(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==be(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ge=function(e,t,r){var n,o,i,u=r.name;if(void 0===u){u=e.title?e.title.join(" "):(0,ce.kA)(t,"catalog.notAvailable");var a=(n=r.protocol,r.value,null!==(o=null===(i=y()([{protocol:"https://registry.geodati.gov.it/metadata-codelist/ProtocolValue/www-download",displayValue:"Download"},{protocol:"http://www.opengis.net/def/serviceType/ogc/wms",displayValue:"WMS"},{protocol:"http://www.opengis.net/def/serviceType/ogc/wfs",displayValue:"WFS"}].filter(function(e){return e.protocol===n})))||void 0===i?void 0:i.displayValue)&&void 0!==o?o:"Link");u="".concat(a?"".concat(u," - ").concat(a):u)}return'<li><a target="_blank" href="'.concat(r.value,'">').concat(u,"</a></li>")};function Oe(e,t){var r,n,o=(null==e?void 0:e.URI)&&S()(e.URI);if(o){var i=y()(o.filter(function(e){return"thumbnail"===e.name}))||y()(o.filter(function(e){var t;return!e.name&&(null===(t=e.protocol)||void 0===t?void 0:t.indexOf("image/"))>-1}));r=i?i.value:null}if(!r&&e&&e.references){var u=function(e){return y()(S()(e.references).filter(function(t){return"WWW:LINK-1.0-http--image-thumbnail"===t.scheme||"thumbnail"===t.scheme||"WWW:DOWNLOAD-1.0-http--download"===t.scheme&&-1!==(t.value||"").indexOf("".concat(e.identifier||"","-thumb"))||"WWW:DOWNLOAD-REST_MAP"===t.scheme&&-1!==(t.value||"").indexOf("".concat(e.identifier||"","-thumb"))}))}(e);u&&(r=u.value)}return r&&(0===r.indexOf("http")||(r=((n=t&&t.url)&&n.replace(/\/csw$/,"/")||"")+r)),r}function he(e){var t,r,n,o;return E()(null===(t=e.boundingBox)||void 0===t?void 0:t.crs)||E()(null===(r=e.boundingBox)||void 0===r?void 0:r.extent)?null:{crs:null===(n=e.boundingBox)||void 0===n?void 0:n.crs,bounds:(0,se.transformExtentToObj)(null===(o=e.boundingBox)||void 0===o?void 0:o.extent)}}var Se=["wfs"],we=H,je=J,Pe=Y({parseUrl:fe.Ay.parseUrl}),xe=fe.Ay.textSearch,Re=function(e,t,r){var n=e;return n&&n.records?n.records.map(function(e){var n=e.dc,o=[];n&&n.references&&(Array.isArray(n.references)?n.references:[n.references]).filter(function(e){return e.scheme.indexOf("http-get-capabilities")>-1}).forEach(function(e){var r=0===e.value.indexOf("http")?e.value:(t&&t.catalogURL||"")+"/"+e.value;o.push({type:e.scheme,url:r})});var i=["wms"].concat(Se).map(function(e){return(0,fe.i0)(n,ve(ve({},t),{},{type:e}))}).filter(function(e){return e});E()(i)||(o=o.concat(i));var u={boundingBox:e.boundingBox&&e.boundingBox.extent&&S()(e.boundingBox.extent.join(","))};if(n&&(u=ve(ve({},u),j()(Object.keys(n)).reduce(function(e,t){return ve(ve({},e),{},me({},t,x()(S()(n[t]))))},{}))),n&&n.URI&&S()(n.URI)&&S()(n.URI).length&&(u=ve(ve({},u),{},{uri:["<ul>"+S()(n.URI).map(ge.bind(void 0,u,r)).join("")+"</ul>"]})),n&&n.subject&&S()(n.subject)&&S()(n.subject).length&&(u=ve(ve({},u),{},{subject:["<ul>"+S()(n.subject).map(function(e){return"<li>".concat(e,"</li>")}).join("")+"</ul>"]})),o&&S()(o).length?u=ve(ve({},u),{},{references:["<ul>"+S()(o).map(function(e){return'<li><a target="_blank" href="'.concat(e.url,'">').concat(e.params&&e.params.name||e.url,"</a></li>")}).join("")+"</ul>"]}):delete u.references,n&&n.temporal){var a=m()(n.temporal)?n.temporal.split("; "):[];if(a.length){var l=a.filter(function(e){return-1!==e.indexOf("scheme=")}).map(function(e){var t=e.indexOf("=");return e.substr(t+1,e.length-1)});l=l.length?l[0]:"W3C-DTF";var c=a.filter(function(e){return-1!==e.indexOf("start=")||-1!==e.indexOf("end=")}).map(function(e){var t=e.indexOf("="),n=e.substr(0,t),o=e.substr(t+1,e.length-1),i=e.length-t-1<=10;return O()(["start","end"],n)&&"W3C-DTF"===l&&!i?(0,ce.kA)(r,"catalog.".concat(n))+new Date(o).toLocaleString():O()(["start","end"],n)?(0,ce.kA)(r,"catalog.".concat(n))+o:""});u=ve(ve({},u),{},{temporal:["<ul>"+c.map(function(e){return"<li>".concat(e,"</li>")}).join("")+"</ul>"]})}}var s,f=ve(ve({},(0,k.VV)({references:o})),(0,k.ZU)({references:o}));if(n&&n.format===pe.c)s=function(e,t){var r=e.dc,n=S()(null==r?void 0:r.URI),o=null==n?void 0:n.find(function(e){var t;return null==e||null===(t=e.value)||void 0===t?void 0:t.endsWith(".json")}),i=(null==o?void 0:o.value)||"";return{serviceType:"3dtiles",isValid:!0,description:r&&m()(r.abstract)&&r.abstract||"",title:r&&m()(r.title)&&r.title||"",identifier:r&&m()(r.identifier)&&r.identifier||"",url:i,thumbnail:null,bbox:he(e),format:r&&r.format||"",references:[],catalogType:"csw",metadata:t}}(e,u);else if(n&&n.format===de.A2);else{var p=Object.keys(f).filter(function(e){return!Se.includes(e)}).find(function(e){return f[e]}),d=p&&"esri"!==p?f[p]:void 0;s=ve({serviceType:"csw",layerType:p,isValid:!!p,boundingBox:e.boundingBox,description:n&&m()(n.abstract)&&n.abstract||"",layerOptions:t&&t.layerOptions||{},identifier:n&&m()(n.identifier)&&n.identifier||"",references:o,thumbnail:Oe(n,t),title:n&&m()(n.title)&&n.title||"",tags:n&&n.tags||"",metadata:u,capabilities:e.capabilities,ogcReferences:d},function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Se.some(function(e){return!E()(r[e])})?{additionalOGCServices:ve({},Se.map(function(n){var o,i=null!==(o=r[n])&&void 0!==o?o:{},u=i.url,a=i.params;return me({},n,{url:u,name:(void 0===a?{}:a).name,references:t,ogcReferences:i,fetchCapabilities:!0,boundingBox:he(e)})}).flat().reduce(function(e,t){return ve(ve({},t),e)},{}))}:null}(e,o,f))}return s}):null},Ee=function(e,t,r){var n=function(e,t){switch(e.layerType){case"wms":return le(e,t);case"esri":return function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).layerBaseConfig,r=void 0===t?{}:t;if(!e||!e.references)return null;var n=(0,k.ZU)(e).esri;return ve({type:n.type,url:n.url,visibility:!0,dimensions:e.dimensions||[],name:n.params&&n.params.name,bbox:{crs:e.boundingBox.crs,bounds:{minx:e.boundingBox.extent[0],miny:e.boundingBox.extent[1],maxx:e.boundingBox.extent[2],maxy:e.boundingBox.extent[3]}}},r)}(e,t);default:return null}}(e,t);return r?Promise.resolve(n):n},Te=r(223805),Ce=r.n(Te),Ae=r(724188),De=r(636422);function Me(e){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Me(e)}function Ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(r),!0).forEach(function(t){Ge(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ie(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ge(e,t,r){return(t=function(e){var t=function(e){if("object"!=Me(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Me(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Me(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ue=function(e){return Ce()(e)&&e._||e},_e=function(e,t){return e.filter(function(r){return(0,Ae.Ec)(t,r,e,t,null)})},Be=De.Ay.textSearch,Fe=H,Ne=J,ke=Y({parseUrl:De.Ay.parseUrl}),Ve=function(e,t){return e&&e.records?e.records.map(function(e){var r=S()((0,Ae.Gd)(e)||t&&t.url);1===r.length&&(r=r[0]);var n=(0,Ae.E_)(e),o=S()((null==e?void 0:e.TileMatrixSetLink)||[]).reduce(function(t,r){var n,o=S()((null==e?void 0:e.TileMatrixSet)||[]).find(function(e){return e["ows:Identifier"]===r.TileMatrixSet}),i=o&&(0,se.getEPSGCode)(o["ows:SupportedCRS"]),u=null!=r&&r.TileMatrixSetLimits?S()((null==r||null===(n=r.TileMatrixSetLimits)||void 0===n?void 0:n.TileMatrixLimits)||[]).map(function(e){return{identifier:e.TileMatrix,ranges:{cols:{min:e.MinTileCol,max:e.MaxTileCol},rows:{min:e.MinTileRow,max:e.MaxTileRow}}}}):null;return Le(Le({},t),{},Ge({},o["ows:Identifier"],Le(Le({crs:i},u&&{limits:u}),{},{tileMatrixSet:o})))},{}),i=(0,Ae.iT)({availableTileMatrixSets:o}).matrixIds,u=function(e){var t=e["ows:WGS84BoundingBox"];return t||(t={"ows:LowerCorner":"-180.0 -90.0","ows:UpperCorner":"180.0 90.0"}),t}(e),a=[{type:"OGC:WMTS",url:r,SRS:_e(e.SRS||[],i),params:{name:e["ows:Identifier"]}}],l=(0,k.VV)({references:a}).wmts;return{serviceType:"wmts",isValid:!!l,title:Ue(e["ows:Title"]||e["ows:Identifier"]),description:Ue(e["ows:Abstract"]||e["ows:Title"]||e["ows:Identifier"]),identifier:Ue(e["ows:Identifier"]),tags:"",layerOptions:t&&t.layerOptions||{},style:e.style,capabilitiesURL:n,queryable:e.queryable,requestEncoding:e.requestEncoding,availableTileMatrixSets:o,format:e.format,formats:e.formats,TileMatrixSetLink:S()(e.TileMatrixSetLink),boundingBox:{extent:[u["ows:LowerCorner"].split(" ")[0],u["ows:LowerCorner"].split(" ")[1],u["ows:UpperCorner"].split(" ")[0],u["ows:UpperCorner"].split(" ")[1]],crs:"EPSG:4326"},references:a,ogcReferences:l}}):null},We=function(e,t,r){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.removeParams,n=void 0===r?[]:r,o=t.service,i=t.catalogURL,u=t.url,a=t.layerBaseConfig;if(!e||!e.references)return null;var l,c,s=(0,k.VV)(e).wmts,f=function(e){return(0,k.Ln)((0,_.hG)(e),["request","layer","layers","service","version"].concat(n))},p=(0,k.mT)(s.url);if(p&&C()(p))l=p.map(function(e){return f(e)}).map(function(e){return e.url}),c=p.map(function(e){return f(e)}).map(function(e){return e.params}).reduce(function(e,t){return Le(Le({},e),t)},{});else{var d=f(p||i);l=d.url,c=d.params}var b,y=(b=u||l,C()(b)&&1===b.length?b[0]:b),v=o||{},m=v.format,g=v.localizedLayerStyles,O=(0,k.Zh)(s.SRS),h=e.format||m,S=e.formats?e.formats.find(function(e){return e===h})||e.format:h;return Le(Le(Le({type:"wmts",requestEncoding:e.requestEncoding,style:e.style,format:S,url:y,capabilitiesURL:e.capabilitiesURL,queryable:e.queryable,visibility:!0,dimensions:e.dimensions||[],name:s.params&&s.params.name,title:e.title||s.params&&s.params.name,description:e.description||"",availableTileMatrixSets:e.availableTileMatrixSets||[],credits:!(0,_.Uh)("noCreditsFromCatalog")&&e.credits,bbox:{crs:e.boundingBox.crs,bounds:{minx:e.boundingBox.extent[0],miny:e.boundingBox.extent[1],maxx:e.boundingBox.extent[2],maxy:e.boundingBox.extent[3]}},links:(0,k.Jx)(e),params:c,allowedSRS:O,catalogURL:i},a),e.layerOptions),{},{localizedLayerStyles:I()(g)?void 0:g})}(e,t);return r?Promise.resolve(n):n},Ke=r(858156),qe=r.n(Ke),ze=r(738805),$e=r.n(ze),Xe=r(584153),Ze=r(87405);function He(e){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},He(e)}function Je(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ye(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(r),!0).forEach(function(t){Qe(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Je(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Qe(e,t,r){return(t=function(e){var t=function(e){if("object"!=He(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=He(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==He(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var et={},tt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=S()(qe()(e,"TileMapService.TileMaps.TileMap",[])),u=o.projection,a=qe()(o,"options.service.allSRS"),l=i.map(function(t){var r=t.$,n=void 0===r?{}:r;return Ye(Ye({},n),{},{href:(0,Xe.o_)(n.href),identifier:(0,Xe.o_)(n.href),format:(0,Ze.h)(n.href),tmsUrl:(0,Xe.o_)(e.url)})}).filter(function(e){var t=e.srs;return!(u&&!a)||function(e,t){return e===t||"EPSG:3857"===e&&"EPSG:900913"===t||"EPSG:900913"===e&&"EPSG:3857"===t}(t,u)}).filter(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.title,r=void 0===t?"":t,o=e.srs,i=void 0===o?"":o;return!n||-1!==r.toLowerCase().indexOf(n.toLowerCase())||-1!==i.toLowerCase().indexOf(n.toLowerCase())});return{numberOfRecordsMatched:l.length,numberOfRecordsReturned:Math.min(r,l.length),nextRecord:t+Math.min(r,l.length)+1,records:l.filter(function(e,n){return n>=t-1&&n<t-1+r})}},rt=function(e){return e},nt=function(e,t,r,n,o){var i,u=et[e];if(u&&(new Date).getTime()<u.timestamp+1e3*(_.Ay.getConfigProp("cacheExpire")||60))return new Promise(function(e){e(tt(u.data,t,r,n,o))});var a=null==o||null===(i=o.options)||void 0===i||null===(i=i.service)||void 0===i?void 0:i.protectedId,l=(0,Xe.WZ)(a);return W.A.get(e,{headers:l}).then(function(i){var u;return $e().parseString(i.data,{explicitArray:!1},function(t,r){u=Ye(Ye({},r),{},{url:e})}),et[e]={timestamp:(new Date).getTime(),data:u},tt(u,t,r,n,o)})},ot=r(839199),it=r(79738);function ut(e){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ut(e)}function at(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function lt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?at(Object(r),!0).forEach(function(t){ct(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):at(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ct(e,t,r){return(t=function(e){var t=function(e){if("object"!=ut(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ut(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var st="custom",ft=function(e,t,r,n,o){var i,u,a,l=qe()(o,"options.service"),c=[];if(l.provider&&l.provider!==st){var s=(i=l.provider,Object.keys(null!==(u=null===ot.A||void 0===ot.A||null===(a=ot.A[i])||void 0===a?void 0:a.variants)&&void 0!==u?u:{}));0===s.length?c.push({provider:"".concat(l.provider),title:"".concat(l.provider)}):c=s.map(function(e){return{provider:"".concat(l.provider,".").concat(e)}})}else l.url&&(c=[lt(lt({},l),{},{title:l.title,type:"tileprovider",url:l.url,attribution:l.attribution,options:l.options||{},provider:st})]);return new Promise(function(e){e(function(e,t,r,n){var o=e.filter(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).title;return!n||-1!==(void 0===e?"":e).toLowerCase().indexOf(n.toLowerCase())}),i=o.filter(function(e,n){return n>=t-1&&n<t-1+r});return{numberOfRecordsMatched:o.length,numberOfRecordsReturned:i.length,nextRecord:t+Math.min(r,o.length)+1,records:i}}(c,t,r,n))})};function pt(e){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pt(e)}function dt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function bt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(r),!0).forEach(function(t){yt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dt(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function yt(e,t,r){return(t=function(e){var t=function(e){if("object"!=pt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==pt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var vt=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=(o.options||{}).service;return"tms"===(void 0===i?{}:i).provider&&nt(e,t,r,n,o),ft(0,t,r,n,o)},mt=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=(o.options||{}).service;return"tms"===(void 0===i?{}:i).provider?nt(e,t,r,n,o):ft(0,t,r,n,o)},gt=function(e){return"tms"===e.provider?J(e):function(e){var t,r=e.provider&&"custom"!==e.provider?!!e.provider:(t=e.url,(0,it.qk)(t));if(e.title&&r)return G.Observable.of(e);throw new Error("catalog.config.notValidURLTemplate")}(e)},Ot=function(e){return"tms"===e.provider?Y({parseUrl:rt})(e):function(e){return G.Observable.of(e)}(e)},ht=function(e,t){if(e&&e.records){if(t.service&&"tms"===t.service.provider){var r=[{type:"OGC:TMS",version:"1.0.0",url:t.url}],n=(0,k.VV)({references:r}).tms;return e.records.map(function(e){return{serviceType:"tms",layerType:"tms",isValid:!!n,title:e.title,tileMapUrl:e.href,description:"".concat(e.srs).concat(e.format?", "+e.format:""),tmsUrl:t.tmsUrl,references:r,ogcReferences:n}})}return e.records.map(function(e){return{serviceType:"tms",layerType:"tileprovider",isValid:!!e.provider,title:e.title||e.provider,url:e.url,attribution:e.attribution,options:e.options,provider:e.provider,references:[]}})}return null},St=function(e,t){var r=e.tileMapUrl,n=t.tileMap,o=t.service,i=(n||{}).TileMap,u=void 0===i?{}:i,a=(o||{}).forceDefaultTileGrid,l=u.Title,c=u.Abstract,s=u.SRS,f=u.BoundingBox,p=void 0===f?{}:f,d=u.Origin,b=u.TileFormat,y=void 0===b?{}:b,v=u.TileSets,m=u.$,g=m.version,O=m.tilemapservice,h=qe()(p,"$",{}),w=h.minx,j=h.miny,P=h.maxx,x=h.maxy,R=qe()(d,"$"),E=R.x,T=R.y,C=qe()(y,"$",{}),A=C.width,D=C.height,M=C["mime-type"],I=C.extension,L=[parseFloat(A),parseFloat(D,10)],G=S()(qe()(v,"TileSet",[]).map(function(e){return e.$})).map(function(e){var t=e.href,r=e.order,n=e["units-per-pixel"];return{href:(0,Xe.o_)(t),order:parseFloat(r),resolution:parseFloat(n)}}),U=qe()(v,"profile");return{title:l,visibility:!0,hideErrors:!0,name:l,allowedSRS:yt({},s,!0),description:c,srs:s,version:g,tileMapService:O?(0,Xe.o_)(O):void 0,type:"tms",profile:U,tileMapUrl:r,forceDefaultTileGrid:a,bbox:p&&{crs:s,bounds:{minx:parseFloat(w),miny:parseFloat(j),maxx:parseFloat(P),maxy:parseFloat(x)}},tileSets:G,origin:{x:parseFloat(E),y:parseFloat(T)},format:M,tileSize:L,extension:I}},wt=function(e){return{type:"tileprovider",visibility:!0,url:e.url,title:e.title,attribution:e.attribution,options:e.options,provider:e.provider,name:e.provider}},jt=function(e,t,r){return r?"tms"===e.layerType?function(e,t){var r,n=null==t||null===(r=t.service)||void 0===r?void 0:r.protectedId,o=(0,Xe.WZ)(n);return W.A.get(e,{headers:o}).then(function(e){return new Promise(function(t){$e().parseString(e.data,{explicitArray:!1},function(e,r){return t(r)})})})}(e.tileMapUrl,t).then(function(r){return St(e,bt(bt({},t),{},{tileMap:r}))}):Promise.resolve(wt(e)):function(e,t){return"tms"===e.layerType?St(e,t):"tileprovider"===e.layerType?wt(e,t):null}(e,t)},Pt=r(181817);function xt(e){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(e)}function Rt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Et(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(r),!0).forEach(function(t){Tt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rt(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Tt(e,t,r){return(t=function(e){var t=function(e){if("object"!=xt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=xt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==xt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ct(e,t){if(e){if("string"==typeof e)return At(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?At(e,t):void 0}}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Dt=function(e,t){var r,n=t.service,o=(n||{}).layerOptions;return null!=n&&n.protectedId&&(r={sourceId:null==n?void 0:n.protectedId,type:"basic"}),Et(Et({type:e.type||"wfs",search:{url:e.url,type:"wfs"},security:r,url:e.url,queryable:e.queryable,visibility:!0,name:e.name,title:e.title||e.name,description:e.description||"",bbox:e.boundingBox,links:(0,k.Jx)(e)},e.layerOptions),o)},Mt=function(e,t,r,n,o){return(0,Pt.Fu)(e,o).then(function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=S()(qe()(e,'["wfs:WFS_Capabilities"].FeatureTypeList.FeatureType',[])).map(function(t){var r,n=t.Name,o=t.Title,i=t.Abstract,u=t.DefaultSRS,a=t.OtherSRS,l=void 0===a?[]:a,c=t["ows:WGS84BoundingBox"],s=c["ows:LowerCorner"].split(" "),f=c["ows:UpperCorner"].split(" "),p={minx:parseFloat(s[0]),miny:parseFloat(s[1]),maxx:parseFloat(f[0]),maxy:parseFloat(f[1])};return{featureType:t,type:"wfs",url:(0,Xe.o_)(e.url),name:n,title:o,description:i,SRS:[u].concat((r=l,function(e){if(Array.isArray(e))return At(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||Ct(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),defaultSRS:u,boundingBox:{bounds:p,crs:"EPSG:4326"}}}).filter(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.title,r=void 0===t?"":t,o=e.name,i=void 0===o?"":o,u=e.description;return!n||-1!==r.toLowerCase().indexOf(n.toLowerCase())||-1!==i.toLowerCase().indexOf(n.toLowerCase())||-1!==u.toLowerCase().indexOf(n.toLowerCase())}),i=o.filter(function(e,n){return n>=t-1&&n<t-1+r});return{numberOfRecordsMatched:o.length,numberOfRecordsReturned:Math.min(r,i.length),nextRecord:t+Math.min(r,o.length)+1,records:i}}(e,t,r,n,o)})},It=H,Lt=J,Gt=Y({parseUrl:Pt.E_}),Ut=function(e,t,r,n,o){return Mt(e,t,r,n,o)},_t=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).records;return e?e.map(function(e){var t=[{type:"OGC:WFS-1.1.0-http-get-capabilities",url:e.url},{type:"OGC:WFS-1.1.0-http-get-feature",url:e.url}],r=(0,k.VV)({references:t}).wfs;return Et(Et({},e),{},{serviceType:"wfs",isValid:!!r,references:t,ogcReferences:r})}):null},Bt=function(e,t,r){if(t.fetchCapabilities&&r)return function(e,t){var r=Dt(e,t);return Mt(e.url,1,1,e.name).then(function(e){var n,o,i,u=(o=null!==(n=null==e?void 0:e.records)&&void 0!==n?n:[],i=1,function(e){if(Array.isArray(e))return e}(o)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,u,a=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(o,i)||Ct(o,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return E()(u)?r:Dt(u,t)}).catch(function(){return r})}(e,t);var n=Dt(e,t);return r?Promise.resolve(n):n};function Ft(e){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ft(e)}function Nt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function kt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(r),!0).forEach(function(t){Vt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nt(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Vt(e,t,r){return(t=function(e){var t=function(e){if("object"!=Ft(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ft(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Wt=H,Kt=function(e){return G.Observable.of(e)},qt=function(e){return G.Observable.of(e)},zt=function(e,t,r,n){return W.A.get(e).then(function(t){var r=t.data,o=[kt({title:n,url:e,type:"geojson",name:n},r)];return{numberOfRecordsMatched:o.length,numberOfRecordsReturned:o.length,records:o}})},$t=function(e){return e.records},Xt=function(e,t,r){var n=e?(0,B.mb)(e):null;return r?Promise.resolve(n):n};function Zt(e){return Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zt(e)}function Ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Jt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(r),!0).forEach(function(t){Yt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ht(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Yt(e,t,r){return(t=function(e){var t=function(e){if("object"!=Zt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Zt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Zt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Qt=r(234169).A.textSearch,er=H,tr=J,rr=Y({parseUrl:function(e){return e}}),nr=function(e){return e&&e.records?e.records.map(function(e){return{serviceType:"backgrounds",isValid:!!e,description:e.title,title:e.title,identifier:e.name,thumbnail:e.thumbURL,references:[],background:e}}):null},or=function(e,t,r){var n=function(e){return Jt(Jt({},null==e?void 0:e.background),{},{id:null==e?void 0:e.background.name,visibility:!1})}(e);return r?Promise.resolve(n):n},ir=["tileset"];function ur(e){return ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ur(e)}function ar(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function lr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(r),!0).forEach(function(t){cr(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ar(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function cr(e,t,r){return(t=function(e){var t=function(e){if("object"!=ur(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ur(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ur(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sr(e){var t=e.split("/");return t[t.length-2]}var fr,pr=H,dr=function(e){return G.Observable.of(e)},br=function(e,t,r,n,o){return function(e,t,r,n,o){return(0,pe.F)(e,o).then(function(t){var r,n=t.tileset,i=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(t,ir),u=[lr({title:(null==o||null===(r=o.options)||void 0===r||null===(r=r.service)||void 0===r?void 0:r.title)||sr(e),url:e,type:"3dtiles",tileset:n},i)];return{numberOfRecordsMatched:u.length,numberOfRecordsReturned:u.length,records:u}})}(e,0,0,0,o)},yr=function(e){return null!=e&&e.records?e.records.map(function(e){var t=e.version,r=e.bbox,n=e.format,o=e.properties,i=(e.url||"").split("?")[0];return lr(lr(lr(lr({serviceType:"3dtiles",isValid:!0,description:"v. ".concat(t),title:e.title,identifier:i,url:e.url,thumbnail:null},r&&{bbox:r}),n&&{format:n}),o&&{properties:o}),{},{references:[]})}):null},vr=function(e,t,r){var n=function(e){if(!e)return null;var t=e.bbox,r=e.format,n=e.properties;return lr(lr(lr({type:"3dtiles",url:e.url,title:e.title,visibility:!0},t&&{bbox:t}),r&&{format:r}),n&&{properties:n})}(e);return r?Promise.resolve(n):n},mr=function(e){if(e.title&&function(e){if((0,it.Gz)(e)){var t=e.split(/\./g);return"json"===(t[t.length-1]||"").split(/\?/g)[0]}return!1}(e.url))return G.Observable.of(e);throw new Error("catalog.config.notValidURLTemplate")},gr=r(594336),Or=r(294312);function hr(e){return hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hr(e)}function Sr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function wr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Sr(Object(r),!0).forEach(function(t){jr(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function jr(e,t,r){return(t=function(e){var t=function(e){if("object"!=hr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=hr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==hr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Pr=function(e){return e(new DOMException("Aborted","AbortError"))};const xr=fr={getProjectionFromGeoKeys:function(e){var t=e.geoKeys;return t?t.ProjectedCSTypeGeoKey&&32767!==t.ProjectedCSTypeGeoKey?"EPSG:"+t.ProjectedCSTypeGeoKey:t.GeographicTypeGeoKey&&32767!==t.GeographicTypeGeoKey?"EPSG:"+t.GeographicTypeGeoKey:null:null},fromUrl:function(e,t){return null!=t&&t.aborted?Pr(Promise.reject):new Promise(function(r,n){return null==t||t.addEventListener("abort",function(){return Pr(n)}),(0,gr.fromUrl)(e).then(function(e){return e.getImage()}).then(function(e){return r(e)}).catch(function(){return Pr(n)})})},getLayerConfig:function(e){var t=e.url,r=e.layer,n=e.controller;return fr.fromUrl(t,null==n?void 0:n.signal).then(function(e){var t,n,o,i=fr.getProjectionFromGeoKeys(e),u=e.getBoundingBox(),a=(0,Or.dv)(i),l=e.getSamplesPerPixel(),c=null!==(t=e.getGDALMetadata())&&void 0!==t?t:{},s=c.STATISTICS_MINIMUM,f=c.STATISTICS_MAXIMUM,p=null!==(n=e.getGDALNoData())&&void 0!==n?n:0;return wr(wr({},r),{},{sources:null==r||null===(o=r.sources)||void 0===o?void 0:o.map(function(e){var t,r;return wr(wr({},e),{},{min:null!==(t=e.min)&&void 0!==t?t:s,max:null!==(r=e.max)&&void 0!==r?r:f,nodata:p})}),sourceMetadata:{crs:i,extent:u,width:e.getWidth(),height:e.getHeight(),tileWidth:e.getTileWidth(),tileHeight:e.getTileHeight(),origin:e.getOrigin(),resolution:e.getResolution(),samples:l,fileDirectory:{PhotometricInterpretation:qe()(e,"fileDirectory.PhotometricInterpretation")}}},!E()(u)&&!E()(i)&&{bbox:wr({crs:i},a&&{bounds:{minx:u[0],miny:u[1],maxx:u[2],maxy:u[3]}})})}).catch(function(){return wr({},r)})}};function Rr(e){return Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rr(e)}function Er(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Tr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Cr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(r),!0).forEach(function(t){Ar(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ar(e,t,r){return(t=function(e){var t=function(e){if("object"!=Rr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Rr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Rr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Dr={},Mr=function(e,t,r,n){var o,i,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=qe()(u,"options.service"),l=qe()(u,"options.controller"),c=[];return a.records&&(c=null===(o=a.records)||void 0===o?void 0:o.map(function(e){var t,r,n,o=e.url,i=Cr(Cr({},e),{},{title:e.title,type:null!==(t=e.type)&&void 0!==t?t:k.N$,sources:null!==(r=e.sources)&&void 0!==r?r:[{url:o}],options:null!==(n=e.options)&&void 0!==n?n:a.options||{}}),c=qe()(u,"options.save",!1),s=Dr[o];return s&&(new Date).getTime()<s.timestamp+1e3*(_.Ay.getConfigProp("cacheExpire")||60)?Cr({},s.data):(I()(a.fetchMetadata)||a.fetchMetadata)&&c?xr.getLayerConfig({url:o,controller:l,layer:i}).then(function(e){return Dr[o]={timestamp:(new Date).getTime(),data:Cr({},e)},e}).catch(function(){return Cr({},i)}):Promise.resolve(i)})),Promise.all((i=c,function(e){if(Array.isArray(e))return Er(e)}(i)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||function(e,t){if(e){if("string"==typeof e)return Er(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Er(e,t):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).then(function(o){if(!o.length){var i=Cr(Cr({},a),{},{title:n,identifier:e,type:k.N$,sources:[{url:e}],options:a.options||{}});return xr.getLayerConfig({url:e,layer:i,controller:l}).then(function(e){return{numberOfRecordsMatched:1,numberOfRecordsReturned:1,records:[e]}}).catch(function(){return Cr({},i)})}return function(e,t,r,n){var o=e.filter(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).title;return!n||-1!==(void 0===e?"":e).toLowerCase().indexOf(n.toLowerCase())}),i=o.filter(function(e,n){return n>=t-1&&n<t-1+r});return{numberOfRecordsMatched:o.length,numberOfRecordsReturned:i.length,nextRecord:t+Math.min(r,o.length)+1,records:i}}(o,t,r,n)})},Ir=function(e,t,r,n){return Mr(e,t,r,n,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{})},Lr=function(e){return function(e){var t,r=null===(t=e.records)||void 0===t?void 0:t.every(function(e){return(0,it.Gz)(null==e?void 0:e.url)});if(e.title&&r)return G.Observable.of(e);throw new Error("catalog.config.notValidURLTemplate")}(e)},Gr=function(e){return G.Observable.of(e)},Ur=function(e){return e&&e.records?e.records.map(function(e){var t;return Cr(Cr({},e),{},{serviceType:k.N$,isValid:null===(t=e.sources)||void 0===t?void 0:t.every(function(e){return(0,it.Gz)(e.url)}),title:e.title||e.provider,sources:e.sources,options:e.options,references:[]})}):null},_r=function(e){return Cr(Cr({},e),{},{type:k.N$,visibility:!0,sources:e.sources,title:e.title,options:e.options,name:e.title})},Br=function(e,t){return _r(e,t)},Fr=function(e,t,r){return r?Promise.resolve(Br(e,t)):Br(e,t)};function Nr(e){return Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nr(e)}var kr=["scale","longitude","latitude","height","heading"];function Vr(){return Vr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vr.apply(null,arguments)}function Wr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Kr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Wr(Object(r),!0).forEach(function(t){qr(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function qr(e,t,r){return(t=function(e){var t=function(e){if("object"!=Nr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Nr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Nr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zr(e){var t=e.split("/");return t[t.length-2]}var $r=H,Xr=function(e){return G.Observable.of(e)},Zr=function(e,t,r,n,o){return function(e,t,r,n,o){return(0,de.Fu)(e).then(function(t){var r,n=Vr({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(t),t)),i=[Kr({title:(null==o||null===(r=o.options)||void 0===r||null===(r=r.service)||void 0===r?void 0:r.title)||zr(e),url:e,type:"model"},n)];return{numberOfRecordsMatched:i.length,numberOfRecordsReturned:i.length,records:i}})}(e,0,0,0,o)},Hr=function(e){return null!=e&&e.records?e.records.map(function(e){var t=e.version,r=e.bbox,n=e.format,o=e.properties,i=(e.url||"").split("?")[0];return Kr(Kr(Kr(Kr({serviceType:"model",isValid:!0,description:"v. ".concat(t),title:e.title,identifier:i,url:e.url,thumbnail:null},r&&{bbox:r}),n&&{format:n}),o&&{properties:o}),{},{references:[]})}):null},Jr=function(e,t,r){var n=function(e){if(!e)return null;var t=e.bbox,r=e.format,n=e.properties,o=n.scale,i=n.longitude,u=n.latitude,a=n.height,l=n.heading,c=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(n,kr);return Kr(Kr({type:"model",url:e.url,title:e.title,features:[{type:"Feature",id:"model-origin",properties:Kr(Kr({},c),{},{heading:l||0,pitch:0,roll:0,scale:o||1}),geometry:{type:"Point",coordinates:[i||0,u||0,a||0]}}],visibility:!0},t&&{bbox:t}),r&&{format:r})}(e);return r?Promise.resolve(n):n},Yr=function(e){if(e.title&&function(e){if((0,it.Gz)(e)){var t=e.split(/\./g);return"ifc"===(t[t.length-1]||"").split(/\?/g)[0]}return!1}(e.url))return G.Observable.of(e);throw new Error("catalog.config.notValidURLTemplate")},Qr=r(557238);function en(e){return en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},en(e)}function tn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function rn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tn(Object(r),!0).forEach(function(t){nn(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tn(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function nn(e,t,r){return(t=function(e){var t=function(e){if("object"!=en(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=en(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==en(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var on=H,un=function(e){return G.Observable.of(e)},an=function(e,t,r,n,o){return function(e,t,r,n,o){return(0,Qr.Fu)(e,t,r,n,o)}(e,t,r,n,o)},ln=function(e){return null!=e&&e.records?e.records.map(function(e){var t,r="".concat(void 0!==e.id?"Layer:".concat(e.id):"Group",":").concat(e.name);return{serviceType:"arcgis",isValid:!0,description:e.description,title:e.name,identifier:r,url:e.url,thumbnail:null!==(t=e.thumbnail)&&void 0!==t?t:null,references:[],name:e.id,format:e.format,layers:e.layers,queryable:e.queryable,bbox:e.bbox}}):null},cn=function(e,t,r){var n=function(e,t){var r=t.layerBaseConfig;return e?rn(rn(rn({type:"arcgis",url:e.url,title:e.title,format:e.format,queryable:e.queryable,visibility:!0},void 0!==e.name&&{name:"".concat(e.name)}),e.bbox&&{bbox:e.bbox}),{},{options:{layers:e.layers}},r):null}(e,t);return r?Promise.resolve(n):n},sn=function(e){if(e.title&&(t=e.url,(0,it.Gz)(t)&&t.includes("rest/services")))return G.Observable.of(e);var t;throw new Error("catalog.config.notValidURLTemplate")};const fn={csw:o,wfs:a,wms:n,tms:u,wmts:i,geojson:l,backgrounds:c,"3dtiles":s,cog:f,model:p,arcgis:d}},2834:(e,t,r)=>{"use strict";r.d(t,{A:()=>ve});var n=r(45388),o=r(272505),i=r.n(o),u=r(923631),a=r.n(u),l=r(400912),c=r.n(l),s=r(858156),f=r.n(s),p=r(907309),d=r.n(p),b=r(956449),y=r.n(b),v=r(185015),m=r.n(v),g=r(223805),O=r.n(g),h=r(395950),S=r.n(h),w=r(318938),j=r.n(w),P=r(355364),x=r.n(P),R=r(499084),E=r.n(R),T=r(792516),C=r.n(T),A=r(621939),D=r(904059),M=r(883832),I=r(415392),L=r(812366),G=r(509095),U=r(486174),_=r(148936),B=r(286447),F=r(307679),N=r(223856),k=r(375482),V=r(724188),W=r(764932),K=r(779893),q=r(112585),z=r(273494),$=r(725304),X=r(131127),Z=r(6683),H=r(181817),J=r(112206),Y=r(181634),Q=r(621720),ee=r(427572),te=r(142974),re=r(636422),ne=r(557238),oe=["format","url","text","layerOptions","service"],ie=["data"];function ue(e){return function(e){if(Array.isArray(e))return be(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||de(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function le(e){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(e)}function ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(r),!0).forEach(function(t){fe(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function fe(e,t,r){return(t=function(e){var t=function(e){if("object"!=le(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=le(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==le(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,u,a=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(e,t)||de(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,t){if(e){if("string"==typeof e)return be(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?be(e,t):void 0}}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ye=function(e,t){(0,ee.vV)({message:t});var r=pe(E()(null==t?void 0:t.error),1)[0];if(r&&(r=(0,Q.NS)(r)),e){var o=r?C()(r,{length:400}):"catalog.notification.errorServiceUrl";return n.Observable.of((0,M.z3)({title:"notification.warning",message:o,autoDismiss:6,position:"tc"}),(0,A.iN)(!1))}return n.Observable.of((0,A.JQ)(r))};const ve=function(e){return{recordSearchEpic:function(t,r){return t.ofType(A.rO).switchMap(function(t){var o=t.format,i=t.url,u=t.startPosition,a=t.maxRecords,l=t.text,c=t.options,s=f()(c,"isNewService",!1);return n.Observable.defer(function(){return e[o].textSearch(i,u,a,l,se({options:c},(0,U.vl)(r.getState())))}).switchMap(function(e){if(e.error)return ye(s,e);var t=n.Observable.empty();return s&&(t=n.Observable.from([(0,A.eo)(!0),(0,A.Qi)((0,N.Tq)(c,e)),(0,M.kX)({title:"notification.success",message:"catalog.notification.addCatalogService",autoDismiss:6,position:"tc"}),(0,A.iN)(!1)])),t.concat([(0,A.__)({url:i,startPosition:u,maxRecords:a,text:l},e)])}).startWith(s?(0,A.iN)(!0):(0,A.r1)(!0)).catch(function(e){return ye(s,e)})})},addLayersFromCatalogsEpic:function(t,r){return t.ofType(A.Dh).filter(function(e){var t=e.layers,r=e.sources;return y()(t)&&y()(r)&&t.length&&t.length===r.length}).mergeMap(function(t){var o=t.layers,i=t.sources,u=t.options,a=t.startPosition,l=void 0===a?1:a,s=t.maxRecords,p=void 0===s?4:s,d=r.getState(),b=(0,U.pY)(d),v=o.filter(function(e,t){return!(null==b||!b[i[t]])||"object"===le(i[t])}).map(function(t,r){var a,c=i[r],s="object"===le(c)?c:b[c],y=s.type.toLowerCase(),v=s.url,m=o[r],g=f()(u,r,(0,U.od)(d)),h="3dtiles"===y||"geojson"===y||"cog"===y?se(se({},g),{},{title:O()(null==g?void 0:g.title)?se(se({},null==g?void 0:g.title),{},{default:(null==g||null===(a=g.title)||void 0===a?void 0:a.default)||m}):(null==g?void 0:g.title)||m}):g;return n.Observable.defer(function(){return e[y].textSearch(v,l,p,m,se(se(se({},h),s),{},{options:{service:s}})).catch(function(){return{records:[]}})}).map(function(e){return se(se({},e),{},{format:y,url:v,text:m,layerOptions:h,service:s})})});return n.Observable.forkJoin(v).switchMap(function(t){return y()(t)&&t.length?n.Observable.of(t.map(function(t){var r=t.format,o=t.url,i=t.text,u=t.layerOptions,a=t.service,l=ae(t,oe),s=(0,B.TI)(d),f=e[r].getCatalogRecords(l,{layerOptions:u,url:null==a?void 0:a.url,service:a},s)||[],p=c()(f.filter(function(e){return e.identifier||e.name===i})),b=(0,N.VV)(p),y=b.wms,v=b.wmts,m=y||v;if(m){var g=(0,N.Zh)(m.SRS);if(m.SRS.length>0&&!W.default.isAllowedSRS("EPSG:3857",g))return n.Observable.empty()}var O=(0,U.Ns)(d),h=e[r].getLayerFromRecord(p,{service:a,removeParams:O,catalogURL:"csw"===r&&o?o+"?request=GetRecordById&service=CSW&version=2.0.2&elementSetName=full&id="+p.identifier:o,layerBaseConfig:{},map:{projection:(0,X.Bg)(d),resolutions:(0,Z._7)()}});return p?[h,u]:[i]})):n.Observable.empty()})}).mergeMap(function(e){if(e){var t=e.filter(function(e){return m()(e[0])}).join(" "),r=[];t&&(r=[(0,A.Iu)(t)]);var o=e.filter(function(e){return O()(e[0])}).map(function(e){return x()({},e[0],e[1])});return r=[].concat(ue(r),ue(o.map(function(e){return(0,A.VE)(e)}))),n.Observable.from(r)}return n.Observable.empty()}).catch(function(){return n.Observable.empty()})},addLayerAndDescribeEpic:function(e,t){return e.ofType(A.gd).mergeMap(function(e){var r,o=e.layer,i=e.zoomToLayer,u=[],a=t.getState(),l=(0,q.h8)(o);if(u.push((0,D.VE)(se(se({},o),{},{id:l}))),i&&o.bbox&&u.push((0,z.jc)(o.bbox.bounds,o.bbox.crs)),"wms"===o.type)return n.Observable.forkJoin(n.Observable.defer(function(){return(0,k.MS)((0,q.Dn)(o),o.name,o.security)}),null!=o&&o.remoteTileGrids?n.Observable.defer(function(){return(0,re.Q3)((0,V.ez)(o),o.name,o)}).catch(function(){return n.Observable.of(null)}):n.Observable.of(null)).switchMap(function(e){var t=pe(e,2),r=t[0],i=t[1],u=i?(0,te.Pj)(i):{};if(r){var c=d()(r,function(e){return e.name===o.name});if(c&&"WFS"===c.owsType){var s=K.Ay.filterUrlParams(K.Ay.cleanDuplicatedQuestionMarks(c.owsURL),(0,U.Ns)(a));return n.Observable.of((0,D.ju)(l,se({search:{url:s,type:"wfs"}},u)))}return n.Observable.of((0,D.ju)(l,se({},u)))}return n.Observable.empty()}).merge(n.Observable.from(u)).catch(function(e){return n.Observable.of((0,A.Uc)(o,e))});if("wfs"===o.type)return n.Observable.defer(function(){return(0,H.sq)(o.url,o.name)}).switchMap(function(e){var t=((0,J.ud)(e)||"").replace("Multi",""),r=["Point","LineString","Polygon"].includes(t)?t:"GeometryCollection";return n.Observable.of((0,D.ju)(l,{style:(0,Y.d1)({geometryType:r})}))}).merge(n.Observable.from(u)).catch(function(e){return n.Observable.of((0,A.Uc)(o,e))});if("model"===o.type){var c,s=(null==o||null===(c=o.features)||void 0===c||null===(c=c[0])||void 0===c?void 0:c.properties)||{};if(null!=s&&s.projectedCrsNotSupported||null==s||!s.projectedCrs){var f,p=((0,X.mg)(a)||{}).center,b=W.default.reproject(p,p.crs,"EPSG:4326"),y=b.x,v=b.y,m=s.size||[2,2],g=se(se({},o),{},{bbox:{bounds:{minx:(y||0)-m[0]/2/Z.Ig.degrees,miny:(v||0)-m[1]/2/Z.Ig.degrees,maxx:(y||0)+m[0]/2/Z.Ig.degrees,maxy:(v||0)+m[1]/2/Z.Ig.degrees},crs:"EPSG:4326"},features:[se(se({},null==o||null===(f=o.features)||void 0===f?void 0:f[0]),{},{geometry:{type:"Point",coordinates:[y,v,0]}})]});return n.Observable.from([(0,D.VE)(se(se({},g),{},{id:l})),(0,M.$e)({title:"notification.warning",message:null!=s&&s.projectedCrsNotSupported?"layerProperties.modelLayer.warnings.projectedCrsNotSupported":"layerProperties.modelLayer.warnings.projectedCrsNotProvided",autoDismiss:15,values:{modelProjection:null!=s&&s.projectedCrsNotSupported?"(".concat(null==s?void 0:s.projectedCrs,")"):""},position:"tc"})])}}return"arcgis"!==o.type||void 0===o.name&&null!=o&&null!==(r=o.options)&&void 0!==r&&r.layers?n.Observable.from(u):n.Observable.defer(function(){return(0,ne.TN)(o.url,o.name)}).switchMap(function(e){e.data;var t=ae(e,ie),r=se(se({},o),t);return n.Observable.from([(0,D.VE)(se(se({},r),{},{id:l}))].concat(ue(r.bbox?[(0,z.jc)(r.bbox.bounds,r.bbox.crs)]:[])))}).catch(function(e){return n.Observable.of((0,A.Uc)(o,e))})}).catch(function(){return n.Observable.empty()})},newCatalogServiceAdded:function(t,r){return t.ofType(A.w3).switchMap(function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).options,o=r.getState(),i=(0,U.Tl)(o),u=(0,U.ah)(o);return n.Observable.of(i).switchMap(function(t){var r,o,i;return null!==(r=null===(o=e[t.type])||void 0===o||null===(i=o.preprocess)||void 0===i?void 0:i.call(o,t))&&void 0!==r?r:n.Observable.of(t)}).switchMap(function(t){var r,o,i;return null!==(r=null===(o=e[t.type])||void 0===o||null===(i=o.validate)||void 0===i?void 0:i.call(o,t))&&void 0!==r?r:n.Observable.of(t)}).switchMap(function(e){return n.Observable.of((0,A.yZ)({format:e.type,url:e.url,startPosition:1,maxRecords:u,text:"",options:se({service:e,isNewService:!0},t)}))}).catch(function(e){return n.Observable.of((0,M.z3)({exception:e,title:"notification.warning",message:e.notification||"catalog.notification.warningAddCatalogService",autoDismiss:6,position:"tc"}))})})},deleteCatalogServiceEpic:function(e,t){return e.ofType(A.Wr).switchMap(function(){var e=t.getState(),r=(0,U.Kz)(e),o=(0,U.C0)(e),i=o[r]?(0,M.kX)({title:"notification.warning",message:"catalog.notification.serviceDeletedCorrectly",autoDismiss:6,position:"tc"}):(0,M.z3)({title:"notification.warning",message:"catalog.notification.impossibleDeleteService",autoDismiss:6,position:"tc"}),u=(0,A.uM)(r);return o[r]?n.Observable.of(i,u):n.Observable.of(i)})},openCatalogEpic:function(e,t){return e.ofType(I.$4,I.x7).filter(function(e){return"metadataexplorer"===e.control&&(0,U.km)(t.getState())}).switchMap(function(){return n.Observable.of((0,L.gt)(),(0,L.bC)())})},getMetadataRecordById:function(e,t){return e.ofType(A.Pc).switchMap(function(e){var r=e.metadataOptions,o=void 0===r?{}:r,u=t.getState(),l=(0,F.ZT)(u);return n.Observable.defer(function(){return(0,k.Fu)((0,q.wk)(l))}).switchMap(function(e){var t,r=(0,k.eO)(null==e?void 0:e.Capability),u=E()((1===r.length?r[0].MetadataURL:null===(t=d()(r,function(e){return(0,q.qh)(e.Name)===(0,q.qh)(l.name)}))||void 0===t?void 0:t.MetadataURL)||[]).map(function(e){var t,r,n;return se(se({},null==e?void 0:e.$),{},{format:null==e?void 0:e.Format,onlineResource:{type:null==e||null===(t=e.OnlineResource)||void 0===t||null===(t=t.$)||void 0===t?void 0:t["xlink:type"],href:null==e||null===(r=e.OnlineResource)||void 0===r||null===(r=r.$)||void 0===r?void 0:r["xlink:href"],xlink:null==e||null===(n=e.OnlineResource)||void 0===n||null===(n=n.$)||void 0===n?void 0:n["xmlns:xlink"]}})}),c=f()(d()(u,function(e){return m()(e.type)&&("iso19115:2003"===e.type.toLowerCase()||"tc211"===e.type.toLowerCase())&&("application/xml"===e.format||"text/xml"===e.format)}),"onlineResource.href"),s=f()(d()(u,function(e){return m()(e.type)&&("iso19115:2003"===e.type.toLowerCase()||"tc211"===e.type.toLowerCase())&&"text/html"===e.format}),"onlineResource.href"),p=d()(f()(o,"extractors",[]),function(e){var t=e.properties,r=e.layersRegex,n=r?new RegExp(r):null;return O()(t)&&(!r||n.test(l.name))}),b=s?{metadataUrl:s}:{},y=n.Observable.defer(function(){return $.Ay.getRecordById(l.catalogURL)}).switchMap(function(e){return e&&e.error?n.Observable.of((0,M.z3)({title:"notification.warning",message:"toc.layerMetadata.notification.warnigGetMetadataRecordById",autoDismiss:6,position:"tc"}),(0,D.ik)(b,!1)):e&&e.dc?n.Observable.of((0,D.ik)(se(se({},b),e.dc),!1)):n.Observable.empty()}),v=n.Observable.defer(function(){return i().get(c,{headers:{Accept:"application/xml"}})}).pluck("data").map(function(e){return(new DOMParser).parseFromString(e,"text/xml")}).map(function(e){var t=a().useNamespaces(o.xmlNamespaces||{}),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return j()(e).reduce(function(e,o){var i,u=pe(o,2),a=u[0],l=u[1];if(O()(l)&&m()(l.xpath)&&O()(l.properties)&&S()(l.properties).length>0)0===(i=t(l.xpath,n).map(function(e){return r(l.properties,e)})).length&&(i=null);else{var c,s=t(l,n);1===s.length?i=null!==(c=f()(s[0],"nodeValue"))&&void 0!==c?c:f()(s[0],"childNodes[0].nodeValue"):s.length>1&&(i=s.map(function(e){return f()(e,"childNodes[0].nodeValue")}).filter(function(e){return!!e}))}return se(se({},e),i?fe({},a,i):{})},{})};return r(p.properties,e)}).switchMap(function(e){return n.Observable.of((0,D.ik)(se(se({},b),e),!1))});return c&&p?v:l.catalogURL?y:n.Observable.of((0,D.ik)(b,!1))}).startWith((0,D.ik)({},!0)).catch(function(){return n.Observable.of((0,M.z3)({title:"notification.warning",message:"toc.layerMetadata.notification.warnigGetMetadataRecordById",autoDismiss:6,position:"tc"}),(0,D.ik)({},!1))})})},autoSearchEpic:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,r=void 0===t?function(){}:t;return e.ofType(A.jH).debounce(function(){var e=r(),t=(0,U.sq)(e);return n.Observable.timer(t)}).switchMap(function(e){var t=e.text,o=r(),i=(0,U.ah)(o),u=(0,U.ck)(o);return n.Observable.of((0,A.yZ)({format:u.type,url:(0,N.XU)(u),startPosition:1,maxRecords:i,text:t,options:{service:u}}))})},catalogCloseEpic:function(e,t){return e.ofType(A.dP).switchMap(function(){var e,r=t.getState(),o=(0,_.Mn)(r),i=(0,_.XS)(r);return(e=n.Observable).of.apply(e,ue([(0,I.H3)("metadataexplorer","enabled",!1,"group",null),(0,A.pp)("view"),(0,A.pf)()].concat("backgroundSelector"===o?[(0,A.Rt)(i),(0,G.bj)(!0)]:[])))})},updateGroupSelectedMetadataExplorerEpic:function(e,t){return e.ofType(D.S$).filter(function(){return(0,U.km)(t.getState())}).switchMap(function(e){var r=e.nodeType,o=e.id,i=t.getState(),u=0===(0,F.ew)(i).length||"group"!==r?q.Yw:o;return n.Observable.of((0,I.fN)("metadataexplorer","group",u))})}}}},223856:(e,t,r)=>{"use strict";r.d(t,{Jx:()=>h,Ln:()=>m,N$:()=>y,Tq:()=>j,VV:()=>g,XU:()=>S,ZU:()=>O,Zh:()=>v,mT:()=>w});var n=r(400912),o=r.n(n),i=r(956449),u=r.n(i),a=r(858156),l=r.n(a),c=r(764932);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach(function(t){b(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function b(e,t,r){return(t=function(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y="cog",v=function(e){return e.filter(function(e){return c.default.isSRSAllowed(e)}).reduce(function(e,t){return Object.assign(e,b({},t,!0))},{})},m=function(e,t){var r=e.split("?"),n={};return r.length>=2&&r[1]&&r[1].split(/[&;]/g).forEach(function(e){var r=e.split("=");-1===t.indexOf(r[0].toLowerCase())&&(n[r[0]]=r[1])}),{url:r[0],params:n}},g=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).references,t=void 0===e?[]:e;return{wfs:o()(t.filter(function(e){return e.type&&("OGC:WFS"===e.type||e.type.indexOf("OGC:WFS")>-1&&e.type.indexOf("http-get-feature")>-1)})),wms:o()(t.filter(function(e){return e.type&&("OGC:WMS"===e.type||e.type.indexOf("OGC:WMS")>-1&&e.type.indexOf("http-get-map")>-1)})),wmts:o()(t.filter(function(e){return e.type&&("OGC:WMTS"===e.type||e.type.indexOf("OGC:WMTS")>-1&&e.type.indexOf("http-get-map")>-1)})),tms:o()(t.filter(function(e){return e.type&&("OGC:TMS"===e.type||e.type.indexOf("OGC:TMS")>-1)}))}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{references:[]};return{esri:o()(e.references.filter(function(e){return e.type&&("ESRI:SERVER"===e.type||"arcgis"===e.type)}))}},h=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).references,t=void 0===e?[]:e,r=o()(t.filter(function(e){return e.type&&e.type.indexOf("OGC:WMS")>-1&&e.type.indexOf("http-get-capabilities")>-1})),n=o()(t.filter(function(e){return e.type&&e.type.indexOf("OGC:WFS")>-1&&e.type.indexOf("http-get-capabilities")>-1})),i=o()(t.filter(function(e){return e.type&&e.type.indexOf("OGC:WMTS")>-1&&e.type.indexOf("http-get-capabilities")>-1})),u=[];return r&&u.push({type:"WMS_GET_CAPABILITIES",url:r.url,labelId:"catalog.wmsGetCapLink"}),i&&u.push({type:"WMTS_GET_CAPABILITIES",url:i.url,labelId:"catalog.wmtsGetCapLink"}),n&&u.push({type:"WFS_GET_CAPABILITIES",url:n.url,labelId:"catalog.wfsGetCapLink"}),u},S=function(e){var t,r;return"wms"===e.type?[e.url].concat((r=null!==(t=e.domainAliases)&&void 0!==t?t:[],function(e){if(Array.isArray(e))return d(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).join(","):e.url},w=function(e){return e&&!u()(e)&&-1!==e.indexOf(",")?e.split(",").map(function(e){return e.trim()}):e},j=function(e,t){if(l()(e,"service.type")===y){var r=l()(e,"service.records",[]);return p(p({},e.service),{},{records:r.map(function(e){var r;return p(p({},e),null==t||null===(r=t.records)||void 0===r?void 0:r.find(function(t){return t.url===e.url}))})})}return e.service}},87405:(e,t,r)=>{"use strict";r.d(t,{h:()=>i});var n=r(679859),o=r.n(n),i=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("?")[0].split("@");if(e.length>1){var t=e[e.length-1];if(o()(["png","png8","jpeg","vnd.jpeg-png","gif"],t))return t}return null}},928625:()=>{},556504:()=>{},368236:()=>{}}]);