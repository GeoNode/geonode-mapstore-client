(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[2933],{67007:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>S});var r=n(72500),o=n.n(r),i=n(86494),a=n.n(i),c=n(27418),l=n.n(c),s=n(5055),u=n.n(s),p=n(75875),d=n.n(p),f=n(37275),y=n(90183);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g={},h=function(e){var t=(a().isArray(e)&&e||e.split(","))[0],n=o().parse(t,!0);return o().format(l()({},n,{search:null},{query:l()({service:"WMS",version:"1.3.0",request:"GetCapabilities"},n.query)}))},O=function(e){var t=e&&e.Title,n=e.LogoURL&&b(b({},a().get(e,"LogoURL.$")||{}),{},{format:a().get(e,"LogoURL.Format")}),r=a().get(e,'OnlineResource.$["xlink:href"]');return{title:t,logo:n,imageUrl:a().get(e,'LogoURL.OnlineResource.$["xlink:href"]'),link:r}},w=function e(t){return t.Layer?(a().isArray(t.Layer)&&t.Layer||[t.Layer]).reduce((function(t,n){return t.concat(e(n)).concat(n.Layer&&n.Name?[n]:[])}),[]):t.Name&&[t]||[]},E=function(e){return e.Request&&e.Request.GetMap&&e.Request.GetMap.DCPType&&e.Request.GetMap.DCPType.HTTP&&e.Request.GetMap.DCPType.HTTP.Get&&e.Request.GetMap.DCPType.HTTP.Get.OnlineResource&&e.Request.GetMap.DCPType.HTTP.Get.OnlineResource.$||void 0},P=function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,s=(r.WMS_Capabilities||r.WMT_MS_Capabilities||{}).Capability,u=(r.WMS_Capabilities||r.WMT_MS_Capabilities||{}).Service,p=E(s),d=s.Layer&&(null===(e=s.Layer.SRS||s.Layer.CRS)||void 0===e?void 0:e.map((function(e){return e.toUpperCase()})))||[],f=s.Layer&&s.Layer.Attribution&&O(s.Layer.Attribution),y=s.Request&&s.Request.GetMap&&s.Request.GetMap.Format||[],m=w(s),b=a().isArray(m)?m:[m],v=b.filter((function(e){return!c||-1!==e.Name.toLowerCase().indexOf(c.toLowerCase())||e.Title&&-1!==e.Title.toLowerCase().indexOf(c.toLowerCase())||e.Abstract&&-1!==e.Abstract.toLowerCase().indexOf(c.toLowerCase())}));return{numberOfRecordsMatched:v.length,numberOfRecordsReturned:Math.min(i,v.length),nextRecord:o+Math.min(i,v.length)+1,service:u,layerOptions:{version:(null===(t=r.WMS_Capabilities||r.WMT_MS_Capabilities)||void 0===t||null===(n=t.$)||void 0===n?void 0:n.version)||"1.3.0"},records:v.filter((function(e,t){return t>=o-1&&t<o-1+i})).map((function(e){return l()({},e,{formats:y,onlineResource:p,SRS:d,credits:e.Attribution?O(e.Attribution):f})}))}},j=function(e,t,n,r){var o=g[e];return o&&(new Date).getTime()<o.timestamp+1e3*((0,f.u8)("cacheExpire")||60)?new Promise((function(e){e(P(o.data,t,n,r))})):d().get(h(e)).then((function(o){var i;return u().parseString(o.data,{explicitArray:!1},(function(e,t){i=t})),g[e]={timestamp:(new Date).getTime(),data:i},P(i,t,n,r)}))};const S={flatLayers:w,parseUrl:h,getDimensions:function(e){return a().castArray(e.Dimension||e.dimension||[]).map((function(t,n){var r=e.Extent&&a().castArray(e.Extent)[n]||e.extent&&a().castArray(e.extent)[n];return{name:t.$.name,units:t.$.units,unitSymbol:t.$.unitSymbol,default:t.$.default||r&&r.$.default,values:t._&&t._.split(",")||r&&r._&&r._.split(",")}}))},getCapabilities:function(e,t){var r=o().parse(e,!0),i=o().format(l()({},r,{query:l()({service:"WMS",version:"1.1.1",request:"GetCapabilities"},r.query)}));return new Promise((function(e){Promise.all([n.e(9942),n.e(7260)]).then(function(){var r=n(67260).unmarshaller;e(d().get(h(i)).then((function(e){var n;if(t)return u().parseString(e.data,{explicitArray:!1},(function(e,t){n=t})),n;var o=r.unmarshalString(e.data);return o&&o.value})))}.bind(null,n)).catch(n.oe)}))},describeLayer:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o().parse(e,!0),a=o().format(l()({},i,{query:l()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},i.query,r.query||{})}));return new Promise((function(e){Promise.all([n.e(9942),n.e(7260)]).then(function(){var t=n(67260).unmarshaller;e(d().get(h(a)).then((function(e){var n=t.unmarshalString(e.data);return n&&n.value&&n.value.layerDescription&&n.value.layerDescription[0]})))}.bind(null,n)).catch(n.oe)}))},getRecords:j,describeLayers:function(e,t){var n=o().parse(e,!0),r=o().format(l()({},n,{query:l()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},n.query)}));return d().get(h(r)).then((function(e){var t;return u().parseString(e.data,{explicitArray:!1},(function(e,n){t=n&&n.WMS_DescribeLayerResponse&&n.WMS_DescribeLayerResponse.LayerDescription})),(t=Array.isArray(t)?t:[t]).map((function(e){return b(b({},e&&e.$||{}),{},{layerName:e&&e.$&&e.$.name,query:b({},e&&e.query&&e.query.$||{})})}))}))},textSearch:function(e,t,n,r){return j(e,t,n,r)},parseLayerCapabilities:function e(t,n,r){return a().castArray(r||a().get(t,"capability.layer.layer")).reduce((function(r,o){return r||(!o.name&&o.layer?e(t,n,a().castArray(o.layer)):2===n.name.split(":").length&&o.name&&2===o.name.split(":").length?n.name===o.name&&o:o.name&&2===o.name.split(":").length?n.name===o.name.split(":")[1]&&o:2===n.name.split(":").length?n.name.split(":")[1]===o.name&&o:n.name===o.name&&o)}),null)},getBBox:function(e,t){for(var n=e,r=n.EX_GeographicBoundingBox||n.exGeographicBoundingBox||(0,y.getWMSBoundingBox)(n.BoundingBox)||n.LatLonBoundingBox&&n.LatLonBoundingBox.$||n.latLonBoundingBox;!r&&n.Layer&&n.Layer.length;)r=(n=n.Layer[0]).EX_GeographicBoundingBox||n.exGeographicBoundingBox||(0,y.getWMSBoundingBox)(n.BoundingBox)||n.LatLonBoundingBox&&n.LatLonBoundingBox.$||n.latLonBoundingBox;r||(r={westBoundLongitude:-180,southBoundLatitude:-90,eastBoundLongitude:180,northBoundLatitude:90});var o={extent:[r.westBoundLongitude||r.minx,r.southBoundLatitude||r.miny,r.eastBoundLongitude||r.maxx,r.northBoundLatitude||r.maxy],crs:"EPSG:4326"};return t?{crs:o.crs,bounds:{minx:o.extent[0],miny:o.extent[1],maxx:o.extent[2],maxy:o.extent[3]}}:o},reset:function(){Object.keys(g).forEach((function(e){delete g[e]}))}}},7472:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var r=n(27418),o=n.n(r),i=n(45697),a=n.n(i),c=n(24852),l=n.n(c),s=n(85294),u=n.n(s),p=n(72986),d=n.n(p),f=n(5346);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?w(e):t}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(c,e);var t,n,r,i,a=(r=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(r);if(i){var n=E(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return O(this,e)});function c(){var e;v(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return P(w(e=a.call.apply(a,[this].concat(n))),"renderLoading",(function(){return e.props.maskLoading?l().createElement("div",{style:{width:"100%",height:"100%",position:"absolute",overflow:"visible",margin:"auto",verticalAlign:"center",left:"0",background:"rgba(255, 255, 255, 0.5)",zIndex:2}},l().createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -40%)"}},l().createElement(f.Z,{msgId:"loading"}),l().createElement(d(),{spinnerName:"circle",noFadeIn:!0,overrideSpinnerClassName:"spinner"}))):null})),P(w(e),"renderRole",(function(t){return l().Children.toArray(e.props.children).filter((function(e){return e.props.role===t}))})),P(w(e),"hasRole",(function(t){return l().Children.toArray(e.props.children).filter((function(e){return e.props.role===t})).length>0})),P(w(e),"onClickOut",(function(t){e.props.onClickOut&&e.mask===t.target&&e.props.onClickOut(t)})),e}return t=c,(n=[{key:"render",value:function(){var e=this,t=l().createElement("div",{id:this.props.id,style:b({zIndex:3},this.props.style),className:"".concat(this.props.draggable?"modal-dialog-draggable":""," ").concat(this.props.className," modal-dialog-container")},l().createElement("div",{className:this.props.headerClassName+" draggable-header"},this.renderRole("header")),l().createElement("div",{className:this.props.bodyClassName},this.renderLoading(),this.renderRole("body")),this.hasRole("footer")?l().createElement("div",{className:this.props.footerClassName},this.renderRole("footer")):l().createElement("span",null)),n=this.props.draggable?l().createElement(u(),{defaultPosition:this.props.start,bounds:this.props.bounds,handle:".draggable-header, .draggable-header *"},t):t,r=o()({},this.props.style.display?{display:this.props.style.display}:{},this.props.backgroundStyle);return this.props.modal?l().createElement("div",{ref:function(t){e.mask=t},onClick:this.onClickOut,style:r,className:"fade in modal "+this.props.containerClassName,role:"dialog"},n):n}}])&&g(t.prototype,n),c}(l().Component);P(j,"propTypes",{id:a().string.isRequired,style:a().object,backgroundStyle:a().object,className:a().string,maskLoading:a().bool,containerClassName:a().string,headerClassName:a().string,bodyClassName:a().string,footerClassName:a().string,onClickOut:a().func,modal:a().bool,start:a().object,draggable:a().bool,bounds:a().oneOfType([a().string,a().object])}),P(j,"defaultProps",{style:{},backgroundStyle:{background:"rgba(0,0,0,.5)"},start:{x:0,y:150},className:"modal-dialog modal-content",maskLoading:!1,containerClassName:"",headerClassName:"modal-header",bodyClassName:"modal-body",footerClassName:"modal-footer",modal:!1,draggable:!0,bounds:"parent"});const S=j},87320:(e,t,n)=>{"use strict";n.d(t,{Z:()=>O});var r=n(24852),o=n.n(r),i=n(45697),a=n.n(i),c=n(7412),l=n(43129),s=n(30294),u=n(52595);function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=function(e){var t,n,i=e.text,a=e.placement,c=e.bsStyle,l=e.left,d=e.top,f=e.title,y=e.glyph,m=e.id,b=(0,r.useRef)(),v=(t=(0,r.useState)(!1),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}}(t,n)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),g=v[0],h=v[1];return o().createElement("span",{className:"mapstore-info-popover",onMouseLeave:function(){return h(!1)}},o().createElement(s.Glyphicon,{onMouseEnter:function(){h(!0)},ref:function(e){b.current=e},className:"text-".concat(c),glyph:y}),o().createElement(u.Z,{placement:a,show:g,target:function(){return b.current}},o().createElement(s.Popover,{id:m,placement:a,positionLeft:l,positionTop:d,title:f},o().createElement("div",{style:{display:"flex"}},i))))};d.propTypes={id:a().string,title:a().string,text:a().string,glyph:a().string,bsStyle:a().string,placement:a().string,left:a().number,top:a().number,trigger:a().oneOfType([a().array,a().bool])},d.defaultProps={id:"",title:"",text:"",placement:"right",left:200,top:50,glyph:"question-sign",bsStyle:"info"};const f=d;var y=n(15402);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){var t=e.id,n=e.label,r=e.infoFormat,i=e.availableInfoFormat,a=e.popoverMessage,c=e.disabled,u=e.onInfoFormatChange,p=e.selectProps,d=Object.keys(i).reduce((function(e,t){return Object.keys(e).map((function(t){return e[t]})).some((function(e){return e===i[t]}))?e:v(v({},e),{},g({},t,i[t]))}),{}),b=Object.keys(d).map((function(e){return{value:d[e],label:e}})),h=o().createElement(o().Fragment,null,"   ",a&&o().createElement(f,{text:o().createElement(y.Z,{msgId:a})}),o().createElement(l.ZP,m({},p,{id:t,value:r,clearable:!1,disabled:c,options:b,onChange:function(e){return u(null==e?void 0:e.value)}})));return n?o().createElement(s.FormGroup,{bsSize:"small"},o().createElement(s.ControlLabel,null,n),h):h}h.propTypes={id:a().string,label:a().oneOfType([a().func,a().string,a().object]),availableInfoFormat:a().object,infoFormat:a().string,popoverMessage:a().string,onInfoFormatChange:a().func,disabled:a().bool,selectProps:a().object},h.defaultProps={id:"mapstore-feature-format-selector",availableInfoFormat:(0,c.eq)(),infoFormat:(0,c.wR)(),popoverMessage:"",onInfoFormatChange:function(){},selectProps:{}};const O=h},89919:(e,t,n)=>{"use strict";n.d(t,{hP:()=>s});var r=n(86494),o=n(49977),i=n.n(o);function a(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.startWith.apply(e,a(t))},s=function(e,t,n){return function(o){return(n?l(o,(0,r.castArray)(e)).catch(n):l(o,(0,r.castArray)(e))).concat(i().Observable.from((0,r.castArray)(t)))}}},3538:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Fa});var r={};n.r(r),n.d(r,{cleanUpEmptyStoryContainers:()=>fe,closeShareOnGeostoryChangeMode:()=>ve,editMediaForBackgroundEpic:()=>ue,editWebPageComponent:()=>ce,handlePendingGeoStoryChanges:()=>ge,inlineEditorEditMap:()=>be,loadGeostoryEpic:()=>pe,loadStoryOnHistoryPop:()=>we,openMediaEditorForNewMedia:()=>oe,openWebPageComponentCreator:()=>ae,reloadGeoStoryOnLoginLogout:()=>de,saveGeoStoryResource:()=>le,scrollOnLoad:()=>Oe,scrollSideBar:()=>Ee,scrollToContentEpic:()=>se,setFocusOnMapEditing:()=>me,sortContentEpic:()=>ye,urlUpdateOnScroll:()=>he});var o=n(24852),i=n.n(o),a=n(71703),c=n(22222),l=n(75933),s=n.n(l),u=n(22843),p=n(92579),d=n(86638),f=n(31398),y=n(34990),m=n(93848),b=n(49977),v=n(91175),g=n.n(v),h=n(7654),O=n.n(h),w=n(47037),E=n.n(w),P=n(14293),j=n.n(P),S=n(95825),T=n.n(S),C=n(58748),k=n.n(C),I=n(27361),M=n.n(I),x=n(1469),A=n.n(x),N=n(41609),D=n.n(N),R=n(75982),L=n(23570),_=n.n(L),B=n(75875),W=n.n(B),Z=n(91312),F=n(82904),V=n(97395),H=n(63516),z=n(74621),U=n(66113),G=n(7501),q=n(89919),$=n(27693),K=n(82385);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){Y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function ee(e){return function(e){if(Array.isArray(e))return ne(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||te(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){if(e){if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(e,t):void 0}}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var re=function(e,t){return function(n){return n.ofType(m.AQ).switchMap((function(n){var r=n.resource,o=void 0===r?{}:r,i=[],a=e.getState(),c=(0,G.hb)(a),l=(0,G.IQ)(a),s=g()((0,U.jq)(a).filter((function(e){return e.data&&(l!==$.r.GEOSTORY&&e.data.id||e.id)===o.id}))),u=o.id;s?u=s.id:D()(o)?i=[].concat(ee(i),[(0,y.Od)("".concat(t)),(0,m.Cp)()]):(u=o.id||_()(),i=[].concat(ee(i),[(0,y.rp)(u,c,o.data?o.data:o)]));var d=c===p.Tr.MAP?{resourceId:u,type:c,map:void 0}:{resourceId:u,type:c};return i=[].concat(ee(i),[(0,y.Vx)("".concat(t),d,"merge"),(0,m.Cp)()]),b.Observable.from(i)}))}},oe=function(e,t){return e.ofType(y.D7).filter((function(e){var t=e.element,n=void 0===t?{}:t;return n.type===p.bT.MEDIA||(0,p.lt)(n)})).switchMap((function(n){var r=n.path,o=n.element,i="";(0,p.lt)(o)&&"sections"===r&&(i=".contents[0].contents[0]");var a="".concat(r,'[{"id":"').concat(o.id,'"}]').concat(i),c=(0,U.X6)(t.getState());return b.Observable.of((0,m.$Z)("geostory",c)).merge(e.let(re(t,a)),e.ofType(m.B8).switchMap((function(){return b.Observable.of((0,y.Od)(a))})).takeUntil(e.ofType(y.wb))).takeUntil(e.ofType(m.wd))}))},ie=function(e){return function(t){return t.ofType(y.Hb).switchMap((function(t){var n=t.src;return b.Observable.of((0,y.Vx)("".concat(e),{src:n,editURL:!1},"merge"))}))}},ae=function(e){return e.ofType(y.D7).filter((function(e){var t=e.element,n=void 0===t?{}:t;return n.type===p.bT.WEBPAGE&&!1!==n.editURL||(0,p.NC)(n)})).switchMap((function(t){var n=t.path,r=t.element,o="";(0,p.NC)(r)&&"sections"===n&&(o=".contents[0].contents[0]");var i="".concat(n,'[{"id":"').concat(r.id,'"}]').concat(o);return b.Observable.of((0,y.Vx)(i,{editURL:!0},"merge")).merge(e.let(ie(i))).takeUntil(e.ofType(y.cc))}))},ce=function(e){return e.ofType(y.cc).switchMap((function(t){var n=t.path;return b.Observable.of((0,y.Vx)(n,{editURL:!0},"merge")).merge(e.let(ie(n))).takeUntil(e.ofType(y.D7))}))},le=function(e){return e.ofType(y.LE).exhaustMap((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.resource,n=e.delay,r=void 0===n?1e3:n;return(t.id?(0,Z.id)(t):(0,Z.SN)(t)).switchMap((function(e){return b.Observable.of((0,y.GD)(e),(0,y.g5)(p.ZX.SHOW_SAVE,!1),t.id?(0,y.wJ)(e):(0,R.VF)("/geostory/".concat(e))).merge(b.Observable.of((0,V.$Z)({id:"STORY_SAVE_SUCCESS",title:"saveDialog.saveSuccessTitle",message:"saveDialog.saveSuccessMessage"})).delay(t.id?0:r))})).let((0,q.hP)((0,y.YP)(!0,"loading"),(0,y.YP)(!1,"loading"))).catch((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.status,n=e.statusText,r=e.data,o=e.message,i=J(e,["status","statusText","data","message"]);return b.Observable.of((0,y.y6)(t?{status:t,statusText:n,data:r}:o||i),(0,y.YP)(!1,"loading"))}))}))},se=function(e){return e.ofType(y.D7).switchMap((function(e){var t=e.element;return b.Observable.of(t).switchMap((function(){if(document.getElementById(t.id))return(0,p.M1)(t.id,{behavior:"auto",block:"center"}),b.Observable.empty();throw new Error("Item not mounted yet")})).retryWhen((function(e){return e.delay(200).take(10)}))}))},ue=function(e,t){return e.ofType(m.wd).switchMap((function(n){var r=n.path,o=n.owner,i=(0,U.vv)(r)(t.getState()),a=(0,U.Tr)(i)(t.getState());return b.Observable.of((0,G.hb)(t.getState())).filter((function(e){return a&&a.type!==e})).map((function(){return(0,m.y5)(a.type)})).merge(b.Observable.of((0,m.$Z)(o,(0,U.X6)(t.getState())),(0,m.Gh)(i)).merge(e.let(re(t,r)).takeUntil(e.ofType(m.B8,y.D7))))}))},pe=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.XH).switchMap((function(e){var t=e.id;return b.Observable.defer((function(){return t&&O()(parseInt(t,10))?W().get("configs/".concat(t,".json")).then((function(e){var t=e.data,n=t.sections,r=A()(n)&&n.map((function(e){return X(X({},e),{},{id:_()()})}));return{data:r.length?X(X({},t),{},{sections:r}):t,isStatic:!0,canEdit:!0}})):(0,Z.RX)(t)})).do((function(e){if(!e.data)throw Error("Wrong data format");return!0})).switchMap((function(e){var n=e.data,o=e.isStatic,i=void 0!==o&&o,a=J(e,["data","isStatic"]),c=r(),l=(0,z.qg)(c),s=(0,z.jl)(c),u=E()(n)?JSON.parse(n):n;if(!s&&O()(parseInt(t,10)))return b.Observable.of((0,y.Ct)({status:403}));var d=(0,U.eK)(c)===p.nl.EDIT;return b.Observable.from([].concat(ee(i||d?[(0,y.D_)(a&&a.canEdit||l)]:[]),[(0,y.OS)(t),(0,y.K0)(u),(0,y.DF)(a)]))})).let((0,q.hP)((0,y.YP)(!0,"loading"),(0,y.YP)(!1,"loading"),(function(e){var t=(0,p.of)(),n=t+".errors.loading.unknownError";return 403===e.status?(n=t+".errors.loading.pleaseLogin",((0,z.jl)(r())||(0,U.JM)(r()))&&(n=t+".errors.loading.geostoryNotAccessible")):404===e.status?n=t+".errors.loading.geostoryDoesNotExist":j()(e.status)&&(n=e.message),b.Observable.of((0,V.vU)({title:t+".errors.loading.title",message:n}),(0,y.K0)({}),(0,y.Ct)(X(X({},e),{},{messageId:n})))}))).startWith((0,y.K0)({}))}))},de=function(e){return e.ofType(y.XH).switchMap((function(t){var n=t.id;return e.ofType(H.XP,H.Nv).switchMap((function(){return b.Observable.of((0,y.wJ)(n)).delay(500)})).takeUntil(e.ofType(R.nk))}))},fe=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.Dq).switchMap((function(e){var t=e.path,n=(0,p.Ll)(t,(0,U.Kg)(r())),o=T()(n,"contents");if(o>0){var i=n.splice(0,o),a=(0,U.$F)(i.join("."))(r());if(a&&a.contents&&0===a.contents.length)return b.Observable.of((0,y.Od)(i.join(".")))}return b.Observable.empty()}))},ye=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.tP).switchMap((function(e){var t=e.source,n=e.target,o=e.position,i=r(),a=(0,U.$F)(t)(i);return b.Observable.of((0,y.Od)(t),(0,y.IH)(n,o,a))}))},me=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(y.wb).filter((function(e){var t=e.path;return(void 0===t?"":t).endsWith("editMap")})).map((function(e){var t=e.path,n=e.element,o=(0,p.ln)(t,(0,U.Kg)(r())),i=o.flatPath,a=o.path,c=i.pop(),l=i.shift(),s="background"===a[a.length-2],u=s&&"#".concat(l.id," .ms-section-background-container")||"#".concat(c.id);return(0,p.M1)(c.id),(0,y.$A)(n,c,u,s,t.replace(".editMap",""))}))},be=function(e,t){var n=t.getState;return e.ofType(K.nr).filter((function(e){var t=e.owner,n=e.map;return"inlineEditor"===t&&!!n})).switchMap((function(){return e.ofType(K.LE).switchMap((function(t){var r=t.map,o=(0,U.FW)(n()).path;return b.Observable.of((0,y.Vx)("".concat(o,".map"),r),(0,y.Vx)("".concat(o,".editMap"),!1),(0,K.Cp)()).takeUntil(e.ofType(K.B8))}))}))},ve=function(e){return e.ofType(y.vb).switchMap((function(){return b.Observable.of((0,F.Xg)("share","enabled",!1))}))},ge=function(e){return b.Observable.merge(e.ofType(y.XH).switchMap((function(){return e.ofType(y.Zf)}))).switchMap((function(){return e.ofType(y.D7,y.wb,y.Dq,y.mN,y.QK,y.km).take(1).switchMap((function(){return b.Observable.of((0,y.c0)(!0)).concat(e.ofType(y.si,R.nk,H.Nv).take(1).switchMap((function(){return b.Observable.of((0,y.c0)(!1))})))}))}))},he=function(e,t){var n=t.getState;return e.ofType(y.un).debounceTime(50).switchMap((function(e){var t=e.sectionId,r=e.columnId;if("edit"!==(0,U.eK)(n())&&(r||t)&&(0,U.bU)(n())){var o,i,a=M()(n(),"geostory.resource.id"),c=(0,p.NP)(window.location.href,null===(o=window)||void 0===o||null===(i=o.location)||void 0===i?void 0:i.hash,a,t,r);c&&history.pushState(null,"",c)}return b.Observable.empty()}))},Oe=function(e){return e.ofType(y.ij).switchMap((function(){var e,t,n,r,o,i,a=null===(e=window)||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.hash)||void 0===n?void 0:n.split("/");return null!==(r=window)&&void 0!==r&&null!==(o=r.location)&&void 0!==o&&null!==(i=o.hash)&&void 0!==i&&i.includes("shared")?(0,p.M1)(a[7]||a[5],{block:"start",behavior:"auto"}):a.length>5?(0,p.M1)(a[6],{block:"start",behavior:"auto"}):5===a.length&&(0,p.M1)(a[4],{block:"start",behavior:"auto"}),b.Observable.empty()}))},we=function(e){return e.ofType(R.nk).switchMap((function(e){var t,n=e.payload;if((null==n||null===(t=n.location)||void 0===t?void 0:t.pathname.includes("/geostory/"))&&"POP"===n.action){var r,o=k()(null==n||null===(r=n.location)||void 0===r?void 0:r.pathname);return o.find((function(e){return"shared"===e}))?b.Observable.of((0,y.wJ)(o[2])).delay(500):b.Observable.of((0,y.wJ)(o[1])).delay(500)}return b.Observable.empty()}))},Ee=function(e,t){var n=t.getState;return e.ofType(y.un).filter((function(e){var t=e.columnId,r=e.sectionId;return!("edit"!==(0,U.eK)(n())||!t&&!r)})).debounceTime(50).switchMap((function(){return b.Observable.of(Array.from(document.querySelectorAll(".ms-geostory-builder .mapstore-side-card.ms-highlight")).pop()).filter((function(e){return!!e})).withLatestFrom(b.Observable.of(document.querySelector(".ms-geostory-builder .ms2-border-layout-body")).filter((function(e){return!!e}))).map((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}}(t,n)||te(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];return function(){var e=o.getBoundingClientRect(),t=e.top,n=e.bottom,r=i.getBoundingClientRect(),a=r.top,c=r.bottom;t<a?i.scrollBy({top:t-a-10,behavior:"smooth"}):n>c&&i.scrollBy({top:n-c+10,behavior:"smooth"})}})).do((function(e){return window.requestAnimationFrame(e)})).ignoreElements()}))},Pe=n(8316),je=n(66190),Se=n(65539),Te=n(96259),Ce=n(67076),ke=n(28878);function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){xe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,Ce.setObservableConfig)(ke.Z);var Ne=(0,Ce.compose)((0,Ce.mapPropsStream)((function(e){var t=(0,Ce.createEventHandler)(),n=t.handler,r=t.stream,o="EMPTY",i="EMPTY";return b.Observable.combineLatest(e,r.filter((function(e){var t=e.columnId,n=e.sectionId;return t&&o!==t?(o=t,!0):!(!n||i===n||(i=n,0))})).withLatestFrom(e.pluck("updateCurrentPage")).do((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ae(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];return i&&i(o)})).ignoreElements().startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Me(Me({},t.reduce((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Me(Me({},e),t)}),{})),{},{updateCurrentPage:n})}))}))),De=n(82030),Re=n(86494);function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){Be(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,Ce.setObservableConfig)(ke.Z);const We=(0,Ce.compose)((0,Ce.mapPropsStream)((function(e){var t=(0,Ce.createEventHandler)(),n=t.handler,r=t.stream;return b.Observable.combineLatest(e,function(e,t){return t.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{interceptorTime:e.interceptorTime,updateCurrentPage:e.updateCurrentPage}})).distinctUntilKeyChanged("interceptorTime").switchMap((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.interceptorTime,r=void 0===n?100:n,o=t.updateCurrentPage;return e.scan((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.visible,o=t.entry;return _e(_e({},e),{},Be({},n,{visible:r,entry:o}))}),{}).debounceTime(r).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,Re.minBy)(Object.keys(e),(function(t){return e[t].visible?(0,Re.get)(e[t],"entry.boundingClientRect.top"):1/0}))})).do((function(e){o&&o({sectionId:e})})).ignoreElements()}))}(r,e).startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return _e(_e({},t.reduce((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return _e(_e({},e),t)}),{})),{},{onVisibilityChange:n})}))})));var Ze=n(45697),Fe=n.n(Ze),Ve=n(93451),He=(n(2485),n(37163)),ze=n(73611),Ue=n(94184),Ge=n.n(Ue);function qe(e){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qe(e,t,n){return t&&Ke(e.prototype,t),n&&Ke(e,n),e}function Xe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nt(e);if(t){var o=nt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return et(this,n)}}function et(e,t){return!t||"object"!==qe(t)&&"function"!=typeof t?tt(e):t}function tt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nt(e){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ot="External Link",it=function(e){Xe(n,e);var t=Je(n);function n(){var e;$e(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return rt(tt(e=t.call.apply(t,[this].concat(o))),"state",{expanded:!1}),rt(tt(e),"toggle",(function(){e.setState((function(e){return{expanded:!e.expanded}}))})),e}return Qe(n,[{key:"render",value:function(){var e=this.state.expanded,t=this.props,n=t.externalLinkOption,r=t.onSelectionChange,o=t.currentSelectOption,a=t.availableStorySections;return i().createElement("div",{className:"rdw-block-wrapper","aria-label":"rdw-block-control"},i().createElement(ze.Dropdown,{className:"ms-rdw-link-options-dropdown",onChange:r,expanded:e,doExpand:this.toggle,doCollapse:this.toggle,onExpandEvent:this.toggle,title:"MSLinks"},i().createElement("span",null,o),i().createElement(ze.DropdownOption,{active:!0,value:{value:n,label:n},key:n},"External Link"),a&&a.map((function(e){return i().createElement(ze.DropdownOption,{active:e.id===o,value:{value:e.id,label:e.title||e.type||e.id},key:e.id},e.title||e.type||e.id)}))))}}]),n}(o.Component);rt(it,"propTypes",{externalLinkOption:Fe().string,onSelectionChange:Fe().func,currentSelectOption:Fe().string,availableStorySections:Fe().array});var at=function(e){Xe(n,e);var t=Je(n);function n(){var e;$e(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return rt(tt(e=t.call.apply(t,[this].concat(o))),"state",{showModal:!1,linkTarget:"",linkTitle:"",attributes:{},linkTargetOption:e.props.config.defaultTargetOption,currentSelectOption:"Select link target"}),rt(tt(e),"removeLink",(function(){(0,e.props.onChange)("unlink")})),rt(tt(e),"addLink",(function(){var t=e.props.onChange,n=e.state;t("link",n.linkTitle,n.linkTarget,n.linkTargetOption,n.attributes)})),rt(tt(e),"updateValue",(function(t){e.setState(rt({},"".concat(t.target.name),t.target.value))})),rt(tt(e),"onSelectionChange",(function(t){t.value===ot?e.setState({linkTarget:"",attributes:{},currentSelectOption:t.label}):e.setState({linkTarget:t.value,attributes:{"data-geostory-interaction-type":"scrollTo","data-geostory-interaction-params":"".concat(t.value),"data-geostory-interaction-name":t.label},currentSelectOption:t.label})})),rt(tt(e),"updateTargetOption",(function(t){e.setState({linkTargetOption:t.target.checked?"_blank":"_self"})})),rt(tt(e),"hideModal",(function(){e.setState({showModal:!1})})),rt(tt(e),"signalExpandShowModal",(function(){var t=e.props,n=t.onExpandEvent,r=t.currentState,o=r.link,i=r.selectionText,a=e.state.linkTargetOption;n();var c="Select link target";null!=o&&o.target&&o.target.length>0&&(c=ot),null!=o&&o.attributes["data-geostory-interaction-name"]&&(c=o.attributes["data-geostory-interaction-name"]),e.setState({showModal:!0,linkTarget:o&&o.target||"",linkTargetOption:o&&o.targetOption||a,linkTitle:o&&o.title||i,attributes:o&&o.attributes||{},currentSelectOption:c})})),rt(tt(e),"forceExpandAndShowModal",(function(){var t=e.props,n=t.doExpand,r=t.currentState,o=r.link,i=r.selectionText,a=e.state.linkTargetOption;n();var c="Select link target";null!=o&&o.target&&o.target.length>0&&(c=ot),null!=o&&o.attributes["data-geostory-interaction-name"]&&(c=o.attributes["data-geostory-interaction-name"]),e.setState({showModal:!0,linkTarget:o&&o.target,linkTargetOption:o&&o.targetOption||a,linkTitle:o&&o.title||i,attributes:o&&o.attributes||{},currentSelectOption:c})})),e}return Qe(n,[{key:"componentDidUpdate",value:function(e){e.expanded&&!this.props.expanded&&this.setState({showModal:!1,linkTarget:"",linkTitle:"",attributes:{},linkTargetOption:this.props.config.defaultTargetOption,currentSelectOption:"Select link target"})}},{key:"renderAddLinkModal",value:function(){var e=this.props,t=e.config.popupClassName,n=e.doCollapse,r=e.translations,o=e.availableStorySections,a=this.state,c=a.linkTitle,l=a.linkTarget,s=a.linkTargetOption,u=a.currentSelectOption;return i().createElement("div",{className:Ge()("rdw-link-modal",t),onClick:ze.stopPropagation},i().createElement("label",{className:"rdw-link-modal-label",htmlFor:"linkTitle"},r["components.controls.link.linkTitle"]),i().createElement("input",{id:"linkTitle",className:"rdw-link-modal-input",onChange:this.updateValue,onBlur:this.updateValue,name:"linkTitle",value:c}),i().createElement("label",{className:"rdw-link-modal-label",htmlFor:"linkTarget"},r["components.controls.link.linkTarget"]),i().createElement(it,{externalLinkOption:ot,currentSelectOption:u,onSelectionChange:this.onSelectionChange,availableStorySections:o}),u===ot&&i().createElement(i().Fragment,null,i().createElement("input",{id:"linkTarget",className:"rdw-link-modal-input",onChange:this.updateValue,onBlur:this.updateValue,name:"linkTarget",value:l}),i().createElement("label",{className:"rdw-link-modal-target-option",htmlFor:"openLinkInNewWindow"},i().createElement("input",{id:"openLinkInNewWindow",type:"checkbox",defaultChecked:"_blank"===s,value:"_blank",onChange:this.updateTargetOption}),i().createElement("span",null,r["components.controls.link.linkTargetOption"]))),i().createElement("span",{className:"rdw-link-modal-buttonsection"},i().createElement("button",{className:"rdw-link-modal-btn",onClick:this.addLink,disabled:!l||!c},r["generic.add"]),i().createElement("button",{className:"rdw-link-modal-btn",onClick:n},r["generic.cancel"])))}},{key:"renderInFlatList",value:function(){var e=this.props,t=e.config,n=t.options,r=t.link,o=t.unlink,a=t.className,c=e.currentState,l=e.expanded,s=e.translations,u=this.state.showModal;return i().createElement("div",{className:Ge()("rdw-link-wrapper",a),"aria-label":"rdw-link-control"},n.indexOf("link")>=0&&i().createElement(ze.Option,{value:"unordered-list-item",className:Ge()(r.className),onClick:this.signalExpandShowModal,"aria-haspopup":"true","aria-expanded":u,title:r.title||s["components.controls.link.link"]},i().createElement("img",{src:r.icon,alt:""})),n.indexOf("unlink")>=0&&i().createElement(ze.Option,{disabled:!c.link,value:"ordered-list-item",className:Ge()(o.className),onClick:this.removeLink,title:o.title||s["components.controls.link.unlink"]},i().createElement("img",{src:o.icon,alt:""})),l&&u?this.renderAddLinkModal():void 0)}},{key:"renderInDropDown",value:function(){var e=this.props,t=e.expanded,n=e.onExpandEvent,r=e.doCollapse,o=e.doExpand,a=e.onChange,c=e.config,l=e.currentState,s=e.translations,u=c.options,p=c.link,d=c.unlink,f=c.className,y=c.dropdownClassName,m=c.title,b=this.state.showModal;return i().createElement("div",{className:"rdw-link-wrapper","aria-haspopup":"true","aria-label":"rdw-link-control","aria-expanded":t,title:m},i().createElement(ze.Dropdown,{className:Ge()("rdw-link-dropdown",f),optionWrapperClassName:Ge()(y),onChange:a,expanded:t&&!b,doExpand:o,doCollapse:r,onExpandEvent:n},i().createElement("img",{src:(0,ze.getFirstIcon)(c),alt:""}),u.indexOf("link")>=0&&i().createElement(ze.DropdownOption,{onClick:this.forceExpandAndShowModal,className:Ge()("rdw-link-dropdownoption",p.className),title:p.title||s["components.controls.link.link"]},i().createElement("img",{src:p.icon,alt:""})),u.indexOf("unlink")>=0&&i().createElement(ze.DropdownOption,{onClick:this.removeLink,disabled:!l.link,className:Ge()("rdw-link-dropdownoption",d.className),title:d.title||s["components.controls.link.unlink"]},i().createElement("img",{src:d.icon,alt:""}))),t&&b?this.renderAddLinkModal():void 0)}},{key:"render",value:function(){return this.props.config.inDropdown?this.renderInDropDown():this.renderInFlatList()}}]),n}(o.Component);rt(at,"propTypes",{expanded:Fe().bool,doExpand:Fe().func,doCollapse:Fe().func,onExpandEvent:Fe().func,config:Fe().object,onChange:Fe().func,currentState:Fe().object,translations:Fe().object,modalHandler:Fe().any});const ct=at;function lt(e){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function st(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pt(e,t){return(pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dt(e,t){return!t||"object"!==lt(t)&&"function"!=typeof t?ft(e):t}function ft(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yt(e){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bt(e,t,n){e.findEntityRanges((function(e){var t=e.getEntity();return null!==t&&"LINK"===n.getEntity(t).getType()}),t)}function vt(e){var t,n,r=e.showOpenOptionOnHover;return n=t=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pt(e,t)}(l,e);var t,n,o,a,c=(o=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=yt(o);if(a){var n=yt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return dt(this,e)});function l(){var e;st(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mt(ft(e=c.call.apply(c,[this].concat(n))),"state",{showPopOver:!1}),mt(ft(e),"openLink",(function(){var t=e.props,n=t.entityKey,r=t.contentState.getEntity(n).getData().url,o=window.open(r,"blank");o&&o.focus()})),mt(ft(e),"toggleShowPopOver",(function(){var t=!e.state.showPopOver;e.setState({showPopOver:t})})),mt(ft(e),"renderDecorator",(function(){var t=e.props,n=t.children,o=t.entityKey,a=t.contentState.getEntity(o).getData(),c=a.url,l=a.targetOption,s=a.attributes,u=e.state.showPopOver;return s&&s["data-geostory-interaction-type"]?i().createElement("span",{className:"rdw-link-decorator-wrapper"},i().createElement("a",{"data-geostory-interaction-type":s["data-geostory-interaction-type"],"data-geostory-interaction-params":s["data-geostory-interaction-params"]},n)):i().createElement("span",{className:"rdw-link-decorator-wrapper",onMouseEnter:e.toggleShowPopOver,onMouseLeave:e.toggleShowPopOver},i().createElement("a",{href:c,target:l},n),u&&r?i().createElement("img",{src:ze.openlink,alt:"",onClick:e.openLink,className:"rdw-link-decorator-icon"}):void 0)})),e}return t=l,(n=[{key:"render",value:function(){return this.renderDecorator()}}])&&ut(t.prototype,n),l}(o.Component),mt(t,"propTypes",{entityKey:Fe().string.isRequired,children:Fe().array,contentState:Fe().object}),n}const gt=function(e){return{strategy:bt,component:vt(e)}};var ht=n(89265),Ot=n.n(ht),wt=n(17247),Et=n.n(wt),Pt=function(e){var t=void 0;if(e instanceof HTMLAnchorElement){var n={};if(e.dataset&&void 0!==e.dataset.mention)n.url=e.href,n.text=e.innerHTML,n.value=e.dataset.value,t=He.Entity.__create("MENTION","IMMUTABLE",n);else{n.url=e.getAttribute&&e.getAttribute("href")||e.href,n.title=e.innerHTML,n.targetOption=e.target;var r=e.getAttribute&&e.getAttribute("data-geostory-interaction-type"),o=e.getAttribute&&e.getAttribute("data-geostory-interaction-params"),i=e.getAttribute&&e.getAttribute("data-geostory-interaction-name"),a={};i&&o&&r&&(a["data-geostory-interaction-type"]=r,a["data-geostory-interaction-params"]=o,a["data-geostory-interaction-name"]=i),n.attributes=a,t=He.Entity.__create("LINK","MUTABLE",n)}}return t},jt=function(e,t){if("MENTION"===e.type)return'< href="'.concat(e.data.url,'" class="wysiwyg-mention" data-mention data-value="').concat(e.data.value,'">').concat(t,"</a>");if("LINK"===e.type){var n=e.data.targetOption||"_self",r=e.data.attributes;return r&&r["data-geostory-interaction-type"]?'<a data-geostory-interaction-name="'.concat(r["data-geostory-interaction-name"],'" data-geostory-interaction-type="').concat(r["data-geostory-interaction-type"],'" data-geostory-interaction-params="').concat(r["data-geostory-interaction-params"],"\" onclick=\"__geostory_interaction(type='scrollTo', '").concat(r["data-geostory-interaction-params"],"')\">").concat(t,"</a>"):'<a href="'.concat(e.data.url,'" target="').concat(n,'">').concat(t,"</a>")}if("IMAGE"===e.type){var o=e.data.alignment,i=o&&"none"!==o?"float: ".concat(o,";"):"display: block; margin: 0 auto 0 auto;";return'<img src="'.concat(e.data.src,'" alt="').concat(e.data.alt,'" style="height: ').concat(e.data.height,"; width: ").concat(e.data.width,"; ").concat(i,'" />')}return"EMBEDDED_LINK"===e.type?'<iframe width="'.concat(e.data.width,'" height="').concat(e.data.height,'" src="').concat(e.data.src,'" frameBorder="0"></iframe>'):t};function St(){return(St=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(n),!0).forEach((function(t){It(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function It(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mt=(0,Ce.compose)((0,Ce.withProps)((function(e){var t=e.storyFonts,n=void 0===t?[]:t,r=e.placeholder,o=e.toolbarStyle,i=void 0===o?{}:o,a=e.className,c=void 0===a?"ms-text-editor":a,l=e.toolbar,s=void 0===l?{}:l;return{editorRef:function(e){return setTimeout((function(){return e&&e.focus&&e.focus()}),100)},stripPastedStyles:!0,placeholder:r,toolbarStyle:i,toolbar:kt({options:["fontFamily","blockType","fontSize","inline","textAlign","colorPicker","list","link","remove"],fontFamily:{options:n.length>0?n:p.Km,className:void 0,component:void 0,dropdownClassName:void 0},link:{inDropdown:!1,className:void 0,component:void 0,popupClassName:void 0,dropdownClassName:void 0,showOpenOptionOnHover:!0,defaultTargetOption:"_self",options:["link","unlink"],link:{icon:void 0,className:void 0},unlink:{icon:void 0,className:void 0},linkCallback:void 0},blockType:{inDropdown:!0,options:["Normal","H1","H2","H3","H4","H5","H6","Blockquote","Code"],className:void 0,component:void 0,dropdownClassName:void 0},inline:{options:["bold","italic","underline","strikethrough","monospace"],bold:{className:"".concat(c,"-toolbar-btn")},italic:{className:"".concat(c,"-toolbar-btn")},underline:{className:"".concat(c,"-toolbar-btn")},strikethrough:{className:"".concat(c,"-toolbar-btn")},code:{className:"".concat(c,"-toolbar-btn")}},textAlign:{left:{className:"".concat(c,"-toolbar-btn")},center:{className:"".concat(c,"-toolbar-btn")},right:{className:"".concat(c,"-toolbar-btn")},justify:{className:"".concat(c,"-toolbar-btn")}},colorPicker:{className:"".concat(c,"-toolbar-btn")},remove:{className:"".concat(c,"-toolbar-btn")}},s),toolbarClassName:"".concat(c,"-toolbar"),wrapperClassName:"".concat(c,"-wrapper"),editorClassName:"".concat(c,"-main")}})),(0,Ce.renderComponent)(ze.Editor)),xt=(0,Ce.compose)((0,Ce.lifecycle)({componentWillUnmount:function(){var e=this.props,t=e.editorState,n=e.save;(void 0===n?function(){}:n)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e){var n=1!==(0,He.convertToRaw)(e.getCurrentContent()).blocks.length||(0,He.convertToRaw)(e.getCurrentContent()).blocks[0].text,r=Ot()((0,He.convertToRaw)(e.getCurrentContent()),null,null,jt);return n?r:t}return t}(t,p.gg))}}),(0,Ce.withHandlers)({onBlur:function(e){var t=e.toggleEditing,n=void 0===t?function(){}:t;return function(){n(!1)}}}),(0,Ce.withProps)((function(e){var t=e.sections;return{availableStorySections:(void 0===t?[]:t).reduce((function(e,t){var n,r=[];return t.type===p.ID.IMMERSIVE?t.contents.forEach((function(e){r.push(e)})):r.push(t),[].concat(function(e){if(Array.isArray(e))return Tt(e)}(n=e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return Tt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tt(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),r)}),[])}})),(0,Ce.withProps)((function(e){var t=e.availableStorySections,n=void 0===t?[]:t;return{toolbar:{link:{inDropdown:!1,className:void 0,component:function(e){return i().createElement(ct,St({},e,{availableStorySections:n}))},popupClassName:void 0,dropdownClassName:void 0,showOpenOptionOnHover:!0,defaultTargetOption:"_self",options:["link","unlink"],link:{icon:void 0,className:void 0},unlink:{icon:void 0,className:void 0},linkCallback:void 0,getLinkDecorator:gt}}}})),Mt);const At=(0,Ce.compose)((0,Ce.withState)("contentEditing","setContentEditing",!1),(0,Ce.withState)("editorState","onEditorStateChange"),(0,Ce.withHandlers)({toggleEditing:function(e){var t=e.bubblingTextEditing,n=void 0===t?function(){}:t,r=e.sectionType,o=e.onEditorStateChange,i=void 0===o?function(){}:o,a=e.setContentEditing,c=void 0===a?function(){}:a;return function(e,t){if(e){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=Et()(e,null,Pt),n=He.ContentState.createFromBlockArray(t.contentBlocks);return He.EditorState.createWithContent(n)}(t);if(r===p.ID.TITLE&&"unstyled"===He.RichUtils.getCurrentBlockType(o)){var a=o.getCurrentContent();a=He.Modifier.setBlockType(a,He.EditorState.createWithContent(a).getSelection(),"header-one"),o=He.EditorState.createWithContent(a)}i(o),c(!0),n(!0)}else c(!1),n(!1)}}}),(0,Ce.branch)((function(e){return!!e.contentEditing}),xt)),Nt=(0,Ce.compose)((0,Ce.withHandlers)({save:function(e){var t=e.update,n=void 0===t?function(){}:t;return function(e){return n("html",e)}}}),(0,Ce.branch)((function(e){return e.mode===p.nl.EDIT}),At),(0,Ce.compose)((0,Ce.withPropsOnChange)(["sectionType"],(function(e){var t=e.sectionType;return{placeholder:p.ID.TITLE===t?"geostory.builder.defaults.htmlTitlePlaceholder":"geostory.builder.defaults.htmlPlaceholder",placeholderTag:p.ID.TITLE===t?"h1":"p"}})),(0,Ve.Z)("placeholder")))((function(e){var t=e.placeholder,n=e.placeholderTag,r=void 0===n?"p":n,o=e.id,a=e.toggleEditing,c=void 0===a?function(){}:a,l=e.html,s=e.mode;return i().createElement("div",{className:"ms-text-wrapper"},l!==p.gg&&i().createElement("div",{id:o,onClick:function(){return c(!0,l)},dangerouslySetInnerHTML:{__html:l}}),(!l||l===p.gg)&&s===p.nl.EDIT&&i().createElement("div",{className:"ms-text-placeholder",id:"placeholder"+o,onClick:function(){return c(!0,l===p.gg?"":l)},dangerouslySetInnerHTML:{__html:"<".concat(r,">").concat(t,"</").concat(r,">")}}))}));var Dt=n(1206),Rt=n.n(Dt),Lt=n(96797),_t=n.n(Lt);function Bt(e){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wt(Object(n),!0).forEach((function(t){Gt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ht(e,t){return(Ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zt(e,t){return!t||"object"!==Bt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ut(e){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ht(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ut(r);if(o){var n=Ut(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return zt(this,e)});function c(){return Ft(this,c),a.apply(this,arguments)}return t=c,(n=[{key:"componentDidMount",value:function(){_t()(this._node)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.src!==this.props.src&&_t()(this._node)}},{key:"render",value:function(){var e=this,t=this.props,n=t.id,r=t.src,o=t.fit,a=void 0===o?"cover":o,c=t.enableFullscreen,l=void 0===c||c,s=t.fullscreen,u=t.onClick,p=t.description,d=t.showCaption,f=t.caption,y=void 0===f?p:f,m=t.credits,b=t.loaderStyle,v=this.props.loaderComponent,g=this.props.errorComponent;return i().createElement("div",{id:n,className:"ms-media ms-media-image"},r&&"error"!==this.props.status&&i().createElement("img",{ref:function(t){e._node=t},src:r,onLoad:function(){return e.props.onChangeStatus("loaded")},onError:function(){return e.props.onChangeStatus("error")},onClick:l?function(){return u(!0)}:void 0,style:{objectFit:a,fontFamily:"object-fit: ".concat(a),cursor:l?"pointer":"default"}}),r&&!this.props.status&&v&&i().createElement(v,{style:Zt({},b)}),"error"===this.props.status&&g&&i().createElement(g,null),m&&i().createElement("div",{className:"ms-media-credits"},i().createElement("small",null,m)),d&&y&&i().createElement("div",{className:"ms-media-caption"},i().createElement("small",null,y)),l&&s?i().createElement(Rt(),{mainSrc:r,onCloseRequest:function(){return u(!1)}}):null)}}])&&Vt(t.prototype,n),c}(o.Component);Gt(qt,"propTypes",{src:Fe().string,id:Fe().string,fit:Fe().string,description:Fe().string,showCaption:Fe().bool,credits:Fe().string,altText:Fe().string,enableFullscreen:Fe().bool,fullscreen:Fe().bool,onClick:Fe().func,onChangeStatus:Fe().func,status:Fe().string,loaderComponent:Fe().element,errorComponent:Fe().element,caption:Fe().string,loaderStyle:Fe().object});const $t=(0,Ce.compose)((0,Ce.withState)("fullscreen","onClick",!1),(0,Ce.withState)("status","onChangeStatus",""))(qt);var Kt=n(30294),Qt=n(19180),Xt=n(91812),Yt=n(37981),Jt=n(69705),en=n(57068),tn=n(63721),nn=n(61928);const rn=(0,Ce.compose)(Jt.Z,(0,Xt.Z)(0),Qt.Z,tn.dY,tn.yM,Yt.Z,en.e)(nn.Z);var on=n(99534),an=n(15135),cn=n(80628),ln=n(38560);function sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sn(Object(n),!0).forEach((function(t){pn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dn=(0,an.Z)(ln.Z);const fn=(0,Ce.compose)((0,Ce.withState)("active","setActive",!1),cn.Z)((function(e){var t=e.id,n=e.map,r=void 0===n?{layers:[$.D]}:n,o=e.fit,a=e.editMap,c=void 0!==a&&a,l=e.onMapViewChanges,s=e.eventHandlers,u=e.expandable,d=void 0!==u&&u,f=e.active,y=e.setActive,m=e.width,b=e.height,v=e.size,g=e.showCaption,h=e.caption,O=e.mapType,w=void 0===O?"leaflet":O,E=e.onMapTypeLoaded,P=r.data?r.data:r,j=P.layers,S=void 0===j?[]:j,T=P.mapOptions,C=void 0===T?{}:T,k=P.description,I=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(P,["layers","mapOptions","description"]),M=h||k,x=d?f?{zoomControl:!1,interactive:!0,mapOptions:{scrollWheelZoom:!0,interactions:{mouseWheelZoom:!0,dragPan:!0}}}:{zoomControl:!1,interactive:!1,mapOptions:{scrollWheelZoom:!1,interactions:{mouseWheelZoom:!1,dragPan:!1}}}:{mapOptions:C},A=c?{mapOptions:un(un({},C),{},{interactions:un(un({},C.interactions),{},{mouseWheelZoom:I.zoomControl})})}:x,N=I.mapInfoControl&&!(d&&!f),D=i().createElement(i().Fragment,null,i().createElement(rn,{key:d?"overlay":"block",onMapViewChanges:l,eventHandlers:s,map:un(un({},I),{},{id:"media-".concat(t),resize:m+"-"+b+"_"+v,className:"aaaa",style:{cursor:N?"pointer":"default"}}),layers:S,tools:N?["popup"]:[],options:(0,p.kn)(A),mapType:w,onMapTypeLoaded:E}),d&&!c&&i().createElement(dn,{className:"ms-expand-media-button",onClick:function(){return y(!f)},tooltipId:f?"geostory.closeFullscreenMap":"geostory.showFullscreenMap",tooltipPosition:"left"},i().createElement(Kt.Glyphicon,{glyph:f?"1-close":"1-full-screen"})));return i().createElement("div",{className:"ms-media ms-media-map ".concat(C.zoomPosition||""),style:{objectFit:o}},f&&d?i().createElement(on.Z,null,i().createElement("div",{className:"ms-expanded-media-container"},D)):D,g&&M&&i().createElement("div",{className:"ms-media-caption"},i().createElement("small",null,M)))}));var yn=n(52826);function mn(){return(mn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var vn=$t,gn={image:$t,map:fn,video:yn.Z},hn=function(e){var t,n,r=e.debounceTime,a=e.mediaViewer,c=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["debounceTime","mediaViewer"]),l="".concat(c.id).concat(c.resourceId?"-".concat(c.resourceId):""),s=(t=(0,o.useState)({}),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}}(t,n)||function(e,t){if(e){if("string"==typeof e)return bn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bn(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=s[0],p=s[1],d=void 0===u[l]||u[l],f=a||gn[c.mediaType||c.type]||vn;return i().createElement(f,mn({sectionType:c.sectionType,debounceTime:r,loading:u,isLoading:d,onLoad:p,loadingId:l},c))};hn.propTypes={id:Fe().string,lazy:Fe().bool,mediaType:Fe().string,type:Fe().string,debounceTime:Fe().number},hn.defaultProps={id:"",lazy:!0,mediaType:"",type:""};const On=hn;var wn=n(7472);function En(){return(En=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pn(Object(n),!0).forEach((function(t){Sn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Sn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Tn=function(e){var t=e.show,n=e.style,r=void 0===n?{}:n,o=e.modal,a=e.draggable,c=void 0!==a&&a,l=e.closeGlyph,s=void 0===l?"1-close":l,u=e.closable,p=void 0===u||u,d=e.onClose,f=void 0===d?function(){}:d,y=e.title,m=e.header,b=e.footer,v=e.children,g=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["show","style","modal","draggable","closeGlyph","closable","onClose","title","header","footer","children"]);return t?i().createElement(wn.Z,En({modal:o,onClickOut:p&&o?function(){return f()}:null,style:jn(jn({},r),{},{display:t?"block":"none"}),draggable:c},g),i().createElement("span",{role:"header"},y||m||i().createElement("span",null," "),p?i().createElement("button",{onClick:function(){return f()},className:"settings-panel-close close"},i().createElement(Kt.Glyphicon,{glyph:s})):null),i().createElement("span",{role:"body"},v),b?i().createElement("span",{role:"footer"},b):null):null};var Cn=n(5346),kn=(0,Ce.branch)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.viewHeight,o=e.size;return!n||!r||!o}),(0,De.Z)((function(){return!0}),(function(){return{glyph:"code"}})));const In=(0,Ce.compose)(kn)((function(e){var t=e.src,n=e.size,r=e.viewHeight;return i().createElement("div",{className:"ms-webpage-wrapper"},i().createElement("iframe",{src:t,height:"".concat((0,p.t4)(n,r),"px")}))}));var Mn=n(11847),xn=n(37275),An=n(48759),Nn=n(23279),Dn=n.n(Nn);function Rn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ln(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rn(Object(n),!0).forEach((function(t){_n(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wn=function(e){var t,n,r=e.id,a=e.onLoad,c=e.loading,l=e.debounceTime,s=e.children,u=e.loaderComponent,p=e.loaderStyle,d=(t=(0,An.YD)(),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Bn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Bn(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=d[0],y=d[1],m=(0,o.useRef)(null),b=u;return(0,o.useEffect)((function(){return m.current=Dn()((function(e){a(e)}),l),function(){m.current.cancel()}}),[]),(0,o.useEffect)((function(){y&&c&&m.current(r),!y&&c&&m.current.cancel()}),[y,c,r]),i().createElement("div",{ref:f,className:"ms-visibility-container"},c?b?i().createElement(b,{style:Ln({},p)}):null:(0,o.cloneElement)(s,{inView:y}))};Wn.propTypes={id:Fe().string,debounceTime:Fe().number,loading:Fe().bool,onLoad:Fe().func,loaderComponent:Fe().element},Wn.defaultProps={id:"",debounceTime:300,loading:!0,onLoad:function(){},loaderComponent:null};const Zn=Wn;var Fn=n(32425);function Vn(e){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Un(e,t){return(Un=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gn(e,t){return!t||"object"!==Vn(t)&&"function"!=typeof t?qn(e):t}function qn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $n(e){return($n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Qn=function(){return i().createElement("div",{className:"ms-media-loader"},i().createElement(Fn.Z,{size:52}))},Xn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Un(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$n(r);if(o){var n=$n(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Gn(this,e)});function c(){var e;Hn(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Kn(qn(e=a.call.apply(a,[this].concat(n))),"state",{url:e.props.src||"",error:!1,loading:!0}),Kn(qn(e),"updateURL",(function(t){var n=t.target.value;e.setState({url:n})})),Kn(qn(e),"save",(function(){var t=e.state.url,n=!(0,Mn.K2)(t,(0,xn.u8)("GeoStoryValidIframeURLRegex"));e.setState({error:n}),n||e.props.onChange(t)})),e}return t=c,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.editURL,o=this.state,a=o.url,c=o.error;return i().createElement(i().Fragment,null,i().createElement(on.Z,null,i().createElement(Tn,{modal:!0,show:r,onClickOut:function(e){return e.preventDefault()&&e.stopPropagation()},title:i().createElement(Cn.Z,{msgId:"geostory.webPageCreator.title"}),onClose:n,id:"web-page-creator",footer:i().createElement(ln.Z,{bsSize:"small",onClick:this.save},i().createElement(Cn.Z,{msgId:"geostory.webPageCreator.saveButton"}))},c&&i().createElement("div",{className:"dropzone-errorBox alert-danger"},i().createElement(Cn.Z,{msgId:"geostory.webPageCreator.error"})),i().createElement(Kt.FormGroup,{controlId:"WEBPAGE_URL",validationState:c&&"error"},i().createElement(Kt.ControlLabel,null,i().createElement(Cn.Z,{msgId:"geostory.webPageCreator.url.label"})),i().createElement(Kt.FormControl,{label:"URL",type:"text",value:a,onChange:this.updateURL,required:!0})))),this.props.lazy?i().createElement(Zn,{key:this.props.id,id:this.props.id,debounceTime:this.props.debounceTime,loading:this.state.loading,onLoad:function(){return e.setState({loading:!1})},loaderComponent:Qn},i().createElement(In,this.props)):i().createElement(In,this.props))}}])&&zn(t.prototype,n),c}(i().PureComponent);Kn(Xn,"propTypes",{editURL:Fe().bool,onClose:Fe().func,onChange:Fe().func,src:Fe().string,id:Fe().string,debounceTime:Fe().number,lazy:Fe().bool}),Kn(Xn,"defaultProps",{lazy:!0});var Yn=(0,Ce.compose)((0,Ce.withHandlers)({onClose:function(e){var t=e.update,n=void 0===t?function(){}:t;return function(){return n("editURL",!1,"merge")}}}))(Xn);const Jn=(0,a.connect)(null,{onChange:y.YM})(Yn);function er(){return(er=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var tr=function(e){var t=e.type;return i().createElement("div",{className:"ms-content ms-content-unknown"},'warning: unknown content type "'.concat(t,'"'))};const nr=function(e){var t=e.type,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["type"]),r=function(e){switch(e){case p.bT.TEXT:return Nt;case p.bT.MEDIA:case p.Tr.IMAGE:case p.Tr.MAP:case p.Tr.VIDEO:return On;case p.bT.WEBPAGE:return Jn;default:return tr}}(t);return i().createElement(r,er({type:t},n))};var rr=n(25288),or=n(80717);function ir(e){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(n),!0).forEach((function(t){fr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ar(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ur(e,t){return(ur=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pr(e,t){return!t||"object"!==ir(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dr(e){return(dr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ur(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=dr(r);if(o){var n=dr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return pr(this,e)});function c(){return lr(this,c),a.apply(this,arguments)}return t=c,(n=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){!this.trigger||e.containerWidth===this.props.containerWidth&&e.containerHeight===this.props.containerHeight||this.trigger.hide()}},{key:"render",value:function(){var e=this;return i().createElement(rr.Z,{className:"add-bar",popoverClassName:"add-bar-popover",content:i().createElement(or.Z,{btnDefaultProps:{className:"square-button btn-tray"},buttons:this.props.buttons.map((function(t){var n=t.onClick,r=void 0===n?function(){}:n;return cr(cr({},function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,["onClick"])),{},{onClick:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];r.apply(void 0,n),e.trigger.hide(),n[0]&&n[0].preventDefault&&n[0].preventDefault()}})}))}),ref:function(t){t&&(e.trigger=t.trigger)},placement:"top"},i().createElement(ln.Z,{className:this.props.addButtonClassName},i().createElement(Kt.Glyphicon,{glyph:"plus"})))}}])&&sr(t.prototype,n),c}(i().Component);fr(yr,"propTypes",{id:Fe().string,type:Fe().string,buttons:Fe().array,containerWidth:Fe().oneOfType([Fe().number,Fe().string]),containerHeight:Fe().oneOfType([Fe().number,Fe().string]),addButtonClassName:Fe().string}),fr(yr,"defaultProps",{id:"",type:"",buttons:[],containerWidth:0,containerHeight:0,addButtonClassName:""});const mr=yr;function br(e){return function(e){if(Array.isArray(e))return vr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return vr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vr(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gr(Object(n),!0).forEach((function(t){Or(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Or(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wr(){return(wr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Er(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const Pr=function(e){var t=e.viewWidth,n=e.viewHeight,r=e.className,o=e.contentProps,a=void 0===o?{}:o,c=e.addButtons,l=void 0===c?[]:c,s=e.tools,u=void 0===s?[]:s,d=e.contents,f=void 0===d?[]:d,y=e.ContentComponent,m=void 0===y?nr:y,b=e.mode,v=e.sectionType,g=e.editMedia,h=void 0===g?function(){}:g,O=e.editWebPage,w=void 0===O?function(){}:O,E=e.add,P=void 0===E?function(){}:E,j=e.update,S=void 0===j?function(){}:j,T=e.remove,C=void 0===T?function(){}:T,k=e.bubblingTextEditing,I=void 0===k?function(){}:k,M=e.storyTheme,x=e.sections,A=void 0===x?[]:x,N=e.storyFonts;return i().createElement("div",{className:r},f.reduce((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0,o=r.id,c=Er(r,["id"]),s=[i().createElement(m,wr({id:o,key:"".concat(o,"-content"),mode:b,viewWidth:t,sectionType:v,viewHeight:n,editMedia:function(e){for(var t=e.path,n=void 0===t?"":t,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return h.apply(void 0,[{path:'contents[{"id": "'.concat(o,'"}]')+n}].concat(i))},editWebPage:function(e){for(var t=e.path,n=void 0===t?"":t,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return w.apply(void 0,[{path:'contents[{"id": "'.concat(o,'"}]')+n}].concat(i))},add:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return P.apply(void 0,['contents[{"id": "'.concat(o,'"}].')+e].concat(n))},update:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return S.apply(void 0,['contents[{"id": "'.concat(o,'"}].')+e].concat(n))},remove:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return C.apply(void 0,['contents[{"id": "'.concat(o,'"}]')+(e?"."+e:"")].concat(n))}},a,c,{storyTheme:M,storyFonts:N,bubblingTextEditing:I,tools:u&&u[c.type],sections:A}))];return b===p.nl.EDIT&&l.length>0&&s.push(i().createElement(mr,{key:"".concat(o,"-content-add-buttons"),containerWidth:t,containerHeight:n,buttons:l.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return hr(hr({},e),{},{onClick:function(){return P("contents",o,e.template)}})}))})),[].concat(br(e),s)}),[]))};function jr(){return(jr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Sr(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}n(66337);const Tr=function(e){return(0,Ce.compose)((0,Ce.withHandlers)({onVisibilityChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.onVisibilityChange,r=void 0===n?function(){}:n;return function(e,n){return r({id:t,visible:e,entry:n})}}}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onVisibilityChange,n=(e.rootSelector,Sr(e,["onVisibilityChange","rootSelector"]));return function(e){return function(r){var o=r.intersectionObserverOptions,a=void 0===o?{}:o,c=r.onVisibilityChange,l=Sr(r,["intersectionObserverOptions","onVisibilityChange"]),s=t||c;return i().createElement(An.df,jr({},n,a,{onChange:s}),(function(t){var n=t.inView,r=t.ref,o=t.entry;return i().createElement(e,jr({},l,{inView:n,inViewRef:r,inViewEntry:o}))}))}}}(e))};var Cr=n(90085),kr=n(12610),Ir=n(13311),Mr=n.n(Ir),xr=n(23560),Ar=n.n(xr),Nr=n(18446),Dr=n.n(Nr);function Rr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Lr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _r=(0,kr.Z)(Kt.DropdownButton);function Br(e){var t=e.value,n=e.options,r=void 0===n?[]:n,a=e.onSelect,c=void 0===a?function(){}:a,l=e.glyph,s=void 0===l?"":l,u=e.tooltipId,p=e.pullRight,d=void 0!==p&&p,f=e.className,y=void 0===f?"square-button-md no-border":f,m=e.disabled,b=e.noTooltipWhenDisabled,v=void 0!==b&&b,g=e.hideMenuItem,h=void 0===g?function(){return!1}:g,O=e.shouldClose,w=Rr((0,o.useState)(!1),2),E=w[0],P=w[1],S=Rr((0,o.useState)(!1),2),T=S[0],C=S[1],k=(Mr()(r,(function(e){return Dr()(e.value,t)}))||{}).glyph;return(0,o.useEffect)((function(){m&&P(!1)}),[m]),i().createElement(_r,{noCaret:!0,open:E,noTooltipWhenDisabled:v,tooltipId:u,pullRight:d,className:y,disabled:m,title:i().createElement(Kt.Glyphicon,{glyph:k||s}),onToggle:function(e,n,r){return T||"select"===(null==r?void 0:r.source)||O&&!O(t,n)?null:P(e)}},r.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(null==e?void 0:e.Component)||Kt.MenuItem;return h(t,e)?null:i().createElement(n,{key:e.value,selected:t,value:e.value,active:Ar()(null==e?void 0:e.isActive)&&e.isActive(t)||!j()(t)&&t===e.value,onClick:null!=e&&e.Component?c:function(){return c(e.value)},onActive:function(e){return C(e)}},e.label)})))}var Wr=n(12122),Zr=n(11766),Fr=n(13218),Vr=n.n(Fr);function Hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hr(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ur(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gr(){return(Gr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var qr=(0,Wr.Z)(Cr.Z),$r=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.align,o=e.sectionType,a=e.size,c=e.update,l=void 0===c?function(){}:c,s=e.filterOptions,u=e.pullRight;return i().createElement(Br,{value:a,noTooltipWhenDisabled:!0,disabled:n,glyph:"resize-horizontal",pullRight:u||("right"===r||"full"===a||"large"===a)&&!o,tooltipId:"geostory.contentToolbar.contentSize",options:[{value:"small",glyph:"size-small",label:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.smallSizeLabel"})},{value:"medium",glyph:"size-medium",label:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.mediumSizeLabel"})},{value:"large",glyph:"size-large",label:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.largeSizeLabel"})},{value:"full",glyph:"size-extra-large",label:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.fullSizeLabel"})}].filter((function(e){return!s||s(e)})),onSelect:function(e){return l("size",e)}})},Kr=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.align,o=e.sectionType,a=e.size,c=e.update,l=void 0===c?function(){}:c;return i().createElement(Br,{value:r,noTooltipWhenDisabled:!0,disabled:"full"===a||n,glyph:"align-center",pullRight:("right"===r||"full"===a||"large"===a)&&!o,tooltipId:"geostory.contentToolbar.contentAlign",options:[{value:"left",label:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.leftAlignLabel"}),glyph:"align-left"},{value:"center",label:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.centerAlignLabel"}),glyph:"align-center"},{value:"right",label:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.rightAlignLabel"}),glyph:"align-right"}],onSelect:function(e){return l("align",e)}})},Qr=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.theme,o=e.storyTheme,a=e.align,c=e.sectionType,l=e.update,s=void 0===l?function(){}:l,u=e.themeProps,p=e.size;return i().createElement(Br,{value:r,noTooltipWhenDisabled:!0,pullRight:("right"===a||"full"===p||"large"===p)&&!c,glyph:"dropper",tooltipId:"geostory.contentToolbar.contentTheme",disabled:n,shouldClose:function(e,t){var n,r;return Vr()(e)&&"ms-color-picker-cover"!==(null==t||null===(n=t.target)||void 0===n||null===(r=n.getAttribute)||void 0===r?void 0:r.call(n,"class"))||E()(e)||void 0===e},hideMenuItem:function(e,t){return"custom"===(null==e?void 0:e.value)&&"custom"!==(null==t?void 0:t.value)},options:[{value:"",isActive:function(e){return void 0===e||""===e||Vr()(e)&&(void 0===e.value||""===e.value)},label:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.defaultThemeLabel"})},{value:"bright",isActive:function(e){return"bright"===(null==e?void 0:e.value)||"bright"===e},label:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.brightThemeLabel"})},{value:"dark",isActive:function(e){return"dark"===(null==e?void 0:e.value)||"dark"===e},label:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.darkThemeLabel"})},{value:"custom",Component:function(e){return i().createElement(Zr.H,Gr({},e,{disableBackgroundAlpha:null==u?void 0:u.disableBackgroundAlpha,disableShadow:null==u?void 0:u.disableShadow,disableTextColor:null==u?void 0:u.disableTextColor,onUpdate:s,storyTheme:o}))}}],onSelect:function(e){return s("theme",zr(zr({},Vr()(r)&&r),{},{value:e}))}})},Xr=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.path,o=e.remove,a=void 0===o?function(){}:o;return i().createElement(qr,{glyph:"trash",visible:!0,noTooltipWhenDisabled:!0,disabled:n,className:"square-button-md no-border",tooltipId:"geostory.contentToolbar.remove",confirmTitle:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.removeConfirmTitle"}),confirmContent:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.removeConfirmContent"}),onClick:function(){a(r)}})};function Yr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yr(Object(n),!0).forEach((function(t){eo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function eo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var to={size:function(e){return{renderButton:i().createElement($r,e)}},align:function(e){return{renderButton:i().createElement(Kr,e)}},theme:function(e){return{renderButton:i().createElement(Qr,e)}},fit:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.fit,o=e.update,i=void 0===o?function(){}:o;return{value:r,glyph:"contain"===r?"fit-cover":"fit-contain",disabled:n,visible:!0,tooltipId:"contain"===r?"geostory.contentToolbar.cover":"geostory.contentToolbar.fit",onClick:function(){return i("fit","contain"===r?"cover":"contain")}}},cover:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.cover,o=e.updateSection,i=void 0===o?function(){}:o;return{value:r,glyph:r?"height-auto":"height-view",visible:!0,disabled:n,tooltipId:r?"geostory.contentToolbar.contentHeightAuto":"geostory.contentToolbar.contentHeightView",onClick:function(){return i({cover:!r},"merge")}}},editMedia:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.path,o=e.editMedia,i=void 0===o?function(){}:o;return{glyph:"pencil","data-button":"pencil",visible:!0,disabled:n,tooltipId:"geostory.contentToolbar.editMedia",onClick:function(){i({path:r})}}},remove:function(e){return{renderButton:i().createElement(Xr,e)}},editMap:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.update,o=void 0===r?function(){}:r;return{glyph:"map-edit",visible:!0,disabled:n,bsStyle:n?"success":"default",tooltipId:"geostory.contentToolbar.editMap",onClick:function(){o("editMap",!n)}}},editURL:function(e){var t=e.editURL,n=void 0!==t&&t,r=e.path,o=e.editWebPage,i=void 0===o?function(){}:o;return{glyph:"pencil",visible:!0,disabled:n,bsStyle:n?"success":"default",tooltipId:"geostory.contentToolbar.editURL",onClick:function(){i({path:r})}}},muted:function(e){var t=e.update,n=e.muted;return{glyph:n?"muted":"audio",visible:!0,active:!n,tooltipId:n?"geostory.contentToolbar.enableAudio":"geostory.contentToolbar.disableAudio",onClick:function(){t("muted",!n)}}},autoplay:function(e){var t=e.update,n=e.autoplay;return{glyph:"play-circle",visible:!("cover"===e.fit),active:n,tooltipId:n?"geostory.contentToolbar.disableAutoplay":"geostory.contentToolbar.enableAutoplay",onClick:function(){t("autoplay",!n)}}},loop:function(e){var t=e.update,n=e.loop;return{glyph:"loop",visible:!("cover"===e.fit),active:n,tooltipId:n?"geostory.contentToolbar.disableLoop":"geostory.contentToolbar.enableLoop",onClick:function(){t("loop",!n)}}},showCaption:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.update,o=e.showCaption,i=e.caption,a=e.description;return{glyph:"caption",visible:!(!i&&!a),disabled:n,active:!(!o||n),tooltipId:o?"geostory.contentToolbar.hideCaption":"geostory.contentToolbar.showCaption",onClick:function(){r("showCaption",!o)}}}};function no(e){var t=e.tools,n=void 0===t?[]:t,r=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["tools"]);return i().createElement("div",{className:"ms-content-toolbar"},i().createElement(or.Z,{btnDefaultProps:{className:"square-button-md no-border",noTooltipWhenDisabled:!0},buttons:n.filter((function(e){return(null==e?void 0:e.id)&&to[e.id]||to[e]})).map((function(e){return(null==e?void 0:e.id)&&to[e.id](Jr(Jr({},r),e))||to[e](r)}))}))}const ro=function(e){var t=e.id,n=e.inViewRef,r=e.children,o=e.type,a=e.contentWrapperStyle,c=e.contentToolbar,l=e.mode,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["id","inViewRef","children","type","contentWrapperStyle","contentToolbar","mode"]),u=c||no;return i().createElement("div",{id:t,ref:n,style:a,className:"ms-content ms-content-".concat(o).concat((0,p.w)(s))},i().createElement("div",{className:"ms-content-body",style:(0,p.cy)(s)},l===p.nl.EDIT&&i().createElement(u,s),r))};function oo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function io(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oo(Object(n),!0).forEach((function(t){ao(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ao(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var co=(0,Ce.compose)(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return Ce.nest.apply(void 0,t.concat([e]))}}(ro),(0,Ce.setDisplayName)("ColumnContent"))(nr),lo=function(e){return{id:"size",filterOptions:function(e){return"full"!==e.value},pullRight:e}};const so=(0,Ce.compose)((0,Ce.branch)((function(e){var t=e.type;return e.sectionType===p.ID.IMMERSIVE&&t===p.bT.COLUMN}),Tr({threshold:[0,.25,.5,.75]})),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return Ce.nest.apply(void 0,t.concat([e]))}}(ro),(0,Ce.setDisplayName)("SectionContent"),(0,Ce.branch)((function(e){return e.type===p.bT.COLUMN}),(0,Ce.renderComponent)((function(e){var t,n=e.viewWidth,r=e.viewHeight,o=e.contents,a=void 0===o?[]:o,c=e.mode,l=e.add,s=void 0===l?function(){}:l,u=e.editMedia,d=void 0===u?function(){}:u,f=e.editWebPage,y=void 0===f?function(){}:f,m=e.update,b=void 0===m?function(){}:m,v=e.remove,g=void 0===v?function(){}:v,h=e.bubblingTextEditing,O=void 0===h?function(){}:h,w=e.expandable,E=e.mediaViewer,P=e.contentToolbar,j=e.sections,S=void 0===j?[]:j,T=e.sectionType,C=e.overrideTools,k=e.storyFonts;return i().createElement(Pr,{className:"ms-column-contents",ContentComponent:co,contents:a,mode:c,add:s,editMedia:d,editWebPage:y,update:b,remove:g,viewWidth:n,viewHeight:r,bubblingTextEditing:O,sectionType:T,contentProps:{expandable:w,mediaViewer:E,contentToolbar:P},sections:S,storyFonts:k,tools:io((t={},ao(t,p.bT.TEXT,["remove"]),ao(t,p.Tr.IMAGE,["editMedia",lo(),"showCaption","remove"]),ao(t,p.Tr.MAP,["editMedia","editMap",lo(!0),"showCaption","remove"]),ao(t,p.bT.WEBPAGE,["editURL",lo(!0),"remove"]),ao(t,p.Tr.VIDEO,["editMedia","muted","autoplay","loop","showCaption","remove"]),t),C),addButtons:[{glyph:"sheet",tooltipId:"geostory.addTextContent",template:p.bT.TEXT},{glyph:"picture",tooltipId:"geostory.addMediaContent",template:p.bT.MEDIA},{glyph:"webpage",tooltipId:"geostory.addWebPageContent",template:p.bT.WEBPAGE}]})}))))(nr),uo=(0,Ce.compose)((0,Ce.defaultProps)({ContentComponent:so}),(0,Ce.withHandlers)({editMedia:function(e){var t=e.editMedia,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=e.path,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return n.apply(void 0,[{path:'sections[{"id": "'.concat(r,'"}].')+t}].concat(i))}},editWebPage:function(e){var t=e.editWebPage,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=e.path,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return n.apply(void 0,[{path:'sections[{"id": "'.concat(r,'"}].')+t}].concat(i))}},add:function(e){var t=e.add,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}},update:function(e){var t=e.update,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}},remove:function(e){var t=e.remove,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}}}),(0,Ce.setDisplayName)("SectionContents"))(Pr);function po(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fo(Object(n),!0).forEach((function(t){mo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,Ce.setObservableConfig)(ke.Z);var bo=(0,Ce.withProps)((function(e){var t=e.id,n=e.backgroundId,r=e.contents,o=function(e,t){var n=(0,Re.findIndex)(e,{id:t});return e[-1!==n&&n?n:0]}(void 0===r?[]:r,n)||{},i=o&&o.id;return{background:(0,Re.get)(o,"background")||{type:"none"},contentId:i,sectionId:t,path:'sections[{"id": "'.concat(t,'"}].contents[{"id": "').concat(i,'"}].background')}})),vo=(0,Ce.withHandlers)({updateBackground:function(e){var t=e.sectionId,n=e.contentId,r=e.update,o=void 0===r?function(){}:r;return function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return o.apply(void 0,['sections[{"id": "'.concat(t,'"}].contents[{"id": "').concat(n,'"}].background.')+e].concat(i))}},updateSection:function(e){var t=e.sectionId,n=e.update,r=void 0===n?function(){}:n;return function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return r.apply(void 0,['sections[{"id": "'.concat(t,'"}]')].concat(n))}}}),go=(0,Ce.compose)(bo,vo);const ho=(0,Ce.compose)((0,Ce.mapPropsStream)((function(e){var t=(0,Ce.createEventHandler)(),n=t.handler,r=t.stream;return b.Observable.combineLatest(e,function(e,t){var n=e.scan((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.visible,o=t.entry;return yo(yo({},e),{},mo({},n,{visible:r,entry:o}))}),{}).debounceTime(100).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{maxItem:(0,Re.maxBy)(Object.keys(e),(function(t){return e[t].visible?(0,Re.get)(e[t],"entry.intersectionRatio"):-1/0})),items:e}}));return b.Observable.merge(n.pluck("maxItem").distinctUntilChanged().map((function(e){return{backgroundId:e}})),n.map((function(e){var t=e.maxItem,n=e.items;return 0===(0,Re.get)(n[t],"entry.intersectionRatio")?"EMPTY":t})).withLatestFrom(t.pluck("updateCurrentPage")).do((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}}(t,n)||function(e,t){if(e){if("string"==typeof e)return po(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?po(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];return i&&i({columnId:o})})).ignoreElements())}(r,e).startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return yo(yo({},t.reduce((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return yo(yo({},e),t)}),{})),{},{onVisibilityChange:n})}))})),go);var Oo=n(89438);function wo(e){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Eo(){return(Eo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Po(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Po(Object(n),!0).forEach((function(t){xo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Po(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function So(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function To(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Co(e,t){return(Co=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ko(e,t){return!t||"object"!==wo(t)&&"function"!=typeof t?Io(e):t}function Io(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mo(e){return(Mo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ao=n(56936),No=n(83255),Do=n.n(No);function Ro(e){return(Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lo(Object(n),!0).forEach((function(t){zo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bo(){return(Bo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Wo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fo(e,t){return(Fo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vo(e,t){return!t||"object"!==Ro(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ho(e){return(Ho=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Uo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fo(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ho(r);if(o){var n=Ho(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Vo(this,e)});function c(){return Wo(this,c),a.apply(this,arguments)}return t=c,(n=[{key:"render",value:function(){var e=(0,p.cy)(this.props),t=!this.props.disableToolbarPortal&&this.refs&&this.refs.div&&this.refs.div.parentNode,n=this.props.sectionType===p.ID.TITLE?["editMedia","cover"]:["editMedia"],r=this.props.contentToolbar||no,o=i().createElement(r,Bo({},this.props,{themeProps:{disableBackgroundAlpha:!0,disableTextColor:!0,disableShadow:!0},tools:this.props.tools&&this.props.type&&this.props.tools[this.props.type]||this.props.sectionType===p.ID.BANNER&&[].concat(n,["cover","remove"])||n})),a="".concat(this.props.sectionId||"ms","-media-").concat(this.props.id||this.props.resourceId);return i().createElement("div",{ref:"div",className:"ms-section-background",style:_o({},this.props.style)},i().createElement("div",{className:"ms-section-background-container".concat((0,p.w)(this.props)),style:_o(_o({height:this.props.height},e),null!=gn&&gn[this.props.type]?{}:this.props.backgroundPlaceholder)},i().createElement(On,Bo({id:a},this.props,{enableFullscreen:!1,descriptionEnabled:!1,mediaViewer:this.props.mediaViewer,containerInView:this.props.inView})),this.props.mode===p.nl.EDIT&&(t?i().createElement(Ao.h_,{container:t},o):o)))}}])&&Zo(t.prototype,n),c}(o.Component);zo(Uo,"propTypes",{id:Fe().string,resourceId:Fe().string,sectionId:Fe().string,mode:Fe().string,fit:Fe().string,size:Fe().string,path:Fe().string,credits:Fe().string,description:Fe().string,height:Fe().number,width:Fe().number,tools:Fe().object,style:Fe().object,add:Fe().func,editMedia:Fe().func,update:Fe().func,updateSection:Fe().func,remove:Fe().func,type:Fe().oneOf(p.lg.MediaTypes),disableToolbarPortal:Fe().bool,backgroundPlaceholder:Fe().object,sectionType:Fe().string,src:Fe().string,theme:Fe().string,mediaViewer:Fe().func,contentToolbar:Fe().func,inView:Fe().bool}),zo(Uo,"defaultProps",{height:0,size:"full",width:0,style:{},backgroundPlaceholder:{background:"url(".concat(Do(),")"),backgroundSize:"256px auto"}});const Go=(qo=Uo,Ko=$o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Co(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Mo(r);if(o){var n=Mo(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ko(this,e)});function c(){var e;So(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return xo(Io(e=a.call.apply(a,[this].concat(n))),"state",{style:{}}),xo(Io(e),"update",(function(t){if(e._stickybits){var n=document.querySelector(t);-1===e._stickybits.definePosition().indexOf("sticky")&&n&&(e._stickybits.update(),setTimeout((function(){var t=n.getBoundingClientRect(),r=t.top,o=t.left;e.setState({style:{top:r,left:o,width:n.scrollWidth-2}})})))}})),e}return t=c,(n=[{key:"componentDidMount",value:function(){this._stickybits=this._node&&(0,Oo.Z)(this._node,{scrollEl:this.props.scrollContainerSelector,noStyles:!0,useGetBoundingClientRect:!0}),this.update(this.props.scrollContainerSelector)}},{key:"componentWillReceiveProps",value:function(e){!this._stickybits||e.viewWidth===this.props.viewWidth&&e.viewHeight===this.props.viewHeight||this.update(e.scrollContainerSelector)}},{key:"componentWillUnmount",value:function(){this._stickybits&&this._stickybits.cleanup()}},{key:"render",value:function(){var e=this;return i().createElement(qo,Eo({ref:function(t){t&&t.refs&&t.refs[e.props.refId]&&(e._node=t.refs[e.props.refId])},style:jo({},this.state.style)},this.props),this.props.children)}}])&&To(t.prototype,n),c}(o.Component),xo($o,"propTypes",{scrollContainerSelector:Fe().string,height:Fe().number,width:Fe().number,refId:Fe().string}),xo($o,"defaultProps",{scrollContainerSelector:"body",height:0,width:0,refId:"div"}),Ko);var qo,$o,Ko,Qo=n(11636),Xo=n.n(Qo);function Yo(){return(Yo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Jo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ei=(0,Ce.compose)(ho,(0,Ce.withStateHandlers)({textEditorActive:!1},{bubblingTextEditing:function(){return function(e){return{textEditorActiveClass:e?" ms-text-editor-active":""}}}}))((function(e){var t,n=e.add,r=void 0===n?function(){}:n,o=e.editMedia,a=void 0===o?function(){}:o,c=e.editWebPage,l=void 0===c?function(){}:c,s=e.onVisibilityChange,u=void 0===s?function(){}:s,d=e.update,f=void 0===d?function(){}:d,y=e.updateBackground,m=void 0===y?function(){}:y,b=e.updateCurrentPage,v=void 0===b?function(){}:b,g=e.remove,h=void 0===g?function(){}:g,O=e.id,w=e.background,E=void 0===w?{}:w,P=e.path,j=e.contents,S=void 0===j?[]:j,T=e.mode,C=e.sectionType,k=e.inViewRef,I=e.viewWidth,M=e.viewHeight,x=e.focusedContent,A=e.contentId,N=e.bubblingTextEditing,D=void 0===N?function(){}:N,R=e.textEditorActiveClass,L=void 0===R?"":R,_=e.expandableMedia,B=void 0!==_&&_,W=e.storyTheme,Z=e.mediaViewer,F=e.contentToolbar,V=e.inView,H=e.sections,z=void 0===H?[]:H,U=e.storyFonts,G=x&&x.hideContent&&(0,Re.get)(x,"target.id")===A,q=G?"hidden":"visible",$=B&&E&&"map"===E.type?" ms-expandable-background":"",K=(null==W?void 0:W.overlay)||{},Q=(null==W?void 0:W.general)||{};return i().createElement("section",{className:"ms-section ms-section-immersive".concat($),id:O,ref:k},i().createElement(Go,Yo({},E,{mode:T,disableToolbarPortal:!0,tools:(t={},Jo(t,p.Tr.IMAGE,["editMedia","fit","size","align","theme"]),Jo(t,p.Tr.MAP,["editMedia","editMap","size","align","theme"]),Jo(t,p.Tr.VIDEO,["editMedia","fit","size","align","theme","muted","autoplay","loop"]),t),scrollContainerSelector:"#ms-sections-container",add:r,editMedia:a,expandable:B,path:P,update:m,updateCurrentPage:v,remove:h,sectionType:C,sectionId:O,backgroundId:E.id,key:E.id,width:I,height:M,backgroundPlaceholder:{background:"url(".concat(Xo(),")"),backgroundSize:"600px auto"},storyTheme:Q,mediaViewer:Z,contentToolbar:F,inView:V})),i().createElement(uo,{tools:Jo({},p.bT.COLUMN,["size","align","theme"]),className:"ms-section-contents".concat(L),contents:S,mode:T,add:r,updateCurrentPage:v,editMedia:a,editWebPage:l,update:f,remove:h,sectionId:O,viewWidth:I,viewHeight:M,contentProps:{onVisibilityChange:u,contentWrapperStyle:{minHeight:M,visibility:q},expandable:B,mediaViewer:Z,contentToolbar:F},focusedContent:x,bubblingTextEditing:D,sectionType:C,storyTheme:K,sections:z,storyFonts:U}),T===p.nl.EDIT&&!G&&i().createElement(mr,{containerWidth:I,containerHeight:M,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){r("sections",O,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){r("sections",O,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){r("sections",O,p.ID.PARAGRAPH)}},{glyph:"story-immersive-content",tooltipId:"geostory.addImmersiveContent",onClick:function(){r('sections[{"id": "'.concat(O,'"}].contents'),void 0,p.bT.COLUMN)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){r("sections",O,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){r("sections",O,p.tQ.WEBPAGE)}}]}))})),ti=function(e){var t,n,r,o=e.id,a=e.contents,c=e.mode,l=e.add,s=void 0===l?function(){}:l,u=e.update,d=void 0===u?function(){}:u,f=e.editMedia,y=void 0===f?function(){}:f,m=e.editWebPage,b=void 0===m?function(){}:m,v=e.remove,g=void 0===v?function(){}:v,h=e.inViewRef,O=e.viewWidth,w=e.viewHeight,E=e.expandableMedia,P=e.mediaViewer,j=e.contentToolbar,S=e.sections,T=void 0===S?[]:S,C=e.sectionType,k=e.storyFonts;return i().createElement("section",{className:"ms-section ms-section-paragraph",id:o,ref:h},i().createElement(uo,{className:"ms-section-contents",contents:a,mode:c,add:s,editMedia:y,editWebPage:b,update:d,remove:g,sectionId:o,viewWidth:O,viewHeight:w,sectionType:C,contentProps:{expandable:E,mediaViewer:P,contentToolbar:j,overrideTools:(t={},n=p.bT.TEXT,r=[(!0,{id:"size",filterOptions:function(e){return"full"!==e.value},pullRight:true}),"remove"],n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t)},sections:T,storyFonts:k}),c===p.nl.EDIT&&i().createElement(mr,{containerWidth:O,containerHeight:w,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){s("sections",o,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){s("sections",o,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){s("sections",o,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){s("sections",o,p.ID.IMMERSIVE)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){s("sections",o,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){s("sections",o,p.tQ.WEBPAGE)}}]}))};var ni=n(75492),ri=n.n(ni);function oi(){return(oi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ii(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ai=(0,Ce.compose)(go,(0,Ce.withStateHandlers)({textEditorActive:!1},{bubblingTextEditing:function(){return function(e){return{textEditorActiveClass:e?" ms-text-editor-active":""}}}}))((function(e){var t=e.id,n=e.background,r=void 0===n?{}:n,o=e.contents,a=void 0===o?[]:o,c=e.mode,l=e.contentId,s=e.path,u=e.sectionType,d=e.cover,f=e.viewWidth,y=e.viewHeight,m=e.inViewRef,b=e.add,v=void 0===b?function(){}:b,g=e.update,h=void 0===g?function(){}:g,O=e.updateSection,w=void 0===O?function(){}:O,E=e.remove,P=void 0===E?function(){}:E,j=e.updateBackground,S=void 0===j?function(){}:j,T=e.editMedia,C=void 0===T?function(){}:T,k=e.focusedContent,I=e.bubblingTextEditing,M=void 0===I?function(){}:I,x=e.textEditorActiveClass,A=void 0===x?"":x,N=e.expandableMedia,D=void 0!==N&&N,R=e.storyTheme,L=e.mediaViewer,_=e.contentToolbar,B=e.inView,W=e.sections,Z=void 0===W?[]:W,F=e.storyFonts,V=(0,Re.get)(k,"target.id")===l,H=V?"hidden":"visible",z=D&&r&&"map"===r.type?" ms-expandable-background":"",U=(null==R?void 0:R.overlay)||{},G=(null==R?void 0:R.general)||{};return i().createElement("section",{ref:m,className:"ms-section ms-section-title".concat(z),id:t},i().createElement(Te.Z,null,(function(e){var t,n=e.height;return i().createElement(Go,oi({},r,{scrollContainerSelector:"#ms-sections-container",key:r.id,mode:c,id:l,path:s,update:S,add:v,editMedia:C,expandable:D,updateSection:w,cover:d,remove:P,width:f,sectionType:u,backgroundPlaceholder:{background:"url(".concat(d?Do():ri(),")"),backgroundSize:"".concat(d?64:600,"px auto")},tools:(t={},ii(t,p.Tr.IMAGE,["editMedia","cover","fit","size","align","theme"]),ii(t,p.Tr.MAP,["editMedia","cover","editMap","size","align","theme"]),ii(t,p.Tr.VIDEO,["editMedia","cover","fit","size","align","theme","muted","autoplay","loop"]),t),height:n>=y?y:n,storyTheme:G,mediaViewer:L,contentToolbar:_,inView:B}))})),i().createElement(uo,{className:"ms-section-contents".concat(A),contents:a,mode:c,add:v,sectionType:u,update:h,remove:P,sectionId:t,contentProps:{contentWrapperStyle:d?{minHeight:y,visibility:H}:{visibility:H},mediaViewer:L,contentToolbar:_},tools:ii({},p.bT.TEXT,["size","align","theme","remove"]),focusedContent:k,bubblingTextEditing:M,storyTheme:U,sections:Z,storyFonts:F}),c===p.nl.EDIT&&!V&&i().createElement(mr,{containerWidth:f,containerHeight:y,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){v("sections",t,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){v("sections",t,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){v("sections",t,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){v("sections",t,p.ID.IMMERSIVE)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){v("sections",t,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){v("sections",t,p.tQ.WEBPAGE)}}]}))}));function ci(){return(ci=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function li(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const si=(0,Ce.compose)(go,(0,Ce.withStateHandlers)({textEditorActive:!1}))((function(e){var t=e.id,n=e.background,r=void 0===n?{}:n,o=e.mode,a=e.contentId,c=e.path,l=e.sectionType,s=void 0===l?p.ID.BANNER:l,u=e.cover,d=e.viewWidth,f=e.viewHeight,y=e.inViewRef,m=e.add,b=void 0===m?function(){}:m,v=e.updateSection,g=void 0===v?function(){}:v,h=e.remove,O=void 0===h?function(){}:h,w=e.updateBackground,E=void 0===w?function(){}:w,P=e.editMedia,j=void 0===P?function(){}:P,S=e.focusedContent,T=e.expandableMedia,C=void 0!==T&&T,k=e.storyTheme,I=e.mediaViewer,M=e.contentToolbar,x=e.inView,A=(0,Re.get)(S,"target.id")===a,N=C&&r&&"map"===r.type?" ms-expandable-background":"",D=c.replace(".background","");return i().createElement("section",{ref:y,className:"ms-section ms-section-banner".concat(N),id:t},i().createElement(Te.Z,null,(function(e){var t,n=e.height;return i().createElement(Go,ci({},r,{scrollContainerSelector:"#ms-sections-container",key:r.id,mode:o,id:a,path:c,update:E,add:b,editMedia:j,expandable:C,updateSection:g,cover:u,remove:function(){return O(D)},width:d,sectionType:s,backgroundPlaceholder:{background:"url(".concat(u?Do():ri(),")"),backgroundSize:"".concat(u?64:600,"px auto")},tools:(t={},li(t,p.Tr.IMAGE,["editMedia","cover","fit","size","align","theme","remove"]),li(t,p.Tr.MAP,["editMedia","cover","editMap","size","align","theme","remove"]),li(t,p.Tr.VIDEO,["editMedia","cover","fit","size","align","theme","muted","autoplay","loop","remove"]),t),height:n>=f?f:n,storyTheme:k,mediaViewer:I,contentToolbar:M,inView:x}))})),i().createElement("div",{style:{minHeight:u?f:300,pointerEvents:"none"}}),o===p.nl.EDIT&&!A&&i().createElement(mr,{containerWidth:d,containerHeight:f,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){b("sections",t,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){b("sections",t,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){b("sections",t,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){b("sections",t,p.ID.IMMERSIVE)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){b("sections",t,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){b("sections",t,p.tQ.WEBPAGE)}}]}))}));function ui(e){return(ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var pi;function di(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yi(e,t){return(yi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mi(e,t){return!t||"object"!==ui(t)&&"function"!=typeof t?bi(e):t}function bi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vi(e){return(vi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hi=(gi(pi={},p.ID.IMMERSIVE,ei),gi(pi,p.ID.PARAGRAPH,ti),gi(pi,p.tQ.MEDIA,ti),gi(pi,p.tQ.WEBPAGE,ti),gi(pi,p.ID.TITLE,ai),gi(pi,p.ID.BANNER,si),gi(pi,"UNKNOWN",(function(e){var t=e.type,n=e.inViewRef;return i().createElement("div",{ref:n,className:"ms-section ms-section-unknown"},"WARNING: unknown session of type ",t)})),pi),Oi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yi(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=vi(r);if(o){var n=vi(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return mi(this,e)});function c(){var e;di(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return gi(bi(e=a.call.apply(a,[this].concat(n))),"state",{height:0}),e}return t=c,(n=[{key:"render",value:function(){var e=hi[this.props.type]||hi.UNKNOWN;return i().createElement(e,{sectionType:this.props.type,id:this.props.id,add:this.props.add,update:this.props.update,inViewRef:this.props.inViewRef,editMedia:this.props.editMedia,expandableMedia:this.props.expandableMedia,editWebPage:this.props.editWebPage,updateCurrentPage:this.props.updateCurrentPage,remove:this.props.remove,mode:this.props.mode,cover:this.props.cover,contents:this.props.contents,viewWidth:this.props.viewWidth,viewHeight:this.props.viewHeight,focusedContent:this.props.focusedContent,storyTheme:this.props.storyTheme,mediaViewer:this.props.mediaViewer,contentToolbar:this.props.contentToolbar,inView:this.props.inView,sections:this.props.sections,storyFonts:this.props.storyFonts})}}])&&fi(t.prototype,n),c}(i().Component);gi(Oi,"propTypes",{id:Fe().string,type:Fe().oneOf(p.lg.SectionTypes),storyType:Fe().oneOf(p.lg.StoryTypes),add:Fe().func,update:Fe().func,editMedia:Fe().func,editWebPage:Fe().func,remove:Fe().func,updateCurrentPage:Fe().func,mode:Fe().oneOf(p.lg.Modes),contents:Fe().array,viewHeight:Fe().number,viewWidth:Fe().number,inViewRef:Fe().func,excludeClassName:Fe().string,cover:Fe().bool,focusedContent:Fe().object,expandableMedia:Fe().bool,storyTheme:Fe().object,mediaViewer:Fe().func,contentToolbar:Fe().func,inView:Fe().bool,sections:Fe().array,storyFonts:Fe().array}),gi(Oi,"defaultProps",{id:"",add:function(){},update:function(){},editMedia:function(){},editWebPage:function(){},updateCurrentPage:function(){},remove:function(){},storyType:p.Ln.CASCADE,viewHeight:0,viewWidth:0,mode:p.nl.VIEW,expandableMedia:!1,sections:[],storyFonts:[]});const wi=Tr({threshold:[0,.25,.5,.75,1],rootMargin:"-200px 0px 0px 0px"})(Oi);function Ei(e){return(Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ji(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Si(e,t){return(Si=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ti(e,t){return!t||"object"!==Ei(t)&&"function"!=typeof t?Ci(e):t}function Ci(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ki(e){return(ki=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ii(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Si(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ki(r);if(o){var n=ki(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ti(this,e)});function c(){var e;Pi(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ii(Ci(e=a.call.apply(a,[this].concat(n))),"getAdjustedSelector",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/#\d|^#-\d/g,(function(e,t){return t?"#\\"+t[1]+t[2]:"#\\3"+e[1]+" "}))})),Ii(Ci(e),"getFocusedTarget",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.targets,n=e.props.padding,r=void 0===n?{}:n;return t.map((function(t){var n=t.selector,o=null;try{var i=window.document.querySelector(e.getAdjustedSelector(n));if(i){var a=i.getBoundingClientRect(),c=a.top,l=a.right,s=a.bottom,u=a.left;o={x:u-r,y:c-r,w:l-u+2*r,h:s-c+2*r}}}catch(e){console.warn(e)}finally{return o}})).filter((function(e){return e}))})),Ii(Ci(e),"getHolePath",(function(t){var n=t.x,r=t.y,o=t.w,i=t.h,a=e.props.borderRadius,c=void 0===a?8:a;return"M ".concat(n," ").concat(r+c," q 0 -").concat(c," ").concat(c," -").concat(c," h ").concat(o-2*c," q ").concat(c," 0 ").concat(c," ").concat(c," v ").concat(i-2*c," q 0 ").concat(c," -").concat(c," ").concat(c," h-").concat(o-2*c," q -").concat(c," 0 -").concat(c," -").concat(c," v-").concat(i-2*c)})),Ii(Ci(e),"getPath",(function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getFocusedTarget(),o="M 0 0 h ".concat(n," v ").concat(t," h -").concat(n," v -").concat(t),i=r.map(e.getHolePath);return o+i.join(" ")})),e}return t=c,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.onMaskClicked,r=t.stopEventsOnTargets,o=void 0!==r&&r,a=t.targets,c=this.getFocusedTarget(a.filter((function(e){var t=e.stopEventsOnTarget;return o||t})));return i().createElement("div",{style:{position:"fixed",height:"100vh",width:"100vw",top:0,left:0,zIndex:1e6,pointerEvents:"none"}},i().createElement(Te.Z,null,(function(t){var r=t.width,o=t.height;return i().createElement("svg",{width:r,height:o,xmlns:"http://www.w3.org/2000/svg"},i().createElement("path",{d:e.getPath(o,r),fill:"rgba(0,0,0,0.7)",fillRule:"evenodd",pointerEvents:"visiblePainted",onClick:n}),c.map((function(t,n){return i().createElement("path",{key:n,d:e.getHolePath(t),fill:"transparent",pointerEvents:"visiblePainted"})})))})))}}])&&ji(t.prototype,n),c}(i().Component);function xi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ai(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xi(Object(n),!0).forEach((function(t){Ni(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ni(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ii(Mi,"propTypes",{targets:Fe().arrayOf(Fe().shape({selector:Fe().string,stopEventsOnTarget:Fe().bool})),padding:Fe().number,borderRadius:Fe().number,onMaskClicked:Fe().func,stopEventsOnTargets:Fe().bool}),Ii(Mi,"defaultProps",{targets:[],padding:0,borderRadius:8,onMaskClicked:function(){},stopEventsOnTargets:!1});var Di=(0,De.Z)((function(e){var t=e.sections;return 0===(void 0===t?[]:t).length}),(function(e){var t=e.add,n=void 0===t?function(){}:t;return{iconFit:!1,style:{position:"relative",width:"50%",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},glyph:"geostory",title:i().createElement(Cn.Z,{msgId:"geostory.emptyTitle"}),description:i().createElement(Cn.Z,{msgId:"geostory.emptyDescription"}),content:i().createElement(mr,{addButtonClassName:"square-button-md",containerWidth:"100%",containerHeight:"100%",buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){n("sections",0,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){n("sections",0,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){n("sections",0,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveContent",onClick:function(){n("sections",0,p.ID.IMMERSIVE)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){n("sections",0,p.tQ.MEDIA)}},{glyph:"code",tooltipId:"geostory.addWebPageSection",onClick:function(){n("sections",0,p.tQ.WEBPAGE)}}]})}}))(Te.Z),Ri=function(e){var t=e.width;return e.mode===p.nl.EDIT?"":t<640?"sm":t>=640&&t<1024?"md":""};const Li=(0,Ce.compose)(Ne,We,function(e){var t=e.showFocusMask,n=void 0===t?function(){}:t,r=e.defaultTargets,o=void 0===r?{selector:".ms-geostory-map-editor"}:r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=a.padding,l=void 0===c?0:c,s=a.borderRadius,u=void 0===s?8:s,p=a.stopEventsOnTargets,d=void 0!==p&&p,f=a.onMaskClicked,y=void 0===f?function(){}:f;return(0,Ce.branch)(n,(function(e){return(0,Ce.nest)((function(e){var t=e.focusedContent,n=e.children;return i().createElement(i().Fragment,null,n,i().createElement(Mi,{targets:[t,o],padding:l,borderRadius:u,stopEventsOnTargets:d,onMaskClicked:y}))}),e)}))}({showFocusMask:function(e){var t=e.focusedContent,n=(t=void 0===t?{}:t).target;return(void 0===n?{}:n).id}}))((function(e){var t=e.mode,n=void 0===t?p.nl.VIEW:t,r=e.sections,o=void 0===r?[]:r,a=e.add,c=void 0===a?function(){}:a,l=e.onVisibilityChange,s=void 0===l?function(){}:l,u=e.updateCurrentPage,d=void 0===u?function(){}:u,f=e.editMedia,y=void 0===f?function(){}:f,m=e.editWebPage,b=void 0===m?function(){}:m,v=e.update,g=void 0===v?function(){}:v,h=e.remove,O=void 0===h?function(){}:h,w=e.focusedContent,E=e.isContentFocused,P=void 0!==E&&E,j=e.getSize,S=void 0===j?Ri:j,T=e.theme,C=void 0===T?{}:T,k=e.mediaViewer,I=e.contentToolbar,M=e.storyFonts;return i().createElement(Se.Z,{className:"ms-cascade-story ms-".concat(n)},i().createElement(Di,{sections:o,add:c},(function(e){var t,r=e.width,a=e.height,l=S({width:r,height:a,mode:n}),u=l?" ms-".concat(l):"",p="sm"===l,f=C&&Vr()(C)&&C||{};return i().createElement("div",{id:"ms-sections-container",className:"ms-sections-container".concat(u," ms-sections-hyperlinks"),style:Ai(Ai({},null==f?void 0:f.general),P&&{overflow:"hidden"})},(null==f||null===(t=f.link)||void 0===t?void 0:t.color)&&i().createElement("style",{dangerouslySetInnerHTML:{__html:"\n            .ms-sections-hyperlinks .ms-text-editor-main a,\n            .ms-sections-hyperlinks .ms-text-wrapper a,\n            .ms-sections-hyperlinks .ms-text-editor-main a:link,\n            .ms-sections-hyperlinks .ms-text-wrapper a:link,\n            .ms-sections-hyperlinks .ms-text-editor-main a:visited,\n            .ms-sections-hyperlinks .ms-text-wrapper a:visited,\n            .ms-sections-hyperlinks .ms-text-editor-main a:active,\n            .ms-sections-hyperlinks .ms-text-wrapper a:active {\n                color: ".concat(f.link.color,";\n                opacity: 1;\n            }\n            .ms-sections-hyperlinks .ms-text-editor-main a:hover,\n            .ms-sections-hyperlinks .ms-text-wrapper a:hover {\n                color: ").concat(f.link.color,";\n                opacity: 0.75;\n            }\n        ")}}),o.map((function(e){var t=e.contents,l=void 0===t?[]:t,u=e.id,m=e.type,v=e.cover;return i().createElement(wi,{focusedContent:w,onVisibilityChange:s,add:c,editMedia:y,expandableMedia:p,editWebPage:b,updateCurrentPage:d,update:g,remove:O,key:u,id:u,viewHeight:a,viewWidth:r,type:m,mode:n,contents:l,cover:v,storyTheme:f,mediaViewer:k,contentToolbar:I,sections:o,storyFonts:M})})))})))}));var _i=n(55877),Bi=n.n(_i),Wi=n(48860);function Zi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fi(){return(Fi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Vi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vi(Object(n),!0).forEach((function(t){zi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ui=(0,Wr.Z)(Cr.Z);const Gi=(0,Ce.compose)((0,a.connect)((0,c.P1)(U.jq,U.z7,(function(e,t){return{resources:e,isContentFocused:t}}))),(0,Ce.withProps)((function(e){var t=e.resources,n=e.resourceId,r=e.map,o=void 0===r?{}:r,i=Hi(Hi({},o),{},{layers:(o.layers||[]).map((function(e){return e||void 0}))}),a=(0,Re.find)(t,{id:n})||{};return{map:(0,p.oH)(a.data,i)}})));var qi=(0,Ce.compose)((0,a.connect)((0,c.P1)(U.GC,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{focusedEl:e}}))),(0,Ce.withProps)((function(e){var t=e.focusedEl,n=(t=void 0===t?{}:t).resourceId,r=t.map;return{map:r||{},resourceId:n,disableReset:!r}}))),$i=(0,Ce.withHandlers)({onChangeMap:function(e){var t=e.update,n=e.focusedContent,r=void 0===n?{}:n;return function(e,n){t("".concat(r.path,".map.").concat(e),n,"merge")}},onChange:function(e){var t=e.update,n=e.focusedContent,r=void 0===n?{}:n;return function(e,n){t(r.path+".".concat(e),n,"merge")}}}),Ki=(0,Ce.compose)((0,a.connect)(null,{toggleAdvancedEditing:K.$Z}),(0,Ce.withHandlers)({toggleAdvancedEditing:function(e){var t=e.toggleAdvancedEditing,n=void 0===t?function(){}:t,r=e.map,o=void 0===r?{}:r;return function(){var e=o.id,t=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(o,["id"]);n("inlineEditor",{data:t,id:e})}}})),Qi=(0,Ce.withHandlers)({toggleEditing:function(e){var t=e.editMap,n=e.update,r=e.focusedContent;return function(){return n(r.path+".editMap",!t)}},onReset:function(e){var t=e.update,n=e.focusedContent,r=(n=void 0===n?{}:n).path,o=void 0===r?"":r;return function(){t(o+".map",void 0)}},discardAndClose:function(e){var t=e.update,n=e.focusedContent,r=void 0===n?{}:n;return function(e){t(r.path+".map",e),t(r.path+".editMap",!1)}}}),Xi=function(e){return i().createElement(Ui,Fi({glyph:"repeat",bsStyle:"primary",className:"square-button-md no-border",tooltipId:"geostory.contentToolbar.resetMap",confirmTitle:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.resetMapConfirm"}),confirmContent:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.resetConfirmContent"})},e))},Yi=(0,Ce.compose)((0,Ce.withProps)((function(e){var t=e.pendingChanges,n=e.toggleEditing,r=e.disableReset,o=e.onReset,a=e.toggleAdvancedEditing,c=void 0===a?function(){}:a;return{buttons:[{glyph:"floppy-disk",disabled:!t,tooltipId:"geostory.contentToolbar.saveChanges",onClick:n},{renderButton:i().createElement(Xi,{disabled:r,onClick:o})},{glyph:"pencil",tooltipId:"geostory.contentToolbar.advancedMapEditor",onClick:c}]}})),Wi.Z,(0,Ce.withStateHandlers)((function(){return{editNode:void 0}}),{setEditNode:function(){return function(e){return{editNode:e}}},closeNodeEditor:function(){return function(){return{editNode:void 0}}}}),(0,Ce.branch)((function(e){return!!e.editNode}),(0,Ce.withProps)((function(e){var t=e.selectedNodes,n=void 0===t?[]:t,r=e.closeNodeEditor,o=void 0===r?function(){}:r;return{buttons:[{visible:1===n.length,tooltipId:"close",glyph:"1-close",onClick:o}]}})),(0,Ce.withProps)((function(e){var t,n=e.selectedNodes,r=void 0===n?[]:n,o=e.setEditNode,i=void 0===o?function(){}:o,a=e.buttons,c=void 0===a?[]:a;return{buttons:[{visible:1===r.length,glyph:"wrench",tooltipId:"toc.toolLayerSettingsTooltip",onClick:function(){i(r[0])}}].concat((t=c,function(e){if(Array.isArray(e))return Zi(e)}(t)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return Zi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zi(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}})))),Ji=(0,Ce.compose)((0,Ce.withPropsOnChange)(["focusedContent"],(function(e){var t=e.map,n=e.focusedEl;return{contentMap:(n=void 0===n?{}:n).map,lastSavedMap:t}})),(0,Ce.withPropsOnChange)(["map"],(function(e){var t=e.map,n=e.lastSavedMap;return{pendingChanges:!(0,Re.isEqual)(n,t)}}))),ea=(0,Ce.compose)((0,Ce.withProps)((function(e){var t=e.toggleEditing;return{CloseBtn:function(e){return i().createElement(Cr.Z,Fi({onClick:t},e))}}})),(0,Ce.branch)((function(e){return e.pendingChanges}),(0,Ce.withProps)((function(e){var t=e.discardAndClose,n=e.contentMap;return{CloseBtn:function(e){return i().createElement(Ui,Fi({onClick:function(){return t(n)},confirmTitle:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.confirmCloseMapEditing"}),confirmContent:i().createElement(Cn.Z,{msgId:"geostory.contentToolbar.pendingChangesDiscardConfirm"})},e))}}})))),ta=(0,Ce.mapPropsStream)((function(e){var t=(0,Ce.createEventHandler)(),n=t.stream,r=t.handler;return e.pluck("map").distinctUntilChanged((function(e,t){return(0,Re.isEqual)(e,t)})).switchMap((function(e){return n.map((function(t){return{map:Hi(Hi({},e),t)}})).startWith({map:e})})).combineLatest(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Hi(Hi({},n),{},{onMapViewLocalChanges:r,map:t})}))})),na=function(e,t){return void 0!==e&&void 0!==t&&e.toFixed(12)-t.toFixed(12)==0},ra=(0,Ce.withHandlers)({onMapViewChanges:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.update,n=e.editMap,r=void 0!==n&&n,o=e.onMapViewLocalChanges,i=e.map,a=(i=void 0===i?{}:i).center,c=void 0===a?{}:a,l=i.zoom;return function(e){var n=e.center,i=void 0===n?{}:n,a=e.zoom,s=e.mapStateSource,u=e.resolution,p=na(c.x,i.x)&&na(c.y,i.y);!r||p&&l===a?o({center:i,zoom:a,mapStateSource:s,resolution:u}):t("map",{center:i,zoom:a,mapStateSource:Bi()(),resolution:u},"merge")}}}),oa=n(5993),ia=n(75927),aa=n(51768);function ca(){return(ca=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function la(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var sa=(0,an.Z)(Kt.NavItem);var ua=n(79105),pa=n(43129),da=n(45869),fa=n(87320),ya=(0,Ve.Z)(["placeholder","options"])(pa.ZP);const ma=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,n=void 0===t?{zoomControl:!0,mapInfoControl:!1}:t,r=e.onChangeMap,o=void 0===r?function(){}:r,a=n&&n.mapOptions||{},c=(0,p.kn)({mapOptions:a,zoomControl:!!(0,Re.isNil)(n.zoomControl)||n.zoomControl,mapInfoControl:!(0,Re.isNil)(n.mapInfoControl)&&n.mapInfoControl});return i().createElement(Kt.Form,{className:"ms-geostory-map-controls"},i().createElement(Kt.FormGroup,null,i().createElement(Kt.ControlLabel,null,i().createElement(Cn.Z,{msgId:"geostory.mapEditor.zoom"})),i().createElement(da.Z,{onChange:function(){var e=!c.zoomControl;o("zoomControl",e),o("mapOptions.interactions",{doubleClickZoom:e,shiftDragZoom:e,pinchZoom:e})},className:"ms-geostory-map-controls-switch",checked:c.zoomControl}),i().createElement(ya,{options:[{label:"geostory.mapEditor.topLeft",value:"topLeft"},{label:"geostory.mapEditor.topRight",value:"topRight"},{label:"geostory.mapEditor.bottomLeft",value:"bottomLeft"},{label:"geostory.mapEditor.bottomRight",value:"bottomRight"}],wrapperStyle:{marginTop:"10px"},value:c.mapOptions&&c.mapOptions.zoomPosition||"topLeft",clearable:!1,disabled:!c.zoomControl,onChange:function(e){return o("mapOptions.zoomPosition",e&&e.value?e.value:"topLeft")},placeholder:"geostory.builder.settings.titlePlaceholder"})),i().createElement(Kt.FormGroup,null,i().createElement(Kt.ControlLabel,null,i().createElement(Cn.Z,{msgId:"geostory.mapEditor.pan"})),i().createElement(da.Z,{onChange:function(){var e=!(c.mapOptions&&c.mapOptions.interactions&&c.mapOptions.interactions.dragPan);o("mapOptions.interactions",{dragPan:e,keyboardPan:e})},className:"ms-geostory-map-controls-switch",checked:c.mapOptions&&c.mapOptions.interactions&&c.mapOptions.interactions.dragPan})),i().createElement(Kt.FormGroup,null,i().createElement(Kt.ControlLabel,null,i().createElement(Cn.Z,{msgId:"geostory.mapEditor.identify"})),i().createElement(da.Z,{onChange:function(){var e=!c.mapInfoControl;o("mapInfoControl",e)},className:"ms-geostory-map-controls-switch",checked:c.mapInfoControl}),c.mapInfoControl&&i().createElement(fa.Z,{disabled:!c.mapInfoControl,popoverMessage:"geostory.builder.settings.templateTooltip",infoFormat:c.mapOptions&&c.mapOptions.mapInfoFormat||"application/json",onInfoFormatChange:function(e){return o("mapOptions.mapInfoFormat",e)},selectProps:{wrapperStyle:{marginTop:10}}})))};var ba=n(16701),va=(0,Ce.withProps)((function(e){return{tabs:e.tabs||[{id:"toc",titleId:"geostory.mapEditor.toc",tooltipId:"geostory.mapEditor.toc",glyph:"1-layer",visible:!0,Component:ba.Z},{id:"settings",titleId:"geostory.mapEditor.settings",tooltipId:"geostory.mapEditor.settings",glyph:"wrench",visible:!0,Component:ma}]}}));const ga=(0,Ce.compose)((0,ua.Z)("activeTab","setActiveTab","toc"),va);var ha=(0,Ce.compose)(aa.Z,(0,Ce.withProps)((function(e){var t=e.selectedNode;return{title:t&&t.title}})),(0,oa.Z)("title"))((function(e){var t=e.title,n=e.description;return i().createElement("div",{className:"text-center"},i().createElement("div",{className:"mapstore-step-title"},t),i().createElement("div",{className:"mapstore-step-description"},n))})),Oa=(0,aa.Z)(ia.Z),wa=ga((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tabs,n=void 0===t?[]:t,r=e.activeTab,o=(e.width,e.setActiveTab),a=void 0===o?function(){}:o,c=la(e,["tabs","activeTab","width","setActiveTab"]);return i().createElement("div",{key:"ms-geostory-map-settings-navbar",className:"ms-row-tab"},i().createElement("div",null,i().createElement(Kt.Nav,{bsStyle:"tabs",activeKey:r,justified:!0},n.map((function(e){return i().createElement(sa,{key:"ms-tab-settings-"+e.id,tooltipId:e.tooltipId,eventKey:e.id,onClick:function(){return a(e.id)}},i().createElement(Kt.Glyphicon,{glyph:e.glyph}))})))),i().createElement("div",null,n.filter((function(e){return e.id&&e.id===r})).filter((function(e){return e.Component})).map((function(e){return i().createElement(e.Component,ca({},c,{key:"ms-geostory-tab-settings-body-"+e.id}))}))))}));const Ea=(0,Ce.branch)((function(e){var t=e.focusedContent;return(t=void 0===t?{}:t).path}),(0,Ce.compose)((0,Ce.defaultProps)({isFocused:!0,editMap:!0}),qi,Gi,Ji,$i,Qi,Ki,Yi,ea))((function(e){var t=e.mode,n=void 0===t?p.nl.VIEW:t,r=e.isFocused,o=void 0!==r&&r,a=e.map,c=void 0===a?{}:a,l=e.onChange,s=void 0===l?function(){}:l,u=e.onChangeMap,d=void 0===u?function(){}:u,f=e.onNodeSelect,y=void 0===f?function(){}:f,m=e.selectedNodes,b=e.buttons,v=void 0===b?[]:b,g=e.editNode,h=e.closeNodeEditor,O=e.CloseBtn,w=void 0===O?function(){return null}:O;return n===p.nl.EDIT&&o?i().createElement("div",{key:"left-column",style:{order:-1,width:400,position:"relative"}},i().createElement(Se.Z,{className:"ms-geostory-map-editor",header:i().createElement("div",{className:"ms-geostory-map-editor-header text-center"},i().createElement(Kt.Row,null,i().createElement(Kt.Col,{md:12,className:"text-center",style:{overflow:"hidden",lineHeight:"52px"}},i().createElement(w,{glyph:"1-close",className:"pull-left on-close-btn square-button no-border ",tooltipId:"geostory.contentToolbar.closeMapEditing"}),i().createElement("div",{className:"mapstore-step-title"},i().createElement(Cn.Z,{msgId:"geostory.mapEditor.configureMapOptions"})))),i().createElement(or.Z,{transitionProps:!1,btnGroupProps:{className:"ms-geostory-map-editor-toolbar"},btnDefaultProps:{className:"square-button-md no-border",bsStyle:"primary",noTooltipWhenDisabled:!0},buttons:v}))},!!g&&[i().createElement(ha,{map:c,editNode:g}),i().createElement(Oa,{closeNodeEditor:h,editNode:g,map:c,onChange:s})]||[i().createElement(wa,{map:c,onChange:s,onChangeMap:d,selectedNodes:m,onSelect:y})])):null}));function Pa(){return(Pa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ja(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ja(Object(n),!0).forEach((function(t){Ta(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ja(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ta(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ca=function(e){var t=function(){return i().createElement("div",{className:"ms-media-error"},i().createElement(Kt.Glyphicon,{glyph:"exclamation-sign"}))},n=function(e){var t=e.style,n=void 0===t?{}:t;return i().createElement("div",{style:n,className:"ms-media-loader"},i().createElement(Fn.Z,{size:52}))};return function(r){var o={},a=r.sectionType;if((a===p.ID.PARAGRAPH||a===p.ID.IMMERSIVE)&&r.type===p.Tr.IMAGE){var c=((null==r?void 0:r.imgHeight)||9)/((null==r?void 0:r.imgWidth)||16)*100;o={paddingTop:"".concat(c,"%")}}return r.lazy?i().createElement(Zn,{key:r.loadingId,id:r.loadingId,debounceTime:r.debounceTime,loading:r.isLoading,onLoad:function(e){return r.onLoad(Sa(Sa({},r.loading),{},Ta({},e,!1)))},loaderComponent:n,loaderStyle:o},i().createElement(e,Pa({},r,{type:r.type,loaderComponent:n,loaderStyle:o,errorComponent:t}))):i().createElement(e,Pa({},r,{key:r.id,type:r.mediaType||r.type,loaderComponent:n,errorComponent:t}))}};var ka=n(7848),Ia=n(19983);function Ma(){return(Ma=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function xa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Aa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xa(Object(n),!0).forEach((function(t){Na(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Na(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Da(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Ra={image:(0,Ce.branch)((function(e){return e.resourceId}),(0,Ce.compose)((0,a.connect)((0,c.P1)(U.jq,(function(e){return{resources:e}}))),(0,Ce.withProps)((function(e){var t=e.resources,n=e.resourceId;return(Mr()(t,{id:n})||{}).data}))),(0,De.Z)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.sectionType;return!n&&r!==p.ID.TITLE&&r!==p.ID.IMMERSIVE}),(function(){return{glyph:"picture"}})))(Ca($t)),map:(0,Ce.compose)((0,Ce.branch)((function(e){return e.resourceId}),Gi),ka.Z,Ia.Z,ta,ra)(Ca(fn)),video:(0,Ce.branch)((function(e){return e.resourceId}),(0,Ce.compose)((0,a.connect)((0,c.P1)(U.jq,(function(e){return{resources:e}}))),(0,Ce.withProps)((function(e){var t=e.resources,n=e.resourceId,r=e.autoplay,o=(Mr()(t,{id:n})||{}).data||{},i=o.autoplay;return Aa(Aa({},Da(o,["autoplay"])),{},{autoplay:void 0!==r?r:i})}))),(0,De.Z)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.sectionType;return!n&&r!==p.ID.TITLE&&r!==p.ID.IMMERSIVE}),(function(){return{glyph:"play"}})))(Ca(yn.Z))};const La=function(e){var t=e.type,n=Da(e,["type"]),r=Ra[t];return r?i().createElement(r,Ma({type:t},n)):null};function _a(){return(_a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}const Ba=(0,a.connect)((0,c.P1)(U.jq,(function(e){return{resources:e}})))((function(e){var t=e.resources,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["resources"]);if(n.resourceId){var r=(Mr()(t,{id:n.resourceId})||{}).data||{};return i().createElement(no,_a({},r,n))}return i().createElement(no,n)}));function Wa(){return(Wa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var Za=function(e){var t=e.story,n=e.mode,r=void 0===n?p.nl.VIEW:n,a=e.onAdd,c=e.messages,l=e.fontFamilies,u=void 0===l?[]:l,f=e.storyFonts,y=void 0===f?[]:f,m=e.webFont,b=void 0===m?s():m,v=e.onUpdate,g=void 0===v?function(){}:v,h=e.onBasicError,O=void 0===h?function(){}:h,w=e.onUpdateMediaEditorSetting,E=e.mediaEditorSettings,P=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["story","mode","onAdd","messages","fontFamilies","storyFonts","webFont","onUpdate","onBasicError","onUpdateMediaEditorSetting","mediaEditorSettings"]),j=(0,o.useCallback)((function(e){return(0,d.S$)(c,e)}),[c]),S=function(e,t,n){return a(e,t,n,j)};return(0,o.useEffect)((function(){window.__geostory_interaction=function(e,t){"scrollTo"===e&&(0,p.M1)(t,{behavior:"smooth"})}}),[]),(0,o.useEffect)((function(){g("settings.theme.fontFamilies",u,"merge"),E&&w(E)}),[]),(0,o.useEffect)((function(){y.length>0&&y.filter((function(e){var t=e.src;return t&&!document.head.querySelector("link[href='".concat(t,"']"))})).length>0&&b.load((0,p.bm)(y,(function(){}),(function(){return O({message:"geostory.builder.settings.webFontLoadError"})})))}),[y]),i().createElement(Se.Z,{className:"ms-geostory",columns:[i().createElement(Ea,Wa({},P,{add:S,update:g,mode:r}))]},i().createElement(Li,Wa({},t,P,{storyFonts:(0,p._R)(y),add:S,update:g,mode:r,mediaViewer:La,contentToolbar:Ba})))};Za.defaultProps={storyFonts:[],fontFamilies:[],onUpdateMediaEditorSetting:function(){}};const Fa=(0,u.rx)("GeoStory",{component:(0,a.connect)((0,c.zB)({mode:U.eK,story:U.Kg,messages:Pe.Ps,focusedContent:U.FW,isContentFocused:U.z7,theme:function(e){var t;return(null===(t=(0,U.TQ)(e))||void 0===t?void 0:t.theme)||{}},storyFonts:U.mm}),{onAdd:y.IH,onUpdate:y.Vx,updateCurrentPage:y.RZ,onUpdateSetting:y.m7,remove:y.Od,editMedia:m.Ql,editWebPage:y.o2,onBasicError:f.d,onUpdateMediaEditorSetting:y.Fu})(Za),reducers:{geostory:je.Z},epics:r})},8316:(e,t,n)=>{"use strict";n.d(t,{Pz:()=>i,Ps:()=>a,KV:()=>c});var r=n(22222),o=n(86494),i=function(e){return e.locale&&e.locale.current||"en-US"},a=function(e){return e.locale&&e.locale.messages||{}},c=(0,r.P1)([i],(function(e){return(0,o.head)(e.split("-"))}))},10284:(e,t,n)=>{"use strict";n.d(t,{sw:()=>b,oB:()=>v});var r=n(49977),o=n.n(r),i=n(86494),a=n(5055),c=n(7526);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){var t="function"==typeof Map?new Map:void 0;return(u=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return p(e,arguments,y(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,e)})(e)}function p(e,t,n){return(p=d()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&f(o,n.prototype),o}).apply(null,arguments)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n(24384);var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(o,e);var t,n,r=(t=o,n=d(),function(){var e,r=y(t);if(n){var o=y(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return s(this,e)});function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e)).name="OGCError",n.code=t,n}return o}(u(Error)),b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{tagNameProcessors:[c.stripPrefix],explicitArray:!1,mergeAttrs:!0};return o().Observable.bindNodeCallback((function(e,n){return(0,a.parseString)(e,t,n)}))(e)},v=function(e){return e.switchMap((function(e){return"string"==typeof e.data&&e.data.indexOf("ExceptionReport")>0?o().Observable.bindNodeCallback((function(e,t){return(0,a.parseString)(e,{tagNameProcessors:[c.stripPrefix],explicitArray:!1,mergeAttrs:!0},t)}))(e.data).map((function(e){var t=(0,i.get)(e,"ExceptionReport.Exception.ExceptionText");throw new m(t||"Undefined OGC Service Error",(0,i.get)(e,"ExceptionReport.Exception.exceptionCode"))})):o().Observable.of(e)}))}},59112:(e,t,n)=>{"use strict";n.d(t,{LT:()=>a,BC:()=>l,yQ:()=>s,fu:()=>u});var r=n(86494),o=n(24262),i=n(86638),a=function(e,t){var n=RegExp("^/|/$|/{2,}");if(0===t.length||e.map((function(e){return e.label})).indexOf(t)>-1||n.test(t))return null;var r=t.replace(/\./g,"${dot}").replace(/\//g,".");return{label:t,value:r}},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"title",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" - ";switch(e){case"title":var i=(0,r.isObject)(t.title)?t.title[n]||t.title.default:t.title,a=i||t.name||"";return a;case"description":var c=t.description||"";return c;case"both":var l=(0,r.isObject)(t.title)?t.title[n]||t.title.default:t.title,s=l||t.nam||"",u=t.description||"";return"".concat(s).concat(o&&u?o:"").concat(u);default:return t[e]}},l=function(e){var t=e.node,n=e.currentLocale,r=e.tooltipOptions,o=void 0===r?{separator:" - ",maxLength:807}:r,i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" - ";return c(e.tooltipOptions,e,t,n)}(t,n,o.separator)||"";return(i=i&&i.substring(0,o.maxLength)).length===o.maxLength&&(i+="..."),{title:c("title",t,n,o.separator),tooltipText:i}},s=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t.filter((function(e){return e.nodes})).reduce((function(t,o){return t.push(r?o:{label:o.id.replace(/\./g,"/").replace(/\${dot}/g,"."),value:o.id}),o.nodes.length>0?t.concat(e(o.nodes,n+1,r)):t}),[])},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.replace(/[^\.\/]+/g,(function(e){var n=(0,r.get)((0,o.getGroupByName)(e,t),"title");return(0,r.isObject)(n)?n[(0,i.Kd)()]||n.default:t&&n||e}));return(n=n.replace(/\./g,"/")).replace(/\${dot}/g,".")}},11847:(e,t,n)=>{"use strict";n.d(t,{ij:()=>l,w0:()=>s,vl:()=>u,K2:()=>p,Nw:()=>d});var r=n(72500),o=n.n(r),i=n(86494),a=n(64210);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=function(e){if(!e)return{};var t=!(0===e.indexOf("http")),n=t?[]:e.match(/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/);if(t){var r=window.location;n[1]=r.protocol,n[3]=r.hostname,n[4]=r.port,n[5]=e}n[4]=""!==n[4]&&n[4]?n[4]:"https:"===n[1]?"443":"80",n[5]=n[5]?n[5]:e.slice(n[0].length);var o,i,a=(i=6,function(e){if(Array.isArray(e))return e}(o=n)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}}(o,i)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(o,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=a[1],s=a[3],u=a[4],p=a[5],d=0===p.indexOf("/")?p.split("/")[1]:"";return{protocol:l,domain:s,port:u,rootPath:p,applicationRootPath:d}},s=function(e,t){var n=(0,i.isArray)(e)?e[0]:e,r=(0,i.isArray)(t)?t[0]:t;if(n===r)return!0;if(!n||!r)return!1;if(!(0,i.isString)(n)||!(0,i.isString)(r))return!1;var a=o().parse(n),c=o().parse(r),s=l(n),u=l(r),p=s.protocol===u.protocol,d=s.domain===u.domain,f=s.port===u.port,y=a.pathname===c.pathname,m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e===t)return!0;if(!e&&!t)return!0;var n=e?e.split("&").filter((function(e){return!!e})):[],r=t?t.split("&").filter((function(e){return!!e})):[];return(0,i.isEqual)((0,i.sortBy)(n),(0,i.sortBy)(r))}(a.query,c.query);return p&&f&&d&&y&&m},u=function(e){return a.parse(e)},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/^(http(s{0,1}):\/\/)+?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/,n=new RegExp(t);return n.test(e)},d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/^(http(s{0,1}):\/\/)+?[\w.\-{}]+(?:\.[\w\.-]+)+[\w\-\._~\/\;\.\%\:\&\=\?{}]+$/,r=new RegExp(n),o=r.test(e);if(!o)return!1;if(o&&!t)return!0;if(o&&t){var a=/\{(.*?)\}/.test(e);return 0===t.filter((function(e){return(0,i.find)(a,e)})).length}return!1}},83255:(e,t,n)=>{e.exports=n.p+"grid.svg"},11636:(e,t,n)=>{e.exports=n.p+"world.svg"},75492:(e,t,n)=>{e.exports=n.p+"MapStore2/web/client/components/geostory/layouts/sections/patterns/dots.png"}}]);