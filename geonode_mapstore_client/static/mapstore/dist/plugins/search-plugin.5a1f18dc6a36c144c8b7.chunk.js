(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[5190],{60604:(e,t,r)=>{"use strict";r.d(t,{jJ:()=>n,oy:()=>o,yg:()=>a,vD:()=>i,W:()=>c,B1:()=>l,fU:()=>s,cY:()=>u});var n="ADDITIONALLAYER:UPDATE_ADDITIONAL_LAYER",o="ADDITIONALLAYER:UPDATE_OPTIONS_BY_OWNER",a="ADDITIONALLAYER:REMOVE_ADDITIONAL_LAYER",i="ADDITIONALLAYER:REMOVE_ALL_ADDITIONAL_LAYERS",c=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"override",o=arguments.length>3?arguments[3]:void 0;return{type:n,id:e,owner:t,actionType:r,options:o}},l=function(e,t){return{type:o,owner:e,options:t}},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.owner;return{type:a,id:t,owner:r}},u=function(){return{type:i}}},15047:(e,t,r)=>{"use strict";r.d(t,{b:()=>m});var n=r(27418),o=r.n(n);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=function(e){return null===e?[]:e.map((function(e){return{properties:i({},e),id:e.osm_id,type:"Feature",bbox:e.boundingbox.map((function(e){return parseFloat(e)})).reduce((function(e,t,r){return e[function(e){switch(e){case 0:return 1;case 1:return 3;case 2:return 0;case 3:return 2;default:return-1}}(r)]=t,e}),[]),geometry:e.geojson||{type:"Point",coordinates:[parseFloat(e.lon),parseFloat(e.lat)]}}}))},s=r(59286),u=r(32420);var f=function(e){var t,r=e.searchText,n=e.staticFilter,o=e.blacklist,a=e.item,i=e.queriableAttributes,c=e.predicate,l=(0,s.generateTemplateString)(n||"")(a),u=r.split(" ").filter((function(e){return e})).filter((function(e){return o.indexOf(e.toLowerCase())<0}));return 0===u.length&&(u=r?[r]:[]),u.length>0&&(t="(".concat(u.map((function(e){return i.map((function(t){return"".concat(t," ").concat(c," '%").concat(e.replace("'","''"),"%'")})).join(" OR ")})).join(") AND (")).concat(")")),t?t.concat(l):l||null},p={nominatim:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{returnFullData:!1};return r(47310).Z.geocode(e,t).then((function(e){return t.returnFullData?e:l(e.data)}))},wfs:function(e,t){var r=t.url,n=t.typeName,a=t.queriableAttributes,i=void 0===a?[]:a,c=t.outputFormat,l=void 0===c?"application/json":c,s=t.predicate,p=void 0===s?"ILIKE":s,d=t.staticFilter,m=void 0===d?"":d,h=t.blacklist,y=void 0===h?[]:h,b=t.item,v=t.fromTextToFilter,g=void 0===v?f:v,O=t.returnFullData,S=void 0!==O&&O,_=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(t,["url","typeName","queriableAttributes","outputFormat","predicate","staticFilter","blacklist","item","fromTextToFilter","returnFullData"]),E=g({searchText:e,staticFilter:m,blacklist:y,item:b,queriableAttributes:i,predicate:p});return u.getFeatureSimple(r,o()({maxFeatures:10,typeName:n,outputFormat:l,cql_filter:E},_)).then((function(e){return S?e:e.features}))}},d={setService:function(e,t){p[e]=t},getService:function(e){return p[e]?p[e]:null}},m={Services:p,Utils:d}},38167:(e,t,r)=>{"use strict";r.d(t,{k9:()=>S,v0:()=>O,ZP:()=>E});var n=r(45697),o=r.n(n),a=r(24852),i=r.n(a),c=r(68195);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(l,e);var t,r,n,o,a=(n=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(n);if(o){var r=m(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return d(this,e)});function l(){return u(this,l),a.apply(this,arguments)}return t=l,(r=[{key:"render",value:function(){return this.context.intl?i().createElement(c.FormattedDate,s({value:this.props.value},this.props.dateParams)):i().createElement("span",null,this.props.value&&this.props.value.toString()||"")}}])&&f(t.prototype,r),l}(i().Component);h(y,"propTypes",{value:o().object,dateParams:o().object}),h(y,"contextTypes",{intl:o().object}),h(y,"defaultProps",{value:new Date});const b=y;var v=r(15402),g=r(5346),O=g.Z,S=v.Z,_=b;const E={Message:g.Z,HTML:S,DateFormat:_}},61012:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Rt});var n=r(86494),o=r(27418),a=r.n(o),i=r(45697),c=r.n(i),l=r(24852),s=r.n(l),u=r(71703),f=r(1852),p=r.n(f),d=r(22222),m=r(60604),h=r(81808),y=r(82904),b=r(1550),v=r(97222);function g(e,t){return{type:"SET_SEARCH_BOOKMARK_CONFIG",property:e,value:t}}var O=r(30294),S=r(5346),_=r(15135),E=r(23570),w=r.n(E);function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var j=(0,_.Z)(O.DropdownButton),I={disabled:!1,className:"square-button-md",noCaret:!0,idDropDown:w()()},P={title:s().createElement(O.Glyphicon,{glyph:"menu-hamburger"}),tooltipId:"search.changeSearchInputField",tooltipPosition:"bottom",className:"square-button-md no-border",pullRight:!0};const T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.menuItems,r=void 0===t?[]:t,n=e.disabled,o=void 0!==n&&n;return s().createElement(j,C({disabled:o},I,P),r.length?r.map((function(e){return e})):null)},k=function(e){var t=e.className,r=e.style,n=e.children;return s().createElement("div",{id:"map-search-bar",style:r,className:"MapSearchBar"+(t?" "+t:"")},n)};var R=r(86638);function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?A(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var N=function(e,t){var r=e.show,n=e.autoFocusOnSelect,o=void 0===n||n,a=e.selectedItems,i=void 0===a?[]:a,c=e.className,l=e.style,u=void 0===l?{textOverflow:"ellipsis"}:l,f=e.placeholder,p=e.placeholderMsgId,d=e.hideOnBlur,m=void 0===d||d,h=e.searchText,y=void 0===h?"":h,b=e.typeAhead,v=void 0===b||b,g=e.delay,S=void 0===g?1e3:g,_=e.blurResetDelay,E=void 0===_?300:_,w=e.onSearch,C=void 0===w?function(){}:w,j=e.onSearchTextChange,I=void 0===j?function(){}:j,P=e.onCancelSelectedItem,T=void 0===P?function(){}:P,k=e.onPurgeResults,A=void 0===k?function(){}:k,N=s().useRef(),D=s().useRef(),F=x(s().useState(),2),V=F[0],M=F[1],B=x(s().useState(),2),Z=B[0],L=B[1],G=x(s().useState(!1),2),q=G[0],z=G[1];s().useEffect((function(){var e=D.current;if(o&&i&&(e<i.length||!e&&1===i.length)){var t=N.current;t&&t.focus instanceof Function&&setTimeout((function(){return t.focus()}),200)}D.current=i&&i.length})),s().useEffect((function(){q&&(C(),z(!1))}),[q,C]);var U="search.addressSearch";if(!f&&t.messages){var Y=(0,R.S$)(t.messages,p||U);Y&&(U=Y)}else U=f;return r&&s().createElement(O.FormControl,{className:"searchInput".concat(c?" ".concat(c):""),key:"search-input",placeholder:U,type:"text",inputRef:function(e){N.current=e},style:u,value:y,onKeyDown:function(e){switch(e.keyCode){case 13:C();break;case 8:!y&&i&&i.length>0&&T(i[i.length-1])}},onBlur:function(){m&&(V&&clearTimeout(V),M(setTimeout((function(){A()}),E)))},onFocus:function(){v&&y&&C()},onChange:function(e){var t=e.target.value;I(t),v&&(Z&&clearTimeout(Z),L(setTimeout((function(){z(!0)}),S)))}})};N.contextTypes={messages:c().object};const D=N;var F=r(72986),V=r.n(F),M=r(80717);function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){G(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const q=function(e){var t=e.loading,r=(e.splitTools,e.toolbarProps),n=void 0===r?{}:r,o=e.toolbarButtons,i=void 0===o?[]:o,c=e.children;return s().createElement("span",{className:"search-toolbar-options"},t&&s().createElement(V(),{style:a()({},{position:"absolute"},L({},{right:"69px",zIndex:1,top:"13px"})),spinnerName:"pulse",noFadeIn:!0}),s().createElement(M.Z,B({btnGroupProps:{className:"btn-group-menu-options"},transitionProps:null,btnDefaultProps:{className:"square-button-md",bsStyle:"primary"}},n,{buttons:i})),c)};var z=r(43129);function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return K(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?K(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function $(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var X=(0,r(93451).Z)(["placeholder","clearValueText","noResultsText"])(z.ZP),J={searchByBookmark:function(e,t,r,o,a){var i,c,l=e.options,s=void 0===l?{}:l,u=e.layerVisibilityReload;void 0!==u&&u?t(W(W({},r),{},{map:W(W({},r.map),{},{bookmark_search_config:o})}),null,{bounds:[s.west,s.south,s.east,s.north],crs:(null==r||null===(i=r.map)||void 0===i||null===(c=i.center)||void 0===c?void 0:c.crs)||"EPSG:4326"}):s&&!(0,n.isEmpty)(s)&&a([s.west,s.south,s.east,s.north],"EPSG:4326")},searchIcon:function(e,t){var r=t.onLayerVisibilityLoad,n=t.mapInitial,o=t.bookmarkConfig,a=t.onZoomToExtent;return{tooltipId:"bookmarkSearch"===e?"search.zoomToBookmark":"",tooltipPosition:"bottom",visible:"bookmarkSearch"===e&&!(null!=o&&o.zoomOnSelect),disabled:"bookmarkSearch"===e&&!o.selected,onClick:function(){"bookmarkSearch"===e&&J.searchByBookmark(o.selected,r,n,o.bookmarkSearchConfig||{},a)}}}},Q=function(e){var t=e.bookmarkConfig,r=e.onPropertyChange,o=e.onLayerVisibilityLoad,a=e.mapInitial,i=e.onZoomToExtent,c=Y((0,l.useState)([]),2),u=c[0],f=c[1],p=t||{},d=p.selected,m=void 0===d?{}:d,h=p.bookmarkSearchConfig,y=void 0===h?{}:h,b=p.zoomOnSelect,v=void 0===b||b,g=y.bookmarks,O=void 0===g?[]:g,S=J.searchByBookmark;return(0,l.useEffect)((function(){(0,n.isEmpty)(O)||f(O.map((function(e){return e.title})))}),[O]),s().createElement("div",{className:"search-select"},s().createElement("div",{style:{flex:"1 1 0%",padding:"0px 4px"}},s().createElement(X,U({},{clearable:!0,isSearchable:!0,isClearable:!0},{onChange:function(e){var t=e&&e.value||"",n=Y(O.filter((function(r,n){return r.title===t&&n===e.idx})),1)[0];r("selected",n),v&&S(n,o,a,y,i)},value:(null==m?void 0:m.title)||"",options:u.map((function(e,t){return{label:e,value:e,idx:t}})),placeholder:"search.b_placeholder",clearValueText:"search.b_clearvalue",noResultsText:"search.b_noresult"}))))};Q.propTypes={bookmarkConfig:c().object.isRequired,onPropertyChange:c().func.isRequired};const ee=(0,u.connect)((function(e){return{bookmarkConfig:e.searchbookmarkconfig||{}}}),{onPropertyChange:g,onZoomToExtent:b.Px,onLayerVisibilityLoad:h.H0})(Q);var te=r(99509),re=r(77900),ne={clearCoordinates:function(e,t){e({owner:"search"}),t("lat",""),t("lon","")},areValidCoordinates:function(e){return(0,n.isNumber)(null==e?void 0:e.lon)&&(0,n.isNumber)(null==e?void 0:e.lat)},zoomToPoint:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12;e({x:parseFloat(t.lon),y:parseFloat(t.lat)},r,"EPSG:4326")},coordinateFormatChange:function(e,t,r,n){return{buttonConfig:{title:s().createElement(O.Glyphicon,{glyph:"cog"}),tooltipId:"search.changeSearchInputField",tooltipPosition:"bottom",className:"square-button-md no-border",pullRight:!0},menuOptions:[{active:"decimal"===e,onClick:function(){return t("decimal")},text:s().createElement(S.Z,{msgId:"search.decimal"})},{active:"aeronautical"===e,onClick:function(){return t("aeronautical")},text:s().createElement(S.Z,{msgId:"search.aeronautical"})}],visible:r&&"coordinatesSearch"===n,Element:re.Z}},removeIcon:function(e,t,r,o){return{visible:"coordinatesSearch"===e&&((0,n.isNumber)(t.lon)||(0,n.isNumber)(t.lat)),onClick:function(){return ne.clearCoordinates(r,o)}}},searchIcon:function(e,t,r,n){return{visible:"coordinatesSearch"===e,onClick:function(){"coordinatesSearch"===e&&ne.areValidCoordinates(t)&&ne.zoomToPoint(r,t,n)}}},coordinatesMenuItem:function(e){var t=e.activeTool,r=e.searchText,n=e.clearSearch,o=e.onChangeActiveSearchTool,a=e.onClearBookmarkSearch;return s().createElement(O.MenuItem,{active:"coordinatesSearch"===t,onClick:function(){void 0!==r&&""!==r&&n(),a("selected"),o("coordinatesSearch"),document.dispatchEvent(new MouseEvent("click"))}},s().createElement(O.Glyphicon,{glyph:"search-coords"})," ",s().createElement(S.Z,{msgId:"search.coordinatesSearch"}))}},oe=function(e){var t=e.coordinate,r=void 0===t?{}:t,n=e.format,o=e.onClearCoordinatesSearch,a=e.onZoomToPoint,i=e.onChangeCoord,c=e.defaultZoomLevel,l=e.aeronauticalOptions,u=void 0===l?{seconds:{decimals:4,step:1e-4}}:l,f=e.constraintsCoordEditor,p=void 0===f?{decimal:{lat:{min:-90,max:90},lon:{min:-180,max:180}}}:f,d=ne.zoomToPoint,m=ne.areValidCoordinates,h=function(e,t){var r=isNaN(parseFloat(t))?"":parseFloat(t);i(e,r),m()||o({owner:"search"})},y=function(){d(a,r,c)};return s().createElement("div",{className:"coordinateEditor",style:{flexWrap:"decimal"===n?"nowrap":"wrap"}},s().createElement(O.Row,{className:"entryRow ".concat(n)},s().createElement(O.FormGroup,null,s().createElement(O.InputGroup,null,s().createElement(O.InputGroup.Addon,{style:{minWidth:45}},s().createElement(S.Z,{msgId:"search.latitude"})),s().createElement(te.Z,{format:n,aeronauticalOptions:u,coordinate:"lat",idx:1,value:r.lat,constraints:p,onChange:function(e){return h("lat",e)},onKeyDown:function(){m(r)&&y()}})))),s().createElement(O.Row,{className:"entryRow ".concat(n)},s().createElement(O.FormGroup,null,s().createElement(O.InputGroup,null,s().createElement(O.InputGroup.Addon,{style:{minWidth:45}},s().createElement(S.Z,{msgId:"search.longitude"})),s().createElement(te.Z,{format:n,aeronauticalOptions:u,coordinate:"lon",idx:2,value:r.lon,constraints:p,onChange:function(e){return h("lon",e)},onKeyDown:function(){m(r)&&y()}})))))};oe.propTypes={coordinate:c().object,format:c().string,onClearCoordinatesSearch:c().func,onZoomToPoint:c().func,onChangeCoord:c().func,defaultZoomLevel:c().number};const ae=(0,u.connect)((function(e){return{coordinate:e.search.coordinate||{}}}),{onZoomToPoint:v.Z,onChangeCoord:v.TS})(oe);function ie(e){return function(e){if(Array.isArray(e))return ce(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ce(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ce(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?le(Object(r),!0).forEach((function(t){ue(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ue(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var fe=r(59286);function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ye(e,t){return!t||"object"!==pe(t)&&"function"!=typeof t?be(e):t}function be(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ve(e){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ge(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(c,e);var t,r,o,a,i=(o=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ve(o);if(a){var r=ve(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return ye(this,e)});function c(){var e;de(this,c);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return ge(be(e=i.call.apply(i,[this].concat(r))),"onClick",(function(){var t=e.props.item;e.props.onItemClick(t)})),e}return t=c,(r=[{key:"render",value:function(){if(void 0===this.props.item)return null;var e=this.props.item;return s().createElement("div",{key:e.osm_id,className:"search-result",style:e.resultCssStyle,onClick:this.onClick},s().createElement("div",{className:"search-result-left-container"},s().createElement("div",{className:"icon"}," ",s().createElement("img",{src:e.icon})),s().createElement("div",{className:"text-result-title"},(0,n.get)(e,this.props.displayName)||(0,fe.generateTemplateString)(this.props.displayName||"")(e)),s().createElement("small",{className:"text-info"},this.props.subTitle&&(0,n.get)(e,this.props.subTitle)||(0,fe.generateTemplateString)(this.props.subTitle||"")(e))),s().createElement("div",{className:"search-result-right-container"},s().createElement("div",{className:"search-result-tools"},s().createElement(M.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:this.props.tools}))))}}])&&me(t.prototype,r),c}(s().Component);ge(Oe,"propTypes",{subTitle:c().string,item:c().object,displayName:c().string,idField:c().string,icon:c().string,onItemClick:c().func,tools:c().array}),ge(Oe,"defaultProps",{displayName:"properties.display_name",idField:"id",icon:"properties.icon",tools:[]});const Se=Oe;var _e=r(38167),Ee=r(18412);function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ie(e,t){return(Ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pe(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?Te(e):t}function Te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Re(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ie(e,t)}(l,e);var t,r,o,i,c=(o=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ke(o);if(i){var r=ke(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Pe(this,e)});function l(){var e;Ce(this,l);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return Re(Te(e=c.call.apply(c,[this].concat(r))),"onItemClick",(function(t){e.props.onItemClick(t,e.props.mapConfig)})),Re(Te(e),"renderResults",(function(){return e.props.results.map((function(t,r){var o,a=e.findService(t)||{},i=(0,n.find)(e.props.layers,{name:null===(o=a.options)||void 0===o?void 0:o.typeName}),c=(0,Ee.zA)(a),l=!(0,Ee.Tv)(i,a);return s().createElement(Se,{subTitle:a.subTitle,idField:a.idField,displayName:a.displayName,key:t.osm_id||t.id||"res_"+r,item:t,onItemClick:e.onItemClick,tools:[{id:"open-gfi",keyProp:"open-gfi",visible:c,disabled:l,glyph:"info-sign",tooltipId:c&&l?"search.layerMustBeVisible":"search.showGFI",onClick:function(r){r.stopPropagation(),e.props.showGFI(t)}}]})}))})),Re(Te(e),"findService",(function(t){var r=e.props.searchOptions&&e.props.searchOptions.services;if(null!==t.__SERVICE__)if(r&&"string"==typeof t.__SERVICE__){for(var n=0;n<r.length;n++)if(r[n]&&r[n].id===t.__SERVICE__)return r[n];for(var o=0;o<r.length;o++)if(r[o]&&r[o].type===t.__SERVICE__)return r[o]}else if("object"===we(t.__SERVICE__))return t.__SERVICE__;return null})),e}return t=l,(r=[{key:"render",value:function(){var e=this.props.notFoundMessage;e||(e=s().createElement(_e.ZP.Message,{msgId:"noresultfound"}));var t=this.props.containerStyle,r=this.props.mapConfig&&this.props.mapConfig.size;if(this.props.fitToMapSize&&r){var n=r.width-this.props.sizeAdjustment.width,o=r.height-this.props.sizeAdjustment.height;t=a()({},this.props.containerStyle,{maxWidth:n,maxHeight:o})}return this.props.results?0===this.props.results.length?s().createElement("div",{className:"search-result-list",style:a()({padding:"10px",textAlign:"center"},t)},e):s().createElement("div",{className:"search-result-list",style:t},this.renderResults()):null}}])&&je(t.prototype,r),l}(s().Component);Re(xe,"propTypes",{results:c().array,layers:c().array,searchOptions:c().object,mapConfig:c().object,fitToMapSize:c().bool,containerStyle:c().object,sizeAdjustment:c().object,onItemClick:c().func,addMarker:c().func,afterItemClick:c().func,showGFI:c().func,notFoundMessage:c().oneOfType([c().object,c().string])}),Re(xe,"defaultProps",{layers:[],sizeAdjustment:{width:0,height:110},containerStyle:{zIndex:1e3},onItemClick:function(){},addMarker:function(){},afterItemClick:function(){},showGFI:function(){}});var Ae=r(49977),Ne=r(94707),De=r.n(Ne),Fe=r(35385),Ve=r.n(Fe),Me=r(75110),Be=r(21914),Ze=r(80416),Le=r(90183),Ge=r(15047),qe=r(32420);function ze(e){return function(e){if(Array.isArray(e))return Ue(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ue(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ue(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ke(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(r),!0).forEach((function(t){He(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function He(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var We=r(26125);function $e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(r),!0).forEach((function(t){Je(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Je(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qe(e){return function(e){if(Array.isArray(e))return et(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return et(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?et(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function et(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var tt=r(827),rt=r(37275),nt=r(38560);function ot(e){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function at(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function it(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ct(e,t){return(ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lt(e,t){return!t||"object"!==ot(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function st(e){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ut(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ft=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ct(e,t)}(i,e);var t,r,n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=st(n);if(o){var r=st(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return lt(this,e)});function i(){return at(this,i),a.apply(this,arguments)}return t=i,(r=[{key:"render",value:function(){var e=this;return s().createElement(nt.Z,{onClick:function(){return e.props.onToggle(e.props.pressed)},bsStyle:this.props.pressed?"default":"primary",className:"square-button search-toggle"},s().createElement(O.Glyphicon,{glyph:"search"}))}}])&&it(t.prototype,r),i}(s().Component);ut(ft,"propTypes",{pressed:c().bool,onToggle:c().func}),ut(ft,"defaultProps",{pressed:!1,onToggle:function(){}});const pt=(0,u.connect)((function(e){return{pressed:e.controls&&e.controls.search&&e.controls.search.enabled||!1}}),{onToggle:y.Xi.bind(null,"search",null)})(ft);function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var mt,ht;function yt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function bt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(r),!0).forEach((function(t){Ct(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function vt(){return(vt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function gt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ot(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function St(e,t){return(St=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _t(e,t){return!t||"object"!==dt(t)&&"function"!=typeof t?Et(e):t}function Et(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wt(e){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ct(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var jt=(0,d.P1)([function(e){return e.search||null},function(e){return e.controls&&e.controls.searchBookmarkConfig||null},function(e){return e.mapConfigRawData||{}},function(e){return(null==e?void 0:e.searchbookmarkconfig)||""}],(function(e,t,r,o){return{enabledSearchBookmarkConfig:t&&t.enabled||!1,error:e&&e.error,coordinate:e&&e.coordinate||{},loading:e&&e.loading,searchText:e?e.searchText:"",activeSearchTool:(0,n.get)(e,"activeSearchTool","addressSearch"),format:(0,n.get)(e,"format")||rt.ZP.getConfigProp("defaultCoordinateFormat"),selectedItems:e&&e.selectedItems,mapInitial:r,bookmarkConfig:o||{}}})),It=(0,u.connect)(jt,{onSearch:v.tt,onChangeCoord:v.TS,onChangeActiveSearchTool:v.a,onClearCoordinatesSearch:m.fU,onClearBookmarkSearch:g,onChangeFormat:v.Zw,onToggleControl:y.Xi,onZoomToPoint:v.Z,onPurgeResults:v.kV,onSearchReset:v.v2,onSearchTextChange:v.k9,onCancelSelectedItem:v.KG,onZoomToExtent:b.Px,onLayerVisibilityLoad:h.H0})((function(e){var t,r=e.activeSearchTool,o=void 0===r?"addressSearch":r,a=e.removeIcon,i=void 0===a?"1-close":a,c=e.searchIcon,l=void 0===c?"search":c,u=e.isSearchClickable,f=void 0===u||u,p=e.splitTools,d=e.searchText,m=void 0===d?"":d,h=e.maxResults,y=void 0===h?15:h,b=e.searchOptions,v=e.loading,g=e.delay,_=e.blurResetDelay,E=e.typeAhead,w=e.coordinate,C=void 0===w?{}:w,j=e.selectedItems,I=void 0===j?[]:j,P=e.defaultZoomLevel,R=void 0===P?12:P,x=e.enabledSearchBookmarkConfig,A=void 0!==x&&x,N=e.error,F=e.format,V=void 0===F?"decimal":F,M=e.placeholder,B=e.placeholderMsgId,Z=void 0===B?"search.addressSearch":B,L=e.showOptions,G=void 0===L||L,z=e.showAddressSearchOption,U=void 0===z||z,Y=e.showCoordinatesSearchOption,K=void 0===Y||Y,H=e.showBookMarkSearchOption,W=void 0===H||H,$=e.onSearch,X=e.onSearchReset,Q=e.onSearchTextChange,te=e.onCancelSelectedItem,re=e.onChangeCoord,oe=void 0===re?function(){}:re,ce=e.onChangeActiveSearchTool,le=void 0===ce?function(){}:ce,ue=e.onClearCoordinatesSearch,fe=void 0===ue?function(){}:ue,pe=e.onChangeFormat,de=void 0===pe?function(){}:pe,me=e.onToggleControl,he=void 0===me?function(){}:me,ye=e.onZoomToPoint,be=void 0===ye?function(){}:ye,ve=e.onClearBookmarkSearch,ge=void 0===ve?function(){}:ve,Oe=e.onPurgeResults,Se=e.items,_e=void 0===Se?[]:Se,Ee=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,["activeSearchTool","removeIcon","searchIcon","isSearchClickable","splitTools","searchText","maxResults","searchOptions","loading","delay","blurResetDelay","typeAhead","coordinate","selectedItems","defaultZoomLevel","enabledSearchBookmarkConfig","error","format","placeholder","placeholderMsgId","showOptions","showAddressSearchOption","showCoordinatesSearchOption","showBookMarkSearchOption","onSearch","onSearchReset","onSearchTextChange","onCancelSelectedItem","onChangeCoord","onChangeActiveSearchTool","onClearCoordinatesSearch","onChangeFormat","onToggleControl","onZoomToPoint","onClearBookmarkSearch","onPurgeResults","items"]),we=function(e){var t=e.searchText,r=e.selectedItems,n=e.searchOptions,o=e.maxResults,a=e.onSearch,i=void 0===a?function(){}:a,c=e.onSearchReset,l=void 0===c?function(){}:c;return function(){var e=t,a=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(t,r){var n;return t+((null==r||null===(n=r.options)||void 0===n?void 0:n.maxFeatures)||e)}),0)||e}(null==n?void 0:n.services,o);void 0!==e&&""!==e||r&&0!==r.length?void 0!==e&&""!==e&&i(e,n,a):l()}}({searchText:m,selectedItems:I,searchOptions:b,maxResults:y,onSearch:$,onSearchReset:X}),Ce=function(){X()},je=[];if(U&&je.push(s().createElement(O.MenuItem,{active:"addressSearch"===o,onClick:function(){fe({owner:"search"}),ge("selected"),le("addressSearch")}},s().createElement(O.Glyphicon,{glyph:l})," ",s().createElement(S.Z,{msgId:"search.addressSearch"}))),K&&je.push(s().createElement(ne.coordinatesMenuItem,{activeTool:o,searchText:m,clearSearch:Ce,onChangeActiveSearchTool:le,onClearBookmarkSearch:ge})),W&&!(0,n.isEmpty)(_e)){var Ie,Pe=Ee.bookmarkConfig||{},Te=Pe.allowUser,ke=Pe.bookmarkSearchConfig,Re=_e.find((function(e){return"SearchByBookmark"===e.name}))||{};if(Re.menuItem){var xe=Re.menuItem;je.push(s().createElement(xe,null))}Re.bookmarkConfig&&(t=se(se({},Re.bookmarkConfig(he,A,o)),!Te&&{visible:!1})),Te||0!==(null==ke||null===(Ie=ke.bookmarks)||void 0===Ie?void 0:Ie.length)||"bookmarkSearch"!==o||le("addressSearch")}var Ae,Ne=function(){if(G){if("coordinatesSearch"===o)return ne.coordinateFormatChange(V,de,G,o);if("bookmarkSearch"===o)return t}return null};return s().createElement(k,null,s().createElement(O.FormGroup,null,s().createElement("div",{className:"input-group",style:{display:"flex"}},I&&I.map((function(e,t){return s().createElement("span",{key:"selected-item"+t,className:"input-group-addon"},s().createElement("div",{className:"selectedItem-text"},e.text))})),s().createElement(D,{show:"addressSearch"===o,delay:g,typeAhead:E,blurResetDelay:_,placeholder:M,placeholderMsgId:Z,searchText:m,selectedItems:I,onSearch:we,onSearchTextChange:Q,onCancelSelectedItem:te,onPurgeResults:Oe}),"coordinatesSearch"===o&&K&&s().createElement(ae,{format:V,defaultZoomLevel:R,onClearCoordinatesSearch:fe}),"bookmarkSearch"===o&&W&&s().createElement(ee,{mapInitial:Ee.mapInitial}),s().createElement(q,{splitTools:!1,toolbarButtons:[].concat(ie(Ne()?[se({},Ne())]:[]),ie(_e.filter((function(e){return"button"===e.target})).map((function(e){var t=e.component;return{visible:!!G,Element:t}}))),[se({glyph:i,className:"square-button-md no-border",bsStyle:"default",pullRight:!0,loading:!(0,n.isUndefined)(v)&&v,visible:"addressSearch"===o&&(""!==m||I&&I.length>0),onClick:function(){"addressSearch"===o&&Ce()}},"coordinatesSearch"===o&&ne.removeIcon(o,C,fe,oe)),se(se({glyph:l,className:"square-button-md no-border "+(f||"addressSearch"!==o?"magnifying-glass clickable":"magnifying-glass"),bsStyle:"default",pullRight:!0,tooltipPosition:"bottom",visible:!("addressSearch"!==o||(""!==m||I&&I.length>0)&&p),onClick:function(){return f&&we()}},"coordinatesSearch"===o&&ne.searchIcon(o,C,be,R)),"bookmarkSearch"===o&&J.searchIcon(o,Ee)),{tooltip:(Ae=N,Ae?s().createElement(S.Z,{msgId:Ae.msgId||"search.generic_error",msgParams:{message:Ae.message,serviceType:Ae.serviceType}}):null),tooltipPosition:"bottom",className:"square-button-md no-border",glyph:"warning-sign",bsStyle:"danger",glyphClassName:"searcherror",visible:!!N,onClick:Ce},{visible:G,renderButton:s().createElement(T,{disabled:G,menuItems:je})}])}))))})),Pt=(0,d.P1)([tt.Od,Me.l2,function(e){return e.search||null}],(function(e,t,r){return{mapConfig:e,layers:t,results:r?r.results:null}})),Tt=(0,u.connect)(Pt,{onItemClick:v.Jc,addMarker:v._q,showGFI:v.w4})(xe),kt=(0,u.connect)((function(e){return{enabled:e.controls&&e.controls.search&&e.controls.search.enabled||!1,selectedServices:e&&e.search&&e.search.selectedServices,selectedItems:e&&e.search&&e.search.selectedItems,textSearchConfig:e&&e.searchconfig&&e.searchconfig.textSearchConfig}}),{onUpdateResultsStyle:v.o$})((ht=mt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&St(e,t)}(l,e);var t,r,o,i,c=(o=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=wt(o);if(i){var r=wt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return _t(this,e)});function l(){var e;gt(this,l);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return Ct(Et(e=c.call.apply(c,[this].concat(r))),"getServiceOverrides",(function(t){return e.props.selectedItems&&e.props.selectedItems[e.props.selectedItems.length-1]&&(0,n.get)(e.props.selectedItems[e.props.selectedItems.length-1],t)})),Ct(Et(e),"getSearchOptions",(function(){var t=e.props,r=t.searchOptions,n=t.textSearchConfig;return n&&n.services&&n.services.length>0?n.override?a()({},r,{services:n.services}):a()({},r,{services:r.services.concat(n.services)}):r})),Ct(Et(e),"getCurrentServices",(function(){var t=e.props.selectedServices,r=e.getSearchOptions();return t&&t.length>0?a()({},r,{services:t}):r})),Ct(Et(e),"getSearchAndToggleButton",(function(){var t=s().createElement(It,vt({key:"searchBar"},e.props,{searchOptions:e.getCurrentServices(),placeholder:e.getServiceOverrides("placeholder"),placeholderMsgId:e.getServiceOverrides("placeholderMsgId")}));return!0===e.props.withToggle?[s().createElement(pt,null)].concat(e.props.enabled?[t]:null):(0,n.isArray)(e.props.withToggle)?s().createElement("span",null,s().createElement(p(),{query:"("+e.props.withToggle[0]+")"},s().createElement(pt,null),e.props.enabled?t:null),s().createElement(p(),{query:"("+e.props.withToggle[1]+")"},t)):t})),e}return t=l,(r=[{key:"componentDidMount",value:function(){this.props.onUpdateResultsStyle(bt(bt({},Ee.be),this.props.resultsStyle))}},{key:"render",value:function(){return s().createElement("span",null,this.getSearchAndToggleButton(),s().createElement(Tt,{fitToMapSize:this.props.fitResultsToMapSize,searchOptions:this.props.searchOptions,onUpdateResultsStyle:this.props.onUpdateResultsStyle,key:"nominatimresults"}))}}])&&Ot(t.prototype,r),l}(s().Component),Ct(mt,"propTypes",{splitTools:c().bool,showOptions:c().bool,isSearchClickable:c().bool,fitResultsToMapSize:c().bool,searchOptions:c().object,resultsStyle:c().object,selectedItems:c().array,selectedServices:c().array,userServices:c().array,withToggle:c().oneOfType([c().bool,c().array]),enabled:c().bool,textSearchConfig:c().object}),Ct(mt,"defaultProps",{searchOptions:{services:[{type:"nominatim",priority:5}]},isSearchClickable:!1,splitTools:!0,resultsStyle:{color:"#3388ff",weight:4,dashArray:"",fillColor:"#3388ff",fillOpacity:.2},fitResultsToMapSize:!0,withToggle:!1,enabled:!0}),ht));const Rt={SearchPlugin:a()(kt,{OmniBar:{name:"search",position:1,tool:!0,priority:1}}),epics:{searchEpic:function(e){return e.ofType(v.bj).debounceTime(250).switchMap((function(t){return Ae.Observable.from((t.services||[{type:"nominatim",priority:5}]).map((function(e){var r=Ge.b.Utils.getService(e.type);if(!r){var n=new Error("Service Missing");return n.msgId="search.service_missing",n.serviceType=e.type,Ae.Observable.of(n).do((function(e){throw e}))}return Ae.Observable.defer((function(){return r(t.searchText,e.options).then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){return Ke(Ke({},t),{},{__SERVICE__:e,__PRIORITY__:e.priority||0})}))}))})).retryWhen((function(e){return e.delay(200).scan((function(e,t){if(e>=2)throw t;return e+1}),0)}))}))).mergeAll().scan((function(e,t){return(0,n.sortBy)([].concat(ze(e),ze(t)),["__PRIORITY__"])})).map((function(e){return(0,v.WN)(e.slice(0,t.maxResults||15),!1)})).startWith((0,v.yo)(!0)).takeUntil(e.ofType(v.Av,v.M8,v.dX)).concat([(0,v.yo)(!1)]).catch((function(e){var t=Ke(Ke({msgId:"search.generic_error"},e),{},{message:e.message,stack:e.stack});return Ae.Observable.from([(0,v.kE)(t),(0,v.yo)(!1)])}))}))},searchOnStartEpic:function(e,t){return e.ofType(v.Vc).switchMap((function(e){var r=e.layer,n=e.cql_filter,o=t.getState();if(0===(0,Me.OX)(o).filter((function(e){return e.name===r})).length)return Ae.Observable.of((0,v.Tw)());var a=(0,Me.dT)(o,r);return a&&n?Ae.Observable.defer((function(){return(0,qe.getFeatureSimple)(a.url,{maxFeatures:1,typeName:r,srsName:"EPSG:4326",outputFormat:"application/json",cql_filter:n}).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.features&&e.features.length&&Ke(Ke({},e.features[0]),{},{typeName:r})}))})).switchMap((function(e){var t=e.type,r=e.geometry,o=e.typeName,a=Ve()({type:t,geometry:r}).geometry.coordinates,i={lng:a[0],lat:a[1]};return a?Ae.Observable.of((0,Be.lK)({latlng:i},o,[o],He({},o,{cql_filter:n})),(0,Be.HP)()):Ae.Observable.empty()})).catch((function(){return Ae.Observable.of((0,v.I3)())})):Ae.Observable.empty()}))},searchItemSelected:function(e,t){return e.ofType(v.dX).switchMap((function(e){var r=Ae.Observable.of(e.item).concatMap((function(t){if(t&&t.__SERVICE__&&t.__SERVICE__.geomService){var r=(0,fe.generateTemplateString)(t.__SERVICE__.geomService.options.staticFilter||"")(t);return Ae.Observable.fromPromise(Ge.b.Utils.getService(t.__SERVICE__.geomService.type)("",a()({},t.__SERVICE__.geomService.options,{staticFilter:r})).then((function(e){return a()({},t,{geometry:Le.default.mergeToPolyGeom(e)})})))}return Ae.Observable.of(e.item)})).concatMap((function(e){var r=e.bbox||e.properties.bbox||De()(e),o=[(0,b.Px)([r[0],r[1],r[2],r[3]],"EPSG:4326",e.__SERVICE__&&e.__SERVICE__.options&&e.__SERVICE__.options.maxZoomLevel||21),(0,v._q)(e)];if(e.__SERVICE__&&!(0,n.isNil)(e.__SERVICE__.launchInfoPanel)&&e.__SERVICE__.options&&e.__SERVICE__.options.typeName){var a=Ve()(e).geometry.coordinates,i={lng:a[0],lat:a[1]},c=e.__SERVICE__.options.typeName;if(a){var l=c&&(0,Me.dT)(t.getState(),c),s=null,u=[],f={},p=!1;return"single_layer"===e.__SERVICE__.launchInfoPanel&&(p=e.__SERVICE__.forceSearchLayerVisibility,u=[c],s=e.id,f=He({},e.__SERVICE__.options.typeName,{info_format:"application/json"})),[].concat(ze(p&&l?[(0,Ze.He)(l.id,{visibility:!0})]:[]),ze(e.__SERVICE__.openFeatureInfoButtonEnabled?[]:[(0,Be.lK)({latlng:i},c,u,f,s)]),[(0,Be.HP)()],o)}}return o})),o=e.item,i=o&&o.__SERVICE__&&o.__SERVICE__.then,c=i?Ae.Observable.of((0,v.QJ)(i.map((function(e){return Ke(Ke({},e),{},{options:Ke({item:o},e.options)})})),{text:(0,fe.generateTemplateString)(o.__SERVICE__.displayName||"")(o),placeholder:o.__SERVICE__.nestedPlaceholder&&(0,fe.generateTemplateString)(o.__SERVICE__.nestedPlaceholder||"")(o),placeholderMsgId:o.__SERVICE__.nestedPlaceholderMsgId&&(0,fe.generateTemplateString)(o.__SERVICE__.nestedPlaceholderMsgId||"")(o)},(0,fe.generateTemplateString)(o.__SERVICE__.searchTextTemplate||"")(o))):Ae.Observable.empty(),l=o.__SERVICE__&&o.__SERVICE__.searchTextTemplate,s=l?Ae.Observable.of((0,v.k9)((0,fe.generateTemplateString)(l)(o))):Ae.Observable.empty();return Ae.Observable.of((0,v.kV)()).concat(r,c,s)}))},zoomAndAddPointEpic:function(e,t){return e.ofType(v.b4).switchMap((function(e){var r={type:"Feature",geometry:{type:"Point",coordinates:[e.pos.x,e.pos.y]}},n=t.getState();return Ae.Observable.from([(0,m.W)("search","search","overlay",{features:[r],type:"vector",name:"searchPoints",id:"searchPoints",visibility:!0,style:n.search&&n.search.style||Ee.be}),(0,b.xy)(e.pos,e.zoom,e.crs)])}))},textSearchShowGFIEpic:function(e,t){return e.ofType(v.al).switchMap((function(e){var r,n,o,a,i,c,l=e.item,s=t.getState(),u=null==l||null===(r=l.__SERVICE__)||void 0===r||null===(n=r.options)||void 0===n?void 0:n.typeName,f=u&&(0,Me.dT)(s,u),p=l.bbox||l.properties.bbox||De()(l),d=Ve()(l).geometry.coordinates,m={lng:d[0],lat:d[1]};return d&&(0,Ee.zA)(null==l?void 0:l.__SERVICE__)&&(0,Ee.Tv)(f,null==l?void 0:l.__SERVICE__)?(o=Ae.Observable).of.apply(o,ze(null!=l&&null!==(a=l.__SERVICE__)&&void 0!==a&&a.forceSearchLayerVisibility&&f?[(0,Ze.He)(f.id,{visibility:!0})]:[]).concat([(0,Be.lK)({latlng:m},u,[u],He({},u,{info_format:"application/json"}),l.id),(0,Be.HP)(),(0,b.Px)([p[0],p[1],p[2],p[3]],"EPSG:4326",(null==l||null===(i=l.__SERVICE__)||void 0===i||null===(c=i.options)||void 0===c?void 0:c.maxZoomLevel)||21),(0,v._q)(l)])):Ae.Observable.empty()}))}},reducers:{search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v.NN:return a()({},e,{loading:t.loading});case v.O7:return a()({},e,{error:t.error});case v.gs:return a()({},e,{searchText:t.searchText,error:null});case v.p7:var r=t.results;return!0===t.append&&e&&e.results&&(r=[].concat(Qe(e.results),Qe(t.results))),a()({},e,{results:r,error:null});case v.Av:return a()({},e,{results:null,error:null});case v.wn:return a()({},e,{markerPosition:t.markerPosition,markerLabel:t.markerLabel});case v.Gh:return a()({},e,{highlightedFeature:t.highlightedFeature});case v.M8:return{style:e.style||{}};case y.l:return null;case v.C2:return a()({},e,{selectedServices:t.services,searchText:t.searchText,selectedItems:(e.selectedItems||[]).concat(t.items)});case v.oQ:return a()({},{selectedItems:e.selectedItems&&e.selectedItems.filter((function(e){return e!==t.item})),searchText:""===e.searchText&&t.item&&t.item.text?t.item.text.substring(0,t.item.text.length):e.searchText});case v.x2:return a()({},e,{style:t.style});case v.Y7:return Xe(Xe({},e),{},{activeSearchTool:t.activeSearchTool});case v.GI:return Xe(Xe({},e),{},{format:t.format});case v.KP:return Xe(Xe({},e),{},{coordinate:Xe(Xe({},e.coordinate),{},Je({},t.coord,t.val))});default:return e}},mapInfo:We.Z}}}}]);