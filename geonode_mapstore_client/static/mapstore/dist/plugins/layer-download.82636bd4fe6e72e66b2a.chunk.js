/*! For license information please see layer-download.82636bd4fe6e72e66b2a.chunk.js.LICENSE.txt */
(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[2426],{81808:(e,t,n)=>{"use strict";n.d(t,{eD:()=>r,AM:()=>o,ok:()=>a,Gg:()=>i,nT:()=>l,TL:()=>c,KS:()=>s,EB:()=>u,DZ:()=>p,Aw:()=>f,V_:()=>d,H0:()=>m,jW:()=>y,JZ:()=>b,fQ:()=>v,HK:()=>g,YO:()=>h,I6:()=>O});var r="MAP:LOAD_NEW_MAP",o="MAP_LOAD_MAP_CONFIG",a="MAP_CONFIG_LOADED",i="MAP_CONFIG_LOAD_ERROR",l="MAP_LOAD_INFO",c="MAP_INFO_LOAD_START",s="MAP_INFO_LOADED",u="MAP_INFO_LOAD_ERROR",p="MAP:MAP_SAVE_ERROR",f="MAP:MAP_SAVED",d="MAP:RESET_MAP_SAVE_ERROR";function m(e,t,n){return{type:a,config:e,legacy:!!t,mapId:t,zoomToExtent:n}}function y(e,t){return{type:i,error:e,mapId:t}}function b(e,t,n,r,a){return{type:o,configName:e,mapId:t,config:n,mapInfo:r,overrideConfig:a}}function v(e,t){return{type:s,mapId:t,info:e}}function g(e,t){return{type:u,mapId:e,error:t}}function h(e){return{type:c,mapId:e}}function O(e){return{type:l,mapId:e}}},80416:(e,t,n)=>{"use strict";n.d(t,{yS:()=>r,Zz:()=>o,ms:()=>a,ih:()=>i,OX:()=>l,sb:()=>c,K$:()=>s,k7:()=>u,cX:()=>p,x9:()=>f,vs:()=>d,oE:()=>m,Po:()=>y,qv:()=>b,cI:()=>v,g6:()=>g,I4:()=>h,l$:()=>O,Xv:()=>w,k3:()=>E,CQ:()=>S,R8:()=>P,HN:()=>R,sH:()=>A,c7:()=>x,_7:()=>D,eF:()=>j,O6:()=>T,ED:()=>N,RP:()=>I,sF:()=>F,VP:()=>L,He:()=>_,vO:()=>C,WO:()=>k,bh:()=>M,pV:()=>G,MK:()=>U,ZF:()=>W,tV:()=>B,Dv:()=>Y,Yz:()=>Z,kI:()=>q,XG:()=>V,A4:()=>X,Rp:()=>H,ct:()=>z,oh:()=>Q,$h:()=>K,ud:()=>$,Qr:()=>J,LR:()=>ee,nN:()=>te,UG:()=>ne,F5:()=>re,c9:()=>oe,Jh:()=>ae,Xy:()=>ie});var r="CHANGE_LAYER_PROPERTIES",o="LAYERS:CHANGE_LAYER_PARAMS",a="CHANGE_GROUP_PROPERTIES",i="TOGGLE_NODE",l="SORT_NODE",c="REMOVE_NODE",s="UPDATE_NODE",u="MOVE_NODE",p="LAYER_LOADING",f="LAYER_LOAD",d="LAYER_ERROR",m="ADD_LAYER",y="ADD_GROUP",b="REMOVE_LAYER",v="SHOW_SETTINGS",g="HIDE_SETTINGS",h="UPDATE_SETTINGS",O="REFRESH_LAYERS",w="LAYERS:UPDATE_LAYERS_DIMENSION",E="LAYERS_REFRESHED",S="LAYERS_REFRESH_ERROR",P="LAYERS:BROWSE_DATA",R="LAYERS:DOWNLOAD",A="LAYERS:CLEAR_LAYERS",x="LAYERS:SELECT_NODE",D="LAYERS:FILTER_LAYERS",j="LAYERS:SHOW_LAYER_METADATA",T="LAYERS:HIDE_LAYER_METADATA",N="LAYERS:UPDATE_SETTINGS_PARAMS";function I(e,t,n){return{type:v,node:e,nodeType:t,options:n}}function F(){return{type:g}}function L(e){return{type:h,options:e}}function _(e,t){return{type:r,newProperties:t,layer:e}}function C(e,t){return{type:o,layer:e,params:t}}function k(e,t){return{type:a,newProperties:t,group:e}}function M(e,t,n){return{type:i,node:e,nodeType:t,status:!n}}function G(e){return{type:"CONTEXT_NODE",node:e}}function U(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:l,node:e,order:t,sortLayers:n}}function W(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:c,node:e,nodeType:t,removeEmpty:n}}function B(e,t,n){return{type:s,node:e,nodeType:t,options:n}}function Y(e,t,n){return{type:u,node:e,groupId:t,index:n}}function Z(e){return{type:p,layerId:e}}function q(e,t){return{type:f,layerId:e,error:t}}function V(e,t,n){return{type:d,layerId:e,tilesCount:t,tilesErrorCount:n}}function X(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{type:m,layer:e,foreground:t}}function H(e,t,n){return{type:y,group:e,parent:t,options:n}}function z(e,t){return{type:r,layer:e,newProperties:{_v_:t||(new Date).getTime()}}}function Q(e){return{type:E,layers:e}}function K(e,t){return{type:S,layers:e,error:t}}function $(e,t,n,r){return{type:w,dimension:e,value:t,options:n,layers:r}}function J(e){return{type:P,layer:e}}function ee(e){return{type:R,layer:e}}function te(){return{type:A}}function ne(e,t,n){return{type:x,id:e,nodeType:t,ctrlKey:n}}function re(e){return{type:D,text:e}}function oe(e,t){return{type:j,metadataRecord:e,maskLoading:t}}function ae(){return{type:T}}function ie(e,t){return{type:N,newParams:e,update:t}}},95797:(e,t,n)=>{"use strict";n.d(t,{DR:()=>r,S0:()=>o,u7:()=>a,lj:()=>i,yz:()=>l,lN:()=>c,zW:()=>s,Yx:()=>u,VN:()=>p,Hu:()=>f,VT:()=>d,RD:()=>m,Qq:()=>y,R1:()=>b,_T:()=>v,vO:()=>g,XO:()=>h,jG:()=>O,Xc:()=>w,gT:()=>E,rG:()=>S,t3:()=>P,Fs:()=>R,w_:()=>A,Lm:()=>x,rh:()=>D,rP:()=>j,IO:()=>T}),n(75875);var r="LAYER_SELECTED_FOR_SEARCH",o="FEATURE_TYPE_SELECTED",a="FEATURE_TYPE_LOADED",i="FEATURE_LOADED",l="FEATURE_LOADING",c="FEATURE_TYPE_ERROR",s="FEATURE_ERROR",u="QUERY_CREATE",p="QUERY:UPDATE_QUERY",f="QUERY_RESULT",d="QUERY_ERROR",m="RESET_QUERY",y="QUERY",b="INIT_QUERY_PANEL",v="QUERY:TOGGLE_SYNC_WMS",g="QUERY:TOGGLE_LAYER_FILTER";function h(){return{type:v}}function O(){return{type:g}}function w(){return{type:b}}function E(e,t){return{type:o,url:e,typeName:t}}function S(e,t){return{type:a,typeName:e,featureType:t}}function P(e,t){return{type:c,typeName:e,error:t}}function R(e){return{type:l,isLoading:e}}function A(e,t,n,r,o){return{type:f,searchUrl:t,filterObj:n,result:e,queryOptions:r,reason:o}}function x(e){return{type:d,error:e}}function D(e,t){return{type:p,updates:e,reason:t}}function j(e,t){return{type:u,searchUrl:e,filterObj:t}}function T(e,t,n,r){return{type:y,searchUrl:e,filterObj:t,queryOptions:n,reason:r}}},7472:(e,t,n)=>{"use strict";n.d(t,{Z:()=>R});var r=n(27418),o=n.n(r),a=n(45697),i=n.n(a),l=n(24852),c=n.n(l),s=n(85294),u=n.n(s),p=n(72986),f=n.n(p),d=n(5346);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?w(e):t}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(l,e);var t,n,r,a,i=(r=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(r);if(a){var n=E(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return O(this,e)});function l(){var e;v(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return S(w(e=i.call.apply(i,[this].concat(n))),"renderLoading",(function(){return e.props.maskLoading?c().createElement("div",{style:{width:"100%",height:"100%",position:"absolute",overflow:"visible",margin:"auto",verticalAlign:"center",left:"0",background:"rgba(255, 255, 255, 0.5)",zIndex:2}},c().createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -40%)"}},c().createElement(d.Z,{msgId:"loading"}),c().createElement(f(),{spinnerName:"circle",noFadeIn:!0,overrideSpinnerClassName:"spinner"}))):null})),S(w(e),"renderRole",(function(t){return c().Children.toArray(e.props.children).filter((function(e){return e.props.role===t}))})),S(w(e),"hasRole",(function(t){return c().Children.toArray(e.props.children).filter((function(e){return e.props.role===t})).length>0})),S(w(e),"onClickOut",(function(t){e.props.onClickOut&&e.mask===t.target&&e.props.onClickOut(t)})),e}return t=l,(n=[{key:"render",value:function(){var e=this,t=c().createElement("div",{id:this.props.id,style:b({zIndex:3},this.props.style),className:"".concat(this.props.draggable?"modal-dialog-draggable":""," ").concat(this.props.className," modal-dialog-container")},c().createElement("div",{className:this.props.headerClassName+" draggable-header"},this.renderRole("header")),c().createElement("div",{className:this.props.bodyClassName},this.renderLoading(),this.renderRole("body")),this.hasRole("footer")?c().createElement("div",{className:this.props.footerClassName},this.renderRole("footer")):c().createElement("span",null)),n=this.props.draggable?c().createElement(u(),{defaultPosition:this.props.start,bounds:this.props.bounds,handle:".draggable-header, .draggable-header *"},t):t,r=o()({},this.props.style.display?{display:this.props.style.display}:{},this.props.backgroundStyle);return this.props.modal?c().createElement("div",{ref:function(t){e.mask=t},onClick:this.onClickOut,style:r,className:"fade in modal "+this.props.containerClassName,role:"dialog"},n):n}}])&&g(t.prototype,n),l}(c().Component);S(P,"propTypes",{id:i().string.isRequired,style:i().object,backgroundStyle:i().object,className:i().string,maskLoading:i().bool,containerClassName:i().string,headerClassName:i().string,bodyClassName:i().string,footerClassName:i().string,onClickOut:i().func,modal:i().bool,start:i().object,draggable:i().bool,bounds:i().oneOfType([i().string,i().object])}),S(P,"defaultProps",{style:{},backgroundStyle:{background:"rgba(0,0,0,.5)"},start:{x:0,y:150},className:"modal-dialog modal-content",maskLoading:!1,containerClassName:"",headerClassName:"modal-header",bodyClassName:"modal-body",footerClassName:"modal-footer",modal:!1,draggable:!0,bounds:"parent"});const R=P},35400:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(24852),o=n.n(r),a=n(79313);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.style,n=void 0===t?{}:t,r=e.mainViewStyle,i=void 0===r?{}:r,c=e.contentStyle,s=void 0===c?{}:c,u=e.imageStyle,p=void 0===u?{}:u,f=e.glyph,d=void 0===f?"info-sign":f,m=e.iconFit,y=e.title,b=e.tooltip,v=e.tooltipId,g=e.description,h=e.content;return o().createElement("div",{className:"empty-state-container",style:l({height:m?"100%":void 0},n)},o().createElement("div",{key:"main-view",className:"empty-state-main-view",style:l({height:m?"100%":void 0},i)},d?o().createElement("div",{key:"glyph",className:"empty-state-image",style:l({height:m?"100%":void 0},p)},o().createElement(a.Z,{iconFit:m,tooltip:b,tooltipId:v,glyph:d})):null,y?o().createElement("h1",{key:"title"},y):null,g?o().createElement("p",{key:"description",className:"empty-state-description"},g):null),o().createElement("div",{key:"content",className:"empty-state-content",style:s},h))}},79313:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(24852),o=n.n(r),a=n(30294),i=n(96259),l=(0,n(15135).Z)(a.Glyphicon);const c=function(e){var t=e.glyph,n=void 0===t?"info-sign":t,r=e.tooltip,a=e.tooltipId,c=e.iconFit,s=e.padding,u=void 0===s?0:s,p=e.margin,f=void 0===p?0:p;return o().createElement(i.Z,null,(function(e){var t=e.width,i=e.height;return o().createElement(l,{glyph:n,tooltip:r,tooltipId:a,style:{display:"inline-block",padding:u+"px",margin:f+"px",textAlign:"center",fontSize:c?Math.min(t,i)-2*u-2*f:t-2*u-2*f}})}))}},32425:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n(45697),o=n.n(r),a=n(24852),i=n.n(a);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(e){return e>100?"full":e>40?"medium":"small"},p=function(e){var t=e.size,n=e.style,r=void 0===n?{}:n,o=e.className,a=e.hidden;return i().createElement("div",{className:o,style:c({width:t,height:t,overflow:"hidden"},r)},!a&&i().createElement("div",{className:"mapstore-".concat(u(t),"-size-loader")}))};p.propTypes={size:o().number,className:o().string,style:o().object};const f=p},50966:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(61365),o=n(30294);const a=(0,r.Z)(o.OverlayTrigger)},61365:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(24852),o=n.n(r),a=n(37275);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}const l=function(e){return function(t){return o().createElement(e,i({},t,{container:document.querySelector("."+(a.ZP.getConfigProp("themePrefix")||"ms2")+" > div")||document.body}))}}},82030:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(24852),o=n.n(r),a=n(86494),i=n(67076),l=n(35400);const c=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.Z;return(0,i.branch)(e,(function(){return function(e){return o().createElement(n,t&&(0,a.isFunction)(t)?t(e):t)}}))}},15135:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var r=n(24852),o=n.n(r),a=n(67076),i=n(30294),l=n(50966),c=n(5346),s=n(86494);function u(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const p=(0,a.branch)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tooltip,n=e.tooltipId;return t||n}),(function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.tooltip,r=t.tooltipId,a=t.tooltipPosition,s=void 0===a?"top":a,p=t.tooltipTrigger,f=t.keyProp,d=t.idDropDown,m=t.args,y=u(t,["tooltip","tooltipId","tooltipPosition","tooltipTrigger","keyProp","idDropDown","args"]);return o().createElement(l.Z,{trigger:p,id:d,key:f,placement:s,overlay:o().createElement(i.Tooltip,{id:"tooltip-"+f},r?o().createElement(c.Z,{msgId:r,msgParams:{data:m}}):n)},o().createElement(e,y))}}),(function(e){return function(t){return o().createElement(e,(0,s.omit)(t,["tooltipId","tooltip"]),t.children)}}))},45869:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var r=n(24852),o=n.n(r),a=n(45697),i=n.n(a);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(l,e);var t,n,r,a,i=(r=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(r);if(a){var n=f(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(){return c(this,l),i.apply(this,arguments)}return t=l,(n=[{key:"render",value:function(){var e=this;return o().createElement("label",{className:"mapstore-switch-btn ".concat(this.props.className)},o().createElement("input",{type:"checkbox",disabled:this.props.disabled,checked:this.props.checked,onChange:function(){return e.props.onChange(!e.props.checked)}}),o().createElement("span",{onClick:function(){return e.props.onClick(!e.props.checked)},className:"m-slider"}))}}])&&s(t.prototype,n),l}(o().Component);d(m,"propTypes",{disabled:i().bool,className:i().string,checked:i().bool,onChange:i().func,onClick:i().func}),d(m,"defaultProps",{className:"",checked:!1,onChange:function(){},onClick:function(){}});const y=m},86850:(e,t,n)=>{"use strict";n.d(t,{Mc:()=>N,v$:()=>I,ED:()=>F});var r=n(72500),o=n.n(r),a=n(86494),i=n(49977),l=n.n(i),c=n(5055),s=n(7526),u=n(75875),p=n.n(u),f=n(47805),d=n(24262),m=n(10284),y=n(39156);function b(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=n.n(y)()({wfsVersion:"1.1.0"}),P=S.getFeature,R=S.query,A=S.sortBy,x=S.propertyName,D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.totalFeatures,n=e.features,r=h(e,["totalFeatures","features"]),o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=o.startIndex,i=arguments.length>2?arguments[2]:void 0;return i>t&&i===a+n.length&&t===n.length?w(w({},r),{},{features:n,totalFeatures:i}):w(w({},r),{},{features:n,totalFeatures:t})},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.pagination||!(0,a.isNil)(t.startIndex)&&!(0,a.isNil)(t.maxFeatures)&&{startIndex:t.startIndex,maxFeatures:t.maxFeatures}},T=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(0,f.getWFSFilterData)(t,n),i=o().parse(e,!0),c=(0,a.isObject)(i.query)?i.query:{};c.service="WFS",c.outputFormat="json";var s=o().format({protocol:i.protocol,host:i.host,pathname:i.pathname,query:c});return l().Observable.defer((function(){return p().post(s,r,{timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/json"}})})).let(m.oB).map((function(e){return D(e.data,j(t,n),n.totalFeatures)}))},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.search,n=void 0===t?{}:t,r=e.url,o=e.name,i=arguments.length>1?arguments[1]:void 0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=l.sortOptions,s=l.propertyName,u=h(l,["sortOptions","propertyName"]);return T(n.url||r,i&&"object"===g(i)?w(w({},i),{},{typeName:o||i.typeName}):P(R(o,[].concat(b(c?[A(c.sortBy,c.sortOrder)]:[]),b(s?[x(s)]:[]),b(i?(0,a.castArray)(i):[]))),u),u).catch((function(e){if("OGCError"===e.name&&"NoApplicableCode"===e.code&&!c&&s&&s[0])return T(n.url||r,i&&"object"===g(i)?w(w({},i),{},{typeName:o||i.typeName}):P(R(o,[A(s[0])].concat(b(s?[x(s)]:[]),b(i?(0,a.castArray)(i):[]))),u),u);throw e}))},I=function(e){var t=e.layer;return l().Observable.defer((function(){return p().get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.search,r=void 0===n?{}:n,a=e.url,i=e.describeFeatureTypeURL,l=o().parse(i||r.url||a,!0);return o().format(w(w({},l),{},{search:void 0,query:w(w({},l.query),{},{service:"WFS",version:"1.1.0",typeName:t,outputFormat:"application/json",request:"DescribeFeatureType"})}))}(t))})).let(m.oB)},F=function(e){var t=e.layer;return l().Observable.defer((function(){return p().get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.search,r=void 0===n?{}:n,a=e.url,i=(0,d.getCapabilitiesUrl)({name:t,url:r&&r.url||a}),l=o().parse(i,!0);return o().format(w(w({},l),{},{search:void 0,query:w(w({},l.query),{},{service:"WFS",version:"1.1.1",request:"GetCapabilities"})}))}(t))})).let(m.oB).switchMap((function(e){return l().Observable.bindNodeCallback((function(e,t){return(0,c.parseString)(e,{tagNameProcessors:[s.stripPrefix],explicitArray:!1,mergeAttrs:!0},t)}))(e.data)}))}},99767:(e,t,n)=>{"use strict";n.d(t,{qP:()=>s,XA:()=>u,fA:()=>p,gN:()=>f,p5:()=>d,Rr:()=>m,DK:()=>y,En:()=>b,Tr:()=>v,t$:()=>g,XJ:()=>h,Dx:()=>O,Jy:()=>w});var r=n(72500),o=n.n(r),a=n(86494);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(e,t){return"<wps:Input>"+"<ows:Identifier>".concat(e,"</ows:Identifier>")+t+"</wps:Input>"},u=function(e){return"<wps:Data>".concat(e,"</wps:Data>")},p=function(e,t,n,r){return'<wps:Reference mimeType="'.concat(e,'" xlink:href="').concat(t,'" method="').concat(n,'"').concat("POST"===n?"":"/",">")+("POST"===n?"<wps:Body>".concat(r,"</wps:Body></wps:Reference>"):"")},f=function(e){return"<wps:LiteralData>".concat(e,"</wps:LiteralData>")},d=function(e,t,n){return"<wps:ComplexData".concat(t?' mimeType="'.concat(t,'"'):"").concat(n?' encoding="'.concat(n,'"'):"",">").concat(e,"</wps:ComplexData>")},m=function(e){return"<![CDATA[".concat(e,"]]>")},y=function(e){return"<wps:ResponseForm>".concat(e,"</wps:ResponseForm>")},b=function(e,t){return"<wps:RawDataOutput".concat(t?' mimeType="'.concat(t,'"'):"",">")+"<ows:Identifier>".concat(e,"</ows:Identifier>")+"</wps:RawDataOutput>"},v=function(e,t,n){return"<wps:ResponseDocument".concat(e?' storeExecuteResponse="true"':"").concat(t?' status="true"':"",">")+n+"</wps:ResponseDocument>"},g=function(e,t,n,r,o){return"<wps:Output".concat(e?' mimeType="'.concat(e,'"'):"").concat(t?' asReference="true"':"",">")+"<ows:Identifier>".concat(n,"</ows:Identifier>")+(r?"<ows:Title>".concat(r,"</ows:Title>"):"")+(o?"<ows:Abstract>".concat(o,"</ows:Abstract>"):"")+"</wps:Output>"},h=function(e){return s("writeParameters",u(d("<dwn:Parameters>".concat(e,"</dwn:Parameters>"))))},O=function(e,t){return'<dwn:Parameter key="'.concat(e,'">').concat(t,"</dwn:Parameter>")},w=function(e,t){if(e){var n=o().parse(e,!0),r=n.pathname;return((0,a.endsWith)(n.pathname,"wfs")||(0,a.endsWith)(n.pathname,"wms"))&&(r=n.pathname.replace(/(wms|ows|wfs|wps)$/,"wps")),o().format(l(l({},n),{},{search:null,pathname:r,query:l(l({service:"WPS"},t),n.query)}))}return e}},72747:(e,t,n)=>{"use strict";n.d(t,{l:()=>c});var r=n(49977),o=n(75875),a=n.n(o),i=n(10284),l=n(99767),c=function(e,t){return r.Observable.defer((function(){return a().get((0,l.Jy)(e,{version:"1.0.0",REQUEST:"DescribeProcess",IDENTIFIER:t}),{timeout:5e3,headers:{Accept:"application/json","Content-Type":"application/xml"}})})).let(i.oB)}},27835:(e,t,n)=>{"use strict";n.d(t,{Uh:()=>S,W5:()=>P,ai:()=>x,RW:()=>D,dr:()=>j,mG:()=>N});var r=n(86494),o=n(49977),a=n(5055),i=n(7526),l=n(75875),c=n.n(l),s=n(99767);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){var t="function"==typeof Map?new Map:void 0;return(v=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return g(e,arguments,w(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),O(r,e)})(e)}function g(e,t,n){return(g=h()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&O(o,n.prototype),o}).apply(null,arguments)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(o,e);var t,n,r=(t=o,n=h(),function(){var e,r=w(t);if(n){var o=w(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return b(this,e)});function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e)).name="WPSExecuteError",n.code=t||e,n}return o}(v(Error)),S=function(e,t,n){return'<?xml version="1.0" encoding="UTF-8"?><wps:Execute version="1.0.0" service="WPS" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.opengis.net/wps/1.0.0" xmlns:wfs="http://www.opengis.net/wfs" xmlns:wps="http://www.opengis.net/wps/1.0.0" xmlns:ows="http://www.opengis.net/ows/1.1" xmlns:gml="http://www.opengis.net/gml" xmlns:ogc="http://www.opengis.net/ogc" xmlns:wcs="http://www.opengis.net/wcs/1.1.1" xmlns:dwn="http://geoserver.org/wps/download" xmlns:xlink="http://www.w3.org/1999/xlink" xsi:schemaLocation="http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd">'+"<ows:Identifier>".concat(e,"</ows:Identifier>")+"<wps:DataInputs>"+(t||[]).join("")+"</wps:DataInputs>"+(n||"")+"</wps:Execute>"},P=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o.Observable.defer((function(){return c().get((0,s.Jy)(e,{version:"1.0.0",REQUEST:"GetExecutionStatus",executionId:t}),m({headers:{Accept:"application/xml"}},n))}))},R=function(e,t){var n,o,a=function(e){var t,n,o,a,i,l,c,s,u,p,f,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.identity,m=null==e||null===(t=e.ExecuteResponse)||void 0===t||null===(n=t.Status)||void 0===n?void 0:n[0];return null!=m&&m.ProcessAccepted?{status:"ProcessAccepted"}:null!=m&&m.ProcessStarted?{status:"ProcessStarted"}:null!=m&&m.ProcessSucceeded?{status:"ProcessSucceeded",data:d(null===(o=e.ExecuteResponse.ProcessOutputs)||void 0===o||null===(a=o[0])||void 0===a?void 0:a.Output)}:null!=m&&m.ProcessFailed?{status:"ProcessFailed",exceptionReport:null==m||null===(i=m.ProcessFailed)||void 0===i||null===(l=i[0])||void 0===l||null===(c=l.ExceptionReport)||void 0===c||null===(s=c[0])||void 0===s||null===(u=s.Exception)||void 0===u||null===(p=u[0])||void 0===p||null===(f=p.ExceptionText)||void 0===f?void 0:f[0]}:null!=m&&m.ProcessPaused?{status:"ProcessPaused"}:{status:"UnexpectedStatus"}}(e,t);if("ProcessFailed"===a.status)throw new E(a.exceptionReport,"ProcessFailed");if("UnexpectedStatus"===a.status)throw new E("UnexpectedProcessStatus");if("ProcessSucceeded"===a.status)return{succeeded:!0,data:a.data};var i=null==e||null===(n=e.ExecuteResponse)||void 0===n||null===(o=n.$)||void 0===o?void 0:o.statusLocation;if(!i)throw new E("NoStatusLocation");var l=i.indexOf("executionId=");if(-1===l)throw new E("NoExecutionId");var c=i.slice(l+12),s=c.indexOf("&");return{succeeded:!1,executionId:-1===s?c:c.slice(0,s)}},A=function(e){var t,n;return null!=e&&null!==(t=e.Identifier)&&void 0!==t&&t[0]?{identifier:null==e||null===(n=e.Identifier)||void 0===n?void 0:n[0]}:null},x=function(e){var t,n,r,o,a;return null!=e&&null!==(t=e.Data)&&void 0!==t&&null!==(n=t[0])&&void 0!==n&&n.LiteralData?{data:null==e||null===(r=e.Data)||void 0===r||null===(o=r[0])||void 0===o||null===(a=o.LiteralData)||void 0===a?void 0:a[0]}:null},D=function(e){var t,n,r,o,a,i;return null!=e&&e.Reference?{href:null==e||null===(t=e.Reference)||void 0===t||null===(n=t[0])||void 0===n||null===(r=n.$)||void 0===r?void 0:r.href,mimeType:null==e||null===(o=e.Reference)||void 0===o||null===(a=o[0])||void 0===a||null===(i=a.$)||void 0===i?void 0:i.mimeType}:null},j=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return[A].concat(p(t||[])).map((function(t){return t(e)})).reduce((function(e,t){return t?m(m({},e),t):e}),{})}))}},T=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o.Observable.defer((function(){return c().post((0,s.Jy)(e,{version:"1.0.0",REQUEST:"Execute"}),t,m({headers:{"Content-Type":"application/xml"}},n))}))},N=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=n.executeStatusUpdateInterval,c=void 0===l?2e3:l,s=n.outputsExtractor,u=function(e){return o.Observable.defer((function(){return new Promise((function(t,n){return(0,a.parseString)(e,{tagNameProcessors:[i.stripPrefix]},(function(e,r){return e?n(e):t(r)}))}))}))};return T(e,t,r).catch((function(){throw new E("ExecuteProcessXHRFailed")})).switchMap((function(e){return"application/xml"===e.headers["content-type"]||"text/xml"===e.headers["content-type"]?u(e.data).map((function(t){return{data:t,type:"application/xml",originalData:e.data}})):o.Observable.of({data:e.data,type:e.headers["content-type"]})})).flatMap((function(t){var n=t.data,r=t.type,a=t.originalData;if("application/xml"!==r)return o.Observable.of(n);if(null==n||!n.ExecuteResponse)return o.Observable.of(a);var i=R(n,s),l=i.succeeded,p=i.data,f=i.executionId;if(l)return o.Observable.of(p);var d=o.Observable.interval(c).take(1).flatMap((function(){return P(e,f).catch((function(){throw new E("GetExecutionStatusXHRFailed")})).flatMap((function(e){return u(e.data).flatMap((function(e){var t=R(e,s);return t.succeeded?o.Observable.of(t.data):d}))}))}));return d}))}},80658:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Xt});var r={};n.r(r),n.d(r,{checkExportDataEntriesEpic:()=>Mt,checkWPSAvailabilityEpic:()=>It,closeExportDownload:()=>Ct,fetchFormatsWFSDownload:()=>Lt,openDownloadTool:()=>Ft,resetExportDataResultsOnLogout:()=>Ut,serializeCookieOnExportDataChange:()=>Gt,setExportDataResultsOnLoginSuccessAndMapConfigLoaded:()=>Wt,showInfoBubbleMessageEpic:()=>kt,startFeatureExportDownload:()=>_t});var o=n(71703),a=n(22222),i="LAYERDOWNLOAD:CHECK_WPS_AVAILABILITY",l="LAYERDOWNLOAD:CHECKING_WPS_AVAILABILITY",c="LAYERDOWNLOAD:DOWNLOAD_FEATURES",s="LAYERDOWNLOAD:DOWNLOAD_FINISHED",u="LAYERDOWNLOAD:FORMAT_SELECTED",p="LAYERDOWNLOAD:CLEAR_DOWNLOAD_OPTIONS",f="LAYERDOWNLOAD:FORMAT_FETCH",d="LAYERDOWNLOAD:FORMAT_UPDATE",m="LAYERDOWNLOAD:SET_SERVICE",y="LAYERDOWNLOAD:SET_EXPORT_DATA_RESULTS",b="LAYERDOWNLOAD:ADD_EXPORT_DATA_RESULT",v="LAYERDOWNLOAD:UPDATE_EXPORT_DATA_RESULT",g="LAYERDOWNLOAD:REMOVE_EXPORT_DATA_RESULT",h="LAYERDOWNLOAD:REMOVE_EXPORT_DATA_RESULTS",O="LAYERDOWNLOAD:CHECK_EXPORT_DATA_ENTRIES",w="LAYERDOWNLOAD:CHECKING_EXPORT_DATA_ENTRIES",E="LAYERDOWNLOAD:SERIALIZE_COOKIE",S="LAYERDOWNLOAD:SHOW_INFO_BUBBLE_MESSAGE",P="LAYERDOWNLOAD:SHOW_INFO_BUBBLE",R="LAYERDOWNLOAD:SET_INFO_BUBBLE_MESSAGE",A=function(e){return{type:l,checking:e}},x=function(e,t){return{type:u,key:e,value:t}},D=function(){return{type:s}},j=function(e){return{type:m,service:e}},T=function(e){return{type:y,results:e}},N=function(e,t){return{type:v,id:e,newProps:t}},I=function(e){return{type:w,checking:e}},F=function(e,t,n,r){return{type:S,msgId:e,msgParams:t,level:n,duration:r}},L=function(e){return{type:P,show:e}},_=function(e,t,n){return{type:R,msgId:e,msgParams:t,level:n}},C=n(82904),k=n(31255),M=n(75110),G=n(24260),U=function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.service},W=(0,a.P1)(k.Rd,G.X1,M.Iz,(function(e,t,n){return e?t:null!=n&&n.name?{featureTypeName:n.name,filterType:"OGC",ogcVersion:"1.1.0"}:null})),B=function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.results},Y=n(8316),Z=n(24852),q=n.n(Z),V=n(45697),X=n.n(V),H=n(86494),z=n(27418),Q=n.n(z),K=n(30294),$=n(72986),J=n.n($),ee=n(32425),te=n(7472),ne=n(5346),re=n(35400),oe=n(43129),ae=n(45869);function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const le=function(e){var t,n,r=e.cropDataSetVisible,o=void 0!==r&&r,a=e.cropDataSetEnabled,i=void 0!==a&&a,l=e.donwloadFilteredVisible,c=void 0!==l&&l,s=e.downloadFilteredEnabled,u=void 0!==s&&s,p=e.advancedOptionsVisible,f=void 0!==p&&p,d=e.compressionOptions,m=void 0===d?["CCITT RLE","LZW","JPEG","ZLib","PackBits","Deflate"]:d,y=e.selectedCompression,b=e.tileWidth,v=e.tileHeight,g=e.quality,h=e.onChange,O=void 0===h?function(){}:h,w=(t=q().useState(!1),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n}}(t,n)||function(e,t){if(e){if("string"==typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ie(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),E=w[0],S=w[1];return q().createElement(q().Fragment,null,o&&q().createElement("div",{className:"mapstore-downloadwpsoptions-menuitem"},q().createElement(ae.Z,{checked:i,onClick:function(e){return O("cropDataSet",e)}}),q().createElement(ne.Z,{msgId:"layerdownload.cropDataSet"})),c&&q().createElement("div",{className:"mapstore-downloadwpsoptions-menuitem"},q().createElement(ae.Z,{checked:u,onClick:function(e){return O("downloadFilteredDataSet",e)}}),q().createElement(ne.Z,{msgId:"layerdownload.downloadFilteredDataSet"})),f&&q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-options"},q().createElement(K.Button,{className:"no-border",onClick:function(){return S(!E)}},q().createElement(K.Glyphicon,{glyph:"chevron-".concat(E?"down":"right")})),q().createElement(ne.Z,{msgId:"layerdownload.advancedOptions"})),E&&f&&q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced"},q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},q().createElement(ne.Z,{msgId:"layerdownload.compression"}),q().createElement(oe.ZP,{clearable:!0,value:y,options:m.map((function(e){return(0,H.isString)(e)?{value:e,label:e}:e})),onChange:function(e){return O("compression",null==e?void 0:e.value)}})),q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},q().createElement(ne.Z,{msgId:"layerdownload.quality"}),q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},q().createElement(K.FormControl,{placeholder:"0.75",type:"number",min:"0",max:"1",value:g||"",onChange:function(e){return O("quality",e.target.value)}}))),q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},q().createElement(ne.Z,{msgId:"layerdownload.tileWidth"}),q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},q().createElement(K.FormControl,{placeholder:"256",type:"number",min:"0",value:b||"",onChange:function(e){return O("tileWidth",e.target.value&&e.target.value.length>0?"".concat(parseInt(e.target.value,10)):"")}}),q().createElement("span",null,"px"))),q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},q().createElement(ne.Z,{msgId:"layerdownload.tileHeight"}),q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},q().createElement(K.FormControl,{placeholder:"256",type:"number",min:"0",value:v||"",onChange:function(e){return O("tileHeight",e.target.value&&e.target.value.length>0?"".concat(parseInt(e.target.value,10)):"")}}),q().createElement("span",null,"px")))))};function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fe(e,t){return!t||"object"!==ce(t)&&"function"!=typeof t?de(e):t}function de(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(i,e);var t,n,r,o,a=(r=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=me(r);if(o){var n=me(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return fe(this,e)});function i(){var e;se(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ye(de(e=a.call.apply(a,[this].concat(n))),"getSelectedFormat",(function(){return(0,H.get)(e.props,"downloadOptions.selectedFormat")})),ye(de(e),"getSelectedSRS",(function(){return(0,H.get)(e.props,"downloadOptions.selectedSrs")||e.props.defaultSrs||(0,H.get)((0,H.head)(e.props.srsList),"name")})),e}return t=i,(n=[{key:"render",value:function(){var e,t=this;return q().createElement("form",null,q().createElement("label",null,q().createElement(ne.Z,{msgId:"layerdownload.format"})),q().createElement(oe.ZP,{clearable:!1,isLoading:this.props.formatsLoading,onOpen:function(){return t.props.formatOptionsFetch(t.props.layer)},value:null===(e=this.props.downloadOptions)||void 0===e?void 0:e.selectedFormat,noResultsText:q().createElement(ne.Z,{msgId:"layerdownload.format"}),onChange:function(e){return t.props.onChange("selectedFormat",e.value)},options:this.props.formats.map((function(e){return{value:e.name,label:e.label||e.name}}))}),q().createElement("label",null,q().createElement(ne.Z,{msgId:"layerdownload.srs"})),q().createElement(oe.ZP,{clearable:!1,value:this.getSelectedSRS(),onChange:function(e){return t.props.onChange("selectedSrs",e.value)},options:this.props.srsList.map((function(e){return{value:e.name,label:e.label||e.name}}))}),this.props.wpsOptionsVisible&&q().createElement(le,{cropDataSetVisible:!0,donwloadFilteredVisible:this.props.downloadFilteredVisible,advancedOptionsVisible:this.props.wpsAdvancedOptionsVisible,cropDataSetEnabled:this.props.downloadOptions.cropDataSet,downloadFilteredEnabled:this.props.downloadOptions.downloadFilteredDataSet,selectedCompression:this.props.downloadOptions.compression,quality:this.props.downloadOptions.quality,tileWidth:this.props.downloadOptions.tileWidth,tileHeight:this.props.downloadOptions.tileHeight,onChange:this.props.onChange}),this.props.virtualScroll?null:q().createElement(K.Checkbox,{checked:this.props.downloadOptions.singlePage,onChange:function(){return t.props.onChange("singlePage",!t.props.downloadOptions.singlePage)}},q().createElement(ne.Z,{msgId:"layerdownload.downloadonlycurrentpage"})))}}])&&ue(t.prototype,n),i}(q().Component);ye(be,"propTypes",{downloadOptions:X().object,formatOptionsFetch:X().func,formats:X().array,srsList:X().array,onChange:X().func,defaultSrs:X().string,wpsOptionsVisible:X().bool,wpsAdvancedOptionsVisible:X().bool,downloadFilteredVisible:X().bool,layer:X().object,formatsLoading:X().bool,virtualScroll:X().bool}),ye(be,"defaultProps",{downloadOptions:{},formatsLoading:!1,formats:[],srsList:[],wpsOptionsVisible:!1,wpsAdvancedOptionsVisible:!1,downloadFilteredVisible:!1,virtualScroll:!0});const ve=be;var ge=n(38560);function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ee(e,t){return(Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Se(e,t){return!t||"object"!==he(t)&&"function"!=typeof t?Pe(e):t}function Pe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ee(e,t)}(i,e);var t,n,r,o,a=(r=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Re(r);if(o){var n=Re(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Se(this,e)});function i(){var e;Oe(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ae(Pe(e=a.call.apply(a,[this].concat(n))),"onClose",(function(){e.props.onClose()})),Ae(Pe(e),"renderIcon",(function(){return e.props.loading?q().createElement("div",{style:{float:"left"}},q().createElement(J(),{spinnerName:"circle",noFadeIn:!0})):q().createElement(K.Glyphicon,{glyph:"download"})})),Ae(Pe(e),"handleExport",(function(){var t=e.props,n=t.url,r=t.filterObj,o=t.downloadOptions,a=t.defaultSrs,i=t.srsList,l=t.onExport,c=t.layer,s=o&&o.selectedSrs||a||(i[0]||{}).name;l(n||c.url,r,Q()({},o,{selectedSrs:s}))})),e}return t=i,(n=[{key:"componentDidMount",value:function(){this.props.onMount()}},{key:"componentWillUnmount",value:function(){this.props.onUnmount()}},{key:"componentDidUpdate",value:function(e){this.props.enabled!==e.enabled&&this.props.enabled&&(this.props.onClearDownloadOptions(),"wms"===this.props.layer.type&&this.props.onCheckWPSAvailability(this.props.url||this.props.layer.url))}},{key:"render",value:function(){var e,t,n,r=this,o=function(e){return r.props.formats.filter((function(t){var n,o,a=t.validServices,i=t.type,l=void 0===i?"vector":i;return(!a||(0,H.findIndex)(a,(function(t){return t===e}))>-1)&&("vector"===l&&(null===(n=r.props.layer.search)||void 0===n?void 0:n.url)||"raster"===l&&!(null!==(o=r.props.layer.search)&&void 0!==o&&o.url))}))},a=o("wfs"),i=o("wps"),l=a.length>0?a.filter((function(e){return r.props.wfsFormats.find((function(t){return t.name.toLowerCase()===e.name.toLowerCase()}))})):this.props.wfsFormats;return this.props.enabled?q().createElement(te.Z,{id:"mapstore-export",draggable:!1,modal:!0},q().createElement("span",{role:"header"},q().createElement("span",{className:"about-panel-title"},q().createElement(ne.Z,{msgId:"layerdownload.title"})),q().createElement("button",{onClick:this.onClose,className:"settings-panel-close close"},this.props.closeGlyph?q().createElement(K.Glyphicon,{glyph:this.props.closeGlyph}):q().createElement("span",null,"×"))),q().createElement("div",{role:"body"},this.props.checkingWPSAvailability?q().createElement(ee.Z,{size:100,style:{margin:"0 auto"}}):"wfs"!==this.props.service||null!==(e=this.props.layer.search)&&void 0!==e&&e.url?q().createElement(ve,{downloadOptions:this.props.downloadOptions,onChange:this.props.onDownloadOptionChange,formatOptionsFetch:"wfs"===this.props.service?this.props.onFormatOptionsFetch:function(){},formatsLoading:this.props.formatsLoading,formats:"wfs"===this.props.service?l:i,srsList:this.props.srsList,defaultSrs:this.props.defaultSrs,wpsOptionsVisible:"wps"===this.props.service,wpsAdvancedOptionsVisible:!(null!==(t=this.props.layer.search)&&void 0!==t&&t.url),downloadFilteredVisible:!(null===(n=this.props.layer.search)||void 0===n||!n.url),layer:this.props.layer,virtualScroll:this.props.virtualScroll}):q().createElement(re.Z,{title:q().createElement(ne.Z,{msgId:"layerdownload.noSupportedServiceFound"})})),!this.props.checkingWPSAvailability&&q().createElement("div",{role:"footer"},q().createElement(ge.Z,{bsStyle:"primary",className:"download-button",disabled:!this.props.downloadOptions.selectedFormat||this.props.loading,onClick:this.handleExport},this.renderIcon()," ",q().createElement(ne.Z,{msgId:"layerdownload.export"})))):null}}])&&we(t.prototype,n),i}(q().Component);Ae(xe,"propTypes",{filterObj:X().object,closeGlyph:X().string,url:X().string,service:X().string,onMount:X().func,onUnmount:X().func,enabled:X().bool,loading:X().bool,checkingWPSAvailability:X().bool,onClose:X().func,onExport:X().func,onCheckWPSAvailability:X().func,onDownloadOptionChange:X().func,onClearDownloadOptions:X().func,onFormatOptionsFetch:X().func,downloadOptions:X().object,wfsFormats:X().array,formats:X().array,srsList:X().array,defaultSrs:X().string,layer:X().object,formatsLoading:X().bool,virtualScroll:X().bool}),Ae(xe,"defaultProps",{onMount:function(){},onUnmount:function(){},onExport:function(){},onClose:function(){},onCheckWPSAvailability:function(){},onDownloadOptionChange:function(){},onClearDownloadOptions:function(){},onFormatOptionsFetch:function(){},checkingWPSAvailability:!1,layer:{},closeGlyph:"1-close",service:"wfs",wfsFormats:[],formats:[{name:"application/json",label:"GeoJSON",type:"vector",validServices:["wps"]},{name:"application/arcgrid",label:"ArcGrid",type:"raster",validServices:["wps"]},{name:"image/tiff",label:"TIFF",type:"raster",validServices:["wps"]},{name:"image/png",label:"PNG",type:"raster",validServices:["wps"]},{name:"image/jpeg",label:"JPEG",type:"raster",validServices:["wps"]},{name:"application/wfs-collection-1.0",label:"wfs-collection-1.0",type:"vector",validServices:["wps"]},{name:"application/wfs-collection-1.1",label:"wfs-collection-1.1",type:"vector",validServices:["wps"]},{name:"application/zip",label:"Shapefile",type:"vector",validServices:["wps"]},{name:"text/csv",label:"CSV",type:"vector",validServices:["wps"]}],formatsLoading:!1,srsList:[{name:"native",label:"Native"},{name:"EPSG:4326",label:"WGS84"}],virtualScroll:!0,downloadOptions:{}});const De=xe;var je=n(82030),Te=n(50966),Ne=n(24262),Ie=q().createElement(K.Button,{bsStyle:"primary",bsSize:"small",className:"mapstore-exportdataresults-item-failed"},q().createElement(K.Glyphicon,{glyph:"exclamation-sign"}));const Fe=(0,je.Z)((function(e){var t=e.results;return!(void 0===t?[]:t).length}),{title:q().createElement(ne.Z,{msgId:"exportDataResults.emptyStateMessage"})})((function(e){var t=e.loading,n=void 0!==t&&t,r=e.results,o=void 0===r?[]:r,a=e.currentLocale,i=e.onRemoveResult,l=void 0===i?function(){}:i;return n?q().createElement(ee.Z,{size:100,style:{margin:"0 auto",padding:"10px"}}):q().createElement("div",{className:"mapstore-exportdataresults-container"},o.map((function(e){var t=e.id,n=e.layerName,r=e.layerTitle,o=e.startTime,i=e.status,c=e.result,s=(0,Ne.getLayerTitle)({name:n,title:r},a),u=new Date(o),p=function(e){return e<10?"0".concat(e):"".concat(e)},f="".concat(p(u.getDate()),"/").concat(p(u.getMonth()+1),"/").concat(u.getFullYear()," ").concat(p(u.getHours()),":").concat(p(u.getMinutes()));return q().createElement("div",{key:t,className:"mapstore-exportdataresults-item"},q().createElement("div",{className:"mapstore-exportdataresults-item-name"},s),q().createElement("div",{className:"mapstore-exportdataresults-item-date"},f),q().createElement("div",{className:"mapstore-exportdataresults-item-buttons"},"pending"===i&&q().createElement(ee.Z,{size:22,style:{marginLeft:"2px"}}),"failed"===i&&c&&c.msgId?q().createElement(Te.Z,{placement:"top",overlay:q().createElement(K.Tooltip,{id:"exportresults-failure-tooltip"},q().createElement(ne.Z,{msgId:c.msgId,msgParams:c.msgParams}))},Ie):null,"failed"!==i||c&&c.msgId?null:Ie,"completed"===i&&q().createElement("a",{href:c},q().createElement(K.Button,{bsStyle:"primary",bsSize:"small"},q().createElement(K.Glyphicon,{glyph:"floppy-disk"}))),q().createElement(K.Button,{bsStyle:"primary",bsSize:"small",onClick:function(){return l(t)}},q().createElement(K.Glyphicon,{glyph:"trash"}))))})))}));var Le=n(94184),_e=n.n(Le);function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const ke=function(e){var t,n=e.show,r=e.arrowDirection,o=void 0===r?"bottom":r,a=e.className,i=e.containerClassName,l=e.children;return q().createElement("div",{className:_e().apply(void 0,["mapstore-info-bubble"].concat((t=n?["mapstore-info-bubble-visible"]:[],function(e){if(Array.isArray(e))return Ce(e)}(t)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ce(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[a]))},q().createElement("div",{className:_e()("mapstore-info-bubble-container",i)},q().createElement("div",{className:_e()("mapstore-info-bubble-arrow-container","arrow-".concat(o))},q().createElement("div",{className:"mapstore-info-bubble-arrow"})),q().createElement("div",{className:"mapstore-info-bubble-inner"},l)))},Me=function(e){var t=e.msgId,n=e.msgParams,r=e.level,o=void 0===r?"normal":r,a=e.className;return q().createElement("div",{className:_e()("mapstore-info-bubble-default-inner","mapstore-info-bubble-default-inner-level-".concat(o),a)},t?q().createElement(ne.Z,{msgId:t,msgParams:n}):null)};var Ge=n(9669),Ue=n.n(Ge),We=n(49977),Be=n.n(We),Ye=n(78598),Ze=n(5055),qe=n(7526),Ve=n(23570),Xe=n.n(Ve),He=n(75982),ze=n(80416),Qe=n(95797),Ke=n(97395),$e=n(63516),Je=n(81808),et=n(7147),tt=n(827),nt=n(74621),rt=n(86850),ot=n(72747),at=n(99767),it=n(27835);function lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(n),!0).forEach((function(t){st(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function st(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ut(e){return function(e){if(Array.isArray(e))return ft(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||pt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(e,t){if(e){if("string"==typeof e)return ft(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ft(e,t):void 0}}function ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var dt=function(e){var t=e.type,n=e.data;return"TEXT"===t?(0,at.XA)((0,at.p5)((0,at.Rr)(n.data),n.mimeType)):(0,at.fA)(n.mimeType,n.href,n.method,(0,at.Rr)(n.requestBodyData))},mt=function(e,t,n){if(e&&t){var r=(0,it.mG)(e,(i=(a={layerName:t.layerName,ROI:t.ROI,roiCRS:t.roiCRS,dataFilter:t.dataFilter,targetCRS:t.targetCRS}).layerName,l=a.ROI,c=a.roiCRS,s=a.dataFilter,u=a.targetCRS,(0,it.Uh)("gs:DownloadEstimator",[(0,at.qP)("layerName",(0,at.XA)((0,at.gN)(i)))].concat(ut(l?[(0,at.qP)("ROI",dt(l))]:[]),ut(c?[(0,at.qP)("RoiCRS",(0,at.XA)((0,at.gN)(c)))]:[]),ut(s?[(0,at.qP)("filter",dt(s))]:[]),ut(u?[(0,at.qP)("targetCRS",(0,at.XA)((0,at.gN)(u)))]:[])))),{outputsExtractor:(0,it.dr)(it.ai)}),o=(0,it.mG)(e,function(e){var t=e.layerName,n=e.dataFilter,r=e.outputFormat,o=e.targetCRS,a=e.roiCRS,i=e.ROI,l=e.cropToROI,c=e.asynchronous,s=e.outputAsReference,u=e.resultOutput,p=e.writeParameters;return(0,it.Uh)("gs:Download",[(0,at.qP)("layerName",(0,at.XA)((0,at.gN)(t))),(0,at.qP)("outputFormat",(0,at.XA)((0,at.gN)(r)))].concat(ut(i?[(0,at.qP)("ROI",dt(i))]:[]),ut(n?[(0,at.qP)("filter",dt(n))]:[]),ut(o?[(0,at.qP)("targetCRS",(0,at.XA)((0,at.gN)(o)))]:[]),ut(a?[(0,at.qP)("RoiCRS",(0,at.XA)((0,at.gN)(a)))]:[]),[(0,at.qP)("cropToROI",(0,at.XA)((0,at.gN)(l?"true":"false")))],ut(p&&(0,H.keys)(p).length>0?[(0,at.XJ)((0,H.toPairs)(p).map((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n}}(t,n)||pt(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],a=r[1];return(0,at.Dx)(o,a)})).join(""))]:[])),(0,at.DK)(c?(0,at.Tr)(!0,!0,s?(0,at.t$)(u,!0,"result"):(0,at.En)("result",u)):(0,at.En)("result",u)))}(ct(ct({},(0,H.omit)(t,"notifyDownloadEstimatorSuccess")),{},{outputAsReference:!!t.asynchronous&&t.outputAsReference})),n,{headers:{"Content-Type":"application/xml",Accept:"application/xml, ".concat(t.resultOutput||"application/zip")}});return r.catch((function(){throw new Error("DownloadEstimatorException")})).mergeMap((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length>0&&"result"===e[0].identifier&&"true"===e[0].data)return t.notifyDownloadEstimatorSuccess?We.Observable.of("DownloadEstimatorSuccess").concat(o):o;throw new Error("DownloadEstimatorFailed")}))}var a,i,l,c,s,u;return We.Observable.empty()},yt=n(37275),bt=n(47805),vt=[{outputFormat:"shape-zip",extension:"zip"},{outputFormat:"csv",extension:"csv"},{outputFormat:"excel",extension:"xls"},{outputFormat:"excel2007",extension:"xlsx"},{outputFormat:"dxf",extension:"dxf"},{outputFormat:"dxf-zip",extension:"zip"},{outputFormat:"application/vnd.google-earth.kml+xml",extension:"kml"},{outputFormat:"application/json",extension:"json"},{outputFormat:"gml3",extension:"gml"},{outputFormat:"GML2",extension:"gml"},{outputFormat:"application/vnd.googlxml",extension:"kml"},{outputFormat:"OGR-CSV",extension:"csv"},{outputFormat:"OGR-FileGDB",extension:"gdb"},{outputFormat:"OGR-GPKG",extension:"gpkg"},{outputFormat:"OGR-KML",extension:"kml"},{outputFormat:"OGR-MIF",extension:"mif"},{outputFormat:"OGR-TAB",extension:"tab"},{outputFormat:"SHAPE-ZIP",extension:"zip"},{outputFormat:"gml32",extension:"gml"},{outputFormat:"application/x-gpk",extension:"gpk"}],gt=n(86267),ht=n(10284);function Ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ot(Object(n),!0).forEach((function(t){Et(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function St(e){return function(e){if(Array.isArray(e))return Rt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Pt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(e,t){if(e){if("string"==typeof e)return Rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rt(e,t):void 0}}function Rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var At={gml3:"GML3.1",GML2:"GML2","DXF-ZIP":"DXF-ZIP","application/vnd.google-earth.kml+xml":"KML","OGR-CSV":"OGR-CSV","OGR-FileGDB":"OGR-GeoDatabase","OGR-GPKG":"OGR-GeoPackage","OGR-KML":"OGR-KML","OGR-MIF":"OGR-MIF","OGR-TAB":"OGR-TAB","SHAPE-ZIP":"Shapefile",gml32:"GML3.2","application/json":"GeoJSON",csv:"CSV","application/x-gpkg":"GeoPackage",excel:"excel",excel2007:"excel2007"},xt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=e.filterObj,r=void 0===n?{}:n,o=e.downloadOptions,a=void 0===o?{}:o,i=(0,bt.toOGCFilter)(r.featureTypeName,r,r.ogcVersion,r.sortOptions,!1,null,null,a.selectedSrs);return Be().Observable.defer((function(){return Ue().post((0,yt.$F)(t+"?service=WFS&outputFormat=".concat(a.selectedFormat)),i,{timeout:6e4,responseType:"arraybuffer",headers:{"Content-Type":"application/xml"}})}))},Dt=function(e){var t,n=(0,H.get)(e,"filterObj.featureTypeName"),r=(t=(0,H.get)(e,"downloadOptions.selectedFormat"),(0,H.head)(vt.filter((function(e){return e.outputFormat===t})))||function(e){var t=e.split(/[^\w]/)[1];return t?{outputFormat:e,extension:t.toLowerCase()}:void 0}(t));return r&&r.extension?n+"."+r.extension:n},jt=function(e){return e.query&&e.query.featureTypes&&e.query.featureTypes[e.query.typeName]&&e.query.featureTypes[e.query.typeName].attributes&&e.query.featureTypes[e.query.typeName].attributes[0]&&e.query.featureTypes[e.query.typeName].attributes[0].attribute||null},Tt=function(e){switch(e.code){case"ProcessFailed":return{msgId:"layerdownload.wpsExecuteError.processFailed",msgParams:{exceptionReport:e.message}};case"NoStatusLocation":case"NoExecutionId":case"UnexpectedProcessStatus":return{msgId:"layerdownload.wpsExecuteError.badResponse",msgParams:{eCode:e.code}};case"ExecuteProcessXHRFailed":return{msgId:"layerdownload.wpsExecuteError.executeProcessXhrFailed"};case"GetExecutionStatusXHRFailed":return{msgId:"layerdonwload.wpsExecuteError.getExecutionStatusXhrFailed"};default:return{msgId:"layerdownload.wpsExecuteError.unexpectedError"}}},Nt=function(e){var t=(0,nt.np)(e);if(null!=t&&t.id){var n=document.cookie.split(";").filter((function(e){return e.indexOf("exportDataResults_".concat(t.id,"="))>-1}))[0];if(n){var r=JSON.parse(decodeURIComponent(n.split("=")[1])).results;return Be().Observable.of(T(r.filter((function(e){return"pending"!==e.status}))))}}return Be().Observable.empty()},It=function(e){return e.ofType(i).switchMap((function(e){var t=e.url;return(0,ot.l)(t,"gs:DownloadEstimator,gs:Download").switchMap((function(e){return Be().Observable.defer((function(){return new Promise((function(t,n){return(0,Ze.parseString)(e.data,{tagNameProcessors:[qe.stripPrefix]},(function(e,r){return e?n(e):t(r)}))}))}))})).flatMap((function(e){var t,n,r,o,a,i,l,c,s=[null==e||null===(t=e.ProcessDescriptions)||void 0===t||null===(n=t.ProcessDescription)||void 0===n||null===(r=n[0])||void 0===r||null===(o=r.Identifier)||void 0===o?void 0:o[0],null==e||null===(a=e.ProcessDescriptions)||void 0===a||null===(i=a.ProcessDescription)||void 0===i||null===(l=i[1])||void 0===l||null===(c=l.Identifier)||void 0===c?void 0:c[0]];return Be().Observable.of(j((0,H.findIndex)(s,(function(e){return"gs:DownloadEstimator"===e}))>-1&&(0,H.findIndex)(s,(function(e){return"gs:Download"===e}))>-1?"wps":"wfs"),A(!1))})).catch((function(){return Be().Observable.of(j("wfs"),A(!1))})).startWith(A(!0))}))},Ft=function(e){return e.ofType(ze.HN).switchMap((function(e){var t;return Be().Observable.from([(0,C.Xi)("layerdownload"),x("singlePage",!1)].concat(St(null!==(t=e.layer.search)&&void 0!==t&&t.url?[(0,Qe.rP)(e.layer.url,{featureTypeName:e.layer.name})]:[])))}))},Lt=function(e){return e.ofType(f).switchMap((function(e){return(0,rt.ED)(e).map((function(e){return t=function(e){var t=(0,H.get)(e,"WFS_Capabilities.OperationsMetadata.Operation"),n=(0,H.find)(t,(function(e){return"GetFeature"===e.name})),r=(0,H.get)(n,"Parameter"),o=(0,H.find)(r,(function(e){return"outputFormat"===e.name})).Value,a=(0,H.pick)(At,o);return(0,H.toPairs)(a).map((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n}}(t,n)||Pt(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{name:r[0],label:r[1]}}))}(e),{type:d,wfsFormats:t};var t}))}))},_t=function(e,t){return e.ofType(c).switchMap((function(n){var r,o,a,i,l=t.getState(),c=l.featuregrid.virtualScroll,s=void 0!==c&&c,u=U(l),p=(0,M.Iz)(l),f=(0,tt.pQ)(l),d=(0,Y.Pz)(l);return"wps"===u?(r=n.downloadOptions.cropDataSet&&!!f&&!!f.bounds,o={layerName:p.name,outputFormat:n.downloadOptions.selectedFormat,asynchronous:!0,outputAsReference:!0,targetCRS:n.downloadOptions.selectedSrs&&"native"!==n.downloadOptions.selectedSrs?n.downloadOptions.selectedSrs:void 0,cropToROI:r,dataFilter:n.downloadOptions.downloadFilteredDataSet?{type:"TEXT",data:{mimeType:"text/plain; subtype=filter/1.0",data:(0,bt.mergeFiltersToOGC)({ogcVersion:"1.0.0",addXmlnsToRoot:!0,xmlnsToAdd:['xmlns:ogc="http://www.opengis.net/ogc"','xmlns:gml="http://www.opengis.net/gml"']},p.layerFilter,n.filterObj)}}:void 0,ROI:r?{type:"TEXT",data:{mimeType:"application/json",data:JSON.stringify((0,gt.bboxToFeatureGeometry)(f.bounds))}}:void 0,roiCRS:r?f.crs||"EPSG:4326":void 0,writeParameters:wt(wt(wt({},n.downloadOptions.tileWidth?{tilewidth:n.downloadOptions.tileWidth}:{}),n.downloadOptions.tileHeight?{tileheight:n.downloadOptions.tileHeight}:{}),n.downloadOptions.compression?wt({compression:n.downloadOptions.compression},n.downloadOptions.quality?{quality:n.downloadOptions.quality}:{}):{}),notifyDownloadEstimatorSuccess:!0},a={id:Xe()(),layerName:p.name,layerTitle:p.title,status:"pending"},i={outputsExtractor:(0,it.dr)(it.RW)},mt(n.url,o,i).takeUntil(e.ofType(g).filter((function(e){return e.id===a.id})).take(1)).flatMap((function(e){var t,n;return"DownloadEstimatorSuccess"===e?Be().Observable.of((n=wt(wt({},a),{},{startTime:(new Date).getTime()}),{type:b,result:n}),F("layerdownload.exportResultsMessages.newExport"),D(),(0,C.Xi)("layerdownload","enabled")):(t=Be().Observable).of.apply(t,St(e&&e.length>0&&e[0].href?[N(a.id,{status:"completed",result:e[0].href}),F("layerdownload.exportResultsMessages.exportSuccess",{layerTitle:(0,Ne.getLayerTitle)(p,d)},"success")]:[N(a.id,{status:"failed",result:{msgId:"layerdonwload.exportResultsMessages.invalidHref"}}),F("layerdownload.exportResultsMessages.exportFailure",{layerTitle:(0,Ne.getLayerTitle)(p,d)},"danger")]))})).catch((function(e){var t;return(t=Be().Observable).of.apply(t,St(e.message&&e.message.indexOf("DownloadEstimator")>-1?[(0,Ke.vU)({error:e,title:"layerdownload.error.downloadEstimatorTitle",message:"layerdownload.error.downloadEstimatorFailed"}),D()]:[N(a.id,{status:"failed",result:Tt(e)}),F("layerdownload.exportResultsMessages.exportFailure",{layerTitle:(0,Ne.getLayerTitle)(p,d)},"danger")]))}))):xt({url:n.url,downloadOptions:n.downloadOptions,filterObj:wt(wt({},n.filterObj),{},{pagination:!s&&(0,H.get)(n,"downloadOptions.singlePage")?n.filterObj&&n.filterObj.pagination:null})}).do((function(e){var t=e.data;if("application/xml"===e.headers["content-type"]){var n=String.fromCharCode.apply(null,new Uint8Array(t));if(0===n.indexOf("<ows:ExceptionReport"))throw n}})).catch((function(){return xt({url:n.url,downloadOptions:n.downloadOptions,filterObj:wt(wt({},n.filterObj),{},{pagination:!s&&(0,H.get)(n,"downloadOptions.singlePage")?n.filterObj&&n.filterObj.pagination:null,sortOptions:(e=jt(t.getState()),e?{sortBy:e,sortOrder:"A"}:{})})}).do((function(e){var t=e.data,r=e.headers;if("application/xml"===r["content-type"]){var o=String.fromCharCode.apply(null,new Uint8Array(t));if(0===o.indexOf("<ows:ExceptionReport"))throw o}(0,Ye.saveAs)(new Blob([t],{type:r&&r["content-type"]}),Dt(n))}));var e})).do((function(e){var t=e.data,r=e.headers;(0,Ye.saveAs)(new Blob([t],{type:r&&r["content-type"]}),Dt(n))})).map((function(){return D()})).catch((function(e){return Be().Observable.of((0,Ke.vU)({error:e,title:"layerdownload.error.title",message:"layerdownload.error.invalidOutputFormat",autoDismiss:5,position:"tr"}),D())}))}))},Ct=function(e,t){return e.ofType(C.kM).filter((function(e){return"queryPanel"===e.control&&!(0,et._d)(t.getState())&&(0,et.lI)(t.getState())})).switchMap((function(){return Be().Observable.of((0,C.Xi)("layerdownload"))}))},kt=function(e){return e.ofType(S).concatMap((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Be().Observable.of(_(e.msgId,e.msgParams,e.level),L(!0)).delay(10).concat(Be().Observable.of(L(!1)).delay(e.duration||3e3)).concat(Be().Observable.empty().delay(1e3))}))},Mt=function(e,t){return e.ofType(O).exhaustMap((function(){var e=t.getState(),n=(B(e)||[]).filter((function(e){return"completed"===e.status}));return n.length>0?Be().Observable.forkJoin(n.map((function(e){var t=e.result,n=t.indexOf("executionId="),r=t.slice(n),o=r.indexOf("&"),a=(o>-1?r.slice(0,o):r).slice(12),i=t.indexOf("?"),l=t.slice(0,i);return(0,it.W5)(l,a).let(ht.oB).catch((function(){return Be().Observable.of(null)})).map((function(t){return t?null:e.id}))}))).flatMap((function(e){return Be().Observable.of((t=e.filter((function(e){return!!e})),{type:h,ids:t}),{type:E},I(!1));var t})).startWith(I(!0)):Be().Observable.empty()}))},Gt=function(e,t){return e.ofType(b,g,v,E).filter((function(){return(0,nt.jl)(t.getState())})).do((function(){var e=t.getState(),n=B(e),r=(0,nt.np)(e).id,o=JSON.stringify({results:n});document.cookie="exportDataResults_".concat(r,"=").concat(encodeURIComponent(o))})).flatMap((function(){return Be().Observable.empty()}))},Ut=function(e){return e.ofType(Je.ok).switchMap((function(){return e.ofType($e.Nv).switchMap((function(){return Be().Observable.of(T([]))})).takeUntil(e.ofType(He.nk))}))},Wt=function(e,t){return e.ofType(Je.ok).switchMap((function(){return Nt(t.getState()).concat(e.ofType($e.XP).switchMap((function(){return Nt(t.getState())})).takeUntil(e.ofType(He.nk)))}))};function Bt(e){return function(e){if(Array.isArray(e))return Yt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(n),!0).forEach((function(t){Vt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Xt=(0,n(22843).rx)("LayerDownload",{component:(0,o.connect)((0,a.zB)({url:G.Bu,filterObj:W,enabled:function(e){var t,n;return null==e||null===(t=e.controls)||void 0===t||null===(n=t.layerdownload)||void 0===n?void 0:n.enabled},downloadOptions:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.downloadOptions},loading:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.loading},wfsFormats:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.wfsFormats},formatsLoading:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.formatsLoading},layer:M.Iz,service:U,checkingWPSAvailability:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.checkingWPSAvailability},virtualScroll:function(e){return e&&e.featuregrid&&e.featuregrid.virtualScroll}}),{onExport:function(e,t,n){return{type:c,url:e,filterObj:t,downloadOptions:n}},onDownloadOptionChange:x,onClearDownloadOptions:function(){return{type:p}},onFormatOptionsFetch:function(e){return{type:f,layer:e}},onCheckWPSAvailability:function(e){return{type:i,url:e}},onMount:function(){return(0,C.Xg)("layerdownload","available",!0)},onUnmount:function(){return(0,C.Xg)("layerdownload","available",!1)},onClose:function(){return(0,C.Xi)("layerdownload")}})(De),containers:{TOC:{doNotHide:!0,name:"LayerDownload"},MapFooter:{name:"LayerDownload",position:1,tool:(0,o.connect)((0,a.zB)({active:function(e){var t,n;return null==e||null===(t=e.controls)||void 0===t||null===(n=t.exportDataResults)||void 0===n?void 0:n.enabled},showInfoBubble:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.showInfoBubble},infoBubbleMessage:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.infoBubbleMessage},checkingExportDataEntries:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.checkingExportDataEntries},results:B,currentLocale:Y.Pz}),{onToggle:C.Xi.bind(null,"exportDataResults","enabled"),onActive:function(){return{type:O}},onRemoveResult:function(e){return{type:g,id:e}}})((function(e){var t=e.active,n=void 0!==t&&t,r=e.showInfoBubble,o=void 0!==r&&r,a=e.infoBubbleMessage,i=void 0===a?{}:a,l=e.checkingExportDataEntries,c=e.results,s=void 0===c?[]:c,u=e.currentLocale,p=e.onToggle,f=void 0===p?function(){}:p,d=e.onActive,m=void 0===d?function(){}:d,y=e.onRemoveResult;return q().useEffect((function(){n&&m()}),[n]),q().createElement(q().Fragment,null,s.length>0?q().createElement("div",{id:"mapstore-export-data-results-button-container"},q().createElement(Te.Z,{placement:"left",overlay:q().createElement(K.Tooltip,{id:"mapstore-export-data-results-tooltip"},q().createElement(ne.Z,{msgId:"exportDataResults.title"}))},q().createElement(K.Button,{bsStyle:"primary",bsSize:"small",onClick:function(){return f()}},q().createElement(K.Glyphicon,{glyph:"download"}))),q().createElement(ke,{show:o,className:"mapstore-export"},q().createElement(Me,i))):null,q().createElement(te.Z,{id:"mapstore-export-data-results",style:{display:n?"block":"none"},draggable:!1,modal:!0},q().createElement("span",{role:"header"},q().createElement("span",{className:"about-panel-title"},q().createElement(ne.Z,{msgId:"exportDataResults.title"})),q().createElement("button",{onClick:function(){return f()},className:"settings-panel-close close"},q().createElement(K.Glyphicon,{glyph:"1-close"}))),q().createElement("div",{role:"body"},q().createElement(Fe,{loading:l,results:s,currentLocale:u,onRemoveResult:y}))))}))}},epics:r,reducers:{layerdownload:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{downloadOptions:{singlePage:!0}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c:return qt(qt({},e),{},{loading:!0});case u:return qt(qt({},e),{},{downloadOptions:qt(qt({},e.downloadOptions),{},Vt({},t.key,t.value))});case p:return qt(qt({},e),{},{downloadOptions:{singlePage:!0}});case f:return qt(qt({},e),{},{layer:t.layer,wfsFormats:[],formatsLoading:!0});case s:return qt(qt({},e),{},{loading:!1});case d:return qt(qt({},e),{},{wfsFormats:t.wfsFormats,formatsLoading:!1});case m:return qt(qt({},e),{},{service:t.service});case l:return qt(qt({},e),{},{checkingWPSAvailability:t.checking});case y:return qt(qt({},e),{},{results:t.results});case b:return qt(qt({},e),{},{results:[].concat(Bt(e.results||[]),[t.result])});case v:var n=(0,H.findIndex)(e.results||[],{id:t.id});return qt(qt({},e),{},{results:n>-1?[].concat(Bt(e.results.slice(0,n)),[qt(qt({},e.results[n]),t.newProps||{})],Bt(e.results.slice(n+1))):e.results});case g:return qt(qt({},e),{},{results:(e.results||[]).filter((function(e){return e.id!==t.id}))});case h:return qt(qt({},e),{},{results:(e.results||[]).filter((function(e){return-1===(0,H.findIndex)(t.ids,(function(t){return t===e.id}))}))});case P:return qt(qt({},e),{},{showInfoBubble:t.show});case R:return qt(qt({},e),{},{infoBubbleMessage:{msgId:t.msgId,msgParams:t.msgParams,level:t.level}});case w:return qt(qt({},e),{},{checkingExportDataEntries:t.checking});default:return e}}}})},7147:(e,t,n)=>{"use strict";n.d(t,{Yq:()=>o,Iz:()=>a,QF:()=>i,_d:()=>l,pn:()=>c,lI:()=>s,PJ:()=>u,dH:()=>p,Gd:()=>f,tL:()=>d,R4:()=>m,BP:()=>y});var r=n(86494),o=function(e){return function(e,t){return function(t){return(0,r.get)(t,"controls[".concat(e,"][").concat("enabled","]"))}}(e)},a=function(e){return(0,r.get)(e,"controls.measure.showCoordinateEditor")},i=function(e){return(0,r.get)(e,"controls.measure.enabled")},l=function(e){return(0,r.get)(e,"controls.queryPanel.enabled")},c=function(e){return!!(0,r.get)(e,"controls.layerdownload.available")},s=function(e){return!!(0,r.get)(e,"controls.layerdownload.enabled")},u=function(e){return(0,r.get)(e,"controls.widgetBuilder.available",!1)},p=function(e){return(0,r.get)(e,"controls.widgetBuilder.enabled")},f=function(e){return(0,r.get)(e,"controls.layersettings.initialSettings")||{}},d=function(e){return(0,r.get)(e,"controls.layersettings.originalSettings")||{}},m=function(e){return(0,r.get)(e,"controls.layersettings.activeTab")||"general"},y=function(e){return(0,r.get)(e,"controls.drawer.enabled",!1)}},10284:(e,t,n)=>{"use strict";n.d(t,{sw:()=>b,oB:()=>v});var r=n(49977),o=n.n(r),a=n(86494),i=n(5055),l=n(7526);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){var t="function"==typeof Map?new Map:void 0;return(u=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return p(e,arguments,m(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),d(r,e)})(e)}function p(e,t,n){return(p=f()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&d(o,n.prototype),o}).apply(null,arguments)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n(24384);var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(o,e);var t,n,r=(t=o,n=f(),function(){var e,r=m(t);if(n){var o=m(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return s(this,e)});function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e)).name="OGCError",n.code=t,n}return o}(u(Error)),b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{tagNameProcessors:[l.stripPrefix],explicitArray:!1,mergeAttrs:!0};return o().Observable.bindNodeCallback((function(e,n){return(0,i.parseString)(e,t,n)}))(e)},v=function(e){return e.switchMap((function(e){return"string"==typeof e.data&&e.data.indexOf("ExceptionReport")>0?o().Observable.bindNodeCallback((function(e,t){return(0,i.parseString)(e,{tagNameProcessors:[l.stripPrefix],explicitArray:!1,mergeAttrs:!0},t)}))(e.data).map((function(e){var t=(0,a.get)(e,"ExceptionReport.Exception.ExceptionText");throw new y(t||"Undefined OGC Service Error",(0,a.get)(e,"ExceptionReport.Exception.exceptionCode"))})):o().Observable.of(e)}))}},39156:(e,t,n)=>{function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=n(2245),l=n(86494).castArray,c=n(78889).wfsToGmlVersion,s=function(e){return'service="WFS" version="'+e+'" '+("1.0.0"===e?'outputFormat="GML2" ':"")+'xmlns:gml="http://www.opengis.net/gml" xmlns:wfs="http://www.opengis.net/wfs" xmlns:ogc="http://www.opengis.net/ogc" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/wfs '+"http://schemas.opengis.net/wfs/".concat(e,"1.0.0"===e?'/WFS-basic.xsd"':'/wfs.xsd"')},u=function(e){return'service="WFS" version="'+e+'" xmlns:wfs="http://www.opengis.net/wfs/2.0" xmlns:fes="http://www.opengis.net/fes/2.0" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd http://www.opengis.net/gml/3.2 http://schemas.opengis.net/gml/3.2.1/gml.xsd"'};e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.wfsVersion,n=void 0===t?"1.1.0":t,r=e.gmlVersion,a=e.filterNS,p=e.wfsNS,f=void 0===p?"wfs":p,d=r;!d&&n?d=c(n):d||(d="3.1.1");var m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.viewParams,r=e.resultType,o=e.outputFormat,a=e.startIndex,i=e.maxFeatures,l=function(e){return 0===n.indexOf("2.")?'count="'.concat(e,'"'):'maxFeatures="'.concat(e,'"')};return(0===n.indexOf("1.")?s(n):u(n))+(r?' resultType="'.concat(r,'"'):"")+(o?' outputFormat="'.concat(o,'"'):"")+(a||0===a?' startIndex="'.concat(a,'"'):"")+(i||0===i?" ".concat(l(i)):"")+(t?' viewParams="'.concat(t,'"'):"")},y=function(e){return l(e).map((function(e){return"<".concat("2.0"===n?"fes":"ogc",":PropertyName>").concat(e,"</").concat("2.0"===n?"fes":"ogc",":PropertyName>")})).join("")};return o(o({propertyName:y},i({gmlVersion:d,wfsVersion:n,filterNS:a||"2.0"===n?"fes":"ogc"})),{},{getFeature:function(e,t){return"<".concat(f,":GetFeature ").concat(m(t),">").concat(Array.isArray(e)?e.join(""):e,"</").concat(f,":GetFeature>")},sortBy:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ASC";return"<".concat(f,":SortBy><").concat(f,":SortProperty>").concat(y(e),"<").concat(f,":SortOrder>").concat(t,"</").concat(f,":SortOrder></").concat(f,":SortProperty></").concat(f,":SortBy>")},query:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.srsName,a=void 0===o?"EPSG:4326":o;return"<".concat(f,":Query ").concat("2.0"===n?"typeNames":"typeName",'="').concat(e,'" srsName="').concat(a,'">')+"".concat(Array.isArray(t)?t.join(""):t)+"</".concat(f,":Query>")}})}},78598:function(e,t,n){var r,o=o||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,a=/constructor/i.test(e.HTMLElement)||e.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent),l=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},c=function(e){setTimeout((function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()}),4e4)},s=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},u=function(t,u,p){p||(t=s(t));var f,d=this,m="application/octet-stream"===t.type,y=function(){!function(e,t,n){for(var r=(t=[].concat(t)).length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,e)}catch(e){l(e)}}}(d,"writestart progress write writeend".split(" "))};if(d.readyState=d.INIT,o)return f=n().createObjectURL(t),void setTimeout((function(){var e,t;r.href=f,r.download=u,e=r,t=new MouseEvent("click"),e.dispatchEvent(t),y(),c(f),d.readyState=d.DONE}));!function(){if((i||m&&a)&&e.FileReader){var r=new FileReader;return r.onloadend=function(){var t=i?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,d.readyState=d.DONE,y()},r.readAsDataURL(t),void(d.readyState=d.INIT)}f||(f=n().createObjectURL(t)),m?e.location.href=f:e.open(f,"_blank")||(e.location.href=f),d.readyState=d.DONE,y(),c(f)}()},p=u.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=s(e)),navigator.msSaveOrOpenBlob(e,t)}:(p.abort=function(){},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,function(e,t,n){return new u(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);e.exports?e.exports.saveAs=o:null!==n.amdD&&null!==n.amdO&&(void 0===(r=function(){return o}.call(t,n,t,e))||(e.exports=r))}}]);