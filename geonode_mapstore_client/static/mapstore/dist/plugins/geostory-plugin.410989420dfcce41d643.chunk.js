(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[2933,2259,6287,5378,6712,6113,6755],{67007:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>k});var r=n(72500),o=n.n(r),i=n(1469),a=n.n(i),c=n(84596),l=n.n(c),u=n(27361),s=n.n(u),p=n(27418),d=n.n(p),f=n(5055),m=n.n(f),y=n(75875),g=n.n(y),v=n(37275),b=n(86267);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E={},S=function(e){var t=(a()(e)&&e||e.split(","))[0],n=o().parse(t,!0);return o().format(d()({},n,{search:null},{query:d()({service:"WMS",version:"1.3.0",request:"GetCapabilities"},n.query)}))},P=function(e){var t=e&&e.Title,n=e.LogoURL&&O(O({},s()(e,"LogoURL.$")||{}),{},{format:s()(e,"LogoURL.Format")}),r=s()(e,'OnlineResource.$["xlink:href"]');return{title:t,logo:n,imageUrl:s()(e,'LogoURL.OnlineResource.$["xlink:href"]'),link:r}},j=function e(t){return t.Layer?(a()(t.Layer)&&t.Layer||[t.Layer]).reduce((function(t,n){return t.concat(e(n)).concat(n.Layer&&n.Name?[n]:[])}),[]):t.Name&&[t]||[]},T=function(e){return e.Request&&e.Request.GetMap&&e.Request.GetMap.DCPType&&e.Request.GetMap.DCPType.HTTP&&e.Request.GetMap.DCPType.HTTP.Get&&e.Request.GetMap.DCPType.HTTP.Get.OnlineResource&&e.Request.GetMap.DCPType.HTTP.Get.OnlineResource.$||void 0},C=function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,l=(r.WMS_Capabilities||r.WMT_MS_Capabilities||{}).Capability,u=(r.WMS_Capabilities||r.WMT_MS_Capabilities||{}).Service,s=T(l),p=l.Layer&&(null===(e=l.Layer.SRS||l.Layer.CRS)||void 0===e?void 0:e.map((function(e){return e.toUpperCase()})))||[],f=l.Layer&&l.Layer.Attribution&&P(l.Layer.Attribution),m=l.Request&&l.Request.GetMap&&l.Request.GetMap.Format||[],y=j(l),g=a()(y)?y:[y],v=g.filter((function(e){return!c||-1!==e.Name.toLowerCase().indexOf(c.toLowerCase())||e.Title&&-1!==e.Title.toLowerCase().indexOf(c.toLowerCase())||e.Abstract&&-1!==e.Abstract.toLowerCase().indexOf(c.toLowerCase())}));return{numberOfRecordsMatched:v.length,numberOfRecordsReturned:Math.min(i,v.length),nextRecord:o+Math.min(i,v.length)+1,service:u,layerOptions:{version:(null===(t=r.WMS_Capabilities||r.WMT_MS_Capabilities)||void 0===t||null===(n=t.$)||void 0===n?void 0:n.version)||"1.3.0"},records:v.filter((function(e,t){return t>=o-1&&t<o-1+i})).map((function(e){return d()({},e,{formats:m,onlineResource:s,SRS:p,credits:e.Attribution?P(e.Attribution):f})}))}},I=function(e,t,n,r){var o=E[e];return o&&(new Date).getTime()<o.timestamp+1e3*((0,v.u8)("cacheExpire")||60)?new Promise((function(e){e(C(o.data,t,n,r))})):g().get(S(e)).then((function(o){var i;return m().parseString(o.data,{explicitArray:!1},(function(e,t){i=t})),E[e]={timestamp:(new Date).getTime(),data:i},C(i,t,n,r)}))};const k={flatLayers:j,parseUrl:S,getDimensions:function(e){return l()(e.Dimension||e.dimension||[]).map((function(t,n){var r=e.Extent&&l()(e.Extent)[n]||e.extent&&l()(e.extent)[n];return{name:t.$.name,units:t.$.units,unitSymbol:t.$.unitSymbol,default:t.$.default||r&&r.$.default,values:t._&&t.split(",")||r&&r._&&r.split(",")}}))},getCapabilities:function(e,t){var r=o().parse(e,!0),i=o().format(d()({},r,{query:d()({service:"WMS",version:"1.1.1",request:"GetCapabilities"},r.query)}));return new Promise((function(e){Promise.all([n.e(9942),n.e(7260)]).then(function(){var r=n(67260).unmarshaller;e(g().get(S(i)).then((function(e){var n;if(t)return m().parseString(e.data,{explicitArray:!1},(function(e,t){n=t})),n;var o=r.unmarshalString(e.data);return o&&o.value})))}.bind(null,n)).catch(n.oe)}))},describeLayer:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o().parse(e,!0),a=o().format(d()({},i,{query:d()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},i.query,r.query||{})}));return new Promise((function(e){Promise.all([n.e(9942),n.e(7260)]).then(function(){var t=n(67260).unmarshaller;e(g().get(S(a)).then((function(e){var n=t.unmarshalString(e.data);return n&&n.value&&n.value.layerDescription&&n.value.layerDescription[0]})))}.bind(null,n)).catch(n.oe)}))},getRecords:I,describeLayers:function(e,t){var n=o().parse(e,!0),r=o().format(d()({},n,{query:d()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},n.query)}));return g().get(S(r)).then((function(e){var t;return m().parseString(e.data,{explicitArray:!1},(function(e,n){t=n&&n.WMS_DescribeLayerResponse&&n.WMS_DescribeLayerResponse.LayerDescription})),(t=Array.isArray(t)?t:[t]).map((function(e){return O(O({},e&&e.$||{}),{},{layerName:e&&e.$&&e.$.name,query:O({},e&&e.query&&e.query.$||{})})}))}))},textSearch:function(e,t,n,r){return I(e,t,n,r)},parseLayerCapabilities:function e(t,n,r){return l()(r||s()(t,"capability.layer.layer")).reduce((function(r,o){return r||(!o.name&&o.layer?e(t,n,l()(o.layer)):2===n.name.split(":").length&&o.name&&2===o.name.split(":").length?n.name===o.name&&o:o.name&&2===o.name.split(":").length?n.name===o.name.split(":")[1]&&o:2===n.name.split(":").length?n.name.split(":")[1]===o.name&&o:n.name===o.name&&o)}),null)},getBBox:function(e,t){for(var n=e,r=n.EX_GeographicBoundingBox||n.exGeographicBoundingBox||(0,b.getWMSBoundingBox)(n.BoundingBox)||n.LatLonBoundingBox&&n.LatLonBoundingBox.$||n.latLonBoundingBox;!r&&n.Layer&&n.Layer.length;)r=(n=n.Layer[0]).EX_GeographicBoundingBox||n.exGeographicBoundingBox||(0,b.getWMSBoundingBox)(n.BoundingBox)||n.LatLonBoundingBox&&n.LatLonBoundingBox.$||n.latLonBoundingBox;r||(r={westBoundLongitude:-180,southBoundLatitude:-90,eastBoundLongitude:180,northBoundLatitude:90});var o={extent:[r.westBoundLongitude||r.minx,r.southBoundLatitude||r.miny,r.eastBoundLongitude||r.maxx,r.northBoundLatitude||r.maxy],crs:"EPSG:4326"};return t?{crs:o.crs,bounds:{minx:o.extent[0],miny:o.extent[1],maxx:o.extent[2],maxy:o.extent[3]}}:o},reset:function(){Object.keys(E).forEach((function(e){delete E[e]}))}}},42872:(e,t,n)=>{"use strict";n.d(t,{Z:()=>N});var r=n(24852),o=n.n(r),i=n(45697),a=n.n(i),c=n(88798),l=n(15402),u=n(5346),s=n(30294);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?g(e):t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(c,e);var t,n,r,i,a=(r=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(r);if(i){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return y(this,e)});function c(){var e;d(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return b(g(e=a.call.apply(a,[this].concat(n))),"onTouchStart",(function(t){var n=t.touches[0];e.startX=n.pageX,e.startY=n.pageY,e.setState({scrolling:!1})})),b(g(e),"onTouchMove",(function(t){var n=t.touches[0],r=t.currentTarget;if(e.state.scrolling)t.stopPropagation();else if(Math.abs(e.startY-n.pageY)>Math.abs(e.startX-n.pageX))t.stopPropagation();else{var o=e.startX<n.pageX?"left":"right";(r&&"left"===o&&r.clientWidth<r.scrollWidth&&0!==r.scrollLeft||r&&"right"===o&&r.clientWidth+r.scrollLeft!==r.scrollWidth)&&(e.setState({scrolling:!0}),t.stopPropagation())}})),b(g(e),"onTouchEnd",(function(){e.setState({scrolling:!1})})),b(g(e),"renderPage",(function(){var t="function"==typeof e.props.viewers?e.props.viewers:e.props.viewers[e.props.format];return t?o().createElement(t,{response:e.props.response,layer:e.props.layer}):null})),e}return t=c,(n=[{key:"render",value:function(){return o().createElement("div",{style:{width:"100%",height:"100%",overflowX:"auto"},onTouchMove:this.onTouchMove,onTouchStart:this.onTouchStart,onTouchEnd:this.onTouchEnd},this.renderPage())}}])&&f(t.prototype,n),c}(o().Component);b(h,"propTypes",{format:a().string,viewers:a().oneOfType([a().func,a().object]),response:a().oneOfType([a().string,a().object,a().node]),layer:a().object});var O=n(41609),w=n.n(O),E=n(31351),S=n.n(E),P=n(2870);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?M(e):t}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(p,e);var t,n,r,i,a=(r=p,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(r);if(i){var n=A(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return x(this,e)});function p(){var e;C(this,p);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return R(M(e=a.call.apply(a,[this].concat(n))),"getResponseProperties",(function(){var t=e.props.validator(e.props.format),n=e.props.responses.map((function(e){return void 0===e?{}:e})),r=t.getValidResponses(n),o=t.getNoValidResponses(e.props.responses),i=e.props.requests.length===o.length;return{validResponses:r,currResponse:e.getCurrentResponse(r[e.props.index]),emptyResponses:i,invalidResponses:o}})),R(M(e),"getCurrentResponse",(function(t){return e.props.validator(e.props.format).getValidResponses([t])})),R(M(e),"renderEmptyLayers",(function(){var t=e.getResponseProperties(),n=t.invalidResponses,r=t.emptyResponses;if(0===e.props.missingResponses&&r)return null;var i=0!==n.length;if(e.props.renderEmpty||(i=i&&0===e.props.missingResponses),i){var a=n.map((function(e){return e.layerMetadata.title}));return e.props.showEmptyMessageGFI?o().createElement(s.Alert,{bsStyle:"info"},o().createElement(u.Z,{msgId:"noInfoForLayers"}),o().createElement("b",null,a.join(", "))):null}return null})),R(M(e),"renderPage",(function(t){var n=e.props.viewers[e.props.format];return n?o().createElement(n,{response:t}):null})),R(M(e),"renderEmptyPages",(function(){var t=e.getResponseProperties().emptyResponses;return 0===e.props.missingResponses&&t?o().createElement(s.Alert,{bsStyle:"danger"},o().createElement("h4",null,o().createElement(l.Z,{msgId:"noFeatureInfo"}))):null})),R(M(e),"renderPages",(function(){var t=e.getResponseProperties().validResponses;return t.map((function(n,r){var i,a,l=n.response,u=n.layerMetadata,p=(0,P.Q)(n,e.props),d=e.props.header;return null!=u&&null!==(i=u.viewer)&&void 0!==i&&i.type&&(a=(0,c.gA)(u.viewer.type)),o().createElement(s.Panel,{eventKey:r,key:r,collapsible:e.props.collapsible,header:d?o().createElement("span",null,o().createElement(d,T({size:t.length},e.props.headerOptions,u,{index:e.props.index,onNext:function(){return e.props.onNext()},onPrevious:function(){return e.props.onPrevious()}}))):null,style:e.props.style},o().createElement(h,{response:l,format:p,viewers:a||e.props.viewers,layer:u}))}))})),R(M(e),"containerStyle",(function(t){return w()(t)&&e.props.isMobile?{height:"100%"}:{display:w()(t)?"none":"block"}})),e}return t=p,(n=[{key:"shouldComponentUpdate",value:function(e){return e.responses!==this.props.responses||e.missingResponses!==this.props.missingResponses||e.index!==this.props.index}},{key:"render",value:function(){var e=this,t=this.props.container,n=this.getResponseProperties(),r=n.currResponse,i=n.emptyResponses,a=[this.renderEmptyLayers(),o().createElement(t,T({},this.props.containerProps,{onChangeIndex:function(t){e.props.setIndex(t)},ref:"container",index:this.props.index||0,key:"swiper",style:this.containerStyle(r),className:"swipeable-view"}),this.renderPages())];return a=this.props.isMobile?a:S()(a),o().createElement("div",{className:"mapstore-identify-viewer"},i?this.renderEmptyPages():a.map((function(e){return e})))}}])&&I(t.prototype,n),p}(o().Component);R(D,"propTypes",{format:a().string,collapsible:a().bool,requests:a().array,responses:a().array,missingResponses:a().number,container:a().oneOfType([a().object,a().func]),header:a().oneOfType([a().object,a().func]),headerOptions:a().object,validator:a().func,viewers:a().object,style:a().object,containerProps:a().object,index:a().number,onNext:a().func,onPrevious:a().func,onUpdateIndex:a().func,setIndex:a().func,showEmptyMessageGFI:a().bool,renderEmpty:a().bool,loaded:a().bool,isMobile:a().bool}),R(D,"defaultProps",{format:(0,c.wR)(),responses:[],requests:[],missingResponses:0,collapsible:!1,headerOptions:{},container:s.Accordion,validator:c.Te,viewers:(0,c.Qm)(),style:{position:"relative",marginBottom:0},containerProps:{},showEmptyMessageGFI:!0,renderEmpty:!1,onNext:function(){},onPrevious:function(){},setIndex:function(){},isMobile:!1});const N=D},11196:(e,t,n)=>{"use strict";n.d(t,{mI:()=>i,Yy:()=>a});var r=n(67076),o=n(88798),i=(0,r.withHandlers)({onNext:function(e){var t=e.index,n=void 0===t?0:t,r=e.setIndex,o=void 0===r?function(){}:r,i=e.validResponses,a=void 0===i?[]:i;return function(){o(Math.min(a.length-1,n+1))}},onPrevious:function(e){var t=e.index,n=e.setIndex,r=void 0===n?function(){}:n;return function(){r(Math.max(0,t-1))}}}),a=(0,r.defaultProps)({format:(0,o.wR)(),validator:o.Te})},81593:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(24852),o=n(45338);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const d=function(e){var t=e.direction,n=void 0===t?"horizontal":t,i=e.deltaScroll,s=e.width,p=e.height,d=e.transition,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],m=(0,r.useState)(0),y=u(m,2),g=y[0],v=y[1],b=(0,r.useState)(0),h=u(b,2),O=h[0],w=h[1],E=(0,r.useRef)({x:0,y:0}),S=(0,r.useState)(!1),P=u(S,2),j=P[0],T=P[1],C=(0,r.useState)("start"),I=u(C,2),k=I[0],x=I[1],M=(0,r.useState)(),A=u(M,2),R=A[0],D=A[1],N=(0,r.useRef)(),L=(0,r.useRef)({});function _(e,t){D("move:start");var r=N.current,o=r.parentNode,i=r.getBoundingClientRect(),a=o.getBoundingClientRect();if("horizontal"===n){var c=e+i.width;e<0&&c>a.width?(v(e),E.current.x=e,x("center")):e>=0?(v(0),E.current.x=0,x("start")):c<=a.width&&(v(a.width-i.width),E.current.x=a.width-i.width,x("end"))}if("vertical"===n){var l=t+i.height;t<0&&l>a.height?(w(t),E.current.y=t,x("center")):t>=0?(w(0),E.current.y=0,x("start")):l<=a.height&&(w(a.height-i.height),E.current.y=a.height-i.height,x("end"))}setTimeout((function(){D("move:end")}),d)}function B(e){_(g+e,O+e)}function U(){var e=N.current,t=e.parentNode,r=e.getBoundingClientRect(),o=t.getBoundingClientRect();return!("horizontal"===n&&o.width>=r.width||"vertical"===n&&o.height>=r.height)}(0,r.useEffect)((function(){function e(e){e.preventDefault();var t=U();return T(U()),t?_(E.current.x-(e.deltaY>0?i:-i),E.current.y-(e.deltaY>0?i:-i)):null}var t=U();T(t);var n=N.current.parentNode;return t&&_(E.current.x,E.current.y),t&&n&&n.addEventListener&&n.addEventListener("wheel",e),function(){t&&n&&n.removeEventListener&&n.removeEventListener("wheel",e)}}),[s,p].concat(l(f)));var F=(0,o.QS)({onSwiping:function(e){e.event.stopPropagation();var t=U();return T(U()),t?_(g-e.deltaX*e.velocity,O-e.deltaY*e.velocity):null},trackTouch:!0,trackMouse:!0});function Z(e,t){L.current=a(a({},L.current),{},c({},e,t))}function W(e){var t=L.current[e];if(t){var r=N.current,o=(r&&r.parentNode).getBoundingClientRect(),i=t.getBoundingClientRect();if("horizontal"===n){var a=o.width,c=o.left,l=i.width,u=i.left,s=c+a,p=u+l;return c<=u&&s>=u||c<=p&&s>=p}}return!1}function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.margin,o=void 0===r?0:r,i=L.current[e];if(i){var a=N.current,c=a&&a.parentNode,l=c.getBoundingClientRect(),u=i.getBoundingClientRect();if("horizontal"===n){var s=l.width,p=l.left,d=u.width,f=u.left,m=p+s,y=f+d,g=p<=f&&m>=y;if(!g){var v=a.getBoundingClientRect(),b=v.left;_(-(f-b)+o,void 0)}}}}var G=j&&("end"===k||"center"===k),z=j&&("start"===k||"center"===k);return{status:R,canSwipe:j,isStartControlActive:G,isEndControlActive:z,positionLabel:k,coordinates:{x:g,y:O},containerPropsHandlers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.style,n=void 0===t?{}:t;return a(a({},F),{},{style:a({position:"relative",overflow:"hidden",width:"100%",height:"100%"},n)})},contentPropsHandlers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.style,r=void 0===t?{}:t;return{ref:N,style:a(a(a(a({position:"absolute",display:"flex"},d&&{transition:"transform ".concat(d,"ms ease 0s")}),{},{flexDirection:"horizontal"===n?"row":"column"},j&&"horizontal"===n&&{transform:"translateX(".concat(g,"px)")}),j&&"vertical"===n&&{transform:"translateY(".concat(O,"px)")}),r)}},itemPropsHandlers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.onClick;return a({key:t,ref:function(e){return e&&Z(t,e)}},n?{onClick:n,tabindex:W(t)?0:-1,onKeyDown:function(e){"Enter"===e.key&&n()}}:{tabindex:-1})},updateCoordinates:_,moveItemInViewById:H,moveToDeltaSize:B}}},71335:(e,t,n)=>{"use strict";n.d(t,{Z:()=>O});var r=n(24852),o=n.n(r),i=n(45697),a=n.n(i),c=n(5346),l=n(13718),u=n(14068);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?y(e):t}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b={FORMAT:o().createElement(c.Z,{msgId:"map.errorFormat"}),SIZE:o().createElement(c.Z,{msgId:"map.errorSize"})},h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(s,e);var t,n,r,i,a=(r=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=g(r);if(i){var n=g(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function s(){var e;p(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return v(y(e=a.call.apply(a,[this].concat(n))),"state",{}),v(y(e),"getThumbnailUrl",(function(){return e.props.map&&e.props.map.newThumbnail&&"NODATA"!==e.props.map.newThumbnail?decodeURIComponent(e.props.map.newThumbnail):null})),v(y(e),"getDataUri",(function(e,t){var n=e;if(n&&n.length>0){var r=n[0],o=new FileReader;return o.onload=function(e){return t(e.target.result,r.size)},o.readAsDataURL(r)}return t(null)})),v(y(e),"getThumbnailDataUri",(function(t){e.getDataUri(e.files,t)})),v(y(e),"generateUUID",(function(){var e=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))})),v(y(e),"processUpdateThumbnail",(function(t,n,r){var o=e.generateUUID(),i="THUMBNAIL";!e.props.map||r||!e.props.map.thumbnail||e.refs.imgThumbnail||n||e.deleteThumbnail(e.props.map.thumbnail,e.props.map.id,!0),e.props.map&&!r&&e.props.map.newThumbnail&&!e.refs.imgThumbnail&&n&&(e.deleteThumbnail(e.props.map.thumbnail,e.props.map.id,!1),e.props.onSaveAll(t,n,o,r,i,e.props.map.id)),e.props.map.newThumbnail&&r&&e.refs.imgThumbnail&&(e.deleteThumbnail(e.props.map.thumbnail,null,!1),e.props.onSaveAll(t,n,o,r,i,e.props.map.id)),e.props.map.newThumbnail&&!r&&e.refs.imgThumbnail&&e.props.onSaveAll(t,n,o,r,i,e.props.map.id),e.props.map.newThumbnail||r||e.refs.imgThumbnail||(e.props.map.thumbnail&&n&&e.deleteThumbnail(e.props.map.thumbnail,e.props.map.id,!1),e.props.onSaveAll(t,n,o,r,i,e.props.map.id))})),v(y(e),"updateThumbnail",(function(t,n){e.props.map.errors&&e.props.map.errors.length||e.getDataUri(e.files,(function(r){return e.processUpdateThumbnail(t,n,r),r}))})),v(y(e),"deleteThumbnail",(function(t,n){if(t&&-1!==t.indexOf("geostore")){var r=(0,l.C)(t);r&&e.props.onDeleteThumbnail(r,n)}})),e}return t=s,(n=[{key:"renderThumbnailErrors",value:function(){return this.props.thumbnailErrors&&this.props.thumbnailErrors.length>0?o().createElement("div",{className:"dropzone-errorBox alert-danger"},o().createElement("p",null,o().createElement(c.Z,{msgId:"map.error"})),this.props.thumbnailErrors.map((function(e){return o().createElement("div",{id:"error"+e,key:"error"+e,className:"error"+e},b[e])}))):null}},{key:"render",value:function(){var e=this;return o().createElement(u.Z,{ref:"imgThumbnail",thumbnail:this.getThumbnailUrl(),className:null,dropZoneProps:{className:"dropzone alert alert-info",rejectClassName:"alert-danger"},loading:this.props.loading,maxFileSize:this.props.maxFileSize,style:{pointerEvents:this.props.map.saving?"none":"auto"},label:this.props.withLabel&&o().createElement("label",{className:"control-label"},o().createElement(c.Z,{msgId:"map.thumbnail"})),ù:!0,message:o().createElement(o().Fragment,null,this.props.message,o().createElement("br",null),this.props.suggestion),error:this.renderThumbnailErrors(),onUpdate:function(t,n){var r;e.props.onError([],e.props.map.id),e.files=n,e.props.onUpdate(t,null==n||null===(r=n[0])||void 0===r?void 0:r.preview)},onError:function(t,n){e.props.onError(t,e.props.map.id),e.files=n,e.props.onUpdate(null,null)},onRemove:function(){e.files=null,e.props.onUpdate(null,null),e.props.onRemoveThumbnail(),e.props.onError([],e.props.map.id)}})}}])&&d(t.prototype,n),s}(o().Component);v(h,"propTypes",{glyphiconRemove:a().string,style:a().object,thumbnailErrors:a().array,loading:a().bool,withLabel:a().bool,map:a().object,maxFileSize:a().number,onDrop:a().func,onError:a().func,onUpdate:a().func,onSaveAll:a().func,onCreateThumbnail:a().func,onDeleteThumbnail:a().func,onRemoveThumbnail:a().func,message:a().oneOfType([a().string,a().element]),suggestion:a().oneOfType([a().string,a().element])}),v(h,"contextTypes",{messages:a().object}),v(h,"defaultProps",{loading:!1,withLabel:!0,glyphiconRemove:"remove-circle",maxFileSize:5e5,onDrop:function(){},onError:function(){},onUpdate:function(){},onSaveAll:function(){},onRemoveThumbnail:function(){},onCreateThumbnail:function(){},onDeleteThumbnail:function(){},message:o().createElement(c.Z,{msgId:"map.message"}),suggestion:o().createElement(c.Z,{msgId:"map.suggestion"}),map:{},thumbnailErrors:[]});const O=h},7472:(e,t,n)=>{"use strict";n.d(t,{Z:()=>j});var r=n(27418),o=n.n(r),i=n(45697),a=n.n(i),c=n(24852),l=n.n(c),u=n(85294),s=n.n(u),p=n(72986),d=n.n(p),f=n(5346);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?w(e):t}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(c,e);var t,n,r,i,a=(r=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(r);if(i){var n=E(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return O(this,e)});function c(){var e;v(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return S(w(e=a.call.apply(a,[this].concat(n))),"renderLoading",(function(){return e.props.maskLoading?l().createElement("div",{style:{width:"100%",height:"100%",position:"absolute",overflow:"visible",margin:"auto",verticalAlign:"center",left:"0",background:"rgba(255, 255, 255, 0.5)",zIndex:2}},l().createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -40%)"}},l().createElement(f.Z,{msgId:"loading"}),l().createElement(d(),{spinnerName:"circle",noFadeIn:!0,overrideSpinnerClassName:"spinner"}))):null})),S(w(e),"renderRole",(function(t){return l().Children.toArray(e.props.children).filter((function(e){return e.props.role===t}))})),S(w(e),"hasRole",(function(t){return l().Children.toArray(e.props.children).filter((function(e){return e.props.role===t})).length>0})),S(w(e),"onClickOut",(function(t){e.props.onClickOut&&e.mask===t.target&&e.props.onClickOut(t)})),e}return t=c,(n=[{key:"render",value:function(){var e=this,t=l().createElement("div",{id:this.props.id,style:g({zIndex:3},this.props.style),className:"".concat(this.props.draggable?"modal-dialog-draggable":""," ").concat(this.props.className," modal-dialog-container")},l().createElement("div",{className:this.props.headerClassName+" draggable-header"},this.renderRole("header")),l().createElement("div",{className:this.props.bodyClassName},this.renderLoading(),this.renderRole("body")),this.hasRole("footer")?l().createElement("div",{className:this.props.footerClassName},this.renderRole("footer")):l().createElement("span",null)),n=this.props.draggable?l().createElement(s(),{defaultPosition:this.props.start,bounds:this.props.bounds,handle:".draggable-header, .draggable-header *"},t):t,r=o()({},this.props.style.display?{display:this.props.style.display}:{},this.props.backgroundStyle);return this.props.modal?l().createElement("div",{ref:function(t){e.mask=t},onClick:this.onClickOut,style:r,className:"fade in modal "+this.props.containerClassName,role:"dialog"},n):n}}])&&b(t.prototype,n),c}(l().Component);S(P,"propTypes",{id:a().string.isRequired,style:a().object,backgroundStyle:a().object,className:a().string,maskLoading:a().bool,containerClassName:a().string,headerClassName:a().string,bodyClassName:a().string,footerClassName:a().string,onClickOut:a().func,modal:a().bool,start:a().object,draggable:a().bool,bounds:a().oneOfType([a().string,a().object])}),S(P,"defaultProps",{style:{},backgroundStyle:{background:"rgba(0,0,0,.5)"},start:{x:0,y:150},className:"modal-dialog modal-content",maskLoading:!1,containerClassName:"",headerClassName:"modal-header",bodyClassName:"modal-body",footerClassName:"modal-footer",modal:!1,draggable:!0,bounds:"parent"});const j=P},87320:(e,t,n)=>{"use strict";n.d(t,{Z:()=>O});var r=n(24852),o=n.n(r),i=n(45697),a=n.n(i),c=n(88798),l=n(43129),u=n(30294),s=n(52595);function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=function(e){var t,n,i=e.text,a=e.placement,c=e.bsStyle,l=e.left,d=e.top,f=e.title,m=e.glyph,y=e.id,g=(0,r.useRef)(),v=(t=(0,r.useState)(!1),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),b=v[0],h=v[1];return o().createElement("span",{className:"mapstore-info-popover",onMouseLeave:function(){return h(!1)}},o().createElement(u.Glyphicon,{onMouseEnter:function(){h(!0)},ref:function(e){g.current=e},className:"text-".concat(c),glyph:m}),o().createElement(s.Z,{placement:a,show:b,target:function(){return g.current}},o().createElement(u.Popover,{id:y,placement:a,positionLeft:l,positionTop:d,title:f},o().createElement("div",{style:{display:"flex"}},i))))};d.propTypes={id:a().string,title:a().string,text:a().string,glyph:a().string,bsStyle:a().string,placement:a().string,left:a().number,top:a().number,trigger:a().oneOfType([a().array,a().bool])},d.defaultProps={id:"",title:"",text:"",placement:"right",left:200,top:50,glyph:"question-sign",bsStyle:"info"};const f=d;var m=n(15402);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){var t=e.id,n=e.label,r=e.infoFormat,i=e.availableInfoFormat,a=e.popoverMessage,c=e.disabled,s=e.onInfoFormatChange,p=e.selectProps,d=Object.keys(i).reduce((function(e,t){return Object.keys(e).map((function(t){return e[t]})).some((function(e){return e===i[t]}))?e:v(v({},e),{},b({},t,i[t]))}),{}),g=Object.keys(d).map((function(e){return{value:d[e],label:e}})),h=o().createElement(o().Fragment,null,"   ",a&&o().createElement(f,{text:o().createElement(m.Z,{msgId:a})}),o().createElement(l.ZP,y({},p,{id:t,value:r,clearable:!1,disabled:c,options:g,onChange:function(e){return s(null==e?void 0:e.value)}})));return n?o().createElement(u.FormGroup,{bsSize:"small"},o().createElement(u.ControlLabel,null,n),h):h}h.propTypes={id:a().string,label:a().oneOfType([a().func,a().string,a().object]),availableInfoFormat:a().object,infoFormat:a().string,popoverMessage:a().string,onInfoFormatChange:a().func,disabled:a().bool,selectProps:a().object},h.defaultProps={id:"mapstore-feature-format-selector",availableInfoFormat:(0,c.eq)(),infoFormat:(0,c.wR)(),popoverMessage:"",onInfoFormatChange:function(){},selectProps:{}};const O=h},82110:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(24852),o=n.n(r),i=n(96259),a=n(32425);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const s=function(e){var t=e.width,n=e.height,r=e.className,c=void 0===r?"loader-container":r,u=e.contentStyle,s=void 0===u?{}:u;return o().createElement("div",{className:c},o().createElement(i.Z,null,(function(e){var r=e.width,i=void 0===r?200:r,c=e.height,u=void 0===c?200:c,p=t||(u>0?Math.min(i,u):i),d=n||(u>0?Math.min(i,u):i),f=Math.min(p,d);return o().createElement(a.Z,{size:f,style:l({padding:f/10,margin:"auto",display:"flex"},s)})})))}},50966:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(61365),o=n(30294);const i=(0,r.Z)(o.OverlayTrigger)},14068:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var r=n(24852),o=n.n(r),i=n(55033),a=n.n(i),c=n(32425),l=n(83139),u=n(80717);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const m=(0,r.forwardRef)((function(e,t){var n,i,f=e.className,m=void 0===f?"ms-thumbnail":f,y=e.label,g=e.loading,v=e.message,b=e.error,h=e.thumbnail,O=e.removeGlyph,w=void 0===O?"trash":O,E=e.removeTooltipId,S=void 0===E?"removeThumbnail":E,P=e.style,j=void 0===P?{}:P,T=e.maxFileSize,C=void 0===T?5e5:T,I=e.supportedImageTypes,k=void 0===I?["image/png","image/jpeg","image/jpg"]:I,x=e.thumbnailOptions,M=e.dropZoneProps,A=void 0===M?{className:"ms-thumbnail-dropzone",activeClassName:"ms-thumbnail-dropzone-active",rejectClassName:"ms-thumbnail-dropzone-reject"}:M,R=e.onUpdate,D=void 0===R?function(){}:R,N=e.onError,L=void 0===N?function(){}:N,_=e.onRemove,B=e.toolbarButtons,U=(0,r.useRef)(),F=(n=(0,r.useState)(),i=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(n,i)||d(n,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),Z=F[0],W=F[1];if((0,r.useEffect)((function(){return U.current=!0,function(){U.current=!1}}),[]),g||Z)return o().createElement("div",{className:"dropzone-thumbnail-container".concat(m?" ".concat(m):""," ms-loading")},o().createElement(c.Z,{size:70}));var H=o().createElement(u.Z,{btnDefaultProps:{className:"square-button-md no-border"},buttons:B||[{glyph:w,visible:!(!_||!h),tooltipId:S,onClick:function(e){var t;null==e||null===(t=e.stopPropagation)||void 0===t||t.call(e),null==_||_()}}]});return o().createElement("div",{className:"dropzone-thumbnail-container".concat(m?" ".concat(m):""),style:j},y,o().createElement(a(),s({},A,{multiple:!1,onDrop:function(e){var t,n=null==e||null===(t=e[0])||void 0===t?void 0:t.type,r=-1!==k.indexOf(n);W(!0),function(e,t){return new Promise((function(n){var r=e;if(null!=r&&r[0]){var o=r[0],i=new FileReader;return i.onload=function(e){return n(t?(0,l.Xq)(e.target.result,t).then((function(e){return{data:e,size:e.length}})):{data:e.target.result,size:o.size})},i.readAsDataURL(o)}return n({data:null})}))}(e,x).then((function(t){var n=t.data,o=t.size;return U.current?(W(!1),r&&n&&o<C?D(n,e):L([].concat(p(r?[]:["FORMAT"]),p(n&&o>=C?["SIZE"]:[])),e)):null})).catch((function(e){return U.current?(W(!1),L(e)):null}))}}),h?o().createElement("div",{style:{position:"relative",width:"100%",height:"100%"}},o().createElement("div",{ref:t,style:{position:"relative",width:"100%",height:"100%",backgroundImage:"url(".concat(h,")"),backgroundSize:null!=x&&x.contain?"contain":"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),o().createElement("div",{className:"dropzone-content-image-added"},v),H):o().createElement("div",{className:"dropzone-content-image"},v,H,b&&o().createElement("div",{className:"dropzone-errors"},b))))}))},61365:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(24852),o=n.n(r),i=n(37275);function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}const c=function(e){return function(t){return o().createElement(e,a({},t,{container:document.querySelector("."+(i.ZP.getConfigProp("themePrefix")||"ms2")+" > div")||document.body}))}}},12610:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(24852),o=n.n(r),i=n(67076),a=n(57557),c=n.n(a),l=n(15135);const u=(0,i.branch)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.disabled,n=e.noTooltipWhenDisabled,r=void 0!==n&&n;return!(r&&t)}),l.Z,(function(e){return function(t){return o().createElement(e,c()(t,["tooltipId","tooltip","noTooltipWhenDisabled"]),t.children)}}))},73014:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(24852),o=n.n(r),i=n(67076),a=n(82110);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var l=function(e){var t=e.loading,n=e.isLoading;return t||n&&("function"==typeof n?n():!0===n)};const u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.Z;return(0,i.branch)(e,(function(){return function(e){var r=e.loaderProps;return o().createElement(n,c({},t,r))}}))}},17252:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(24852),o=n.n(r),i=n(67076),a=n(45697),c=n.n(a),l=n(57557),u=n.n(l),s=n(30294),p=n(50966);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h=(0,i.branch)((function(e){return e.popover}),(function(e){var t,n;return n=t=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(d,t);var n,r,a,c,l=(a=d,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(a);if(c){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return g(this,e)});function d(){return f(this,d),l.apply(this,arguments)}return n=d,(r=[{key:"renderPopover",value:function(){return o().createElement(s.Popover,u()(this.props.popover,["trigger","placement","text"]),this.props.popover.text)}},{key:"renderContent",value:function(){var t=(0,i.toClass)(e);return o().createElement(t,u()(this.props,["popover"]))}},{key:"render",value:function(){var e=!0===this.props.popover.trigger?["hover","focus"]:this.props.popover.trigger;return o().createElement("span",null,o().createElement(p.Z,{trigger:e,placement:this.props.popover.placement,overlay:this.renderPopover()},this.renderContent()))}}])&&m(n.prototype,r),d}(o().Component),b(t,"propTypes",{popover:c().object}),b(t,"defaultProps",{popover:{trigger:!0}}),n}))},15135:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n(24852),o=n.n(r),i=n(67076),a=n(30294),c=n(50966),l=n(5346),u=n(57557),s=n.n(u),p=["tooltip","tooltipId","tooltipPosition","tooltipTrigger","keyProp","idDropDown","args"];function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const f=(0,i.branch)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tooltip,n=e.tooltipId;return t||n}),(function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.tooltip,r=t.tooltipId,i=t.tooltipPosition,u=void 0===i?"top":i,s=t.tooltipTrigger,f=t.keyProp,m=t.idDropDown,y=t.args,g=d(t,p);return o().createElement(c.Z,{trigger:s,id:m,key:f,placement:u,overlay:o().createElement(a.Tooltip,{id:"tooltip-"+f},r?o().createElement(l.Z,{msgId:r,msgParams:{data:y}}):n)},o().createElement(e,g))}}),(function(e){return function(t){return o().createElement(e,s()(t,["tooltipId","tooltip"]),t.children)}}))},80717:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(24852),o=n.n(r),i=n(19081),a=n.n(i),c=n(30294),l=n(90085),u=["visible","Element","renderButton"];function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.buttons,n=void 0===t?[]:t,r=e.btnGroupProps,i=void 0===r?{}:r,d=e.btnDefaultProps,f=void 0===d?{}:d,m=e.transitionProps,y=void 0===m?{transitionName:"toolbar-btn-transition",transitionEnterTimeout:300,transitionLeaveTimeout:300}:m,g=function(){return n.map((function(e,t){var n=e.visible,r=void 0===n||n,i=e.Element,a=e.renderButton,c=p(e,u);return r?a||i&&o().createElement(i,s({key:c.key||t},c))||o().createElement(l.Z,s({key:c.key||t},f,c)):null}))};return o().createElement(c.ButtonGroup,i,y?o().createElement(a(),y,g()):g())}},90085:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var r=n(24852),o=n.n(r),i=n(67076),a=n(5346),c=n(57557),l=n.n(c),u=n(30294),s=n(32425),p=n(12610),d=n(17252),f=n(38560),m=["glyph","loading","text","textId","glyphClassName","loaderProps","children"];function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function g(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const v=(0,i.compose)(p.Z,d.Z)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.glyph,n=e.loading,r=e.text,i=void 0===r?"":r,c=e.textId,p=e.glyphClassName,d=void 0===p?"":p,v=e.loaderProps,b=void 0===v?{}:v,h=e.children,O=g(e,m);return o().createElement(f.Z,l()(O,["pullRight","confirmNo","confirmYes"]),t&&!n?o().createElement(u.Glyphicon,{glyph:t,className:d}):null,c?o().createElement(a.Z,{msgId:c}):i,n?o().createElement(s.Z,y({className:"ms-loader".concat(O.bsStyle&&" ms-loader-"+O.bsStyle||"").concat(O.bsSize&&" ms-loader-"+O.bsSize||"")},b)):null,h)}))},89919:(e,t,n)=>{"use strict";n.d(t,{hP:()=>s});var r=n(84596),o=n.n(r),i=n(49977),a=n.n(i);function c(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.startWith.apply(e,c(t))},s=function(e,t,n){return function(r){return(n?u(r,o()(e)).catch(n):u(r,o()(e))).concat(a().Observable.from(o()(t)))}}},3519:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Bl});var r={};n.r(r),n.d(r,{cleanUpEmptyStoryContainers:()=>ge,closeShareOnGeostoryChangeMode:()=>we,editMediaForBackgroundEpic:()=>fe,editWebPageComponent:()=>se,handlePendingGeoStoryChanges:()=>Ee,hideCarouselItemsOnUpdateCurrentPage:()=>he,inlineEditorEditMap:()=>Oe,loadGeostoryEpic:()=>me,loadStoryOnHistoryPop:()=>je,openMediaEditorForNewMedia:()=>ce,openWebPageComponentCreator:()=>ue,reloadGeoStoryOnLoginLogout:()=>ye,saveGeoStoryResource:()=>pe,scrollOnLoad:()=>Pe,scrollSideBar:()=>Te,scrollToContentEpic:()=>de,setFocusOnMapEditing:()=>be,sortContentEpic:()=>ve,urlUpdateOnScroll:()=>Se});var o=n(24852),i=n.n(o),a=n(71703),c=n(22222),l=n(75933),u=n.n(l),s=n(22843),p=n(92579),d=n(86638),f=n(31398),m=n(34990),y=n(93848),g=n(49977),v=n(91175),b=n.n(v),h=n(7654),O=n.n(h),w=n(47037),E=n.n(w),S=n(14293),P=n.n(S),j=n(95825),T=n.n(j),C=n(58748),I=n.n(C),k=n(27361),x=n.n(k),M=n(1469),A=n.n(M),R=n(41609),D=n.n(R),N=n(75982),L=n(23570),_=n.n(L),B=n(75875),U=n.n(B),F=n(91312),Z=n(82904),W=n(97395),H=n(63516),G=n(74621),z=n(66113),V=n(7501),q=n(89919),K=n(27693),$=n(82385),X=["status","statusText","data","message"],Y=["data","isStatic"];function Q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||oe(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){te(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function re(e){return function(e){if(Array.isArray(e))return ie(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||oe(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e,t){if(e){if("string"==typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ie(e,t):void 0}}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ae=function(e,t,n){return function(r){return r.ofType(y.AQ).switchMap((function(r){var o=r.resource,i=void 0===o?{}:o,a=[],c=e.getState(),l=(0,V.hb)(c),u=(0,V.IQ)(c),s=b()((0,z.jq)(c).filter((function(e){return e.data&&(u!==K.r.GEOSTORY&&e.data.id||e.id)===i.id}))),d=i.id;s?d=s.id:D()(i)?a=[].concat(re(a),[(0,m.Od)("".concat(t)),(0,y.Cp)()]):(d=i.id||_()(),a=[].concat(re(a),[(0,m.rp)(d,l,i.data?i.data:i)]));var f=l===p.Tr.MAP?{resourceId:d,type:l,map:void 0}:{resourceId:d,type:l},v=[(0,m.Vx)("".concat(t),f,"merge")];return n===p.ID.CAROUSEL&&v.push((0,m.Vx)("".concat(t,".map"),{mapInfoControl:!0},"merge")),a=[].concat(re(a),v,[(0,y.Cp)()]),g.Observable.from(a)}))}},ce=function(e,t){return e.ofType(m.D7).filter((function(e){var t=e.element,n=void 0===t?{}:t;return n.type===p.bT.MEDIA||(0,p.lt)(n)})).switchMap((function(n){var r=n.path,o=n.element,i="";(0,p.lt)(o)&&"sections"===r&&(i=".contents[0].contents[0]");var a="".concat(r,'[{"id":"').concat(o.id,'"}]').concat(i),c=(0,z.X6)(t.getState());return g.Observable.of((0,y.$Z)("geostory",c)).merge(e.let(ae(t,a)),e.ofType(y.B8).switchMap((function(){return g.Observable.of((0,m.Od)(a))})).takeUntil(e.ofType(m.wb))).takeUntil(e.ofType(y.wd))}))},le=function(e){return function(t){return t.ofType(m.Hb).switchMap((function(t){var n=t.src;return g.Observable.of((0,m.Vx)("".concat(e),{src:n,editURL:!1},"merge"))}))}},ue=function(e){return e.ofType(m.D7).filter((function(e){var t=e.element,n=void 0===t?{}:t;return n.type===p.bT.WEBPAGE&&!1!==n.editURL||(0,p.NC)(n)})).switchMap((function(t){var n=t.path,r=t.element,o="";(0,p.NC)(r)&&"sections"===n&&(o=".contents[0].contents[0]");var i="".concat(n,'[{"id":"').concat(r.id,'"}]').concat(o);return g.Observable.of((0,m.Vx)(i,{editURL:!0},"merge")).merge(e.let(le(i))).takeUntil(e.ofType(m.cc))}))},se=function(e){return e.ofType(m.cc).switchMap((function(t){var n=t.path;return g.Observable.of((0,m.Vx)(n,{editURL:!0},"merge")).merge(e.let(le(n))).takeUntil(e.ofType(m.D7))}))},pe=function(e){return e.ofType(m.LE).exhaustMap((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.resource,n=e.delay,r=void 0===n?1e3:n;return(t.id?(0,F.id)(t):(0,F.SN)(t)).switchMap((function(e){return g.Observable.of((0,m.GD)(e),(0,m.g5)(p.ZX.SHOW_SAVE,!1),t.id?(0,m.wJ)(e):(0,N.VF)("/geostory/".concat(e))).merge(g.Observable.of((0,W.$Z)({id:"STORY_SAVE_SUCCESS",title:"saveDialog.saveSuccessTitle",message:"saveDialog.saveSuccessMessage"})).delay(t.id?0:r))})).let((0,q.hP)((0,m.YP)(!0,"loading"),(0,m.YP)(!1,"loading"))).catch((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.status,n=e.statusText,r=e.data,o=e.message,i=ne(e,X);return g.Observable.of((0,m.y6)(t?{status:t,statusText:n,data:r}:o||i),(0,m.YP)(!1,"loading"))}))}))},de=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.getState,r=void 0===n?function(){}:n;return e.ofType(m.D7).switchMap((function(e){var t=e.path,n=e.element;return g.Observable.of(n).switchMap((function(){if(document.getElementById(n.id)){var e=(0,p.u0)(t).sectionId,o=(0,z.I0)(e)(r())?e:n.id;return(0,p.M1)(o,{behavior:"auto",block:"center"}),g.Observable.empty()}throw new Error("Item not mounted yet")})).retryWhen((function(e){return e.delay(200).take(10)}))}))},fe=function(e,t){return e.ofType(y.wd).switchMap((function(n){var r=n.path,o=n.owner,i=n.sectionType,a=(0,z.vv)(r)(t.getState()),c=(0,z.Tr)(a)(t.getState());return g.Observable.of((0,V.hb)(t.getState())).filter((function(e){return c&&c.type!==e})).map((function(){return(0,y.y5)(c.type)})).merge(g.Observable.of((0,y.$Z)(o,(0,z.X6)(t.getState())),(0,y.Gh)(a),(0,y.Tk)(i===p.ID.CAROUSEL?["image","video"]:[])).merge(e.let(ae(t,r,i)).takeUntil(e.ofType(y.B8,m.D7))))}))},me=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(m.XH).switchMap((function(e){var t=e.id;return g.Observable.defer((function(){return t&&O()(parseInt(t,10))?U().get("configs/".concat(t,".json")).then((function(e){var t=e.data,n=t.sections,r=A()(n)&&n.map((function(e){return ee(ee({},e),{},{id:_()()})}));return{data:r.length?ee(ee({},t),{},{sections:r}):t,isStatic:!0,canEdit:!0}})):(0,F.RX)(t)})).do((function(e){if(!e.data)throw Error("Wrong data format");return!0})).switchMap((function(e){var n=e.data,o=e.isStatic,i=void 0!==o&&o,a=ne(e,Y),c=r(),l=(0,G.qg)(c),u=(0,G.jl)(c),s=E()(n)?JSON.parse(n):n;if(!u&&O()(parseInt(t,10)))return g.Observable.of((0,m.Ct)({status:403}));var d=(0,z.eK)(c)===p.nl.EDIT;return g.Observable.from([].concat(re(i||d?[(0,m.D_)(a&&a.canEdit||l)]:[]),[(0,m.OS)(t),(0,m.K0)(s),(0,m.DF)(a)]))})).let((0,q.hP)((0,m.YP)(!0,"loading"),(0,m.YP)(!1,"loading"),(function(e){var t=(0,p.of)(),n=t+".errors.loading.unknownError";return 403===e.status?(n=t+".errors.loading.pleaseLogin",((0,G.jl)(r())||(0,z.JM)(r()))&&(n=t+".errors.loading.geostoryNotAccessible")):404===e.status?n=t+".errors.loading.geostoryDoesNotExist":P()(e.status)&&(n=e.message),g.Observable.of((0,W.vU)({title:t+".errors.loading.title",message:n}),(0,m.K0)({}),(0,m.Ct)(ee(ee({},e),{},{messageId:n})))}))).startWith((0,m.K0)({}))}))},ye=function(e){return e.ofType(m.XH).switchMap((function(t){var n=t.id;return e.ofType(H.XP,H.Nv).switchMap((function(){return g.Observable.of((0,m.wJ)(n)).delay(500)})).takeUntil(e.ofType(N.nk))}))},ge=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(m.Dq).switchMap((function(e){var t=e.path,n=(0,p.Ll)(t,(0,z.Kg)(r())),o=T()(n,"contents");if(o>0){var i=n.splice(0,o),a=(0,z.$F)(i.join("."))(r());if(a&&a.contents&&0===a.contents.length)return g.Observable.of((0,m.Od)(i.join(".")))}return g.Observable.empty()}))},ve=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(m.tP).switchMap((function(e){var t=e.source,n=e.target,o=e.position,i=r(),a=(0,z.$F)(t)(i);return g.Observable.from([(0,m.Od)(t),(0,m.IH)(n,o,a)])}))},be=function(e,t){var n=t.getState,r=void 0===n?function(){}:n;return e.ofType(m.wb).filter((function(e){var t=e.path;return(void 0===t?"":t).endsWith("editMap")})).switchMap((function(e){var t=e.path,n=e.element,o=(0,p.ln)(t,(0,z.Kg)(r())),i=o.flatPath,a=o.path,c=1===i.length,l=c?i[0]:i.pop(),u=c?i[0]:i.shift(),s="background"===a[a.length-2],d=s&&"#".concat(u.id," .ms-section-background-container")||"#".concat(l.id);return(0,p.M1)(l.id),g.Observable.from([(0,m.$A)(n,l,d,s,t.replace(".editMap",""))])}))},he=function(e,t){var n=t.getState;return e.ofType(m.wb).filter((function(e){var t=e.path,n=e.element;return t&&t.endsWith("carouselToggle")&&n})).switchMap((function(e){var t=e.path,r=(0,p.u0)(t)||{},o=r.sectionId,i=r.contentId,a=(0,z.eB)(o)(n())||[];return i&&!D()(a)?g.Observable.from([(0,m.fD)(o,i)]).concat(g.Observable.of((0,m.Vx)(t,!1))):g.Observable.empty()}))},Oe=function(e,t){var n=t.getState;return e.ofType($.nr).filter((function(e){var t=e.owner,n=e.map;return"inlineEditor"===t&&!!n})).switchMap((function(){return e.ofType($.LE).switchMap((function(t){var r=t.map,o=(0,z.FW)(n()).path;return g.Observable.of((0,m.Vx)("".concat(o,".map"),r,"merge"),(0,m.Vx)("".concat(o,".editMap"),!1),(0,$.Cp)()).takeUntil(e.ofType($.B8))}))}))},we=function(e){return e.ofType(m.vb).switchMap((function(){return g.Observable.of((0,Z.Xg)("share","enabled",!1))}))},Ee=function(e){return g.Observable.merge(e.ofType(m.XH).switchMap((function(){return e.ofType(m.Zf)}))).switchMap((function(){return e.ofType(m.D7,m.wb,m.Dq,m.mN,m.QK,m.km).take(1).switchMap((function(){return g.Observable.of((0,m.c0)(!0)).concat(e.ofType(m.si,N.nk,H.Nv).take(1).switchMap((function(){return g.Observable.of((0,m.c0)(!1))})))}))}))},Se=function(e,t){var n=t.getState;return e.ofType(m.un).let(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};return function(r){return r.withLatestFrom(e.startWith(t)).filter((function(e){var t=Q(e,2)[1];return n(t)})).map((function(e){return Q(e,1)[0]}))}}(e.ofType(m.Gx).map((function(e){return!e.value})))).debounceTime(50).switchMap((function(e){var t=e.sectionId,r=e.columnId;if("edit"!==(0,z.eK)(n())&&(r||t)&&(0,z.bU)(n())){var o,i,a=x()(n(),"geostory.resource.id"),c=(0,p.NP)(window.location.href,null===(o=window)||void 0===o||null===(i=o.location)||void 0===i?void 0:i.hash,a,t,r);c&&history.pushState(null,"",c)}return g.Observable.empty()}))},Pe=function(e){return e.ofType(m.ij).switchMap((function(e){var t,n,r,o=e.delay,i=void 0===o?500:o,a=null===(t=window)||void 0===t||null===(n=t.location)||void 0===n||null===(r=n.hash)||void 0===r?void 0:r.split("/");return g.Observable.of(a).delay(i).do((function(){var e,t,n;null!==(e=window)&&void 0!==e&&null!==(t=e.location)&&void 0!==t&&null!==(n=t.hash)&&void 0!==n&&n.includes("shared")?(0,p.M1)(a[7]||a[5],{block:"start",behavior:"auto"}):a.length>5?(0,p.M1)(a[6],{block:"start",behavior:"auto"}):5===a.length&&(0,p.M1)(a[4],{block:"start",behavior:"auto"})})).ignoreElements().startWith((0,m.WE)(!0)).concat(g.Observable.of((0,m.WE)(!1)).delay(i))}))},je=function(e){return e.ofType(N.nk).switchMap((function(e){var t,n=e.payload;if((null==n||null===(t=n.location)||void 0===t?void 0:t.pathname.includes("/geostory/"))&&"POP"===n.action){var r,o=I()(null==n||null===(r=n.location)||void 0===r?void 0:r.pathname);return o.find((function(e){return"shared"===e}))?g.Observable.of((0,m.wJ)(o[2])).delay(500):g.Observable.of((0,m.wJ)(o[1])).delay(500)}return g.Observable.empty()}))},Te=function(e,t){var n=t.getState;return e.ofType(m.un).filter((function(e){var t=e.columnId,r=e.sectionId;return!("edit"!==(0,z.eK)(n())||!t&&!r)})).debounceTime(50).switchMap((function(){return g.Observable.of(Array.from(document.querySelectorAll(".ms-geostory-builder .mapstore-side-card.ms-highlight")).pop()).filter((function(e){return!!e})).withLatestFrom(g.Observable.of(document.querySelector(".ms-geostory-builder .ms2-border-layout-body")).filter((function(e){return!!e}))).map((function(e){var t=Q(e,2),n=t[0],r=t[1];return function(){var e=n.getBoundingClientRect(),t=e.top,o=e.bottom,i=r.getBoundingClientRect(),a=i.top,c=i.bottom;t<a?r.scrollBy({top:t-a-10,behavior:"smooth"}):o>c&&r.scrollBy({top:o-c+10,behavior:"smooth"})}})).do((function(e){return window.requestAnimationFrame(e)})).ignoreElements()}))},Ce=n(8316),Ie=n(66190),ke=n(65539),xe=n(96259),Me=n(67076),Ae=n(28878);function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){Ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,Me.setObservableConfig)(Ae.Z);var _e=(0,Me.compose)((0,Me.mapPropsStream)((function(e){var t=(0,Me.createEventHandler)(),n=t.handler,r=t.stream,o="EMPTY",i="EMPTY";return g.Observable.combineLatest(e,r.filter((function(e){var t=e.columnId,n=e.sectionId;return t&&o!==t?(o=t,!0):!(!n||i===n||(i=n,0))})).withLatestFrom(e.pluck("updateCurrentPage")).do((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Le(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];return i&&i(o)})).ignoreElements().startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return De(De({},t.reduce((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return De(De({},e),t)}),{})),{},{updateCurrentPage:n})}))}))),Be=n(82030),Ue=n(22762),Fe=n.n(Ue);function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){He(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function He(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,Me.setObservableConfig)(Ae.Z);const Ge=(0,Me.compose)((0,Me.mapPropsStream)((function(e){var t=(0,Me.createEventHandler)(),n=t.handler,r=t.stream;return g.Observable.combineLatest(e,function(e,t){return t.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{interceptorTime:e.interceptorTime,updateCurrentPage:e.updateCurrentPage}})).distinctUntilKeyChanged("interceptorTime").switchMap((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.interceptorTime,r=void 0===n?100:n,o=t.updateCurrentPage;return e.scan((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.visible,o=t.entry;return We(We({},e),{},He({},n,{visible:r,entry:o}))}),{}).debounceTime(r).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Fe()(Object.keys(e),(function(t){return e[t].visible?x()(e[t],"entry.boundingClientRect.top"):1/0}))})).do((function(e){o&&o({sectionId:e})})).ignoreElements()}))}(r,e).startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return We(We({},t.reduce((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return We(We({},e),t)}),{})),{},{onVisibilityChange:n})}))})));var ze=n(45697),Ve=n.n(ze),qe=n(93451),Ke=(n(2485),n(37163)),$e=n(73611),Xe=n(94184),Ye=n.n(Xe);function Qe(e){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tt(e,t,n){return t&&et(e.prototype,t),n&&et(e,n),e}function nt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rt(e,t)}function rt(e,t){return(rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ot(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ct(e);if(t){var o=ct(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return it(this,n)}}function it(e,t){return!t||"object"!==Qe(t)&&"function"!=typeof t?at(e):t}function at(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ut="External Link",st=function(e){nt(n,e);var t=ot(n);function n(){var e;Je(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return lt(at(e=t.call.apply(t,[this].concat(o))),"state",{expanded:!1}),lt(at(e),"toggle",(function(){e.setState((function(e){return{expanded:!e.expanded}}))})),e}return tt(n,[{key:"render",value:function(){var e=this.state.expanded,t=this.props,n=t.externalLinkOption,r=t.onSelectionChange,o=t.currentSelectOption,a=t.availableStorySections;return i().createElement("div",{className:"rdw-block-wrapper","aria-label":"rdw-block-control"},i().createElement($e.Dropdown,{className:"ms-rdw-link-options-dropdown",onChange:r,expanded:e,doExpand:this.toggle,doCollapse:this.toggle,onExpandEvent:this.toggle,title:"MSLinks"},i().createElement("span",null,o),i().createElement($e.DropdownOption,{active:!0,value:{value:n,label:n},key:n},"External Link"),a&&a.map((function(e){return i().createElement($e.DropdownOption,{active:e.id===o,value:{value:e.id,label:e.title||e.type||e.id},key:e.id},e.title||e.type||e.id)}))))}}]),n}(o.Component);lt(st,"propTypes",{externalLinkOption:Ve().string,onSelectionChange:Ve().func,currentSelectOption:Ve().string,availableStorySections:Ve().array});var pt=function(e){nt(n,e);var t=ot(n);function n(){var e;Je(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return lt(at(e=t.call.apply(t,[this].concat(o))),"state",{showModal:!1,linkTarget:"",linkTitle:"",attributes:{},linkTargetOption:e.props.config.defaultTargetOption,currentSelectOption:"Select link target"}),lt(at(e),"removeLink",(function(){(0,e.props.onChange)("unlink")})),lt(at(e),"addLink",(function(){var t=e.props.onChange,n=e.state;t("link",n.linkTitle,n.linkTarget,n.linkTargetOption,n.attributes)})),lt(at(e),"updateValue",(function(t){e.setState(lt({},"".concat(t.target.name),t.target.value))})),lt(at(e),"onSelectionChange",(function(t){t.value===ut?e.setState({linkTarget:"",attributes:{},currentSelectOption:t.label}):e.setState({linkTarget:t.value,attributes:{"data-geostory-interaction-type":"scrollTo","data-geostory-interaction-params":"".concat(t.value),"data-geostory-interaction-name":t.label},currentSelectOption:t.label})})),lt(at(e),"updateTargetOption",(function(t){e.setState({linkTargetOption:t.target.checked?"_blank":"_self"})})),lt(at(e),"hideModal",(function(){e.setState({showModal:!1})})),lt(at(e),"signalExpandShowModal",(function(){var t=e.props,n=t.onExpandEvent,r=t.currentState,o=r.link,i=r.selectionText,a=e.state.linkTargetOption;n();var c="Select link target";null!=o&&o.target&&o.target.length>0&&(c=ut),null!=o&&o.attributes["data-geostory-interaction-name"]&&(c=o.attributes["data-geostory-interaction-name"]),e.setState({showModal:!0,linkTarget:o&&o.target||"",linkTargetOption:o&&o.targetOption||a,linkTitle:o&&o.title||i,attributes:o&&o.attributes||{},currentSelectOption:c})})),lt(at(e),"forceExpandAndShowModal",(function(){var t=e.props,n=t.doExpand,r=t.currentState,o=r.link,i=r.selectionText,a=e.state.linkTargetOption;n();var c="Select link target";null!=o&&o.target&&o.target.length>0&&(c=ut),null!=o&&o.attributes["data-geostory-interaction-name"]&&(c=o.attributes["data-geostory-interaction-name"]),e.setState({showModal:!0,linkTarget:o&&o.target,linkTargetOption:o&&o.targetOption||a,linkTitle:o&&o.title||i,attributes:o&&o.attributes||{},currentSelectOption:c})})),e}return tt(n,[{key:"componentDidUpdate",value:function(e){e.expanded&&!this.props.expanded&&this.setState({showModal:!1,linkTarget:"",linkTitle:"",attributes:{},linkTargetOption:this.props.config.defaultTargetOption,currentSelectOption:"Select link target"})}},{key:"renderAddLinkModal",value:function(){var e=this.props,t=e.config.popupClassName,n=e.doCollapse,r=e.translations,o=e.availableStorySections,a=this.state,c=a.linkTitle,l=a.linkTarget,u=a.linkTargetOption,s=a.currentSelectOption;return i().createElement("div",{className:Ye()("rdw-link-modal",t),onClick:$e.stopPropagation},i().createElement("label",{className:"rdw-link-modal-label",htmlFor:"linkTitle"},r["components.controls.link.linkTitle"]),i().createElement("input",{id:"linkTitle",className:"rdw-link-modal-input",onChange:this.updateValue,onBlur:this.updateValue,name:"linkTitle",value:c}),i().createElement("label",{className:"rdw-link-modal-label",htmlFor:"linkTarget"},r["components.controls.link.linkTarget"]),i().createElement(st,{externalLinkOption:ut,currentSelectOption:s,onSelectionChange:this.onSelectionChange,availableStorySections:o}),s===ut&&i().createElement(i().Fragment,null,i().createElement("input",{id:"linkTarget",className:"rdw-link-modal-input",onChange:this.updateValue,onBlur:this.updateValue,name:"linkTarget",value:l}),i().createElement("label",{className:"rdw-link-modal-target-option",htmlFor:"openLinkInNewWindow"},i().createElement("input",{id:"openLinkInNewWindow",type:"checkbox",defaultChecked:"_blank"===u,value:"_blank",onChange:this.updateTargetOption}),i().createElement("span",null,r["components.controls.link.linkTargetOption"]))),i().createElement("span",{className:"rdw-link-modal-buttonsection"},i().createElement("button",{className:"rdw-link-modal-btn",onClick:this.addLink,disabled:!l||!c},r["generic.add"]),i().createElement("button",{className:"rdw-link-modal-btn",onClick:n},r["generic.cancel"])))}},{key:"renderInFlatList",value:function(){var e=this.props,t=e.config,n=t.options,r=t.link,o=t.unlink,a=t.className,c=e.currentState,l=e.expanded,u=e.translations,s=this.state.showModal;return i().createElement("div",{className:Ye()("rdw-link-wrapper",a),"aria-label":"rdw-link-control"},n.indexOf("link")>=0&&i().createElement($e.Option,{value:"unordered-list-item",className:Ye()(r.className),onClick:this.signalExpandShowModal,"aria-haspopup":"true","aria-expanded":s,title:r.title||u["components.controls.link.link"]},i().createElement("img",{src:r.icon,alt:""})),n.indexOf("unlink")>=0&&i().createElement($e.Option,{disabled:!c.link,value:"ordered-list-item",className:Ye()(o.className),onClick:this.removeLink,title:o.title||u["components.controls.link.unlink"]},i().createElement("img",{src:o.icon,alt:""})),l&&s?this.renderAddLinkModal():void 0)}},{key:"renderInDropDown",value:function(){var e=this.props,t=e.expanded,n=e.onExpandEvent,r=e.doCollapse,o=e.doExpand,a=e.onChange,c=e.config,l=e.currentState,u=e.translations,s=c.options,p=c.link,d=c.unlink,f=c.className,m=c.dropdownClassName,y=c.title,g=this.state.showModal;return i().createElement("div",{className:"rdw-link-wrapper","aria-haspopup":"true","aria-label":"rdw-link-control","aria-expanded":t,title:y},i().createElement($e.Dropdown,{className:Ye()("rdw-link-dropdown",f),optionWrapperClassName:Ye()(m),onChange:a,expanded:t&&!g,doExpand:o,doCollapse:r,onExpandEvent:n},i().createElement("img",{src:(0,$e.getFirstIcon)(c),alt:""}),s.indexOf("link")>=0&&i().createElement($e.DropdownOption,{onClick:this.forceExpandAndShowModal,className:Ye()("rdw-link-dropdownoption",p.className),title:p.title||u["components.controls.link.link"]},i().createElement("img",{src:p.icon,alt:""})),s.indexOf("unlink")>=0&&i().createElement($e.DropdownOption,{onClick:this.removeLink,disabled:!l.link,className:Ye()("rdw-link-dropdownoption",d.className),title:d.title||u["components.controls.link.unlink"]},i().createElement("img",{src:d.icon,alt:""}))),t&&g?this.renderAddLinkModal():void 0)}},{key:"render",value:function(){return this.props.config.inDropdown?this.renderInDropDown():this.renderInFlatList()}}]),n}(o.Component);lt(pt,"propTypes",{expanded:Ve().bool,doExpand:Ve().func,doCollapse:Ve().func,onExpandEvent:Ve().func,config:Ve().object,onChange:Ve().func,currentState:Ve().object,translations:Ve().object,modalHandler:Ve().any});const dt=pt;function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gt(e,t){return(gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vt(e,t){return!t||"object"!==ft(t)&&"function"!=typeof t?bt(e):t}function bt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ht(e){return(ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wt(e,t,n){e.findEntityRanges((function(e){var t=e.getEntity();return null!==t&&"LINK"===n.getEntity(t).getType()}),t)}function Et(e){var t,n,r=e.showOpenOptionOnHover;return n=t=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gt(e,t)}(l,e);var t,n,o,a,c=(o=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ht(o);if(a){var n=ht(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return vt(this,e)});function l(){var e;mt(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return Ot(bt(e=c.call.apply(c,[this].concat(n))),"state",{showPopOver:!1}),Ot(bt(e),"openLink",(function(){var t=e.props,n=t.entityKey,r=t.contentState.getEntity(n).getData().url,o=window.open(r,"blank");o&&o.focus()})),Ot(bt(e),"toggleShowPopOver",(function(){var t=!e.state.showPopOver;e.setState({showPopOver:t})})),Ot(bt(e),"renderDecorator",(function(){var t=e.props,n=t.children,o=t.entityKey,a=t.contentState.getEntity(o).getData(),c=a.url,l=a.targetOption,u=a.attributes,s=e.state.showPopOver;return u&&u["data-geostory-interaction-type"]?i().createElement("span",{className:"rdw-link-decorator-wrapper"},i().createElement("a",{"data-geostory-interaction-type":u["data-geostory-interaction-type"],"data-geostory-interaction-params":u["data-geostory-interaction-params"]},n)):i().createElement("span",{className:"rdw-link-decorator-wrapper",onMouseEnter:e.toggleShowPopOver,onMouseLeave:e.toggleShowPopOver},i().createElement("a",{href:c,target:l},n),s&&r?i().createElement("img",{src:$e.openlink,alt:"",onClick:e.openLink,className:"rdw-link-decorator-icon"}):void 0)})),e}return t=l,(n=[{key:"render",value:function(){return this.renderDecorator()}}])&&yt(t.prototype,n),l}(o.Component),Ot(t,"propTypes",{entityKey:Ve().string.isRequired,children:Ve().array,contentState:Ve().object}),n}const St=function(e){return{strategy:wt,component:Et(e)}};var Pt=n(89265),jt=n.n(Pt),Tt=n(17247),Ct=n.n(Tt),It=function(e){var t=void 0;if(e instanceof HTMLAnchorElement){var n={};if(e.dataset&&void 0!==e.dataset.mention)n.url=e.href,n.text=e.innerHTML,n.value=e.dataset.value,t=Ke.Entity.__create("MENTION","IMMUTABLE",n);else{n.url=e.getAttribute&&e.getAttribute("href")||e.href,n.title=e.innerHTML,n.targetOption=e.target;var r=e.getAttribute&&e.getAttribute("data-geostory-interaction-type"),o=e.getAttribute&&e.getAttribute("data-geostory-interaction-params"),i=e.getAttribute&&e.getAttribute("data-geostory-interaction-name"),a={};i&&o&&r&&(a["data-geostory-interaction-type"]=r,a["data-geostory-interaction-params"]=o,a["data-geostory-interaction-name"]=i),n.attributes=a,t=Ke.Entity.__create("LINK","MUTABLE",n)}}return t},kt=function(e,t){if("MENTION"===e.type)return'< href="'.concat(e.data.url,'" class="wysiwyg-mention" data-mention data-value="').concat(e.data.value,'">').concat(t,"</a>");if("LINK"===e.type){var n=e.data.targetOption||"_self",r=e.data.attributes;return r&&r["data-geostory-interaction-type"]?'<a data-geostory-interaction-name="'.concat(r["data-geostory-interaction-name"],'" data-geostory-interaction-type="').concat(r["data-geostory-interaction-type"],'" data-geostory-interaction-params="').concat(r["data-geostory-interaction-params"],"\" onclick=\"__geostory_interaction(type='scrollTo', '").concat(r["data-geostory-interaction-params"],"')\">").concat(t,"</a>"):'<a href="'.concat(e.data.url,'" target="').concat(n,'">').concat(t,"</a>")}if("IMAGE"===e.type){var o=e.data.alignment,i=o&&"none"!==o?"float: ".concat(o,";"):"display: block; margin: 0 auto 0 auto;";return'<img src="'.concat(e.data.src,'" alt="').concat(e.data.alt,'" style="height: ').concat(e.data.height,"; width: ").concat(e.data.width,"; ").concat(i,'" />')}return"EMBEDDED_LINK"===e.type?'<iframe width="'.concat(e.data.width,'" height="').concat(e.data.height,'" src="').concat(e.data.src,'" frameBorder="0"></iframe>'):t};function xt(){return(xt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function At(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?At(Object(n),!0).forEach((function(t){Dt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Nt=(0,Me.compose)((0,Me.withProps)((function(e){var t=e.storyFonts,n=void 0===t?[]:t,r=e.placeholder,o=e.toolbarStyle,i=void 0===o?{}:o,a=e.className,c=void 0===a?"ms-text-editor":a,l=e.toolbar,u=void 0===l?{}:l;return{editorRef:function(e){return setTimeout((function(){return e&&e.focus&&e.focus()}),100)},stripPastedStyles:!0,placeholder:r,toolbarStyle:i,toolbar:Rt({options:["fontFamily","blockType","fontSize","inline","textAlign","colorPicker","list","link","remove"],fontFamily:{options:n.length>0?n:p.Km,className:void 0,component:void 0,dropdownClassName:void 0},link:{inDropdown:!1,className:void 0,component:void 0,popupClassName:void 0,dropdownClassName:void 0,showOpenOptionOnHover:!0,defaultTargetOption:"_self",options:["link","unlink"],link:{icon:void 0,className:void 0},unlink:{icon:void 0,className:void 0},linkCallback:void 0},blockType:{inDropdown:!0,options:["Normal","H1","H2","H3","H4","H5","H6","Blockquote","Code"],className:void 0,component:void 0,dropdownClassName:void 0},inline:{options:["bold","italic","underline","strikethrough","monospace"],bold:{className:"".concat(c,"-toolbar-btn")},italic:{className:"".concat(c,"-toolbar-btn")},underline:{className:"".concat(c,"-toolbar-btn")},strikethrough:{className:"".concat(c,"-toolbar-btn")},code:{className:"".concat(c,"-toolbar-btn")}},textAlign:{left:{className:"".concat(c,"-toolbar-btn")},center:{className:"".concat(c,"-toolbar-btn")},right:{className:"".concat(c,"-toolbar-btn")},justify:{className:"".concat(c,"-toolbar-btn")}},colorPicker:{className:"".concat(c,"-toolbar-btn")},remove:{className:"".concat(c,"-toolbar-btn")}},u),toolbarClassName:"".concat(c,"-toolbar"),wrapperClassName:"".concat(c,"-wrapper"),editorClassName:"".concat(c,"-main")}})),(0,Me.renderComponent)($e.Editor)),Lt=(0,Me.compose)((0,Me.lifecycle)({componentWillUnmount:function(){var e=this.props,t=e.editorState,n=e.save;(void 0===n?function(){}:n)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e){var n=1!==(0,Ke.convertToRaw)(e.getCurrentContent()).blocks.length||(0,Ke.convertToRaw)(e.getCurrentContent()).blocks[0].text,r=jt()((0,Ke.convertToRaw)(e.getCurrentContent()),null,null,kt);return n?r:t}return t}(t,p.gg))}}),(0,Me.withHandlers)({onBlur:function(e){var t=e.toggleEditing,n=void 0===t?function(){}:t;return function(){n(!1)}}}),(0,Me.withProps)((function(e){var t=e.sections;return{availableStorySections:(void 0===t?[]:t).reduce((function(e,t){var n,r=[];return[p.ID.IMMERSIVE,p.ID.CAROUSEL].includes(t.type)?t.contents.forEach((function(e){r.push(e)})):r.push(t),[].concat(function(e){if(Array.isArray(e))return Mt(e)}(n=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return Mt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mt(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),r)}),[])}})),(0,Me.withProps)((function(e){var t=e.availableStorySections,n=void 0===t?[]:t;return{toolbar:{link:{inDropdown:!1,className:void 0,component:function(e){return i().createElement(dt,xt({},e,{availableStorySections:n}))},popupClassName:void 0,dropdownClassName:void 0,showOpenOptionOnHover:!0,defaultTargetOption:"_self",options:["link","unlink"],link:{icon:void 0,className:void 0},unlink:{icon:void 0,className:void 0},linkCallback:void 0,getLinkDecorator:St}}}})),Nt);const _t=(0,Me.compose)((0,Me.withState)("contentEditing","setContentEditing",!1),(0,Me.withState)("editorState","onEditorStateChange"),(0,Me.withHandlers)({toggleEditing:function(e){var t=e.bubblingTextEditing,n=void 0===t?function(){}:t,r=e.sectionType,o=e.onEditorStateChange,i=void 0===o?function(){}:o,a=e.setContentEditing,c=void 0===a?function(){}:a;return function(e,t){if(e){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=Ct()(e,null,It),n=Ke.ContentState.createFromBlockArray(t.contentBlocks);return Ke.EditorState.createWithContent(n)}(t);if(r===p.ID.TITLE&&"unstyled"===Ke.RichUtils.getCurrentBlockType(o)){var a=o.getCurrentContent();a=Ke.Modifier.setBlockType(a,Ke.EditorState.createWithContent(a).getSelection(),"header-one"),o=Ke.EditorState.createWithContent(a)}i(o),c(!0),n(!0)}else c(!1),n(!1)}}}),(0,Me.branch)((function(e){return!!e.contentEditing}),Lt)),Bt=(0,Me.compose)((0,Me.withHandlers)({save:function(e){var t=e.update,n=void 0===t?function(){}:t;return function(e){return n("html",e)}}}),(0,Me.branch)((function(e){return e.mode===p.nl.EDIT}),_t),(0,Me.compose)((0,Me.withPropsOnChange)(["sectionType"],(function(e){var t=e.sectionType;return{placeholder:p.ID.TITLE===t?"geostory.builder.defaults.htmlTitlePlaceholder":"geostory.builder.defaults.htmlPlaceholder",placeholderTag:p.ID.TITLE===t?"h1":"p"}})),(0,qe.Z)("placeholder")))((function(e){var t=e.placeholder,n=e.placeholderTag,r=void 0===n?"p":n,o=e.id,a=e.toggleEditing,c=void 0===a?function(){}:a,l=e.html,u=e.mode;return i().createElement("div",{className:"ms-text-wrapper"},l!==p.gg&&i().createElement("div",{id:o,onClick:function(){return c(!0,l)},dangerouslySetInnerHTML:{__html:l}}),(!l||l===p.gg)&&u===p.nl.EDIT&&i().createElement("div",{className:"ms-text-placeholder",id:"placeholder"+o,onClick:function(){return c(!0,l===p.gg?"":l)},dangerouslySetInnerHTML:{__html:"<".concat(r,">").concat(t,"</").concat(r,">")}}))}));var Ut=n(1206),Ft=n.n(Ut),Zt=n(96797),Wt=n.n(Zt);function Ht(e){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){Yt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kt(e,t){return(Kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $t(e,t){return!t||"object"!==Ht(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xt(e){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Qt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kt(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Xt(r);if(o){var n=Xt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return $t(this,e)});function c(){return Vt(this,c),a.apply(this,arguments)}return t=c,(n=[{key:"componentDidMount",value:function(){Wt()(this._node)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.src!==this.props.src&&Wt()(this._node)}},{key:"render",value:function(){var e=this,t=this.props,n=t.id,r=t.src,o=t.fit,a=void 0===o?"cover":o,c=t.enableFullscreen,l=void 0===c||c,u=t.fullscreen,s=t.onClick,p=t.description,d=t.showCaption,f=t.caption,m=void 0===f?p:f,y=t.credits,g=t.loaderStyle,v=this.props.loaderComponent,b=this.props.errorComponent;return i().createElement("div",{id:n,className:"ms-media ms-media-image"},r&&"error"!==this.props.status&&i().createElement("img",{ref:function(t){e._node=t},src:r,onLoad:function(){return e.props.onChangeStatus("loaded")},onError:function(){return e.props.onChangeStatus("error")},onClick:l?function(){return s(!0)}:void 0,style:{objectFit:a,fontFamily:"object-fit: ".concat(a),cursor:l?"pointer":"default"}}),r&&!this.props.status&&v&&i().createElement(v,{style:zt({},g)}),"error"===this.props.status&&b&&i().createElement(b,null),y&&i().createElement("div",{className:"ms-media-credits"},i().createElement("small",null,y)),d&&m&&i().createElement("div",{className:"ms-media-caption"},i().createElement("small",null,m)),l&&u?i().createElement(Ft(),{mainSrc:r,onCloseRequest:function(){return s(!1)}}):null)}}])&&qt(t.prototype,n),c}(o.Component);Yt(Qt,"propTypes",{src:Ve().string,id:Ve().string,fit:Ve().string,description:Ve().string,showCaption:Ve().bool,credits:Ve().string,altText:Ve().string,enableFullscreen:Ve().bool,fullscreen:Ve().bool,onClick:Ve().func,onChangeStatus:Ve().func,status:Ve().string,loaderComponent:Ve().element,errorComponent:Ve().element,caption:Ve().string,loaderStyle:Ve().object});const Jt=(0,Me.compose)((0,Me.withState)("fullscreen","onClick",!1),(0,Me.withState)("status","onChangeStatus",""))(Qt);var en=n(30294),tn=n(19180),nn=n(91812),rn=n(37981),on=n(69705),an=n(57068),cn=n(1979),ln=n(55745),un=n.n(ln),sn=n(65442),pn=n.n(sn),dn=n(47359),fn=n(18446),mn=n.n(fn),yn=n(24262),gn=n(88798),vn=n(49243),bn=n(13311),hn=n.n(bn),On=["rawPos"],wn=["PopupSupport","tools"];function En(){return(En=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Sn(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Pn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return jn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tn(Object(n),!0).forEach((function(t){In(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function In(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kn(e){return e&&0===e.indexOf("geostory-vector")}var xn=(0,Me.compose)((0,a.connect)((function(e){return{sections:(0,z.NR)(e)}}),{onClickMarker:m.Vx}),(0,Me.withHandlers)({onClickMarker:function(e){var t=e.onClickMarker,n=void 0===t?function(){}:t,r=e.sections,o=void 0===r?{}:r;return function(e,t,r){var a=(hn()(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.queryParams,r=(n=void 0===n?{}:n).request,o=e.layerMetadata,i=(o=void 0===o?{}:o).title;return!r&&i.toLowerCase()===t}))||{}).response,c=(a=void 0===a?{}:a).features,l=Pn(c=void 0===c?[]:c,1)[0],u=(l=void 0===l?{}:l).contentRefId,s=hn()(o,(function(e){var t=e.contents;return hn()(t,{id:u})})),p={popups:[]};if(s){var d=hn()(s.contents,{id:u})||{},f=d.id,m=d.title,y=void 0===m?"":m;n('sections[{"id":"'.concat(s.id,'"}].contents[{"id":"').concat(f,'"}].carouselToggle'),!0),y&&(p={popups:r.map((function(e){return Cn(Cn({},e),{},{component:function(){return i().createElement("div",{className:"ms-geostory-carousel-viewer"},y)}})}))})}return p}}})),Mn=(0,Me.mapPropsStream)((function(e){var t=(0,Me.createEventHandler)(),n=t.stream,r=t.handler;return n.withLatestFrom(e.map((function(e){return{map:e.map,layers:e.layers,options:e.options}})).distinctUntilChanged((function(e,t){return mn()(e,t)}))).switchMap((function(e){var t=Pn(e,2),n=t[0],r=n.point,o=n.layerInfo,i=t[1],a=i.map,c=i.layers,l=void 0===c?[]:c,u=i.options,s=(u=void 0===u?{}:u).mapOptions,p=(s=void 0===s?{}:s).mapInfoFormat,d=void 0===p?(0,cn.GA)():p,f=l.filter((function(e){return(0,yn.T4)(e,a.resolution)&&(0,gn.y_)(e)}));kn(o)&&(f=f.filter((function(e){var t=e.id;return o===t})));var m=["SLD_BODY"],y=["buffer","cql_filter","filter","propertyName"];return 0===f.length?g.Observable.of({requests:[{}],responses:[{response:{features:[]}}],validResponses:[]}):g.Observable.from(f).mergeMap((function(e){var t=(0,gn.Fm)(e,{format:d,map:a,point:r,currentLocale:"en-US"}),n=t.url,o=t.request,i=t.metadata,c=n,l=o,u=Cn(Cn({},(0,gn.K7)(e,y,m)),l),s=_()();return(n?(0,vn.y)(c,u,e).map((function(e){return e.data.exceptions?{reqId:s,exceptions:e.data.exceptions,queryParams:l,layerMetadata:i}:{data:e.data,reqId:s,queryParams:l,layerMetadata:Cn(Cn({},i),{},{features:e.features,featuresCrs:e.featuresCrs})}})):g.Observable.of(function(e,t,n){var r={type:"Feature",properties:{},geometry:{type:"Point",coordinates:[t.lng,t.lat]}},o=n&&n.units;switch(o){case"m":o="meters";break;case"deg":o="degrees";break;case"mi":o="miles";break;default:o="meters"}var i=n&&n.resolution||1,a=un()(r,(n.buffer||1)*i,o);return{data:{crs:null,features:(e.features||[]).filter((function(e){try{return"FeatureCollection"===e.type&&e.features&&e.features.length?e.features.reduce((function(e,t){var r=t.properties.useGeodesicLines&&t.properties.geometryGeodesic?Cn(Cn({},t),{},{geometry:t.properties.geometryGeodesic}):t;return e||pn()(a,i&&n.buffer&&o?un()(r,1,"meters"):r)}),!1):pn()(a,i&&n.buffer&&o?un()(e,1,"meters"):e)}catch(e){return!1}})),totalFeatures:"unknown",type:"FeatureCollection"},queryParams:t,layerMetadata:n}}(e,o,i))).catch((function(e){return{error:e.data||e.statusText||e.status,reqId:s,queryParams:l,layerMetadata:i}})).startWith({start:!0,reqId:s,request:u})})).scan((function(e,t){var n=e.requests,r=e.responses,i=e.validResponses;if(t.start){var a=t.reqId,c=t.request;return{requests:n.concat({reqId:a,request:c}),responses:r,validResponses:i}}var l=t.data,u=t.queryParams,s=t.layerMetadata,p=(0,gn.Te)(d),f=r.concat({response:l,queryParams:u,layerMetadata:s});return{requests:n,validResponses:p.getValidResponses(f),responses:f,layerInfo:o}}),{requests:[],responses:[],validResponses:[],layerInfo:o})})).startWith({requests:[],responses:[]}).combineLatest(e,(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Cn(Cn({},t),{},{mapInfo:e,getFeatureInfoHandler:r})}))}));const An=(0,Me.branch)((function(e){var t=e.map,n=(t=void 0===t?{}:t).mapInfoControl,r=void 0!==n&&n;return!e.isDrawEnabled&&r}),(0,Me.compose)(Mn,(0,Me.withStateHandlers)({popups:[]},{onClick:function(e,t){var n=t.getFeatureInfoHandler,r=void 0===n?function(){}:n,o=t.map,i=(o=void 0===o?{}:o).mapInfoControl;return function(e,t){var n=e.rawPos,o=void 0===n?[]:n,a=Sn(e,On);return kn(t)||i?(r({point:a,layerInfo:t}),{popups:[{position:{coordinates:o},id:_()()}]}):{popups:[]}}},onPopupClose:function(){return function(){return{popups:[]}}}}),(0,Me.withPropsOnChange)(["mapInfo","popups"],(function(e){var t=e.mapInfo,n=e.popups,r=e.options,o=(r=void 0===r?{}:r).mapOptions,a=(o=void 0===o?{}:o).mapInfoFormat,c=void 0===a?(0,cn.GA)():a,l=e.onClickMarker,u=void 0===l?function(){}:l,s=t.responses,p=t.requests,d=t.validResponses,f=t.layerInfo;return kn(f)?u(d,f,n):{popups:n.map((function(e){return Cn(Cn({},e),{},{component:function(){return i().createElement(dn.Z,{renderEmpty:!0,responses:s,requests:p,validResponses:d,format:c,showEmptyMessageGFI:!0,missingResponses:(p||[]).length-(s||[]).length})}})}))}})),(0,Me.withPropsOnChange)(["plugins","onPopupClose","popups"],(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.plugins,n=e.popups,r=e.onPopupClose,o=t.PopupSupport,a=t.tools,c=void 0===a?{}:a,l=Sn(t,wn);if(!o)return{};var u=function(e){return i().createElement(o,En({},e,{popups:n,onPopupClose:r}))};return{plugins:Cn(Cn({},l),{},{tools:Cn(Cn({},c),{},{popup:u})})}}))));var Rn=n(61928);const Dn=(0,Me.compose)(on.Z,(0,nn.Z)(0),tn.Z,An,cn.yM,rn.Z,an.e)(Rn.Z);var Nn=n(99534),Ln=n(15135),_n=n(80628),Bn=n(38560),Un=["id","map","fit","editMap","onMapViewChanges","eventHandlers","expandable","active","setActive","width","height","size","showCaption","caption","mapType","onMapTypeLoaded","layers","children"],Fn=["layers","mapOptions","description"];function Zn(){return(Zn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Wn(e){return function(e){if(Array.isArray(e))return Hn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Hn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hn(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gn(Object(n),!0).forEach((function(t){Vn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qn(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Kn=(0,Ln.Z)(Bn.Z);const $n=(0,Me.compose)((0,Me.withState)("active","setActive",!1),_n.Z)((function(e){var t=e.id,n=e.map,r=void 0===n?{layers:[K.D]}:n,a=e.fit,c=e.editMap,l=void 0!==c&&c,u=e.onMapViewChanges,s=e.eventHandlers,d=e.expandable,f=void 0!==d&&d,m=e.active,y=e.setActive,g=e.width,v=e.height,b=e.size,h=e.showCaption,O=e.caption,w=e.mapType,E=void 0===w?"leaflet":w,S=e.onMapTypeLoaded,P=e.layers,j=e.children,T=qn(e,Un),C=r.data?r.data:r,I=C.layers,k=void 0===I?[]:I,x=C.mapOptions,M=void 0===x?{}:x,A=C.description,R=qn(C,Fn),D=O||A,N=f?m?{zoomControl:!1,interactive:!0,mapOptions:{scrollWheelZoom:!0,interactions:{mouseWheelZoom:!0,dragPan:!0}}}:{zoomControl:!1,interactive:!1,mapOptions:{scrollWheelZoom:!1,interactions:{mouseWheelZoom:!1,dragPan:!1}}}:{mapOptions:M},L=l?{mapOptions:zn(zn({},M),{},{interactions:zn(zn({},M.interactions),{},{mouseWheelZoom:R.zoomControl})})}:N,_=!T.isDrawEnabled&&R.mapInfoControl&&!(f&&!m),B=i().createElement(i().Fragment,null,i().createElement(Dn,Zn({},T,{key:f?"overlay":"block",onMapViewChanges:u,eventHandlers:s,map:zn(zn({},R),{},{id:"media-".concat(t),resize:g+"-"+v+"_"+b,className:"aaaa",style:{cursor:_?"pointer":"default"}}),layers:P?[].concat(Wn(k),Wn(P)):k,tools:_?["popup"]:[],options:(0,p.kn)(L),mapType:E,onMapTypeLoaded:S}),o.Children.map(j,(function(e){return e?(0,o.cloneElement)(e,{mapType:E}):null}))),f&&!l&&i().createElement(Kn,{className:"ms-expand-media-button",onClick:function(){return y(!m)},tooltipId:m?"geostory.closeFullscreenMap":"geostory.showFullscreenMap",tooltipPosition:"left"},i().createElement(en.Glyphicon,{glyph:m?"1-close":"1-full-screen"})));return i().createElement("div",{className:"ms-media ms-media-map ".concat(M.zoomPosition||""),style:{objectFit:a}},m&&f?i().createElement(Nn.Z,null,i().createElement("div",{className:"ms-expanded-media-container"},B)):B,h&&D&&i().createElement("div",{className:"ms-media-caption"},i().createElement("small",null,D)))}));var Xn=n(52826),Yn=["debounceTime","mediaViewer","children"];function Qn(){return(Qn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var er=Jt,tr={image:Jt,map:$n,video:Xn.Z},nr=function(e){var t,n,r=e.debounceTime,a=e.mediaViewer,c=e.children,l=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Yn),u="".concat(l.id).concat(l.resourceId?"-".concat(l.resourceId):""),s=(t=(0,o.useState)({}),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Jn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jn(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=s[0],d=s[1],f=void 0===p[u]||p[u],m=a||tr[l.mediaType||l.type]||er;return i().createElement(m,Qn({sectionType:l.sectionType,debounceTime:r,loading:p,isLoading:f,onLoad:d,loadingId:u},l),c)};nr.propTypes={id:Ve().string,lazy:Ve().bool,mediaType:Ve().string,type:Ve().string,debounceTime:Ve().number},nr.defaultProps={id:"",lazy:!0,mediaType:"",type:""};const rr=nr;var or=n(7472),ir=["show","style","modal","draggable","closeGlyph","closable","onClose","title","header","footer","children"];function ar(){return(ar=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function cr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cr(Object(n),!0).forEach((function(t){ur(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ur(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const sr=function(e){var t=e.show,n=e.style,r=void 0===n?{}:n,o=e.modal,a=e.draggable,c=void 0!==a&&a,l=e.closeGlyph,u=void 0===l?"1-close":l,s=e.closable,p=void 0===s||s,d=e.onClose,f=void 0===d?function(){}:d,m=e.title,y=e.header,g=e.footer,v=e.children,b=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,ir);return t?i().createElement(or.Z,ar({modal:o,onClickOut:p&&o?function(){return f()}:null,style:lr(lr({},r),{},{display:t?"block":"none"}),draggable:c},b),i().createElement("span",{role:"header"},m||y||i().createElement("span",null," "),p?i().createElement("button",{onClick:function(){return f()},className:"settings-panel-close close"},i().createElement(en.Glyphicon,{glyph:u})):null),i().createElement("span",{role:"body"},v),g?i().createElement("span",{role:"footer"},g):null):null};var pr=n(5346),dr=(0,Me.branch)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.viewHeight,o=e.size;return!n||!r||!o}),(0,Be.Z)((function(){return!0}),(function(){return{glyph:"code"}})));const fr=(0,Me.compose)(dr)((function(e){var t=e.src,n=e.size,r=e.viewHeight;return i().createElement("div",{className:"ms-webpage-wrapper"},i().createElement("iframe",{src:t,height:"".concat((0,p.t4)(n,r),"px")}))}));var mr=n(11847),yr=n(37275),gr=n(48759),vr=n(23279),br=n.n(vr);function hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Or(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hr(Object(n),!0).forEach((function(t){wr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Er(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Sr=function(e){var t,n,r=e.id,a=e.onLoad,c=e.loading,l=e.debounceTime,u=e.children,s=e.loaderComponent,p=e.loaderStyle,d=(t=(0,gr.YD)(),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Er(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Er(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=d[0],m=d[1],y=(0,o.useRef)(null),g=s;return(0,o.useEffect)((function(){return y.current=br()((function(e){a(e)}),l),function(){y.current.cancel()}}),[]),(0,o.useEffect)((function(){m&&c&&y.current(r),!m&&c&&y.current.cancel()}),[m,c,r]),i().createElement("div",{ref:f,className:"ms-visibility-container"},c?g?i().createElement(g,{style:Or({},p)}):null:(0,o.cloneElement)(u,{inView:m}))};Sr.propTypes={id:Ve().string,debounceTime:Ve().number,loading:Ve().bool,onLoad:Ve().func,loaderComponent:Ve().element},Sr.defaultProps={id:"",debounceTime:300,loading:!0,onLoad:function(){},loaderComponent:null};const Pr=Sr;var jr=n(32425);function Tr(e){return(Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kr(e,t){return(kr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xr(e,t){return!t||"object"!==Tr(t)&&"function"!=typeof t?Mr(e):t}function Mr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ar(e){return(Ar=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Dr=function(){return i().createElement("div",{className:"ms-media-loader"},i().createElement(jr.Z,{size:52}))},Nr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kr(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ar(r);if(o){var n=Ar(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return xr(this,e)});function c(){var e;Cr(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Rr(Mr(e=a.call.apply(a,[this].concat(n))),"state",{url:e.props.src||"",error:!1,loading:!0}),Rr(Mr(e),"updateURL",(function(t){var n=t.target.value;e.setState({url:n})})),Rr(Mr(e),"save",(function(){var t=e.state.url,n=!(0,mr.K2)(t,(0,yr.u8)("GeoStoryValidIframeURLRegex"));e.setState({error:n}),n||e.props.onChange(t)})),e}return t=c,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.editURL,o=this.state,a=o.url,c=o.error;return i().createElement(i().Fragment,null,i().createElement(Nn.Z,null,i().createElement(sr,{modal:!0,show:r,onClickOut:function(e){return e.preventDefault()&&e.stopPropagation()},title:i().createElement(pr.Z,{msgId:"geostory.webPageCreator.title"}),onClose:n,id:"web-page-creator",footer:i().createElement(Bn.Z,{bsSize:"small",onClick:this.save},i().createElement(pr.Z,{msgId:"geostory.webPageCreator.saveButton"}))},c&&i().createElement("div",{className:"dropzone-errorBox alert-danger"},i().createElement(pr.Z,{msgId:"geostory.webPageCreator.error"})),i().createElement(en.FormGroup,{controlId:"WEBPAGE_URL",validationState:c&&"error"},i().createElement(en.ControlLabel,null,i().createElement(pr.Z,{msgId:"geostory.webPageCreator.url.label"})),i().createElement(en.FormControl,{label:"URL",type:"text",value:a,onChange:this.updateURL,required:!0})))),this.props.lazy?i().createElement(Pr,{key:this.props.id,id:this.props.id,debounceTime:this.props.debounceTime,loading:this.state.loading,onLoad:function(){return e.setState({loading:!1})},loaderComponent:Dr},i().createElement(fr,this.props)):i().createElement(fr,this.props))}}])&&Ir(t.prototype,n),c}(i().PureComponent);Rr(Nr,"propTypes",{editURL:Ve().bool,onClose:Ve().func,onChange:Ve().func,src:Ve().string,id:Ve().string,debounceTime:Ve().number,lazy:Ve().bool}),Rr(Nr,"defaultProps",{lazy:!0});var Lr=(0,Me.compose)((0,Me.withHandlers)({onClose:function(e){var t=e.update,n=void 0===t?function(){}:t;return function(){return n("editURL",!1,"merge")}}}))(Nr);const _r=(0,a.connect)(null,{onChange:m.YM})(Lr);var Br=["type"];function Ur(){return(Ur=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var Fr=function(e){var t=e.type;return i().createElement("div",{className:"ms-content ms-content-unknown"},'warning: unknown content type "'.concat(t,'"'))};const Zr=function(e){var t=e.type,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Br),r=function(e){switch(e){case p.bT.TEXT:return Bt;case p.bT.MEDIA:case p.Tr.IMAGE:case p.Tr.MAP:case p.Tr.VIDEO:return rr;case p.bT.WEBPAGE:return _r;default:return Fr}}(t);return i().createElement(r,Ur({type:t},n))};var Wr=n(25288),Hr=n(80717);function Gr(e){return(Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var zr=["onClick"];function Vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vr(Object(n),!0).forEach((function(t){Jr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xr(e,t){return(Xr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yr(e,t){return!t||"object"!==Gr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qr(e){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xr(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Qr(r);if(o){var n=Qr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Yr(this,e)});function c(){return Kr(this,c),a.apply(this,arguments)}return t=c,(n=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){!this.trigger||e.containerWidth===this.props.containerWidth&&e.containerHeight===this.props.containerHeight||this.trigger.hide()}},{key:"render",value:function(){var e=this;return i().createElement(Wr.Z,{className:"add-bar",popoverClassName:"add-bar-popover",content:i().createElement(Hr.Z,{btnDefaultProps:{className:"square-button btn-tray"},buttons:this.props.buttons.map((function(t){var n=t.onClick,r=void 0===n?function(){}:n;return qr(qr({},function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,zr)),{},{onClick:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];r.apply(void 0,n),e.trigger.hide(),n[0]&&n[0].preventDefault&&n[0].preventDefault()}})}))}),ref:function(t){t&&(e.trigger=t.trigger)},placement:"top"},i().createElement(Bn.Z,{className:this.props.addButtonClassName},i().createElement(en.Glyphicon,{glyph:"plus"})))}}])&&$r(t.prototype,n),c}(i().Component);Jr(eo,"propTypes",{id:Ve().string,type:Ve().string,buttons:Ve().array,containerWidth:Ve().oneOfType([Ve().number,Ve().string]),containerHeight:Ve().oneOfType([Ve().number,Ve().string]),addButtonClassName:Ve().string}),Jr(eo,"defaultProps",{id:"",type:"",buttons:[],containerWidth:0,containerHeight:0,addButtonClassName:""});const to=eo;var no=["id"];function ro(e){return function(e){if(Array.isArray(e))return oo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return oo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oo(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function io(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ao(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?io(Object(n),!0).forEach((function(t){co(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):io(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function co(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lo(){return(lo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function uo(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const so=function(e){var t=e.viewWidth,n=e.viewHeight,r=e.className,o=e.contentProps,a=void 0===o?{}:o,c=e.addButtons,l=void 0===c?[]:c,u=e.tools,s=void 0===u?[]:u,d=e.contents,f=void 0===d?[]:d,m=e.ContentComponent,y=void 0===m?Zr:m,g=e.mode,v=e.sectionType,b=e.editMedia,h=void 0===b?function(){}:b,O=e.editWebPage,w=void 0===O?function(){}:O,E=e.add,S=void 0===E?function(){}:E,P=e.update,j=void 0===P?function(){}:P,T=e.remove,C=void 0===T?function(){}:T,I=e.bubblingTextEditing,k=void 0===I?function(){}:I,x=e.storyTheme,M=e.sections,A=void 0===M?[]:M,R=e.storyFonts,D=e.innerRef;return i().createElement("div",{ref:D,className:r},f.reduce((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0,o=r.id,c=uo(r,no),u=[i().createElement(y,lo({id:o,key:"".concat(o,"-content"),mode:g,viewWidth:t,sectionType:v,viewHeight:n,editMedia:function(e){for(var t=e.path,n=void 0===t?"":t,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return h.apply(void 0,[{path:'contents[{"id": "'.concat(o,'"}]')+n}].concat(i))},editWebPage:function(e){for(var t=e.path,n=void 0===t?"":t,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return w.apply(void 0,[{path:'contents[{"id": "'.concat(o,'"}]')+n}].concat(i))},add:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return S.apply(void 0,['contents[{"id": "'.concat(o,'"}].')+e].concat(n))},update:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return j.apply(void 0,['contents[{"id": "'.concat(o,'"}].')+e].concat(n))},remove:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return C.apply(void 0,['contents[{"id": "'.concat(o,'"}]')+(e?"."+e:"")].concat(n))}},a,c,{storyTheme:x,storyFonts:R,bubblingTextEditing:k,tools:s&&s[c.type],sections:A}))];return g===p.nl.EDIT&&l.length>0&&u.push(i().createElement(to,{key:"".concat(o,"-content-add-buttons"),containerWidth:t,containerHeight:n,buttons:l.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ao(ao({},e),{},{onClick:function(){return S("contents",o,e.template)}})}))})),[].concat(ro(e),u)}),[]))};n(66337);var po=["onVisibilityChange","rootSelector"],fo=["intersectionObserverOptions","onVisibilityChange"];function mo(){return(mo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function yo(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const go=function(e){return(0,Me.compose)((0,Me.withHandlers)({onVisibilityChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.onVisibilityChange,r=void 0===n?function(){}:n;return function(e,n){return r({id:t,visible:e,entry:n})}}}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onVisibilityChange,n=(e.rootSelector,yo(e,po));return function(e){return function(r){var o=r.intersectionObserverOptions,a=void 0===o?{}:o,c=r.onVisibilityChange,l=yo(r,fo),u=t||c;return i().createElement(gr.df,mo({},n,a,{onChange:u}),(function(t){var n=t.inView,r=t.ref,o=t.entry;return i().createElement(e,mo({},l,{inView:n,inViewRef:r,inViewEntry:o}))}))}}}(e))};var vo=n(90085),bo=n(12610),ho=n(23560),Oo=n.n(ho);function wo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Eo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Eo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Eo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var So=(0,bo.Z)(en.DropdownButton);function Po(e){var t=e.value,n=e.options,r=void 0===n?[]:n,a=e.onSelect,c=void 0===a?function(){}:a,l=e.glyph,u=void 0===l?"":l,s=e.tooltipId,p=e.pullRight,d=void 0!==p&&p,f=e.className,m=void 0===f?"square-button-md no-border":f,y=e.disabled,g=e.noTooltipWhenDisabled,v=void 0!==g&&g,b=e.hideMenuItem,h=void 0===b?function(){return!1}:b,O=e.shouldClose,w=wo((0,o.useState)(!1),2),E=w[0],S=w[1],j=wo((0,o.useState)(!1),2),T=j[0],C=j[1],I=(hn()(r,(function(e){return mn()(e.value,t)}))||{}).glyph;return(0,o.useEffect)((function(){y&&S(!1)}),[y]),i().createElement(So,{noCaret:!0,open:E,noTooltipWhenDisabled:v,tooltipId:s,pullRight:d,className:m,disabled:y,title:i().createElement(en.Glyphicon,{glyph:I||u}),onToggle:function(e,n,r){return T||"select"===(null==r?void 0:r.source)||O&&!O(t,n)?null:S(e)}},r.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(null==e?void 0:e.Component)||en.MenuItem;return h(t,e)?null:i().createElement(n,{key:e.value,selected:t,value:e.value,active:Oo()(null==e?void 0:e.isActive)&&e.isActive(t)||!P()(t)&&t===e.value,onClick:null!=e&&e.Component?c:function(){return c(e.value)},onActive:function(e){return C(e)}},e.label)})))}var jo=n(12122),To=n(11766),Co=n(13218),Io=n.n(Co);function ko(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ko(Object(n),!0).forEach((function(t){Mo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ko(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ao(){return(Ao=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var Ro=(0,jo.Z)(vo.Z),Do={primary:"btn-primary",default:"btn-default"},No=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.align,o=e.sectionType,a=e.size,c=e.update,l=void 0===c?function(){}:c,u=e.filterOptions,s=e.pullRight;return i().createElement(Po,{value:a,noTooltipWhenDisabled:!0,disabled:n,glyph:"resize-horizontal",pullRight:s||("right"===r||"full"===a||"large"===a)&&!o,tooltipId:"geostory.contentToolbar.contentSize",options:[{value:"small",glyph:"size-small",label:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.smallSizeLabel"})},{value:"medium",glyph:"size-medium",label:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.mediumSizeLabel"})},{value:"large",glyph:"size-large",label:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.largeSizeLabel"})},{value:"full",glyph:"size-extra-large",label:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.fullSizeLabel"})}].filter((function(e){return!u||u(e)})),onSelect:function(e){return l("size",e)}})},Lo=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.align,o=e.sectionType,a=e.size,c=e.update,l=void 0===c?function(){}:c;return i().createElement(Po,{value:r,noTooltipWhenDisabled:!0,disabled:"full"===a||n,glyph:"align-center",pullRight:("right"===r||"full"===a||"large"===a)&&!o,tooltipId:"geostory.contentToolbar.contentAlign",options:[{value:"left",label:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.leftAlignLabel"}),glyph:"align-left"},{value:"center",label:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.centerAlignLabel"}),glyph:"align-center"},{value:"right",label:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.rightAlignLabel"}),glyph:"align-right"}],onSelect:function(e){return l("align",e)}})},_o=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.theme,o=e.storyTheme,a=e.align,c=e.sectionType,l=e.update,u=void 0===l?function(){}:l,s=e.themeProps,p=e.size;return i().createElement(Po,{value:r,noTooltipWhenDisabled:!0,pullRight:("right"===a||"full"===p||"large"===p)&&!c,glyph:"dropper",tooltipId:"geostory.contentToolbar.contentTheme",disabled:n,shouldClose:function(e,t){var n,r;return Io()(e)&&"ms-color-picker-cover"!==(null==t||null===(n=t.target)||void 0===n||null===(r=n.getAttribute)||void 0===r?void 0:r.call(n,"class"))||E()(e)||void 0===e},hideMenuItem:function(e,t){return"custom"===(null==e?void 0:e.value)&&"custom"!==(null==t?void 0:t.value)},options:[{value:"",isActive:function(e){return void 0===e||""===e||Io()(e)&&(void 0===e.value||""===e.value)},label:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.defaultThemeLabel"})},{value:"bright",isActive:function(e){return"bright"===(null==e?void 0:e.value)||"bright"===e},label:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.brightThemeLabel"})},{value:"dark",isActive:function(e){return"dark"===(null==e?void 0:e.value)||"dark"===e},label:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.darkThemeLabel"})},{value:"custom",Component:function(e){return i().createElement(To.H,Ao({},e,{disableBackgroundAlpha:null==s?void 0:s.disableBackgroundAlpha,disableShadow:null==s?void 0:s.disableShadow,disableTextColor:null==s?void 0:s.disableTextColor,onUpdate:u,storyTheme:o}))}}],onSelect:function(e){return u("theme",xo(xo({},Io()(r)&&r),{},{value:e}))}})},Bo=function(e){var t=e.editMap,n=void 0!==t&&t,r=e.forceDelBtnDisable,o=void 0!==r&&r,a=e.path,c=e.remove,l=void 0===c?function(){}:c,u=e.bsStyle;return i().createElement(Ro,{glyph:"trash",visible:!0,noTooltipWhenDisabled:!0,disabled:n||o,className:"".concat("square-button-md no-border"," ").concat(u&&Do[u]),tooltipId:"geostory.contentToolbar.remove",confirmTitle:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.removeConfirmTitle"}),confirmContent:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.removeConfirmContent"}),onClick:function(){l(a)}})},Uo=["tools","children"];function Fo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fo(Object(n),!0).forEach((function(t){Wo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ho={size:function(e){return{renderButton:i().createElement(No,e)}},align:function(e){return{renderButton:i().createElement(Lo,e)}},theme:function(e){return{renderButton:i().createElement(_o,e)}},fit:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.fit,o=e.update,i=void 0===o?function(){}:o;return{value:r,glyph:"contain"===r?"fit-cover":"fit-contain",disabled:n,visible:!0,tooltipId:"contain"===r?"geostory.contentToolbar.cover":"geostory.contentToolbar.fit",onClick:function(){return i("fit","contain"===r?"cover":"contain")}}},cover:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.cover,o=e.updateSection,i=void 0===o?function(){}:o;return{value:r,glyph:r?"height-auto":"height-view",visible:!0,disabled:n,tooltipId:r?"geostory.contentToolbar.contentHeightAuto":"geostory.contentToolbar.contentHeightView",onClick:function(){return i({cover:!r},"merge")}}},editMedia:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.path,o=e.editMedia,i=void 0===o?function(){}:o,a=e.sectionType;return{glyph:"pencil","data-button":"pencil",visible:!0,disabled:n,tooltipId:"geostory.contentToolbar.editMedia",onClick:function(){i({path:r},r?a:"")}}},remove:function(e){return{renderButton:i().createElement(Bo,e)}},editMap:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.update,o=void 0===r?function(){}:r;return{glyph:"map-edit",visible:!0,disabled:n,bsStyle:n?"success":"default",tooltipId:"geostory.contentToolbar.editMap",onClick:function(){o("editMap",!n)}}},editURL:function(e){var t=e.editURL,n=void 0!==t&&t,r=e.path,o=e.editWebPage,i=void 0===o?function(){}:o;return{glyph:"pencil",visible:!0,disabled:n,bsStyle:n?"success":"default",tooltipId:"geostory.contentToolbar.editURL",onClick:function(){i({path:r})}}},muted:function(e){var t=e.update,n=e.muted;return{glyph:n?"muted":"audio",visible:!0,active:!n,tooltipId:n?"geostory.contentToolbar.enableAudio":"geostory.contentToolbar.disableAudio",onClick:function(){t("muted",!n)}}},autoplay:function(e){var t=e.update,n=e.autoplay;return{glyph:"play-circle",visible:!("cover"===e.fit),active:n,tooltipId:n?"geostory.contentToolbar.disableAutoplay":"geostory.contentToolbar.enableAutoplay",onClick:function(){t("autoplay",!n)}}},loop:function(e){var t=e.update,n=e.loop;return{glyph:"loop",visible:!("cover"===e.fit),active:n,tooltipId:n?"geostory.contentToolbar.disableLoop":"geostory.contentToolbar.enableLoop",onClick:function(){t("loop",!n)}}},showCaption:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.update,o=e.showCaption,i=e.caption,a=e.description;return{glyph:"caption",visible:!(!i&&!a),disabled:n,active:!(!o||n),tooltipId:o?"geostory.contentToolbar.hideCaption":"geostory.contentToolbar.showCaption",onClick:function(){r("showCaption",!o)}}},add:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.addDisabled,o=void 0!==r&&r,i=e.add,a=void 0===i?function(){}:i,c=e.bsStyle;return{glyph:"plus",visible:!0,bsStyle:void 0===c?"default":c,tooltipId:"geostory.contentToolbar.add",disabled:n||o,onClick:a}},edit:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.edit,o=void 0===r?function(){}:r,i=e.bsStyle;return{glyph:"pencil",visible:!0,bsStyle:void 0===i?"default":i,tooltipId:"geostory.contentToolbar.edit",disabled:n,onClick:o}},marker:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.markerDisabled,o=void 0!==r&&r,i=e.marker,a=void 0===i?function(){}:i,c=e.bsStyle;return{glyph:"map-marker",visible:!0,tooltipId:"geostory.contentToolbar.marker",bsStyle:void 0===c?"default":c,disabled:n||o,onClick:a}},closeDraw:function(e){var t=e.editMap,n=void 0!==t&&t,r=e.bsStyle,o=void 0===r?"default":r,i=e.update,a=void 0===i?function(){}:i,c=e.onEnableDraw,l=void 0===c?function(){}:c;return{glyph:"1-close",visible:!0,tooltipId:"geostory.contentToolbar.closeMapEditing",bsStyle:o,disabled:!n,onClick:function(){l(null),a("editMap",!n)}}}};function Go(e){var t=e.tools,n=void 0===t?[]:t,r=e.children,o=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Uo);return i().createElement("div",{className:"ms-content-toolbar"},i().createElement(Hr.Z,{btnDefaultProps:{className:"square-button-md no-border",noTooltipWhenDisabled:!0},buttons:n.filter((function(e){return(null==e?void 0:e.id)&&Ho[e.id]||Ho[e]})).map((function(e){return(null==e?void 0:e.id)&&Ho[e.id](Zo(Zo({},o),e))||Ho[e](o)}))}),r)}var zo=["id","inViewRef","innerRef","children","type","contentWrapperStyle","contentToolbar","mode"];function Vo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vo(Object(n),!0).forEach((function(t){Ko(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ko(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const $o=function(e){var t=e.id,n=e.inViewRef,r=e.innerRef,o=e.children,a=e.type,c=e.contentWrapperStyle,l=e.contentToolbar,u=e.mode,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,zo),d=l||Go;return i().createElement("div",{id:t,ref:n,style:qo(qo({},c),s.hideContent&&{display:"none"}),className:"ms-content ms-content-".concat(a).concat((0,p.w)(s))},i().createElement("div",{className:"ms-content-body",ref:r,style:(0,p.cy)(s)},u===p.nl.EDIT&&i().createElement(d,s),o))};function Xo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Yo=(0,Me.compose)(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return Me.nest.apply(void 0,t.concat([e]))}}($o),(0,Me.setDisplayName)("ColumnContent"))(Zr),Qo=function(e){return{id:"size",filterOptions:function(e){return"full"!==e.value},pullRight:e}};const Jo=(0,Me.compose)((0,Me.branch)((function(e){var t=e.type,n=e.sectionType;return[p.ID.IMMERSIVE,p.ID.CAROUSEL].includes(n)&&t===p.bT.COLUMN}),go({threshold:[0,.25,.5,.75]})),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return Me.nest.apply(void 0,t.concat([e]))}}($o),(0,Me.setDisplayName)("SectionContent"),(0,Me.branch)((function(e){return e.type===p.bT.COLUMN}),(0,Me.renderComponent)((function(e){var t,n=e.viewWidth,r=e.viewHeight,o=e.contents,a=void 0===o?[]:o,c=e.mode,l=e.add,u=void 0===l?function(){}:l,s=e.editMedia,d=void 0===s?function(){}:s,f=e.editWebPage,m=void 0===f?function(){}:f,y=e.update,g=void 0===y?function(){}:y,v=e.remove,b=void 0===v?function(){}:v,h=e.bubblingTextEditing,O=void 0===h?function(){}:h,w=e.expandable,E=e.mediaViewer,S=e.contentToolbar,P=e.sections,j=void 0===P?[]:P,T=e.sectionType,C=e.overrideTools,I=void 0===C?function(e){return e}:C,k=e.storyFonts;return i().createElement(so,{className:"ms-column-contents",ContentComponent:Yo,contents:a,mode:c,add:u,editMedia:d,editWebPage:m,update:g,remove:b,viewWidth:n,viewHeight:r,bubblingTextEditing:O,sectionType:T,contentProps:{expandable:w,mediaViewer:E,contentToolbar:S},sections:j,storyFonts:k,tools:I((t={},Xo(t,p.bT.TEXT,["remove"]),Xo(t,p.Tr.IMAGE,["editMedia",Qo(),"showCaption","remove"]),Xo(t,p.Tr.MAP,["editMedia","editMap",Qo(!0),"showCaption","remove"]),Xo(t,p.bT.WEBPAGE,["editURL",Qo(!0),"remove"]),Xo(t,p.Tr.VIDEO,["editMedia","muted","autoplay","loop","showCaption","remove"]),t)),addButtons:[{glyph:"sheet",tooltipId:"geostory.addTextContent",template:p.bT.TEXT},{glyph:"picture",tooltipId:"geostory.addMediaContent",template:p.bT.MEDIA},{glyph:"webpage",tooltipId:"geostory.addWebPageContent",template:p.bT.WEBPAGE}]})}))))(Zr),ei=(0,Me.compose)((0,Me.defaultProps)({ContentComponent:Jo}),(0,Me.withHandlers)({editMedia:function(e){var t=e.editMedia,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=e.path,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return n.apply(void 0,[{path:'sections[{"id": "'.concat(r,'"}].')+t}].concat(i))}},editWebPage:function(e){var t=e.editWebPage,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=e.path,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return n.apply(void 0,[{path:'sections[{"id": "'.concat(r,'"}].')+t}].concat(i))}},add:function(e){var t=e.add,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}},update:function(e){var t=e.update,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}},remove:function(e){var t=e.remove,n=void 0===t?function(){}:t,r=e.sectionId;return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];return n.apply(void 0,['sections[{"id": "'.concat(r,'"}].')+e].concat(o))}}}),(0,Me.setDisplayName)("SectionContents"))(so);var ti=n(30998),ni=n.n(ti),ri=n(84753),oi=n.n(ri);function ii(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ai(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ci(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ai(Object(n),!0).forEach((function(t){li(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ai(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function li(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(0,Me.setObservableConfig)(Ae.Z);var ui=function(e,t){var n=ni()(e,{id:t});return e[-1!==n&&n?n:0]},si=(0,Me.withProps)((function(e){var t=e.id,n=e.backgroundId,r=e.contents,o=ui(void 0===r?[]:r,n)||{},i=o&&o.id;return{background:x()(o,"background")||{type:"none"},contentId:i,sectionId:t,path:'sections[{"id": "'.concat(t,'"}].contents[{"id": "').concat(i,'"}].background')}})),pi=(0,Me.withHandlers)({updateBackground:function(e){var t=e.sectionId,n=e.contentId,r=e.update,o=void 0===r?function(){}:r;return function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return o.apply(void 0,['sections[{"id": "'.concat(t,'"}].contents[{"id": "').concat(n,'"}].background.')+e].concat(i))}},updateSection:function(e){var t=e.sectionId,n=e.update,r=void 0===n?function(){}:n;return function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return r.apply(void 0,['sections[{"id": "'.concat(t,'"}]')].concat(n))}}}),di=(0,Me.compose)(si,pi),fi=(0,Me.mapPropsStream)((function(e){var t=(0,Me.createEventHandler)(),n=t.handler,r=t.stream;return g.Observable.combineLatest(e,function(e,t){var n=e.scan((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.visible,o=t.entry;return ci(ci({},e),{},li({},n,{visible:r,entry:o}))}),{}).debounceTime(100).map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{maxItem:oi()(Object.keys(e),(function(t){return e[t].visible?x()(e[t],"entry.intersectionRatio"):-1/0})),items:e}}));return g.Observable.merge(n.pluck("maxItem").distinctUntilChanged().map((function(e){return{backgroundId:e}})),n.map((function(e){var t=e.maxItem,n=e.items;return 0===x()(n[t],"entry.intersectionRatio")?"EMPTY":t})).withLatestFrom(t.pluck("updateCurrentPage")).do((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return ii(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ii(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];return i&&i({columnId:o})})).ignoreElements())}(r,e).startWith({}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ci(ci({},t.reduce((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return ci(ci({},e),t)}),{})),{},{onVisibilityChange:n})}))}));const mi=(0,Me.compose)(fi,di);var yi=n(89438);function gi(e){return(gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vi(){return(vi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function bi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bi(Object(n),!0).forEach((function(t){Ti(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ei(e,t){return(Ei=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Si(e,t){return!t||"object"!==gi(t)&&"function"!=typeof t?Pi(e):t}function Pi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ji(e){return(ji=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ti(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ci=n(56936),Ii=n(83255),ki=n.n(Ii);function xi(e){return(xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ai(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mi(Object(n),!0).forEach((function(t){Ui(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ri(){return(Ri=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Di(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ni(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Li(e,t){return(Li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _i(e,t){return!t||"object"!==xi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bi(e){return(Bi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ui(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Li(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Bi(r);if(o){var n=Bi(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _i(this,e)});function c(){return Di(this,c),a.apply(this,arguments)}return t=c,(n=[{key:"render",value:function(){var e=(0,p.cy)(this.props),t=!this.props.disableToolbarPortal&&this.refs&&this.refs.div&&this.refs.div.parentNode,n=this.props.sectionType===p.ID.TITLE?["editMedia","cover"]:["editMedia"],r=this.props.contentToolbar||Go,o=i().createElement(r,Ri({},this.props,{themeProps:{disableBackgroundAlpha:!0,disableTextColor:!0,disableShadow:!0},tools:this.props.tools&&this.props.type&&this.props.tools[this.props.type]||this.props.sectionType===p.ID.BANNER&&[].concat(n,["cover","remove"])||n}),this.props.contentToolbarChildren),a="".concat(this.props.sectionId||"ms","-media-").concat(this.props.id||this.props.resourceId);return i().createElement("div",{ref:"div",className:"ms-section-background",style:Ai({},this.props.style)},i().createElement("div",{className:"ms-section-background-container".concat((0,p.w)(this.props)),ref:this.props.innerRef,style:Ai(Ai({height:this.props.height},e),null!=tr&&tr[this.props.type]?{}:this.props.backgroundPlaceholder)},i().createElement(rr,Ri({id:a},this.props,{enableFullscreen:!1,descriptionEnabled:!1,mediaViewer:this.props.mediaViewer,containerInView:this.props.inView}),this.props.children),this.props.mode===p.nl.EDIT&&(t?i().createElement(Ci.h_,{container:t},o):o)))}}])&&Ni(t.prototype,n),c}(o.Component);Ui(Fi,"propTypes",{id:Ve().string,resourceId:Ve().string,sectionId:Ve().string,mode:Ve().string,fit:Ve().string,size:Ve().string,path:Ve().string,credits:Ve().string,description:Ve().string,height:Ve().number,width:Ve().number,tools:Ve().object,style:Ve().object,add:Ve().func,editMedia:Ve().func,update:Ve().func,updateSection:Ve().func,remove:Ve().func,type:Ve().oneOf(p.lg.MediaTypes),disableToolbarPortal:Ve().bool,backgroundPlaceholder:Ve().object,sectionType:Ve().string,src:Ve().string,theme:Ve().string,mediaViewer:Ve().func,contentToolbar:Ve().func,inView:Ve().bool,sections:Ve().array,innerRef:Ve().func,contentToolbarChildren:Ve().node}),Ui(Fi,"defaultProps",{height:0,size:"full",width:0,style:{},backgroundPlaceholder:{background:"url(".concat(ki(),")"),backgroundSize:"256px auto"}});const Zi=(Wi=Fi,Gi=Hi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ei(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ji(r);if(o){var n=ji(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Si(this,e)});function c(){var e;Oi(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ti(Pi(e=a.call.apply(a,[this].concat(n))),"state",{style:{}}),Ti(Pi(e),"update",(function(t){if(e._stickybits){var n=document.querySelector(t);-1===e._stickybits.definePosition().indexOf("sticky")&&n&&(e._stickybits.update(),setTimeout((function(){var t=n.getBoundingClientRect(),r=t.top,o=t.left;e.setState({style:{top:r,left:o,width:n.scrollWidth-2}})})))}})),e}return t=c,(n=[{key:"componentDidMount",value:function(){this._stickybits=this._node&&(0,yi.Z)(this._node,{scrollEl:this.props.scrollContainerSelector,noStyles:!0,useGetBoundingClientRect:!0}),this.update(this.props.scrollContainerSelector)}},{key:"componentWillReceiveProps",value:function(e){!this._stickybits||e.viewWidth===this.props.viewWidth&&e.viewHeight===this.props.viewHeight||this.update(e.scrollContainerSelector)}},{key:"componentWillUnmount",value:function(){this._stickybits&&this._stickybits.cleanup()}},{key:"render",value:function(){var e=this;return i().createElement(Wi,vi({ref:function(t){t&&t.refs&&t.refs[e.props.refId]&&(e._node=t.refs[e.props.refId])},style:hi({},this.state.style)},this.props),this.props.children)}}])&&wi(t.prototype,n),c}(o.Component),Ti(Hi,"propTypes",{scrollContainerSelector:Ve().string,height:Ve().number,width:Ve().number,refId:Ve().string}),Ti(Hi,"defaultProps",{scrollContainerSelector:"body",height:0,width:0,refId:"div"}),Gi);var Wi,Hi,Gi,zi=n(11636),Vi=n.n(zi);function qi(){return(qi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ki(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const $i=(0,Me.compose)(mi,(0,Me.withStateHandlers)({textEditorActive:!1},{bubblingTextEditing:function(){return function(e){return{textEditorActiveClass:e?" ms-text-editor-active":""}}}}))((function(e){var t,n=e.add,r=void 0===n?function(){}:n,o=e.editMedia,a=void 0===o?function(){}:o,c=e.editWebPage,l=void 0===c?function(){}:c,u=e.onVisibilityChange,s=void 0===u?function(){}:u,d=e.update,f=void 0===d?function(){}:d,m=e.updateBackground,y=void 0===m?function(){}:m,g=e.updateCurrentPage,v=void 0===g?function(){}:g,b=e.remove,h=void 0===b?function(){}:b,O=e.id,w=e.background,E=void 0===w?{}:w,S=e.path,P=e.contents,j=void 0===P?[]:P,T=e.mode,C=e.sectionType,I=e.inViewRef,k=e.viewWidth,M=e.viewHeight,A=e.focusedContent,R=e.contentId,D=e.bubblingTextEditing,N=void 0===D?function(){}:D,L=e.textEditorActiveClass,_=void 0===L?"":L,B=e.expandableMedia,U=void 0!==B&&B,F=e.storyTheme,Z=e.mediaViewer,W=e.contentToolbar,H=e.inView,G=e.sections,z=void 0===G?[]:G,V=e.storyFonts,q=A&&A.hideContent&&x()(A,"target.id")===R,K=q?"hidden":"visible",$=U&&E&&"map"===E.type?" ms-expandable-background":"",X=(null==F?void 0:F.overlay)||{},Y=(null==F?void 0:F.general)||{};return i().createElement("section",{className:"ms-section ms-section-immersive".concat($),id:O,ref:I},i().createElement(Zi,qi({},E,{mode:T,disableToolbarPortal:!0,tools:(t={},Ki(t,p.Tr.IMAGE,["editMedia","fit","size","align","theme"]),Ki(t,p.Tr.MAP,["editMedia","editMap","size","align","theme"]),Ki(t,p.Tr.VIDEO,["editMedia","fit","size","align","theme","muted","autoplay","loop"]),t),scrollContainerSelector:"#ms-sections-container",add:r,editMedia:a,expandable:U,path:S,update:y,updateCurrentPage:v,remove:h,sectionType:C,sectionId:O,backgroundId:E.id,key:E.id,width:k,height:M,backgroundPlaceholder:{background:"url(".concat(Vi(),")"),backgroundSize:"600px auto"},storyTheme:Y,mediaViewer:Z,contentToolbar:W,inView:H})),i().createElement(ei,{tools:Ki({},p.bT.COLUMN,["size","align","theme"]),className:"ms-section-contents".concat(_),contents:j,mode:T,add:r,updateCurrentPage:v,editMedia:a,editWebPage:l,update:f,remove:h,sectionId:O,viewWidth:k,viewHeight:M,contentProps:{onVisibilityChange:s,contentWrapperStyle:{minHeight:M,visibility:K},expandable:U,mediaViewer:Z,contentToolbar:W},focusedContent:A,bubblingTextEditing:N,sectionType:C,storyTheme:X,sections:z,storyFonts:V}),T===p.nl.EDIT&&!q&&i().createElement(to,{containerWidth:k,containerHeight:M,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){r("sections",O,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){r("sections",O,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){r("sections",O,p.ID.PARAGRAPH)}},{glyph:"story-immersive-content",tooltipId:"geostory.addImmersiveContent",onClick:function(){r('sections[{"id": "'.concat(O,'"}].contents'),void 0,p.bT.COLUMN,"geostory.builder.defaults.titleImmersiveContent")}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){r("sections",O,p.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){r("sections",O,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){r("sections",O,p.tQ.WEBPAGE)}}]}))}));function Xi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xi(Object(n),!0).forEach((function(t){Qi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ji=function(e){var t=e.id,n=e.contents,r=e.mode,o=e.add,a=void 0===o?function(){}:o,c=e.update,l=void 0===c?function(){}:c,u=e.editMedia,s=void 0===u?function(){}:u,d=e.editWebPage,f=void 0===d?function(){}:d,m=e.remove,y=void 0===m?function(){}:m,g=e.inViewRef,v=e.viewWidth,b=e.viewHeight,h=e.expandableMedia,O=e.mediaViewer,w=e.contentToolbar,E=e.sections,S=void 0===E?[]:E,P=e.sectionType,j=e.storyFonts;return i().createElement("section",{className:"ms-section ms-section-paragraph",id:t,ref:g},i().createElement(ei,{className:"ms-section-contents",contents:n,mode:r,add:a,editMedia:s,editWebPage:f,update:l,remove:y,sectionId:t,viewWidth:v,viewHeight:b,sectionType:P,contentProps:{expandable:h,mediaViewer:O,contentToolbar:w,overrideTools:function(e){return Yi(Yi({},e),{},Qi({},p.bT.TEXT,[(!0,{id:"size",filterOptions:function(e){return"full"!==e.value},pullRight:true}),"remove"]))}},sections:S,storyFonts:j}),r===p.nl.EDIT&&i().createElement(to,{containerWidth:v,containerHeight:b,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){a("sections",t,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){a("sections",t,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){a("sections",t,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){a("sections",t,p.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){a("sections",t,p.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){a("sections",t,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){a("sections",t,p.tQ.WEBPAGE)}}]}))};var ea=n(75492),ta=n.n(ea);function na(){return(na=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ra(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const oa=(0,Me.compose)(di,(0,Me.withStateHandlers)({textEditorActive:!1},{bubblingTextEditing:function(){return function(e){return{textEditorActiveClass:e?" ms-text-editor-active":""}}}}))((function(e){var t=e.id,n=e.background,r=void 0===n?{}:n,o=e.contents,a=void 0===o?[]:o,c=e.mode,l=e.contentId,u=e.path,s=e.sectionType,d=e.cover,f=e.viewWidth,m=e.viewHeight,y=e.inViewRef,g=e.add,v=void 0===g?function(){}:g,b=e.update,h=void 0===b?function(){}:b,O=e.updateSection,w=void 0===O?function(){}:O,E=e.remove,S=void 0===E?function(){}:E,P=e.updateBackground,j=void 0===P?function(){}:P,T=e.editMedia,C=void 0===T?function(){}:T,I=e.focusedContent,k=e.bubblingTextEditing,M=void 0===k?function(){}:k,A=e.textEditorActiveClass,R=void 0===A?"":A,D=e.expandableMedia,N=void 0!==D&&D,L=e.storyTheme,_=e.mediaViewer,B=e.contentToolbar,U=e.inView,F=e.sections,Z=void 0===F?[]:F,W=e.storyFonts,H=x()(I,"target.id")===l,G=H?"hidden":"visible",z=N&&r&&"map"===r.type?" ms-expandable-background":"",V=(null==L?void 0:L.overlay)||{},q=(null==L?void 0:L.general)||{};return i().createElement("section",{ref:y,className:"ms-section ms-section-title".concat(z),id:t},i().createElement(xe.Z,null,(function(e){var t,n=e.height;return i().createElement(Zi,na({},r,{scrollContainerSelector:"#ms-sections-container",key:r.id,mode:c,id:l,path:u,update:j,add:v,editMedia:C,expandable:N,updateSection:w,cover:d,remove:S,width:f,sectionType:s,backgroundPlaceholder:{background:"url(".concat(d?ki():ta(),")"),backgroundSize:"".concat(d?64:600,"px auto")},tools:(t={},ra(t,p.Tr.IMAGE,["editMedia","cover","fit","size","align","theme"]),ra(t,p.Tr.MAP,["editMedia","cover","editMap","size","align","theme"]),ra(t,p.Tr.VIDEO,["editMedia","cover","fit","size","align","theme","muted","autoplay","loop"]),t),height:n>=m?m:n,storyTheme:q,mediaViewer:_,contentToolbar:B,inView:U}))})),i().createElement(ei,{className:"ms-section-contents".concat(R),contents:a,mode:c,add:v,sectionType:s,update:h,remove:S,sectionId:t,contentProps:{contentWrapperStyle:d?{minHeight:m,visibility:G}:{visibility:G},mediaViewer:_,contentToolbar:B},tools:ra({},p.bT.TEXT,["size","align","theme","remove"]),focusedContent:I,bubblingTextEditing:M,storyTheme:V,sections:Z,storyFonts:W}),c===p.nl.EDIT&&!H&&i().createElement(to,{containerWidth:f,containerHeight:m,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){v("sections",t,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){v("sections",t,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){v("sections",t,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){v("sections",t,p.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){v("sections",t,p.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){v("sections",t,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){v("sections",t,p.tQ.WEBPAGE)}}]}))}));function ia(){return(ia=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function aa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ca=(0,Me.compose)(di,(0,Me.withStateHandlers)({textEditorActive:!1}))((function(e){var t=e.id,n=e.background,r=void 0===n?{}:n,o=e.mode,a=e.contentId,c=e.path,l=e.sectionType,u=void 0===l?p.ID.BANNER:l,s=e.cover,d=e.viewWidth,f=e.viewHeight,m=e.inViewRef,y=e.add,g=void 0===y?function(){}:y,v=e.updateSection,b=void 0===v?function(){}:v,h=e.remove,O=void 0===h?function(){}:h,w=e.updateBackground,E=void 0===w?function(){}:w,S=e.editMedia,P=void 0===S?function(){}:S,j=e.focusedContent,T=e.expandableMedia,C=void 0!==T&&T,I=e.storyTheme,k=e.mediaViewer,M=e.contentToolbar,A=e.inView,R=x()(j,"target.id")===a,D=C&&r&&"map"===r.type?" ms-expandable-background":"",N=c.replace(".background","");return i().createElement("section",{ref:m,className:"ms-section ms-section-banner".concat(D),id:t},i().createElement(xe.Z,null,(function(e){var t,n=e.height;return i().createElement(Zi,ia({},r,{scrollContainerSelector:"#ms-sections-container",key:r.id,mode:o,id:a,path:c,update:E,add:g,editMedia:P,expandable:C,updateSection:b,cover:s,remove:function(){return O(N)},width:d,sectionType:u,backgroundPlaceholder:{background:"url(".concat(s?ki():ta(),")"),backgroundSize:"".concat(s?64:600,"px auto")},tools:(t={},aa(t,p.Tr.IMAGE,["editMedia","cover","fit","size","align","theme","remove"]),aa(t,p.Tr.MAP,["editMedia","cover","editMap","size","align","theme","remove"]),aa(t,p.Tr.VIDEO,["editMedia","cover","fit","size","align","theme","muted","autoplay","loop","remove"]),t),height:n>=f?f:n,storyTheme:I,mediaViewer:k,contentToolbar:M,inView:A}))})),i().createElement("div",{style:{minHeight:s?f:300,pointerEvents:"none"}}),o===p.nl.EDIT&&!R&&i().createElement(to,{containerWidth:d,containerHeight:f,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){g("sections",t,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){g("sections",t,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){g("sections",t,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){g("sections",t,p.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){g("sections",t,p.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){g("sections",t,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){g("sections",t,p.tQ.WEBPAGE)}}]}))}));var la=n(71335),ua=n(94745);function sa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return pa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pa(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var da=(0,qe.Z)("placeholder")(en.FormControl);const fa=function(e){var t,n,r,a=sa((0,o.useState)([]),2),c=a[0],l=a[1],u=sa((0,o.useState)({data:null==e||null===(t=e.thumbnail)||void 0===t?void 0:t.image}),2),s=u[0],p=u[1],d=sa((0,o.useState)(null==e?void 0:e.title),2),f=d[0],m=d[1];return i().createElement(ua.Z,{fitContent:!0,title:i().createElement(pr.Z,{msgId:e.editing?"geostory.carouselEditTitle":"geostory.carouselAddTitle"}),show:!0,fade:!0,clickOutEnabled:!1,bodyClassName:"ms-flex modal-properties-container background-dialog",onClose:e.onClose,buttons:e.loading?[]:[{text:i().createElement(pr.Z,{msgId:e.editing?"save":"backgroundDialog.add"}),bsStyle:"primary",onClick:function(){e.update("thumbnail",{image:s.data}),e.update("title",f),e.onClose()}}]},i().createElement(en.Form,{style:{width:"100%"}},(r={FORMAT:i().createElement(pr.Z,{msgId:"map.errorFormat"}),SIZE:i().createElement(pr.Z,{msgId:"map.errorSize"})},c.length>0?i().createElement("div",{className:"dropzone-errorBox alert-danger"},i().createElement("p",null,i().createElement(pr.Z,{msgId:"map.error"})),c.map((function(e){return i().createElement("div",{id:"error"+e,key:"error"+e,className:"error"+e},r[e])}))):null),i().createElement(la.Z,{onUpdate:function(e,t){return p({data:e,url:t})},onError:function(e){return l(e)},message:i().createElement(pr.Z,{msgId:"backgroundDialog.thumbnailMessage"}),suggestion:"",map:{newThumbnail:x()(s,"url")||(null===(n=e.thumbnail)||void 0===n?void 0:n.image)||"NODATA"}}),i().createElement(en.FormGroup,null,i().createElement(en.ControlLabel,null,i().createElement(pr.Z,{msgId:"layerProperties.title"})),i().createElement(da,{value:f,placeholder:"backgroundDialog.titlePlaceholder",onChange:function(e){return m(e.target.value)}}))))};var ma=n(25311),ya=n(45567),ga=n(55877),va=n.n(ga),ba=n(73723),ha=n.n(ba),Oa=n(15402);const wa=function(e){return t=e.type,n="",r="","addMap"===t?(n="ms-carousel-map-info",r="geostory.carouselAddMapInfo"):"addMarker"===t?(n="ms-carousel-marker-info",r="geostory.carouselPlaceMarkerInfo"):(n="ms-carousel-add-info",r="geostory.carouselAddItemInfo"),i().createElement("div",{className:n},i().createElement(Oa.Z,{msgId:r}));var t,n,r};var Ea=n(81593),Sa=["title","thumbnail","index","isSelected"],Pa=["onSort","sectionId","contents","onEnableDraw","isEditMap","isDrawEnabled"];function ja(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ta(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ja(Object(n),!0).forEach((function(t){Ca(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ja(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ca(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ia(){return(Ia=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ka(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return xa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xa(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ma(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Aa=(0,ma.Z)((function(e){var t=e.title,n=e.thumbnail,r=e.index,o=e.isSelected,a=Ma(e,Sa),c=i().createElement("div",{className:Ye()("ms-geo-carousel-item",{"ms-geo-carousel-item-selected":o}),onClick:a.onClick},i().createElement("div",{className:"ms-geo-carousel-item-inner-wrapper",style:{backgroundImage:"url(".concat((null==n?void 0:n.image)||ha(),")")}},i().createElement("span",{className:"ms-geo-carousel-item-inner"},t||"Item ".concat(r+1)),i().createElement("span",{className:"ms-geo-carousel-item-inner-index"},r+1)));return a.isDraggable&&a.connectDragSource?a.connectDragSource(c):c})),Ra=(0,ya.Z)((function(e){var t=e.mode,n=e.add,r=e.update,a=void 0===r?function(){}:r,c=e.remove,l=e.sectionId,u=e.isMapBackground,s=e.contentId,d=e.items,f=e.contentToolbar,m=void 0===f?Go:f,y=e.cardComponent,g=e.containerWidth,v=e.isDrawEnabled,b=e.onEnableDraw,h=e.isEditMap,O=e.innerRef,w=e.deltaSwipeSize,E=void 0===w?200:w,S=e.transition,P=void 0===S?300:S,j=e.style,T=e.controlStyle,C=ka((0,o.useState)(!1),2),I=C[0],k=C[1],x=ka((0,o.useState)(void 0),2),M=x[0],A=x[1],R=ka((0,o.useState)(""),2),N=R[0],L=R[1],_=ka((0,o.useState)({}),2),B=_[0],U=_[1],F=(0,Ea.Z)({direction:"horizontal",width:g,deltaScroll:E,transition:P},[d.length]),Z=F.isStartControlActive,W=F.isEndControlActive,H=F.containerPropsHandlers,G=F.contentPropsHandlers,z=F.itemPropsHandlers,V=F.moveToDeltaSize,q=F.moveItemInViewById,K=t===p.nl.EDIT;(0,o.useEffect)((function(){s&&q(s,{margin:32})}),[s]);var $=!(u&&!hn()(d,(function(e){var t;return 0===((null==e||null===(t=e.features)||void 0===t?void 0:t.length)||0)})));return i().createElement(i().Fragment,null,i().createElement("div",{ref:O,style:j,className:"ms-geo-carousel"},K&&1===d.length&&$&&!h&&i().createElement(wa,{type:"addInfo"}),h&&K&&v&&!!hn()(d,(function(e){var t;return e.id===s&&0===((null==e||null===(t=e.features)||void 0===t?void 0:t.length)||0)}))&&i().createElement(wa,{type:"addMarker"}),K&&i().createElement(m,{addDisabled:$,add:n,editMap:h,remove:function(){return c('sections[{"id":"'.concat(l,'"}]'))},tools:["add","remove"]}),i().createElement("div",Ia({},H(),{className:"ms-horizontal-menu"}),i().createElement("div",G(),d.map((function(e,t){var r=z({id:e.id,onClick:h?void 0:function(){a('sections[{"id":"'.concat(l,'"}].contents[{"id":"').concat(e.id,'"}].carouselToggle'),!0)}});return i().createElement("div",Ia({key:t},r,{className:"ms-geo-carousel-item-wrapper",style:h?{pointerEvents:"none"}:{}}),K&&i().createElement(m,{editMap:h,markerDisabled:!u||(null==e?void 0:e.id)!==s,edit:function(t){t.stopPropagation(),function(e){A(null==e?void 0:e.id),k(!0),U(null==e?void 0:e.thumbnail),L(null==e?void 0:e.title)}(e)},remove:function(){var n,r,o,i;return o=null==e?void 0:e.id,i=0===t&&d.length>0?null===(n=d[t+1])||void 0===n?void 0:n.id:null===(r=d[t-1])||void 0===r?void 0:r.id,c('sections[{"id":"'.concat(l,'"}].contents[{"id":"').concat(o,'"}]')),void(s===o&&a('sections[{"id":"'.concat(l,'"}].contents[{"id":"').concat(i,'"}].hideContent'),!1))},forceDelBtnDisable:(null==e?void 0:e.id)===s,add:n,marker:function(t){t.stopPropagation(),b(e)},tools:["edit","remove","marker"]}),i().createElement(y,Ia({key:t,index:t,items:d,update:a,sectionId:l,selectedId:s,isSelected:(null==e?void 0:e.id)===s},e)))}))),Z&&i().createElement(Bn.Z,{className:"square-button-md no-border ms-geo-carousel-control",style:Ta(Ta({},T),{},{position:"absolute"}),onClick:function(){return V(E)}},i().createElement(en.Glyphicon,{glyph:"chevron-left"})),W&&i().createElement(Bn.Z,{className:"square-button-md no-border ms-geo-carousel-control",style:Ta(Ta({},T),{},{position:"absolute",right:0}),onClick:function(){return V(-E)}},i().createElement(en.Glyphicon,{glyph:"chevron-right"})))),I&&i().createElement(fa,{title:N,thumbnail:B,update:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"replace",o=D()(e)?"":".".concat(e);a('sections[{"id":"'.concat(l,'"}].contents[{"id":"').concat(n,'"}]')+o,t,r)},onClose:function(){return k(!1)}}))}));const Da=function(e){var t=e.onSort,n=e.sectionId,r=e.contents,o=void 0===r?[]:r,a=e.onEnableDraw,c=void 0===a?function(){}:a,l=e.isEditMap,u=e.isDrawEnabled,s=Ma(e,Pa);return i().createElement(Ra,Ia({containerId:n,isDraggable:s.mode===p.nl.EDIT,onSort:function(e,r,o,i){if(o.containerId===i.containerId){var a='sections[{ "id": "'.concat(n,'" }].contents[{"id":"').concat(i.id,'"}]'),c='sections[{ "id": "'.concat(n,'" }].contents'),l=e,u=va()();t(a,c,l,u,'sections[{ "id": "'.concat(n,'" }].contents[{"id":"').concat(u,'"}]'))}}},Ta(Ta({},s),{},{sectionId:n}),{cardComponent:Aa,items:o.map((function(e){var t=e.id,n=e.thumbnail;return{id:t,thumbnail:void 0===n?{}:n,features:e.features,title:e.title}})),isDrawEnabled:u,onEnableDraw:c,isEditMap:l}))};var Na=n(6909);function La(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?La(Object(n),!0).forEach((function(t){Ba(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):La(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ba(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ua(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fa(e){var t,n,r=e.map,a=e.active,c=e.method,l=e.mapId,u=e.mapType,s=e.features,p=e.options,d=e.onChange,f=(t=(0,o.useState)([]),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Ua(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ua(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),m=f[0],y=f[1];return(0,o.useEffect)((function(){y(a?"drawOrEdit":"clean")}),[a]),"openlayers"!==u?null:i().createElement(Na.Z,{map:r,drawOwner:l,drawStatus:m,drawMethod:c,features:s,options:_a({drawEnabled:a,addClickCallback:!0,editEnabled:!0,featureProjection:"EPSG:4326",geodesic:!1,stopAfterDrawing:!1,transformToFeatureCollection:!0,translateEnabled:!1,useSelectedStyle:!0},p),onDrawingFeatures:d.bind(null,l)})}Fa.propTypes={active:Ve().boolean,method:Ve().string,features:Ve().array,onChange:Ve().func,options:Ve().object},Fa.defaultProps={active:!1,method:"Point",features:[],onChange:function(){},options:{}};const Za=Fa;var Wa=n(86267),Ha=n(52043);function Ga(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var za={openlayers:{fit:function(e){var t,n=e.map,r=e.geometry,o=e.padding,i=e.geometryProjection,a=e.fixedZoom,c=e.maxZoom,l=e.duration,u=n.getView(),s=u.getProjection().getCode();if(2===r.length){var p=(0,Wa.reproject)(r,i,s),d=p.x,f=p.y;t=new Ha.Z([d,f])}else t=(0,Wa.reprojectBbox)(r,i,s);var m=o||{},y=m.top,g=void 0===y?0:y,v=m.right,b=void 0===v?0:v,h=m.bottom,O=void 0===h?0:h,w=m.left,E=void 0===w?0:w;u.fit(t,{padding:[g,b,O,E],maxZoom:a?u.getZoom():c,duration:l})}},leaflet:{fit:function(e){var t,n,r,o=e.map,i=e.geometry,a=e.padding,c=e.geometryProjection,l=e.fixedZoom,u=e.maxZoom,s=e.duration,p=l?o.getZoom():u,d=a.top,f=void 0===d?0:d,m=a.right,y=void 0===m?0:m,g=a.bottom,v=void 0===g?0:g,b=a.left,h=void 0===b?0:b;if(2===i.length){var O=(0,Wa.reproject)(i,c,"EPSG:4326"),w=O.x,E=O.y;t=[[E,w],[E,w]]}else{var S=(n=(0,Wa.reprojectBbox)(i,c,"EPSG:4326"),r=4,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return Ga(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ga(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),P=S[0],j=S[1],T=S[2];t=[[j,P],[S[3],T]]}o.flyToBounds(t,{paddingTopLeft:[h,f],paddingBottomRight:[y,v],maxZoom:p,animate:!!s,duration:s/1e3})}}};function Va(e){var t=e.map,n=e.mapType,r=e.active,i=e.geometry,a=e.geometryProjection,c=void 0===a?"EPSG:4326":a,l=e.padding,u=e.maxZoom,s=e.fixedZoom,p=e.duration,d=(0,o.useRef)();return d.current=function(){t&&za[n]&&za[n].fit({map:t,geometry:i,padding:l,geometryProjection:c,maxZoom:u,fixedZoom:s,duration:p})},(0,o.useEffect)((function(){r&&i&&d.current()}),[i,r]),null}Va.propTypes={id:Ve().string,map:Ve().object,mapType:Ve().string,active:Ve().boolean,geometry:Ve().array,geometryProjection:Ve().string,padding:Ve().object,maxZoom:Ve().number,fixedZoom:Ve().boolean,duration:Ve().number},Va.defaultProps={geometryProjection:"EPSG:4326",padding:{top:0,right:0,bottom:0,left:0}};const qa=Va;function Ka(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return $a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xa(){return(Xa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ya(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ya(Object(n),!0).forEach((function(t){Ja(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ya(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ja(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ec=(0,Me.compose)(fi,(function(e){return function(t){var n=ui(t.contents||[],t.backgroundId)||{},r=n&&n.id,o=ci(ci({},t),{},{contentId:r,sectionId:t.id,path:'sections[{"id": "'.concat(t.id,'"}].background')});return i().createElement(e,o)}}),(function(e){return function(t){var n=ci(ci({},t),{},{updateBackground:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.update.apply(t,['sections[{"id": "'.concat(t.sectionId,'"}].background.')+e].concat(r))},updateSection:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.update.apply(t,['sections[{"id": "'.concat(t.sectionId,'"}]')].concat(n))}});return i().createElement(e,n)}}),(function(e){return function(t){var n=Ka((0,o.useState)(""),2),r=n[0],a=n[1];return i().createElement(e,Xa({},t,{textEditorActiveClass:r,bubblingTextEditing:function(e){return a(e?" ms-text-editor-active":"")}}))}}))((function(e){var t,n,r,a=e.add,c=void 0===a?function(){}:a,l=e.editMedia,u=void 0===l?function(){}:l,s=e.editWebPage,d=void 0===s?function(){}:s,f=e.onVisibilityChange,m=void 0===f?function(){}:f,y=e.update,g=void 0===y?function(){}:y,v=e.updateBackground,b=void 0===v?function(){}:v,h=e.updateCurrentPage,O=void 0===h?function(){}:h,w=e.remove,E=void 0===w?function(){}:w,S=e.id,P=e.background,j=void 0===P?{}:P,T=e.path,C=e.contents,I=void 0===C?[]:C,k=e.mode,M=e.sectionType,A=e.inViewRef,R=e.viewWidth,D=e.viewHeight,N=e.focusedContent,L=e.contentId,_=e.bubblingTextEditing,B=void 0===_?function(){}:_,U=e.textEditorActiveClass,F=void 0===U?"":U,Z=e.expandableMedia,W=void 0!==Z&&Z,H=e.storyTheme,G=e.mediaViewer,z=e.contentToolbar,V=e.inView,q=e.sections,K=void 0===q?[]:q,$=e.storyFonts,X=e.onSort,Y=void 0===X?function(){}:X,Q=e.onEnableDraw,J=void 0===Q?function(){}:Q,ee=e.isDrawEnabled,te=e.defaultMarkerStyle,ne=void 0===te?{iconColor:"cyan",iconShape:"circle"}:te,re=(0,o.useRef)(),oe=(0,o.useRef)(),ie=(0,o.useRef)();function ae(e,t){return t-(e.left+e.right)<128?{top:0,left:0,bottom:0,right:0}:e}var ce=N&&N.hideContent&&x()(N,"target.id")===S,le=ce?"hidden":"visible",ue=W&&j&&"map"===j.type?" ms-expandable-background":"",se=Qa(Qa({},null==H?void 0:H.overlay),k===p.nl.VIEW&&{maxHeight:D-350,overflowY:"auto"})||{},pe=(null==H?void 0:H.general)||{},de=D-(k===p.nl.EDIT?220:200),fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=hn()(I,{id:L})||{},n=t.contents,r=void 0===n?[]:n;return e.filter((function(e){return p.ID.CAROUSEL===M&&1===r.length?"remove"!==e:e}))},me=(null==j?void 0:j.type)===p.Tr.MAP,ye=(I.find((function(e){return e.id===L}))||{}).features,ge=void 0===ye?[]:ye,ve=(0,p.Yh)({id:S,contents:I,featureStyle:function(e,t){var n=e.content,r=e.feature;return Qa(Qa(Qa({},ne),{},{iconText:"".concat(t+1)},r.style),{},{highlight:L===n.id})}});return i().createElement("section",{className:"ms-section ms-section-carousel".concat(ue),id:S,ref:A},i().createElement(Zi,Xa({},j,{mode:k,innerRef:re,disableToolbarPortal:!0,tools:(t={},Ja(t,p.Tr.IMAGE,["editMedia","fit","size","align","theme"]),Ja(t,p.Tr.MAP,["editMedia","editMap","size","align","theme"].concat(ee?"closeDraw":[])),Ja(t,p.Tr.VIDEO,["editMedia","fit","size","align","theme","muted","autoplay","loop"]),t),scrollContainerSelector:"#ms-sections-container",add:c,editMedia:u,expandable:W,path:T,update:b,updateCurrentPage:O,remove:E,sectionType:M,sectionId:S,backgroundId:j.id,key:j.id,width:R,height:D,backgroundPlaceholder:{background:"url(".concat(Vi(),")"),backgroundSize:"600px auto"},storyTheme:pe,mediaViewer:G,contentToolbar:z,inView:V,layers:[ve],isDrawEnabled:ee,onEnableDraw:J,contentToolbarChildren:!me&&k===p.nl.EDIT&&i().createElement(wa,{type:"addMap"})}),i().createElement(Za,{active:ee,features:ge,method:"Point",onChange:function(e,t){g('sections[{"id":"'.concat(S,'"}].contents[{"id":"').concat(L,'"}].features'),t)}}),i().createElement(qa,{active:!(ee||null!=j&&j.editMap),geometry:null==ge||null===(n=ge[0])||void 0===n||null===(r=n.geometry)||void 0===r?void 0:r.coordinates,padding:function(){var e={top:0,left:0,bottom:0,right:0},t=re.current&&re.current.querySelector(".ms-media-map"),n=oe.current&&oe.current.querySelector("[id='".concat(L,"']"));if(t&&n){var r=re.current.getBoundingClientRect()||{},o=t.getBoundingClientRect()||{},i=n.getBoundingClientRect()||{};if(ie.current){var a=ie.current.getBoundingClientRect()||{};e.bottom=r.height-(a.top-r.top)}var c=o.left-r.left,l=c+o.width,u=i.left-r.left,s=u+i.width;if(u>=c&&s<=l){var p=u-c,d=l-s;return d>=p?e.left=p+i.width:e.right=d+i.width,ae(e,o.width)}if(s>=c&&s<=l)return e.left=s-c,ae(e,o.width);if(u>=c&&u<=l)return e.right=l-u,ae(e,o.width)}return e}(),fixedZoom:!0,duration:300})),i().createElement(ei,{innerRef:oe,tools:Ja({},p.bT.COLUMN,["size","align","theme"]),className:"ms-section-contents".concat(F),contents:I,mode:k,add:c,updateCurrentPage:O,editMedia:u,editWebPage:d,update:g,remove:E,sectionId:S,viewWidth:R,viewHeight:D,contentProps:{onVisibilityChange:m,contentWrapperStyle:{minHeight:de,visibility:le},expandable:W,mediaViewer:G,contentToolbar:z,overrideTools:function(e){return Object.fromEntries(Object.entries(e).map((function(e){var t=Ka(e,2),n=t[0],r=t[1];return[n,fe(r)]})))}},focusedContent:N,bubblingTextEditing:B,sectionType:M,storyTheme:se,sections:K,storyFonts:$}),i().createElement(Da,{innerRef:ie,style:null!=H&&H.overlay?Qa({},H.overlay):{},controlStyle:pe?Qa({},pe):{},sectionId:S,contentId:L,contents:I,update:g,remove:E,expandable:W,add:function(){return e=Qa(Qa({},(0,p.nq)(p.bT.COLUMN)),{},{title:"Item "+(I.length+1),background:{}}),c('sections[{"id": "'.concat(S,'"}].contents'),void 0,e,"geostory.builder.defaults.titleGeocarouselContent"),void g('sections[{"id":"'.concat(S,'"}].contents[{"id":"').concat(L,'"}].hideContent'),!0);var e},contentToolbar:z,mode:k,onSort:Y,isMapBackground:me,isEditMap:null==j?void 0:j.editMap,containerWidth:R,isDrawEnabled:ee,onEnableDraw:function(e){g('sections[{"id":"'.concat(S,'"}].background.editMap'),!0,"replace"),J({contentId:e.id,sectionId:S})}}),k===p.nl.EDIT&&!ce&&i().createElement(to,{containerWidth:R,containerHeight:D,buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){c("sections",S,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){c("sections",S,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){c("sections",S,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveSection",onClick:function(){return c("sections",S,p.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselSection",onClick:function(){c("sections",S,p.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){c("sections",S,p.tQ.MEDIA)}},{glyph:"story-webpage-section",tooltipId:"geostory.addWebPageSection",onClick:function(){c("sections",S,p.tQ.WEBPAGE)}}]}))}));function tc(e){return(tc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var nc;function rc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ic(e,t){return(ic=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ac(e,t){return!t||"object"!==tc(t)&&"function"!=typeof t?cc(e):t}function cc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lc(e){return(lc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var sc=(uc(nc={},p.ID.IMMERSIVE,$i),uc(nc,p.ID.CAROUSEL,ec),uc(nc,p.ID.PARAGRAPH,Ji),uc(nc,p.tQ.MEDIA,Ji),uc(nc,p.tQ.WEBPAGE,Ji),uc(nc,p.ID.TITLE,oa),uc(nc,p.ID.BANNER,ca),uc(nc,"UNKNOWN",(function(e){var t=e.type,n=e.inViewRef;return i().createElement("div",{ref:n,className:"ms-section ms-section-unknown"},"WARNING: unknown session of type ",t)})),nc),pc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ic(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=lc(r);if(o){var n=lc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ac(this,e)});function c(){var e;rc(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return uc(cc(e=a.call.apply(a,[this].concat(n))),"state",{height:0}),e}return t=c,(n=[{key:"render",value:function(){var e=sc[this.props.type]||sc.UNKNOWN;return i().createElement(e,{sectionType:this.props.type,id:this.props.id,add:this.props.add,update:this.props.update,inViewRef:this.props.inViewRef,editMedia:this.props.editMedia,expandableMedia:this.props.expandableMedia,editWebPage:this.props.editWebPage,updateCurrentPage:this.props.updateCurrentPage,remove:this.props.remove,mode:this.props.mode,cover:this.props.cover,contents:this.props.contents,viewWidth:this.props.viewWidth,viewHeight:this.props.viewHeight,focusedContent:this.props.focusedContent,storyTheme:this.props.storyTheme,mediaViewer:this.props.mediaViewer,contentToolbar:this.props.contentToolbar,inView:this.props.inView,sections:this.props.sections,storyFonts:this.props.storyFonts,onSort:this.props.onSort,isDrawEnabled:this.props.isDrawEnabled,background:this.props.background,onEnableDraw:this.props.onEnableDraw,defaultMarkerStyle:this.props.defaultMarkerStyle})}}])&&oc(t.prototype,n),c}(i().Component);uc(pc,"propTypes",{id:Ve().string,type:Ve().oneOf(p.lg.SectionTypes),storyType:Ve().oneOf(p.lg.StoryTypes),add:Ve().func,update:Ve().func,editMedia:Ve().func,editWebPage:Ve().func,remove:Ve().func,updateCurrentPage:Ve().func,mode:Ve().oneOf(p.lg.Modes),contents:Ve().array,viewHeight:Ve().number,viewWidth:Ve().number,inViewRef:Ve().func,excludeClassName:Ve().string,cover:Ve().bool,focusedContent:Ve().object,expandableMedia:Ve().bool,storyTheme:Ve().object,mediaViewer:Ve().func,contentToolbar:Ve().func,inView:Ve().bool,sections:Ve().array,storyFonts:Ve().array,onSort:Ve().func,isDrawEnabled:Ve().bool,onEnableDraw:Ve().func,background:Ve().object,defaultMarkerStyle:Ve().object}),uc(pc,"defaultProps",{id:"",add:function(){},update:function(){},editMedia:function(){},editWebPage:function(){},updateCurrentPage:function(){},remove:function(){},onSort:function(){},storyType:p.Ln.CASCADE,viewHeight:0,viewWidth:0,mode:p.nl.VIEW,expandableMedia:!1,sections:[],storyFonts:[],onEnableDraw:function(){}});const dc=go({threshold:[0,.25,.5,.75,1],rootMargin:"-200px 0px 0px 0px"})(pc);function fc(e){return(fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gc(e,t){return(gc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vc(e,t){return!t||"object"!==fc(t)&&"function"!=typeof t?bc(e):t}function bc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hc(e){return(hc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gc(e,t)}(c,e);var t,n,r,o,a=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=hc(r);if(o){var n=hc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return vc(this,e)});function c(){var e;mc(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Oc(bc(e=a.call.apply(a,[this].concat(n))),"getAdjustedSelector",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/#\d|^#-\d/g,(function(e,t){return t?"#\\"+t[1]+t[2]:"#\\3"+e[1]+" "}))})),Oc(bc(e),"getFocusedTarget",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.targets,n=e.props.padding,r=void 0===n?{}:n;return t.map((function(t){var n=t.selector,o=null;try{var i=window.document.querySelector(e.getAdjustedSelector(n));if(i){var a=i.getBoundingClientRect(),c=a.top,l=a.right,u=a.bottom,s=a.left;o={x:s-r,y:c-r,w:l-s+2*r,h:u-c+2*r}}}catch(e){console.warn(e)}finally{return o}})).filter((function(e){return e}))})),Oc(bc(e),"getHolePath",(function(t){var n=t.x,r=t.y,o=t.w,i=t.h,a=e.props.borderRadius,c=void 0===a?8:a;return"M ".concat(n," ").concat(r+c," q 0 -").concat(c," ").concat(c," -").concat(c," h ").concat(o-2*c," q ").concat(c," 0 ").concat(c," ").concat(c," v ").concat(i-2*c," q 0 ").concat(c," -").concat(c," ").concat(c," h-").concat(o-2*c," q -").concat(c," 0 -").concat(c," -").concat(c," v-").concat(i-2*c)})),Oc(bc(e),"getPath",(function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getFocusedTarget(),o="M 0 0 h ".concat(n," v ").concat(t," h -").concat(n," v -").concat(t),i=r.map(e.getHolePath);return o+i.join(" ")})),e}return t=c,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.onMaskClicked,r=t.stopEventsOnTargets,o=void 0!==r&&r,a=t.targets,c=this.getFocusedTarget(a.filter((function(e){var t=e.stopEventsOnTarget;return o||t})));return i().createElement("div",{style:{position:"fixed",height:"100vh",width:"100vw",top:0,left:0,zIndex:1e6,pointerEvents:"none"}},i().createElement(xe.Z,null,(function(t){var r=t.width,o=t.height;return i().createElement("svg",{width:r,height:o,xmlns:"http://www.w3.org/2000/svg"},i().createElement("path",{d:e.getPath(o,r),fill:"rgba(0,0,0,0.7)",fillRule:"evenodd",pointerEvents:"visiblePainted",onClick:n}),c.map((function(t,n){return i().createElement("path",{key:n,d:e.getHolePath(t),fill:"transparent",pointerEvents:"visiblePainted"})})))})))}}])&&yc(t.prototype,n),c}(i().Component);function Ec(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ec(Object(n),!0).forEach((function(t){Pc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ec(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Oc(wc,"propTypes",{targets:Ve().arrayOf(Ve().shape({selector:Ve().string,stopEventsOnTarget:Ve().bool})),padding:Ve().number,borderRadius:Ve().number,onMaskClicked:Ve().func,stopEventsOnTargets:Ve().bool}),Oc(wc,"defaultProps",{targets:[],padding:0,borderRadius:8,onMaskClicked:function(){},stopEventsOnTargets:!1});var jc=(0,Be.Z)((function(e){var t=e.sections;return 0===(void 0===t?[]:t).length}),(function(e){var t=e.add,n=void 0===t?function(){}:t;return{iconFit:!1,style:{position:"relative",width:"50%",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},glyph:"geostory",title:i().createElement(pr.Z,{msgId:"geostory.emptyTitle"}),description:i().createElement(pr.Z,{msgId:"geostory.emptyDescription"}),content:i().createElement(to,{addButtonClassName:"square-button-md",containerWidth:"100%",containerHeight:"100%",buttons:[{glyph:"story-title-section",tooltipId:"geostory.addTitleSection",onClick:function(){n("sections",0,p.ID.TITLE)}},{glyph:"story-banner-section",tooltipId:"geostory.addBannerSection",onClick:function(){n("sections",0,p.ID.BANNER)}},{glyph:"story-paragraph-section",tooltipId:"geostory.addParagraphSection",onClick:function(){n("sections",0,p.ID.PARAGRAPH)}},{glyph:"story-immersive-section",tooltipId:"geostory.addImmersiveContent",onClick:function(){n("sections",0,p.ID.IMMERSIVE)}},{glyph:"story-carousel-section",tooltipId:"geostory.addGeocarouselContent",onClick:function(){n("sections",0,p.ID.CAROUSEL)}},{glyph:"story-media-section",tooltipId:"geostory.addMediaSection",onClick:function(){n("sections",0,p.tQ.MEDIA)}},{glyph:"code",tooltipId:"geostory.addWebPageSection",onClick:function(){n("sections",0,p.tQ.WEBPAGE)}}]})}}))(xe.Z),Tc=function(e){var t=e.width;return e.mode===p.nl.EDIT?"":t<640?"sm":t>=640&&t<1024?"md":""};const Cc=(0,Me.compose)(_e,Ge,function(e){var t=e.showFocusMask,n=void 0===t?function(){}:t,r=e.defaultTargets,o=void 0===r?{selector:".ms-geostory-map-editor"}:r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=a.padding,l=void 0===c?0:c,u=a.borderRadius,s=void 0===u?8:u,p=a.stopEventsOnTargets,d=void 0!==p&&p,f=a.onMaskClicked,m=void 0===f?function(){}:f;return(0,Me.branch)(n,(function(e){return(0,Me.nest)((function(e){var t=e.focusedContent,n=e.children;return i().createElement(i().Fragment,null,n,i().createElement(wc,{targets:[t,o],padding:l,borderRadius:s,stopEventsOnTargets:d,onMaskClicked:m}))}),e)}))}({showFocusMask:function(e){var t=e.focusedContent,n=(t=void 0===t?{}:t).target;return(void 0===n?{}:n).id}}))((function(e){var t=e.mode,n=void 0===t?p.nl.VIEW:t,r=e.sections,o=void 0===r?[]:r,a=e.add,c=void 0===a?function(){}:a,l=e.onVisibilityChange,u=void 0===l?function(){}:l,s=e.updateCurrentPage,d=void 0===s?function(){}:s,f=e.editMedia,m=void 0===f?function(){}:f,y=e.editWebPage,g=void 0===y?function(){}:y,v=e.update,b=void 0===v?function(){}:v,h=e.remove,O=void 0===h?function(){}:h,w=e.focusedContent,E=e.isContentFocused,S=void 0!==E&&E,P=e.getSize,j=void 0===P?Tc:P,T=e.theme,C=void 0===T?{}:T,I=e.mediaViewer,k=e.contentToolbar,x=e.storyFonts,M=e.onSort,A=void 0===M?function(){}:M,R=e.isDrawEnabled,D=void 0!==R&&R,N=e.onEnableDraw,L=void 0===N?function(){}:N,_=e.defaultMarkerStyle;return i().createElement(ke.Z,{className:"ms-cascade-story ms-".concat(n)},i().createElement(jc,{sections:o,add:c},(function(e){var t,r=e.width,a=e.height,l=j({width:r,height:a,mode:n}),s=l?" ms-".concat(l):"",p="sm"===l,f=C&&Io()(C)&&C||{};return i().createElement("div",{id:"ms-sections-container",className:"ms-sections-container".concat(s," ms-sections-hyperlinks"),style:Sc(Sc({},null==f?void 0:f.general),S&&{overflow:"hidden"})},(null==f||null===(t=f.link)||void 0===t?void 0:t.color)&&i().createElement("style",{dangerouslySetInnerHTML:{__html:"\n            .ms-sections-hyperlinks .ms-text-editor-main a,\n            .ms-sections-hyperlinks .ms-text-wrapper a,\n            .ms-sections-hyperlinks .ms-text-editor-main a:link,\n            .ms-sections-hyperlinks .ms-text-wrapper a:link,\n            .ms-sections-hyperlinks .ms-text-editor-main a:visited,\n            .ms-sections-hyperlinks .ms-text-wrapper a:visited,\n            .ms-sections-hyperlinks .ms-text-editor-main a:active,\n            .ms-sections-hyperlinks .ms-text-wrapper a:active {\n                color: ".concat(f.link.color,";\n                opacity: 1;\n            }\n            .ms-sections-hyperlinks .ms-text-editor-main a:hover,\n            .ms-sections-hyperlinks .ms-text-wrapper a:hover {\n                color: ").concat(f.link.color,";\n                opacity: 0.75;\n            }\n        ")}}),o.map((function(e){var t=e.contents,l=void 0===t?[]:t,s=e.id,y=e.type,v=e.cover,h=e.background;return i().createElement(dc,{focusedContent:w,onVisibilityChange:u,add:c,editMedia:m,expandableMedia:p,editWebPage:g,updateCurrentPage:d,update:b,remove:O,key:s,id:s,viewHeight:a,viewWidth:r,type:y,mode:n,contents:l,cover:v,storyTheme:f,mediaViewer:I,contentToolbar:k,sections:o,storyFonts:x,onSort:A,isDrawEnabled:D,onEnableDraw:L,background:h,defaultMarkerStyle:_})})))})))}));var Ic=n(48860),kc=["id"];function xc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Mc(){return(Mc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ac(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ac(Object(n),!0).forEach((function(t){Dc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ac(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Dc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Nc=(0,jo.Z)(vo.Z);const Lc=(0,Me.compose)((0,a.connect)((0,c.P1)(z.jq,z.z7,(function(e,t){return{resources:e,isContentFocused:t}}))),(0,Me.withProps)((function(e){var t=e.resources,n=e.resourceId,r=e.map,o=void 0===r?{}:r,i=Rc(Rc({},o),{},{layers:(o.layers||[]).map((function(e){return e||void 0}))}),a=hn()(t,{id:n})||{};return{map:(0,p.oH)(a.data,i)}})));var _c=(0,Me.compose)((0,a.connect)((0,c.P1)(z.GC,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{focusedEl:e}}))),(0,Me.withProps)((function(e){var t=e.focusedEl,n=(t=void 0===t?{}:t).resourceId,r=t.map;return{map:r||{},resourceId:n,disableReset:!r}}))),Bc=(0,Me.withHandlers)({onChangeMap:function(e){var t=e.update,n=e.focusedContent,r=void 0===n?{}:n;return function(e,n){t("".concat(r.path,".map.").concat(e),n,"merge")}},onChange:function(e){var t=e.update,n=e.focusedContent,r=void 0===n?{}:n;return function(e,n){t(r.path+".".concat(e),n,"merge")}}}),Uc=(0,Me.compose)((0,a.connect)(null,{toggleAdvancedEditing:$.$Z}),(0,Me.withHandlers)({toggleAdvancedEditing:function(e){var t=e.toggleAdvancedEditing,n=void 0===t?function(){}:t,r=e.map,o=void 0===r?{}:r;return function(){var e=o.id,t=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(o,kc);n("inlineEditor",{data:t,id:e})}}})),Fc=(0,Me.withHandlers)({toggleEditing:function(e){var t=e.editMap,n=e.update,r=e.focusedContent;return function(){return n(r.path+".editMap",!t)}},onReset:function(e){var t=e.update,n=e.focusedContent,r=(n=void 0===n?{}:n).path,o=void 0===r?"":r;return function(){t(o+".map",void 0)}},discardAndClose:function(e){var t=e.update,n=e.focusedContent,r=void 0===n?{}:n;return function(e){t(r.path+".map",e),t(r.path+".editMap",!1)}}}),Zc=function(e){return i().createElement(Nc,Mc({glyph:"repeat",bsStyle:"primary",className:"square-button-md no-border",tooltipId:"geostory.contentToolbar.resetMap",confirmTitle:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.resetMapConfirm"}),confirmContent:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.resetConfirmContent"})},e))},Wc=(0,Me.compose)((0,Me.withProps)((function(e){var t=e.pendingChanges,n=e.toggleEditing,r=e.disableReset,o=e.onReset,a=e.toggleAdvancedEditing,c=void 0===a?function(){}:a;return{buttons:[{glyph:"floppy-disk",disabled:!t,tooltipId:"geostory.contentToolbar.saveChanges",onClick:n},{renderButton:i().createElement(Zc,{disabled:r,onClick:o})},{glyph:"pencil",tooltipId:"geostory.contentToolbar.advancedMapEditor",onClick:c}]}})),Ic.Z,(0,Me.withStateHandlers)((function(){return{editNode:void 0}}),{setEditNode:function(){return function(e){return{editNode:e}}},closeNodeEditor:function(){return function(){return{editNode:void 0}}}}),(0,Me.branch)((function(e){return!!e.editNode}),(0,Me.withProps)((function(e){var t=e.selectedNodes,n=void 0===t?[]:t,r=e.closeNodeEditor,o=void 0===r?function(){}:r;return{buttons:[{visible:1===n.length,tooltipId:"close",glyph:"1-close",onClick:o}]}})),(0,Me.withProps)((function(e){var t,n=e.selectedNodes,r=void 0===n?[]:n,o=e.setEditNode,i=void 0===o?function(){}:o,a=e.buttons,c=void 0===a?[]:a;return{buttons:[{visible:1===r.length,glyph:"wrench",tooltipId:"toc.toolLayerSettingsTooltip",onClick:function(){i(r[0])}}].concat((t=c,function(e){if(Array.isArray(e))return xc(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return xc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xc(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}})))),Hc=(0,Me.compose)((0,Me.withPropsOnChange)(["focusedContent"],(function(e){var t=e.map,n=e.focusedEl;return{contentMap:(n=void 0===n?{}:n).map,lastSavedMap:t}})),(0,Me.withPropsOnChange)(["map"],(function(e){var t=e.map,n=e.lastSavedMap;return{pendingChanges:!mn()(n,t)}}))),Gc=(0,Me.compose)((0,Me.withProps)((function(e){var t=e.toggleEditing;return{CloseBtn:function(e){return i().createElement(vo.Z,Mc({onClick:t},e))}}})),(0,Me.branch)((function(e){return e.pendingChanges}),(0,Me.withProps)((function(e){var t=e.discardAndClose,n=e.contentMap;return{CloseBtn:function(e){return i().createElement(Nc,Mc({onClick:function(){return t(n)},confirmTitle:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.confirmCloseMapEditing"}),confirmContent:i().createElement(pr.Z,{msgId:"geostory.contentToolbar.pendingChangesDiscardConfirm"})},e))}}})))),zc=(0,Me.mapPropsStream)((function(e){var t=(0,Me.createEventHandler)(),n=t.stream,r=t.handler;return e.pluck("map").distinctUntilChanged((function(e,t){return mn()(e,t)})).switchMap((function(e){return n.map((function(t){return{map:Rc(Rc({},e),t)}})).startWith({map:e})})).combineLatest(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Rc(Rc({},n),{},{onMapViewLocalChanges:r,map:t})}))})),Vc=function(e,t){return void 0!==e&&void 0!==t&&e.toFixed(12)-t.toFixed(12)==0},qc=(0,Me.withHandlers)({onMapViewChanges:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.update,n=e.editMap,r=void 0!==n&&n,o=e.onMapViewLocalChanges,i=e.map,a=(i=void 0===i?{}:i).center,c=void 0===a?{}:a,l=i.zoom,u=i.mapStateSource,s=i.resolution,p=i.resetPanAndZoom;return function(e){var n=e.center,i=void 0===n?{}:n,a=e.zoom,d=e.mapStateSource,f=e.resolution,m=Vc(c.x,i.x)&&Vc(c.y,i.y);!r||m&&l===a?p?t("map",{center:c,zoom:l,mapStateSource:u,resolution:s,resetPanAndZoom:!1},"merge"):o({center:i,zoom:a,mapStateSource:d,resolution:f}):t("map",{center:i,zoom:a,mapStateSource:va()(),resolution:f,resetPanAndZoom:!1},"merge")}}}),Kc=n(5993),$c=n(75927),Xc=n(51768),Yc=["tabs","activeTab","width","setActiveTab"];function Qc(){return(Qc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Jc(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var el=(0,Ln.Z)(en.NavItem);var tl=n(79105),nl=n(43129),rl=n(45869),ol=n(87320),il=(0,qe.Z)(["placeholder","options"])(nl.ZP);const al=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,n=void 0===t?{zoomControl:!0,mapInfoControl:!1}:t,r=e.onChangeMap,o=void 0===r?function(){}:r,a=n&&n.mapOptions||{},c=(0,p.kn)({mapOptions:a,zoomControl:!!P()(n.zoomControl)||n.zoomControl,mapInfoControl:!P()(n.mapInfoControl)&&n.mapInfoControl});return i().createElement(en.Form,{className:"ms-geostory-map-controls"},i().createElement(en.FormGroup,null,i().createElement(en.ControlLabel,null,i().createElement(pr.Z,{msgId:"geostory.mapEditor.zoom"})),i().createElement(rl.Z,{onChange:function(){var e=!c.zoomControl;o("zoomControl",e),o("mapOptions.interactions",{doubleClickZoom:e,shiftDragZoom:e,pinchZoom:e})},className:"ms-geostory-map-controls-switch",checked:c.zoomControl}),i().createElement(il,{options:[{label:"geostory.mapEditor.topLeft",value:"topLeft"},{label:"geostory.mapEditor.topRight",value:"topRight"},{label:"geostory.mapEditor.bottomLeft",value:"bottomLeft"},{label:"geostory.mapEditor.bottomRight",value:"bottomRight"}],wrapperStyle:{marginTop:"10px"},value:c.mapOptions&&c.mapOptions.zoomPosition||"topLeft",clearable:!1,disabled:!c.zoomControl,onChange:function(e){return o("mapOptions.zoomPosition",e&&e.value?e.value:"topLeft")},placeholder:"geostory.builder.settings.titlePlaceholder"})),i().createElement(en.FormGroup,null,i().createElement(en.ControlLabel,null,i().createElement(pr.Z,{msgId:"geostory.mapEditor.pan"})),i().createElement(rl.Z,{onChange:function(){var e=!(c.mapOptions&&c.mapOptions.interactions&&c.mapOptions.interactions.dragPan);o("mapOptions.interactions",{dragPan:e,keyboardPan:e})},className:"ms-geostory-map-controls-switch",checked:c.mapOptions&&c.mapOptions.interactions&&c.mapOptions.interactions.dragPan})),i().createElement(en.FormGroup,null,i().createElement(en.ControlLabel,null,i().createElement(pr.Z,{msgId:"geostory.mapEditor.identify"})),i().createElement(rl.Z,{onChange:function(){var e=!c.mapInfoControl;o("mapInfoControl",e)},className:"ms-geostory-map-controls-switch",checked:c.mapInfoControl}),c.mapInfoControl&&i().createElement(ol.Z,{disabled:!c.mapInfoControl,popoverMessage:"geostory.builder.settings.templateTooltip",infoFormat:c.mapOptions&&c.mapOptions.mapInfoFormat||"application/json",onInfoFormatChange:function(e){return o("mapOptions.mapInfoFormat",e)},selectProps:{wrapperStyle:{marginTop:10}}})))};var cl=n(16701),ll=(0,Me.withProps)((function(e){return{tabs:e.tabs||[{id:"toc",titleId:"geostory.mapEditor.toc",tooltipId:"geostory.mapEditor.toc",glyph:"1-layer",visible:!0,Component:cl.Z},{id:"settings",titleId:"geostory.mapEditor.settings",tooltipId:"geostory.mapEditor.settings",glyph:"wrench",visible:!0,Component:al}]}}));const ul=(0,Me.compose)((0,tl.Z)("activeTab","setActiveTab","toc"),ll);var sl=(0,Me.compose)(Xc.Z,(0,Me.withProps)((function(e){var t=e.selectedNode;return{title:t&&t.title}})),(0,Kc.Z)("title"))((function(e){var t=e.title,n=e.description;return i().createElement("div",{className:"text-center"},i().createElement("div",{className:"mapstore-step-title"},t),i().createElement("div",{className:"mapstore-step-description"},n))})),pl=(0,Xc.Z)($c.Z),dl=ul((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tabs,n=void 0===t?[]:t,r=e.activeTab,o=(e.width,e.setActiveTab),a=void 0===o?function(){}:o,c=Jc(e,Yc);return i().createElement("div",{key:"ms-geostory-map-settings-navbar",className:"ms-row-tab"},i().createElement("div",null,i().createElement(en.Nav,{bsStyle:"tabs",activeKey:r,justified:!0},n.map((function(e){return i().createElement(el,{key:"ms-tab-settings-"+e.id,tooltipId:e.tooltipId,eventKey:e.id,onClick:function(){return a(e.id)}},i().createElement(en.Glyphicon,{glyph:e.glyph}))})))),i().createElement("div",null,n.filter((function(e){return e.id&&e.id===r})).filter((function(e){return e.Component})).map((function(e){return i().createElement(e.Component,Qc({},c,{key:"ms-geostory-tab-settings-body-"+e.id}))}))))}));const fl=(0,Me.branch)((function(e){var t=e.focusedContent;return(t=void 0===t?{}:t).path}),(0,Me.compose)((0,Me.defaultProps)({isFocused:!0,editMap:!0}),_c,Lc,Hc,Bc,Fc,Uc,Wc,Gc))((function(e){var t=e.mode,n=void 0===t?p.nl.VIEW:t,r=e.isFocused,o=void 0!==r&&r,a=e.map,c=void 0===a?{}:a,l=e.onChange,u=void 0===l?function(){}:l,s=e.onChangeMap,d=void 0===s?function(){}:s,f=e.onNodeSelect,m=void 0===f?function(){}:f,y=e.selectedNodes,g=e.buttons,v=void 0===g?[]:g,b=e.editNode,h=e.closeNodeEditor,O=e.CloseBtn,w=void 0===O?function(){return null}:O,E=e.isDrawEnabled;return n===p.nl.EDIT&&o?i().createElement("div",{key:"left-column",style:{order:-1,width:400,position:"relative"}},!E&&i().createElement(ke.Z,{className:"ms-geostory-map-editor",header:i().createElement("div",{className:"ms-geostory-map-editor-header text-center"},i().createElement(en.Row,null,i().createElement(en.Col,{md:12,className:"text-center",style:{overflow:"hidden",lineHeight:"52px"}},i().createElement(w,{glyph:"1-close",className:"pull-left on-close-btn square-button no-border ",tooltipId:"geostory.contentToolbar.closeMapEditing"}),i().createElement("div",{className:"mapstore-step-title"},i().createElement(pr.Z,{msgId:"geostory.mapEditor.configureMapOptions"})))),i().createElement(Hr.Z,{transitionProps:!1,btnGroupProps:{className:"ms-geostory-map-editor-toolbar"},btnDefaultProps:{className:"square-button-md no-border",bsStyle:"primary",noTooltipWhenDisabled:!0},buttons:v}))},!!b&&[i().createElement(sl,{map:c,editNode:b}),i().createElement(pl,{closeNodeEditor:h,editNode:b,map:c,onChange:u})]||[i().createElement(dl,{map:c,onChange:u,onChangeMap:d,selectedNodes:y,onSelect:m})])):null}));var ml=n(64721),yl=n.n(ml);function gl(){return(gl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function vl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vl(Object(n),!0).forEach((function(t){hl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ol=function(e){var t=function(){return i().createElement("div",{className:"ms-media-error"},i().createElement(en.Glyphicon,{glyph:"exclamation-sign"}))},n=function(e){var t=e.style,n=void 0===t?{}:t;return i().createElement("div",{style:n,className:"ms-media-loader"},i().createElement(jr.Z,{size:52}))};return function(r){var o={},a=r.sectionType;if((a===p.ID.PARAGRAPH||a===p.ID.IMMERSIVE||a===p.ID.CAROUSEL)&&r.type===p.Tr.IMAGE){var c=((null==r?void 0:r.imgHeight)||9)/((null==r?void 0:r.imgWidth)||16)*100;o={paddingTop:"".concat(c,"%")}}return r.lazy?i().createElement(Pr,{key:r.loadingId,id:r.loadingId,debounceTime:r.debounceTime,loading:r.isLoading,onLoad:function(e){return r.onLoad(bl(bl({},r.loading),{},hl({},e,!1)))},loaderComponent:n,loaderStyle:o},i().createElement(e,gl({},r,{type:r.type,loaderComponent:n,loaderStyle:o,errorComponent:t}))):i().createElement(e,gl({},r,{key:r.id,type:r.mediaType||r.type,loaderComponent:n,errorComponent:t}))}};var wl=n(7848),El=n(19983),Sl=["autoplay"],Pl=["type"];function jl(){return(jl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Tl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tl(Object(n),!0).forEach((function(t){Il(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Il(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kl(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var xl={image:(0,Me.branch)((function(e){return e.resourceId}),(0,Me.compose)((0,a.connect)((0,c.P1)(z.jq,(function(e){return{resources:e}}))),(0,Me.withProps)((function(e){var t=e.resources,n=e.resourceId;return(hn()(t,{id:n})||{}).data}))),(0,Be.Z)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.sectionType;return!n&&r!==p.ID.TITLE&&!yl()([p.ID.IMMERSIVE,p.ID.CAROUSEL],r)}),(function(){return{glyph:"picture"}})))(Ol(Jt)),map:(0,Me.compose)((0,Me.branch)((function(e){return e.resourceId}),Lc),wl.Z,El.Z,zc,qc,xn)(Ol($n)),video:(0,Me.branch)((function(e){return e.resourceId}),(0,Me.compose)((0,a.connect)((0,c.P1)(z.jq,(function(e){return{resources:e}}))),(0,Me.withProps)((function(e){var t=e.resources,n=e.resourceId,r=e.autoplay,o=(hn()(t,{id:n})||{}).data||{},i=o.autoplay;return Cl(Cl({},kl(o,Sl)),{},{autoplay:void 0!==r?r:i})}))),(0,Be.Z)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.src,n=void 0===t?"":t,r=e.sectionType;return!n&&r!==p.ID.TITLE&&!yl()([p.ID.IMMERSIVE,p.ID.CAROUSEL],r)}),(function(){return{glyph:"play"}})))(Ol(Xn.Z))};const Ml=function(e){var t=e.type,n=kl(e,Pl),r=xl[t];return r?i().createElement(r,jl({type:t},n)):null};var Al=["resources"];function Rl(){return(Rl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}const Dl=(0,a.connect)((0,c.P1)(z.jq,(function(e){return{resources:e}})))((function(e){var t=e.resources,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Al);if(n.resourceId){var r=(hn()(t,{id:n.resourceId})||{}).data||{};return i().createElement(Go,Rl({},r,n))}return i().createElement(Go,n)}));var Nl=["story","mode","onAdd","messages","fontFamilies","storyFonts","webFont","onUpdate","onBasicError","onUpdateMediaEditorSetting","mediaEditorSettings"];function Ll(){return(Ll=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var _l=function(e){var t=e.story,n=e.mode,r=void 0===n?p.nl.VIEW:n,a=e.onAdd,c=e.messages,l=e.fontFamilies,s=void 0===l?[]:l,f=e.storyFonts,m=void 0===f?[]:f,y=e.webFont,g=void 0===y?u():y,v=e.onUpdate,b=void 0===v?function(){}:v,h=e.onBasicError,O=void 0===h?function(){}:h,w=e.onUpdateMediaEditorSetting,E=e.mediaEditorSettings,S=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Nl),P=(0,o.useCallback)((function(e){return(0,d.S$)(c,e)}),[c]),j=function(e,t,n,r){return a(e,t,n,r?P(r):P)};return(0,o.useEffect)((function(){window.__geostory_interaction=function(e,t){"scrollTo"===e&&(0,p.M1)(t,{behavior:"smooth"})}}),[]),(0,o.useEffect)((function(){b("settings.theme.fontFamilies",s,"merge"),E&&w(E)}),[]),(0,o.useEffect)((function(){m.length>0&&m.filter((function(e){var t=e.src;return t&&!document.head.querySelector("link[href='".concat(t,"']"))})).length>0&&g.load((0,p.bm)(m,(function(){}),(function(){return O({message:"geostory.builder.settings.webFontLoadError"})})))}),[m]),i().createElement(ke.Z,{className:"ms-geostory",columns:[i().createElement(fl,Ll({},S,{add:j,update:b,mode:r}))]},i().createElement(Cc,Ll({},t,S,{storyFonts:(0,p._R)(m),add:j,update:b,mode:r,mediaViewer:Ml,contentToolbar:Dl})))};_l.defaultProps={storyFonts:[],fontFamilies:[],onUpdateMediaEditorSetting:function(){}};const Bl=(0,s.rx)("GeoStory",{component:(0,a.connect)((0,c.zB)({mode:z.eK,story:z.Kg,messages:Ce.Ps,focusedContent:z.FW,isContentFocused:z.z7,theme:function(e){var t;return(null===(t=(0,z.TQ)(e))||void 0===t?void 0:t.theme)||{}},storyFonts:z.mm,isDrawEnabled:z.HB}),{onAdd:m.IH,onUpdate:m.Vx,updateCurrentPage:m.RZ,onUpdateSetting:m.m7,remove:m.Od,onSort:m.pB,editMedia:y.Ql,editWebPage:m.o2,onBasicError:f.d,onUpdateMediaEditorSetting:m.Fu,onEnableDraw:m.EE})(_l),reducers:{geostory:Ie.Z},epics:r})},66113:(e,t,n)=>{"use strict";n.d(t,{$F:()=>S,eg:()=>P,Kg:()=>j,PR:()=>T,eK:()=>C,pu:()=>I,Lu:()=>x,W5:()=>M,TQ:()=>A,KR:()=>D,sY:()=>N,vv:()=>L,jq:()=>_,Tr:()=>B,w:()=>U,CK:()=>F,u5:()=>Z,z7:()=>W,FW:()=>H,GC:()=>G,yL:()=>z,_O:()=>q,JM:()=>K,bU:()=>$,mm:()=>X,X6:()=>Y,NR:()=>Q,I0:()=>J,eB:()=>ee,HB:()=>te});var r=n(27361),o=n.n(r),i=n(13311),a=n.n(i),c=n(30998),l=n.n(c),u=n(18446),s=n.n(u),p=n(44908),d=n.n(p),f=n(64721),m=n.n(f),y=n(92579),g=n(74621),v=n(24684);function b(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(e){return function(t){return o()(t,(0,y.Ll)("geostory.currentStory.".concat(e),t),"")}},P=function(e){return o()(e,"geostory.isCollapsed",!1)},j=function(e){return o()(e,"geostory.currentStory")},T=function(e){return o()(e,"geostory.currentPage",{})},C=function(e){return o()(e,"geostory.mode")},I=function(e){return function(e){return o()(function(e){return o()(e,"geostory.resource")}(e),"canEdit",!1)}(e)||(0,g.qg)(e)},k=function(e){return o()(j(e),"sections",[])},x=function(e){return k(e).length>0},M=function(e){return o()(e,"geostory.isSettingsEnabled",!1)},A=function(e){var t=o()(j(e),"settings",{}),n=k(e).filter((function(e){var t=e.type;return m()([y.ID.CAROUSEL,y.ID.IMMERSIVE],t)})),r=t.checked||[],i=d()(r.map((function(e){return(0,y.Un)(n,e)})).filter((function(e){return e})));return w(w({},t),{},{expanded:i})},R=function(e){return o()(A(e),"checked",[]).reduce((function(e,t){return w(w({},e),{},E({},t,!0))}),{})},D=function(e){return!s()(o()(j(e),"settings",{}),function(e){return o()(e,"geostory.oldSettings",{})}(e))},N=function(e){return o()(e,"geostory.selectedCard","")},L=function(e){return function(t){return S("".concat(e,".resourceId"))(t)}},_=function(e){return o()(j(e),"resources",[])},B=function(e){return function(t){return a()(_(t),{id:e})}},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.withImmersiveSection,n=void 0!==t&&t,r=e.includeAlways,o=void 0===r||r;return function(e){var t=k(e),r=R(e);return t.reduce((function(e,t){if(t.type===y.ID.TITLE&&(o||r[t.id]))return[].concat(b(e),[t]);if(t.type===y.ID.PARAGRAPH&&(o||r[t.id]))return[].concat(b(e),[t]);if(t.type===y.ID.BANNER&&(o||r[t.id]))return[].concat(b(e),[t]);if(t.type===y.ID.CAROUSEL&&(o||r[t.id]))return[].concat(b(e),[t]);if(t.type===y.ID.IMMERSIVE){var i=t.contents&&t.contents.reduce((function(e,t){return o||r[t.id]?[].concat(b(e),[w(w({},t),{},{sectionId:e.id})]):e}),[])||[];return n?[].concat(b(e),[t],b(i)):[].concat(b(e),b(i))}return e}),[])}},F=function(e){return U({includeAlways:!0})(e).length},Z=function(e){return l()(U({includeAlways:!0})(e),{id:T(e).columns&&T(e).columns[T(e).sectionId]?T(e).columns[T(e).sectionId]:T(e).sectionId||""})},W=function(e){return void 0!==o()(e,"geostory.focusedContent.target")},H=function(e){return o()(e,"geostory.focusedContent")},G=function(e){return S(o()(e,"geostory.focusedContent.path",""))(e)},z=function(e){return k(e).reduce((function(e,t){if(m()([y.ID.IMMERSIVE,y.ID.CAROUSEL],t.type)){var n=t.contents&&t.contents.map((function(e){return{label:e.title||"",value:e.id}}))||[];return[].concat(b(e),[w({label:t.title||"",value:t.id},t.type===y.ID.IMMERSIVE&&{children:n})])}return[].concat(b(e),[{label:t.title||"",value:t.id}])}),[])},V=function e(t,n){var r=n.contents,o=n.background;return n.resourceId===t||!(!o||o.resourceId!==t)||!!r&&!!a()(r,(function(n){return e(t,n)}))},q=function(e,t){return!!a()(k(e),(function(e){return V(t,e)}))},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,v.F)(e).includes("geostory/shared")},$=function(e){return o()(e,"geostory.updateUrlOnScroll",!1)},X=function(e){return o()(e,"geostory.currentStory.settings.theme.fontFamilies",[])},Y=function(e){return o()(e,"geostory.mediaEditorSettings")},Q=function(e){var t;return((null===(t=j(e))||void 0===t?void 0:t.sections)||[]).filter((function(e){return e.type===y.ID.CAROUSEL}))},J=function(e){return function(t){return!!a()(Q(t),{id:e})}},ee=function(e){return function(t){var n=a()(Q(t)||[],{id:e});return(null==n?void 0:n.contents)||[]}},te=function(e){var t;return!(null==e||null===(t=e.geostory)||void 0===t||!t.drawOptions)}},8316:(e,t,n)=>{"use strict";n.d(t,{Pz:()=>a,Ps:()=>c,KV:()=>l});var r=n(22222),o=n(91175),i=n.n(o),a=function(e){return e.locale&&e.locale.current||"en-US"},c=function(e){return e.locale&&e.locale.messages||{}},l=(0,r.P1)([a],(function(e){return i()(e.split("-"))}))},24684:(e,t,n)=>{"use strict";n.d(t,{F:()=>i,y:()=>a});var r=n(27361),o=n.n(r),i=function(e){return o()(e,"router.location.pathname")||"/"},a=function(e){return o()(e,"router.location.search")||""}},76712:(e,t,n)=>{"use strict";n.d(t,{n0:()=>z,tW:()=>q,FJ:()=>K,F8:()=>$,ll:()=>Y,eL:()=>Q,AD:()=>J,oR:()=>ee,LZ:()=>te,eX:()=>ne,QQ:()=>re,B8:()=>oe,T6:()=>ie});var r=n(27418),o=n.n(r),i=n(91175),a=n.n(i),c=n(1469),l=n.n(c),u=n(47037),s=n.n(u),p=n(84596),d=n.n(p),f=n(13218),m=n.n(f),y=n(89734),g=n.n(y),v=n(44908),b=n.n(v),h=n(64721),O=n.n(h),w=n(27361),E=n.n(w),S=n(14293),P=n.n(S),j=n(41609),T=n.n(j),C=n(72500),I=n.n(C),k=n(86267),x=n(37275),M=n(24262),A=n(86638),R=n(7294),D=n(33044),N=n(67007),L=n(88798);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){U(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var F=function(e){return e&&e.replace(/\/csw$/,"/")},Z=function(e){return m()(e)&&e._||e},W=function(e,t){return e.filter((function(n){return R.C2(t,n,e,t,null)}))},H=function(e){var t=Array.isArray(e.references)?e.references:[e.references];return a()([].filter.call(t,(function(t){return"WWW:LINK-1.0-http--image-thumbnail"===t.scheme||"thumbnail"===t.scheme||"WWW:DOWNLOAD-1.0-http--download"===t.scheme&&-1!==(t.value||"").indexOf("".concat(e.identifier||"","-thumb"))||"WWW:DOWNLOAD-REST_MAP"===t.scheme&&-1!==(t.value||"").indexOf("".concat(e.identifier||"","-thumb"))})))},G={csw:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e;return r&&r.records?r.records.map((function(e){var r,i,c,u=e.dc;if(u&&u.URI){var p=l()(u.URI)?u.URI:u.URI&&[u.URI]||[],f=a()([].filter.call(p,(function(e){return"thumbnail"===e.name})))||a()([].filter.call(p,(function(e){var t;return!e.name&&(null===(t=e.protocol)||void 0===t?void 0:t.indexOf("image/"))>-1})));r=f?f.value:null,i=a()([].filter.call(p,(function(e){return e.protocol&&(e.protocol.match(/^OGC:WMS-(.*)-http-get-map/g)||e.protocol.match(/^OGC:WMS/g))})))}if(!i&&u&&u.references&&u.references.length){var m=Array.isArray(u.references)?u.references:[u.references];if(i=a()([].filter.call(m,(function(e){return e.scheme&&(e.scheme.match(/^OGC:WMS-(.*)-http-get-map/g)||"OGC:WMS"===e.scheme)})))){var y=I().parse(i.value,!0),v=y.query&&y.query.layers||u.alternative;i=o()({},i,{name:v})}}if(!i&&u&&u.references&&u.references.length){var h=Array.isArray(u.references)?u.references:[u.references];if(c=a()([].filter.call(h,(function(e){return e.scheme&&"WWW:DOWNLOAD-REST_MAP"===e.scheme})))){var w=u.alternative;c=o()({},c,{name:w})}}if(!r&&u&&u.references){var E=H(u);E&&(r=E.value)}var S=[];if(u&&u.references&&(Array.isArray(u.references)?u.references:[u.references]).filter((function(e){return e.scheme.indexOf("http-get-capabilities")>-1})).forEach((function(e){var n=0===e.value.indexOf("http")?e.value:(t&&t.catalogURL||"")+"/"+e.value;S.push({type:e.scheme,url:n})})),i&&i.name){0===i.value.indexOf("http")||o()({},i,{value:(t&&t.catalogURL||"")+"/"+i.value});var P={type:i.protocol||i.scheme,url:i.value,SRS:[],params:{name:i.name}};S.push(P)}if(c&&c.name){var j={type:"arcgis",url:c.value,SRS:[],params:{name:c.name}};S.push(j)}r&&(0===r.indexOf("http")||(r=(F(t&&t.url)||"")+r));var T={boundingBox:e.boundingBox&&e.boundingBox.extent&&d()(e.boundingBox.extent.join(","))};if(u&&(T=B(B({},T),g()(Object.keys(u)).reduce((function(e,t){return B(B({},e),{},U({},t,b()(d()(u[t]))))}),{}))),u&&u.URI&&d()(u.URI)&&d()(u.URI).length&&(T=B(B({},T),{},{uri:["<ul>"+d()(u.URI).map((function(e){return'<li><a target="_blank" href="'.concat(e.value,'">').concat(e.name,"</a></li>")})).join("")+"</ul>"]})),u&&u.subject&&d()(u.subject)&&d()(u.subject).length&&(T=B(B({},T),{},{subject:["<ul>"+d()(u.subject).map((function(e){return"<li>".concat(e,"</li>")})).join("")+"</ul>"]})),S&&d()(S).length?T=B(B({},T),{},{references:["<ul>"+d()(S).map((function(e){return'<li><a target="_blank" href="'.concat(e.url,'">').concat(e.params&&e.params.name||e.url,"</a></li>")})).join("")+"</ul>"]}):delete T.references,u&&u.temporal){var C=u.temporal.split("; ");if(C.length){var k=C.filter((function(e){return-1!==e.indexOf("scheme=")})).map((function(e){var t=e.indexOf("=");return e.substr(t+1,e.length-1)}));k=k.length?k[0]:"W3C-DTF";var x=C.filter((function(e){return-1!==e.indexOf("start=")||-1!==e.indexOf("end=")})).map((function(e){var t=e.indexOf("="),r=e.substr(0,t),o=e.substr(t+1,e.length-1),i=e.length-t-1<=10;return O()(["start","end"],r)&&"W3C-DTF"===k&&!i?(0,A.S$)(n,"catalog.".concat(r))+new Date(o).toLocaleString():O()(["start","end"],r)?(0,A.S$)(n,"catalog.".concat(r))+o:""}));T=B(B({},T),{},{temporal:["<ul>"+x.map((function(e){return"<li>".concat(e,"</li>")})).join("")+"</ul>"]})}}return{boundingBox:e.boundingBox,description:u&&s()(u.abstract)&&u.abstract||"",layerOptions:t&&t.layerOptions||{},identifier:u&&s()(u.identifier)&&u.identifier||"",references:S,thumbnail:r,title:u&&s()(u.title)&&u.title||"",tags:u&&u.tags||"",metadata:T}})):null},wms:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&e.records?e.records.map((function(n){return{capabilities:n,credits:n.credits,boundingBox:N.ZP.getBBox(n),description:n.Abstract||n.Title||n.Name,identifier:n.Name,service:e.service,tags:"",layerOptions:B(B({},(null==t?void 0:t.layerOptions)||{}),(null==e?void 0:e.layerOptions)||{}),title:(0,M.EM)(n)||n.Name,formats:d()(n.formats||[]),dimensions:(n.Dimension&&d()(n.Dimension)||[]).map((function(e){return o()({},{values:e._&&e._.split(",")||[]},e.$||{})})).filter((function(e){return e&&"time"!==e.name})),references:[{type:"OGC:WMS",url:t&&t.url,SRS:n.SRS&&(l()(n.SRS)?n.SRS:[n.SRS])||[],params:{name:n.Name}}]}})):null},wmts:function(e,t){return e&&e.records?e.records.map((function(e){var n=d()(R.f1(e)||t&&t.url);1===n.length&&(n=n[0]);var r=R.dN(e),i=d()(e.TileMatrixSetLink||[]).reduce((function(t,n){var r,i=a()((e.TileMatrixSet&&d()(e.TileMatrixSet)||[]).filter((function(e){return e["ows:Identifier"]===n.TileMatrixSet}))),c=i&&k.default.getEPSGCode(i["ows:SupportedCRS"]),l=n.TileMatrixSetLimits&&(n.TileMatrixSetLimits.TileMatrixLimits||[]).map((function(e){return{identifier:e.TileMatrix,ranges:{cols:{min:e.MinTileCol,max:e.MaxTileCol},rows:{min:e.MinTileRow,max:e.MaxTileRow}}}}))||i.TileMatrix.map((function(e){return{identifier:e["ows:Identifier"]}}));return o()(t,(U(r={},i["ows:Identifier"],l),U(r,c,l),r))}),{}),c=function(e){var t=e["ows:WGS84BoundingBox"];return t||(t={"ows:LowerCorner":"-180.0 -90.0","ows:UpperCorner":"180.0 90.0"}),t}(e);return{title:Z(e["ows:Title"]||e["ows:Identifier"]),description:Z(e["ows:Abstract"]||e["ows:Title"]||e["ows:Identifier"]),identifier:Z(e["ows:Identifier"]),tags:"",layerOptions:t&&t.layerOptions||{},style:e.style,capabilitiesURL:r,queryable:e.queryable,requestEncoding:e.requestEncoding,tileMatrixSet:e.TileMatrixSet,matrixIds:i,format:e.format,TileMatrixSetLink:d()(e.TileMatrixSetLink),boundingBox:{extent:[c["ows:LowerCorner"].split(" ")[0],c["ows:LowerCorner"].split(" ")[1],c["ows:UpperCorner"].split(" ")[0],c["ows:UpperCorner"].split(" ")[1]],crs:"EPSG:4326"},references:[{type:"OGC:WMTS",url:n,SRS:W(e.SRS||[],i),params:{name:e["ows:Identifier"]}}]}})):null},tms:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&e.records){var n=t.service&&"tms"===t.service.provider;return n?e.records.map((function(e){return{title:e.title,tileMapUrl:e.href,description:"".concat(e.srs).concat(e.format?", "+e.format:""),tmsUrl:t.tmsUrl,references:[{type:"OGC:TMS",version:"1.0.0",url:t.url}]}})):e.records.map((function(e){return{title:e.title||e.provider,url:e.url,attribution:e.attribution,options:e.options,provider:e.provider,type:"tileprovider",references:[]}}))}return null},wfs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.records;return t?t.map((function(e){return B(B({},e),{},{references:[{type:"OGC:WFS-1.1.0-http-get-capabilities",url:e.url},{type:"OGC:WFS-1.1.0-http-get-feature",url:e.url}]})})):null},backgrounds:function(e){return e&&e.records?e.records.map((function(e){return{description:e.title,title:e.title,identifier:e.name,thumbnail:e.thumbURL,references:[],background:e}})):null}},z=function(e){return e.filter((function(e){return k.default.isSRSAllowed(e)})).reduce((function(e,t){return o()(e,U({},t,!0))}),{})},V=function(e,t){var n=e.split("?"),r={};return n.length>=2&&n[1]&&n[1].split(/[&;]/g).forEach((function(e){var n=e.split("=");-1===t.indexOf(n[0].toLowerCase())&&(r[n[0]]=n[1])})),{url:n[0],params:r}},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.references,n=void 0===t?[]:t;return{wfs:a()(n.filter((function(e){return e.type&&("OGC:WFS"===e.type||e.type.indexOf("OGC:WFS")>-1&&e.type.indexOf("http-get-feature")>-1)}))),wms:a()(n.filter((function(e){return e.type&&("OGC:WMS"===e.type||e.type.indexOf("OGC:WMS")>-1&&e.type.indexOf("http-get-map")>-1)}))),wmts:a()(n.filter((function(e){return e.type&&("OGC:WMTS"===e.type||e.type.indexOf("OGC:WMTS")>-1&&e.type.indexOf("http-get-map")>-1)}))),tms:a()(n.filter((function(e){return e.type&&("OGC:TMS"===e.type||e.type.indexOf("OGC:TMS")>-1)})))}},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{references:[]};return{esri:a()(e.references.filter((function(e){return e.type&&("ESRI:SERVER"===e.type||"arcgis"===e.type)})))}},$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.references,n=void 0===t?[]:t,r=a()(n.filter((function(e){return e.type&&e.type.indexOf("OGC:WMS")>-1&&e.type.indexOf("http-get-capabilities")>-1}))),o=a()(n.filter((function(e){return e.type&&e.type.indexOf("OGC:WFS")>-1&&e.type.indexOf("http-get-capabilities")>-1}))),i=a()(n.filter((function(e){return e.type&&e.type.indexOf("OGC:WMTS")>-1&&e.type.indexOf("http-get-capabilities")>-1}))),c=[];return r&&c.push({type:"WMS_GET_CAPABILITIES",url:r.url,labelId:"catalog.wmsGetCapLink"}),i&&c.push({type:"WMTS_GET_CAPABILITIES",url:i.url,labelId:"catalog.wmtsGetCapLink"}),o&&c.push({type:"WFS_GET_CAPABILITIES",url:o.url,labelId:"catalog.wfsGetCapLink"}),c},X=function(e){return e&&!l()(e)&&-1!==e.indexOf(",")?e.split(",").map((function(e){return e.trim()})):e},Y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"wms",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.removeParams,o=void 0===r?[]:r,i=n.format,a=n.catalogURL,c=n.url,u=n.formats,s=void 0===u?{}:u,p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},d=arguments.length>4?arguments[4]:void 0;if(!e||!e.references)return null;var f,m,y=q(e),g=y.wms,v=y.wmts,b=g||v,h=function(e){return V(x.ZP.cleanDuplicatedQuestionMarks(e),["request","layer","layers","service","version"].concat(o))},O=X(b.url);if(O&&l()(O))f=O.map((function(e){return h(e)})).map((function(e){return e.url})),m=O.map((function(e){return h(e)})).map((function(e){return e.params})).reduce((function(e,t){return B(B({},e),t)}),{});else{var w=h(O||a),E=w.url,S=w.params;f=E,m=S}var j=function(e){return l()(e)&&1===e.length?e[0]:e},C=j(c||f),I=z(b.SRS);return B(B(B({type:t,requestEncoding:e.requestEncoding,style:e.style,format:i,url:C,capabilitiesURL:e.capabilitiesURL,queryable:e.queryable,visibility:!0,dimensions:e.dimensions||[],name:b.params&&b.params.name,title:e.title||b.params&&b.params.name,matrixIds:"wmts"===t?e.matrixIds||[]:void 0,description:e.description||"",tileMatrixSet:"wmts"===t?e.tileMatrixSet||[]:void 0,credits:!x.ZP.getConfigProp("noCreditsFromCatalog")&&e.credits,bbox:{crs:e.boundingBox.crs,bounds:{minx:e.boundingBox.extent[0],miny:e.boundingBox.extent[1],maxx:e.boundingBox.extent[2],maxy:e.boundingBox.extent[3]}},links:$(e),params:m,allowedSRS:I,catalogURL:a},p),e.layerOptions),{},{localizedLayerStyles:P()(d)?void 0:d},"wms"===t&&!T()(s)&&{imageFormats:s.imageFormats,infoFormats:s.infoFormats})},Q=function(e,t,n,r){return G[e]&&G[e](t,n,r)||null},J=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||!e.references)return null;var n=K(e),r=n.esri;return B({type:r.type,url:r.url,visibility:!0,dimensions:e.dimensions||[],name:r.params&&r.params.name,bbox:{crs:e.boundingBox.crs,bounds:{minx:e.boundingBox.extent[0],miny:e.boundingBox.extent[1],maxx:e.boundingBox.extent[2],maxy:e.boundingBox.extent[3]}}},t)},ee=function(e,t,n){var r=e.tileMapUrl,o=t.TileMap,i=void 0===o?{}:o,a=n.forceDefaultTileGrid,c=i.Title,l=i.Abstract,u=i.SRS,s=i.BoundingBox,p=void 0===s?{}:s,f=i.Origin,m=i.TileFormat,y=void 0===m?{}:m,g=i.TileSets,v=i.$,b=v.version,h=v.tilemapservice,O=E()(p,"$",{}),w=O.minx,S=O.miny,P=O.maxx,j=O.maxy,T=E()(f,"$"),C=T.x,I=T.y,k=E()(y,"$",{}),x=k.width,M=k.height,A=k["mime-type"],R=k.extension,N=[parseFloat(x),parseFloat(M,10)],L=d()(E()(g,"TileSet",[]).map((function(e){return e.$}))).map((function(e){var t=e.href,n=e.order,r=e["units-per-pixel"];return{href:(0,D.cleanAuthParamsFromURL)(t),order:parseFloat(n),resolution:parseFloat(r)}})),_=E()(g,"profile");return{title:c,visibility:!0,hideErrors:!0,name:c,allowedSRS:U({},u,!0),description:l,srs:u,version:b,tileMapService:h?(0,D.cleanAuthParamsFromURL)(h):void 0,type:"tms",profile:_,tileMapUrl:r,forceDefaultTileGrid:a,bbox:p&&{crs:u,bounds:{minx:parseFloat(w),miny:parseFloat(S),maxx:parseFloat(P),maxy:parseFloat(j)}},tileSets:L,origin:{x:parseFloat(C),y:parseFloat(I)},format:A,tileSize:N,extension:R}},te=function(e){return B({type:e.type||"wfs",search:{url:e.url,type:"wfs"},url:e.url,queryable:e.queryable,visibility:!0,name:e.name,title:e.title||e.name,description:e.description||"",bbox:e.boundingBox,links:$(e),style:{weight:1,color:"rgba(0, 0, 255, 1)",opacity:1,fillColor:"rgba(0, 0, 255, 0.1)",fillOpacity:.1,radius:10}},e.layerOptions)},ne=function(e){return{type:"tileprovider",visibility:!0,url:e.url,title:e.title,attribution:e.attribution,options:e.options,provider:e.provider,name:e.provider}},re=[{label:"image/png",value:"image/png"},{label:"image/png8",value:"image/png8"},{label:"image/jpeg",value:"image/jpeg"},{label:"image/vnd.jpeg-png",value:"image/vnd.jpeg-png"},{label:"image/vnd.jpeg-png8",value:"image/vnd.jpeg-png8"},{label:"image/gif",value:"image/gif"}],oe=function(){return b()(Object.values((0,L.eq)()))},ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return N.ZP.getCapabilities(e).then((function(e){var n,r,o=E()(e,"capability.request.getMap.format",[]);if(T()(o))n=re;else{var i=re.map((function(e){return e.value}));n=(o=o.map((function(e){var t=e.value;return{label:t,value:t}}))).filter((function(e){var t=e.value;return O()(i,t)}))||[]}if(t){var a=E()(e,"capability.request.getFeatureInfo.format",[]),c=oe();T()(a)?r=c:(a=a.map((function(e){return e.value})),r=b()(a.filter((function(e){return O()(c,e)})))||[])}return t?{imageFormats:n,infoFormats:r}:n})).catch((function(){return t?{imageFormats:re,infoFormats:oe()}:re}))}},43143:(e,t,n)=>{"use strict";n.d(t,{qH:()=>l,qj:()=>u,qq:()=>s});var r,o=n(17621),i=n.n(o),a=n(14841),c=n.n(a),l=function(e,t,n,o){var i=e;isNaN(parseFloat(e))&&(i=r.hexToHsv(e)[0]);var a=.5/(n-1),c=t/(n-1),l=[];1===n&&(a=.5,c=t/2);for(var u=0;u<n;u++){var s=i+u*c-t/2,p=a*u+.3,d=p;o&&(s=o.h||s,p=o.s||p,d=o.v||d),l.push(r.hsvToHex(s,p,d,u))}return l},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"red";return i()(e).toHexString()},s=function(e,t,n){var r=i()(e);return e&&r.setAlpha(c()(void 0!==t?t:r.getAlpha())).toRgbString()||n};r={decToHex:function(e){var t="0123456789ABCDEF",n=parseInt(e,10);return n=isNaN(n)?0:n,t.charAt(((n=n>255||n<0?0:n)-n%16)/16)+t.charAt(n%16)},rgbToHex:function(e,t,n){return e instanceof Array?r.rgbToHex(e[0],e[1],e[2]):"#"+r.decToHex(e)+r.decToHex(t)+r.decToHex(n)},realToDec:function(e){return Math.min(255,Math.round(256*e))},rgbToHsv:function(e,t,n){if(e instanceof Array)return r.rgbToHsv(e[0],e[1],e[2]);var o,i,a,c,l,u=e/255,s=t/255,p=n/255;switch(o=Math.min(Math.min(u,s),p),a=(i=Math.max(Math.max(u,s),p))-o,i){case o:c=0;break;case u:c=60*(s-p)/a,s<p&&(c+=360);break;case s:c=60*(p-u)/a+120;break;case p:c=60*(u-s)/a+240}return l=0===i?0:1-o/i,[Math.round(c),l,i]},distributedColorsHEX:function(e){for(var t=360/(e-1),n=[],o=function e(t,n,o){var i=e(t,n,o);return r.rgbToHex(i)},i=0;i<e;i++)n.push(o(t*i,.57,.63));return n},sameToneRangeColors:l,hsvToRgb:function(e,t,n){if(e instanceof Array)return r.hsvToRgb(e[0],e[1],e[2]);var o,i,a,c=Math.floor(e/60%6),l=e/60-c,u=n*(1-t),s=n*(1-l*t),p=n*(1-(1-l)*t);switch(c){case 0:o=n,i=p,a=u;break;case 1:o=s,i=n,a=u;break;case 2:o=u,i=n,a=p;break;case 3:o=u,i=s,a=n;break;case 4:o=p,i=u,a=n;break;case 5:o=n,i=u,a=s}return[r.realToDec(o),r.realToDec(i),r.realToDec(a)]},hsvToHex:function(e,t,n){var o=r.hsvToRgb(e,t,n);return r.rgbToHex(o)},hexToHsv:function(e){var t=e;if(t.length>0){"#"===t[0]&&(t=e.substring(1));var n=r.hexToRgb(t);return r.rgbToHsv(n)}return null},hexToRgb:function(e){var t,n,r,o=e;return"#"===o.charAt(0)&&(o=e.substring(1)),t=o.charAt(0)+o.charAt(1),n=o.charAt(2)+o.charAt(3),r=o.charAt(4)+o.charAt(5),[parseInt(t,16),parseInt(n,16),parseInt(r,16)]},colorToHexStr:u,colorToRgbaStr:s}},92579:(e,t,n)=>{"use strict";n.d(t,{gg:()=>A,Ln:()=>R,ID:()=>D,bT:()=>N,tQ:()=>L,Tr:()=>_,nl:()=>B,ZX:()=>U,lg:()=>F,w:()=>Z,cy:()=>W,lt:()=>H,M1:()=>G,kn:()=>V,oH:()=>q,Aq:()=>$,nq:()=>X,Ll:()=>Y,ln:()=>Q,Un:()=>J,NC:()=>ee,t4:()=>te,NP:()=>ne,bm:()=>re,_R:()=>oe,Km:()=>ie,of:()=>ae,u0:()=>ce,eI:()=>le,Yh:()=>ue});var r=n(27361),o=n.n(r),i=n(30998),a=n.n(i),c=n(30084),l=n.n(c),u=n(1469),s=n.n(u),p=n(52628),d=n.n(p),f=n(63105),m=n.n(f),y=n(82492),g=n.n(y),v=n(47037),b=n.n(v),h=n(13218),O=n.n(h),w=n(64721),E=n.n(w),S=n(13880),P=n.n(S),j=n(55877),T=n.n(j);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e){return function(e){if(Array.isArray(e))return M(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A="EMPTY_CONTENT",R={CASCADE:"cascade"},D={TITLE:"title",PARAGRAPH:"paragraph",IMMERSIVE:"immersive",BANNER:"banner",CAROUSEL:"carousel"},N={TEXT:"text",MEDIA:"media",WEBPAGE:"webPage",COLUMN:"column"},L={MEDIA:"template-media",WEBPAGE:"template-web-page"},_={IMAGE:"image",MAP:"map",VIDEO:"video"},B={EDIT:"edit",VIEW:"view"},U={SHOW_SAVE:"save.show",LOADING:"loading"},F={StoryTypes:d()(R),SectionTypes:d()(D),MediaTypes:d()(_),Modes:d()(B)},Z=function(e){var t=e.theme,n=void 0===t?{}:t,r=e.align,o=void 0===r?"center":r,i=e.size,a=void 0===i?"full":i,c=(null==n?void 0:n.value)||b()(n)&&n,l=c&&"custom"!==c&&b()(c)&&" ms-".concat(c)||"",u=" ms-align-".concat(o),s=" ms-size-".concat(a);return"".concat(l).concat(u).concat(s)},W=function(e){var t=e.theme,n=void 0===t?{}:t,r=e.storyTheme;if(""===n||""===(null==n?void 0:n.value))return O()(r)?r:{};var o=null==n?void 0:n.value,i=null==n?void 0:n[o];return O()(i)&&i||{}},H=function(e){return e.type===D.PARAGRAPH&&e&&s()(e.contents)&&e.contents.length&&s()(e.contents[0].contents)&&e.contents[0].contents.length&&e.contents[0].contents[0].type===N.MEDIA},G=function(e,t){var n=function(e){var t=e.split("?");return 2===t.length?t[0]:e}(e),r=document.getElementById(n);r&&r.scrollIntoView(t)},z={zoomControl:!0,mapInfoControl:!1,mapOptions:{scrollWheelZoom:!1,interactions:{mouseWheelZoom:!1,dragPan:!0}}},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return g()({},z,e)},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return g()({},e,t)},K=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:RegExp(t,"i");return!t||n.test(e)},$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:RegExp(t,"i");return m()(e,(function(e){return K(e.data&&(e.data.title||e.data.name),t,n)||K(e.data&&e.data.description,t,n)}))},X=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};switch(t){case D.TITLE:return{id:T()(),type:D.TITLE,title:n("geostory.builder.defaults.titleTitle"),cover:!1,contents:[{id:T()(),type:N.TEXT,html:"",size:"large",align:"center",theme:"",background:{fit:"cover",size:"full",align:"center"}}]};case D.BANNER:return{id:T()(),type:D.BANNER,title:n("geostory.builder.defaults.titleBanner"),cover:!1,contents:[{id:T()(),background:{fit:"cover",size:"full",align:"center"}}]};case D.PARAGRAPH:return{id:T()(),type:D.PARAGRAPH,title:n("geostory.builder.defaults.titleParagraph"),contents:[{id:T()(),type:N.COLUMN,size:"full",align:"center",contents:[{id:T()(),type:N.TEXT,html:""}]}]};case D.IMMERSIVE:return{id:T()(),type:D.IMMERSIVE,title:n("geostory.builder.defaults.titleImmersive"),contents:[e(N.COLUMN,n("geostory.builder.defaults.titleImmersiveContent"))]};case D.CAROUSEL:return{id:T()(),type:t,title:n("geostory.builder.defaults.titleGeocarousel"),template:t,background:{fit:"cover",size:"full",align:"center"},contents:[e(N.COLUMN,n("geostory.builder.defaults.titleGeocarouselContent"))]};case L.MEDIA:return{id:T()(),type:D.PARAGRAPH,title:n("geostory.builder.defaults.titleMedia"),contents:[{id:T()(),type:N.COLUMN,contents:[{id:T()(),type:N.MEDIA,size:"large",align:"center"}]}]};case L.WEBPAGE:return{id:T()(),type:D.PARAGRAPH,title:n("geostory.builder.defaults.titleWebPageSection"),contents:[{id:T()(),type:N.COLUMN,contents:[{id:T()(),type:N.WEBPAGE,size:"medium",align:"center"}]}]};case N.COLUMN:return{id:T()(),type:N.COLUMN,align:"left",size:"small",theme:"",title:n,contents:[{id:T()(),type:N.TEXT,html:""}],background:{fit:"cover",size:"full",align:"center"}};case N.TEXT:return{id:T()(),type:N.TEXT,title:n("geostory.builder.defaults.titleText"),html:""};case N.IMAGE:return{id:T()(),type:t,title:n("geostory.builder.defaults.titleMedia"),size:"full",align:"center"};case N.WEBPAGE:return{id:T()(),type:t,title:n("geostory.builder.defaults.titleWebPage"),size:"medium",align:"center"};case N.MEDIA:return{id:T()(),type:t,title:n("geostory.builder.defaults.titleUnknown"),size:"large",align:"center"};default:return{id:T()(),type:t,title:n("geostory.builder.defaults.titleUnknown"),size:"full",align:"center"}}},Y=function(e,t){return l()(e).reduce((function(e,n){if(n&&0===n.indexOf("{")){var r=JSON.parse(n),i=o()(t,e),c=a()(i,r);return c>=0?[].concat(x(e),[c]):e}return[].concat(x(e),[n])}),[])},Q=function(e,t){return l()(e).reduce((function(e,n){var r=e.path,i=e.flatPath;if(n&&0===n.indexOf("{")){var c=JSON.parse(n),l=o()(t,r),u=a()(l,c);if(u>=0){var s=l[u],p=s.id,d=s.type;return{path:[].concat(x(r),[u]),flatPath:[].concat(x(i),[{id:p,type:r[r.length-1],contentType:d}])}}return{path:r,flatPath:i}}return{path:[].concat(x(r),[n]),flatPath:i}}),{path:[],flatPath:[]})},J=function(e,t){return e.reduce((function(e,n){return E()(n.contents.map((function(e){return e.id})),t)?n.id:e}),null)},ee=function(e){return e.type===D.PARAGRAPH&&!1!==e.editURL&&e&&s()(e.contents)&&e.contents.length&&s()(e.contents[0].contents)&&e.contents[0].contents.length&&e.contents[0].contents[0].type===N.WEBPAGE&&!1!==e.contents[0].contents[0].editURL},te=function(e,t){if(t)switch(e){case"small":return.4*t;case"medium":return.6*t;case"large":return.8*t;default:return t}return 0},ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,i="EMPTY";if(!t.includes(n))return null;var a=t.substring(t.indexOf(n)).split("/");return r&&n?a.length>1&&a[2]&&Number(a[0])===n?5===a.length?P()(e,"".concat(a[2],"/column/").concat(a[4]),"".concat(r)):P()(e,"".concat(a[2]),"".concat(r)):(t.includes("shared"),""!==a[1]?"".concat(e,"/section/").concat(r):"".concat(e,"section/").concat(r)):!r&&o&&b()(o)&&o!==i&&a.length>1?t.includes("shared")&&!a[2]?e:5===a.length?P()(e,"".concat(a[4]),"".concat(o)):"".concat(e,"/column/").concat(o):null},re=function(e,t,n){var r={active:t,inactive:n,custom:{families:[],urls:[]}};return e.filter((function(e){return!!e.src})).forEach((function(e,t){r.custom.families[t]=e.family,r.custom.urls[t]=e.src})),r},oe=function(e){return e.map((function(e){return e.family}))},ie=["inherit","Arial","Georgia","Impact","Tahoma","Times New Roman","Verdana"],ae=function(){return window.location.href.match("geostory-embedded")?"geostoryEmbedded":"geostory"},ce=function(e){var t=function(e){try{var t;return null===(t=JSON.parse(e))||void 0===t?void 0:t.id}catch(e){return null}},n=l()(e)||[];return{sectionId:t(null==n?void 0:n[1]),contentId:t(null==n?void 0:n[3]),innerContentId:t(null==n?void 0:n[5])}},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.map((function(e){return t.sectionId===e.id?I(I({},e),{},{contents:(e.contents||[]).map((function(e){return I(I({},e),{},{hideContent:e.id!==t.showContentId})}))}):e}))};function ue(e){var t=e.id,n=e.contents,r=e.featureStyle;return I(I({visibility:!0,handleClickOnLayer:!0},e.layerOptions),{},{id:"geostory-vector-".concat(t),name:"geostory-vector-".concat(t),type:"vector",features:n.reduce((function(e,t,n){return[].concat(x(e),x(((null==t?void 0:t.features)||[]).map((function(e){return I(I({},e),{},{contentRefId:t.id},r&&{style:r({content:t,feature:e},n)})}))||[]))}),[]).reverse()})}},2870:(e,t,n)=>{"use strict";n.d(t,{Q:()=>a,j:()=>c});var r=n(27361),o=n.n(r),i=n(53005),a=function(e,t){var n=e.format,r=e.queryParams,o=void 0===r?{}:r;return o.info_format||o.outputFormat||n&&i.O7[n]||t.format},c=function(e){return!!o()(e,"layer.search.url")}},52259:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DEFAULT_SCREEN_DPI:()=>Y,METERS_PER_UNIT:()=>Q,GOOGLE_MERCATOR:()=>J,EXTENT_TO_ZOOM_HOOK:()=>ee,ZOOM_TO_EXTENT_HOOK:()=>te,RESOLUTIONS_HOOK:()=>ne,RESOLUTION_HOOK:()=>re,COMPUTE_BBOX_HOOK:()=>oe,GET_PIXEL_FROM_COORDINATES_HOOK:()=>ie,GET_COORDINATES_FROM_PIXEL_HOOK:()=>ae,registerHook:()=>le,getHook:()=>ue,executeHook:()=>se,clearHooks:()=>pe,dpi2dpm:()=>de,dpi2dpu:()=>fe,getSphericalMercatorScale:()=>me,getGoogleMercatorScale:()=>ye,getSphericalMercatorScales:()=>ge,getGoogleMercatorScales:()=>ve,getResolutionsForScales:()=>be,getGoogleMercatorResolutions:()=>he,getResolutions:()=>Oe,getScales:()=>we,getZoomFromResolution:()=>Ee,defaultGetZoomForExtent:()=>Se,getZoomForExtent:()=>Pe,getCurrentResolution:()=>je,getCenterForExtent:()=>Te,getBbox:()=>Ce,isNearlyEqual:()=>Ie,mapUpdated:()=>ke,transformExtent:()=>xe,groupSaveFormatted:()=>Me,saveMapConfiguration:()=>Ae,generateNewUUIDs:()=>Re,mergeMapConfigs:()=>De,addRootParentGroup:()=>Ne,isSimpleGeomType:()=>Le,getSimpleGeomType:()=>_e,getIdFromUri:()=>Be,parseLayoutValue:()=>Ue,prepareMapObjectToCompare:()=>Fe,updateObjectFieldKey:()=>Ze,compareMapChanges:()=>We,createRegisterHooks:()=>He,default:()=>Ge});var r=n(47037),o=n.n(r),i=n(92742),a=n.n(i),c=n(81763),l=n.n(c),u=n(78718),s=n.n(u),p=n(27361),d=n.n(p),f=n(13311),m=n.n(f),y=n(95395),g=n.n(y),v=n(66604),b=n.n(v),h=n(3674),O=n.n(h),w=n(44908),E=n.n(w),S=n(87185),P=n.n(S),j=n(18446),T=n.n(j),C=n(41609),I=n.n(C),k=n(30998),x=n.n(k),M=n(50361),A=n.n(M),R=n(22762),D=n.n(R),N=n(23570),L=n.n(N),_=n(86267),B=n(61868),U=n(24262),F=n(27418),Z=n.n(F),W=["id"],H=["group"];function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function V(e){return function(e){if(Array.isArray(e))return q(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){X(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function X(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y=96,Q={m:1,degrees:111194.87428468118,ft:.3048,"us-ft":1200/3937},J={RADIUS:6378137,TILE_WIDTH:256,ZOOM_FACTOR:2},ee="EXTENT_TO_ZOOM_HOOK",te="ZOOM_TO_EXTENT_HOOK",ne="RESOLUTIONS_HOOK",re="RESOLUTION_HOOK",oe="COMPUTE_BBOX_HOOK",ie="GET_PIXEL_FROM_COORDINATES_HOOK",ae="GET_COORDINATES_FROM_PIXEL_HOOK",ce={};function le(e,t){ce[e]=t}function ue(e){return ce[e]}function se(e,t,n){var r=ue(e);return r?t(r):n?n():null}function pe(){ce={}}function de(e){return e*(100/2.54)}function fe(e,t){var n=(0,_.getUnits)(t||"EPSG:3857");return Q[n]*de(e||Y)}function me(e,t,n,r,o){return 2*Math.PI*e/(t*Math.pow(n,r)/de(o||Y))}function ye(e,t){return me(J.RADIUS,J.TILE_WIDTH,J.ZOOM_FACTOR,e,t)}function ge(e,t,n,r,o,i){for(var a=[],c=r;c<=o;c++)a.push(me(e,t,n,c,i));return a}function ve(e,t,n){return ge(J.RADIUS,J.TILE_WIDTH,J.ZOOM_FACTOR,e,t,n)}function be(e,t,n){var r=fe(n,t);return e.map((function(e){return e/r}))}function he(e,t,n){return be(ve(e,t,n),"EPSG:3857",n)}function Oe(){return ue("RESOLUTIONS_HOOK")?ue("RESOLUTIONS_HOOK")():he(0,21,Y)}function we(e,t){var n=fe(t,e);return Oe().map((function(e){return e*n}))}function Ee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Oe(),n=t.map((function(t,n){return{diff:Math.abs(t-e),zoom:n}})),r=D()(n,"diff"),o=r.zoom;return o}function Se(e,t,n,r,o,i){var a=e[2]-e[0],c=e[3]-e[1],l=Math.abs(a/t.width),u=Math.abs(c/t.height),s=Math.max(l,u),p=(i||be(ve(n,r,o||Y),"EPSG:3857",o)).reduce((function(e,t,n){var r=Math.abs(t-s);return r>e.diff?e:{diff:r,zoom:n}}),{diff:Number.POSITIVE_INFINITY,zoom:0}).zoom;return Math.max(0,Math.min(p,r))}function Pe(e,t,n,r,o){return ue("EXTENT_TO_ZOOM_HOOK")?ue("EXTENT_TO_ZOOM_HOOK")(e,t,n,r,o):Se(e,t,n,r,o,ue("RESOLUTIONS_HOOK")?ue("RESOLUTIONS_HOOK")(e,t,n,r,o,de(o||Y)):null)}function je(e,t,n,r){return ue("RESOLUTION_HOOK")?ue("RESOLUTION_HOOK")(e,t,n,r):he(t,n,r)[e]}function Te(e,t){var n=(e[2]-e[0])/2,r=(e[3]-e[1])/2;return{x:e[0]+n,y:e[1]+r,crs:t}}function Ce(e,t){return se("COMPUTE_BBOX_HOOK",(function(n){return n(e,t)}))}var Ie=function(e,t){return void 0!==e&&void 0!==t&&e.toFixed(12)-t.toFixed(12)==0};function ke(e,t){var n,r,o,i;return!(!e||I()(e)||!t||I()(t)||Ie(null==t||null===(n=t.center)||void 0===n?void 0:n.x,null==e||null===(r=e.center)||void 0===r?void 0:r.x)&&Ie(null==t||null===(o=t.center)||void 0===o?void 0:o.y,null==e||null===(i=e.center)||void 0===i?void 0:i.y)&&(null==t?void 0:t.zoom)===(null==e?void 0:e.zoom))}function xe(e,t,n,r){var o=(0,_.getUnits)(e);return"ft"===o?{width:n/Q.ft,height:r/Q.ft}:"us-ft"===o?{width:n/Q["us-ft"],height:r/Q["us-ft"]}:"degrees"===o?{width:n/(111132.92-559.82*Math.cos(2*t.y)+1.175*Math.cos(4*t.y)),height:r/(111412.84*Math.cos(t.y)-93.5*Math.cos(3*t.y))}:{width:n,height:r}}var Me=function(e){return{id:e.id,title:e.title,description:e.description,tooltipOptions:e.tooltipOptions,tooltipPlacement:e.tooltipPlacement,expanded:e.expanded}};function Ae(e,t,n,r,o,i,a){var c={center:e.center,maxExtent:e.maxExtent,projection:e.projection,units:e.units,mapInfoControl:e.mapInfoControl,zoom:e.zoom,mapOptions:e.mapOptions||{}},l=t.map((function(e){return(0,U.z8)(e)})),u=n.reduce((function(e,t){return e.concat((0,U.ar)(t))}),[].concat(n.map((function(e){return e.id})))).map((function(e){var t=(0,U.Mk)(n,e);return t&&t.nodes?Me(t):null})).filter((function(e){return e})),s=r.filter((function(e){return!!e.thumbnail})),p=(0,U.V5)(l),d=l.map((function(e){return Z()({},e,{tileMatrixSet:e.tileMatrixSet&&e.tileMatrixSet.length>0,matrixIds:e.matrixIds&&Object.keys(e.matrixIds)})})),f=x()(d,(function(e){return"annotations"===e.id}));if(-1!==f){var m=d[f].features.map((function(e){return"FeatureCollection"===e.type?$($({},e),{},{features:e.features.map((function(e){return e.properties.geometryGeodesic?(0,B.t8)("properties.geometryGeodesic",null,e):e}))}):e.properties.geometryGeodesic?(0,B.t8)("properties.geometryGeodesic",null,e):{}}));d[f]=(0,B.t8)("features",m,d[f])}return $({version:2,map:Z()({},c,{layers:d,groups:u,backgrounds:s,text_search_config:o,bookmark_search_config:i},!I()(p)&&{sources:p}||{})},a)}var Re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=A()(e),n=$($({},d()(e,"map.layers",[]).reduce((function(e,t){return $($({},e),{},X({},t.id,"annotations"===t.id?t.id:L()()))}),{})),d()(e,"widgetsConfig.widgets",[]).reduce((function(e,t){return $($({},e),{},X({},t.id,L()()))}),{}));return(0,B.t8)("map.backgrounds",d()(e,"map.backgrounds",[]).map((function(e){return $($({},e),{},{id:n[e.id]})})),(0,B.t8)("widgetsConfig",{collapsed:b()(g()(d()(e,"widgetsConfig.collapsed",{}),(function(e,t){return n[t]})),(function(e){return $($({},e),{},{layouts:b()(e.layouts,(function(e){return $($({},e),{},{i:n[e.i]})}))})})),layouts:b()(d()(e,"widgetsConfig.layouts",{}),(function(e){return e.map((function(e){return $($({},e),{},{i:n[e.i]})}))})),widgets:d()(e,"widgetsConfig.widgets",[]).map((function(e){return $($({},e),{},{id:n[e.id],layer:$($({},d()(e,"layer",{})),{},{id:n[d()(e,"layer.id")]})})}))},(0,B.t8)("map.layers",d()(e,"map.layers",[]).map((function(e){return $($({},e),{},{id:n[e.id]})})),t)))},De=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return s()(e,O()(e).filter((function(t){return void 0!==e[t]})))}))},r=Re(t),o=[].concat(V(d()(e,"map.backgrounds",[])),V(d()(r,"map.backgrounds",[]))),i=n(d()(e,"map.layers",[])),a=n(d()(r,"map.layers",[])),c=m()(i,(function(e){return"annotations"===e.id})),l=m()(a,(function(e){return"annotations"===e.id})),u=[].concat(V(a.filter((function(e){return"annotations"!==e.id}))),V(i.filter((function(e){return"annotations"!==e.id}))),V(c||l?[$($($({},c||{}),l||{}),{},{features:[].concat(V(d()(c,"features",[])),V(d()(l,"features",[])))})]:[])),p=u.filter((function(e){return"background"===e.group})),f=x()(p,(function(e){return e.visibility})),y=d()(e,"map.sources",{}),g=d()(r,"map.sources",{}),v=$($({},y),g),b=d()(e,"widgetsConfig",{}),h=d()(r,"widgetsConfig",{});return $($($({},r),e),{},{catalogServices:$($({},d()(e,"catalogServices",{})),{},{services:$($({},d()(e,"catalogServices.services",{})),d()(r,"catalogServices.services",{}))}),map:$($($({},r.map),e.map),{},{backgrounds:o,groups:P()([].concat(V(d()(e,"map.groups",[])),V(d()(r,"map.groups",[]))),(function(e,t){return e.id===t.id})),layers:[].concat(V(p.slice(0,f+1)),V(p.slice(f+1).map((function(e){return $($({},e),{},{visibility:!1})}))),V(u.filter((function(e){return"background"!==e.group})))),sources:I()(v)?void 0:v}),widgetsConfig:{collapsed:$($({},b.collapsed),h.collapsed),layouts:E()([].concat(V(O()(b.layouts)),V(O()(h.layouts)))).reduce((function(e,t){return $($({},e),{},X({},t,[].concat(V(d()(b,"layouts.".concat(t),[])),V(d()(h,"layouts.".concat(t),[])))))}),{}),widgets:[].concat(V(d()(b,"widgets",[])),V(d()(h,"widgets",[])))},timelineData:$($({},d()(e,"timelineData",{})),d()(r,"timelineData",{})),dimensionData:$($({},d()(e,"dimensionData",{})),d()(r,"dimensionData",{}))})},Ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"RootGroup",n=d()(e,"map.groups",[]),r=n.filter((function(e){return"Default"!==e.id})),o=m()(n,(function(e){return"Default"===e.id})),i=o&&{id:L()(),title:t,expanded:o.expanded},a=o?[].concat(V(r.map((function(e){var t=e.id,n=z(e,W);return $({id:"".concat(i.id,".").concat(t)},n)}))),[i]):r;return $($({},e),{},{map:$($({},e.map),{},{groups:a,layers:d()(e,"map.layers",[]).map((function(e){var t,n=e.group;return $($({},z(e,H)),{},{group:!o||"background"===n||"Default"!==n&&n?o&&(null===(t=m()(a,(function(e){var t=e.id;return t.slice(t.indexOf(".")+1)===n})))||void 0===t?void 0:t.id)||n:i.id})}))})})};function Le(e){switch(e){case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":case"Text":return!1;case"Point":case"Circle":case"LineString":case"Polygon":default:return!0}}function _e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Point";switch(e){case"Point":case"LineString":case"Polygon":case"Circle":return e;case"MultiPoint":case"Marker":return"Point";case"MultiLineString":return"LineString";case"MultiPolygon":return"Polygon";case"GeometryCollection":return"GeometryCollection";case"Text":return"Point";default:return e}}var Be=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/data\/(\d+)/,n=decodeURIComponent(e),r=t.exec(n);return r&&r.length&&r.length>1?r[1]:null},Ue=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return o()(e)&&-1!==e.indexOf("%")?parseFloat(a()(e))*t/100:l()(e)?e:0},Fe=function e(t){var n=["apiKey","time","args","fixed"],r=function(e){return n.reduce((function(t,n){return t||e===n}),!1)};Object.keys(t).forEach((function(n){var o=t[n],i=G(o);"object"!==i||null===o||r(n)?"undefined"!==i&&o&&!r(n)||delete t[n]:(e(o),Object.keys(o).length||delete t[n])}))},Ze=function(e,t,n){e[t]&&(Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(e,t)),delete e[t])},We=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=["map.layers","map.backgrounds","map.text_search_config","map.bookmark_search_config","map.text_serch_config","map.zoom","widgetsConfig"],r=s()(A()(e),n),o=s()(A()(t),n);return Ze(r.map,"text_serch_config","text_search_config"),Ze(o.map,"text_serch_config","text_search_config"),Fe(r),Fe(o),T()(r,o)},He=function(){var e={};return{registerHook:function(t,n){e[t]=n},getHook:function(t){return e[t]},executeHook:function(t,n,r){var o=e[t];return o?n(o):r?r():null}}};const Ge={createRegisterHooks:He,EXTENT_TO_ZOOM_HOOK:ee,RESOLUTIONS_HOOK:ne,RESOLUTION_HOOK:re,COMPUTE_BBOX_HOOK:oe,GET_PIXEL_FROM_COORDINATES_HOOK:ie,GET_COORDINATES_FROM_PIXEL_HOOK:ae,DEFAULT_SCREEN_DPI:Y,ZOOM_TO_EXTENT_HOOK:te,registerHook:le,getHook:ue,dpi2dpm:de,getSphericalMercatorScales:ge,getSphericalMercatorScale:me,getGoogleMercatorScales:ve,getGoogleMercatorResolutions:he,getGoogleMercatorScale:ye,getResolutionsForScales:be,getZoomForExtent:Pe,defaultGetZoomForExtent:Se,getCenterForExtent:Te,getResolutions:Oe,getScales:we,getBbox:Ce,mapUpdated:ke,getCurrentResolution:je,transformExtent:xe,saveMapConfiguration:Ae,generateNewUUIDs:Re,mergeMapConfigs:De,addRootParentGroup:Ne,isSimpleGeomType:Le,getSimpleGeomType:_e,getIdFromUri:Be,parseLayoutValue:Ue,prepareMapObjectToCompare:Fe,updateObjectFieldKey:Ze,compareMapChanges:We,clearHooks:pe}},59112:(e,t,n)=>{"use strict";n.d(t,{LT:()=>u,BC:()=>p,yQ:()=>d,fu:()=>f});var r=n(13218),o=n.n(r),i=n(27361),a=n.n(i),c=n(24262),l=n(86638),u=function(e,t){var n=RegExp("^/|/$|/{2,}");if(0===t.length||e.map((function(e){return e.label})).indexOf(t)>-1||n.test(t))return null;var r=t.replace(/\./g,"${dot}").replace(/\//g,".");return{label:t,value:r}},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"title",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" - ";switch(e){case"title":var i=o()(t.title)?t.title[n]||t.title.default:t.title,a=i||t.name||"";return a;case"description":var c=t.description||"";return c;case"both":var l=o()(t.title)?t.title[n]||t.title.default:t.title,u=l||t.nam||"",s=t.description||"";return"".concat(u).concat(r&&s?r:"").concat(s);default:return t[e]}},p=function(e){var t=e.node,n=e.currentLocale,r=e.tooltipOptions,o=void 0===r?{separator:" - ",maxLength:807}:r,i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" - ";return s(e.tooltipOptions,e,t,n)}(t,n,o.separator)||"";return(i=i&&i.substring(0,o.maxLength)).length===o.maxLength&&(i+="..."),{title:s("title",t,n,o.separator),tooltipText:i}},d=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t.filter((function(e){return e.nodes})).reduce((function(t,o){return t.push(r?o:{label:o.id.replace(/\./g,"/").replace(/\${dot}/g,"."),value:o.id}),o.nodes.length>0?t.concat(e(o.nodes,n+1,r)):t}),[])},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.replace(/[^\.\/]+/g,(function(e){var n=a()((0,c._e)(e,t),"title");return o()(n)?n[(0,l.Kd)()]||n.default:t&&n||e}));return(n=n.replace(/\./g,"/")).replace(/\${dot}/g,".")}},83139:(e,t,n)=>{"use strict";n.d(t,{Xq:()=>r,v9:()=>i});var r=function(e,t){return new Promise((function(n,r){var o=t||{},i=o.width,a=void 0===i?64:i,c=o.height,l=void 0===c?64:c,u=o.contain,s=o.type,p=void 0===s?"image/jpeg":s,d=o.quality,f=void 0===d?.5:d,m=new Image;m.crossOrigin="anonymous",m.onload=function(){var e=m.naturalWidth/m.naturalHeight,t=a,r=l,o=a/l,i=document.createElement("canvas");i.setAttribute("width",a),i.setAttribute("height",l),i.style.width=a+"px",i.style.height=l+"px";var c=i.getContext("2d"),s=!u&&e<o||u&&e>o?[t,t/e]:[r*e,r];c.save(),c.translate(t/2,r/2),c.drawImage(m,-s[0]/2,-s[1]/2,s[0],s[1]),c.restore();var d=i.toDataURL(p,f);n(d)},m.onerror=function(e){r(e)},m.src=e}))},o=function(e,t){return new Promise((function(n,r){var o=t||{},i=o.type,a=void 0===i?"image/jpeg":i,c=o.quality,l=void 0===c?.5:c,u=document.createElement("video");u.crossOrigin="anonymous";var s=document.createElement("source"),p=document.createElement("canvas");u.addEventListener("loadedmetadata",(function(){var e=u.videoWidth,t=u.videoHeight;p.setAttribute("width",e),p.setAttribute("height",t),p.style.width=e+"px",p.style.height=t+"px"}),!0),u.addEventListener("loadeddata",(function(){u.currentTime=1}),!0),u.addEventListener("seeked",(function(){p.getContext("2d").drawImage(u,0,0);try{var e=p.toDataURL(a,l);n(e)}catch(e){r(e)}}),!0),u.addEventListener("error",(function(e){r(e)}),!0),u.appendChild(s),u.setAttribute("src",e)}))},i=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,i=/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})|youtube\.com\/playlist\?list=/,a=null===(e=t.match(i))||void 0===e?void 0:e[1];return a?new Promise((function(e){return e("http://img.youtube.com/vi/".concat(a,"/sddefault.jpg"))})):t.match(/\.(mp4|og[gv]|webm|mov|m4v)($|\?)/i)?o(t).then((function(e){return r(e,n)})):new Promise((function(e,t){return t("Cannot create a thumbnail from the provided source")}))}},11847:(e,t,n)=>{"use strict";n.d(t,{ij:()=>v,w0:()=>b,vl:()=>h,K2:()=>O,Nw:()=>w});var r=n(72500),o=n.n(r),i=n(1469),a=n.n(i),c=n(47037),l=n.n(c),u=n(18446),s=n.n(u),p=n(89734),d=n.n(p),f=n(13311),m=n.n(f),y=n(64210);function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=function(e){if(!e)return{};var t=!(0===e.indexOf("http")),n=t?[]:e.match(/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/);if(t){var r=window.location;n[1]=r.protocol,n[3]=r.hostname,n[4]=r.port,n[5]=e}n[4]=""!==n[4]&&n[4]?n[4]:"https:"===n[1]?"443":"80",n[5]=n[5]?n[5]:e.slice(n[0].length);var o,i,a=(i=6,function(e){if(Array.isArray(e))return e}(o=n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(o,i)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(o,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=a[1],l=a[3],u=a[4],s=a[5],p=0===s.indexOf("/")?s.split("/")[1]:"";return{protocol:c,domain:l,port:u,rootPath:s,applicationRootPath:p}},b=function(e,t){var n=a()(e)?e[0]:e,r=a()(t)?t[0]:t;if(n===r)return!0;if(!n||!r)return!1;if(!l()(n)||!l()(r))return!1;var i=o().parse(n),c=o().parse(r),u=v(n),p=v(r),f=u.protocol===p.protocol,m=u.domain===p.domain,y=u.port===p.port,g=i.pathname===c.pathname,b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e===t)return!0;if(!e&&!t)return!0;var n=e?e.split("&").filter((function(e){return!!e})):[],r=t?t.split("&").filter((function(e){return!!e})):[];return s()(d()(n),d()(r))}(i.query,c.query);return f&&y&&m&&g&&b},h=function(e){return y.parse(e)},O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/^(http(s{0,1}):\/\/)+?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/,n=new RegExp(t);return n.test(e)},w=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/^(http(s{0,1}):\/\/)+?[\w.\-{}]+(?:\.[\w\.-]+)+[\w\-\._~\/\;\.\%\:\&\=\?{}]+$/,r=new RegExp(n),o=r.test(e);if(!o)return!1;if(o&&!t)return!0;if(o&&t){var i=/\{(.*?)\}/.test(e);return 0===t.filter((function(e){return m()(i,e)})).length}return!1}},66287:(e,t,n)=>{"use strict";n.r(t),n.d(t,{isAttrPresent:()=>v,isStrokeStyle:()=>b,isFillStyle:()=>h,isTextStyle:()=>O,isCircleStyle:()=>w,isMarkerStyle:()=>E,isSymbolStyle:()=>S,getStylerTitle:()=>P,geometryFunctions:()=>j,getGeometryFunction:()=>T,registerGeometryFunctions:()=>C,addOpacityToColor:()=>I,hashCode:()=>k,registerStyle:()=>M,setSymbolsStyles:()=>A,fetchStyle:()=>R,getSymbolsStyles:()=>D,hashAndStringify:()=>N,domNodeToString:()=>L,createSvgUrl:()=>_,createStylesAsync:()=>B,getStyleParser:()=>U});var r=n(14293),o=n.n(r),i=n(61868),a=n(43143),c=n(9669),l=n.n(c),u=n(42757),s=n.n(u),p=n(50436),d=n.n(p);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g={sld:new(s()),css:new(d())},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.filter((function(t){return!o()(e[t])})).length>0},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["color","opacity","dashArray","dashOffset","lineCap","lineJoin","weight"];return v(e,t)},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["fillColor","fillOpacity"];return v(e,t)},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["label","font","fontFamily","fontSize","fontStyle","fontWeight","textAlign","textRotationDeg"];return v(e,t)},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["radius"];return v(e,t)},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["iconGlyph","iconShape","iconUrl"];return v(e,t)},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["symbolUrl"];return v(e,t)},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return E(e)?"Marker":S(e)?"Symbol":O(e)?"Text":w(e)||"Circle Style"===e.title?"Circle":h(e)?"Polygon":b(e)?"Polyline":""},j={centerPoint:{type:"Point",func:function(){}},lineToArc:{type:"LineString",func:function(){}},startPoint:{type:"Point",func:function(){}},endPoint:{type:"Point",func:function(){}}},T=function(e,t){return j[e]&&j[e][t]},C=function(e,t,n){if(!(e&&t&&n))throw new Error("specify all the params: functionName, func, type");j[e]={func:t,type:n}},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#FFCC33",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;return(0,i.t8)("a",t,e)},k=function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},x={},M=function(e,t){if(!e||!t)throw new Error("specify all the params: sha, style");x[e]=t},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};x=e},R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"style";return x[e]&&x[e][t]},D=function(){return x},N=function(e){if(e)return k(JSON.stringify(e));throw new Error("hashAndStringify: specify mandatory params: style")},L=function(e){var t=document.createElement("div");return t.appendChild(e),t.innerHTML},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return S(e)&&e.symbolUrl?l().get(t,{"Content-Type":"image/svg+xml;charset=utf-8"}).then((function(t){var n=window.URL||window.webkitURL||window,r=(new DOMParser).parseFromString(t.data,"image/svg+xml").firstElementChild;r.setAttribute("fill",e.fillColor||"#FFCC33"),r.setAttribute("fill-opacity",o()(e.fillOpacity)?.2:e.fillOpacity),r.setAttribute("stroke",(0,a.qq)(e.color||"#FFCC33",o()(e.opacity)?1:e.opacity)),r.setAttribute("stroke-opacity",o()(e.opacity)?1:e.opacity),r.setAttribute("stroke-width",e.weight||1),r.setAttribute("width",e.size||32),r.setAttribute("height",e.size||32),r.setAttribute("stroke-dasharray",e.dashArray||"none");var i=new Blob([L(r)],{type:"image/svg+xml;charset=utf-8"}),c=n.createObjectURL(i),l=document.createElement("canvas");l.width=e.size,l.height=e.size;var u=l.getContext("2d"),s=new Image;s.src=c;var p="",d=N(e);return s.onload=function(){try{u.drawImage(s,l.width/2-s.width/2,l.height/2-s.height/2),p=l.toDataURL("image/png"),l=null,M(d,{style:m(m({},e),{},{symbolUrlCustomized:c}),base64:p})}catch(e){return}},M(d,{style:m(m({},e),{},{symbolUrlCustomized:c}),svg:r,base64:p}),c})).catch((function(){return n(70898)})):new Promise((function(e){e(null)}))},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return S(e)&&!R(N(e))?_(e,e.symbolUrl||e.symbolUrlCustomized).then((function(t){return t?m(m({},e),{},{symbolUrlCustomized:t}):R(N(e))})).catch((function(){return m(m({},e),{},{symbolUrlCustomized:n(70898)})})):new Promise((function(t){t(S(e)?R(N(e)):e)}))}))},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"sld";return g[e]}},83255:(e,t,n)=>{e.exports=n.p+"grid.svg"},11636:(e,t,n)=>{e.exports=n.p+"world.svg"},70898:(e,t,n)=>{e.exports=n.p+"symbolMissing.svg"},73723:(e,t,n)=>{e.exports=n.p+"MapStore2/web/client/components/geostory/contents/carousel/img/default.jpg"},75492:(e,t,n)=>{e.exports=n.p+"MapStore2/web/client/components/geostory/layouts/sections/patterns/dots.png"}}]);